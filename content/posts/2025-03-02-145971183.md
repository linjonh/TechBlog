---
layout: post
title: "每日一题接雨水"
date: 2025-03-02 22:23:45 +0800
description: "每日一题——接雨水"
keywords: "每日一题——接雨水"
categories: ['面经', '算法题', 'C']
tags: ['算法', '笔记', '数据结构', '学习']
artid: "145971183"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=145971183
    alt: "每日一题接雨水"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=145971183
featuredImagePreview: https://bing.ee123.net/img/rand?artid=145971183
cover: https://bing.ee123.net/img/rand?artid=145971183
image: https://bing.ee123.net/img/rand?artid=145971183
img: https://bing.ee123.net/img/rand?artid=145971183
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     每日一题——接雨水
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="_1">
     </a>
     接雨水问题详解
    </h2>
    <h3>
     <a id="_2">
     </a>
     视频学习推荐
    </h3>
    <p>
     建议先参考以下视频进行学习：
    </p>
    <h3>
     <a id="_8">
     </a>
     问题描述
    </h3>
    <p>
     给定一个非负整数数组
     <code>
      height
     </code>
     ，表示每个宽度为 1 的柱子的高度图。计算按此排列的柱子，下雨之后能接多少雨水。
    </p>
    <h4>
     <a id="_12">
     </a>
     示例
    </h4>
    <p>
     <strong>
      示例 1：
     </strong>
    </p>
    <p>
     输入：
     <code>
      height = [0,1,0,2,1,0,1,3,2,1,2,1]
     </code>
     <br/>
     输出：
     <code>
      6
     </code>
     <br/>
     解释：上面是由数组
     <code>
      [0,1,0,2,1,0,1,3,2,1,2,1]
     </code>
     表示的高度图，在这种情况下，可以接 6 个单位的雨水（蓝色部分表示雨水）。
    </p>
    <p>
     <strong>
      示例 2：
     </strong>
    </p>
    <p>
     输入：
     <code>
      height = [4,2,0,3,2,5]
     </code>
     <br/>
     输出：
     <code>
      9
     </code>
    </p>
    <h4>
     <a id="_25">
     </a>
     提示
    </h4>
    <ul>
     <li>
      <code>
       n == height.length
      </code>
     </li>
     <li>
      <code>
       1 &lt;= n &lt;= 2 * 10^4
      </code>
     </li>
     <li>
      <code>
       0 &lt;= height[i] &lt;= 10^5
      </code>
     </li>
    </ul>
    <h3>
     <a id="_31">
     </a>
     解题思路
    </h3>
    <h4>
     <a id="_33">
     </a>
     方法一：单调栈
    </h4>
    <p>
     单调栈是一种利用栈结构来解决此类问题的方法。其核心思想是通过维护一个单调递减的栈，来找到每个柱子左右两侧的“边界”，从而计算出能接的雨水量。
    </p>
    <h5>
     <a id="_37">
     </a>
     算法步骤
    </h5>
    <ol>
     <li>
      初始化一个栈
      <code>
       st
      </code>
      ，用于存储柱子的索引。
     </li>
     <li>
      遍历数组
      <code>
       height
      </code>
      ，对于每个柱子：
      <ul>
       <li>
        如果当前柱子高度大于栈顶柱子的高度（即发现更高的右边界），则：
        <ul>
         <li>
          弹出栈顶元素（作为中间柱子）。
         </li>
         <li>
          如果栈不为空，则计算当前柱子与栈顶柱子之间的雨水量：
          <ul>
           <li>
            高度差：
            <code>
             h = min(height[st.top()], height[i]) - height[mid]
            </code>
           </li>
           <li>
            宽度：
            <code>
             w = i - st.top() - 1
            </code>
           </li>
           <li>
            雨水量：
            <code>
             sum += h * w
            </code>
           </li>
          </ul>
         </li>
        </ul>
       </li>
      </ul>
     </li>
     <li>
      将当前柱子索引入栈。
     </li>
     <li>
      遍历结束后，返回总雨水量。
     </li>
    </ol>
    <h5>
     <a id="C_50">
     </a>
     C++代码实现
    </h5>
    <pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> <span class="token function">trap</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span> height<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>height<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 可以不加</span>
        stack<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> st<span class="token punctuation">;</span>
        <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> height<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>st<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> height<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;=</span> height<span class="token punctuation">[</span>st<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 发现有更高的右边界</span>
                <span class="token keyword">int</span> mid <span class="token operator">=</span> st<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 单调栈第一个拿来当作盛水的低</span>
                st<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 拿来用就给扔了，没用了</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>st<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 看下单调栈是否为空，别是空的，保证左边能盛水</span>
                    <span class="token keyword">int</span> h <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>height<span class="token punctuation">[</span>st<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> height<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> height<span class="token punctuation">[</span>mid<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 这是找左边最大值</span>
                    <span class="token keyword">int</span> w <span class="token operator">=</span> i <span class="token operator">-</span> st<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 注意减一，只求中间宽度</span>
                    sum <span class="token operator">+=</span> h <span class="token operator">*</span> w<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token comment">// 注意while还在循环，因为右边多了一组墙，左边多了几组雨水</span>
            st<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 把当前这个最大值扔进去，当作左边的墙</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> sum<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
    <h5>
     <a id="C_76">
     </a>
     C语言代码实现
    </h5>
    <pre><code class="prism language-c"><span class="token keyword">int</span> <span class="token function">trap</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span> height<span class="token punctuation">,</span> <span class="token keyword">int</span> heightSize<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> n <span class="token operator">=</span> heightSize<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">int</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> stk<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">,</span> top <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>top <span class="token operator">&amp;&amp;</span> height<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> height<span class="token punctuation">[</span>stk<span class="token punctuation">[</span>top <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">int</span> stk_top <span class="token operator">=</span> stk<span class="token punctuation">[</span><span class="token operator">--</span>top<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>top<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">int</span> left <span class="token operator">=</span> stk<span class="token punctuation">[</span>top <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> currWidth <span class="token operator">=</span> i <span class="token operator">-</span> left <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> currHeight <span class="token operator">=</span> <span class="token function">fmin</span><span class="token punctuation">(</span>height<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">,</span> height<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> height<span class="token punctuation">[</span>stk_top<span class="token punctuation">]</span><span class="token punctuation">;</span>
            ans <span class="token operator">+=</span> currWidth <span class="token operator">*</span> currHeight<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        stk<span class="token punctuation">[</span>top<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> ans<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="_103">
     </a>
     方法二：动态规划
    </h4>
    <p>
     动态规划的核心思想是通过维护两个数组
     <code>
      leftMax
     </code>
     和
     <code>
      rightMax
     </code>
     ，分别表示每个柱子左侧和右侧的最大高度。通过这两个数组，可以快速计算出每个柱子能接的雨水量。
    </p>
    <h5>
     <a id="_107">
     </a>
     算法步骤
    </h5>
    <ol>
     <li>
      初始化两个数组
      <code>
       leftMax
      </code>
      和
      <code>
       rightMax
      </code>
      ，分别表示每个柱子左侧和右侧的最大高度。
     </li>
     <li>
      遍历数组
      <code>
       height
      </code>
      ，计算
      <code>
       leftMax
      </code>
      和
      <code>
       rightMax
      </code>
      ：
      <ul>
       <li>
        <code>
         leftMax[i] = max(leftMax[i-1], height[i])
        </code>
       </li>
       <li>
        <code>
         rightMax[i] = max(rightMax[i+1], height[i])
        </code>
       </li>
      </ul>
     </li>
     <li>
      遍历数组
      <code>
       height
      </code>
      ，计算每个柱子能接的雨水量：
      <ul>
       <li>
        <code>
         result += min(leftMax[i], rightMax[i]) - height[i]
        </code>
       </li>
      </ul>
     </li>
    </ol>
    <h5>
     <a id="_116">
     </a>
     代码实现
    </h5>
    <pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> <span class="token function">trap</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span> height<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> n <span class="token operator">=</span> height<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
        
        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> <span class="token function">leftMax</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> <span class="token function">rightMax</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        leftMax<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> height<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            leftMax<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>leftMax<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> height<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        rightMax<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> height<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            rightMax<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>rightMax<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> height<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            result <span class="token operator">+=</span> <span class="token function">min</span><span class="token punctuation">(</span>leftMax<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> rightMax<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> height<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
    <h4>
     <a id="_147">
     </a>
     方法三：双指针优化
    </h4>
    <p>
     动态规划的方法需要额外的
     <code>
      O(n)
     </code>
     空间来存储
     <code>
      leftMax
     </code>
     和
     <code>
      rightMax
     </code>
     。通过使用双指针，可以将空间复杂度优化到
     <code>
      O(1)
     </code>
     。
    </p>
    <h5>
     <a id="_151">
     </a>
     算法步骤
    </h5>
    <ol>
     <li>
      初始化两个指针
      <code>
       left
      </code>
      和
      <code>
       right
      </code>
      ，分别指向数组的两端。
     </li>
     <li>
      初始化两个变量
      <code>
       leftMax
      </code>
      和
      <code>
       rightMax
      </code>
      ，分别表示左侧和右侧的最大高度。
     </li>
     <li>
      当
      <code>
       left &lt; right
      </code>
      时：
      <ul>
       <li>
        更新
        <code>
         leftMax
        </code>
        和
        <code>
         rightMax
        </code>
        ：
        <ul>
         <li>
          <code>
           leftMax = max(leftMax, height[left])
          </code>
         </li>
         <li>
          <code>
           rightMax = max(rightMax, height[right])
          </code>
         </li>
        </ul>
       </li>
       <li>
        如果
        <code>
         height[left] &lt; height[right]
        </code>
        ，则：
        <ul>
         <li>
          <code>
           result += leftMax - height[left]
          </code>
         </li>
         <li>
          <code>
           left++
          </code>
         </li>
        </ul>
       </li>
       <li>
        否则：
        <ul>
         <li>
          <code>
           result += rightMax - height[right]
          </code>
         </li>
         <li>
          <code>
           right--
          </code>
         </li>
        </ul>
       </li>
      </ul>
     </li>
     <li>
      返回总雨水量。
     </li>
    </ol>
    <h5>
     <a id="_167">
     </a>
     代码实现
    </h5>
    <pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> <span class="token function">trap</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span> height<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> r <span class="token operator">=</span> height<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> lMax <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> rMax <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>l <span class="token operator">&lt;</span> r<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            lMax <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>lMax<span class="token punctuation">,</span> height<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            rMax <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>rMax<span class="token punctuation">,</span> height<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>height<span class="token punctuation">[</span>l<span class="token punctuation">]</span> <span class="token operator">&lt;</span> height<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                result <span class="token operator">+=</span> lMax <span class="token operator">-</span> height<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token operator">++</span>l<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                result <span class="token operator">+=</span> rMax <span class="token operator">-</span> height<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token operator">--</span>r<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
    <h5>
     <a id="C_192">
     </a>
     C语言代码实现
    </h5>
    <pre><code class="prism language-c"><span class="token keyword">int</span> <span class="token function">trap</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span> height<span class="token punctuation">,</span> <span class="token keyword">int</span> heightSize<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                <span class="token comment">// 用于存储最终能接的雨水总量</span>
    <span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> r <span class="token operator">=</span> heightSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 初始化左右指针，l指向数组起始位置，r指向数组末尾位置</span>
    <span class="token keyword">int</span> lMax <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> rMax <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token comment">// 初始化左右最大高度变量，用于记录左右指针遍历过程中的最大柱子高度</span>

    <span class="token comment">// 当左指针小于右指针时，继续循环，直到两个指针相遇</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>l <span class="token operator">&lt;</span> r<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 更新左指针左侧的最大高度</span>
        lMax <span class="token operator">=</span> lMax <span class="token operator">&gt;</span> height<span class="token punctuation">[</span>l<span class="token punctuation">]</span> <span class="token operator">?</span> lMax <span class="token operator">:</span> height<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 如果当前左指针指向的柱子高度大于lMax，则更新lMax</span>
        <span class="token comment">// 更新右指针右侧的最大高度</span>
        rMax <span class="token operator">=</span> rMax <span class="token operator">&gt;</span> height<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">?</span> rMax <span class="token operator">:</span> height<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 如果当前右指针指向的柱子高度大于rMax，则更新rMax</span>

        <span class="token comment">// 根据左右指针指向的柱子高度，决定移动哪个指针</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>height<span class="token punctuation">[</span>l<span class="token punctuation">]</span> <span class="token operator">&lt;</span> height<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 如果左指针指向的柱子高度小于右指针指向的柱子高度</span>
            <span class="token comment">// 说明左指针处的柱子可以确定其能接的雨水量（由左最大值lMax决定）</span>
            result <span class="token operator">+=</span> lMax <span class="token operator">-</span> height<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 计算当前左指针处能接的雨水量，并累加到result中</span>
            <span class="token operator">++</span>l<span class="token punctuation">;</span>                        <span class="token comment">// 左指针向右移动一位</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 如果左指针指向的柱子高度大于等于右指针指向的柱子高度</span>
            <span class="token comment">// 说明右指针处的柱子可以确定其能接的雨水量（由右最大值rMax决定）</span>
            result <span class="token operator">+=</span> rMax <span class="token operator">-</span> height<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 计算当前右指针处能接的雨水量，并累加到result中</span>
            <span class="token operator">--</span>r<span class="token punctuation">;</span>                        <span class="token comment">// 右指针向左移动一位</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 当左右指针相遇时，遍历结束，返回能接的雨水总量</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="_226">
     </a>
     总结
    </h3>
    <ul>
     <li>
      <strong>
       单调栈
      </strong>
      ：时间复杂度
      <code>
       O(n)
      </code>
      ，空间复杂度
      <code>
       O(n)
      </code>
      。适合对空间复杂度要求不高的场景。
     </li>
     <li>
      <strong>
       动态规划
      </strong>
      ：时间复杂度
      <code>
       O(n)
      </code>
      ，空间复杂度
      <code>
       O(n)
      </code>
      。思路清晰，适合初学者理解。
     </li>
     <li>
      <strong>
       双指针优化
      </strong>
      ：时间复杂度
      <code>
       O(n)
      </code>
      ，空间复杂度
      <code>
       O(1)
      </code>
      。最优解，适合对空间复杂度要求较高的场景。
      <br/>
      接雨水这个经典题目，看似很难，但是实际上只是考察单调栈的使用。别的还是很容易的。
     </li>
    </ul>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="6874747073:3a2f2f626c6f672e6373646e2e6e65742f7a786a696179612f:61727469636c652f64657461696c732f313435393731313833" class_="artid" style="display:none">
 </p>
</div>


