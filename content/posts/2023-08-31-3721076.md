---
layout: post
title: "Google-C-Test-Framework-一通过ASSERT和EXPECT宏完成的测试"
date: 2023-08-31 11:12:07 +0800
description: "Google C++ Test Framework（以下简称gtest）是Google提供的一套C+"
keywords: "c++test 提供的宏"
categories: ['Programming']
tags: ['语言', '测试', '框架', 'Testing', 'Google', 'C']
artid: "3721076"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=3721076
    alt: "Google-C-Test-Framework-一通过ASSERT和EXPECT宏完成的测试"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=3721076
featuredImagePreview: https://bing.ee123.net/img/rand?artid=3721076
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Google C++ Test Framework （一）通过ASSERT和EXPECT宏完成的测试
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    Google C++ Test Framework（以下简称gtest）是Google提供的一套C++测试框架。其官方地址为
    <a href="http://code.google.com/p/googletest/" rel="nofollow">
     http://code.google.com/p/googletest/
    </a>
    。
    <br/>
    <br/>
    （一）通过ASSERT和EXPECT宏完成的测试
    <br/>
    gtest用TEST宏来完成最基本的测试，其实用的方法如下：
    <br/>
    TEST(CASE_NAME, TEST_NAME){
    <br/>
    ...//ASSERTs or EXPECTs
    <br/>
    }
    <br/>
    <br/>
    CASE_NAME 为测试用例名，TEST_NAME为测试名，这些都是由测试人员给的。在TEST宏中可以加入若干ASSERT类型的宏或者EXPECT类型的宏。如果 ASSERT类型的宏的检查没有通过，那么将中断这一测试，不再继续执行此测试中后面的内容；如果EXPECT类型的宏的检查没有通过，难么将向控制台输 出这一信息，但是不影响用例中后面的宏的继续执行。在程序中，可以通过调用RUN_ALL_TESTS()来执行全部的用例。
    <br/>
    <br/>
    可以通过下面的例子来说明gtest的简单使用方法：
    <br/>
    #include &lt;gtest/gtest.h&gt;
    <br/>
    <br/>
    int Sum(int a, int b){
    <br/>
    return a+b;
    <br/>
    }
    <br/>
    <br/>
    TEST(TESTSum, TEST_ZERO){
    <br/>
    EXPECT_EQ(0,Sum(0,0));
    <br/>
    EXPECT_EQ(0,Sum(-1,1));
    <br/>
    }
    <br/>
    <br/>
    TEST(TESTSum, TEST_ASSERT_SUCCESS){
    <br/>
    ASSERT_EQ(1,Sum(0,1));
    <br/>
    ASSERT_EQ(1,Sum(1,0));
    <br/>
    }
    <br/>
    <br/>
    TEST(TESTSum, TEST_ASSERT_FAIL){
    <br/>
    ASSERT_EQ(0, Sum(1,0));
    <br/>
    EXPECT_EQ(2,Sum(1,0));
    <br/>
    }
    <br/>
    <br/>
    TEST(TESTSum, TEST_FAIL){
    <br/>
    EXPECT_EQ(2,Sum(0,1));
    <br/>
    EXPECT_EQ(-1,Sum(1,0));
    <br/>
    }
    <br/>
    <br/>
    int main(int argc, char* argv[]){
    <br/>
    testing::InitGoogleTest(&amp;argc,argv);
    <br/>
    RUN_ALL_TESTS();
    <br/>
    return 0;
    <br/>
    }
    <br/>
    <br/>
    这 一示例程序建立了4个针对Sum函数的测试，其中TEST_ZERO和TEST_ASSERT_SUCCESS都是可以通过的测试，分别采用了 EXPECT宏和ASSERT宏；而TEST_ASSERT_FAIL和TEST_FAIL则是不能通过的测试，而TEST_ASSERT_FAIL包含 了一个不能通过测试的ASSERT宏。在main函数中，通过testing::InitGoogleTest函数对gtest进行初始化，然后运行 RUN_ALL_TESTS进行全部的测试。程序的运行结果如下：
    <br/>
    <br/>
    [==========] Running 4 tests from 1 test case.
    <br/>
    [----------] Global test environment set-up.
    <br/>
    [----------] 4 tests from TESTSum
    <br/>
    [ RUN      ] TESTSum.TEST_ZERO
    <br/>
    [       OK ] TESTSum.TEST_ZERO
    <br/>
    [ RUN      ] TESTSum.TEST_ASSERT_SUCCESS
    <br/>
    [       OK ] TESTSum.TEST_ASSERT_SUCCESS
    <br/>
    [ RUN      ] TESTSum.TEST_ASSERT_FAIL
    <br/>
    ./main.cpp(19): error: Value of: Sum(1,0)
    <br/>
    Actual: 1
    <br/>
    Expected: 0
    <br/>
    [  FAILED  ] TESTSum.TEST_ASSERT_FAIL
    <br/>
    [ RUN      ] TESTSum.TEST_FAIL
    <br/>
    ./main.cpp(24): error: Value of: Sum(0,1)
    <br/>
    Actual: 1
    <br/>
    Expected: 2
    <br/>
    ./main.cpp(25): error: Value of: Sum(1,0)
    <br/>
    Actual: 1
    <br/>
    Expected: -1
    <br/>
    [  FAILED  ] TESTSum.TEST_FAIL
    <br/>
    [----------] Global test environment tear-down
    <br/>
    [==========] 4 tests from 1 test case ran.
    <br/>
    [  PASSED  ] 2 tests.
    <br/>
    [  FAILED  ] 2 tests, listed below:
    <br/>
    [  FAILED  ] TESTSum.TEST_ASSERT_FAIL
    <br/>
    [  FAILED  ] TESTSum.TEST_FAIL
    <br/>
    <br/>
    2 FAILED TESTS
    <br/>
    <br/>
    我 们可以看到TESTSum.TEST_ZERO和TESTSum.TEST_ASSERT_SUCCESS都正常的通过了测试，在 TESTSum.TEST_FAIL中没有通过的两个测试也得到了对应的输出。而在用例TESTSum.TEST_ASSERT_FAIL中，我们也可以 看到在ASSERT没有通过，程序停止对该测试，跳过了剩下的一个EXPECT宏。RUN_ALL_TESTS有返回值，全部测试通过时会返回0。
    <br/>
    <br/>
    ACCERT或者EXPECT类型的宏都包含以下几类：
    <br/>
    1）Boolean类型，只需要传一个参数，即一个判断条件，包括ASSERT_TRUE，ASSERT_FALSE，EXPECT_TRUE，EXPECT_FALSE。
    <br/>
    2）数值类，传入两个值，检查两个值是否符合调用宏的条件。ASSERT类型的宏包括 ASSERT_EQ，ASSERT_NE，ASSERT_LE，ASSERT_LE，ASSERT_GT，ASSERT_GE，对于每一种ASSERT类 型的宏，EXPECT类型的宏都有一个对应。
    <br/>
    3）字符类，检查两个字符串相等或者不等，比较的字符串必须为c语言的字符串类型（char*或者wchar*）。ASSERT类型的宏包括 ASSERT_STREQ，ASSERT_STRNE，ASSERT_STRCASEEQ，ASSERT_STRCASENE（后两种为忽略大小写的检 查），对于每一种ASSERT类型的宏，EXPECT类型的宏都有一个对应。
    <br/>
   </div>
  </div>
 </article>
 <p alt="68747470:733a2f2f626c6f672e6373646e2e6e65742f736f6372617465:732f61727469636c652f64657461696c732f33373231303736" class_="artid" style="display:none">
 </p>
</div>


