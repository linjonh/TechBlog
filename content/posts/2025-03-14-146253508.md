---
layout: post
title: "实战篇MySQL-时间字段的处理"
date: 2025-03-14 11:36:05 +0800
description: "NOW()：返回当前的日期和时间。：返回当前日期，不包含时间部分。：返回当前时间，不包含日期部分。：返回当前时间的 Unix 时间戳。：将 Unix 时间戳转换为日期时间。"
keywords: "【实战篇】MySQL 时间字段的处理"
categories: ['Mysql']
tags: ['数据库', 'Sql', 'Mysql']
artid: "146253508"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146253508
    alt: "实战篇MySQL-时间字段的处理"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146253508
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146253508
cover: https://bing.ee123.net/img/rand?artid=146253508
image: https://bing.ee123.net/img/rand?artid=146253508
img: https://bing.ee123.net/img/rand?artid=146253508
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     【实战篇】MySQL 时间字段的处理
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="MySQL__0">
     </a>
     MySQL 时间字段的处理
    </h2>
    <h3>
     <a id="1_2">
     </a>
     1、获取当前日期和时间
    </h3>
    <ul>
     <li>
      <p>
       <code>
        NOW()
       </code>
       ：返回当前的日期和时间。
      </p>
      <pre><code class="prism language-sql"><span class="token comment"># 2025-03-14 11:07:24</span>
<span class="token keyword">SELECT</span> <span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
     </li>
     <li>
      <p>
       <code>
        CURDATE()
       </code>
       ：返回当前日期，不包含时间部分。
      </p>
      <pre><code class="prism language-sql"><span class="token comment"># 2025-03-14</span>
<span class="token keyword">SELECT</span> CURDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
     </li>
     <li>
      <p>
       <code>
        CURTIME()
       </code>
       ：返回当前时间，不包含日期部分。
      </p>
      <pre><code class="prism language-sql"><span class="token comment"># 11:07:24</span>
<span class="token keyword">SELECT</span> CURTIME<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
     </li>
     <li>
      <p>
       <code>
        UNIX_TIMESTAMP()
       </code>
       ：返回当前时间的 Unix 时间戳。
      </p>
      <pre><code class="prism language-sql"><span class="token keyword">SELECT</span> UNIX_TIMESTAMP<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
     </li>
     <li>
      <p>
       <code>
        FROM_UNIXTIME(unix_timestamp)
       </code>
       ：将 Unix 时间戳转换为日期时间。
      </p>
      <pre><code class="prism language-sql"><span class="token keyword">SELECT</span> FROM_UNIXTIME<span class="token punctuation">(</span><span class="token number">1678783404</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
     </li>
    </ul>
    <h3>
     <a id="2_39">
     </a>
     2、提取日期或时间的特定部分
    </h3>
    <ul>
     <li>
      <p>
       <code>
        YEAR(date)
       </code>
       ：返回日期的年份部分。
      </p>
      <pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">YEAR</span><span class="token punctuation">(</span><span class="token string">'2025-03-14'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 2025</span>
</code></pre>
     </li>
     <li>
      <p>
       <code>
        MONTH(date)
       </code>
       ：返回日期的月份部分。
      </p>
      <pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">MONTH</span><span class="token punctuation">(</span><span class="token string">'2025-03-14'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 3</span>
</code></pre>
     </li>
     <li>
      <p>
       <code>
        DAY(date)
       </code>
       ：返回日期的天部分。
      </p>
      <pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">DAY</span><span class="token punctuation">(</span><span class="token string">'2025-03-14'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 14</span>
</code></pre>
     </li>
     <li>
      <p>
       <code>
        HOUR(time)
       </code>
       ：返回时间的小时部分。
      </p>
      <pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">HOUR</span><span class="token punctuation">(</span><span class="token string">'11:03:24'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 11</span>
</code></pre>
     </li>
     <li>
      <p>
       <strong>
        <code>
         MINUTE(time)
        </code>
       </strong>
       ：返回时间的分钟部分。
      </p>
      <pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">MINUTE</span><span class="token punctuation">(</span><span class="token string">'11:03:24'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 3</span>
</code></pre>
     </li>
     <li>
      <p>
       <code>
        SECOND(time)
       </code>
       ：返回时间的秒部分。
      </p>
      <pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">SECOND</span><span class="token punctuation">(</span><span class="token string">'11:03:24'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 24</span>
</code></pre>
     </li>
    </ul>
    <p>
     <strong>
      实战示例
     </strong>
     ：
    </p>
    <pre><code class="prism language-sql"><span class="token comment">-- 近三年条件过滤</span>
<span class="token operator">and</span> check_year <span class="token operator">BETWEEN</span> <span class="token keyword">YEAR</span> <span class="token punctuation">(</span>CURDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">AND</span> <span class="token keyword">YEAR</span> <span class="token punctuation">(</span>CURDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
    <h3>
     <a id="3_86">
     </a>
     3、时间差计算
    </h3>
    <ul>
     <li>
      <code>
       TIMESTAMPDIFF(unit, datetime_expr1, datetime_expr2)
      </code>
      ：返回两个日期时间表达式之间的差值，单位由第一个参数指定。
     </li>
     <li>
      <code>
       DateDiff()
      </code>
      ：计算 第一个时间 和 第二个时间 的时间差，a - b
     </li>
     <li>
      <code>
       TIMEDIFF(time_expr1, time_expr2)
      </code>
      ：返回两个时间表达式之间的差值。
     </li>
    </ul>
    <pre><code class="prism language-sql"><span class="token keyword">SELECT</span> TIMESTAMPDIFF<span class="token punctuation">(</span><span class="token keyword">DAY</span><span class="token punctuation">,</span> <span class="token string">'2025-03-01'</span><span class="token punctuation">,</span> <span class="token string">'2025-03-14'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment"># 13</span>

<span class="token keyword">SELECT</span> DATEDIFF<span class="token punctuation">(</span><span class="token string">'2025-03-01'</span><span class="token punctuation">,</span> <span class="token string">'2025-03-14'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment"># -13</span>

<span class="token keyword">SELECT</span> TIMEDIFF<span class="token punctuation">(</span><span class="token string">'11:03:24'</span><span class="token punctuation">,</span> <span class="token string">'10:00:00'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment"># '01:03:24'</span>
</code></pre>
    <h3>
     <a id="4_102">
     </a>
     4、格式化日期字段
    </h3>
    <pre><code class="prism language-sql"><span class="token comment"># DATE_FORMAT(date, format)：将日期格式化为指定的字符串</span>
<span class="token keyword">SELECT</span> DATE_FORMAT<span class="token punctuation">(</span><span class="token string">'2025-03-01 11:03:24'</span><span class="token punctuation">,</span> <span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- '2025-03-01'</span>

<span class="token comment"># STR_TO_DATE(str, format)：将字符串按指定格式转换为日期</span>
<span class="token keyword">SELECT</span> STR_TO_DATE<span class="token punctuation">(</span><span class="token string">'14-03-2025'</span><span class="token punctuation">,</span> <span class="token string">'%d-%m-%Y'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- 2025-03-14</span>
</code></pre>
    <h3>
     <a id="5_114">
     </a>
     5、时间提取
    </h3>
    <ul>
     <li>
      <code>
       DATE()
      </code>
      ：提取日期时间表达式的日期部分。
     </li>
    </ul>
    <pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">DATE</span><span class="token punctuation">(</span><span class="token string">'2025-03-14 11:03:24'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- '2025-03-14'</span>
</code></pre>
    <ul>
     <li>
      <code>
       TIME()
      </code>
      ：提取日期时间表达式的时间部分。
     </li>
    </ul>
    <pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">TIME</span><span class="token punctuation">(</span><span class="token string">'2025-03-14 11:03:24'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">-- '11:03:24'</span>
</code></pre>
    <h3>
     <a id="6_130">
     </a>
     6、日期的加减
    </h3>
    <h4>
     <a id="_132">
     </a>
     （一）增加时间
    </h4>
    <pre><code class="prism language-sql"><span class="token comment"># 日期 小于 当前日期加上 30 天</span>
<span class="token punctuation">(</span> my_date <span class="token operator">&lt;</span> CURDATE<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">INTERVAL</span> <span class="token number">30</span> <span class="token keyword">DAY</span> <span class="token punctuation">)</span>

<span class="token comment"># 日期加上 30 天</span>
ADDDATE<span class="token punctuation">(</span>my_date<span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token number">30</span> <span class="token keyword">DAY</span><span class="token punctuation">)</span>

<span class="token comment"># 时间(time) 加上 2 小时</span>
ADDTIME<span class="token punctuation">(</span>my_time<span class="token punctuation">,</span> <span class="token string">'02:00:00'</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     函数解析：
    </p>
    <ul>
     <li>
      <code>
       ADDDATE(date, interval)
      </code>
      函数用于将指定的时间间隔（interval）添加到给定的日期（date）上。
     </li>
     <li>
      <code>
       ADDTIME(time, interval)
      </code>
      函数用于将指定的时间间隔（interval）添加到给定的时间（time）上。
     </li>
    </ul>
    <h4>
     <a id="_150">
     </a>
     （二）减少时间
    </h4>
    <pre><code class="prism language-sql"><span class="token comment"># 一个日期减 30 天后，在'2024-01-27' 和 '2024-02-27' 的范围内的数据</span>
<span class="token punctuation">(</span> my_date <span class="token operator">-</span> <span class="token keyword">INTERVAL</span> <span class="token number">30</span> <span class="token keyword">DAY</span> <span class="token punctuation">)</span> <span class="token operator">BETWEEN</span> <span class="token string">'2024-01-27'</span> <span class="token operator">AND</span> <span class="token string">'2024-02-27'</span>

<span class="token comment"># 一个日期中减去 30 天</span>
ADDDATE<span class="token punctuation">(</span>my_date<span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token operator">-</span><span class="token number">30</span> <span class="token keyword">DAY</span><span class="token punctuation">)</span>

<span class="token comment"># 一个时间中减去 2 小时</span>
ADDTIME<span class="token punctuation">(</span>my_time<span class="token punctuation">,</span> <span class="token string">'-02:00:00'</span><span class="token punctuation">)</span>

<span class="token comment"># 当天减一天（即昨天）</span>
DATE_SUB<span class="token punctuation">(</span> CURDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token number">1</span> <span class="token keyword">DAY</span> <span class="token punctuation">)</span>

<span class="token comment"># 例如今天是 2024-7-12，则下面拼接后的时间为 2024-7-11 23:59:59</span>
CONCAT<span class="token punctuation">(</span> DATE_SUB<span class="token punctuation">(</span> CURDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token number">1</span> <span class="token keyword">DAY</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">' 23:59:59'</span> <span class="token punctuation">)</span>
</code></pre>
    <p>
     函数解析：
    </p>
    <ul>
     <li>
      <code>
       DATE_SUB(date, interval)
      </code>
      函数用于将指定的日期（date）上减去时间间隔（interval）。
     </li>
    </ul>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f35343038383233342f:61727469636c652f64657461696c732f313436323533353038" class_="artid" style="display:none">
 </p>
</div>


