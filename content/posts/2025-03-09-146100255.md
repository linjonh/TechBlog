---
layout: post
title: "MyBatis-Mapper-接口的作用,以及如何将-Mapper-接口与-SQL-映射文件关联起来"
date: 2025-03-09 14:32:52 +0800
description: "无论使用哪种方式，MyBatis 都会根据 Mapper 接口的方法名和参数类型，自动查找并执行对应的 SQL 语句，并将结果映射为 Java 对象或基本类型。Mapper 接口是 MyBatis 的核心概念之一，理解其作用和关联方式对于使用 MyBatis 至关重要。MyBatis Mapper 接口在 MyBatis 框架中扮演着至关重要的角色，它充当了 Java 代码与 SQL 映射文件之间的桥梁，使得我们可以通过面向对象的方式来操作数据库。"
keywords: "MyBatis Mapper 接口的作用，以及如何将 Mapper 接口与 SQL 映射文件关联起来"
categories: ['源码系列', 'Mybatis']
tags: ['数据库', 'Sql', 'Mybatis']
artid: "146100255"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146100255
    alt: "MyBatis-Mapper-接口的作用,以及如何将-Mapper-接口与-SQL-映射文件关联起来"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146100255
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146100255
cover: https://bing.ee123.net/img/rand?artid=146100255
image: https://bing.ee123.net/img/rand?artid=146100255
img: https://bing.ee123.net/img/rand?artid=146100255
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     MyBatis Mapper 接口的作用，以及如何将 Mapper 接口与 SQL 映射文件关联起来
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     MyBatis Mapper 接口在 MyBatis 框架中扮演着至关重要的角色，它充当了 Java 代码与 SQL 映射文件之间的桥梁，使得我们可以通过面向对象的方式来操作数据库。
    </p>
    <p>
     <strong>
      Mapper 接口的作用：
     </strong>
    </p>
    <ol>
     <li>
      <strong>
       定义数据库操作方法:
      </strong>
      Mapper 接口中定义的方法与 SQL 映射文件中的 SQL 语句（
      <code>
       select
      </code>
      ,
      <code>
       insert
      </code>
      ,
      <code>
       update
      </code>
      ,
      <code>
       delete
      </code>
      ）一一对应。 每个方法代表一个特定的数据库操作。
     </li>
     <li>
      <strong>
       类型安全:
      </strong>
      Mapper 接口提供了类型安全的数据库操作。方法参数和返回值类型在编译时就会进行检查，避免了类型转换错误。
     </li>
     <li>
      <strong>
       代码简洁:
      </strong>
      通过 Mapper 接口，我们可以直接调用方法来执行 SQL 语句，而无需编写繁琐的 JDBC 代码。
     </li>
     <li>
      <strong>
       易于测试:
      </strong>
      Mapper 接口可以很容易地进行单元测试，我们可以使用 Mock 对象来模拟数据库交互，而无需实际连接数据库。
     </li>
     <li>
      <strong>
       与 Spring 集成:
      </strong>
      MyBatis 可以与 Spring 框架无缝集成，Mapper 接口可以被 Spring 容器管理，方便进行依赖注入。
     </li>
    </ol>
    <p>
     <strong>
      Mapper 接口与 SQL 映射文件的关联方式：
     </strong>
    </p>
    <p>
     MyBatis 提供了两种主要的方式来将 Mapper 接口与 SQL 映射文件关联起来：
    </p>
    <p>
     <strong>
      1. XML 配置方式 (传统方式):
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       SQL 映射文件 (XML):
      </strong>
      SQL 语句写在 XML 文件中，例如
      <code>
       UserMapper.xml
      </code>
      。
     </li>
     <li>
      <strong>
       Mapper 接口:
      </strong>
      定义与 XML 文件中 SQL 语句对应的方法，例如
      <code>
       UserMapper.java
      </code>
      。
     </li>
     <li>
      <strong>
       关联方式:
      </strong>
      通过 XML 文件中的
      <code>
       namespace
      </code>
      属性与 Mapper 接口的全限定名进行关联。
     </li>
    </ul>
    <p>
     <strong>
      示例:
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       UserMapper.xml:
      </strong>
     </li>
    </ul>
    <pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
  <span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">mapper</span>
    <span class="token name">PUBLIC</span> <span class="token string">"-//mybatis.org//DTD Mapper 3.0//EN"</span>
    <span class="token string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.example.mapper.UserMapper<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectUserById<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>int<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.example.model.User<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      SELECT id, username, password, email FROM users WHERE id = #{id}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>insertUser<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.example.model.User<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
         INSERT INTO users(username, password) VALUES(#{username}, #{password})
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>insert</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <ul>
     <li>
      <p>
       <code>
        &lt;mapper namespace="com.example.mapper.UserMapper"&gt;
       </code>
       :
       <code>
        namespace
       </code>
       属性值必须与 Mapper 接口的全限定名一致。
      </p>
     </li>
     <li>
      <p>
       <code>
        id="selectUserById"
       </code>
       ：该
       <code>
        select
       </code>
       语句的唯一标识符，与Mapper接口中对应的方法名相同。
      </p>
     </li>
     <li>
      <p>
       <code>
        id="insertUser"
       </code>
       ：该
       <code>
        insert
       </code>
       语句的唯一标识符，与Mapper接口中对应的方法名相同。
      </p>
      <ul>
       <li>
        <strong>
         UserMapper.java (Mapper 接口):
        </strong>
       </li>
      </ul>
      <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>mapper</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">User</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserMapper</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">User</span> <span class="token function">selectUserById</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> <span class="token function">insertUser</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
      <p>
       <strong>
        MyBatis 配置文件 (mybatis-config.xml 示例，部分配置):
       </strong>
      </p>
      <pre><code class="prism language-xml">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mappers</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com/example/mapper/UserMapper.xml<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span> 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mappers</span><span class="token punctuation">&gt;</span></span>
</code></pre>
     </li>
     <li>
      <p>
       <code>
        &lt;mapper resource="com/example/mapper/UserMapper.xml"/&gt;
       </code>
       : 指定 SQL 映射文件的位置。
      </p>
     </li>
     <li>
      <p>
       也可以使用
       <code>
        &lt;package name="com.example.mapper"/&gt;
       </code>
       来扫描指定包下的所有 Mapper 接口和对应的 XML 文件 (前提是 XML 文件与 Mapper 接口在同一个包下，且文件名与接口名相同)。
      </p>
     </li>
    </ul>
    <p>
     <strong>
      2. 注解方式 (更简洁的方式):
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       SQL 映射文件 (可选):
      </strong>
      对于简单的 SQL 语句，可以直接在 Mapper 接口的方法上使用 MyBatis 提供的注解 (
      <code>
       @Select
      </code>
      ,
      <code>
       @Insert
      </code>
      ,
      <code>
       @Update
      </code>
      ,
      <code>
       @Delete
      </code>
      ) 来编写 SQL 语句，此时可以不需要 XML 文件。 对于复杂的 SQL 语句，仍然建议使用 XML 文件。
     </li>
     <li>
      <strong>
       Mapper 接口:
      </strong>
      在接口方法上使用注解来定义 SQL 语句。
     </li>
     <li>
      <strong>
       关联方式:
      </strong>
      MyBatis 会自动扫描带有
      <code>
       @Mapper
      </code>
      注解的接口，并将注解中的 SQL 语句与方法关联起来。
     </li>
    </ul>
    <p>
     <strong>
      示例:
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       UserMapper.java (Mapper 接口):
      </strong>
     </li>
    </ul>
    <pre><code class="prism language-java">  <span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>mapper</span><span class="token punctuation">;</span>

  <span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">User</span></span><span class="token punctuation">;</span>
  <span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>

  <span class="token annotation punctuation">@Mapper</span> <span class="token comment">// 标记该接口为一个 MyBatis Mapper 接口</span>
  <span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserMapper</span> <span class="token punctuation">{<!-- --></span>

      <span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"SELECT id, username, password, email FROM users WHERE id = #{id}"</span><span class="token punctuation">)</span>
      <span class="token class-name">User</span> <span class="token function">selectUserById</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token annotation punctuation">@Insert</span><span class="token punctuation">(</span><span class="token string">"INSERT INTO users(username, password) VALUES(#{username}, #{password})"</span><span class="token punctuation">)</span>
      <span class="token annotation punctuation">@Options</span><span class="token punctuation">(</span>useGeneratedKeys <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span> keyProperty <span class="token operator">=</span> <span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token comment">// 获取自增主键</span>
      <span class="token keyword">int</span> <span class="token function">insertUser</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 也可以混合使用注解和 XML</span>
      <span class="token annotation punctuation">@SelectProvider</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">UserSqlProvider</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token string">"buildGetUsersByName"</span><span class="token punctuation">)</span>
      <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">getUsersByName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
   
  <span class="token comment">//对于复杂SQL可以使用Provider</span>
  <span class="token keyword">class</span> <span class="token class-name">UserSqlProvider</span> <span class="token punctuation">{<!-- --></span>
     <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">buildGetUsersByName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
       <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SQL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>
         <span class="token function">SELECT</span><span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token function">FROM</span><span class="token punctuation">(</span><span class="token string">"users"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
           <span class="token function">WHERE</span><span class="token punctuation">(</span><span class="token string">"username like #{name}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         <span class="token function">ORDER_BY</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
</code></pre>
    <ul>
     <li>
      <p>
       <code>
        @Select
       </code>
       ,
       <code>
        @Insert
       </code>
       ,
       <code>
        @Update
       </code>
       ,
       <code>
        @Delete
       </code>
       : 分别对应 SQL 的四种操作。
      </p>
      <ul>
       <li>
        <code>
         @Options
        </code>
        : 用于配置一些额外的选项，例如获取自增主键。
       </li>
       <li>
        <code>
         @Mapper
        </code>
        : 标记该接口，让MyBatis扫描并进行处理
       </li>
       <li>
        <code>
         @SelectProvider
        </code>
        ,
        <code>
         @InsertProvider
        </code>
        ,
        <code>
         @UpdateProvider
        </code>
        ,
        <code>
         @DeleteProvider
        </code>
        : 用于构建动态 SQL。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        MyBatis 配置文件 (mybatis-config.xml，如果使用纯注解方式，且通过 Spring Boot 自动配置，则通常不需要此文件):
       </strong>
      </p>
     </li>
     <li>
      <p>
       如果使用 Spring Boot，通常不需要手动配置 MyBatis 配置文件，Spring Boot 会自动扫描带有
       <code>
        @Mapper
       </code>
       注解的接口，并进行自动配置。
      </p>
     </li>
     <li>
      <p>
       如果不是 Spring Boot 项目，需要在 MyBatis 配置文件中使用
       <code>
        &lt;mappers&gt;
       </code>
       标签来扫描 Mapper 接口：
      </p>
     </li>
    </ul>
    <pre><code class="prism language-xml">     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mappers</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.example.mapper<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span> 
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mappers</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <p>
     或者，如果使用了XML文件
    </p>
    <pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mappers</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.example.mapper.UserMapper<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mappers</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <p>
     <strong>
      总结：
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       XML 配置方式:
      </strong>
      更适合复杂的 SQL 语句和需要细粒度控制的场景。
     </li>
     <li>
      <strong>
       注解方式:
      </strong>
      更简洁，更适合简单的 SQL 语句，并且与 Spring Boot 集成更方便。
     </li>
     <li>
      两种方式可以混合使用，根据实际情况选择最合适的方式。 通常对于简单的 CRUD 操作使用注解，复杂的查询使用 XML。
     </li>
    </ul>
    <p>
     无论使用哪种方式，MyBatis 都会根据 Mapper 接口的方法名和参数类型，自动查找并执行对应的 SQL 语句，并将结果映射为 Java 对象或基本类型。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f6e6d736f66746b6c622f:61727469636c652f64657461696c732f313436313030323535" class_="artid" style="display:none">
 </p>
</div>


