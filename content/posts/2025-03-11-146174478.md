---
layout: post
title: "Unity辅助工具_头部与svn"
date: 2025-03-11 11:37:53 +0800
description: "Unity调用者按钮增加PlaySideButton。unity头部扩展基类ToolbarCallback。svn工具辅助类 SVNHelper。\"Assets/SVN/更新\"\"Assets/SVN/提交\""
keywords: "Unity辅助工具_头部与svn"
categories: ['未分类']
tags: ['游戏引擎', 'Unity', 'Svn']
artid: "146174478"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146174478
    alt: "Unity辅助工具_头部与svn"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146174478
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146174478
cover: https://bing.ee123.net/img/rand?artid=146174478
image: https://bing.ee123.net/img/rand?artid=146174478
img: https://bing.ee123.net/img/rand?artid=146174478
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Unity辅助工具_头部与svn
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/955427f1f04f44478a1faa47b3396c6f.png#pic_center"/>
    </p>
    <p>
     Unity调用者按钮增加PlaySideButton
    </p>
    <pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">QQu</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEditor</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">InitializeOnLoad</span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PlaySideButton</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">static</span> <span class="token function">PlaySideButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        UnityEditorToolbar<span class="token punctuation">.</span>RightToolbarGUI<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>OnRightToolbarGUI<span class="token punctuation">)</span><span class="token punctuation">;</span>
        UnityEditorToolbar<span class="token punctuation">.</span>LeftToolbarGUI<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>OnLeftToolbarGUI<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name"><span class="token keyword">bool</span></span> mIsOpenPreview <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnRightToolbarGUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>GUILayout<span class="token punctuation">.</span><span class="token function">Button</span><span class="token punctuation">(</span><span class="token string">"GM | 格子坐标 | 格子使用"</span><span class="token punctuation">,</span> GUILayout<span class="token punctuation">.</span><span class="token function">MaxWidth</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">,</span> GUILayout<span class="token punctuation">.</span><span class="token function">Height</span><span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>Event<span class="token punctuation">.</span>current<span class="token punctuation">.</span>button <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                AudioController<span class="token punctuation">.</span><span class="token function">GetInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">PlayClickSound</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                UIMgr<span class="token punctuation">.</span>Ins<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Show</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>QQu<span class="token punctuation">.</span>UI<span class="token punctuation">.</span>GMView<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Task</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>Event<span class="token punctuation">.</span>current<span class="token punctuation">.</span>button <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                BuildingGridTileMgr<span class="token punctuation">.</span>Ins<span class="token punctuation">.</span><span class="token function">SetTestShowCell</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>Event<span class="token punctuation">.</span>current<span class="token punctuation">.</span>button <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>mIsOpenPreview<span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span>
                    SceneMapManager<span class="token punctuation">.</span>Ins<span class="token punctuation">.</span><span class="token function">PreviewCell</span><span class="token punctuation">(</span>PreviewCellTypeEnum<span class="token punctuation">.</span>CanBuilding<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span>
                    SceneMapManager<span class="token punctuation">.</span>Ins<span class="token punctuation">.</span><span class="token function">ClosePreviewCell</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                mIsOpenPreview <span class="token operator">=</span> <span class="token operator">!</span>mIsOpenPreview<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnLeftToolbarGUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        GUILayout<span class="token punctuation">.</span><span class="token function">FlexibleSpace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//从右开始排</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>GUILayout<span class="token punctuation">.</span><span class="token function">Button</span><span class="token punctuation">(</span><span class="token string">"更新 | 日志 | 提交"</span><span class="token punctuation">,</span> GUILayout<span class="token punctuation">.</span><span class="token function">MaxWidth</span><span class="token punctuation">(</span><span class="token number">110</span><span class="token punctuation">)</span><span class="token punctuation">,</span> GUILayout<span class="token punctuation">.</span><span class="token function">Height</span><span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>Application<span class="token punctuation">.</span>isPlaying<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                Debug<span class="token punctuation">.</span><span class="token function">LogError</span><span class="token punctuation">(</span><span class="token string">"你游戏正在运行中"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> strCMD <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token string">"update"</span><span class="token punctuation">,</span> <span class="token string">"commit"</span><span class="token punctuation">,</span> <span class="token string">"log"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">//更新   查看日志  提交</span>

            <span class="token class-name"><span class="token keyword">string</span></span> path <span class="token operator">=</span> Application<span class="token punctuation">.</span>dataPath<span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token string">"Assets"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            SVNHelper<span class="token punctuation">.</span><span class="token function">StartSvnProc</span><span class="token punctuation">(</span>strCMD<span class="token punctuation">[</span>Event<span class="token punctuation">.</span>current<span class="token punctuation">.</span>button<span class="token punctuation">]</span><span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     unity头部扩展基类ToolbarCallback
    </p>
    <pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Reflection</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEditor</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">if</span> UNITY_2019_1_OR_NEWER</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEngine<span class="token punctuation">.</span>UIElements</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">else</span></span>
<span class="token keyword">using</span> <span class="token namespace">UnityEngine<span class="token punctuation">.</span>Experimental<span class="token punctuation">.</span>UIElements</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">endif</span></span>
<span class="token comment">//https://github.com/marijnz/unity-toolbar-extender</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">ToolbarCallback</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">static</span> <span class="token class-name">Type</span> m_toolbarType <span class="token operator">=</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">UnityEditor<span class="token punctuation">.</span>Editor</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">.</span><span class="token function">GetType</span><span class="token punctuation">(</span><span class="token string">"UnityEditor.Toolbar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token class-name">Type</span> m_guiViewType <span class="token operator">=</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">UnityEditor<span class="token punctuation">.</span>Editor</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">.</span><span class="token function">GetType</span><span class="token punctuation">(</span><span class="token string">"UnityEditor.GUIView"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">if</span> UNITY_2020_1_OR_NEWER</span>
    <span class="token keyword">static</span> <span class="token class-name">Type</span> m_iWindowBackendType <span class="token operator">=</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">UnityEditor<span class="token punctuation">.</span>Editor</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">.</span><span class="token function">GetType</span><span class="token punctuation">(</span><span class="token string">"UnityEditor.IWindowBackend"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token class-name">PropertyInfo</span> m_windowBackend <span class="token operator">=</span> m_guiViewType<span class="token punctuation">.</span><span class="token function">GetProperty</span><span class="token punctuation">(</span><span class="token string">"windowBackend"</span><span class="token punctuation">,</span>
        BindingFlags<span class="token punctuation">.</span>Public <span class="token operator">|</span> BindingFlags<span class="token punctuation">.</span>NonPublic <span class="token operator">|</span> BindingFlags<span class="token punctuation">.</span>Instance<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token class-name">PropertyInfo</span> m_viewVisualTree <span class="token operator">=</span> m_iWindowBackendType<span class="token punctuation">.</span><span class="token function">GetProperty</span><span class="token punctuation">(</span><span class="token string">"visualTree"</span><span class="token punctuation">,</span>
        BindingFlags<span class="token punctuation">.</span>Public <span class="token operator">|</span> BindingFlags<span class="token punctuation">.</span>NonPublic <span class="token operator">|</span> BindingFlags<span class="token punctuation">.</span>Instance<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">else</span></span>
        <span class="token keyword">static</span> <span class="token class-name">PropertyInfo</span> m_viewVisualTree <span class="token operator">=</span> m_guiViewType<span class="token punctuation">.</span><span class="token function">GetProperty</span><span class="token punctuation">(</span><span class="token string">"visualTree"</span><span class="token punctuation">,</span>
            BindingFlags<span class="token punctuation">.</span>Public <span class="token operator">|</span> BindingFlags<span class="token punctuation">.</span>NonPublic <span class="token operator">|</span> BindingFlags<span class="token punctuation">.</span>Instance<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">endif</span></span>
    <span class="token keyword">static</span> <span class="token class-name">FieldInfo</span> m_imguiContainerOnGui <span class="token operator">=</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">IMGUIContainer</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetField</span><span class="token punctuation">(</span><span class="token string">"m_OnGUIHandler"</span><span class="token punctuation">,</span>
        BindingFlags<span class="token punctuation">.</span>Public <span class="token operator">|</span> BindingFlags<span class="token punctuation">.</span>NonPublic <span class="token operator">|</span> BindingFlags<span class="token punctuation">.</span>Instance<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token class-name">ScriptableObject</span> m_currentToolbar<span class="token punctuation">;</span>

    <span class="token comment">/// &lt;summary&gt;</span>
    <span class="token comment">/// Callback for toolbar OnGUI method.</span>
    <span class="token comment">/// &lt;/summary&gt;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Action</span> OnToolbarGUI<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Action</span> OnToolbarGUILeft<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Action</span> OnToolbarGUIRight<span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token function">ToolbarCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        EditorApplication<span class="token punctuation">.</span>update <span class="token operator">-=</span> OnUpdate<span class="token punctuation">;</span>
        EditorApplication<span class="token punctuation">.</span>update <span class="token operator">+=</span> OnUpdate<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Relying on the fact that toolbar is ScriptableObject and gets deleted when layout changes</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>m_currentToolbar <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// Find toolbar</span>
            <span class="token class-name"><span class="token keyword">var</span></span> toolbars <span class="token operator">=</span> Resources<span class="token punctuation">.</span><span class="token function">FindObjectsOfTypeAll</span><span class="token punctuation">(</span>m_toolbarType<span class="token punctuation">)</span><span class="token punctuation">;</span>
            m_currentToolbar <span class="token operator">=</span> toolbars<span class="token punctuation">.</span>Length <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">?</span> <span class="token punctuation">(</span>ScriptableObject<span class="token punctuation">)</span>toolbars<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>m_currentToolbar <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
<span class="token preprocessor property">#<span class="token directive keyword">if</span> UNITY_2021_1_OR_NEWER</span>
                <span class="token class-name"><span class="token keyword">var</span></span> root <span class="token operator">=</span> m_currentToolbar<span class="token punctuation">.</span><span class="token function">GetType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetField</span><span class="token punctuation">(</span><span class="token string">"m_Root"</span><span class="token punctuation">,</span> BindingFlags<span class="token punctuation">.</span>NonPublic <span class="token operator">|</span> BindingFlags<span class="token punctuation">.</span>Instance<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">var</span></span> rawRoot <span class="token operator">=</span> root<span class="token punctuation">.</span><span class="token function">GetValue</span><span class="token punctuation">(</span>m_currentToolbar<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">var</span></span> mRoot <span class="token operator">=</span> rawRoot <span class="token keyword">as</span> <span class="token class-name">VisualElement</span><span class="token punctuation">;</span>
                <span class="token function">RegisterCallback</span><span class="token punctuation">(</span><span class="token string">"ToolbarZoneLeftAlign"</span><span class="token punctuation">,</span> OnToolbarGUILeft<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">RegisterCallback</span><span class="token punctuation">(</span><span class="token string">"ToolbarZoneRightAlign"</span><span class="token punctuation">,</span> OnToolbarGUIRight<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">RegisterCallback</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> root<span class="token punctuation">,</span> <span class="token class-name">Action</span> cb<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token class-name"><span class="token keyword">var</span></span> toolbarZone <span class="token operator">=</span> mRoot<span class="token punctuation">.</span><span class="token function">Q</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token class-name"><span class="token keyword">var</span></span> parent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">VisualElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        style <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
                                flexGrow <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
                                flexDirection <span class="token operator">=</span> FlexDirection<span class="token punctuation">.</span>Row<span class="token punctuation">,</span>
                            <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">;</span>
                    <span class="token class-name"><span class="token keyword">var</span></span> container <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">IMGUIContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    container<span class="token punctuation">.</span>style<span class="token punctuation">.</span>flexGrow <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                    container<span class="token punctuation">.</span>onGUIHandler <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
                    <span class="token punctuation">{<!-- --></span>
                        cb<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span><span class="token punctuation">;</span>
                    parent<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>container<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    toolbarZone<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
<span class="token preprocessor property">#<span class="token directive keyword">else</span></span>
<span class="token preprocessor property">#<span class="token directive keyword">if</span> UNITY_2020_1_OR_NEWER</span>
<span class="token class-name"><span class="token keyword">var</span></span> windowBackend <span class="token operator">=</span> m_windowBackend<span class="token punctuation">.</span><span class="token function">GetValue</span><span class="token punctuation">(</span>m_currentToolbar<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">// Get it's visual tree</span>
<span class="token class-name"><span class="token keyword">var</span></span> visualTree <span class="token operator">=</span> <span class="token punctuation">(</span>VisualElement<span class="token punctuation">)</span> m_viewVisualTree<span class="token punctuation">.</span><span class="token function">GetValue</span><span class="token punctuation">(</span>windowBackend<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">else</span></span>
                    <span class="token comment">// Get it's visual tree</span>
                    <span class="token class-name"><span class="token keyword">var</span></span> visualTree <span class="token operator">=</span> <span class="token punctuation">(</span>VisualElement<span class="token punctuation">)</span>m_viewVisualTree<span class="token punctuation">.</span><span class="token function">GetValue</span><span class="token punctuation">(</span>m_currentToolbar<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">endif</span></span>

                    <span class="token comment">// Get first child which 'happens' to be toolbar IMGUIContainer</span>
                    <span class="token class-name"><span class="token keyword">var</span></span> container <span class="token operator">=</span> <span class="token punctuation">(</span>IMGUIContainer<span class="token punctuation">)</span>visualTree<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

                    <span class="token comment">// (Re)attach handler</span>
                    <span class="token class-name"><span class="token keyword">var</span></span> handler <span class="token operator">=</span> <span class="token punctuation">(</span>Action<span class="token punctuation">)</span>m_imguiContainerOnGui<span class="token punctuation">.</span><span class="token function">GetValue</span><span class="token punctuation">(</span>container<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    handler <span class="token operator">-=</span> OnGUI<span class="token punctuation">;</span>
                    handler <span class="token operator">+=</span> OnGUI<span class="token punctuation">;</span>
                    m_imguiContainerOnGui<span class="token punctuation">.</span><span class="token function">SetValue</span><span class="token punctuation">(</span>container<span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token preprocessor property">#<span class="token directive keyword">endif</span></span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnGUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name"><span class="token keyword">var</span></span> handler <span class="token operator">=</span> OnToolbarGUI<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>handler <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">InitializeOnLoad</span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">UnityEditorToolbar</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">static</span> <span class="token class-name"><span class="token keyword">int</span></span> m_toolCount<span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token class-name">GUIStyle</span> m_commandStyle <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">readonly</span> <span class="token class-name">List<span class="token punctuation">&lt;</span>Action<span class="token punctuation">&gt;</span></span> LeftToolbarGUI <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Action<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">readonly</span> <span class="token class-name">List<span class="token punctuation">&lt;</span>Action<span class="token punctuation">&gt;</span></span> RightToolbarGUI <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Action<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token function">UnityEditorToolbar</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Type</span> toolbarType <span class="token operator">=</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">UnityEditor<span class="token punctuation">.</span>Editor</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">.</span><span class="token function">GetType</span><span class="token punctuation">(</span><span class="token string">"UnityEditor.Toolbar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token preprocessor property">#<span class="token directive keyword">if</span> UNITY_2019_1_OR_NEWER</span>
        <span class="token class-name"><span class="token keyword">string</span></span> fieldName <span class="token operator">=</span> <span class="token string">"k_ToolCount"</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">else</span></span>
<span class="token class-name"><span class="token keyword">string</span></span> fieldName <span class="token operator">=</span> <span class="token string">"s_ShownToolIcons"</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">endif</span></span>

        <span class="token class-name">FieldInfo</span> toolIcons <span class="token operator">=</span> toolbarType<span class="token punctuation">.</span><span class="token function">GetField</span><span class="token punctuation">(</span>fieldName<span class="token punctuation">,</span>
            BindingFlags<span class="token punctuation">.</span>Public <span class="token operator">|</span> BindingFlags<span class="token punctuation">.</span>NonPublic <span class="token operator">|</span> BindingFlags<span class="token punctuation">.</span>Static<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token preprocessor property">#<span class="token directive keyword">if</span> UNITY_2019_3_OR_NEWER</span>
        m_toolCount <span class="token operator">=</span> toolIcons <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token punctuation">?</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>toolIcons<span class="token punctuation">.</span><span class="token function">GetValue</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">elif</span> UNITY_2019_1_OR_NEWER</span>
m_toolCount <span class="token operator">=</span> toolIcons <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token punctuation">?</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> toolIcons<span class="token punctuation">.</span><span class="token function">GetValue</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">elif</span> UNITY_2018_1_OR_NEWER</span>
m_toolCount <span class="token operator">=</span> toolIcons <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token punctuation">?</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Array<span class="token punctuation">)</span> toolIcons<span class="token punctuation">.</span><span class="token function">GetValue</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Length <span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">else</span></span>
m_toolCount <span class="token operator">=</span> toolIcons <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token punctuation">?</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Array<span class="token punctuation">)</span> toolIcons<span class="token punctuation">.</span><span class="token function">GetValue</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Length <span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">endif</span></span>

        ToolbarCallback<span class="token punctuation">.</span>OnToolbarGUI <span class="token operator">=</span> OnGUI<span class="token punctuation">;</span>
        ToolbarCallback<span class="token punctuation">.</span>OnToolbarGUILeft <span class="token operator">=</span> GUILeft<span class="token punctuation">;</span>
        ToolbarCallback<span class="token punctuation">.</span>OnToolbarGUIRight <span class="token operator">=</span> GUIRight<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token preprocessor property">#<span class="token directive keyword">if</span> UNITY_2019_3_OR_NEWER</span>
    <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">float</span></span> space <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">else</span></span>
<span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">float</span></span> space <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">endif</span></span>
    <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">float</span></span> largeSpace <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">float</span></span> buttonWidth <span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">float</span></span> dropdownWidth <span class="token operator">=</span> <span class="token number">80</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">if</span> UNITY_2019_1_OR_NEWER</span>
    <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">float</span></span> playPauseStopWidth <span class="token operator">=</span> <span class="token number">140</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">else</span></span>
<span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">float</span></span> playPauseStopWidth <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">endif</span></span>

    <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnGUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Create two containers, left and right</span>
        <span class="token comment">// Screen is whole toolbar</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>m_commandStyle <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            m_commandStyle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">GUIStyle</span><span class="token punctuation">(</span><span class="token string">"CommandLeft"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name"><span class="token keyword">var</span></span> screenWidth <span class="token operator">=</span> EditorGUIUtility<span class="token punctuation">.</span>currentViewWidth<span class="token punctuation">;</span>

        <span class="token comment">// Following calculations match code reflected from Toolbar.OldOnGUI()</span>
        <span class="token class-name"><span class="token keyword">float</span></span> playButtonsPosition <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">RoundToInt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>screenWidth <span class="token operator">-</span> playPauseStopWidth<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Rect</span> leftRect <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> screenWidth<span class="token punctuation">,</span> Screen<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
        leftRect<span class="token punctuation">.</span>xMin <span class="token operator">+=</span> space<span class="token punctuation">;</span> <span class="token comment">// Spacing left</span>
        leftRect<span class="token punctuation">.</span>xMin <span class="token operator">+=</span> buttonWidth <span class="token operator">*</span> m_toolCount<span class="token punctuation">;</span> <span class="token comment">// Tool buttons</span>
<span class="token preprocessor property">#<span class="token directive keyword">if</span> UNITY_2019_3_OR_NEWER</span>
        leftRect<span class="token punctuation">.</span>xMin <span class="token operator">+=</span> space<span class="token punctuation">;</span> <span class="token comment">// Spacing between tools and pivot</span>
<span class="token preprocessor property">#<span class="token directive keyword">else</span></span>
leftRect<span class="token punctuation">.</span>xMin <span class="token operator">+=</span> largeSpace<span class="token punctuation">;</span> <span class="token comment">// Spacing between tools and pivot</span>
<span class="token preprocessor property">#<span class="token directive keyword">endif</span></span>
        leftRect<span class="token punctuation">.</span>xMin <span class="token operator">+=</span> <span class="token number">64</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">// Pivot buttons</span>
        leftRect<span class="token punctuation">.</span>xMax <span class="token operator">=</span> playButtonsPosition<span class="token punctuation">;</span>

        <span class="token class-name">Rect</span> rightRect <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Rect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> screenWidth<span class="token punctuation">,</span> Screen<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
        rightRect<span class="token punctuation">.</span>xMin <span class="token operator">=</span> playButtonsPosition<span class="token punctuation">;</span>
        rightRect<span class="token punctuation">.</span>xMin <span class="token operator">+=</span> m_commandStyle<span class="token punctuation">.</span>fixedWidth <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">// Play buttons</span>
        rightRect<span class="token punctuation">.</span>xMax <span class="token operator">=</span> screenWidth<span class="token punctuation">;</span>
        rightRect<span class="token punctuation">.</span>xMax <span class="token operator">-=</span> space<span class="token punctuation">;</span> <span class="token comment">// Spacing right</span>
        rightRect<span class="token punctuation">.</span>xMax <span class="token operator">-=</span> dropdownWidth<span class="token punctuation">;</span> <span class="token comment">// Layout</span>
        rightRect<span class="token punctuation">.</span>xMax <span class="token operator">-=</span> space<span class="token punctuation">;</span> <span class="token comment">// Spacing between layout and layers</span>
        rightRect<span class="token punctuation">.</span>xMax <span class="token operator">-=</span> dropdownWidth<span class="token punctuation">;</span> <span class="token comment">// Layers</span>
<span class="token preprocessor property">#<span class="token directive keyword">if</span> UNITY_2019_3_OR_NEWER</span>
        rightRect<span class="token punctuation">.</span>xMax <span class="token operator">-=</span> space<span class="token punctuation">;</span> <span class="token comment">// Spacing between layers and account</span>
<span class="token preprocessor property">#<span class="token directive keyword">else</span></span>
rightRect<span class="token punctuation">.</span>xMax <span class="token operator">-=</span> largeSpace<span class="token punctuation">;</span> <span class="token comment">// Spacing between layers and account</span>
<span class="token preprocessor property">#<span class="token directive keyword">endif</span></span>
        rightRect<span class="token punctuation">.</span>xMax <span class="token operator">-=</span> dropdownWidth<span class="token punctuation">;</span> <span class="token comment">// Account</span>
        rightRect<span class="token punctuation">.</span>xMax <span class="token operator">-=</span> space<span class="token punctuation">;</span> <span class="token comment">// Spacing between account and cloud</span>
        rightRect<span class="token punctuation">.</span>xMax <span class="token operator">-=</span> buttonWidth<span class="token punctuation">;</span> <span class="token comment">// Cloud</span>
        rightRect<span class="token punctuation">.</span>xMax <span class="token operator">-=</span> space<span class="token punctuation">;</span> <span class="token comment">// Spacing between cloud and collab</span>
        rightRect<span class="token punctuation">.</span>xMax <span class="token operator">-=</span> <span class="token number">78</span><span class="token punctuation">;</span> <span class="token comment">// Colab</span>

        <span class="token comment">// Add spacing around existing controls</span>
        leftRect<span class="token punctuation">.</span>xMin <span class="token operator">+=</span> space<span class="token punctuation">;</span>
        leftRect<span class="token punctuation">.</span>xMax <span class="token operator">-=</span> space<span class="token punctuation">;</span>
        rightRect<span class="token punctuation">.</span>xMin <span class="token operator">+=</span> space<span class="token punctuation">;</span>
        rightRect<span class="token punctuation">.</span>xMax <span class="token operator">-=</span> space<span class="token punctuation">;</span>

        <span class="token comment">// Add top and bottom margins</span>
<span class="token preprocessor property">#<span class="token directive keyword">if</span> UNITY_2019_3_OR_NEWER</span>
        leftRect<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
        leftRect<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">22</span><span class="token punctuation">;</span>
        rightRect<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
        rightRect<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">22</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">else</span></span>
leftRect<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
leftRect<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">24</span><span class="token punctuation">;</span>
rightRect<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
rightRect<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">24</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">endif</span></span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>leftRect<span class="token punctuation">.</span>width <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            GUILayout<span class="token punctuation">.</span><span class="token function">BeginArea</span><span class="token punctuation">(</span>leftRect<span class="token punctuation">)</span><span class="token punctuation">;</span>
            GUILayout<span class="token punctuation">.</span><span class="token function">BeginHorizontal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> handler <span class="token keyword">in</span> LeftToolbarGUI<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            GUILayout<span class="token punctuation">.</span><span class="token function">EndHorizontal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            GUILayout<span class="token punctuation">.</span><span class="token function">EndArea</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>rightRect<span class="token punctuation">.</span>width <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            GUILayout<span class="token punctuation">.</span><span class="token function">BeginArea</span><span class="token punctuation">(</span>rightRect<span class="token punctuation">)</span><span class="token punctuation">;</span>
            GUILayout<span class="token punctuation">.</span><span class="token function">BeginHorizontal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> handler <span class="token keyword">in</span> RightToolbarGUI<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            GUILayout<span class="token punctuation">.</span><span class="token function">EndHorizontal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            GUILayout<span class="token punctuation">.</span><span class="token function">EndArea</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">GUILeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        GUILayout<span class="token punctuation">.</span><span class="token function">BeginHorizontal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> handler <span class="token keyword">in</span> LeftToolbarGUI<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        GUILayout<span class="token punctuation">.</span><span class="token function">EndHorizontal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">GUIRight</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        GUILayout<span class="token punctuation">.</span><span class="token function">BeginHorizontal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> handler <span class="token keyword">in</span> RightToolbarGUI<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        GUILayout<span class="token punctuation">.</span><span class="token function">EndHorizontal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/5beace3be4804d158bae59bd09c0828f.png#pic_center"/>
    </p>
    <p>
     svn工具辅助类 SVNHelper
    </p>
    <pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>Win32</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Diagnostics</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>IO</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEditor</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">SVNHelper</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//Log</span>
    <span class="token punctuation">[</span><span class="token function">MenuItem</span><span class="token punctuation">(</span><span class="token string">"Assets/SVN/日志"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">RightClickLog</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name"><span class="token keyword">var</span></span> path <span class="token operator">=</span> <span class="token function">MySelectActiveObj</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">StartSvnProc</span><span class="token punctuation">(</span><span class="token string">"log"</span><span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//更新</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">MenuItem</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Assets/SVN/更新"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">RightClickUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name"><span class="token keyword">var</span></span> path <span class="token operator">=</span> <span class="token function">MySelectActiveObj</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">StartSvnProc</span><span class="token punctuation">(</span><span class="token string">"update"</span><span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//提交</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">MenuItem</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Assets/SVN/提交"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">RightClickCommit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name"><span class="token keyword">var</span></span> path<span class="token operator">=</span> <span class="token function">MySelectActiveObj</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">StartSvnProc</span><span class="token punctuation">(</span><span class="token string">"commit"</span><span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 获取选中的对象</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">MySelectActiveObj</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>       
        <span class="token class-name"><span class="token keyword">var</span></span> selectedObjects <span class="token operator">=</span> Selection<span class="token punctuation">.</span>objects<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>selectedObjects<span class="token punctuation">.</span>Length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> obj <span class="token keyword">in</span> selectedObjects<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 检查选定对象是否是文件夹</span>
                <span class="token class-name"><span class="token keyword">string</span></span> path <span class="token operator">=</span> AssetDatabase<span class="token punctuation">.</span><span class="token function">GetAssetPath</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>AssetDatabase<span class="token punctuation">.</span><span class="token function">IsValidFolder</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token class-name"><span class="token keyword">string</span></span> target <span class="token operator">=</span> Application<span class="token punctuation">.</span>dataPath<span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token string">"Assets"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token operator">+</span>path<span class="token punctuation">;</span>
                    <span class="token keyword">return</span> target<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">StartSvnProc</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> cmd<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> path<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> url <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">bool</span></span> closeOnEnd <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token class-name"><span class="token keyword">string</span></span> logMsg <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">ProcessStartInfo</span> startInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ProcessStartInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">if</span> UNITY_EDITOR_WIN</span>
        <span class="token class-name"><span class="token keyword">var</span></span> tortoiseProcPath <span class="token operator">=</span> <span class="token function">GetTortoiseProcSvnPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>tortoiseProcPath<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            UnityEngine<span class="token punctuation">.</span>Debug<span class="token punctuation">.</span><span class="token function">LogError</span><span class="token punctuation">(</span><span class="token string">"TortoiseProc未找到"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        startInfo<span class="token punctuation">.</span>FileName <span class="token operator">=</span> tortoiseProcPath<span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>cmd<span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">"commit"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>logMsg<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span>
                startInfo<span class="token punctuation">.</span>Arguments <span class="token operator">=</span>
                    <span class="token interpolation-string"><span class="token string">$"/command:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">cmd</span><span class="token punctuation">}</span></span><span class="token string"> /path:\"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">path</span><span class="token punctuation">}</span></span><span class="token string">\" /logmsg:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">logMsg</span><span class="token punctuation">}</span></span><span class="token string"> /closeonend:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp"><span class="token punctuation">(</span>closeOnEnd <span class="token punctuation">?</span> <span class="token number">2</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span></span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">;</span>
            <span class="token keyword">else</span>
                startInfo<span class="token punctuation">.</span>Arguments <span class="token operator">=</span>
                    <span class="token interpolation-string"><span class="token string">$"/command:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">cmd</span><span class="token punctuation">}</span></span><span class="token string"> /path:\"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">path</span><span class="token punctuation">}</span></span><span class="token string">\" /url:\"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">url</span><span class="token punctuation">}</span></span><span class="token string">\" /logmsg:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">logMsg</span><span class="token punctuation">}</span></span><span class="token string"> /closeonend:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp"><span class="token punctuation">(</span>closeOnEnd <span class="token punctuation">?</span> <span class="token number">2</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span></span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span>
                startInfo<span class="token punctuation">.</span>Arguments <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$"/command:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">cmd</span><span class="token punctuation">}</span></span><span class="token string"> /path:\"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">path</span><span class="token punctuation">}</span></span><span class="token string">\" /closeonend:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp"><span class="token punctuation">(</span>closeOnEnd <span class="token punctuation">?</span> <span class="token number">2</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span></span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">;</span>
            <span class="token keyword">else</span>
                startInfo<span class="token punctuation">.</span>Arguments <span class="token operator">=</span>
                    <span class="token interpolation-string"><span class="token string">$"/command:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">cmd</span><span class="token punctuation">}</span></span><span class="token string"> /path:\"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">path</span><span class="token punctuation">}</span></span><span class="token string">\" /url:\"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">url</span><span class="token punctuation">}</span></span><span class="token string">\" /closeonend:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp"><span class="token punctuation">(</span>closeOnEnd <span class="token punctuation">?</span> <span class="token number">2</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span></span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        startInfo<span class="token punctuation">.</span>RedirectStandardOutput <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        startInfo<span class="token punctuation">.</span>UseShellExecute <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

<span class="token preprocessor property">#<span class="token directive keyword">elif</span> UNITY_EDITOR_OSX</span>
        startInfo<span class="token punctuation">.</span>CreateNoWindow <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        startInfo<span class="token punctuation">.</span>ErrorDialog <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        startInfo<span class="token punctuation">.</span>UseShellExecute <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        startInfo<span class="token punctuation">.</span>FileName <span class="token operator">=</span> <span class="token string">"/usr/local/bin/svn"</span><span class="token punctuation">;</span>
        startInfo<span class="token punctuation">.</span>Arguments <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">cmd</span><span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">url</span><span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">path</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">;</span>
        startInfo<span class="token punctuation">.</span>RedirectStandardOutput <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        UnityEngine<span class="token punctuation">.</span>Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">"start process = "</span> <span class="token operator">+</span> startInfo<span class="token punctuation">.</span>Arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token preprocessor property">#<span class="token directive keyword">endif</span></span>
        <span class="token class-name">Process</span> svnUpProcess <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        svnUpProcess<span class="token punctuation">.</span>StartInfo <span class="token operator">=</span> startInfo<span class="token punctuation">;</span>
        svnUpProcess<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        svnUpProcess<span class="token punctuation">.</span><span class="token function">WaitForExit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">string</span></span> output <span class="token operator">=</span> svnUpProcess<span class="token punctuation">.</span>StandardOutput<span class="token punctuation">.</span><span class="token function">ReadToEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        UnityEngine<span class="token punctuation">.</span>Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">"process output = "</span> <span class="token operator">+</span> output<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name"><span class="token keyword">var</span></span> exitCode <span class="token operator">=</span> svnUpProcess<span class="token punctuation">.</span>ExitCode<span class="token punctuation">;</span>
        svnUpProcess<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        AssetDatabase<span class="token punctuation">.</span><span class="token function">Refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> exitCode<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">GetTortoiseProcSvnPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">RegistryKey</span> key <span class="token operator">=</span> RegistryKey<span class="token punctuation">.</span><span class="token function">OpenBaseKey</span><span class="token punctuation">(</span>RegistryHive<span class="token punctuation">.</span>LocalMachine<span class="token punctuation">,</span> RegistryView<span class="token punctuation">.</span>Default<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">var</span></span> path <span class="token operator">=</span> key<span class="token punctuation">.</span><span class="token function">OpenSubKey</span><span class="token punctuation">(</span><span class="token string">"SOFTWARE"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">OpenSubKey</span><span class="token punctuation">(</span><span class="token string">"TortoiseSVN"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetValue</span><span class="token punctuation">(</span><span class="token string">"ProcPath"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> path<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> vols <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">,</span> <span class="token string">"E"</span><span class="token punctuation">,</span> <span class="token string">"F"</span><span class="token punctuation">,</span> <span class="token string">"G"</span><span class="token punctuation">,</span> <span class="token string">"H"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> dirs <span class="token operator">=</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token string">@"Program Files"</span><span class="token punctuation">,</span>
                <span class="token string">@"Program Files (x86)"</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>

            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> vol <span class="token keyword">in</span> vols<span class="token punctuation">)</span>
                <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> dir <span class="token keyword">in</span> dirs<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token class-name"><span class="token keyword">string</span></span> file <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">vol</span><span class="token punctuation">}</span></span><span class="token string">:\\</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">dir</span><span class="token punctuation">}</span></span><span class="token string">\\TortoiseSVN\\bin\\TortoiseProc.exe"</span></span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>File<span class="token punctuation">.</span><span class="token function">Exists</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">)</span>
                        <span class="token keyword">return</span> file<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     git工具辅助类 GitHelper
    </p>
    <pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>Win32</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Diagnostics</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEditor</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GitHelper</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">StartGitProc</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> cmd<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> path<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> outPath <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name"><span class="token keyword">string</span></span> gitProcPath <span class="token operator">=</span> <span class="token function">GetTortoiseGitProcPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>gitProcPath<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            UnityEngine<span class="token punctuation">.</span>Debug<span class="token punctuation">.</span><span class="token function">LogError</span><span class="token punctuation">(</span><span class="token string">"TortoiseGitProc未找到"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">ProcessStartInfo</span> startInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ProcessStartInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        startInfo<span class="token punctuation">.</span>FileName <span class="token operator">=</span> gitProcPath<span class="token punctuation">;</span>
        startInfo<span class="token punctuation">.</span>Arguments <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$"/command:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">cmd</span><span class="token punctuation">}</span></span><span class="token string"> /path:\"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">path</span><span class="token punctuation">}</span></span><span class="token string">\"/closeonend:2"</span></span><span class="token punctuation">;</span>

        <span class="token class-name">Process</span> gitProcess <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        gitProcess<span class="token punctuation">.</span>StartInfo <span class="token operator">=</span> startInfo<span class="token punctuation">;</span>
        gitProcess<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        gitProcess<span class="token punctuation">.</span><span class="token function">WaitForExit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>gitProcess<span class="token punctuation">.</span>ExitCode <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            EditorUtility<span class="token punctuation">.</span><span class="token function">DisplayDialog</span><span class="token punctuation">(</span><span class="token string">"提示"</span><span class="token punctuation">,</span> <span class="token interpolation-string"><span class="token string">$"git </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">cmd</span><span class="token punctuation">}</span></span><span class="token string"> exit with code:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">gitProcess<span class="token punctuation">.</span>ExitCode</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> <span class="token string">"确定"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">GetTortoiseGitProcPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">RegistryKey</span> key <span class="token operator">=</span> RegistryKey<span class="token punctuation">.</span><span class="token function">OpenBaseKey</span><span class="token punctuation">(</span>RegistryHive<span class="token punctuation">.</span>LocalMachine<span class="token punctuation">,</span> RegistryView<span class="token punctuation">.</span>Default<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">var</span></span> path <span class="token operator">=</span> key<span class="token punctuation">.</span><span class="token function">OpenSubKey</span><span class="token punctuation">(</span><span class="token string">"SOFTWARE"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">OpenSubKey</span><span class="token punctuation">(</span><span class="token string">"TortoiseGit"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetValue</span><span class="token punctuation">(</span><span class="token string">"ProcPath"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> path<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470:733a2f2f626c6f672e6373646e2e6e65742f53656e6453492f:61727469636c652f64657461696c732f313436313734343738" class_="artid" style="display:none">
 </p>
</div>


