---
layout: post
title: "Node-RED基础1"
date: 2025-03-12 23:22:43 +0800
description: "NodeRed简介，安装、基础应用（基本功能、通讯、数据、节点）"
keywords: "Node-RED基础1"
categories: ['未分类']
tags: ['集成测试', '物联网', '低代码']
artid: "145602865"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=145602865
    alt: "Node-RED基础1"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=145602865
featuredImagePreview: https://bing.ee123.net/img/rand?artid=145602865
cover: https://bing.ee123.net/img/rand?artid=145602865
image: https://bing.ee123.net/img/rand?artid=145602865
img: https://bing.ee123.net/img/rand?artid=145602865
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Node-RED基础1
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-tomorrow-night-eighties" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <h2>
     <a id="_2">
     </a>
     一、概述
    </h2>
    <p>
     <strong>
      Rode-Red是什么？
     </strong>
    </p>
    <ul>
     <li>
      基于Node.js的物联网开发工具，做API、通讯；
     </li>
     <li>
      提供了一些基本的监控功能，可在编辑器界面中查看节点的运行状态、消息流量等信息。
     </li>
     <li>
      通过安装一些额外的节点或使用外部监控工具来实现更详细的监控和管理，
     </li>
    </ul>
    <p>
     例如：监控数据处理的性能指标、数据传输的成功率等。
    </p>
    <p>
     <strong>
      Node.js是什么？
     </strong>
    </p>
    <ul>
     <li>
      基于谷歌V8引擎的JavaScript运行环境（底层环境）
      <a href="https://nodejs.org/zh-cn" rel="nofollow">
       点击安装
      </a>
      <br/>
      <img alt="安装完成" src="https://i-blog.csdnimg.cn/direct/1a133469754a434a89750ca573ebefe1.png"/>
     </li>
    </ul>
    <p>
     <strong>
      PM2是什么？
     </strong>
    </p>
    <ul>
     <li>
      实时管理JavaScript应用（包括Node-red）的进程工具；
     </li>
     <li>
      基于PM2部署的Node-red进行PLC（MQTT）数据采集转发可以确保其7x24h稳定运行。
     </li>
    </ul>
    <hr/>
    <h2>
     <a id="_20">
     </a>
     二、安装
    </h2>
    <ul>
     <li>
      <strong>
       安装：
      </strong>
      安装node.js，安装pm2（
      <a href="https://blog.csdn.net/qq_43067585/article/details/126478322">
       是什么？
      </a>
      ）
      <code>
       npm install pm2 -g
      </code>
      ，基于pm2安装Node-Red
      <code>
       npm install -g--unsafe perm node-red pm2 pm2-windows-startup pm2-windows-service
      </code>
      ；
     </li>
     <li>
      <strong>
       启动：
      </strong>
      在命令行中输入node-red启动 Node-RED 服务（临时调试；关闭CMD窗口会停止服务）
     </li>
     <li>
      <strong>
       自启动：
      </strong>
      在开始菜单
      <code>
       C:\ProgramData\Microsoft\Windows\Start Menu
      </code>
      路径下建立.bat文件
      <code>
       pm2 start C:\Users\Administrator\AppData\Roaming\npm\node_modules\node-red\red.js
      </code>
      开机自动启动服务
     </li>
     <li>
      <strong>
       打开：
      </strong>
      通过浏览器访问
      <code>
       http://localhost:1880
      </code>
     </li>
     <li>
      <strong>
       创建：
      </strong>
      输入—响应—输出
     </li>
     <li>
      <strong>
       运行：
      </strong>
      点击 Node-RED 编辑器右上角的 “部署” 按钮，将流程部署到运行环境中。此时，数据管道就开始按照设定的流程运行，接收输入数据，进行处理和存储，并根据需要输出响应。
     </li>
     <li>
      <strong>
       分析：
      </strong>
      监控数据处理的性能指标、数据传输的成功率等。
     </li>
    </ul>
    <hr/>
    <h2>
     <a id="_31">
     </a>
     三、基操
    </h2>
    <p>
     <strong>
      前提
     </strong>
    </p>
    <ul>
     <li>
      运行服务
     </li>
     <li>
      浏览器
      <code>
       http://localhost:1880
      </code>
     </li>
    </ul>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/a88cda30bbf84a3c8076c23db6841cde.png"/>
    </p>
    <p>
     <strong>
      概要
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       输入：
      </strong>
      <code>
       inject
      </code>
     </li>
     <li>
      <ul>
       <li>
        <strong>
         msg：
        </strong>
        Payload、topic、或自定义标题
       </li>
      </ul>
     </li>
     <li>
      <ul>
       <li>
        <strong>
         =值：
        </strong>
        二进制、环境变量、数字、文本、表达式、msg、时间戳、
       </li>
      </ul>
     </li>
     <li>
      <ul>
       <li>
        <strong>
         特别说明：
        </strong>
        JSON
        <code>
         { "num": 98, "name": "小王","yes":true}
        </code>
        …类似键值对格式（可循环嵌套）；
       </li>
      </ul>
     </li>
     <li>
      <strong>
       输出：
      </strong>
      <code>
       debug
      </code>
     </li>
     <li>
      <ul>
       <li>
        <strong>
         msg.
        </strong>
        <code>
         Payload.name
        </code>
        （与输入的msg标题对应）
       </li>
      </ul>
     </li>
     <li>
      <ul>
       <li>
        与调试输出相同
       </li>
      </ul>
     </li>
     <li>
      <strong>
       部署：
      </strong>
      每次更改必须
      <strong>
       部署
      </strong>
     </li>
     <li>
      <strong>
       注入：
      </strong>
      点击
      <strong>
       输入的左边小框
      </strong>
      该条指令即可输出内容
     </li>
     <li>
      <strong>
       组合：
      </strong>
      框选右击可组合命令
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/0bacaaf93ccc4c828ac983fbe6b3985d.png"/>
     </li>
    </ul>
    <p>
     <strong>
      1. Switch选择
     </strong>
    </p>
    <ul>
     <li>
      <code>
       inject
      </code>
      （数字）——
      <code>
       Switch
      </code>
      （添加域）——
      <code>
       debug1
      </code>
      、
      <code>
       debug2...
      </code>
      （选择输出）
     </li>
     <li>
      应用：输入的数字在相应域内选择当前域的输出
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/7180fd6d990949d1af9af27e612ebf4b.png"/>
     </li>
    </ul>
    <p>
     <strong>
      2. range缩放
     </strong>
    </p>
    <ul>
     <li>
      <code>
       inject
      </code>
      （数字）——
      <code>
       range
      </code>
      （缩放）——
      <code>
       debug
      </code>
     </li>
     <li>
      应用：根据输入值放大或缩小其倍数并输出（模数转换）
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/8e6b783be3b049a4929275af81329ed1.png"/>
     </li>
    </ul>
    <p>
     <strong>
      3. delay延迟
     </strong>
    </p>
    <ul>
     <li>
      <code>
       inject
      </code>
      （数字）——
      <code>
       delay
      </code>
      （延迟）——
      <code>
       debug
      </code>
     </li>
     <li>
      应用：延迟输出
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/963c59150d6d4ba283e3250116da092b.png"/>
     </li>
    </ul>
    <p>
     <strong>
      4. trigger触发
     </strong>
    </p>
    <ul>
     <li>
      <code>
       inject
      </code>
      （数字）——
      <code>
       trigger
      </code>
      （触发）——
      <code>
       debug
      </code>
     </li>
     <li>
      应用：触发输出
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/fda2f9476c2a40c0bfa27c3424a532a9.png"/>
     </li>
    </ul>
    <p>
     <strong>
      5. change更改
     </strong>
    </p>
    <ul>
     <li>
      <code>
       inject
      </code>
      ——
      <code>
       change
      </code>
      （增删改移消息msg.topic）——
      <code>
       debug
      </code>
     </li>
     <li>
      应用：对Payload消息进行操作控制、删除、修改、移动设定等；
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/52dac408a8d647bfabbe7731724aac9f.png"/>
     </li>
    </ul>
    <p>
     <strong>
      6. loop循环
     </strong>
    </p>
    <ul>
     <li>
      <code>
       inject
      </code>
      ——
      <code>
       function
      </code>
      ——
      <code>
       loop
      </code>
      ===
      <code>
       function
      </code>
      ——
      <code>
       debug
      </code>
     </li>
     <li>
      loop 固定循环次数Fixed Count
     </li>
     <li>
      loop 条件判断输出Condition
     </li>
     <li>
      loop 遍历function对象Enumeration
     </li>
     <li>
      应用：循环处理事件
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/f8e20964084d4187a62d718fa072c542.png"/>
     </li>
    </ul>
    <p>
     <strong>
      7.link跳转
     </strong>
    </p>
    <ul>
     <li>
      <code>
       inject
      </code>
      ——
      <code>
       link out
      </code>
     </li>
     <li>
      <code>
       link in
      </code>
      (link1)——
      <code>
       Debug
      </code>
     </li>
     <li>
      应用：省略流程的连线，视觉简化；可多个in、out互联
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/aa9d9ad8aa4143049e4b4e20bb2a7f34.png"/>
     </li>
    </ul>
    <hr/>
    <h2>
     <a id="_90">
     </a>
     四、通讯
    </h2>
    <p>
     <strong>
      1. tcp链接
     </strong>
    </p>
    <ul>
     <li>
      TCP调试工具（Client、Server、UDP）
     </li>
     <li>
      TCP接收信息：
      <code>
       tcp in
      </code>
      ——
      <code>
       debug
      </code>
     </li>
     <li>
      TCP发送信息：
      <code>
       tcp out
      </code>
      ——
      <code>
       debug
      </code>
     </li>
     <li>
      作Server：监听，只需配置端口号（IP为主机网卡地址）
     </li>
     <li>
      作Client：连接，输入主机IP、端口号即可
     </li>
     <li>
      应用：TCP通讯传输数据
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/4826b691e59541779b9759e194876c2c.png"/>
     </li>
    </ul>
    <p>
     <strong>
      2. UDP链接
     </strong>
    </p>
    <ul>
     <li>
      TCP调试助手（UDP）
     </li>
     <li>
      发送信息到UDP本地：
      <code>
       inject
      </code>
      ——
      <code>
       udp out
      </code>
      （本地IP、端口）
     </li>
     <li>
      从UDP本地接收信息：
      <code>
       udp in
      </code>
      （远程IP&lt;网卡IP&gt;、端口）——
      <code>
       debug
      </code>
     </li>
     <li>
      应用：UDP通讯传输数据
     </li>
    </ul>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/a82177b4e9034fc6902b32e5096eb291.png"/>
    </p>
    <p>
     <strong>
      3. MQTT发布订阅
     </strong>
    </p>
    <ul>
     <li>
      <code>
       inject
      </code>
      ——
      <code>
       mqtt out
      </code>
      （服务端、发布主题）
     </li>
     <li>
      <code>
       mqtt in
      </code>
      ——
      <code>
       debug
      </code>
      （服务端、订阅主题）
     </li>
     <li>
      客户端发布 _
      <a href="http://www.taichi-maker.com/public-mqtt-broker/" rel="nofollow">
       公网Server
      </a>
      _客户端订阅
     </li>
     <li>
      客户端发布 _
      <a href="https://github.com/ges0062/GesMQTT">
       私有Server
      </a>
      _ 客户端订阅
     </li>
     <li>
      可用公网Server进行练习测试，也可自己开发Server端
      <a href="https://blog.csdn.net/weixin_38767017/article/details/145717959">
       MQTT开发
      </a>
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/31edaedb0240448aa808d8299e2f29b1.png"/>
     </li>
    </ul>
    <p>
     <strong>
      4. http请求
     </strong>
    </p>
    <ul>
     <li>
      <code>
       http in
      </code>
      （get）——
      <code>
       function
      </code>
      ——
      <code>
       http response
      </code>
     </li>
     <li>
      输入：请求方法（查数据用GET，添新用POST；全改旧用PUT，微调用PATCH；想删干净DELETE一下。）、URL地址
     </li>
     <li>
      应用：网址+URL 地址（http://localhost:1880/test）；
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/56973061382e404b9d5b8c087c3ec1ee.png"/>
     </li>
    </ul>
    <p>
     <strong>
      5. modbus通讯
     </strong>
    </p>
    <ul>
     <li>
      <code>
       modbus read
      </code>
      /write（modbus slave调试工具连接）——debug
     </li>
     <li>
      <code>
       modbus server
      </code>
      （modbus poll调试工具连接）——debug
     </li>
     <li>
      modbus：需要物理IP（非随意IP）
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/ebbfdb8580d344acbd64d27faf08ca48.png"/>
     </li>
    </ul>
    <hr/>
    <h2>
     <a id="_130">
     </a>
     五、数据
    </h2>
    <p>
     <strong>
      1. MySql数据库链接
     </strong>
    </p>
    <ul>
     <li>
      虚拟机安装Mysql数据库
      <a href="https://blog.csdn.net/xiang_qi_li/article/details/125366812">
       Mysql安装
      </a>
      ； 更改主机名为任意IP
      <a href="https://blog.csdn.net/ericwuhk/article/details/116697203">
       更改方法
      </a>
     </li>
     <li>
      主机安装Navicat客户端，测试连接成功
      <a href="https://www.fujieace.com/navicat/for-mysql-11.html" rel="nofollow">
       绝活哥
      </a>
      ； 新建数据库-表-插入测试内容；sql语句查询
     </li>
     <li>
      <code>
       inject
      </code>
      ——
      <code>
       mysql2
      </code>
      ——
      <code>
       debug
      </code>
     </li>
     <li>
      mysql2链接参数配置：主机名，端口，用户名，密码，数据库，表名 ； 查询语句Binds…：
      <code>
       select NAME FROM class1 WHERE ID=1;
      </code>
     </li>
     <li>
      应用：链接Mysql数据库进行增删改查
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/feb6af0c38d94f4b95be7b9794b9a260.png"/>
     </li>
    </ul>
    <p>
     <strong>
      2. 文件读写
     </strong>
    </p>
    <ul>
     <li>
      <code>
       inject
      </code>
      ——
      <code>
       写入文件
      </code>
      （路径：文件路径）
     </li>
     <li>
      <code>
       inject
      </code>
      ——
      <code>
       读取文件
      </code>
      ——
      <code>
       debug
      </code>
     </li>
     <li>
      <code>
       inject
      </code>
      ——
      <code>
       function
      </code>
      ——
      <code>
       写入文件
      </code>
      （msg.filename）
     </li>
     <li>
      function：msg.filename=“C:\Intel\test1.txt”（代码中的路径不能有中文；双斜杠&lt;单斜杠默认转译&gt;）
     </li>
     <li>
      输出：文件夹下新建文本文件，配置路径（复制粘贴路径）
     </li>
     <li>
      应用：查看文件文件写入内容；查看调试窗口内容
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/e252fcd88c0d4da68217e5fa3b3d32af.png"/>
     </li>
    </ul>
    <hr/>
    <h2>
     <a id="_150">
     </a>
     六、节点
    </h2>
    <ul>
     <li>
      节点管理
     </li>
     <li>
      搜索关键词即可安装
     </li>
     <li>
      <code>
       node-red-node-random
      </code>
      ：随机数
     </li>
     <li>
      <code>
       node-red-contrib-mysql2
      </code>
      ： MySQL数据库
     </li>
     <li>
      <code>
       node-red-contrib-modbus
      </code>
      ：MODBUS通讯
     </li>
     <li>
      <code>
       node-red-contrib-loop
      </code>
      ：loop循环
     </li>
     <li>
      <code>
       node-red-contrib-opcua
      </code>
      ：OPC UA通讯
     </li>
     <li>
      <code>
       node-red-contrib-s7
      </code>
      ：S7通讯
     </li>
     <li>
      <code>
       node-red-contrib-dashbored
      </code>
      ：Web控件
     </li>
     <li>
      <code>
       node-red-contrib-email
      </code>
      ：邮件发送
     </li>
    </ul>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/cb32721a0e214d7a957e49f7950f482a.png"/>
    </p>
    <hr/>
    <h2>
     <a id="__167">
     </a>
     七、 应用
    </h2>
    <p>
     <strong>
      1.企业微信机器人推送消息
     </strong>
    </p>
    <ul>
     <li>
      <code>
       inject
      </code>
      ——
      <code>
       function
      </code>
      （文本发送代码）——
      <code>
       http request
      </code>
      （post，API&lt;企业微信机器人Webhook&gt; ）
     </li>
     <li>
      逻辑思路：时间戳触发功能块（文本发送至企业微信消息代码）到http response的请求
      <code>
       post
      </code>
      的URL地址（机器人Webhook）
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/94935b0173a14d6e9d4785ddcaef9b28.png"/>
     </li>
    </ul>
    <p>
     function4代码：
     <a href="https://developer.work.weixin.qq.com/document/path/91770" rel="nofollow">
      群机器人配置说明
     </a>
    </p>
    <pre><code class="prism language-bash"><span class="token assign-left variable">msg.payload</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
    <span class="token string">"msgtype"</span><span class="token builtin class-name">:</span> <span class="token string">"text"</span>,
    <span class="token string">"text"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">"content"</span><span class="token builtin class-name">:</span> <span class="token string">"今日天气：29度，大部分多云，降雨概率：60%"</span>,
		<span class="token string">"mentioned_list"</span>:<span class="token punctuation">[</span><span class="token string">"小王"</span>,<span class="token string">"@all"</span><span class="token punctuation">]</span>,
		<span class="token string">"mentioned_mobile_list"</span>:<span class="token punctuation">[</span><span class="token string">"mobilenumber"</span>,<span class="token string">"@all"</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token builtin class-name">return</span> msg<span class="token punctuation">;</span>
</code></pre>
    <p>
     添加机器人：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/9f327077a9534660a6990127e179df57.png"/>
    </p>
    <p>
     <strong>
      2. 定时执行——过该时刻后5秒执行一个事件
     </strong>
    </p>
    <ul>
     <li>
      记录时刻：时间戳写入文件time
     </li>
     <li>
      逻辑思路：时间戳读取time文件的时间值，创建当前时间对象var newtime = new Date().Valueof()，与读取时间作差，为真执行输出；同时更新time文件的时间值
     </li>
    </ul>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/32e6701393e5413191828333bad561c6.png"/>
     <br/>
     function7代码片段:
    </p>
    <pre><code class="prism language-bash">var newtime <span class="token operator">=</span> new Date<span class="token punctuation">(</span><span class="token punctuation">)</span>.valueOf<span class="token punctuation">(</span><span class="token punctuation">)</span>  //获取当前时间值
<span class="token keyword">if</span> <span class="token punctuation">(</span>newtime - parseInt<span class="token punctuation">(</span>msg.payload<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">4</span>*1000<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>  //过4S执行一次
    msg.Flag <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>else<span class="token punctuation">{<!-- --></span>
    msg.Flag <span class="token operator">=</span>false
<span class="token punctuation">}</span>
</code></pre>
    <p>
     function8代码片段:
    </p>
    <pre><code class="prism language-bash">msg.payload <span class="token operator">=</span> new Date<span class="token punctuation">(</span><span class="token punctuation">)</span>.valueOf<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     <strong>
      3. 发送邮件
     </strong>
    </p>
    <ul>
     <li>
      <code>
       inject
      </code>
      ——
      <code>
       send email
      </code>
     </li>
     <li>
      host：发信服务器 (SMTP)，端口465
     </li>
     <li>
      secure：勾选
     </li>
     <li>
      user：发送的邮箱账号
     </li>
     <li>
      password：邮箱-安全设置-客户端专用密码
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/5900c735ee6f4ae5b363a0268366a843.png"/>
     </li>
    </ul>
    <hr/>
    <h2>
     <a id="END_221">
     </a>
     END
    </h2>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f33383736373031372f:61727469636c652f64657461696c732f313435363032383635" class_="artid" style="display:none">
 </p>
</div>


