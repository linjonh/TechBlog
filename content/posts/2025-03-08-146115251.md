---
layout: post
title: "æ·±åº¦å­¦ä¹ è®­ç»ƒCampç¬¬R5å‘¨å¤©æ°”é¢„æµ‹"
date: 2025-03-08 14:55:23 +0800
description: "å¤©æ°”é¢„æµ‹"
keywords: "æ·±åº¦å­¦ä¹ è®­ç»ƒCampï¼šç¬¬R5å‘¨ï¼šå¤©æ°”é¢„æµ‹"
categories: ['æœªåˆ†ç±»']
tags: ['æ·±åº¦å­¦ä¹ ', 'äººå·¥æ™ºèƒ½', 'Python']
artid: "146115251"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146115251
    alt: "æ·±åº¦å­¦ä¹ è®­ç»ƒCampç¬¬R5å‘¨å¤©æ°”é¢„æµ‹"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146115251
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146115251
cover: https://bing.ee123.net/img/rand?artid=146115251
image: https://bing.ee123.net/img/rand?artid=146115251
img: https://bing.ee123.net/img/rand?artid=146115251
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     æ·±åº¦å­¦ä¹ è®­ç»ƒCampï¼šç¬¬R5å‘¨ï¼šå¤©æ°”é¢„æµ‹
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <blockquote>
     <ul>
      <li>
       <strong>
        ğŸ¨ æœ¬æ–‡ä¸º
        <a href="https://mp.weixin.qq.com/s/rnFa-IeY93EpjVu0yzzjkw" rel="nofollow">
         ğŸ”—365å¤©æ·±åº¦å­¦ä¹ è®­ç»ƒè¥
        </a>
        ä¸­çš„å­¦ä¹ è®°å½•åšå®¢
       </strong>
      </li>
      <li>
       <strong>
        ğŸ– åŸä½œè€…ï¼š
        <a href="https://mtyjkh.blog.csdn.net/" rel="nofollow">
         KåŒå­¦å•Š
        </a>
       </strong>
      </li>
     </ul>
    </blockquote>
    <p>
     æœ¬å‘¨ä»»åŠ¡ï¼š
     <br/>
     ä»»åŠ¡è¯´æ˜ï¼šè¯¥æ•°æ®é›†æä¾›äº†æ¥è‡ªæ¾³å¤§åˆ©äºšè®¸å¤šåœ°ç‚¹çš„å¤§çº¦ 10 å¹´çš„æ¯æ—¥å¤©æ°”è§‚æµ‹æ•°æ®ã€‚ä½ éœ€è¦åšçš„æ˜¯æ ¹æ®è¿™äº›æ•°æ®å¯¹
     <code>
      RainTomorrow
     </code>
     è¿›è¡Œä¸€ä¸ªé¢„æµ‹ï¼Œè¿™æ¬¡ä»»åŠ¡ä»»åŠ¡ä¸ä»¥å¾€çš„ä¸åŒï¼Œæˆ‘å¢åŠ äº†æ¢ç´¢å¼æ•°æ®åˆ†æï¼ˆEDAï¼‰ï¼Œå¸Œæœ›è¿™éƒ¨åˆ†å†…å®¹å¯ä»¥å¸®åŠ©åˆ°å¤§å®¶ã€‚
    </p>
    <h2>
     <a id="_6">
     </a>
     ä¸€ã€å¯¼å…¥æ•°æ®
    </h2>
    <pre><code class="prism language-python"><span class="token keyword">from</span> datetime <span class="token keyword">import</span> date

<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> warnings
warnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">'ignore'</span><span class="token punctuation">)</span>

<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> MinMaxScaler

<span class="token keyword">import</span> torch
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>optim <span class="token keyword">as</span> optim
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>functional <span class="token keyword">as</span> F

file_path <span class="token operator">=</span> <span class="token string">'D:/OneDrive/code learning(python and matlab and latex)/365camp/data/weatherAUS.csv'</span>
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
df <span class="token operator">=</span> data<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     ä»£ç è¾“å‡ºï¼š
    </p>
    <pre><code class="prism language-python">         Date Location  MinTemp  MaxTemp  Rainfall  Evaporation  Sunshine  \
<span class="token number">0</span>  <span class="token number">2008</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">01</span>   Albury     <span class="token number">13.4</span>     <span class="token number">22.9</span>       <span class="token number">0.6</span>          NaN       NaN   
<span class="token number">1</span>  <span class="token number">2008</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">02</span>   Albury      <span class="token number">7.4</span>     <span class="token number">25.1</span>       <span class="token number">0.0</span>          NaN       NaN   
<span class="token number">2</span>  <span class="token number">2008</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">03</span>   Albury     <span class="token number">12.9</span>     <span class="token number">25.7</span>       <span class="token number">0.0</span>          NaN       NaN   
<span class="token number">3</span>  <span class="token number">2008</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">04</span>   Albury      <span class="token number">9.2</span>     <span class="token number">28.0</span>       <span class="token number">0.0</span>          NaN       NaN   
<span class="token number">4</span>  <span class="token number">2008</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">05</span>   Albury     <span class="token number">17.5</span>     <span class="token number">32.3</span>       <span class="token number">1.0</span>          NaN       NaN   
<span class="token number">5</span>  <span class="token number">2008</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">06</span>   Albury     <span class="token number">14.6</span>     <span class="token number">29.7</span>       <span class="token number">0.2</span>          NaN       NaN   
<span class="token number">6</span>  <span class="token number">2008</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">07</span>   Albury     <span class="token number">14.3</span>     <span class="token number">25.0</span>       <span class="token number">0.0</span>          NaN       NaN   
<span class="token number">7</span>  <span class="token number">2008</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">08</span>   Albury      <span class="token number">7.7</span>     <span class="token number">26.7</span>       <span class="token number">0.0</span>          NaN       NaN   
<span class="token number">8</span>  <span class="token number">2008</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">09</span>   Albury      <span class="token number">9.7</span>     <span class="token number">31.9</span>       <span class="token number">0.0</span>          NaN       NaN   
<span class="token number">9</span>  <span class="token number">2008</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">10</span>   Albury     <span class="token number">13.1</span>     <span class="token number">30.1</span>       <span class="token number">1.4</span>          NaN       NaN   

  WindGustDir  WindGustSpeed WindDir9am  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> Humidity9am  Humidity3pm  \
<span class="token number">0</span>           W           <span class="token number">44.0</span>          W  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        <span class="token number">71.0</span>         <span class="token number">22.0</span>   
<span class="token number">1</span>         WNW           <span class="token number">44.0</span>        NNW  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        <span class="token number">44.0</span>         <span class="token number">25.0</span>   
<span class="token number">2</span>         WSW           <span class="token number">46.0</span>          W  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        <span class="token number">38.0</span>         <span class="token number">30.0</span>   
<span class="token number">3</span>          NE           <span class="token number">24.0</span>         SE  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        <span class="token number">45.0</span>         <span class="token number">16.0</span>   
<span class="token number">4</span>           W           <span class="token number">41.0</span>        ENE  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        <span class="token number">82.0</span>         <span class="token number">33.0</span>   
<span class="token number">5</span>         WNW           <span class="token number">56.0</span>          W  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        <span class="token number">55.0</span>         <span class="token number">23.0</span>   
<span class="token number">6</span>           W           <span class="token number">50.0</span>         SW  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        <span class="token number">49.0</span>         <span class="token number">19.0</span>   
<span class="token number">7</span>           W           <span class="token number">35.0</span>        SSE  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        <span class="token number">48.0</span>         <span class="token number">19.0</span>   
<span class="token number">8</span>         NNW           <span class="token number">80.0</span>         SE  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        <span class="token number">42.0</span>          <span class="token number">9.0</span>   
<span class="token number">9</span>           W           <span class="token number">28.0</span>          S  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        <span class="token number">58.0</span>         <span class="token number">27.0</span>   

   Pressure9am  Pressure3pm  Cloud9am  Cloud3pm  Temp9am  Temp3pm  RainToday  \
<span class="token number">0</span>       <span class="token number">1007.7</span>       <span class="token number">1007.1</span>       <span class="token number">8.0</span>       NaN     <span class="token number">16.9</span>     <span class="token number">21.8</span>         No   
<span class="token number">1</span>       <span class="token number">1010.6</span>       <span class="token number">1007.8</span>       NaN       NaN     <span class="token number">17.2</span>     <span class="token number">24.3</span>         No   
<span class="token number">2</span>       <span class="token number">1007.6</span>       <span class="token number">1008.7</span>       NaN       <span class="token number">2.0</span>     <span class="token number">21.0</span>     <span class="token number">23.2</span>         No   
<span class="token number">3</span>       <span class="token number">1017.6</span>       <span class="token number">1012.8</span>       NaN       NaN     <span class="token number">18.1</span>     <span class="token number">26.5</span>         No   
<span class="token number">4</span>       <span class="token number">1010.8</span>       <span class="token number">1006.0</span>       <span class="token number">7.0</span>       <span class="token number">8.0</span>     <span class="token number">17.8</span>     <span class="token number">29.7</span>         No   
<span class="token number">5</span>       <span class="token number">1009.2</span>       <span class="token number">1005.4</span>       NaN       NaN     <span class="token number">20.6</span>     <span class="token number">28.9</span>         No   
<span class="token number">6</span>       <span class="token number">1009.6</span>       <span class="token number">1008.2</span>       <span class="token number">1.0</span>       NaN     <span class="token number">18.1</span>     <span class="token number">24.6</span>         No   
<span class="token number">7</span>       <span class="token number">1013.4</span>       <span class="token number">1010.1</span>       NaN       NaN     <span class="token number">16.3</span>     <span class="token number">25.5</span>         No   
<span class="token number">8</span>       <span class="token number">1008.9</span>       <span class="token number">1003.6</span>       NaN       NaN     <span class="token number">18.3</span>     <span class="token number">30.2</span>         No   
<span class="token number">9</span>       <span class="token number">1007.0</span>       <span class="token number">1005.7</span>       NaN       NaN     <span class="token number">20.1</span>     <span class="token number">28.2</span>        Yes   

   RainTomorrow  
<span class="token number">0</span>            No  
<span class="token number">1</span>            No  
<span class="token number">2</span>            No  
<span class="token number">3</span>            No  
<span class="token number">4</span>            No  
<span class="token number">5</span>            No  
<span class="token number">6</span>            No  
<span class="token number">7</span>            No  
<span class="token number">8</span>           Yes  
<span class="token number">9</span>            No  

<span class="token punctuation">[</span><span class="token number">10</span> rows x <span class="token number">23</span> columns<span class="token punctuation">]</span>
</code></pre>
    <p>
     æˆ‘ä»¬æ¥ä¸‹æ¥æŸ¥çœ‹æ•°æ®çš„åŸºæœ¬ç‰¹å¾
    </p>
    <pre><code class="prism language-python">data<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     ä»£ç è¾“å‡ºï¼š
    </p>
    <pre><code class="prism language-python">             MinTemp        MaxTemp       Rainfall   Evaporation  \
count  <span class="token number">143975.000000</span>  <span class="token number">144199.000000</span>  <span class="token number">142199.000000</span>  <span class="token number">82670.000000</span>   
mean       <span class="token number">12.194034</span>      <span class="token number">23.221348</span>       <span class="token number">2.360918</span>      <span class="token number">5.468232</span>   
std         <span class="token number">6.398495</span>       <span class="token number">7.119049</span>       <span class="token number">8.478060</span>      <span class="token number">4.193704</span>   
<span class="token builtin">min</span>        <span class="token operator">-</span><span class="token number">8.500000</span>      <span class="token operator">-</span><span class="token number">4.800000</span>       <span class="token number">0.000000</span>      <span class="token number">0.000000</span>   
<span class="token number">25</span><span class="token operator">%</span>         <span class="token number">7.600000</span>      <span class="token number">17.900000</span>       <span class="token number">0.000000</span>      <span class="token number">2.600000</span>   
<span class="token number">50</span><span class="token operator">%</span>        <span class="token number">12.000000</span>      <span class="token number">22.600000</span>       <span class="token number">0.000000</span>      <span class="token number">4.800000</span>   
<span class="token number">75</span><span class="token operator">%</span>        <span class="token number">16.900000</span>      <span class="token number">28.200000</span>       <span class="token number">0.800000</span>      <span class="token number">7.400000</span>   
<span class="token builtin">max</span>        <span class="token number">33.900000</span>      <span class="token number">48.100000</span>     <span class="token number">371.000000</span>    <span class="token number">145.000000</span>   

           Sunshine  WindGustSpeed   WindSpeed9am   WindSpeed3pm  \
count  <span class="token number">75625.000000</span>  <span class="token number">135197.000000</span>  <span class="token number">143693.000000</span>  <span class="token number">142398.000000</span>   
mean       <span class="token number">7.611178</span>      <span class="token number">40.035230</span>      <span class="token number">14.043426</span>      <span class="token number">18.662657</span>   
std        <span class="token number">3.785483</span>      <span class="token number">13.607062</span>       <span class="token number">8.915375</span>       <span class="token number">8.809800</span>   
<span class="token builtin">min</span>        <span class="token number">0.000000</span>       <span class="token number">6.000000</span>       <span class="token number">0.000000</span>       <span class="token number">0.000000</span>   
<span class="token number">25</span><span class="token operator">%</span>        <span class="token number">4.800000</span>      <span class="token number">31.000000</span>       <span class="token number">7.000000</span>      <span class="token number">13.000000</span>   
<span class="token number">50</span><span class="token operator">%</span>        <span class="token number">8.400000</span>      <span class="token number">39.000000</span>      <span class="token number">13.000000</span>      <span class="token number">19.000000</span>   
<span class="token number">75</span><span class="token operator">%</span>       <span class="token number">10.600000</span>      <span class="token number">48.000000</span>      <span class="token number">19.000000</span>      <span class="token number">24.000000</span>   
<span class="token builtin">max</span>       <span class="token number">14.500000</span>     <span class="token number">135.000000</span>     <span class="token number">130.000000</span>      <span class="token number">87.000000</span>   

         Humidity9am    Humidity3pm   Pressure9am    Pressure3pm  \
count  <span class="token number">142806.000000</span>  <span class="token number">140953.000000</span>  <span class="token number">130395.00000</span>  <span class="token number">130432.000000</span>   
mean       <span class="token number">68.880831</span>      <span class="token number">51.539116</span>    <span class="token number">1017.64994</span>    <span class="token number">1015.255889</span>   
std        <span class="token number">19.029164</span>      <span class="token number">20.795902</span>       <span class="token number">7.10653</span>       <span class="token number">7.037414</span>   
<span class="token builtin">min</span>         <span class="token number">0.000000</span>       <span class="token number">0.000000</span>     <span class="token number">980.50000</span>     <span class="token number">977.100000</span>   
<span class="token number">25</span><span class="token operator">%</span>        <span class="token number">57.000000</span>      <span class="token number">37.000000</span>    <span class="token number">1012.90000</span>    <span class="token number">1010.400000</span>   
<span class="token number">50</span><span class="token operator">%</span>        <span class="token number">70.000000</span>      <span class="token number">52.000000</span>    <span class="token number">1017.60000</span>    <span class="token number">1015.200000</span>   
<span class="token number">75</span><span class="token operator">%</span>        <span class="token number">83.000000</span>      <span class="token number">66.000000</span>    <span class="token number">1022.40000</span>    <span class="token number">1020.000000</span>   
<span class="token builtin">max</span>       <span class="token number">100.000000</span>     <span class="token number">100.000000</span>    <span class="token number">1041.00000</span>    <span class="token number">1039.600000</span>   

           Cloud9am      Cloud3pm        Temp9am       Temp3pm  
count  <span class="token number">89572.000000</span>  <span class="token number">86102.000000</span>  <span class="token number">143693.000000</span>  <span class="token number">141851.00000</span>  
mean       <span class="token number">4.447461</span>      <span class="token number">4.509930</span>      <span class="token number">16.990631</span>      <span class="token number">21.68339</span>  
std        <span class="token number">2.887159</span>      <span class="token number">2.720357</span>       <span class="token number">6.488753</span>       <span class="token number">6.93665</span>  
<span class="token builtin">min</span>        <span class="token number">0.000000</span>      <span class="token number">0.000000</span>      <span class="token operator">-</span><span class="token number">7.200000</span>      <span class="token operator">-</span><span class="token number">5.40000</span>  
<span class="token number">25</span><span class="token operator">%</span>        <span class="token number">1.000000</span>      <span class="token number">2.000000</span>      <span class="token number">12.300000</span>      <span class="token number">16.60000</span>  
<span class="token number">50</span><span class="token operator">%</span>        <span class="token number">5.000000</span>      <span class="token number">5.000000</span>      <span class="token number">16.700000</span>      <span class="token number">21.10000</span>  
<span class="token number">75</span><span class="token operator">%</span>        <span class="token number">7.000000</span>      <span class="token number">7.000000</span>      <span class="token number">21.600000</span>      <span class="token number">26.40000</span>  
<span class="token builtin">max</span>        <span class="token number">9.000000</span>      <span class="token number">9.000000</span>      <span class="token number">40.200000</span>      <span class="token number">46.70000</span>  
</code></pre>
    <p>
     éšåæˆ‘ä»¬æŸ¥çœ‹æ•°æ®ç±»å‹ï¼š
    </p>
    <pre><code class="prism language-python">data<span class="token punctuation">.</span>dtypes
</code></pre>
    <p>
     ä»£ç è¾“å‡ºï¼š
    </p>
    <pre><code class="prism language-python">Date              <span class="token builtin">object</span>
Location          <span class="token builtin">object</span>
MinTemp          float64
MaxTemp          float64
Rainfall         float64
Evaporation      float64
Sunshine         float64
WindGustDir       <span class="token builtin">object</span>
WindGustSpeed    float64
WindDir9am        <span class="token builtin">object</span>
WindDir3pm        <span class="token builtin">object</span>
WindSpeed9am     float64
WindSpeed3pm     float64
Humidity9am      float64
Humidity3pm      float64
Pressure9am      float64
Pressure3pm      float64
Cloud9am         float64
Cloud3pm         float64
Temp9am          float64
Temp3pm          float64
RainToday         <span class="token builtin">object</span>
RainTomorrow      <span class="token builtin">object</span>
dtype<span class="token punctuation">:</span> <span class="token builtin">object</span>
</code></pre>
    <p>
     å°†æ—¥æœŸè½¬æ¢ä¸ºæ—¥æœŸæ—¶é—´æ ¼å¼ï¼š
    </p>
    <pre><code class="prism language-python">data<span class="token punctuation">[</span><span class="token string">'Date'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'Date'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

data<span class="token punctuation">[</span><span class="token string">'year'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'Date'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>year
data<span class="token punctuation">[</span><span class="token string">'month'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'Date'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>month
data<span class="token punctuation">[</span><span class="token string">'day'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'Date'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>day

data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     ä»£ç è¾“å‡ºï¼š
    </p>
    <pre><code class="prism language-python">        Date Location  MinTemp  MaxTemp  Rainfall  Evaporation  Sunshine  \
<span class="token number">0</span> <span class="token number">2008</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">01</span>   Albury     <span class="token number">13.4</span>     <span class="token number">22.9</span>       <span class="token number">0.6</span>          NaN       NaN   
<span class="token number">1</span> <span class="token number">2008</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">02</span>   Albury      <span class="token number">7.4</span>     <span class="token number">25.1</span>       <span class="token number">0.0</span>          NaN       NaN   
<span class="token number">2</span> <span class="token number">2008</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">03</span>   Albury     <span class="token number">12.9</span>     <span class="token number">25.7</span>       <span class="token number">0.0</span>          NaN       NaN   
<span class="token number">3</span> <span class="token number">2008</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">04</span>   Albury      <span class="token number">9.2</span>     <span class="token number">28.0</span>       <span class="token number">0.0</span>          NaN       NaN   
<span class="token number">4</span> <span class="token number">2008</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">05</span>   Albury     <span class="token number">17.5</span>     <span class="token number">32.3</span>       <span class="token number">1.0</span>          NaN       NaN   

  WindGustDir  WindGustSpeed WindDir9am  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> Pressure3pm  Cloud9am  Cloud3pm  \
<span class="token number">0</span>           W           <span class="token number">44.0</span>          W  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>      <span class="token number">1007.1</span>       <span class="token number">8.0</span>       NaN   
<span class="token number">1</span>         WNW           <span class="token number">44.0</span>        NNW  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>      <span class="token number">1007.8</span>       NaN       NaN   
<span class="token number">2</span>         WSW           <span class="token number">46.0</span>          W  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>      <span class="token number">1008.7</span>       NaN       <span class="token number">2.0</span>   
<span class="token number">3</span>          NE           <span class="token number">24.0</span>         SE  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>      <span class="token number">1012.8</span>       NaN       NaN   
<span class="token number">4</span>           W           <span class="token number">41.0</span>        ENE  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>      <span class="token number">1006.0</span>       <span class="token number">7.0</span>       <span class="token number">8.0</span>   

   Temp9am  Temp3pm  RainToday  RainTomorrow  year  month  day  
<span class="token number">0</span>     <span class="token number">16.9</span>     <span class="token number">21.8</span>         No            No  <span class="token number">2008</span>     <span class="token number">12</span>    <span class="token number">1</span>  
<span class="token number">1</span>     <span class="token number">17.2</span>     <span class="token number">24.3</span>         No            No  <span class="token number">2008</span>     <span class="token number">12</span>    <span class="token number">2</span>  
<span class="token number">2</span>     <span class="token number">21.0</span>     <span class="token number">23.2</span>         No            No  <span class="token number">2008</span>     <span class="token number">12</span>    <span class="token number">3</span>  
<span class="token number">3</span>     <span class="token number">18.1</span>     <span class="token number">26.5</span>         No            No  <span class="token number">2008</span>     <span class="token number">12</span>    <span class="token number">4</span>  
<span class="token number">4</span>     <span class="token number">17.8</span>     <span class="token number">29.7</span>         No            No  <span class="token number">2008</span>     <span class="token number">12</span>    <span class="token number">5</span>  

<span class="token punctuation">[</span><span class="token number">5</span> rows x <span class="token number">26</span> columns<span class="token punctuation">]</span>
</code></pre>
    <pre><code class="prism language-python">data<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">'Date'</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
data<span class="token punctuation">.</span>columns
</code></pre>
    <p>
     ä»£ç è¾“å‡ºï¼š
    </p>
    <pre><code class="prism language-python">Index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Location'</span><span class="token punctuation">,</span> <span class="token string">'MinTemp'</span><span class="token punctuation">,</span> <span class="token string">'MaxTemp'</span><span class="token punctuation">,</span> <span class="token string">'Rainfall'</span><span class="token punctuation">,</span> <span class="token string">'Evaporation'</span><span class="token punctuation">,</span> <span class="token string">'Sunshine'</span><span class="token punctuation">,</span>
       <span class="token string">'WindGustDir'</span><span class="token punctuation">,</span> <span class="token string">'WindGustSpeed'</span><span class="token punctuation">,</span> <span class="token string">'WindDir9am'</span><span class="token punctuation">,</span> <span class="token string">'WindDir3pm'</span><span class="token punctuation">,</span>
       <span class="token string">'WindSpeed9am'</span><span class="token punctuation">,</span> <span class="token string">'WindSpeed3pm'</span><span class="token punctuation">,</span> <span class="token string">'Humidity9am'</span><span class="token punctuation">,</span> <span class="token string">'Humidity3pm'</span><span class="token punctuation">,</span>
       <span class="token string">'Pressure9am'</span><span class="token punctuation">,</span> <span class="token string">'Pressure3pm'</span><span class="token punctuation">,</span> <span class="token string">'Cloud9am'</span><span class="token punctuation">,</span> <span class="token string">'Cloud3pm'</span><span class="token punctuation">,</span> <span class="token string">'Temp9am'</span><span class="token punctuation">,</span>
       <span class="token string">'Temp3pm'</span><span class="token punctuation">,</span> <span class="token string">'RainToday'</span><span class="token punctuation">,</span> <span class="token string">'RainTomorrow'</span><span class="token punctuation">,</span> <span class="token string">'year'</span><span class="token punctuation">,</span> <span class="token string">'month'</span><span class="token punctuation">,</span> <span class="token string">'day'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      dtype<span class="token operator">=</span><span class="token string">'object'</span><span class="token punctuation">)</span>
</code></pre>
    <h2>
     <a id="EDA_214">
     </a>
     äºŒã€æ¢ç´¢å¼æ•°æ®åˆ†æï¼ˆEDAï¼‰
    </h2>
    <h3>
     <a id="1_215">
     </a>
     1ã€æ•°æ®ç›¸å…³æ€§æ¢ç´¢
    </h3>
    <pre><code class="prism language-python">numeric_data <span class="token operator">=</span> data<span class="token punctuation">.</span>select_dtypes<span class="token punctuation">(</span>include<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'number'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ax <span class="token operator">=</span> sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>numeric_data<span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> square<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> annot<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> fmt<span class="token operator">=</span><span class="token string">'.2f'</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_xticklabels<span class="token punctuation">(</span>ax<span class="token punctuation">.</span>get_xticklabels<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rotation<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     ä»£ç è¾“å‡ºï¼š
     <br/>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/0728db23880943f493bf10d26217477c.png"/>
    </p>
    <h3>
     <a id="2_225">
     </a>
     2ã€æ˜¯å¦ä¼šä¸‹é›¨
    </h3>
    <pre><code class="prism language-python"><span class="token comment"># è®¾ç½®æ ·å¼å’Œè°ƒè‰²æ¿</span>
sns<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>style<span class="token operator">=</span><span class="token string">"whitegrid"</span><span class="token punctuation">,</span> palette<span class="token operator">=</span><span class="token string">"Set2"</span><span class="token punctuation">)</span>

<span class="token comment"># åˆ›å»ºä¸€ä¸ª 1 è¡Œ 2 åˆ—çš„å›¾åƒå¸ƒå±€</span>
fig<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># å›¾å½¢å°ºå¯¸è°ƒå¤§ (10, 4)</span>

<span class="token comment"># å›¾è¡¨æ ‡é¢˜æ ·å¼</span>
title_font <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'fontsize'</span><span class="token punctuation">:</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token string">'fontweight'</span><span class="token punctuation">:</span> <span class="token string">'bold'</span><span class="token punctuation">,</span> <span class="token string">'color'</span><span class="token punctuation">:</span> <span class="token string">'darkblue'</span><span class="token punctuation">}</span>

<span class="token comment"># ç¬¬ä¸€å¼ å›¾ï¼šRainTomorrow</span>
sns<span class="token punctuation">.</span>countplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">'RainTomorrow'</span><span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> ax<span class="token operator">=</span>axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">'black'</span><span class="token punctuation">,</span>
              palette<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'Yes'</span><span class="token punctuation">:</span> <span class="token string">'green'</span><span class="token punctuation">,</span> <span class="token string">'No'</span><span class="token punctuation">:</span> <span class="token string">'red'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment"># æ·»åŠ è¾¹æ¡†</span>
axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">'Rain Tomorrow'</span><span class="token punctuation">,</span> fontdict<span class="token operator">=</span>title_font<span class="token punctuation">)</span>  <span class="token comment"># è®¾ç½®æ ‡é¢˜</span>
axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">'Will it Rain Tomorrow?'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>  <span class="token comment"># Xè½´æ ‡ç­¾</span>
axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">'Count'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>  <span class="token comment"># Yè½´æ ‡ç­¾</span>
axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tick_params<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token string">'x'</span><span class="token punctuation">,</span> labelsize<span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">)</span>  <span class="token comment"># Xè½´åˆ»åº¦å­—ä½“å¤§å°</span>
axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tick_params<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token string">'y'</span><span class="token punctuation">,</span> labelsize<span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">)</span>  <span class="token comment"># Yè½´åˆ»åº¦å­—ä½“å¤§å°</span>

<span class="token comment"># ç¬¬äºŒå¼ å›¾ï¼šRainToday</span>
sns<span class="token punctuation">.</span>countplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">'RainToday'</span><span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> ax<span class="token operator">=</span>axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">'black'</span><span class="token punctuation">,</span>
              palette<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'Yes'</span><span class="token punctuation">:</span> <span class="token string">'green'</span><span class="token punctuation">,</span> <span class="token string">'No'</span><span class="token punctuation">:</span> <span class="token string">'red'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment"># æ·»åŠ è¾¹æ¡†</span>
axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">'Rain Today'</span><span class="token punctuation">,</span> fontdict<span class="token operator">=</span>title_font<span class="token punctuation">)</span>  <span class="token comment"># è®¾ç½®æ ‡é¢˜</span>
axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">'Did it Rain Today?'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>  <span class="token comment"># Xè½´æ ‡ç­¾</span>
axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">'Count'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>  <span class="token comment"># Yè½´æ ‡ç­¾</span>
axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tick_params<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token string">'x'</span><span class="token punctuation">,</span> labelsize<span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">)</span>  <span class="token comment"># Xè½´åˆ»åº¦å­—ä½“å¤§å°</span>
axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tick_params<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token string">'y'</span><span class="token punctuation">,</span> labelsize<span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">)</span>  <span class="token comment"># Yè½´åˆ»åº¦å­—ä½“å¤§å°</span>

sns<span class="token punctuation">.</span>despine<span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token comment"># å»é™¤å›¾è¡¨é¡¶éƒ¨å’Œå³ä¾§çš„è¾¹æ¡†</span>
plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># è°ƒæ•´å¸ƒå±€ï¼Œé¿å…å›¾å½¢ä¹‹é—´çš„é‡å </span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     ä»£ç è¾“å‡ºï¼š
     <br/>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/b69e5e9045174907b6ddfdaab350914e.png"/>
    </p>
    <pre><code class="prism language-python">x<span class="token operator">=</span>pd<span class="token punctuation">.</span>crosstab<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'RainTomorrow'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data<span class="token punctuation">[</span><span class="token string">'RainToday'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
x
</code></pre>
    <p>
     ä»£ç è¾“å‡ºï¼š
    </p>
    <pre><code class="prism language-python">RainToday        No    Yes
RainTomorrow              
No            <span class="token number">92728</span>  <span class="token number">16858</span>
Yes           <span class="token number">16604</span>  <span class="token number">14597</span>
</code></pre>
    <pre><code class="prism language-python">y<span class="token operator">=</span>x<span class="token operator">/</span>x<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span>
y
</code></pre>
    <p>
     ä»£ç è¾“å‡ºï¼š
    </p>
    <pre><code class="prism language-python">RainToday            No        Yes
RainTomorrow                      
No            <span class="token number">84.616648</span>  <span class="token number">15.383352</span>
Yes           <span class="token number">53.216243</span>  <span class="token number">46.783757</span>
</code></pre>
    <pre><code class="prism language-python">y<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">"bar"</span><span class="token punctuation">,</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'#006666'</span><span class="token punctuation">,</span><span class="token string">'#d279a6'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     ä»£ç è¾“å‡ºï¼š
     <br/>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/572776db324c4204a16b7b88bc99dc1a.png"/>
    </p>
    <h3>
     <a id="3_293">
     </a>
     3ã€åœ°ç†ä½ç½®ä¸ä¸‹é›¨çš„å…³ç³»
    </h3>
    <pre><code class="prism language-python">x<span class="token operator">=</span>pd<span class="token punctuation">.</span>crosstab<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'Location'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data<span class="token punctuation">[</span><span class="token string">'RainToday'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
<span class="token comment"># è·å–æ¯ä¸ªåŸå¸‚ä¸‹é›¨å¤©æ•°å’Œéä¸‹é›¨å¤©æ•°çš„ç™¾åˆ†æ¯”</span>
y<span class="token operator">=</span>x<span class="token operator">/</span>x<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span>
<span class="token comment"># æŒ‰æ¯ä¸ªåŸå¸‚çš„é›¨å¤©ç™¾åˆ†æ¯”æ’åº</span>
y<span class="token operator">=</span>y<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'Yes'</span><span class="token punctuation">,</span>ascending<span class="token operator">=</span><span class="token boolean">True</span> <span class="token punctuation">)</span>

color<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'#cc6699'</span><span class="token punctuation">,</span><span class="token string">'#006699'</span><span class="token punctuation">,</span><span class="token string">'#006666'</span><span class="token punctuation">,</span><span class="token string">'#862d86'</span><span class="token punctuation">,</span><span class="token string">'#ff9966'</span>  <span class="token punctuation">]</span>
y<span class="token punctuation">.</span>Yes<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">"barh"</span><span class="token punctuation">,</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>color<span class="token operator">=</span>color<span class="token punctuation">)</span>
</code></pre>
    <p>
     ä»£ç è¾“å‡ºï¼š
     <br/>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/24cb23070eeb409e86601fd46515fdeb.png"/>
    </p>
    <h3>
     <a id="4_307">
     </a>
     4ã€æ¹¿åº¦å’Œå‹åŠ›å¯¹ä¸‹é›¨çš„å½±å“
    </h3>
    <pre><code class="prism language-python">data<span class="token punctuation">.</span>columns
</code></pre>
    <p>
     ä»£ç è¾“å‡ºï¼š
    </p>
    <pre><code class="prism language-python">Index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Location'</span><span class="token punctuation">,</span> <span class="token string">'MinTemp'</span><span class="token punctuation">,</span> <span class="token string">'MaxTemp'</span><span class="token punctuation">,</span> <span class="token string">'Rainfall'</span><span class="token punctuation">,</span> <span class="token string">'Evaporation'</span><span class="token punctuation">,</span> <span class="token string">'Sunshine'</span><span class="token punctuation">,</span>
       <span class="token string">'WindGustDir'</span><span class="token punctuation">,</span> <span class="token string">'WindGustSpeed'</span><span class="token punctuation">,</span> <span class="token string">'WindDir9am'</span><span class="token punctuation">,</span> <span class="token string">'WindDir3pm'</span><span class="token punctuation">,</span>
       <span class="token string">'WindSpeed9am'</span><span class="token punctuation">,</span> <span class="token string">'WindSpeed3pm'</span><span class="token punctuation">,</span> <span class="token string">'Humidity9am'</span><span class="token punctuation">,</span> <span class="token string">'Humidity3pm'</span><span class="token punctuation">,</span>
       <span class="token string">'Pressure9am'</span><span class="token punctuation">,</span> <span class="token string">'Pressure3pm'</span><span class="token punctuation">,</span> <span class="token string">'Cloud9am'</span><span class="token punctuation">,</span> <span class="token string">'Cloud3pm'</span><span class="token punctuation">,</span> <span class="token string">'Temp9am'</span><span class="token punctuation">,</span>
       <span class="token string">'Temp3pm'</span><span class="token punctuation">,</span> <span class="token string">'RainToday'</span><span class="token punctuation">,</span> <span class="token string">'RainTomorrow'</span><span class="token punctuation">,</span> <span class="token string">'year'</span><span class="token punctuation">,</span> <span class="token string">'month'</span><span class="token punctuation">,</span> <span class="token string">'day'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      dtype<span class="token operator">=</span><span class="token string">'object'</span><span class="token punctuation">)</span>
</code></pre>
    <pre><code class="prism language-python">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>scatterplot<span class="token punctuation">(</span>data<span class="token operator">=</span>data<span class="token punctuation">,</span>x<span class="token operator">=</span><span class="token string">'Pressure9am'</span><span class="token punctuation">,</span>
                y<span class="token operator">=</span><span class="token string">'Pressure3pm'</span><span class="token punctuation">,</span>hue<span class="token operator">=</span><span class="token string">'RainTomorrow'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     ä»£ç è¾“å‡ºï¼š
     <br/>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/6c4557214816426c88fd11d9b7b8d2c9.png"/>
    </p>
    <pre><code class="prism language-python">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>scatterplot<span class="token punctuation">(</span>data<span class="token operator">=</span>data<span class="token punctuation">,</span>x<span class="token operator">=</span><span class="token string">'Humidity9am'</span><span class="token punctuation">,</span>
                y<span class="token operator">=</span><span class="token string">'Humidity3pm'</span><span class="token punctuation">,</span>hue<span class="token operator">=</span><span class="token string">'RainTomorrow'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     ä»£ç è¾“å‡ºï¼š
     <br/>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/cd9f29231fa644cd8d675aaac80c1887.png"/>
    </p>
    <h3>
     <a id="5_338">
     </a>
     5ã€æ°”æ¸©å¯¹ä¸‹é›¨çš„å½±å“
    </h3>
    <pre><code class="prism language-python">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>scatterplot<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">'MaxTemp'</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token string">'MinTemp'</span><span class="token punctuation">,</span> 
                data<span class="token operator">=</span>data<span class="token punctuation">,</span> hue<span class="token operator">=</span><span class="token string">'RainTomorrow'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     ä»£ç è¾“å‡ºï¼š
     <br/>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/98adf0de5a9a4bcc95b5c37b29049e7a.png"/>
    </p>
    <h2>
     <a id="_347">
     </a>
     ä¸‰ã€æ•°æ®é¢„å¤„ç†
    </h2>
    <pre><code class="prism language-python"><span class="token comment"># æ¯åˆ—ä¸­ç¼ºå¤±æ•°æ®çš„ç™¾åˆ†æ¯”</span>
data<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span>data<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">100</span>
</code></pre>
    <p>
     ä»£ç è¾“å‡ºï¼š
    </p>
    <pre><code class="prism language-python">Location          <span class="token number">0.000000</span>
MinTemp           <span class="token number">1.020899</span>
MaxTemp           <span class="token number">0.866905</span>
Rainfall          <span class="token number">2.241853</span>
Evaporation      <span class="token number">43.166506</span>
Sunshine         <span class="token number">48.009762</span>
WindGustDir       <span class="token number">7.098859</span>
WindGustSpeed     <span class="token number">7.055548</span>
WindDir9am        <span class="token number">7.263853</span>
WindDir3pm        <span class="token number">2.906641</span>
WindSpeed9am      <span class="token number">1.214767</span>
WindSpeed3pm      <span class="token number">2.105046</span>
Humidity9am       <span class="token number">1.824557</span>
Humidity3pm       <span class="token number">3.098446</span>
Pressure9am      <span class="token number">10.356799</span>
Pressure3pm      <span class="token number">10.331363</span>
Cloud9am         <span class="token number">38.421559</span>
Cloud3pm         <span class="token number">40.807095</span>
Temp9am           <span class="token number">1.214767</span>
Temp3pm           <span class="token number">2.481094</span>
RainToday         <span class="token number">2.241853</span>
RainTomorrow      <span class="token number">2.245978</span>
year              <span class="token number">0.000000</span>
month             <span class="token number">0.000000</span>
day               <span class="token number">0.000000</span>
dtype<span class="token punctuation">:</span> float64
</code></pre>
    <pre><code class="prism language-python"><span class="token comment"># åœ¨è¯¥åˆ—ä¸­éšæœºé€‰æ‹©æ•°è¿›è¡Œå¡«å……</span>
lst<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Evaporation'</span><span class="token punctuation">,</span><span class="token string">'Sunshine'</span><span class="token punctuation">,</span><span class="token string">'Cloud9am'</span><span class="token punctuation">,</span><span class="token string">'Cloud3pm'</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> col <span class="token keyword">in</span> lst<span class="token punctuation">:</span>
    fill_list <span class="token operator">=</span> data<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span>
    data<span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>fill_list<span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
s <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>dtypes <span class="token operator">==</span> <span class="token string">"object"</span><span class="token punctuation">)</span>
object_cols <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">.</span>index<span class="token punctuation">)</span>
object_cols
</code></pre>
    <p>
     ä»£ç è¾“å‡ºï¼š
    </p>
    <pre><code class="prism language-python"><span class="token punctuation">[</span><span class="token string">'Location'</span><span class="token punctuation">,</span>
 <span class="token string">'WindGustDir'</span><span class="token punctuation">,</span>
 <span class="token string">'WindDir9am'</span><span class="token punctuation">,</span>
 <span class="token string">'WindDir3pm'</span><span class="token punctuation">,</span>
 <span class="token string">'RainToday'</span><span class="token punctuation">,</span>
 <span class="token string">'RainTomorrow'</span><span class="token punctuation">]</span>
</code></pre>
    <pre><code class="prism language-python"><span class="token comment"># inplace=Trueï¼šç›´æ¥ä¿®æ”¹åŸå¯¹è±¡ï¼Œä¸åˆ›å»ºå‰¯æœ¬</span>
<span class="token comment"># data[i].mode()[0] è¿”å›é¢‘ç‡å‡ºç°æœ€é«˜çš„é€‰é¡¹ï¼Œä¼—æ•°</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> object_cols<span class="token punctuation">:</span>
    data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>mode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

t <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>dtypes <span class="token operator">==</span> <span class="token string">"float64"</span><span class="token punctuation">)</span>
num_cols <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>t<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">.</span>index<span class="token punctuation">)</span>
num_cols
</code></pre>
    <p>
     ä»£ç è¾“å‡ºï¼š
    </p>
    <pre><code class="prism language-python"><span class="token punctuation">[</span><span class="token string">'MinTemp'</span><span class="token punctuation">,</span>
 <span class="token string">'MaxTemp'</span><span class="token punctuation">,</span>
 <span class="token string">'Rainfall'</span><span class="token punctuation">,</span>
 <span class="token string">'Evaporation'</span><span class="token punctuation">,</span>
 <span class="token string">'Sunshine'</span><span class="token punctuation">,</span>
 <span class="token string">'WindGustSpeed'</span><span class="token punctuation">,</span>
 <span class="token string">'WindSpeed9am'</span><span class="token punctuation">,</span>
 <span class="token string">'WindSpeed3pm'</span><span class="token punctuation">,</span>
 <span class="token string">'Humidity9am'</span><span class="token punctuation">,</span>
 <span class="token string">'Humidity3pm'</span><span class="token punctuation">,</span>
 <span class="token string">'Pressure9am'</span><span class="token punctuation">,</span>
 <span class="token string">'Pressure3pm'</span><span class="token punctuation">,</span>
 <span class="token string">'Cloud9am'</span><span class="token punctuation">,</span>
 <span class="token string">'Cloud3pm'</span><span class="token punctuation">,</span>
 <span class="token string">'Temp9am'</span><span class="token punctuation">,</span>
 <span class="token string">'Temp3pm'</span><span class="token punctuation">]</span>
</code></pre>
    <p>
     ä¸­ä½æ•°è¿›è¡Œå¡«å……ï¼š
    </p>
    <pre><code class="prism language-python"><span class="token comment"># .median(), ä¸­ä½æ•°</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> num_cols<span class="token punctuation">:</span>
    data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

data<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     ä»£ç è¾“å‡ºï¼š
    </p>
    <pre><code class="prism language-python">Date                 <span class="token number">0</span>
Location             <span class="token number">0</span>
MinTemp              <span class="token number">0</span>
MaxTemp              <span class="token number">0</span>
Rainfall             <span class="token number">0</span>
Evaporation          <span class="token number">0</span>
Sunshine             <span class="token number">0</span>
WindGustDir      <span class="token number">10326</span>
WindGustSpeed        <span class="token number">0</span>
WindDir9am       <span class="token number">10566</span>
WindDir3pm        <span class="token number">4228</span>
WindSpeed9am         <span class="token number">0</span>
WindSpeed3pm         <span class="token number">0</span>
Humidity9am          <span class="token number">0</span>
Humidity3pm          <span class="token number">0</span>
Pressure9am          <span class="token number">0</span>
Pressure3pm          <span class="token number">0</span>
Cloud9am             <span class="token number">0</span>
Cloud3pm             <span class="token number">0</span>
Temp9am              <span class="token number">0</span>
Temp3pm              <span class="token number">0</span>
RainToday         <span class="token number">3261</span>
RainTomorrow      <span class="token number">3267</span>
dtype<span class="token punctuation">:</span> int64
</code></pre>
    <h3>
     <a id="2_474">
     </a>
     2ã€æ„å»ºæ•°æ®é›†
    </h3>
    <pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> LabelEncoder

label_encoder <span class="token operator">=</span> LabelEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> object_cols<span class="token punctuation">:</span>
    data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> label_encoder<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>

X <span class="token operator">=</span> data<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'RainTomorrow'</span><span class="token punctuation">,</span><span class="token string">'day'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values
y <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'RainTomorrow'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values

X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span>y<span class="token punctuation">,</span>test_size<span class="token operator">=</span><span class="token number">0.25</span><span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">101</span><span class="token punctuation">)</span>

scaler <span class="token operator">=</span> MinMaxScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>
scaler<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>
X_train <span class="token operator">=</span> scaler<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>
X_test  <span class="token operator">=</span> scaler<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
</code></pre>
    <h3>
     <a id="3_493">
     </a>
     3ã€ç½‘ç»œæ„å»ºä¸è®­ç»ƒ
    </h3>
    <pre><code class="prism language-python"><span class="token keyword">import</span> torch
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>optim <span class="token keyword">as</span> optim
<span class="token keyword">from</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data <span class="token keyword">import</span> DataLoader<span class="token punctuation">,</span> TensorDataset
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token comment"># æ£€æŸ¥ GPU æ˜¯å¦å¯ç”¨</span>
device <span class="token operator">=</span> torch<span class="token punctuation">.</span>device<span class="token punctuation">(</span><span class="token string">"cuda"</span> <span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">"cpu"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Using device:"</span><span class="token punctuation">,</span> device<span class="token punctuation">)</span>

<span class="token comment"># 1. å®šä¹‰æ¨¡å‹ç»“æ„</span>
<span class="token keyword">class</span> <span class="token class-name">MyModel</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_dim<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>MyModel<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>fc1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>input_dim<span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span>       <span class="token comment"># ç¬¬ä¸€å±‚ï¼šè¾“å…¥ -&gt; 24</span>
        self<span class="token punctuation">.</span>fc2 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span>               <span class="token comment"># ç¬¬äºŒå±‚ï¼š24 -&gt; 18</span>
        self<span class="token punctuation">.</span>fc3 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span>               <span class="token comment"># ç¬¬ä¸‰å±‚ï¼š18 -&gt; 23</span>
        self<span class="token punctuation">.</span>dropout1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Dropout<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>            <span class="token comment"># dropout 0.5</span>
        self<span class="token punctuation">.</span>fc4 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span>               <span class="token comment"># ç¬¬å››å±‚ï¼š23 -&gt; 12</span>
        self<span class="token punctuation">.</span>dropout2 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Dropout<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>            <span class="token comment"># dropout 0.2</span>
        self<span class="token punctuation">.</span>fc5 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>                <span class="token comment"># è¾“å‡ºå±‚ï¼š12 -&gt; 1</span>
        
    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> torch<span class="token punctuation">.</span>tanh<span class="token punctuation">(</span>self<span class="token punctuation">.</span>fc1<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>               <span class="token comment"># ä½¿ç”¨ tanh æ¿€æ´»</span>
        x <span class="token operator">=</span> torch<span class="token punctuation">.</span>tanh<span class="token punctuation">(</span>self<span class="token punctuation">.</span>fc2<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> torch<span class="token punctuation">.</span>tanh<span class="token punctuation">(</span>self<span class="token punctuation">.</span>fc3<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>dropout1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> torch<span class="token punctuation">.</span>tanh<span class="token punctuation">(</span>self<span class="token punctuation">.</span>fc4<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>dropout2<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> torch<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>self<span class="token punctuation">.</span>fc5<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token comment"># è¾“å‡ºå±‚ç”¨ sigmoidï¼Œè¾“å‡ºæ¦‚ç‡</span>
        <span class="token keyword">return</span> x

<span class="token comment"># 2. æ•°æ®å‡†å¤‡</span>
<span class="token comment"># å‡è®¾ X_train, y_train, X_test, y_test æ˜¯ NumPy æ•°ç»„</span>
X_train_tensor <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
y_train_tensor <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>y_train<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># è°ƒæ•´ä¸º (N,1)</span>
X_test_tensor  <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
y_test_tensor  <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment"># åˆ›å»ºæ•°æ®é›†å’Œ DataLoader</span>
train_dataset <span class="token operator">=</span> TensorDataset<span class="token punctuation">(</span>X_train_tensor<span class="token punctuation">,</span> y_train_tensor<span class="token punctuation">)</span>
val_dataset   <span class="token operator">=</span> TensorDataset<span class="token punctuation">(</span>X_test_tensor<span class="token punctuation">,</span> y_test_tensor<span class="token punctuation">)</span>

batch_size <span class="token operator">=</span> <span class="token number">32</span>
train_loader <span class="token operator">=</span> DataLoader<span class="token punctuation">(</span>train_dataset<span class="token punctuation">,</span> batch_size<span class="token operator">=</span>batch_size<span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
val_loader   <span class="token operator">=</span> DataLoader<span class="token punctuation">(</span>val_dataset<span class="token punctuation">,</span> batch_size<span class="token operator">=</span>batch_size<span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token comment"># 3. å®ä¾‹åŒ–æ¨¡å‹ï¼Œå¹¶ç§»åŠ¨åˆ° GPUï¼ˆå¦‚æœå¯ç”¨ï¼‰</span>
input_dim <span class="token operator">=</span> X_train<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment"># ç‰¹å¾ä¸ªæ•°</span>
model <span class="token operator">=</span> MyModel<span class="token punctuation">(</span>input_dim<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>

<span class="token comment"># 4. å®šä¹‰ä¼˜åŒ–å™¨å’ŒæŸå¤±å‡½æ•°</span>
optimizer <span class="token operator">=</span> optim<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">1e-4</span><span class="token punctuation">)</span>
criterion <span class="token operator">=</span> nn<span class="token punctuation">.</span>BCELoss<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># äºŒå…ƒäº¤å‰ç†µæŸå¤±</span>

<span class="token comment"># 5. è®¾ç½®æ—©åœå‚æ•°</span>
patience <span class="token operator">=</span> <span class="token number">25</span>          <span class="token comment"># æœ€å¤šç­‰å¾… 25 ä¸ª epoch</span>
min_delta <span class="token operator">=</span> <span class="token number">0.001</span>      <span class="token comment"># éªŒè¯æŸå¤±æ”¹å–„é˜ˆå€¼</span>
best_val_loss <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token string">'inf'</span><span class="token punctuation">)</span>
patience_counter <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token comment"># åˆå§‹åŒ–è®°å½•æŒ‡æ ‡çš„åˆ—è¡¨</span>
train_loss_history <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
val_loss_history <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
train_acc_history <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
val_acc_history <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

num_epochs <span class="token operator">=</span> <span class="token number">10</span>  <span class="token comment"># æˆ–ä½ å®é™…çš„è®­ç»ƒå‘¨æœŸæ•°</span>

<span class="token keyword">for</span> epoch <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    model<span class="token punctuation">.</span>train<span class="token punctuation">(</span><span class="token punctuation">)</span>
    train_loss <span class="token operator">=</span> <span class="token number">0.0</span>
    correct_train <span class="token operator">=</span> <span class="token number">0</span>
    total_train <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token comment"># éå†è®­ç»ƒé›†</span>
    <span class="token keyword">for</span> batch_x<span class="token punctuation">,</span> batch_y <span class="token keyword">in</span> train_loader<span class="token punctuation">:</span>
        <span class="token comment"># å°†æ•°æ®ç§»åŠ¨åˆ°è®¾å¤‡ï¼ˆGPU/CPUï¼‰</span>
        batch_x <span class="token operator">=</span> batch_x<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>
        batch_y <span class="token operator">=</span> batch_y<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>
        
        optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token comment"># æ¸…é™¤æ¢¯åº¦</span>
        outputs <span class="token operator">=</span> model<span class="token punctuation">(</span>batch_x<span class="token punctuation">)</span>         <span class="token comment"># å‰å‘ä¼ æ’­</span>
        loss <span class="token operator">=</span> criterion<span class="token punctuation">(</span>outputs<span class="token punctuation">,</span> batch_y<span class="token punctuation">)</span> <span class="token comment"># è®¡ç®—æŸå¤±</span>
        loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>                  <span class="token comment"># åå‘ä¼ æ’­</span>
        optimizer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>                 <span class="token comment"># æ›´æ–°å‚æ•°</span>
        
        train_loss <span class="token operator">+=</span> loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> batch_x<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token comment"># äºŒåˆ†ç±»ï¼šå°†è¾“å‡ºæ¦‚ç‡å¤§äº 0.5 çš„åˆ¤ä¸º 1ï¼Œå¦åˆ™ä¸º 0</span>
        preds <span class="token operator">=</span> <span class="token punctuation">(</span>outputs <span class="token operator">&gt;=</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">float</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        correct_train <span class="token operator">+=</span> <span class="token punctuation">(</span>preds <span class="token operator">==</span> batch_y<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>
        total_train <span class="token operator">+=</span> batch_y<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    
    epoch_train_loss <span class="token operator">=</span> train_loss <span class="token operator">/</span> total_train
    epoch_train_acc <span class="token operator">=</span> correct_train <span class="token operator">/</span> total_train
    train_loss_history<span class="token punctuation">.</span>append<span class="token punctuation">(</span>epoch_train_loss<span class="token punctuation">)</span>
    train_acc_history<span class="token punctuation">.</span>append<span class="token punctuation">(</span>epoch_train_acc<span class="token punctuation">)</span>
    
    <span class="token comment"># éªŒè¯é˜¶æ®µ</span>
    model<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    val_loss <span class="token operator">=</span> <span class="token number">0.0</span>
    correct_val <span class="token operator">=</span> <span class="token number">0</span>
    total_val <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> batch_x<span class="token punctuation">,</span> batch_y <span class="token keyword">in</span> val_loader<span class="token punctuation">:</span>
            batch_x <span class="token operator">=</span> batch_x<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>
            batch_y <span class="token operator">=</span> batch_y<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>
            outputs <span class="token operator">=</span> model<span class="token punctuation">(</span>batch_x<span class="token punctuation">)</span>
            loss <span class="token operator">=</span> criterion<span class="token punctuation">(</span>outputs<span class="token punctuation">,</span> batch_y<span class="token punctuation">)</span>
            val_loss <span class="token operator">+=</span> loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> batch_x<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
            preds <span class="token operator">=</span> <span class="token punctuation">(</span>outputs <span class="token operator">&gt;=</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">float</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            correct_val <span class="token operator">+=</span> <span class="token punctuation">(</span>preds <span class="token operator">==</span> batch_y<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>
            total_val <span class="token operator">+=</span> batch_y<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    epoch_val_loss <span class="token operator">=</span> val_loss <span class="token operator">/</span> total_val
    epoch_val_acc <span class="token operator">=</span> correct_val <span class="token operator">/</span> total_val
    val_loss_history<span class="token punctuation">.</span>append<span class="token punctuation">(</span>epoch_val_loss<span class="token punctuation">)</span>
    val_acc_history<span class="token punctuation">.</span>append<span class="token punctuation">(</span>epoch_val_acc<span class="token punctuation">)</span>
    
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Epoch </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>epoch<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>num_epochs<span class="token punctuation">}</span></span><span class="token string">, Training Loss: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>epoch_train_loss<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">, Training Acc: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>epoch_train_acc<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">, "</span></span>
          <span class="token string-interpolation"><span class="token string">f"Validation Loss: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>epoch_val_loss<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">, Validation Acc: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>epoch_val_acc<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># ç»˜å›¾ï¼šè®­ç»ƒå’ŒéªŒè¯çš„å‡†ç¡®ç‡ä¸æŸå¤±</span>
epochs_range <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> num_epochs <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>epochs_range<span class="token punctuation">,</span> train_acc_history<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Training Accuracy'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>epochs_range<span class="token punctuation">,</span> val_acc_history<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Validation Accuracy'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">'lower right'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Training and Validation Accuracy'</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>epochs_range<span class="token punctuation">,</span> train_loss_history<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Training Loss'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>epochs_range<span class="token punctuation">,</span> val_loss_history<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Validation Loss'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">'upper right'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Training and Validation Loss'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     ä»£ç è¾“å‡ºï¼š
    </p>
    <pre><code class="prism language-python">Using device<span class="token punctuation">:</span> cuda
Epoch <span class="token number">1</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">,</span> Training Loss<span class="token punctuation">:</span> <span class="token number">0.4736</span><span class="token punctuation">,</span> Training Acc<span class="token punctuation">:</span> <span class="token number">0.7941</span><span class="token punctuation">,</span> Validation Loss<span class="token punctuation">:</span> <span class="token number">0.3953</span><span class="token punctuation">,</span> Validation Acc<span class="token punctuation">:</span> <span class="token number">0.8288</span>
Epoch <span class="token number">2</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">,</span> Training Loss<span class="token punctuation">:</span> <span class="token number">0.3899</span><span class="token punctuation">,</span> Training Acc<span class="token punctuation">:</span> <span class="token number">0.8356</span><span class="token punctuation">,</span> Validation Loss<span class="token punctuation">:</span> <span class="token number">0.3775</span><span class="token punctuation">,</span> Validation Acc<span class="token punctuation">:</span> <span class="token number">0.8381</span>
Epoch <span class="token number">3</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">,</span> Training Loss<span class="token punctuation">:</span> <span class="token number">0.3836</span><span class="token punctuation">,</span> Training Acc<span class="token punctuation">:</span> <span class="token number">0.8391</span><span class="token punctuation">,</span> Validation Loss<span class="token punctuation">:</span> <span class="token number">0.3746</span><span class="token punctuation">,</span> Validation Acc<span class="token punctuation">:</span> <span class="token number">0.8385</span>
Epoch <span class="token number">4</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">,</span> Training Loss<span class="token punctuation">:</span> <span class="token number">0.3812</span><span class="token punctuation">,</span> Training Acc<span class="token punctuation">:</span> <span class="token number">0.8400</span><span class="token punctuation">,</span> Validation Loss<span class="token punctuation">:</span> <span class="token number">0.3730</span><span class="token punctuation">,</span> Validation Acc<span class="token punctuation">:</span> <span class="token number">0.8392</span>
Epoch <span class="token number">5</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">,</span> Training Loss<span class="token punctuation">:</span> <span class="token number">0.3797</span><span class="token punctuation">,</span> Training Acc<span class="token punctuation">:</span> <span class="token number">0.8392</span><span class="token punctuation">,</span> Validation Loss<span class="token punctuation">:</span> <span class="token number">0.3719</span><span class="token punctuation">,</span> Validation Acc<span class="token punctuation">:</span> <span class="token number">0.8398</span>
Epoch <span class="token number">6</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">,</span> Training Loss<span class="token punctuation">:</span> <span class="token number">0.3776</span><span class="token punctuation">,</span> Training Acc<span class="token punctuation">:</span> <span class="token number">0.8400</span><span class="token punctuation">,</span> Validation Loss<span class="token punctuation">:</span> <span class="token number">0.3711</span><span class="token punctuation">,</span> Validation Acc<span class="token punctuation">:</span> <span class="token number">0.8404</span>
Epoch <span class="token number">7</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">,</span> Training Loss<span class="token punctuation">:</span> <span class="token number">0.3776</span><span class="token punctuation">,</span> Training Acc<span class="token punctuation">:</span> <span class="token number">0.8398</span><span class="token punctuation">,</span> Validation Loss<span class="token punctuation">:</span> <span class="token number">0.3707</span><span class="token punctuation">,</span> Validation Acc<span class="token punctuation">:</span> <span class="token number">0.8405</span>
Epoch <span class="token number">8</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">,</span> Training Loss<span class="token punctuation">:</span> <span class="token number">0.3771</span><span class="token punctuation">,</span> Training Acc<span class="token punctuation">:</span> <span class="token number">0.8400</span><span class="token punctuation">,</span> Validation Loss<span class="token punctuation">:</span> <span class="token number">0.3715</span><span class="token punctuation">,</span> Validation Acc<span class="token punctuation">:</span> <span class="token number">0.8400</span>
Epoch <span class="token number">9</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">,</span> Training Loss<span class="token punctuation">:</span> <span class="token number">0.3769</span><span class="token punctuation">,</span> Training Acc<span class="token punctuation">:</span> <span class="token number">0.8402</span><span class="token punctuation">,</span> Validation Loss<span class="token punctuation">:</span> <span class="token number">0.3708</span><span class="token punctuation">,</span> Validation Acc<span class="token punctuation">:</span> <span class="token number">0.8405</span>
Epoch <span class="token number">10</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">,</span> Training Loss<span class="token punctuation">:</span> <span class="token number">0.3770</span><span class="token punctuation">,</span> Training Acc<span class="token punctuation">:</span> <span class="token number">0.8395</span><span class="token punctuation">,</span> Validation Loss<span class="token punctuation">:</span> <span class="token number">0.3698</span><span class="token punctuation">,</span> Validation Acc<span class="token punctuation">:</span> <span class="token number">0.8398</span>

<span class="token operator">&lt;</span>Figure size 1400x400 <span class="token keyword">with</span> <span class="token number">2</span> Axes<span class="token operator">&gt;</span>
</code></pre>
    <h3>
     <a id="4_654">
     </a>
     4ã€æ•°æ®å¯è§†åŒ–
    </h3>
    <p>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/08161e797b2043f8acac0ad054c4b402.png"/>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="6874747073:3a2f2f626c6f672e6373646e2e6e65742f697261636f6c652f:61727469636c652f64657461696c732f313436313135323531" class_="artid" style="display:none">
 </p>
</div>


