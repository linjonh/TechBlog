---
layout: post
title: "字节小游戏SDK-ios切支付方案"
date: 2022-07-07 19:20:48 +0800
description: "抖音小游戏ios切第三方支付_bytedance ttwebview"
keywords: "bytedance ttwebview"
categories: ['前端']
tags: ['大数据']
artid: "125665494"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=125665494
    alt: "字节小游戏SDK-ios切支付方案"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=125665494
featuredImagePreview: https://bing.ee123.net/img/rand?artid=125665494
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     字节小游戏SDK-ios切支付方案
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <div>
     <div>
      <h4 style="text-align:left;">
       一般字节小游戏和ios是不允许调起第三方支付的，但是有了字节内部的api，可以实现调隐藏api实现第三方支付功能。
      </h4>
      <h2 style="text-align:left;">
       <strong>
        <span style="color:#1a1a1a;">
         openWebview API 接口文档
        </span>
       </strong>
      </h2>
      <h2 style="text-align:left;">
       <strong>
        <span style="color:#000000;">
         tt.openWebview
        </span>
       </strong>
      </h2>
      <p style="text-align:left;">
       <span style="color:#000000;">
        创建实例 Webview 实例， 该 Webview 的大小默认为 {left: -1, right: -1, width: 1, height: 1} 且不能修改
       </span>
      </p>
      <h4 style="text-align:left;">
       <strong>
        <span style="color:#000000;">
         语法
        </span>
       </strong>
      </h4>
      <p style="text-align:left;">
      </p>
      <p style="text-align:left;">
      </p>
      <pre><span style="background-color:#fafafa;"><code><span style="color:#333333;">tt.openWebview(options);</span>
</code></span></pre>
      <p>
      </p>
      <h4 style="text-align:left;">
       <strong>
        <span style="color:#000000;">
         返回值
        </span>
       </strong>
      </h4>
      <p style="text-align:left;">
       <span style="color:#000000;">
        回调参数为 Webview 类型，属性参考 Webview 说明：
       </span>
      </p>
      <h4 style="text-align:left;">
       <strong>
        <span style="color:#000000;">
         参数说明
        </span>
       </strong>
      </h4>
      <p style="text-align:left;">
       <span style="color:#000000;">
        options 为 object 类型，属性如下：
       </span>
      </p>
      <div>
       <table border="1" cellspacing="0">
        <tbody>
         <tr>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             属性名
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             类型
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             默认值
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             必填
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             说明
            </span>
           </p>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             url
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             string
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             无
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             是
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             跳转的 URL 地址， 域名必须为 wx.tenpay.com
            </span>
           </p>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             referer
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             string
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             无
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             是
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             商户申请微信 H5 支付时提交的授权域名，用户拉起微信支付后，无论支付结果如何都会跳转到 Safari 中显示该页面
            </span>
           </p>
          </td>
         </tr>
        </tbody>
       </table>
      </div>
      <h4 style="text-align:left;">
       <strong>
        <span style="color:#000000;">
         回调成功
        </span>
       </strong>
      </h4>
      <p style="text-align:left;">
       <span style="color:#000000;">
        返回值为 Webview 对象，类型为 object，属性如下：
       </span>
      </p>
      <div>
       <table border="1" cellspacing="0">
        <tbody>
         <tr>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             属性名
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             类型
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             默认值
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             必填
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             说明
            </span>
           </p>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             close
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             fuction
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             无
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             是
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             用于关闭打开的 Webview
            </span>
           </p>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             errMsg
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             string
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             无
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             是
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             "openWebview:ok "
            </span>
           </p>
          </td>
         </tr>
        </tbody>
       </table>
      </div>
      <h4 style="text-align:left;">
       <strong>
        <span style="color:#000000;">
         回调失败
        </span>
       </strong>
      </h4>
      <p style="text-align:left;">
       <span style="color:#000000;">
        object 类型，属性如下：
       </span>
      </p>
      <div>
       <table border="1" cellspacing="0">
        <tbody>
         <tr>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             属性名
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             类型
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             默认值
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             必填
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             说明
            </span>
           </p>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             errMsg
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             string
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             无
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             是
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             "openWebview:fail " + 详细错误信息
            </span>
           </p>
          </td>
         </tr>
        </tbody>
       </table>
      </div>
      <h4 style="text-align:left;">
       <strong>
        <span style="color:#000000;">
         示例代码
        </span>
       </strong>
      </h4>
      <p style="text-align:left;">
      </p>
      <p style="text-align:left;">
      </p>
      <pre><span style="background-color:#fafafa;"><code><span style="color:#333333;"> let params = {<!-- --></span>
<span style="color:#333333;">     url:'https://wx.tenpay.com/cgi-bin/mmpayweb-bin/checkmweb?prepay_id=wx09115922286166a73ff1776308e32a0000&amp;package=2514622250',</span>
<span style="color:#333333;">     referer: 'microapp.bytedance.com',</span>
<span style="color:#333333;">     success(res: any) {<!-- --></span>
<span style="color:#333333;">         console.log('open Webview success!', res);</span>
<span style="color:#333333;">         webview = res;</span>
<span style="color:#333333;">     },</span>
<span style="color:#333333;">     fail(res: any) {<!-- --></span>
<span style="color:#333333;">         console.log('open Webview fail!', res);</span>
<span style="color:#333333;">     },</span>
<span style="color:#333333;">   }</span>
<span style="color:#333333;">   tt.openWebview(params);</span>
</code></span></pre>
      <p>
      </p>
      <p style="text-align:left;">
       <span style="background-color:#fff5eb;">
        <span style="color:#000000;">
         小游戏回到前台时，会自动关闭上次打开的 Webview
        </span>
       </span>
      </p>
      <h2 style="text-align:left;">
       <strong>
        <span style="color:#000000;">
         Webview
        </span>
       </strong>
      </h2>
      <p style="text-align:left;">
       <span style="color:#000000;">
        tt.openWebview 函数返回对象，包含的属性如下
       </span>
      </p>
      <div>
       <table border="1" cellspacing="0">
        <tbody>
         <tr>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             属性名
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             类型
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             说明
            </span>
           </p>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             close
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             function
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             用于关闭打开的 Webview
            </span>
           </p>
          </td>
         </tr>
        </tbody>
       </table>
      </div>
      <h2 style="text-align:left;">
       <strong>
        <span style="color:#000000;">
         Webview.close
        </span>
       </strong>
      </h2>
      <p style="text-align:left;">
       <span style="color:#000000;">
        为了防止意外的情况导致跳转微信失败，建议调用tt.openWebview 成功之后定时关闭此窗口
       </span>
      </p>
      <h4 style="text-align:left;">
       <strong>
        <span style="color:#000000;">
         语法
        </span>
       </strong>
      </h4>
      <p style="text-align:left;">
      </p>
      <p style="text-align:left;">
      </p>
      <pre><span style="background-color:#fafafa;"><code><span style="color:#333333;"> Webview.close(options);</span>
</code></span></pre>
      <p>
      </p>
      <h4 style="text-align:left;">
       <strong>
        <span style="color:#000000;">
         参数说明
        </span>
       </strong>
      </h4>
      <h4 style="text-align:left;">
       <strong>
        <span style="color:#000000;">
         回调成功
        </span>
       </strong>
      </h4>
      <p style="text-align:left;">
       <span style="color:#000000;">
        object 类型，属性如下：
       </span>
      </p>
      <p style="text-align:left;">
       <span style="color:#000000;">
        ，属性如下：
       </span>
      </p>
      <div>
       <table border="1" cellspacing="0">
        <tbody>
         <tr>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             属性名
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             类型
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             默认值
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             必填
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             说明
            </span>
           </p>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             errMsg
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             fuction
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             无
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             是
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             "Webview.close:ok "
            </span>
           </p>
          </td>
         </tr>
        </tbody>
       </table>
      </div>
      <h4 style="text-align:left;">
       <strong>
        <span style="color:#000000;">
         回调失败
        </span>
       </strong>
      </h4>
      <p style="text-align:left;">
       <span style="color:#000000;">
        object 类型，属性如下：
       </span>
      </p>
      <div>
       <table border="1" cellspacing="0">
        <tbody>
         <tr>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             属性名
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             类型
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             默认值
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             必填
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             说明
            </span>
           </p>
          </td>
         </tr>
         <tr>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             errMsg
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             string
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             无
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             是
            </span>
           </p>
          </td>
          <td colspan="1" rowspan="1" style="vertical-align:middle;width:48px;">
           <p style="text-align:left;">
            <span style="color:#000000;">
             "Webview.close:fail " + 详细错误信息
            </span>
           </p>
          </td>
         </tr>
        </tbody>
       </table>
      </div>
      <h4 style="text-align:left;">
       <strong>
        <span style="color:#000000;">
         示例代码
        </span>
       </strong>
      </h4>
      <p style="text-align:left;">
      </p>
      <p style="text-align:left;">
      </p>
      <pre><span style="background-color:#fafafa;"><code><span style="color:#333333;">let params = {<!-- --></span>
<span style="color:#333333;">    url:'https://wx.tenpay.com/cgi-bin/mmpayweb-bin/checkmweb?prepay_id=wx09115922286166a73ff1776308e32a0000&amp;package=2514622250',</span>
<span style="color:#333333;">    referer: 'https://microapp.bytedance.com',</span>
<span style="color:#333333;">    success(res: any) {<!-- --></span>
<span style="color:#333333;">        console.log('open Webview success!', res);</span>
<span style="color:#333333;">        webview = res;</span>
<span style="color:#333333;">        // cocos 写法，其他平台注意调整</span>
<span style="color:#333333;">        setTimeout(()=&gt;{<!-- --></span>
<span style="color:#333333;">            console.log('setTimeout close webview');</span>
<span style="color:#333333;">            let params2 = {<!-- --></span>
<span style="color:#333333;">                success(res: any) {<!-- --></span>
<span style="color:#333333;">                    console.log('timeout close Webview success!', res);</span>
<span style="color:#333333;">                },</span>
<span style="color:#333333;">                fail(res: any) {<!-- --></span>
<span style="color:#333333;">                    console.log('timeout close Webview fail!', res);</span>
<span style="color:#333333;">                },</span>
<span style="color:#333333;">            }</span>
<span style="color:#333333;">            webview.close(params2);</span>
<span style="color:#333333;">        },2000) ;</span>
<span style="color:#333333;">    },</span>
<span style="color:#333333;">    fail(res: any) {<!-- --></span>
<span style="color:#333333;">        console.log('open Webview fail!', res);</span>
<span style="color:#333333;">    },</span>
<span style="color:#333333;">}</span>
<span style="color:#333333;">tt.openWebview(params);</span>
</code></span></pre>
      <p>
      </p>
      <h2 style="text-align:left;">
      </h2>
      <p style="text-align:left;">
      </p>
     </div>
    </div>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34313836343233302f:61727469636c652f64657461696c732f313235363635343934" class_="artid" style="display:none">
 </p>
</div>


