---
layout: post
title: "æ–­ç‚¹ç»­è·‘-"
date: 2025-08-29T12:32:25+0800
description: "DKBMDKBMã€‚"
keywords: "æ–­ç‚¹ç»­è·‘ "
categories: ['æœªåˆ†ç±»']
tags: ['å¼€å‘è¯­è¨€', 'Python']
artid: "150981608"
arturl: "https://blog.csdn.net/wu_jing_sheng0/article/details/150981608"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=150981608
    alt: "æ–­ç‚¹ç»­è·‘-"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=150981608
featuredImagePreview: https://bing.ee123.net/img/rand?artid=150981608
cover: https://bing.ee123.net/img/rand?artid=150981608
image: https://bing.ee123.net/img/rand?artid=150981608
img: https://bing.ee123.net/img/rand?artid=150981608
---



# æ–­ç‚¹ç»­è·‘

#### ä¸€ã€æ ¸å¿ƒæ€è·¯

1. **æ–­ç‚¹è®°å½•**ï¼šç”¨æ–‡æœ¬æ–‡ä»¶ï¼ˆ`breakpoint.txt`ï¼‰ä¿å­˜å·²æˆåŠŸå¯¼å‡ºçš„`DKBM`å€¼ï¼Œæ¯å®Œæˆä¸€ä¸ªæ–‡ä»¶å°±å†™å…¥è®°å½•ã€‚
2. **æ–­ç‚¹æ£€æµ‹**ï¼šè„šæœ¬å¯åŠ¨æ—¶è¯»å–`breakpoint.txt`ï¼Œè·å–å·²å®Œæˆåˆ—è¡¨ï¼Œåç»­å¾ªç¯ä¸­è·³è¿‡è¿™äº›`DKBM`ã€‚
3. **å®¹é”™å¤„ç†**ï¼šé¿å…é‡å¤å†™å…¥è®°å½•ã€å¤„ç†æ–‡ä»¶è¯»å†™å¼‚å¸¸ï¼Œç¡®ä¿æ–­ç‚¹æ•°æ®å¯é ã€‚

#### äºŒã€å®Œæ•´æ–­ç‚¹ç»­è·‘è„šæœ¬

python

è¿è¡Œ

```

#!/usr/bin/python
# -*- coding: UTF-8 -*-
import arcpy
import sys
import os  # æ–°å¢ï¼šç”¨äºæ–‡ä»¶è·¯å¾„æ“ä½œå’Œæ–­ç‚¹è®°å½•
import datetime
from arcpy import env
import math

# -------------------------- 1. æ–­ç‚¹å·¥å…·å‡½æ•°ï¼ˆæ–°å¢ï¼‰--------------------------
def init_breakpoint_file(breakpoint_path):
    """åˆå§‹åŒ–æ–­ç‚¹æ–‡ä»¶ï¼šè‹¥ä¸å­˜åœ¨åˆ™åˆ›å»ºç©ºæ–‡ä»¶"""
    if not os.path.exists(breakpoint_path):
        with open(breakpoint_path, 'w', encoding='utf-8') as f:
            f.write("")  # åˆ›å»ºç©ºæ–‡ä»¶
        print(f"åˆå§‹åŒ–æ–­ç‚¹æ–‡ä»¶ï¼š{breakpoint_path}")

def get_completed_dkbms(breakpoint_path):
    """è¯»å–æ–­ç‚¹æ–‡ä»¶ï¼Œè¿”å›å·²å®Œæˆçš„DKBMåˆ—è¡¨"""
    completed = []
    if os.path.exists(breakpoint_path):
        with open(breakpoint_path, 'r', encoding='utf-8') as f:
            lines = f.readlines()
            completed = [line.strip() for line in lines if line.strip()]  # å»ç©ºè¡Œå’Œç©ºæ ¼
    print(f"å·²å®Œæˆå¯¼å‡ºçš„DKBMæ•°é‡ï¼š{len(completed)}")
    return completed

def add_completed_dkbm(breakpoint_path, dkbm):
    """å°†å·²å®Œæˆçš„DKBMå†™å…¥æ–­ç‚¹æ–‡ä»¶ï¼ˆé¿å…é‡å¤ï¼‰"""
    completed = get_completed_dkbms(breakpoint_path)
    if dkbm not in completed:
        with open(breakpoint_path, 'a', encoding='utf-8') as f:
            f.write(f"{dkbm}\n")  # æ¯è¡Œå­˜ä¸€ä¸ªDKBMï¼Œä¾¿äºåç»­è¯»å–
        print(f"è®°å½•å®Œæˆï¼šDKBM={dkbm}")

# -------------------------- 2. åŸåŠŸèƒ½å‡½æ•°ä¿ç•™ï¼ˆä¿®å¤éƒ¨åˆ†é—®é¢˜ï¼‰--------------------------
def mkdir(path):             
    path = path.strip().rstrip("\\")
    if not os.path.exists(path):
        os.makedirs(path) 
        print(f"{path} åˆ›å»ºæˆåŠŸ")
        return True
    else:
        print(f"{path} å·²å­˜åœ¨")
        return False

# -------------------------- 3. ä¸»é€»è¾‘ï¼ˆæ–°å¢æ–­ç‚¹ç»­è·‘ï¼‰--------------------------
if __name__ == "__main__":
    # -------------------------- åŸºç¡€å‚æ•°é…ç½® --------------------------
    resolution = 10
    scale = 96 * 1000 * resolution / 25.4
    imgWidth = 300    # å¯¼å‡ºå›¾ç‰‡å®½åº¦
    imgHeight = 200   # å¯¼å‡ºå›¾ç‰‡é«˜åº¦
    selectfield = "DKBM"  # ç”¨äºç­›é€‰å’Œå‘½åçš„å­—æ®µ
    label_field = "ZW"    # æ ‡æ³¨å­—æ®µ

    # æ–‡ä»¶è·¯å¾„é…ç½®ï¼ˆæ ¹æ®å®é™…æƒ…å†µä¿®æ”¹ï¼‰
    mxdfile = r"E:\gzct\gzct.mxd"       # MXDæ–‡ä»¶è·¯å¾„
    outdir = r"E:\gzct"                 # å¯¼å‡ºJPGçš„è¾“å‡ºç›®å½•
    shpname = r"E:\gzct\dk6209222021_241106_2.shp"  # è¦ç´ ç±»è·¯å¾„
    breakpoint_file = os.path.join(outdir, "breakpoint.txt")  # æ–­ç‚¹è®°å½•æ–‡ä»¶ï¼ˆæ”¾åœ¨è¾“å‡ºç›®å½•ä¸‹ï¼‰

    # -------------------------- åˆå§‹åŒ–ï¼šåˆ›å»ºè¾“å‡ºç›®å½•å’Œæ–­ç‚¹æ–‡ä»¶ --------------------------
    mkdir(outdir)  # ç¡®ä¿è¾“å‡ºç›®å½•å­˜åœ¨
    init_breakpoint_file(breakpoint_file)  # åˆå§‹åŒ–æ–­ç‚¹æ–‡ä»¶
    completed_dkbms = get_completed_dkbms(breakpoint_file)  # è¯»å–å·²å®Œæˆçš„DKBM

    # -------------------------- åŠ è½½MXDå’Œå›¾å±‚ --------------------------
    try:
        mxd = arcpy.mapping.MapDocument(mxdfile)
        df = arcpy.mapping.ListDataFrames(mxd)[0]  # è·å–ç¬¬ä¸€ä¸ªæ•°æ®æ¡†
        input_layer = arcpy.mapping.ListLayers(mxd, "", df)[0]  # è·å–ç›®æ ‡å›¾å±‚
        target_layer = input_layer  # æ ‡æ³¨ç”¨å›¾å±‚ï¼ˆä¸ç›®æ ‡å›¾å±‚ä¸€è‡´ï¼‰
        print(f"æˆåŠŸåŠ è½½MXDï¼š{mxdfile}")
        print(f"ç›®æ ‡å›¾å±‚ï¼š{input_layer.name}")
    except Exception as e:
        print(f"åŠ è½½MXD/å›¾å±‚å¤±è´¥ï¼š{str(e)}")
        sys.exit(1)  # åŠ è½½å¤±è´¥åˆ™é€€å‡º

    # -------------------------- æ–­ç‚¹ç»­è·‘ï¼šå¾ªç¯å¤„ç†è¦ç´  --------------------------
    total_count = 0  # æ€»è¦ç´ æ•°
    processed_count = 0  # æœ¬æ¬¡å¤„ç†çš„è¦ç´ æ•°
    skipped_count = 0  # è·³è¿‡çš„å·²å®Œæˆè¦ç´ æ•°

    # å…ˆç»Ÿè®¡æ€»è¦ç´ æ•°ï¼ˆå¯é€‰ï¼Œç”¨äºè¿›åº¦æ˜¾ç¤ºï¼‰
    with arcpy.da.SearchCursor(shpname, [selectfield]) as count_cursor:
        total_count = sum(1 for _ in count_cursor)
    print(f"è¦ç´ ç±»æ€»è¦ç´ æ•°ï¼š{total_count}")

    # æ ¸å¿ƒï¼šå¾ªç¯å¤„ç†æ¯ä¸ªè¦ç´ ï¼ˆè·³è¿‡å·²å®Œæˆé¡¹ï¼‰
    with arcpy.da.SearchCursor(shpname, [selectfield, label_field]) as cursor:
        for row in cursor:
            current_dkbm = str(row[0]).strip()  # å½“å‰è¦ç´ çš„DKBM
            current_zw = str(row[1]).strip()     # å½“å‰è¦ç´ çš„æ ‡æ³¨æ–‡æœ¬

            # 1. æ–­ç‚¹åˆ¤æ–­ï¼šè‹¥å·²å®Œæˆï¼Œç›´æ¥è·³è¿‡
            if current_dkbm in completed_dkbms:
                skipped_count += 1
                print(f"è·³è¿‡å·²å®Œæˆï¼šDKBM={current_dkbm}ï¼ˆç´¯è®¡è·³è¿‡ï¼š{skipped_count}ï¼‰")
                continue

            # 2. å¤„ç†æœªå®Œæˆçš„è¦ç´ ï¼šç­›é€‰ã€æ ‡æ³¨ã€å¯¼å‡º
            try:
                # 2.1 æŒ‰DKBMç­›é€‰è¦ç´ 
                where_clause = f'"{selectfield}" = \'{current_dkbm}\''  # SQLç­›é€‰æ¡ä»¶
                arcpy.SelectLayerByAttribute_management(
                    in_layer_or_view=input_layer,
                    selection_type="NEW_SELECTION",
                    where_clause=where_clause
                )

                # 2.2 æ£€æŸ¥æ˜¯å¦æœ‰é€‰ä¸­è¦ç´ 
                selected_count = int(arcpy.GetCount_management(input_layer).getOutput(0))
                if selected_count == 0:
                    print(f"è­¦å‘Šï¼šDKBM={current_dkbm} æ— åŒ¹é…è¦ç´ ï¼Œè·³è¿‡")
                    continue

                # 2.3 ç¼©æ”¾è‡³é€‰ä¸­è¦ç´ ï¼ˆå¯è°ƒæ•´ç¼©æ”¾æ¯”ä¾‹ï¼‰
                df.zoomToSelectedFeatures()
                df.scale = df.scale * 1.1  # æ‰©å¤§10%è§†é‡ï¼ˆé¿å…è¦ç´ è´´è¾¹ï¼‰
                arcpy.RefreshActiveView()  # åˆ·æ–°è§†å›¾

                # 2.4 è®¾ç½®æ ‡æ³¨ï¼ˆä»…æ˜¾ç¤ºå½“å‰é€‰ä¸­è¦ç´ çš„æ ‡æ³¨ï¼‰
                if target_layer.supports("LABELCLASSES"):
                    lbl_class = target_layer.labelClasses[0]
                    lbl_class.expression = f"[{label_field}]"  # æ ‡æ³¨å­—æ®µ
                    lbl_class.SQLQuery = where_clause  # ä»…æ ‡æ³¨å½“å‰é€‰ä¸­è¦ç´ 
                    target_layer.showLabels = True
                    arcpy.RefreshActiveView()  # åˆ·æ–°æ ‡æ³¨

                # 2.5 å¯¼å‡ºJPG
                out_file = os.path.join(outdir, f"{current_dkbm}.jpg")
                arcpy.mapping.ExportToJPEG(
                    map_document=mxd,
                    out_jpeg=out_file,
                    data_frame=df,
                    width=imgWidth,
                    height=imgHeight,
                    resolution=90  # å›¾ç‰‡åˆ†è¾¨ç‡
                )
                print(f"å¯¼å‡ºæˆåŠŸï¼š{out_file}")

                # 2.6 è®°å½•æ–­ç‚¹ï¼šåªæœ‰å¯¼å‡ºæˆåŠŸæ‰å†™å…¥è®°å½•
                add_completed_dkbm(breakpoint_file, current_dkbm)
                processed_count += 1

            except Exception as e:
                # å¼‚å¸¸å¤„ç†ï¼šè®°å½•é”™è¯¯ä½†ä¸ç»ˆæ­¢è„šæœ¬ï¼ˆç»§ç»­å¤„ç†ä¸‹ä¸€ä¸ªï¼‰
                error_msg = f"å¤„ç†DKBM={current_dkbm}æ—¶å‡ºé”™ï¼š{str(e)}"
                print(error_msg)
                # å¯é€‰ï¼šå°†é”™è¯¯è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶
                with open(os.path.join(outdir, "error_log.txt"), 'a', encoding='utf-8') as err_f:
                    err_f.write(f"{datetime.datetime.now()} - {error_msg}\n")
                continue

    # -------------------------- ç»“æŸï¼šæ¸…ç†èµ„æºå’Œæ˜¾ç¤ºç»Ÿè®¡ --------------------------
    # æ¸…ç†ArcGISèµ„æº
    arcpy.SelectLayerByAttribute_management(input_layer, "CLEAR_SELECTION")  # æ¸…é™¤é€‰æ‹©
    del mxd, df, input_layer, target_layer
    arcpy.RefreshActiveView()
    arcpy.RefreshTOC()

    # æ˜¾ç¤ºæœ€ç»ˆç»Ÿè®¡
    print("\n" + "="*50)
    print("æ–­ç‚¹ç»­è·‘ä»»åŠ¡å®Œæˆï¼")
    print(f"æ€»è¦ç´ æ•°ï¼š{total_count}")
    print(f"å·²å®Œæˆæ€»æ•°ï¼ˆå«å†å²ï¼‰ï¼š{len(get_completed_dkbms(breakpoint_file))}")
    print(f"æœ¬æ¬¡å¤„ç†æ•°ï¼š{processed_count}")
    print(f"æœ¬æ¬¡è·³è¿‡æ•°ï¼š{skipped_count}")
    print(f"æ–­ç‚¹æ–‡ä»¶è·¯å¾„ï¼š{breakpoint_file}")
    print("="*50)

```

#### ä¸‰ã€ä½¿ç”¨è¯´æ˜

1. **é¦–æ¬¡è¿è¡Œ**ï¼š

   * è„šæœ¬ä¼šè‡ªåŠ¨åœ¨è¾“å‡ºç›®å½•ï¼ˆ`outdir`ï¼‰åˆ›å»º`breakpoint.txt`ï¼ˆç©ºæ–‡ä»¶ï¼‰ã€‚
   * æŒ‰é¡ºåºå¤„ç†æ‰€æœ‰è¦ç´ ï¼Œæ¯æˆåŠŸå¯¼å‡ºä¸€ä¸ª JPGï¼Œå°±å°†å¯¹åº”çš„`DKBM`å†™å…¥`breakpoint.txt`ã€‚
2. **ä¸­æ–­åç»­è·‘**ï¼š

   * é‡å¯è„šæœ¬æ—¶ï¼Œè„šæœ¬ä¼šå…ˆè¯»å–`breakpoint.txt`ä¸­çš„å·²å®Œæˆ`DKBM`ã€‚
   * å¾ªç¯æ—¶è·³è¿‡è¿™äº›å·²å®Œæˆé¡¹ï¼Œç›´æ¥å¤„ç†æœªè®°å½•çš„`DKBM`ï¼Œå®ç° â€œæ–­ç‚¹ç»­è·‘â€ã€‚
3. **é‡ç½®ä»»åŠ¡**ï¼š

   * è‹¥éœ€é‡æ–°å¤„ç†æ‰€æœ‰è¦ç´ ï¼Œåªéœ€åˆ é™¤è¾“å‡ºç›®å½•ä¸‹çš„`breakpoint.txt`ï¼Œè„šæœ¬ä¼šé‡æ–°åˆå§‹åŒ–å¹¶ä»å¤´å¼€å§‹ã€‚

#### å››ã€å…³é”®ä¼˜åŒ–ç‚¹

1. **é¿å…é‡å¤å¯¼å‡º**ï¼šé€šè¿‡`breakpoint.txt`ç²¾å‡†è®°å½•è¿›åº¦ï¼Œè·³è¿‡å·²å®Œæˆé¡¹ã€‚
2. **å®¹é”™æ€§å¢å¼º**ï¼š
   * å¤„ç† â€œæ— åŒ¹é…è¦ç´ â€â€œæ–‡ä»¶è¯»å†™å¼‚å¸¸â€ ç­‰æƒ…å†µï¼Œä¸ç»ˆæ­¢è„šæœ¬ã€‚
   * é”™è¯¯æ—¥å¿—ï¼ˆ`error_log.txt`ï¼‰è®°å½•å¼‚å¸¸ï¼Œä¾¿äºæ’æŸ¥é—®é¢˜ã€‚
3. **è¿›åº¦å¯è§†åŒ–**ï¼šæ˜¾ç¤ºæ€»è¦ç´ æ•°ã€å·²å®Œæˆæ•°ã€æœ¬æ¬¡å¤„ç†æ•°ï¼Œæ¸…æ™°æŒæ¡è¿›åº¦ã€‚
4. **æ ‡æ³¨ä¿®å¤**ï¼šç¡®ä¿æ ‡æ³¨ä»…æ˜¾ç¤ºå½“å‰é€‰ä¸­è¦ç´ ï¼ˆé€šè¿‡`lbl_class.SQLQuery`ç»‘å®šç­›é€‰æ¡ä»¶ï¼‰ã€‚

#### äº”ã€æ³¨æ„äº‹é¡¹

1. **è·¯å¾„é…ç½®**ï¼šç¡®ä¿`mxdfile`ã€`shpname`ã€`outdir`çš„è·¯å¾„ä¸å®é™…æ–‡ä»¶ä¸€è‡´ï¼ˆWindows è·¯å¾„ç”¨`r"è·¯å¾„"`é¿å…è½¬ä¹‰ï¼‰ã€‚
2. **å­—æ®µååŒ¹é…**ï¼š`selectfield`ï¼ˆ`DKBM`ï¼‰å’Œ`label_field`ï¼ˆ`ZW`ï¼‰éœ€ä¸è¦ç´ ç±»çš„å®é™…å­—æ®µåä¸€è‡´ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰ã€‚
3. **ArcGIS ç¯å¢ƒ**ï¼šéœ€åœ¨å®‰è£…äº† ArcPy çš„ç¯å¢ƒä¸­è¿è¡Œï¼ˆå¦‚ ArcGIS Desktop çš„ Python çª—å£ã€ArcGIS Pro çš„ Python ç¯å¢ƒï¼‰ã€‚

å†™ csdn åšå®¢

## ArcPy è„šæœ¬å®ç°æ–­ç‚¹ç»­è·‘ï¼šæ‰¹é‡å¯¼å‡ºè¦ç´  JPG çš„é«˜æ•ˆè§£å†³æ–¹æ¡ˆ

åœ¨ ArcGIS è‡ªåŠ¨åŒ–å·¥ä½œä¸­ï¼Œæ‰¹é‡å¤„ç†ç©ºé—´æ•°æ®ï¼ˆå¦‚æŒ‰è¦ç´ å¯¼å‡º JPG åœ°å›¾ï¼‰æ˜¯å¸¸è§éœ€æ±‚ã€‚ä½†å®é™…æ“ä½œä¸­ï¼Œè‹¥é‡åˆ°è„šæœ¬ä¸­æ–­ï¼ˆå¦‚ç”µè„‘æ­»æœºã€æ‰‹åŠ¨åœæ­¢ï¼‰ï¼Œé‡å¯åå¾€å¾€éœ€è¦ä»å¤´å¼€å§‹ï¼Œæµªè´¹å¤§é‡æ—¶é—´ã€‚æœ¬æ–‡å°†åˆ†äº«å¦‚ä½•åŸºäº ArcPy å®ç°**æ–­ç‚¹ç»­è·‘åŠŸèƒ½**ï¼Œé€šè¿‡è®°å½•è¿›åº¦è·³è¿‡å·²å®Œæˆä»»åŠ¡ï¼Œå¤§å¹…æå‡æ‰¹é‡å¤„ç†æ•ˆç‡ã€‚

### ä¸€ã€éœ€æ±‚èƒŒæ™¯ä¸ç—›ç‚¹

å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªçŸ¢é‡è¦ç´ ç±»ï¼ˆå¦‚åœ°å—æ•°æ®ï¼‰ï¼Œéœ€è¦æŒ‰æ¯ä¸ªè¦ç´ çš„`DKBM`å­—æ®µæ‰¹é‡å¯¼å‡ºå¯¹åº”èŒƒå›´çš„ JPG åœ°å›¾ï¼Œå¹¶æ·»åŠ `ZW`å­—æ®µä½œä¸ºæ ‡æ³¨ã€‚ä¼ ç»Ÿè„šæœ¬å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š

1. **ä¸­æ–­åéœ€é‡è·‘**ï¼šè‹¥å¤„ç† 1000 ä¸ªè¦ç´ æ—¶åœ¨ç¬¬ 500 ä¸ªä¸­æ–­ï¼Œé‡å¯åéœ€é‡æ–°å¤„ç†å‰ 500 ä¸ªï¼Œè€—æ—¶è€—åŠ›ï¼›
2. **æ— è¿›åº¦è®°å½•**ï¼šæ— æ³•ç›´è§‚äº†è§£å·²å®Œæˆå¤šå°‘ä»»åŠ¡ï¼Œä¹Ÿæ— æ³•å®šä½ä¸­æ–­åŸå› ï¼›
3. **å®¹é”™æ€§å·®**ï¼šé‡åˆ°æ— åŒ¹é…è¦ç´ ã€æ–‡ä»¶æƒé™ç­‰é—®é¢˜æ—¶ï¼Œè„šæœ¬ç›´æ¥å´©æºƒï¼Œæœªå¤„ç†åç»­è¦ç´ ã€‚

é’ˆå¯¹è¿™äº›ç—›ç‚¹ï¼Œæˆ‘ä»¬çš„æ ¸å¿ƒè§£å†³æ–¹æ¡ˆæ˜¯ï¼š**ç”¨æ–‡æœ¬æ–‡ä»¶è®°å½•å·²å®Œæˆä»»åŠ¡çš„`DKBM`ï¼Œé‡å¯æ—¶è·³è¿‡å·²è®°å½•é¡¹ï¼Œä»…å¤„ç†æœªå®Œæˆè¦ç´ **ã€‚

### äºŒã€æ ¸å¿ƒåŸç†

æ–­ç‚¹ç»­è·‘çš„å®ç°ä¾èµ– 3 ä¸ªå…³é”®æ­¥éª¤ï¼Œæµç¨‹å¦‚ä¸‹ï¼š

æ˜¯

å¦

åˆå§‹åŒ–

åˆ›å»ºæ–­ç‚¹æ–‡ä»¶ breakpoint.txt

è¯»å–å·²å®Œæˆçš„DKBMåˆ—è¡¨

å¾ªç¯å¤„ç†è¦ç´ 

å½“å‰DKBMæ˜¯å¦åœ¨å·²å®Œæˆåˆ—è¡¨ï¼Ÿ

è·³è¿‡è¯¥è¦ç´ 

ç­›é€‰è¦ç´ â†’è®¾ç½®æ ‡æ³¨â†’å¯¼å‡ºJPG

å°†å½“å‰DKBMå†™å…¥æ–­ç‚¹æ–‡ä»¶

æ‰€æœ‰è¦ç´ å¤„ç†å®Œæˆï¼Œè¾“å‡ºç»Ÿè®¡ç»“æœ

* **æ–­ç‚¹æ–‡ä»¶**ï¼šç”¨`breakpoint.txt`å­˜å‚¨å·²æˆåŠŸå¯¼å‡ºçš„`DKBM`ï¼ˆæ¯è¡Œä¸€ä¸ªï¼‰ï¼Œä½œä¸ºè¿›åº¦è®°å½•çš„ â€œå‡­è¯â€ï¼›
* **æ–­ç‚¹æ£€æµ‹**ï¼šè„šæœ¬å¯åŠ¨æ—¶è¯»å–æ–­ç‚¹æ–‡ä»¶ï¼Œç”Ÿæˆå·²å®Œæˆåˆ—è¡¨ï¼Œå¾ªç¯ä¸­é€šè¿‡åˆ¤æ–­`DKBM`æ˜¯å¦åœ¨åˆ—è¡¨ä¸­å†³å®šæ˜¯å¦è·³è¿‡ï¼›
* **å®¹é”™å¤„ç†**ï¼šæ–°å¢é”™è¯¯æ—¥å¿—è®°å½•å¼‚å¸¸ï¼Œç¡®ä¿å•ä¸ªè¦ç´ å¤„ç†å¤±è´¥ä¸å½±å“æ•´ä½“æµç¨‹ã€‚

### ä¸‰ã€å®Œæ•´ä»£ç å®ç°

ä»¥ä¸‹æ˜¯åŒ…å«æ–­ç‚¹ç»­è·‘ã€æ ‡æ³¨é…ç½®ã€é”™è¯¯æ—¥å¿—çš„å®Œæ•´ ArcPy è„šæœ¬ï¼Œå¯ç›´æ¥å¤åˆ¶ä½¿ç”¨ï¼ˆéœ€æ ¹æ®å®é™…è·¯å¾„å’Œå­—æ®µåè°ƒæ•´ï¼‰ï¼š

python

è¿è¡Œ

```

#!/usr/bin/python
# -*- coding: UTF-8 -*-
import arcpy
import sys
import os
import datetime
from arcpy import env
import math

# -------------------------- 1. æ–­ç‚¹å·¥å…·å‡½æ•°ï¼ˆæ ¸å¿ƒï¼‰--------------------------
def init_breakpoint_file(breakpoint_path):
    """åˆå§‹åŒ–æ–­ç‚¹æ–‡ä»¶ï¼šè‹¥ä¸å­˜åœ¨åˆ™åˆ›å»ºç©ºæ–‡ä»¶ï¼Œé¿å…åç»­è¯»å–æŠ¥é”™"""
    if not os.path.exists(breakpoint_path):
        with open(breakpoint_path, 'w', encoding='utf-8') as f:
            f.write("")
        print(f"âœ… åˆå§‹åŒ–æ–­ç‚¹æ–‡ä»¶ï¼š{breakpoint_path}")

def get_completed_dkbms(breakpoint_path):
    """è¯»å–æ–­ç‚¹æ–‡ä»¶ï¼Œè¿”å›å·²å®Œæˆçš„DKBMåˆ—è¡¨ï¼ˆå»é‡ã€å»ç©ºï¼‰"""
    completed = []
    if os.path.exists(breakpoint_path):
        with open(breakpoint_path, 'r', encoding='utf-8') as f:
            lines = f.readlines()
            completed = [line.strip() for line in lines if line.strip()]
    print(f"ğŸ“Š å·²å®Œæˆå¯¼å‡ºçš„DKBMæ•°é‡ï¼š{len(completed)}")
    return completed

def add_completed_dkbm(breakpoint_path, dkbm):
    """å°†å·²å®Œæˆçš„DKBMå†™å…¥æ–­ç‚¹æ–‡ä»¶ï¼ˆé¿å…é‡å¤å†™å…¥ï¼‰"""
    completed = get_completed_dkbms(breakpoint_path)
    if dkbm not in completed:
        with open(breakpoint_path, 'a', encoding='utf-8') as f:
            f.write(f"{dkbm}\n")
        print(f"ğŸ“ è®°å½•å®Œæˆï¼šDKBM={dkbm}")

# -------------------------- 2. è¾…åŠ©å·¥å…·å‡½æ•° --------------------------
def mkdir(path):
    """åˆ›å»ºç›®å½•ï¼ˆè‹¥ä¸å­˜åœ¨ï¼‰"""
    path = path.strip().rstrip("\\")
    if not os.path.exists(path):
        os.makedirs(path)
        print(f"ğŸ“ ç›®å½•åˆ›å»ºæˆåŠŸï¼š{path}")
        return True
    else:
        print(f"â„¹ï¸  ç›®å½•å·²å­˜åœ¨ï¼š{path}")
        return False

# -------------------------- 3. ä¸»é€»è¾‘ï¼ˆæ–­ç‚¹ç»­è·‘æ ¸å¿ƒï¼‰--------------------------
if __name__ == "__main__":
    # ====================== 1. åŸºç¡€å‚æ•°é…ç½®ï¼ˆéœ€æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹ï¼‰======================
    img_width = 300       # å¯¼å‡ºJPGå®½åº¦ï¼ˆåƒç´ ï¼‰
    img_height = 200      # å¯¼å‡ºJPGé«˜åº¦ï¼ˆåƒç´ ï¼‰
    img_resolution = 90   # å¯¼å‡ºJPGåˆ†è¾¨ç‡ï¼ˆDPIï¼‰
    scale_expand = 1.1    # ç¼©æ”¾ç³»æ•°ï¼ˆç¼©æ”¾è‡³è¦ç´ åæ‰©å¤§10%ï¼Œé¿å…è¦ç´ è´´è¾¹ï¼‰
    select_field = "DKBM" # ç”¨äºç­›é€‰è¦ç´ å’Œå‘½åæ–‡ä»¶çš„å­—æ®µ
    label_field = "ZW"    # ç”¨äºåœ°å›¾æ ‡æ³¨çš„å­—æ®µ

    # æ–‡ä»¶è·¯å¾„é…ç½®ï¼ˆWindowsè·¯å¾„éœ€åŠ rè½¬ä¹‰ï¼Œé¿å…åæ–œæ é—®é¢˜ï¼‰
    mxd_path = r"E:\gzct\gzct.mxd"                 # MXDåœ°å›¾æ–‡æ¡£è·¯å¾„
    out_dir = r"E:\gzct\export_jpg"                # JPGå¯¼å‡ºç›®å½•
    shp_path = r"E:\gzct\dk6209222021_241106_2.shp"# çŸ¢é‡è¦ç´ ç±»è·¯å¾„
    breakpoint_path = os.path.join(out_dir, "breakpoint.txt") # æ–­ç‚¹æ–‡ä»¶è·¯å¾„
    error_log_path = os.path.join(out_dir, "error_log.txt")   # é”™è¯¯æ—¥å¿—è·¯å¾„

    # ====================== 2. åˆå§‹åŒ–ï¼šç›®å½•ä¸æ–­ç‚¹æ–‡ä»¶ ======================
    mkdir(out_dir)                # ç¡®ä¿å¯¼å‡ºç›®å½•å­˜åœ¨
    init_breakpoint_file(breakpoint_path)  # åˆå§‹åŒ–æ–­ç‚¹æ–‡ä»¶
    completed_dkbms = get_completed_dkbms(breakpoint_path)  # è¯»å–å·²å®Œæˆåˆ—è¡¨

    # ====================== 3. åŠ è½½ArcGISèµ„æºï¼ˆMXDã€å›¾å±‚ã€æ•°æ®æ¡†ï¼‰======================
    try:
        # åŠ è½½MXDæ–‡æ¡£
        mxd = arcpy.mapping.MapDocument(mxd_path)
        # è·å–ç¬¬ä¸€ä¸ªæ•°æ®æ¡†ï¼ˆè‹¥æœ‰å¤šä¸ªï¼Œéœ€æŒ‡å®šåç§°ï¼Œå¦‚ListDataFrames(mxd, "æ•°æ®æ¡†1")ï¼‰
        df = arcpy.mapping.ListDataFrames(mxd)[0]
        # è·å–ç›®æ ‡å›¾å±‚ï¼ˆè‹¥æœ‰å¤šä¸ªï¼Œéœ€æŒ‡å®šåç§°ï¼Œå¦‚ListLayers(mxd, "åœ°å—å›¾å±‚", df)[0]ï¼‰
        target_layer = arcpy.mapping.ListLayers(mxd, "", df)[0]
        
        print(f"âœ… æˆåŠŸåŠ è½½èµ„æºï¼š")
        print(f"   - MXDæ–‡æ¡£ï¼š{mxd_path}")
        print(f"   - æ•°æ®æ¡†ï¼š{df.name}")
        print(f"   - ç›®æ ‡å›¾å±‚ï¼š{target_layer.name}")
    except Exception as e:
        print(f"âŒ åŠ è½½ArcGISèµ„æºå¤±è´¥ï¼š{str(e)}")
        sys.exit(1)  # èµ„æºåŠ è½½å¤±è´¥ï¼Œç›´æ¥é€€å‡ºè„šæœ¬

    # ====================== 4. ç»Ÿè®¡æ€»è¦ç´ æ•°ï¼ˆå¯é€‰ï¼Œç”¨äºè¿›åº¦å±•ç¤ºï¼‰======================
    try:
        with arcpy.da.SearchCursor(shp_path, [select_field]) as count_cursor:
            total_features = sum(1 for _ in count_cursor)  # ç»Ÿè®¡æ€»è¦ç´ æ•°
        print(f"ğŸ“Š è¦ç´ ç±»ç»Ÿè®¡ï¼šæ€»è¦ç´ æ•°={total_features}ï¼Œå·²å®Œæˆæ•°={len(completed_dkbms)}")
    except Exception as e:
        print(f"âš ï¸  ç»Ÿè®¡æ€»è¦ç´ æ•°å¤±è´¥ï¼š{str(e)}ï¼Œå°†è·³è¿‡ç»Ÿè®¡")
        total_features = "æœªçŸ¥"

    # ====================== 5. æ–­ç‚¹ç»­è·‘ï¼šæ‰¹é‡å¤„ç†è¦ç´  ======================
    processed_count = 0  # æœ¬æ¬¡å¤„ç†çš„æœªå®Œæˆè¦ç´ æ•°
    skipped_count = 0    # æœ¬æ¬¡è·³è¿‡çš„å·²å®Œæˆè¦ç´ æ•°

    # ä½¿ç”¨da.SearchCursoré«˜æ•ˆéå†è¦ç´ ï¼ˆæ¯”æ—§ç‰ˆCursoræ›´å¿«ã€æ›´ç¨³å®šï¼‰
    with arcpy.da.SearchCursor(shp_path, [select_field, label_field]) as cursor:
        for row in cursor:
            current_dkbm = str(row[0]).strip()  # å½“å‰è¦ç´ çš„DKBMï¼ˆå»ç©ºæ ¼ï¼Œé¿å…åŒ¹é…é—®é¢˜ï¼‰
            current_zw = str(row[1]).strip()     # å½“å‰è¦ç´ çš„æ ‡æ³¨æ–‡æœ¬

            # -------------------------- 5.1 æ–­ç‚¹åˆ¤æ–­ï¼šè·³è¿‡å·²å®Œæˆè¦ç´  --------------------------
            if current_dkbm in completed_dkbms:
                skipped_count += 1
                print(f"â„¹ï¸  è·³è¿‡å·²å®Œæˆï¼šDKBM={current_dkbm}ï¼ˆç´¯è®¡è·³è¿‡ï¼š{skipped_count}ï¼‰")
                continue

            # -------------------------- 5.2 å¤„ç†æœªå®Œæˆè¦ç´ ï¼šç­›é€‰â†’æ ‡æ³¨â†’å¯¼å‡º --------------------------
            try:
                # 5.2.1 æŒ‰DKBMç­›é€‰è¦ç´ ï¼ˆæ„å»ºSQLæ¡ä»¶ï¼Œæ³¨æ„å­—æ®µååŠ åŒå¼•å·ï¼Œå€¼åŠ å•å¼•å·ï¼‰
                where_clause = f'"{select_field}" = \'{current_dkbm}\''
                arcpy.SelectLayerByAttribute_management(
                    in_layer_or_view=target_layer,
                    selection_type="NEW_SELECTION",  # æ–°å»ºé€‰æ‹©é›†
                    where_clause=where_clause
                )

                # 5.2.2 æ£€æŸ¥æ˜¯å¦æœ‰åŒ¹é…çš„é€‰ä¸­è¦ç´ 
                selected_count = int(arcpy.GetCount_management(target_layer).getOutput(0))
                if selected_count == 0:
                    print(f"âš ï¸  æ— åŒ¹é…è¦ç´ ï¼šDKBM={current_dkbm}ï¼Œè·³è¿‡")
                    continue

                # 5.2.3 ç¼©æ”¾è‡³é€‰ä¸­è¦ç´ ï¼ˆå¹¶æ‰©å¤§è§†é‡ï¼Œé¿å…è¦ç´ è´´è¾¹ï¼‰
                df.zoomToSelectedFeatures()  # ç¼©æ”¾è‡³é€‰ä¸­è¦ç´ èŒƒå›´
                df.scale = df.scale * scale_expand  # æ‰©å¤§è§†é‡ï¼ˆå¯æ ¹æ®éœ€æ±‚è°ƒæ•´ç³»æ•°ï¼‰
                arcpy.RefreshActiveView()  # åˆ·æ–°è§†å›¾ï¼Œç¡®ä¿ç¼©æ”¾ç”Ÿæ•ˆ

                # 5.2.4 é…ç½®æ ‡æ³¨ï¼ˆä»…æ˜¾ç¤ºå½“å‰é€‰ä¸­è¦ç´ çš„æ ‡æ³¨ï¼Œé¿å…å¹²æ‰°ï¼‰
                if target_layer.supports("LABELCLASSES"):  # æ£€æŸ¥å›¾å±‚æ˜¯å¦æ”¯æŒæ ‡æ³¨ç±»
                    lbl_class = target_layer.labelClasses[0]  # è·å–ç¬¬ä¸€ä¸ªæ ‡æ³¨ç±»
                    lbl_class.expression = f"[{label_field}]"  # è®¾ç½®æ ‡æ³¨å­—æ®µï¼ˆå¦‚[ZW]ï¼‰
                    lbl_class.SQLQuery = where_clause  # ä»…æ ‡æ³¨å½“å‰é€‰ä¸­è¦ç´ ï¼ˆå…³é”®ï¼ï¼‰
                    target_layer.showLabels = True  # å¯ç”¨æ ‡æ³¨
                    arcpy.RefreshActiveView()  # åˆ·æ–°æ ‡æ³¨ï¼Œç¡®ä¿ç”Ÿæ•ˆ
                else:
                    print(f"âš ï¸  å›¾å±‚{target_layer.name}ä¸æ”¯æŒæ ‡æ³¨ç±»ï¼Œè·³è¿‡æ ‡æ³¨è®¾ç½®")

                # 5.2.5 å¯¼å‡ºJPGåœ°å›¾
                jpg_name = f"{current_dkbm}.jpg"  # ä»¥DKBMå‘½åJPGæ–‡ä»¶
                jpg_path = os.path.join(out_dir, jpg_name)  # å®Œæ•´JPGè·¯å¾„

                # è°ƒç”¨ExportToJPEGå‡½æ•°å¯¼å‡º
                arcpy.mapping.ExportToJPEG(
                    map_document=mxd,
                    out_jpeg=jpg_path,
                    data_frame=df,          # å¯¼å‡ºçš„æ•°æ®æ¡†
                    width=img_width,        # å›¾ç‰‡å®½åº¦
                    height=img_height,      # å›¾ç‰‡é«˜åº¦
                    resolution=img_resolution,  # å›¾ç‰‡åˆ†è¾¨ç‡
                    world_file=False        # æ˜¯å¦ç”Ÿæˆä¸–ç•Œæ–‡ä»¶ï¼ˆ.jgwï¼‰ï¼ŒæŒ‰éœ€å¼€å¯
                )
                print(f"âœ… å¯¼å‡ºæˆåŠŸï¼š{jpg_path}ï¼ˆæœ¬æ¬¡å¤„ç†ï¼š{processed_count + 1}ï¼‰")

                # 5.2.6 è®°å½•æ–­ç‚¹ï¼šä»…å½“å¯¼å‡ºæˆåŠŸæ—¶ï¼Œæ‰å°†DKBMå†™å…¥æ–­ç‚¹æ–‡ä»¶
                add_completed_dkbm(breakpoint_path, current_dkbm)
                processed_count += 1

            # -------------------------- 5.3 å¼‚å¸¸å¤„ç†ï¼šå•ä¸ªè¦ç´ å¤±è´¥ä¸å½±å“æ•´ä½“ --------------------------
            except Exception as e:
                error_msg = f"å¤„ç†DKBM={current_dkbm}æ—¶å‡ºé”™ï¼š{str(e)}"
                print(f"âŒ {error_msg}")
                # å°†é”™è¯¯ä¿¡æ¯å†™å…¥æ—¥å¿—æ–‡ä»¶ï¼Œä¾¿äºåç»­æ’æŸ¥
                with open(error_log_path, 'a', encoding='utf-8') as err_f:
                    err_f.write(f"[{datetime.datetime.now()}] {error_msg}\n")
                continue  # è·³è¿‡å½“å‰é”™è¯¯è¦ç´ ï¼Œç»§ç»­å¤„ç†ä¸‹ä¸€ä¸ª

    # ====================== 6. æ¸…ç†èµ„æºä¸è¾“å‡ºæœ€ç»ˆç»Ÿè®¡ ======================
    # æ¸…ç†ArcGISèµ„æºï¼ˆé¿å…å†…å­˜æ³„æ¼ï¼‰
    arcpy.SelectLayerByAttribute_management(target_layer, "CLEAR_SELECTION")  # æ¸…é™¤é€‰æ‹©é›†
    del mxd, df, target_layer  # åˆ é™¤MXDã€æ•°æ®æ¡†ã€å›¾å±‚å¯¹è±¡
    arcpy.RefreshActiveView()  # åˆ·æ–°è§†å›¾
    arcpy.RefreshTOC()         # åˆ·æ–°ç›®å½•è¡¨

    # è¾“å‡ºæœ€ç»ˆç»Ÿè®¡ç»“æœ
    print("\n" + "="*60)
    print("ğŸ¯ æ–­ç‚¹ç»­è·‘ä»»åŠ¡å®Œæˆï¼")
    print(f"ğŸ“Š ç»Ÿè®¡æ±‡æ€»ï¼š")
    print(f"   - æ€»è¦ç´ æ•°ï¼š{total_features}")
    print(f"   - å·²å®Œæˆæ€»æ•°ï¼ˆå«å†å²ï¼‰ï¼š{len(get_completed_dkbms(breakpoint_path))}")
    print(f"   - æœ¬æ¬¡å¤„ç†æ•°ï¼š{processed_count}")
    print(f"   - æœ¬æ¬¡è·³è¿‡æ•°ï¼š{skipped_count}")
    print(f"ğŸ“ å…³é”®æ–‡ä»¶è·¯å¾„ï¼š")
    print(f"   - æ–­ç‚¹æ–‡ä»¶ï¼š{breakpoint_path}")
    print(f"   - é”™è¯¯æ—¥å¿—ï¼š{error_log_path}")
    print("="*60)

```

### å››ã€ä½¿ç”¨æ•™ç¨‹

#### 1. ç¯å¢ƒå‡†å¤‡

* å®‰è£… ArcGIS Desktopï¼ˆ10.2+ï¼‰æˆ– ArcGIS Proï¼Œç¡®ä¿`arcpy`æ¨¡å—å¯ç”¨ï¼›
* ç¡®ä¿çŸ¢é‡è¦ç´ ç±»ï¼ˆ.shpï¼‰ã€MXD æ–‡æ¡£è·¯å¾„æ­£ç¡®ï¼Œä¸”å­—æ®µåï¼ˆ`DKBM`ã€`ZW`ï¼‰ä¸è„šæœ¬é…ç½®ä¸€è‡´ã€‚

#### 2. è„šæœ¬è°ƒæ•´ï¼ˆå…³é”®ï¼ï¼‰

æ ¹æ®ä½ çš„æ•°æ®ä¿®æ”¹ä»¥ä¸‹å‚æ•°ï¼ˆè„šæœ¬ä¸­å·²æ ‡æ³¨ â€œéœ€æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹â€ï¼‰ï¼š

| å‚æ•°å | è¯´æ˜ | ç¤ºä¾‹ |
| --- | --- | --- |
| `mxd_path` | MXD åœ°å›¾æ–‡æ¡£è·¯å¾„ | `r"E:\Project\map.mxd"` |
| `out_dir` | JPG å¯¼å‡ºç›®å½• | `r"E:\Project\export"` |
| `shp_path` | çŸ¢é‡è¦ç´ ç±»è·¯å¾„ | `r"E:\Project\data\parcels.shp"` |
| `select_field` | ç­›é€‰ / å‘½åå­—æ®µ | `"DKBM"`ï¼ˆä½ çš„è¦ç´ ç±»ä¸­ç”¨äºå”¯ä¸€æ ‡è¯†çš„å­—æ®µï¼‰ |
| `label_field` | æ ‡æ³¨å­—æ®µ | `"ZW"`ï¼ˆä½ çš„è¦ç´ ç±»ä¸­ç”¨äºæ ‡æ³¨çš„å­—æ®µï¼‰ |
| `img_width/img_height` | å¯¼å‡ºå›¾ç‰‡å°ºå¯¸ | `500`/`400`ï¼ˆæ ¹æ®éœ€æ±‚è°ƒæ•´ï¼‰ |

#### 3. è¿è¡Œè„šæœ¬

* æ‰“å¼€ ArcGIS çš„ Python çª—å£ï¼ˆArcMapâ†’åœ°ç†å¤„ç†â†’Pythonï¼‰ï¼›
* å°†è„šæœ¬å¤åˆ¶åˆ° Python çª—å£ï¼ŒæŒ‰ Enter è¿è¡Œï¼›
* è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œè„šæœ¬ä¼šå®æ—¶æ‰“å°è¿›åº¦ï¼ˆå¦‚ â€œè·³è¿‡å·²å®Œæˆâ€â€œå¯¼å‡ºæˆåŠŸâ€ï¼‰ã€‚

#### 4. ä¸­æ–­åç»­è·‘

è‹¥è„šæœ¬ä¸­æ–­ï¼ˆå¦‚å…³é—­çª—å£ã€ç”µè„‘é‡å¯ï¼‰ï¼Œåªéœ€é‡æ–°è¿è¡Œè„šæœ¬ï¼š

* è„šæœ¬ä¼šè‡ªåŠ¨è¯»å–`breakpoint.txt`ä¸­çš„å·²å®Œæˆ`DKBM`ï¼›
* è·³è¿‡æ‰€æœ‰å·²å¯¼å‡ºçš„è¦ç´ ï¼Œç›´æ¥å¤„ç†æœªå®Œæˆé¡¹ã€‚

#### 5. é‡ç½®ä»»åŠ¡

è‹¥éœ€é‡æ–°å¤„ç†æ‰€æœ‰è¦ç´ ï¼ˆå¦‚ä¿®æ”¹äº†å¯¼å‡ºå‚æ•°ï¼‰ï¼Œåªéœ€ï¼š

1. åˆ é™¤å¯¼å‡ºç›®å½•ä¸‹çš„`breakpoint.txt`æ–‡ä»¶ï¼›
2. ï¼ˆå¯é€‰ï¼‰åˆ é™¤å·²å¯¼å‡ºçš„ JPG æ–‡ä»¶ï¼›
3. é‡æ–°è¿è¡Œè„šæœ¬ï¼Œè„šæœ¬ä¼šä»å¤´å¼€å§‹å¤„ç†ã€‚

### äº”ã€å…³é”®ä¼˜åŒ–ç‚¹ä¸æ³¨æ„äº‹é¡¹

#### 1. æ€§èƒ½ä¼˜åŒ–

* ä½¿ç”¨`arcpy.da.SearchCursor`ï¼šæ¯”æ—§ç‰ˆ`arcpy.SearchCursor`æ›´å¿«ï¼Œæ”¯æŒæ‰¹é‡å­—æ®µè¯»å–ï¼Œå‡å°‘å†…å­˜å ç”¨ï¼›
* é¿å…é‡å¤åŠ è½½èµ„æºï¼šMXDã€å›¾å±‚ç­‰èµ„æºä»…åŠ è½½ä¸€æ¬¡ï¼Œè€Œéå¾ªç¯ä¸­é‡å¤åŠ è½½ï¼›
* è¿›åº¦ç»Ÿè®¡ï¼šå¯é€‰ç»Ÿè®¡æ€»è¦ç´ æ•°ï¼Œä¾¿äºé¢„ä¼°å‰©ä½™æ—¶é—´ã€‚

#### 2. å®¹é”™å¤„ç†

* èµ„æºåŠ è½½å¤±è´¥ï¼šç›´æ¥é€€å‡ºè„šæœ¬ï¼Œé¿å…åç»­æŠ¥é”™ï¼›
* æ— åŒ¹é…è¦ç´ ï¼šè·³è¿‡è¯¥è¦ç´ ï¼Œä¸ç»ˆæ­¢è„šæœ¬ï¼›
* å¼‚å¸¸æ—¥å¿—ï¼šå°†é”™è¯¯ä¿¡æ¯å†™å…¥`error_log.txt`ï¼Œä¾¿äºæ’æŸ¥ï¼ˆå¦‚ â€œå­—æ®µä¸å­˜åœ¨â€â€œæƒé™ä¸è¶³â€ï¼‰ã€‚

#### 3. å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

| é—®é¢˜ç°è±¡ | å¯èƒ½åŸå›  | è§£å†³æ–¹æ¡ˆ |
| --- | --- | --- |
| è„šæœ¬æç¤º â€œåŠ è½½ MXD å¤±è´¥â€ | MXD è·¯å¾„é”™è¯¯ / æ–‡ä»¶æŸå | æ£€æŸ¥`mxd_path`æ˜¯å¦æ­£ç¡®ï¼Œå°è¯•æ‰‹åŠ¨æ‰“å¼€ MXD ç¡®è®¤æ˜¯å¦æ­£å¸¸ |
| æ— è¦ç´ è¢«ç­›é€‰ | `select_field`å­—æ®µåé”™è¯¯ / SQL æ¡ä»¶æ ¼å¼é—®é¢˜ | 1. ç¡®è®¤å­—æ®µåä¸è¦ç´ ç±»ä¸€è‡´ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰ï¼›2. æ£€æŸ¥ SQL æ¡ä»¶æ ¼å¼ï¼ˆå¦‚å­—æ®µåŠ åŒå¼•å·ï¼Œå€¼åŠ å•å¼•å·ï¼‰ |
| æ ‡æ³¨ä¸æ˜¾ç¤º | å›¾å±‚ä¸æ”¯æŒæ ‡æ³¨ç±» / æ ‡æ³¨å­—æ®µé”™è¯¯ | 1. åœ¨ ArcMap ä¸­æ‰‹åŠ¨æµ‹è¯•æ ‡æ³¨æ˜¯å¦æ­£å¸¸ï¼›2. ç¡®è®¤`label_field`å­—æ®µåæ­£ç¡® |
| æ–­ç‚¹æ–‡ä»¶ä¸æ›´æ–° | å¯¼å‡º JPG å¤±è´¥ / æƒé™ä¸è¶³ | 1. æ£€æŸ¥å¯¼å‡ºç›®å½•æ˜¯å¦æœ‰å†™å…¥æƒé™ï¼›2. æŸ¥çœ‹`error_log.txt`æ˜¯å¦æœ‰å¯¼å‡ºç›¸å…³é”™è¯¯ |

### å…­ã€æ‰©å±•åœºæ™¯

æœ¬è„šæœ¬çš„æ–­ç‚¹ç»­è·‘é€»è¾‘



