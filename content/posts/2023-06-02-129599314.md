---
layout: post
title: "数据库系统概论作业6-第八章-习题2第九章-习题9"
date: 2023-06-02 13:03:25 +0800
description: "试画出用关系代数表示的语法树，并用关系代数表达式优化算法对原始的语法树进行优化处理，画出优化后的标准"
keywords: "数据库应用技术8章9章课后答案"
categories: ['数据库系统概论']
tags: ['数据库', 'Sql']
artid: "129599314"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=129599314
    alt: "数据库系统概论作业6-第八章-习题2第九章-习题9"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=129599314
featuredImagePreview: https://bing.ee123.net/img/rand?artid=129599314
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     【数据库系统概论】作业6 第八章 习题2、第九章 习题9
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <div class="toc">
     <h4>
      文章目录
     </h4>
     <ul>
      <li>
       <ul>
        <li>
         <a href="#_1" rel="nofollow">
          一、要求：
         </a>
        </li>
        <li>
         <a href="#_3" rel="nofollow">
          二、题目：
         </a>
        </li>
        <li>
         <a href="#__5" rel="nofollow">
          第八章 数据库编程
         </a>
        </li>
        <li>
         <ul>
          <li>
           <ul>
            <li>
             <a href="#2_6" rel="nofollow">
              2.对学生-课程数据库编写存储过程，完成下述功能∶
             </a>
            </li>
           </ul>
          </li>
         </ul>
        </li>
        <li>
         <a href="#__88" rel="nofollow">
          第九章 关系查询处理和查询优化
         </a>
        </li>
        <li>
         <ul>
          <li>
           <ul>
            <li>
             <a href="#3_89" rel="nofollow">
              3.对学生-课程数据库，查询信息系学生选修了的所有课程名称。
             </a>
            </li>
           </ul>
          </li>
         </ul>
        </li>
       </ul>
      </li>
     </ul>
    </div>
    <p>
    </p>
    <h3>
     <a id="_1">
     </a>
     一、要求：
    </h3>
    <p>
     1.请完成第8、9章作业，习题8第2题，习题9第3题，提交文档。
    </p>
    <h3>
     <a id="_3">
     </a>
     二、题目：
    </h3>
    <h3>
     <a id="__5">
     </a>
     第八章 数据库编程
    </h3>
    <h5>
     <a id="2_6">
     </a>
     2.对学生-课程数据库编写存储过程，完成下述功能∶
    </h5>
    <p>
     （1）统计离散数学的成绩分布情况，即按照各分数段统计人数
     <br/>
     1.建表Rank
    </p>
    <pre><code class="prism language-sql"><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> Rank<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Rank<span class="token punctuation">(</span>
	Grade <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>              <span class="token comment">-- 成绩划分等级</span>
	num <span class="token keyword">INT</span>            <span class="token comment">-- 该分数段人数</span>
<span class="token punctuation">)</span>
</code></pre>
    <pre><code class="prism language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Rank
<span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">'[0,20)'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'[20,40)'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'[40,60)'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'[60,80)'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'[80,100]'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Rank
</code></pre>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/a2d58f271fe6c176be3f97378fb65880.png"/>
    </p>
    <pre><code class="prism language-sql"><span class="token keyword">IF</span><span class="token punctuation">(</span><span class="token keyword">EXISTS</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> sys<span class="token punctuation">.</span>objects <span class="token keyword">WHERE</span> name<span class="token operator">=</span><span class="token string">'Proc_Grade'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">DROP</span> <span class="token keyword">PROCEDURE</span> Proc_Grade
GO 
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> Proc_Grade
<span class="token keyword">AS</span> 
<span class="token keyword">DECLARE</span> 
<span class="token variable">@less20</span> <span class="token keyword">INT</span><span class="token punctuation">,</span>
<span class="token variable">@20to40</span> <span class="token keyword">INT</span><span class="token punctuation">,</span>
<span class="token variable">@40to60</span> <span class="token keyword">INT</span><span class="token punctuation">,</span>
<span class="token variable">@60to80</span> <span class="token keyword">INT</span><span class="token punctuation">,</span>
<span class="token variable">@80to100</span> <span class="token keyword">INT</span><span class="token punctuation">,</span>
<span class="token variable">@Cno</span> <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token variable">@Cno</span><span class="token operator">=</span>Cno <span class="token keyword">FROM</span> Course <span class="token keyword">WHERE</span> Cname<span class="token operator">=</span><span class="token string">'离散数学'</span><span class="token punctuation">;</span><span class="token comment">--统计各个分数段人数</span>
</code></pre>
    <pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token variable">@less20</span><span class="token operator">=</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> Grade<span class="token operator">&lt;</span><span class="token number">20</span> <span class="token operator">AND</span> Cno<span class="token operator">=</span><span class="token variable">@Cno</span><span class="token punctuation">;</span> <span class="token comment">-- 将该分数段的人存储在@less20中</span>
</code></pre>
    <pre><code class="prism language-sql"><span class="token keyword">UPDATE</span> Rank <span class="token keyword">SET</span> num<span class="token operator">=</span><span class="token variable">@less20</span> <span class="token keyword">WHERE</span> Grade<span class="token operator">=</span><span class="token string">'[0,20)'</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token variable">@20to40</span><span class="token operator">=</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> Grade<span class="token operator">&lt;</span><span class="token number">40</span> <span class="token operator">AND</span> Grade<span class="token operator">&gt;=</span><span class="token number">20</span> <span class="token operator">AND</span> Cno<span class="token operator">=</span><span class="token variable">@Cno</span><span class="token punctuation">;</span>
</code></pre>
    <pre><code class="prism language-sql"><span class="token keyword">UPDATE</span> Rank <span class="token keyword">SET</span> num<span class="token operator">=</span><span class="token variable">@20to40</span> <span class="token keyword">WHERE</span> Grade<span class="token operator">=</span><span class="token string">'[20,40)'</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token variable">@40to60</span><span class="token operator">=</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> Grade<span class="token operator">&lt;</span><span class="token number">60</span> <span class="token operator">AND</span> Grade<span class="token operator">&gt;=</span><span class="token number">40</span> <span class="token operator">AND</span> Cno<span class="token operator">=</span><span class="token variable">@Cno</span><span class="token punctuation">;</span>
</code></pre>
    <pre><code class="prism language-sql"><span class="token keyword">UPDATE</span> Rank <span class="token keyword">SET</span> num<span class="token operator">=</span><span class="token variable">@40to60</span> <span class="token keyword">WHERE</span> Grade<span class="token operator">=</span><span class="token string">'[40,60)'</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token variable">@60to80</span><span class="token operator">=</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> Grade<span class="token operator">&lt;</span><span class="token number">80</span> <span class="token operator">AND</span> Grade<span class="token operator">&gt;=</span><span class="token number">60</span> <span class="token operator">AND</span> Cno<span class="token operator">=</span><span class="token variable">@Cno</span><span class="token punctuation">;</span>
</code></pre>
    <pre><code class="prism language-sql"><span class="token keyword">UPDATE</span> Rank <span class="token keyword">SET</span> num<span class="token operator">=</span><span class="token variable">@60to80</span> <span class="token keyword">WHERE</span> Grade<span class="token operator">=</span><span class="token string">'[60,80)'</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token variable">@80to100</span><span class="token operator">=</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> Grade<span class="token operator">&lt;=</span><span class="token number">100</span> <span class="token operator">AND</span> Grade<span class="token operator">&gt;=</span><span class="token number">80</span> <span class="token operator">AND</span> Cno<span class="token operator">=</span><span class="token variable">@Cno</span><span class="token punctuation">;</span>
</code></pre>
    <pre><code class="prism language-sql"><span class="token keyword">UPDATE</span> Rank <span class="token keyword">SET</span> num<span class="token operator">=</span><span class="token variable">@80to100</span> <span class="token keyword">WHERE</span> Grade<span class="token operator">=</span><span class="token string">'[80,100]'</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     创建好存储过程后运行，必须先创建，再EXEC。
    </p>
    <pre><code class="prism language-sql"><span class="token keyword">EXEC</span> Proc_Grade<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span><span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> Cno<span class="token operator">=</span><span class="token number">8</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span><span class="token keyword">FROM</span> Rank
</code></pre>
    <h3>
     <a id="__88">
     </a>
     第九章 关系查询处理和查询优化
    </h3>
    <h5>
     <a id="3_89">
     </a>
     3.对学生-课程数据库，查询信息系学生选修了的所有课程名称。
    </h5>
    <pre><code class="prism language-sql"><span class="token keyword">SELECT</span> Cname
<span class="token keyword">FROM</span> Student<span class="token punctuation">,</span> Course<span class="token punctuation">,</span> SC
<span class="token keyword">WHERE</span> Student<span class="token punctuation">.</span>Sno<span class="token operator">=</span>SC<span class="token punctuation">.</span>Sno <span class="token operator">AND</span> SC<span class="token punctuation">.</span>Cno<span class="token operator">=</span>Course<span class="token punctuation">.</span>Cno <span class="token operator">AND</span> Student<span class="token punctuation">.</span>Sdept<span class="token operator">=</span><span class="token string">'IS'</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     试画出用关系代数表示的语法树，并用关系代数表达式优化算法对原始的语法树进行优化处理，画出优化后的标准语法树。
     <br/>
     最初的语法树：
     <br/>
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/fc8779f6c40dc62535d3d0cac6493fe3.png">
      <br/>
      关系代数语法树：
      <br/>
      <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/f75e9ac9803bb464342ff83a5fe1614f.png">
       <br/>
       优化后：
       <br/>
       <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/743047ba4390b6dd666f5411f5ec1eeb.png"/>
      </img>
     </img>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
  <div class="blog-extension-box" id="blogExtensionBox" style="width:400px;margin:auto;margin-top:12px">
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34343839333930322f:61727469636c652f64657461696c732f313239353939333134" class_="artid" style="display:none">
 </p>
</div>


