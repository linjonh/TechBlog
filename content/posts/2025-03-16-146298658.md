---
layout: post
title: "记如何理解kotlin中的委托属性"
date: 2025-03-16 18:14:14 +0800
description: "委托属性的核心思想是：通过委托属性，你可以：在 Kotlin 中，委托属性的语法如下：\t：用于将属性的  和  委托给一个外部对象（）。\t：一个实现了  和  方法的对象，负责处理属性的存储和逻辑。3. 委托属性的示例例 1：简单的委托属性假设我们有一个  类，它实现了  和  方法：\t：用于获取属性的值。\t：用于设置属性的值。然后，我们可以在类中使用这个委托：\t：这个属性的  和  被委托给 。使用效果：例 2：懒加载属性（Lazy Prope"
keywords: "【记】如何理解kotlin中的委托属性？"
categories: ['Kotlin']
tags: ['开发语言', 'Kotlin', 'Android']
artid: "146298658"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146298658
    alt: "记如何理解kotlin中的委托属性"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146298658
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146298658
cover: https://bing.ee123.net/img/rand?artid=146298658
image: https://bing.ee123.net/img/rand?artid=146298658
img: https://bing.ee123.net/img/rand?artid=146298658
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     【记】如何理解kotlin中的委托属性？
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h2>
     <strong>
      1. 什么是委托属性？
     </strong>
    </h2>
    <p>
     委托属性的核心思想是：
    </p>
    <ul>
     <li>
      你可以将一个属性的
      <code>
       getter
      </code>
      和
      <code>
       setter
      </code>
      的逻辑交给一个外部对象（称为委托对象）来处理。
     </li>
     <li>
      这个外部对象负责存储属性的值，并提供自定义的
      <code>
       get
      </code>
      和
      <code>
       set
      </code>
      行为。
     </li>
    </ul>
    <p>
     通过委托属性，你可以：
    </p>
    <ol>
     <li>
      简化代码，避免重复。
     </li>
     <li>
      实现属性的懒加载（Lazy Properties）。
     </li>
     <li>
      监听属性的变化（Observable Properties）。
     </li>
     <li>
      将属性的存储和逻辑分离。
     </li>
    </ol>
    <hr/>
    <h2>
     2.
     <strong>
      委托属性的基本语法
     </strong>
    </h2>
    <p>
     在 Kotlin 中，委托属性的语法如下：
    </p>
    <pre><code class="language-Kotlin">class MyClass {
    var property: Type by Delegate
}
</code></pre>
    <ul>
     <li>
      <strong>
       <code>
        by
       </code>
      </strong>
      ：用于将属性的
      <code>
       getter
      </code>
      和
      <code>
       setter
      </code>
      委托给一个外部对象（
      <code>
       Delegate
      </code>
      ）。
     </li>
     <li>
      <strong>
       <code>
        Delegate
       </code>
      </strong>
      ：一个实现了
      <code>
       getProperty
      </code>
      和
      <code>
       setProperty
      </code>
      方法的对象，负责处理属性的存储和逻辑。
     </li>
    </ul>
    <hr/>
    <h2>
     3.
     <strong>
      委托属性的示例
     </strong>
    </h2>
    <h3>
     例 1：简单的委托属性
    </h3>
    <p>
     假设我们有一个
     <code>
      Delegate
     </code>
     类，它实现了
     <code>
      getProperty
     </code>
     和
     <code>
      setProperty
     </code>
     方法：
    </p>
    <pre><code class="language-Kotlin">class SimpleDelegate {
    private var value: Int = 0

    operator fun getValue(thisRef: Any?, property: KProperty&lt;*&gt;): Int {
        return value
    }

    operator fun setValue(thisRef: Any?, property: KProperty&lt;*&gt;, value: Int) {
        this.value = value
    }
}
</code></pre>
    <ul>
     <li>
      <strong>
       <code>
        getValue
       </code>
      </strong>
      ：用于获取属性的值。
     </li>
     <li>
      <strong>
       <code>
        setValue
       </code>
      </strong>
      ：用于设置属性的值。
     </li>
    </ul>
    <p>
     然后，我们可以在类中使用这个委托：
    </p>
    <pre><code class="language-Kotlin">class MyClass {
    var number: Int by SimpleDelegate()
}
</code></pre>
    <ul>
     <li>
      <strong>
       <code>
        number
       </code>
      </strong>
      ：这个属性的
      <code>
       getter
      </code>
      和
      <code>
       setter
      </code>
      被委托给
      <code>
       SimpleDelegate
      </code>
      。
     </li>
    </ul>
    <p>
     使用效果：
    </p>
    <pre><code class="language-Kotlin">val obj = MyClass()
println(obj.number) // 调用 SimpleDelegate 的 getValue
obj.number = 42 // 调用 SimpleDelegate 的 setValue
println(obj.number) // 输出: 42</code></pre>
    <h3>
     例 2：懒加载属性（Lazy Properties）
    </h3>
    <p>
     Kotlin 标准库提供了
     <code>
      lazy
     </code>
     委托，用于实现懒加载属性。懒加载属性的值在第一次访问时才会被初始化。
    </p>
    <pre><code class="language-Kotlin">class MyClass {
    val lazyValue: String by lazy {
        println("Initializing lazyValue")
        "Hello, Lazy!"
    }
}
</code></pre>
    <ul>
     <li>
      <strong>
       <code>
        lazy
       </code>
      </strong>
      ：一个标准库提供的委托，用于实现懒加载。
     </li>
     <li>
      <strong>
       初始化逻辑
      </strong>
      ：在第一次访问
      <code>
       lazyValue
      </code>
      时，才会执行初始化逻辑。
     </li>
    </ul>
    <p>
     使用效果：
    </p>
    <pre><code class="language-Kotlin">val obj = MyClass()
println(obj.lazyValue) // 输出: Initializing lazyValue \n Hello, Lazy!
</code></pre>
    <h3>
     例 3：可观察属性（Observable Properties）
    </h3>
    <p>
     Kotlin 标准库还提供了
     <code>
      observable
     </code>
     委托，用于监听属性的变化。
    </p>
    <pre><code class="language-Kotlin">import kotlin.properties.Delegates

class MyClass {
    var observableValue: String by Delegates.observable("&lt;initial&gt;") {
        _, old, new -&gt;
        println("Property changed from $old to $new")
    }
}
</code></pre>
    <ul>
     <li>
      <strong>
       <code>
        Delegates.observable
       </code>
      </strong>
      ：一个标准库提供的委托，用于监听属性的变化。
     </li>
     <li>
      <strong>
       回调函数
      </strong>
      ：在属性值改变时，会调用回调函数。
     </li>
    </ul>
    <p>
     使用效果：
    </p>
    <pre><code class="language-Kotlin">val obj = MyClass()
obj.observableValue = "New Value" // 输出: Property changed from &lt;initial&gt; to New Value
</code></pre>
    <h2>
     4.
     <strong>
      委托属性的优势
     </strong>
    </h2>
    <ul>
     <li>
      <strong>
       简化代码
      </strong>
      ：通过委托，实现属性的存储和逻辑分离，避免重复代码。
     </li>
     <li>
      <strong>
       懒加载
      </strong>
      ：通过
      <code>
       lazy
      </code>
      委托，可以实现属性的懒加载。
     </li>
     <li>
      <strong>
       监听变化
      </strong>
      ：通过
      <code>
       observable
      </code>
      委托，可以监听属性的变化。
     </li>
     <li>
      <strong>
       灵活性
      </strong>
      ：可以自定义委托对象，实现更复杂的行为。
     </li>
    </ul>
    <hr/>
    <h2>
     5.
     <strong>
      总结
     </strong>
    </h2>
    <ul>
     <li>
      <strong>
       委托属性
      </strong>
      ：通过
      <code>
       by
      </code>
      关键字，将属性的
      <code>
       getter
      </code>
      和
      <code>
       setter
      </code>
      委托给一个外部对象。
     </li>
     <li>
      <strong>
       委托对象
      </strong>
      ：负责存储属性的值，并提供自定义的
      <code>
       get
      </code>
      和
      <code>
       set
      </code>
      行为。
     </li>
     <li>
      <strong>
       常见用途
      </strong>
      ：
      <ul>
       <li>
        懒加载属性（
        <code>
         lazy
        </code>
        ）。
       </li>
       <li>
        可观察属性（
        <code>
         observable
        </code>
        ）。
       </li>
       <li>
        自定义委托（如
        <code>
         SimpleDelegate
        </code>
        ）。
       </li>
      </ul>
     </li>
    </ul>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f37343736393931302f:61727469636c652f64657461696c732f313436323938363538" class_="artid" style="display:none">
 </p>
</div>


