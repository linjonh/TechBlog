---
arturl_encode: "68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34313839333530352f:61727469636c652f64657461696c732f313436323139313834"
layout: post
title: "HashMap-ä¸­çš„-key-å€¼ç±»å‹"
date: 2025-03-13 01:03:37 +08:00
description: "Stringåœ¨ Java ä¸­ï¼ŒHashMapçš„keyä¸€èˆ¬å»ºè®®ä½¿ç”¨Stringã€‚"
keywords: "java map key æ¨èç±»å‹"
categories: ['æœªåˆ†ç±»']
tags: ['Java']
artid: "146219184"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146219184
    alt: "HashMap-ä¸­çš„-key-å€¼ç±»å‹"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146219184
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146219184
cover: https://bing.ee123.net/img/rand?artid=146219184
image: https://bing.ee123.net/img/rand?artid=146219184
img: https://bing.ee123.net/img/rand?artid=146219184
---

# HashMap ä¸­çš„ key å€¼ç±»å‹

åœ¨ Java ä¸­ï¼Œ
`HashMap`
çš„
`key`
ä¸€èˆ¬å»ºè®®ä½¿ç”¨
`String`
è€Œä¸æ˜¯è‡ªå®šä¹‰å¯¹è±¡ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªåŸå› ï¼š

## 1. **`String` æ˜¯ä¸å¯å˜å¯¹è±¡ï¼ˆImmutableï¼‰**

* `String`
  åœ¨ Java ä¸­æ˜¯ä¸å¯å˜çš„ï¼Œä¸€æ—¦åˆ›å»ºå°±ä¸ä¼šæ”¹å˜å…¶å“ˆå¸Œå€¼ (
  `hashCode`
  )ã€‚
* `HashMap`
  ä¾èµ–
  `key`
  çš„
  `hashCode()`
  è®¡ç®—å­˜å‚¨ä½ç½®ï¼Œå¦‚æœ
  `key`
  æ˜¯å¯å˜å¯¹è±¡ï¼Œä¿®æ”¹
  `key`
  åï¼Œå®ƒçš„
  `hashCode()`
  å¯èƒ½ä¼šæ”¹å˜ï¼Œå¯¼è‡´
  `HashMap`
  æ— æ³•æ­£ç¡®æŸ¥æ‰¾è¯¥
  `key`
  ï¼Œå¼•å‘æ½œåœ¨é—®é¢˜ï¼ˆå¦‚æ•°æ®ä¸¢å¤±ã€æ— æ³•æŸ¥æ‰¾ç­‰ï¼‰ã€‚
* ä¾‹å¦‚ï¼š

  ```java
  Map<List<Integer>, String> map = new HashMap<>();
  List<Integer> key = new ArrayList<>();
  key.add(1);
  map.put(key, "value");

  key.add(2); // ä¿®æ”¹ key
  System.out.println(map.get(key)); // å¯èƒ½è¿”å› null

  ```

  ç”±äº
  `ArrayList`
  çš„
  `hashCode()`
  ä¾èµ–äºå†…å®¹ï¼Œ
  `key`
  å˜åŒ–å
  `hashCode`
  å˜åŒ–ï¼Œå¯¼è‡´
  `HashMap`
  æ— æ³•æ‰¾åˆ°åŸæ¥çš„
  `value`
  ã€‚

## 2. **`String` çš„ `hashCode()` è®¡ç®—é«˜æ•ˆä¸”ç¨³å®š**

* `String`
  åœ¨ Java ä¸­çš„
  `hashCode()`
  å®ç°æ˜¯ç»è¿‡é«˜åº¦ä¼˜åŒ–çš„ï¼Œå¹¶ä¸”è¢«å¹¿æ³›ä½¿ç”¨ï¼Œè®¡ç®—æ•ˆç‡é«˜ã€‚
* `String`
  çš„
  `hashCode()`
  è®¡ç®—æ–¹å¼å¦‚ä¸‹ï¼š

  ```java
  public int hashCode() {
      int h = 0;
      for (int i = 0; i < length(); i++) {
          h = 31 * h + charAt(i);
      }
      return h;
  }

  ```
* ç”±äº
  `String`
  æ˜¯
  `final`
  ç±»ï¼Œå®ƒçš„
  `hashCode()`
  è®¡ç®—é€»è¾‘ä¸ä¼šè¢«å­ç±»é‡å†™æˆ–ä¿®æ”¹ï¼Œä¿è¯äº†å“ˆå¸Œå€¼çš„ä¸€è‡´æ€§ã€‚

## 3. **`String` å…·æœ‰è‰¯å¥½çš„åˆ†å¸ƒæ€§ï¼Œå‡å°‘ Hash å†²çª**

* åœ¨
  `HashMap`
  ä¸­ï¼Œè‰¯å¥½çš„
  `hashCode()`
  è®¾è®¡å¯ä»¥å‡å°‘å“ˆå¸Œå†²çªï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚
* `String`
  çš„
  `hashCode()`
  è®¡ç®—æ–¹å¼èƒ½å¤Ÿè¾ƒå¥½åœ°åˆ†å¸ƒæ•°æ®ï¼Œé¿å…å¤§é‡
  `key`
  è½åœ¨ç›¸åŒçš„æ¡¶ï¼ˆbucketï¼‰é‡Œã€‚

## 4. **`String` é€‚åˆä½œä¸ºæ ‡è¯†ç¬¦**

* `String`
  ç›´è§‚æ˜“è¯»ï¼Œå¯ä»¥ç›´æ¥è¡¨ç¤ºç”¨æˆ·åã€IDã€ç±»åˆ«ç­‰ï¼Œä¾¿äºä»£ç ç†è§£ã€‚
* ä¾‹å¦‚ï¼š

  ```java
  Map<String, Integer> map = new HashMap<>();
  map.put("Alice", 25);
  map.put("Bob", 30);

  ```

  ç›¸æ¯”äºè‡ªå®šä¹‰å¯¹è±¡ï¼Œ
  `String`
  æ›´é€‚åˆä½œä¸º
  `key`
  æ¥è¡¨ç¤ºä¸šåŠ¡å±æ€§ã€‚

## 5. **é¿å… `equals()` å’Œ `hashCode()` æ–¹æ³•å®ç°é”™è¯¯**

* ä½¿ç”¨è‡ªå®šä¹‰å¯¹è±¡ä½œä¸º
  `key`
  æ—¶ï¼Œéœ€è¦æ­£ç¡®å®ç°
  `equals()`
  å’Œ
  `hashCode()`
  æ–¹æ³•ï¼Œå¦åˆ™ä¼šå¯¼è‡´
  `HashMap`
  è¡Œä¸ºå¼‚å¸¸ï¼Œå¦‚æ— æ³•æ­£ç¡®æŸ¥æ‰¾
  `key`
  æˆ–å‘ç”Ÿå“ˆå¸Œå†²çªã€‚
* ä¾‹å¦‚ï¼š

  ```java
  class Person {
      String name;
      int age;
  }

  ```

  å¦‚æœ
  `Person`
  æ²¡æœ‰æ­£ç¡®é‡å†™
  `equals()`
  å’Œ
  `hashCode()`
  ï¼Œé‚£ä¹ˆ
  `HashMap`
  å¯èƒ½æ— æ³•æ­£ç¡®åŒºåˆ†ä¸¤ä¸ª
  `Person`
  å¯¹è±¡ï¼Œå³ä½¿å®ƒä»¬çš„
  `name`
  å’Œ
  `age`
  ç›¸åŒã€‚

## 6. **`String` å…·æœ‰å†…å­˜ä¼˜åŒ–ï¼ˆå­—ç¬¦ä¸²å¸¸é‡æ± ï¼‰**

* `String`
  åœ¨ JVM ä¸­æœ‰å­—ç¬¦ä¸²å¸¸é‡æ± ï¼ˆString Poolï¼‰ï¼Œç›¸åŒå­—ç¬¦ä¸²å¯å¤ç”¨ï¼Œå‡å°‘å†…å­˜å ç”¨ã€‚
* ä¾‹å¦‚ï¼š

  ```java
  String s1 = "hello";
  String s2 = "hello";
  System.out.println(s1 == s2); // trueï¼Œå…±äº«åŒä¸€ä¸ªå¯¹è±¡

  ```

## **æ€»ç»“**

| **æ¯”è¾ƒé¡¹** | **ä½¿ç”¨ `String` ä½œä¸º `key`** | **ä½¿ç”¨å¯¹è±¡ä½œä¸º `key`** |
| --- | --- | --- |
| **ä¸å¯å˜æ€§** | ä¸å¯å˜ï¼Œå“ˆå¸Œå€¼ç¨³å®š | å¯èƒ½å¯å˜ï¼Œå½±å“ `hashCode()` |
| **å“ˆå¸Œåˆ†å¸ƒæ€§** | `String` çš„ `hashCode()` åˆ†å¸ƒè‰¯å¥½ | éœ€è¦è‡ªå®šä¹‰ `hashCode()` ï¼Œå¯èƒ½ä¸å‡åŒ€ |
| **æ˜“ç”¨æ€§** | ç›´è§‚ï¼Œæ˜“è¯»æ˜“ç»´æŠ¤ | éœ€è¦æ­£ç¡®å®ç° `equals()` å’Œ `hashCode()` |
| **æ€§èƒ½** | `String` çš„ `hashCode()` è®¡ç®—é«˜æ•ˆ | å¯èƒ½è®¡ç®—å¤æ‚ï¼Œå½±å“ `HashMap` æ•ˆç‡ |
| **å†…å­˜ä¼˜åŒ–** | äº«å— JVM `String Pool` ä¼˜åŠ¿ | æ²¡æœ‰å­—ç¬¦ä¸²æ± æœºåˆ¶ |

å› æ­¤ï¼Œåœ¨
`HashMap`
ä¸­ï¼Œ
**æ¨èä¼˜å…ˆä½¿ç”¨
`String`
ä½œä¸º
`key`**
ï¼Œå¦‚æœå¿…é¡»ä½¿ç”¨å¯¹è±¡ä½œä¸º
`key`
ï¼Œéœ€è¦ç¡®ä¿ï¼š

1. è¯¥å¯¹è±¡æ˜¯ä¸å¯å˜çš„ï¼›
2. æ­£ç¡®é‡å†™
   `equals()`
   å’Œ
   `hashCode()`
   æ–¹æ³•ã€‚

åœ¨
`HashMap`
ä¸­ï¼Œå¦‚æœ
`key`
æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”è¯¥å¯¹è±¡çš„
**æŸä¸ªå±æ€§å‘ç”Ÿå˜åŒ–**
ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šå¯¼è‡´æ— æ³•é€šè¿‡åŸæ¥çš„
`key`
æ‰¾åˆ°å¯¹åº”çš„
`value`
ã€‚

## **ä¸ºä»€ä¹ˆæ‰¾ä¸åˆ°åŸæ¥çš„ `value` ï¼Ÿ**

1. **`HashMap`
   ä¾èµ–
   `key`
   çš„
   `hashCode()`
   è®¡ç®—å­˜å‚¨ä½ç½®**
   * `HashMap`
     é€šè¿‡
     `key`
     çš„
     `hashCode()`
     è®¡ç®—å­˜å‚¨æ¡¶ï¼ˆbucketï¼‰çš„ç´¢å¼•ã€‚
   * å¦‚æœ
     `key`
     æ˜¯å¯¹è±¡ï¼Œå¹¶ä¸”å¯¹è±¡çš„æŸäº›å±æ€§å½±å“äº†
     `hashCode()`
     è®¡ç®—ï¼Œé‚£ä¹ˆä¿®æ”¹è¯¥å±æ€§ä¼šå¯¼è‡´
     `hashCode()`
     å˜åŒ–ï¼Œä½¿å¾—
     `HashMap`
     æ— æ³•åœ¨åŸæ¥çš„ä½ç½®æ‰¾åˆ°è¯¥
     `key`
     ã€‚
2. **`HashMap`
   ä¾èµ–
   `equals()`
   æ–¹æ³•æŸ¥æ‰¾
   `key`**
   * åœ¨
     `HashMap`
     ä¸­ï¼Œå³ä½¿ä¸¤ä¸ªå¯¹è±¡çš„
     `hashCode()`
     ç›¸åŒï¼Œæœ€ç»ˆè¿˜æ˜¯è¦é€šè¿‡
     `equals()`
     æ–¹æ³•ç¡®è®¤å®ƒä»¬æ˜¯å¦ç›¸ç­‰ã€‚
   * å¦‚æœ
     `equals()`
     æ–¹æ³•ä¾èµ–äºæŸäº›å¯å˜å±æ€§ï¼Œè€Œè¿™äº›å±æ€§å‘ç”Ÿäº†å˜åŒ–ï¼Œé‚£ä¹ˆå³ä½¿
     `hashCode()`
     ä»ç„¶ç›¸åŒï¼Œä¹Ÿå¯èƒ½ä¼šå¯¼è‡´
     `equals()`
     å¤±æ•ˆï¼Œä½¿å¾—
     `HashMap`
     æ— æ³•åŒ¹é…åŸæ¥çš„
     `key`
     ã€‚

## **ç¤ºä¾‹ä»£ç **

```java
import java.util.HashMap;
import java.util.Objects;

class Person {
    String name;
    int age;

    public Person(String name, int age) {
        this.name = name;
        this.age = age;
    }

    @Override
    public int hashCode() {
        return Objects.hash(name, age);
    }

    @Override
    public boolean equals(Object obj) {
        if (this == obj) return true;
        if (obj == null || getClass() != obj.getClass()) return false;
        Person person = (Person) obj;
        return age == person.age && Objects.equals(name, person.name);
    }
}

public class HashMapKeyTest {
    public static void main(String[] args) {
        HashMap<Person, String> map = new HashMap<>();

        Person p = new Person("Alice", 25);
        map.put(p, "Engineer");

        System.out.println("Before change: " + map.get(p)); // æ­£å¸¸è·å– "Engineer"

        // ä¿®æ”¹ key å¯¹è±¡çš„å±æ€§
        p.age = 30;

        System.out.println("After change: " + map.get(p)); // å¯èƒ½è¿”å› null
        System.out.println("Contains key: " + map.containsKey(p)); // å¯èƒ½è¿”å› false
    }
}

```

## **åˆ†æ**

1. `Person`
   ä½œä¸º
   `key`
   ï¼Œå®ƒçš„
   `hashCode()`
   ä¾èµ–äº
   `name`
   å’Œ
   `age`
   ã€‚
2. å­˜å…¥
   `HashMap`
   åï¼Œ
   `p`
   è®¡ç®—çš„
   `hashCode()`
   ç¡®å®šäº†å®ƒåœ¨
   `HashMap`
   çš„å­˜å‚¨ä½ç½®ã€‚
3. ä¿®æ”¹
   `p.age`
   åï¼Œ
   `hashCode()`
   å‘ç”Ÿå˜åŒ–ï¼Œå¯¼è‡´
   `HashMap`
   åœ¨æŸ¥æ‰¾
   `p`
   æ—¶ï¼Œè®¡ç®—å‡ºçš„
   `hashCode()`
   å¯¹åº”çš„å­˜å‚¨æ¡¶ä½ç½®å¯èƒ½å·²ç»æ”¹å˜ã€‚
4. **ç»“æœï¼š
   `map.get(p)`
   å¯èƒ½è¿”å›
   `null`
   ï¼Œå³æ— æ³•æ‰¾åˆ°åŸæ¥çš„
   `value`
   ã€‚**

## **å¦‚ä½•è§£å†³ï¼Ÿ**

### **æ–¹æ¡ˆ 1ï¼šä½¿ç”¨ä¸å¯å˜å¯¹è±¡ä½œä¸º `key`**

```java
class Person {
    private final String name;
    private final int age;

    public Person(String name, int age) {
        this.name = name;
        this.age = age;
    }

    @Override
    public int hashCode() {
        return Objects.hash(name, age);
    }

    @Override
    public boolean equals(Object obj) {
        if (this == obj) return true;
        if (obj == null || getClass() != obj.getClass()) return false;
        Person person = (Person) obj;
        return age == person.age && Objects.equals(name, person.name);
    }
}

```

* **ä¼˜ç‚¹**
  ï¼šä¿è¯
  `key`
  ä¸å˜ï¼Œé¿å…
  `hashCode()`
  å˜åŒ–å¯¼è‡´æŸ¥æ‰¾å¤±è´¥ã€‚
* **é€‚ç”¨åœºæ™¯**
  ï¼šå¦‚æœ
  `key`
  éœ€è¦ç¨³å®šï¼Œå»ºè®®ä½¿ç”¨
  `final`
  å…³é”®å­—è®©å±æ€§ä¸å¯å˜ï¼Œæˆ–è€…ä½¿ç”¨
  `String`
  ä½œä¸º
  `key`
  ã€‚

### **æ–¹æ¡ˆ 2ï¼šä½¿ç”¨ `put()` é‡æ–°å­˜å…¥ä¿®æ”¹åçš„ `key`**

å¦‚æœ
`key`
å‘ç”Ÿå˜åŒ–ï¼Œéœ€è¦é‡æ–°
`put()`
è¿›å»ï¼š

```java
map.remove(p); // å…ˆåˆ é™¤æ—§çš„ key
p.age = 30;    // ä¿®æ”¹å±æ€§
map.put(p, "Engineer"); // é‡æ–°æ”¾å…¥ HashMap

```

* **é€‚ç”¨åœºæ™¯**
  ï¼šå¦‚æœä¸€å®šè¦ä¿®æ”¹
  `key`
  ï¼Œéœ€è¦ç¡®ä¿
  `HashMap`
  ç»“æ„åŒæ­¥æ›´æ–°ã€‚

## **æ€»ç»“**

| æ–¹æ¡ˆ | å½±å“ | é€‚ç”¨åœºæ™¯ |
| --- | --- | --- |
| **ä¿®æ”¹ `key` å±æ€§** | `hashCode()` å˜æ›´ï¼Œå¯¼è‡´æŸ¥æ‰¾å¤±è´¥ | ä¸æ¨è |
| **ä½¿ç”¨ä¸å¯å˜å¯¹è±¡** | `key` ä¿æŒä¸å˜ï¼Œé¿å…é—®é¢˜ | æ¨è |
| **ä½¿ç”¨ `remove()` åé‡æ–° `put()`** | éœ€è¦é¢å¤–æ“ä½œï¼Œä¿è¯ `HashMap` ä¸€è‡´æ€§ | é€‚ç”¨äºå¯å˜å¯¹è±¡ |

ğŸ‘‰
**æœ€ä½³å®è·µï¼šå»ºè®®
`HashMap`
çš„
`key`
é€‰æ‹©
`String`
æˆ–ä¸å¯å˜å¯¹è±¡ï¼Œé¿å…å› 
`hashCode()`
å˜åŒ–å¯¼è‡´æŸ¥æ‰¾å¤±è´¥ï¼**