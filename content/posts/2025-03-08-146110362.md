---
layout: post
title: "ä½¿ç”¨-OpenSSL-å’Œ-Python-å®ç°-AES-256-CBC-åŠ å¯†ä¸è§£å¯†å®‰å…¨å¯†é’¥ç®¡ç†"
date: 2025-03-08 08:36:50 +0800
description: "ä½¿ç”¨ OpenSSL å’Œ Python å®ç° AES-256-CBC åŠ å¯†ä¸è§£å¯†, åœ¨ä¸åŠ å¯†çš„è½¯ä»¶ä¸Šä¹Ÿèƒ½å®‰å…¨ä¼ è¾“ä½ çš„åŠ å¯†æ¶ˆæ¯!"
keywords: "æ²¡æœ‰aes-256-cfbæ’ä»¶"
categories: ['æœªåˆ†ç±»']
tags: ['ç½‘ç»œå®‰å…¨', 'å¯†ç å­¦', 'å®‰å…¨', 'Python', 'Openssl']
artid: "146110362"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146110362
    alt: "ä½¿ç”¨-OpenSSL-å’Œ-Python-å®ç°-AES-256-CBC-åŠ å¯†ä¸è§£å¯†å®‰å…¨å¯†é’¥ç®¡ç†"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146110362
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146110362
cover: https://bing.ee123.net/img/rand?artid=146110362
image: https://bing.ee123.net/img/rand?artid=146110362
img: https://bing.ee123.net/img/rand?artid=146110362
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     ä½¿ç”¨ OpenSSL å’Œ Python å®ç° AES-256-CBC åŠ å¯†ä¸è§£å¯†ï¼ˆå®‰å…¨å¯†é’¥ç®¡ç†ï¼‰
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="_0">
     </a>
     ç¯å¢ƒ
    </h3>
    <ul>
     <li>
      OpenSSL
     </li>
     <li>
      Python
     </li>
    </ul>
    <h3>
     <a id="_OpenSSL__5">
     </a>
     ä½¿ç”¨ OpenSSL åŠ å¯†
    </h3>
    <h4>
     <a id="1__AES__IV_7">
     </a>
     <strong>
      1. ç”Ÿæˆ AES å¯†é’¥å’Œ IV
     </strong>
    </h4>
    <p>
     <strong>
      å¼ºçƒˆæ¨èä½¿ç”¨æ–¹æ³•ä¸€ï¼ˆPython
      <code>
       secrets
      </code>
      æ¨¡å—ï¼‰
     </strong>
     ï¼Œå› ä¸ºå®ƒæ›´å®‰å…¨ã€‚
    </p>
    <h5>
     <a id="_Python__secrets__11">
     </a>
     æ–¹æ³•ä¸€: Python çš„
     <code>
      secrets
     </code>
     æ¨¡å—ï¼ˆå®‰å…¨æ–¹å¼ï¼‰
    </h5>
    <ul>
     <li>
      <p>
       <strong>
        ä¸è¦ä½¿ç”¨ OpenSSL çš„
        <code>
         rand
        </code>
        å‘½ä»¤ç›´æ¥ç”Ÿæˆå¯†é’¥å’Œ IV ç”¨äºç”Ÿäº§ç¯å¢ƒã€‚
       </strong>
       å°½ç®¡
       <code>
        openssl rand
       </code>
       å¯ä»¥ç”Ÿæˆéšæœºæ•°ï¼Œä½†å®ƒå¯èƒ½ä¸ç¬¦åˆå¯†ç å­¦å®‰å…¨çš„è¦æ±‚ã€‚
      </p>
     </li>
     <li>
      <p>
       <strong>
        æ¨èæ–¹æ³•ï¼š
       </strong>
       ä½¿ç”¨æ›´å®‰å…¨çš„éšæœºæ•°ç”Ÿæˆå™¨ï¼Œä¾‹å¦‚ Python çš„
       <code>
        secrets
       </code>
       æ¨¡å—ï¼š
      </p>
      <pre><code class="prism language-python"><span class="token keyword">import</span> secrets
<span class="token keyword">import</span> binascii

<span class="token comment"># ç”Ÿæˆ 256 ä½ AES å¯†é’¥ï¼ˆ32 å­—èŠ‚ï¼‰</span>
key <span class="token operator">=</span> secrets<span class="token punctuation">.</span>token_bytes<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>
key_hex <span class="token operator">=</span> binascii<span class="token punctuation">.</span>hexlify<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># è½¬æ¢ä¸ºåå…­è¿›åˆ¶å­—ç¬¦ä¸²</span>

<span class="token comment"># ç”Ÿæˆ 128 ä½ IVï¼ˆ16 å­—èŠ‚ï¼‰</span>
iv <span class="token operator">=</span> secrets<span class="token punctuation">.</span>token_bytes<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>
iv_hex <span class="token operator">=</span> binascii<span class="token punctuation">.</span>hexlify<span class="token punctuation">(</span>iv<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># è½¬æ¢ä¸ºåå…­è¿›åˆ¶å­—ç¬¦ä¸²</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"AES Key (Hex):"</span><span class="token punctuation">,</span> key_hex<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"IV (Hex):"</span><span class="token punctuation">,</span> iv_hex<span class="token punctuation">)</span>
</code></pre>
     </li>
     <li>
      <p>
       <strong>
        <code>
         secrets.token_bytes(nbytes)
        </code>
        ï¼š
       </strong>
       ç”Ÿæˆ
       <code>
        nbytes
       </code>
       ä¸ªå¯†ç å­¦å®‰å…¨çš„éšæœºå­—èŠ‚ã€‚
      </p>
     </li>
     <li>
      <p>
       <strong>
        <code>
         binascii.hexlify(data)
        </code>
        ï¼š
       </strong>
       å°†å­—èŠ‚æ•°æ®è½¬æ¢ä¸ºåå…­è¿›åˆ¶å­—ç¬¦ä¸²ã€‚
      </p>
     </li>
     <li>
      <p>
       <strong>
        ä¿å­˜ï¼š
       </strong>
       å°†ç”Ÿæˆçš„å¯†é’¥å’Œ IV å®‰å…¨åœ°ä¿å­˜èµ·æ¥ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨å¯†ç ç®¡ç†å™¨ï¼‰ã€‚
      </p>
     </li>
    </ul>
    <h5>
     <a id="__OpenSSL__rand__37">
     </a>
     æ–¹æ³•äºŒ: ç›´æ¥ä½¿ç”¨ OpenSSL çš„
     <code>
      rand
     </code>
     å‘½ä»¤(ä¸æ¨è)
    </h5>
    <pre><code class="prism language-bash">openssl rand <span class="token parameter variable">-hex</span> <span class="token number">32</span>  <span class="token comment"># ç”Ÿæˆ 256 ä½ AES å¯†é’¥ï¼ˆ32 å­—èŠ‚ï¼‰</span>
openssl rand <span class="token parameter variable">-hex</span> <span class="token number">16</span>  <span class="token comment"># ç”Ÿæˆ 128 ä½ IVï¼ˆ16 å­—èŠ‚ï¼‰</span>
</code></pre>
    <ul>
     <li>
      <strong>
       <code>
        openssl rand -hex &lt;é•¿åº¦&gt;
       </code>
       ï¼š
      </strong>
      ä½¿ç”¨ OpenSSL çš„éšæœºæ•°ç”Ÿæˆå™¨ç”ŸæˆæŒ‡å®šé•¿åº¦çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²ã€‚
     </li>
     <li>
      <strong>
       ä¿å­˜å¯†é’¥å’Œ IVï¼š
      </strong>
      å°†ç”Ÿæˆçš„å¯†é’¥å’Œ IV å®‰å…¨åœ°ä¿å­˜èµ·æ¥ï¼ˆä¾‹å¦‚ï¼Œå­˜å‚¨åœ¨å¯†ç ç®¡ç†å™¨ä¸­ï¼‰ã€‚
     </li>
    </ul>
    <h4>
     <a id="2__47">
     </a>
     <strong>
      2. åŠ å¯†
     </strong>
    </h4>
    <pre><code class="prism language-bash">openssl enc -aes-256-cbc <span class="token parameter variable">-pbkdf2</span> <span class="token parameter variable">-iter</span> <span class="token number">100000</span> <span class="token parameter variable">-in</span> plaintext.txt <span class="token parameter variable">-out</span> ciphertext.bin <span class="token parameter variable">-K</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> key.txt<span class="token variable">)</span></span> <span class="token parameter variable">-iv</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> iv.txt<span class="token variable">)</span></span>
</code></pre>
    <ul>
     <li>
      <strong>
       <code>
        -pbkdf2
       </code>
       ï¼š
      </strong>
      ä½¿ç”¨ PBKDF2 å¯†é’¥æ´¾ç”Ÿå‡½æ•°ã€‚
     </li>
     <li>
      <strong>
       <code>
        -iter 100000
       </code>
       ï¼š
      </strong>
      è®¾ç½®è¿­ä»£æ¬¡æ•°ä¸º 100000ï¼ˆå»ºè®®è‡³å°‘ 10000ï¼Œå¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´ï¼‰ã€‚
     </li>
     <li>
      <strong>
       <code>
        -K $(cat key.txt)
       </code>
       ï¼š
      </strong>
      ä»æ–‡ä»¶
      <code>
       key.txt
      </code>
      ä¸­è¯»å– AES å¯†é’¥ï¼ˆå‡è®¾ä½ å·²å°†å¯†é’¥ä¿å­˜åœ¨
      <code>
       key.txt
      </code>
      æ–‡ä»¶ä¸­ï¼‰ã€‚
     </li>
     <li>
      <strong>
       <code>
        -iv $(cat iv.txt)
       </code>
       ï¼š
      </strong>
      ä»æ–‡ä»¶
      <code>
       iv.txt
      </code>
      ä¸­è¯»å– IVï¼ˆå‡è®¾ä½ å·²å°† IV ä¿å­˜åœ¨
      <code>
       iv.txt
      </code>
      æ–‡ä»¶ä¸­ï¼‰ã€‚
     </li>
     <li>
      <strong>
       å»æ‰äº†
       <code>
        -salt
       </code>
      </strong>
      : å½“ä½¿ç”¨
      <code>
       -pbkdf2
      </code>
      çš„æ—¶å€™ï¼Œä¸å†éœ€è¦
      <code>
       -salt
      </code>
      ã€‚
     </li>
     <li>
      <strong>
       ä¸ºä»€ä¹ˆè¦ä»æ–‡ä»¶ä¸­è¯»å–å¯†é’¥å’Œ IVï¼Ÿ
      </strong>
      <ul>
       <li>
        <strong>
         å®‰å…¨ï¼š
        </strong>
        é¿å…å°†å¯†é’¥å’Œ IV ç›´æ¥å†™åœ¨å‘½ä»¤è¡Œä¸­ï¼Œé˜²æ­¢æ³„éœ²ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡å‘½ä»¤è¡Œå†å²è®°å½•ï¼‰ã€‚
       </li>
       <li>
        <strong>
         æ–¹ä¾¿ï¼š
        </strong>
        æ–¹ä¾¿ç®¡ç†å’Œé‡å¤ä½¿ç”¨å¯†é’¥å’Œ IVã€‚
       </li>
      </ul>
     </li>
    </ul>
    <h4>
     <a id="3_Base64__62">
     </a>
     <strong>
      3. Base64 ç¼–ç 
     </strong>
    </h4>
    <p>
     å°†å¯†æ–‡è½¬æ¢ä¸ºæ–‡æœ¬æ ¼å¼ï¼ˆç”¨äºç”Ÿæˆæ¡å½¢ç ï¼‰ï¼Œéœ€è¦è¿›è¡Œ Base64 ç¼–ç ï¼š
    </p>
    <pre><code class="prism language-bash">openssl base64 <span class="token parameter variable">-in</span> ciphertext.bin <span class="token parameter variable">-out</span> ciphertext.txt
</code></pre>
    <h4>
     <a id="4__70">
     </a>
     <strong>
      4. ç”Ÿæˆæ¡å½¢ç 
     </strong>
    </h4>
    <ul>
     <li>
      ä½¿ç”¨åœ¨çº¿æ¡å½¢ç ç”Ÿæˆå™¨ï¼ˆå¦‚
      <code>
       https://barcode.tec-it.com/en
      </code>
      ï¼‰å°† Base64 ç¼–ç åçš„å¯†æ–‡ç”Ÿæˆæ¡å½¢ç å›¾ç‰‡ã€‚
     </li>
     <li>
      é€‰æ‹©æ¡å½¢ç ç±»å‹ï¼ˆå¦‚ Code 128ï¼‰ï¼Œå°† Base64 ç¼–ç åçš„å¯†æ–‡ç²˜è´´åˆ°è¾“å…¥æ¡†ä¸­ï¼Œç”Ÿæˆæ¡å½¢ç å›¾ç‰‡ã€‚
     </li>
    </ul>
    <h3>
     <a id="_75">
     </a>
     å®‰å…¨ä¼ è¾“å¯†é’¥å’Œå¯†æ–‡
    </h3>
    <h4>
     <a id="1__77">
     </a>
     <strong>
      1. å®‰å…¨ä¼ è¾“å¯†é’¥ï¼š
     </strong>
    </h4>
    <ul>
     <li>
      <strong>
       é‡è¦ï¼š
      </strong>
      å¯†é’¥å’Œ IV çš„å®‰å…¨è‡³å…³é‡è¦ï¼ç»å¯¹ä¸è¦é€šè¿‡ä¸å®‰å…¨çš„æ¸ é“ï¼ˆå¦‚å¾®ä¿¡ã€é‚®ä»¶ ğŸ’€ï¼‰ç›´æ¥å‘é€ã€‚
     </li>
     <li>
      <strong>
       å®‰å…¨æ–¹æ¡ˆï¼š
      </strong>
      <ul>
       <li>
        <strong>
         çº¿ä¸‹å‘ŠçŸ¥ï¼š
        </strong>
        å¦‚æœæ¡ä»¶å…è®¸ï¼Œçº¿ä¸‹å£å¤´å‘ŠçŸ¥æˆ–ä½¿ç”¨çº¸æ¡ä¼ é€’ã€‚
       </li>
       <li>
        <strong>
         åŠ å¯†é€šä¿¡å·¥å…·ï¼š
        </strong>
        ä½¿ç”¨ Signalã€Wire ç­‰ç«¯åˆ°ç«¯åŠ å¯†çš„é€šä¿¡å·¥å…·ã€‚
       </li>
       <li>
        <strong>
         å¯†é’¥äº¤æ¢åè®®ï¼š
        </strong>
        å¦‚æœå¯¹å¯†ç å­¦æœ‰ä¸€å®šäº†è§£ï¼Œå¯ä»¥ä½¿ç”¨ Diffie-Hellman ç­‰å¯†é’¥äº¤æ¢åè®®ã€‚
       </li>
       <li>
        <strong>
         å¯†é’¥æ–‡ä»¶ï¼š
        </strong>
        å¯ä»¥å°†å¯†é’¥å’ŒIVå­˜æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­, ä½¿ç”¨ GPG åŠ å¯†åå‘é€.
       </li>
      </ul>
     </li>
    </ul>
    <h4>
     <a id="2__86">
     </a>
     <strong>
      2. å‘é€æ¡å½¢ç ï¼š
     </strong>
    </h4>
    <ul>
     <li>
      å°†ç”Ÿæˆçš„æ¡å½¢ç å›¾ç‰‡é€šè¿‡å¾®ä¿¡ç­‰æ–¹å¼å‘é€ç»™ä½ çš„æœ‹å‹ã€‚è¿™æ­¥å¯ä»¥ç”¨å¾®ä¿¡äº†ã€‚ğŸ˜‡
     </li>
    </ul>
    <h3>
     <a id="_90">
     </a>
     è§£å¯†æ–¹å¼
    </h3>
    <h4>
     <a id="1__92">
     </a>
     <strong>
      1. è§£å¯†
     </strong>
    </h4>
    <pre><code class="prism language-bash">openssl enc <span class="token parameter variable">-d</span> -aes-256-cbc <span class="token parameter variable">-in</span> ciphertext.bin <span class="token parameter variable">-out</span> plaintext.txt <span class="token parameter variable">-K</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> key.txt<span class="token variable">)</span></span> <span class="token parameter variable">-iv</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> iv.txt<span class="token variable">)</span></span> <span class="token parameter variable">-pbkdf2</span> <span class="token parameter variable">-iter</span> <span class="token number">100000</span>
</code></pre>
    <ul>
     <li>
      <strong>
       æ³¨æ„ï¼š
      </strong>
      <ul>
       <li>
        è§£å¯†å‘½ä»¤ä¸åŠ å¯†å‘½ä»¤
        <strong>
         åŸºæœ¬ç›¸åŒ
        </strong>
        ï¼Œåªæ˜¯å°†
        <code>
         -enc
        </code>
        æ”¹ä¸º
        <code>
         -d
        </code>
        ï¼ˆè¡¨ç¤ºè§£å¯†ï¼‰ã€‚
       </li>
       <li>
        <code>
         -pbkdf2
        </code>
        å’Œ
        <code>
         -iter
        </code>
        å‚æ•°å¿…é¡»ä¸åŠ å¯†æ—¶
        <strong>
         å®Œå…¨ä¸€è‡´
        </strong>
        ã€‚
       </li>
       <li>
        <code>
         -K
        </code>
        å’Œ
        <code>
         -iv
        </code>
        å‚æ•°ä»ç„¶ä»æ–‡ä»¶ä¸­è¯»å–å¯†é’¥å’Œ IVã€‚
       </li>
      </ul>
     </li>
    </ul>
    <h4>
     <a id="2_Base64__103">
     </a>
     <strong>
      2. Base64 è§£ç 
     </strong>
    </h4>
    <pre><code class="prism language-bash">openssl base64 <span class="token parameter variable">-d</span> <span class="token parameter variable">-in</span> ciphertext.txt <span class="token parameter variable">-out</span> ciphertext.bin
</code></pre>
    <h3>
     <a id="_109">
     </a>
     <strong>
      å®Œæ•´çš„æµç¨‹æ€»ç»“
     </strong>
    </h3>
    <ol>
     <li>
      <p>
       <strong>
        ç”Ÿæˆå¼ºå¯†é’¥å’Œ IVï¼š
       </strong>
      </p>
      <ul>
       <li>
        ä½¿ç”¨ Python çš„
        <code>
         secrets
        </code>
        æ¨¡å—ã€‚
       </li>
       <li>
        å°†å¯†é’¥å’Œ IV ä¿å­˜åˆ°å®‰å…¨çš„æ–‡ä»¶ä¸­ï¼ˆä¾‹å¦‚ï¼Œ
        <code>
         key.txt
        </code>
        å’Œ
        <code>
         iv.txt
        </code>
        ï¼‰, æˆ–è€…å¯†ç ç®¡ç†å™¨ä¸­ã€‚
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        åŠ å¯†ï¼š
       </strong>
      </p>
      <pre><code class="prism language-bash">openssl enc -aes-256-cbc <span class="token parameter variable">-pbkdf2</span> <span class="token parameter variable">-iter</span> <span class="token number">100000</span> <span class="token parameter variable">-in</span> plaintext.txt <span class="token parameter variable">-out</span> ciphertext.bin <span class="token parameter variable">-K</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> key.txt<span class="token variable">)</span></span> <span class="token parameter variable">-iv</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> iv.txt<span class="token variable">)</span></span>
</code></pre>
      <pre><code class="prism language-bash">openssl base64 <span class="token parameter variable">-in</span> ciphertext.bin <span class="token parameter variable">-out</span> ciphertext.txt
</code></pre>
     </li>
     <li>
      <p>
       <strong>
        è§£å¯†ï¼š
       </strong>
      </p>
      <pre><code class="prism language-bash">openssl enc <span class="token parameter variable">-d</span> -aes-256-cbc <span class="token parameter variable">-in</span> ciphertext.bin <span class="token parameter variable">-out</span> plaintext.txt <span class="token parameter variable">-K</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> key.txt<span class="token variable">)</span></span> <span class="token parameter variable">-iv</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> iv.txt<span class="token variable">)</span></span> <span class="token parameter variable">-pbkdf2</span> <span class="token parameter variable">-iter</span> <span class="token number">100000</span>
</code></pre>
      <pre><code class="prism language-bash">openssl base64 <span class="token parameter variable">-d</span> <span class="token parameter variable">-in</span> ciphertext.txt <span class="token parameter variable">-out</span> ciphertext.bin
</code></pre>
     </li>
    </ol>
    <p>
     æ³¨æ„å®‰å…¨, HAVE FUN! ğŸ‘€
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a:2f2f626c6f672e6373646e2e6e65742f4b656972616b65652f:61727469636c652f64657461696c732f313436313130333632" class_="artid" style="display:none">
 </p>
</div>


