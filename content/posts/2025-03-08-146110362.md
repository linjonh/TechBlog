---
arturl_encode: "68747470733a:2f2f626c6f672e6373646e2e6e65742f4b656972616b65652f:61727469636c652f64657461696c732f313436313130333632"
layout: post
title: "ä½¿ç”¨-OpenSSL-å’Œ-Python-å®ç°-AES-256-CBC-åŠ å¯†ä¸è§£å¯†å®‰å…¨å¯†é’¥ç®¡ç†"
date: 2025-03-08 08:36:50 +0800
description: "ä½¿ç”¨ OpenSSL å’Œ Python å®ç° AES-256-CBC åŠ å¯†ä¸è§£å¯†, åœ¨ä¸åŠ å¯†çš„è½¯ä»¶ä¸Šä¹Ÿèƒ½å®‰å…¨ä¼ è¾“ä½ çš„åŠ å¯†æ¶ˆæ¯!"
keywords: "æ²¡æœ‰aes-256-cfbæ’ä»¶"
categories: ['æœªåˆ†ç±»']
tags: ['ç½‘ç»œå®‰å…¨', 'å¯†ç å­¦', 'å®‰å…¨', 'Python', 'Openssl']
artid: "146110362"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146110362
    alt: "ä½¿ç”¨-OpenSSL-å’Œ-Python-å®ç°-AES-256-CBC-åŠ å¯†ä¸è§£å¯†å®‰å…¨å¯†é’¥ç®¡ç†"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146110362
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146110362
cover: https://bing.ee123.net/img/rand?artid=146110362
image: https://bing.ee123.net/img/rand?artid=146110362
img: https://bing.ee123.net/img/rand?artid=146110362
---

# ä½¿ç”¨ OpenSSL å’Œ Python å®ç° AES-256-CBC åŠ å¯†ä¸è§£å¯†ï¼ˆå®‰å…¨å¯†é’¥ç®¡ç†ï¼‰

### ç¯å¢ƒ

* OpenSSL
* Python

### ä½¿ç”¨ OpenSSL åŠ å¯†

#### **1. ç”Ÿæˆ AES å¯†é’¥å’Œ IV**

**å¼ºçƒˆæ¨èä½¿ç”¨æ–¹æ³•ä¸€ï¼ˆPython
`secrets`
æ¨¡å—ï¼‰**
ï¼Œå› ä¸ºå®ƒæ›´å®‰å…¨ã€‚

##### æ–¹æ³•ä¸€: Python çš„ `secrets` æ¨¡å—ï¼ˆå®‰å…¨æ–¹å¼ï¼‰

* **ä¸è¦ä½¿ç”¨ OpenSSL çš„
  `rand`
  å‘½ä»¤ç›´æ¥ç”Ÿæˆå¯†é’¥å’Œ IV ç”¨äºç”Ÿäº§ç¯å¢ƒã€‚**
  å°½ç®¡
  `openssl rand`
  å¯ä»¥ç”Ÿæˆéšæœºæ•°ï¼Œä½†å®ƒå¯èƒ½ä¸ç¬¦åˆå¯†ç å­¦å®‰å…¨çš„è¦æ±‚ã€‚
* **æ¨èæ–¹æ³•ï¼š**
  ä½¿ç”¨æ›´å®‰å…¨çš„éšæœºæ•°ç”Ÿæˆå™¨ï¼Œä¾‹å¦‚ Python çš„
  `secrets`
  æ¨¡å—ï¼š

  ```python
  import secrets
  import binascii

  # ç”Ÿæˆ 256 ä½ AES å¯†é’¥ï¼ˆ32 å­—èŠ‚ï¼‰
  key = secrets.token_bytes(32)
  key_hex = binascii.hexlify(key).decode()  # è½¬æ¢ä¸ºåå…­è¿›åˆ¶å­—ç¬¦ä¸²

  # ç”Ÿæˆ 128 ä½ IVï¼ˆ16 å­—èŠ‚ï¼‰
  iv = secrets.token_bytes(16)
  iv_hex = binascii.hexlify(iv).decode()  # è½¬æ¢ä¸ºåå…­è¿›åˆ¶å­—ç¬¦ä¸²

  print("AES Key (Hex):", key_hex)
  print("IV (Hex):", iv_hex)

  ```
* **`secrets.token_bytes(nbytes)`
  ï¼š**
  ç”Ÿæˆ
  `nbytes`
  ä¸ªå¯†ç å­¦å®‰å…¨çš„éšæœºå­—èŠ‚ã€‚
* **`binascii.hexlify(data)`
  ï¼š**
  å°†å­—èŠ‚æ•°æ®è½¬æ¢ä¸ºåå…­è¿›åˆ¶å­—ç¬¦ä¸²ã€‚
* **ä¿å­˜ï¼š**
  å°†ç”Ÿæˆçš„å¯†é’¥å’Œ IV å®‰å…¨åœ°ä¿å­˜èµ·æ¥ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨å¯†ç ç®¡ç†å™¨ï¼‰ã€‚

##### æ–¹æ³•äºŒ: ç›´æ¥ä½¿ç”¨ OpenSSL çš„ `rand` å‘½ä»¤(ä¸æ¨è)

```bash
openssl rand -hex 32  # ç”Ÿæˆ 256 ä½ AES å¯†é’¥ï¼ˆ32 å­—èŠ‚ï¼‰
openssl rand -hex 16  # ç”Ÿæˆ 128 ä½ IVï¼ˆ16 å­—èŠ‚ï¼‰

```

* **`openssl rand -hex <é•¿åº¦>`
  ï¼š**
  ä½¿ç”¨ OpenSSL çš„éšæœºæ•°ç”Ÿæˆå™¨ç”ŸæˆæŒ‡å®šé•¿åº¦çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²ã€‚
* **ä¿å­˜å¯†é’¥å’Œ IVï¼š**
  å°†ç”Ÿæˆçš„å¯†é’¥å’Œ IV å®‰å…¨åœ°ä¿å­˜èµ·æ¥ï¼ˆä¾‹å¦‚ï¼Œå­˜å‚¨åœ¨å¯†ç ç®¡ç†å™¨ä¸­ï¼‰ã€‚

#### **2. åŠ å¯†**

```bash
openssl enc -aes-256-cbc -pbkdf2 -iter 100000 -in plaintext.txt -out ciphertext.bin -K $(cat key.txt) -iv $(cat iv.txt)

```

* **`-pbkdf2`
  ï¼š**
  ä½¿ç”¨ PBKDF2 å¯†é’¥æ´¾ç”Ÿå‡½æ•°ã€‚
* **`-iter 100000`
  ï¼š**
  è®¾ç½®è¿­ä»£æ¬¡æ•°ä¸º 100000ï¼ˆå»ºè®®è‡³å°‘ 10000ï¼Œå¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´ï¼‰ã€‚
* **`-K $(cat key.txt)`
  ï¼š**
  ä»æ–‡ä»¶
  `key.txt`
  ä¸­è¯»å– AES å¯†é’¥ï¼ˆå‡è®¾ä½ å·²å°†å¯†é’¥ä¿å­˜åœ¨
  `key.txt`
  æ–‡ä»¶ä¸­ï¼‰ã€‚
* **`-iv $(cat iv.txt)`
  ï¼š**
  ä»æ–‡ä»¶
  `iv.txt`
  ä¸­è¯»å– IVï¼ˆå‡è®¾ä½ å·²å°† IV ä¿å­˜åœ¨
  `iv.txt`
  æ–‡ä»¶ä¸­ï¼‰ã€‚
* **å»æ‰äº†
  `-salt`**
  : å½“ä½¿ç”¨
  `-pbkdf2`
  çš„æ—¶å€™ï¼Œä¸å†éœ€è¦
  `-salt`
  ã€‚
* **ä¸ºä»€ä¹ˆè¦ä»æ–‡ä»¶ä¸­è¯»å–å¯†é’¥å’Œ IVï¼Ÿ**
  + **å®‰å…¨ï¼š**
    é¿å…å°†å¯†é’¥å’Œ IV ç›´æ¥å†™åœ¨å‘½ä»¤è¡Œä¸­ï¼Œé˜²æ­¢æ³„éœ²ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡å‘½ä»¤è¡Œå†å²è®°å½•ï¼‰ã€‚
  + **æ–¹ä¾¿ï¼š**
    æ–¹ä¾¿ç®¡ç†å’Œé‡å¤ä½¿ç”¨å¯†é’¥å’Œ IVã€‚

#### **3. Base64 ç¼–ç **

å°†å¯†æ–‡è½¬æ¢ä¸ºæ–‡æœ¬æ ¼å¼ï¼ˆç”¨äºç”Ÿæˆæ¡å½¢ç ï¼‰ï¼Œéœ€è¦è¿›è¡Œ Base64 ç¼–ç ï¼š

```bash
openssl base64 -in ciphertext.bin -out ciphertext.txt

```

#### **4. ç”Ÿæˆæ¡å½¢ç **

* ä½¿ç”¨åœ¨çº¿æ¡å½¢ç ç”Ÿæˆå™¨ï¼ˆå¦‚
  `https://barcode.tec-it.com/en`
  ï¼‰å°† Base64 ç¼–ç åçš„å¯†æ–‡ç”Ÿæˆæ¡å½¢ç å›¾ç‰‡ã€‚
* é€‰æ‹©æ¡å½¢ç ç±»å‹ï¼ˆå¦‚ Code 128ï¼‰ï¼Œå°† Base64 ç¼–ç åçš„å¯†æ–‡ç²˜è´´åˆ°è¾“å…¥æ¡†ä¸­ï¼Œç”Ÿæˆæ¡å½¢ç å›¾ç‰‡ã€‚

### å®‰å…¨ä¼ è¾“å¯†é’¥å’Œå¯†æ–‡

#### **1. å®‰å…¨ä¼ è¾“å¯†é’¥ï¼š**

* **é‡è¦ï¼š**
  å¯†é’¥å’Œ IV çš„å®‰å…¨è‡³å…³é‡è¦ï¼ç»å¯¹ä¸è¦é€šè¿‡ä¸å®‰å…¨çš„æ¸ é“ï¼ˆå¦‚å¾®ä¿¡ã€é‚®ä»¶ ğŸ’€ï¼‰ç›´æ¥å‘é€ã€‚
* **å®‰å…¨æ–¹æ¡ˆï¼š**
  + **çº¿ä¸‹å‘ŠçŸ¥ï¼š**
    å¦‚æœæ¡ä»¶å…è®¸ï¼Œçº¿ä¸‹å£å¤´å‘ŠçŸ¥æˆ–ä½¿ç”¨çº¸æ¡ä¼ é€’ã€‚
  + **åŠ å¯†é€šä¿¡å·¥å…·ï¼š**
    ä½¿ç”¨ Signalã€Wire ç­‰ç«¯åˆ°ç«¯åŠ å¯†çš„é€šä¿¡å·¥å…·ã€‚
  + **å¯†é’¥äº¤æ¢åè®®ï¼š**
    å¦‚æœå¯¹å¯†ç å­¦æœ‰ä¸€å®šäº†è§£ï¼Œå¯ä»¥ä½¿ç”¨ Diffie-Hellman ç­‰å¯†é’¥äº¤æ¢åè®®ã€‚
  + **å¯†é’¥æ–‡ä»¶ï¼š**
    å¯ä»¥å°†å¯†é’¥å’ŒIVå­˜æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­, ä½¿ç”¨ GPG åŠ å¯†åå‘é€.

#### **2. å‘é€æ¡å½¢ç ï¼š**

* å°†ç”Ÿæˆçš„æ¡å½¢ç å›¾ç‰‡é€šè¿‡å¾®ä¿¡ç­‰æ–¹å¼å‘é€ç»™ä½ çš„æœ‹å‹ã€‚è¿™æ­¥å¯ä»¥ç”¨å¾®ä¿¡äº†ã€‚ğŸ˜‡

### è§£å¯†æ–¹å¼

#### **1. è§£å¯†**

```bash
openssl enc -d -aes-256-cbc -in ciphertext.bin -out plaintext.txt -K $(cat key.txt) -iv $(cat iv.txt) -pbkdf2 -iter 100000

```

* **æ³¨æ„ï¼š**
  + è§£å¯†å‘½ä»¤ä¸åŠ å¯†å‘½ä»¤
    **åŸºæœ¬ç›¸åŒ**
    ï¼Œåªæ˜¯å°†
    `-enc`
    æ”¹ä¸º
    `-d`
    ï¼ˆè¡¨ç¤ºè§£å¯†ï¼‰ã€‚
  + `-pbkdf2`
    å’Œ
    `-iter`
    å‚æ•°å¿…é¡»ä¸åŠ å¯†æ—¶
    **å®Œå…¨ä¸€è‡´**
    ã€‚
  + `-K`
    å’Œ
    `-iv`
    å‚æ•°ä»ç„¶ä»æ–‡ä»¶ä¸­è¯»å–å¯†é’¥å’Œ IVã€‚

#### **2. Base64 è§£ç **

```bash
openssl base64 -d -in ciphertext.txt -out ciphertext.bin

```

### **å®Œæ•´çš„æµç¨‹æ€»ç»“**

1. **ç”Ÿæˆå¼ºå¯†é’¥å’Œ IVï¼š**

   * ä½¿ç”¨ Python çš„
     `secrets`
     æ¨¡å—ã€‚
   * å°†å¯†é’¥å’Œ IV ä¿å­˜åˆ°å®‰å…¨çš„æ–‡ä»¶ä¸­ï¼ˆä¾‹å¦‚ï¼Œ
     `key.txt`
     å’Œ
     `iv.txt`
     ï¼‰, æˆ–è€…å¯†ç ç®¡ç†å™¨ä¸­ã€‚
2. **åŠ å¯†ï¼š**

   ```bash
   openssl enc -aes-256-cbc -pbkdf2 -iter 100000 -in plaintext.txt -out ciphertext.bin -K $(cat key.txt) -iv $(cat iv.txt)

   ```

   ```bash
   openssl base64 -in ciphertext.bin -out ciphertext.txt

   ```
3. **è§£å¯†ï¼š**

   ```bash
   openssl enc -d -aes-256-cbc -in ciphertext.bin -out plaintext.txt -K $(cat key.txt) -iv $(cat iv.txt) -pbkdf2 -iter 100000

   ```

   ```bash
   openssl base64 -d -in ciphertext.txt -out ciphertext.bin

   ```

æ³¨æ„å®‰å…¨, HAVE FUN! ğŸ‘€