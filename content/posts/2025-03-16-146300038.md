---
layout: post
title: "Python学习第十九天"
date: 2025-03-16 20:14:57 +0800
description: "Python第十九天学习内容：前端分页和后端分页、增加前端静态资源比如背景图"
keywords: "Python学习第十九天"
categories: ['Python']
tags: ['学习', 'Python']
artid: "146300038"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146300038
    alt: "Python学习第十九天"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146300038
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146300038
cover: https://bing.ee123.net/img/rand?artid=146300038
image: https://bing.ee123.net/img/rand?artid=146300038
img: https://bing.ee123.net/img/rand?artid=146300038
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Python学习第十九天
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h2>
     Django-分页
    </h2>
    <h3>
     后端分页
    </h3>
    <p>
     Django提供了
     <code>
      Paginator
     </code>
     类来实现后端分页。
     <code>
      Paginator
     </code>
     类可以将一个查询集（QuerySet）分成多个页面，每个页面包含指定数量的对象。
    </p>
    <pre><code class="language-python">from django.shortcuts import render, redirect, get_object_or_404
from .models import User
from .forms import UserForm
from django.core.paginator import Paginator, EmptyPage, PageNotAnInteger

'''
    用户列表
'''
def user_list(request):
    user_list = User.objects.all()

    # 处理自定义值
    try:
        # 获取用户选择的每页显示数量，默认为 10
        per_page = int(request.GET.get('per_page', 10))
        per_page = int(per_page)  # 将 per_page 转换为整数
        if per_page &lt;= 0:  # 如果输入的值小于等于0，设置为默认值10
            per_page = 10
    except (ValueError, TypeError):  # 如果 per_page 不是数字，设置为默认值10
        per_page = 10

    # 分页
    paginator = Paginator(user_list, per_page)
    page_number = request.GET.get('page')
    try:
        page_obj = paginator.get_page(page_number)  # 获取当前页
    except PageNotAnInteger:  # 如果 page 不是整数，跳转到第一页
        page_obj = paginator.get_page(1)
    except EmptyPage:  # 如果 page 超出范围，跳转到最后一页
        page_obj = paginator.get_page(paginator.num_pages)

    # 允许的每页显示数量列表
    allowed_per_page = [10, 20, 50, 100, 200]

    return render(request, 'myapp/user_list.html', {
        'page_obj': page_obj,
        'per_page': per_page,  # 将每页显示数量传递给模板
        'allowed_per_page': allowed_per_page,

    })</code></pre>
    <h3>
     前端分页
    </h3>
    <p>
     通用前端的分页代码支持输入页码，也支持选择页码，跳转到对应页面
    </p>
    <pre><code class="language-html">&lt;nav aria-label="Page navigation" class="mt-4"&gt;
    &lt;ul class="pagination justify-content-center"&gt;
        &lt;!-- 首页按钮 --&gt;
        {% if page_obj.has_previous %}
            &lt;li class="page-item"&gt;
                &lt;a class="page-link" href="?page=1&amp;per_page={<!-- -->{ per_page }}" aria-label="First"&gt;
                    &lt;span aria-hidden="true"&gt;首页&lt;/span&gt;
                &lt;/a&gt;
            &lt;/li&gt;
        {% else %}
            &lt;li class="page-item disabled"&gt;
                &lt;span class="page-link"&gt;首页&lt;/span&gt;
            &lt;/li&gt;
        {% endif %}

        &lt;!-- 上一页按钮 --&gt;
        {% if page_obj.has_previous %}
            &lt;li class="page-item"&gt;
                &lt;a class="page-link" href="?page={<!-- -->{ page_obj.previous_page_number }}&amp;per_page={<!-- -->{ per_page }}" aria-label="Previous"&gt;
                    &lt;span aria-hidden="true"&gt;上一页&lt;/span&gt;
                &lt;/a&gt;
            &lt;/li&gt;
        {% else %}
            &lt;li class="page-item disabled"&gt;
                &lt;span class="page-link"&gt;上一页&lt;/span&gt;
            &lt;/li&gt;
        {% endif %}

        &lt;!-- 当前页码信息 --&gt;
        &lt;li class="page-item active"&gt;
            &lt;span class="page-link"&gt;
                第 {<!-- -->{ page_obj.number }} 页，共 {<!-- -->{ page_obj.paginator.num_pages }} 页
            &lt;/span&gt;
        &lt;/li&gt;

        &lt;!-- 下一页按钮 --&gt;
        {% if page_obj.has_next %}
            &lt;li class="page-item"&gt;
                &lt;a class="page-link" href="?page={<!-- -->{ page_obj.next_page_number }}&amp;per_page={<!-- -->{ per_page }}" aria-label="Next"&gt;
                    &lt;span aria-hidden="true"&gt;下一页&lt;/span&gt;
                &lt;/a&gt;
            &lt;/li&gt;
        {% else %}
            &lt;li class="page-item disabled"&gt;
                &lt;span class="page-link"&gt;下一页&lt;/span&gt;
            &lt;/li&gt;
        {% endif %}

        &lt;!-- 末页按钮 --&gt;
        {% if page_obj.has_next %}
            &lt;li class="page-item"&gt;
                &lt;a class="page-link" href="?page={<!-- -->{ page_obj.paginator.num_pages }}&amp;per_page={<!-- -->{ per_page }}" aria-label="Last"&gt;
                    &lt;span aria-hidden="true"&gt;末页&lt;/span&gt;
                &lt;/a&gt;
            &lt;/li&gt;
        {% else %}
            &lt;li class="page-item disabled"&gt;
                &lt;span class="page-link"&gt;末页&lt;/span&gt;
            &lt;/li&gt;
        {% endif %}
    &lt;/ul&gt;

    &lt;!-- 输入页码跳转和选择每页显示数量 --&gt;
    &lt;div class="d-flex justify-content-center mt-3"&gt;
        &lt;!-- 输入页码跳转 --&gt;
        &lt;form method="get" action="" class="form-inline mr-3"&gt;
            &lt;div class="input-group"&gt;
                &lt;input type="number" name="page" class="form-control" min="1" max="{<!-- -->{ page_obj.paginator.num_pages }}"
                       placeholder="页码" aria-label="页码" required&gt;
                &lt;input type="hidden" name="per_page" value="{<!-- -->{ per_page }}"&gt;
                &lt;div class="input-group-append"&gt;
                    &lt;button type="submit" class="btn btn-outline-primary"&gt;跳转&lt;/button&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/form&gt;

        &lt;!-- 选择每页显示数量 --&gt;
        &lt;form method="get" action="" class="form-inline"&gt;
            &lt;div class="input-group"&gt;
                &lt;select name="per_page" class="form-control" aria-label="每页显示数量" onchange="this.form.submit()"&gt;
                    &lt;option value="10" {% if per_page == 10 %}selected{% endif %}&gt;10 条/页&lt;/option&gt;
                    &lt;option value="20" {% if per_page == 20 %}selected{% endif %}&gt;20 条/页&lt;/option&gt;
                    &lt;option value="50" {% if per_page == 50 %}selected{% endif %}&gt;50 条/页&lt;/option&gt;
                    &lt;option value="100" {% if per_page == 100 %}selected{% endif %}&gt;100 条/页&lt;/option&gt;
                    &lt;option value="200" {% if per_page == 200 %}selected{% endif %}&gt;200 条/页&lt;/option&gt;

                    &lt;option value="1" {% if per_page != 10 and per_page != 20 and per_page != 50 and per_page != 100 and per_page != 200 %}selected{% endif %}&gt;自定义&lt;/option&gt;
                &lt;/select&gt;
                {% if per_page != 10 and per_page != 20 and per_page != 50 and per_page != 100 and per_page != 200 %}
                    &lt;input type="number" name="per_page" class="form-control ml-2" min="1"
                           value="{<!-- -->{ per_page }}" placeholder="自定义" aria-label="自定义" required&gt;
                {% endif %}
            &lt;/div&gt;
        &lt;/form&gt;
    &lt;/div&gt;
&lt;/nav&gt;
</code></pre>
    <h2 style="background-color:transparent">
     静态资源配置
    </h2>
    <h3>
     使用
    </h3>
    <p>
     在前端中需要引入背景图或者其他的静态资源
    </p>
    <p>
     配置settings.py
    </p>
    <pre><code class="language-bash"># 静态资源
STATIC_URL = 'static/'
import os
# 静态文件目录
STATICFILES_DIRS = [
    os.path.join(BASE_DIR, 'static'),           # 全局静态文件目录
    os.path.join(BASE_DIR, 'user/static'),     # user app 的静态文件目录
]</code></pre>
    <p>
     目录以及加载使用
    </p>
    <p>
     html中使用
    </p>
    <pre><code class="language-html">&lt;!-- 加载静态文件 --&gt;
{% load static %}
&lt;!-- 全局静态文件 --&gt;
&lt;!--&lt;body style="background-image: url('{% static '02.png' %}');"&gt;--&gt;
&lt;!-- 引入app下的的静态文件 --&gt;
 &lt;body style="background-image: url('{% static 'user/images/backgroud_image.png' %}');"&gt;</code></pre>
    <p>
     <img alt="" height="811" src="https://i-blog.csdnimg.cn/direct/1370bfe0645a4a19ac02b1daef9c0443.png" width="1761"/>
    </p>
    <h3>
     防止多次加载
    </h3>
    <p>
     在 Django 模板中，使用
     <code>
      {% block %}
     </code>
     来定义可覆盖的区域，避免在多个模板中重复加载相同的静态资源。（主要是使用这个其他通过继承这部分内容 有点像是iframe标签 引入了部分代码块）
    </p>
    <pre><code class="language-html"># 在main.html中使用{% block content %}{% endblock %}

&lt;!-- 加载静态文件 --&gt;
{# main.html注释哈 #}
{% load static %}
&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;{% block title %}首页{% endblock %}&lt;/title&gt;
&lt;/head&gt;
&lt;!-- 全局静态文件 --&gt;
&lt;!--&lt;body style="background-image: url('{% static '02.png' %}');"&gt;--&gt;
&lt;!-- 引入app下的的静态文件 比如使用app下的静态资源不需要重复引入 --&gt;
&lt;body style="background-image: url('{% static 'user/images/backgroud_image.png' %}');"&gt;
&lt;a href="{% url 'main' %}"&gt;首页&lt;/a&gt;
&lt;a href="{% url 'register' %}"&gt;注册&lt;/a&gt;
&lt;a href="{% url 'login' %}"&gt;登录&lt;/a&gt;
{# 主要是使用这个其他通过继承这部分内容 有点像是iframe标签 引入了部分代码块 #}
{% block content %}{% endblock %}
&lt;/body&gt;
&lt;/html&gt;</code></pre>
    <p>
     子类通过继承{% extends 'main.html' %} 以及主类中的{% block 名称%}
    </p>
    <pre><code class="language-html">{# login.html的模版 继承main的静态资源只需要写自己的相关代码块即可 #}
{% extends 'main.html' %}

{% block content %}
用户名：&lt;input name="username" value ="" placeholder="请输入用户名"/&gt;
密码：&lt;input name="password" value ="" placeholder="请输入密码"/&gt;
{% endblock%}
</code></pre>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f33373831333131382f:61727469636c652f64657461696c732f313436333030303338" class_="artid" style="display:none">
 </p>
</div>


