---
layout: post
title: "Docker-å­¦ä¹ ç¬”è®°ä»å…¥é—¨åˆ°éƒ¨ç½²,å®æˆ˜æ¼”ç»ƒå…¨æµç¨‹"
date: 2025-03-09 11:13:25 +0800
description: "Docker ä¸ä»…è®©å¼€å‘éƒ¨ç½²æ›´ç®€å•ï¼Œè¿˜è®©è¿ç»´ç®¡ç†æ›´é«˜æ•ˆã€‚å¦‚æœä½ æƒ³çœŸæ­£æŒæ¡å®ƒï¼Œå°±ä» åŠ¨æ‰‹å®è·µ å¼€å§‹ï¼å¸Œæœ›è¿™ç¯‡å­¦ä¹ ç¬”è®°èƒ½å¸®åˆ°ä½ ï¼Œè®°å¾—æ”¶è— + åˆ†äº«ï¼Œè®©æ›´å¤šäººå—ç›Šï¼ğŸ‘€ ä½ è¿˜æƒ³äº†è§£å“ªäº› Docker è¿›é˜¶ç©æ³•ï¼Ÿæ¬¢è¿ç•™è¨€è®¨è®ºï¼"
keywords: "Docker å­¦ä¹ ç¬”è®°ï¼šä»å…¥é—¨åˆ°éƒ¨ç½²ï¼Œå®æˆ˜æ¼”ç»ƒå…¨æµç¨‹ï¼"
categories: ['æœªåˆ†ç±»']
tags: ['å®¹å™¨', 'Docker', 'Docker']
artid: "146128672"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146128672
    alt: "Docker-å­¦ä¹ ç¬”è®°ä»å…¥é—¨åˆ°éƒ¨ç½²,å®æˆ˜æ¼”ç»ƒå…¨æµç¨‹"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146128672
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146128672
cover: https://bing.ee123.net/img/rand?artid=146128672
image: https://bing.ee123.net/img/rand?artid=146128672
img: https://bing.ee123.net/img/rand?artid=146128672
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Docker å­¦ä¹ ç¬”è®°ï¼šä»å…¥é—¨åˆ°éƒ¨ç½²ï¼Œå®æˆ˜æ¼”ç»ƒå…¨æµç¨‹ï¼
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="__Docker_0">
     </a>
     <strong>
      ğŸ“Œ å¼€ç¯‡ï¼šä¸ºä»€ä¹ˆè¦å­¦ Dockerï¼Ÿ
     </strong>
    </h2>
    <p>
     è¿˜åœ¨ä¸ºç¯å¢ƒä¸ä¸€è‡´ã€éƒ¨ç½²éº»çƒ¦ã€ä¾èµ–å†²çªå¤´ç–¼å—ï¼ŸDocker è®©ä¸€åˆ‡å˜å¾—ç®€å•ï¼ä½œä¸ºç°ä»£å¼€å‘å’Œè¿ç»´çš„ç¥å™¨ï¼ŒDocker è®©æˆ‘ä»¬å¯ä»¥ç”¨
     <strong>
      ä¸€å¥å‘½ä»¤
     </strong>
     è§£å†³ â€œåœ¨æˆ‘ç”µè„‘ä¸Šèƒ½è·‘â€ çš„é—®é¢˜ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°±æ¥ç³»ç»Ÿæ•´ç†ä¸€ä¸‹ Docker çš„å­¦ä¹ ç¬”è®°ï¼Œè®©ä½ è½»æ¾ä¸Šæ‰‹ï¼Œå¹¶èƒ½åœ¨å®é™…é¡¹ç›®ä¸­ç”¨å¾—ä¸Šï¼
    </p>
    <h2>
     <a id="Docker__4">
     </a>
     Docker å¸¸ç”¨å‘½ä»¤
    </h2>
    <h3>
     <a id="_6">
     </a>
     é•œåƒå‘½ä»¤
    </h3>
    <h4>
     <a id="docker_images_8">
     </a>
     docker images
    </h4>
    <p>
     docker images æŸ¥çœ‹æ‰€æœ‰æœ¬åœ°çš„ä¸»æœºä¸Šçš„é•œåƒ
    </p>
    <pre><code>[root@VM-16-5-centos ~]# docker images
REPOSITORY    TAG       IMAGE ID       CREATED        SIZE
hello-world   latest    feb5d9fea6a5   6 months ago   13.3kB
</code></pre>
    <p>
     <strong>
      æ‰§è¡Œè§£é‡Š
     </strong>
    </p>
    <table>
     <thead>
      <tr>
       <th>
        KEY
       </th>
       <th>
        ç»“æœè§£é‡Š
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        REPOSITORY
       </td>
       <td>
        é•œåƒçš„ä»“åº“æº
       </td>
      </tr>
      <tr>
       <td>
        TAG
       </td>
       <td>
        é•œåƒçš„æ ‡ç­¾
       </td>
      </tr>
      <tr>
       <td>
        IMAGE ID
       </td>
       <td>
        é•œåƒçš„ID
       </td>
      </tr>
      <tr>
       <td>
        CREATED
       </td>
       <td>
        é•œåƒçš„åˆ›å»ºæ—¶é—´
       </td>
      </tr>
      <tr>
       <td>
        SIZE
       </td>
       <td>
        é•œåƒçš„å¤§å°
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     <strong>
      å‘½ä»¤å‚æ•°å¯é€‰é¡¹ -a -q
     </strong>
    </p>
    <pre><code>[root@VM-16-5-centos ~]# docker images -a
REPOSITORY    TAG       IMAGE ID       CREATED        SIZE
hello-world   latest    feb5d9fea6a5   6 months ago   13.3kB
[root@VM-16-5-centos ~]# docker images -q
feb5d9fea6a5
</code></pre>
    <h4>
     <a id="docker_search_38">
     </a>
     docker search
    </h4>
    <p>
     docker search æœç´¢é•œåƒ
    </p>
    <pre><code>[root@VM-16-5-centos ~]# docker search mysql
NAME                             DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED
mysql                            MySQL is a widely used, open-source relationâ€¦   12393     [OK]       
mariadb                          MariaDB Server is a high performing open souâ€¦   4770      [OK]
</code></pre>
    <h4>
     <a id="docker_pull_49">
     </a>
     docker pull
    </h4>
    <p>
     docker pull æ‹‰å–é•œåƒ
    </p>
    <pre><code># ä¸‹è½½é•œåƒ docker pull é•œåƒå[:tag]
[root@VM-16-5-centos ~]# docker pull mysql
Using default tag: latest # å¦‚æœä¸å†™tagï¼Œé»˜è®¤å°±æ˜¯latest
latest: Pulling from library/mysql
f003217c5aae: Pull complete  # åˆ†å±‚ä¸‹è½½ï¼Œdocker imageçš„æ ¸å¿ƒ è”åˆæ–‡ä»¶ç³»ç»Ÿ
65d94f01a09f: Pull complete 
43d78aaa6078: Pull complete 
a0f91ffbdf69: Pull complete 
59ee9e07e12f: Pull complete 
04d82978082c: Pull complete 
70f46ebb971a: Pull complete 
db6ea71d471d: Pull complete 
c2920c795b25: Pull complete 
26c3bdf75ff5: Pull complete 
9ec1f1f78b0e: Pull complete 
4607fa685ac6: Pull complete 
Digest: sha256:1c75ba7716c6f73fc106dacedfdcf13f934ea8c161c8b3b3e4618bcd5fbcf195 # ç­¾å
Status: Downloaded newer image for mysql:latest
docker.io/library/mysql:latest	# çœŸå®åœ°å€
# docker pull mysqlå‘½ä»¤ç­‰ä»·äº docker pull docker.io/library/mysql:latest

# æŒ‡å®šç‰ˆæœ¬ä¸‹è½½ å‰æå®˜ç½‘ä»“åº“éœ€è¦æœ‰
[root@VM-16-5-centos ~]# docker pull mysql:5.7
5.7: Pulling from library/mysql
f003217c5aae: Already exists 
65d94f01a09f: Already exists 
43d78aaa6078: Already exists 
a0f91ffbdf69: Already exists 
59ee9e07e12f: Already exists 
04d82978082c: Already exists 
70f46ebb971a: Already exists  # æœ‰ä¾èµ–å·²ç»æœ‰çš„å°±ä¸ä¼šå†æ¬¡ä¸‹è½½
ba61822c65c2: Pull complete 
dec59acdf78a: Pull complete 
0a05235a6981: Pull complete 
c87d621d6916: Pull complete 
Digest: sha256:1a73b6a8f507639a8f91ed01ace28965f4f74bb62a9d9b9e7378d5f07fab79dc
Status: Downloaded newer image for mysql:5.7
docker.io/library/mysql:5.7
</code></pre>
    <h4>
     <a id="docker_rmi_94">
     </a>
     docker rmi
    </h4>
    <p>
     docker rmi -f é•œåƒIDåˆ é™¤é•œåƒ
    </p>
    <pre><code>[root@VM-16-5-centos ~]# docker rmi -f f26e21ddd20d
Untagged: mysql:5.7
Untagged: mysql@sha256:1a73b6a8f507639a8f91ed01ace28965f4f74bb62a9d9b9e7378d5f07fab79dc
Deleted: sha256:f26e21ddd20df245d88410116241f3eef1ec49ce888856c95b85081a7250183d
Deleted: sha256:c607cd1716e1e3f52d37b391b9e48207c15b9de687c49539c42b7c7411b8a845
Deleted: sha256:18d0239fa88c234ffcde52288f532ac4f69d052964d6605df32fb2e3a197bbf9
Deleted: sha256:8d1d80a87e029e4729a56a87e38d54b9ef2ca1af404e13af1feadeba53745529
Deleted: sha256:1ac7c17dadb8b439a4034925f290a2f9288068b4192669bed1a614c4057c0c1b
# åˆ é™¤æ‰€æœ‰é•œåƒ ï¼ˆå…¶ä¸­docker images -aqæŸ¥è¯¢æ‰€æœ‰é•œåƒIDï¼‰
[root@VM-16-5-centos ~]# docker rmi -f $(docker images -aq)
# åˆ é™¤å¤šä¸ªå®¹å™¨
[root@VM-16-5-centos ~]# docker rmi -f å®¹å™¨ID1 å®¹å™¨ID2 å®¹å™¨ID3
</code></pre>
    <h3>
     <a id="_113">
     </a>
     å®¹å™¨å‘½ä»¤
    </h3>
    <p>
     è¯´æ˜ï¼šæˆ‘ä»¬æœ‰äº†é•œåƒæ‰å¯ä»¥åˆ›å»ºå®¹å™¨ï¼Œä¸‹è½½ä¸€ä¸ªcentosé•œåƒæ¥æµ‹è¯•
    </p>
    <pre><code>docker pull centos
</code></pre>
    <h4>
     <a id="_121">
     </a>
     æ–°å»ºå®¹å™¨å¹¶ä¸”å¯åŠ¨
    </h4>
    <pre><code>docker run [å¯é€‰å‚æ•°] image
# å‚æ•°è¯´æ˜
--name="Name" 	å®¹å™¨åç§° ç”¨æ¥åŒºåˆ†å®¹å™¨
-d				åå°æ–¹å¼è¿è¡Œ
-it				ä½¿ç”¨äº¤äº’æ–¹å¼è¿è¡Œï¼Œè¿›å…¥å®¹å™¨æŸ¥çœ‹å†…å®¹
-p				æŒ‡å®šå®¹å™¨çš„ç«¯å£ eg. -p 8080:8080
    -p ip:ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£
	-p ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£ ï¼ˆå¸¸ç”¨ï¼‰
	-p å®¹å™¨ç«¯å£
	-p			éšæœºæŒ‡å®šç«¯å£
# æµ‹è¯•
docker run -it centos /bin/bash # å¯åŠ¨å¹¶ä¸”è¿›å…¥å®¹å™¨
exit # é€€å‡ºå®¹å™¨
</code></pre>
    <h4>
     <a id="_139">
     </a>
     åˆ—å‡ºæ‰€æœ‰è¿è¡Œçš„å®¹å™¨
    </h4>
    <pre><code>docker ps 		# åˆ—å‡ºå½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨
docker ps -a 	# åˆ—å‡ºå½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨ + åˆ—å‡ºå†å²å·²ç»è¿è¡Œçš„å®¹å™¨
docker ps -n=?	# æ˜¾ç¤ºæœ€è¿‘åˆ›å»ºçš„å®¹å™¨
docker ps -q	# åªæ˜¾ç¤ºæ­£åœ¨è¿è¡Œå®¹å™¨çš„ç¼–å·
</code></pre>
    <h4>
     <a id="_148">
     </a>
     é€€å‡ºå®¹å™¨
    </h4>
    <pre><code>exit	# ç›´æ¥å®¹å™¨åœæ­¢å¹¶é€€å‡º
Ctrl + P + Q 	# å®¹å™¨ä¸åœæ­¢é€€å‡º
</code></pre>
    <h4>
     <a id="_155">
     </a>
     åˆ é™¤å®¹å™¨
    </h4>
    <pre><code>docker rm å®¹å™¨id					   # åˆ é™¤æŒ‡å®šå®¹å™¨ï¼Œä¸èƒ½åˆ é™¤æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼Œå¦‚æœå¼ºåˆ¶åˆ é™¤ï¼Œéœ€è¦rm -f
docker rm -f $(docker ps -aq)		# åˆ é™¤æ‰€æœ‰å®¹å™¨
</code></pre>
    <h4>
     <a id="_162">
     </a>
     å¯åŠ¨å’Œåœæ­¢å®¹å™¨
    </h4>
    <pre><code>docker start å®¹å™¨id
docker restart å®¹å™¨id
docker stop å®¹å™¨id
docker kill å®¹å™¨id
</code></pre>
    <h4>
     <a id="_171">
     </a>
     è¿›å…¥å®¹å™¨
    </h4>
    <p>
     è¿›å…¥å®¹å™¨å‘½ä»¤
    </p>
    <pre><code># æˆ‘ä»¬é€šå¸¸å®¹å™¨éƒ½æ˜¯ä½¿ç”¨åå°æ–¹å¼è¿è¡Œçš„ï¼Œéœ€è¦è¿›å…¥å®¹å™¨ï¼Œä¿®æ”¹ä¸€äº›é…ç½®ä»¥å®ç°

# è¿›å…¥å®¹å™¨å‘½ä»¤å‘½ä»¤ 
# æ–¹å¼ä¸€	docker exec -it å®¹å™¨id bashShell
docker exec -it å®¹å™¨id /bin/bash
[root@VM-16-5-centos ~]# docker exec -it 8b0d2f432376 /bin/bash

# æ–¹å¼äºŒ	docker attach å®¹å™¨id
[root@VM-16-5-centos ~]# docker attach 03d21bad4539
[root@03d21bad4539 /]# #æ­£åœ¨æ‰§è¡Œçš„ä»£ç 

# åŒºåˆ«

# docker exec	# è¿›å…¥å®¹å™¨åå¼€å¯ä¸€ä¸ªæ–°çš„ç»ˆç«¯ï¼Œå¯ä»¥åœ¨é‡Œé¢æ“ä½œ ã€å¸¸ç”¨ã€‘
# docker attach # è¿›å…¥å®¹å™¨æ­£åœ¨æ‰§è¡Œçš„ç»ˆç«¯ï¼Œä¸ä¼šå¯åŠ¨æ–°çš„è¿›ç¨‹
</code></pre>
    <h3>
     <a id="_193">
     </a>
     å¸¸ç”¨å‘½ä»¤
    </h3>
    <h4>
     <a id="_195">
     </a>
     åå°å¯åŠ¨å®¹å™¨å‘½ä»¤
    </h4>
    <pre><code># å‘½ä»¤ docker run -d é•œåƒ

# æ‰§è¡Œå®Œæˆä¹‹åå‡ºç°é—®é¢˜ docker ps å‘ç°centos åœæ­¢

# åŸå› ï¼šdocker å®¹å™¨ä½¿ç”¨åå°è¿è¡Œï¼Œå°±å¿…é¡»è¦æœ‰ä¸€ä¸ªå‰å°è¿›ç¨‹ï¼Œdockerå‘ç°æ²¡æœ‰åº”ç”¨ï¼Œå°±ä¼šè‡ªåŠ¨åœæ­¢

# æµ‹è¯•
docker run -it centos /bin/bash # å¯åŠ¨å¹¶ä¸”è¿›å…¥å®¹å™¨ 
Ctrl + P + Q 	# å®¹å™¨ä¸åœæ­¢é€€å‡º
docker ps # æ­¤æ–¹å¼å­˜åœ¨è¿›ç¨‹

# æµ‹è¯•è¿‡ç¨‹
[root@VM-16-5-centos ~]# docker run -it centos /bin/bash
[root@265fad67c23c /]# [root@VM-16-5-centos ~]# 
[root@VM-16-5-centos ~]# docker ps
CONTAINER ID   IMAGE     COMMAND       CREATED          STATUS          PORTS     NAMES
265fad67c23c   centos    "/bin/bash"   56 seconds ago   Up 55 seconds             naughty_dhawan
[root@VM-16-5-centos ~]# docker logs -f -t --tail 10 265fad67c23c
</code></pre>
    <h4>
     <a id="_218">
     </a>
     æŸ¥çœ‹æ—¥å¿—
    </h4>
    <pre><code>docker logs -f -t --tail [è¡Œæ•°] [å®¹å™¨id]
# eg.
[root@VM-16-5-centos ~]# docker logs -f -t --tail 10 265fad67c23c
2022-04-11T16:28:25.267052701Z bash: hostory: command not found
2022-04-11T16:28:29.301653166Z [root@265fad67c23c /]# history 
2022-04-11T16:28:29.301684360Z     1  ls
2022-04-11T16:28:29.301713366Z     2  ll
2022-04-11T16:28:29.301717403Z     3  hostory
2022-04-11T16:28:29.301721227Z     4  history
2022-04-11T16:28:32.148697734Z [root@265fad67c23c /]# pwd
2022-04-11T16:28:32.148726863Z /
2022-04-11T16:28:32.354371895Z [root@265fad67c23c /]# 
2022-04-11T16:28:32.557457658Z [root@265fad67c23c /]#
</code></pre>
    <p>
     <strong>
      æµ‹è¯•è¿‡ç¨‹
     </strong>
    </p>
    <pre><code>[root@VM-16-5-centos ~]# docker run -d centos /bin/sh -c "while true;do echo kamila; sleep 1; done"
9f4e032553ee5bdebcc3f7db594276a4317a5ee96e7f035dff14fbb7c8f9d7d8
[root@VM-16-5-centos ~]# docker ps
CONTAINER ID   IMAGE     COMMAND                  CREATED         STATUS         PORTS     NAMES
9f4e032553ee   centos    "/bin/sh -c 'while tâ€¦"   8 seconds ago   Up 7 seconds             xenodochial_elion
[root@VM-16-5-centos ~]# docker logs -f -t --tail 5 9f4e032553ee
2022-04-11T16:39:19.477204322Z kamila
2022-04-11T16:39:20.479143262Z kamila
2022-04-11T16:39:21.481326571Z kamila
</code></pre>
    <p>
     <strong>
      å…³äº /bin/sh ç›´æ¥æ‰§è¡Œ shell è„šæœ¬
     </strong>
    </p>
    <pre><code>[root@57e9286eec0d /]# /bin/sh -c "echo kamila8"
kamila8
[root@57e9286eec0d /]# /bin/bash -c "echo kamila8"
kamila8
</code></pre>
    <h4>
     <a id="_259">
     </a>
     æŸ¥çœ‹å®¹å™¨ä¸­è¿›ç¨‹ä¿¡æ¯
    </h4>
    <pre><code>[root@VM-16-5-centos ~]# docker top 57e9286eec0d
</code></pre>
    <h4>
     <a id="_265">
     </a>
     æŸ¥çœ‹é•œåƒæºæ•°æ®
    </h4>
    <pre><code>[root@VM-16-5-centos ~]# docker inspect 57e9286eec0d
</code></pre>
    <h4>
     <a id="_271">
     </a>
     è¿›å…¥å½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨
    </h4>
    <p>
     <strong>
      è¿›å…¥å®¹å™¨å‘½ä»¤å‘½ä»¤
     </strong>
    </p>
    <pre><code># æˆ‘ä»¬é€šå¸¸å®¹å™¨éƒ½æ˜¯ä½¿ç”¨åå°æ–¹å¼è¿è¡Œçš„ï¼Œéœ€è¦è¿›å…¥å®¹å™¨ï¼Œä¿®æ”¹ä¸€äº›é…ç½®ä»¥å®ç°

# è¿›å…¥å®¹å™¨å‘½ä»¤å‘½ä»¤ 
# æ–¹å¼ä¸€	docker exec -it å®¹å™¨id bashShell
docker exec -it å®¹å™¨id /bin/bash

# æ–¹å¼äºŒ	docker attach å®¹å™¨id
[root@VM-16-5-centos ~]# docker attach 03d21bad4539
[root@03d21bad4539 /]# #æ­£åœ¨æ‰§è¡Œçš„ä»£ç 

# åŒºåˆ«

# docker exec	# è¿›å…¥å®¹å™¨åå¼€å¯ä¸€ä¸ªæ–°çš„ç»ˆç«¯ï¼Œå¯ä»¥åœ¨é‡Œé¢æ“ä½œ ã€å¸¸ç”¨ã€‘
# docker attach # è¿›å…¥å®¹å™¨æ­£åœ¨æ‰§è¡Œçš„ç»ˆç«¯ï¼Œä¸ä¼šå¯åŠ¨æ–°çš„è¿›ç¨‹
</code></pre>
    <h4>
     <a id="_292">
     </a>
     ä»å®¹å™¨æ‹·è´æ–‡ä»¶åˆ°å¤–éƒ¨ä¸»æœºä¸Š
    </h4>
    <pre><code>docker cp å®¹å™¨id:å®¹å™¨å†…çš„è·¯å¾„ å½“å‰ä¸»æœºç›®çš„ç›®å½•
[root@VM-16-5-centos tmp0403]# docker cp 03d21bad4539:/tmp0412/readme /tmp/tmp0403/

# æ‹·è´æ˜¯ä¸€ä¸ªæ‰‹åŠ¨è¿‡ç¨‹ï¼Œåç»­ä½¿ç”¨ -v å·æŠ€æœ¯ï¼Œå¯ä»¥å®ç°è‡ªåŠ¨åŒæ­¥ eg. å®¹å™¨å†…/home ä¸ ä¸»æœº /home å¯¹åº”åŒæ­¥
</code></pre>
    <h2>
     <a id="Docker__301">
     </a>
     Docker éƒ¨ç½²å®è·µ
    </h2>
    <h3>
     <a id="_Nginx_303">
     </a>
     éƒ¨ç½² Nginx
    </h3>
    <pre><code># æ‹‰å–é•œåƒ
docker pull nginx
# å¯åŠ¨é•œåƒ
docker run -d --name nginx01 -p 80:80 nginx
# è¿è¡Œæµ‹è¯•
[root@VM-16-5-centos ~]# docker run -d --name nginx01 -p 8080:80 nginx
479af478aa8eabfa6d980924b9c40c9b44c6a6e1d542d38b0b03e4c7e0e8325f
[root@VM-16-5-centos ~]# curl localhost:8080
# -d åå°è¿è¡Œ
# --name ç»™å®¹å™¨å–å
# -p å®¿ä¸»æœºç«¯å£:å®¹å™¨å†…éƒ¨ç«¯å£

# è¿›å…¥nginx è¿›å…¥å®¹å™¨
[root@VM-16-5-centos ~]# docker exec -it nginx01 /bin/bash
root@0a44ad83dfe5:/# whereis nginx
nginx: /usr/sbin/nginx /usr/lib/nginx /etc/nginx /usr/share/nginx

exit # é€€å‡ºå®¹å™¨
</code></pre>
    <p>
     æˆ‘ä»¬æ¯æ¬¡æ”¹åŠ¨ nginx é…ç½®æ–‡ä»¶ï¼Œéƒ½éœ€è¦è¿›å…¥å®¹å™¨å†…éƒ¨ï¼Ÿååˆ†éº»çƒ¦ï¼Œæˆ‘è¦æ˜¯å¯ä»¥åœ¨å®¹å™¨å¤–éƒ¨æä¾›ä¸€ä¸ªæ˜ å°„è·¯å¾„ï¼Œè¾¾åˆ°åœ¨å®¹å™¨ä¿®æ”¹æ–‡ä»¶åï¼Œå®¹å™¨å†…éƒ¨å°±å¯ä»¥è‡ªåŠ¨ä¿®æ”¹ï¼Ÿ
     <strong>
      ä½¿ç”¨ -v æ•°æ®å·æŠ€æœ¯è¿›è¡Œå¤„ç†ã€‚run -v /user/share/nginx /nginx/conf è¿™æ ·å¯ä»¥åœ¨ä¸»æœºä¸Šä¿®æ”¹æ–‡ä»¶å¹¶ä¸”å®¹å™¨å†…ä¿æŒåŒæ­¥ã€‚
     </strong>
    </p>
    <h3>
     <a id="_Tomcat_328">
     </a>
     éƒ¨ç½² Tomcat
    </h3>
    <p>
     ä¸‹è½½æŒ‡å®š Tomcat ç‰ˆæœ¬éœ€è¦å…ˆçœ‹ä¸‹å®˜ç½‘æ˜¯å¦æœ‰å¯¹åº”ç‰ˆæœ¬ï¼ŒæŸ¥è¯¢åœ°å€ï¼š
     <a href="https://hub.docker.com/" rel="nofollow">
      https://hub.docker.com/
     </a>
    </p>
    <pre><code># å®˜ç½‘ä½¿ç”¨ç¤ºä¾‹ å®˜ç½‘æ–¹æ³•ç”¨å®Œå³åˆ é™¤ -it --rm
docker run -it --rm tomcat:9.0
# æ‹‰å–é•œåƒ
[root@VM-16-5-centos ~]# docker pull tomcat:9.0
# å¯åŠ¨é•œåƒ -d åå°è¿è¡Œ 
docker run -d --name tomcatv9 -p 81:8080 tomcat

# è¿›å…¥å®¹å™¨
[root@VM-16-5-centos ~]# docker exec -it tomcatv9 /bin/bash

# ç”±äºä¸‹è½½é•œåƒé˜‰å‰²ç‰ˆ
root@a4e43d29503d:/usr/local/tomcat# cp -r webapps.dist/* webapps/

# æ‹·è´å®Œç›®å½•ä¹‹åå†æ¬¡è®¿é—®81å¯ä»¥æ­£å¸¸è¿›å…¥tomcat
</code></pre>
    <p>
     <strong>
      ğŸ’¡ğŸ¤” æ€è€ƒé—®é¢˜ï¼šä»¥åéƒ¨ç½²é¡¹ç›®ï¼Œå¦‚æœæ¯æ¬¡éƒ½è¦è¿›å…¥å®¹å™¨æ˜¯ä¸æ˜¯ååˆ†éº»çƒ¦ï¼Ÿæˆ‘è¦æ˜¯å¯ä»¥åœ¨å®¹å™¨å¤–éƒ¨æä¾›ä¸€ä¸ªæ˜ å°„è·¯å¾„ï¼Œwebappsï¼Œæˆ‘ä»¬åœ¨å¤–éƒ¨æ”¾ç½®é¡¹ç›®ï¼Œå°±è‡ªåŠ¨åŒæ­¥åˆ°å†…éƒ¨å°±å¥½äº†ã€‚
     </strong>
    </p>
    <h3>
     <a id="Docker__351">
     </a>
     Docker é•œåƒ
    </h3>
    <p>
     å¦‚ä½•è‡ªå·±æ‰“åŒ…é•œåƒ
    </p>
    <pre><code>docker commit æäº¤å®¹å™¨æˆä¸ºä¸€ä¸ªæ–°çš„å‰¯æœ¬
docker commit -m="æäº¤çš„æè¿°ä¿¡æ¯" -a="ä½œè€…" å®¹å™¨id ç›®æ ‡é•œåƒå:[TAG]
</code></pre>
    <p>
     å®˜ç½‘ Tomcat ä¿®æ”¹ä¸ºä¾‹
    </p>
    <pre><code># å¯åŠ¨ä¸€ä¸ªé»˜è®¤çš„tomcat

# å‘ç°tomcatæ˜¯æ²¡æœ‰webappsåº”ç”¨ 

# è‡ªå·±æ‹·è´è‡ªå®šä¹‰çš„ç›®å½•è‡³webappsç›®å½•ä¸‹é¢
root@b3e1c2ff8af0:/usr/local/tomcat# cp -r webapps.dist/* webapps
# ä¿®æ”¹å®Œæˆä¹‹åå°†æˆ‘ä»¬æ“ä½œè¿‡çš„å®¹å™¨é€šè¿‡commitæäº¤é•œåƒ
docker commit -a="ljs" -m="add weapps..." b3e1c2ff8af0 tomcat02:1.0
</code></pre>
    <h3>
     <a id="Docker__372">
     </a>
     Docker é•œåƒåŠ é€Ÿ
    </h3>
    <p>
     ä½¿ç”¨è…¾è®¯äº‘ Docker é•œåƒæºåŠ é€Ÿé•œåƒä¸‹è½½
     <br/>
     æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œæ‰“å¼€ /etc/docker/daemon.json é…ç½®æ–‡ä»¶ã€‚
    </p>
    <p>
     vim /etc/docker/daemon.json
     <br/>
     æŒ‰ iåˆ‡æ¢è‡³ç¼–è¾‘æ¨¡å¼ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼Œå¹¶ä¿å­˜ã€‚
    </p>
    <pre><code>{
"registry-mirrors": [
"https://mirror.ccs.tencentyun.com"
]
}
</code></pre>
    <p>
     æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œé‡å¯ Docker å³å¯ã€‚ç¤ºä¾‹å‘½ä»¤ä»¥ CentOS 7 ä¸ºä¾‹ã€‚
    </p>
    <p>
     sudo systemctl restart docker
    </p>
    <h2>
     <a id="Docker__392">
     </a>
     Docker å®¹å™¨æ•°æ®å·
    </h2>
    <h3>
     <a id="_394">
     </a>
     ä»€ä¹ˆæ˜¯å®¹å™¨æ•°æ®å·ï¼Ÿ
    </h3>
    <p>
     <strong>
      ğŸ¤” docker ç†å¿µå›é¡¾
     </strong>
    </p>
    <p>
     <strong>
      ğŸ“Œ å¦‚æœæ•°æ®éƒ½å­˜åœ¨å®¹å™¨ä¸­ï¼Œé‚£æˆ‘ä»¬åˆ é™¤å®¹å™¨ï¼Œæ•°æ®å°±ä¼šä¸¢å¤±ï¼
      <br/>
      ğŸ“Œ è§£å†³æ–¹æ¡ˆï¼šæ•°æ®å¯ä»¥æŒä¹…åŒ–ã€‚ä¾‹å¦‚MySQLï¼Œéœ€è¦å°†æ•°æ®å­˜å‚¨ä¸‹æ¥ã€‚å®¹å™¨ä¹‹é—´å¯ä»¥æœ‰ä¸€ä¸ªæ•°æ®å…±äº«çš„æŠ€æœ¯ï¼Docker ä¸­äº§ç”Ÿçš„æ•°æ®ï¼ŒåŒæ­¥åˆ°æœ¬åœ°ï¼è¿™å°±æ˜¯æ•°æ®å·çš„æŠ€æœ¯ï¼
      <br/>
      âœ… æˆ‘ä»¬å¯ä»¥é€šè¿‡ç›®å½•çš„æŒ‚è½½ï¼Œå°†æˆ‘ä»¬çš„å®¹å™¨å†…çš„ç›®å½•ï¼ŒæŒ‚è½½åˆ°Linuxä¸Šé¢ï¼å°†å®¹å™¨ä¸­MySQLæ–‡ä»¶ç³»ç»ŸæŒ‚è½½å‡ºæ¥ï¼Œ/usr/mysqlæŒ‚è½½åˆ°Linuxä¸»æœºçš„/home/mysqlä¸‹ï¼Œå³å®¹å™¨çš„æŒä¹…åŒ–å’ŒåŒæ­¥æ“ä½œï¼å®¹å™¨é—´çš„æ•°æ®å¯ä»¥è¿›è¡Œå…±äº«ï¼
     </strong>
    </p>
    <h3>
     <a id="_402">
     </a>
     ä½¿ç”¨æ•°æ®å·
    </h3>
    <pre><code># æ–¹å¼ä¸€ï¼šä½¿ç”¨å‘½ä»¤ç›´æ¥æŒ‚è½½ -v
docker run -it -v ä¸»æœºç›®å½•:/å®¹å™¨ç›®å½• centos /bin/bash

[root@VM-16-5-centos ~]# docker run -it -v /home/ceshi:/home centos /bin/bash

# ä¸»æœº/homeç›®å½•æ–°å»ºæ–‡ä»¶ä¼šåŒæ­¥è‡³å®¹å™¨/home/ceshi åŒæ ·å®¹å™¨å†…æ–°å»ºä¹Ÿä¼šåŒæ­¥è‡³ä¸»æœºçš„å¯¹åº”ç›®å½•ä¸‹

# å®¹å™¨ä¿¡æ¯æŸ¥çœ‹
[root@VM-16-5-centos ceshi]# docker inspect 60bb7ebd0884	
		...
        "Mounts": [
            {
                "Type": "bind",
                "Source": "/home/ceshi", # dockerå®¹å™¨å†…åœ°å€
                "Destination": "/home",  # ä¸»æœºåœ°å€
                "Mode": "",
                "RW": true,
                "Propagation": "rprivate"
            }
        ],
        ...
        
# å³ä½¿å®¹å™¨åœæ­¢ï¼Œä¸»æœºä¸Šç›®å½•æ›´æ”¹çš„æ–‡ä»¶åœ¨å®¹å™¨å¯åŠ¨æ—¶ä¼šå‡ºç°ä¸€æ ·çš„æ•ˆæœ
</code></pre>
    <h3>
     <a id="MySQL_430">
     </a>
     å®æˆ˜ï¼šå®‰è£…MySQL
    </h3>
    <p>
     æ€è€ƒï¼šMySQLæ•°æ®æŒä¹…åŒ–
    </p>
    <pre><code># è·å–é•œåƒ
docker pull mysql:5.7
# è¿è¡Œå®¹å™¨ 
# -v æ˜ å°„é…ç½®æ–‡ä»¶å’Œæ•°æ®ç›®å½• 
# -e é…ç½®MySQLå¯†ç 
# -p ç«¯å£æ˜ å°„
# -d åå°è¿è¡Œ
docker run -d -p 3310:3306 -v /hmoe/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d --name mysql01 mysql:5.7

# åˆ é™¤å®¹å™¨
docker rm -f mysql01
# æŒ‚è½½åˆ°æœ¬åœ°çš„æ•°æ®å·ä¾æ—§æ²¡æœ‰ä¸¢å¤±ï¼Œè¿™å°±å®ç°å®¹å™¨çš„æ•°æ®æŒä¹…åŒ–åŠŸèƒ½
</code></pre>
    <h3>
     <a id="_449">
     </a>
     å…·åå’ŒåŒ¿åæŒ‚è½½
    </h3>
    <pre><code># åŒ¿åæŒ‚è½½ -v å®¹å™¨å†…è·¯å¾„ï¼› -P éšæœºæ˜ å°„ç«¯å£ï¼› -p 3306:3360 æŒ‡å®šæ˜ å°„ç«¯å£
docker run -d -P -name -v /etc/nginx nginx
# æŸ¥çœ‹æ‰€æœ‰å·çš„æƒ…å†µ docker volume --help
[root@VM-16-5-centos home]# docker volume ls
DRIVER    VOLUME NAME
local     0a419b7ad1d86e8e4d9710a694fc396382a9b214e2a1cdffbb10af3ff6f27752
[root@VM-16-5-centos home]# 
# å…·åæŒ‚è½½
docker run -d -P --name nginx02 -v juming-nginx:/etc/nginx nginx
# æŸ¥çœ‹å·æƒ…å†µ
[root@VM-16-5-centos home]# docker volume ls
DRIVER    VOLUME NAME
local     0a419b7ad1d86e8e4d9710a694fc396382a9b214e2a1cdffbb10af3ff6f27752
local     juming-nginx
# é€šè¿‡ -v å·åï¼šå®¹å™¨å†…è·¯å¾„

# æŸ¥çœ‹å·è¯¦æƒ…å…·ä½“ä½ç½®
[root@VM-16-5-centos home]# docker volume  juming-nginx
[
    {
        "CreatedAt": "2022-04-16T16:21:45+08:00",
        "Driver": "local",
        "Labels": null,
        "Mountpoint": "/var/lib/docker/volumes/juming-nginx/_data",
        "Name": "juming-nginx",
        "Options": null,
        "Scope": "local"
    }
]
# æ²¡æœ‰æŒ‡å®šç›®å½•çš„æƒ…å†µä¸‹å®¹å™¨çš„å·éƒ½åœ¨/var/lib/docker/volumesç›®å½•ä¸‹é¢
</code></pre>
    <p>
     dockeræ‰€æœ‰å®¹å™¨å†…çš„å·ï¼Œæ²¡æœ‰æŒ‡å®šç›®å½•çš„æƒ…å†µä¸‹éƒ½åœ¨/var/lib/docker/volumesç›®å½•ä¸‹é¢ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å…·åæŒ‚è½½çš„æ–¹å¼æ–¹ä¾¿æ‰¾åˆ°æˆ‘ä»¬çš„å·ï¼Œå¤§å¤šæ•°æƒ…å†µåœ¨ä½¿ç”¨å…·åæŒ‚è½½çš„æ–¹å¼ã€‚
    </p>
    <pre><code># æŒ‚è½½
-v å®¹å™¨å†…è·¯å¾„ 			   # åŒ¿åæŒ‚è½½
-v å·åï¼šå®¹å™¨å†…è·¯å¾„		     # å…·åæŒ‚è½½
-v /å®¿ä¸»æœºè·¯å¾„::å®¹å™¨å†…è·¯å¾„    # æŒ‡å®šè·¯å¾„æŒ‚è½½
</code></pre>
    <h3>
     <a id="_493">
     </a>
     æ•°æ®å·å®¹å™¨
    </h3>
    <p>
     æ•°æ®å·å®¹å™¨é—´åŒæ­¥ï¼Œå³å¤šä¸ªå®¹å™¨mysqlå®¹å™¨é—´åŒæ­¥ã€‚
    </p>
    <pre><code># å¯åŠ¨3ä¸ªå®¹å™¨

# å¯åŠ¨ docker01
[root@VM-16-5-centos ~]# docker run -it --name docker01 kamila/centos
[root@6e4374ed8b07 /]# 

# å¯åŠ¨ docker02
[root@VM-16-5-centos ~]# docker run -it --name docker02 --volumes-from docker01 kamila/centos
[root@6de1e5911994 /]# 

# æ­¤æ—¶volume01 volume02 ç›®å½•åŒæ­¥

# å¯åŠ¨ docker03
[root@VM-16-5-centos ~]# docker run -it --name docker03 --volumes-from docker01 kamila/centos

# å®¹å™¨é—´æ•°æ®å®Œå…¨åŒæ­¥
[root@9a1c6a43bb81 volume01]# touch docker03
[root@9a1c6a43bb81 volume01]# ls -l
total 0
-rw-r--r-- 1 root root 0 Apr 18 14:24 docker01
-rw-r--r-- 1 root root 0 Apr 18 14:24 docker02
-rw-r--r-- 1 root root 0 Apr 18 14:27 docker03


# åˆ é™¤å®¹å™¨docker01
[root@VM-16-5-centos ~]# docker rm -f 6e4374ed8b07
6e4374ed8b07

# docker03 docke02 æ•°æ®ä»ç„¶å­˜åœ¨
</code></pre>
    <h3>
     <a id="MySQL_529">
     </a>
     MySQLæ•°æ®åŒæ­¥
    </h3>
    <p>
     å¤šä¸ªMySQLæ•°æ®åŒæ­¥å®ç°
    </p>
    <pre><code># ç¬¬ä¸€ä¸ªMySQL
docker run -d -p 3312:3306 -v /etc/mysql/conf.d -v /var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d --name mysql02 mysql:5.7

# ç¬¬äºŒä¸ªMySQL
docker run -d -p 3313:3306 -v /etc/mysql/conf.d -v /var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d --name mysql03 --volumes-from mysql02 mysql:5.7

# æ•°æ®åº“æ•°æ®åŒæ­¥
</code></pre>
    <p>
     ç»“è®ºï¼š
    </p>
    <p>
     å®¹å™¨ä¹‹é—´é…ç½®ä¿¡æ¯çš„ä¼ é€’ï¼Œæ•°æ®å·å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸä¸€ç›´æŒç»­åˆ°æ²¡æœ‰å®¹å™¨ä½¿ç”¨ä¸ºæ­¢ã€‚ä½†æ˜¯ä¸€æ—¦çˆ¶å®¹å™¨æŒä¹…åŒ–åˆ°æœ¬åœ°ï¼Œè¿™ä¸ªæ—¶å€™å®¹å™¨åˆ é™¤ï¼Œæœ¬åœ°æ•°æ®ä¸ä¼šåˆ é™¤ã€‚
    </p>
    <h2>
     <a id="DockerFile_547">
     </a>
     DockerFile
    </h2>
    <h3>
     <a id="DockerFile__549">
     </a>
     DockerFile ä»‹ç»
    </h3>
    <p>
     <strong>
      Dockerfile å°±æ˜¯ç”¨æ¥æ„å»º docker é•œåƒçš„æ„å»ºæ–‡ä»¶ï¼å‘½ä»¤è„šæœ¬ï¼é€šè¿‡è„šæœ¬ç”Ÿæˆé•œåƒï¼Œé•œåƒæ˜¯ä¸€å±‚ä¸€å±‚çš„ï¼Œæ¯ä¸ªå‘½ä»¤å°±æ˜¯ä¸€å±‚ã€‚
     </strong>
    </p>
    <h3>
     <a id="DockerFile__553">
     </a>
     DockerFile æ„å»ºè¿‡ç¨‹
    </h3>
    <pre><code># docker æµ‹è¯•æŒ‚è½½ç›®å½•
[root@VM-16-5-centos ~]# cd /home/
[root@VM-16-5-centos home]# mkdir docker-test-volume

# è¿›å…¥ç›®å½•
[root@VM-16-5-centos home]# cd docker-test-volume/
# åˆ›å»ºè„šæœ¬æ–‡ä»¶
[root@VM-16-5-centos docker-test-volume]# vi dockerfile1
</code></pre>
    <p>
     è„šæœ¬æ–‡ä»¶å†…å®¹
    </p>
    <pre><code># æ–‡ä»¶ä¸­å†…å®¹ æŒ‡ä»¤å¤§å†™ æ¯ä¸€ä¸ªæŒ‡ä»¤å°±æ˜¯ä¸€å±‚é•œåƒ VOLUMEæŒ‚è½½
FROM centos

VOLUME ["volume01","volume02"]

CMD echo "- - - - end - - - -"

CMD /bin/bash
</code></pre>
    <p>
     æ„å»ºå‘½ä»¤
    </p>
    <pre><code># æ„å»ºå‘½ä»¤ .ä»£è¡¨å½“å‰ç›®å½•
docker build -f dockerfile1 -t kamila/centos .

[root@VM-16-5-centos docker-test-volume]# docker build -f dockerfile1 -t kamila/centos .
Sending build context to Docker daemon  2.048kB
Step 1/4 : FROM centos
 ---&gt; 5d0da3dc9764
Step 2/4 : VOLUME ["volume01","volume02"]
 ---&gt; Running in 8b129a37455e
Removing intermediate container 8b129a37455e
 ---&gt; 010771923d9b
Step 3/4 : CMD echo "- - - - end - - - -"
 ---&gt; Running in e47388cba239
Removing intermediate container e47388cba239
 ---&gt; 557e5b6304dd
Step 4/4 : CMD /bin/bash
 ---&gt; Running in b8368c5e839f
Removing intermediate container b8368c5e839f
 ---&gt; adb3afd6cf9b
Successfully built adb3afd6cf9b
Successfully tagged kamila/centos:latest

# æŸ¥çœ‹æ„å»ºç»“æœ
[root@VM-16-5-centos docker-test-volume]# docker images
REPOSITORY            TAG       IMAGE ID       CREATED          SIZE
kamila/centos         latest    adb3afd6cf9b   39 seconds ago   231MB

# è¿è¡Œé•œåƒ
[root@VM-16-5-centos docker-test-volume]# docker run -it adb3afd6cf9b /bin/bash
[root@0ef312830664 /]# 

# æŒ‚è½½ç›®å½• volume01 volume02 è¯¥æ–¹å¼ä¸ºåŒ¿åæŒ‚è½½
[root@0ef312830664 /]# ls -l
total 56
lrwxrwxrwx   1 root root    7 Nov  3  2020 bin -&gt; usr/bin
drwxr-xr-x   5 root root  360 Apr 18 13:31 dev
drwxr-xr-x   1 root root 4096 Apr 18 13:31 etc
drwxr-xr-x   2 root root 4096 Nov  3  2020 home
lrwxrwxrwx   1 root root    7 Nov  3  2020 lib -&gt; usr/lib
lrwxrwxrwx   1 root root    9 Nov  3  2020 lib64 -&gt; usr/lib64
drwx------   2 root root 4096 Sep 15  2021 lost+found
drwxr-xr-x   2 root root 4096 Nov  3  2020 media
drwxr-xr-x   2 root root 4096 Nov  3  2020 mnt
drwxr-xr-x   2 root root 4096 Nov  3  2020 opt
dr-xr-xr-x 134 root root    0 Apr 18 13:31 proc
dr-xr-x---   2 root root 4096 Sep 15  2021 root
drwxr-xr-x  11 root root 4096 Sep 15  2021 run
lrwxrwxrwx   1 root root    8 Nov  3  2020 sbin -&gt; usr/sbin
drwxr-xr-x   2 root root 4096 Nov  3  2020 srv
dr-xr-xr-x  13 root root    0 Apr  3 14:06 sys
drwxrwxrwt   7 root root 4096 Sep 15  2021 tmp
drwxr-xr-x  12 root root 4096 Sep 15  2021 usr
drwxr-xr-x  20 root root 4096 Sep 15  2021 var
drwxr-xr-x   2 root root 4096 Apr 18 13:31 volume01
drwxr-xr-x   2 root root 4096 Apr 18 13:31 volume02

# å®¹å™¨å†…ä¸å®¹å™¨å¤–æŒ‚è½½ç›®å½•å…±äº«æƒ…å†µæŸ¥çœ‹
[root@VM-16-5-centos ~]# docker inspect å®¹å™¨id
...
</code></pre>
    <p>
     <strong>
      dockerfile æ–¹å¼æ„å»ºé•œåƒé€šå¸¸ç»å¸¸ä½¿ç”¨ï¼Œå‡è®¾æ„å»ºé•œåƒçš„æ—¶å€™æ²¡æœ‰æŒ‚è½½å·ï¼Œè¦æ‰‹åŠ¨é•œåƒæŒ‚è½½ -v å·åï¼šå®¹å™¨å†…è·¯å¾„!
     </strong>
    </p>
    <p>
     <strong>
      Docker ä½¿ç”¨æµç¨‹æ€»ç»“
     </strong>
    </p>
    <p>
     <strong>
      1ï¸âƒ£ ç¼–å†™ Dockerfile ğŸ“ â€”â€” å®šä¹‰å®¹å™¨ç¯å¢ƒå’Œåº”ç”¨è¿è¡Œæ–¹å¼ã€‚
      <br/>
      2ï¸âƒ£ æ„å»ºé•œåƒ (docker build) ğŸ”¨ â€”â€” å°† Dockerfile ç”Ÿæˆå¯å¤ç”¨çš„é•œåƒã€‚
      <br/>
      3ï¸âƒ£ è¿è¡Œå®¹å™¨ (docker run) ğŸš€ â€”â€” åŸºäºé•œåƒå¯åŠ¨åº”ç”¨ã€‚
      <br/>
      4ï¸âƒ£ å‘å¸ƒé•œåƒ (docker push) ğŸŒ â€”â€” å°†é•œåƒä¸Šä¼ åˆ°è¿œç¨‹ä»“åº“ï¼Œä¾¿äºå…±äº«ä¸éƒ¨ç½²ã€‚
     </strong>
    </p>
    <h3>
     <a id="DockerFile_652">
     </a>
     DockerFileæŒ‡ä»¤
    </h3>
    <pre><code>FROM 			# åŸºç¡€é•œåƒ
MAINTAINER		# é•œåƒæ˜¯è°å†™çš„ï¼Œå§“å+é‚®ç®±
RUN 			# é•œåƒæ„å»ºçš„æ—¶å€™éœ€è¦è¿è¡Œçš„å‘½ä»¤
ADD				# æ­¥éª¤ï¼štomcaté•œåƒï¼Œtomcatçš„å‹ç¼©åŒ…ï¼ˆæ·»åŠ å†…å®¹ï¼‰
WORKDIR			# é•œåƒå·¥ä½œç›®å½•
VOLUME 			# å®¹å™¨å· æŒ‚è½½ç›®å½•ä½ç½®
EXPOSE			# æŒ‡å®šæš´éœ²ç«¯å£
CMD 			# æŒ‡å®šå®¹å™¨å¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤ eg. cmd echo "start." åªæœ‰æœ€åä¸€ä¸ªä¼šç”Ÿæ•ˆ
ENTRYPOINT		# æŒ‡å®šå®¹å™¨å¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤ï¼Œå¯ä»¥è¿½åŠ å‘½ä»¤
ONBUILD			# å½“æ„å»ºä¸€ä¸ªè¢«ç»§æ‰¿ Dockerfile æ—¶å°±ä¼šè¿è¡Œ ONBUILD çš„æŒ‡ä»¤
COPY			# å°†æ–‡ä»¶æ‹·è´åˆ°ç›®å½•ä¸­
ENV				# æ„å»ºæ—¶è®¾ç½®ç¯å¢ƒå˜é‡
</code></pre>
    <h3>
     <a id="_669">
     </a>
     å®æˆ˜
    </h3>
    <p>
     <strong>
      ç¼–å†™æ„å»ºè‡ªå·±çš„ dockerfile æ–‡ä»¶ï¼
     </strong>
    </p>
    <pre><code># ç¼–å†™è‡ªå·±çš„dockerfileæ–‡ä»¶
[root@VM-16-5-centos home]# cd dockerfile/
/home/dockerfile

[root@VM-16-5-centos dockerfile]# vim mydockerfile-centos

FROM centos

MAINTAINER kamila&lt;pitt1997@foxmail.com&gt;

ENV MYPATH /usr/local

WORKDIR $MYPATH

# RUN yum -y install vim

# RUN yum -y install net-tools

EXPOSE 80

CMD echo $MYPATH

CMD echo "- - - end - - - "

CMD /bin/bash

# å¼€å§‹æ„å»º
[root@VM-16-5-centos dockerfile]# docker build -f mydockerfile-centos -t mycentos:0.1 .

# docker historyæ„å»ºå†å²æŸ¥çœ‹
[root@VM-16-5-centos dockerfile]# docker history 12766a6745ee
IMAGE          CREATED       CREATED BY                                      SIZE      COMMENT
12766a6745ee   2 weeks ago   /bin/sh -c #(nop)  CMD ["nginx" "-g" "daemonâ€¦   0B        
&lt;missing&gt;      2 weeks ago   /bin/sh -c #(nop)  STOPSIGNAL SIGQUIT           0B        
&lt;missing&gt;      2 weeks ago   /bin/sh -c #(nop)  EXPOSE 80                    0B        
&lt;missing&gt;      2 weeks ago   /bin/sh -c #(nop)  ENTRYPOINT ["/docker-entrâ€¦   0B        
&lt;missing&gt;      2 weeks ago   /bin/sh -c #(nop) COPY file:09a214a3e07c919aâ€¦   4.61kB    
&lt;missing&gt;      2 weeks ago   /bin/sh -c #(nop) COPY file:0fd5fca330dcd6a7â€¦   1.04kB    
&lt;missing&gt;      2 weeks ago   /bin/sh -c #(nop) COPY file:0b866ff3fc1ef5b0â€¦   1.96kB    
&lt;missing&gt;      2 weeks ago   /bin/sh -c #(nop) COPY file:65504f71f5855ca0â€¦   1.2kB     
&lt;missing&gt;      2 weeks ago   /bin/sh -c set -x     &amp;&amp; addgroup --system -â€¦   61.1MB    
&lt;missing&gt;      2 weeks ago   /bin/sh -c #(nop)  ENV PKG_RELEASE=1~bullseye   0B        
&lt;missing&gt;      2 weeks ago   /bin/sh -c #(nop)  ENV NJS_VERSION=0.7.2        0B        
&lt;missing&gt;      2 weeks ago   /bin/sh -c #(nop)  ENV NGINX_VERSION=1.21.6     0B        
&lt;missing&gt;      2 weeks ago   /bin/sh -c #(nop)  LABEL maintainer=NGINX Doâ€¦   0B        
&lt;missing&gt;      3 weeks ago   /bin/sh -c #(nop)  CMD ["bash"]                 0B        
&lt;missing&gt;      3 weeks ago   /bin/sh -c #(nop) ADD file:966d3669b40f5fbaeâ€¦   80.4MB
</code></pre>
    <h2>
     <a id="Docker__722">
     </a>
     Docker å®æˆ˜
    </h2>
    <h3>
     <a id="Docker__Redis__723">
     </a>
     Docker å®æˆ˜ Redis é›†ç¾¤
    </h3>
    <pre><code>[root@VM-16-5-centos ~]# ip addr
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000
    link/ether 52:54:00:ff:ad:5e brd ff:ff:ff:ff:ff:ff
    inet 10.0.16.5/22 brd 10.0.19.255 scope global eth0
       valid_lft forever preferred_lft forever
    inet6 fe80::5054:ff:feff:ad5e/64 scope link 
       valid_lft forever preferred_lft forever
3: docker0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN group default 
    link/ether 02:42:af:7f:9c:8e brd ff:ff:ff:ff:ff:ff
    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0
       valid_lft forever preferred_lft forever
    inet6 fe80::42:afff:fe7f:9c8e/64 scope link 
       valid_lft forever preferred_lft forever
</code></pre>
    <pre><code># åˆ›å»ºä¸€ä¸ªç½‘å¡
[root@VM-16-5-centos ~]# docker network create redis --subnet 172.18.0.0/16
4c7bfbe5589e7189f3d266760aaeb4b377a62e24d83a64cc8bbfd90d59af0341

# æŸ¥çœ‹ç½‘ç»œçŠ¶å†µ
[root@VM-16-5-centos ~]# docker network ls
NETWORK ID     NAME      DRIVER    SCOPE
72ced6575972   bridge    bridge    local
d3878b871e93   host      host      local
f35cc32d849d   none      null      local
4c7bfbe5589e   redis     bridge    local

# redisç½‘å¡ç½‘ç»œæƒ…å†µ
[root@VM-16-5-centos ~]# docker network inspect redis
[
    {
        "Name": "redis",
        "Id": "4c7bfbe5589e7189f3d266760aaeb4b377a62e24d83a64cc8bbfd90d59af0341",
        "Created": "2022-04-24T21:19:08.514356554+08:00",
        "Scope": "local",
        "Driver": "bridge",
        "EnableIPv6": false,
        "IPAM": {
            "Driver": "default",
            "Options": {},
            "Config": [
                {
                    "Subnet": "172.18.0.0/16"
                }
            ]
        },
        "Internal": false,
        "Attachable": false,
        "Ingress": false,
        "ConfigFrom": {
            "Network": ""
        },
        "ConfigOnly": false,
        "Containers": {},
        "Options": {},
        "Labels": {}
    }
]
[root@VM-16-5-centos ~]# 

# åˆ›å»º6ä¸ªredisæœåŠ¡

# è„šæœ¬åˆ›å»º (å¯ç›´æ¥åå°æ‰§è¡Œï¼‰
for port in $(seq 1 6); \
do \
mkdir -p /mydata/redis/node-${port}/conf
touch /mydata/redis/node-${port}/conf/redis.conf
cat &lt;&lt; EOF &gt; /mydata/redis/node-${port}/conf/redis.conf
port 6379
bind 0.0.0.0
cluster-enabled yes
cluster-config-file nodes.conf
cluster-node-timeout 5000
cluster-announce-ip 172.18.0.1${port}
cluster-announce-port 6379
cluster-announce-bus-port 16379
appendonly yes
EOF
done

# å·²åˆ›å»ºå®Œ6ä¸ªèŠ‚ç‚¹ 
# 172.18.0.11
docker run -p 6371:6379 -p 16371:16379 --name redis-1 \
-v /mydata/redis/node-1/data:/data \
-v /mydata/redis/node-1/conf/redis.conf:/etc/redis/redis.conf \
-d --net redis --ip 172.18.0.11 redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf

# 172.18.0.12
docker run -p 6372:6379 -p 16372:16379 --name redis-2 \
-v /mydata/redis/node-2/data:/data \
-v /mydata/redis/node-2/conf/redis.conf:/etc/redis/redis.conf \
-d --net redis --ip 172.18.0.12 redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf

# 172.18.0.13
docker run -p 6373:6379 -p 16373:16379 --name redis-3 \
-v /mydata/redis/node-3/data:/data \
-v /mydata/redis/node-3/conf/redis.conf:/etc/redis/redis.conf \
-d --net redis --ip 172.18.0.13 redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf

# 172.18.0.14
docker run -p 6374:6379 -p 16374:16379 --name redis-4 \
-v /mydata/redis/node-4/data:/data \
-v /mydata/redis/node-4/conf/redis.conf:/etc/redis/redis.conf \
-d --net redis --ip 172.18.0.14 redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf

# 172.18.0.15
docker run -p 6375:6379 -p 16375:16379 --name redis-5 \
-v /mydata/redis/node-5/data:/data \
-v /mydata/redis/node-5/conf/redis.conf:/etc/redis/redis.conf \
-d --net redis --ip 172.18.0.15 redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf

# 172.18.0.16
docker run -p 6376:6379 -p 16376:16379 --name redis-6 \
-v /mydata/redis/node-6/data:/data \
-v /mydata/redis/node-6/conf/redis.conf:/etc/redis/redis.conf \
-d --net redis --ip 172.18.0.16 redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf

# åˆ é™¤æ‰€æœ‰å®¹å™¨
[root@VM-16-5-centos conf]# docker rm -f $(docker ps -aq)

# è¿›å…¥å®¹å™¨
[root@VM-16-5-centos conf]# docker exec -it redis-1 /bin/sh
/data # ls
appendonly.aof  nodes.conf

# åˆ›å»ºé›†ç¾¤
/data # redis-cli --cluster create 172.18.0.11:6379 172.18.0.12:6379 172.18.0.13:6379 172.18.0.14:6379 172.18.0.15:6379 172.18.0.16:6379 --cluster-
replicas 1

# åˆ›å»ºæˆåŠŸæŸ¥çœ‹é›†ç¾¤è¯¦æƒ…

/data # redis-cli -c
127.0.0.1:6379&gt; cluster info
cluster_state:ok
cluster_slots_assigned:16384
cluster_slots_ok:16384
cluster_slots_pfail:0
cluster_slots_fail:0
cluster_known_nodes:6
cluster_size:3
cluster_current_epoch:6
cluster_my_epoch:1
cluster_stats_messages_ping_sent:168
cluster_stats_messages_pong_sent:177
cluster_stats_messages_sent:345
cluster_stats_messages_ping_received:172
cluster_stats_messages_pong_received:168
cluster_stats_messages_meet_received:5
cluster_stats_messages_received:345

127.0.0.1:6379&gt; cluster nodes
4d06ba47c680ae2b306f58978592f5c8aa7a2a85 172.18.0.16:6379@16379 slave 1fbdbfddc999de27b73418dff637a2191a13658d 0 1650896979000 6 connected
9ad5eea3c3f2959070d72ba84372b6a79b925ff8 172.18.0.13:6379@16379 master - 0 1650896980471 3 connected 10923-16383
29cc13afdb5c8213e5c3bf8814177bba0ef7ff98 172.18.0.14:6379@16379 slave 9ad5eea3c3f2959070d72ba84372b6a79b925ff8 0 1650896980570 4 connected
98c09c14c4f12d6184d7ff5e11cd911b3ee6e0a4 172.18.0.11:6379@16379 myself,master - 0 1650896978000 1 connected 0-5460
eded85ab704ebcc66ffc1ba2f41d3f77e8f8335a 172.18.0.15:6379@16379 slave 98c09c14c4f12d6184d7ff5e11cd911b3ee6e0a4 0 1650896979000 5 connected
1fbdbfddc999de27b73418dff637a2191a13658d 172.18.0.12:6379@16379 master - 0 1650896980000 2 connected 5461-10922
127.0.0.1:6379&gt;
</code></pre>
    <h2>
     <a id="__Docker_893">
     </a>
     <strong>
      ğŸ¯ æ€»ç»“ï¼šå­¦ä¼š Dockerï¼Œä½ å°±èµ¢äº†ä¸€åŠï¼
     </strong>
    </h2>
    <p>
     Docker ä¸ä»…è®©å¼€å‘éƒ¨ç½²æ›´ç®€å•ï¼Œè¿˜è®©è¿ç»´ç®¡ç†æ›´é«˜æ•ˆã€‚å¦‚æœä½ æƒ³çœŸæ­£æŒæ¡å®ƒï¼Œå°±ä»
     <strong>
      åŠ¨æ‰‹å®è·µ
     </strong>
     å¼€å§‹ï¼å¸Œæœ›è¿™ç¯‡å­¦ä¹ ç¬”è®°èƒ½å¸®åˆ°ä½ ï¼Œå¦‚æœæœ‰ç”¨è®°å¾—ç‚¹èµ + æ”¶è— + åˆ†äº«ï¼Œè®©æ›´å¤šäººå—ç›Šï¼
    </p>
    <p>
     <strong>
      ğŸ‘€ ä½ è¿˜æƒ³äº†è§£å“ªäº› Docker è¿›é˜¶ç©æ³•ï¼Ÿæ¬¢è¿ç•™è¨€è®¨è®ºï¼
     </strong>
     ğŸ˜ƒ
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f427261645f50695474372f:61727469636c652f64657461696c732f313436313238363732" class_="artid" style="display:none">
 </p>
</div>


