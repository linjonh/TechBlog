---
layout: post
title: "现代密码学-具有完整性功能的安全方案"
date: 2025-03-12 23:30:17 +0800
description: "这一次，陈某动摇了。对消息M进行加密，得到E(K1,M)并附在消息之后，对其再加密，得到E(K2,C(K1,M)||M),目的是保密性，使其在传输过程中也是以密文的形式传输，而非危险的明文直接传输，加密信息经过可信信道加密传输后，接收方收到，首先使用密钥K2对其进行解密，得到M||C(K1,M)，使用MAC函数及密钥K1对得到的消息M进行加密，得到计算MAC值，然后与附加的MAC值进行比较，若相同则验证了消息的完整性，说明在加密、传输过程中并未被非法篡改，消息可信；否则，消息不可信，存在风险。"
keywords: "现代密码学 | 具有完整性功能的安全方案"
categories: ['未分类']
tags: ['密码学', '安全']
artid: "146217821"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146217821
    alt: "现代密码学-具有完整性功能的安全方案"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146217821
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146217821
cover: https://bing.ee123.net/img/rand?artid=146217821
image: https://bing.ee123.net/img/rand?artid=146217821
img: https://bing.ee123.net/img/rand?artid=146217821
---

# 现代密码学 | 具有完整性功能的安全方案
## 1.案例背景
### \*\*\*\*\*\*1.1\*\*\*\*\*\*\*\*邮箱遭黑客入侵，一公司差点损失1500万\*\*\*\*\*\*
事件描述：
近日，杭州钱塘区公安分局前进派出所接辖区某公司报案称，公司邮箱遭黑客非法入侵恶意篡改信息，其国外客户被欺骗后，将650余万元（人民币）的货款打入了黑客账户。接警后，前进派出所立即将相关情况上报分局，钱塘区公安分局网警大队联合前进派出所迅速介入调查，并第一时间开展紧急止损，通过及时申诉止付冻结，将全部货款顺利追回。据警方调查，黑客利用程序侵入了该公司的电子邮箱，篡改了其发送给国外客户邮件中的收款人信息及收款账户，客户根据邮件，将货款打进了黑客的账户。在帮助止损的同时，分局网警大队积极协助该公司开展内部网络安全隐患排查，对突出问题提出整改意见，及时发现并劝阻其暂缓第二笔850余万元（人民币）
的货款打款，开展网络安全宣传教育，加强企业风险防范意识，筑牢网络安全防线。
此类黑客作案手法具有较强的针对性，侵害对象以与境外客商有业务往来的企业为主。由于存在时差、语言沟通等因素，外贸企业与境外客商联系业务，主要是通过电子邮件方式。黑客攻陷企业邮箱后，便长期“潜伏”，当发现双方交易时，黑客利用网络漏洞窃取邮件，然后偷梁换柱，冒充交易双方，将交易账户变成自己的账户。
### \*\*\*\*\*\*1.\*\*\*\*\*\*\*\*2\*\*\*\*\*\*\*\*邯郸|两人培训千人通过，上万条数据被篡改！\*\*\*\*\*\*
2017年10月，邯郸市中级人民法院开庭审理了一起非法篡改网络数据库、伪造买卖证件案。2017年6月，邯郸市公安局网安支队、复兴分局网安大队合成作战、重拳出击，联合侦破了该案件，打掉了一个通过网络搜集攻击漏洞、网上发布需求、恶意篡改考试结果、伪造考试合格证书一条龙犯罪团伙，拆散了集网络黑客、中间人、伪造证件者犯罪利益链条，弥补了网络数据重大隐患，抓获犯罪嫌疑人16名，涉案金额600余万元。该案也是近年来河北警方侦破的首起非法篡改网络数据库案。
### \*\*\*\*\*\*1.3 百度一 29 岁程序员因“篡改数据”被抓\*\*\*\*\*\*
事件描述：
根据裁判文书显示，2015年9月16日，陈某入职百度时代网络技术（北京）有限公司，担任研发工程师，所在部门为展示广告平台部的union团队，主要负责展示广告平台部流量端系统的开发工作，权限范围是百度联盟流量端系统的功能开发以及日常上线与维护。陈某负责该系统的开发与维护工作，无权审核媒体资质，也没有权限对媒体审核服务器计算机系统程序里的数据进行非研发、调试和维护性需要的修改。2017年8月，自称刘某的男子通过微信联系到陈某，称有“私活”可以“挣外快”，问其能否做快速审核（审核网站是否能有资质承接百度联盟广告），但被陈某拒绝了。没过多久，刘某从哈尔滨到了北京，在对外经贸大学附近一个饭馆约陈某吃饭，说还是想做审核网站的事情，需要使用百度在职员工的权限，帮助其快速通过审核网站。这一次，陈某动摇了。他找刘某要了9000元钱，审核每个网站300元，共审核30个。
陈某使用的其中一种方式是通过CURL命令调用流量端系统的媒体审核接口，另一种是通过编写脚本批量操作的方式调用了流量端系统的媒体审核接口，从而篡改数据。
2018年2月27日，百度公司相关部门发现在风控平台审核媒体时，部分媒体无法进行正常审核操作。进一步排查分析，发现疑似存在陈某在相关机器上进行了工作职责不相符合的操作，对部分没有经过业审审核的媒体，进行了“媒体审核通过”的操作，异常审核通过的媒体有735个，分成金额3745054元。2018年3月2日，百度公司相关部门将上述情况以电子邮件形式发送给百度时代网络技术（北京）有限公司职业道德委员会。
事件影响：
公安机关于2018年3月11日接到百度公司报案称公司员工陈某涉嫌破坏计算机信息信息系统犯罪，后于同年4月20日将前往百度公司接受约谈的被告人陈某传唤到案。
最终，被告人陈某以犯破坏计算机信息系统罪，被判处有期徒刑一年九个月，并没收所有违法所得。
## 2.安全分析
安全问题：
这三个案例均涉及到数据的非法篡改，攻击者利用漏洞或业务流程上的监管缺陷实施非法获利。进行数据篡改破坏了完整性。在第一个案例中，攻击者入侵邮箱，进行“被动攻击”，长期进行监听，等待合适时机，修改交易账户。在第二个案例中，攻击者利用漏洞夺取考试系统权限，非法添加考试人员信息，并修改成绩，获得报酬；在第三个案例中，该程序员利用职务便利联合公司外部人员，通过多种方式获取到媒体审核接口并进行批量式审批操作。这两案例暴露出其管理系统存在对外开放的接口，出现无消息认证、数据完整性未实现等安全问题。
安全目标：利用MAC实现认证和完整性。
## 3.方案设计
![](https://i-blog.csdnimg.cn/direct/d2b35c6e1e7d49d692580f7d55ad7cf8.png)
为了实现完整性功能，该方案中使用MAC(Message Authentication
code)以及对称密钥加密的方式完成设计。以分析案例中的邮件入侵事件为例，邮件发送方首先要验证身份，获得操作权限，进入管理系统发送消息。对消息M进行加密，得到E(K1,M)并附在消息之后，对其再加密，得到E(K2,C(K1,M)||M),目的是保密性，使其在传输过程中也是以密文的形式传输，而非危险的明文直接传输，加密信息经过可信信道加密传输后，接收方收到，首先使用密钥K2对其进行解密，得到M||C(K1,M)，使用MAC函数及密钥K1对得到的消息M进行加密，得到计算MAC值，然后与附加的MAC值进行比较，若相同则验证了消息的完整性，说明在加密、传输过程中并未被非法篡改，消息可信；否则，消息不可信，存在风险。