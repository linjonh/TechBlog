---
layout: post
title: "完美解决ElementUI中树形结构table勾选问题"
date: 2025-03-13 10:09:25 +0800
description: "完美解决ElementUI中树形结构table勾选问题"
keywords: "完美解决ElementUI中树形结构table勾选问题"
categories: ['Vue']
tags: ['前端', 'Javascript', 'Elementui']
artid: "146223515"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146223515
    alt: "完美解决ElementUI中树形结构table勾选问题"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146223515
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146223515
cover: https://bing.ee123.net/img/rand?artid=146223515
image: https://bing.ee123.net/img/rand?artid=146223515
img: https://bing.ee123.net/img/rand?artid=146223515
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     完美解决ElementUI中树形结构table勾选问题
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <h2>
     <a id="_1">
     </a>
     实现功能
    </h2>
    <blockquote>
     <p>
      <strong>
       1. 全选/取消全选，更新所有节点勾选状态
       <br/>
       2. 勾选父/子节点，子/父节点状态和全选框状态更新
      </strong>
     </p>
    </blockquote>
    <h2>
     <a id="_6">
     </a>
     效果图
    </h2>
    <h3>
     <a id="_7">
     </a>
     全选
    </h3>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/d380978e9b294ca2984796509d142312.png"/>
    </p>
    <h3>
     <a id="_11">
     </a>
     取消全选
    </h3>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/2b5b2c05e8a34b81ab5fd8500cc9b970.png"/>
    </p>
    <h3>
     <a id="_15">
     </a>
     取消父节点
    </h3>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/ff219e595b3942c4aec1cf44df257453.png"/>
    </p>
    <h3>
     <a id="_18">
     </a>
     取消某个子节点
    </h3>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/5388676c1cfd4211942f92c82cc881b2.png"/>
    </p>
    <h2>
     <a id="_21">
     </a>
     关键代码
    </h2>
    <p>
     这里是vue2写法，不管什么写法逻辑是一样滴！
    </p>
    <pre><code class="prism language-bash"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el-table
    <span class="token assign-left variable">ref</span><span class="token operator">=</span><span class="token string">"multipleTable"</span>
    v-loading<span class="token operator">=</span><span class="token string">"loading"</span>
    row-key<span class="token operator">=</span><span class="token string">"id"</span>
    :data<span class="token operator">=</span><span class="token string">"tableList"</span>
    :tree-props<span class="token operator">=</span><span class="token string">"{ children: 'children' }"</span>
    @select-all<span class="token operator">=</span><span class="token string">"selectAll"</span>
    @select<span class="token operator">=</span><span class="token string">"handleSelect"</span>
  <span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>el-table-column <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">"selection"</span> <span class="token assign-left variable">width</span><span class="token operator">=</span><span class="token string">"55"</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span>/el-table-column<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>/el-table<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token builtin class-name">export</span> default <span class="token punctuation">{<!-- --></span>
  methods: <span class="token punctuation">{<!-- --></span>
    // 递归设置子节点的勾选状态
    setChildrenSelection<span class="token punctuation">(</span>children, selected<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>children <span class="token operator">||</span> children.length <span class="token operator">==</span><span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token builtin class-name">return</span><span class="token punctuation">;</span>
      children.forEach<span class="token punctuation">((</span>child<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
        this.<span class="token variable">$refs</span>.multipleTable.toggleRowSelection<span class="token punctuation">(</span>child, selected<span class="token punctuation">)</span><span class="token punctuation">;</span>
        this.setChildrenSelection<span class="token punctuation">(</span>child.children, selected<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>,
    // 更新父节点的勾选状态
    updateParentSelection<span class="token punctuation">(</span>node<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>node <span class="token operator">||</span> <span class="token operator">!</span>node.pid<span class="token punctuation">)</span> <span class="token builtin class-name">return</span><span class="token punctuation">;</span> // 如果没有父节点，递归终止

      const parent <span class="token operator">=</span> this.findNodeById<span class="token punctuation">(</span>node.pid<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>parent<span class="token punctuation">)</span> <span class="token builtin class-name">return</span><span class="token punctuation">;</span> // 如果父节点不存在，退出

      // 检查父节点的所有子节点是否都被勾选
      const allChildrenSelected <span class="token operator">=</span> parent.children.every<span class="token punctuation">((</span>child<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span>
        this.<span class="token variable">$refs</span>.multipleTable.selection.some<span class="token punctuation">((</span>item<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> item.id <span class="token operator">==</span><span class="token operator">=</span> child.id<span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>

      // 根据子节点的勾选状态更新父节点的勾选状态
      this.<span class="token variable">$refs</span>.multipleTable.toggleRowSelection<span class="token punctuation">(</span>parent, allChildrenSelected<span class="token punctuation">)</span><span class="token punctuation">;</span>

      // 递归更新父节点的父节点
      this.updateParentSelection<span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>,
    // 根据 ID 查找节点
    findNodeById<span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      const stack <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">..</span>.this.tableList<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span> <span class="token punctuation">(</span>stack.length<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        const <span class="token function">node</span> <span class="token operator">=</span> stack.pop<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>node.id <span class="token operator">==</span><span class="token operator">=</span> <span class="token function">id</span><span class="token punctuation">)</span> <span class="token builtin class-name">return</span> <span class="token function">node</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>node.children <span class="token operator">&amp;&amp;</span> node.children.length<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          stack.push<span class="token punctuation">(</span><span class="token punctuation">..</span>.node.children<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token builtin class-name">return</span> null<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>,
    // 勾选事件处理
    handleSelect<span class="token punctuation">(</span>selection, row<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>row.children <span class="token operator">&amp;&amp;</span> row.children.length<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        // 如果当前节点有子节点，递归设置子节点的勾选状态
        const isCurrentSelected <span class="token operator">=</span> selection.some<span class="token punctuation">((</span>item<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> item.id <span class="token operator">==</span><span class="token operator">=</span> row.id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        this.setChildrenSelection<span class="token punctuation">(</span>row.children, isCurrentSelected<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      // 更新父节点的勾选状态
      this.updateParentSelection<span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>,

    // 全选事件处理
    selectAll<span class="token punctuation">(</span>selection<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      this.tableList.forEach<span class="token punctuation">((</span>row<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
        const isRowSelected <span class="token operator">=</span> selection.some<span class="token punctuation">((</span>item<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> item.id <span class="token operator">==</span><span class="token operator">=</span> row.id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        this.<span class="token variable">$refs</span>.multipleTable.toggleRowSelection<span class="token punctuation">(</span>row, isRowSelected<span class="token punctuation">)</span><span class="token punctuation">;</span>

        // 递归设置子节点的勾选状态
        this.setChildrenSelection<span class="token punctuation">(</span>row.children, isRowSelected<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>,
  <span class="token punctuation">}</span>,
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span>/script<span class="token operator">&gt;</span>

</code></pre>
    <pre><code class="prism language-bash">// 若想要获取表格选中的数据
const selectedRows <span class="token operator">=</span> this.<span class="token variable">$refs</span>.multipleTable.selection<span class="token punctuation">;</span>
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f77636831393936303531382f:61727469636c652f64657461696c732f313436323233353135" class_="artid" style="display:none">
 </p>
</div>


