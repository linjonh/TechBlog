---
layout: post
title: el-table组件实现表头搜索
date: 2023-12-11 17:41:03 +0800
categories: ['前端']
tags: ['前端', 'Vue', 'Elementui']
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=134928212
    alt: el-table组件实现表头搜索
artid: 134928212
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=134928212
featuredImagePreview: https://bing.ee123.net/img/rand?artid=134928212
---
<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     el-table组件实现表头搜索
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <div class="toc">
     <h4>
      大纲
     </h4>
     <ul>
      <li>
       <ul>
        <li>
         <a href="#_1" rel="nofollow">
          一，展示效果
         </a>
        </li>
        <li>
         <a href="#_3" rel="nofollow">
          二，功能介绍
         </a>
        </li>
        <li>
         <a href="#_5" rel="nofollow">
          三，实现代码
         </a>
        </li>
        <li>
         <a href="#_189" rel="nofollow">
          四，遇到的问题
         </a>
        </li>
        <li>
         <a href="#_232" rel="nofollow">
          五，解决
         </a>
        </li>
       </ul>
      </li>
     </ul>
    </div>
    <p>
    </p>
    <h3>
     <a id="_1">
     </a>
     一，展示效果
    </h3>
    <p>
     <img alt="请添加图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/48853eb4bbc1c3ee3383555f353d6309.png"/>
    </p>
    <h3>
     <a id="_3">
     </a>
     二，功能介绍
    </h3>
    <p>
     利用
     <code>
      el-table
     </code>
     组件提供的
     <code>
      render-header
     </code>
     属性自定义表头渲染内容，包含表头标题和一个搜索图标，图标是一个
     <code>
      Popover
     </code>
     组件弹出框，点击图标出现下面输入框和搜索按钮，点击搜索区域以外的位置，搜索区域消失，这个使用的是
     <code>
      element-ui
     </code>
     的
     <code>
      Clickoutside
     </code>
     指令。
    </p>
    <h3>
     <a id="_5">
     </a>
     三，实现代码
    </h3>
    <hr/>
    <p>
     主页面
     <code>
      template
     </code>
     部分：
    </p>
    <pre><code class="prism language-html">	 <span class="token comment">&lt;!-- template部分--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table</span>  
		  <span class="token attr-name">:data</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>list<span class="token punctuation">"</span></span>
          <span class="token attr-name">v-loading</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>listLoading<span class="token punctuation">"</span></span> 
          <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>table<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-table-column</span>
            <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>(item, index) in tableHead[activeOption]<span class="token punctuation">"</span></span>
            <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>index + item.prop + item.label<span class="token punctuation">"</span></span>
            <span class="token attr-name">:prop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.prop<span class="token punctuation">"</span></span>
            <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.label<span class="token punctuation">"</span></span>
            <span class="token attr-name">:min-width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.width ? item.width : item.label.length * 12 + 50<span class="token punctuation">"</span></span>
            <span class="token attr-name">:show-overflow-tooltip</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span>
            <span class="token attr-name">:align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.align || 'center'<span class="token punctuation">"</span></span>
            <span class="token attr-name">class-name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>flexColumn<span class="token punctuation">"</span></span>
            <span class="token attr-name">:render-header</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>(h, row) =&gt; NumberRenderHeader(h, row, item)<span class="token punctuation">"</span></span>
            <span class="token attr-name">:fixed</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.fixed<span class="token punctuation">"</span></span>
          <span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">slot-scope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{ row }<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>
                {<!-- -->{ row[item.prop] || "" }}
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-table-column</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <br/>
    <p>
     主页面
     <code>
      methods
     </code>
     部分，其中
     <code>
      SearchCom
     </code>
     是自定义搜索组件。
    </p>
    <pre><code class="prism language-js">    <span class="token comment">// 表头渲染函数</span>
    <span class="token function">NumberRenderHeader</span><span class="token punctuation">(</span><span class="token parameter">createElement<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> column<span class="token punctuation">,</span> $index <span class="token punctuation">}</span><span class="token punctuation">,</span> item</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">let</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>item<span class="token punctuation">.</span>isHeadSearch<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> item<span class="token punctuation">.</span>label<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
        <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
          <span class="token literal-property property">domProps</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">innerHTML</span><span class="token operator">:</span> column<span class="token punctuation">.</span>label<span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">createElement</span><span class="token punctuation">(</span>SearchCom<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
          <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">defaultValue</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token comment">// 默认值</span>
            <span class="token literal-property property">selectIndex</span><span class="token operator">:</span> item<span class="token punctuation">.</span>popIndex <span class="token operator">||</span> $index <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token literal-property property">on</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function-variable function">selectChange</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> self<span class="token punctuation">.</span><span class="token function">selectFruitChange</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
    <p>
     <code>
      render-header
     </code>
     属性：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/e06b99d583f571c3c102e4cfcab846f6.png"/>
    </p>
    <blockquote>
     <p>
      关于
      <code>
       createElement
      </code>
      函数：
      <a href="https://v2.cn.vuejs.org/v2/guide/render-function.html#createElement-%E5%8F%82%E6%95%B0" rel="nofollow">
       介绍链接
      </a>
     </p>
    </blockquote>
    <p>
     自定义组件部分
    </p>
    <pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-popover</span>
    <span class="token attr-name">placement</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bottom<span class="token punctuation">"</span></span>
    <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>200<span class="token punctuation">"</span></span>
    <span class="token attr-name">trigger</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>manual<span class="token punctuation">"</span></span>
    <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>visible<span class="token punctuation">"</span></span>
    <span class="token attr-name">@show</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>showPopover<span class="token punctuation">"</span></span>
    <span class="token attr-name">popper-class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>charge-item-header-popover aaa<span class="token punctuation">"</span></span>
  <span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 弹出框内容 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>popover_box<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-input</span>
        <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>请输入<span class="token punctuation">"</span></span>
        <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectValue<span class="token punctuation">"</span></span>
        <span class="token attr-name">@keyup.enter.native</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>confirm<span class="token punctuation">"</span></span>
        <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sInput<span class="token punctuation">"</span></span>
        <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">padding</span><span class="token punctuation">:</span> 10px 5px</span><span class="token punctuation">"</span></span></span>
      <span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-input</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>confirm<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>搜索<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 触发元素 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
      <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>reference<span class="token punctuation">"</span></span>
      <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">margin-left</span><span class="token punctuation">:</span> 5px</span><span class="token punctuation">"</span></span></span>
      <span class="token attr-name">@click.stop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>popClick<span class="token punctuation">"</span></span>
      <span class="token attr-name">v-clickoutside</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>closeOver<span class="token punctuation">"</span></span>
    <span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>el-icon-search<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-popover</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token comment">// import Clickoutside from "element-ui/src/utils/clickoutside"; // 使用elementui的 Clickoutside 指令</span>
<span class="token keyword">import</span> Clickoutside <span class="token keyword">from</span> <span class="token string">"./clickoutside"</span><span class="token punctuation">;</span> <span class="token comment">// 使用elementui的 Clickoutside 指令</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token comment">// 输入框中的值</span>
      <span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 组件显示隐藏控制</span>
      <span class="token literal-property property">selectValue</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token comment">// 当前选中值</span>
      <span class="token literal-property property">popperElm</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">defaultValue</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">selectIndex</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> Number<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 解决点击输入框组件关闭问题</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>popperElm <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span>
      <span class="token string">"charge-item-header-popover"</span>
    <span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>selectIndex <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 点击当前组件之外关闭</span>
    <span class="token function">handleOutsideClick</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>visible <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// 展示当前组件时 鼠标光标定位到输入框</span>
    <span class="token function">showPopover</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>sInput<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 关闭当前组件</span>
    <span class="token function">closeOver</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>visible <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">popClick</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>visible <span class="token operator">=</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>visible<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 输入文字匹配对象的li项</span>
    <span class="token function">confirm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">"selectChange"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>selectValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">directives</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    Clickoutside<span class="token punctuation">,</span> <span class="token comment">// 引用elementui Clickoutside指令</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.el-input</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">border-bottom</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.el-input--prefix /deep/ .el-input__prefix</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">left</span><span class="token punctuation">:</span> 15px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.popover_box</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 0 5px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">::v-deep .el-input</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">border-bottom</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.charge-item-header-popover</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.charge-item-header-popover .el-button</span> <span class="token punctuation">{<!-- --></span>
  <span class="token property">height</span><span class="token punctuation">:</span> 80%<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <h3>
     <a id="_189">
     </a>
     四，遇到的问题
    </h3>
    <p>
     点击表格的某个搜索图标，点击输入框，搜索区域消失，控制是否点击目标区域以外的元素是通过
     <code>
      Clickoutside
     </code>
     指令实现的，下面是
     <code>
      Clickoutside
     </code>
     指令的关键代码：
    </p>
    <pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token function">createDocumentHandler</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> binding<span class="token punctuation">,</span> vnode</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">mouseup <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span> mousedown <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>
      <span class="token operator">!</span>vnode <span class="token operator">||</span>
      <span class="token operator">!</span>vnode<span class="token punctuation">.</span>context <span class="token operator">||</span>
      <span class="token operator">!</span>mouseup<span class="token punctuation">.</span>target <span class="token operator">||</span>
      <span class="token operator">!</span>mousedown<span class="token punctuation">.</span>target <span class="token operator">||</span>
      el<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>mouseup<span class="token punctuation">.</span>target<span class="token punctuation">)</span> <span class="token operator">||</span>
      el<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>mousedown<span class="token punctuation">.</span>target<span class="token punctuation">)</span> <span class="token operator">||</span>
      el <span class="token operator">===</span> mouseup<span class="token punctuation">.</span>target <span class="token operator">||</span>
      <span class="token punctuation">(</span>vnode<span class="token punctuation">.</span>context<span class="token punctuation">.</span>popperElm <span class="token operator">&amp;&amp;</span>
        <span class="token punctuation">(</span>vnode<span class="token punctuation">.</span>context<span class="token punctuation">.</span>popperElm<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>mouseup<span class="token punctuation">.</span>target<span class="token punctuation">)</span> <span class="token operator">||</span>
          vnode<span class="token punctuation">.</span>context<span class="token punctuation">.</span>popperElm<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>mousedown<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>
      binding<span class="token punctuation">.</span>expression <span class="token operator">&amp;&amp;</span>
      el<span class="token punctuation">[</span>ctx<span class="token punctuation">]</span><span class="token punctuation">.</span>methodName <span class="token operator">&amp;&amp;</span>
      vnode<span class="token punctuation">.</span>context<span class="token punctuation">[</span>el<span class="token punctuation">[</span>ctx<span class="token punctuation">]</span><span class="token punctuation">.</span>methodName<span class="token punctuation">]</span>
    <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      vnode<span class="token punctuation">.</span>context<span class="token punctuation">[</span>el<span class="token punctuation">[</span>ctx<span class="token punctuation">]</span><span class="token punctuation">.</span>methodName<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
      el<span class="token punctuation">[</span>ctx<span class="token punctuation">]</span><span class="token punctuation">.</span>bindingFn <span class="token operator">&amp;&amp;</span> el<span class="token punctuation">[</span>ctx<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">bindingFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     其中
     <code>
      vnode
     </code>
     代表使用自定义指令的元素，
     <code>
      vnode.context.popperElm
     </code>
     则代表使用自定义指令所在的
     <code>
      vue
     </code>
     文件中
     <code>
      data
     </code>
     属性中的数据，若这个值绑定的元素包含鼠标点击的元素（即搜索图标）则
     <code>
      Popver
     </code>
     弹出框不会消失，否则消失，其中
     <code>
      popperElm
     </code>
     绑定的元素如下：
    </p>
    <pre><code class="prism language-js">  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 解决点击输入框组件关闭问题</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>popperElm <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span>
      <span class="token string">"charge-item-header-popover"</span>
    <span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
    <p>
     以上说明通过上面方法获取的弹出框元素并不包含搜索图标（两个元素不具有父子关系），但是从控制台检索元素看，两个元素又确实是包含关系，后来想到原因如下
    </p>
    <blockquote>
     <p>
      一个表格内包含多个表头搜索字段，而第二个搜索框肯定是不包含第一个搜索框图标的
     </p>
    </blockquote>
    <h3>
     <a id="_232">
     </a>
     五，解决
    </h3>
    <hr/>
    <p>
     在获取弹出框元素时传给搜索框组件一个索引说明是当前页面中的第几个弹出框
    </p>
    <p>
     父组件页面
    </p>
    <pre><code class="prism language-js">     <span class="token function">createElement</span><span class="token punctuation">(</span>SearchCom<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
         <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
           <span class="token literal-property property">defaultValue</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token comment">// 默认值</span>
           <span class="token literal-property property">selectIndex</span><span class="token operator">:</span> item<span class="token punctuation">.</span>popIndex <span class="token operator">||</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//selectIndex代表当前页面的第几个popper弹出框</span>
         <span class="token punctuation">}</span><span class="token punctuation">,</span>
         <span class="token literal-property property">on</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
           <span class="token function-variable function">selectChange</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> self<span class="token punctuation">.</span><span class="token function">selectFruitChange</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">,</span>
         <span class="token punctuation">}</span><span class="token punctuation">,</span>
       <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre>
    <p>
     自定义弹出框组件
    </p>
    <pre><code class="prism language-js"> <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 解决点击输入框组件关闭问题</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>popperElm <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span>
      <span class="token string">"charge-item-header-popover"</span>
    <span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>selectIndex <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
    <p>
     -----------------------------------------------------------------------------------结束-------------------------------------------------------------------------
    </p>
   </div>
   <link href="./../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="./../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
</div>


