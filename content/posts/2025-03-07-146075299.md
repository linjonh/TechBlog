---
layout: post
title: "C-Lambda-表达式-详解"
date: 2025-03-07 19:00:00 +0800
description: "C# Lambda 表达式 详解"
keywords: "C# Lambda 表达式 详解"
categories: ['C']
tags: ['知识捡漏', '开发语言', 'C', 'C']
artid: "146075299"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146075299
    alt: "C-Lambda-表达式-详解"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146075299
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146075299
cover: https://bing.ee123.net/img/rand?artid=146075299
image: https://bing.ee123.net/img/rand?artid=146075299
img: https://bing.ee123.net/img/rand?artid=146075299
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     C# Lambda 表达式 详解
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="httpsblogcsdnnetqq_39847278articledetails127617179_1">
     </a>
     <a href="https://blog.csdn.net/qq_39847278/article/details/127617179">
      总目录
     </a>
    </h2>
    <hr/>
    <h2>
     <a id="_6">
     </a>
     前言
    </h2>
    <p>
     在C#编程中，Lambda表达式是一种简洁而强大的语法特性，它提供了一种更加灵活和直观的方式来编写匿名函数。无论是在LINQ查询、事件处理还是异步编程中，Lambda表达式都扮演着重要角色。本文将详细介绍Lambda，帮助您更好地理解和掌握这一重要的C#特性。
    </p>
    <hr/>
    <h2>
     <a id="Lambda___12">
     </a>
     一、Lambda 表达式 是什么？
    </h2>
    <h3>
     <a id="1__13">
     </a>
     1. 定义
    </h3>
    <p>
     Lambda表达式是C# 3.0引入的一个新特性，它是匿名方法的简化形式，允许开发者以更简洁的方式定义函数。Lambda表达式可以用于任何需要委托的地方，并且可以在运行时动态创建函数对象。它的主要优点包括代码简洁、易于阅读和维护。
    </p>
    <h3>
     <a id="2__16">
     </a>
     2. 基本语法
    </h3>
    <p>
     Lambda表达式的语法非常简单，由参数列表、
     <code>
      =&gt;
     </code>
     符号和表达式或语句块组成。其基本形式如下：
    </p>
    <pre><code class="prism language-csharp"><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> expression
</code></pre>
    <p>
     或
    </p>
    <pre><code class="prism language-csharp"><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span> statements <span class="token punctuation">}</span>
</code></pre>
    <ul>
     <li>
      <strong>
       参数列表
      </strong>
      ：可以包含零个或多个参数，用逗号分隔。
     </li>
     <li>
      <strong>
       <code>
        =&gt;
       </code>
       符号
      </strong>
      ：称为“
      <code>
       goes to
      </code>
      ”操作符，表示从参数到表达式或语句块的映射。
     </li>
     <li>
      <strong>
       表达式或语句块
      </strong>
      ：可以是一个简单的表达式或一个包含多条语句的代码块。
     </li>
    </ul>
    <h2>
     <a id="_Lambda__35">
     </a>
     二、如何使用 Lambda 表达式？
    </h2>
    <p>
     根据是否包含语句块，Lambda表达式可以分为两种类型：
     <strong>
      表达式Lambda
     </strong>
     和
     <strong>
      语句Lambda
     </strong>
     。
    </p>
    <h3>
     <a id="1__Lambda_39">
     </a>
     1. 使用 表达式Lambda
    </h3>
    <p>
     表达式Lambda是最简单的形式，
     <strong>
      仅包含一个表达式
     </strong>
     ，
     <strong>
      表达式Lambda 侧重于表达式的返回值
     </strong>
     。其语法如下：
    </p>
    <pre><code class="prism language-csharp"><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> expression

<span class="token comment">//如：</span>
 x <span class="token operator">=&gt;</span> x <span class="token operator">*</span> <span class="token number">4</span>
</code></pre>
    <h4>
     <a id="1_49">
     </a>
     1）演化过程
    </h4>
    <pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">Square</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> num<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
     <span class="token keyword">return</span> num <span class="token operator">*</span> num<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     上面定义一个简单的计算方法，现在我们需要以 Lambda 表达式表现出来，该如何表现呢？
    </p>
    <pre><code class="prism language-csharp"><span class="token class-name">Func<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> func <span class="token operator">=</span> x <span class="token operator">=&gt;</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span>
</code></pre>
    <p>
     上述两个示例代码是等效的，
     <code>
      x =&gt; x * x;
     </code>
     本质上等同于将一个有返回值的方法赋予了
     <code>
      Func
     </code>
     委托；
    </p>
    <h4>
     <a id="2_64">
     </a>
     2）示例
    </h4>
    <pre><code class="prism language-csharp"><span class="token comment">// 定义一个委托类型</span>
<span class="token class-name">Func<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> square <span class="token operator">=</span> x <span class="token operator">=&gt;</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span>

<span class="token comment">// 调用委托</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token function">square</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出: 25</span>
</code></pre>
    <p>
     在这个例子中，我们定义了一个名为
     <code>
      square
     </code>
     的委托，它接受一个整数参数并返回该整数的平方值。通过Lambda表达式，我们可以非常简洁地实现这一功能。
    </p>
    <h3>
     <a id="2_Lambda_74">
     </a>
     2. 语句Lambda
    </h3>
    <p>
     语句Lambda允许包含
     <strong>
      多条语句
     </strong>
     ，适用于需要执行复杂逻辑的情况。其语法如下：
    </p>
    <pre><code class="prism language-csharp"><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span> statements <span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      语句Lambda侧重语句块中执行内容
     </strong>
     ，具体示例如下：
    </p>
    <pre><code class="prism language-csharp"><span class="token comment">// 定义一个委托类型</span>
<span class="token class-name">Action<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> printAndSquare <span class="token operator">=</span> x <span class="token operator">=&gt;</span>
<span class="token punctuation">{<!-- --></span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Input: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">x</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Square: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">x <span class="token operator">*</span> x</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 调用委托</span>
<span class="token function">printAndSquare</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出: Input: 5 Square: 25</span>
</code></pre>
    <p>
     在这个例子中，我们定义了一个名为
     <code>
      printAndSquare
     </code>
     的委托，它接受一个整数参数并打印输入值及其平方值。通过语句Lambda，我们可以轻松实现这一复杂的逻辑。
    </p>
    <pre><code class="prism language-csharp"><span class="token class-name">Func<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> factorial <span class="token operator">=</span> n <span class="token operator">=&gt;</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        <span class="token keyword">return</span> n <span class="token operator">*</span> <span class="token function">factorial</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
    <h3>
     <a id="3_Lambda__106">
     </a>
     3. Lambda 表达式的各种使用方式
    </h3>
    <h4>
     <a id="1___107">
     </a>
     1）无参数 与 空括号
    </h4>
    <p>
     将 lambda 表达式的输入参数括在括号中。 使用空括号指定零个输入参数。
     <strong>
      如果是没有参数，必须有这个空括号
     </strong>
    </p>
    <pre><code class="prism language-csharp"><span class="token class-name">Action</span> line <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <h4>
     <a id="2_114">
     </a>
     2）方法体只有一行代码
    </h4>
    <p>
     如果方法体中只有一行代码，可以省略方法体大括号
    </p>
    <pre><code class="prism language-csharp"><span class="token class-name">Action</span> line1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//省略方法体大括号</span>
<span class="token class-name">Action</span> line2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <h4>
     <a id="3_124">
     </a>
     3）类型推断
    </h4>
    <p>
     C# 编译器会根据上下文自动推断参数类型，无需显式声明：
    </p>
    <blockquote>
     <p>
      Lambda表达式的类型是由编译器根据上下文推断出来的，通常对应于某个委托类型（如
      <code>
       Func&lt;T, TResult&gt;
      </code>
      或
      <code>
       Action&lt;T&gt;
      </code>
      ）。如果Lambda表达式没有返回值，则其类型为
      <code>
       Action
      </code>
      ；如果有返回值，则其类型为
      <code>
       Func
      </code>
      。
     </p>
    </blockquote>
    <pre><code class="prism language-csharp"><span class="token class-name">Func<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> func3 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> num1<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> num2<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> num1 <span class="token operator">*</span> num2<span class="token punctuation">;</span>

<span class="token comment">//类型推断 允许我们省略 数据类型的显示声明</span>
<span class="token class-name">Func<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> func4 <span class="token operator">=</span> <span class="token punctuation">(</span>num1<span class="token punctuation">,</span> num2<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> num1 <span class="token operator">*</span> num2<span class="token punctuation">;</span>
</code></pre>
    <h4>
     <a id="4_135">
     </a>
     4）无法类型推断时
    </h4>
    <p>
     一般情况下，编译器可自行推断输入参数的类型，但存在编译器无法推断的情况，则需自行指定
    </p>
    <pre><code class="prism language-csharp"><span class="token class-name">Func<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">bool</span><span class="token punctuation">&gt;</span></span> isTooLong <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> x<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> s<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> s<span class="token punctuation">.</span>Length <span class="token operator">&gt;</span> x<span class="token punctuation">;</span>
</code></pre>
    <h4>
     <a id="5return_142">
     </a>
     5）省略return
    </h4>
    <p>
     如果方法体中只有一行代码，且有返回值，可以省略
     <code>
      return
     </code>
    </p>
    <ul>
     <li>
      当方法体中只有一行代码，但并没有返回值的时候，此时的Lambda表达式 是 【语句
      <code>
       Lambda
      </code>
      】
     </li>
     <li>
      当方法体中只有一行代码，且有返回值的时候，此时的Lambda表达式 是 【表达式
      <code>
       Lambda
      </code>
      】
     </li>
    </ul>
    <pre><code class="prism language-csharp"><span class="token comment">// 语句 Lambda ，侧重于执行内容</span>
<span class="token class-name">Action</span> action <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"ss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 表达式 Lambda，侧重于返回值</span>
<span class="token comment">// 特征：一行代码 + 有返回值</span>
<span class="token class-name">Func<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> func1 <span class="token operator">=</span> x <span class="token operator">=&gt;</span> x <span class="token operator">*</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span>
<span class="token class-name">Func<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> func2 <span class="token operator">=</span> x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      

</code></pre>
    <h4>
     <a id="6_157">
     </a>
     6）一个参数
    </h4>
    <p>
     如果只有一个输入参数，则括号可有可无
    </p>
    <pre><code class="prism language-csharp"><span class="token class-name">Func<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> func <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x <span class="token operator">*</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span>

<span class="token comment">//省略括号</span>
<span class="token class-name">Func<span class="token punctuation">&lt;</span><span class="token keyword">double</span><span class="token punctuation">,</span> <span class="token keyword">double</span><span class="token punctuation">&gt;</span></span> cube <span class="token operator">=</span> x <span class="token operator">=&gt;</span> x <span class="token operator">*</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span>
</code></pre>
    <h4>
     <a id="7_2_166">
     </a>
     7） 2个参数以上
    </h4>
    <p>
     两个或更多输入参数使用逗号加以分隔
    </p>
    <pre><code class="prism language-csharp"><span class="token class-name">Func<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">bool</span><span class="token punctuation">&gt;</span></span> testForEquality <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x <span class="token operator">==</span> y<span class="token punctuation">;</span>

<span class="token class-name">Func<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
</code></pre>
    <h4>
     <a id="8___return_175">
     </a>
     8）多行代码 + 显示 return
    </h4>
    <p>
     当方法体中具有多行代码，则 该Lambda表达式 是【语句Lambda】，如果需要返回数据，则需要显示使用
     <code>
      return
     </code>
     。
    </p>
    <pre><code class="prism language-csharp"><span class="token class-name">Func<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> func3 <span class="token operator">=</span> <span class="token punctuation">(</span>num1<span class="token punctuation">,</span> num2<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
<span class="token punctuation">{<!-- --></span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"计算："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> num1<span class="token operator">*</span> num2<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>                                                

</code></pre>
    <h2>
     <a id="Lambda__186">
     </a>
     三、Lambda 表达式的常见应用场景
    </h2>
    <h3>
     <a id="1__188">
     </a>
     1. 应用场景
    </h3>
    <p>
     Lambda表达式广泛应用于各种场景，以下是几个常见的应用场景：
    </p>
    <ul>
     <li>
      <strong>
       LINQ查询
      </strong>
      ：在LINQ查询中，Lambda表达式常用于指定过滤条件、投影、排序等操作。
     </li>
     <li>
      <strong>
       事件处理
      </strong>
      ：可以用Lambda表达式来简化事件处理程序的编写。
     </li>
     <li>
      <strong>
       异步编程
      </strong>
      ：在异步编程中，Lambda表达式可用于定义异步任务的执行逻辑。
     </li>
     <li>
      <strong>
       委托与回调
      </strong>
      ：Lambda表达式可以作为委托的实现，用于回调函数或其他需要传递函数指针的场合。
     </li>
    </ul>
    <h3>
     <a id="2__197">
     </a>
     2. 应用场景示例
    </h3>
    <h4>
     <a id="1Lambda_198">
     </a>
     1）Lambda与委托
    </h4>
    <ul>
     <li>
      <strong>
       内置委托类型
      </strong>
      ：Lambda表达式可隐式转换为
      <code>
       Func
      </code>
      或
      <code>
       Action
      </code>
      委托：
      <pre><code class="prism language-csharp"><span class="token comment">// Func委托（带返回值）  </span>
<span class="token class-name">Func<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>  

<span class="token comment">// Action委托（无返回值）  </span>
<span class="token class-name">Action<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> log <span class="token operator">=</span> msg <span class="token operator">=&gt;</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre>
      <blockquote>
       <p>
        Lambda 表达式可以转换的委托类型由其参数和返回值的类型定义。 如果 Lambda 表达式不返回值，则可以将其转换为 Action 委托类型之一；否则，可将其转换为 Func 委托类型之一。
       </p>
      </blockquote>
     </li>
     <li>
      <strong>
       自定义委托
      </strong>
      ：Lambda可直接赋值给自定义委托类型：
      <pre><code class="prism language-csharp"><span class="token keyword">delegate</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">Operation</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> a<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Operation</span> <span class="token keyword">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token keyword">add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出 7</span>
</code></pre>
     </li>
    </ul>
    <h4>
     <a id="2Lambda_LINQ_215">
     </a>
     2）Lambda 在LINQ中的应用
    </h4>
    <p>
     Lambda是LINQ查询的基石，是编写查询条件的标准方式，用于定义筛选、排序和转换逻辑：
    </p>
    <pre><code class="prism language-csharp"><span class="token class-name"><span class="token keyword">var</span></span> numbers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{<!-- --></span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>  
<span class="token comment">// 筛选大于3的元素  </span>
<span class="token class-name"><span class="token keyword">var</span></span> filtered <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>n <span class="token operator">=&gt;</span> n <span class="token operator">&gt;</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 筛选 &gt;3 的数</span>
<span class="token comment">// 转换为平方值  </span>
<span class="token class-name"><span class="token keyword">var</span></span> squares <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>n <span class="token operator">=&gt;</span> n <span class="token operator">*</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 转换为平方值</span>
</code></pre>
    <pre><code class="prism language-csharp">
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name"><span class="token keyword">var</span></span> numbers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{<!-- --></span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token comment">// 筛选</span>
        <span class="token class-name"><span class="token keyword">var</span></span> evenNumbers <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Even numbers: "</span> <span class="token operator">+</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span><span class="token string">", "</span><span class="token punctuation">,</span> evenNumbers<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 排序</span>
        <span class="token class-name"><span class="token keyword">var</span></span> sortedNumbers <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Sorted numbers: "</span> <span class="token operator">+</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span><span class="token string">", "</span><span class="token punctuation">,</span> sortedNumbers<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 投影</span>
        <span class="token class-name"><span class="token keyword">var</span></span> squaredNumbers <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x <span class="token operator">*</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Squared numbers: "</span> <span class="token operator">+</span> <span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span><span class="token string">", "</span><span class="token punctuation">,</span> squaredNumbers<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <ul>
     <li>
      <strong>
       表达式树
      </strong>
      ：Lambda还可生成表达式树，供LINQ to SQL等框架解析为SQL语句。
     </li>
    </ul>
    <h4>
     <a id="3_Lambda__249">
     </a>
     3） Lambda 在事件处理中的应用
    </h4>
    <p>
     Lambda 可简化事件处理程序的编写：
    </p>
    <pre><code class="prism language-csharp">button<span class="token punctuation">.</span>Click <span class="token operator">+=</span> <span class="token punctuation">(</span>sender<span class="token punctuation">,</span> e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"按钮被点击！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <h4>
     <a id="4Lambda__255">
     </a>
     4）Lambda 在异步编程中的应用
    </h4>
    <p>
     在异步编程中，Lambda表达式可以用于定义异步任务的执行逻辑。
    </p>
    <pre><code class="prism language-csharp"><span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">static</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task</span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        <span class="token punctuation">{<!-- --></span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Task started."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Processing item </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">i <span class="token operator">+</span> <span class="token number">1</span></span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Task completed."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Main method completed."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     在这个例子中，我们使用Lambda表达式
     <code>
      () =&gt; { ... }
     </code>
     来定义异步任务的执行逻辑。
    </p>
    <h2>
     <a id="_283">
     </a>
     三、高级特性
    </h2>
    <h3>
     <a id="1__Closure_284">
     </a>
     1. 闭包（Closure）
    </h3>
    <p>
     Lambda 表达式可以捕获上下文中(或 外部作用域 )的变量，形成闭包。
    </p>
    <blockquote>
     <p>
      Lambda表达式可以捕获其定义范围内的局部变量，这意味着Lambda表达式可以访问外部作用域中的变量。这种特性使得Lambda表达式在某些情况下非常强大和灵活。
     </p>
    </blockquote>
    <pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name"><span class="token keyword">int</span></span> factor <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token class-name">Func<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> multiply <span class="token operator">=</span> x <span class="token operator">=&gt;</span> x <span class="token operator">*</span> factor<span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token function">multiply</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出: 10</span>

        factor <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token function">multiply</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出: 25（闭包保留了 factor 的引用）</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     在这个例子中，Lambda表达式捕获了外部变量
     <code>
      factor
     </code>
     ，并在计算结果时使用了这个变量的值。
    </p>
    <p>
     需要注意的是，被捕获的变量在Lambda表达式被调用时仍然有效，因此要确保这些变量在其生命周期内不会被销毁或修改。
    </p>
    <p>
     <strong>
      注意事项
     </strong>
     ：
    </p>
    <ul>
     <li>
      捕获的变量生命周期与委托绑定，可能导致内存泄漏；
     </li>
     <li>
      避免修改外部变量，防止逻辑混乱。
     </li>
     <li>
      闭包可能导致意外的变量共享，需谨慎处理。
     </li>
    </ul>
    <h3>
     <a id="2_Expression_Tree_312">
     </a>
     2. 表达式树（Expression Tree）
    </h3>
    <p>
     Lambda 表达式可以转换为表达式树，用于表示代码的结构化形式。表达式树常用于动态生成代码或进行反射操作。
    </p>
    <pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Expression<span class="token punctuation">&lt;</span>Func<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> expression <span class="token operator">=</span> x <span class="token operator">=&gt;</span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>expression<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出: x =&gt; (x + 1)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="3__Lambda_325">
     </a>
     3. 异步 Lambda
    </h3>
    <p>
     Lambda 表达式可以用于异步操作，通过
     <code>
      async
     </code>
     和
     <code>
      await
     </code>
     关键字实现。
    </p>
    <pre><code class="prism language-csharp"><span class="token class-name">Func<span class="token punctuation">&lt;</span>Task<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> asyncLambda <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ContinueWith</span><span class="token punctuation">(</span>_ <span class="token operator">=&gt;</span> <span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Tasks</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Func<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> Task<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> asyncLambda <span class="token operator">=</span> <span class="token keyword">async</span> x <span class="token operator">=&gt;</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token function">asyncLambda</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ContinueWith</span><span class="token punctuation">(</span>t <span class="token operator">=&gt;</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>Result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出: 25</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <pre><code class="prism language-csharp"><span class="token class-name">Func<span class="token punctuation">&lt;</span>Task<span class="token punctuation">&gt;</span></span> asyncTask <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> 
<span class="token punctuation">{<!-- --></span>  
    <span class="token keyword">await</span> Task<span class="token punctuation">.</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"异步完成"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span><span class="token punctuation">;</span>  
</code></pre>
    <h3>
     <a id="4__360">
     </a>
     4. 动态方法
    </h3>
    <p>
     Lambda 表达式可以用于动态生成方法，这在反射或动态调用中非常有用。
    </p>
    <pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Reflection<span class="token punctuation">.</span>Emit</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 动态生成一个方法</span>
        <span class="token class-name">DynamicMethod</span> dynamicMethod <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">DynamicMethod</span><span class="token punctuation">(</span><span class="token string">"Add"</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name"><span class="token keyword">int</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name"><span class="token keyword">int</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name"><span class="token keyword">int</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">Program</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ILGenerator</span> il <span class="token operator">=</span> dynamicMethod<span class="token punctuation">.</span><span class="token function">GetILGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        il<span class="token punctuation">.</span><span class="token function">Emit</span><span class="token punctuation">(</span>OpCodes<span class="token punctuation">.</span>Ldarg_0<span class="token punctuation">)</span><span class="token punctuation">;</span>
        il<span class="token punctuation">.</span><span class="token function">Emit</span><span class="token punctuation">(</span>OpCodes<span class="token punctuation">.</span>Ldarg_1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        il<span class="token punctuation">.</span><span class="token function">Emit</span><span class="token punctuation">(</span>OpCodes<span class="token punctuation">.</span>Add<span class="token punctuation">)</span><span class="token punctuation">;</span>
        il<span class="token punctuation">.</span><span class="token function">Emit</span><span class="token punctuation">(</span>OpCodes<span class="token punctuation">.</span>Ret<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 调用动态生成的方法</span>
        <span class="token class-name">Func<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span>Func<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>dynamicMethod<span class="token punctuation">.</span><span class="token function">CreateDelegate</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">Func<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token keyword">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出: 5</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="5__Lambda_386">
     </a>
     5. 泛型 Lambda
    </h3>
    <p>
     Lambda 表达式可以用于泛型委托，提高代码的复用性增强灵活性。
    </p>
    <pre><code class="prism language-csharp"><span class="token class-name">Func<span class="token punctuation">&lt;</span>T<span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> toString <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">T</span> obj<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> obj<span class="token punctuation">?.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre>
    <h2>
     <a id="_395">
     </a>
     四、注意事项与限制
    </h2>
    <ul>
     <li>
      <p>
       <strong>
        作用域规则
       </strong>
       ：
      </p>
      <ul>
       <li>
        Lambda 无法捕获
        <code>
         ref
        </code>
        /
        <code>
         out
        </code>
        参数。
       </li>
       <li>
        Lambda 内的
        <code>
         return
        </code>
        不影响外部方法。
       </li>
       <li>
        外部方法无法访问 Lambda 内部定义的变量。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        运算符限制
       </strong>
       ：
      </p>
      <ul>
       <li>
        不可用于
        <code>
         is
        </code>
        或
        <code>
         as
        </code>
        运算符左侧。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        语句限制
       </strong>
       ：
      </p>
      <ul>
       <li>
        不允许包含
        <code>
         goto
        </code>
        、
        <code>
         break
        </code>
        、
        <code>
         continue
        </code>
        跨越 Lambda 边界的语句。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        性能考量
       </strong>
       ：
      </p>
      <ul>
       <li>
        表达式树可能比直接委托生成更多内存开销。
       </li>
       <li>
        频繁调用的Lambda需避免闭包捕获，减少GC压力。
       </li>
       <li>
        过度使用Lambda表达式可能影响性能，尤其是在循环中频繁创建委托时。
       </li>
       <li>
        Lambda 表达式在运行时会被编译为委托或表达式树，可能会有一定的性能开销。在性能敏感的场景中，需要谨慎使用。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        循环变量捕获
       </strong>
       ：
      </p>
      <ul>
       <li>
        Lambda表达式捕获循环变量时，可能会导致意外行为（多线程异步情况下）。应使用局部变量来避免。
       </li>
      </ul>
      <pre><code class="prism language-csharp"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name"><span class="token keyword">int</span></span> local <span class="token operator">=</span> i<span class="token punctuation">;</span>
    actions<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>local<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
     </li>
    </ul>
    <h2>
     <a id="_420">
     </a>
     五、演化过程
    </h2>
    <pre><code class="prism language-csharp">    <span class="token keyword">public</span> <span class="token keyword">delegate</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ShowDelegate</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> a<span class="token punctuation">,</span><span class="token class-name"><span class="token keyword">string</span></span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LambdaEvolution</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> a1<span class="token punctuation">,</span><span class="token class-name"><span class="token keyword">string</span></span> b1<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"show</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">a1</span><span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">b1</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//1 .Netframework1.0/1.1，原始方法</span>
            <span class="token class-name">ShowDelegate</span> showDelegate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ShowDelegate</span><span class="token punctuation">(</span>Show<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//2 .NetFramework2.0，匿名方法，增加delegate,去掉单独定义方法</span>
            showDelegate <span class="token operator">=</span> <span class="token keyword">delegate</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> x<span class="token punctuation">,</span><span class="token class-name"><span class="token keyword">string</span></span> y<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"show</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">x</span><span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">y</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

            <span class="token comment">//3 .NetFramework3.0，=&gt; 引入Lambda表达式，去掉delegate</span>
            showDelegate <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> s<span class="token punctuation">,</span><span class="token class-name"><span class="token keyword">string</span></span> t<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"show</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">s</span><span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">t</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

            <span class="token comment">//4 .NetFramework3.0后期，简化参数类型,编译器自动推断数据类型</span>
            showDelegate <span class="token operator">=</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span>t<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"show</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">s</span><span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">t</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

            <span class="token comment">//5 如果方法体中只有一行代码，可以省略方法体大括号</span>
            showDelegate <span class="token operator">=</span> <span class="token punctuation">(</span>s<span class="token punctuation">,</span>t<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"show</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">s</span><span class="token punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">t</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//如果方法只有一个参数，可以省略参数小括号</span>
            <span class="token class-name">Action<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> action <span class="token operator">=</span> x <span class="token operator">=&gt;</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"show</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">x</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//如果方法体中只有一行代码，且有返回值，可以省略return</span>
            <span class="token class-name">Func<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> func <span class="token operator">=</span> x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>

</code></pre>
    <hr/>
    <h2>
     <a id="_463">
     </a>
     结语
    </h2>
    <p>
     回到目录页：
     <a href="https://blog.csdn.net/qq_39847278/article/details/144340513">
      C#/.NET 知识汇总
     </a>
     <br/>
     希望以上内容可以帮助到大家，如文中有不对之处，还请批评指正。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f33393834373237382f:61727469636c652f64657461696c732f313436303735323939" class_="artid" style="display:none">
 </p>
</div>


