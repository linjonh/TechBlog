---
layout: post
title: "d3_v7-基于-d3.arc生成径向柱状图"
date: 2025-03-13 20:49:20 +0800
description: "【代码】d3_v7 基于 d3.arc()生成径向柱状图。"
keywords: "d3_v7 基于 d3.arc()生成径向柱状图"
categories: ['数据可视化']
tags: ['开发语言', '前端', 'Javascript']
artid: "146242005"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146242005
    alt: "d3_v7-基于-d3.arc生成径向柱状图"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146242005
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146242005
cover: https://bing.ee123.net/img/rand?artid=146242005
image: https://bing.ee123.net/img/rand?artid=146242005
img: https://bing.ee123.net/img/rand?artid=146242005
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     d3_v7 基于 d3.arc()生成径向柱状图
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     <img alt="" height="924" src="https://i-blog.csdnimg.cn/direct/3873a6ae8d0e480391c126d1bd60f698.png" width="1006"/>
    </p>
    <pre><code class="language-javascript">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;title&gt;双层径向柱状图&lt;/title&gt;
&lt;!--    &lt;script src="d3.js"&gt;&lt;/script&gt;--&gt;
    &lt;script src="https://d3js.org/d3.v7.min.js"&gt;&lt;/script&gt;
    &lt;style&gt;
        .bar-inner:hover, .bar-outer:hover { opacity: 0.7; }
        .tooltip {
            position: absolute;
            padding: 8px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            border-radius: 4px;
            pointer-events: none;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id="chart"&gt;&lt;/div&gt;

&lt;script&gt;
    // 1. 定义参数
    const width = 800,
        height = 800,
        innerRadius = 80,      // 最内层圆半径
        middleRadius = 200,    // 内层柱子外半径
        outerRadius = 350;     // 外层柱子外半径

    // 2. 创建SVG容器
    const svg = d3.select("#chart")
        .append("svg")
        .attr("width", width)
        .attr("height", height)
        .append("g")
        .attr("transform", `translate(${width/2}, ${height/2})`);

    // 3. 生成双层数据（示例：12个月份，内外层各一组值）
    const data = d3.range(12).map(i =&gt; ({
        month: i + 1,
        innerValue: Math.random() * 80 + 20,  // 内层数据
        outerValue: Math.random() * 120 + 30   // 外层数据
    }));

    // 4. 角度比例尺（共用）
    const x = d3.scaleBand()
        .domain(data.map(d =&gt; d.month))
        .range([-3*Math.PI/4, 3*Math.PI/4])
        // .padding(0.2);

    // 5. 定义内外层径向比例尺
    const yInner = d3.scaleRadial()
        .domain([0, d3.max(data, d =&gt; d.innerValue)])
        .range([innerRadius, middleRadius]);

    const yOuter = d3.scaleRadial()
        .domain([0, d3.max(data, d =&gt; d.outerValue)])
        .range([middleRadius + 20, outerRadius]); // 中间留20px空隙

    // 6. 绘制中心圆
    svg.append("circle")
        .attr("r", innerRadius - 5)
        .attr("fill", "#f0f0f0")
        .attr("stroke", "#999");

    // 7. 创建弧形生成器（内层和外层）
    const arcInner = d3.arc()
        .innerRadius(innerRadius)
        .outerRadius(d =&gt; yInner(d.innerValue))
        .startAngle(d =&gt; x(d.month))
        .endAngle(d =&gt; x(d.month) + x.bandwidth())
        .padAngle(0.01);

    const arcOuter = d3.arc()
        .innerRadius(middleRadius + 20) // 与外层比例尺的range起始值对齐
        .outerRadius(d =&gt; yOuter(d.outerValue))
        .startAngle(d =&gt; x(d.month))
        .endAngle(d =&gt; x(d.month) + x.bandwidth())
        .padAngle(0.01);

    // 8. 绘制内层柱子
    svg.selectAll(".bar-inner")
        .data(data)
        .join("path")
        .attr("class", "bar-inner")
        .attr("d", arcInner)
        .attr("fill", (d, i) =&gt; d3.interpolateBlues(i/12 * 0.8));
    svg.append('path').attr("d",d3.arc()
        .innerRadius(innerRadius) // 与外层比例尺的range起始值对齐
        .outerRadius(d =&gt; yInner(40))
        .startAngle(d =&gt; -4*Math.PI/5)
        .endAngle(d =&gt; -99*Math.PI/100)).attr("fill", "grey");
    svg.append('path').attr("d",d3.arc()
        .innerRadius(innerRadius) // 与外层比例尺的range起始值对齐
        .outerRadius(d =&gt; yInner(30))
        .startAngle(d =&gt; 4*Math.PI/5)
        .endAngle(d =&gt; 99*Math.PI/100)).attr("fill", "green");
    // 9. 绘制外层柱子
    svg.selectAll(".bar-outer")
        .data(data)
        .join("path")
        .attr("class", "bar-outer")
        .attr("d", arcOuter)
        .attr("fill", (d, i) =&gt; d3.interpolateReds(i/12 * 0.8));


    // 11. 工具提示
    const tooltip = d3.select("body").append("div").attr("class", "tooltip");

    function showTooltip(event, d, layer) {
        tooltip
            .style("opacity", 1)
            .html(`${layer} Layer&lt;br&gt;Month ${d.month}&lt;br&gt;Value: ${d[layer === 'Inner' ? 'innerValue' : 'outerValue'].toFixed(1)}`)
            .style("left", (event.pageX + 10) + "px")
            .style("top", (event.pageY - 28) + "px");
    }

    d3.selectAll(".bar-inner")
        .on("mouseover", function(event, d) { showTooltip(event, d, 'Inner'); })
        .on("mouseout", () =&gt; tooltip.style("opacity", 0));

    d3.selectAll(".bar-outer")
        .on("mouseover", function(event, d) { showTooltip(event, d, 'Outer'); })
        .on("mouseout", () =&gt; tooltip.style("opacity", 0));

&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f36323236383433372f:61727469636c652f64657461696c732f313436323432303035" class_="artid" style="display:none">
 </p>
</div>


