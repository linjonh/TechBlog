---
layout: post
title: "本地YARN集群部署"
date: 2025-03-05 20:27:09 +0800
description: "本地介绍了如何在本地部署YARN集群，包括修改MapReduce配置文件，修改YARN配置文件,分发配置文件，启动HDFS，启动YARN，查看YARN的WEB UI页面"
keywords: "本地YARN集群部署"
categories: ['未分类']
tags: ['大数据', 'Yarn', 'Mapreduce', 'Hdfs']
artid: "146051466"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146051466
    alt: "本地YARN集群部署"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146051466
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146051466
cover: https://bing.ee123.net/img/rand?artid=146051466
image: https://bing.ee123.net/img/rand?artid=146051466
img: https://bing.ee123.net/img/rand?artid=146051466
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     本地YARN集群部署
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     请先完成HDFS的前置部署，部署方式可查看:
     <a class="link-info has-card" href="https://blog.csdn.net/m0_73641796/article/details/145998092?spm=1001.2014.3001.5502" title="本地部署HDFS集群">
      <span class="link-card-box" contenteditable="false">
       <span class="link-title">
        本地部署HDFS集群
       </span>
       <span class="link-link">
        <img class="link-link-icon" src="https://csdnimg.cn/release/blog_editor_html/release2.3.8/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=P1C7">
         https://blog.csdn.net/m0_73641796/article/details/145998092?spm=1001.2014.3001.5502
        </img>
       </span>
      </span>
     </a>
    </p>
    <h2>
     部署说明
    </h2>
    <table border="1" cellpadding="1" cellspacing="1" style="width:750px">
     <tbody>
      <tr>
       <td style="width:159px">
        组件
       </td>
       <td style="width:101px">
        配置文件
       </td>
       <td style="width:268px">
        启动进程
       </td>
       <td style="width:145px">
        备注
       </td>
      </tr>
      <tr>
       <td style="width:159px">
        Hadoop HDFS
       </td>
       <td style="width:101px">
        需修改
       </td>
       <td style="width:268px">
        <p>
         需启动:
        </p>
        <p>
         NameNode作为主节点
        </p>
        <p>
         DataNode作为从节点
         <br/>
         SecondaryNameNode主节点辅助
        </p>
       </td>
       <td style="width:145px">
        分布式文件系统
       </td>
      </tr>
      <tr>
       <td style="width:159px">
        Hadoop YARN
       </td>
       <td style="width:101px">
        需修改
       </td>
       <td style="width:268px">
        <p>
         需启动
         <br/>
         ResourceManager作为集群资源管理者
         <br/>
         NodeManager作为单机资源管理者
        </p>
        <p>
         ProxyServer代理服务器提供安全性
        </p>
        <p>
         JobHistoryServer记录历史信息和日志
        </p>
       </td>
       <td style="width:145px">
        分布式资源调度
       </td>
      </tr>
      <tr>
       <td style="width:159px">
        Hadoop MapReduce
       </td>
       <td style="width:101px">
        需修改
       </td>
       <td style="width:268px">
        <p>
         无需启动任何进程
        </p>
        <p>
         MapReduce程序运行在YARN容器内
        </p>
       </td>
       <td style="width:145px">
        分布式数据计算
       </td>
      </tr>
     </tbody>
    </table>
    <h2>
     集群规划
    </h2>
    <table border="1" cellpadding="1" cellspacing="1" style="width:400px">
     <tbody>
      <tr>
       <td style="width:107px">
        主机
       </td>
       <td style="width:491px">
        角色
       </td>
      </tr>
      <tr>
       <td style="width:107px">
        node1
       </td>
       <td style="width:491px">
        <p>
         ResourceManager
         <br/>
         NodeManager
        </p>
        <p>
         ProxyServer
        </p>
        <p>
         JobHistoryServer
        </p>
       </td>
      </tr>
      <tr>
       <td style="width:107px">
        node2
       </td>
       <td style="width:491px">
        NodeManager
       </td>
      </tr>
      <tr>
       <td style="width:107px">
        node3
       </td>
       <td style="width:491px">
        NodeManager
       </td>
      </tr>
     </tbody>
    </table>
    <h2>
     修改MapReduce配置文件
    </h2>
    <p>
     在$HADOOP_HOME/etc/hadoop文件夹内，修改mapred-env.sh文件，添加如下环境变量
    </p>
    <pre class="sweezy-custom-cursor-default-hover"><code>export JAVA_HOME=/export/server/jdk
export HADOOP_JOB_HISTORYSERVER_HEAPSIZE=1000
export HADOOP_MAPRED_ROOT_LOGGER=INFO,RFA</code></pre>
    <p>
     修改mapred-site.xml文件，添加如下配置信息
    </p>
    <pre class="sweezy-custom-cursor-default-hover"><code>&lt;configuration&gt;
  &lt;property&gt;
    &lt;name&gt;mapreduce.framework.name&lt;/name&gt;
    &lt;value&gt;yarn&lt;/value&gt;
    &lt;description&gt;&lt;/description&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;mapreduce.jobhistory.address&lt;/name&gt;
    &lt;value&gt;node1:10020&lt;/value&gt;
    &lt;description&gt;&lt;/description&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;mapreduce.jobhistory.webapp.address&lt;/name&gt;
    &lt;value&gt;node1:19888&lt;/value&gt;
    &lt;description&gt;&lt;/description&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;mapreduce.jobhistory.intermediate-done-dir&lt;/name&gt;
    &lt;value&gt;/data/mr-history/tmp&lt;/value&gt;
    &lt;description&gt;&lt;/description&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;mapreduce.jobhistory.done-dir&lt;/name&gt;
    &lt;value&gt;/data/mr-history/done&lt;/value&gt;
    &lt;description&gt;&lt;/description&gt;
  &lt;/property&gt;
 &lt;property&gt;
   &lt;name&gt;yarn.app.mapreduce.am.env&lt;/name&gt;
   &lt;value&gt;HADOOP_MAPRED_HOME=$HADOOP_HOME&lt;/value&gt;
 &lt;/property&gt;
 &lt;property&gt;
   &lt;name&gt;mapreduce.map.env&lt;/name&gt;
   &lt;value&gt;HADOOP_MAPRED_HOME=$HADOOP_HOME&lt;/value&gt;
 &lt;/property&gt;
 &lt;property&gt;
   &lt;name&gt;mapreduce.reduce.env&lt;/name&gt;
   &lt;value&gt;HADOOP_MAPRED_HOME=$HADOOP_HOME&lt;/value&gt;
 &lt;/property&gt;
&lt;/configuration&gt;</code></pre>
    <h2>
     修改YARN配置文件
    </h2>
    <p>
     在$HADOOP_HOME/etc/hadoop文件夹内，修改yarn-env.sh文件，添加如下环境变量
    </p>
    <pre class="sweezy-custom-cursor-default-hover"><code>export JAVA_HOME=/export/server/jdk
export HADOOP_HOME=/export/server/hadoop
export HADOOP_CONF_DIR=$HADOOP_HOME/etc/hadoop
export HADOOP_LOG_DIR=$HADOOP_HOME/logs
</code></pre>
    <p>
     修改yarn-site.xml文件，添加如下内容：
    </p>
    <pre class="sweezy-custom-cursor-default-hover"><code>&lt;configuration&gt;

&lt;!-- Site specific YARN configuration properties --&gt;
&lt;property&gt;
    &lt;name&gt;yarn.log.server.url&lt;/name&gt;
    &lt;value&gt;http://node1:19888/jobhistory/logs&lt;/value&gt;
    &lt;description&gt;&lt;/description&gt;
&lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;yarn.web-proxy.address&lt;/name&gt;
    &lt;value&gt;node1:8089&lt;/value&gt;
    &lt;description&gt;proxy server hostname and port&lt;/description&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;yarn.log-aggregation-enable&lt;/name&gt;
    &lt;value&gt;true&lt;/value&gt;
    &lt;description&gt;Configuration to enable or disable log aggregation&lt;/description&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;yarn.nodemanager.remote-app-log-dir&lt;/name&gt;
    &lt;value&gt;/tmp/logs&lt;/value&gt;
    &lt;description&gt;Configuration to enable or disable log aggregation&lt;/description&gt;
  &lt;/property&gt;

&lt;!-- Site specific YARN configuration properties --&gt;
  &lt;property&gt;
    &lt;name&gt;yarn.resourcemanager.hostname&lt;/name&gt;
    &lt;value&gt;node1&lt;/value&gt;
    &lt;description&gt;&lt;/description&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;yarn.resourcemanager.scheduler.class&lt;/name&gt;
&lt;value&gt;org.apache.hadoop.yarn.server.resourcemanager.scheduler.fair.FairScheduler&lt;/value&gt;
    &lt;description&gt;&lt;/description&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;yarn.nodemanager.local-dirs&lt;/name&gt;
    &lt;value&gt;/data/nm-local&lt;/value&gt;
    &lt;description&gt;Comma-separated list of paths on the local filesystem where intermediate data is written.&lt;/description&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;yarn.nodemanager.log-dirs&lt;/name&gt;
    &lt;value&gt;/data/nm-log&lt;/value&gt;
    &lt;description&gt;Comma-separated list of paths on the local filesystem where logs are written.&lt;/description&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;yarn.nodemanager.log.retain-seconds&lt;/name&gt;
    &lt;value&gt;10800&lt;/value&gt;
    &lt;description&gt;Default time (in seconds) to retain log files on the NodeManager Only applicable if log-aggregation is disabled.&lt;/description&gt;
  &lt;/property&gt;
  &lt;property&gt;
    &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;
    &lt;value&gt;mapreduce_shuffle&lt;/value&gt;
    &lt;description&gt;Shuffle service that needs to be set for Map Reduce applications.&lt;/description&gt;
  &lt;/property&gt;
&lt;/configuration&gt;</code></pre>
    <h2>
     分发配置文件
    </h2>
    <pre class="sweezy-custom-cursor-default-hover"><code>scp mapred-env.sh mapred-site.xml yarn-env.sh yarn-site.xml node2:`pwd`/
scp mapred-env.sh mapred-site.xml yarn-env.sh yarn-site.xml node3:`pwd`/</code></pre>
    <h2>
     启动HDFS
    </h2>
    <pre class="sweezy-custom-cursor-default-hover"><code>start-dfs.sh</code></pre>
    <h2>
     启动YARN
    </h2>
    <pre class="sweezy-custom-cursor-default-hover"><code class="language-bash"># 一键启动YARN集群
start-yarn.sh

# 一键停止YARN集群
stop-yarn.sh

# 在当前机器，单独启动或停止进程
yarn --daemon start|stop resourcemanager|nodemanager|proxyserver

# 历史服务器启动和停止
mapred --daemon start|stop historyserver</code></pre>
    <p>
     可通过jps命令查看当前运行的进程
    </p>
    <p>
     <img alt="" height="344" src="https://i-blog.csdnimg.cn/direct/089c2f3e8c624d79979041df073350f5.png" width="556"/>
    </p>
    <h2 style="background-color:transparent">
     查看YARN的WEB UI页面
    </h2>
    <p>
     <span style="color:#262626">
      打开 http://node1:8088
     </span>
     <span style="color:#262626">
      即可看到
     </span>
     <span style="color:#262626">
      YARN
     </span>
     <span style="color:#262626">
      集群的监控页面（
     </span>
     <span style="color:#262626">
      ResourceManager
     </span>
     <span style="color:#262626">
      的
     </span>
     <span style="color:#262626">
      WEB UI
     </span>
     <span style="color:#262626">
      ）
     </span>
    </p>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f37333634313739362f:61727469636c652f64657461696c732f313436303531343636" class_="artid" style="display:none">
 </p>
</div>


