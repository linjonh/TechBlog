---
layout: post
title: "跳表数据结构"
date: 2025-03-11 19:02:59 +0800
description: "等系统中被用于**有序集合（Sorted Set）**的实现。每一层都是上一层的子集，节点的“晋升”是。跳表（Skip List）是一种。，用于加速查找操作，特别适用于。—— 因为跳表的高度是。的（通常是 1/2）。，查找路径长度也大约是。"
keywords: "跳表数据结构"
categories: ['未分类']
tags: ['数据结构']
artid: "146186226"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146186226
    alt: "跳表数据结构"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146186226
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146186226
cover: https://bing.ee123.net/img/rand?artid=146186226
image: https://bing.ee123.net/img/rand?artid=146186226
img: https://bing.ee123.net/img/rand?artid=146186226
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     跳表数据结构
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     跳表（Skip List）是一种
     <strong>
      支持高效插入、删除和查找
     </strong>
     的
     <strong>
      链表结构
     </strong>
     ，用于加速查找操作，特别适用于
     <strong>
      有序数据集合
     </strong>
     。它在
     <strong>
      Redis、LevelDB
     </strong>
     等系统中被用于**有序集合（Sorted Set）**的实现。
    </p>
    <h2>
     <a id="1__1">
     </a>
     <strong>
      1. 跳表的结构
     </strong>
    </h2>
    <p>
     跳表的核心思想是：
     <br/>
     <strong>
      在链表的基础上，引入多级索引，类似于高速公路的匝道，提高查找效率。
     </strong>
    </p>
    <p>
     一个跳表通常由多层索引构成：
    </p>
    <ul>
     <li>
      <strong>
       最底层（Level 0）
      </strong>
      是一个
      <strong>
       有序单链表
      </strong>
      ，存储所有数据；
     </li>
     <li>
      <strong>
       上层索引（Level &gt; 0）
      </strong>
      由
      <strong>
       部分节点
      </strong>
      构成，起到“跳跃”的作用，加速查找；
     </li>
     <li>
      <strong>
       最上层索引
      </strong>
      由
      <strong>
       少量节点
      </strong>
      构成，使得查找可以迅速缩小范围。
     </li>
    </ul>
    <p>
     示例跳表（3 层）：
    </p>
    <pre><code>Level 2:    1 --------------&gt; 9 ----------------&gt; 19
Level 1:    1 ----&gt; 5 -----&gt; 9 ----&gt; 13 -------&gt; 19
Level 0:    1 -&gt; 3 -&gt; 5 -&gt; 7 -&gt; 9 -&gt; 11 -&gt; 13 -&gt; 15 -&gt; 17 -&gt; 19
</code></pre>
    <p>
     每一层都是上一层的子集，节点的“晋升”是
     <strong>
      概率性
     </strong>
     的（通常是 1/2）。
    </p>
    <h2>
     <a id="2__17">
     </a>
     <strong>
      2. 跳表的基本操作
     </strong>
    </h2>
    <h3>
     <a id="_18">
     </a>
     <strong>
      查找
     </strong>
    </h3>
    <p>
     跳表的查找过程类似于二分查找：
    </p>
    <ol>
     <li>
      <strong>
       从最高层索引
      </strong>
      开始，查找小于目标值的最大节点；
     </li>
     <li>
      <strong>
       向下移动
      </strong>
      到下一层索引，继续查找；
     </li>
     <li>
      <strong>
       直到底层
      </strong>
      （Level 0），最终在普通链表中找到目标节点或确认其不存在。
     </li>
    </ol>
    <p>
     时间复杂度：
     <br/>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         O 
         
        
          ( 
         
        
          log 
         
        
          ⁡ 
         
        
          n 
         
        
          ) 
         
        
       
         O(\log n)
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           O
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mop">
           lo
           <span style="margin-right: 0.0139em;">
            g
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mord mathnormal">
           n
          </span>
          <span class="mclose">
           )
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     —— 因为跳表的高度是
     <strong>
      O(log n)
     </strong>
     ，查找路径长度也大约是
     <strong>
      O(log n)
     </strong>
     。
    </p>
    <h3>
     <a id="_26">
     </a>
     <strong>
      插入
     </strong>
    </h3>
    <ol>
     <li>
      <strong>
       查找插入位置
      </strong>
      ，找到前驱节点；
     </li>
     <li>
      <strong>
       随机决定新节点的层数
      </strong>
      （常见做法：掷硬币，每次有 50% 概率提升一层）；
     </li>
     <li>
      <strong>
       在每一层进行插入
      </strong>
      ，更新索引。
     </li>
    </ol>
    <p>
     时间复杂度：
    </p>
    <ul>
     <li>
      <strong>
       平均 O(log n)
      </strong>
      ，因为最多遍历 log n 层；
     </li>
     <li>
      <strong>
       最坏 O(n)
      </strong>
      （所有元素都在同一层）。
     </li>
    </ul>
    <h3>
     <a id="_34">
     </a>
     <strong>
      删除
     </strong>
    </h3>
    <ol>
     <li>
      <strong>
       查找目标节点
      </strong>
      （与查找操作类似）；
     </li>
     <li>
      <strong>
       在每一层移除节点
      </strong>
      ；
     </li>
     <li>
      <strong>
       如果某层为空，则删除该层
      </strong>
      。
     </li>
    </ol>
    <p>
     时间复杂度：
     <br/>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         O 
         
        
          ( 
         
        
          log 
         
        
          ⁡ 
         
        
          n 
         
        
          ) 
         
        
       
         O(\log n)
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           O
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mop">
           lo
           <span style="margin-right: 0.0139em;">
            g
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mord mathnormal">
           n
          </span>
          <span class="mclose">
           )
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <h2>
     <a id="3__vs__41">
     </a>
     <strong>
      3. 跳表 vs. 其他数据结构
     </strong>
    </h2>
    <table>
     <thead>
      <tr>
       <th>
        数据结构
       </th>
       <th>
        查找时间复杂度
       </th>
       <th>
        插入时间复杂度
       </th>
       <th>
        删除时间复杂度
       </th>
       <th>
        额外空间
       </th>
       <th>
        适用场景
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <strong>
         跳表
        </strong>
       </td>
       <td>
        O(log n)
       </td>
       <td>
        O(log n)
       </td>
       <td>
        O(log n)
       </td>
       <td>
        O(n)
       </td>
       <td>
        <strong>
         有序数据、高效查找
        </strong>
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         平衡二叉搜索树 (AVL, 红黑树)
        </strong>
       </td>
       <td>
        O(log n)
       </td>
       <td>
        O(log n)
       </td>
       <td>
        O(log n)
       </td>
       <td>
        O(n)
       </td>
       <td>
        <strong>
         适用于动态数据
        </strong>
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         哈希表
        </strong>
       </td>
       <td>
        O(1)
       </td>
       <td>
        O(1)
       </td>
       <td>
        O(1)
       </td>
       <td>
        O(n)
       </td>
       <td>
        <strong>
         适用于无序数据、频繁查询
        </strong>
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         链表
        </strong>
       </td>
       <td>
        O(n)
       </td>
       <td>
        O(1)
       </td>
       <td>
        O(n)
       </td>
       <td>
        O(n)
       </td>
       <td>
        <strong>
         适用于插入、删除较多
        </strong>
       </td>
      </tr>
     </tbody>
    </table>
    <h3>
     <a id="_vs__48">
     </a>
     <strong>
      跳表 vs. 红黑树
     </strong>
    </h3>
    <ul>
     <li>
      <strong>
       跳表实现更简单
      </strong>
      ，只需维护索引，而红黑树需要复杂的旋转操作；
     </li>
     <li>
      <strong>
       跳表在分布式环境中更友好
      </strong>
      ，如 Redis 的有序集合（ZSet）采用跳表；
     </li>
     <li>
      <strong>
       红黑树适用于内存受限的场景
      </strong>
      ，因为跳表的索引层需要额外存储空间。
     </li>
    </ul>
    <h2>
     <a id="4__52">
     </a>
     <strong>
      4. 实际应用
     </strong>
    </h2>
    <h3>
     <a id="Redis_53">
     </a>
     <strong>
      Redis
     </strong>
    </h3>
    <p>
     Redis
     <strong>
      有序集合（Sorted Set）
     </strong>
     的底层结构是
     <strong>
      跳表 + 哈希表
     </strong>
     ：
    </p>
    <ul>
     <li>
      跳表：用于
      <strong>
       范围查询
      </strong>
      （
      <code>
       ZRANGE
      </code>
      、
      <code>
       ZREVRANGE
      </code>
      ）
     </li>
     <li>
      哈希表：用于
      <strong>
       O(1) 查找
      </strong>
      （
      <code>
       ZADD
      </code>
      ）
     </li>
    </ul>
    <h3>
     <a id="LevelDB_57">
     </a>
     <strong>
      LevelDB
     </strong>
    </h3>
    <p>
     Google 的
     <strong>
      LevelDB
     </strong>
     用跳表存储
     <strong>
      MemTable
     </strong>
     ，然后刷盘成
     <strong>
      SSTable
     </strong>
     。
    </p>
    <h2>
     <a id="5_Java_59">
     </a>
     <strong>
      5. 代码实现（Java）
     </strong>
    </h2>
    <h3>
     <a id="_60">
     </a>
     <strong>
      跳表节点
     </strong>
    </h3>
    <pre><code class="prism language-java"><span class="token keyword">class</span> <span class="token class-name">SkipListNode</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> val<span class="token punctuation">;</span>
    <span class="token class-name">SkipListNode</span><span class="token punctuation">[</span><span class="token punctuation">]</span> next<span class="token punctuation">;</span> <span class="token comment">// 指向不同层级的下一个节点</span>

    <span class="token keyword">public</span> <span class="token class-name">SkipListNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">,</span> <span class="token keyword">int</span> level<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>val <span class="token operator">=</span> val<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SkipListNode</span><span class="token punctuation">[</span>level<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="_72">
     </a>
     <strong>
      跳表类
     </strong>
    </h3>
    <pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Random</span></span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">SkipList</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">MAX_LEVEL</span> <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span>  <span class="token comment">// 最大层数</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">SkipListNode</span> head<span class="token punctuation">;</span> <span class="token comment">// 头节点</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> levelCount <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 当前最大层数</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Random</span> random <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">SkipList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        head <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SkipListNode</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token constant">MAX_LEVEL</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 初始化头节点</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 查找</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">search</span><span class="token punctuation">(</span><span class="token keyword">int</span> target<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">SkipListNode</span> cur <span class="token operator">=</span> head<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> levelCount <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>cur<span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> cur<span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>val <span class="token operator">&lt;</span> target<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                cur <span class="token operator">=</span> cur<span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        cur <span class="token operator">=</span> cur<span class="token punctuation">.</span>next<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// 进入最底层</span>
        <span class="token keyword">return</span> cur <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> cur<span class="token punctuation">.</span>val <span class="token operator">==</span> target<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 插入</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">SkipListNode</span><span class="token punctuation">[</span><span class="token punctuation">]</span> update <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SkipListNode</span><span class="token punctuation">[</span><span class="token constant">MAX_LEVEL</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 记录每层的前驱节点</span>
        <span class="token class-name">SkipListNode</span> cur <span class="token operator">=</span> head<span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> levelCount <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>cur<span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> cur<span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>val <span class="token operator">&lt;</span> num<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                cur <span class="token operator">=</span> cur<span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            update<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> cur<span class="token punctuation">;</span>  <span class="token comment">// 记录前驱节点</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">int</span> newLevel <span class="token operator">=</span> <span class="token function">randomLevel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        levelCount <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>levelCount<span class="token punctuation">,</span> newLevel<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SkipListNode</span> newNode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SkipListNode</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> newLevel<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> newLevel<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            newNode<span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> update<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            update<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> newNode<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 删除</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">SkipListNode</span> cur <span class="token operator">=</span> head<span class="token punctuation">;</span>
        <span class="token class-name">SkipListNode</span><span class="token punctuation">[</span><span class="token punctuation">]</span> update <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SkipListNode</span><span class="token punctuation">[</span><span class="token constant">MAX_LEVEL</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> levelCount <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>cur<span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> cur<span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>val <span class="token operator">&lt;</span> num<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                cur <span class="token operator">=</span> cur<span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            update<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> cur<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">SkipListNode</span> target <span class="token operator">=</span> cur<span class="token punctuation">.</span>next<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>target <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> target<span class="token punctuation">.</span>val <span class="token operator">!=</span> num<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> levelCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>update<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> target<span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
            update<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> target<span class="token punctuation">.</span>next<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 随机生成层数</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">randomLevel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> level <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>random<span class="token punctuation">.</span><span class="token function">nextDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.5</span> <span class="token operator">&amp;&amp;</span> level <span class="token operator">&lt;</span> <span class="token constant">MAX_LEVEL</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            level<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> level<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h2>
     <a id="6__151">
     </a>
     <strong>
      6. 总结
     </strong>
    </h2>
    <ul>
     <li>
      <strong>
       跳表通过多层索引加速查询
      </strong>
      ，时间复杂度接近
      <strong>
       O(log n)
      </strong>
      ；
     </li>
     <li>
      <strong>
       插入/删除时动态调整索引
      </strong>
      ，比红黑树实现简单；
     </li>
     <li>
      <strong>
       Redis、LevelDB 等系统采用跳表
      </strong>
      ，适用于
      <strong>
       有序集合、范围查询
      </strong>
      等场景；
     </li>
     <li>
      <strong>
       比红黑树占用更多空间
      </strong>
      ，但
      <strong>
       更适合并发和分布式环境
      </strong>
      。
     </li>
    </ul>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34313839333530352f:61727469636c652f64657461696c732f313436313836323236" class_="artid" style="display:none">
 </p>
</div>


