---
layout: post
title: "C语言飞机游戏"
date: 2023-03-18 11:58:43 +0800
description: "飞机游戏_c语言飞机小游戏代码"
keywords: "c语言飞机小游戏代码"
categories: ['C']
tags: ['C']
artid: "129633583"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=129633583
    alt: "C语言飞机游戏"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=129633583
featuredImagePreview: https://bing.ee123.net/img/rand?artid=129633583
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     C语言——飞机游戏
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p id="main-toc">
     <strong>
      目录
     </strong>
    </p>
    <p id="%E5%89%8D%E8%A8%80-toc" style="margin-left:0px;">
     <a href="#%E5%89%8D%E8%A8%80" rel="nofollow">
      前言
     </a>
    </p>
    <p id="%E4%B8%80%E3%80%81%E9%A3%9E%E6%9C%BA%E6%B8%B8%E6%88%8F%E7%9A%84%E4%BB%A3%E7%A0%81-toc" style="margin-left:0px;">
     <a href="#%E4%B8%80%E3%80%81%E9%A3%9E%E6%9C%BA%E6%B8%B8%E6%88%8F%E7%9A%84%E4%BB%A3%E7%A0%81" rel="nofollow">
      一、飞机游戏的代码
     </a>
    </p>
    <p id="%E4%BA%8C%E3%80%81%E4%BB%A3%E7%A0%81%E8%A7%A3%E6%9E%90-toc" style="margin-left:0px;">
     <a href="#%E4%BA%8C%E3%80%81%E4%BB%A3%E7%A0%81%E8%A7%A3%E6%9E%90" rel="nofollow">
      二、代码解析
     </a>
    </p>
    <p id="1%E3%80%81%E4%BB%A3%E7%A0%81%E9%87%8D%E6%9E%84-toc" style="margin-left:40px;">
     <a href="#1%E3%80%81%E4%BB%A3%E7%A0%81%E9%87%8D%E6%9E%84" rel="nofollow">
      1、代码重构
     </a>
    </p>
    <p id="1%EF%BC%89%E4%B8%BB%E5%87%BD%E6%95%B0-toc" style="margin-left:80px;">
     <a href="#1%EF%BC%89%E4%B8%BB%E5%87%BD%E6%95%B0" rel="nofollow">
      1）主函数
     </a>
    </p>
    <p id="2%EF%BC%89%E5%85%B6%E5%AE%83%E5%87%BD%E6%95%B0-toc" style="margin-left:80px;">
     <a href="#2%EF%BC%89%E5%85%B6%E5%AE%83%E5%87%BD%E6%95%B0" rel="nofollow">
      2）其它函数
     </a>
    </p>
    <p id="2%E3%80%81%E6%96%B0%E7%9A%84%E5%AD%90%E5%BC%B9-toc" style="margin-left:40px;">
     <a href="#2%E3%80%81%E6%96%B0%E7%9A%84%E5%AD%90%E5%BC%B9" rel="nofollow">
      2、新的子弹
     </a>
    </p>
    <p id="3%E3%80%81%E6%95%8C%E6%9C%BA-toc" style="margin-left:40px;">
     <a href="#3%E3%80%81%E6%95%8C%E6%9C%BA" rel="nofollow">
      3、敌机
     </a>
    </p>
    <p id="1%EF%BC%89%E9%9D%99%E6%AD%A2%E7%9A%84%E6%95%8C%E6%9C%BA-toc" style="margin-left:80px;">
     <a href="#1%EF%BC%89%E9%9D%99%E6%AD%A2%E7%9A%84%E6%95%8C%E6%9C%BA" rel="nofollow">
      1）静止的敌机
     </a>
    </p>
    <p id="2%EF%BC%89%E6%95%8C%E6%9C%BA%E7%9A%84%E7%A7%BB%E5%8A%A8-toc" style="margin-left:80px;">
     <a href="#2%EF%BC%89%E6%95%8C%E6%9C%BA%E7%9A%84%E7%A7%BB%E5%8A%A8" rel="nofollow">
      2）敌机的移动
     </a>
    </p>
    <p id="3%EF%BC%89%E5%87%BB%E4%B8%AD%E6%95%8C%E6%9C%BA-toc" style="margin-left:80px;">
     <a href="#3%EF%BC%89%E5%87%BB%E4%B8%AD%E6%95%8C%E6%9C%BA" rel="nofollow">
      3）击中敌机
     </a>
    </p>
    <p id="4%E3%80%81%E6%B8%85%E5%B1%8F%E5%8A%9F%E8%83%BD-toc" style="margin-left:40px;">
     <a href="#4%E3%80%81%E6%B8%85%E5%B1%8F%E5%8A%9F%E8%83%BD" rel="nofollow">
      4、清屏功能
     </a>
    </p>
    <p id="%E6%80%BB%E7%BB%93-toc" style="margin-left:0px;">
     <a href="#%E6%80%BB%E7%BB%93" rel="nofollow">
      总结
     </a>
    </p>
    <hr id="hr-toc"/>
    <h2>
     前言
    </h2>
    <blockquote>
     <p>
      代码参考了《C语言课程设计与游戏开发实践教程》
     </p>
    </blockquote>
    <blockquote>
     <p>
      游戏介绍：
     </p>
     <p>
      对我之前的博客
      <a class="link-info" href="https://mp.csdn.net/mp_blog/creation/editor/129371528" title="C语言——简单的飞机小游戏">
       C语言——简单的飞机小游戏
      </a>
      升级，玩法和之前的没有区别，只是代码的实现不同，依旧是玩家通过输入 "W S A D" 控制飞机 " * " 的上下左右移动，同时可以通过空格键来让飞机发射激光击中敌机 " @ "。
     </p>
    </blockquote>
    <h2 id="%E4%B8%80%E3%80%81%E9%A3%9E%E6%9C%BA%E6%B8%B8%E6%88%8F%E7%9A%84%E4%BB%A3%E7%A0%81">
     一、飞机游戏的代码
    </h2>
    <pre><code class="language-cpp">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;conio.h&gt;
#include &lt;windows.h&gt;

//定义边界，游戏边界
#define HIGH 20
#define WIDTH 30

// 全局变量
int position_x, position_y; // 飞机位置
int bullet_x, bullet_y;     // 子弹位置
int enemy_x, enemy_y;       // 敌机位置
int score;                  // 得分

void gotoxy(int x, int y) // 光标移动到(x,y)位置
{
    HANDLE handle = GetStdHandle(STD_OUTPUT_HANDLE);
    COORD pos;
    pos.X = x;
    pos.Y = y;
    SetConsoleCursorPosition(handle, pos);
}

void HideCursor() // 用于隐藏光标
{
    CONSOLE_CURSOR_INFO cursor_info = {1, 0}; // 第二个值为0表示隐藏光标
    SetConsoleCursorInfo(GetStdHandle(STD_OUTPUT_HANDLE), &amp;cursor_info);
}

void startup() // 数据初始化
{
    position_x = HIGH / 2;
    position_y = WIDTH / 2;
    bullet_x = -2;
    bullet_y = position_y;
    enemy_x = 0;
    enemy_y = position_y;
    score = 0;

    HideCursor(); // 隐藏光标
}

void show() // 显示画面
{
    gotoxy(0, 0); // 光标移动到原点位置，以下重画清屏
    int i, j;
    for (i = 0; i &lt; HIGH; i++)
    {
        for (j = 0; j &lt; WIDTH; j++)
        {
            if ((i == position_x) &amp;&amp; (j == position_y))
                printf("*"); //   输出飞机*
            else if ((i == enemy_x) &amp;&amp; (j == enemy_y))
                printf("@"); //   输出敌机@
            else if ((i == bullet_x) &amp;&amp; (j == bullet_y))
                printf("|"); //   输出子弹|
            else if (i == HIGH - 1)
                printf("-");
            else if (j == WIDTH - 1)
                printf("|"); // 输出边界
            else
                printf(" "); //   输出空格
        }
        printf("\n");
    }
    printf("得分：%d\n", score);
}

void updateWithoutInput() // 与用户输入无关的更新
{
    if (bullet_x &gt; -1)
        bullet_x--;

    if ((bullet_x == enemy_x) &amp;&amp; (bullet_y == enemy_y)) // 子弹击中敌机
    {
        score++;      // 分数加1
        enemy_x = -1; // 产生新的飞机
        enemy_y = rand() % WIDTH;
        bullet_x = -2; // 子弹无效
    }
    if (enemy_x &gt; HIGH) // 敌机跑出显示屏幕
    {
        enemy_x = -1; // 产生新的飞机
        enemy_y = rand() % WIDTH;
    }

    // 用来控制敌机向下移动的速度。每隔几次循环，才移动一次敌机
    // 这样修改的话，用户按键交互速度还是保持很快，但我们NPC的移动显示可以降速
    static int speed = 0;
    if (speed &lt; 20)
        speed++;
    if (speed == 20)
    {
        enemy_x++;
        speed = 0;
    }
}

void updateWithInput() // 与用户输入有关的更新
{
    char input;
    if (kbhit()) // 判断是否有输入
    {
        input = getch(); // 根据用户的不同输入来移动，不必输入回车
        if (input == 'a')
            position_y--; // 位置左移
        if (input == 'd')
            position_y++; // 位置右移
        if (input == 'w')
            position_x--; // 位置上移
        if (input == 's')
            position_x++; // 位置下移
        if (input == ' ') // 发射子弹
        {
            bullet_x = position_x - 1; // 发射子弹的初始位置在飞机的正上方
            bullet_y = position_y;
        }
    }
}

int main()
{
    startup(); // 数据初始化
    while (1)  //  游戏循环执行
    {
        show();               // 显示画面
        updateWithoutInput(); // 与用户输入无关的更新
        updateWithInput();    // 与用户输入有关的更新
    }

    return 0;
}
</code></pre>
    <h2 id="%E4%BA%8C%E3%80%81%E4%BB%A3%E7%A0%81%E8%A7%A3%E6%9E%90">
     二、代码解析
    </h2>
    <h3 id="1%E3%80%81%E4%BB%A3%E7%A0%81%E9%87%8D%E6%9E%84">
     1、代码重构
    </h3>
    <h4 id="1%EF%BC%89%E4%B8%BB%E5%87%BD%E6%95%B0">
     1）主函数
    </h4>
    <p>
     对之前只是在主函数中实现的功能，我们首先来将需要实现的功能进行拆分，让它通过一个个函数来实现，最后通过主函数来实现功能的统一（实现预期效果）。
    </p>
    <pre><code class="language-cpp">int main()
{
    startup(); // 数据初始化
    while (1)  //  游戏循环执行
    {
        show();               // 显示画面
        updateWithoutInput(); // 与用户输入无关的更新
        updateWithInput();    // 与用户输入有关的更新
    }

    return 0;
}</code></pre>
    <p>
     将我们需要达到的预期效果分成若干个函数，让需要重复实现的放在循环中。
    </p>
    <h4 id="2%EF%BC%89%E5%85%B6%E5%AE%83%E5%87%BD%E6%95%B0">
     2）其它函数
    </h4>
    <p>
     对主函数进行重构后，对之前小游戏进行功能的模块化（通过相应的函数来实现）。
    </p>
    <pre><code class="language-cpp">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;conio.h&gt;
#include &lt;windows.h&gt;

// 定义边界，游戏边界
#define HIGH 20
#define WIDTH 30

// 全局变量
int position_x, position_y; // 飞机位置

void startup() // 数据初始化
{
    position_x = HIGH / 2;
    position_y = WIDTH / 2;
}

void show() // 显示画面
{
    system("cls");
    int i, j;
    for (i = 0; i &lt; HIGH; i++)
    {
        for (j = 0; j &lt; WIDTH; j++)
        {
            if ((i == position_x) &amp;&amp; (j == position_y))
                printf("*"); //   输出飞机 *
            else if (i == HIGH - 1)
                printf("-");
            else if (j == WIDTH - 1)
                printf("|"); // 输出边界
            else
                printf(" "); //   输出空格
        }
        printf("\n");
    }
}

void updateWithoutInput() // 与用户输入无关的更新
{
    
}

void updateWithInput() // 与用户输入有关的更新
{
    char input;
    if (kbhit()) // 判断是否有输入
    {
        input = getch(); // 根据用户的不同输入来移动，不必输入回车
        if (input == 'a')
            position_y--; // 位置左移
        if (input == 'd')
            position_y++; // 位置右移
        if (input == 'w')
            position_x--; // 位置上移
        if (input == 's')
            position_x++; // 位置下移
    }
}

int main()
{
    startup(); // 数据初始化
    while (1)  //  游戏循环执行
    {
        show();               // 显示画面
        updateWithoutInput(); // 与用户输入无关的更新
        updateWithInput();    // 与用户输入有关的更新
    }

    return 0;
}
</code></pre>
    <p>
     到此我们就完成了对之前代码的重构，这里我没有使用之前的飞机模型，使用的是 " * " 来代替飞机。
    </p>
    <h3 id="2%E3%80%81%E6%96%B0%E7%9A%84%E5%AD%90%E5%BC%B9">
     2、新的子弹
    </h3>
    <p>
     实现之前的功能之后我们来实现新的功能和对旧功能的优化。这一次我们让子弹发射后自动向前飞行。通过在打印飞机和边界的函数中添加新的分支来实现子弹的打印。
    </p>
    <pre><code class="language-cpp">void show() // 显示画面
{
    system("cls");  //清屏函数
    int i, j;
    for (i = 0; i &lt; HIGH; i++)
    {
        for (j = 0; j &lt; WIDTH; j++)
        {
            if ((i == position_x) &amp;&amp; (j == position_y))
                printf("*"); //   输出飞机 *
            else if ((i == bullet_x) &amp;&amp; (j == bullet_y))
                printf("|"); //   输出子弹|
            else if (i == HIGH - 1)
                printf("-");
            else if (j == WIDTH - 1)
                printf("|"); // 输出边界
            else
                printf(" "); //   输出空格
        }
        printf("\n");
    }
}</code></pre>
    <h3 id="3%E3%80%81%E6%95%8C%E6%9C%BA">
     3、敌机
    </h3>
    <p>
     接下来就是敌机的实现了
    </p>
    <h4 id="1%EF%BC%89%E9%9D%99%E6%AD%A2%E7%9A%84%E6%95%8C%E6%9C%BA">
     1）静止的敌机
    </h4>
    <p>
     首先我们来实现敌机的出现。
    </p>
    <p>
     依旧是在打印飞机的函数中增加新的分支来实现敌机 " @ " 的出现。（记得定义敌机相应的变量）
    </p>
    <pre><code class="language-cpp">void show() // 显示画面
{
    system("cls");  //清屏函数
    int i, j;
    for (i = 0; i &lt; HIGH; i++)
    {
        for (j = 0; j &lt; WIDTH; j++)
        {
            if ((i == position_x) &amp;&amp; (j == position_y))
                printf("*"); //   输出飞机*
            else if ((i == enemy_x) &amp;&amp; (j == enemy_y))
                printf("@"); //   输出敌机@
            else if ((i == bullet_x) &amp;&amp; (j == bullet_y))
                printf("|"); //   输出子弹|
            else if (i == HIGH - 1)
                printf("-");
            else if (j == WIDTH - 1)
                printf("|"); // 输出边界
            else
                printf(" "); //   输出空格
        }
        printf("\n");
    }
}</code></pre>
    <h4 id="2%EF%BC%89%E6%95%8C%E6%9C%BA%E7%9A%84%E7%A7%BB%E5%8A%A8">
     2）敌机的移动
    </h4>
    <p>
     实现敌机的出现后我们来移动敌机，为了降低敌机的移动速度而不影响玩家输入相应的频率。这里通过定义静态变量speed来让每实现20次 updateWithoutInput() 函数，敌机飞行一次。
    </p>
    <pre><code class="language-cpp">    // 用来控制敌机向下移动的速度。每隔几次循环，才移动一次敌机
    // 这样修改的话，用户按键交互速度还是保持很快，但我们NPC的移动显示可以降速
    static int speed = 0;
    if (speed &lt; 20)
        speed++;
    if (speed == 20)
    {
        enemy_x++;
        speed = 0;
    }</code></pre>
    <h4 id="3%EF%BC%89%E5%87%BB%E4%B8%AD%E6%95%8C%E6%9C%BA">
     3）击中敌机
    </h4>
    <p>
     通过判断飞机和子弹的位置来判断是否击中敌机，如果击中就通过随机数来实现新敌机的出现。
    </p>
    <pre><code class="language-cpp">void updateWithoutInput() // 与用户输入无关的更新
{
    if (bullet_x &gt; -1)
        bullet_x--;

    if ((bullet_x == enemy_x) &amp;&amp; (bullet_y == enemy_y)) // 子弹击中敌机
    {
        score++;      // 分数加1
        enemy_x = -1; // 产生新的飞机
        enemy_y = rand() % WIDTH;
        bullet_x = -2; // 子弹无效
    }
    if (enemy_x &gt; HIGH) // 敌机跑出显示屏幕
    {
        enemy_x = -1; // 产生新的飞机
        enemy_y = rand() % WIDTH;
    }

    // 用来控制敌机向下移动的速度。每隔几次循环，才移动一次敌机
    // 这样修改的话，用户按键交互速度还是保持很快，但我们NPC的移动显示可以降速
    static int speed = 0;
    if (speed &lt; 20)
        speed++;
    if (speed == 20)
    {
        enemy_x++;
        speed = 0;
    }
}</code></pre>
    <h3 id="4%E3%80%81%E6%B8%85%E5%B1%8F%E5%8A%9F%E8%83%BD">
     4、清屏功能
    </h3>
    <p>
     到这里基本已经实现了我们预期的效果，但会发现闪烁非常严重，这个时候我们只需要将通过移动光标来让画面重新画过就可以了，同时实现光标的隐藏。
    </p>
    <pre><code class="language-cpp">void gotoxy(int x, int y) // 光标移动到(x,y)位置
{
    HANDLE handle = GetStdHandle(STD_OUTPUT_HANDLE);
    COORD pos;
    pos.X = x;
    pos.Y = y;
    SetConsoleCursorPosition(handle, pos);
}

void HideCursor() // 用于隐藏光标
{
    CONSOLE_CURSOR_INFO cursor_info = {1, 0}; // 第二个值为0表示隐藏光标
    SetConsoleCursorInfo(GetStdHandle(STD_OUTPUT_HANDLE), &amp;cursor_info);
}</code></pre>
    <h2 id="%E6%80%BB%E7%BB%93">
     总结
    </h2>
    <blockquote>
     <p>
      我没有对这里使用到的知识点做出解释，相应的知识点请看这里
     </p>
     <p>
      清屏函数：
      <a class="has-card" href="https://blog.csdn.net/neadsc/article/details/126722743?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=C%E8%AF%AD%E8%A8%80%E6%B8%85%E5%B1%8F%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-2-126722743.142%5Ev74%5Einsert_down2,201%5Ev4%5Eadd_ask,239%5Ev2%5Einsert_chatgpt&amp;spm=1018.2226.3001.4187" title="C语言——函数的综合运用。自定义函数，gotoxy清屏函数与HideCursor隐藏光标，防闪屏，共同制作打飞机游戏。_void hidecursor功能_冰小九的博客-CSDN博客">
       <span class="link-card-box">
        <span class="link-title">
         C语言——函数的综合运用。自定义函数，gotoxy清屏函数与HideCursor隐藏光标，防闪屏，共同制作打飞机游戏。_void hidecursor功能_冰小九的博客-CSDN博客
        </span>
        <span class="link-link">
         <img alt="" class="link-link-icon" src="https://i-blog.csdnimg.cn/blog_migrate/b05fae3d85bd860567e87b0bd725661f.png">
          https://blog.csdn.net/neadsc/article/details/126722743?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=C%E8%AF%AD%E8%A8%80%E6%B8%85%E5%B1%8F%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-2-126722743.142%5Ev74%5Einsert_down2,201%5Ev4%5Eadd_ask,239%5Ev2%5Einsert_chatgpt&amp;spm=1018.2226.3001.4187
         </img>
        </span>
       </span>
      </a>
     </p>
     <p>
      随机数：
      <a class="has-card" href="https://blog.csdn.net/weixin_46022083/article/details/106661495?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167911124816800217231790%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=167911124816800217231790&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-106661495-null-null.142%5Ev74%5Einsert_down2,201%5Ev4%5Eadd_ask,239%5Ev2%5Einsert_chatgpt&amp;utm_term=%E9%9A%8F%E6%9C%BA%E6%95%B0&amp;spm=1018.2226.3001.4187" title="C语言随机数的生成【详解】_星空之路Star的博客-CSDN博客">
       <span class="link-card-box">
        <span class="link-title">
         C语言随机数的生成【详解】_星空之路Star的博客-CSDN博客
        </span>
        <span class="link-link">
         <img alt="" class="link-link-icon" src="https://i-blog.csdnimg.cn/blog_migrate/b05fae3d85bd860567e87b0bd725661f.png">
          https://blog.csdn.net/weixin_46022083/article/details/106661495?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167911124816800217231790%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=167911124816800217231790&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-106661495-null-null.142%5Ev74%5Einsert_down2,201%5Ev4%5Eadd_ask,239%5Ev2%5Einsert_chatgpt&amp;utm_term=%E9%9A%8F%E6%9C%BA%E6%95%B0&amp;spm=1018.2226.3001.4187
         </img>
        </span>
       </span>
      </a>
     </p>
    </blockquote>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f37343332363537342f:61727469636c652f64657461696c732f313239363333353833" class_="artid" style="display:none">
 </p>
</div>


