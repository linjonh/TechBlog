---
layout: post
title: ".NET-EFCore-生成数据库"
date: 2021-08-19 11:08:12 +0800
description: "一、EFCoreDBFirst：先有数据库，然后通过映射得到实体（和数据库的表对应）1.可以通过Ef"
keywords: "efcore 生成数据库"
categories: ['Core', '.NET']
tags: ['C', '.Net']
artid: "119797258"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=119797258
    alt: ".NET-EFCore-生成数据库"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=119797258
featuredImagePreview: https://bing.ee123.net/img/rand?artid=119797258
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     .NET EFCore 生成数据库
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      一、
     </span>
     <span style="color:#000000;">
      EFCoreDBFirst
     </span>
     <span style="color:#000000;">
      ：
     </span>
     <span style="color:#000000;">
      先有数据库，然后通过映射得到实体（和数据库的表对应）
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      1.可以通过EfCore带有的api来完成从代码生成数据库
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      命令：
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      Install-Package Microsoft.EntityFrameworkCore
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      Install-Package Microsoft.EntityFrameworkCore.SqlServer
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      Install-Package Microsoft.EntityFrameworkCore.Tools
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      工具--nuget包管理器--程序包管理器控制台：命令执行：
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      Scaffold-DbContext "Data Source=地址;Initial Catalog=数据库名;User ID=sa;Password=密码" Microsoft.EntityFrameworkCore.SqlServer -OutputDir Entity -Force -Context EntityDbContext -ContextDir ./
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      命令参数：
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      -OutputDir *** 实体文件所存放的文件目录
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      -ContextDir *** DbContext文件存放的目录
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      -Context *** DbContext文件名
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      -Schemas *** 需要生成实体数据的数据表所在的模式
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      -Tables *** 需要生成实体数据的数据表的集合
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      -DataAnnotations
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      -UseDatabaseNames 直接使用数据库中的表名和列名（某些版本不支持）
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      -Force 强制执行，重写已经存在的实体文件
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      二、
     </span>
     <span style="color:#000000;">
      EFCoreCodeFirst
     </span>
     <span style="color:#000000;">
      ：
     </span>
     <span style="color:#000000;">
      (迁移）：代码先行，现有代码再有数据库
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      1.可以通过EfCore带有的api来完成从代码生成数据库
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      2.迁移
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      Install-Package Microsoft.EntityFrameworkCore
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      Install-Package Microsoft.EntityFrameworkCore.SqlServer
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      Install-Package Microsoft.EntityFrameworkCore.Design
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      迁移命令：CLI命令
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      创建迁移：migrationname为迁移名称 dotnet ef migrations add migrationName
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      移除迁移(删除最近的一次迁移) dotnet ef migrations remove
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      应用所有的迁移(使迁移文件应用到数据库) dotnet ef database update migrationName
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      生成对应版本的脚本 dotnet ef migrations script
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      查看迁移列表 dotnet ef migrations list
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      查看数据库上下文信息 dotnet ef dbcontext info
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      迁移命令：PMC命令
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      创建迁移：migrationname为迁移名称 add-migration migrationName
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      移除迁移(删除最近的一次迁移) remove-migration
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      应用所有的迁移(使迁移文件应用到数据库) update-database
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:left;">
     <span style="color:#000000;">
      指定版本进行迁移 update-database migrationName
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     <span style="color:#000000;">
      生成对应版本的脚本 Script-Migration
     </span>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f77313832343537353938392f:61727469636c652f64657461696c732f313139373937323538" class_="artid" style="display:none">
 </p>
</div>


