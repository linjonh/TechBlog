---
layout: post
title: "Ubuntu-22.04-升级到-Ubuntu-24.04-全流程指南"
date: 2025-03-10 09:54:26 +0800
description: "本指南详细记录了从Ubuntu 22.04升级到Ubuntu 24.0的完整过程。"
keywords: "ubuntu升级 22.04.5 24"
categories: ['个人经验']
tags: ['运维', 'Ubuntu', 'Linux']
artid: "146143873"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146143873
    alt: "Ubuntu-22.04-升级到-Ubuntu-24.04-全流程指南"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146143873
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146143873
cover: https://bing.ee123.net/img/rand?artid=146143873
image: https://bing.ee123.net/img/rand?artid=146143873
img: https://bing.ee123.net/img/rand?artid=146143873
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Ubuntu 22.04 升级到 Ubuntu 24.04 全流程指南
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="_1__0">
     </a>
     <strong>
      📌 1. 前言
     </strong>
    </h3>
    <p>
     Ubuntu 24.04 是最新的 LTS 版本，带来了内核更新、性能优化以及更强的安全性。本指南详细记录了从
     <strong>
      Ubuntu 22.04 升级到 24.04
     </strong>
     的完整过程，包括
     <strong>
      升级前的准备、遇到的问题及如何选择最佳选项
     </strong>
     ，避免升级失败或系统损坏。
    </p>
    <hr/>
    <h3>
     <a id="_2__5">
     </a>
     <strong>
      🛠 2. 升级前的准备
     </strong>
    </h3>
    <h4>
     <a id="_21__7">
     </a>
     <strong>
      ✅ 2.1 备份重要数据
     </strong>
    </h4>
    <p>
     建议对
     <strong>
      整个系统或重要目录
     </strong>
     进行备份，以防升级失败后数据丢失。
    </p>
    <p>
     <strong>
      备份整个系统：
     </strong>
    </p>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">tar</span> <span class="token parameter variable">-cvpzf</span> backup.tar.gz <span class="token parameter variable">--exclude</span><span class="token operator">=</span>/backup.tar.gz --one-file-system /
</code></pre>
    <p>
     <strong>
      仅备份
      <code>
       /home
      </code>
      目录（用户数据）：
     </strong>
    </p>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">rsync</span> <span class="token parameter variable">-aAXv</span> /home /mnt/backup/
</code></pre>
    <p>
     如果是
     <code>
      VMware
     </code>
     或
     <code>
      Parallels Desktop
     </code>
     也可以直接备份文件夹。
     <br/>
     如果是服务器，建议
     <strong>
      使用快照
     </strong>
     （LVM、ZFS 或 VMware 快照）。
    </p>
    <hr/>
    <h4>
     <a id="_22__25">
     </a>
     <strong>
      ✅ 2.2 更新现有软件包
     </strong>
    </h4>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> update <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> <span class="token function">apt</span> upgrade <span class="token parameter variable">-y</span>
<span class="token function">sudo</span> <span class="token function">apt</span> autoremove <span class="token parameter variable">-y</span>
</code></pre>
    <p>
     然后，确保 update-manager-core 已安装：
    </p>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> update-manager-core <span class="token parameter variable">-y</span>
</code></pre>
    <p>
     <strong>
      是否要重启系统？
     </strong>
    </p>
    <ul>
     <li>
      如果
      <code>
       apt upgrade
      </code>
      <strong>
       更新了内核
      </strong>
      ，建议
      <strong>
       重启
      </strong>
      ：
      <pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">reboot</span>
</code></pre>
     </li>
     <li>
      如果只是普通的软件包更新，则
      <strong>
       可以不重启
      </strong>
      ，直接进入升级流程。
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="_3__Ubuntu__44">
     </a>
     <strong>
      🚀 3. 执行 Ubuntu 版本升级
     </strong>
    </h3>
    <p>
     Ubuntu 提供了
     <code>
      do-release-upgrade
     </code>
     命令进行版本升级。
    </p>
    <h4>
     <a id="_31__47">
     </a>
     <strong>
      ✅ 3.1 检查是否可以升级
     </strong>
    </h4>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> do-release-upgrade <span class="token parameter variable">-c</span>
</code></pre>
    <p>
     如果输出：
    </p>
    <pre><code>Checking for a new Ubuntu release
No new release found
</code></pre>
    <p>
     说明官方还未正式推送升级，你可以尝试
     <strong>
      强制升级
     </strong>
     ：
    </p>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> do-release-upgrade <span class="token parameter variable">-d</span>
</code></pre>
    <p>
     其中 -d 选项用于升级到最新的开发版（如果 24.04 仍是 Beta 版）。
    </p>
    <hr/>
    <h4>
     <a id="_32__63">
     </a>
     <strong>
      ✅ 3.2 开始升级
     </strong>
    </h4>
    <p>
     运行：
    </p>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> do-release-upgrade
</code></pre>
    <p>
     👉
     <strong>
      升级过程中系统可能会遇到以下选项：
     </strong>
    </p>
    <h4>
     <a id="321_71">
     </a>
     3.2.1
     <strong>
      是否自动重启服务？
     </strong>
    </h4>
    <p>
     建议选择
     <strong>
      <code>
       Yes
      </code>
     </strong>
     ，让系统自动重启受影响的服务。
    </p>
    <table>
     <thead>
      <tr>
       <th>
        选项
       </th>
       <th>
        说明
       </th>
       <th>
        适用场景
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        ✅
        <strong>
         选择 “是”（自动重启服务）
        </strong>
       </td>
       <td>
        适用于 Ubuntu 桌面版或无关键服务器应用的情况。
        <br/>
        选择“是”可以减少手动操作，使升级更加顺畅。
       </td>
       <td>
        个人使用、开发环境
       </td>
      </tr>
      <tr>
       <td>
        ❌
        <strong>
         选择 “否”（不自动重启服务）
        </strong>
       </td>
       <td>
        如果系统运行关键服务（如数据库、Web 服务器等），建议选择“否”。
        <br/>
        这样可以在升级完成后手动重启，避免因服务重启导致中断。
       </td>
       <td>
        生产环境、服务器
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/33ebb8ee8ad4486aac57307deaab9ea1.png"/>
    </p>
    <h4>
     <a id="322_sshd_config_81">
     </a>
     3.2.2
     <strong>
      配置文件冲突（如 sshd_config）
     </strong>
    </h4>
    <p>
     <strong>
      选择建议
     </strong>
    </p>
    <table>
     <thead>
      <tr>
       <th>
        情况
       </th>
       <th>
        选项
       </th>
       <th>
        说明
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <strong>
         如果你以前修改过
         <code>
          sshd_config
         </code>
         ，并且不想丢失修改（推荐）
        </strong>
       </td>
       <td>
        选择
        <strong>
         “keep the local version currently installed”
        </strong>
        （保持当前已安装的本地版本）
       </td>
       <td>
        这样可以保留你的自定义 SSH 设置，避免覆盖导致 SSH 连接中断。
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         如果你不确定是否要修改
         <code>
          sshd_config
         </code>
         ，或者想要默认的新配置
        </strong>
       </td>
       <td>
        选择
        <strong>
         “show the differences between the versions”
        </strong>
        或
        <strong>
         “show a side-by-side difference”
        </strong>
       </td>
       <td>
        查看新旧版本的不同，评估新版本是否有重要变更，再决定保留本地版本还是更新。
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         如果你想要使用官方默认的
         <code>
          sshd_config
         </code>
        </strong>
       </td>
       <td>
        选择
        <strong>
         “install the package maintainer’s version”
        </strong>
       </td>
       <td>
        这样会
        <strong>
         覆盖你现有的 SSH 设置
        </strong>
        ，可能影响 SSH 访问权限等，需要手动重新配置。
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     <strong>
      推荐操作
     </strong>
    </p>
    <table>
     <thead>
      <tr>
       <th>
        建议
       </th>
       <th>
        说明
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <strong>
         如果是远程连接（如 SSH 访问云台虚拟机）
        </strong>
       </td>
       <td>
        强烈建议
        <strong>
         保持本地版本
        </strong>
        ，以免导致 SSH 连接问题。
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         如果不确定或想对比版本
        </strong>
       </td>
       <td>
        可以选择
        <strong>
         “show the differences”
        </strong>
        先查看变更内容。
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/73c680c2e34048239b7e7e71e6c5b6cb.png"/>
    </p>
    <hr/>
    <h3>
     <a id="_4__101">
     </a>
     <strong>
      ⚠️ 4. 升级过程中遇到的问题及解决方案
     </strong>
    </h3>
    <h4>
     <a id="_41_gnomeremotedesktop__103">
     </a>
     <strong>
      🛑 4.1
      <code>
       gnome-remote-desktop
      </code>
      安装失败
     </strong>
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/f650b3f879c04d0aba99bbff66ed174e.png"/>
    </p>
    <p>
     <strong>
      错误信息：
     </strong>
    </p>
    <pre><code>Failed to check if group gnome-remote-desktop already exists: Connection refused
</code></pre>
    <p>
     <strong>
      解决方案：
     </strong>
     <br/>
     系统升级成功以后，手动重新安装：
    </p>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token parameter variable">--reinstall</span> gnome-remote-desktop
</code></pre>
    <p>
     如果还是报错，那么手动创建用户组：
    </p>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">groupadd</span> <span class="token parameter variable">-r</span> gnome-remote-desktop
<span class="token function">sudo</span> <span class="token function">useradd</span> <span class="token parameter variable">-r</span> <span class="token parameter variable">-g</span> gnome-remote-desktop <span class="token parameter variable">-s</span> /usr/sbin/nologin gnome-remote-desktop
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token parameter variable">--reinstall</span> gnome-remote-desktop
</code></pre>
    <p>
     然后重启：
    </p>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">reboot</span>
</code></pre>
    <hr/>
    <h4>
     <a id="_42_fwupdconf__130">
     </a>
     <strong>
      🛑 4.2
      <code>
       fwupd.conf
      </code>
      配置文件冲突
     </strong>
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/eb159396aeaa4bc0b18c07fa6206b18d.png"/>
    </p>
    <p>
     <strong>
      错误信息：
     </strong>
    </p>
    <pre><code>The configuration file /etc/fwupd/fwupd.conf has changed.
Do you want to install the package maintainer’s version?
</code></pre>
    <p>
     <strong>
      解决方案：
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       如果不清楚该文件的用途，推荐选择 “D”，对比以后合并。
      </strong>
     </li>
     <li>
      <strong>
       如果对
       <code>
        fwupd.conf
       </code>
       做了定制（如固件更新策略），可以保留当前版本。
      </strong>
     </li>
    </ul>
    <hr/>
    <h4>
     <a id="_43_systemctl_restart_dbus__144">
     </a>
     <strong>
      🛑 4.3
      <code>
       systemctl restart dbus
      </code>
      造成黑屏
     </strong>
    </h4>
    <p>
     执行
     <code>
      sudo systemctl restart dbus
     </code>
     后，
     <strong>
      整个系统黑屏
     </strong>
     ，鼠标键盘失效。
    </p>
    <p>
     <strong>
      解决方案：
     </strong>
    </p>
    <ol>
     <li>
      <strong>
       切换到 TTY 终端（Ctrl + Alt + F3）
      </strong>
     </li>
     <li>
      重新启动
      <strong>
       GNOME 桌面
      </strong>
      <pre><code class="prism language-bash"><span class="token function">sudo</span> systemctl restart gdm
</code></pre>
     </li>
     <li>
      <strong>
       如果仍然黑屏，执行系统重启
      </strong>
      <pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">reboot</span>
</code></pre>
     </li>
    </ol>
    <hr/>
    <h3>
     <a id="_5__160">
     </a>
     <strong>
      🔍 5. 检查升级是否成功
     </strong>
    </h3>
    <h4>
     <a id="_51__Ubuntu__161">
     </a>
     <strong>
      ✅ 5.1 确认 Ubuntu 版本
     </strong>
    </h4>
    <pre><code class="prism language-bash">lsb_release <span class="token parameter variable">-a</span>
</code></pre>
    <p>
     <strong>
      正确输出示例：
     </strong>
    </p>
    <pre><code>Ubuntu 24.04 LTS
</code></pre>
    <h4>
     <a id="_52__170">
     </a>
     <strong>
      ✅ 5.2 检查内核版本
     </strong>
    </h4>
    <pre><code class="prism language-bash"><span class="token function">uname</span> <span class="token parameter variable">-r</span>
</code></pre>
    <p>
     <strong>
      示例输出：
     </strong>
    </p>
    <pre><code>6.8.0-55-generic
</code></pre>
    <h4>
     <a id="_53__179">
     </a>
     <strong>
      ✅ 5.3 检查系统服务是否正常
     </strong>
    </h4>
    <pre><code class="prism language-bash">systemctl <span class="token parameter variable">--failed</span>
</code></pre>
    <p>
     如果输出：
    </p>
    <pre><code>0 loaded units listed.
</code></pre>
    <p>
     说明所有系统服务正常运行。
    </p>
    <hr/>
    <h3>
     <a id="_6__191">
     </a>
     <strong>
      🎯 6. 总结
     </strong>
    </h3>
    <h4>
     <a id="__192">
     </a>
     <strong>
      🔹 这次升级的重点
     </strong>
    </h4>
    <ol>
     <li>
      <strong>
       系统升级需要备份
      </strong>
      ，避免数据丢失。
     </li>
     <li>
      <strong>
       遇到
       <code>
        libc6
       </code>
       、
       <code>
        sshd_config
       </code>
       等配置文件冲突时，选择最适合自己的方式
      </strong>
      。
     </li>
     <li>
      <strong>
       升级完成后，检查 Ubuntu 版本、内核版本以及服务状态
      </strong>
      。
     </li>
    </ol>
    <h4>
     <a id="__197">
     </a>
     <strong>
      🔹 遇到的主要问题
     </strong>
    </h4>
    <p>
     ✅
     <strong>
      SSH 配置冲突
     </strong>
     → 选择保留或覆盖
     <br/>
     ✅
     <strong>
      系统服务需要重启
     </strong>
     → 选择
     <code>
      Yes
     </code>
     <br/>
     ✅
     <strong>
      <code>
       gnome-remote-desktop
      </code>
      组权限错误
     </strong>
     → 手动创建
    </p>
    <p>
     至此，Ubuntu 22.04 到 24.04 的升级顺利完成！🎉
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f35383634383839302f:61727469636c652f64657461696c732f313436313433383733" class_="artid" style="display:none">
 </p>
</div>


