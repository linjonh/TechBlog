---
layout: post
title: "Linuxhttps-协议"
date: 2025-03-15 10:52:51 +0800
description: "数据摘要基本原理是通过单向哈希函数对原始数据将那些数学运算，生成固定长度的字符串。无论输入数据多大，输出长度始终固定。数据摘要本身并不是用于加密的，其目的在于判断数据是否被篡改，只要数据发生了改变，再使用哈希函数进行运算得到的摘要也和原先的摘要不同。常见的算法：MD5，SHA 系统以及 CRC32。特点：按原始数据生成固定大小的字符串，因为使用哈希函数对原始数据进行加工，因此有可能出现哈希碰撞的可能（概率低）。除此之外，其具有唯一性、防篡改和不可逆的特点。"
keywords: "【Linux】https 协议"
categories: ['未分类']
tags: ['网络协议', 'Https', 'Http']
artid: "146111360"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146111360
    alt: "Linuxhttps-协议"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146111360
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146111360
cover: https://bing.ee123.net/img/rand?artid=146111360
image: https://bing.ee123.net/img/rand?artid=146111360
img: https://bing.ee123.net/img/rand?artid=146111360
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     【Linux】https 协议
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <hr id="hr-toc" name="tableOfContents"/>
    <p>
    </p>
    <h2 id="%E4%B8%80%E3%80%81https%20%E5%8D%8F%E8%AE%AE" name="%E4%B8%80%E3%80%81https%20%E5%8D%8F%E8%AE%AE">
     一、https 协议
    </h2>
    <p>
     <a href="https://blog.csdn.net/Sweet_0115/article/details/146050509?spm=1001.2014.3001.5502" title="【Linux】http 协议-CSDN博客">
      【Linux】http 协议-CSDN博客
     </a>
    </p>
    <p>
     上节我们提到 http协议 是不安全，因其是按照明文进行数据传输的，导致用户信息很容易在网络传输的过程中被窃取篡改。
    </p>
    <p>
     因此在实际情况中必须得考虑数据安全问题，https 协议就出现了。https 协议在 http协议 的基础上多了一个加密功能——SSL 协议。 https 协议保证了在网络传输过程中数据的安全，在传输层将数据向上交付时可以通过目的端口号区分 http 协议和 https 协议，具体通信过程于下文中讲述。
    </p>
    <h2 id="%E4%BA%8C%E3%80%81%E5%8A%A0%E5%AF%86%E5%92%8C%E8%A7%A3%E5%AF%86" name="%E4%BA%8C%E3%80%81%E5%8A%A0%E5%AF%86%E5%92%8C%E8%A7%A3%E5%AF%86">
     二、加密和解密
    </h2>
    <h3 id="%EF%BC%88%E4%B8%80%EF%BC%89%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86" name="%EF%BC%88%E4%B8%80%EF%BC%89%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86">
     （一）为什么需要加密与解密
    </h3>
    <p>
     上文我们提到，http 协议在网络传输中是明文进行传输的，很容易被窃取和篡改，因此需要对传输数据进行加密，防止在网络传输过程中用户信息被窃取。
    </p>
    <h3 id="%EF%BC%88%E4%BA%8C%EF%BC%89%E5%8A%A0%E5%AF%86%E5%92%8C%E8%A7%A3%E5%AF%86%E7%9A%84%E8%BF%87%E7%A8%8B" name="%EF%BC%88%E4%BA%8C%EF%BC%89%E5%8A%A0%E5%AF%86%E5%92%8C%E8%A7%A3%E5%AF%86%E7%9A%84%E8%BF%87%E7%A8%8B">
     （二）加密和解密的过程
    </h3>
    <p>
     加密解密不仅仅是为了使传输数据在网络中不以明文的形式进行传输，而还要是发送方和接收方能够了解传输数据的真实内容。
    </p>
    <p>
     <strong>
      加密就是将明文数据进行一系列转换形成密文，而解密则是将密文在进行一系列转换形成明文。
     </strong>
    </p>
    <p>
     <img alt="" height="303" src="https://i-blog.csdnimg.cn/direct/c46c2208b4564044945eb7716e42cc14.png" width="758"/>
    </p>
    <h3 id="%EF%BC%88%E4%BA%8C%EF%BC%89%E5%B8%B8%E8%A7%81%E7%9A%84%E5%8A%A0%E5%AF%86%E6%96%B9%E5%BC%8F" name="%EF%BC%88%E4%BA%8C%EF%BC%89%E5%B8%B8%E8%A7%81%E7%9A%84%E5%8A%A0%E5%AF%86%E6%96%B9%E5%BC%8F">
     （二）常见的加密方式
    </h3>
    <p>
     本文不具体讨论加密算法。
    </p>
    <h4 id="1%E3%80%81%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86" name="1%E3%80%81%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86">
     1、对称加密
    </h4>
    <p>
     <strong>
      对称加密即采用单密钥的加密方法，加密与解密使用同一个密钥，这种加密方法成为对称加密。
     </strong>
    </p>
    <blockquote>
     <ul>
      <li>
       常见的加密算法：AES、DES 和 3DES、Blowfish 或 IDEA系统。
      </li>
      <li>
       特点：
       <strong>
        其核心优势在于速度快
       </strong>
       ，适合处理大量数据，例如实时通信或大规模存储加密。
      </li>
     </ul>
    </blockquote>
    <p>
     例如在上图中按位异或也是简单的对称加密策略。
    </p>
    <h4 id="2%E3%80%81%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86" name="2%E3%80%81%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86">
     2、非对称加密
    </h4>
    <p>
     <strong>
      非对称加密即采用两个不同的密钥分别进行加密与解密，这两个密钥分别是公钥和私钥。
     </strong>
    </p>
    <blockquote>
     <ul>
      <li>
       常见的非对称加密算法：RSA、ECC 或 ECDSA。
      </li>
      <li>
       特点：解决密钥分发问题，
       <strong>
        安全性更高，但计算效率低
       </strong>
       。
      </li>
     </ul>
    </blockquote>
    <p>
     <strong>
      加密与解密过程：
     </strong>
    </p>
    <p>
     <strong>
      1）加密过程：发送方使用接收方的公钥对明文假面，生成密文。
     </strong>
    </p>
    <p>
     <strong>
      2）解密过程：接收方使用私钥解密密文，还原原始数据。
     </strong>
    </p>
    <p>
     <strong>
      即可以使用公钥加密和私密解密，又可以使用私密加密和公钥解密。
     </strong>
    </p>
    <p style="text-align:center">
     <img alt="" height="204" src="https://i-blog.csdnimg.cn/direct/5336eaa83223472c8dc50674e50c1074.png" width="502"/>
    </p>
    <h4 id="3%E3%80%81%E6%95%B0%E6%8D%AE%E6%91%98%E8%A6%81" name="3%E3%80%81%E6%95%B0%E6%8D%AE%E6%91%98%E8%A6%81">
     3、数据摘要
    </h4>
    <p>
     <strong>
      数据摘要基本原理是通过单向哈希函数对原始数据将那些数学运算，生成固定长度的字符串。无论输入数据多大，输出长度始终固定。
     </strong>
    </p>
    <p>
     <strong>
      数据摘要本身并不是用于加密的，其目的在于判断数据是否被篡改，只要数据发生了改变，再使用哈希函数进行运算得到的摘要也和原先的摘要不同。
     </strong>
    </p>
    <blockquote>
     <ul>
      <li>
       常见的算法：MD5，SHA 系统以及 CRC32。
      </li>
      <li>
       特点：按原始数据生成固定大小的字符串，因为使用哈希函数对原始数据进行加工，因此有可能出现哈希碰撞的可能（概率低）。除此之外，其具有唯一性、防篡改和不可逆的特点。
      </li>
     </ul>
    </blockquote>
    <p>
     数据摘要并不是加密解密的方法，其主要用于传输文件中检查文件是否被损坏、系统存储用户密码的摘要而非明文等应用场景。
    </p>
    <h4 id="4%E3%80%81%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D" name="4%E3%80%81%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D">
     4、数字签名
    </h4>
    <p>
     <strong>
      数字签名是基于数据摘要生成的，通过使用单向哈希函数对原始数据进行处理得到数据摘要，再使用非对称加密算法对数据摘要进行加密即可得到数字签名。
     </strong>
    </p>
    <h2 id="%E4%B8%89%E3%80%81https%20%E7%9A%84%E5%8A%A0%E5%AF%86%E6%96%B9%E5%BC%8F" name="%E4%B8%89%E3%80%81https%20%E7%9A%84%E5%8A%A0%E5%AF%86%E6%96%B9%E5%BC%8F">
     三、https 的加密方式
    </h2>
    <h3 id="%EF%BC%88%E4%B8%80%EF%BC%89%E5%8F%AA%E4%BD%BF%E7%94%A8%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95" name="%EF%BC%88%E4%B8%80%EF%BC%89%E5%8F%AA%E4%BD%BF%E7%94%A8%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95">
     （一）只使用对称加密算法
    </h3>
    <p>
     对称加密是是只使用一个密钥，一旦通信双方约定好同一个加密算法，即使只使用同一个加密算法也能完全满足需要。
    </p>
    <p style="text-align:center">
     <img alt="" height="215" src="https://i-blog.csdnimg.cn/direct/a76b5279ec7c41c5b0d1fe9fd2dcf6bf.png" width="498"/>
    </p>
    <p>
     这一方式看似没有问题，但如果再发送密钥的时候就被中间人（攻击者）截获了呢？如果这样的话，
     <strong>
      通信双方虽然对数据进行加密后再发送，而中间人也可以在通信双方约定密钥的时候获取密钥，此后也通过获取到的密钥对传输数据进行加密和解密，因此数据传输对中间人而言实际相当于明文传输，对称加密并没有起到任何作用。
     </strong>
    </p>
    <h3 id="%EF%BC%88%E4%BA%8C%EF%BC%89%E5%8F%AA%E4%BD%BF%E7%94%A8%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95" name="%EF%BC%88%E4%BA%8C%EF%BC%89%E5%8F%AA%E4%BD%BF%E7%94%A8%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95">
     （二）只使用非对称加密算法
    </h3>
    <p>
     使用非对称加密算法也会面临相同的困境，如果在约定公钥私钥时中间人通过劫持 https 请求也可以获取到公钥，用户的信息也会被泄漏甚至篡改。
    </p>
    <p>
     <img alt="" height="515" src="https://i-blog.csdnimg.cn/direct/56b93a7be8494568b30f89dc74d07d73.png" width="1298"/>
    </p>
    <p>
     所以只使用非对称加密算法无法解决在通信开始时被中间人窃取公钥的情况。
    </p>
    <h3 id="%EF%BC%88%E4%B8%89%EF%BC%89%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%2B%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86" name="%EF%BC%88%E4%B8%89%EF%BC%89%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%2B%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86">
     （三）对称加密+非对称加密
    </h3>
    <p>
     <strong>
      即使使用对称加密+非对称加密也无法解决上述情况
     </strong>
     ，但在这里提到是因为二者的特性。
    </p>
    <p>
     从上文可知，对称加密的特点是计算快，但安全性低，而非对称加密的特点是安全性更高，但是计算复杂效率慢，因此可以二者结合使用。
    </p>
    <p>
     <img alt="" height="536" src="https://i-blog.csdnimg.cn/direct/8de9993697a1470fae8012e5aedd1775.png" width="1299"/>
    </p>
    <p>
     但非对称加密+对称加密依然不能解决通信安全问题。
    </p>
    <h3 id="%EF%BC%88%E5%9B%9B%EF%BC%89%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6%E7%9A%84%E5%BC%95%E5%85%A5" name="%EF%BC%88%E5%9B%9B%EF%BC%89%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6%E7%9A%84%E5%BC%95%E5%85%A5">
     （四）数字证书的引入
    </h3>
    <p>
     <strong>
      数字证书（Digital Certificate）是一种由权威机构颁发的电子凭证，用于在网络环境中验证通信实体的身份并保障数据传输安全
     </strong>
    </p>
    <p>
     服务器在使用 https 前，需要向CA机构申领⼀份数字证书，数字证书⾥含有证书申请者信息、公钥信息等。客户端向服务器请求公钥时，服务器把证书传输给浏览器，浏览器从证书里获取公钥就行了，证书就如⾝份证，是服务端公钥的身份证明。
    </p>
    <p>
     <img alt="" height="562" src="https://i-blog.csdnimg.cn/direct/9e5324935e274c8d9d491cde88f20a8f.png" width="782"/>
    </p>
    <p>
     当服务端申请向CA机构申请证书时，CA机构会该服务端进行审核，若通过后会为该网站形成数据签名：
    </p>
    <p>
     1、CA机构拥有
     <strong>
      非对称加密的公钥A（公开）和私钥A'
     </strong>
     ；
    </p>
    <p>
     2、CA机构会对服务端的申请认证信息
     <strong>
      使用哈希算法（公开）形成数据摘要
     </strong>
     ；
    </p>
    <p>
     3、对数据摘要使用私钥A'进行加密得到
     <strong>
      数字签名S
     </strong>
     ；
    </p>
    <p>
     4、将服务端的
     <strong>
      证书明文
     </strong>
     和
     <strong>
      数字签名S
     </strong>
     共同组成
     <strong>
      数字证书
     </strong>
     ，将其发送给服务端。
    </p>
    <h3 id="%EF%BC%88%E4%BA%94%EF%BC%89%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%2B%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%2B%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6" name="%EF%BC%88%E4%BA%94%EF%BC%89%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%2B%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%2B%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6">
     （五）非对称加密+对称加密+数字证书
    </h3>
    <p>
     <strong>
      在服务器和客户端建立连接时，服务器将数字证书发送给客户端，而客户端验证证书后就可以通过证书里的公钥对自身的对称加密的密钥进行加密后发送给服务器，当服务器接收后再使用私钥对传输数据进行解密后获取对称加密的密钥，之后通信双方就通过对称加密的密钥进行数据通信。
     </strong>
    </p>
    <p>
     <img alt="" height="537" src="https://i-blog.csdnimg.cn/direct/fcd9d670a93e45d791b9ce50014d0566.png" width="1319"/>
    </p>
    <p>
     那为什么这种方式能够解决数据传输的安全性问题呢？中间人在开始阶段不也是能接收到数据证书吗？
    </p>
    <p>
     针对以上问题我们简单说明下客户端如何验证证书，
     <strong>
      数字证书 = 数字证书明文 + 数字签名
     </strong>
     。
     <strong>
      当客户端接收到数字证书后，首先会使用哈希函数（公开）对数字证明明文进行加工形成数据摘要A，再使用CA机构公开的公钥对数字签名进行解密得到数据摘要B，之后对比数据摘要A和数据摘要B是否相同即可验证该证书是否有效（是否被修改或掉包），除此之外，还需要验证证书的有效期、域名匹配等等。
     </strong>
    </p>
    <p>
     因此即使数据证书被中间人窃取，中间人也无法做出任何行为：
    </p>
    <p>
     1、如果中间人劫持到了数字证书，对其内容进行修改后发送给客户端，客户端通过以上验证即可发现证书被修改过并将其丢弃；
    </p>
    <p>
     2、如果中间人劫持到了数字证书，对其内容进行掉包后发送给客户端，客户端通过以上验证即可发现证书被修改过并将其丢弃；
    </p>
    <p>
     因此无论中间人如何做，都无法对通信过程造成实质性的影响。因为
     <strong>
      中间人并不是知道CA机构的私钥
     </strong>
     ，因此无法生成有效的证书，即无法通过证书明文形成符合的数据摘要。即使中间人真的使用有效的证书进行替换，因为CA证书的申请是需要经过CA机构认证审核，且替换后的证书包含了域名项，而这也会暴露中间人的真实信息。
    </p>
    <p>
     <strong>
      随着社会科技的发展，实际中的证书并不是单单只有以上内容，其还涉及到了信任链、有效期、域名匹配等多维度检查，忽略任意环节都会导致安全认证失败，本文只做简单的介绍。
     </strong>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f53776565745f303131352f:61727469636c652f64657461696c732f313436313131333630" class_="artid" style="display:none">
 </p>
</div>


