---
layout: post
title: Javaæ“ä½œWordæ–‡æ¡£
date: 2025-01-09 16:41:12 +0800
categories: ['å¼€å‘è¯­è¨€']
tags: ['å¼€å‘è¯­è¨€', 'åç«¯', 'Java']
image:
    path: https://img-blog.csdnimg.cn/img_convert/fc34657b710de4122c79b0942d8db889.png?x-oss-process=image/resize,m_fixed,h_150
    alt: Javaæ“ä½œWordæ–‡æ¡£
artid: 121240987
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=121240987
featuredImagePreview: https://bing.ee123.net/img/rand?artid=121240987
---
<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Javaæ“ä½œWordæ–‡æ¡£
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <hr/>
    <p>
     title: Javaæ“ä½œWordæ–‡æ¡£
     <br/>
     description: ä½¿ç”¨ Spire.Doc for Javaæ“ä½œWordæ–‡æ¡£ï¼›æ›¿æ¢Wordæ¨¡æ¿ä¸­çš„å ä½ç¬¦ï¼Œç„¶åç”Ÿæˆæ–°çš„Wordæ–‡æ¡£
     <br/>
     tags: [å·¥å…·]
     <br/>
     categories:
    </p>
    <ul>
     <li>
      å…¶ä»–
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="Java__Word__10">
     </a>
     Java ç”Ÿæˆ Word çš„å‡ ç§æ–¹æ¡ˆ
    </h3>
    <blockquote>
     <p>
      <a href="http://blog.sina.com.cn/s/blog_a5e968370101crtl.html" rel="nofollow">
       å‚è€ƒ
      </a>
     </p>
    </blockquote>
    <p>
     â€‹ ä¸»è¦æœ‰è¿™ä¹ˆä¸€äº›å·¥å…·å¯ä»¥ä½¿ç”¨ Jacobã€Apache POIã€Java2wordã€iTextï¼Œè¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨XMLä½œä¸ºæ¨¡æ¿ã€‚
    </p>
    <p>
     â€‹ ä½¿ç”¨ XML çš„æ€è·¯ï¼šå…ˆç”¨ office ç¼–è¾‘å¥½wordçš„æ ·å¼ï¼Œç„¶åå¦å­˜ä¸ºxmlï¼Œå°†xmlç¿»è¯‘ä¸ºFreeMarkeræ¨¡æ¿ï¼Œæœ€åç”¨javaæ¥è§£æ FreeMarkeræ¨¡æ¿ å¹¶è¾“å‡º Word æ–‡æ¡£ã€‚ç»æµ‹è¯•è¿™æ ·æ–¹å¼ç”Ÿæˆçš„wordæ–‡æ¡£å®Œå…¨ç¬¦åˆ office æ ‡å‡†ï¼Œæ ·å¼ã€å†…å®¹æ§åˆ¶éå¸¸ä¾¿åˆ©ï¼Œæ‰“å°ä¹Ÿä¸ä¼šå˜å½¢ï¼Œç”Ÿæˆçš„æ–‡æ¡£å’Œofficeä¸­ç¼–è¾‘æ–‡æ¡£å®Œå…¨ä¸€æ ·ã€‚ ===&gt;
     <a href="https://www.cnblogs.com/hongzm/p/11266805.html" rel="nofollow">
      å‚è€ƒ
     </a>
    </p>
    <p>
     <img alt="image-20211021162828629" src="https://i-blog.csdnimg.cn/blog_migrate/64462d489e25d0444e36d53f8f5aef2f.png"/>
    </p>
    <ul>
     <li>
      Jacob å’Œ Java2wordéœ€è¦æœåŠ¡å™¨ç«¯æ”¯æŒ officeï¼Œç›¸å¯¹éº»çƒ¦ã€‚
     </li>
     <li>
      Apache POI åŠŸèƒ½è¾ƒå°‘ã€‚===&gt;
      <a href="http://deepoove.com/poi-tl/apache-poi-guide.html" rel="nofollow">
       å‚è€ƒ
      </a>
     </li>
    </ul>
    <p>
     â€‹ è¿™é‡Œæ¨èä¸€ä¸ªåˆšåˆšå‘ç°çš„äº§å“ï¼Œç”±æˆéƒ½å†°è“ç§‘æŠ€å¼€å‘çš„äº§å“ Spireï¼Œå¯ä»¥ç”¨äºæ“ä½œå„ç§æ–‡æ¡£ï¼Œç›®å‰æˆ‘åªä½“éªŒè¿‡ Spire.Doc for Javaï¼Œä¸ªäººè®¤ä¸ºä½¿ç”¨ç®€å•ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œå¯¹æ ·å¼çš„æ”¯æŒéå¸¸å¥½ï¼ˆè™½ç„¶Spireä¸»è¦é¢å‘ä¼ä¸šæä¾›äº§å“ï¼Œä½†æ˜¯ä¹Ÿæä¾›äº†å…è´¹ä½¿ç”¨çš„äº§å“ï¼‰ã€‚æœ€å¤§çš„ç¼ºç‚¹æ˜¯ï¼Œå…è´¹ç‰ˆï¼Œæ²¡æœ‰ Api æ–‡æ¡£ä¸”JaråŒ…ä¸èƒ½å®Œç¾åç¼–è¯‘ï¼Œåªæœ‰ä½¿ç”¨æ–‡æ¡£ï¼Œæœ‰äº›ä»£ç åªèƒ½ä¾é åç§°æ¨æ–­ä½œç”¨ï¼Œæ‰€ä»¥å¾ˆéš¾æ·±å…¥çš„æŒ–æ˜ Spire çš„ç”¨æ³•ã€‚
    </p>
    <h3>
     <a id="_SpireDoc__Word__27">
     </a>
     ä½¿ç”¨ Spire.Doc æ›¿æ¢ Word æ¨¡æ¿ä¸­å ä½ç¬¦
    </h3>
    <p>
     è¿™é‡Œä½¿ç”¨ Maven ä¸‹è½½ Spire.Doc ä¹Ÿå¯ä»¥ç›´æ¥
     <a href="https://repo.e-iceblue.cn/repository/maven-public/e-iceblue/spire.doc.free/3.9.0/spire.doc.free-3.9.0.jar" rel="nofollow">
      ä¸‹è½½ jar åŒ…
     </a>
     ==&gt;
     <a href="https://repo.e-iceblue.cn/#browse/browse:maven-public:e-iceblue%2Fspire.doc.free%2F3.9.0%2Fspire.doc.free-3.9.0.jar" rel="nofollow">
      å‚è€ƒ
     </a>
    </p>
    <p>
     1ï¸âƒ£ï¼šé¦–å…ˆå¼•å…¥ Maven ä¾èµ–
    </p>
    <p>
     â€‹ åœ¨ Maven çš„å®˜æ–¹ä»“åº“æˆ–è€…é˜¿é‡Œäº‘é•œåƒä»“åº“ä¸­æ˜¯æ²¡æœ‰ Spire ä¾èµ–çš„ï¼Œæ‰€ä»¥éœ€è¦é…ç½® Spire è‡ªå·±çš„ä¸€ä¸ªä»“åº“æºã€‚
    </p>
    <pre><code class="prism language-pom">&lt;repositories&gt;
	&lt;repository&gt;
        &lt;id&gt;com.e-iceblue&lt;/id&gt;
        &lt;url&gt;https://repo.e-iceblue.cn/repository/maven-public/&lt;/url&gt;
	&lt;/repository&gt;
&lt;/repositories&gt;
</code></pre>
    <p>
     â€‹ ä»¥ä¸‹å°±æ˜¯ Spire.Doc for Java çš„ä¾èµ–
    </p>
    <pre><code class="prism language-xml"><span class="token comment">&lt;!--spire.doc æ“ä½œwordæ–‡æ¡£--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>e-iceblue<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spire.doc.free<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.9.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <p>
     2ï¸âƒ£ï¼šè®¾è®¡ä¸€ä¸ªWordæ¨¡æ¿ï¼Œæ­¤æ–‡æ¡£ä¸­å­˜åœ¨å ä½ç¬¦
    </p>
    <img alt="image-20211021172656642" src="https://i-blog.csdnimg.cn/blog_migrate/8e47df6ee4580d32941d74283358feeb.png">
     <p>
      3ï¸âƒ£ï¼šç¼–ç 
     </p>
     <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestSpireWord</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">generateAndReplaceText</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Document</span> doc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Document</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        doc<span class="token punctuation">.</span><span class="token function">loadFromFile</span><span class="token punctuation">(</span><span class="token string">"F:\\yourlocation\\template.docx"</span><span class="token punctuation">,</span> <span class="token class-name">FileFormat<span class="token punctuation">.</span>Docx</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"${name}"</span><span class="token punctuation">,</span> <span class="token string">"å¼ å±±"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"${birthday}"</span><span class="token punctuation">,</span> <span class="token string">"2021-10-18"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"${result}"</span><span class="token punctuation">,</span> <span class="token string">"æˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"${col}"</span><span class="token punctuation">,</span> <span class="token string">"ç¬¬ä¸€åˆ—"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"${col1}"</span><span class="token punctuation">,</span> <span class="token string">"ç¬¬äºŒåˆ—"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"${col2}"</span><span class="token punctuation">,</span> <span class="token string">"ç¬¬ä¸‰åˆ—"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">replaceSpecialWord</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> map<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ä¿å­˜ä¸ºæ–‡ä»¶</span>
        doc<span class="token punctuation">.</span><span class="token function">saveToFile</span><span class="token punctuation">(</span><span class="token string">"F:\\yourlocation\\result.docx"</span><span class="token punctuation">,</span><span class="token class-name">FileFormat<span class="token punctuation">.</span>Docx</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æˆ–è€…ä¿å­˜è‡³è¾“å‡ºæµä¸­</span>
        <span class="token comment">//ByteArrayOutputStream os = new ByteArrayOutputStream();</span>
        <span class="token comment">//doc.saveToStream(os, FileFormat.Docx);</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * æ›¿æ¢Wordæ–‡ä»¶ä¸­ ${} æ ‡è¯†çš„ç‰¹æ®Šå­—ç¬¦
     * &lt;br&gt;
     * &lt;strong&gt;æ³¨æ„ï¼šå¦‚æœå­˜åœ¨éƒ¨åˆ†ç‰¹æ®Šè¡¨ç¤ºæ— æ³•æ›¿æ¢ï¼Œè¯·å°è¯•å°† ${} çš„æ•´ä¸ªå­—ç¬¦ä¸²å¤åˆ¶åˆ°wordä¸­ï¼Œæœ‰å¯èƒ½wordæ²¡æœ‰å°†${}è¯†åˆ«ä¸ºä¸€ä¸ªæ•´ä½“&lt;/strong&gt;
     * @param doc: Sprire Document
     * @param map: å ä½ç¬¦${} ä¸ éœ€è¦æ›¿æ¢çš„ä¸ºå­—ç¬¦ä¸²çš„å¯¹åº”å…³ç³»
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">replaceSpecialWord</span><span class="token punctuation">(</span><span class="token class-name">Document</span> doc<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> map<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// æ­£åˆ™è¡¨è¾¾å¼ï¼ŒåŒ¹é…æ‰€æœ‰çš„å ä½ç¬¦ ${}</span>
        <span class="token class-name">Pattern</span> pattern <span class="token operator">=</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token string">"\\$\\{.*?}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æ ¹æ®æ­£åˆ™è¡¨è¾¾å¼è·å–æ‰€æœ‰æ–‡æœ¬</span>
        <span class="token class-name">TextSelection</span><span class="token punctuation">[</span><span class="token punctuation">]</span> allPattern <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">findAllPattern</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// é€ä¸ªæ›¿æ¢å ä½ç¬¦</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">TextSelection</span> textSelection <span class="token operator">:</span> allPattern<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">String</span> tmp <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>textSelection<span class="token punctuation">.</span><span class="token function">getSelectedText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>textSelection<span class="token punctuation">.</span><span class="token function">getSelectedText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> res <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>textSelection<span class="token punctuation">.</span><span class="token function">getSelectedText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tmp<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">": "</span> <span class="token operator">+</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
     <p>
      æœ€ç»ˆç»“æœï¼š
     </p>
     <pre><code class="prism language-java"><span class="token comment">// æ§åˆ¶å°è¾“å‡º</span>
$<span class="token punctuation">{<!-- --></span>name<span class="token punctuation">}</span><span class="token operator">:</span> <span class="token number">1</span>
$<span class="token punctuation">{<!-- --></span>birthday<span class="token punctuation">}</span><span class="token operator">:</span> <span class="token number">1</span>
$<span class="token punctuation">{<!-- --></span>result<span class="token punctuation">}</span><span class="token operator">:</span> <span class="token number">1</span>
$<span class="token punctuation">{<!-- --></span>col<span class="token punctuation">}</span><span class="token operator">:</span> <span class="token number">1</span>
$<span class="token punctuation">{<!-- --></span>col1<span class="token punctuation">}</span><span class="token operator">:</span> <span class="token number">1</span>
$<span class="token punctuation">{<!-- --></span>col2<span class="token punctuation">}</span><span class="token operator">:</span> <span class="token number">1</span>
</code></pre>
     <img alt="image-20211021173346574" src="https://i-blog.csdnimg.cn/blog_migrate/e78fabc145f294e17cced182c5e08961.png">
      <p>
       â€‹ å¯ä»¥çœ‹åˆ°ä½¿ç”¨ Spire.Doc for Java æ›¿æ¢å ä½ç¬¦ååˆ†ç®€å•ï¼Œå¹¶ä¸”ä¸ä¼šç ´åæ¨¡æ¿çš„åŸæœ‰æ · å¼ã€‚
      </p>
      <p>
       â€‹ å¦‚æœéœ€è¦äº†è§£ Spire.Doc for Java çš„æ›´å¤šæ“ä½œï¼Œå‚è€ƒ ===&gt;
       <a href="https://www.e-iceblue.cn/spiredocforjava/spire-doc-for-java-program-guide-content.html" rel="nofollow">
        å®˜æ–¹æ–‡æ¡£
       </a>
      </p>
      <h3>
       <a id="SpireDoc_Word_133">
       </a>
       ä½¿ç”¨Spire.Doc å°†Wordæ–‡æ¡£ä¸­å ä½ç¬¦æ›¿æ¢ä¸ºå›¾ç‰‡
      </h3>
      <p>
       1ï¸âƒ£ï¼šç¼–å†™ä¸€ä¸ªæµ‹è¯•æ–‡æ¡£
      </p>
      <img alt="image-20211023191349321" src="https://i-blog.csdnimg.cn/blog_migrate/9251c3d3082ab1714bdd0fbd45b2fd1f.png">
       <p>
        2ï¸âƒ£ï¼šäº†è§£Sprie.Doc æ˜¯å¦‚ä½•æ’å…¥ä¸€å¼ å›¾ç‰‡
       </p>
       <blockquote>
        <p>
         <a href="https://www.e-iceblue.cn/docforjava/insert-image-into-word-document-in-java.html" rel="nofollow">
          å‚è€ƒâ€”å®˜æ–¹æ–‡æ¡£
         </a>
        </p>
       </blockquote>
       <p>
        Spire.Doc for Javaä¸­çš„ Paragraphç±» æä¾›äº†appendPicture ()æ–¹æ³•ç”¨äºç»™Wordæ®µè½æ·»åŠ å›¾ç‰‡ã€‚
       </p>
       <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InsertImage</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">//åˆ›å»ºDocumentå¯¹è±¡</span>
        <span class="token class-name">Document</span> doc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Document</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ·»åŠ èŠ‚</span>
        <span class="token class-name">Section</span> section <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">addSection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//æ·»åŠ ç¬¬ä¸€ä¸ªæ®µè½</span>
        <span class="token class-name">Paragraph</span> paragraph <span class="token operator">=</span> section<span class="token punctuation">.</span><span class="token function">addParagraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ·»åŠ å›¾ç‰‡åˆ°æ®µè½</span>
        <span class="token class-name">DocPicture</span> picture <span class="token operator">=</span> paragraph<span class="token punctuation">.</span><span class="token function">appendPicture</span><span class="token punctuation">(</span><span class="token string">"C:\\Users\\Administrator\\Desktop\\Hydrangeas.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è®¾ç½®å›¾ç‰‡å®½åº¦</span>
        picture<span class="token punctuation">.</span><span class="token function">setWidth</span><span class="token punctuation">(</span><span class="token number">300f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è®¾ç½®å›¾ç‰‡é«˜åº¦</span>
        picture<span class="token punctuation">.</span><span class="token function">setHeight</span><span class="token punctuation">(</span><span class="token number">250f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//ç»™æ®µè½è®¾ç½®æ°´å¹³å±…ä¸­å¯¹é½æ–¹å¼</span>
        paragraph<span class="token punctuation">.</span><span class="token function">getFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setHorizontalAlignment</span><span class="token punctuation">(</span><span class="token class-name">HorizontalAlignment<span class="token punctuation">.</span>Center</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//ä¿å­˜</span>
        doc<span class="token punctuation">.</span><span class="token function">saveToFile</span><span class="token punctuation">(</span><span class="token string">"InsertImage.docx"</span><span class="token punctuation">,</span> <span class="token class-name">FileFormat<span class="token punctuation">.</span>Docx_2013</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
       <p>
        ç¬¬äºŒç§æ–¹å¼ï¼š ===&gt;
        <a href="https://www.evget.com/article/2019/6/18/30761.html" rel="nofollow">
         å‚è€ƒ
        </a>
       </p>
       <p>
        â€‹ é€šè¿‡è·å– Spire.Doc ä¸­çš„ TextRange å¯¹è±¡ï¼Œå¯ä»¥ç”¨è¿™ä¸ªå¯¹è±¡æ’å…¥å›¾ç‰‡ã€‚
       </p>
       <pre><code class="prism language-java"><span class="token class-name">Document</span> doc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Document</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
doc<span class="token punctuation">.</span><span class="token function">loadFromFile</span><span class="token punctuation">(</span><span class="token string">"F:\\yourlocation\\template.docx"</span><span class="token punctuation">,</span> <span class="token class-name">FileFormat<span class="token punctuation">.</span>Docx</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// æˆ–è€…å¯ä»¥åŠ è½½æµloadFromStream(.,.)</span>
<span class="token comment">// 0. ä½¿ç”¨ Spire.Doc çš„ DocPictureç±» åŠ è½½ä¸€å¼ å›¾ç‰‡ï¼Œå¹¶ä¸”å¯ä»¥è®¾ç½®å›¾ç‰‡çš„å®½é«˜</span>
<span class="token class-name">DocPicture</span> pic <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DocPicture</span><span class="token punctuation">(</span>doc<span class="token punctuation">)</span><span class="token punctuation">;</span>
pic<span class="token punctuation">.</span><span class="token function">loadImage</span><span class="token punctuation">(</span>imgList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 1. è·å– TextSelection</span>
<span class="token class-name">TextSelection</span> selection <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">findString</span><span class="token punctuation">(</span><span class="token string">"matchString"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯éœ€è¦çš„åŒ¹é…å­—ç¬¦ä¸²å³å ä½ç¬¦ï¼Œåé¢ä¸¤ä¸ªå‚æ•°çš„æ„æ€ä¸ºï¼šæ˜¯å¦å¤§å°å†™æ•æ„Ÿã€æ˜¯å¦åŒ¹é…æ•´ä¸ªå•è¯</span>
<span class="token comment">// 2. æ ¹æ® selection è·å– TextRange</span>
<span class="token class-name">TextRange</span> range <span class="token operator">=</span> selection<span class="token punctuation">.</span><span class="token function">getAsOneRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 3. é€šè¿‡ TextRange æ‰¾åˆ° å ä½ç¬¦åœ¨ä¸€ä¸ªæ®µè½ä¸­çš„ä½ç½®</span>
<span class="token keyword">int</span> index <span class="token operator">=</span> range<span class="token punctuation">.</span><span class="token function">getOwnerParagraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getChildObjects</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>range<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 4. é€šè¿‡è·å–åˆ°çš„ index ä½ç½®ï¼Œæ’å…¥ä¸€å¼ å›¾ç‰‡</span>
range<span class="token punctuation">.</span><span class="token function">getOwnerParagraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getChildObjects</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> pic<span class="token punctuation">)</span><span class="token punctuation">;</span>
range<span class="token punctuation">.</span><span class="token function">getOwnerParagraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getChildObjects</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>range<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// è¿™ä¸ªremove æ“ä½œå…·ä½“ä½œç”¨ä¸å¤ªæ¸…æ¥šï¼Œä½†æ˜¯æ²¡æœ‰è¿™ä¸€æ­¥å›¾ç‰‡æ˜¯æ— æ³•æ­£ç¡®æ’å…¥çš„</span>
</code></pre>
       <p>
        3ï¸âƒ£ï¼šå¼€å§‹ç¼–ç â€‹
       </p>
       <pre><code class="prism language-java"><span class="token comment">// æµ‹è¯•æ–¹æ³•</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">imageTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Document</span> doc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Document</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        doc<span class="token punctuation">.</span><span class="token function">loadFromFile</span><span class="token punctuation">(</span><span class="token string">"F:\\yourlocation\\template.docx"</span><span class="token punctuation">,</span> <span class="token class-name">FileFormat<span class="token punctuation">.</span>Docx</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"F:\\yourlocation\\orange.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">File</span> file1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"F:\\yourlocation\\orange.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">InputStream</span> in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">InputStream</span> in1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>file1<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">InputStream</span><span class="token punctuation">&gt;</span></span> imgList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            imgList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>
            imgList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>in1<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> matchString <span class="token operator">=</span> <span class="token string">"${images}"</span><span class="token punctuation">;</span>
            <span class="token function">replaceTextToImage</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> matchString<span class="token punctuation">,</span> imgList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">FileNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        doc<span class="token punctuation">.</span><span class="token function">saveToFile</span><span class="token punctuation">(</span><span class="token string">"F:\\yourlocation\\result.docx"</span><span class="token punctuation">,</span><span class="token class-name">FileFormat<span class="token punctuation">.</span>Docx</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token comment">/**
     * æ›¿æ¢Wordæ–‡æ¡£ä¸­çš„åŒä¸€å ä½ç¬¦ï¼Œä¸ºå¤šå¼ ä¸åŒçš„å›¾ç‰‡ï¼Œæ¯ä¸€ä¸ªå ä½ç¬¦å¯¹åº”ä¸€å¼ å›¾ç‰‡ï¼Œ
     * å¦‚æœå ä½ç¬¦æ¯”å›¾ç‰‡æ•°é‡å¤šåˆ™è¯¥å ä½ç¬¦ä¼šè¢«å†™ä¸ºç©ºå­—ç¬¦ä¸²
     * @param doc: Spire Document
     * @param matchString: å ä½ç¬¦
     * @param imgList: å›¾ç‰‡è¾“å…¥æµé›†åˆ
     * @date 2021/10/22 20:09
     */</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">replaceTextToImage</span><span class="token punctuation">(</span><span class="token class-name">Document</span> doc<span class="token punctuation">,</span> <span class="token class-name">String</span> matchString<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">InputStream</span><span class="token punctuation">&gt;</span></span> imgList<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">TextSelection</span><span class="token punctuation">[</span><span class="token punctuation">]</span> selections <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">findAllString</span><span class="token punctuation">(</span>matchString<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> total <span class="token operator">=</span> imgList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">TextSelection</span> selection <span class="token operator">:</span> selections<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&lt;</span> total <span class="token operator">&amp;&amp;</span> imgList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">DocPicture</span> pic <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DocPicture</span><span class="token punctuation">(</span>doc<span class="token punctuation">)</span><span class="token punctuation">;</span>
            pic<span class="token punctuation">.</span><span class="token function">loadImage</span><span class="token punctuation">(</span>imgList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            pic<span class="token punctuation">.</span><span class="token function">setWidth</span><span class="token punctuation">(</span><span class="token number">100f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// è®¾ç½®å›¾ç‰‡å®½é«˜</span>
            pic<span class="token punctuation">.</span><span class="token function">setHeight</span><span class="token punctuation">(</span><span class="token number">100f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">TextRange</span> range <span class="token operator">=</span> selection<span class="token punctuation">.</span><span class="token function">getAsOneRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> index <span class="token operator">=</span> range<span class="token punctuation">.</span><span class="token function">getOwnerParagraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getChildObjects</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>range<span class="token punctuation">)</span><span class="token punctuation">;</span>
            range<span class="token punctuation">.</span><span class="token function">getOwnerParagraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getChildObjects</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> pic<span class="token punctuation">)</span><span class="token punctuation">;</span>
            range<span class="token punctuation">.</span><span class="token function">getOwnerParagraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getChildObjects</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>range<span class="token punctuation">)</span><span class="token punctuation">;</span>
            count<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// å¦‚æœå·²è¿‘æ²¡æœ‰äº†å›¾ç‰‡åˆ™å°†æ‰€æœ‰å ä½ç¬¦æ›¿æ¢ä¸ºç©º</span>
            doc<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>selection<span class="token punctuation">.</span><span class="token function">getSelectedText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>



	<span class="token comment">/**
     * æŒ‰ç…§æ¨ªçºµæ¯”ç¼©æ”¾å›¾ç‰‡
     * @param pic: Spire å›¾ç‰‡å¯¹è±¡
     * @param rate: ç¼©æ”¾æ¯”ä¾‹ 0.1&lt;= rate &lt;=10ï¼Œ
     * @author He Peng
     * @date 2021/10/23 9:28
     */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">zoomImage</span><span class="token punctuation">(</span><span class="token class-name">DocPicture</span> pic<span class="token punctuation">,</span> <span class="token keyword">float</span> rate<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>rate <span class="token operator">&lt;</span> <span class="token number">0.1</span> <span class="token operator">||</span> rate <span class="token operator">&gt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"ç¼©æ”¾æ¯”ä¾‹å‚æ•°çš„æ•°å€¼èŒƒå›´ä¸ºï¼š0.1&lt;= rate &lt;=10ï¼Œä¸èƒ½è¶…è¿‡æ­¤èŒƒå›´"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">float</span> originalWidth <span class="token operator">=</span> pic<span class="token punctuation">.</span><span class="token function">getWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">float</span> originalHeight <span class="token operator">=</span> pic<span class="token punctuation">.</span><span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pic<span class="token punctuation">.</span><span class="token function">setWidth</span><span class="token punctuation">(</span>originalWidth <span class="token operator">*</span> rate<span class="token punctuation">)</span><span class="token punctuation">;</span>
    pic<span class="token punctuation">.</span><span class="token function">setHeight</span><span class="token punctuation">(</span>originalHeight <span class="token operator">*</span> rate<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre>
       <p>
        æœ€ç»ˆç»“æœï¼š
       </p>
       <img alt="image-20211023191231049" src="https://i-blog.csdnimg.cn/blog_migrate/a8db7b6ebb9d39296bc07322f2229f4a.png">
        <h3>
         <a id="blue_book__279">
         </a>
         ğŸ“˜ å‚è€ƒèµ„æ–™
        </h3>
        <p>
         <a href="https://orange-code.gitee.io/" rel="nofollow">
          ä¸ªäººåšå®¢åŒæ­¥å‘å¸ƒ
         </a>
        </p>
        <p>
         <a href="https://www.jianshu.com/p/6603b1ea3ad1" rel="nofollow">
          POIæ“ä½œwordæ¨¡æ¿å¹¶ç”Ÿæˆæ–°çš„wordâ€“jianshu
         </a>
         <br/>
         <a href="https://www.e-iceblue.cn/spiredocforjavaoperating/java-draw-checkbox-to-word-document.html" rel="nofollow">
          Spire.doc for Javaâ€”å®˜æ–¹æ–‡æ¡£
         </a>
         <br/>
         <a href="https://blog.csdn.net/weixin_45266979/article/details/118969799">
          Spire.Doc for Java èµ„æºâ€”csdn
         </a>
         <br/>
         <a href="https://www.e-iceblue.cn/licensing/install-spirepdf-for-java-from-maven-repository.html" rel="nofollow">
          é€šè¿‡ Maven ä»“åº“å®‰è£… Spire ç³»åˆ— Java äº§å“â€”å®˜æ–¹æ–‡æ¡£
         </a>
         <br/>
         <a href="https://www.evget.com/article/2019/6/18/30761.html" rel="nofollow">
          Spire.Doc ç³»åˆ—æ•™ç¨‹
         </a>
        </p>
       </img>
      </img>
     </img>
    </img>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
</div>


