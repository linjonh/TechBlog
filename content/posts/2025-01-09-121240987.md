---
layout: post
title: Javaæ“ä½œWordæ–‡æ¡£
date: 2025-01-09 16:41:12 +0800
categories: ['å¼€å‘è¯­è¨€']
tags: ['å¼€å‘è¯­è¨€', 'åç«¯', 'Java']
image:
    path: https://img-blog.csdnimg.cn/img_convert/fc34657b710de4122c79b0942d8db889.png?x-oss-process=image/resize,m_fixed,h_150
    alt: Javaæ“ä½œWordæ–‡æ¡£
artid: 121240987
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=121240987
featuredImagePreview: https://bing.ee123.net/img/rand?artid=121240987
---

# Javaæ“ä½œWordæ–‡æ¡£

---

title: Javaæ“ä½œWordæ–‡æ¡£
  
description: ä½¿ç”¨ Spire.Doc for Javaæ“ä½œWordæ–‡æ¡£ï¼›æ›¿æ¢Wordæ¨¡æ¿ä¸­çš„å ä½ç¬¦ï¼Œç„¶åç”Ÿæˆæ–°çš„Wordæ–‡æ¡£
  
tags: [å·¥å…·]
  
categories:

* å…¶ä»–

---

### Java ç”Ÿæˆ Word çš„å‡ ç§æ–¹æ¡ˆ

> [å‚è€ƒ](http://blog.sina.com.cn/s/blog_a5e968370101crtl.html)

â€‹ ä¸»è¦æœ‰è¿™ä¹ˆä¸€äº›å·¥å…·å¯ä»¥ä½¿ç”¨ Jacobã€Apache POIã€Java2wordã€iTextï¼Œè¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨XMLä½œä¸ºæ¨¡æ¿ã€‚

â€‹ ä½¿ç”¨ XML çš„æ€è·¯ï¼šå…ˆç”¨ office ç¼–è¾‘å¥½wordçš„æ ·å¼ï¼Œç„¶åå¦å­˜ä¸ºxmlï¼Œå°†xmlç¿»è¯‘ä¸ºFreeMarkeræ¨¡æ¿ï¼Œæœ€åç”¨javaæ¥è§£æ FreeMarkeræ¨¡æ¿ å¹¶è¾“å‡º Word æ–‡æ¡£ã€‚ç»æµ‹è¯•è¿™æ ·æ–¹å¼ç”Ÿæˆçš„wordæ–‡æ¡£å®Œå…¨ç¬¦åˆ office æ ‡å‡†ï¼Œæ ·å¼ã€å†…å®¹æ§åˆ¶éå¸¸ä¾¿åˆ©ï¼Œæ‰“å°ä¹Ÿä¸ä¼šå˜å½¢ï¼Œç”Ÿæˆçš„æ–‡æ¡£å’Œofficeä¸­ç¼–è¾‘æ–‡æ¡£å®Œå…¨ä¸€æ ·ã€‚ ===>
[å‚è€ƒ](https://www.cnblogs.com/hongzm/p/11266805.html)

![image-20211021162828629](https://i-blog.csdnimg.cn/blog_migrate/64462d489e25d0444e36d53f8f5aef2f.png)

* Jacob å’Œ Java2wordéœ€è¦æœåŠ¡å™¨ç«¯æ”¯æŒ officeï¼Œç›¸å¯¹éº»çƒ¦ã€‚
* Apache POI åŠŸèƒ½è¾ƒå°‘ã€‚===>
  [å‚è€ƒ](http://deepoove.com/poi-tl/apache-poi-guide.html)

â€‹ è¿™é‡Œæ¨èä¸€ä¸ªåˆšåˆšå‘ç°çš„äº§å“ï¼Œç”±æˆéƒ½å†°è“ç§‘æŠ€å¼€å‘çš„äº§å“ Spireï¼Œå¯ä»¥ç”¨äºæ“ä½œå„ç§æ–‡æ¡£ï¼Œç›®å‰æˆ‘åªä½“éªŒè¿‡ Spire.Doc for Javaï¼Œä¸ªäººè®¤ä¸ºä½¿ç”¨ç®€å•ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œå¯¹æ ·å¼çš„æ”¯æŒéå¸¸å¥½ï¼ˆè™½ç„¶Spireä¸»è¦é¢å‘ä¼ä¸šæä¾›äº§å“ï¼Œä½†æ˜¯ä¹Ÿæä¾›äº†å…è´¹ä½¿ç”¨çš„äº§å“ï¼‰ã€‚æœ€å¤§çš„ç¼ºç‚¹æ˜¯ï¼Œå…è´¹ç‰ˆï¼Œæ²¡æœ‰ Api æ–‡æ¡£ä¸”JaråŒ…ä¸èƒ½å®Œç¾åç¼–è¯‘ï¼Œåªæœ‰ä½¿ç”¨æ–‡æ¡£ï¼Œæœ‰äº›ä»£ç åªèƒ½ä¾é åç§°æ¨æ–­ä½œç”¨ï¼Œæ‰€ä»¥å¾ˆéš¾æ·±å…¥çš„æŒ–æ˜ Spire çš„ç”¨æ³•ã€‚

### ä½¿ç”¨ Spire.Doc æ›¿æ¢ Word æ¨¡æ¿ä¸­å ä½ç¬¦

è¿™é‡Œä½¿ç”¨ Maven ä¸‹è½½ Spire.Doc ä¹Ÿå¯ä»¥ç›´æ¥
[ä¸‹è½½ jar åŒ…](https://repo.e-iceblue.cn/repository/maven-public/e-iceblue/spire.doc.free/3.9.0/spire.doc.free-3.9.0.jar)
==>
[å‚è€ƒ](https://repo.e-iceblue.cn/#browse/browse:maven-public:e-iceblue%2Fspire.doc.free%2F3.9.0%2Fspire.doc.free-3.9.0.jar)

1ï¸âƒ£ï¼šé¦–å…ˆå¼•å…¥ Maven ä¾èµ–

â€‹ åœ¨ Maven çš„å®˜æ–¹ä»“åº“æˆ–è€…é˜¿é‡Œäº‘é•œåƒä»“åº“ä¸­æ˜¯æ²¡æœ‰ Spire ä¾èµ–çš„ï¼Œæ‰€ä»¥éœ€è¦é…ç½® Spire è‡ªå·±çš„ä¸€ä¸ªä»“åº“æºã€‚

```pom
<repositories>
	<repository>
        <id>com.e-iceblue</id>
        <url>https://repo.e-iceblue.cn/repository/maven-public/</url>
	</repository>
</repositories>

```

â€‹ ä»¥ä¸‹å°±æ˜¯ Spire.Doc for Java çš„ä¾èµ–

```xml
<!--spire.doc æ“ä½œwordæ–‡æ¡£-->
<dependency>
    <groupId>e-iceblue</groupId>
    <artifactId>spire.doc.free</artifactId>
    <version>3.9.0</version>
</dependency>

```

2ï¸âƒ£ï¼šè®¾è®¡ä¸€ä¸ªWordæ¨¡æ¿ï¼Œæ­¤æ–‡æ¡£ä¸­å­˜åœ¨å ä½ç¬¦

![image-20211021172656642](https://i-blog.csdnimg.cn/blog_migrate/8e47df6ee4580d32941d74283358feeb.png)

3ï¸âƒ£ï¼šç¼–ç 

```java
public class TestSpireWord {

    @Test
    public void generateAndReplaceText() {
        Document doc = new Document();
        doc.loadFromFile("F:\\yourlocation\\template.docx", FileFormat.Docx);

        Map<String, String> map = new HashMap<>();
        map.put("${name}", "å¼ å±±");
        map.put("${birthday}", "2021-10-18");
        map.put("${result}", "æˆåŠŸ");
        map.put("${col}", "ç¬¬ä¸€åˆ—");
        map.put("${col1}", "ç¬¬äºŒåˆ—");
        map.put("${col2}", "ç¬¬ä¸‰åˆ—");
        replaceSpecialWord(doc, map);
        // ä¿å­˜ä¸ºæ–‡ä»¶
        doc.saveToFile("F:\\yourlocation\\result.docx",FileFormat.Docx);
        // æˆ–è€…ä¿å­˜è‡³è¾“å‡ºæµä¸­
        //ByteArrayOutputStream os = new ByteArrayOutputStream();
        //doc.saveToStream(os, FileFormat.Docx);
    }

    /**
     * æ›¿æ¢Wordæ–‡ä»¶ä¸­ ${} æ ‡è¯†çš„ç‰¹æ®Šå­—ç¬¦
     * <br>
     * <strong>æ³¨æ„ï¼šå¦‚æœå­˜åœ¨éƒ¨åˆ†ç‰¹æ®Šè¡¨ç¤ºæ— æ³•æ›¿æ¢ï¼Œè¯·å°è¯•å°† ${} çš„æ•´ä¸ªå­—ç¬¦ä¸²å¤åˆ¶åˆ°wordä¸­ï¼Œæœ‰å¯èƒ½wordæ²¡æœ‰å°†${}è¯†åˆ«ä¸ºä¸€ä¸ªæ•´ä½“</strong>
     * @param doc: Sprire Document
     * @param map: å ä½ç¬¦${} ä¸ éœ€è¦æ›¿æ¢çš„ä¸ºå­—ç¬¦ä¸²çš„å¯¹åº”å…³ç³»
     */
    public void replaceSpecialWord(Document doc, Map<String, String> map) {
        // æ­£åˆ™è¡¨è¾¾å¼ï¼ŒåŒ¹é…æ‰€æœ‰çš„å ä½ç¬¦ ${}
        Pattern pattern = Pattern.compile("\\$\\{.*?}");
        // æ ¹æ®æ­£åˆ™è¡¨è¾¾å¼è·å–æ‰€æœ‰æ–‡æœ¬
        TextSelection[] allPattern = doc.findAllPattern(pattern);
        // é€ä¸ªæ›¿æ¢å ä½ç¬¦
        for (TextSelection textSelection : allPattern) {
            String tmp = map.get(textSelection.getSelectedText());
            System.out.print(textSelection.getSelectedText());
            int res = doc.replace(textSelection.getSelectedText(), tmp, true, true);
            System.out.println(": " + res);
        }
    }
}

```

æœ€ç»ˆç»“æœï¼š

```java
// æ§åˆ¶å°è¾“å‡º
${name}: 1
${birthday}: 1
${result}: 1
${col}: 1
${col1}: 1
${col2}: 1

```

![image-20211021173346574](https://i-blog.csdnimg.cn/blog_migrate/e78fabc145f294e17cced182c5e08961.png)

â€‹ å¯ä»¥çœ‹åˆ°ä½¿ç”¨ Spire.Doc for Java æ›¿æ¢å ä½ç¬¦ååˆ†ç®€å•ï¼Œå¹¶ä¸”ä¸ä¼šç ´åæ¨¡æ¿çš„åŸæœ‰æ · å¼ã€‚

â€‹ å¦‚æœéœ€è¦äº†è§£ Spire.Doc for Java çš„æ›´å¤šæ“ä½œï¼Œå‚è€ƒ ===>
[å®˜æ–¹æ–‡æ¡£](https://www.e-iceblue.cn/spiredocforjava/spire-doc-for-java-program-guide-content.html)

### ä½¿ç”¨Spire.Doc å°†Wordæ–‡æ¡£ä¸­å ä½ç¬¦æ›¿æ¢ä¸ºå›¾ç‰‡

1ï¸âƒ£ï¼šç¼–å†™ä¸€ä¸ªæµ‹è¯•æ–‡æ¡£

![image-20211023191349321](https://i-blog.csdnimg.cn/blog_migrate/9251c3d3082ab1714bdd0fbd45b2fd1f.png)

2ï¸âƒ£ï¼šäº†è§£Sprie.Doc æ˜¯å¦‚ä½•æ’å…¥ä¸€å¼ å›¾ç‰‡

> [å‚è€ƒâ€”å®˜æ–¹æ–‡æ¡£](https://www.e-iceblue.cn/docforjava/insert-image-into-word-document-in-java.html)

Spire.Doc for Javaä¸­çš„ Paragraphç±» æä¾›äº†appendPicture ()æ–¹æ³•ç”¨äºç»™Wordæ®µè½æ·»åŠ å›¾ç‰‡ã€‚

```java
public class InsertImage {
    public static void main(String[] args){
        //åˆ›å»ºDocumentå¯¹è±¡
        Document doc = new Document();
        //æ·»åŠ èŠ‚
        Section section = doc.addSection();

        //æ·»åŠ ç¬¬ä¸€ä¸ªæ®µè½
        Paragraph paragraph = section.addParagraph();
        //æ·»åŠ å›¾ç‰‡åˆ°æ®µè½
        DocPicture picture = paragraph.appendPicture("C:\\Users\\Administrator\\Desktop\\Hydrangeas.jpg");
        //è®¾ç½®å›¾ç‰‡å®½åº¦
        picture.setWidth(300f);
        //è®¾ç½®å›¾ç‰‡é«˜åº¦
        picture.setHeight(250f);

        //ç»™æ®µè½è®¾ç½®æ°´å¹³å±…ä¸­å¯¹é½æ–¹å¼
        paragraph.getFormat().setHorizontalAlignment(HorizontalAlignment.Center);
        
        //ä¿å­˜
        doc.saveToFile("InsertImage.docx", FileFormat.Docx_2013);
    }
}


```

ç¬¬äºŒç§æ–¹å¼ï¼š ===>
[å‚è€ƒ](https://www.evget.com/article/2019/6/18/30761.html)

â€‹ é€šè¿‡è·å– Spire.Doc ä¸­çš„ TextRange å¯¹è±¡ï¼Œå¯ä»¥ç”¨è¿™ä¸ªå¯¹è±¡æ’å…¥å›¾ç‰‡ã€‚

```java
Document doc = new Document();
doc.loadFromFile("F:\\yourlocation\\template.docx", FileFormat.Docx);	// æˆ–è€…å¯ä»¥åŠ è½½æµloadFromStream(.,.)
// 0. ä½¿ç”¨ Spire.Doc çš„ DocPictureç±» åŠ è½½ä¸€å¼ å›¾ç‰‡ï¼Œå¹¶ä¸”å¯ä»¥è®¾ç½®å›¾ç‰‡çš„å®½é«˜
DocPicture pic = new DocPicture(doc);
pic.loadImage(imgList.get(count));
// 1. è·å– TextSelection
TextSelection selection = doc.findString("matchString", true, true);	// ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯éœ€è¦çš„åŒ¹é…å­—ç¬¦ä¸²å³å ä½ç¬¦ï¼Œåé¢ä¸¤ä¸ªå‚æ•°çš„æ„æ€ä¸ºï¼šæ˜¯å¦å¤§å°å†™æ•æ„Ÿã€æ˜¯å¦åŒ¹é…æ•´ä¸ªå•è¯
// 2. æ ¹æ® selection è·å– TextRange
TextRange range = selection.getAsOneRange();
// 3. é€šè¿‡ TextRange æ‰¾åˆ° å ä½ç¬¦åœ¨ä¸€ä¸ªæ®µè½ä¸­çš„ä½ç½®
int index = range.getOwnerParagraph().getChildObjects().indexOf(range);
// 4. é€šè¿‡è·å–åˆ°çš„ index ä½ç½®ï¼Œæ’å…¥ä¸€å¼ å›¾ç‰‡
range.getOwnerParagraph().getChildObjects().insert(index, pic);
range.getOwnerParagraph().getChildObjects().remove(range);	// è¿™ä¸ªremove æ“ä½œå…·ä½“ä½œç”¨ä¸å¤ªæ¸…æ¥šï¼Œä½†æ˜¯æ²¡æœ‰è¿™ä¸€æ­¥å›¾ç‰‡æ˜¯æ— æ³•æ­£ç¡®æ’å…¥çš„

```

3ï¸âƒ£ï¼šå¼€å§‹ç¼–ç â€‹

```java
// æµ‹è¯•æ–¹æ³•
@Test
public void imageTest() {
        Document doc = new Document();
        doc.loadFromFile("F:\\yourlocation\\template.docx", FileFormat.Docx);
        File file = new File("F:\\yourlocation\\orange.jpg");
        File file1 = new File("F:\\yourlocation\\orange.jpg");
        try {
            InputStream in = new FileInputStream(file);
            InputStream in1 = new FileInputStream(file1);
            List<InputStream> imgList = new ArrayList<>();
            imgList.add(in);
            imgList.add(in1);
            String matchString = "${images}";
            replaceTextToImage(doc, matchString, imgList);
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        }
        doc.saveToFile("F:\\yourlocation\\result.docx",FileFormat.Docx);
    }

/**
     * æ›¿æ¢Wordæ–‡æ¡£ä¸­çš„åŒä¸€å ä½ç¬¦ï¼Œä¸ºå¤šå¼ ä¸åŒçš„å›¾ç‰‡ï¼Œæ¯ä¸€ä¸ªå ä½ç¬¦å¯¹åº”ä¸€å¼ å›¾ç‰‡ï¼Œ
     * å¦‚æœå ä½ç¬¦æ¯”å›¾ç‰‡æ•°é‡å¤šåˆ™è¯¥å ä½ç¬¦ä¼šè¢«å†™ä¸ºç©ºå­—ç¬¦ä¸²
     * @param doc: Spire Document
     * @param matchString: å ä½ç¬¦
     * @param imgList: å›¾ç‰‡è¾“å…¥æµé›†åˆ
     * @date 2021/10/22 20:09
     */
public void replaceTextToImage(Document doc, String matchString, List<InputStream> imgList) {
    TextSelection[] selections = doc.findAllString(matchString, true, true);
    int total = imgList.size();
    int count = 0;
    for (TextSelection selection : selections) {
        if (count < total && imgList.get(count) != null) {
            DocPicture pic = new DocPicture(doc);
            pic.loadImage(imgList.get(count));
            pic.setWidth(100f);		// è®¾ç½®å›¾ç‰‡å®½é«˜
            pic.setHeight(100f);
            TextRange range = selection.getAsOneRange();
            int index = range.getOwnerParagraph().getChildObjects().indexOf(range);
            range.getOwnerParagraph().getChildObjects().insert(index, pic);
            range.getOwnerParagraph().getChildObjects().remove(range);
            count++;
        } else {
            // å¦‚æœå·²è¿‘æ²¡æœ‰äº†å›¾ç‰‡åˆ™å°†æ‰€æœ‰å ä½ç¬¦æ›¿æ¢ä¸ºç©º
            doc.replace(selection.getSelectedText(), "", true, true);
            break;
        }
    }
}



	/**
     * æŒ‰ç…§æ¨ªçºµæ¯”ç¼©æ”¾å›¾ç‰‡
     * @param pic: Spire å›¾ç‰‡å¯¹è±¡
     * @param rate: ç¼©æ”¾æ¯”ä¾‹ 0.1<= rate <=10ï¼Œ
     * @author He Peng
     * @date 2021/10/23 9:28
     */
public static void zoomImage(DocPicture pic, float rate) {
    if (rate < 0.1 || rate > 10) {
        throw new IllegalArgumentException("ç¼©æ”¾æ¯”ä¾‹å‚æ•°çš„æ•°å€¼èŒƒå›´ä¸ºï¼š0.1<= rate <=10ï¼Œä¸èƒ½è¶…è¿‡æ­¤èŒƒå›´");
    }
    float originalWidth = pic.getWidth();
    float originalHeight = pic.getHeight();
    pic.setWidth(originalWidth * rate);
    pic.setHeight(originalHeight * rate);
}


```

æœ€ç»ˆç»“æœï¼š

![image-20211023191231049](https://i-blog.csdnimg.cn/blog_migrate/a8db7b6ebb9d39296bc07322f2229f4a.png)

### ğŸ“˜ å‚è€ƒèµ„æ–™

[ä¸ªäººåšå®¢åŒæ­¥å‘å¸ƒ](https://orange-code.gitee.io/)

[POIæ“ä½œwordæ¨¡æ¿å¹¶ç”Ÿæˆæ–°çš„wordâ€“jianshu](https://www.jianshu.com/p/6603b1ea3ad1)
  
[Spire.doc for Javaâ€”å®˜æ–¹æ–‡æ¡£](https://www.e-iceblue.cn/spiredocforjavaoperating/java-draw-checkbox-to-word-document.html)
  
[Spire.Doc for Java èµ„æºâ€”csdn](https://blog.csdn.net/weixin_45266979/article/details/118969799)
  
[é€šè¿‡ Maven ä»“åº“å®‰è£… Spire ç³»åˆ— Java äº§å“â€”å®˜æ–¹æ–‡æ¡£](https://www.e-iceblue.cn/licensing/install-spirepdf-for-java-from-maven-repository.html)
  
[Spire.Doc ç³»åˆ—æ•™ç¨‹](https://www.evget.com/article/2019/6/18/30761.html)