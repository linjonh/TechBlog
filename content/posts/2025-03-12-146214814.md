---
layout: post
title: "在线商城服务器"
date: 2025-03-12 22:17:05 +0800
description: "解析 POST 请求内容（如表单提交），支持简单数据库查询（示例中未完全实现）开发的轻量级 HTTP 服务器，旨在实现基本的静态文件服务和简单的动态请求处理。1、如何根据客户端发送的请求，发送给客户的需要的数据。| - 创建 socket              || ├── GET 请求处理            || └── POST 请求处理           || - 监听连接 (listen)        ||     └── 数据库查询          |"
keywords: "在线商城服务器"
categories: ['未分类']
tags: ['服务器', 'Linux', 'C']
artid: "146214814"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146214814
    alt: "在线商城服务器"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146214814
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146214814
cover: https://bing.ee123.net/img/rand?artid=146214814
image: https://bing.ee123.net/img/rand?artid=146214814
img: https://bing.ee123.net/img/rand?artid=146214814
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     在线商城服务器
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h3>
     1、项目背景
    </h3>
    <p>
     本项目是一个基于
     <strong>
      C语言
     </strong>
     开发的轻量级 HTTP 服务器，旨在实现基本的静态文件服务和简单的动态请求处理。
    </p>
    <ul>
     <li>
      <p>
       <strong>
        核心目标
       </strong>
       ：
      </p>
      <ul>
       <li>
        <p>
         支持 HTTP/1.1 协议的 GET/POST 请求解析与响应。
        </p>
       </li>
       <li>
        <p>
         提供静态资源（HTML、图片等）的快速分发。
        </p>
       </li>
       <li>
        <p>
         作为学习网络编程和服务器开发的实践案例，验证高并发场景下的性能优化策略。
        </p>
       </li>
      </ul>
     </li>
    </ul>
    <h3>
     2、项目功能
    </h3>
    <h6>
     <strong>
      核心功能
     </strong>
    </h6>
    <p>
     <strong>
      静态文件服务
     </strong>
     ：
    </p>
    <p>
     支持返回 HTML、CSS、JS、图片（JPG/PNG）等静态资源。
    </p>
    <p>
     自动解析 URL 路径，映射到本地文件系统（
     <code>
      ../source/
     </code>
     目录）
    </p>
    <p>
     <strong>
      动态请求处理
     </strong>
     ：
    </p>
    <p>
     解析 POST 请求内容（如表单提交），支持简单数据库查询（示例中未完全实现）
    </p>
    <p>
     <strong>
      HTTP 协议支持
     </strong>
     ：
    </p>
    <p>
     基础请求解析（方法、URL、内容提取）。
    </p>
    <p>
     响应头生成（状态码、Content-Type、连接控制）
    </p>
    <h3>
     3、项目的设计框架及分析
    </h3>
    <blockquote>
     <p>
      +----------------------------+
      <br/>
      |         主程序入口          |
      <br/>
      | (main.c: main())           |
      <br/>
      +----------------------------+
      <br/>
      |
      <br/>
      v
      <br/>
      +----------------------------+
      <br/>
      | TCP 服务器初始化            |
      <br/>
      | (net.c: init_tcp_ser())    |
      <br/>
      | - 创建 socket              |
      <br/>
      | - 绑定端口 (bind)          |
      <br/>
      | - 监听连接 (listen)        |
      <br/>
      +----------------------------+
      <br/>
      |
      <br/>
      v
      <br/>
      +----------------------------+
      <br/>
      | 主循环：接收客户端连接        |
      <br/>
      | (main.c: accept())         |
      <br/>
      +----------------------------+
      <br/>
      |
      <br/>
      v
      <br/>
      +----------------------------+
      <br/>
      | HTTP 请求接收与解析          |
      <br/>
      | 1. 接收原始数据             |
      <br/>
      |   (net.c: recv_http_request)|
      <br/>
      | 2. 解析请求方法、URL、内容   |
      <br/>
      |   (net.c: parse_http_request)|
      <br/>
      | 3. 填充 Http_req_t 结构体   |
      <br/>
      +----------------------------+
      <br/>
      |
      <br/>
      v
      <br/>
      +----------------------------+
      <br/>
      | 响应生成与发送               |
      <br/>
      | (net.c: send_http_response)|
      <br/>
      | 分支逻辑：                  |
      <br/>
      | ├── GET 请求处理            |
      <br/>
      | │   ├── 静态文件发送        |
      <br/>
      | │   │   (send_net_file)    |
      <br/>
      | │   └── 特殊路径处理        |
      <br/>
      | │       (e.g., /favicon.ico)|
      <br/>
      | └── POST 请求处理           |
      <br/>
      |     ├── 动态内容生成        |
      <br/>
      |     └── 数据库查询          |
      <br/>
      |         (示例未完全实现)     |
      <br/>
      +----------------------------+
      <br/>
      |
      <br/>
      v
      <br/>
      +----------------------------+
      <br/>
      | 资源管理模块                |
      <br/>
      | 1. 文件 I/O 操作           |
      <br/>
      |   (net.c: send_net_file)   |
      <br/>
      | 2. 内存缓存机制            |
      <br/>
      |   (未实现，优化方向)        |
      <br/>
      +----------------------------+
      <br/>
      |
      <br/>
      v
      <br/>
      +----------------------------+
      <br/>
      | 网络通信层                  |
      <br/>
      | - 数据发送 (send)          |
      <br/>
      | - 连接关闭 (close)         |
      <br/>
      +----------------------------+
     </p>
    </blockquote>
    <p>
    </p>
    <p>
     <strong>
      关键数据流向
     </strong>
    </p>
    <blockquote>
     <p>
      <strong>
       客户端请求
       <br/>
       ↓
       <br/>
       [TCP 接收] → recv_http_request() → http_req 缓冲区
       <br/>
       ↓
       <br/>
       parse_http_request() → Http_req_t 结构体
       <br/>
       ↓
       <br/>
       send_http_response()
       <br/>
       ├── 分支1: GET → send_net_file() → 文件内容
       <br/>
       └── 分支2: POST → 动态逻辑 → 数据库/拼接响应
       <br/>
       ↓
       <br/>
       send() → 客户端
      </strong>
     </p>
    </blockquote>
    <h3>
     4、各个模块功能及技术
    </h3>
    <p>
     <strong>
      1. 网络通信模块
     </strong>
    </p>
    <p>
     <strong>
      功能
     </strong>
     ：负责 TCP 服务器的初始化、连接管理和数据传输。
    </p>
    <p>
     <strong>
      2. 协议解析模块
     </strong>
    </p>
    <p>
     <strong>
      功能
     </strong>
     ：解析 HTTP 请求，提取方法、URL 和内容。
    </p>
    <p>
     <strong>
      3. 文件处理模块
     </strong>
    </p>
    <p>
     <strong>
      功能
     </strong>
     ：读取本地文件并发送给客户端，支持静态资源服务。
    </p>
    <p>
     <strong>
      4. 动态内容处理模块
     </strong>
    </p>
    <p>
     <strong>
      功能
     </strong>
     ：处理 POST 请求，支持简单的动态内容生成。
    </p>
    <h3>
     5、函数接口
    </h3>
    <blockquote>
     <table>
      <thead>
       <tr>
        <th>
         函数名
        </th>
        <th>
         功能描述
        </th>
       </tr>
      </thead>
      <tbody>
       <tr>
        <td>
         <code>
          init_tcp_ser()
         </code>
        </td>
        <td>
         初始化 TCP 服务器，返回监听套接字
        </td>
       </tr>
       <tr>
        <td>
         <code>
          recv_http_request()
         </code>
        </td>
        <td>
         接收 HTTP 请求数据
        </td>
       </tr>
       <tr>
        <td>
         <code>
          parse_http_request()
         </code>
        </td>
        <td>
         解析请求方法、URL 和内容
        </td>
       </tr>
       <tr>
        <td>
         <code>
          send_http_response()
         </code>
        </td>
        <td>
         根据请求生成并发送响应
        </td>
       </tr>
       <tr>
        <td>
         <code>
          send_net_file()
         </code>
        </td>
        <td>
         发送本地文件到客户端
        </td>
       </tr>
      </tbody>
     </table>
    </blockquote>
    <h3>
     6、项目中遇到的困难和解决办法
    </h3>
    <p>
     1、如何根据客户端发送的请求，发送给客户的需要的数据
    </p>
    <p>
     通过解析URL，根据请求，发送文件给客户端
    </p>
    <p>
     2、如何实现并发
    </p>
    <p>
     采用
     <code>
      epoll
     </code>
     I/O 多路复用技术
    </p>
    <h3>
     7、项目的优化方向
    </h3>
    <p>
     1、完善更多功能
    </p>
    <p>
     2、优化UI界面
    </p>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323330325f37373930313537312f:61727469636c652f64657461696c732f313436323134383134" class_="artid" style="display:none">
 </p>
</div>


