---
layout: post
title: "前端-向后端传数据,判断问题所在的调试过程"
date: 2025-03-09 18:06:21 +0800
description: "理清架构：vue文件中（界面）——调用函数js文件中（api交互）——定义函数，并向后端发送 post 请求node后端中（处理）——接收 post 请求，并进行处理在里调用saveToFile要求：调用的传入的数据是js修改，在里，先打印text🚀texttextfetch若发现 text 的格式是content:Proxy用途：把响应式数据 ref([])即Proxy，转为普通数组。这样才可以进行解析。NetworkNetwork（网络）saveHeaders（请求头）"
keywords: "前端 | 向后端传数据，判断问题所在的调试过程"
categories: ['编程报错', '编程中的错误总结', 'Vue']
tags: ['前端', 'Vue', 'Javascript']
artid: "146130668"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146130668
    alt: "前端-向后端传数据,判断问题所在的调试过程"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146130668
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146130668
cover: https://bing.ee123.net/img/rand?artid=146130668
image: https://bing.ee123.net/img/rand?artid=146130668
img: https://bing.ee123.net/img/rand?artid=146130668
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     前端 | 向后端传数据，判断问题所在的调试过程
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <hr id="hr-toc" name="tableOfContents"/>
    <p>
     理清架构：
    </p>
    <p>
     <span style="background-color:#fef2f0">
      vue文件中（界面）——
     </span>
     <strong>
      <span style="background-color:#fef2f0">
       调用
      </span>
     </strong>
     <span style="background-color:#fef2f0">
      函数
     </span>
    </p>
    <p>
     <span style="background-color:#fef2f0">
      js文件中（api交互）——
     </span>
     <strong>
      <span style="background-color:#fef2f0">
       定义
      </span>
     </strong>
     <span style="background-color:#fef2f0">
      函数，并向后端
     </span>
     <strong>
      <span style="background-color:#fef2f0">
       发送 post 请求
      </span>
     </strong>
    </p>
    <p>
     <span style="background-color:#fef2f0">
      node后端中（处理）——
     </span>
     <strong>
      <span style="background-color:#fef2f0">
       接收 post 请求
      </span>
     </strong>
     <span style="background-color:#fef2f0">
      ，并进行
     </span>
     <strong>
      <span style="background-color:#fef2f0">
       处理
      </span>
     </strong>
    </p>
    <h3 id="%E2%80%8B%E7%BC%96%E8%BE%91" name="%E2%80%8B%E7%BC%96%E8%BE%91">
     <img alt="" height="184" src="https://i-blog.csdnimg.cn/direct/8ff4c52eeb234bd8ab177abbd36264d1.png" width="534"/>
    </h3>
    <hr/>
    <h3 id="1.%20%E5%9C%A8%20vue%20%E6%96%87%E4%BB%B6%E4%B8%AD%EF%BC%8C%E5%9C%A8%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0%E4%B9%8B%E5%89%8D%20%E5%85%88%E6%89%93%E5%8D%B0%E4%BC%A0%E5%85%A5%E7%9A%84%E6%95%B0%E6%8D%AE" name="1.%20%E5%9C%A8%20vue%20%E6%96%87%E4%BB%B6%E4%B8%AD%EF%BC%8C%E5%9C%A8%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0%E4%B9%8B%E5%89%8D%20%E5%85%88%E6%89%93%E5%8D%B0%E4%BC%A0%E5%85%A5%E7%9A%84%E6%95%B0%E6%8D%AE">
     <strong>
      1. 在 vue 文件中，在调用函数之前 先打印传入的数据
     </strong>
    </h3>
    <p>
     在
     <code>
      ChatView.vue
     </code>
     里调用
     <code>
      saveToFile
     </code>
     之前，先打印要传入的 userMessage 的数据格式：
    </p>
    <pre><code class="language-javascript">const sendMessage = async () =&gt; {
  
  console.log("调用 saveToFile 之前，用户输入：", userMessage); // 查看传入的数据格式

  await saveToFile(userMessage); // 调用保存函数
}</code></pre>
    <p>
     要求：调用的传入的数据是
    </p>
    <hr/>
    <h3 id="2.%20%E5%9C%A8%C2%A0js%C2%A0%E6%96%87%E4%BB%B6%E4%B8%AD%EF%BC%8C%E6%89%93%E5%8D%B0%E6%8E%A5%E6%94%B6%E5%88%B0%E7%9A%84%E6%95%B0%E6%8D%AE" name="2.%20%E5%9C%A8%C2%A0js%C2%A0%E6%96%87%E4%BB%B6%E4%B8%AD%EF%BC%8C%E6%89%93%E5%8D%B0%E6%8E%A5%E6%94%B6%E5%88%B0%E7%9A%84%E6%95%B0%E6%8D%AE">
     <strong>
      2. 在
      <code>
       js
      </code>
      文件中，打印接收到的数据
     </strong>
    </h3>
    <p>
     修改
     <code>
      deepseek.js
     </code>
     ，在
     <code>
      saveToFile()
     </code>
     里，先打印
     <code>
      text
     </code>
     的内容以及类型 用于判断接受到的数据：
    </p>
    <pre><code class="language-javascript">export const saveToFile = async (text) =&gt; {
  console.log("deepseek.js 收到的 text:", text); // 确保数据传递正确
  console.log("text 的类型:", typeof text); // 确保是字符串

  try {
    const response = await fetch("http://localhost:3000/save", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({ content: text }), // 发送 JSON 格式数据
    });

    console.log("请求返回 response:", response); // 查看请求结果

    if (!response.ok) {
      throw new Error("服务器返回错误：" + response.status);
    }

    console.log("保存成功");
  } catch (error) {
    console.error("存档失败:", error);
  }
};
</code></pre>
    <p>
     🚀
     <strong>
      作用
     </strong>
     ：
    </p>
    <ul>
     <li>
      确保
      <code>
       text
      </code>
      的数据格式正确。
     </li>
     <li>
      <code>
       console.log("text 的类型:", typeof text);
      </code>
      <strong>
       确保
       <code>
        text
       </code>
       是字符串
      </strong>
      。
     </li>
     <li>
      <code>
       console.log("请求返回 response:", response);
      </code>
      查看
      <code>
       fetch
      </code>
      请求是否成功。
     </li>
    </ul>
    <blockquote>
     <p>
      若发现 text 的格式是
      <strong>
       <span style="background-color:#fef2f0">
        content:
        <span style="color:#fe2c24">
         Proxy
        </span>
       </span>
      </strong>
      ，则在console.log之前添加：
     </p>
     <pre><code class="language-javascript">// 解析contentArray为文本格式 ——&gt; 把响应式数据 ref([])即Proxy 转为普通数组

    const normalArray = JSON.parse(JSON.stringify(contentArray.value || contentArray));
    const text = JSON.stringify({ content: normalArray });</code></pre>
     <p>
      用途：
      <span style="color:#fe2c24">
       <span style="background-color:#fef2f0">
        把响应式数据 ref([])即Proxy，转为普通数组
       </span>
      </span>
      。这样才可以进行解析。
     </p>
     <p>
      代码如图：
     </p>
     <p>
      <img alt="" height="1255" src="https://i-blog.csdnimg.cn/direct/26ac095242f44471bef04b81749a139d.png" width="1355"/>
     </p>
    </blockquote>
    <blockquote>
     <p>
      <strong>
       知识点：
      </strong>
     </p>
     <p>
      <strong>
       JSON.stringify() —— 对象→json字符串
      </strong>
     </p>
     <p>
      <strong>
       JSON.parse() —— json字符串→js对象
      </strong>
     </p>
    </blockquote>
    <hr/>
    <h3 id="3.%20%E5%9C%A8%E6%B5%8F%E8%A7%88%E5%99%A8%20Network%20%E9%9D%A2%E6%9D%BF%E6%9F%A5%E7%9C%8B%E8%AF%B7%E6%B1%82%E6%95%B0%E6%8D%AE" name="3.%20%E5%9C%A8%E6%B5%8F%E8%A7%88%E5%99%A8%20Network%20%E9%9D%A2%E6%9D%BF%E6%9F%A5%E7%9C%8B%E8%AF%B7%E6%B1%82%E6%95%B0%E6%8D%AE">
     <strong>
      3. 在浏览器
      <code>
       Network
      </code>
      面板查看请求数据
     </strong>
    </h3>
    <ol>
     <li>
      打开
      <strong>
       浏览器开发者工具（F12 或 Ctrl+Shift+I）
      </strong>
     </li>
     <li>
      切换到
      <strong>
       <span style="background-color:#fef2f0">
        Network（网络）
       </span>
      </strong>
      面板
     </li>
     <li>
      找到
      <code>
       save
      </code>
      请求，点击后查看：
      <ul>
       <li>
        <strong>
         <span style="background-color:#fef2f0">
          Headers（请求头）
         </span>
        </strong>
        → 确保
        <span style="background-color:#fef2f0">
        </span>
        <code>
         <span style="background-color:#fef2f0">
          Content-Type: application/json
         </span>
        </code>
       </li>
       <li>
        <strong>
         <span style="background-color:#fef2f0">
          Request Payload（请求数据）
         </span>
        </strong>
        →
        <span style="background-color:#fef2f0">
         确保
        </span>
        <code>
         <span style="background-color:#fef2f0">
          body
         </span>
        </code>
        <span style="background-color:#fef2f0">
         里是
        </span>
        <code>
         <span style="background-color:#fef2f0">
          { "content": "你的数据" }
         </span>
        </code>
       </li>
      </ul>
     </li>
    </ol>
    <p>
    </p>
    <hr/>
    <h3 id="4.%20%E5%9C%A8%20server.js%20%E4%B8%AD%E6%9F%A5%E7%9C%8B%E8%AF%B7%E6%B1%82%E6%95%B0%E6%8D%AE" name="4.%20%E5%9C%A8%20server.js%20%E4%B8%AD%E6%9F%A5%E7%9C%8B%E8%AF%B7%E6%B1%82%E6%95%B0%E6%8D%AE">
     <strong>
      4. 在
      <code>
       server.js
      </code>
      中查看请求数据
     </strong>
    </h3>
    <p>
     修改
     <code>
      server.js
     </code>
     ，在
     <code>
      POST /save
     </code>
     里打印收到的数据：
    </p>
    <pre><code class="language-javascript">const express = require("express");
const cors = require("cors");
const fs = require("fs");

const app = express();
app.use(cors());
app.use(express.json()); // 确保能解析 JSON 数据

app.post("/save", (req, res) =&gt; {
  console.log("后端接收到的数据:", req.body); // 打印请求内容

  const content = req.body.content;
  console.log("格式化后的 content:", content); // 确保是字符串

  fs.appendFile("conversation.txt", content + "\n", (err) =&gt; {
    if (err) {
      console.error("写入文件失败:", err);
      return res.status(500).json({ error: "写入失败" });
    }
    res.json({ message: "写入成功" });
  });
});

app.listen(3000, () =&gt; {
  console.log("服务器运行在 http://localhost:3000");
});
</code></pre>
    <p>
     🚀
     <strong>
      作用
     </strong>
     ：
    </p>
    <ul>
     <li>
      <code>
       <span style="background-color:#fef2f0">
        console.log(
       </span>
       "后端接收到的数据:
       <span style="background-color:#fef2f0">
        ", req.body)
       </span>
       ;
      </code>
      确保前端传递的 JSON 格式正确。
     </li>
     <li>
      <code>
       <span style="background-color:#fef2f0">
        console.log("格式化后的 content:", content)
       </span>
       ;
      </code>
      确保
      <strong>
       <code>
        content
       </code>
       是字符串
      </strong>
      。
     </li>
     <li>
      <code>
       fs.appendFile
      </code>
      把
      <code>
       content
      </code>
      追加写入
      <code>
       conversation.txt
      </code>
      ，每条信息换行存储。
     </li>
    </ul>
    <hr/>
    <h3 id="5.%20%E7%A1%AE%E4%BF%9D%20JSON%20%E6%A0%BC%E5%BC%8F%E6%AD%A3%E7%A1%AE" name="5.%20%E7%A1%AE%E4%BF%9D%20JSON%20%E6%A0%BC%E5%BC%8F%E6%AD%A3%E7%A1%AE">
     <strong>
      5. 确保 JSON 格式正确
     </strong>
    </h3>
    <p>
     如果
     <code>
      deepseek.js（api交互的js）
     </code>
     里
     <code>
      <span style="background-color:#fef2f0">
       console.log("text 类型:", typeof text);
      </span>
     </code>
     <span style="background-color:#fef2f0">
     </span>
     发现
     <code>
      text
     </code>
     不是字符串，你可以用：
    </p>
    <pre><code class="language-javascript">const textString = JSON.stringify(text, null, 2);  // 格式化 JSON
console.log("格式化后的 text:", textString);
</code></pre>
    <p>
     这样你可以更容易发现问题。
    </p>
    <blockquote>
     <h3 id="%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AJSON.stringify(req.body%2C%20null%2C%202)%C2%A0" name="%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9AJSON.stringify(req.body%2C%20null%2C%202)%C2%A0" style="background-color:transparent">
      <strong>
       <code>
        知识点：
        <span style="color:#fe2c24">
         <span style="background-color:#fef2f0">
          JSON.stringify(req.body, null, 2)
         </span>
        </span>
       </code>
      </strong>
      <span style="color:#fe2c24">
       <span style="background-color:#fef2f0">
       </span>
      </span>
     </h3>
     <p>
      <span style="color:#fe2c24">
       <strong>
        <code>
         <span style="background-color:#fef2f0">
          JSON.stringify(req.body）对象→json字符串
         </span>
        </code>
       </strong>
      </span>
     </p>
     <p>
      <span style="color:#fe2c24">
       <strong>
        <code>
         <span style="background-color:#fef2f0">
          JSON.stringify(req.body, null, 2)
         </span>
        </code>
       </strong>
      </span>
      是一个常见的 JavaScript 代码片段，主要用于将对象
      <code>
       req.body
      </code>
      <strong>
       <span style="background-color:#fef2f0">
        序列化为格式化的 JSON 字符串
       </span>
      </strong>
      ，便于人类阅读或调试。以下是详细解析：
     </p>
     <hr/>
     <h4 id="1.%20%E4%BB%A3%E7%A0%81%E7%BB%93%E6%9E%84" name="1.%20%E4%BB%A3%E7%A0%81%E7%BB%93%E6%9E%84">
      <strong>
       1. 代码结构
      </strong>
     </h4>
     <pre><strong><span style="background-color:#fef2f0">JSON.stringify(value, replacer, space)</span></strong></pre>
     <ul>
      <li>
       <p>
        <strong>
         <code>
          value
         </code>
        </strong>
        : 需
        <strong>
         要序列化的对象
        </strong>
        （这里是
        <code>
         req.body
        </code>
        ，通常来自 HTTP 请求的请求体，如 POST/PUT 请求的 JSON 数据）。
       </p>
      </li>
      <li>
       <p>
        <strong>
         <code>
          replacer
         </code>
        </strong>
        : 可选参数，用于
        <strong>
         过滤或转换
        </strong>
        属性。此处设为
        <code>
         null
        </code>
        ，表示不进行过滤或修改。
       </p>
      </li>
      <li>
       <p>
        <strong>
         <code>
          space
         </code>
        </strong>
        : 可选参数，指定
        <strong>
         缩进的空格数或字符串
        </strong>
        。此处设为
        <code>
         2
        </code>
        ，表示用
        <strong>
         2 个空格
        </strong>
        缩进格式化输出。
       </p>
      </li>
     </ul>
     <hr/>
     <h4 id="2.%20%E4%BD%9C%E7%94%A8" name="2.%20%E4%BD%9C%E7%94%A8">
      <strong>
       2. 作用
      </strong>
     </h4>
     <h5 id="%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD" name="%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD">
      <strong>
       核心功能
      </strong>
     </h5>
     <ul>
      <li>
       <p>
        将
        <code>
         req.body
        </code>
        （通常是 JavaScript 对象）转换为
        <strong>
         格式化的 JSON 字符串
        </strong>
        。
       </p>
      </li>
      <li>
       <p>
        例如，原始对象：
       </p>
       <pre><span style="background-color:#fef2f0">{ name: "Alice", age: 30, address: { city: "Shanghai" } }</span></pre>
       <p>
        会被转换为：
       </p>
       <pre><span style="background-color:#fef2f0">{
  "name": "Alice",
  "age": 30,
  "address": {
    "city": "Shanghai"
  }
}</span></pre>
      </li>
     </ul>
     <h5 id="%E5%85%B3%E9%94%AE%E7%89%B9%E7%82%B9" name="%E5%85%B3%E9%94%AE%E7%89%B9%E7%82%B9">
      <strong>
       关键特点
      </strong>
     </h5>
     <ol>
      <li>
       <p>
        <strong>
         美化输出
        </strong>
        （Pretty-Print）:
       </p>
       <ul>
        <li>
         <p>
          <code>
           space: 2
          </code>
          会为 JSON 字符串添加换行和缩进（2 个空格），使数据结构更清晰。
         </p>
        </li>
        <li>
         <p>
          适合日志记录、调试输出或直接展示给用户。
         </p>
        </li>
       </ul>
      </li>
      <li>
       <p>
        <strong>
         保留完整数据
        </strong>
        （不过滤）:
       </p>
       <ul>
        <li>
         <p>
          <code>
           replacer: null
          </code>
          表示不修改或过滤任何属性，所有可序列化的属性都会被保留。
         </p>
        </li>
       </ul>
      </li>
      <li>
       <p>
        <strong>
         兼容性
        </strong>
        :
       </p>
       <ul>
        <li>
         <p>
          自动处理
          <code>
           Date
          </code>
          、
          <code>
           undefined
          </code>
          、
          <code>
           函数
          </code>
          等类型（遵循
          <code>
           JSON.stringify
          </code>
          的默认规则）。
         </p>
        </li>
       </ul>
      </li>
     </ol>
     <hr/>
     <h4 id="3.%20%E5%85%B8%E5%9E%8B%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF" name="3.%20%E5%85%B8%E5%9E%8B%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF">
      <strong>
       3. 典型使用场景
      </strong>
     </h4>
     <h5 id="(1)%20%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95" name="(1)%20%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95">
      <strong>
       (1) 日志记录
      </strong>
     </h5>
     <p>
      将请求体内容记录到日志文件或控制台，便于排查问题：
     </p>
     <pre>console.log(JSON.stringify(req.body, null, 2));
// 输出：
// {
//   "username": "alice",
//   "action": "login"
// }</pre>
     <h5 id="(2)%20API%20%E5%93%8D%E5%BA%94" name="(2)%20API%20%E5%93%8D%E5%BA%94">
      <strong>
       (2) API 响应
      </strong>
     </h5>
     <p>
      向客户端返回格式化的 JSON 数据（如调试接口时）：
     </p>
     <pre>res.send(JSON.stringify(req.body, null, 2));</pre>
     <h5 id="(3)%20%E5%AD%98%E5%82%A8%E6%95%B0%E6%8D%AE" name="(3)%20%E5%AD%98%E5%82%A8%E6%95%B0%E6%8D%AE">
      <strong>
       (3) 存储数据
      </strong>
     </h5>
     <p>
      将请求体保存到文件或数据库（格式化的 JSON 更易维护）：
     </p>
     <pre>fs.writeFileSync("request.json", JSON.stringify(req.body, null, 2));</pre>
    </blockquote>
    <hr/>
    <h3 id="%C2%A0%E4%BE%8B%E5%AD%90%E2%80%94%E2%80%94%E6%8E%A7%E5%88%B6%E5%8F%B0%E7%9A%84%E6%98%BE%E7%A4%BA" name="%C2%A0%E4%BE%8B%E5%AD%90%E2%80%94%E2%80%94%E6%8E%A7%E5%88%B6%E5%8F%B0%E7%9A%84%E6%98%BE%E7%A4%BA">
     例子——控制台的显示
    </h3>
    <p>
     <img alt="" height="445" src="https://i-blog.csdnimg.cn/direct/a944b6450ea4437b91010ea4fd5306f9.png" width="951"/>
    </p>
    <hr/>
    <h3 id="%E6%9C%80%E7%BB%88%E6%A3%80%E6%9F%A5%E7%82%B9" name="%E6%9C%80%E7%BB%88%E6%A3%80%E6%9F%A5%E7%82%B9">
     <strong>
      最终检查点
     </strong>
    </h3>
    <ul>
     <li>
      <strong>
       ChatView.vue
      </strong>
      →
      <span style="color:#fe2c24">
       <code>
        <span style="background-color:#fef2f0">
         console.log
        </span>
       </code>
       <span style="background-color:#fef2f0">
       </span>
      </span>
      确保
      <code>
       saveToFile
      </code>
      传入正确的内容。
     </li>
     <li>
      <strong>
       deepseek.js
      </strong>
      →
      <span style="color:#fe2c24">
       <span style="background-color:#fef2f0">
       </span>
       <code>
        <span style="background-color:#fef2f0">
         console.log
        </span>
       </code>
       <span style="background-color:#fef2f0">
        确保
       </span>
       <code>
        <span style="background-color:#fef2f0">
         text
        </span>
       </code>
       <span style="background-color:#fef2f0">
        是字符串
       </span>
      </span>
      ，并打印
      <code>
       fetch
      </code>
      请求的
      <code>
       response
      </code>
      。
     </li>
     <li>
      <span style="color:#fe2c24">
       <strong>
        <span style="background-color:#fef2f0">
         Network 面板
        </span>
       </strong>
       <span style="background-color:#fef2f0">
        → 检查请求
       </span>
       <code>
        <span style="background-color:#fef2f0">
         Headers
        </span>
       </code>
       <span style="background-color:#fef2f0">
        和
       </span>
       <code>
        <span style="background-color:#fef2f0">
         Request Payload
        </span>
       </code>
      </span>
      ，确保格式正确。
     </li>
     <li>
      <strong>
       server.js
      </strong>
      →
      <span style="color:#fe2c24">
       <code>
        <span style="background-color:#fef2f0">
         console.log
        </span>
       </code>
       <span style="background-color:#fef2f0">
        确保后端收到的 JSON 正确
       </span>
      </span>
      ，
      <code>
       fs.appendFile
      </code>
      成功写入文件。
     </li>
    </ul>
    <hr/>
    <p>
     ✅ 这样，你就可以完整跟踪 Vue 组件、deepseek.js、fetch 请求、server.js 之间的数据流，并找到问题所在！ 🚀
    </p>
    <p>
     主要是通过
     <strong>
      输出和检查network面板
     </strong>
     进行调试，查看
     <strong>
      控制台结果和node终端的结果
     </strong>
     ，来修改代码，找到问题所在。
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34323437393432312f:61727469636c652f64657461696c732f313436313330363638" class_="artid" style="display:none">
 </p>
</div>


