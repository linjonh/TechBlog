---
layout: post
title: "chrome.webRequest-API-和-Performance-API"
date: 2025-03-16 15:41:10 +0800
description: "Chrome 的  API 和 Performance API 是两个不同的功能模块，分别用于处理网络请求和性能监控。以下是对这两个 API 的详细说明： API 是 Chrome 浏览器扩展程序中用于监控、分析和拦截网络请求的核心工具。它允许开发者在 HTTP 请求的不同阶段添加事件监听器，从而获取请求的详细信息或修改请求内容。以下是其主要特点和功能：Performance API 是一组用于测量网页性能的非授权 API，旨在帮助开发者优化网页性能。它提供了多种性能指标和测量方法，包括：功能差异：隐私与性"
keywords: "chrome.webRequest API 和 Performance API"
categories: ['开源项目观察', '学习札记', 'Python']
tags: ['前端', 'Webrequest', 'Performance', 'Chrome']
artid: "146296232"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146296232
    alt: "chrome.webRequest-API-和-Performance-API"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146296232
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146296232
cover: https://bing.ee123.net/img/rand?artid=146296232
image: https://bing.ee123.net/img/rand?artid=146296232
img: https://bing.ee123.net/img/rand?artid=146296232
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     chrome.webRequest API 和 Performance API
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/3e35548d27b6473cbdf9ffd563f672eb.png#pic_center"/>
    </p>
    <p>
     Chrome 的
     <code>
      chrome.webRequest
     </code>
     API 和 Performance API 是两个不同的功能模块，分别用于处理网络请求和性能监控。以下是对这两个 API 的详细说明：
    </p>
    <h4>
     <a id="1_chromewebRequest_API_4">
     </a>
     1.
     <strong>
      chrome.webRequest API
     </strong>
    </h4>
    <p>
     <code>
      chrome.webRequest
     </code>
     API 是 Chrome 浏览器扩展程序中用于监控、分析和拦截网络请求的核心工具。它允许开发者在 HTTP 请求的不同阶段添加事件监听器，从而获取请求的详细信息或修改请求内容。以下是其主要特点和功能：
    </p>
    <ul>
     <li>
      <strong>
       事件监听器
      </strong>
      ：
      <code>
       chrome.webRequest
      </code>
      提供了多个事件监听器，如
      <code>
       onBeforeRequest
      </code>
      、
      <code>
       onBeforeSendHeaders
      </code>
      、
      <code>
       onSendHeaders
      </code>
      、
      <code>
       onHeadersReceived
      </code>
      、
      <code>
       onAuthRequired
      </code>
      、
      <code>
       onCompleted
      </code>
      和
      <code>
       onErrorOccurred
      </code>
      ，用于在请求的不同阶段进行操作。
     </li>
     <li>
      <strong>
       权限要求
      </strong>
      ：使用
      <code>
       chrome.webRequest
      </code>
      需要在扩展程序的
      <code>
       manifest.json
      </code>
      文件中声明
      <code>
       webRequest
      </code>
      和
      <code>
       webRequestBlocking
      </code>
      权限。某些操作（如阻止或修改请求）需要额外的
      <code>
       webRequestBlocking
      </code>
      权限。
     </li>
     <li>
      <strong>
       功能灵活性
      </strong>
      ：开发者可以通过事件监听器和过滤器（如
      <code>
       RequestFilter
      </code>
      ）来控制请求的拦截、重定向或修改。例如，可以在
      <code>
       onBeforeRequest
      </code>
      事件中取消请求或修改请求头。
     </li>
     <li>
      <strong>
       隐私问题
      </strong>
      ：由于
      <code>
       chrome.webRequest
      </code>
      允许扩展程序完全访问用户的网络请求，因此存在隐私风险。Google 在 Manifest V3 中引入了新的
      <code>
       declarativeNetRequest
      </code>
      API，以减少对
      <code>
       chrome.webRequest
      </code>
      的依赖，并提高隐私保护。
     </li>
    </ul>
    <h4>
     <a id="2_Performance_API_12">
     </a>
     2.
     <strong>
      Performance API
     </strong>
    </h4>
    <p>
     Performance API 是一组用于测量网页性能的非授权 API，旨在帮助开发者优化网页性能。它提供了多种性能指标和测量方法，包括：
    </p>
    <ul>
     <li>
      <strong>
       导航时间（Navigation Timing）
      </strong>
      ：测量从用户点击到页面加载完成的时间。
     </li>
     <li>
      <strong>
       资源加载时间（Resource Timing）
      </strong>
      ：测量资源加载的时间，如 DNS 解析、服务器响应等。
     </li>
     <li>
      <strong>
       绘制时间（Paint Timing）
      </strong>
      ：测量页面绘制的时间，帮助开发者优化渲染性能。
     </li>
     <li>
      <strong>
       动画性能（Animation Performance）
      </strong>
      ：通过
      <code>
       performance.now()
      </code>
      方法测量动画的起始时间和结束时间，分析动画是否流畅。
     </li>
    </ul>
    <h5>
     <a id="_20">
     </a>
     特点：
    </h5>
    <ul>
     <li>
      <strong>
       兼容性
      </strong>
      ：Performance API 在 Chrome、Firefox、Safari 和 Edge 等浏览器中广泛支持，但在旧版本浏览器中可能需要兼容性处理。
     </li>
     <li>
      <strong>
       性能优化
      </strong>
      ：通过测量关键性能指标（如页面加载时间和用户交互延迟），开发者可以发现性能瓶颈并进行优化。
     </li>
     <li>
      <strong>
       隐私保护
      </strong>
      ：Performance API 不涉及用户数据的隐私问题，因此在隐私敏感的应用场景中更为安全。
     </li>
    </ul>
    <h4>
     <a id="3__25">
     </a>
     3.
     <strong>
      对比与总结
     </strong>
    </h4>
    <ul>
     <li>
      <p>
       <strong>
        功能差异
       </strong>
       ：
      </p>
      <ul>
       <li>
        <code>
         chrome.webRequest
        </code>
        主要用于网络请求的监控和拦截，适用于开发需要对网络流量进行干预的扩展程序。
       </li>
       <li>
        Performance API 专注于网页性能的测量和优化，适用于开发者提升网页加载速度和响应性能。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        隐私与性能
       </strong>
       ：
      </p>
      <ul>
       <li>
        <code>
         chrome.webRequest
        </code>
        提供了强大的功能，但也带来了隐私风险。Google 在 Manifest V3 中逐步限制了该 API 的使用，并推荐使用
        <code>
         declarativeNetRequest
        </code>
        API 来替代。
       </li>
       <li>
        Performance API 更加注重性能优化，不涉及用户数据的隐私问题，因此在隐私敏感的应用中更具优势。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        未来趋势
       </strong>
       ：
      </p>
      <ul>
       <li>
        随着 Manifest V3 的推广，
        <code>
         chrome.webRequest
        </code>
        的使用逐渐被
        <code>
         declarativeNetRequest
        </code>
        API 替代，后者提供了更高的性能和更好的隐私保护。
       </li>
       <li>
        Performance API 则继续作为优化网页性能的重要工具，在浏览器中得到广泛应用。
       </li>
      </ul>
     </li>
    </ul>
    <p>
     Chrome 的
     <code>
      chrome.webRequest
     </code>
     API 和 Performance API 分别在不同的场景下发挥重要作用。开发者应根据具体需求选择合适的工具，并注意隐私和性能的平衡。
    </p>
    <p>
     在 Manifest V3 中，Google 推荐使用 Performance API 而不是 chrome.webRequest API 的原因可以从以下几个方面进行分析：
    </p>
    <ol>
     <li>
      <p>
       <strong>
        性能和资源消耗问题
       </strong>
       <br/>
       chrome.webRequest API 允许扩展实时观察和修改网络请求，这虽然对广告拦截等功能非常有用，但也带来了显著的性能开销。例如，该 API 需要持续运行并处理大量数据，这可能导致高资源占用和延迟。相比之下，Performance API 更加轻量级，专注于性能优化，能够减少对系统资源的消耗。
      </p>
     </li>
     <li>
      <p>
       <strong>
        隐私和安全性考虑
       </strong>
       <br/>
       chrome.webRequest API 提供了对用户网络活动的全面访问权限，这引发了隐私和安全方面的担忧。例如，恶意扩展可以利用该 API 读取用户的浏览数据。而 Performance API 更注重性能优化，而非直接干预用户的网络请求，从而降低了隐私泄露的风险。
      </p>
     </li>
     <li>
      <p>
       <strong>
        扩展功能的限制与改进
       </strong>
       <br/>
       Manifest V3 引入了新的 declarativeNetRequest API，取代了 chrome.webRequest API。虽然 declarativeNetRequest 功能有限，但它更符合现代浏览器的懒加载和声明式编程模式。Google 认为这种设计可以更好地平衡性能和功能需求，同时减少扩展对浏览器资源的占用。
      </p>
     </li>
     <li>
      <p>
       <strong>
        社区反馈与技术演进
       </strong>
       <br/>
       Manifest V3 的推出引发了广泛的争议，尤其是关于移除 chrome.webRequest API 的决定。开发者社区对此反应强烈，认为这一变化剥夺了扩展的功能并降低了效率。然而，Google 通过引入 Performance API 和 declarativeNetRequest API，试图在性能优化和功能需求之间找到新的平衡点，并逐步改进这些新 API 的功能。
      </p>
     </li>
     <li>
      <p>
       <strong>
        浏览器生态系统的统一性
       </strong>
       <br/>
       Google 推荐使用 Performance API 是为了推动浏览器扩展生态系统的统一性和现代化。通过引入更高效的 API，Google 希望鼓励开发者采用新的编程模式，从而提升整个生态系统的性能和安全性。
      </p>
     </li>
    </ol>
    <p>
     Google 推荐使用 Performance API 而不是 chrome.webRequest API 的主要原因在于性能优化、隐私保护、功能改进以及对开发者生态系统的长远规划。这些变化虽然在短期内可能带来一些挑战，但从长远来看，它们有助于提升浏览器的整体性能和用户体验。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a:2f2f626c6f672e6373646e2e6e65742f62657374706173752f:61727469636c652f64657461696c732f313436323936323332" class_="artid" style="display:none">
 </p>
</div>


