---
layout: post
title: "51å’Œstm32çš„ç‚¹ç¯åŒºåˆ«"
date: 2025-08-23T11:15:59+0800
description: "51å•ç‰‡æœºä¸STM32ç‚¹ç¯å¯¹æ¯”ï¼š51å•ç‰‡æœºç‚¹ç¯ä»…éœ€ç®€å•GPIOæ§åˆ¶ï¼Œä»£ç ç®€æ´ï¼ˆçº¦10è¡Œï¼‰ï¼Œæ— éœ€æ—¶é’Ÿé…ç½®ï¼›è€ŒSTM32éœ€å®Œæ•´é…ç½®æµç¨‹ï¼ˆæ—¶é’Ÿä½¿èƒ½ã€æ¨¡å¼/ç±»å‹/é€Ÿåº¦è®¾ç½®ç­‰ï¼‰ï¼Œä»£ç æ›´å¤æ‚ï¼ˆçº¦30è¡Œï¼‰ã€‚51é€‚åˆç®€å•æ§åˆ¶åœºæ™¯ï¼ŒSTM32é€‚åˆå¤æ‚åº”ç”¨ï¼Œæä¾›æ›´çµæ´»çš„GPIOé…ç½®é€‰é¡¹ï¼ˆè¾“å…¥/è¾“å‡º/å¤ç”¨æ¨¡å¼ã€æ¨æŒ½/å¼€æ¼ã€é€Ÿåº¦è°ƒèŠ‚ç­‰ï¼‰ã€‚ä¸¤è€…å·®å¼‚ä½“ç°äº†ä¸åŒæ¶æ„çš„è®¾è®¡ç†å¿µï¼š51è¿½æ±‚ç®€å•æ˜“ç”¨ï¼ŒSTM32å¼ºè°ƒåŠŸèƒ½ä¸°å¯Œæ€§ã€‚"
keywords: "51å’Œstm32çš„ç‚¹ç¯åŒºåˆ«"
categories: ['æœªåˆ†ç±»']
tags: ['å•ç‰‡æœº', 'Stm', '51å•ç‰‡æœº']
artid: "150637917"
arturl: "https://blog.csdn.net/amyliyanice/article/details/150637917"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=150637917
    alt: "51å’Œstm32çš„ç‚¹ç¯åŒºåˆ«"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=150637917
featuredImagePreview: https://bing.ee123.net/img/rand?artid=150637917
cover: https://bing.ee123.net/img/rand?artid=150637917
image: https://bing.ee123.net/img/rand?artid=150637917
img: https://bing.ee123.net/img/rand?artid=150637917
---



# 51å’Œstm32çš„ç‚¹ç¯åŒºåˆ«



**ç‚¹ä¸€ä¸ªç¯ï¼Œ51æ˜¯â€œä¸€å¥è¯çš„äº‹â€ï¼Œè€ŒSTM32æ˜¯â€œä¸€ä¸ªæµç¨‹çš„äº‹â€**ã€‚

### 51ç‚¹ç¯

æ§åˆ¶GPIOå£é«˜ä½ç”µå¹³å³å¯

```

#include <REGX52.H> // åŒ…å«STC89C52çš„å¤´æ–‡ä»¶ï¼Œå®šä¹‰äº†P1ç­‰å¯„å­˜å™¨

sbit LED = P1^0; // ä½¿ç”¨sbitå…³é”®å­—å®šä¹‰P1å£çš„ç¬¬0ä½ä¸ºLED

// ç®€å•çš„å»¶æ—¶å‡½æ•°ï¼Œç”¨äºäº§ç”Ÿé—ªçƒé—´éš”
void Delay_ms(unsigned int ms) {
    unsigned int i, j;
    for(i=ms; i>0; i--)
        for(j=114; j>0; j--);
}

void main() { // ä¸»å‡½æ•°
    while(1) { // æ— é™å¾ªç¯
        LED = 0; // P1.0è¾“å‡ºä½ç”µå¹³ï¼Œç‚¹äº®LEDï¼ˆå‡è®¾å…±é˜³æ¥æ³•ï¼‰
        Delay_ms(500); // å»¶æ—¶500æ¯«ç§’
        LED = 1; // P1.0è¾“å‡ºé«˜ç”µå¹³ï¼Œç†„ç­LED
        Delay_ms(500); // å»¶æ—¶500æ¯«ç§’
    }
}
```

### stm32ç‚¹ç¯

ä½¿èƒ½æ—¶é’Ÿ

é…ç½®æ¨¡å¼

é…ç½®ç±»å‹

é…ç½®é€Ÿåº¦

è®¾ç½®åˆå§‹çŠ¶æ€

æ§åˆ¶ç”µå¹³

```

// å¯„å­˜å™¨åœ°å€å®šä¹‰
#define RCC_APB2ENR (*(volatile unsigned int*)0x40021018) // æ—¶é’Ÿä½¿èƒ½å¯„å­˜å™¨åœ°å€
#define GPIOA_CRL (*(volatile unsigned int*)0x40010800)   // GPIOAé…ç½®å¯„å­˜å™¨ä½åœ°å€
#define GPIOA_ODR (*(volatile unsigned int*)0x4001080C)   // GPIOAè¾“å‡ºæ•°æ®å¯„å­˜å™¨åœ°å€

int main(void) {
    // 1. ä½¿èƒ½GPIOAçš„æ—¶é’Ÿ (å¿…åšç¬¬ä¸€æ­¥!)
    RCC_APB2ENR |= (1 << 2); // å°†ç¬¬2ä½ç½®1ï¼Œå¼€å¯GPIOAç«¯å£çš„æ—¶é’Ÿ

    // 2. é…ç½®GPIOAç¬¬5å¼•è„šçš„æ¨¡å¼
    // å…ˆæ¸…ç©ºPA5å¯¹åº”çš„é…ç½®ä½ï¼ˆCNF5[1:0]å’ŒMODE5[1:0]ï¼‰ï¼Œä½äºCRLå¯„å­˜å™¨çš„[23:20]
    GPIOA_CRL &= ~(0xF << 20);
    // è®¾ç½®PA5ä¸ºé€šç”¨æ¨æŒ½è¾“å‡ºæ¨¡å¼ï¼Œæœ€å¤§é€Ÿåº¦50MHz
    // æ¨æŒ½è¾“å‡º(GPIO)ï¼šCNF5[1:0]=00, è¾“å‡ºæ¨¡å¼ï¼Œ50MHzï¼šMODE5[1:0]=11
    // æ‰€ä»¥å†™å…¥äºŒè¿›åˆ¶çš„0011ï¼Œå³0x3ï¼Œå·¦ç§»20ä½
    GPIOA_CRL |= (0x3 << 20); // (0b0011 << 20)

    while(1) {
        // 3. æ§åˆ¶è¾“å‡ºï¼šç‚¹äº®LEDï¼ˆå‡è®¾ä½ç”µå¹³ç‚¹äº®ï¼‰
        GPIOA_ODR &= ~(1 << 5); // å°†ç¬¬5ä½æ¸…0
        // ä½¿ç”¨ç®€é™‹çš„å»¶æ—¶
        for(volatile int i=0; i<500000; i++);
        
        // 4. æ§åˆ¶è¾“å‡ºï¼šç†„ç­LED
        GPIOA_ODR |= (1 << 5);  // å°†ç¬¬5ä½ç½®1
        for(volatile int i=0; i<500000; i++);
    }
}
```

### 51ç‚¹ç¯å’Œstm32ç‚¹ç¯å¯¹æ¯”

| ç‰¹æ€§ | 51å•ç‰‡æœº (å¦‚AT89C51) | STM32å•ç‰‡æœº (å¦‚STM32F103) |
| --- | --- | --- |
| **ç¼–ç¨‹èŒƒå¼** | é€šå¸¸**ç›´æ¥æ“ä½œå¯„å­˜å™¨**16ï¼Œç›¸å¯¹ç®€å• | æ”¯æŒ**ç›´æ¥æ“ä½œå¯„å­˜å™¨**19ã€ä½¿ç”¨**æ ‡å‡†å¤–è®¾åº“**ï¼ˆSTDåº“ï¼‰19ã€æˆ–**HAL/LLåº“**ï¼Œå¤æ‚åº¦æ›´é«˜ï¼Œçµæ´»æ€§æ›´å¼º |
| **æ—¶é’Ÿé…ç½®** | é€šå¸¸**æ— éœ€é¢å¤–ä½¿èƒ½**GPIOç«¯å£æ—¶é’Ÿ6 | **å¿…é¡»é¦–å…ˆä½¿èƒ½**å¯¹åº”GPIOç«¯å£çš„æ—¶é’Ÿï¼ˆé€šè¿‡RCCå¯„å­˜å™¨ï¼‰189ï¼Œå¦åˆ™IOå£æ— æ³•æ­£å¸¸å·¥ä½œ |
| **GPIOæ¨¡å¼é…ç½®** | é…ç½®ç›¸å¯¹ç®€å•ï¼Œä¸»è¦æ˜¯**å‡†åŒå‘å£**ï¼ˆç±»ä¼¼å¼±ä¸Šæ‹‰ï¼‰ã€å¼€æ¼ã€å¼ºæ¨æŒ½è¾“å‡ºç­‰å°‘æ•°å‡ ç§æ¨¡å¼ | é…ç½®å¤æ‚ï¼Œéœ€é€šè¿‡**æ¨¡å¼å¯„å­˜å™¨ (MODER)**Â è®¾ç½®è¾“å…¥/è¾“å‡º/å¤ç”¨/æ¨¡æ‹Ÿï¼Œ**è¾“å‡ºç±»å‹å¯„å­˜å™¨ (OTYPER)**Â é€‰æ‹©æ¨æŒ½/å¼€æ¼ï¼Œ**é€Ÿåº¦å¯„å­˜å™¨ (OSPEEDR)**Â é€‰æ‹©è¾“å‡ºé€Ÿåº¦18 |
| **ä¸Šä¸‹æ‹‰ç”µé˜»é…ç½®** | é…ç½®é€‰é¡¹è¾ƒå°‘ | æœ‰ä¸“é—¨çš„**ä¸Šæ‹‰/ä¸‹æ‹‰å¯„å­˜å™¨ (PUPDR)**Â è¿›è¡Œé…ç½®1 |
| **æ§åˆ¶è¾“å‡ºæ–¹å¼** | ç›´æ¥å¯¹**ç«¯å£å¯„å­˜å™¨**ï¼ˆå¦‚P1ï¼‰èµ‹å€¼æˆ–ä½æ“ä½œï¼ˆå¦‚`sbit`ï¼‰167 | å¯é€šè¿‡**è¾“å‡ºæ•°æ®å¯„å­˜å™¨ (ODR)**ã€**ä½è®¾ç½®/å¤ä½å¯„å­˜å™¨ (BSRR)**ã€**å¤ä½å¯„å­˜å™¨ (BRR)**Â ç­‰å¤šç§æ–¹å¼æ§åˆ¶è¾“å‡º89 |
| **ä»£ç ç¤ºä¾‹ç‰¹ç‚¹** | ä»£ç ç®€çŸ­ï¼Œå‡ è¡Œå³å¯å®Œæˆç‚¹ç¯16 | å³ä½¿æœ€ç®€å•çš„ç‚¹ç¯ï¼Œä¹Ÿéœ€è¦è¾ƒå¤šé…ç½®ä»£ç ï¼ˆå¯„å­˜å™¨ç‰ˆï¼‰19ï¼Œåº“å‡½æ•°ç‰ˆå¯è¯»æ€§æ›´å¥½19 |
| **ä¸­æ–­åº”ç”¨** | æ”¯æŒå¤–éƒ¨ä¸­æ–­ï¼Œé…ç½®ç›¸å¯¹ç®€å• | ä¸­æ–­ç³»ç»Ÿ**é«˜åº¦å¤æ‚ä¸”çµæ´»**ï¼Œæ”¯æŒå¤šä¼˜å…ˆçº§ã€å¤§é‡ä¸­æ–­æºï¼Œéœ€é…ç½®NVICã€EXTIç­‰35 |
| **é€‚ç”¨åœºæ™¯** | ç®€å•æ§åˆ¶ã€æ•™å­¦å…¥é—¨ã€æˆæœ¬æ•æ„Ÿã€å¯¹åŠŸè€—è¦æ±‚ä¸é«˜çš„åº”ç”¨ | å¤æ‚åº”ç”¨ã€å¤šä»»åŠ¡ã€å®æ—¶æ€§è¦æ±‚é«˜ã€ä½åŠŸè€—ã€éœ€è¦ä¸°å¯Œå¤–è®¾ï¼ˆå¦‚PWMã€ADCã€å¤šç§é€šä¿¡æ¥å£ï¼‰çš„åœºæ™¯ |

* **51å•ç‰‡æœº**ï¼š**å¤§éƒ¨åˆ†æƒ…å†µä¸‹æ“ä½œI/Oå£å¹¶ä¸éœ€è¦åƒSTM32é‚£æ ·æ˜¾å¼åœ°â€œä½¿èƒ½â€ä¸€ä¸ªGPIOæ¨¡å—çš„æ—¶é’Ÿ**ï¼ˆéƒ¨åˆ†å¢å¼ºå‹51å¤–è®¾å¦‚ADCã€ä¸²å£ç­‰å¯èƒ½éœ€è¦é…ç½®ç›¸å…³å¯„å­˜å™¨æ¥â€œä½¿èƒ½â€å…¶å·¥ä½œï¼‰6ã€‚51çš„I/Oå£åŠŸèƒ½ç›¸å¯¹å›ºå®šï¼Œå¤ç”¨é€‰é¡¹å°‘ï¼Œå…¶ç«¯å£å¯„å­˜å™¨æœ¬èº«å·²ç»æ˜ å°„åˆ°äº†å›ºå®šçš„åœ°å€ï¼ˆå¦‚P2å£åœ°å€0xA0ï¼‰69ï¼Œæ“ä½œè¿™äº›åœ°å€å°±ç›¸å½“äºç›´æ¥æ§åˆ¶I/Oå£ã€‚
* **STM32çš„é…ç½®ç»´åº¦**ï¼šä½ æåˆ°çš„â€œä½¿èƒ½ã€æ¨¡å¼ã€ç±»å‹ã€é€Ÿåº¦ã€åˆå§‹çŠ¶æ€â€**éå¸¸å‡†ç¡®åœ°æ¦‚æ‹¬äº†STM32 GPIOé…ç½®çš„æ ¸å¿ƒæ­¥éª¤**18ï¼š

  + **ä½¿èƒ½æ—¶é’Ÿ (Enable)**ï¼šé€šè¿‡RCC (Reset and Clock Control) æ¨¡å—çš„**AHBxENR**æˆ–**APBxENR**å¯„å­˜å™¨å¼€å¯å¯¹åº”GPIOç«¯å£çš„æ—¶é’Ÿ189ã€‚è¿™æ˜¯STM32æ“ä½œä»»ä½•å¤–è®¾çš„**ç¬¬ä¸€æ­¥**ï¼Œä¸æ‰“å¼€æ—¶é’Ÿï¼Œåç»­æ‰€æœ‰é…ç½®éƒ½æ— æ•ˆã€‚
  + **è®¾ç½®æ¨¡å¼ (Mode)**ï¼šé€šè¿‡**GPIOx_MODER**å¯„å­˜å™¨è®¾ç½®å¼•è„šä¸º**è¾“å…¥**ã€**è¾“å‡º**ã€**å¤ç”¨åŠŸèƒ½**ï¼ˆè¿æ¥å…¶ä»–å¤–è®¾å¦‚ä¸²å£ã€SPIï¼‰è¿˜æ˜¯**æ¨¡æ‹ŸåŠŸèƒ½**ï¼ˆç”¨äºADC/DACï¼‰18ã€‚
  + **è®¾ç½®è¾“å‡ºç±»å‹ (Type)**ï¼šé€šè¿‡**GPIOx_OTYPER**å¯„å­˜å™¨é€‰æ‹©è¾“å‡ºæ˜¯**æ¨æŒ½**ï¼ˆå¼ºè¾“å‡ºé«˜ä½ç”µå¹³ï¼‰è¿˜æ˜¯**å¼€æ¼**ï¼ˆå¸¸ç”¨äºç”µå¹³è½¬æ¢ã€I2Cç­‰ï¼‰1ã€‚
  + **è®¾ç½®è¾“å‡ºé€Ÿåº¦ (Speed)**ï¼šé€šè¿‡**GPIOx_OSPEEDR**å¯„å­˜å™¨é…ç½®å¼•è„šçš„**ç¿»è½¬é€Ÿåº¦**ï¼ˆå¦‚2MHz, 50MHzï¼‰ï¼Œé€Ÿåº¦è¶Šé«˜åŠŸè€—ä¹Ÿè¶Šå¤§ï¼Œéœ€æ ¹æ®å®é™…éœ€æ±‚ï¼ˆå¦‚é˜²æ­¢ä¿¡å·æŒ¯é“ƒï¼‰é€‰æ‹©1ã€‚
  + **è®¾ç½®ä¸Š/ä¸‹æ‹‰ (Pull-up/Pull-down)**ï¼šé€šè¿‡**GPIOx_PUPDR**å¯„å­˜å™¨é…ç½®æ˜¯å¦ä½¿ç”¨å†…éƒ¨çš„ä¸Šæ‹‰æˆ–ä¸‹æ‹‰ç”µé˜»ï¼Œä»¥é¿å…å¼•è„šæ‚¬ç©ºæ—¶çš„ç”µå¹³ä¸ç¡®å®š1ã€‚
  + **åˆå§‹çŠ¶æ€**ï¼šé€šè¿‡**ODR**æˆ–**BSRR**å¯„å­˜å™¨è®¾ç½®è¾“å‡ºé«˜ä½ç”µå¹³8ã€‚
* **ä¸­æ–­ç³»ç»Ÿçš„å·®å¼‚**ï¼šSTM32çš„ä¸­æ–­ç³»ç»Ÿï¼ˆNVIC, Nested Vectored Interrupt Controllerï¼‰è¿œæ¯”51å¼ºå¤§å’Œå¤æ‚35ã€‚å®ƒæ”¯æŒ**ä¸­æ–­ä¼˜å…ˆçº§åˆ†ç»„**ã€**å¤§é‡å¤–éƒ¨ä¸­æ–­çº¿**ï¼ˆEXTIï¼‰å¹¶å¯çµæ´»æ˜ å°„åˆ°å¤šä¸ªGPIOå¼•è„šã€**ç¡¬ä»¶è‡ªåŠ¨å¤„ç†ç°åœºä¿æŠ¤å’Œæ¢å¤**ç­‰ï¼Œè¿™ä½¿å¾—STM32çš„ä¸­æ–­å“åº”æ›´å¿«é€Ÿï¼Œå®æ—¶æ€§æ›´å¼ºã€‚

ğŸ’¡Â **å¦‚ä½•é€‰æ‹©å•ç‰‡æœº**

* **é€‰æ‹©51å•ç‰‡æœº**ï¼Œå¦‚æœä½ çš„é¡¹ç›®æ˜¯**ç®€å•çš„æ§åˆ¶**ï¼ˆå¦‚ç»§ç”µå™¨å¼€å…³ã€LEDæ˜¾ç¤ºã€æŒ‰é”®æ‰«æï¼‰ã€**æ•™å­¦å…¥é—¨**ã€**å¯¹æˆæœ¬æå…¶æ•æ„Ÿ**ï¼Œæˆ–è€…**äº§å“æ‰¹é‡å¤§ä¸”åŠŸèƒ½å›ºå®š**ï¼Œ51æ˜¯ä¸é”™çš„é€‰æ‹©ã€‚
* **é€‰æ‹©STM32å•ç‰‡æœº**ï¼Œå¦‚æœä½ çš„é¡¹ç›®éœ€è¦**å¤æ‚çš„å¤„ç†**ã€**ä¸°å¯Œçš„é€šä¿¡æ¥å£**ï¼ˆå¦‚å¤šä¸ªUART, SPI, I2C, USB, CANï¼‰ã€**å®æ—¶æ€§è¦æ±‚é«˜**ï¼ˆå¦‚ç”µæœºæ§åˆ¶ï¼‰ã€éœ€è¦**ä½åŠŸè€—ç‰¹æ€§**ï¼ˆSTM32æœ‰ä¸°å¯Œçš„ä½åŠŸè€—æ¨¡å¼ï¼‰ï¼Œæˆ–è€…**æœªæ¥å¯èƒ½éœ€è¦åŠŸèƒ½å‡çº§**ï¼ŒSTM32æ›´èƒ½æ»¡è¶³éœ€æ±‚ã€‚

ğŸš€Â **è¿›é˜¶å­¦ä¹ å»ºè®®**

* **ä»51è¿‡æ¸¡åˆ°STM32**ï¼šç†è§£äº†51çš„å¯„å­˜å™¨æ“ä½œï¼Œæœ‰åŠ©äºä½ ç†è§£STM32å¯„å­˜å™¨ç¼–ç¨‹çš„æœ¬è´¨6ã€‚ä½†ä¹Ÿè¦é€‚åº”STM32æ›´å¤æ‚çš„æ—¶é’Ÿæ ‘å’Œå¤–è®¾é…ç½®æ€è·¯ã€‚
* **å–„ç”¨åº“å‡½æ•°å’Œå·¥å…·**ï¼šSTM32çš„æ ‡å‡†å¤–è®¾åº“ï¼ˆStdPeriph Libraryï¼‰æˆ–HALåº“ï¼ˆHardware Abstraction Layerï¼‰èƒ½**ç®€åŒ–é…ç½®è¿‡ç¨‹**ï¼Œæé«˜å¼€å‘æ•ˆç‡19ã€‚STM32CubeMXå·¥å…·å¯ä»¥**å›¾å½¢åŒ–é…ç½®å¼•è„šã€æ—¶é’Ÿã€å¤–è®¾**ï¼Œå¹¶ç”Ÿæˆåˆå§‹åŒ–ä»£ç ï¼Œæ˜¯æ–°æ‰‹ç¦éŸ³ã€‚
* **å…³æ³¨å®é™…åº”ç”¨**ï¼šç‚¹ç¯æ˜¯ç¬¬ä¸€æ­¥ï¼Œåç»­å¯ä»¥å°è¯•PWMè°ƒ



