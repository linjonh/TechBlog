---
layout: post
title: "C20-新特性总结"
date: 2025-03-11 14:39:38 +0800
description: "本文全面总结了C++20的重要更新, 涵盖三路比较运算符, 模板参数占位符, 概念与要求, Ranges库, std::span, 类型模板参数扩展, 编译时计算, Lambda扩展, 格式化输出, 日期与时区支持, 协程, 多线程同步原语, 同步输出流以及模块系统. 通过实际代码示例和关键点解析, 帮助读者快速掌握这些新特性, 提升开发效率."
keywords: "C++20 新特性总结"
categories: ['Modern', 'C']
tags: ['算法', 'C']
artid: "146178652"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146178652
    alt: "C20-新特性总结"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146178652
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146178652
cover: https://bing.ee123.net/img/rand?artid=146178652
image: https://bing.ee123.net/img/rand?artid=146178652
img: https://bing.ee123.net/img/rand?artid=146178652
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     C++20 新特性总结
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-dracula" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="_1">
     </a>
     简要总结
    </h3>
    <p>
     C++20 引入了四项非常大的更新, 分别是:
    </p>
    <ol>
     <li>
      概念(Concepts). 用来简化模板编程, 强化表达能力. 并且使得出错原因更容易查找.
     </li>
     <li>
      模块(Modules). 这是代码组织方面非常大的更新. 提供了新的方式来组织代码, 并且可以减少编译时间.
     </li>
     <li>
      范围库(Ranges and Views). 轻量级的, 非拥有的范围库, 允许对数据进行各种操作.
     </li>
     <li>
      协程(Coroutine). 多线程编程方面的一次重大更新.
     </li>
    </ol>
    <p>
     本文将会对 C++20 的新特性做一个简要总结, 方便读者快速了解.
    </p>
    <h3>
     <a id="1___12">
     </a>
     1. 三路比较运算符
     <code>
      &lt;=&gt;
     </code>
    </h3>
    <p>
     C++20 引入了一个新的运算符
     <code>
      &lt;=&gt;
     </code>
     , 称为
     <em>
      “三路比较运算符”
     </em>
     或
     <em>
      “spaceship 运算符”
     </em>
     . 这个运算符用于同时执行小于, 等于和大于的比较操作, 并返回一个特殊类型的值, 该类型表示两个对象之间的关系. 具体来说, 它会返回一个
     <code>
      std::strong_ordering
     </code>
     ,
     <code>
      std::weak_ordering
     </code>
     , 或者
     <code>
      std::partial_ordering
     </code>
     类型的对象, 分别对应强有序, 弱有序以及部分有序的情况.
    </p>
    <ul>
     <li>
      当左侧小于右侧时, 返回一个小于零的值(通常是
      <code>
       std::strong_ordering::less
      </code>
      ).
     </li>
     <li>
      当两侧相等时, 返回零(
      <code>
       std::strong_ordering::equal
      </code>
      ).
     </li>
     <li>
      当左侧大于右侧时, 返回一个大于零的值(
      <code>
       std::strong_ordering::greater
      </code>
      ).
     </li>
    </ul>
    <h4>
     <a id="_20">
     </a>
     示例代码
    </h4>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;compare&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword">struct</span> <span class="token class-name">Point</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">int</span> x<span class="token punctuation">,</span> y<span class="token punctuation">;</span>

  <span class="token keyword">auto</span> <span class="token keyword">operator</span><span class="token operator">&lt;=&gt;</span><span class="token punctuation">(</span><span class="token keyword">const</span> Point<span class="token operator">&amp;</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  Point a<span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span> b<span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span> c<span class="token punctuation">{<!-- --></span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">&lt;=&gt;</span> b <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"a and b are equal\n"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>a <span class="token operator">&lt;=&gt;</span> c<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"a is less than c\n"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     在这个示例中,
     <code>
      Point
     </code>
     结构体通过默认的方式实现了三路比较运算符, 这意味着编译器会自动生成所有基于成员变量的比较逻辑.
    </p>
    <p>
     进一步阅读:
     <a href="https://www.arong-xu.com/posts/cpp20-spaceship-operator-tutorial/" rel="nofollow">
      C++20 Spaceship 操作符 (‘&lt;=&gt;’): 现代 C++ 的比较利器
     </a>
    </p>
    <h3>
     <a id="2__51">
     </a>
     2. 函数参数支持占位符类型
    </h3>
    <p>
     C++20 支持在函数参数中使用
     <code>
      auto
     </code>
     关键字作为占位符. 这一特性允许你编写更加通用和灵活的函数, 而不需要指定具体的参数类型.
    </p>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword">auto</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">auto</span> a<span class="token punctuation">,</span> <span class="token keyword">auto</span> b<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span> <span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Integers: "</span> <span class="token operator">&lt;&lt;</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>     <span class="token comment">// 输出3</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Doubles: "</span> <span class="token operator">&lt;&lt;</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token number">2.5</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>  <span class="token comment">// 输出4.0</span>

  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="3__68">
     </a>
     3. 概念和要求
    </h3>
    <ul>
     <li>
      <p>
       <strong>
        概念(Concepts)
       </strong>
       : 是用于描述模板参数类型必须满足的一组要求的实体. 它们可以用来约束模板参数, 确保只有满足特定条件的类型才能被用作模板参数.
      </p>
     </li>
     <li>
      <p>
       <strong>
        要求(Requirements)
       </strong>
       : 通常指模板参数需要满足的具体条件或行为, 比如支持某种操作符, 拥有特定成员函数等.
      </p>
     </li>
    </ul>
    <p>
     假设我们想要定义一个函数模板, 该模板只接受那些可以进行比较操作(例如
     <code>
      &lt;
     </code>
     )的类型. 在 C++20 之前, 这可能需要使用 SFINAE 或者
     <code>
      static_assert
     </code>
     来实现, 但现在我们可以直接使用概念来简化这一过程.
    </p>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;concepts&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>

<span class="token comment">// 定义一个名为Sortable的概念, 要求类型T支持小于运算符</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">concept</span> <span class="token class-name">Sortable</span> <span class="token operator">=</span> <span class="token keyword">requires</span><span class="token punctuation">(</span>T a<span class="token punctuation">,</span> T b<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token punctuation">{<!-- --></span> a <span class="token operator">&lt;</span> b <span class="token punctuation">}</span> <span class="token operator">-&gt;</span> std<span class="token double-colon punctuation">::</span>convertible_to<span class="token operator">&lt;</span><span class="token keyword">bool</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 仅对Sortable类型的参数有效</span>
<span class="token keyword">void</span> <span class="token function">sortFunction</span><span class="token punctuation">(</span>Sortable <span class="token keyword">auto</span><span class="token operator">&amp;</span> container<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 假设这里实现了排序逻辑</span>
<span class="token punctuation">}</span>

<span class="token keyword">struct</span> <span class="token class-name">MyType</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">int</span> value<span class="token punctuation">;</span>
  <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token keyword">const</span> MyType<span class="token operator">&amp;</span> other<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> value <span class="token operator">&lt;</span> other<span class="token punctuation">.</span>value<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">sortFunction</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 正确, int支持&lt;运算</span>

  MyType myArr<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">sortFunction</span><span class="token punctuation">(</span>myArr<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 正确, MyType也重载了&lt;运算符</span>

  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="_107">
     </a>
     关键点解析
    </h4>
    <ul>
     <li>
      <p>
       <strong>
        概念定义
       </strong>
       : 通过
       <code>
        concept
       </code>
       关键字定义概念, 然后使用
       <code>
        requires
       </code>
       子句列出类型必须满足的要求. 在这个例子中,
       <code>
        Sortable
       </code>
       概念要求类型支持
       <code>
        &lt;
       </code>
       运算, 并且结果可以转换为
       <code>
        bool
       </code>
       .
      </p>
     </li>
     <li>
      <p>
       <strong>
        应用概念
       </strong>
       : 在模板声明中使用概念作为约束, 如
       <code>
        Sortable auto&amp;
       </code>
       , 这样就限制了传入的容器元素类型必须满足
       <code>
        Sortable
       </code>
       概念.
      </p>
     </li>
    </ul>
    <p>
     使用概念不仅使代码更易于理解, 而且当传入不符合概念要求的类型时, 编译器能提供更有意义的错误消息, 从而大大提高了开发效率. 此外, 概念还支持复杂的组合和继承关系, 使得构建复杂的需求系统成为可能.
    </p>
    <p>
     进一步阅读:
     <a href="https://www.arong-xu.com/posts/cpp20-concepts-in-action/" rel="nofollow">
      C++20 Concepts 简介
     </a>
    </p>
    <h3>
     <a id="4_rangesviews__117">
     </a>
     4. ranges/views 库
    </h3>
    <p>
     C++20 引入了
     <strong>
      Ranges
     </strong>
     和
     <strong>
      Views
     </strong>
     , 它们是标准库的一部分, 旨在简化容器, 数组和其他序列数据的操作. 通过 Ranges 和 Views, 可以更直观地处理数据序列, 并支持函数式编程风格. 它们提供了强大的工具来创建, 组合以及操作数据流, 而无需手动迭代或复制数据.
    </p>
    <p>
     <strong>
      Ranges
     </strong>
     是 C++20 中的一个新概念, 它扩展了 STL(标准模板库)的容器和算法, 使得操作序列更加直观和高效. 一个 Range 是一个可以遍历的数据序列, 它可以是有限的也可以是无限的. Ranges 的核心思想是将算法与容器解耦, 允许以声明式的方式定义数据处理流程.
    </p>
    <p>
     <strong>
      Views
     </strong>
     是轻量级, 非拥有的范围, 它们提供了一种方式来查看原始数据的一种特定视角, 而不实际拥有数据. 这意味着 views 不会复制数据, 而是基于原始数据进行计算, 这使得它们非常高效且节省内存.
    </p>
    <p>
     以下是一个使用 C++20 Ranges 和 Views 的例子, 展示了如何使用这些新特性来过滤和转换数据:
    </p>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fmt/ranges.h&gt;</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ranges&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> vec <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">// 使用views过滤出偶数, 并对每个元素加1</span>
  <span class="token keyword">auto</span> result <span class="token operator">=</span> vec <span class="token operator">|</span> std<span class="token double-colon punctuation">::</span>views<span class="token double-colon punctuation">::</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> n <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">|</span>
                std<span class="token double-colon punctuation">::</span>views<span class="token double-colon punctuation">::</span><span class="token function">transform</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> n <span class="token operator">*</span> n<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 打印结果</span>
  fmt<span class="token double-colon punctuation">::</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 输出: [0, 4, 16, 36, 64]</span>

  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="_150">
     </a>
     关键点解析
    </h4>
    <ul>
     <li>
      <p>
       <strong>
        管道操作符(
        <code>
         |
        </code>
        )
       </strong>
       : Ranges 和 Views 支持使用管道操作符来链式调用各种视图操作, 如过滤(
       <code>
        filter
       </code>
       ), 转换(
       <code>
        transform
       </code>
       )等, 使得代码更加简洁和易读.
      </p>
     </li>
     <li>
      <p>
       <strong>
        Filter 和 Transform
       </strong>
       : 在这个例子中, 我们首先使用
       <code>
        std::views::filter
       </code>
       来筛选出所有偶数, 然后使用
       <code>
        std::views::transform
       </code>
       对每个筛选出的数字加 1. 这两个操作都是惰性求值的, 也就是说, 它们只有在真正需要时才会执行相应的计算.
      </p>
     </li>
     <li>
      <p>
       <strong>
        性能优势
       </strong>
       : 由于 views 不复制数据, 它们可以在处理大量数据时提供显著的性能优势. 此外, 由于它们的惰性求值特性, 只有当真正访问数据时才会进行计算, 这也进一步提高了效率.
      </p>
     </li>
    </ul>
    <p>
     进一步阅读:
     <a href="https://www.arong-xu.com/posts/master-cpp-ranges-views/" rel="nofollow">
      Modern C++ Ranges/View 库简介
     </a>
    </p>
    <h3>
     <a id="5_stdspan_160">
     </a>
     5.
     <code>
      std::span
     </code>
    </h3>
    <p>
     <code>
      std::span
     </code>
     是一个轻量级, 非拥有的视图, 用于表示连续内存序列(如数组,
     <code>
      std::vector
     </code>
     等). 它不拥有数据, 而是提供对数据的引用, 因此避免了不必要的复制, 同时提供了对序列的安全访问.
    </p>
    <p>
     主要特点:
    </p>
    <ol>
     <li>
      <strong>
       非拥有
      </strong>
      :
      <code>
       std::span
      </code>
      不管理内存, 仅作为数据的视图.
     </li>
     <li>
      <strong>
       连续内存
      </strong>
      : 适用于连续内存的数据结构, 如数组,
      <code>
       std::vector
      </code>
      等.
     </li>
     <li>
      <strong>
       安全性
      </strong>
      : 支持边界检查, 避免越界访问.
     </li>
     <li>
      <strong>
       灵活性
      </strong>
      : 可以表示固定大小或动态大小的序列.
     </li>
    </ol>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fmt/ranges.h&gt;</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;span&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>span<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> span<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> fmt<span class="token double-colon punctuation">::</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"{}"</span><span class="token punctuation">,</span> span<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 使用 std::span 查看数组</span>
  <span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">print</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 输出: 1 2 3 4 5</span>

  <span class="token comment">// 使用 std::span 查看 vector</span>
  std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> vec <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">print</span><span class="token punctuation">(</span>vec<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 输出: 6 7 8 9 10</span>

  <span class="token comment">// 使用 std::span 查看部分数据</span>
  std<span class="token double-colon punctuation">::</span>span<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> <span class="token function">partial</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">print</span><span class="token punctuation">(</span>partial<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 输出: 7 8 9</span>

  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <code>
      std::span
     </code>
     是处理连续内存序列的强大工具, 尤其适用于需要高效传递和操作数据的场景.
    </p>
    <p>
     进一步阅读: {
     <!-- -->
     {&lt; PostRef path=“/posts/2024-07-31-cpp20-span.md” &gt;}}
    </p>
    <h3>
     <a id="6__200">
     </a>
     6. 类型模板参数扩展
    </h3>
    <p>
     C++20 对非类型模板参数(Non-Type Template Parameters, NTTP)进行了扩展, 允许使用更多类型的非类型模板参数. 在 C++17 及之前, 非类型模板参数只能是整型, 指针, 引用或枚举类型. C++20 扩展了这一能力,
    </p>
    <p>
     NTTP 支持如下类型:
    </p>
    <ol>
     <li>
      浮点类型
     </li>
     <li>
      结构体和简单类
     </li>
     <li>
      Lambda
     </li>
    </ol>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string_view&gt;</span></span>

<span class="token comment">// 使用浮点类型作为非类型模板参数</span>
<span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">double</span> Value<span class="token operator">&gt;</span>
<span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Double value: "</span> <span class="token operator">&lt;&lt;</span> Value <span class="token operator">&lt;&lt;</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 浮点类型模板参数</span>
  <span class="token generic-function"><span class="token function">print</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token number">3.14</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 输出: Double value: 3.14</span>

  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     优势:
    </p>
    <ul>
     <li>
      <strong>
       更强的表达能力
      </strong>
      : 支持更多类型的非类型模板参数, 使得模板编程更加灵活.
     </li>
     <li>
      <strong>
       编译时计算
      </strong>
      : 结合
      <code>
       constexpr
      </code>
      和模板元编程, 可以在编译时进行更复杂的计算和优化.
     </li>
    </ul>
    <p>
     C++20 的非类型模板参数扩展为模板编程带来了更多可能性, 尤其是在需要编译时处理浮点数或字符串的场景中非常有用.
    </p>
    <h3>
     <a id="7__235">
     </a>
     7. 编译时计算
    </h3>
    <p>
     C++20 在编译时计算(Compile-Time Computing)方面引入了一些新特性, 使得在编译时进行复杂的计算和优化变得更加方便.
    </p>
    <ol>
     <li>
      <code>
       constexpr
      </code>
      增强: C++20 进一步扩展了
      <code>
       constexpr
      </code>
      的使用范围, 允许在编译时执行更多的操作, 包括动态内存分配, 异常处理等.
     </li>
     <li>
      <code>
       constinit
      </code>
      : 表示一个全局变量或常
      <code>
       static
      </code>
      类型变量在编译时完成初始化.
      <code>
       constinit
      </code>
      =
      <code>
       constexpr - const
      </code>
      . 注意
      <code>
       constinit
      </code>
      修饰的变量是允许后续修改内容的.
     </li>
     <li>
      <code>
       consteval
      </code>
      : 用于定义必须在编译时求值的函数.
     </li>
    </ol>
    <pre><code class="prism language-cpp"><span class="token keyword">constexpr</span> <span class="token keyword">int</span> <span class="token function">square</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">consteval</span> <span class="token keyword">int</span> <span class="token function">triple</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> x <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">constexpr</span> <span class="token keyword">int</span> CX_VAL <span class="token operator">=</span> <span class="token function">square</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 编译期计算</span>
  <span class="token comment">// CX_VAL = 1;                     // 错误, 常量不可修改</span>
  <span class="token keyword">int</span> val <span class="token operator">=</span> <span class="token function">square</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 初始化普通变量</span>
  <span class="token function">square</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// OK, 可以在运行时计算</span>

  <span class="token keyword">constinit</span> <span class="token keyword">static</span> <span class="token keyword">int</span> value <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>  <span class="token comment">// 在编译期初始化, 但不是常量</span>
  value <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
  <span class="token comment">// constinit int value2 = 10; // 错误, constinit 只能用于静态变量或者全局变量</span>

  <span class="token keyword">const</span> <span class="token keyword">int</span> data <span class="token operator">=</span> <span class="token function">triple</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 合法, 因为在编译期求值</span>
  <span class="token comment">// triple(runtime);          // 错误, 不能在在运行期求值</span>

  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     进一步阅读:
     <a href="https://www.arong-xu.com/posts/cpp-constexpr-consteval-constinit-intro/" rel="nofollow">
      C++ constexpr, consteval 和 constinit 简要介绍
     </a>
    </p>
    <h3>
     <a id="8_lambda__266">
     </a>
     8. lambda 扩展
    </h3>
    <p>
     C++20 对 Lambda 表达式进行了一些扩展, 使得 Lambda 更加灵活和强大. 以下是 C++20 中 Lambda 表达式的主要扩展特性:
    </p>
    <ol>
     <li>
      <p>
       <strong>
        模板 Lambda
       </strong>
       : C++20 允许在 Lambda 表达式中使用模板参数, 使得 Lambda 可以处理不同类型的参数.
      </p>
      <pre><code class="prism language-cpp"><span class="token keyword">auto</span> genericLambda <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>T a<span class="token punctuation">,</span> T b<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// logic here</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
     </li>
     <li>
      <p>
       <code>
        this
       </code>
       捕获: C++20 引入了
       <code>
        [*this]
       </code>
       捕获方式, 允许在 Lambda 中捕获当前对象的副本, 而不是引用.
      </p>
     </li>
     <li>
      <p>
       <code>
        consteval
       </code>
       和
       <code>
        constexpr
       </code>
       Lambda: Lambda 表达式现在可以标记为
       <code>
        consteval
       </code>
       或
       <code>
        constexpr
       </code>
       , 以便在编译时求值.
      </p>
     </li>
    </ol>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fmt/core.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fmt/ranges.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 1. 泛型 Lambda</span>
  <span class="token keyword">auto</span> generic <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>T a<span class="token punctuation">,</span> T b<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

  fmt<span class="token double-colon punctuation">::</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Generic Lambda (int): {}"</span><span class="token punctuation">,</span> <span class="token function">generic</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">// 输出: 3</span>
  fmt<span class="token double-colon punctuation">::</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Generic Lambda (double): {}"</span><span class="token punctuation">,</span> <span class="token function">generic</span><span class="token punctuation">(</span><span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token number">2.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 输出: 4.0</span>

  <span class="token comment">// 2. `constexpr` Lambda</span>
  <span class="token keyword">constexpr</span> <span class="token keyword">auto</span> constexprLambda <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token keyword">constexpr</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">constexpr</span> <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token function">constexprLambda</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  fmt<span class="token double-colon punctuation">::</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Constexpr Lambda: {}"</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 输出: 7</span>

  <span class="token comment">// 3. `[*this]` 捕获</span>
  <span class="token keyword">struct</span> <span class="token class-name">MyStruct</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> value <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>
    <span class="token keyword">auto</span> <span class="token function">getLambda</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  MyStruct obj<span class="token punctuation">;</span>
  <span class="token keyword">auto</span> lambda <span class="token operator">=</span> obj<span class="token punctuation">.</span><span class="token function">getLambda</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  obj<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
  fmt<span class="token double-colon punctuation">::</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Lambda with [*this] capture: {}"</span><span class="token punctuation">,</span> <span class="token function">lambda</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 输出: 42</span>

  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="9__315">
     </a>
     9. 格式化输出
    </h3>
    <p>
     C++20 引入了新的格式化输出库
     <code>
      std::format
     </code>
     , 它提供了一种类型安全且更灵活的字符串格式化方式, 类似于 Python 的
     <code>
      str.format()
     </code>
     .
     <code>
      std::format
     </code>
     通过使用格式化字符串和占位符来生成格式化的输出, 避免了传统
     <code>
      printf
     </code>
     风格函数中的类型不安全问题.
    </p>
    <ol>
     <li>
      <strong>
       类型安全
      </strong>
      :
      <code>
       std::format
      </code>
      是类型安全的, 编译器会在编译时检查格式字符串和参数的类型是否匹配.
     </li>
     <li>
      <strong>
       简洁易读
      </strong>
      : 格式化字符串使用
      <code>
       {}
      </code>
      作为占位符, 语法简洁且易于理解.
     </li>
     <li>
      <strong>
       支持自定义类型
      </strong>
      : 可以通过重载
      <code>
       std::formatter
      </code>
      来支持自定义类型的格式化输出.
     </li>
    </ol>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;format&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>
  <span class="token keyword">double</span> pi <span class="token operator">=</span> <span class="token number">3.14159</span><span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>string name <span class="token operator">=</span> <span class="token string">"Alice"</span><span class="token punctuation">;</span>

  <span class="token comment">// 基本格式化</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"Number: {}, Pi: {:.2f}, Name: {}\n"</span><span class="token punctuation">,</span> num<span class="token punctuation">,</span> pi<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 输出: Number: 42, Pi: 3.14, Name: Alice</span>

  <span class="token comment">// 格式化字符串存储到变量</span>
  std<span class="token double-colon punctuation">::</span>string formatted <span class="token operator">=</span>
      std<span class="token double-colon punctuation">::</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"Number: {}, Pi: {:.2f}, Name: {}"</span><span class="token punctuation">,</span> num<span class="token punctuation">,</span> pi<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> formatted <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
  <span class="token comment">// 输出: Number: 42, Pi: 3.14, Name: Alice</span>

  <span class="token comment">// 格式化字符串中的位置参数</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"Name: {2}, Pi: {1:.2f}, Number: {0}\n"</span><span class="token punctuation">,</span> num<span class="token punctuation">,</span> pi<span class="token punctuation">,</span>
                           name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 输出: Name: Alice, Pi: 3.14, Number: 42</span>

  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     进一步阅读:
     <a href="https://www.arong-xu.com/posts/cpp23-std-print-and-println-introduction/" rel="nofollow">
      C++23 格式化输出新特性详解: std::print 和 std::println
     </a>
    </p>
    <h3>
     <a id="10_chrono__353">
     </a>
     10.
     <code>
      chrono
     </code>
     新增日期和时区
    </h3>
    <p>
     C++20 在
     <code>
      &lt;chrono&gt;
     </code>
     库中引入了对日期, 时间和时区的支持, 使得处理日期和时间变得更加方便和强大. 新的特性包括对日历日期的支持, 时区转换以及时间点之间的计算等.
    </p>
    <ol>
     <li>
      <strong>
       日历日期支持
      </strong>
      : C++20 引入了
      <code>
       year
      </code>
      ,
      <code>
       month
      </code>
      ,
      <code>
       day
      </code>
      等类型, 用于表示日历日期.
     </li>
     <li>
      <strong>
       时间点扩展
      </strong>
      :
      <code>
       sys_time
      </code>
      和
      <code>
       local_time
      </code>
      分别表示系统时间和本地时间.
     </li>
     <li>
      <strong>
       时区支持
      </strong>
      :
      <code>
       time_zone
      </code>
      和
      <code>
       zoned_time
      </code>
      用于处理时区转换.
     </li>
     <li>
      <strong>
       日历运算
      </strong>
      : 支持日期的加减运算, 如计算两个日期之间的天数.
     </li>
    </ol>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;chrono&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;format&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token double-colon punctuation">::</span>chrono<span class="token punctuation">;</span>

  <span class="token comment">// 1. 创建日历日期</span>
  year_month_day today <span class="token operator">=</span> <span class="token number">2025</span>y <span class="token operator">/</span> March <span class="token operator">/</span> <span class="token number">6</span>d<span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Today is: "</span> <span class="token operator">&lt;&lt;</span> today <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>  <span class="token comment">// 输出: 2025-03-06</span>

  <span class="token comment">// 2. 创建时间点</span>
  sys_time<span class="token operator">&lt;</span>seconds<span class="token operator">&gt;</span> sys_now <span class="token operator">=</span> <span class="token generic-function"><span class="token function">time_point_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>seconds<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>system_clock<span class="token double-colon punctuation">::</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"System time now: "</span> <span class="token operator">&lt;&lt;</span> sys_now <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>  <span class="token comment">// 输出当前系统时间</span>

  <span class="token comment">// 3. 时区转换</span>
  <span class="token keyword">auto</span> utc_time <span class="token operator">=</span> sys_now<span class="token punctuation">;</span>
  <span class="token keyword">auto</span> local_time <span class="token operator">=</span> zoned_time<span class="token punctuation">{<!-- --></span><span class="token function">current_zone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> utc_time<span class="token punctuation">}</span><span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Local time now: "</span> <span class="token operator">&lt;&lt;</span> local_time
            <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>  <span class="token comment">// 输出当前本地时间</span>

  <span class="token comment">// 4. 计算两个日期之间的天数</span>
  year_month_day next_week <span class="token operator">=</span> sys_days<span class="token punctuation">{<!-- --></span>today<span class="token punctuation">}</span> <span class="token operator">+</span> days<span class="token punctuation">{<!-- --></span><span class="token number">7</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Next week is: "</span> <span class="token operator">&lt;&lt;</span> next_week <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>  <span class="token comment">// 输出: 2025-03-13</span>

  <span class="token comment">// 5. 格式化输出</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"Today is {:%Y-%m-%d}\n"</span><span class="token punctuation">,</span>
                           today<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 输出: Today is 2025-03-06</span>

  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     进一步阅读:
     <a href="https://www.arong-xu.com/posts/cpp-chrono-in-a-nutshell-date-time-calendar-clock/" rel="nofollow">
      一文读懂 C++ chrono 库: duration, clocks, date, timezone
     </a>
    </p>
    <h3>
     <a id="11__398">
     </a>
     11. 协程
    </h3>
    <p>
     C++20 的协程设计比较复杂, 可以参考以下链接:
     <br/>
     <a href="https://www.arong-xu.com/posts/cpp20-coroutine-introduction/" rel="nofollow">
      Modern C++ Coroutine 简介
     </a>
    </p>
    <h3>
     <a id="12_stdjthread__stop_token_403">
     </a>
     12.
     <code>
      std::jthread
     </code>
     和
     <code>
      stop_token
     </code>
    </h3>
    <p>
     C++20 引入了
     <code>
      std::jthread
     </code>
     和
     <code>
      std::stop_token
     </code>
     , 它们为多线程编程提供了更安全和更方便的线程管理机制.
     <code>
      std::jthread
     </code>
     是
     <code>
      std::thread
     </code>
     的增强版本, 支持在离开作用域时自动
     <code>
      join
     </code>
     , 而
     <code>
      std::stop_token
     </code>
     提供了一种机制来请求线程停止执行.
    </p>
    <ol>
     <li>
      <p>
       <code>
        std::jthread
       </code>
       :
      </p>
      <ul>
       <li>
        自动管理线程的生命周期, 析构时会自动调用
        <code>
         join()
        </code>
        , 确保线程在销毁前完成执行.
       </li>
       <li>
        支持
        <code>
         std::stop_token
        </code>
        , 允许线程在外部请求停止执行.
       </li>
      </ul>
     </li>
     <li>
      <p>
       <code>
        std::stop_token
       </code>
       和
       <code>
        std::stop_source
       </code>
       :
      </p>
      <ul>
       <li>
        <code>
         std::stop_token
        </code>
        用于检查是否收到停止请求.
       </li>
       <li>
        <code>
         std::stop_source
        </code>
        用于发出停止请求.
       </li>
       <li>
        两者可以配合使用, 实现线程的优雅停止.
       </li>
      </ul>
     </li>
    </ol>
    <p>
     以下是一个简单的示例, 展示了如何使用
     <code>
      std::jthread
     </code>
     和
     <code>
      std::stop_token
     </code>
     :
    </p>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;thread&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stop_token&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;chrono&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">worker</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>stop_token stopToken<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>stopToken<span class="token punctuation">.</span><span class="token function">stop_requested</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Working...\n"</span><span class="token punctuation">;</span>
        std<span class="token double-colon punctuation">::</span>this_thread<span class="token double-colon punctuation">::</span><span class="token function">sleep_for</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>chrono<span class="token double-colon punctuation">::</span><span class="token function">seconds</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Stopped by request.\n"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 创建一个 jthread, 并传递 worker 函数</span>
    std<span class="token double-colon punctuation">::</span>jthread <span class="token function">t</span><span class="token punctuation">(</span>worker<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 主线程等待 3 秒</span>
    std<span class="token double-colon punctuation">::</span>this_thread<span class="token double-colon punctuation">::</span><span class="token function">sleep_for</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>chrono<span class="token double-colon punctuation">::</span><span class="token function">seconds</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 请求线程停止</span>
    t<span class="token punctuation">.</span><span class="token function">request_stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// jthread 析构时会自动 join, 确保线程完成执行</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     输出
    </p>
    <pre><code class="prism language-plaintext">Working...
Working...
Working...
Stopped by request.
</code></pre>
    <p>
     进一步阅读:
     <a href="https://www.arong-xu.com/posts/cpp20-jthread-guide/" rel="nofollow">
      C++20 std::jthread 完全指南 - 简化多线程编程与线程管理
     </a>
    </p>
    <h3>
     <a id="13__459">
     </a>
     13. 并发特性
    </h3>
    <h4>
     <a id="latches__barriers_461">
     </a>
     <code>
      latches
     </code>
     和
     <code>
      barriers
     </code>
    </h4>
    <p>
     <code>
      std::latch
     </code>
     是一种同步原语, 用于确保一组线程在继续执行之前等待某个操作完成.
     <code>
      std::latch
     </code>
     一旦倒数到零, 就不能重置. 它非常适合用于等待一组线程完成初始化或其他初始化操作.
    </p>
    <ul>
     <li>
      <strong>
       构造函数
      </strong>
      : 接受一个计数器, 表示需要等待的线程数量.
     </li>
     <li>
      <strong>
       count_down()
      </strong>
      : 递减计数器.
     </li>
     <li>
      <strong>
       wait()
      </strong>
      : 阻塞当前线程, 直到计数器归零.
     </li>
    </ul>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;latch&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;thread&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">worker</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>latch<span class="token operator">&amp;</span> latch<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 模拟工作</span>
  std<span class="token double-colon punctuation">::</span>this_thread<span class="token double-colon punctuation">::</span><span class="token function">sleep_for</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>chrono<span class="token double-colon punctuation">::</span><span class="token function">seconds</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Worker thread done\n"</span><span class="token punctuation">;</span>
  latch<span class="token punctuation">.</span><span class="token function">count_down</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  std<span class="token double-colon punctuation">::</span>latch <span class="token function">latch</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 等待3个线程</span>

  std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>thread<span class="token operator">&gt;</span> threads<span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    threads<span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>worker<span class="token punctuation">,</span> std<span class="token double-colon punctuation">::</span><span class="token function">ref</span><span class="token punctuation">(</span>latch<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  latch<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 主线程等待所有工作线程完成</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"All worker threads are done\n"</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> t <span class="token operator">:</span> threads<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    t<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <hr/>
    <h5>
     <a id="Barriers__503">
     </a>
     Barriers (栅栏)
    </h5>
    <p>
     <code>
      std::barrier
     </code>
     类似于
     <code>
      std::latch
     </code>
     , 但它可以被重置.
     <code>
      std::barrier
     </code>
     用于一组线程在继续执行之前等待所有线程到达某个同步点. 所有线程到达后, 它们可以继续执行, 而
     <code>
      std::barrier
     </code>
     也可以被重置以便再次使用.
    </p>
    <ul>
     <li>
      <strong>
       构造函数
      </strong>
      : 接受一个计数器, 表示需要等待的线程数量.
     </li>
     <li>
      <strong>
       arrive_and_wait()
      </strong>
      : 递减计数器并阻塞当前线程, 直到所有线程到达.
     </li>
     <li>
      <strong>
       arrive_and_drop()
      </strong>
      : 递减计数器但不等待其他线程.
     </li>
     <li>
      <strong>
       arrive_and_wait()
      </strong>
      : 递减计数器并阻塞当前线程, 直到所有线程到达.
     </li>
    </ul>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;barrier&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;thread&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">worker</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>barrier<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span> barrier<span class="token punctuation">,</span> <span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Worker "</span> <span class="token operator">&lt;&lt;</span> id <span class="token operator">&lt;&lt;</span> <span class="token string">" is ready\n"</span><span class="token punctuation">;</span>
  barrier<span class="token punctuation">.</span><span class="token function">arrive_and_wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 等待所有线程到达</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Worker "</span> <span class="token operator">&lt;&lt;</span> id <span class="token operator">&lt;&lt;</span> <span class="token string">" is processing\n"</span><span class="token punctuation">;</span>
  barrier<span class="token punctuation">.</span><span class="token function">arrive_and_wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 等待所有线程完成处理</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Worker "</span> <span class="token operator">&lt;&lt;</span> id <span class="token operator">&lt;&lt;</span> <span class="token string">" is done\n"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  std<span class="token double-colon punctuation">::</span>barrier <span class="token function">barrier</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 等待3个线程</span>

  std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>thread<span class="token operator">&gt;</span> threads<span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    threads<span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>worker<span class="token punctuation">,</span> std<span class="token double-colon punctuation">::</span><span class="token function">ref</span><span class="token punctuation">(</span>barrier<span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> t <span class="token operator">:</span> threads<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    t<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     更多阅读:
     <a href="https://www.arong-xu.com/posts/cpp-multi-thread-programming-with-latch-and-barrier/" rel="nofollow">
      C++ Latch 和 Barrier: 新手指南
     </a>
    </p>
    <h4>
     <a id="Semaphores_544">
     </a>
     Semaphores
    </h4>
    <p>
     C++20 引入了
     <code>
      std::counting_semaphore
     </code>
     和
     <code>
      std::binary_semaphore
     </code>
     作为同步原语, 用于多线程编程中的资源管理. 信号量(Semaphore)是一种用于控制多个线程对共享资源访问的机制. 信号量维护一个计数器, 该计数器表示可用资源的数量. 当一个线程需要访问资源时, 它会尝试获取信号量; 如果计数器大于零, 则线程可以访问资源, 并将计数器减一; 如果计数器为零, 则线程会被阻塞, 直到有其他线程释放资源.
    </p>
    <ul>
     <li>
      <code>
       std::counting_semaphore
      </code>
      : 用于管理多个资源的访问. 构造函数接受一个初始计数值, 表示可用资源的数量.
     </li>
     <li>
      <code>
       std::binary_semaphore
      </code>
      : 特殊的计数信号量, 等价于
      <code>
       std::counting_semaphore&lt;1&gt;
      </code>
      , 用于二进制信号量的场景.
     </li>
     <li>
      <code>
       acquire()
      </code>
      : 尝试获取信号量, 如果计数器大于零, 则计数器减一; 否则, 线程会被阻塞.
     </li>
     <li>
      <code>
       try_acquire()
      </code>
      : 尝试获取信号量, 如果计数器大于零, 则计数器减一并返回
      <code>
       true
      </code>
      ; 否则, 立即返回
      <code>
       false
      </code>
      .
     </li>
     <li>
      <code>
       release()
      </code>
      : 释放信号量, 将计数器加一, 唤醒一个等待的线程(如果有).
     </li>
    </ul>
    <h5>
     <a id="_stdcounting_semaphore_554">
     </a>
     使用
     <code>
      std::counting_semaphore
     </code>
    </h5>
    <ul>
     <li>
      创建了一个
      <code>
       std::counting_semaphore
      </code>
      , 初始计数为 5, 表示有 5 个可用资源.
     </li>
     <li>
      10 个线程尝试获取信号量, 但只有 5 个线程可以同时工作, 其余线程会被阻塞, 直到有其他线程释放信号量.
     </li>
    </ul>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;semaphore&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;thread&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span>

std<span class="token double-colon punctuation">::</span>counting_semaphore<span class="token operator">&lt;</span><span class="token number">5</span><span class="token operator">&gt;</span> <span class="token function">sem</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 指定模板参数类型为 int</span>

<span class="token keyword">void</span> <span class="token function">worker</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  sem<span class="token punctuation">.</span><span class="token function">acquire</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 尝试获取信号量</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Worker "</span> <span class="token operator">&lt;&lt;</span> id <span class="token operator">&lt;&lt;</span> <span class="token string">" is working\n"</span><span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>this_thread<span class="token double-colon punctuation">::</span><span class="token function">sleep_for</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>chrono<span class="token double-colon punctuation">::</span><span class="token function">seconds</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 模拟工作</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Worker "</span> <span class="token operator">&lt;&lt;</span> id <span class="token operator">&lt;&lt;</span> <span class="token string">" is done\n"</span><span class="token punctuation">;</span>
  sem<span class="token punctuation">.</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 释放信号量</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>thread<span class="token operator">&gt;</span> threads<span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    threads<span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>worker<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> t <span class="token operator">:</span> threads<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    t<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h5>
     <a id="_stdbinary_semaphore_589">
     </a>
     使用
     <code>
      std::binary_semaphore
     </code>
    </h5>
    <ul>
     <li>
      创建了一个
      <code>
       std::binary_semaphore
      </code>
      , 初始计数为 0, 表示资源不可用.
     </li>
     <li>
      工作者线程尝试获取信号量, 但会被阻塞, 直到生产者线程释放信号量, 表示资源可用.
     </li>
    </ul>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;semaphore&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;thread&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span>

std<span class="token double-colon punctuation">::</span>binary_semaphore <span class="token function">sem</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 初始状态为0, 表示资源不可用</span>

<span class="token keyword">void</span> <span class="token function">worker</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  sem<span class="token punctuation">.</span><span class="token function">acquire</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 尝试获取信号量</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Worker "</span> <span class="token operator">&lt;&lt;</span> id <span class="token operator">&lt;&lt;</span> <span class="token string">" is working\n"</span><span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>this_thread<span class="token double-colon punctuation">::</span><span class="token function">sleep_for</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>chrono<span class="token double-colon punctuation">::</span><span class="token function">seconds</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 模拟工作</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Worker "</span> <span class="token operator">&lt;&lt;</span> id <span class="token operator">&lt;&lt;</span> <span class="token string">" is done\n"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">producer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  std<span class="token double-colon punctuation">::</span>this_thread<span class="token double-colon punctuation">::</span><span class="token function">sleep_for</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>chrono<span class="token double-colon punctuation">::</span><span class="token function">seconds</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 模拟生产时间</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Producer is ready\n"</span><span class="token punctuation">;</span>
  sem<span class="token punctuation">.</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 释放信号量, 表示资源可用</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  std<span class="token double-colon punctuation">::</span>thread <span class="token function">t1</span><span class="token punctuation">(</span>worker<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>thread <span class="token function">t2</span><span class="token punctuation">(</span>producer<span class="token punctuation">)</span><span class="token punctuation">;</span>

  t1<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  t2<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     更多阅读:
     <a href="https://www.arong-xu.com/posts/cpp-condition-variable-and-semaphore/" rel="nofollow">
      条件变量 vs 信号量: 如何选择适合你的多线程同步工具?
     </a>
    </p>
    <h4>
     <a id="Synchronized_Output_Streams_628">
     </a>
     Synchronized Output Streams
    </h4>
    <p>
     C++20 引入了
     <code>
      std::osyncstream
     </code>
     作为同步输出流, 用于确保在多线程环境中对输出流的写操作是线程安全的.
     <code>
      std::osyncstream
     </code>
     是一个同步输出流缓冲区, 它将输出操作缓冲起来, 然后在析构时将缓冲区的内容原子地写入到目标输出流中. 这避免了多个线程同时写入输出流时可能出现的交错输出问题.
    </p>
    <ul>
     <li>
      <strong>
       线程安全
      </strong>
      :
      <code>
       std::osyncstream
      </code>
      确保对输出流的写操作是线程安全的.
     </li>
     <li>
      <strong>
       缓冲区
      </strong>
      : 输出操作会被缓冲, 直到
      <code>
       std::osyncstream
      </code>
      对象被销毁或显式刷新.
     </li>
     <li>
      <strong>
       自动刷新
      </strong>
      : 当
      <code>
       std::osyncstream
      </code>
      对象被销毁时, 缓冲区的内容会自动刷新到目标输出流.
     </li>
    </ul>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;syncstream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;thread&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">worker</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">,</span> <span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  std<span class="token double-colon punctuation">::</span>osyncstream <span class="token function">sync_os</span><span class="token punctuation">(</span>os<span class="token punctuation">)</span><span class="token punctuation">;</span>
  sync_os <span class="token operator">&lt;&lt;</span> <span class="token string">"Worker "</span> <span class="token operator">&lt;&lt;</span> id <span class="token operator">&lt;&lt;</span> <span class="token string">" is starting\n"</span><span class="token punctuation">;</span>
  std<span class="token double-colon punctuation">::</span>this_thread<span class="token double-colon punctuation">::</span><span class="token function">sleep_for</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>chrono<span class="token double-colon punctuation">::</span><span class="token function">milliseconds</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  sync_os <span class="token operator">&lt;&lt;</span> <span class="token string">"Worker "</span> <span class="token operator">&lt;&lt;</span> id <span class="token operator">&lt;&lt;</span> <span class="token string">" is done\n"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>thread<span class="token operator">&gt;</span> threads<span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    threads<span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>worker<span class="token punctuation">,</span> std<span class="token double-colon punctuation">::</span><span class="token function">ref</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>cout<span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> t <span class="token operator">:</span> threads<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    t<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     输出示例
    </p>
    <pre><code>Worker 1 is starting
Worker 1 is done
Worker 0 is starting
Worker 0 is done
Worker 4 is starting
Worker 4 is done
Worker 2 is starting
Worker 2 is done
Worker 3 is starting
Worker 3 is done
</code></pre>
    <p>
     每个线程的输出都是完整的, 不会与其他线程的输出交错, 这得益于
     <code>
      std::osyncstream
     </code>
     的线程安全特性.
    </p>
    <p>
     进一步阅读:
     <a href="https://www.arong-xu.com/posts/cpp20-osyncstream-guide/" rel="nofollow">
      C++20 std::osyncstream 完全指南 - 解决多线程输出混乱问题
     </a>
    </p>
    <h3>
     <a id="14_Modules_682">
     </a>
     14. Modules
    </h3>
    <p>
     C++20 引入了模块(Modules), 这是一种新的代码组织方式, 旨在替代传统的头文件(
     <code>
      #include
     </code>
     )机制. 模块提供了更好的编译性能, 更清晰的代码结构以及更强的封装性.
    </p>
    <ol>
     <li>
      <strong>
       编译性能提升
      </strong>
      : 模块避免了头文件的重复解析, 从而显著减少了编译时间.
     </li>
     <li>
      <strong>
       封装性增强
      </strong>
      : 模块可以控制哪些符号对外可见, 哪些符号仅在模块内部使用.
     </li>
     <li>
      <strong>
       减少宏污染
      </strong>
      : 模块不会像头文件那样引入宏定义, 避免了宏污染问题.
     </li>
     <li>
      <strong>
       简化依赖管理
      </strong>
      : 模块的依赖关系更加清晰, 减少了复杂的头文件包含顺序问题.
     </li>
    </ol>
    <h4>
     <a id="_691">
     </a>
     代码示例
    </h4>
    <p>
     以下是一个简单的模块示例, 展示了如何定义和使用模块:
    </p>
    <p>
     {
     <!-- -->
     {&lt; CodeTabs &gt;}}
    </p>
    <p>
     {
     <!-- -->
     {&lt; Code title=“math.ixx” &gt;}}
    </p>
    <pre><code class="prism language-cpp"><span class="token keyword">export</span> <span class="token keyword">module</span> <span class="token module">math</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span> <span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">int</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> a <span class="token operator">*</span> b<span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre>
    <p>
     {
     <!-- -->
     {&lt; /Code &gt;}}
    </p>
    <p>
     {
     <!-- -->
     {&lt; Code title=“main.cpp” &gt;}}
    </p>
    <pre><code class="prism language-cpp"><span class="token keyword">import</span> <span class="token module">math</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Add: "</span> <span class="token operator">&lt;&lt;</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>            <span class="token comment">// 输出: Add: 5</span>
  std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Multiply: "</span> <span class="token operator">&lt;&lt;</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>  <span class="token comment">// 输出: Multiply: 6</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     {
     <!-- -->
     {&lt; /Code &gt;}}
    </p>
    <p>
     {
     <!-- -->
     {&lt; Code title=“CMakeLists.txt” &gt;}}
    </p>
    <pre><code class="prism language-cmake">add_library(simple_module)
target_sources(simple_module
        PUBLIC
        FILE_SET CXX_MODULES FILES
        math.ixx
)
add_executable(simple_demo main.cpp)
target_link_libraries(simple_demo simple_module)
</code></pre>
    <p>
     {
     <!-- -->
     {&lt; /Code &gt;}}
    </p>
    <p>
     {
     <!-- -->
     {&lt; /CodeTabs &gt;}}
    </p>
    <p>
     进一步阅读:
     <a href="https://www.arong-xu.com/posts/cpp20-module-in-action/" rel="nofollow">
      CMake 构建 C++20 Module 实例(使用 MSVC)
     </a>
    </p>
    <h3>
     <a id="_743">
     </a>
     其他改进
    </h3>
    <h4>
     <a id="String_Members_starts_with_and_ends_with_745">
     </a>
     String Members
     <code>
      starts_with()
     </code>
     and
     <code>
      ends_with()
     </code>
    </h4>
    <pre><code class="prism language-cpp">std<span class="token double-colon punctuation">::</span>string str <span class="token operator">=</span> <span class="token string">"Hello, World!"</span><span class="token punctuation">;</span>

<span class="token comment">// 检查字符串是否以 "Hello" 开头</span>
<span class="token function">assert</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">starts_with</span><span class="token punctuation">(</span><span class="token string">"Hello"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 检查字符串是否以 '!' 结尾</span>
<span class="token function">assert</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">ends_with</span><span class="token punctuation">(</span><span class="token char">'!'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <h4>
     <a id="_string__reserve_757">
     </a>
     受限的
     <code>
      string
     </code>
     成员函数
     <code>
      reserve()
     </code>
    </h4>
    <p>
     对于 string 来说, 成员函数
     <code>
      reserve
     </code>
     不能再用于请求缩小字符串的容量(内存分配给字符串的值).
    </p>
    <h4>
     <a id="ssize_761">
     </a>
     新的工具类函数
     <code>
      ssize()
     </code>
    </h4>
    <pre><code class="prism language-cpp"><span class="token comment">// int与size_t的比较会导致编译器警告</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> std<span class="token double-colon punctuation">::</span><span class="token function">ssize</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token punctuation">}</span>

<span class="token comment">// 使用ssize, 得到有符号的类型</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> std<span class="token double-colon punctuation">::</span><span class="token function">ssize</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="stdsource_location_773">
     </a>
     <code>
      std::source_location
     </code>
    </h4>
    <p>
     代码位置, 帮助追踪代码位置.
    </p>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fmt/core.h&gt;</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;source_location&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">auto</span> sl <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span>source_location<span class="token double-colon punctuation">::</span><span class="token function">current</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  fmt<span class="token double-colon punctuation">::</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"file: {}"</span><span class="token punctuation">,</span> sl<span class="token punctuation">.</span><span class="token function">file_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  fmt<span class="token double-colon punctuation">::</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"function: {}"</span><span class="token punctuation">,</span> sl<span class="token punctuation">.</span><span class="token function">function_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  fmt<span class="token double-colon punctuation">::</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"line/col: {}/{}"</span><span class="token punctuation">,</span> sl<span class="token punctuation">.</span><span class="token function">line</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sl<span class="token punctuation">.</span><span class="token function">column</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="_791">
     </a>
     专栏目录
    </h3>
    <p>
     <a href="https://www.arong-xu.com/posts/modern-cpp/cpp17-new-features-overview/" rel="nofollow">
      C++17 新特性总结
     </a>
     <br/>
     <a href="https://www.arong-xu.com/posts/modern-cpp/cpp20-new-features-overview/" rel="nofollow">
      C++20 新特性总结
     </a>
     <br/>
     <a href="https://www.arong-xu.com/posts/modern-cpp/cpp23-new-features-overview/" rel="nofollow">
      C++23 新特性总结
     </a>
     <br/>
     <a href="https://www.arong-xu.com/posts/cpp26-new-features-preview/" rel="nofollow">
      C++26 新特性预览(Preview)
     </a>
    </p>
    <h4>
     <a id="_798">
     </a>
     说明
    </h4>
    <p>
     本专栏的文章同步发布在 CSDN 和我的个人网站上. 由于 CSDN 的排版限制, 诸如代码高亮, 链接到 Compiler Explorer 的代码段等特殊格式可能会被移除, 感兴趣的读者可以访问我的
     <a href="https://www.arong-xu.com/posts/modern-cpp/cpp20-new-features-overview/" rel="nofollow">
      原贴
     </a>
     .
    </p>
    <p>
     此外, 文中包含许多指向我个人网站的链接, 逐一修正这些链接需要大量时间和精力, 暂时无法完成, 敬请谅解. 感谢您的理解与支持!
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a:2f2f626c6f672e6373646e2e6e65742f61726f6e675f78752f:61727469636c652f64657461696c732f313436313738363532" class_="artid" style="display:none">
 </p>
</div>


