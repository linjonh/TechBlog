---
layout: post
title: "Java代码审计-第一篇Spring应用程序架构审计要点"
date: 2025-03-07 14:48:37 +0800
description: "Spring 是一个功能强大的 Java 开源框架，主要用于简化 Java 企业级应用开发。它提供了依赖注入（DI）、面向切面编程（AOP）、事务管理等核心特性，并支持集成各种 Java 技术（如 JDBC、JPA、Spring MVC）。Spring 通过 IoC（控制反转）容器管理对象生命周期，减少了代码耦合，提高了开发效率。"
keywords: "【Java代码审计 | 第一篇】Spring应用程序架构审计要点"
categories: ['Java']
tags: ['开发语言', 'Spring', 'Java']
artid: "146087645"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146087645
    alt: "Java代码审计-第一篇Spring应用程序架构审计要点"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146087645
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146087645
cover: https://bing.ee123.net/img/rand?artid=146087645
image: https://bing.ee123.net/img/rand?artid=146087645
img: https://bing.ee123.net/img/rand?artid=146087645
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     【Java代码审计 | 第一篇】Spring应用程序架构审计要点
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <blockquote>
     <p>
      未经许可，不得转载。
     </p>
    </blockquote>
    <p>
    </p>
    <p>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/892c1dc4ebd94ce8a3a9fedf5670cf1f.png"/>
    </p>
    <p>
     在开展Java代码审计之前，需先夯实相关基础知识，以确保审计过程更加高效和精准。
    </p>
    <p>
     请同时参考：
     <a href="https://blog.csdn.net/2301_77485708/category_12642835.html">
      【Java开发指南 | CSDN秋说】
     </a>
    </p>
    <h2>
     <a id="Spring_12">
     </a>
     Spring应用程序分层架构
    </h2>
    <p>
     Spring 是一个功能强大的 Java 开源框架，主要用于简化 Java 企业级应用开发。它提供了依赖注入（DI）、面向切面编程（AOP）、事务管理等核心特性，并支持集成各种 Java 技术（如 JDBC、JPA、Spring MVC）。Spring 通过 IoC（控制反转）容器管理对象生命周期，减少了代码耦合，提高了开发效率。
    </p>
    <p>
     Spring 与 Java 的关系密切，它基于 Java 语言构建，广泛应用于 Java Web 开发、微服务架构（如 Spring Boot 和 Spring Cloud），成为 Java 生态中最主流的开发框架之一。
    </p>
    <p>
     Spring 适用于大规模、细粒度控制的企业级开发，Spring Boot 更适合快速开发、微服务架构。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/9091574fde4f4be69be13edf4fec0bf8.png"/>
    </p>
    <h3>
     <a id="1_View__23">
     </a>
     1. 表现层（View 层）
    </h3>
    <p>
     <strong>
      定义
     </strong>
     ：处理用户界面展示，常使用JSP、Thymeleaf、Freemarker等模板引擎
    </p>
    <p>
     <strong>
      核心组件
     </strong>
     ：
    </p>
    <ul>
     <li>
      模板文件（.jsp/.html）
     </li>
     <li>
      视图解析器（ViewResolver）
     </li>
     <li>
      前端控制器（DispatcherServlet）
     </li>
    </ul>
    <p>
     <strong>
      审计要点
     </strong>
     ：
    </p>
    <pre><code class="prism language-jsp">&lt;!-- 漏洞示例：未转义的XSS漏洞 --&gt;
&lt;p&gt;${userInput}&lt;/p&gt;  &lt;!-- 危险写法 --&gt;
&lt;p th:text="${userInput}"&gt;&lt;/p&gt;  &lt;!-- 安全写法 --&gt;
</code></pre>
    <ul>
     <li>
      模板引擎是否开启自动HTML转义
     </li>
     <li>
      动态内容输出时是否强制使用安全输出语法
     </li>
     <li>
      客户端渲染（如Vue/React）与服务器端渲染的混合使用场景
     </li>
    </ul>
    <h3>
     <a id="2_API__49">
     </a>
     2. 接口层（API 层）
    </h3>
    <p>
     <strong>
      定义
     </strong>
     ：提供RESTful/SOAP等API接口，使用
     <code>
      @RestController
     </code>
     标注
    </p>
    <p>
     <strong>
      典型特征
     </strong>
     ：
    </p>
    <ul>
     <li>
      接口响应格式（JSON/XML）
     </li>
     <li>
      统一状态码管理（如200/401/500）
     </li>
    </ul>
    <p>
     <strong>
      审计要点
     </strong>
     ：
    </p>
    <pre><code class="prism language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/user"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">getUser</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span> <span class="token class-name">String</span> id<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 未经验证的参数</span>
    <span class="token keyword">return</span> userService<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <ul>
     <li>
      接口鉴权缺失（如未使用
      <code>
       @PreAuthorize
      </code>
      ）
     </li>
     <li>
      敏感数据未脱敏（如密码字段返回给前端）
     </li>
     <li>
      未限制HTTP方法（如PUT/DELETE权限控制）
     </li>
    </ul>
    <h3>
     <a id="3_Controller__72">
     </a>
     3. 控制器层（Controller 层）
    </h3>
    <p>
     <strong>
      核心组件
     </strong>
     ：
     <code>
      @Controller
     </code>
     、
     <code>
      @RequestMapping
     </code>
    </p>
    <p>
     <strong>
      处理流程
     </strong>
     ：
    </p>
    <ol>
     <li>
      接收HTTP请求参数
     </li>
     <li>
      调用Service层处理业务
     </li>
     <li>
      返回视图或数据模型
     </li>
    </ol>
    <p>
     <strong>
      审计要点
     </strong>
     ：
    </p>
    <pre><code class="prism language-java"><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/download"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">downloadFile</span><span class="token punctuation">(</span><span class="token class-name">String</span> filename<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"/uploads/"</span> <span class="token operator">+</span> filename<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 路径遍历漏洞风险</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre>
    <ul>
     <li>
      参数绑定漏洞（如
      <code>
       @RequestParam
      </code>
      未校验格式）
     </li>
     <li>
      未处理文件上传大小限制（导致DoS攻击）
     </li>
     <li>
      重定向未校验目标地址（开放重定向漏洞）
     </li>
    </ul>
    <h3>
     <a id="4_Service__97">
     </a>
     4. 业务逻辑层（Service 层）
    </h3>
    <p>
     <strong>
      核心组件
     </strong>
     ：
     <code>
      @Service
     </code>
     注解类
    </p>
    <p>
     <strong>
      职责
     </strong>
     ：
    </p>
    <ul>
     <li>
      实现核心业务规则
     </li>
     <li>
      事务管理（
      <code>
       @Transactional
      </code>
      ）
     </li>
    </ul>
    <p>
     <strong>
      审计示例
     </strong>
     ：
    </p>
    <pre><code class="prism language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentService</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">transfer</span><span class="token punctuation">(</span><span class="token class-name">Account</span> from<span class="token punctuation">,</span> <span class="token class-name">Account</span> <span class="token keyword">to</span><span class="token punctuation">,</span> <span class="token class-name">BigDecimal</span> amount<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        from<span class="token punctuation">.</span><span class="token function">withdraw</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 未加事务锁可能导致并发问题</span>
        <span class="token keyword">to</span><span class="token punctuation">.</span><span class="token function">deposit</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      审计要点
     </strong>
     ：
    </p>
    <ul>
     <li>
      业务规则绕过（如支付金额负数校验缺失）
     </li>
     <li>
      事务未处理回滚（如数据库异常后数据不一致）
     </li>
     <li>
      循环依赖导致的空指针异常
     </li>
    </ul>
    <h3>
     <a id="5_DAO___Repository__123">
     </a>
     5. 数据访问层（DAO 层 / Repository 层）
    </h3>
    <p>
     <strong>
      技术栈
     </strong>
     ：JDBC、JPA、MyBatis
    </p>
    <p>
     <strong>
      核心组件
     </strong>
     ：
    </p>
    <ul>
     <li>
      <code>
       @Repository
      </code>
      注解类
     </li>
     <li>
      JpaRepository接口实现
     </li>
    </ul>
    <p>
     <strong>
      漏洞示例
     </strong>
     ：
    </p>
    <pre><code class="prism language-java"><span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span><span class="token string">"SELECT u FROM User u WHERE u.username = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span> <span class="token comment">// SQL注入风险</span>
<span class="token class-name">User</span> <span class="token function">findByUsername</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <strong>
      审计要点
     </strong>
     ：
    </p>
    <ul>
     <li>
      动态SQL拼接（MyBatis中
      <code>
       ${}
      </code>
      误用）
     </li>
     <li>
      JPA方法名注入（如
      <code>
       findByUsername
      </code>
      参数未过滤）
     </li>
     <li>
      连接池配置泄露（如未加密数据库密码）
     </li>
    </ul>
    <h3>
     <a id="6_Model__144">
     </a>
     6. 模型层（Model 层）
    </h3>
    <p>
     <strong>
      组成
     </strong>
     ：POJO类（如
     <code>
      User.java
     </code>
     ）、DTO、VO
    </p>
    <p>
     <strong>
      审计关注点
     </strong>
     ：
    </p>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Size</span><span class="token punctuation">(</span>min<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span> max<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span> 
    <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span> <span class="token comment">// 长度校验但未限制复杂度</span>
<span class="token punctuation">}</span>
</code></pre>
    <ul>
     <li>
      数据验证注解（如
      <code>
       @NotNull
      </code>
      、
      <code>
       @Pattern
      </code>
      ）的完整性
     </li>
     <li>
      敏感字段（如密码）是否标记为
      <code>
       @Transient
      </code>
      避免持久化
     </li>
     <li>
      DTO与实体类转换时的属性拷贝漏洞
     </li>
    </ul>
    <h3>
     <a id="7_Configuration__161">
     </a>
     7. 配置层（Configuration 层）
    </h3>
    <p>
     <strong>
      配置文件
     </strong>
     ：
     <code>
      application.properties
     </code>
     、
     <code>
      @Configuration
     </code>
     类
    </p>
    <p>
     <strong>
      关键配置项
     </strong>
     ：
    </p>
    <pre><code class="prism language-properties"># 安全风险示例：关闭CSRF保护
spring.security.csrf.enabled=false 
</code></pre>
    <p>
     <strong>
      审计要点
     </strong>
     ：
    </p>
    <ul>
     <li>
      CORS配置过于宽松（如
      <code>
       allowedOrigins=*
      </code>
      ）
     </li>
     <li>
      敏感信息硬编码（数据库密码、API密钥）
     </li>
     <li>
      日志级别泄露调试信息（如开启DEBUG模式）
     </li>
    </ul>
    <h3>
     <a id="8_Utility__177">
     </a>
     8. 工具层（Utility 层）
    </h3>
    <p>
     <strong>
      常见类
     </strong>
     ：
     <code>
      StringUtils
     </code>
     、
     <code>
      DateUtils
     </code>
     、加密工具类
    </p>
    <p>
     <strong>
      漏洞案例
     </strong>
     ：
    </p>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token class-name">String</span> input<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 使用不安全的MD5哈希</span>
    <span class="token keyword">return</span> <span class="token class-name">DigestUtils</span><span class="token punctuation">.</span><span class="token function">md5Hex</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      审计重点
     </strong>
     ：
    </p>
    <ul>
     <li>
      弱加密算法（如DES、MD5）
     </li>
     <li>
      随机数生成器（
      <code>
       java.util.Random
      </code>
      替代SecureRandom）
     </li>
     <li>
      反射调用未做安全限制
     </li>
    </ul>
    <h3>
     <a id="9_Cache__195">
     </a>
     9. 缓存层（Cache 层）
    </h3>
    <p>
     <strong>
      技术实现
     </strong>
     ：Redis、Ehcache、
     <code>
      @Cacheable
     </code>
     注解
    </p>
    <p>
     <strong>
      风险场景
     </strong>
     ：
    </p>
    <pre><code class="prism language-java"><span class="token annotation punctuation">@Cacheable</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"users"</span><span class="token punctuation">,</span> key <span class="token operator">=</span> <span class="token string">"#username"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">getUser</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> 
    <span class="token comment">// 缓存未设置过期时间导致敏感数据长期驻留</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      审计要点
     </strong>
     ：
    </p>
    <ul>
     <li>
      缓存穿透/击穿/雪崩防护机制
     </li>
     <li>
      本地缓存未隔离不同用户数据
     </li>
     <li>
      Redis未启用SSL通信加密
     </li>
    </ul>
    <h3>
     <a id="10_Messaging__213">
     </a>
     10. 消息处理层（Messaging 层）
    </h3>
    <p>
     <strong>
      技术组件
     </strong>
     ：Kafka、RabbitMQ、JMS
    </p>
    <p>
     <strong>
      漏洞示例
     </strong>
     ：
    </p>
    <pre><code class="prism language-java"><span class="token annotation punctuation">@JmsListener</span><span class="token punctuation">(</span>destination <span class="token operator">=</span> <span class="token string">"orderQueue"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">processOrder</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 未验证消息来源，导致恶意消息注入</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      审计重点
     </strong>
     ：
    </p>
    <ul>
     <li>
      消息消费者未做身份验证
     </li>
     <li>
      消息内容未加密（敏感信息泄露）
     </li>
     <li>
      死信队列未监控导致消息堆积
     </li>
    </ul>
    <h3>
     <a id="11_Async__231">
     </a>
     11. 异步层（Async 层）
    </h3>
    <p>
     <strong>
      实现方式
     </strong>
     ：
     <code>
      @Async
     </code>
     注解、线程池
    </p>
    <p>
     <strong>
      风险代码
     </strong>
     ：
    </p>
    <pre><code class="prism language-java"><span class="token annotation punctuation">@Async</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">logAccess</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 异步方法内未捕获异常，导致线程崩溃</span>
    accessLogService<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      审计关注点
     </strong>
     ：
    </p>
    <ul>
     <li>
      线程池资源耗尽（未设置合理队列大小）
     </li>
     <li>
      异步任务未记录日志（难以追踪问题）
     </li>
     <li>
      CompletableFuture回调链中的空指针异常
     </li>
    </ul>
    <h3>
     <a id="12_Security__251">
     </a>
     12. 安全层（Security 层）
    </h3>
    <p>
     <strong>
      框架
     </strong>
     ：Spring Security、Shiro
    </p>
    <p>
     <strong>
      配置要点
     </strong>
     ：
    </p>
    <pre><code class="prism language-java"><span class="token annotation punctuation">@Override</span>
<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
    http<span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/admin/**"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasRole</span><span class="token punctuation">(</span><span class="token string">"ADMIN"</span><span class="token punctuation">)</span> <span class="token comment">// 权限配置</span>
        <span class="token punctuation">.</span><span class="token function">anyRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      审计重点
     </strong>
     ：
    </p>
    <ul>
     <li>
      URL权限配置遗漏（如
      <code>
       /actuator/**
      </code>
      未保护）
     </li>
     <li>
      密码存储策略（是否使用BCrypt加密）
     </li>
     <li>
      CSRF Token未绑定到用户会话
     </li>
    </ul>
    <h3>
     <a id="13_Audit__270">
     </a>
     13. 审计层（Audit 层）
    </h3>
    <p>
     <strong>
      实现方式
     </strong>
     ：
     <code>
      @Audit
     </code>
     注解、AOP切面
    </p>
    <p>
     <strong>
      审计要求
     </strong>
     ：
    </p>
    <pre><code class="prism language-java"><span class="token annotation punctuation">@Aspect</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AuditAspect</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@AfterReturning</span><span class="token punctuation">(</span><span class="token string">"execution(* com.example.service.*.*(..))"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">logAction</span><span class="token punctuation">(</span><span class="token class-name">JoinPoint</span> joinPoint<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 未记录操作人ID和IP地址</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <ul>
     <li>
      关键操作日志缺失（如账户删除、权限变更）
     </li>
     <li>
      日志未脱敏（记录完整信用卡号）
     </li>
     <li>
      日志文件权限过宽（所有用户可读）
     </li>
    </ul>
    <h3>
     <a id="14_Filter__288">
     </a>
     14. 过滤器层（Filter 层）
    </h3>
    <p>
     <strong>
      常见过滤器
     </strong>
     ：
    </p>
    <ul>
     <li>
      认证过滤器（AuthenticationFilter）
     </li>
     <li>
      XSS防护过滤器
     </li>
     <li>
      请求日志过滤器
     </li>
    </ul>
    <p>
     <strong>
      漏洞案例
     </strong>
     ：
    </p>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">XssFilter</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token class-name">ServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">ServletResponse</span> res<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> chain<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 仅过滤POST参数，遗漏GET参数</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      审计要点
     </strong>
     ：
    </p>
    <ul>
     <li>
      过滤顺序错误（如先执行业务逻辑后过滤）
     </li>
     <li>
      全局异常处理未覆盖过滤器中的异常
     </li>
     <li>
      敏感请求头（如Authorization）未清除
     </li>
    </ul>
    <h3>
     <a id="15_Servlet__312">
     </a>
     15. Servlet 层
    </h3>
    <p>
     <strong>
      核心对象
     </strong>
     ：HttpServletRequest、HttpServletResponse
    </p>
    <p>
     <strong>
      风险代码
     </strong>
     ：
    </p>
    <pre><code class="prism language-java"><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">String</span> param <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"input"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    resp<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 直接输出未过滤</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      审计重点
     </strong>
     ：
    </p>
    <ul>
     <li>
      自定义Servlet的URL映射冲突
     </li>
     <li>
      未禁用TRACE/TRACK方法
     </li>
     <li>
      响应头未设置安全策略（如Content-Security-Policy）
     </li>
    </ul>
    <h2>
     <a id="_330">
     </a>
     底层支撑
    </h2>
    <h3>
     <a id="16_JDBC_331">
     </a>
     16. JDBC
    </h3>
    <p>
     <strong>
      定义
     </strong>
     ：
    </p>
    <p>
     JDBC（Java Database Connectivity）是 Java 语言用于访问关系型数据库的 API，提供了一套标准接口，使 Java 应用程序能够与不同类型的数据库（如 MySQL、PostgreSQL、Oracle）进行交互。
    </p>
    <p>
     <strong>
      风险代码
     </strong>
     ：
    </p>
    <pre><code class="prism language-java"><span class="token class-name">Statement</span> stmt <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ResultSet</span> rs <span class="token operator">=</span> stmt<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token string">"SELECT * FROM users WHERE id="</span> <span class="token operator">+</span> input<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// SQL注入</span>
</code></pre>
    <p>
     <strong>
      防护措施
     </strong>
     ：
    </p>
    <ul>
     <li>
      使用PreparedStatement绑定参数
     </li>
     <li>
      验证数据库连接池配置（如maxActive限制）
     </li>
    </ul>
    <h3>
     <a id="17_Tomcat_349">
     </a>
     17. Tomcat
    </h3>
    <p>
     <strong>
      定义
     </strong>
     ：
    </p>
    <p>
     Tomcat 是一个开源的 Java Servlet 容器，用于运行 Java Web 应用程序（如 JSP 和 Servlet）。它实现了 Java EE 规范（如 Servlet、JSP），并提供 HTTP 服务器功能，广泛用于 Web 应用的部署和运行。
    </p>
    <p>
     <strong>
      关键配置
     </strong>
     ：
    </p>
    <pre><code class="prism language-xml"><span class="token comment">&lt;!-- server.xml 中禁用不必要协议 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Connector</span> <span class="token attr-name">port</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>8080<span class="token punctuation">"</span></span> <span class="token attr-name">protocol</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>HTTP/1.1<span class="token punctuation">"</span></span> 
           <span class="token attr-name">maxThreads</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>200<span class="token punctuation">"</span></span> <span class="token attr-name">relaxedQueryChars</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>[]<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span> <span class="token comment">&lt;!-- 允许特殊字符可能引发解析问题 --&gt;</span>
</code></pre>
    <p>
     <strong>
      审计重点
     </strong>
     ：
    </p>
    <ul>
     <li>
      禁用AJP协议（如不需要）
     </li>
     <li>
      错误页面未泄露版本信息
     </li>
     <li>
      会话固定防护配置
     </li>
    </ul>
    <h3>
     <a id="18_Maven_369">
     </a>
     18. Maven
    </h3>
    <p>
     <strong>
      定义
     </strong>
     ：
    </p>
    <p>
     Maven 是一个 项目管理和构建工具，用于管理 Java 项目的依赖、构建、测试和部署。它基于 pom.xml 文件定义项目结构，并通过 中央仓库（Maven Central）下载和管理第三方依赖组件，确保项目的可复现性和一致性。
    </p>
    <p>
     <strong>
      依赖风险
     </strong>
     ：
    </p>
    <pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>commons-collections<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>commons-collections<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.2.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span> <span class="token comment">&lt;!-- 已知存在反序列化漏洞 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <p>
     <strong>
      检查项
     </strong>
     ：
    </p>
    <ul>
     <li>
      使用
      <code>
       mvn dependency:tree
      </code>
      排查漏洞组件
     </li>
     <li>
      确保SNAPSHOT版本未上线生产环境
     </li>
     <li>
      仓库地址使用HTTPS协议
     </li>
    </ul>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323330315f37373438353730382f:61727469636c652f64657461696c732f313436303837363435" class_="artid" style="display:none">
 </p>
</div>


