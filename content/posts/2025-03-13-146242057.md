---
layout: post
title: "Redis-Sentinel-åŠ-Redisson-è¿æ¥é—®é¢˜å…¨è§£æ"
date: 2025-03-13 20:52:02 +0800
description: "åœ¨ Kubernetes (k8s) ç¯å¢ƒä¸‹ä½¿ç”¨ Redis Sentinel è¿›è¡Œé«˜å¯ç”¨éƒ¨ç½²æ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°ã€‚Redisson æ˜¯ä¸€ä¸ªé«˜æ•ˆçš„ Redis å®¢æˆ·ç«¯ï¼Œæ”¯æŒ Redis Sentinel æ¨¡å¼ã€‚æœ¬æ–‡å°†å¯¹è¿™äº›é—®é¢˜è¿›è¡Œæ±‡æ€»åˆ†æï¼Œå¹¶æä¾›è¯¦ç»†çš„è§£å†³æ–¹æ¡ˆã€‚ï¼Œè¯´æ˜æ²¡æœ‰å¯ç”¨å‰¯æœ¬ï¼ŒSentinel å¯èƒ½æ— æ³•å®Œæˆåˆ‡æ¢ã€‚å¦‚æœ Sentinel Pod æŒ‚äº†ï¼Œéœ€è¦é‡æ–°å¯åŠ¨ã€‚ä¸å­˜åœ¨ï¼Œè¯´æ˜ Sentinel é…ç½®é”™è¯¯ã€‚éœ€è¦åŒ¹é… Sentinel é…ç½®ã€‚"
keywords: "Redis Sentinel åŠ Redisson è¿æ¥é—®é¢˜å…¨è§£æ"
categories: ['æœªåˆ†ç±»']
tags: ['Sentinel', 'Redis', 'Bootstrap']
artid: "146242057"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146242057
    alt: "Redis-Sentinel-åŠ-Redisson-è¿æ¥é—®é¢˜å…¨è§£æ"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146242057
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146242057
cover: https://bing.ee123.net/img/rand?artid=146242057
image: https://bing.ee123.net/img/rand?artid=146242057
img: https://bing.ee123.net/img/rand?artid=146242057
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Redis Sentinel åŠ Redisson è¿æ¥é—®é¢˜å…¨è§£æ
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     åœ¨ Kubernetes (k8s) ç¯å¢ƒä¸‹ä½¿ç”¨ Redis Sentinel è¿›è¡Œé«˜å¯ç”¨éƒ¨ç½²æ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°
     <strong>
      failover è¶…æ—¶
     </strong>
     ã€
     <strong>
      Sentinel è¯¯åˆ¤
     </strong>
     ã€
     <strong>
      Spring Boot è¿æ¥å¤±è´¥
     </strong>
     ä»¥åŠ
     <strong>
      Redisson é…ç½®é”™è¯¯
     </strong>
     ç­‰é—®é¢˜ã€‚æœ¬æ–‡å°†å¯¹è¿™äº›é—®é¢˜è¿›è¡Œæ±‡æ€»åˆ†æï¼Œå¹¶æä¾›è¯¦ç»†çš„è§£å†³æ–¹æ¡ˆã€‚
    </p>
    <hr/>
    <h3>
     <a id="1_Redis_Sentinel__5">
     </a>
     <strong>
      1ï¸âƒ£ Redis Sentinel ä»‹ç»
     </strong>
    </h3>
    <p>
     <strong>
      Redis Sentinel
     </strong>
     æ˜¯ Redis çš„é«˜å¯ç”¨ç»„ä»¶ï¼Œä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š
    </p>
    <ul>
     <li>
      <strong>
       ä¸»èŠ‚ç‚¹æ•…éšœæ£€æµ‹
      </strong>
      ï¼šåˆ¤æ–­ Redis ä¸»èŠ‚ç‚¹æ˜¯å¦å®•æœºã€‚
     </li>
     <li>
      <strong>
       è‡ªåŠ¨æ•…éšœè½¬ç§»
      </strong>
      ï¼šå½“ä¸»èŠ‚ç‚¹ä¸å¯ç”¨æ—¶ï¼Œé€‰ä¸¾æ–°çš„ä¸»èŠ‚ç‚¹ã€‚
     </li>
     <li>
      <strong>
       é€šçŸ¥å®¢æˆ·ç«¯
      </strong>
      ï¼šåº”ç”¨ç¨‹åºï¼ˆå¦‚ Spring Bootã€Redissonï¼‰å¯ä»¥é€šè¿‡ Sentinel è·å–æœ€æ–°çš„ä¸»èŠ‚ç‚¹åœ°å€ã€‚
     </li>
    </ul>
    <p>
     <strong>
      Redis Sentinel å…³é”®é…ç½®ï¼ˆsentinel.confï¼‰ï¼š
     </strong>
    </p>
    <pre><code class="prism language-conf">sentinel monitor mymaster redis-master 6379 2
sentinel down-after-milliseconds mymaster 5000
sentinel failover-timeout mymaster 60000
sentinel parallel-syncs mymaster 1
</code></pre>
    <ul>
     <li>
      <code>
       down-after-milliseconds mymaster 5000
      </code>
      ï¼šå¦‚æœ 5 ç§’å†…ä¸»èŠ‚ç‚¹æ— å“åº”ï¼Œè®¤ä¸ºå…¶ä¸å¯ç”¨ã€‚
     </li>
     <li>
      <code>
       failover-timeout mymaster 60000
      </code>
      ï¼šSentinel å…è®¸ 60 ç§’å†…å®Œæˆæ•…éšœè½¬ç§»ã€‚
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="2_Redis_Sentinel__23">
     </a>
     <strong>
      2ï¸âƒ£ Redis Sentinel æŠ¥é”™åˆ†æ
     </strong>
    </h3>
    <h4>
     <a id="__1Redis__failovertimeout_24">
     </a>
     <strong>
      ğŸš¨ é—®é¢˜ 1ï¼šRedis æ—¥å¿—æŠ¥
      <code>
       failover-timeout
      </code>
     </strong>
    </h4>
    <h5>
     <a id="__25">
     </a>
     <strong>
      ğŸ” å¯èƒ½åŸå› 
     </strong>
    </h5>
    <ul>
     <li>
      <strong>
       å‰¯æœ¬åŒæ­¥æœªå®Œæˆ
      </strong>
      ï¼ŒSentinel ä¸èƒ½ç«‹å³é€‰å‡ºæ–°çš„ä¸»èŠ‚ç‚¹ã€‚
     </li>
     <li>
      <strong>
       ç½‘ç»œæŠ–åŠ¨
      </strong>
      ï¼Œå¯¼è‡´ Sentinel è¯¯åˆ¤ä¸»èŠ‚ç‚¹å®•æœºã€‚
     </li>
     <li>
      <strong>
       Sentinel æ•°é‡ä¸è¶³
      </strong>
      ï¼Œæ— æ³•è¿›è¡Œæœ‰æ•ˆæŠ•ç¥¨ã€‚
     </li>
    </ul>
    <h5>
     <a id="__30">
     </a>
     <strong>
      âœ… è§£å†³æ–¹æ¡ˆ
     </strong>
    </h5>
    <p>
     1ï¸âƒ£
     <strong>
      æ£€æŸ¥ Redis å‰¯æœ¬åŒæ­¥çŠ¶æ€
     </strong>
     ï¼š
    </p>
    <pre><code class="prism language-sh">kubectl <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> redis-master-0 -- redis-cli INFO replication
</code></pre>
    <p>
     å¦‚æœ
     <code>
      connected_slaves: 0
     </code>
     ï¼Œè¯´æ˜æ²¡æœ‰å¯ç”¨å‰¯æœ¬ï¼ŒSentinel å¯èƒ½æ— æ³•å®Œæˆåˆ‡æ¢ã€‚
    </p>
    <p>
     2ï¸âƒ£
     <strong>
      å¢å¤§
      <code>
       failover-timeout
      </code>
     </strong>
     ï¼š
    </p>
    <pre><code class="prism language-conf">sentinel failover-timeout mymaster 120000  # å¢åŠ è‡³ 120 ç§’
</code></pre>
    <p>
     ç„¶åé‡å¯ Sentinelï¼š
    </p>
    <pre><code class="prism language-sh">kubectl delete pod <span class="token parameter variable">-l</span> <span class="token assign-left variable">app</span><span class="token operator">=</span>redis-sentinel
</code></pre>
    <p>
     3ï¸âƒ£
     <strong>
      æ£€æŸ¥ Sentinel æ˜¯å¦è¶³å¤Ÿ
     </strong>
     ï¼š
    </p>
    <pre><code class="prism language-sh">kubectl get pods <span class="token parameter variable">-l</span> <span class="token assign-left variable">app</span><span class="token operator">=</span>redis-sentinel
</code></pre>
    <p>
     å¦‚æœ
     <code>
      num-other-sentinels: 0
     </code>
     ï¼Œéœ€è¦å¢åŠ å‰¯æœ¬ï¼š
    </p>
    <pre><code class="prism language-yaml"><span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">3</span>  <span class="token comment"># è‡³å°‘ 3 ä¸ª Sentinel</span>
</code></pre>
    <hr/>
    <h4>
     <a id="__2Spring_Boot__Redis_Sentinel__added__is_down_58">
     </a>
     <strong>
      ğŸš¨ é—®é¢˜ 2ï¼šSpring Boot è¿æ¥ Redis Sentinel ä¸€ç›´æŠ¥
      <code>
       added
      </code>
      å’Œ
      <code>
       is down
      </code>
     </strong>
    </h4>
    <h5>
     <a id="__59">
     </a>
     <strong>
      ğŸ” å¯èƒ½åŸå› 
     </strong>
    </h5>
    <ul>
     <li>
      <code>
       spring.redis.sentinel.master
      </code>
      é…ç½®é”™è¯¯ï¼Œå¯¼è‡´ Spring Boot è¿æ¥ä¸ä¸Š Redis Sentinelã€‚
     </li>
     <li>
      <code>
       sentinel.conf
      </code>
      é‡Œ
      <code>
       mymaster
      </code>
      æ‹¼å†™é”™è¯¯ï¼Œå¯¼è‡´ Sentinel æ— æ³•æ­£ç¡®å‘ç°ä¸»èŠ‚ç‚¹ã€‚
     </li>
    </ul>
    <h5>
     <a id="__63">
     </a>
     <strong>
      âœ… è§£å†³æ–¹æ¡ˆ
     </strong>
    </h5>
    <p>
     1ï¸âƒ£
     <strong>
      æ£€æŸ¥
      <code>
       sentinel.conf
      </code>
      é…ç½®
     </strong>
    </p>
    <pre><code class="prism language-sh">kubectl <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> redis-sentinel-0 -- redis-cli <span class="token parameter variable">-p</span> <span class="token number">26379</span> SENTINEL MASTER mymaster
</code></pre>
    <p>
     å¦‚æœ
     <code>
      mymaster
     </code>
     ä¸å­˜åœ¨ï¼Œè¯´æ˜ Sentinel é…ç½®é”™è¯¯ã€‚
    </p>
    <p>
     2ï¸âƒ£
     <strong>
      æ£€æŸ¥ Spring Boot é…ç½®
     </strong>
    </p>
    <pre><code class="prism language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">redis</span><span class="token punctuation">:</span>
    <span class="token key atrule">sentinel</span><span class="token punctuation">:</span>
      <span class="token key atrule">master</span><span class="token punctuation">:</span> mymaster  <span class="token comment"># å¿…é¡»å’Œ Sentinel é…ç½®ä¸€è‡´</span>
      <span class="token key atrule">nodes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> redis<span class="token punctuation">-</span>sentinel<span class="token punctuation">-</span>0<span class="token punctuation">:</span><span class="token number">26379</span>
        <span class="token punctuation">-</span> redis<span class="token punctuation">-</span>sentinel<span class="token punctuation">-</span>1<span class="token punctuation">:</span><span class="token number">26379</span>
        <span class="token punctuation">-</span> redis<span class="token punctuation">-</span>sentinel<span class="token punctuation">-</span>2<span class="token punctuation">:</span><span class="token number">26379</span>
    <span class="token key atrule">password</span><span class="token punctuation">:</span> yourpassword
</code></pre>
    <p>
     3ï¸âƒ£
     <strong>
      è°ƒæ•´
      <code>
       timeout
      </code>
      ä»¥å‡å°‘è¯¯åˆ¤
     </strong>
    </p>
    <pre><code class="prism language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">redis</span><span class="token punctuation">:</span>
    <span class="token key atrule">timeout</span><span class="token punctuation">:</span> <span class="token number">5000</span>
    <span class="token key atrule">lettuce</span><span class="token punctuation">:</span>
      <span class="token key atrule">pool</span><span class="token punctuation">:</span>
        <span class="token key atrule">max-active</span><span class="token punctuation">:</span> <span class="token number">10</span>
        <span class="token key atrule">max-wait</span><span class="token punctuation">:</span> <span class="token number">5000</span>
</code></pre>
    <hr/>
    <h3>
     <a id="3_Redisson__Redis_Sentinel__96">
     </a>
     <strong>
      3ï¸âƒ£ Redisson è¿æ¥ Redis Sentinel é…ç½®
     </strong>
    </h3>
    <p>
     Redisson æ˜¯ä¸€ä¸ªé«˜æ•ˆçš„ Redis å®¢æˆ·ç«¯ï¼Œæ”¯æŒ Redis Sentinel æ¨¡å¼ã€‚
    </p>
    <h4>
     <a id="__99">
     </a>
     <strong>
      ğŸš€ ä¾èµ–
     </strong>
    </h4>
    <p>
     åœ¨
     <code>
      pom.xml
     </code>
     ä¸­å¼•å…¥ï¼š
    </p>
    <pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.redisson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>redisson-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.23.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <h4>
     <a id="__RedissonClient_109">
     </a>
     <strong>
      ğŸš€ é…ç½®
      <code>
       RedissonClient
      </code>
     </strong>
    </h4>
    <pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>redisson<span class="token punctuation">.</span></span><span class="token class-name">Redisson</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>redisson<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">RedissonClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>redisson<span class="token punctuation">.</span>config<span class="token punctuation">.</span></span><span class="token class-name">Config</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedissonConfig</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RedissonClient</span> <span class="token function">redissonClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Config</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span><span class="token function">useSentinelServers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">setMasterName</span><span class="token punctuation">(</span><span class="token string">"mymaster"</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">addSentinelAddress</span><span class="token punctuation">(</span><span class="token string">"redis://redis-sentinel-0:26379"</span><span class="token punctuation">,</span>
                                  <span class="token string">"redis://redis-sentinel-1:26379"</span><span class="token punctuation">,</span>
                                  <span class="token string">"redis://redis-sentinel-2:26379"</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"yourpassword"</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">setConnectTimeout</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">Redisson</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <hr/>
    <h3>
     <a id="4__Redisson__137">
     </a>
     <strong>
      4ï¸âƒ£ æµ‹è¯• Redisson è¿æ¥
     </strong>
    </h3>
    <pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>redisson<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">RBucket</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>redisson<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">RedissonClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestParam</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisController</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">RedissonClient</span> redissonClient<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">RedisController</span><span class="token punctuation">(</span><span class="token class-name">RedissonClient</span> redissonClient<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>redissonClient <span class="token operator">=</span> redissonClient<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/set"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span> <span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token annotation punctuation">@RequestParam</span> <span class="token class-name">String</span> value<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">RBucket</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> bucket <span class="token operator">=</span> redissonClient<span class="token punctuation">.</span><span class="token function">getBucket</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bucket<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"Set "</span> <span class="token operator">+</span> key <span class="token operator">+</span> <span class="token string">" = "</span> <span class="token operator">+</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/get"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span> <span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">RBucket</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> bucket <span class="token operator">=</span> redissonClient<span class="token punctuation">.</span><span class="token function">getBucket</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"Get "</span> <span class="token operator">+</span> key <span class="token operator">+</span> <span class="token string">" = "</span> <span class="token operator">+</span> bucket<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <hr/>
    <h3>
     <a id="5____170">
     </a>
     <strong>
      5ï¸âƒ£ å¯èƒ½çš„é”™è¯¯ &amp; è§£å†³æ–¹æ¡ˆ
     </strong>
    </h3>
    <h4>
     <a id="_Unable_to_connect_to_Redis_Sentinel_171">
     </a>
     <strong>
      âŒ
      <code>
       Unable to connect to Redis Sentinel
      </code>
     </strong>
    </h4>
    <p>
     <strong>
      âœ… è§£å†³æ–¹æ¡ˆ
     </strong>
    </p>
    <ul>
     <li>
      <p>
       <strong>
        æ£€æŸ¥ Sentinel æ˜¯å¦æ­£å¸¸è¿è¡Œ
       </strong>
      </p>
      <pre><code class="prism language-sh">kubectl get pods <span class="token parameter variable">-l</span> <span class="token assign-left variable">app</span><span class="token operator">=</span>redis-sentinel
</code></pre>
      <p>
       å¦‚æœ Sentinel Pod æŒ‚äº†ï¼Œéœ€è¦é‡æ–°å¯åŠ¨ã€‚
      </p>
     </li>
     <li>
      <p>
       <strong>
        æ‰‹åŠ¨æµ‹è¯• Sentinel
       </strong>
      </p>
      <pre><code class="prism language-sh">redis-cli <span class="token parameter variable">-p</span> <span class="token number">26379</span> SENTINEL MASTER mymaster
</code></pre>
      <p>
       <strong>
        å¦‚æœ
        <code>
         mymaster
        </code>
        ä¸å­˜åœ¨ï¼Œè¯´æ˜ Sentinel é…ç½®æœ‰è¯¯ã€‚
       </strong>
      </p>
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="__187">
     </a>
     <strong>
      ğŸ” æ€»ç»“
     </strong>
    </h3>
    <p>
     ğŸš€
     <strong>
      Redis Sentinel + Redisson é«˜å¯ç”¨æ–¹æ¡ˆçš„å…³é”®è¦ç‚¹ï¼š
     </strong>
     <br/>
     1ï¸âƒ£
     <strong>
      Redis Sentinel éœ€é…ç½®æ­£ç¡®
     </strong>
     ï¼Œ
     <code>
      mymaster
     </code>
     åç§°éœ€ä¸€è‡´ï¼Œ
     <code>
      failover-timeout
     </code>
     éœ€è¶³å¤Ÿé•¿ã€‚
     <br/>
     2ï¸âƒ£
     <strong>
      Spring Boot è¿æ¥ Redis Sentinel æ—¶
     </strong>
     ï¼Œ
     <code>
      spring.redis.sentinel.master
     </code>
     éœ€è¦åŒ¹é… Sentinel é…ç½®ã€‚
     <br/>
     3ï¸âƒ£
     <strong>
      Redisson è¿æ¥ Sentinel éœ€è¦æ‰‹åŠ¨é…ç½®
      <code>
       RedissonClient
      </code>
     </strong>
     ï¼Œå¹¶ä¿è¯
     <code>
      sentinel.conf
     </code>
     æ­£ç¡®ã€‚
     <br/>
     4ï¸âƒ£
     <strong>
      æ•…éšœæ’æŸ¥æ—¶ï¼Œæ‰‹åŠ¨æ‰§è¡Œ
      <code>
       SENTINEL MASTER mymaster
      </code>
     </strong>
     ï¼Œæ£€æŸ¥ä¸»èŠ‚ç‚¹çŠ¶æ€ã€‚
    </p>
    <p>
     <strong>
      ğŸ“¢ å¦‚æœä½ ä»ç„¶é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥æä¾›
      <code>
       redis-cli
      </code>
      çš„
      <code>
       SENTINEL MASTER mymaster
      </code>
      è¾“å‡ºï¼Œæˆ‘å¯ä»¥å¸®ä½ åˆ†æï¼ğŸš€
     </strong>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
  <div class="blog-extension-box" id="blogExtensionBox" style="width:400px;margin:auto;margin-top:12px">
  </div>
 </article>
 <p alt="68747470733a:2f2f626c6f672e6373646e2e6e65742f78636265796f6e642f:61727469636c652f64657461696c732f313436323432303537" class_="artid" style="display:none">
 </p>
</div>


