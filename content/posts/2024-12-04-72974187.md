---
layout: post
title: "Linux下切换Python2和Python3的4种方法"
date: 2024-12-04 19:45:21 +0800
description: "﻿﻿ 原文  http://sharpdeep.github.io/2016/06/19/pytho"
keywords: "虚拟机linux修改python默认版本3为2"
categories: ['Python']
tags: ['切换', 'Python', 'Linux', '4种方法']
artid: "72974187"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=72974187
    alt: "Linux下切换Python2和Python3的4种方法"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=72974187
featuredImagePreview: https://bing.ee123.net/img/rand?artid=72974187
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Linux下切换Python2和Python3的4种方法
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <div style="top:0px">
     ﻿﻿
    </div>
    <h2>
     <span class="from">
     </span>
    </h2>
    <div class="article_meta">
     <div class="source">
      <em style="float:left">
       原文
      </em>
      <a class="cut cut70" href="http://sharpdeep.github.io/2016/06/19/python-alternatives/?utm_source=tuicool&amp;utm_medium=referral" rel="nofollow noopener noreferrer" style="display:inline-block" target="_blank">
       http://sharpdeep.github.io/2016/06/19/python-alternatives/
      </a>
     </div>
     <div>
      主题
      <a href="http://www.tuicool.com/topics/11130000" rel="nofollow noopener noreferrer" target="_blank">
       <span class="new-label">
        Python
       </span>
      </a>
      <a href="http://www.tuicool.com/topics/11000069" rel="nofollow noopener noreferrer" target="_blank">
       <span class="new-label">
        Linux
       </span>
      </a>
     </div>
    </div>
    <div class="article_body" id="nei">
     <div>
      <h5>
       本篇博文面向Linux用户，在Linux下(Ubuntu)下测试通过，Win用户嘛，……
      </h5>
      <h3>
       0x00 为什么需要有两个版本的Python
      </h3>
      <p>
       Python2和Python3不兼容是每个接触过Python的开发者都知道的事，虽说Python3是未来，但是仍然有很多项目采用Python2开发。Linux的许多发行版本(如Ubuntu)都会自带Python2.7，但是当我们准备开发一个Python3项目的时候，我们该怎么办？
      </p>
      <p>
       那就把Python3也下咯。嗯，Linux下确实是可以两个一起装的，但是问题是你怎么切换两个版本的Python。
      </p>
      <h3>
       0x01 修改别名
      </h3>
      <p>
       首先先来看一下我们的默认Python版本
      </p>
      <div>
       <pre class="hljs vim"><code>$ <span class="hljs-keyword">python</span> --<span class="hljs-keyword">version</span>
Python <span class="hljs-number">2.7</span>.<span class="hljs-number">6</span>
</code></pre>
      </div>
      <p>
       然后我们修改一下别名
      </p>
      <div>
       <pre><code class="language-ruby"><code>$ <span class="hljs-keyword">alias</span> python=<span class="hljs-string">'/usr/bin/python3'</span>
$ python --version
Python <span class="hljs-number">3.4</span>.<span class="hljs-number">3</span>  <span class="hljs-comment"># 版本已经改变</span>
</code></code></pre>
      </div>
      <p>
       <code>
        /usr/bin/python3
       </code>
       这个路径是怎么找到的呢？
      </p>
      <p>
       一般来说，软件的二进制文件都可以在
       <code>
        /usr/bin
       </code>
       或
       <code>
        /usr/local/bin
       </code>
       (这个优先级高一点)找到。当然如果你是Debian系的Linux，可以这么找(前提是你已经安装了Python3)：
      </p>
      <div>
       <pre><code class="language-ruby"><code>$ dpkg -L python3
</code></code></pre>
      </div>
      <p>
       上面的别名修改只是暂时性的，重开一个窗口后配置就不见了。如果要使每个窗口都使用这个别名，可以编辑
       <code>
        ~/.bashrc
       </code>
       (如果你是别的shell的话，就不是这个文件，如zsh是
       <code>
        ~/.zshrc
       </code>
       )，把alias配置写入文件。
      </p>
      <p>
       修改别名优点是足够简单，但是切换不灵活。
      </p>
      <h3>
       0x02 链接文件
      </h3>
      <p>
       在
       <code>
        /usr/bin
       </code>
       中建立一个链接文件指向Python3。
      </p>
      <div>
       <pre class="prettyprint hljs vim"><code>$ <span class="hljs-keyword">ln</span> -s <span class="hljs-keyword">python</span> /usr/bin/<span class="hljs-keyword">python3</span>
$ <span class="hljs-keyword">python</span> --<span class="hljs-keyword">version</span>
Python <span class="hljs-number">3.4</span>.<span class="hljs-number">3</span>
</code></pre>
      </div>
      <p>
       跟修改别名一样，也是修改不够灵活。
      </p>
      <h3>
       0x03 采用update-alternatives 切换版本
      </h3>
      <p>
       update-alternatives是Debian提供的一个工具(非Debian系的就不用看了)，原理类似于上面一个办法，也是通过链接的方式，但是其切换的过程非常方便。
      </p>
      <p>
       首先看一下update-alternatives的帮助信息：
      </p>
      <div>
       <pre class="prettyprint hljs xml"><code>$ update-alternatives --help
用法：update-alternatives [<span class="hljs-tag">&lt;<span class="hljs-name">选项</span>&gt;</span> ...] <span class="hljs-tag">&lt;<span class="hljs-name">命令</span>&gt;</span>

命令：
  --install <span class="hljs-tag">&lt;<span class="hljs-name">链接</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">名称</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">路径</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">优先级</span>&gt;</span>
    [--slave <span class="hljs-tag">&lt;<span class="hljs-name">链接</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">名称</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">路径</span>&gt;</span>] ...
                           在系统中加入一组候选项。
  --remove <span class="hljs-tag">&lt;<span class="hljs-name">名称</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">路径</span>&gt;</span>   从 <span class="hljs-tag">&lt;<span class="hljs-name">名称</span>&gt;</span> 替换组中去除 <span class="hljs-tag">&lt;<span class="hljs-name">路径</span>&gt;</span> 项。
  --remove-all <span class="hljs-tag">&lt;<span class="hljs-name">名称</span>&gt;</span>      从替换系统中删除 <span class="hljs-tag">&lt;<span class="hljs-name">名称</span>&gt;</span> 替换组。
  --auto <span class="hljs-tag">&lt;<span class="hljs-name">名称</span>&gt;</span>            将 <span class="hljs-tag">&lt;<span class="hljs-name">名称</span>&gt;</span> 的主链接切换到自动模式。
  --display <span class="hljs-tag">&lt;<span class="hljs-name">名称</span>&gt;</span>         显示关于 <span class="hljs-tag">&lt;<span class="hljs-name">名称</span>&gt;</span> 替换组的信息。
  --query <span class="hljs-tag">&lt;<span class="hljs-name">名称</span>&gt;</span>           机器可读版的 --display <span class="hljs-tag">&lt;<span class="hljs-name">名称</span>&gt;</span>.
  --list <span class="hljs-tag">&lt;<span class="hljs-name">名称</span>&gt;</span>            列出 <span class="hljs-tag">&lt;<span class="hljs-name">名称</span>&gt;</span> 替换组中所有的可用候选项。
  --get-selections         列出主要候选项名称以及它们的状态。
  --set-selections         从标准输入中读入候选项的状态。
  --config <span class="hljs-tag">&lt;<span class="hljs-name">名称</span>&gt;</span>          列出 <span class="hljs-tag">&lt;<span class="hljs-name">名称</span>&gt;</span> 替换组中的可选项，并就使用其中
                           哪一个，征询用户的意见。
  --set <span class="hljs-tag">&lt;<span class="hljs-name">名称</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">路径</span>&gt;</span>      将 <span class="hljs-tag">&lt;<span class="hljs-name">路径</span>&gt;</span> 设置为 <span class="hljs-tag">&lt;<span class="hljs-name">名称</span>&gt;</span> 的候选项。
  --all                    对所有可选项一一调用 --config 命令。

<span class="hljs-tag">&lt;<span class="hljs-name">链接</span>&gt;</span> 是指向 /etc/alternatives/<span class="hljs-tag">&lt;<span class="hljs-name">名称</span>&gt;</span> 的符号链接。
    (如 /usr/bin/pager)
<span class="hljs-tag">&lt;<span class="hljs-name">名称</span>&gt;</span> 是该链接替换组的主控名。
    (如 pager)
<span class="hljs-tag">&lt;<span class="hljs-name">路径</span>&gt;</span> 是候选项目标文件的位置。
    (如 /usr/bin/less)
<span class="hljs-tag">&lt;<span class="hljs-name">优先级</span>&gt;</span> 是一个整数，在自动模式下，这个数字越高的选项，其优先级也就越高。

选项：
  --altdir <span class="hljs-tag">&lt;<span class="hljs-name">目录</span>&gt;</span>          改变候选项目录。
  --admindir <span class="hljs-tag">&lt;<span class="hljs-name">目录</span>&gt;</span>        设置 statoverride 文件的目录。
  --log <span class="hljs-tag">&lt;<span class="hljs-name">文件</span>&gt;</span>             改变日志文件。
  --force                  就算没有通过自检，也强制执行操作。
  --skip-auto              在自动模式中跳过设置正确候选项的提示
                           (只与 --config 有关)
  --verbose                启用详细输出。
  --quiet                  安静模式，输出尽可能少的信息。不显示输出信息。
  --help                   显示本帮助信息。
  --version                显示版本信息。
</code></pre>
      </div>
      <p>
       我们仅需要了解3个参数就行了
      </p>
      <ul>
       <li>
        <code>
         --install &lt;链接&gt; &lt;名称&gt; &lt;路径&gt; &lt;优先级&gt;
        </code>
        ：建立一组候选项
       </li>
       <li>
        <code>
         --config &lt;名称&gt;
        </code>
        ：配置 &lt;名称&gt;组中的可选项，并选择使用其中哪一个
       </li>
       <li>
        <code>
         --remove &lt;名称&gt; &lt;路径&gt;
        </code>
        ：从 &lt;名称&gt;中去掉 &lt;路径&gt;选项
       </li>
      </ul>
      <p>
       首先我们先看一下有没有关于Python的可选项：
      </p>
      <div>
       <pre class="prettyprint hljs vim"><code>$ <span class="hljs-keyword">update</span>-alternatives --<span class="hljs-keyword">display</span> <span class="hljs-keyword">python</span>
<span class="hljs-keyword">update</span>-alternative<span class="hljs-variable">s:</span> 错误: 无 <span class="hljs-keyword">python</span> 的候选项
</code></pre>
      </div>
      <p>
       那首先先建立python的组,并添加Python2和Python3的可选项
      </p>
      <div>
       <pre class="prettyprint hljs awk"><code>$ sudo update-alternatives --install <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/python python /u</span>sr<span class="hljs-regexp">/bin/</span>python2.<span class="hljs-number">7</span> <span class="hljs-number">2</span> <span class="hljs-comment"># 添加Python2可选项，优先级为2</span>
$ sudo update-alternatives --install <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/python python /u</span>sr<span class="hljs-regexp">/bin/</span>python3.<span class="hljs-number">4</span> <span class="hljs-number">1</span> <span class="hljs-comment">#添加Python3可选项，优先级为1</span>
</code></pre>
      </div>
      <p>
       注意，这里的
       <code>
        /usr/bin/python
       </code>
       链接文件，两个可选项必须是一样的，这样这个链接文件才可以选择两个不同的可选项去链接。
      </p>
      <p>
       这时如果我们查看
       <code>
        /usr/bin/python
       </code>
       这个文件时，会发现它已经链接到了
       <code>
        /etc/alternatives/python
       </code>
       。
      </p>
      <div>
       <pre class="prettyprint hljs vim"><code>lrwxrwxrwx <span class="hljs-number">1</span> root root        <span class="hljs-number">24</span>  <span class="hljs-number">6</span>月 <span class="hljs-number">19</span> <span class="hljs-number">18</span>:<span class="hljs-number">39</span> <span class="hljs-keyword">python</span> -&gt; /etc/alternatives/<span class="hljs-keyword">python</span>
</code></pre>
      </div>
      <p>
       然后我们再看一下版本
      </p>
      <div>
       <pre class="hljs vim"><code>$ <span class="hljs-keyword">python</span> --<span class="hljs-keyword">version</span>
Python <span class="hljs-number">2.7</span>.<span class="hljs-number">6</span>
</code></pre>
      </div>
      <p>
       为什么还是Python2，看一下配置
      </p>
      <div>
       <pre><code class="language-sql"><code>$ sudo <span class="hljs-keyword">update</span>-alternatives <span class="hljs-comment">--config python</span>
有 <span class="hljs-number">2</span> 个候选项可用于替换 python (提供 /usr/<span class="hljs-keyword">bin</span>/python)。

  选择       路径              优先级  状态
<span class="hljs-comment">------------------------------------------------------------</span>
* <span class="hljs-number">0</span>            /usr/<span class="hljs-keyword">bin</span>/python2<span class="hljs-number">.7</span>   <span class="hljs-number">2</span>         自动模式
  <span class="hljs-number">1</span>            /usr/<span class="hljs-keyword">bin</span>/python2<span class="hljs-number">.7</span>   <span class="hljs-number">2</span>         手动模式
  <span class="hljs-number">2</span>            /usr/<span class="hljs-keyword">bin</span>/python3<span class="hljs-number">.4</span>   <span class="hljs-number">1</span>         手动模式
要维持当前值[*]请按回车键，或者键入选择的编号：
</code></code></pre>
      </div>
      <p>
       原来是因为默认选中了自动模式，而Python2的优先级高于Python3，这时候只要键入2，就可以使用Python3了。
      </p>
      <p>
       如果你想要删除某个可选项的话：
      </p>
      <div>
       <pre class="prettyprint hljs vim"><code>$ sudo <span class="hljs-keyword">update</span>-alternatives --<span class="hljs-built_in">remove</span> <span class="hljs-keyword">python</span> /usr/bin/python2.<span class="hljs-number">7</span>
</code></pre>
      </div>
      <p>
       update-alternatives只适用于Debian系Liunx。
      </p>
      <h3>
       0x04 virtualenvwrapper 切换版本
      </h3>
      <p>
       virtualenvwrapper是管理Python虚拟环境的工具，可以很方便的为不同的项目建立独立的环境，每个项目都可以安装自己的依赖，同时也支持在不同的虚拟环境中存在不同版本的Python。
      </p>
      <p>
       首先安装virtualenvwrapper，可以选择apt安装或者pip安装
      </p>
      <p>
       apt安装
      </p>
      <div>
       <pre><code class="language-sql"><code>$ sudo apt-get <span class="hljs-keyword">install</span> virtualenvwrapper
</code></code></pre>
      </div>
      <p>
       pip安装
      </p>
      <div>
       <pre><code class="language-sql"><code>$ sudo pip <span class="hljs-keyword">install</span> virtualenvwrapper
</code></code></pre>
      </div>
      <p>
       当你需要使用Python2开发项目时，建立一个Python2的虚拟环境：
      </p>
      <div>
       <pre><code class="language-ruby"><code>$ mkvirtualenv -p /usr/bin/python2 env27
</code></code></pre>
      </div>
      <p>
       当你需要Python3开发时：
      </p>
      <div>
       <pre><code class="language-ruby"><code>$ mkvirtualenv -p /usr/bin/python3.<span class="hljs-number">4</span> env34
</code></code></pre>
      </div>
      <p>
       然后可以随时切换不同的虚拟环境：
      </p>
      <div>
       <pre><code class="language-ruby"><code>$ workon env27  <span class="hljs-comment"># 进入Python2环境</span>
$ workon env34  <span class="hljs-comment"># 进入Python3环境</span>
</code></code></pre>
      </div>
      <p>
       更爽的是，你可以在进入虚拟环境的同时切换到项目目录，只需要编辑
       <code>
        $VIRTUAL_ENV/bin/postactivate
       </code>
       这个文件即可：
      </p>
      <div>
       <pre><code class="language-ruby"><code>$ vim $VIRTUAL_ENV/bin/postactivate  <span class="hljs-comment">#前提是已经进入对应的虚拟环境</span>
</code></code></pre>
      </div>
      <p>
       在文件中添加切换目录的命令：
      </p>
      <div>
       <pre class="hljs gradle"><code>cd  <span class="hljs-regexp">/path/</span>to<span class="hljs-regexp">/your/</span><span class="hljs-keyword">project</span>
</code></pre>
      </div>
      <h3>
       0x05 总结
      </h3>
      <p>
       前面两种方法不推荐使用。
      </p>
      <p>
       使用 update-alternatives 切换版本只适用于Debian系的Linux。
      </p>
      <p>
       推荐使用 virtualenvwrapper 来管理虚拟环境和版本。
      </p>
      <p>
       另外，本文介绍的切换不同版本软件的方法，除了 virtualenvwrapper 之外，前面3种方法都适用于其他软件，比如Java（open-jdk和oracle-jdk）。
      </p>
     </div>
    </div>
   </div>
  </div>
 </article>
 <p alt="6874747073:3a2f2f626c6f672e6373646e2e6e65742f6a61736f6e667177:2f61727469636c652f64657461696c732f3732393734313837" class_="artid" style="display:none">
 </p>
</div>


