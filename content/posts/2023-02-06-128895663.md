---
arturl_encode: "68747470733a2f:2f626c6f672e6373646e2e6e65742f7a68616e677869615f2f:61727469636c652f64657461696c732f313238383935363633"
layout: post
title: "å¦‚ä½•ä½¿ç”¨JDBCæ“ä½œæ•°æ®åº“ä¸€æ–‡å¸¦ä½ åƒé€JDBCè§„èŒƒ"
date: 2023-02-06 08:14:46 +0800
description: "åœ¨ Java å¼€å‘ä¸­ï¼Œä½¿ç”¨ Java è¯­è¨€æ“ä½œæ•°æ®åº“æ˜¯éå¸¸é‡è¦çš„ä¸€"
keywords: "jdbcæ“ä½œæ•°æ®åº“"
categories: ['ä»˜è´¹ä¸“æ è¯•è¯»']
tags: ['æ•°æ®åº“', 'Mysql', 'Java']
artid: "128895663"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=128895663
    alt: "å¦‚ä½•ä½¿ç”¨JDBCæ“ä½œæ•°æ®åº“ä¸€æ–‡å¸¦ä½ åƒé€JDBCè§„èŒƒ"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=128895663
featuredImagePreview: https://bing.ee123.net/img/rand?artid=128895663
---

# å¦‚ä½•ä½¿ç”¨JDBCæ“ä½œæ•°æ®åº“ï¼Ÿä¸€æ–‡å¸¦ä½ åƒé€JDBCè§„èŒƒ

#### æ–‡ç« ç›®å½•

* [1. å‰è¨€](#1__2)
* [2. JDBC æ¦‚è¿°](#2_JDBC__32)
* + [2.1 æ¦‚å¿µ](#21__34)
  + [2.2 ä¼˜ç‚¹](#22__48)
* [3. JDBC å¿«é€Ÿå…¥é—¨](#3_JDBC__64)
* [4. JDBC APIè¯¦è§£](#4_JDBC_API_255)
* + [4.1 DriverManager](#41_DriverManager_257)
  + - [4.1.1 æ³¨å†Œé©±åŠ¨](#411__266)
    - [4.1.2 è·å–è¿æ¥](#412__287)
  + [4.2 Connection](#42_Connection_307)
  + - [4.2.1 è·å–æ‰§è¡Œsqlçš„å¯¹è±¡](#421_sql_316)
    - [4.2.2 äº‹åŠ¡ç®¡ç†](#422__324)
  + [4.3 Statement](#43_Statement_401)
  + [4.4 ResultSet](#44_ResultSet_457)
  + [4.5 PreparedStatement](#45_PreparedStatement_539)
  + - [4.5.1 sqlæ³¨å…¥é—®é¢˜](#451_sql_541)
    - [4.5.2 preparedStatement åŸç†](#452_preparedStatement__627)
* [5. æ•°æ®åº“è¿æ¥æ± ](#5__708)
* + [5.1 æ¦‚å¿µ](#51__710)
  + [5.2 å®ç°](#52__737)
* [6. Druid è¿æ¥æ± çš„ä½¿ç”¨](#6_Druid__755)
* [7. å‡†å¤‡å·¥ä½œ](#7__864)
* [8. å®æˆ˜æ¡ˆä¾‹](#8__937)
* [9. å¢åˆ æ”¹æŸ¥æ“ä½œç»ƒä¹ ](#9__1057)
* + [9.1 æŸ¥è¯¢æ‰€æœ‰](#91__1065)
  + [9.2 æ·»åŠ æ•°æ®](#92__1116)
  + [9.3 ä¿®æ”¹æ•°æ®](#93__1168)
  + [9.4 åˆ é™¤æ•°æ®](#94__1220)
* [10. æ€»ç»“](#10__1268)
* [ğŸ“‚æ©™å­ç²¾å“æ–‡ç« å­¦ä¹ æ¨è](#_1277)

## 1. å‰è¨€

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æ©™å­ã€‚æœ€è¿‘åˆè‚äº†å‡ ä¸ªå¤§å¤œï¼Œæ€»ç»“äº† JDBC å®Œæ•´ç‰ˆçš„åŸºç¡€æ•™ç¨‹å’Œå®æˆ˜æ¡ˆä¾‹è®­ç»ƒã€‚å¿«æ¥çœ‹çœ‹è¿™äº› Java åŸºç¡€æ€§çš„ä»£ç ä½ æœ‰æ²¡æœ‰å¿˜è®°ï¼Ÿ

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/2320d82503d6d1d58df147133acdf506.png)

åœ¨ Java å¼€å‘ä¸­ï¼Œä½¿ç”¨ Java è¯­è¨€æ“ä½œæ•°æ®åº“æ˜¯éå¸¸é‡è¦çš„ä¸€éƒ¨åˆ†ï¼Œé‚£ä¹ˆ Java è¯­è¨€æ˜¯å¦‚ä½•æ“ä½œæ•°æ®åº“çš„å‘¢ï¼Ÿ

æˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸åŒå‚å•†çš„æ•°æ®åº“æ—¶ï¼Œä¾‹å¦‚ MySQLï¼ŒOracle ç­‰ï¼Œæ˜¾ç„¶ä¸€å¥— Java ä»£ç æ˜¯ä¸èƒ½åŒæ—¶æ“ä½œä¸åŒçš„æ•°æ®åº“çš„ï¼Œé‚£ä¹ˆæ€æ ·å®ç°ä¸€å¥— Java ä»£ç å¯¹ä¸åŒçš„æ•°æ®åº“çš„æ“ä½œå‘¢ï¼Ÿ

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/ce4afb41a6ee16ba2a8c8bbfa83f1b5d.png)

JDBC åº”è¿è€Œç”Ÿï¼Œ
`JDBC æ˜¯ä½¿ç”¨ Java è¯­è¨€æ“ä½œå…³ç³»å‹æ•°æ®åº“çš„ä¸€å¥— APIï¼Œå…¶ä¸­å®šä¹‰äº†å¯¹æ•°æ®åº“æ“ä½œçš„è§„èŒƒï¼Œ`
è¿™é‡Œçš„è§„èŒƒåœ¨ Java ä¸­å°±æ˜¯æŒ‡æ¥å£ï¼Œä¸åŒçš„æ•°æ®åº“å‚å•†æä¾›äº†ä¸åŒçš„ JDBC å®ç°ç±»ï¼Œç§°ä¸ºé©±åŠ¨ï¼Œä½¿ç”¨æ—¶ï¼Œåªéœ€è¦å¯¼å…¥éœ€è¦çš„æ•°æ®åº“é©±åŠ¨ jar åŒ…ï¼Œä¾¿å¯ä»¥æ“ä½œä¸åŒçš„å…³ç³»å‹æ•°æ®åº“ï¼Œå…¶å®é™…æ˜¯ä½¿ç”¨äº† jar åŒ…ä¸­çš„å®ç°ç±»ã€‚

æœ¬ç³»åˆ—æ–‡ç« çš„å­¦ä¹ ç›®æ ‡ï¼š

* ä»€ä¹ˆæ˜¯ JDBCï¼Œå¦‚ä½•ä½¿ç”¨ï¼Ÿ
* ä½¿ç”¨ JDBC å®Œæˆæ•°æ®çš„å¢åˆ æ”¹æŸ¥æ“ä½œ
* JDBC API ç†Ÿç»ƒä½¿ç”¨

> å­¦ä¼šä½¿ç”¨Javaä»£ç æ“ä½œæ•°æ®åº“ï¼Œæœ¬æ–‡æ˜¯2 ä¸‡å­—å­¦ä¹ æ•™ç¨‹ï¼Œé˜…è¯»æœ¬æ–‡éœ€è¦20 åˆ†é’Ÿï¼Œå»ºè®®æ”¶è—é•¿æœŸå­¦ä¹ ä½¿ç”¨ã€‚

## 2. JDBC æ¦‚è¿°

### 2.1 æ¦‚å¿µ

JDBC ï¼Œ
`Java DataBase Connectivity`
ï¼Œ æ˜¯ä½¿ç”¨ Java è¯­è¨€æ“ä½œå…³ç³»å‹æ•°æ®åº“çš„ä¸€å¥—APIã€‚æœ¬è´¨ä¸Šæ¥è¯´ï¼ŒJDBC ä¸­å®šä¹‰äº†ä¸€å¥—æ“ä½œå…³ç³»å‹æ•°æ®åº“çš„è§„èŒƒï¼Œä½†æ˜¯æˆ‘ä»¬ä¸èƒ½ç›´æ¥ä½¿ç”¨è¿™å¥—æ¥å£æ¥æ“ä½œæ•°æ®åº“ï¼Œäºæ˜¯å„å¤§æ•°æ®åº“å‚å•†æä¾›äº† JDBC ä¸åŒçš„å®ç°ç±»ï¼Œç§°ä¸ºé©±åŠ¨ï¼Œä¾‹å¦‚ MySQL é©±åŠ¨ï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦æ“ä½œ JDBC è§„èŒƒå¥½çš„ä»£ç ä¾¿å¯ä»¥å®Œæˆå¯¹æ•°æ®åº“çš„æ“ä½œã€‚åœ¨å®ç°å¯¹æ•°æ®åº“çš„æ“ä½œæ—¶ï¼Œå…¶åº•å±‚æ˜¯ä½¿ç”¨äº† jar åŒ…ä¸­å®šä¹‰çš„å®ç°ç±»ã€‚

![image-20230122171430643](https://i-blog.csdnimg.cn/blog_migrate/1e365b3c235c8f9ff0e963b9ed3c87f0.png)

å½“æˆ‘ä»¬ä½¿ç”¨ä¸åŒçš„æ•°æ®åº“æ—¶ï¼Œä¾‹å¦‚æµ‹è¯•æ—¶ä½¿ç”¨ MySQL æ•°æ®åº“ï¼Œéƒ¨ç½²æ—¶ä½¿ç”¨ Oracle æ•°æ®åº“ï¼Œåªéœ€è¦ç¼–å†™ä¸€å¥— Java ä»£ç ä¾¿å¯ä»¥å®ç°å¯¹ä¸åŒå…³ç³»å‹æ•°æ®åº“çš„æ“ä½œã€‚

### 2.2 ä¼˜ç‚¹

ä½¿ç”¨ JDBC æ“ä½œå…³ç³»å‹æ•°æ®åº“æ—¶ï¼Œå„å¤§æ•°æ®åº“å‚å•†æä¾›äº†ä¸åŒçš„å®ç°ç±»ï¼Œæˆ‘ä»¬ä¸éœ€è¦é’ˆå¯¹ä¸åŒçš„æ•°æ®åº“è¿›è¡Œå•ç‹¬å¼€å‘ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥éšæ—¶æ›¿æ¢æ•°æ®åº“ï¼Œè€Œä¸ç”¨å¤§é‡ä¿®æ”¹ Java ä»£ç ã€‚

æˆ‘ä»¬åªéœ€è¦åœ¨ä½¿ç”¨æ—¶å¯¼å…¥éœ€è¦ä½¿ç”¨çš„æ•°æ®åº“å¯¹åº”çš„é©±åŠ¨ jaråŒ…åˆ°é¡¹ç›®ä¸­ï¼Œä¾¿å¯ä»¥å®ç°å¯¹æŒ‡å®šæ•°æ®åº“çš„æ“ä½œï¼Œä½¿ Java æ“ä½œæ•°æ®åº“å˜å¾—è½»æ¾ä¾¿æ·ã€‚

ä¸‹å›¾å°±æ˜¯MySQLçš„é©±åŠ¨jaråŒ…ï¼š

![image-20230122170603015](https://i-blog.csdnimg.cn/blog_migrate/c45e2f1933b3f607f3e0d8de010f9861.png)

ä¸åŒç‰ˆæœ¬çš„ jar åŒ…å¯ä»¥åœ¨å®˜ç½‘ä¸‹è½½ã€‚

## 3. JDBC å¿«é€Ÿå…¥é—¨

ä½¿ç”¨ Java è¯­è¨€æ“ä½œæ•°æ®åº“ï¼Œå®é™…ä¸Šå°±æ˜¯ Java ä»£ç å°† sql è¯­å¥å‘é€åˆ° MySQL æ•°æ®åº“æœåŠ¡ç«¯ï¼ŒMySQL æœåŠ¡ç«¯æ¥æ”¶å¹¶æ‰§è¡Œ sql è¯­å¥ï¼ŒåŒæ—¶è¿”å›ä¸€ä¸ªæ‰§è¡Œç»“æœï¼Œæœ€åè¯¥ç»“æœä¼šå‘é€åˆ° Java ä»£ç è¿›è¡Œå¤„ç†ã€‚

å¯¹æ•°æ®åº“çš„æ“ä½œå¤§è‡´åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š

1. æ³¨å†Œé©±åŠ¨
2. è·å–è¿æ¥
3. ç¼–å†™sql
4. è·å–æ‰§è¡Œsqlå¯¹è±¡
5. æ‰§è¡Œsql
6. å¤„ç†è¿”å›ç»“æœ
7. é‡Šæ”¾èµ„æº

åœ¨è¿›è¡Œç¼–ç ä¹‹å‰ï¼Œéœ€è¦å…ˆåˆ›å»ºå·¥ç¨‹ï¼Œå¯¼å…¥æ•°æ®åº“çš„é©±åŠ¨ jar åŒ…ã€‚è¿™é‡Œä»¥ JDBC æ“ä½œ MySQL æ•°æ®åº“ä¸ºä¾‹ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š

åˆ›å»ºç©ºé¡¹ç›®ï¼Œå®šä¹‰é¡¹ç›®åç§°åŠè·¯å¾„ï¼š

![image-20230122173738084](https://i-blog.csdnimg.cn/blog_migrate/2775fdc948a2992ff0d1cd0bc1c302b7.png)

åœ¨File / Project Structure ä¸­è¿›è¡Œé¡¹ç›®è®¾ç½®ï¼ŒJDKç‰ˆæœ¬ï¼Œç¼–è¯‘ç‰ˆæœ¬ç­‰ï¼š

![image-20230122173942616](https://i-blog.csdnimg.cn/blog_migrate/b6b7b953d7f5925652e170f41947f6aa.png)

åˆ›å»ºæ–°æ¨¡å—ï¼ŒæŒ‡å®šåç§°åŠä½ç½®ï¼š

![image-20230122174154153](https://i-blog.csdnimg.cn/blog_migrate/a14b5a70725955144a38b8e4636a9da0.png)

åœ¨ jdbc-demo æ¨¡å—ä¸­æ–°å»º Lib æ–‡ä»¶å¤¹ï¼š

![image-20230122174526391](https://i-blog.csdnimg.cn/blog_migrate/b95d07d2f2e0bc252251d70dfc861182.png)

å°†ä¸‹è½½å¥½çš„ MySQLé©±åŠ¨ jar åŒ…å¯¼å…¥ Lib ç›®å½•ä¸‹ä½œä¸ºåº“æ–‡ä»¶ï¼š

![image-20230122174641452](https://i-blog.csdnimg.cn/blog_migrate/0365f8e0efd7515875aae44ac4a5f5a2.png)

å³é”® MySQL é©±åŠ¨ jar åŒ…ï¼Œç‚¹å‡» Add as Library ,å¹¶é€‰æ‹©æ¨¡å—ä¸‹æœ‰æ•ˆï¼š

![image-20230122174725653](https://i-blog.csdnimg.cn/blog_migrate/6cb173ec7816256d21306f4ba02326db.png)

åˆ›å»ºå¥½å·¥ç¨‹ä»¥åï¼Œå°±å¯ä»¥ç¼–å†™ä»£ç æ“ä½œæ•°æ®åº“å•¦ï¼

åœ¨ idea ä¸­å³é”® src / new / Java Class ï¼Œè¾“å…¥ç±»å JDBCDemo åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»ã€‚

**ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œé©±åŠ¨**

```Java
//1.æ³¨å†Œé©±åŠ¨
Class.forName("com.mysql.jdbc.Driver");

```

ç›®çš„æ˜¯æŠŠ Driver ç±»åŠ è½½åˆ°å†…å­˜ä¸­ã€‚å…¶å®ï¼ŒJava ä¸­ç”¨äºæ³¨å†Œé©±åŠ¨çš„æ˜¯ registerDriver() æ–¹æ³•ï¼Œè€Œåœ¨ Driver ç±»ä¸­ä½¿ç”¨äº†è¯¥æ–¹æ³•ï¼Œæ‰€ä»¥åªè¦æŠŠ Driver ç±»åŠ è½½åˆ°å†…å­˜ä¸­ ï¼ŒåŒ…å« registerDriver æ–¹æ³•çš„é™æ€ä»£ç å—å°±ä¼šæ‰§è¡Œï¼Œé©±åŠ¨å°±ä¼šè¢«æ³¨å†Œã€‚æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹JDKæºç ä¸­çš„Driver ç±»ï¼š

```java
public class Driver extends NonRegisteringDriver implements java.sql.Driver {
    public Driver() throws SQLException {
    }

    static {
        try {
            DriverManager.registerDriver(new Driver());
        } catch (SQLException var1) {
            throw new RuntimeException("Can't register driver!");
        }
    }
}

```

**ç¬¬äºŒæ­¥ï¼šè·å–è¿æ¥**

```java
String url="jdbc:mysql://localhost:3306?useSSL=false";
String username="root";
String pass word="abc123";
Connection conn = DriverManager.getConnection(url, username, password);

```

ç›®çš„æ˜¯é€šè¿‡ getConnection() æ–¹æ³•è·å–æ•°æ®åº“è¿æ¥ Connection ç±»å¯¹è±¡ï¼Œè¿™é‡Œæ²¡æœ‰ç›´æ¥æŠŠæ•°æ®ä¼ å…¥æ–¹æ³•ä¹‹ä¸­ï¼Œè€Œæ˜¯å®šä¹‰äº†ä¸‰ä¸ªå±€éƒ¨å˜é‡ï¼Œurlï¼Œæ•°æ®åº“ç”¨æˆ·åå’Œå¯†ç ï¼Œå…¶ä¸­ url å‚æ•°æœ‰å›ºå®šçš„è¯­æ³•æ ¼å¼ï¼š

```javajava
jdbc:mysql://ipåœ°å€(åŸŸå):ç«¯å£å·ï¼Ÿå‚æ•°é”®å€¼å¯¹1&å‚æ•°é”®å€¼å¯¹2

```

**ç¬¬ä¸‰æ­¥ï¼šå®šä¹‰sql**

```java
String sql="update account set money=2000 where name='å¼ ä¸‰'";

```

ç›®çš„æ˜¯å®šä¹‰æ“ä½œæ•°æ®åº“çš„ sql è¯­å¥ã€‚

**ç¬¬å››æ­¥ï¼šè·å–æ‰§è¡Œsqlçš„å¯¹è±¡**

```java
Statement stmt = conn.createStatement();

```

ç›®çš„æ˜¯åœ¨æ‰§è¡Œ sql è¯­å¥ä¹‹å‰ï¼Œå…ˆè·å–æ‰§è¡Œ sql çš„å¯¹è±¡ statementã€‚

**ç¬¬äº”æ­¥**
ï¼šæ‰§è¡Œsql

```java
int count = stmt.executeUpdate(sql);

```

ç›®çš„æ˜¯ä¸ºäº†å°† sql å‘é€åˆ°æ•°æ®åº“æœåŠ¡ç«¯ï¼Œè®©æ•°æ®åº“æœåŠ¡ç«¯æ‰§è¡Œå®Œ sqlï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªç»“æœï¼Œè¿™é‡Œçš„ executeUpdate() è¿”å›å—å½±å“çš„è¡Œæ•°ã€‚

**ç¬¬å…­æ­¥**
ï¼šå¤„ç†è¿”å›ç»“æœ

```java
 System.out.println(count);

```

ç›®çš„æ˜¯å¤„ç†æ•°æ®åº“æœåŠ¡ç«¯è¿”å›çš„ sq læ‰§è¡Œç»“æœï¼Œè¿™é‡Œæˆ‘ä»¬æ‰“å°äº† executeUpdate() æ–¹æ³•è¿”å›çš„å—å½±å“çš„è¡Œæ•°ã€‚

**ç¬¬ä¸ƒæ­¥**
ï¼šé‡Šæ”¾èµ„æº

```jaVa
stmt.close();
conn.close();

```

ç›®çš„æ˜¯åœ¨å®Œæˆå¯¹æ•°æ®åº“çš„æ“ä½œä»¥åé‡Šæ”¾èµ„æºï¼Œå¦åˆ™æ•°æ®åº“æ–‡ä»¶å°†ä¸€ç›´è¢«è¢«ç¨‹åºå ç”¨ï¼Œé‡Šæ”¾èµ„æºæ—¶éµå¾ªå…ˆå¼€åé‡Šæ”¾çš„åŸåˆ™ã€‚

ä½¿ç”¨ JDBC æ“ä½œ MySQL æ•°æ®åº“å®Œæ•´ä»£ç ï¼š

```java
public class JDBCDemo {
    public static void main(String[] args) throws Exception {
        //1.æ³¨å†Œé©±åŠ¨
        Class.forName("com.mysql.jdbc.Driver");
        //2.è·å–è¿æ¥
        String url="jdbc:mysql://localhost:3306/db1?useSSL=false";
        String username="root";
        String pass word="abc123";
        Connection conn = DriverManager.getConnection(url, username, password);
        //3.å®šä¹‰sql
        String sql="update account set money=2000 where name='å¼ ä¸‰'";
        //4.è·å–æ‰§è¡Œsqlçš„å¯¹è±¡
        Statement stmt = conn.createStatement();
        //5.æ‰§è¡Œsql
        int count = stmt.executeUpdate(sql);
        //6.å¤„ç†ç»“æœ
        System.out.println(count);
        //7.é‡Šæ”¾èµ„æº
        stmt.close();
        conn.close();
    }
}

```

## 4. JDBC APIè¯¦è§£

### 4.1 DriverManager

`DriverManager`
ï¼Œé©±åŠ¨ç®¡ç†ç±»ã€‚åœ¨ JDBC å…¥é—¨ç¯‡ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†è¯¥ç±»çš„æ–¹æ³•æ¥æ³¨å†Œé©±åŠ¨å’Œè·å–è¿æ¥ã€‚

DriverManager ç±»ä¸»è¦æœ‰ä¸¤ä¸ªä½œç”¨ï¼š

1. æ³¨å†Œé©±åŠ¨
2. è·å–è¿æ¥

#### 4.1.1 æ³¨å†Œé©±åŠ¨

åœ¨ Driver ç±»é™æ€ä»£ç å—ä¸­ DriverManager ç±»æ‰§è¡Œäº†å…¶ registerDriver() æ–¹æ³•ç”¨äºæ³¨å†Œé©±åŠ¨ï¼Œå½“æˆ‘ä»¬æŠŠç±»Driver åŠ è½½åˆ°å†…å­˜ä¸­åï¼Œè¯¥é™æ€ä»£ç å—å°±ä¼šæ‰§è¡Œï¼Œæ­¤æ—¶å°±å®Œæˆäº†é©±åŠ¨æ³¨å†Œï¼Œæˆ‘ä»¬å°±æ˜¯ä½¿ç”¨è¿™æ ·çš„æ–¹æ³•æ³¨å†Œé©±åŠ¨çš„ã€‚æŸ¥çœ‹ JDK æºç å°±ä¸éš¾ç†è§£ï¼š

```java
public class Driver extends NonRegisteringDriver implements java.sql.Driver {
    public Driver() throws SQLException {
    }

    static {
        try {
            DriverManager.registerDriver(new Driver());
        } catch (SQLException var1) {
            throw new RuntimeException("Can't register driver!");
        }
    }
}

```

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ MySQL 5 ä»¥åçš„é©±åŠ¨ jar åŒ…å¯ä»¥ä¸ç”¨è¿›è¡Œæ­¤æ­¥éª¤æ¥æ³¨å†Œé©±åŠ¨ï¼Œå½“æˆ‘ä»¬æŠŠ jar å¯¼å…¥åˆ°é¡¹ç›®ä»¥åï¼Œç¨‹åºä¼šè‡ªåŠ¨åŠ è½½ jar åŒ…ä¸­
`META-INF/services/java.sql.Driver`
æ–‡ä»¶ä¸­çš„é©±åŠ¨ç±»ã€‚

#### 4.1.2 è·å–è¿æ¥

æˆ‘ä»¬ä½¿ç”¨ DriverManager ç±»çš„ getConnection() é™æ€æ–¹æ³•æ¥è·å–æ•°æ®åº“è¿æ¥å¯¹è±¡ï¼Œå…¶æ–¹æ³•æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯ urlï¼Œæ•°æ®åº“çš„ç”¨æˆ·åå’Œå¯†ç ã€‚url æœ‰å…¶å›ºå®šçš„è¯­æ³•æ ¼å¼ï¼š

```java
jdbc:mysql://ipåœ°å€(åŸŸå):ç«¯å£å·/è¿æ¥çš„æ•°æ®åº“å?å‚æ•°é”®å€¼å¯¹1&å‚æ•°é”®å€¼å¯¹2

jdbc:mysql://è¿æ¥çš„æ•°æ®åº“å?å‚æ•°é”®å€¼å¯¹1&å‚æ•°é”®å€¼å¯¹2 //å¦‚æœä½¿ç”¨çš„æ˜¯æœ¬åœ°çš„ MySQL ï¼Œå¹¶ä¸”ä½¿ç”¨é»˜è®¤çš„ç«¯å£å· 3306 çš„ï¼Œurl çš„å€¼å¯ä»¥ç®€å†™

```

ä¾‹å¦‚ï¼š

```java
jdbc:mysql://db1?useSSL=false

```

> è¿™é‡Œ useSSL = false å…³é—­äº†å®‰å…¨è¿æ¥æ–¹å¼ï¼Œè§£å†³äº† idea è­¦å‘Šçš„é—®é¢˜ã€‚

### 4.2 Connection

`Connection`
ï¼Œæ•°æ®åº“è¿æ¥å¯¹è±¡æ¥å£ã€‚åœ¨å…¥é—¨ç¯‡ä¸­ä½¿ç”¨äº†è¯¥ç±»è·å– sql çš„æ‰§è¡Œå¯¹è±¡ statementã€‚

Connection æ¥å£çš„ä½œç”¨æœ‰ï¼š

1. è·å–æ‰§è¡Œ SQL çš„å¯¹è±¡
2. ç®¡ç†äº‹åŠ¡

#### 4.2.1 è·å–æ‰§è¡Œsqlçš„å¯¹è±¡

Connection ä¸­çš„ createStatement() æ–¹æ³•å¯ä»¥è·å–æ‰§è¡Œ sql çš„å¯¹è±¡ Statement ï¼Œç”¨äºæŠŠ sql å‘é€åˆ°æ•°æ®åº“æœåŠ¡ç«¯ã€‚ä½¿ç”¨ preparedStatement() æ–¹æ³•å¯ä»¥
**è·å–é¢„ç¼–è¯‘ sql çš„æ‰§è¡Œ sql çš„å¯¹è±¡**
ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥æœ‰æ•ˆçš„é˜²æ­¢ sql æ³¨å…¥çš„é—®é¢˜ã€‚

#### 4.2.2 äº‹åŠ¡ç®¡ç†

åœ¨JDBC ä¸­ä½¿ç”¨ Connection å¯¹è±¡è¿›è¡Œäº‹åŠ¡ç®¡ç†ï¼ŒConnection ä¸­å®šä¹‰äº†ä¸‰ä¸ªå¯¹åº”çš„æ–¹æ³•ï¼š

å¼€å¯äº‹åŠ¡ï¼š

```java
void setAutoCommit(boolean autoCommit) //å°†æ­¤è¿æ¥çš„è‡ªåŠ¨æäº¤æ¨¡å¼è®¾ç½®ä¸ºç»™å®šçŠ¶æ€

```

å›æ»šäº‹åŠ¡ï¼š

```java
void rollback() //æ’¤æ¶ˆå½“å‰äº‹åŠ¡ä¸­æ‰€åšçš„æ‰€æœ‰æ›´æ”¹ï¼Œå¹¶é‡Šæ”¾æ­¤ Connectionå¯¹è±¡å½“å‰æŒæœ‰çš„æ‰€æœ‰æ•°æ®åº“é”

```

æäº¤äº‹åŠ¡ï¼š

```java
void commit() //ä½¿è‡ªä¸Šæ¬¡æäº¤/å›æ»šä»¥æ¥æ‰€åšçš„æ‰€æœ‰æ›´æ”¹æˆä¸ºæ°¸ä¹…æ›´æ”¹ï¼Œå¹¶é‡Šæ”¾æ­¤ Connectionå¯¹è±¡å½“å‰æŒæœ‰çš„æ‰€æœ‰æ•°æ®åº“é”

```

ç¤ºä¾‹ï¼š

```java
public class JDBCDemo {

    public static void main(String[] args) throws Exception {
        //1. æ³¨å†Œé©±åŠ¨
        Class.forName("com.mysql.jdbc.Driver");
        //2. è·å–è¿æ¥ï¼šå¦‚æœè¿æ¥çš„æ˜¯æœ¬æœºmysqlå¹¶ä¸”ç«¯å£æ˜¯é»˜è®¤çš„ 3306 å¯ä»¥ç®€åŒ–ä¹¦å†™
        String url = "jdbc:mysql://db1?useSSL=false";
        String username = "root";
        String ppassword = "abc123";
        Connection conn = DriverManager.getConnection(url, username, password);
        //3. å®šä¹‰sql
        String sql1 = "update account set money = 3000 where id = 1";
        String sql2 = "update account set money = 3000 where id = 2";
        //4. è·å–æ‰§è¡Œsqlçš„å¯¹è±¡ Statement
        Statement stmt = conn.createStatement();

        try {
            // å¼€å¯äº‹åŠ¡
            conn.setAutoCommit(false);
            //5. æ‰§è¡Œsql
            int count1 = stmt.executeUpdate(sql1);//å—å½±å“çš„è¡Œæ•°
            //6. å¤„ç†ç»“æœ
            System.out.println(count1);
            int i = 3 / 0;
            //5. æ‰§è¡Œsql
            int count2 = stmt.executeUpdate(sql2);
            //6. å¤„ç†ç»“æœ
            System.out.println(count2);

            // æäº¤äº‹åŠ¡
            conn.commit();
        } catch (Exception e) {
            // å›æ»šäº‹åŠ¡
            conn.rollback();
            e.printStackTrace();
        }

        //7. é‡Šæ”¾èµ„æº
        stmt.close();
        conn.close();
    }
}

```

æˆ‘ä»¬ä½¿ç”¨ Java ä¸­çš„å¼‚å¸¸æ•è·æœºåˆ¶æ¥è¿›è¡Œäº‹åŠ¡çš„ç®¡ç†ã€‚å°†æ‰§è¡Œ sql çš„è¯­å¥æ”¾åœ¨ try ä»£ç å—ä¸­ï¼Œå¹¶ä¸”ä½¿ç”¨ setAutoCommit() æ–¹æ³•å¼€å¯äº‹åŠ¡ï¼Œå¦‚æœä»£ç å—ä¸­æ²¡æœ‰å‡ºç°å¼‚å¸¸ï¼Œåˆ™ä½¿ç”¨ commit() æ–¹æ³•æäº¤äº‹åŠ¡ï¼Œå¦‚æœ try ä»£ç å—æŸå¤„å‡ºç°äº†å¼‚å¸¸ï¼Œåˆ™éœ€è¦å›æ»šäº‹åŠ¡ï¼Œæ‰€ä»¥å°†å›æ»šäº‹åŠ¡çš„ rollback() æ–¹æ³•å®šä¹‰åœ¨ catch è¯­å¥å—ä¸­ã€‚

### 4.3 Statement

Statement ç±»çš„å¯¹è±¡ç”¨æ¥æ‰§è¡Œ sql è¯­å¥ï¼Œå³æŠŠ sql å‘é€åˆ°æ•°æ®åº“æœåŠ¡ç«¯ï¼Œä½†æ˜¯ä½¿ç”¨æ­¤ç±»å¯¹è±¡æ‰§è¡Œ sql ä¼šå‡ºç° sql æ³¨å…¥çš„é—®é¢˜ã€‚ä¸åŒçš„ sql è¯­å¥ä½¿ç”¨ä¸åŒçš„æ–¹æ³•æ‰§è¡Œï¼Œæ‰§è¡Œ DDLï¼ŒDML è¯­å¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•ï¼š

```java
int executeUpdate(String sql)//æ‰§è¡Œsqlè¯­å¥å®Œæˆå¢åˆ æ”¹æ“ä½œ

```

åœ¨æ‰§è¡Œ DML è¯­å¥å®Œæˆå¯¹æ•°æ®çš„å¢åˆ æ”¹æ“ä½œæ—¶ï¼Œè¯¥æ–¹æ³•è¿”å›æ•°æ®è¡¨ä¸­å—å½±å“çš„è¡Œæ•°ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªè¿”å›å€¼æ¥åˆ¤æ–­æ˜¯å¦æˆåŠŸå®Œæˆå¯¹æ•°æ®çš„æ“ä½œã€‚è€Œä½¿ç”¨ DDL æ¥æ“ä½œæ•°æ®åº“å’Œæ•°æ®è¡¨æ—¶ï¼Œè¿”å›å€¼å¯èƒ½ä¸º 0ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨ä½œä¸Šé¢çš„åˆ¤æ–­ï¼Œä¸”åœ¨å¼€å‘ä¸­ DDL å¾ˆå°‘è¢«ç”¨åˆ°ã€‚

ç¤ºä¾‹1ï¼Œä½¿ç”¨ DML ä¿®æ”¹æ•°æ®ï¼š

```java
//3.å®šä¹‰sql
String sql="update account set money=2000 where name='å¼ ä¸‰'";
//5.æ‰§è¡Œsql
int count = stmt.executeUpdate(sql);
//6.å¤„ç†ç»“æœ
if(count>0){
    System.out.println("ä¿®æ”¹æˆåŠŸï¼");
}else{
     System.out.println("ä¿®æ”¹å¤±è´¥ï¼");
}

```

ç¤ºä¾‹2ï¼Œä½¿ç”¨ DDL åˆ é™¤æ•°æ®åº“ï¼š

```java
//3.å®šä¹‰sql
String sql="drop database db2";
//4.è·å–æ‰§è¡Œsqlçš„å¯¹è±¡
Statement stmt = conn.createStatement();
//5.æ‰§è¡Œsql
int count = stmt.executeUpdate(sql);
//6.å¤„ç†ç»“æœ
System.out.println(count);

```

æ­¤æ—¶ï¼Œæ§åˆ¶å°è¿”å›äº† 0 ï¼Œä½†æ˜¯å¯¹æ•°æ®åº“çš„åˆ é™¤æ“ä½œå·²ç»å®Œæˆã€‚

![image-20230123111252544](https://i-blog.csdnimg.cn/blog_migrate/3b0d415aba33aa6523c2a7cdc9b79acb.png)

æ‰§è¡Œ DQL è¯­å¥æ—¶éœ€è¦ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•ï¼š

```java
ResultSet excuteQuery(String sql)//æ‰§è¡Œsqlè¯­å¥å®ŒæˆæŸ¥è¯¢æ“ä½œï¼Œè¿”å›å•ä¸ªResultSetå¯¹è±¡

```

è¯¥æ–¹æ³•åœ¨ä¸‹é¢ ResultSetç±»ä¸­è®²è§£ã€‚

### 4.4 ResultSet

`ResultSet`
ï¼Œç»“æœé›†å¯¹è±¡ç±»ï¼Œå…¶ä½œç”¨æ˜¯å°è£… sql æŸ¥è¯¢è¯­å¥çš„ç»“æœã€‚æ‰§è¡Œäº† DQL æŸ¥è¯¢è¯­å¥åå°±ä¼šè¿”å›è¯¥ç±»çš„å¯¹è±¡ï¼Œæ‰§è¡Œ DQL è¯­å¥çš„æ–¹æ³•å¦‚ä¸‹ï¼š

```java
ResultSet excuteQuery(String sql)//æ‰§è¡Œsqlè¯­å¥å®ŒæˆæŸ¥è¯¢æ“ä½œï¼Œè¿”å›å•ä¸ªResultSetå¯¹è±¡

```

ResultSet ç±»æä¾›äº†
**æ“ä½œæŸ¥è¯¢ç»“æœæ•°æ®**
çš„æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š

```java
/*
ä½œç”¨:å°†æŒ‡é’ˆä»å½“å‰ä½ç½®ç§»åŠ¨åˆ°ä¸‹ä¸€è¡Œï¼Œç„¶åè¿™ä¸€è¡Œæ˜¯å¦ä¸ºæœ‰æ•ˆè¡Œ
è¿”å›å€¼ï¼štrue å½“å‰è¡Œä¸ºæœ‰æ•ˆè¡Œï¼Œfalse å½“å‰è¡Œæ²¡æœ‰æ•°æ®
*/
boolean next()
/*
ä½œç”¨ï¼šè·å–æ•°æ®  
xxxè¡¨ç¤ºæ•°æ®ç±»å‹ ä¾‹å¦‚ int getInt() 
å‚æ•°ï¼šintç±»å‹çš„å‚æ•°è¡¨ç¤ºåˆ—çš„ç¼–å·ï¼Œè¿™ä¸ªç¼–å·ä»0å¼€å§‹;Stringç±»å‹çš„å‚æ•°ï¼Œè¡¨ç¤ºåˆ—çš„åç§°
*/
xxx getXxx(å‚æ•°)
    
    

```

æ“ä½œæŸ¥è¯¢ç»“æœæ•°æ®çš„æ–¹æ³•å¦‚ä¸‹å›¾ï¼š

![](https://i-blog.csdnimg.cn/blog_migrate/e8551d6e9eab4843aa5ca1f3402d80c1.png)

ä¸€å¼€å§‹æŒ‡é’ˆä½äºç¬¬ä¸€è¡Œå‰ï¼Œå¦‚å›¾æ‰€ç¤ºçº¢è‰²ç®­å¤´æŒ‡å‘äºè¡¨å¤´è¡Œã€‚å½“æˆ‘ä»¬è°ƒç”¨äº†
`next()`
æ–¹æ³•åï¼ŒæŒ‡é’ˆå°±ä¸‹ç§»åˆ°ç¬¬ä¸€è¡Œæ•°æ®ï¼Œå¹¶ä¸”æ–¹æ³•è¿”å› trueï¼Œæ­¤æ—¶å°±å¯ä»¥é€šè¿‡
`getInt("id")`
è·å–å½“å‰è¡Œ id å­—æ®µçš„å€¼ï¼Œä¹Ÿå¯ä»¥é€šè¿‡
`getString("name")`
è·å–å½“å‰è¡Œ name å­—æ®µçš„å€¼ã€‚å¦‚æœæƒ³è·å–ä¸‹ä¸€è¡Œçš„æ•°æ®ï¼Œç»§ç»­è°ƒç”¨
`next()`
æ–¹æ³•ï¼Œä»¥æ­¤ç±»æ¨ã€‚è·å–æŸä¸ªå­—æ®µçš„å€¼æ—¶ï¼Œæ—¢å¯ä»¥ä¼ å…¥ int ç±»å‹ï¼Œå³åˆ—çš„ç¼–å·ï¼Œä¹Ÿå¯ä»¥ä¼ å…¥åˆ—å¯¹åº”çš„å­—æ®µåã€‚

ç¤ºä¾‹ï¼ŒæŸ¥è¯¢ account è¡¨ä¸­æ•°æ®ï¼Œå¹¶ä¸”æ‰“å°æ‰€æœ‰ç»“æœï¼š

```java
public class JDBCDemo {
    public static void main(String[] args) throws Exception {
        //1. æ³¨å†Œé©±åŠ¨
        Class.forName("com.mysql.jdbc.Driver");
        //2. è·å–è¿æ¥ï¼šå¦‚æœè¿æ¥çš„æ˜¯æœ¬æœºmysqlå¹¶ä¸”ç«¯å£æ˜¯é»˜è®¤çš„ 3306 å¯ä»¥ç®€åŒ–ä¹¦å†™
        String url = "jdbc:mysql://localhost:3306/db1?useSSL=false";
        String username = "root";
        String ppassword = "abc123";
        Connection conn = DriverManager.getConnection(url, username, password);
        //3. å®šä¹‰sql
        String sql = "select * from account";
        //4. è·å–æ‰§è¡Œsqlå¯¹è±¡
        Statement stmt = conn.createStatement();
        //5. æ‰§è¡Œsql
        ResultSet rs = stmt.executeQuery(sql);
        //6. å¤„ç†è¿”å›ç»“æœï¼Œ éå†rsä¸­çš„æ‰€æœ‰æ•°æ®
        // 1 æŒ‡é’ˆå‘ä¸‹ç§»åŠ¨ä¸€è¡Œï¼Œå¹¶ä¸”åˆ¤æ–­å½“å‰è¡Œæ˜¯å¦æœ‰æ•°æ®
        while (rs.next()) {
            // 2 è·å–æ•°æ®  getXxx()
            int id = rs.getInt("id");
            String name = rs.getString("name");
            double money = rs.getDouble("money");

            System.out.println(id);
            System.out.println(name);
            System.out.println(money);
        }
        //7. é‡Šæ”¾èµ„æº
        rs.close();
        stmt.close();
        conn.close();
    }
}

```

### 4.5 PreparedStatement

#### 4.5.1 sqlæ³¨å…¥é—®é¢˜

å‰é¢ statement ç±»çš„å¯¹è±¡ç”¨æ¥æ‰§è¡Œsqlè¯­å¥ï¼Œä¾‹å¦‚ ï¼š

```java
int executeUpdate(String sql)//æ‰§è¡Œsqlè¯­å¥å®Œæˆå¢åˆ æ”¹æ“ä½œ

```

ä½†æ˜¯ä½¿ç”¨æ­¤æ–¹æ³•å­˜åœ¨ sql æ³¨å…¥çš„é—®é¢˜ï¼Œä»€ä¹ˆæ˜¯ sql æ³¨å…¥å‘¢ï¼Ÿè¿™é‡Œåšä¸€ä¸ªå¤§è‡´çš„è®²è§£ã€‚

SQLæ³¨å…¥æ˜¯é€šè¿‡æ“ä½œè¾“å…¥æ¥ä¿®æ”¹äº‹å…ˆå®šä¹‰å¥½çš„ sql è¯­å¥ï¼Œç”¨æ¥è¾¾åˆ°æ‰§è¡Œä»£ç å¯¹æœåŠ¡å™¨è¿›è¡Œæ”»å‡»çš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œåœ¨ç¨‹åºçš„ç™»å½•æ“ä½œä¸­ï¼Œç”¨æˆ·è¾“å…¥çš„ç”¨æˆ·åå’Œå¯†ç ä¼šè¢«å‘é€åˆ° Java ä»£ç ï¼Œç„¶åç”¨äº Java æ“ä½œæ•°æ®åº“çš„sql è¯­å¥ä¸­ï¼Œåªæœ‰å½“ç”¨æˆ·è¾“å…¥çš„ç”¨æˆ·åå’Œå¯†ç ä¸æ•°æ®åº“ä¸­çš„æ•°æ®åŒ¹é…æ—¶æ‰èƒ½å®ç°ç™»å½•ï¼Œä½†æ˜¯ï¼Œåªè¦æˆ‘ä»¬è¾“å…¥äº‹å…ˆå®šä¹‰å¥½çš„è¯­å¥ï¼Œä¾¿å¯ä»¥è¿›è¡Œç ´è§£ã€‚ä¾‹å¦‚ä¸‹é¢æ‹¼å­—ç¬¦ä¸²çš„æ–¹å¼ä¿®æ”¹ sql è¯­å¥åŸæ¥çš„å«ä¹‰ï¼š

```java
String name ="lisi";
String ppwd="' or '1' ='1";//äº‹å…ˆå®šä¹‰å¥½çš„è¾“å…¥ï¼Œæ‹¼æ¥åˆ°sqlè¯­å¥ä¸­åæ”¹å˜å…¶å«ä¹‰
String sql = "Select * from tb_user where name='"+username+"' and ppassword='"+ppwd+"'";

```

æ­¤æ—¶ï¼Œå°†ç”¨æˆ·åå’Œå¯†ç æ‹¼æ¥åˆ° sql ä¸­ï¼Œå¦‚ä¸‹ï¼š

```java
select * from tb_user where username = 'lisi' and ppassword = ''or '1' = '1';

```

å¯ä»¥çœ‹åˆ°ï¼Œsql ä¸­çš„åˆ¤æ–­æ¡ä»¶æ°¸è¿œä¸º true ï¼Œä¸ç®¡è¾“å…¥ä»€ä¹ˆæ ·çš„ç”¨æˆ·åï¼Œè¿™æ¡ sql éƒ½æˆç«‹ï¼Œå®ç°äº† sql æ³¨å…¥ã€‚

![image-20230123152756547](https://i-blog.csdnimg.cn/blog_migrate/64fe75b97bfbb35454fb195c9500bd6b.png)

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå‡ºç°äº† preparedStatement ï¼Œè¯¥ç±»ç”¨äºé¢„ç¼–è¯‘ sql è¯­å¥å¹¶æ‰§è¡Œï¼Œå…¶ä¼˜ç‚¹æ˜¯å¯ä»¥é˜²æ­¢sql æ³¨å…¥ï¼Œå¹¶ä¸”é¢„ç¼–è¯‘sqlæé«˜äº†æ€§èƒ½ã€‚å…¶å®åº•å±‚æ˜¯å°†ç‰¹æ®Šå­—ç¬¦è¿›è¡Œäº†è½¬ä¹‰ï¼Œè½¬ä¹‰çš„ sql å¦‚ä¸‹ï¼š

```java
select * from tb_user where username = 'lisi' and ppassword = '\'or \'1\' = \'1'

```

ç¤ºä¾‹ï¼š

```java
public class JDBCDemo {
    public static void main(String[] args) throws Exception {
        //1. æ³¨å†Œé©±åŠ¨
        Class.forName("com.mysql.jdbc.Driver");
        //2. è·å–è¿æ¥
        String url="jdbc:mysql://localhost:3306/db1?useSSL=false";
        String username="root";
        String ppassword="abc123";
        Connection conn = DriverManager.getConnection(url,username,password);
        //Javaä»£ç æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„ç”¨æˆ·åå’Œå¯†ç 
        String name="lisi";
        String ppwd="' or '1' ='1";
        //3. å®šä¹‰sql
        String sql="select * from tb_user where username=? and password=?";
        //4. è·å–æ‰§è¡Œsqlçš„å¯¹è±¡psmt
        PreparedStatement psmt = conn.prepareStatement(sql);
        //è®¾ç½®é—®å·çš„å€¼
        psmt.setString(1,name);
        psmt.setString(2,pwd);
        //5. æ‰§è¡Œsql
        ResultSet rs = psmt.executeQuery();//æ­¤æ—¶ä¸å†éœ€è¦ä¼ å…¥sqlè¯­å¥
        //6. å¤„ç†è¿”å›ç»“æœ
        if(rs.next()){
            System.out.println("yes");
        }else{
            System.out.println("no");
        }
        //7. é‡Šæ”¾èµ„æº
        rs.close();
        psmt.close();
        conn.close();
    }
}

```

![image-20230123152857215](https://i-blog.csdnimg.cn/blog_migrate/f7105593d296ff85e9658b64a5400136.png)

#### 4.5.2 preparedStatement åŸç†

å‰é¢ä½¿ç”¨
`preparedStatement`
è§£å†³äº† sql æ³¨å…¥çš„é—®é¢˜ï¼Œå…¶å®æˆ‘ä»¬è¿˜æ²¡æœ‰å¼€å¯é¢„ç¼–è¯‘çš„åŠŸèƒ½ï¼ŒJDBC ä¸­æ˜¯å¦‚ä½•é€šè¿‡é¢„ç¼–è¯‘æ¥æé«˜æ€§èƒ½çš„å‘¢ï¼Ÿ

è¦å­¦ä¹  prepareStatement å®ç°é¢„ç¼–è¯‘çš„åŸç†ï¼Œé¦–å…ˆè¦æ˜ç™½ Java æ“ä½œæ•°æ®åº“çš„æ­¥éª¤ï¼š

é¦–å…ˆ Java ä»£ç å°† sql å‘é€åˆ° MySQL æœåŠ¡ç«¯ï¼ŒMySQL æœåŠ¡ç«¯æ¥æ”¶åˆ° sql è¯­å¥ä»¥åï¼Œä¼šå¯¹ sql è¯­å¥è¿›è¡Œæ£€æŸ¥ï¼ˆæ£€æŸ¥ sql è¯­å¥çš„è¯­æ³•ï¼‰ï¼Œç¼–è¯‘ï¼ˆç¼–è¯‘ sql è¯­å¥ï¼Œå°† sql è¯­å¥ç¼–è¯‘æˆå¯æ‰§è¡Œçš„å‡½æ•°ï¼‰ï¼Œæ‰§è¡Œçš„æ“ä½œã€‚è€Œæ£€æŸ¥å’Œç¼–è¯‘ sql è¯­å¥èŠ±è´¹çš„æ—¶é—´å¾€å¾€è¾ƒé•¿ï¼Œå¦‚æœæƒ³è¦æé«˜ sql çš„æ€§èƒ½ï¼Œå°±å¯ä»¥ä»è¿™æ–¹é¢å…¥æ‰‹ã€‚åœ¨ä½¿ç”¨é¢„ç¼–è¯‘çš„æ–¹æ³•æ—¶ï¼Œæ£€æŸ¥å’Œç¼–è¯‘ sql è¯­å¥çš„æ“ä½œå°†ä¼šåœ¨è·å–æ‰§è¡Œ sql çš„å¯¹è±¡æ—¶å®Œæˆï¼Œå¹¶ä¸”ä¸ä¼šé‡å¤æ‰§è¡Œï¼Œä»è€Œæé«˜äº†æ€§èƒ½ã€‚

![image-20230123155242436](https://i-blog.csdnimg.cn/blog_migrate/a281aae75844387d98d2065f51ec4d88.png)

è¦æƒ³æ‰“å¼€é¢„ç¼–è¯‘çš„åŠŸèƒ½ï¼Œå°±éœ€è¦åœ¨ url ä¸­è®¾ç½®å¦‚ä¸‹çš„å‚æ•°ï¼š

```java
useServerPrepStmts=true //å‚æ•°å¼€å¯é¢„ç¼–è¯‘åŠŸèƒ½

```

ç¤ºä¾‹ï¼š

```java
public class JDBCDemo {
    public static void main(String[] args) throws Exception {
        //1. æ³¨å†Œé©±åŠ¨
        Class.forName("com.mysql.jdbc.Driver");
        //2. è·å–è¿æ¥
        String url="jdbc:mysql://localhost:3306/db1?useSSL=false&useServerPrepStmts=true";
        String username="root";
        String ppassword="abc123";
        Connection conn = DriverManager.getConnection(url,username,password);
        //Javaä»£ç æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„ç”¨æˆ·åå’Œå¯†ç 
        String name="lisi";
        String ppwd="'or '1' = '1";
        //3. å®šä¹‰sql
        String sql="select * from tb_user where username=? and password=?";
        //4. è·å–æ‰§è¡Œsqlçš„å¯¹è±¡psmt
        PreparedStatement psmt = conn.prepareStatement(sql);

        //è®¾ç½®é—®å·çš„å€¼
        psmt.setString(1,name);
        psmt.setString(2,pwd);
        ResultSet rs=null;
        //5. æ‰§è¡Œsql
        rs = psmt.executeQuery();//æ­¤æ—¶ä¸éœ€è¦ä¼ å…¥sqlè¯­å¥

        psmt.setString(1,"zhangsan");
        psmt.setString(2,"abc123");
        rs=psmt.executeQuery();

        //6. å¤„ç†è¿”å›ç»“æœ
        if(rs.next()){
            System.out.println("yes");
        }else{
            System.out.println("no");
        }
        //7. é‡Šæ”¾èµ„æº
        rs.close();
        psmt.close();
        conn.close();
    }
}

```

åœ¨è·å– sql çš„æ‰§è¡Œå¯¹è±¡æ—¶ï¼Œsql ä¼šä½œä¸ºå‚æ•°è¢«å‘é€åˆ° MySQL æœåŠ¡ç«¯è¿›è¡Œæ£€æŸ¥å’Œç¼–è¯‘ï¼Œåœ¨æ‰§è¡Œæ—¶ï¼Œä¸å†è¿›è¡Œç¬¬äºŒæ¬¡æ£€æŸ¥å’Œç¼–è¯‘çš„æ“ä½œï¼Œæé«˜äº† sql æ‰§è¡Œçš„æ€§èƒ½ã€‚

## 5. æ•°æ®åº“è¿æ¥æ± 

### 5.1 æ¦‚å¿µ

å‰é¢åœ¨ JDBC API è¯¦è§£ä¸­ï¼Œè·å–çš„æ•°æ®åº“è¿æ¥å¯¹è±¡ connï¼Œåœ¨ä½¿ç”¨æ—¶åˆ›å»ºï¼Œä½¿ç”¨å®Œæ¯•å°±ä¼šå°†å…¶é”€æ¯ã€‚è¿™æ ·é‡å¤åˆ›å»ºå’Œé”€æ¯çš„è¿‡ç¨‹å®é™…ä¸Šæ˜¯æ¶ˆè€—æ€§èƒ½å’Œæ—¶é—´çš„ï¼Œå½“å¤§é‡ç”¨æˆ·è®¿é—®æ•°æ®åº“æ—¶ï¼Œæ¯æ¬¡éƒ½è¦è¿›è¡Œæ•°æ®åº“è¿æ¥å¯¹è±¡çš„åˆ›å»ºå’Œé”€æ¯ï¼Œå¯¹ç³»ç»Ÿæ¥è¯´æ˜¯ä¸€ç§å¤§é‡çš„æ¶ˆè€—ã€‚é‚£ä¹ˆæˆ‘ä»¬æ€æ ·æ¥æå‡æ€§èƒ½å’ŒèŠ‚çœæ—¶é—´å‘¢ï¼Ÿ

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/73a2dba22c7e834d48c59da327e9d77b.png)

æˆ‘ä»¬ä½¿ç”¨
**æ•°æ®åº“è¿æ¥æ± **
æ¥é‡å¤åˆ©ç”¨æ•°æ®åº“çš„è¿æ¥å¯¹è±¡ï¼Œå³ Connection ç±»å¯¹è±¡ã€‚

![image-20230123214035329](https://i-blog.csdnimg.cn/blog_migrate/d75b26874fea4560254f87b0622569f4.png)

æ•°æ®åº“è¿æ¥æ± æ˜¯ä¸€ä¸ªè´Ÿè´£åˆ†é…ï¼Œç®¡ç†æ•°æ®åº“è¿æ¥å¯¹è±¡çš„å®¹å™¨ï¼Œå®ƒå…è®¸åº”ç”¨ç¨‹åºé‡å¤ä½¿ç”¨åŒä¸€ä¸ªæ•°æ®åº“è¿æ¥å¯¹è±¡ã€‚æ•°æ®åº“è¿æ¥æ± å¯ä»¥é‡Šæ”¾ç©ºé—²æ—¶é—´è¶…è¿‡æœ€å¤§ç©ºé—²æ—¶é—´çš„æ•°æ®åº“è¿æ¥å¯¹è±¡æ¥é¿å…å› ä¸ºæ²¡æœ‰é‡Šæ”¾æ•°æ®åº“è¿æ¥å¯¹è±¡è€Œå¼•èµ·çš„æ•°æ®åº“è¿æ¥é—æ¼ã€‚

![image-20230123221109976](https://i-blog.csdnimg.cn/blog_migrate/6b18ad6ba8aad23943ec30ee4fc32cf2.png)

è¿æ¥æ± æ˜¯åœ¨ä¸€å¼€å§‹å°±åˆ›å»ºå¥½äº†ä¸€äº›è¿æ¥å¯¹è±¡å­˜å‚¨èµ·æ¥ï¼Œç”¨æˆ·éœ€è¦è¿æ¥æ•°æ®åº“æ—¶ï¼Œä¸éœ€è¦è‡ªå·±åˆ›å»ºè¿æ¥å¯¹è±¡ï¼Œè€Œåªéœ€è¦ä»è¿æ¥æ± ä¸­è·å–ä¸€ä¸ªè¿æ¥å¯¹è±¡è¿›è¡Œä½¿ç”¨ï¼Œä½¿ç”¨å®Œæ¯•åå†å°†è¿æ¥å¯¹è±¡å½’è¿˜ç»™è¿æ¥æ± ã€‚è¿™æ ·å°±å¯ä»¥
**èµ·åˆ°èµ„æºé‡ç”¨çš„ä½œç”¨ï¼Œä¹ŸèŠ‚çœäº†é¢‘ç¹åˆ›å»ºè¿æ¥é”€æ¯è¿æ¥æ‰€èŠ±è´¹çš„æ—¶é—´ï¼Œä»è€Œæå‡äº†ç³»ç»Ÿå“åº”çš„é€Ÿåº¦**
ã€‚

æ€»ç»“æ¥è¯´ä½¿ç”¨æ•°æ®åº“è¿æ¥æ± æœ‰ä»¥ä¸‹å‡ ç‚¹å¥½å¤„ï¼š

* å®ç°èµ„æºé‡ç”¨
* æå‡ç³»ç»Ÿå“åº”é€Ÿåº¦
* é¿å…æ•°æ®åº“è¿æ¥é—æ¼

### 5.2 å®ç°

sun å…¬å¸æä¾›äº†æ•°æ®åº“è¿æ¥æ± çš„æ ‡å‡†æ¥å£
`DataSource`
ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨ç¬¬ä¸‰æ–¹å®ç°è¯¥æ¥å£çš„å®ç°ç±»ï¼Œæ‰€æœ‰å®ç°ç±»éƒ½ç»§æ‰¿äº†å…¶è·å–è¿æ¥çš„æ–¹æ³•ï¼š

```java
Connection getConnection()

```

å¸¸è§çš„æ•°æ®åº“è¿æ¥æ± æœ‰ï¼š

* Druidï¼ˆå¾·é²ä¼Šï¼‰
* C3P0
* DBCP

ä½¿ç”¨äº†æ•°æ®åº“è¿æ¥æ± ä»¥åï¼Œåœ¨è·å–æ•°æ®åº“è¿æ¥å¯¹è±¡æ—¶ä¸éœ€è¦é€šè¿‡ DriverManagerç±»çš„ getConnection() æ–¹æ³•ï¼Œè€Œæ˜¯ç›´æ¥ä»æ•°æ®åº“è¿æ¥æ± ä¸­è·å–ã€‚æˆ‘ä»¬ä»Šå¤©è¦ä½¿ç”¨çš„æ˜¯ Druid è¿æ¥æ± ï¼Œå®ƒæ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„æ•°æ®åº“è¿æ¥æ± é¡¹ç›®ï¼Œå…¶åŠŸèƒ½å¼ºå¤§ï¼Œæ€§èƒ½ä¼˜ç§€ï¼Œä½¿ç”¨å æ¯”é«˜ï¼Œæ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æ•°æ®åº“è¿æ¥æ± ã€‚

## 6. Druid è¿æ¥æ± çš„ä½¿ç”¨

ä¸‹é¢ä»¥ Druid è¿æ¥æ± ä¸ºä¾‹ï¼Œè®²è§£é€šè¿‡æ•°æ®åº“è¿æ¥æ± è·å–æ•°æ®åº“è¿æ¥å¯¹è±¡ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š

1. å¯¼å…¥Druid è¿æ¥æ± çš„ jar åŒ…
2. å®šä¹‰é…ç½®æ–‡ä»¶
3. åŠ è½½é…ç½®æ–‡ä»¶
4. è·å–æ•°æ®åº“è¿æ¥æ± å¯¹è±¡
5. è·å–è¿æ¥

**ç¬¬ä¸€æ­¥**
ï¼šå°† Druid çš„ jar åŒ…æ”¾å…¥é¡¹ç›®ä¸­çš„ Lib ç›®å½•ä¸‹ä½œä¸ºåº“æ–‡ä»¶ï¼Œjar åŒ…è‡ªè¡Œä¸‹è½½ã€‚

![image-20230123222631273](https://i-blog.csdnimg.cn/blog_migrate/dde7d262a129ff235c23245a4d4c0715.png)

é€‰æ‹© Add as Libraryï¼Œé€‰æ‹©æ¨¡å—ä¸‹æœ‰æ•ˆï¼š

![image-20230123222706346](https://i-blog.csdnimg.cn/blog_migrate/b5e270cb51a21407d8ca7276851c86e5.png)

**ç¬¬äºŒæ­¥**
ï¼šç¼–å†™é…ç½®æ–‡ä»¶ï¼Œåœ¨ src ç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶
`druid.properties`
ã€‚

```java
driverClassName=com.mysql.jdbc.Driver
url=jdbc:mysql:///db1?useSSL=false&useServerPrepStmts=true
username=root
password=1234
# åˆå§‹åŒ–è¿æ¥æ•°é‡
initialSize=5
# æœ€å¤§è¿æ¥æ•°
maxActive=10
# æœ€å¤§ç­‰å¾…æ—¶é—´
maxWait=3000

```

Druid é…ç½®æ–‡ä»¶ä¸­æœ‰å¾ˆå¾ˆå¤šçš„å‚æ•°ï¼Œè¿™é‡Œé…ç½®äº†ç”¨åˆ°çš„å‡ é¡¹ï¼Œå…¶ä¸­æœ‰è¿æ¥æ•°æ®åº“çš„åç§°å’Œå¯†ç ï¼Œåˆå§‹è¿æ¥æ•°ï¼Œæœ€å¤§è¿æ¥æ•°ï¼Œæœ€å¤§ç­‰å¾…æ—¶é—´ç­‰ï¼Œè¶…è¿‡äº†æœ€å¤§ç­‰å¾…æ—¶é—´é…ç½®æ–‡ä»¶è¿˜æ²¡æœ‰åŠ è½½æˆåŠŸçš„è¯ï¼Œç¨‹åºå°±ä¼šæŠ¥é”™ã€‚

**ç¬¬ä¸‰æ­¥**
ï¼šåœ¨ä»£ç ä¸­åŠ è½½é…ç½®æ–‡ä»¶

```java
//3. åŠ è½½é…ç½®æ–‡ä»¶
Properties prop = new Properties();
prop.load(new FileInputStream("jdbc-demo/src/druid.properties"));

```

**ç¬¬å››æ­¥**
ï¼šåœ¨ä»£ç ä¸­è·å–è¿æ¥æ± å¯¹è±¡

```java
//4. è·å–è¿æ¥æ± å¯¹è±¡
DataSource dataSource = DruidDataSourceFactory.createDataSource(prop);

```

**ç¬¬äº”æ­¥**
ï¼šè·å–æ•°æ®åº“è¿æ¥å¯¹è±¡

```java
 //5. è·å–æ•°æ®åº“è¿æ¥ Connection
Connection connection = dataSource.getConnection();
System.out.println(connection); //è·å–åˆ°äº†è¿æ¥åå°±å¯ä»¥ç»§ç»­åšå…¶ä»–æ“ä½œäº†

```

ç¤ºä¾‹ï¼ŒDruidçš„ä½¿ç”¨å®Œæ•´ä»£ç ï¼š

```java
public class DruidDemo {

    public static void main(String[] args) throws Exception {
        //1.å¯¼å…¥jaråŒ…
        //2.å®šä¹‰é…ç½®æ–‡ä»¶
        //3. åŠ è½½é…ç½®æ–‡ä»¶
        Properties prop = new Properties();
        prop.load(new FileInputStream("jdbc-demo/src/druid.properties"));
        //4. è·å–è¿æ¥æ± å¯¹è±¡
        DataSource dataSource = DruidDataSourceFactory.createDataSource(prop);
        //5. è·å–æ•°æ®åº“è¿æ¥ Connection
        Connection connection = dataSource.getConnection();
        System.out.println(connection); //è·å–åˆ°äº†è¿æ¥åå°±å¯ä»¥ç»§ç»­åšå…¶ä»–æ“ä½œäº†  
    }
}

```

è¿è¡Œç»“æœï¼š

![image-20230123224744196](https://i-blog.csdnimg.cn/blog_migrate/4ea1b65cef439986cbe7e6585783d08c.png)

å…¶ä¸­ï¼ŒDruidDataSourceFactory ç±»ä¸­çš„
`createDataSource()`
æ–¹æ³•æ—¢å¯ä»¥ä¼ å…¥ä¸€ä¸ª Map é›†åˆï¼Œä¹Ÿå¯ä»¥ä¼ å…¥ prop å¯¹è±¡ï¼Œå…¶ä¸­éƒ½å­˜æ”¾é…ç½®ä¿¡æ¯ï¼Œç”¨æ¥è·å–è¿æ¥æ± å¯¹è±¡ã€‚

> å°tipsï¼šå¦‚æœä»£ç ä¸­æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„æŠ¥é”™ï¼Œå¯ä»¥ä½¿ç”¨
> `System.getProperty("user.dir")`
> è·å–é¡¹ç›®çš„å½“å‰è·¯å¾„ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/7bb2be25d0726bf56617c05674679b58.png)

## 7. å‡†å¤‡å·¥ä½œ

å‰é¢æˆ‘ä»¬è¯´è¿‡ï¼Œåœ¨ Java ä»£ç ä¸­ï¼Œæ‰§è¡Œ sql æŸ¥è¯¢è¯­å¥ä»¥åè¿”å›ä¸€ä¸ª ResultSet ç±»çš„å¯¹è±¡ï¼Œå¹¶ä¸” ResultSet ç±»æä¾›äº†æ–¹æ³•è®©æˆ‘ä»¬å¯ä»¥æ“ä½œæŸ¥è¯¢ç»“æœæ•°æ®ï¼Œä¾‹å¦‚å¯ä»¥ç›´æ¥æ‰“å°æ‰€æœ‰æŸ¥è¯¢çš„æ•°æ®ã€‚

ç¤ºä¾‹ï¼š

```java
public class JDBCDemo {

    public static void main(String[] args) throws Exception {
        //1. æ³¨å†Œé©±åŠ¨
        Class.forName("com.mysql.jdbc.Driver");
        //2. è·å–è¿æ¥
        String url="jdbc:mysql://localhost:3306/blog?useSSL=false";
        String username="root";
        String ppassword="abc123";//å¯†ç 
        Connection conn = DriverManager.getConnection(url,username,password);
        //3. å®šä¹‰sql
        String sql="select * from student";
        //4. è·å–sqlæ‰§è¡Œå¯¹è±¡
        Statement stmt = conn.createStatement();
        //5. æ‰§è¡Œsql
        ResultSet rs = stmt.executeQuery(sql);
        //6. å¤„ç†ç»“æœ
        while (rs.next()){
            int id=rs.getInt(1);
            String name=rs.getString(2);
            String gender=rs.getString(3);

            System.out.println(id);
            System.out.println(name);
            System.out.println(gender);

            System.out.println("---------");
        }
        //7. é‡Šæ”¾èµ„æº
        rs.close();
        stmt.close();
        conn.close();
    }
}

```

è¿è¡Œç»“æœï¼š

![image-20230124144624978](https://i-blog.csdnimg.cn/blog_migrate/f53e40203f07d18ec260fce3c346b4c5.png)

æ˜¾ç„¶è¿™æ ·å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœï¼Œæ•°æ®é›¶æ•£ä¸å¥½å¤„ç†ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠæ¯æ¡æ•°æ®å°è£…ä¸ºä¸€ä¸ªå®ä½“ç±»çš„å¯¹è±¡ï¼Œæ¯ä¸ªå¯¹è±¡å¯¹åº”æ•°æ®åº“è¡¨çš„ä¸€æ¡è®°å½•ï¼Œå¹¶ä¸”æŠŠæ¯ä¸ªå¯¹è±¡æ”¾åˆ°é›†åˆä¸­å­˜å‚¨ã€‚ç»ƒä¹ ä½¿ç”¨çš„æ•°æ®åº“è¡¨ï¼š

```sql
drop table if exists student;

create table student(
	id int primary key auto_increment,
	name varchar(10),
	gender char(1)
);

insert into student(name,gender) values
('å¼ ä¸‰','ç”·'),
('æå››','å¥³'),
('ç‹äº”','ç”·');

```

åœ¨ Navicat ä¸­æŸ¥çœ‹æ•°æ®è¡¨ï¼š

![image-20230124162412597](https://i-blog.csdnimg.cn/blog_migrate/b0dad25d715146c206f5ca47f74db1d7.png)

## 8. å®æˆ˜æ¡ˆä¾‹

**æŸ¥è¯¢å­¦ç”Ÿä¿¡æ¯è¡¨æ•°æ®ï¼Œå°è£…ä¸º Student ç±»å¯¹è±¡ï¼Œå¹¶å­˜æ”¾åœ¨ ArrayList é›†åˆä¸­ã€‚**

æ€è·¯ï¼šè¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¤§æ¦‚åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š

* åˆ›å»ºä¸€ä¸ª Student å®ä½“ç±»
* æŸ¥è¯¢æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œå¹¶ä¸”èµ‹å€¼ç»™å¯¹è±¡çš„å±æ€§
* å°†å¯¹è±¡å­˜å‚¨åˆ° ArrayList é›†åˆä¸­

**ç¬¬ä¸€æ­¥**
ï¼šåˆ›å»ºä¸€ä¸ªStudent å®ä½“ç±»ï¼Œå¹¶å®šä¹‰ set() æ–¹æ³•ï¼Œé‡å†™ Object ç±»ä¸­çš„ toString æ–¹æ³•ï¼Œæ–¹ä¾¿æŸ¥çœ‹æ‰“å°æ•ˆæœã€‚

```java
public class Student {
    private int id;
    private String name;
    private String gender;

    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    public void setName(String name) {
        this.name = name;
    }

    public void setGender(String gender) {
        this.gender = gender;
    }

    @Override
    public String toString() {
        return "Student{" +
                "id=" + id +
                ", name='" + name + '\'' +
                ", gender='" + gender + '\'' +
                '}';
    }
}

```

> å°tips ï¼šåœ¨ idea ä¸­ä½¿ç”¨ Alt + Inset å¿«æ·é”®å¯ä»¥å¿«é€Ÿç»™ç±»æ·»åŠ æˆ–é‡å†™ä¸€äº›æ–¹æ³•ï¼Œä¾‹å¦‚ get() ï¼Œset() ï¼ŒtoString() æ–¹æ³•ç­‰ã€‚ä½¿ç”¨ Ctrl + é¼ æ ‡å·¦é”®å¯ä»¥å¿«é€Ÿé€‰æ‹©å¤šé¡¹æ–¹æ³•ã€‚

**ç¬¬äºŒæ­¥**
ï¼šä½¿ç”¨ Java ä»£ç æ“ä½œæ•°æ®åº“ï¼ŒæŸ¥è¯¢æ•°æ®åº“è¡¨ä¸­æ‰€æœ‰å­¦ç”Ÿä¿¡æ¯å¹¶é€šè¿‡ set() æ–¹æ³•èµ‹å€¼ç»™ Student ç±»çš„å¯¹è±¡ï¼Œå°†å¯¹è±¡å­˜å‚¨åˆ°é›†åˆä¸­ã€‚

```java
public class JDBCDemo {

    public static void main(String[] args) throws Exception {
        //1. æ³¨å†Œé©±åŠ¨
        Class.forName("com.mysql.jdbc.Driver");
        //2. è·å–è¿æ¥
        String url = "jdbc:mysql://localhost:3306/blog?useSSL=false";
        String username = "root";
        String ppassword = "abc123";//å¯†ç 
        Connection conn = DriverManager.getConnection(url, username, password);
        //3. å®šä¹‰sql
        String sql = "select * from student";
        //4. è·å–sqlæ‰§è¡Œå¯¹è±¡
        Statement stmt = conn.createStatement();
        //5. æ‰§è¡Œsql
        ResultSet rs = stmt.executeQuery(sql);
        //6. å¤„ç†ç»“æœ
        List<Student> students = new ArrayList<>();

        while (rs.next()) {
            Student s = new Student();
            int id = rs.getInt(1);
            String name = rs.getString(2);
            String gender = rs.getString(3);

            s.setId(id);
            s.setName(name);
            s.setGender(gender);

            students.add(s);
        }
        System.out.println(students);
        //7. é‡Šæ”¾èµ„æº
        rs.close();
        stmt.close();
        conn.close();
    }
}

```

è¿è¡Œç»“æœï¼š

![image-20230124151820540](https://i-blog.csdnimg.cn/blog_migrate/711f33dbd0902a7fd0c1bb1967d61466.png)

è¿™æ ·ï¼Œæˆ‘ä»¬çš„ç¨‹åºå°±è¾¾åˆ°äº†é¢„æœŸçš„æ•ˆæœï¼Œå°†æ¥éœ€è¦ä½¿ç”¨çš„æ•°æ®å…¨éƒ¨å°è£…ä¸ºå¯¹è±¡å¹¶å­˜æ”¾åœ¨äº†é›†åˆä¸­ã€‚

## 9. å¢åˆ æ”¹æŸ¥æ“ä½œç»ƒä¹ 

åœ¨æ•°æ®åº“è¿æ¥æ± å…¥é—¨ç¯‡ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº† Druid è¿æ¥æ± çš„ä½¿ç”¨ï¼Œæ•°æ®åº“è¿æ¥æ± å…è®¸é‡å¤ä½¿ç”¨ä¸€ä¸ªç°æœ‰çš„æ•°æ®åº“è¿æ¥å¯¹è±¡ï¼Œæå‡äº†ç³»ç»Ÿçš„å“åº”é€Ÿåº¦å’Œæ—¶é—´ã€‚ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨æ•°æ®åº“è¿æ¥æ± æ¥ç»ƒä¹ è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œå¹¶ä¸”åœ¨è·å– sql æ‰§è¡Œå¯¹è±¡æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨ PreparedStatement ç±»ï¼Œè§£å†³sql æ³¨å…¥çš„é—®é¢˜ã€‚

### 9.1 æŸ¥è¯¢æ‰€æœ‰

æŸ¥è¯¢æ‰€æœ‰æ•°æ®ï¼Œå¹¶æŠŠæŸ¥è¯¢ç»“æœæ•°æ®å°è£…ä¸ºå¯¹è±¡å­˜å‚¨åœ¨é›†åˆä¸­ï¼Œè¿™é‡Œçš„æ•°æ®è¡¨ï¼ŒStudent å®ä½“ç±»å’Œä¸Šé¢ä¾‹å­ä¸­ç›¸åŒã€‚

```java
public class DruidDemo {

    public static void main(String[] args) throws Exception {
        //åŠ è½½é…ç½®æ–‡ä»¶
        Properties prop = new Properties();
        prop.load(new FileInputStream("jdbc-demo/src/druid.properties"));
        //è·å–æ•°æ®åº“è¿æ¥æ± å¯¹è±¡
        DataSource dataSource = DruidDataSourceFactory.createDataSource(prop);
        //è·å–æ•°æ®åº“è¿æ¥å¯¹è±¡
        Connection conn = dataSource.getConnection();
        //å®šä¹‰sql
        String sql = "select * from student";
        //è·å– sql æ‰§è¡Œå¯¹è±¡
        PreparedStatement pstmt = conn.prepareStatement(sql);
        //æ‰§è¡Œ sql
        ResultSet rs = pstmt.executeQuery();
        //å¤„ç†æ•°æ®ï¼Œå°†æŸ¥è¯¢ç»“æœæ•°æ®å°è£…ä¸ºå¯¹è±¡å­˜å‚¨åœ¨é›†åˆä¸­
        List<Student> students = new ArrayList<>();
  
        while (rs.next()) {
            Student s = new Student();
            int id = rs.getInt(1);
            String name = rs.getString(2);
            String gender = rs.getString(3);

            s.setId(id);
            s.setName(name);
            s.setGender(gender);

            students.add(s);
        }
        System.out.println(students);
        //é‡Šæ”¾èµ„æº
        rs.close();
        pstmt.close();
        conn.close();
    }
}

```

### 9.2 æ·»åŠ æ•°æ®

ç°åœ¨æ¼”ç¤ºå¾€æ•°æ®åº“ä¸­æ·»åŠ ä¸€æ¡è®°å½•ï¼Œåº”ç”¨åœºæ™¯ä¸ºç”¨æˆ·åœ¨å®¢æˆ·ç«¯è¾“å…¥ä¸€æ¡æ•°æ®æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°†æ•°æ®æ·»åŠ åˆ°æ•°æ®åº“ã€‚ç¤ºä¾‹ï¼š

```java
public class DruidDemo {

    public static void main(String[] args) throws Exception {
        //æ¥æ”¶åˆ°ç”¨æˆ·çš„æ•°æ®
        int id=4;
        String name="å°ç¾";
        String gender="å¥³";
        //åŠ è½½é…ç½®æ–‡ä»¶
        Properties prop = new Properties();
        prop.load(new FileInputStream("jdbc-demo/src/druid.properties"));
        //è·å–æ•°æ®åº“è¿æ¥æ± å¯¹è±¡
        DataSource dataSource = DruidDataSourceFactory.createDataSource(prop);
        //è·å–æ•°æ®åº“è¿æ¥å¯¹è±¡
        Connection conn = dataSource.getConnection();
        //å®šä¹‰sql
        String sql = "insert into student values(?,?,?)";
        //è·å– sql æ‰§è¡Œå¯¹è±¡
        PreparedStatement pstmt = conn.prepareStatement(sql);
        //è®¾ç½®å‚æ•°
        pstmt.setInt(1,id);
        pstmt.setString(2,name);
        pstmt.setString(3,gender);
        //æ‰§è¡Œ sql
        int count = pstmt.executeUpdate();//è¿”å›å—å½±å“çš„è¡Œæ•°
        //å¤„ç†æ•°æ®
        if(count>0){
            System.out.println("æ·»åŠ æˆåŠŸ");
        }else{
            System.out.println("æ·»åŠ å¤±è´¥");
        }
        //é‡Šæ”¾èµ„æº
        pstmt.close();
        conn.close();
    }
}

```

![image-20230124161437384](https://i-blog.csdnimg.cn/blog_migrate/12e7da0f132594698b200fcfa373aa03.png)

æ­¤æ—¶çš„æ•°æ®è¡¨ï¼š

![image-20230124162502370](https://i-blog.csdnimg.cn/blog_migrate/723065031e5985b5a6e874a736b6f5a0.png)

### 9.3 ä¿®æ”¹æ•°æ®

ç°åœ¨æ•°æ®è¡¨ä¸­çš„æ•°æ®ï¼Œåº”ç”¨åœºæ™¯ä¸ºç”¨æˆ·åœ¨å®¢æˆ·ç«¯ä¿®æ”¹æ•°æ®ï¼Œå¯¹åº”æ•°æ®åº“ä¸­çš„æ•°æ®ä¹Ÿè¦å®Œæˆä¿®æ”¹ã€‚ç¤ºä¾‹ï¼š

```java
public class DruidDemo {

    public static void main(String[] args) throws Exception {
        //æ¥æ”¶åˆ°ç”¨æˆ·çš„æ•°æ®
        int id=1;
        String name="å°ç‹";
        String gender="å¥³";
        //åŠ è½½é…ç½®æ–‡ä»¶
        Properties prop = new Properties();
        prop.load(new FileInputStream("jdbc-demo/src/druid.properties"));
        //è·å–æ•°æ®åº“è¿æ¥æ± å¯¹è±¡
        DataSource dataSource = DruidDataSourceFactory.createDataSource(prop);
        //è·å–æ•°æ®åº“è¿æ¥å¯¹è±¡
        Connection conn = dataSource.getConnection();
        //å®šä¹‰sql
        String sql = "update student set name=?,gender=? where id=?";
        //è·å– sql æ‰§è¡Œå¯¹è±¡
        PreparedStatement pstmt = conn.prepareStatement(sql);
        //è®¾ç½®å‚æ•°
        pstmt.setString(1,name);
        pstmt.setString(2,gender);
        pstmt.setInt(3,id);
        //æ‰§è¡Œ sql
        int count = pstmt.executeUpdate();//è¿”å›å—å½±å“çš„è¡Œæ•°
        //å¤„ç†æ•°æ®
        if(count>0){
            System.out.println("ä¿®æ”¹æˆåŠŸ");
        }else{
            System.out.println("ä¿®æ”¹å¤±è´¥");
        }
        //é‡Šæ”¾èµ„æº
        pstmt.close();
        conn.close();
    }
}

```

![image-20230124161542027](https://i-blog.csdnimg.cn/blog_migrate/95cba3332469c7026a30d711720882ff.png)

æ­¤æ—¶çš„æ•°æ®è¡¨ï¼š

![image-20230124162612729](https://i-blog.csdnimg.cn/blog_migrate/21bc73e16827dd4abb4a83d31c088307.png)

### 9.4 åˆ é™¤æ•°æ®

ä¸‹é¢æ¼”ç¤ºåˆ é™¤æ•°æ®ï¼Œç”¨æˆ·åœ¨å®¢æˆ·ç«¯é€‰æ‹©åˆ é™¤æŸæ¡æ•°æ®è®°å½•æ—¶ï¼Œæ•°æ®åº“ä¸­çš„æ•°æ®ä¹Ÿè¦å®Œæˆåˆ é™¤æ“ä½œã€‚ç¤ºä¾‹ï¼š

```java
public class DruidDemo {

    public static void main(String[] args) throws Exception {
        //æ¥æ”¶åˆ°ç”¨æˆ·çš„æ•°æ®
        int id=4;
        //åŠ è½½é…ç½®æ–‡ä»¶
        Properties prop = new Properties();
        prop.load(new FileInputStream("jdbc-demo/src/druid.properties"));
        //è·å–æ•°æ®åº“è¿æ¥æ± å¯¹è±¡
        DataSource dataSource = DruidDataSourceFactory.createDataSource(prop);
        //è·å–æ•°æ®åº“è¿æ¥å¯¹è±¡
        Connection conn = dataSource.getConnection();
        //å®šä¹‰sql
        String sql = "delete from student where id=?";
        //è·å– sql æ‰§è¡Œå¯¹è±¡
        PreparedStatement pstmt = conn.prepareStatement(sql);
        //è®¾ç½®å‚æ•°
        pstmt.setInt(1,id);

        //æ‰§è¡Œ sql
        int count = pstmt.executeUpdate();//è¿”å›å—å½±å“çš„è¡Œæ•°
        //å¤„ç†æ•°æ®
        if(count>0){
            System.out.println("åˆ é™¤æˆåŠŸ");
        }else{
            System.out.println("åˆ é™¤å¤±è´¥");
        }
        //é‡Šæ”¾èµ„æº
        pstmt.close();
        conn.close();
    }
}

```

![image-20230124161944039](https://i-blog.csdnimg.cn/blog_migrate/65baa5695d63c83395978b0b8d930cff.png)

æ­¤æ—¶çš„æ•°æ®è¡¨ï¼š

![image-20230124162647734](https://i-blog.csdnimg.cn/blog_migrate/a942e517491c4a22e6497609eca90570.png)

## 10. æ€»ç»“

å­¦ä¹ å®Œè¿™ç¯‡æ–‡ç« ï¼Œä½ å°†å­¦ä¼šä½¿ç”¨ Java ä»£ç æ“ä½œæ•°æ®åº“ï¼ŒåŒ…æ‹¬æ•°æ®åº“çš„è¿æ¥ï¼Œåˆ›å»ºï¼Œæ•°æ®çš„å¢åˆ æ”¹æŸ¥ç­‰æ“ä½œã€‚

JDBC ä½œä¸ºåŸºç¡€æ€§çš„ä»£ç ï¼Œåœ¨å¼€å‘ä¸­å…¶å®å­˜åœ¨ç€å¾ˆå¤šçš„ç¼ºç‚¹ï¼Œæ‰€ä»¥åœ¨å¼€å‘ä¸­å¹¶ä¸ä¼šç›´æ¥ä½¿ç”¨ï¼Œè€Œä¸€èˆ¬ä¼šä½¿ç”¨æ¡†æ¶å¼€å‘ï¼Œä½¿ç”¨æ¡†æ¶å¼€å‘ä¸ä»…èƒ½å¤Ÿæé«˜å¼€å‘çš„æ•ˆç‡ï¼Œè€Œä¸”å¤§å¤§æé«˜äº†ä»£ç çš„è§„èŒƒæ€§ã€‚MyBatis å°±æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æŒä¹…å±‚æ¡†æ¶ï¼Œä¸“é—¨ç”¨æ¥ç®€åŒ– JDBC å¼€å‘ï¼Œåé¢æˆ‘ä»¬é©¬ä¸Šä¼šæ¥è§¦åˆ°ï¼Œä½†æ˜¯åœ¨è¿™ä¹‹å‰ï¼Œä¸€å®šè¦å…ˆç†Ÿç»ƒ JDBC çš„ä½¿ç”¨ã€‚

---

## ğŸ“‚æ©™å­ç²¾å“æ–‡ç« å­¦ä¹ æ¨è

â“å¾ˆå¤šæœ‹å‹é—®æˆ‘ï¼šæ€æ ·ç³»ç»Ÿçš„å­¦ä¹ ä¸€é—¨ç¼–ç¨‹è¯­è¨€ï¼Ÿæ€æ ·å­¦å¥½ Javaï¼Ÿå¼ºçƒˆæ¨èå¤§å®¶å­¦ä¹ ï¼š
[Javaç¼–ç¨‹åŸºç¡€æ•™ç¨‹ç³»åˆ—ä¸“æ ï¼ˆé›¶åŸºç¡€å°ç™½æ¬ç –é€†è¢­ï¼‰](https://blog.csdn.net/zhangxia_/category_11746896.html?spm=1001.2014.3001.5482)
ï¼Œåšä¸»æ­£å¤„äºå­¦ä¹ æˆé•¿é˜¶æ®µï¼Œæ›´æ˜ç™½åˆå­¦è€…çš„çŠ¶æ€å’Œéœ€æ±‚ï¼Œæ–‡ç« ç»“åˆè‡ªèº«ç»éªŒå’Œç»å†ï¼Œé£è¶£å¹½é»˜ã€‚
æœ¬ä¸“æ ä¸»è¦æ›´æ–° Java åŸºç¡€ï¼ŒMySQL æ•°æ®åº“ï¼ŒJavaWebï¼ŒSSM æ¡†æ¶ï¼ŒSpringBoot æ¡†æ¶ç­‰
ï¼Œé›¶åŸºç¡€å°ç™½æ¬ç –é€†è¢­ï¼Œè¯·ç›¸ä¿¡è‡ªå·±ã€‚å¦‚å›¾ï¼Œä¸“æ æ–‡ç« æŒç»­æ›´æ–°ï¼Œå¿«æ¥å’Œå°ä¼™ä¼´ä»¬ä¸€èµ·å­¦ä¹ ï¼ï¼

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/5da400621ad91c458e2ffe63e5122998.png)

[Javaç¼–ç¨‹åŸºç¡€æ•™ç¨‹ç³»åˆ—](https://blog.csdn.net/zhangxia_/category_11746896.html?spm=1001.2014.3001.5482)
ğŸ‘ˆ
å¿«é€Ÿè®¢é˜…