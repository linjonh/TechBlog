---
layout: post
title: "OpenXmlNPOIEPPlusSpire.Officeç»„ä»¶å¯¹EXCEL-oleå¯¹è±¡é™„ä»¶çš„æ”¯æŒ"
date: 2025-08-24T05:53:19+0800
description: "ä¸»æµExcelæ“ä½œåº“å¯¹æ’å…¥é™„ä»¶ï¼ˆå¦‚ZIPæ–‡ä»¶ï¼‰çš„æ”¯æŒæƒ…å†µï¼š OpenXmlï¼šå®Œå…¨æ”¯æŒï¼Œéœ€ç›´æ¥æ“ä½œOLEå¯¹è±¡ï¼Œçµæ´»ä½†ä»£ç å¤æ‚ NPOIï¼šæ”¯æŒï¼Œéœ€é€šè¿‡OLEå¯¹è±¡è®¿é—®ï¼Œéœ€é¢å¤–å¤„ç† EPPlusï¼šå•†ä¸šç‰ˆæ”¯æŒè¾ƒå¥½ï¼Œå…è´¹ç‰ˆåŠŸèƒ½æœ‰é™ Spire.Officeï¼šå†…ç½®æ–¹æ³•æ”¯æŒï¼ŒåŠŸèƒ½å®Œæ•´ä½†éœ€ä»˜è´¹ æ¨èï¼š å…è´¹é¡¹ç›®é€‰NPOI ä¼ä¸šçº§åº”ç”¨é€‰Spire.Office åº•å±‚æ§åˆ¶é€‰OpenXml å·²æœ‰EPPluså¯å‡çº§å•†ä¸šç‰ˆ æ³¨æ„é™„ä»¶å­˜å‚¨è·¯å¾„å’Œå†…å­˜ç®¡ç†ï¼ŒæŒ‰éœ€æ±‚é€‰æ‹©åˆé€‚åº“ã€‚"
keywords: "OpenXmlã€NPOIã€EPPlusã€Spire.Officeç»„ä»¶å¯¹EXCEL oleå¯¹è±¡é™„ä»¶çš„æ”¯æŒ"
categories: ['æœªåˆ†ç±»']
tags: ['å‰ç«¯', 'Spire', 'Spire', 'Openxml', 'Npoi', 'Excel', '.Net']
artid: "150685814"
arturl: "https://blog.csdn.net/xiaoyao961/article/details/150685814"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=150685814
    alt: "OpenXmlNPOIEPPlusSpire.Officeç»„ä»¶å¯¹EXCEL-oleå¯¹è±¡é™„ä»¶çš„æ”¯æŒ"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=150685814
featuredImagePreview: https://bing.ee123.net/img/rand?artid=150685814
cover: https://bing.ee123.net/img/rand?artid=150685814
image: https://bing.ee123.net/img/rand?artid=150685814
img: https://bing.ee123.net/img/rand?artid=150685814
---



# OpenXmlã€NPOIã€EPPlusã€Spire.Officeç»„ä»¶å¯¹EXCEL oleå¯¹è±¡é™„ä»¶çš„æ”¯æŒ

OpenXmlã€NPOIã€EPPlusã€Spire.Office å¯¹EXCELæ’å…¥é™„ä»¶çš„è¯»å–æ”¯æŒæƒ…å†µï¼ˆæ¯”å¦‚æ’å…¥ZIPæ–‡ä»¶ï¼‰

è¿™äº›ä¸»æµExcelæ“ä½œåº“å¯¹æ’å…¥é™„ä»¶ï¼ˆå¦‚ZIPæ–‡ä»¶ï¼‰çš„æ”¯æŒæƒ…å†µå¦‚ä¸‹ï¼š

### ğŸ“Š æ”¯æŒæƒ…å†µå¯¹æ¯”

| åº“åç§° | ç‰ˆæœ¬ | é™„ä»¶è¯»å–æ”¯æŒ | å®ç°æ–¹å¼ | å¤‡æ³¨ |
| --- | --- | --- | --- | --- |
| **OpenXml** | 2.20+ | âœ… å®Œå…¨æ”¯æŒ | ç›´æ¥æ“ä½œOLEå¯¹è±¡ | æœ€åº•å±‚ï¼Œæœ€çµæ´» |
| **NPOI** | 2.7+ | âœ… æ”¯æŒ | é€šè¿‡OLEå¯¹è±¡è®¿é—® | éœ€è¦é¢å¤–å¤„ç† |
| **EPPlus** | 5.8+ | âš ï¸ æœ‰é™æ”¯æŒ | é€šè¿‡OLEå¯¹è±¡ | å•†ä¸šç‰ˆæ”¯æŒæ›´å¥½ |
| **Spire.Office** | 13.8+ | âœ… æ”¯æŒ | å†…ç½®æ–¹æ³• | å•†ä¸šåº“ï¼ŒåŠŸèƒ½å®Œæ•´ |

### ğŸ”§ å„åº“å…·ä½“å®ç°

#### 1.Â **OpenXml SDK**Â - æœ€åº•å±‚æ”¯æŒ

```


using DocumentFormat.OpenXml.Packaging;
using DocumentFormat.OpenXml.Spreadsheet;

public void ExtractAttachments(string filePath, string outputDir)
{
    using (var spreadsheet = SpreadsheetDocument.Open(filePath, false))
    {
        var workbookPart = spreadsheet.WorkbookPart;
        
        // è·å–æ‰€æœ‰OLEå¯¹è±¡
        foreach (var oleObject in workbookPart.OleObjectsPart?.OleObjects.Elements<OleObject>())
        {
            var objectId = oleObject.Id.Value;
            var embeddedObjectPart = (EmbeddedObjectPart)workbookPart.GetPartById(objectId);
            
            // ä¿å­˜é™„ä»¶
            using (var stream = embeddedObjectPart.GetStream())
            {
                var fileName = $"attachment_{objectId}.bin";
                File.WriteAllBytes(Path.Combine(outputDir, fileName), ReadStream(stream));
            }
        }
    }
}

private byte[] ReadStream(Stream stream)
{
    using (var memoryStream = new MemoryStream())
    {
        stream.CopyTo(memoryStream);
        return memoryStream.ToArray();
    }
}
```

#### 2.Â **NPOI**Â - éœ€è¦é¢å¤–å¤„ç†

```


using NPOI.XSSF.UserModel;
using NPOI.SS.UserModel;

public void ExtractAttachmentsNPOI(string filePath, string outputDir)
{
    using (var fs = new FileStream(filePath, FileMode.Open, FileAccess.Read))
    {
        var workbook = new XSSFWorkbook(fs);
        var xssfWorkbook = (XSSFWorkbook)workbook;
        
        // è·å–æ‰€æœ‰åµŒå…¥å¯¹è±¡
        var package = xssfWorkbook.GetPackage();
        foreach (var partName in package.GetPartsByName("/xl/embeddings/.*"))
        {
            var part = package.GetPart(partName);
            using (var stream = part.GetInputStream())
            {
                var fileName = Path.GetFileName(partName.Name);
                File.WriteAllBytes(Path.Combine(outputDir, fileName), ReadStream(stream));
            }
        }
    }
}
```

#### 3.Â **EPPlus**Â - å•†ä¸šç‰ˆæ”¯æŒæ›´å¥½

```

using OfficeOpenXml;

public void ExtractAttachmentsEPPlus(string filePath, string outputDir)
{
    ExcelPackage.LicenseContext = LicenseContext.NonCommercial;
    
    using (var package = new ExcelPackage(new FileInfo(filePath)))
    {
        // EPPlus 5.8+ å•†ä¸šç‰ˆæ”¯æŒ
        var workbook = package.Workbook;
        
        // é€šè¿‡è‡ªå®šä¹‰æ–¹å¼è®¿é—®OLEå¯¹è±¡
        foreach (var worksheet in workbook.Worksheets)
        {
            var drawings = worksheet.Drawings;
            foreach (var drawing in drawings)
            {
                if (drawing is ExcelOleObjectDrawing oleObject)
                {
                    // å•†ä¸šç‰ˆåŠŸèƒ½
                    var content = oleObject.Content;
                    if (content != null)
                    {
                        File.WriteAllBytes(Path.Combine(outputDir, $"ole_{oleObject.Name}.bin"), content);
                    }
                }
            }
        }
    }
}
```

#### 4.Â **Spire.Office**Â - æœ€ä¾¿æ·

```

using Spire.Xls;

public void ExtractAttachmentsSpire(string filePath, string outputDir)
{
    Workbook workbook = new Workbook();
    workbook.LoadFromFile(filePath);
    
    // ç›´æ¥è·å–æ‰€æœ‰OLEå¯¹è±¡
    foreach (Worksheet sheet in workbook.Worksheets)
    {
        foreach (Spire.Xls.OleObject oleObject in sheet.OleObjects)
        {
            // è·å–é™„ä»¶æ•°æ®
            byte[] data = oleObject.Data;
            string extension = GetFileExtension(oleObject.ObjectType);
            
            File.WriteAllBytes(Path.Combine(outputDir, 
                $"attachment_{sheet.Name}_{oleObject.Location.Row}_{oleObject.Location.Column}{extension}"), 
                data);
        }
    }
}

private string GetFileExtension(OleObjectType objectType)
{
    switch (objectType)
    {
        case OleObjectType.Package: return ".zip";
        case OleObjectType.AcrobatDocument: return ".pdf";
        case OleObjectType.WordDocument: return ".doc";
        default: return ".bin";
    }
}
```

### ğŸ“‹ åŠŸèƒ½å¯¹æ¯”è¯¦æƒ…

#### **OpenXml SDK**

* **ä¼˜ç‚¹**: æœ€åº•å±‚æ§åˆ¶ï¼Œæ”¯æŒæ‰€æœ‰é™„ä»¶ç±»å‹
* **ç¼ºç‚¹**: ä»£ç å¤æ‚ï¼Œéœ€è¦æ·±å…¥äº†è§£OOXMLç»“æ„
* **é€‚ç”¨**: éœ€è¦å®Œå…¨æ§åˆ¶çš„é«˜çº§åœºæ™¯

#### **NPOI**

* **ä¼˜ç‚¹**: å¼€æºå…è´¹ï¼Œæ”¯æŒåŸºæœ¬é™„ä»¶æ“ä½œ
* **ç¼ºç‚¹**: APIä¸å¤Ÿç›´è§‚ï¼Œéœ€è¦æ‰‹åŠ¨å¤„ç†Package
* **é€‚ç”¨**: Java/.NETè·¨å¹³å°é¡¹ç›®

#### **EPPlus**

* **ä¼˜ç‚¹**: APIå‹å¥½ï¼Œæ€§èƒ½ä¼˜ç§€
* **ç¼ºç‚¹**: å…è´¹ç‰ˆé™„ä»¶åŠŸèƒ½æœ‰é™ï¼Œå•†ä¸šç‰ˆè¾ƒè´µ
* **é€‚ç”¨**: ç®€å•Excelæ“ä½œï¼Œå•†ä¸šé¡¹ç›®

#### **Spire.Office**

* **ä¼˜ç‚¹**: åŠŸèƒ½å®Œæ•´ï¼ŒAPIç®€å•æ˜“ç”¨
* **ç¼ºç‚¹**: å•†ä¸šæ”¶è´¹ï¼Œå…è´¹ç‰ˆæœ‰é™åˆ¶
* **é€‚ç”¨**: ä¼ä¸šçº§åº”ç”¨ï¼Œéœ€è¦å¿«é€Ÿå¼€å‘

### ğŸ¯ æ¨èé€‰æ‹©

1. **å®Œå…¨å…è´¹**Â â†’ NPOI
2. **ä¼ä¸šé¡¹ç›®**Â â†’ Spire.Office
3. **åº•å±‚æ§åˆ¶**Â â†’ OpenXml SDK
4. **å·²æœ‰EPPlus**Â â†’ å‡çº§åˆ°å•†ä¸šç‰ˆ

### âš ï¸ æ³¨æ„äº‹é¡¹

* é™„ä»¶å¯èƒ½å­˜å‚¨åœ¨`/xl/embeddings/`æˆ–`/xl/oleObjects/`è·¯å¾„
* ZIPæ–‡ä»¶é€šå¸¸ä½œä¸ºOLE Packageå¯¹è±¡æ’å…¥
* éœ€è¦å¤„ç†ä¸åŒçš„å†…å®¹ç±»å‹(MIME types)
* æ³¨æ„å†…å­˜ä½¿ç”¨ï¼Œå¤§é™„ä»¶éœ€è¦æµå¼å¤„ç†

æ ¹æ®ä½ çš„å…·ä½“éœ€æ±‚å’ŒæŠ€æœ¯æ ˆé€‰æ‹©åˆé€‚çš„åº“ã€‚



