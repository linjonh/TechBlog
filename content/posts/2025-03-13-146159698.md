---
layout: post
title: "日常开发记录-radioGroup组件"
date: 2025-03-13 22:08:29 +0800
description: "日常开发记录-radioGroup组件"
keywords: "日常开发记录-radioGroup组件"
categories: ['未分类']
tags: ['学习', '前端', 'Vue', 'Javascript']
artid: "146159698"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146159698
    alt: "日常开发记录-radioGroup组件"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146159698
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146159698
cover: https://bing.ee123.net/img/rand?artid=146159698
image: https://bing.ee123.net/img/rand?artid=146159698
img: https://bing.ee123.net/img/rand?artid=146159698
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     日常开发记录-radioGroup组件
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <h2>
     <a id="1_1">
     </a>
     1.前提
    </h2>
    <p>
     在上一章的，我们实现了radio组件。
     <a href="https://blog.csdn.net/qq_45030898/article/details/146027633?spm=1001.2014.3001.5502">
      从这进入了解
     </a>
     <br/>
     新增个radioGroup组件呢。
    </p>
    <pre><code class="prism language-javascript"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div
    <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"q-radio-group"</span>
    role<span class="token operator">=</span><span class="token string">"radiogroup"</span>
  <span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>slot<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>slot<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'MyRadioGroup'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">componentName</span><span class="token operator">:</span> <span class="token string">'MyRadioGroup'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">disabled</span><span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> String
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">watch</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">value</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 当值变化时，通知子组件</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
          <span class="token comment">// this.$children.forEach(child =&gt; {<!-- --></span>
          <span class="token comment">//   if (child.$options.name === 'MyRadio') {<!-- --></span>
          <span class="token comment">//     child.$refs.radio.checked = child.label === value;</span>
          <span class="token comment">//   }</span>
          <span class="token comment">// });</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>q<span class="token operator">-</span>radio<span class="token operator">-</span>group <span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">display</span><span class="token operator">:</span> inline<span class="token operator">-</span>block<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>


</code></pre>
    <p>
     原来的radio组件改写成
    </p>
    <pre><code class="prism language-javascript"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>label
    <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"q-radio"</span>
    <span class="token operator">:</span><span class="token keyword">class</span><span class="token operator">=</span>"<span class="token punctuation">{<!-- --></span>
      <span class="token string-property property">'is-disabled'</span><span class="token operator">:</span> isDisabled<span class="token punctuation">,</span>
      <span class="token string-property property">'is-checked'</span><span class="token operator">:</span> model <span class="token operator">===</span> label
    <span class="token punctuation">}</span>"
  <span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"q-radio__input"</span>
      <span class="token operator">:</span><span class="token keyword">class</span><span class="token operator">=</span>"<span class="token punctuation">{<!-- --></span>
        <span class="token string-property property">'is-disabled'</span><span class="token operator">:</span> isDisabled<span class="token punctuation">,</span>
        <span class="token string-property property">'is-checked'</span><span class="token operator">:</span> model <span class="token operator">===</span> label
      <span class="token punctuation">}</span>"
    <span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"q-radio__inner"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>input
        ref<span class="token operator">=</span><span class="token string">"radio"</span>
        type<span class="token operator">=</span><span class="token string">"radio"</span>
        <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"q-radio__original"</span>
        <span class="token operator">:</span>value<span class="token operator">=</span><span class="token string">"label"</span>
        <span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">"name"</span>
        <span class="token operator">:</span>disabled<span class="token operator">=</span><span class="token string">"isDisabled"</span>
        v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">"model"</span>
        @change<span class="token operator">=</span><span class="token string">"handleChange"</span>
      <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"q-radio__label"</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>slot<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>slot<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"!$slots.default"</span><span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>label<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'MyRadio'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> String<span class="token punctuation">,</span>
      <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">disabled</span><span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 预先定义 _radioGroup，提高代码可读性</span>
        <span class="token literal-property property">_radioGroup</span><span class="token operator">:</span> <span class="token keyword">null</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">isGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">let</span> parent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$parent<span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>parent<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>name <span class="token operator">!==</span> <span class="token string">'MyRadioGroup'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            parent <span class="token operator">=</span> parent<span class="token punctuation">.</span>$parent<span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>_radioGroup <span class="token operator">=</span> parent<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">model</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>isGroup <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_radioGroup<span class="token punctuation">.</span>value <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">set</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>isGroup<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 使用 $emit 向上传递事件</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>_radioGroup<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">isDisabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 考虑组的禁用状态</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>isGroup 
          <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_radioGroup<span class="token punctuation">.</span>disabled <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span>disabled 
          <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>disabled<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">handleChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 使用 $nextTick 确保状态已更新</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
          <span class="token comment">// 触发 change 事件</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>model<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token comment">// 如果在组中，也通知组</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>isGroup<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>_radioGroup<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>model<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre>
    <p>
     引用：
    </p>
    <pre><code class="prism language-javascript"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"app"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>el<span class="token operator">-</span>container<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>el<span class="token operator">-</span>header<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>Vue <span class="token number">2</span> <span class="token operator">+</span> Element <span class="token constant">UI</span> Template<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>header<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>el<span class="token operator">-</span>main<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>row<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>el<span class="token operator">-</span>col <span class="token operator">:</span>span<span class="token operator">=</span><span class="token string">"12"</span> <span class="token operator">:</span>offset<span class="token operator">=</span><span class="token string">"6"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>card<span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span>div slot<span class="token operator">=</span><span class="token string">"header"</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>欢迎使用<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">"primary"</span><span class="token operator">&gt;</span>点击我<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>card<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>row<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>main<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"radio"</span> id<span class="token operator">=</span><span class="token string">"contactChoice1"</span> name<span class="token operator">=</span><span class="token string">"contact"</span> value<span class="token operator">=</span><span class="token string">"email"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>label <span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"contactChoice1"</span><span class="token operator">&gt;</span>电子邮件<span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"radio"</span> id<span class="token operator">=</span><span class="token string">"contactChoice2"</span> name<span class="token operator">=</span><span class="token string">"contact"</span> value<span class="token operator">=</span><span class="token string">"phone"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>label <span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"contactChoice2"</span><span class="token operator">&gt;</span>电话<span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"radio"</span> id<span class="token operator">=</span><span class="token string">"contactChoice3"</span> name<span class="token operator">=</span><span class="token string">"contact2"</span> value<span class="token operator">=</span><span class="token string">"mail"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>label <span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"contactChoice3"</span><span class="token operator">&gt;</span>邮件<span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">&gt;</span>

      <span class="token operator">&lt;</span>MyRadio v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">"currentValue.aaa"</span> name<span class="token operator">=</span><span class="token string">"aaa"</span> @input<span class="token operator">=</span><span class="token string">"handleInput"</span> @change<span class="token operator">=</span><span class="token string">"handleChange"</span> label<span class="token operator">=</span><span class="token string">"男"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>MyRadio<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>MyRadio v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">"currentValue.aaa"</span> name<span class="token operator">=</span><span class="token string">"aaa"</span> @input<span class="token operator">=</span><span class="token string">"handleInput"</span> @change<span class="token operator">=</span><span class="token string">"handleChange"</span> label<span class="token operator">=</span><span class="token string">"女"</span><span class="token operator">&gt;</span>女<span class="token operator">&lt;</span><span class="token operator">/</span>MyRadio<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>MyRadio v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">"currentValue2"</span> name<span class="token operator">=</span><span class="token string">"bbb"</span> @input<span class="token operator">=</span><span class="token string">"handleInput"</span> @change<span class="token operator">=</span><span class="token string">"handleChange"</span> label<span class="token operator">=</span><span class="token string">"未知"</span><span class="token operator">&gt;</span>未知<span class="token operator">&lt;</span><span class="token operator">/</span>MyRadio<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>MyRadioGroup v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">"currentValue.bbb"</span> name<span class="token operator">=</span><span class="token string">"bbb"</span> @change<span class="token operator">=</span><span class="token string">"handleGroupChange"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>MyRadio label<span class="token operator">=</span><span class="token string">"男"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>MyRadio<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>MyRadio label<span class="token operator">=</span><span class="token string">"女"</span><span class="token operator">&gt;</span>女<span class="token operator">&lt;</span><span class="token operator">/</span>MyRadio<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>MyRadioGroup<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>el<span class="token operator">-</span>button @click<span class="token operator">=</span><span class="token string">"changeGroupVal"</span><span class="token operator">&gt;</span>改变group的绑定值<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>el<span class="token operator">-</span>radio v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">"radio"</span> label<span class="token operator">=</span><span class="token string">"1"</span> @input<span class="token operator">=</span><span class="token string">"change"</span><span class="token operator">&gt;</span>备选项<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>radio<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>el<span class="token operator">-</span>radio v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">"radio"</span> label<span class="token operator">=</span><span class="token string">"2"</span><span class="token operator">&gt;</span>备选项<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>radio<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>container<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> MyRadio <span class="token keyword">from</span> <span class="token string">'./components/myRadio.vue'</span>
<span class="token keyword">import</span> MyRadioGroup <span class="token keyword">from</span> <span class="token string">'./components/myRadioGroup.vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'App'</span>
  <span class="token punctuation">,</span> <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">currentValue</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">aaa</span><span class="token operator">:</span> <span class="token string">'男'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">bbb</span><span class="token operator">:</span> <span class="token string">''</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">currentValue2</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
      <span class="token literal-property property">radio</span><span class="token operator">:</span> <span class="token string">'1'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    MyRadio<span class="token punctuation">,</span>
    MyRadioGroup
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">handleInput</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'input event'</span><span class="token punctuation">,</span> event<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">changeGroupVal</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>currentValue<span class="token punctuation">.</span>bbb <span class="token operator">=</span> <span class="token string">'女'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">handleChange</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'change event'</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">change</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">handleGroupChange</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'group'</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

</code></pre>
    <p>
     主要在于radio的isGroup和原绑定值的改变，radiogroup就是个插槽。
    </p>
    <h2>
     <a id="2_235">
     </a>
     2.问题：无限循环调用
    </h2>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/a0c46ffd756d40e783b83b8b7b6db558.gif#pic_center">
      <br/>
      会出现无限调用radiogroup组件emit出来的change事件。为什么呢？感觉没问题的应该。
      <br/>
      原有的逻辑，事件传递链分析：
      <br/>
      当您点击 RadioGroup 中的一个选项时，事件流程如下：
      <br/>
      MyRadio 的 model setter 被触发，它调用 this._radioGroup.
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         e 
        
       
         m 
        
       
         i 
        
       
         t 
        
        
        
          ( 
         
        
          ′ 
         
        
       
         i 
        
       
         n 
        
       
         p 
        
       
         u 
        
        
        
          t 
         
        
          ′ 
         
        
       
         , 
        
       
         v 
        
       
         a 
        
       
         l 
        
       
         ) 
        
       
         同时， 
        
       
         M 
        
       
         y 
        
       
         R 
        
       
         a 
        
       
         d 
        
       
         i 
        
       
         o 
        
       
         的 
        
       
         h 
        
       
         a 
        
       
         n 
        
       
         d 
        
       
         l 
        
       
         e 
        
       
         C 
        
       
         h 
        
       
         a 
        
       
         n 
        
       
         g 
        
       
         e 
        
       
         方法被触发，它调用 
        
       
         t 
        
       
         h 
        
       
         i 
        
       
         s 
        
       
         . 
        
       
      
        emit('input', val) 同时，MyRadio 的 handleChange 方法被触发，它调用 this.
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1.0019em; vertical-align: -0.25em;">
          </span>
          <span class="mord mathnormal">
           e
          </span>
          <span class="mord mathnormal">
           mi
          </span>
          <span class="mord mathnormal">
           t
          </span>
          <span class="mopen">
           <span class="mopen">
            (
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.7519em;">
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   ′
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mord mathnormal">
           in
          </span>
          <span class="mord mathnormal">
           p
          </span>
          <span class="mord mathnormal">
           u
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            t
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.7519em;">
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   ′
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           v
          </span>
          <span class="mord mathnormal">
           a
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0197em;">
           l
          </span>
          <span class="mclose">
           )
          </span>
          <span class="mord cjk_fallback">
           同时，
          </span>
          <span class="mord mathnormal" style="margin-right: 0.109em;">
           M
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           y
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0077em;">
           R
          </span>
          <span class="mord mathnormal">
           a
          </span>
          <span class="mord mathnormal">
           d
          </span>
          <span class="mord mathnormal">
           i
          </span>
          <span class="mord mathnormal">
           o
          </span>
          <span class="mord cjk_fallback">
           的
          </span>
          <span class="mord mathnormal">
           han
          </span>
          <span class="mord mathnormal">
           d
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0197em;">
           l
          </span>
          <span class="mord mathnormal">
           e
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0715em;">
           C
          </span>
          <span class="mord mathnormal">
           han
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           g
          </span>
          <span class="mord mathnormal">
           e
          </span>
          <span class="mord cjk_fallback">
           方法被触发，它调用
          </span>
          <span class="mord mathnormal">
           t
          </span>
          <span class="mord mathnormal">
           hi
          </span>
          <span class="mord mathnormal">
           s
          </span>
          <span class="mord">
           .
          </span>
         </span>
        </span>
       </span>
      </span>
      emit(‘change’, this.model) 和 this._radioGroup.
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         e 
        
       
         m 
        
       
         i 
        
       
         t 
        
        
        
          ( 
         
        
          ′ 
         
        
       
         c 
        
       
         h 
        
       
         a 
        
       
         n 
        
       
         g 
        
        
        
          e 
         
        
          ′ 
         
        
       
         , 
        
       
         t 
        
       
         h 
        
       
         i 
        
       
         s 
        
       
         . 
        
       
         m 
        
       
         o 
        
       
         d 
        
       
         e 
        
       
         l 
        
       
         ) 
        
       
         M 
        
       
         y 
        
       
         R 
        
       
         a 
        
       
         d 
        
       
         i 
        
       
         o 
        
       
         G 
        
       
         r 
        
       
         o 
        
       
         u 
        
       
         p 
        
       
         监听 
        
        
        
          到 
         
        
          ′ 
         
        
       
         c 
        
       
         h 
        
       
         a 
        
       
         n 
        
       
         g 
        
        
        
          e 
         
        
          ′ 
         
        
       
         事件，它又调用 
        
       
         t 
        
       
         h 
        
       
         i 
        
       
         s 
        
       
         . 
        
       
      
        emit('change', this.model) MyRadioGroup 监听到 'change' 事件，它又调用 this.
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1.0019em; vertical-align: -0.25em;">
          </span>
          <span class="mord mathnormal">
           e
          </span>
          <span class="mord mathnormal">
           mi
          </span>
          <span class="mord mathnormal">
           t
          </span>
          <span class="mopen">
           <span class="mopen">
            (
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.7519em;">
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   ′
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mord mathnormal">
           c
          </span>
          <span class="mord mathnormal">
           han
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           g
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            e
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.7519em;">
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   ′
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mord mathnormal">
           t
          </span>
          <span class="mord mathnormal">
           hi
          </span>
          <span class="mord mathnormal">
           s
          </span>
          <span class="mord">
           .
          </span>
          <span class="mord mathnormal">
           m
          </span>
          <span class="mord mathnormal">
           o
          </span>
          <span class="mord mathnormal">
           d
          </span>
          <span class="mord mathnormal">
           e
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0197em;">
           l
          </span>
          <span class="mclose">
           )
          </span>
          <span class="mord mathnormal" style="margin-right: 0.109em;">
           M
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           y
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0077em;">
           R
          </span>
          <span class="mord mathnormal">
           a
          </span>
          <span class="mord mathnormal">
           d
          </span>
          <span class="mord mathnormal">
           i
          </span>
          <span class="mord mathnormal">
           o
          </span>
          <span class="mord mathnormal">
           G
          </span>
          <span class="mord mathnormal">
           ro
          </span>
          <span class="mord mathnormal">
           u
          </span>
          <span class="mord mathnormal">
           p
          </span>
          <span class="mord cjk_fallback">
           监听
          </span>
          <span class="mord">
           <span class="mord cjk_fallback">
            到
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.7519em;">
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   ′
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mord mathnormal">
           c
          </span>
          <span class="mord mathnormal">
           han
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           g
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            e
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.7519em;">
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   ′
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mord cjk_fallback">
           事件，它又调用
          </span>
          <span class="mord mathnormal">
           t
          </span>
          <span class="mord mathnormal">
           hi
          </span>
          <span class="mord mathnormal">
           s
          </span>
          <span class="mord">
           .
          </span>
         </span>
        </span>
       </span>
      </span>
      emit(‘change’, value)。
      <br/>
      感觉这样就完了呀。怎么会一直重复的调用change事件呢。
      <br/>
      ？？？？？？
     </img>
    </p>
    <h2>
     <a id="3_246">
     </a>
     3.解释
    </h2>
    <h2>
     <a id="Vue__247">
     </a>
     Vue 事件传播机制分析与无限循环原因解释
    </h2>
    <p>
     分析为什么修改事件名可以解决无限循环问题，并解释 Vue 中 $emit 和 $on 的工作原理。
     <br/>
     问题根源: 组件自我监听
     <br/>
     查看自己的 MyRadioGroup 组件代码：
     <br/>
     这里发现了关键问题 - 组件正在监听自己发出的事件，并且在监听器中又发出同名事件，创建了一个经典的无限循环：
     <br/>
     步骤1.MyRadio 组件触发 change 事件，并将值发送给 MyRadioGroup
     <br/>
     步骤2.MyRadioGroup 接收 change 事件，通过
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        o 
        
       
         n 
        
       
         监听器处理它步骤 
        
       
         3. 
        
       
         处理器调用 
        
       
         t 
        
       
         h 
        
       
         i 
        
       
         s 
        
       
         . 
        
       
      
        on 监听器处理它 步骤3.处理器调用 this.
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal">
          o
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mord cjk_fallback">
          监听器处理它步骤
         </span>
         <span class="mord">
          3.
         </span>
         <span class="mord cjk_fallback">
          处理器调用
         </span>
         <span class="mord mathnormal">
          t
         </span>
         <span class="mord mathnormal">
          hi
         </span>
         <span class="mord mathnormal">
          s
         </span>
         <span class="mord">
          .
         </span>
        </span>
       </span>
      </span>
     </span>
     emit(‘change’, value)，再次向自己发送 change 事件
     <br/>
     步骤4.这又激活了同一个监听器，返回步骤 3，形成无限循环
     <br/>
     Vue 事件机制解析
     <br/>
     基本工作流程：
     <br/>
     $on 将事件处理器存储在组件实例的 _events 对象中
     <br/>
     $emit 查找并调用存储在 _events[eventName] 中的处理器
     <br/>
     关键点： 当组件对自己发出的事件设置监听器时，每次调用 $emit 都会触发这些监听器，包括那些由同一组件设置的监听器。
    </p>
    <h2>
     <a id="4_262">
     </a>
     4.解决
    </h2>
    <p>
     所以我们只要抛出的方法名变一下就行
    </p>
    <pre><code class="prism language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span>_radioGroup<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'handleChange'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>model<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//接受</span>
   <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'handleChange'</span><span class="token punctuation">,</span> <span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34353033303839382f:61727469636c652f64657461696c732f313436313539363938" class_="artid" style="display:none">
 </p>
</div>


