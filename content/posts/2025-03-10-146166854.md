---
layout: post
title: "MFC-项目简易销售系统实践"
date: 2025-03-10 23:40:25 +0800
description: "在类视图中项目名上右键类向导下拉MFC 类类名SelectView，基类CTreeView同样再添加一个类，基类CFormView创建完上面两个类，在类向导页面点确定，编译在下面可能看到一堆SelectView头文件和源文件的报错在头文件增加引用再编译就好了在类视图中双击CMainFrame类进行编辑，写入自定义消息添加自定义消息处理函数，头文件中添加声明protected:源文件中添加定义然后看到，在它和之间添加代码// 响应自定义消息编辑SelectView类中的方法，注意需要引用。"
keywords: "MFC 项目：简易销售系统实践"
categories: ['未分类']
tags: ['系统', '数据库', 'Sqlite', 'Mfc', 'C']
artid: "146166854"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146166854
    alt: "MFC-项目简易销售系统实践"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146166854
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146166854
cover: https://bing.ee123.net/img/rand?artid=146166854
image: https://bing.ee123.net/img/rand?artid=146166854
img: https://bing.ee123.net/img/rand?artid=146166854
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     MFC 项目：简易销售系统实践
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="_0">
     </a>
     预览
    </h2>
    <p>
     源链接：https://blog.iyatt.com/?p=19158
    </p>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/e7a1b715e6bb639d8f178eba93966ff2.png">
      <br/>
      <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/3530a956146a0e736c193d5e9ab55b23.png">
       <br/>
       <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/b657312f6a3d221a2f75e111814c5ce9.png">
        <br/>
        <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/f33255c826958ce833ad66531ccce8f0.png">
         <br/>
         <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/c219293b8c36f8fd9065446052d0def4.png">
          <br/>
          <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/e7887929af66754864edd6916672eb92.png">
           <br/>
           <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/4cd9ab37acc89dbe4e9550a503a145f2.png"/>
          </img>
         </img>
        </img>
       </img>
      </img>
     </img>
    </p>
    <h2>
     <a id="_11">
     </a>
     测试环境
    </h2>
    <ul>
     <li>
      https://blog.iyatt.com/?p=18843#%E7%8E%AF%E5%A2%83
     </li>
    </ul>
    <h2>
     <a id="_15">
     </a>
     项目
    </h2>
    <p>
     参考黑马程序员的案例教程进行实践的记录，部分内容自行修改过，比如原案例直接读写文件保存账号、密码、数据，这里改为使用 SQLite3 数据库。
     <br/>
     注意 VS 默认头文件扩展名用的 .h，我是喜欢在 C++ 中使用扩展名 .hpp，只要不是模板创建的代码部分，是我自己添加的都使用 .hpp 扩展名。
     <br/>
     源码：下载地址见文首源链接
    </p>
    <h3>
     <a id="_21">
     </a>
     新建项目
    </h3>
    <p>
     新建一个 MFC 应用，项目名
     <strong>
      saleSystem
     </strong>
     ，
     <strong>
      应用程序类型
     </strong>
     选
     <strong>
      单个文档
     </strong>
     ，
     <strong>
      项目样式
     </strong>
     选
     <strong>
      MFC standard
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/bc1e27c6cb02bbfb1e1b1718692ab93e.png"/>
    </p>
    <p>
     <strong>
      用户界面功能
     </strong>
     中
     <strong>
      经典菜单选项
     </strong>
     选
     <strong>
      无
     </strong>
     ，再点
     <strong>
      完成
     </strong>
     进行创建
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/d2a894759685544cf837ef50b09c730c.png"/>
    </p>
    <h3>
     <a id="_29">
     </a>
     不使用安全函数
    </h3>
    <p>
     在项目名称上右键属性
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/880e9a890d49597a591a343a3b9547b4.png"/>
    </p>
    <p>
     展开
     <strong>
      配置属性
     </strong>
     -&gt;
     <strong>
      C/C++
     </strong>
     -&gt;
     <strong>
      代码生成
     </strong>
     ，在
     <strong>
      安全检查中
     </strong>
     选
     <strong>
      禁用安全检查
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/f424842960eafc7ff72a8047e1a3788e.png"/>
    </p>
    <h3>
     <a id="_37">
     </a>
     添加窗口图标
    </h3>
    <p>
     将
     <strong>
      user.ico
     </strong>
     放到项目目录下的
     <strong>
      res
     </strong>
     目录里
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/bb0c5adde0aed75b2c7c7af96cfe37ed.png"/>
    </p>
    <p>
     切换到
     <strong>
      资源视图
     </strong>
     选项卡，展开上面的资源分支，在
     <strong>
      Icon
     </strong>
     上右键
     <strong>
      添加资源
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/a8326d17021c688039b02403615cd87f.png"/>
    </p>
    <p>
     点
     <strong>
      导入
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/391a4d3d895092d22af48ffec99bb6c5.png"/>
    </p>
    <p>
     选择图标文件
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/3a2715b33b1c862f4bbd06357bb1b039.png"/>
    </p>
    <p>
     将
     <strong>
      ID
     </strong>
     改为
     <strong>
      IDI_ICON_WIN
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/b613dc82239dfdfaca9d91dc6ef39f28.png"/>
    </p>
    <p>
     在
     <strong>
      类视图
     </strong>
     下，
     <strong>
      CMainFrame
     </strong>
     类中的
     <strong>
      OnCreate
     </strong>
     方法里添加代码
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/7032a2303815880afb2cfa897482aed8.png"/>
    </p>
    <pre><code class="prism language-cpp">	<span class="token comment">// 加载图标</span>
	HICON winIcon <span class="token operator">=</span> <span class="token function">AfxGetApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">LoadIconW</span><span class="token punctuation">(</span>IDI_ICON_WIN<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 设置小图标</span>
	<span class="token function">SetIcon</span><span class="token punctuation">(</span>winIcon<span class="token punctuation">,</span> FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     按
     <code>
      {F5}
     </code>
     调试运行，点
     <strong>
      是
     </strong>
     加载图标文件
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/550be9953dbbfe022d3e8ca6b4f222de.png"/>
    </p>
    <p>
     运行效果
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/6f479791141675efc35117f54641510e.png"/>
    </p>
    <h3>
     <a id="_69">
     </a>
     设置窗口大小和居中显示
    </h3>
    <p>
     在
     <strong>
      类视图
     </strong>
     下，
     <strong>
      CMainFrame
     </strong>
     类中的
     <strong>
      OnCreate
     </strong>
     方法里添加代码
    </p>
    <pre><code class="prism language-cpp">	<span class="token comment">// 设置位置(0,0)和窗口大小（800×600)</span>
	<span class="token function">MoveWindow</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 居中显示</span>
	<span class="token function">CenterWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/069479c795caf2478c0fb085860b669c.png"/>
    </p>
    <h3>
     <a id="_80">
     </a>
     设置窗口标题
    </h3>
    <p>
     在
     <strong>
      资源视图
     </strong>
     下，展开资源树，双击打开
     <strong>
      String Table
     </strong>
     ，在底部添加一个 ID 为
     <strong>
      ID_STRING_PROJECTNAME
     </strong>
     ，值为
     <strong>
      销售系统
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/574eaced5602ea6fbab0e993b6de6de8.png"/>
    </p>
    <p>
     在
     <strong>
      类视图
     </strong>
     下
     <strong>
      CsaleSystemDoc
     </strong>
     类中
     <strong>
      OnNewDocument
     </strong>
     方法下添加代码
    </p>
    <pre><code class="prism language-cpp">	CString projectName<span class="token punctuation">;</span>
	projectName<span class="token punctuation">.</span><span class="token function">LoadStringW</span><span class="token punctuation">(</span>ID_STRING_PROJECTNAME<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 导入字符串资源</span>
	<span class="token function">SetTitle</span><span class="token punctuation">(</span>projectName<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置窗口标题</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/e40383291ec0ff0f2ed9efef3c400057.png"/>
    </p>
    <p>
     运行效果
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/b78001154beee95a25e6a0fa83fbb5bb.png"/>
    </p>
    <h3>
     <a id="_SQLite3__96">
     </a>
     设计 SQLite3 数据库读写实现
    </h3>
    <p>
     这里实现账号、密码、商品信息的读写，数据库采用 SQLite3，配置 SQLite3 环境参考：https://blog.iyatt.com/?p=19187
    </p>
    <h4>
     <a id="_100">
     </a>
     手动创建一个数据库文件
    </h4>
    <p>
     在项目目录下打开终端，执行命令打开数据库文件
     <strong>
      saleSystem.sb
     </strong>
     （不存在会自动创建）,打开后会处于命令交互模式
    </p>
    <pre><code class="prism language-bash">sqlite3 saleSystem.sqlite3
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/a1af5729d62b5ff44d64bef4101021ee.png"/>
    </p>
    <p>
     新建一张表用于存储账号、密码，并写入初始账号、密码（账号：admin，密码：123456）
    </p>
    <pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> users
<span class="token punctuation">(</span>
    id <span class="token keyword">integer</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> autoincrement <span class="token punctuation">,</span>
    username <span class="token keyword">text</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">unique</span> <span class="token punctuation">,</span>
    password <span class="token keyword">text</span> <span class="token operator">not</span> <span class="token boolean">null</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> users <span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">,</span> <span class="token string">'123456'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/2e00df67a44e8541ca6ad4607c1edb8e.png"/>
    </p>
    <p>
     在创建一张表用于存储商品数据，并插入几条商品数据
    </p>
    <pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> products <span class="token punctuation">(</span>
    id <span class="token keyword">integer</span> <span class="token keyword">primary</span> <span class="token keyword">key</span> autoincrement <span class="token punctuation">,</span>
    name <span class="token keyword">text</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">unique</span> <span class="token punctuation">,</span>
    price <span class="token keyword">real</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token punctuation">,</span>
    stock <span class="token keyword">integer</span> <span class="token operator">not</span> <span class="token boolean">null</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> products <span class="token punctuation">(</span>name<span class="token punctuation">,</span> price<span class="token punctuation">,</span> stock<span class="token punctuation">)</span> <span class="token keyword">values</span>
    <span class="token punctuation">(</span><span class="token string">'桌子'</span><span class="token punctuation">,</span> <span class="token number">199.9</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token string">'椅子'</span><span class="token punctuation">,</span> <span class="token number">49.8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/879d619ffe91a944ff6b6c37654a44f7.png"/>
    </p>
    <p>
     退出交互模式
    </p>
    <pre><code class="prism language-bash">.exit
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/70e70455b534fd1abb6dd0bfd3d3a46b.png"/>
    </p>
    <h4>
     <a id="_142">
     </a>
     读写实现
    </h4>
    <p>
     在
     <strong>
      类视图
     </strong>
     下，项目上右键
     <strong>
      添加
     </strong>
     -&gt;
     <strong>
      类
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/8e08bfc1fe159e4b5b2595fc74ef87b5.png"/>
    </p>
    <p>
     创建一个类，类名
     <strong>
      StoreManager
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/b984e74783308390c2c9e29c4525a9ac.png"/>
    </p>
    <p>
     StoreManager.hpp
    </p>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once</span></span>
<span class="token keyword">extern</span> <span class="token string">"C"</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"sqlite3.h"</span></span>
<span class="token punctuation">}</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;vector&gt;</span></span>

<span class="token keyword">typedef</span> <span class="token keyword">struct</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> id<span class="token punctuation">;</span>
	CString name<span class="token punctuation">;</span>
	<span class="token keyword">double</span> price<span class="token punctuation">;</span>
	<span class="token keyword">int</span> stock<span class="token punctuation">;</span>
<span class="token punctuation">}</span>productStruct<span class="token punctuation">;</span>

<span class="token keyword">typedef</span> <span class="token keyword">struct</span>
<span class="token punctuation">{<!-- --></span>
    CString username<span class="token punctuation">;</span>
	CString password<span class="token punctuation">;</span>
<span class="token punctuation">}</span>loginInfoStruct<span class="token punctuation">;</span>

<span class="token keyword">typedef</span> std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>productStruct<span class="token operator">&gt;</span> productsVector<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">StoreManager</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">static</span> sqlite3<span class="token operator">*</span> db<span class="token punctuation">;</span>
	<span class="token keyword">static</span> productStruct product<span class="token punctuation">;</span>
	<span class="token keyword">static</span> loginInfoStruct loginInfo<span class="token punctuation">;</span>

<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">readLoginInfoCallback</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span> data<span class="token punctuation">,</span> <span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">*</span> argv<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">*</span> colName<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">/**
	 * @brief UTF-8 编码窄字符串转 GBK 编码 CString
	 * @param utf8Str 
	 * @return 
	 */</span>
	<span class="token keyword">static</span> CString <span class="token function">utf8ToGbk</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> utf8Str<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">/**
	 * @brief GBK 编码 CString 转 UTF-8 窄字符串
	 * @param gbkStr 
	 * @return 
	 */</span>
	<span class="token keyword">static</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">gbkToUtf8</span><span class="token punctuation">(</span><span class="token keyword">const</span> CString<span class="token operator">&amp;</span> gbkStr<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token comment">/**
	 * @brief 连接数据库
	 * @param databasePath 数据库文件路径
	 */</span>
	<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">connect</span><span class="token punctuation">(</span>CString<span class="token operator">&amp;</span> databasePath<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">/**
	 * @brief 读取登录信息
	 * @param username 用户名
	 * @param password 密码
	 */</span>
	<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">readLogin</span><span class="token punctuation">(</span>CString<span class="token operator">&amp;</span> username<span class="token punctuation">,</span> CString<span class="token operator">&amp;</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">/**
	 * @brief 修改密码
	 * @param username 要修改密码的用户 
	 * @param password 新密码
	 */</span>
	<span class="token keyword">static</span> <span class="token keyword">bool</span> <span class="token function">writePassword</span><span class="token punctuation">(</span>CString<span class="token operator">&amp;</span> username<span class="token punctuation">,</span> CString<span class="token operator">&amp;</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">/**
	 * @brief 关闭数据库
	 */</span>
	<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">/**
	 * @brief 读取商品信息
	 * @param products 商品信息数组
	 */</span>
	<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">readProducts</span><span class="token punctuation">(</span>productsVector<span class="token operator">&amp;</span> products<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">/**
	 * @brief 写入商品信息
	 * @param products 商品信息数据
	 */</span>
	<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">writeProducts</span><span class="token punctuation">(</span>productsVector<span class="token operator">&amp;</span> products<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">/**
	 * @brief 修改商品信息
	 * @param products 
	 */</span>
	<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">modifyProducts</span><span class="token punctuation">(</span>productsVector<span class="token operator">&amp;</span> products<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     StoreManager.cpp
    </p>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"pch.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"StoreManager.hpp"</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdexcept&gt;</span></span>

sqlite3<span class="token operator">*</span> StoreManager<span class="token double-colon punctuation">::</span>db <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
loginInfoStruct StoreManager<span class="token double-colon punctuation">::</span>loginInfo<span class="token punctuation">;</span>
productStruct StoreManager<span class="token double-colon punctuation">::</span>product<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">connect</span><span class="token punctuation">(</span>CString<span class="token operator">&amp;</span> databasePath<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>StoreManager<span class="token double-colon punctuation">::</span>db <span class="token operator">!=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	CW2A <span class="token function">databasePathA</span><span class="token punctuation">(</span>databasePath<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 宽字符串转普通字符串</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sqlite3_open</span><span class="token punctuation">(</span>databasePathA<span class="token punctuation">,</span> <span class="token operator">&amp;</span>StoreManager<span class="token double-colon punctuation">::</span>db<span class="token punctuation">)</span> <span class="token operator">!=</span> SQLITE_OK<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		std<span class="token double-colon punctuation">::</span>string error <span class="token operator">=</span> <span class="token string">"打开数据库失败："</span> <span class="token operator">+</span> std<span class="token double-colon punctuation">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token function">sqlite3_errmsg</span><span class="token punctuation">(</span>StoreManager<span class="token double-colon punctuation">::</span>db<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">throw</span> std<span class="token double-colon punctuation">::</span><span class="token function">runtime_error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>StoreManager<span class="token double-colon punctuation">::</span>db <span class="token operator">!=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">sqlite3_free</span><span class="token punctuation">(</span>StoreManager<span class="token double-colon punctuation">::</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span>
		StoreManager<span class="token double-colon punctuation">::</span>db <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">readLoginInfoCallback</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span> data<span class="token punctuation">,</span> <span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">*</span> argv<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">*</span> colName<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>data<span class="token punctuation">;</span>
	<span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>argc<span class="token punctuation">;</span>
	<span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>colName<span class="token punctuation">;</span>
	StoreManager<span class="token double-colon punctuation">::</span>loginInfo<span class="token punctuation">.</span>username <span class="token operator">=</span> argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	StoreManager<span class="token double-colon punctuation">::</span>loginInfo<span class="token punctuation">.</span>password <span class="token operator">=</span> argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">readLogin</span><span class="token punctuation">(</span>CString<span class="token operator">&amp;</span> username<span class="token punctuation">,</span> CString<span class="token operator">&amp;</span> password<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>StoreManager<span class="token double-colon punctuation">::</span>db <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		std<span class="token double-colon punctuation">::</span>string error <span class="token operator">=</span> <span class="token string">"请连接数据库后再读取登录信息"</span><span class="token punctuation">;</span>
		<span class="token keyword">throw</span> std<span class="token double-colon punctuation">::</span><span class="token function">runtime_error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> sqlA <span class="token operator">=</span> <span class="token string">"select * from users"</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span><span class="token operator">*</span> errorA <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sqlite3_exec</span><span class="token punctuation">(</span>StoreManager<span class="token double-colon punctuation">::</span>db<span class="token punctuation">,</span> sqlA<span class="token punctuation">,</span> StoreManager<span class="token double-colon punctuation">::</span>readLoginInfoCallback<span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>errorA<span class="token punctuation">)</span> <span class="token operator">!=</span> SQLITE_OK<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		std<span class="token double-colon punctuation">::</span>string error <span class="token operator">=</span> <span class="token string">"读取登录信息失败："</span> <span class="token operator">+</span> std<span class="token double-colon punctuation">::</span><span class="token function">string</span><span class="token punctuation">(</span>errorA<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">sqlite3_free</span><span class="token punctuation">(</span>errorA<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">throw</span> std<span class="token double-colon punctuation">::</span><span class="token function">runtime_error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	username <span class="token operator">=</span> StoreManager<span class="token double-colon punctuation">::</span>loginInfo<span class="token punctuation">.</span>username<span class="token punctuation">;</span>
    password <span class="token operator">=</span> StoreManager<span class="token double-colon punctuation">::</span>loginInfo<span class="token punctuation">.</span>password<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> <span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">writePassword</span><span class="token punctuation">(</span>CString<span class="token operator">&amp;</span> username<span class="token punctuation">,</span> CString<span class="token operator">&amp;</span> password<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>StoreManager<span class="token double-colon punctuation">::</span>db <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		std<span class="token double-colon punctuation">::</span>string error <span class="token operator">=</span> <span class="token string">"请连接数据库后再读取登录信息"</span><span class="token punctuation">;</span>
		<span class="token keyword">throw</span> std<span class="token double-colon punctuation">::</span><span class="token function">runtime_error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	CString sql<span class="token punctuation">;</span>
	sql<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span>L<span class="token string">"update users set password = '%s' where username = '%s'"</span><span class="token punctuation">,</span> password<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> username<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	CW2A <span class="token function">sqlA</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span><span class="token operator">*</span> errorA <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sqlite3_exec</span><span class="token punctuation">(</span>StoreManager<span class="token double-colon punctuation">::</span>db<span class="token punctuation">,</span> sqlA<span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>errorA<span class="token punctuation">)</span> <span class="token operator">!=</span> SQLITE_OK<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		CA2W <span class="token function">errorW</span><span class="token punctuation">(</span>errorA<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">AfxMessageBox</span><span class="token punctuation">(</span>errorW<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">sqlite3_free</span><span class="token punctuation">(</span>errorA<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

CString <span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">utf8ToGbk</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> utf8Str<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> wideCharLen <span class="token operator">=</span> <span class="token function">MultiByteToWideChar</span><span class="token punctuation">(</span>CP_UTF8<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> utf8Str<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>wideCharLen <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token function">CString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">wchar_t</span><span class="token operator">*</span> wideCharStr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">wchar_t</span><span class="token punctuation">[</span>wideCharLen<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">MultiByteToWideChar</span><span class="token punctuation">(</span>CP_UTF8<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> utf8Str<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> wideCharStr<span class="token punctuation">,</span> wideCharLen<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">int</span> gbkLen <span class="token operator">=</span> <span class="token function">WideCharToMultiByte</span><span class="token punctuation">(</span>CP_ACP<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wideCharStr<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>gbkLen <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> wideCharStr<span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token function">CString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">char</span><span class="token operator">*</span> gbkStr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>gbkLen<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">WideCharToMultiByte</span><span class="token punctuation">(</span>CP_ACP<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wideCharStr<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> gbkStr<span class="token punctuation">,</span> gbkLen<span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	CString <span class="token function">result</span><span class="token punctuation">(</span>gbkStr<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> wideCharStr<span class="token punctuation">;</span>
	<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> gbkStr<span class="token punctuation">;</span>

	<span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">char</span><span class="token operator">*</span> <span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">gbkToUtf8</span><span class="token punctuation">(</span><span class="token keyword">const</span> CString<span class="token operator">&amp;</span> gbkStr<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// 获取宽字符字符串的长度</span>
	<span class="token keyword">int</span> wideCharLen <span class="token operator">=</span> gbkStr<span class="token punctuation">.</span><span class="token function">GetLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>wideCharLen <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span> <span class="token comment">// 如果字符串为空，直接返回 nullptr</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// 将 CString 转换为宽字符数组</span>
	<span class="token keyword">const</span> WCHAR<span class="token operator">*</span> gbkW <span class="token operator">=</span> gbkStr<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 获取需要的 UTF-8 编码字符串的长度（包括结尾的 '\0'）</span>
	<span class="token keyword">int</span> utf8Len <span class="token operator">=</span> <span class="token function">WideCharToMultiByte</span><span class="token punctuation">(</span>CP_UTF8<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> gbkW<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>utf8Len <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span> <span class="token comment">// 如果转换失败，返回 nullptr</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// 分配内存用于存储 UTF-8 编码的字符串</span>
	<span class="token keyword">char</span><span class="token operator">*</span> utf8Str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>utf8Len<span class="token punctuation">]</span><span class="token punctuation">;</span>

	<span class="token comment">// 执行转换</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">WideCharToMultiByte</span><span class="token punctuation">(</span>CP_UTF8<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> gbkW<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> utf8Str<span class="token punctuation">,</span> utf8Len<span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> utf8Str<span class="token punctuation">;</span> <span class="token comment">// 如果转换失败，释放已分配的内存</span>
		<span class="token keyword">return</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> utf8Str<span class="token punctuation">;</span> <span class="token comment">// 返回转换后的 UTF-8 字符串</span>
<span class="token punctuation">}</span>


<span class="token keyword">void</span> <span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">readProducts</span><span class="token punctuation">(</span>productsVector<span class="token operator">&amp;</span> products<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>StoreManager<span class="token double-colon punctuation">::</span>db <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		std<span class="token double-colon punctuation">::</span>string error <span class="token operator">=</span> <span class="token string">"请连接数据库后再读取商品信息"</span><span class="token punctuation">;</span>
		<span class="token keyword">throw</span> std<span class="token double-colon punctuation">::</span><span class="token function">runtime_error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	products<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> sqlA <span class="token operator">=</span> <span class="token string">"select * from products"</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">*</span> result <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span><span class="token operator">*</span> errorA <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> rows<span class="token punctuation">,</span> cols<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sqlite3_get_table</span><span class="token punctuation">(</span>StoreManager<span class="token double-colon punctuation">::</span>db<span class="token punctuation">,</span> sqlA<span class="token punctuation">,</span> <span class="token operator">&amp;</span>result<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rows<span class="token punctuation">,</span> <span class="token operator">&amp;</span>cols<span class="token punctuation">,</span> <span class="token operator">&amp;</span>errorA<span class="token punctuation">)</span> <span class="token operator">!=</span> SQLITE_OK<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		CA2W <span class="token function">errorW</span><span class="token punctuation">(</span>errorA<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">AfxMessageBox</span><span class="token punctuation">(</span>errorW<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">sqlite3_free</span><span class="token punctuation">(</span>errorA<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	productStruct product<span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> row <span class="token operator">&lt;=</span> rows<span class="token punctuation">;</span> <span class="token operator">++</span>row<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		product<span class="token punctuation">.</span>id <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">stoi</span><span class="token punctuation">(</span>result<span class="token punctuation">[</span>row <span class="token operator">*</span> cols <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		product<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">utf8ToGbk</span><span class="token punctuation">(</span>result<span class="token punctuation">[</span>row <span class="token operator">*</span> cols <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		product<span class="token punctuation">.</span>price <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">stod</span><span class="token punctuation">(</span>result<span class="token punctuation">[</span>row <span class="token operator">*</span> cols <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		product<span class="token punctuation">.</span>stock <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">stoi</span><span class="token punctuation">(</span>result<span class="token punctuation">[</span>row <span class="token operator">*</span> cols <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		products<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">writeProducts</span><span class="token punctuation">(</span>productsVector<span class="token operator">&amp;</span> products<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>StoreManager<span class="token double-colon punctuation">::</span>db <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		std<span class="token double-colon punctuation">::</span>string error <span class="token operator">=</span> <span class="token string">"请连接数据库后再写入商品信息"</span><span class="token punctuation">;</span>
		<span class="token keyword">throw</span> std<span class="token double-colon punctuation">::</span><span class="token function">runtime_error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	CString sql<span class="token punctuation">;</span>
	<span class="token keyword">char</span><span class="token operator">*</span> errorA <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>productStruct product <span class="token operator">:</span> products<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		sql<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span>L<span class="token string">"insert into products (name, price, stock) values ('%s', %f, %d)"</span><span class="token punctuation">,</span> product<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> product<span class="token punctuation">.</span>price<span class="token punctuation">,</span> product<span class="token punctuation">.</span>stock<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">char</span><span class="token operator">*</span> sqlA <span class="token operator">=</span> <span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">gbkToUtf8</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sqlite3_exec</span><span class="token punctuation">(</span>StoreManager<span class="token double-colon punctuation">::</span>db<span class="token punctuation">,</span> sqlA<span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>errorA<span class="token punctuation">)</span> <span class="token operator">!=</span> SQLITE_OK<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			CA2W <span class="token function">errorW</span><span class="token punctuation">(</span>errorA<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">AfxMessageBox</span><span class="token punctuation">(</span>errorW<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">sqlite3_free</span><span class="token punctuation">(</span>errorA<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> sqlA<span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> sqlA<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">modifyProducts</span><span class="token punctuation">(</span>productsVector<span class="token operator">&amp;</span> products<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>StoreManager<span class="token double-colon punctuation">::</span>db <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		std<span class="token double-colon punctuation">::</span>string error <span class="token operator">=</span> <span class="token string">"请连接数据库后再修改商品信息"</span><span class="token punctuation">;</span>
		<span class="token keyword">throw</span> std<span class="token double-colon punctuation">::</span><span class="token function">runtime_error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	CString sql<span class="token punctuation">;</span>
	<span class="token keyword">char</span><span class="token operator">*</span> errorA <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>productStruct product <span class="token operator">:</span> products<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		sql<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span>L<span class="token string">"update products set price = %f, stock = %d where name = '%s'"</span><span class="token punctuation">,</span> product<span class="token punctuation">.</span>price<span class="token punctuation">,</span> product<span class="token punctuation">.</span>stock<span class="token punctuation">,</span> product<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">char</span><span class="token operator">*</span> sqlA <span class="token operator">=</span> <span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">gbkToUtf8</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sqlite3_exec</span><span class="token punctuation">(</span>StoreManager<span class="token double-colon punctuation">::</span>db<span class="token punctuation">,</span> sqlA<span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>errorA<span class="token punctuation">)</span> <span class="token operator">!=</span> SQLITE_OK<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			CA2W <span class="token function">errorW</span><span class="token punctuation">(</span>errorA<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">AfxMessageBox</span><span class="token punctuation">(</span>errorW<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">sqlite3_free</span><span class="token punctuation">(</span>errorA<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> sqlA<span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> sqlA<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="_490">
     </a>
     保证程序退出时关闭数据库
    </h4>
    <p>
     在
     <strong>
      类视图
     </strong>
     下，
     <strong>
      CsaleSystemApp
     </strong>
     类中，找一个位置写入。注意要引用
     <strong>
      StoreManager.hpp
     </strong>
     头文件
    </p>
    <pre><code class="prism language-cpp"><span class="token keyword">struct</span> <span class="token class-name">Release</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token operator">~</span><span class="token function">Release</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span> release<span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/9b665f816f4a8b1cfb601f0f2c908271.png"/>
    </p>
    <p>
     可以把 C++ 中的 struct 看作是默认 public 的 class，这里析构函数需要 public，使用 struct 就不需要额外写一个
     <strong>
      public:
     </strong>
     ，然后实例化一个对象，这样程序结束的时候就会自动调用这个析构函数，完成资源的释放。
    </p>
    <h3>
     <a id="_506">
     </a>
     登录对话框
    </h3>
    <h4>
     <a id="_508">
     </a>
     界面设计
    </h4>
    <p>
     在
     <strong>
      资源视图
     </strong>
     下，
     <strong>
      Dialog
     </strong>
     上右键
     <strong>
      插入
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/1a4b4cef3ac3b8ae3b0d953a95abee81.png"/>
    </p>
    <p>
     将对话框 ID 改为
     <strong>
      DIALOG_LOGIN
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/cafa0eef383cf88d11fab054e0a2828b.png"/>
    </p>
    <p>
     添加控件，并设置好描述文字，设置窗口标题
     <br/>
     (使用 Static Text、Edit Control 和 Button)
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/38368aeec48b9fec70d2ea144359d952.png"/>
    </p>
    <p>
     在对话框空白处右键
     <strong>
      添加类
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/d8ab56b96317ba4432b788583bd2e362.png"/>
    </p>
    <p>
     创建一个类
     <strong>
      LoginDialog
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/e92c71a7dbb51cdf2cdde01a862c8490.png"/>
    </p>
    <p>
     为用户名编辑框创建变量
     <strong>
      usernameEditControl
     </strong>
     ，访问选
     <strong>
      private
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/29d7cbf4496749f8c49d6a596a3972e9.png"/>
    </p>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/f788fc862cd5a7e139135c0a8f0a6756.png"/>
    </p>
    <p>
     同样为密码编辑框创建变量
     <strong>
      passwordEditControl
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/9ffbc24e4b6002449a6490729a587287.png"/>
    </p>
    <h4>
     <a id="_534">
     </a>
     功能实现
    </h4>
    <h5>
     <a id="_536">
     </a>
     让登录对话框在文档之前创建
    </h5>
    <p>
     在
     <strong>
      类视图
     </strong>
     下，
     <strong>
      CsaleSystemApp
     </strong>
     类中的
     <strong>
      InitInstance
     </strong>
     方法中
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/951a37f36ce4b4fcae4fe08b58d47f27.png"/>
    </p>
    <p>
     找到**CWinApp::InitInstance();**的位置，在它之前以模态的方式运行登录对话框。注意要引用对话框的头文件
     <strong>
      LoginDialog.hpp
     </strong>
     。
     <br/>
     然后判断返回值，后续实现中如果登录成功才会调用
     <strong>
      OnOK
     </strong>
     ，这边得到的返回值就是
     <strong>
      IDOK
     </strong>
     ，如果不是那就说明点击了取消登录或右上角的关闭按钮，以及其它操作，这时候就要直接返回，就不会创建后续文档页面。
    </p>
    <pre><code class="prism language-cpp">	LoginDialog loginDialog<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>loginDialog<span class="token punctuation">.</span><span class="token function">DoModal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> IDOK<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> TRUE<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/ee1f9a634399977fb55c8b76b0655d94.png"/>
    </p>
    <p>
     这时候调试运行就会先显示登录对话框，但是关闭登录对话框后会显示文档页面，后续还要处理这个逻辑，只有登录验证才应该显示后续的文档。
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/e11e3b43dfa9c09d53e35dfbd4162dd5.png"/>
    </p>
    <h5>
     <a id="_555">
     </a>
     数据库连接
    </h5>
    <p>
     在
     <strong>
      资源视图
     </strong>
     下，
     <strong>
      StringTable
     </strong>
     添加一个字段
     <strong>
      DATABASE_PATH
     </strong>
     ，设置 SQLite3 数据库文件的路径，这里就在项目目录下，使用相对路径
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/df5be2a488fbc1b697154c970c024110.png"/>
    </p>
    <p>
     <strong>
      类视图
     </strong>
     下，在登录对话框类
     <strong>
      LoginDialog
     </strong>
     上右键
     <strong>
      属性
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/990973acc510f04a3a762651b2e94fb0.png"/>
    </p>
    <p>
     上面点击图标切换到
     <strong>
      重写
     </strong>
     页面，添加（重写）
     <strong>
      OnInitDialog
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/5b1a594c0ea286f3268187be0a9818b5.png"/>
    </p>
    <p>
     然后回到
     <strong>
      OnInitDialog
     </strong>
     函数中，添加连接数据库的代码。注意前面要引用数据库读写实现的头文件
     <strong>
      StoreManager.hpp
     </strong>
     。
    </p>
    <pre><code class="prism language-cpp">	CString databasePath<span class="token punctuation">;</span>
	databasePath<span class="token punctuation">.</span><span class="token function">LoadStringW</span><span class="token punctuation">(</span>DATABASE_PATH<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">connect</span><span class="token punctuation">(</span>databasePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/391ebbddec9e3bdbabef8631f75f5103.png"/>
    </p>
    <h5>
     <a id="_574">
     </a>
     登录按钮回调实现
    </h5>
    <p>
     双击登录按钮会直接创建点击事件的回调
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/27e27fb94798a7eda14e2260e7d67e46.png"/>
    </p>
    <p>
     写入代码
    </p>
    <pre><code class="prism language-cpp">	<span class="token comment">// 读取用户输入的用户名和密码</span>
	CString inputUsername<span class="token punctuation">,</span> inputPassword<span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>usernameEditControl<span class="token punctuation">.</span><span class="token function">GetWindowTextW</span><span class="token punctuation">(</span>inputUsername<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>passwordEditControl<span class="token punctuation">.</span><span class="token function">GetWindowTextW</span><span class="token punctuation">(</span>inputPassword<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 读取数据库中的用户名和密码</span>
	CString username<span class="token punctuation">,</span> password<span class="token punctuation">;</span>
	<span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">readLogin</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 判断用户名和密码</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>inputUsername <span class="token operator">==</span> username<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>inputPassword <span class="token operator">!=</span> password<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">MessageBox</span><span class="token punctuation">(</span>L<span class="token string">"密码错误"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token operator">-&gt;</span>usernameEditControl<span class="token punctuation">.</span><span class="token function">SetWindowTextW</span><span class="token punctuation">(</span>L<span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token operator">-&gt;</span>passwordEditControl<span class="token punctuation">.</span><span class="token function">SetWindowTextW</span><span class="token punctuation">(</span>L<span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">MessageBox</span><span class="token punctuation">(</span>L<span class="token string">"登录成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">CDialogEx</span><span class="token double-colon punctuation">::</span><span class="token function">OnOK</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span>L<span class="token string">"用户名不存在"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token operator">-&gt;</span>usernameEditControl<span class="token punctuation">.</span><span class="token function">SetWindowTextW</span><span class="token punctuation">(</span>L<span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token operator">-&gt;</span>passwordEditControl<span class="token punctuation">.</span><span class="token function">SetWindowTextW</span><span class="token punctuation">(</span>L<span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/44d44131ad423134c9f05386860ba1d9.png"/>
    </p>
    <p>
     调试运行
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/3951c74f4ff76c4bdc89058e2aea7ebd.png"/>
    </p>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/1c60c8f352c618bafd88cd95509d8e38.png"/>
    </p>
    <h5>
     <a id="_619">
     </a>
     取消按钮回调实现
    </h5>
    <p>
     双击取消按钮，创建点击事件回调
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/5e58d5edab3bc830b15841da799a93fb.png"/>
    </p>
    <p>
     点击取消调用取消方法
    </p>
    <pre><code class="prism language-cpp">	<span class="token class-name">CDialogEx</span><span class="token double-colon punctuation">::</span><span class="token function">OnCancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/27e5c73dbf1a73cc393872384ed327dc.png"/>
    </p>
    <h5>
     <a id="_630">
     </a>
     修改回车键为登录
    </h5>
    <p>
     对话框默认状态下按回车会调用
     <strong>
      CDialogEx::OnOK()
     </strong>
     ，这就会让登录验证成为摆设，相当于点击了登录对话框的 OK，那么接下来就会直接进入文档页面。
     <br/>
     另外按照一般使用习惯回车键就是确认输入，这里也就是确认登录。
     <br/>
     在
     <strong>
      类视图
     </strong>
     下，
     <strong>
      LoginDialog
     </strong>
     类上右键
     <strong>
      属性
     </strong>
     ，重写对话框的
     <strong>
      OnOK
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/bb10688dc3c329e49c036e0c9da5d4d6.png"/>
    </p>
    <p>
     注释掉
     <strong>
      CDialogEx::OnOK();
     </strong>
     ，然后调用登录按钮点击事件的回调方法，这就按回车就等于是点击登录按钮。
    </p>
    <pre><code class="prism language-cpp">	<span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">OnBnClickedButton1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/ed390064e1bff7d1dca53632455f9fa7.png"/>
    </p>
    <h3>
     <a id="_643">
     </a>
     静态拆分窗口
    </h3>
    <h4>
     <a id="_645">
     </a>
     自定义视图类
    </h4>
    <p>
     在
     <strong>
      类视图
     </strong>
     中项目名上右键
     <strong>
      类向导
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/5bf7f05fa3e35a39476580a73207d315.png"/>
    </p>
    <p>
     下拉
     <strong>
      MFC 类
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/7155bcc7b3ccacaeff1c5089acb53931.png"/>
    </p>
    <p>
     类名
     <strong>
      SelectView
     </strong>
     ，基类
     <strong>
      CTreeView
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/2a3a89fefc4692376b20fd23c22bfd5d.png"/>
    </p>
    <p>
     同样再添加一个类
     <strong>
      DisplayView
     </strong>
     ，基类
     <strong>
      CFormView
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/9a7558054781bb080909a6b88aeb1020.png"/>
    </p>
    <p>
     创建完上面两个类，在类向导页面点确定，编译在下面可能看到一堆
     <strong>
      SelectView
     </strong>
     头文件和源文件的报错
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/194c66a42eb029dfa0cdbc4e63b74e98.png"/>
    </p>
    <p>
     在头文件增加引用
     <strong>
      #include “afxcview.h”
     </strong>
     ，
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/38dc687be099a18c5e1ddc7c1a16b261.png"/>
    </p>
    <p>
     再编译就好了
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/3fde5ba0e491f733b5327a3aa3f855c8.png"/>
    </p>
    <h4>
     <a id="_668">
     </a>
     拆分窗口
    </h4>
    <p>
     在
     <strong>
      类视图
     </strong>
     中，点开
     <strong>
      CMainFrame
     </strong>
     类，声明一个对象
    </p>
    <pre><code class="prism language-cpp"><span class="token keyword">private</span><span class="token operator">:</span>
	CSplitterWnd splitter<span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/cf1edc8bfa7c1d3ddf9dc117dd16264d.png"/>
    </p>
    <p>
     在
     <strong>
      CMainFrame
     </strong>
     上右键
     <strong>
      属性
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/635fe74e882fbbd051998775cf0b9d8e.png"/>
    </p>
    <p>
     重写
     <strong>
      OnCreateClient
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/d99d32fb7b601f0309954efe17c03805.png"/>
    </p>
    <p>
     把原来的返回注释了，重新写
     <br/>
     注意需要引用
     <strong>
      SelectView.hpp
     </strong>
     和
     <strong>
      DisplayView.hpp
     </strong>
     头文件
    </p>
    <pre><code class="prism language-cpp">	<span class="token comment">// 拆分为 1 行 2 列</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>splitter<span class="token punctuation">.</span><span class="token function">CreateStatic</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 创建左侧视图</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>splitter<span class="token punctuation">.</span><span class="token function">CreateView</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">RUNTIME_CLASS</span><span class="token punctuation">(</span>SelectView<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">CSize</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pContext<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 创建右侧视图</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>splitter<span class="token punctuation">.</span><span class="token function">CreateView</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">RUNTIME_CLASS</span><span class="token punctuation">(</span>DisplayView<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">CSize</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pContext<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> TRUE<span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/09f546bdf0756c6db8cc637fd069aced.png"/>
    </p>
    <p>
     调试运行，登录后可以看到下图的布局
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/bac903189af2ffa67a8749ecffed4c58.png"/>
    </p>
    <h3>
     <a id="_702">
     </a>
     左侧树视图
    </h3>
    <h4>
     <a id="_704">
     </a>
     添加功能节点
    </h4>
    <p>
     <strong>
      资源视图
     </strong>
     下，
     <strong>
      Icon
     </strong>
     右键
     <strong>
      添加资源
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/7c203496cab89e97a4ab0110d53d61e8.png"/>
    </p>
    <p>
     导入
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/fff34f20908c084a19d36b7959d104ee.png"/>
    </p>
    <p>
     选择 re.ico 文件
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/01fb73a26893c33db2bdf1af7fb06440.png"/>
    </p>
    <p>
     ID 重设为
     <strong>
      IDI_ICON_RE
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/790bba76835776ca2fb5030ea18579a6.png"/>
    </p>
    <p>
     <strong>
      类视图
     </strong>
     下双击
     <strong>
      SelectView
     </strong>
     类，在类头文件中增加
    </p>
    <pre><code class="prism language-cpp"><span class="token keyword">private</span><span class="token operator">:</span>
	CTreeCtrl<span class="token operator">*</span> treeCtrl<span class="token punctuation">;</span>
	CImageList imageList<span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/55a1107854ab022fc128b640539bcb89.png"/>
    </p>
    <p>
     <strong>
      SelectView
     </strong>
     类上右键属性
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/6f7e8363cfe5bc05d160e9f4e0783229.png"/>
    </p>
    <p>
     重写
     <strong>
      OnInitialUpdate
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/05c6581160631c4511df004d48b6ddcb.png"/>
    </p>
    <p>
     写入
    </p>
    <pre><code class="prism language-cpp">	<span class="token comment">// 加载图标</span>
	HICON icon <span class="token operator">=</span> <span class="token function">AfxGetApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">LoadIconW</span><span class="token punctuation">(</span>IDI_ICON_RE<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 创建图片列表</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>imageList<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> ILC_COLOR32<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 添加图标</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>imageList<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>icon<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 获取树控件</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>treeCtrl <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token function">GetTreeCtrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 树控件设置图片列表</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>treeCtrl<span class="token operator">-&gt;</span><span class="token function">SetImageList</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>imageList<span class="token punctuation">,</span> TVSIL_NORMAL<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 树控件设置节点</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>treeCtrl<span class="token operator">-&gt;</span><span class="token function">InsertItem</span><span class="token punctuation">(</span>L<span class="token string">"个人信息"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> TVI_ROOT<span class="token punctuation">,</span> TVI_LAST<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>treeCtrl<span class="token operator">-&gt;</span><span class="token function">InsertItem</span><span class="token punctuation">(</span>L<span class="token string">"销售管理"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> TVI_ROOT<span class="token punctuation">,</span> TVI_LAST<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>treeCtrl<span class="token operator">-&gt;</span><span class="token function">InsertItem</span><span class="token punctuation">(</span>L<span class="token string">"库存信息"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> TVI_ROOT<span class="token punctuation">,</span> TVI_LAST<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>treeCtrl<span class="token operator">-&gt;</span><span class="token function">InsertItem</span><span class="token punctuation">(</span>L<span class="token string">"库存添加"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> TVI_ROOT<span class="token punctuation">,</span> TVI_LAST<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>treeCtrl<span class="token operator">-&gt;</span><span class="token function">InsertItem</span><span class="token punctuation">(</span>L<span class="token string">"库存删除"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> TVI_ROOT<span class="token punctuation">,</span> TVI_LAST<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/205497537728aefc4de9b1f5a487364f.png"/>
    </p>
    <p>
     运行登陆后
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/106b462a399ddcca4b2d375a19a3af8f.png"/>
    </p>
    <h4>
     <a id="_761">
     </a>
     功能节点消息处理
    </h4>
    <p>
     查看
     <strong>
      SelectView
     </strong>
     类属性，添加消息
     <strong>
      TVN_SELCHANGED
     </strong>
     的回调
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/462eb42380f30eb3775fab0688a19db0.png"/>
    </p>
    <p>
     写入
    </p>
    <pre><code class="prism language-cpp">	<span class="token comment">// 获取选中的项目</span>
	HTREEITEM item <span class="token operator">=</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>treeCtrl<span class="token operator">-&gt;</span><span class="token function">GetSelectedItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 获取选中项文本内容</span>
	CString selectedText <span class="token operator">=</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>treeCtrl<span class="token operator">-&gt;</span><span class="token function">GetItemText</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>selectedText <span class="token operator">==</span> L<span class="token string">"个人信息"</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>

	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>selectedText <span class="token operator">==</span> L<span class="token string">"销售管理"</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>

	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>selectedText <span class="token operator">==</span> L<span class="token string">"库存信息"</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>

	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>selectedText <span class="token operator">==</span> L<span class="token string">"库存添加"</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>

	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>selectedText <span class="token operator">==</span> L<span class="token string">"库存删除"</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>

	<span class="token punctuation">}</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/87e2fcd98a61bba6430c57735d5e8909.png"/>
    </p>
    <h3>
     <a id="_797">
     </a>
     个人信息页面
    </h3>
    <h4>
     <a id="_799">
     </a>
     界面设计
    </h4>
    <p>
     <strong>
      资源视图
     </strong>
     下，
     <strong>
      Dialog
     </strong>
     上右键
     <strong>
      插入
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/7183a76f05bf324d703f20b37f49d2bc.png"/>
    </p>
    <p>
     <strong>
      ID
     </strong>
     改为
     <strong>
      DIALOG_USER
     </strong>
     ，
     <strong>
      边框
     </strong>
     改为
     <strong>
      None
     </strong>
     ，
     <strong>
      样式
     </strong>
     改为
     <strong>
      Child
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/b285def292460dd4383e2a169e30f547.png"/>
    </p>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/1f6c1da60ed2bc59ff209608b97d154e.png"/>
    </p>
    <p>
     绘制页面，原来的确定和取消按钮保留
     <br/>
     （Group Box、Static Text、Edit Control）
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/35478ddb752df629bdc386cd3035bb1b.png"/>
    </p>
    <p>
     在对话框空白处右键
     <strong>
      添加类
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/a12e2eb5a1db49d9f9567c19035085c4.png"/>
    </p>
    <p>
     类名
     <strong>
      UserDialog
     </strong>
     ，基类
     <strong>
      CFormView
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/e083470e25f044f4bdd753c530d0704b.png"/>
    </p>
    <p>
     下面分别为 4 个编辑框创建变量
     <br/>
     身份
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/282992fecd9dafe0719e7fb312914f75.png"/>
    </p>
    <p>
     变量名
     <strong>
      positionEditControl
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/4cb6ddf5e3ba9843fdd2443d0a6670f5.png"/>
    </p>
    <p>
     用户名编辑框变量
     <strong>
      usernameEditControl
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/2bbdadf480bb229088b6e27b1936eb72.png"/>
    </p>
    <p>
     新密码编辑框变量
     <strong>
      newPasswordEditControl
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/29c3e05b3a747f6907c45298b6a4775a.png"/>
    </p>
    <p>
     确定密码编辑框变量
     <strong>
      confirmPasswordEditControl
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/c97ffde221ccfac16b768cbc21f8990f.png"/>
    </p>
    <h4>
     <a id="_835">
     </a>
     功能实现
    </h4>
    <h5>
     <a id="_837">
     </a>
     初始化界面
    </h5>
    <p>
     <strong>
      类视图
     </strong>
     中
     <strong>
      UserDialog
     </strong>
     类上右键
     <strong>
      属性
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/6d28a75c592ad7318cc62383070ad70b.png"/>
    </p>
    <p>
     重写
     <strong>
      OnInitialUpdate
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/56dd7f3e09eb7eb287f0076687b49b1f.png"/>
    </p>
    <pre><code class="prism language-cpp">	<span class="token keyword">this</span><span class="token operator">-&gt;</span>positionEditControl<span class="token punctuation">.</span><span class="token function">SetWindowTextW</span><span class="token punctuation">(</span>L<span class="token string">"销售员"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/d0550e954503087554688b938b021192.png"/>
    </p>
    <h5>
     <a id="_850">
     </a>
     确定修改密码
    </h5>
    <p>
     双击确定按钮，编辑确定按钮的单机事件回调，注意要引用
     <strong>
      StoreManager.hpp
     </strong>
     头文件
    </p>
    <pre><code class="prism language-cpp">
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>usernameEditControl<span class="token punctuation">.</span><span class="token function">GetWindowTextLengthW</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span>L<span class="token string">"输入用户名不能为空"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>newPasswordEditControl<span class="token punctuation">.</span><span class="token function">GetWindowTextLengthW</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>confirmPasswordEditControl<span class="token punctuation">.</span><span class="token function">GetWindowTextLengthW</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span>L<span class="token string">"输入密码不能为空"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	CString newPassword<span class="token punctuation">,</span> confirmPassword<span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>newPasswordEditControl<span class="token punctuation">.</span><span class="token function">GetWindowTextW</span><span class="token punctuation">(</span>newPassword<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>confirmPasswordEditControl<span class="token punctuation">.</span><span class="token function">GetWindowTextW</span><span class="token punctuation">(</span>confirmPassword<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>newPassword <span class="token operator">!=</span> confirmPassword<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span>L<span class="token string">"输入密码和确定密码不同"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	CString oldPassword<span class="token punctuation">,</span> username<span class="token punctuation">,</span> inputUsername<span class="token punctuation">;</span>
	<span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">readLogin</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> oldPassword<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>usernameEditControl<span class="token punctuation">.</span><span class="token function">GetWindowTextW</span><span class="token punctuation">(</span>inputUsername<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>inputUsername <span class="token operator">!=</span> username<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span>L<span class="token string">"用户名错误"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>newPassword <span class="token operator">==</span> oldPassword<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span>L<span class="token string">"新密码和原密码相同"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">writePassword</span><span class="token punctuation">(</span>inputUsername<span class="token punctuation">,</span> newPassword<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span>L<span class="token string">"修改密码成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span>L<span class="token string">"修改密码失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/9b3f6a73ff0763c1597009b1e8576b7a.png"/>
    </p>
    <h5>
     <a id="_904">
     </a>
     取消修改密码
    </h5>
    <p>
     双击取消按钮
    </p>
    <pre><code class="prism language-cpp">	<span class="token keyword">this</span><span class="token operator">-&gt;</span>usernameEditControl<span class="token punctuation">.</span><span class="token function">SetWindowTextW</span><span class="token punctuation">(</span>L<span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>newPasswordEditControl<span class="token punctuation">.</span><span class="token function">SetWindowTextW</span><span class="token punctuation">(</span>L<span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>confirmPasswordEditControl<span class="token punctuation">.</span><span class="token function">SetWindowTextW</span><span class="token punctuation">(</span>L<span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/bb975f8970ecceaa2b29164b3e58588c.png"/>
    </p>
    <h4>
     <a id="_914">
     </a>
     界面挂载
    </h4>
    <h5>
     <a id="_916">
     </a>
     自定义消息发送
    </h5>
    <p>
     在
     <strong>
      类视图
     </strong>
     中双击
     <strong>
      CMainFrame
     </strong>
     类进行编辑，写入自定义消息
    </p>
    <pre><code class="prism language-cpp"><span class="token keyword">constexpr</span> UINT NM_USER <span class="token operator">=</span> WM_USER <span class="token operator">+</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token keyword">constexpr</span> UINT NM_SELL <span class="token operator">=</span> WM_USER <span class="token operator">+</span> <span class="token number">101</span><span class="token punctuation">;</span>
<span class="token keyword">constexpr</span> UINT NM_INFO <span class="token operator">=</span> WM_USER <span class="token operator">+</span> <span class="token number">102</span><span class="token punctuation">;</span>
<span class="token keyword">constexpr</span> UINT NM_ADD <span class="token operator">=</span> WM_USER <span class="token operator">+</span> <span class="token number">103</span><span class="token punctuation">;</span>
<span class="token keyword">constexpr</span> UINT NM_DEL <span class="token operator">=</span> WM_USER <span class="token operator">+</span> <span class="token number">104</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/d33fe40338d4c33222ad92c83b646dea.png"/>
    </p>
    <p>
     添加自定义消息处理函数，头文件中添加声明
    </p>
    <pre><code class="prism language-cpp"><span class="token keyword">protected</span><span class="token operator">:</span>
	afx_msg LRESULT <span class="token function">onMyChange</span><span class="token punctuation">(</span>WPARAM wParam<span class="token punctuation">,</span> LPARAM lParam<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/32f9545de25988f5280c82522823c80f.png"/>
    </p>
    <p>
     源文件中添加定义
    </p>
    <pre><code class="prism language-cpp">afx_msg LRESULT <span class="token class-name">CMainFrame</span><span class="token double-colon punctuation">::</span><span class="token function">onMyChange</span><span class="token punctuation">(</span>WPARAM wParam<span class="token punctuation">,</span> LPARAM lParam<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>

<span class="token punctuation">}</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/e57b185079d4bce6e2dde03145b9ba19.png"/>
    </p>
    <p>
     然后看到
     <strong>
      BEGIN_MESSAGE_MAP
     </strong>
     ，在它和
     <strong>
      END_MESSAGE_MAP()
     </strong>
     之间添加代码
    </p>
    <pre><code class="prism language-cpp">	<span class="token comment">// 响应自定义消息</span>
	<span class="token function">ON_MESSAGE</span><span class="token punctuation">(</span>NM_USER<span class="token punctuation">,</span> onMyChange<span class="token punctuation">)</span>
	<span class="token function">ON_MESSAGE</span><span class="token punctuation">(</span>NM_SELL<span class="token punctuation">,</span> onMyChange<span class="token punctuation">)</span>
	<span class="token function">ON_MESSAGE</span><span class="token punctuation">(</span>NM_INFO<span class="token punctuation">,</span> onMyChange<span class="token punctuation">)</span>
	<span class="token function">ON_MESSAGE</span><span class="token punctuation">(</span>NM_ADD<span class="token punctuation">,</span> onMyChange<span class="token punctuation">)</span>
	<span class="token function">ON_MESSAGE</span><span class="token punctuation">(</span>NM_DEL<span class="token punctuation">,</span> onMyChange<span class="token punctuation">)</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/6b4bb6ce20cfa9286869645727c91ced.png"/>
    </p>
    <p>
     编辑
     <strong>
      SelectView
     </strong>
     类中的
     <strong>
      OnTvnSelchanged
     </strong>
     方法，注意需要引用
     <strong>
      MainFrm.h
     </strong>
     头文件
    </p>
    <pre><code class="prism language-cpp">	<span class="token keyword">if</span> <span class="token punctuation">(</span>selectedText <span class="token operator">==</span> L<span class="token string">"个人信息"</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 将消息放入消息队列</span>
		<span class="token double-colon punctuation">::</span><span class="token function">PostMessage</span><span class="token punctuation">(</span>
			<span class="token function">AfxGetMainWnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">GetSafeHwnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 框架窗口对象指针</span>
			NM_USER<span class="token punctuation">,</span> <span class="token comment">// 发送自定义消息</span>
			NM_USER<span class="token punctuation">,</span> <span class="token comment">// 消息的附加参数</span>
			<span class="token number">0</span> <span class="token comment">// 消息的附加参数，这里不使用</span>
		<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>selectedText <span class="token operator">==</span> L<span class="token string">"销售管理"</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token double-colon punctuation">::</span><span class="token function">PostMessage</span><span class="token punctuation">(</span><span class="token function">AfxGetMainWnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">GetSafeHwnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> NM_SELL<span class="token punctuation">,</span> NM_SELL<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>selectedText <span class="token operator">==</span> L<span class="token string">"库存信息"</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token double-colon punctuation">::</span><span class="token function">PostMessage</span><span class="token punctuation">(</span><span class="token function">AfxGetMainWnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">GetSafeHwnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> NM_INFO<span class="token punctuation">,</span> NM_INFO<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>selectedText <span class="token operator">==</span> L<span class="token string">"库存添加"</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token double-colon punctuation">::</span><span class="token function">PostMessage</span><span class="token punctuation">(</span><span class="token function">AfxGetMainWnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">GetSafeHwnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> NM_ADD<span class="token punctuation">,</span> NM_ADD<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>selectedText <span class="token operator">==</span> L<span class="token string">"库存删除"</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token double-colon punctuation">::</span><span class="token function">PostMessage</span><span class="token punctuation">(</span><span class="token function">AfxGetMainWnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">GetSafeHwnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> NM_DEL<span class="token punctuation">,</span> NM_DEL<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/293435abb8301266562a59fbdc97269f.png"/>
    </p>
    <h5>
     <a id="_986">
     </a>
     自定义消息处理
    </h5>
    <p>
     编辑
     <strong>
      CMainFrame
     </strong>
     类中的
     <strong>
      OnMyChange
     </strong>
     方法，注意引用
     <strong>
      UserDialog.hpp
     </strong>
     头文件
    </p>
    <pre><code class="prism language-cpp">	CCreateContext context<span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>splitter<span class="token punctuation">.</span><span class="token function">DeleteView</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">switch</span> <span class="token punctuation">(</span>wParam<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">case</span> NM_USER<span class="token operator">:</span>
		<span class="token punctuation">{<!-- --></span>
			context<span class="token punctuation">.</span>m_pNewViewClass <span class="token operator">=</span> <span class="token function">RUNTIME_CLASS</span><span class="token punctuation">(</span>UserDialog<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token operator">-&gt;</span>splitter<span class="token punctuation">.</span><span class="token function">CreateView</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">RUNTIME_CLASS</span><span class="token punctuation">(</span>UserDialog<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">CSize</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">(</span><span class="token punctuation">(</span>UserDialog<span class="token operator">*</span><span class="token punctuation">)</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>splitter<span class="token punctuation">.</span><span class="token function">GetPane</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">OnInitialUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">case</span> NM_SELL<span class="token operator">:</span>
		<span class="token punctuation">{<!-- --></span>

			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">case</span> NM_INFO<span class="token operator">:</span>
		<span class="token punctuation">{<!-- --></span>

			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">case</span> NM_ADD<span class="token operator">:</span>
		<span class="token punctuation">{<!-- --></span>

			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">case</span> NM_DEL<span class="token operator">:</span>
		<span class="token punctuation">{<!-- --></span>

			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

	<span class="token punctuation">}</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>splitter<span class="token punctuation">.</span><span class="token function">RecalcLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>splitter<span class="token punctuation">.</span><span class="token function">SetActivePane</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	context<span class="token punctuation">.</span>m_pLastView <span class="token operator">=</span> <span class="token punctuation">(</span>CFormView<span class="token operator">*</span><span class="token punctuation">)</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>splitter<span class="token punctuation">.</span><span class="token function">GetPane</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	context<span class="token punctuation">.</span>m_pCurrentFrame <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/326af5f0e6eb0e0c411ee2d766044f9e.png"/>
    </p>
    <p>
     调试运行效果
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/976d6c33a350e9a4c5a406578f0c4c63.png"/>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/16d6c0a758c1c317c964c76a7a320b96.png"/>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/f3e7cb5283c58e0546e23a71167d04c5.png"/>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/c13149fdde7922fce5eb7c9b6fbbbe13.png"/>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/df119e96457daadbc0017a83d640d071.png"/>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/332163556111502fd0bf8e4c0e84a82b.png"/>
    </p>
    <h3>
     <a id="_1040">
     </a>
     销售管理页面
    </h3>
    <h4>
     <a id="_1042">
     </a>
     界面设计
    </h4>
    <p>
     资源视图下插入新的对话框
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/a7faeff23efee6e4e69d75b18c142d3d.png"/>
    </p>
    <p>
     <strong>
      ID
     </strong>
     改为
     <strong>
      DIALOG_SELL
     </strong>
     ，
     <strong>
      边框
     </strong>
     改为
     <strong>
      None
     </strong>
     ，
     <strong>
      样式
     </strong>
     改为
     <strong>
      Child
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/b034ab2fc246ccf4e0818b226d35a58d.png"/>
    </p>
    <p>
     绘制界面，不删除原先的确定和取消按钮，
     <strong>
      确定
     </strong>
     的描述文字改成
     <strong>
      购买
     </strong>
     ，商品名那里的 Combo Box 属性里的
     <strong>
      类型
     </strong>
     改为
     <strong>
      下拉列表
     </strong>
     ，订单信息那里的大编辑框属性里
     <strong>
      多行
     </strong>
     、
     <strong>
      垂直滚动
     </strong>
     依次设置为
     <strong>
      True
     </strong>
     ，数量编辑框属性里的
     <strong>
      数字
     </strong>
     改为
     <strong>
      True
     </strong>
     <br/>
     （Group Box、Static Text、Edit Control、Combo Box）
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/0b1f72500fdef45af39f59da8d209534.png"/>
    </p>
    <p>
     在对话框空白处右键添加类
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/e834fc00a1bf878d3583843c0f0efe19.png"/>
    </p>
    <p>
     类名为
     <strong>
      SellDialog
     </strong>
     ，基类为
     <strong>
      CFormView
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/dbfa773d085bfebd7bb34a3d97f84c5b.png"/>
    </p>
    <p>
     为商品名组合框创建变量
     <strong>
      productNameComboBoxControl
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/c045e1fe990c47643e47a72e146bb97f.png"/>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/e52e9beea8e7b8db576c7647b3858e1d.png"/>
    </p>
    <p>
     为单价编辑框创建变量
     <strong>
      priceEditValue
     </strong>
     ，注意类别选值，变量类型填 double
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/af12ac59e4170f6492f7337d0e4abdee.png"/>
    </p>
    <p>
     为数量编辑框创建变量
     <strong>
      numEditValue
     </strong>
     ，类别选值，变量类型填 int
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/e773f9dc6c2f7505490490ff9ed0dad0.png"/>
    </p>
    <p>
     为订单信息编辑框创建变量
     <strong>
      sellEditControl
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/182c69ffcb8db82668f21ec09b137c6e.png"/>
    </p>
    <h4>
     <a id="_1073">
     </a>
     界面挂载
    </h4>
    <p>
     编辑
     <strong>
      CMainFrame
     </strong>
     类中的
     <strong>
      OnMyChange
     </strong>
     方法，在
     <strong>
      case NM_SELL
     </strong>
     下写。注意引用
     <strong>
      SellDialog.hpp
     </strong>
     头文件
    </p>
    <pre><code class="prism language-cpp">			context<span class="token punctuation">.</span>m_pNewViewClass <span class="token operator">=</span> <span class="token function">RUNTIME_CLASS</span><span class="token punctuation">(</span>SellDialog<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token operator">-&gt;</span>splitter<span class="token punctuation">.</span><span class="token function">CreateView</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">RUNTIME_CLASS</span><span class="token punctuation">(</span>SellDialog<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">CSize</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">(</span><span class="token punctuation">(</span>SellDialog<span class="token operator">*</span><span class="token punctuation">)</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>splitter<span class="token punctuation">.</span><span class="token function">GetPane</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">OnInitialUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/2d8bfdf41fbe94e6c8cd92fc07a161cf.png"/>
    </p>
    <p>
     调试运行
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/cd15d7ddb5de5b2df30865380ffa2b8e.png"/>
    </p>
    <h4>
     <a id="_1086">
     </a>
     功能实现
    </h4>
    <h5>
     <a id="_1088">
     </a>
     初始化界面
    </h5>
    <p>
     <strong>
      CellDialog
     </strong>
     类上右键属性，重写
     <strong>
      OnInitialUpdate
     </strong>
     方法
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/fe15abf3f9980c36718ca629eb135d47.png"/>
    </p>
    <p>
     这里从数据库读取商品数据，把商品名设置给组合框，注意引用
     <strong>
      StoreManager.hpp
     </strong>
     头文件
    </p>
    <pre><code class="prism language-cpp">	productsVector products<span class="token punctuation">;</span>
	<span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">readProducts</span><span class="token punctuation">(</span>products<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span>productStruct product <span class="token operator">:</span> products<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">this</span><span class="token operator">-&gt;</span>productNameComboBoxControl<span class="token punctuation">.</span><span class="token function">AddString</span><span class="token punctuation">(</span>product<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>productNameComboBoxControl<span class="token punctuation">.</span><span class="token function">SetCurSel</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/65195b0057dd0c8a9d5d95bfaea388f3.png"/>
    </p>
    <p>
     调试运行
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/666cc8af1aa7514ffb3f63427e829e95.png"/>
    </p>
    <h5>
     <a id="_1109">
     </a>
     组合框切换刷新信息
    </h5>
    <p>
     在商品名组合框上右键属性
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/8feae897822fb1d31d558f6003e82046.png"/>
    </p>
    <p>
     创建
     <strong>
      CBN_SELCHANGE
     </strong>
     事件的回调方法
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/b958299852d71984d30cff8047ce3a14.png"/>
    </p>
    <p>
     写入
    </p>
    <pre><code class="prism language-cpp">	<span class="token comment">// 获取当前选中项的索引</span>
	<span class="token keyword">int</span> curIdx <span class="token operator">=</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>productNameComboBoxControl<span class="token punctuation">.</span><span class="token function">GetCurSel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 获取当前选中项的文本</span>
	CString curText<span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>productNameComboBoxControl<span class="token punctuation">.</span><span class="token function">GetLBText</span><span class="token punctuation">(</span>curIdx<span class="token punctuation">,</span> curText<span class="token punctuation">)</span><span class="token punctuation">;</span>

	productsVector products<span class="token punctuation">;</span>
	<span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">readProducts</span><span class="token punctuation">(</span>products<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span>productStruct product <span class="token operator">:</span> products<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>curText <span class="token operator">==</span> product<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">this</span><span class="token operator">-&gt;</span>priceEditValue <span class="token operator">=</span> product<span class="token punctuation">.</span>price<span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token operator">-&gt;</span>numEditValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token function">UpdateData</span><span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/bbaa758e38d8413263c65ba6260de758.png"/>
    </p>
    <p>
     另外在前面重写的
     <strong>
      OnInitialUpdate
     </strong>
     方法末尾调用一下，实现初始化
    </p>
    <pre><code class="prism language-cpp">	<span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">OnCbnSelchangeCombo1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/53b90ad7c961ce13d1ef893a325e44d4.png"/>
    </p>
    <p>
     调试运行
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/41cb8b8c9a4b57f4d93742db53943179.png"/>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/8d22cdc3be509b8cf97674e9b94c5ce3.png"/>
    </p>
    <h5>
     <a id="_1152">
     </a>
     购买实现
    </h5>
    <p>
     双击购买按钮，创建点击事件回调，写入
    </p>
    <pre><code class="prism language-cpp">	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>numEditValue <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span>L<span class="token string">"购买数量不能为 0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">int</span> curIdx <span class="token operator">=</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>productNameComboBoxControl<span class="token punctuation">.</span><span class="token function">GetCurSel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	CString curText<span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>productNameComboBoxControl<span class="token punctuation">.</span><span class="token function">GetLBText</span><span class="token punctuation">(</span>curIdx<span class="token punctuation">,</span> curText<span class="token punctuation">)</span><span class="token punctuation">;</span>

	productsVector products<span class="token punctuation">;</span>
	<span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">readProducts</span><span class="token punctuation">(</span>products<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>productsVector<span class="token double-colon punctuation">::</span>iterator product <span class="token operator">=</span> products<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> product <span class="token operator">!=</span> products<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>product<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>curText <span class="token operator">==</span> product<span class="token operator">-&gt;</span>name<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>numEditValue <span class="token operator">&gt;</span> product<span class="token operator">-&gt;</span>stock<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				CString msg<span class="token punctuation">;</span>
				msg<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span>L<span class="token string">"购买数量超出库存，当前库存数量：%d，请减小购买数量后再试"</span><span class="token punctuation">,</span> product<span class="token operator">-&gt;</span>stock<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token function">MessageBox</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">return</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			product<span class="token operator">-&gt;</span>stock <span class="token operator">=</span> product<span class="token operator">-&gt;</span>stock <span class="token operator">-</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>numEditValue<span class="token punctuation">;</span>
			productsVector modifyProduct <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token operator">*</span>product <span class="token punctuation">}</span><span class="token punctuation">;</span>
			<span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">modifyProducts</span><span class="token punctuation">(</span>modifyProduct<span class="token punctuation">)</span><span class="token punctuation">;</span>
			CString sellMsg<span class="token punctuation">;</span>
			sellMsg<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span>L<span class="token string">"商品：%s\r\n单价：%f\r\n数量：%d\r\n总价：%f\r\n剩余库存：%d"</span><span class="token punctuation">,</span> product<span class="token operator">-&gt;</span>name<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> product<span class="token operator">-&gt;</span>price<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>numEditValue<span class="token punctuation">,</span> product<span class="token operator">-&gt;</span>price <span class="token operator">*</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>numEditValue<span class="token punctuation">,</span> product<span class="token operator">-&gt;</span>stock<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token operator">-&gt;</span>sellEditControl<span class="token punctuation">.</span><span class="token function">SetWindowTextW</span><span class="token punctuation">(</span>sellMsg<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/bebc012a023a573555c39d21d91cbd2f.png"/>
    </p>
    <p>
     调试运行效果
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/7bb5624f1fc2f54a6d6989c12479249f.png"/>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/2816ea215b9cbbfca9282b92b24bcbf7.png"/>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/83db1e6aea58ce956221fea9b3799b16.png"/>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/04d36cf172cd1167dda1add10611274f.png"/>
    </p>
    <h5>
     <a id="_1197">
     </a>
     取消
    </h5>
    <p>
     双击取消按钮，创建事件回调
    </p>
    <pre><code class="prism language-cpp">	<span class="token keyword">this</span><span class="token operator">-&gt;</span>sellEditControl<span class="token punctuation">.</span><span class="token function">SetWindowTextW</span><span class="token punctuation">(</span>L<span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>numEditValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">UpdateData</span><span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/a4b2d01f6171ddd40a80ab54038a149a.png"/>
    </p>
    <h3>
     <a id="_1207">
     </a>
     库存信息页面
    </h3>
    <h4>
     <a id="_1209">
     </a>
     界面设计
    </h4>
    <p>
     添加一个对话框
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/686ef8b83a1cc16e2bdf02fa2a67e288.png"/>
    </p>
    <p>
     属性里，ID 设置为
     <strong>
      DIALOG_INFO
     </strong>
     ，边框选
     <strong>
      None
     </strong>
     ，样式选
     <strong>
      Child
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/3cfc067f7f740238bf21e8936ab56e00.png"/>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/aab2e7ec817a00413f4c1c720f83c953.png"/>
    </p>
    <p>
     绘制界面，删除确定和取消按钮，List Control 的视图改为
     <strong>
      Report
     </strong>
     <br/>
     （Static Text、List Control）
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/b6fd430fd2084c076f54d65ab2c6b9f1.png"/>
    </p>
    <p>
     对话框空白处右键添加类
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/4bdc4153122290f636a234dbe907b89d.png"/>
    </p>
    <p>
     类名
     <strong>
      InfoDialog
     </strong>
     ，基类
     <strong>
      CFormView
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/3b604cd54319f60f1fc65d9ac0326f4d.png"/>
    </p>
    <p>
     在列表控件上右键添加变量
     <strong>
      infoListControl
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/b59a6768046371ed551b8ce212d7968e.png"/>
    </p>
    <h4>
     <a id="_1231">
     </a>
     界面挂载
    </h4>
    <p>
     编辑
     <strong>
      CMainFrame
     </strong>
     类中的
     <strong>
      onMyChange
     </strong>
     方法，在
     <strong>
      case NM_INFO
     </strong>
     下写入，注意引用头文件
     <strong>
      InfoDialog.hpp
     </strong>
    </p>
    <pre><code class="prism language-cpp">			context<span class="token punctuation">.</span>m_pNewViewClass <span class="token operator">=</span> <span class="token function">RUNTIME_CLASS</span><span class="token punctuation">(</span>InfoDialog<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token operator">-&gt;</span>splitter<span class="token punctuation">.</span><span class="token function">CreateView</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">RUNTIME_CLASS</span><span class="token punctuation">(</span>InfoDialog<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">CSize</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">(</span><span class="token punctuation">(</span>InfoDialog<span class="token operator">*</span><span class="token punctuation">)</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>splitter<span class="token punctuation">.</span><span class="token function">GetPane</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">OnInitialUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/2654bbc29e95d0e00600238db0280006.png"/>
    </p>
    <p>
     调试运行
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/e327651edf8eae8c9f082d47bcb87a75.png"/>
    </p>
    <h4>
     <a id="_1244">
     </a>
     功能实现
    </h4>
    <p>
     在
     <strong>
      InfoDialog
     </strong>
     类上右键
     <strong>
      属性
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/23e4aff5ab2247d7180f52ba38917881.png"/>
    </p>
    <p>
     重写
     <strong>
      OnInitialUpdate
     </strong>
     方法
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/210ceeca48abb9a7571516e9c4797c7d.png"/>
    </p>
    <p>
     注意引用
     <strong>
      StoreManager.hpp
     </strong>
     头文件
    </p>
    <pre><code class="prism language-cpp">	<span class="token comment">// 显示表头</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>infoListControl<span class="token punctuation">.</span><span class="token function">SetExtendedStyle</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>infoListControl<span class="token punctuation">.</span><span class="token function">GetExtendedStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">|</span> LVS_EX_FULLROWSELECT <span class="token operator">|</span> LVS_EX_GRIDLINES<span class="token punctuation">)</span><span class="token punctuation">;</span>
	CString field<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> L<span class="token string">"商品ID"</span><span class="token punctuation">,</span> L<span class="token string">"商品名称"</span><span class="token punctuation">,</span> L<span class="token string">"商品价格"</span><span class="token punctuation">,</span> L<span class="token string">"库存数量"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>field<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>field<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">this</span><span class="token operator">-&gt;</span>infoListControl<span class="token punctuation">.</span><span class="token function">InsertColumn</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> field<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> LVCFMT_CENTER<span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// 读取商品信息</span>
	productsVector products<span class="token punctuation">;</span>
	<span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">readProducts</span><span class="token punctuation">(</span>products<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 显示数据</span>
	<span class="token keyword">int</span> idx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	CString tmpStr<span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>productsVector<span class="token double-colon punctuation">::</span>iterator product <span class="token operator">=</span> products<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> product <span class="token operator">!=</span> products<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>product<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		tmpStr<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span>L<span class="token string">"%d"</span><span class="token punctuation">,</span> product<span class="token operator">-&gt;</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token operator">-&gt;</span>infoListControl<span class="token punctuation">.</span><span class="token function">InsertItem</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span> tmpStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token operator">-&gt;</span>infoListControl<span class="token punctuation">.</span><span class="token function">SetItemText</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> product<span class="token operator">-&gt;</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
		tmpStr<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span>L<span class="token string">"%f"</span><span class="token punctuation">,</span> product<span class="token operator">-&gt;</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token operator">-&gt;</span>infoListControl<span class="token punctuation">.</span><span class="token function">SetItemText</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> tmpStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
		tmpStr<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span>L<span class="token string">"%d"</span><span class="token punctuation">,</span> product<span class="token operator">-&gt;</span>stock<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token operator">-&gt;</span>infoListControl<span class="token punctuation">.</span><span class="token function">SetItemText</span><span class="token punctuation">(</span>idx<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> tmpStr<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token operator">++</span>idx<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/772758f27f1680c7f7c41fdea61808ca.png"/>
    </p>
    <p>
     调试运行
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/107cd0e4dfde25a23b9165405be34eff.png"/>
    </p>
    <h3>
     <a id="_1287">
     </a>
     库存添加页面
    </h3>
    <h4>
     <a id="_1289">
     </a>
     界面设计
    </h4>
    <p>
     添加一个对话框
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/14669617ec87900944824f498f603686.png"/>
    </p>
    <p>
     ID 改为
     <strong>
      DIALOG_ADD
     </strong>
     ，边框改为
     <strong>
      None
     </strong>
     ，样式改为
     <strong>
      Child
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/d538fa886d897b62c23e80c26eef1dbf.png"/>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/71f09d0fff9d1984ef94d04397713833.png"/>
    </p>
    <p>
     绘制界面，删除原来的确定和取消按钮，个数编辑框属性的
     <strong>
      数字
     </strong>
     设置为
     <strong>
      True
     </strong>
     ，Combo Box 属性类型选
     <strong>
      下拉列表
     </strong>
     ，库存单价编辑库属性
     <strong>
      只读
     </strong>
     设置为
     <strong>
      True
     </strong>
     <br/>
     （Static Text、Group Box、Edit Control、Button、Combo Box）
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/1d4c75f196a8b31af13a2f5b79aa78a1.png"/>
    </p>
    <p>
     在对话框空白处右键添加类
     <strong>
      AddDialog
     </strong>
     ，基类
     <strong>
      CFormView
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/9b40cc2ee902ab5797072e0f16764e93.png"/>
    </p>
    <p>
     为组合框和编辑框添加变量
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/d2ad2a191d2400cb5aeff832d992e9f8.png"/>
    </p>
    <p>
     库存商品编辑框，变量名
     <strong>
      stockProductComboBoxControl
     </strong>
     ，访问
     <strong>
      private
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/521cfa5001ebfcb3f8ec23ef864c7d87.png"/>
    </p>
    <p>
     库存价格编辑框，变量名
     <strong>
      stockPriceEditValue
     </strong>
     ，类别
     <strong>
      值
     </strong>
     ，访问
     <strong>
      private
     </strong>
     ，变量类型
     <strong>
      double
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/978efd4e58f1aa1be3a687518f4b3087.png"/>
    </p>
    <p>
     库存个数编辑框，变量名
     <strong>
      stockNumEditValue
     </strong>
     ，类别
     <strong>
      值
     </strong>
     ，访问
     <strong>
      private
     </strong>
     ，变量类型
     <strong>
      int
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/dd84430b9275ca37c427e3c1c7709eae.png"/>
    </p>
    <p>
     新商品编辑框，变量名
     <strong>
      newProductEditValue
     </strong>
     ，类别
     <strong>
      值
     </strong>
     ，访问
     <strong>
      private
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/c51f5a124b1a21b203c8beeee98771aa.png"/>
    </p>
    <p>
     新商品单价编辑框，变量名
     <strong>
      newPriceEditValue
     </strong>
     ，类别
     <strong>
      值
     </strong>
     ，访问
     <strong>
      private
     </strong>
     ，变量类型
     <strong>
      double
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/5d9a758a5270a8bb9086f5f1e84b5ee9.png"/>
    </p>
    <p>
     新商品库存编辑框，变量名
     <strong>
      newNumEditValue
     </strong>
     ，类别
     <strong>
      值
     </strong>
     ，访问
     <strong>
      private
     </strong>
     ，变量类型
     <strong>
      int
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/91e95cdad78c329daacb96bddabecef1.png"/>
    </p>
    <h4>
     <a id="_1326">
     </a>
     界面挂载
    </h4>
    <p>
     编辑
     <strong>
      CMainFrame
     </strong>
     类中
     <strong>
      onMyChange
     </strong>
     方法，在
     <strong>
      case NM_ADD
     </strong>
     中添加，注意引用头文件
     <strong>
      AddDialog.hpp
     </strong>
    </p>
    <pre><code class="prism language-cpp">			context<span class="token punctuation">.</span>m_pNewViewClass <span class="token operator">=</span> <span class="token function">RUNTIME_CLASS</span><span class="token punctuation">(</span>AddDialog<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token operator">-&gt;</span>splitter<span class="token punctuation">.</span><span class="token function">CreateView</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">RUNTIME_CLASS</span><span class="token punctuation">(</span>AddDialog<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">CSize</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">(</span><span class="token punctuation">(</span>AddDialog<span class="token operator">*</span><span class="token punctuation">)</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>splitter<span class="token punctuation">.</span><span class="token function">GetPane</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">OnInitialUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/b39d56f85307415aadd3751e2f6a9909.png"/>
    </p>
    <p>
     调试运行
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/e1bcf29926b36513f4279602039a3219.png"/>
    </p>
    <h4>
     <a id="_1339">
     </a>
     功能实现
    </h4>
    <h5>
     <a id="_1341">
     </a>
     初始化库存组合框
    </h5>
    <p>
     重写
     <strong>
      OnInitialUpdate
     </strong>
     方法
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/102b26cf7983c7799455d501090876c1.png"/>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/77b55ee18ab6dc17c5c9ffb6a85a5874.png"/>
    </p>
    <p>
     注意引用
     <strong>
      StoreManager.hpp
     </strong>
     头文件
    </p>
    <pre><code class="prism language-cpp">	productsVector products<span class="token punctuation">;</span>
	<span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">readProducts</span><span class="token punctuation">(</span>products<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>productsVector<span class="token double-colon punctuation">::</span>iterator product <span class="token operator">=</span> products<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> product <span class="token operator">!=</span> products<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>product<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">this</span><span class="token operator">-&gt;</span>stockProductComboBoxControl<span class="token punctuation">.</span><span class="token function">AddString</span><span class="token punctuation">(</span>product<span class="token operator">-&gt;</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>stockProductComboBoxControl<span class="token punctuation">.</span><span class="token function">SetCurSel</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/11b54d67bfaaf0e7258de51b8a5a66ed.png"/>
    </p>
    <p>
     调试运行
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/6a9bb4e27cc83861ec8a07b1525995d0.png"/>
    </p>
    <h5>
     <a id="_1362">
     </a>
     库存组合框切换事件回调
    </h5>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/0dcc7ad3b79374a21e8d0d9a2c88bfa5.png"/>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/f755d8c92aa36e73fae064372adf2c16.png"/>
    </p>
    <pre><code class="prism language-cpp">	<span class="token keyword">int</span> curIdx <span class="token operator">=</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>stockProductComboBoxControl<span class="token punctuation">.</span><span class="token function">GetCurSel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	CString curText<span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>stockProductComboBoxControl<span class="token punctuation">.</span><span class="token function">GetLBText</span><span class="token punctuation">(</span>curIdx<span class="token punctuation">,</span> curText<span class="token punctuation">)</span><span class="token punctuation">;</span>

	productsVector products<span class="token punctuation">;</span>
	<span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">readProducts</span><span class="token punctuation">(</span>products<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>productsVector<span class="token double-colon punctuation">::</span>iterator product <span class="token operator">=</span> products<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> product <span class="token operator">!=</span> products<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>product<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>curText <span class="token operator">==</span> product<span class="token operator">-&gt;</span>name<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">this</span><span class="token operator">-&gt;</span>stockPriceEditValue <span class="token operator">=</span> product<span class="token operator">-&gt;</span>price<span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token operator">-&gt;</span>stockNumEditValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token function">UpdateData</span><span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/1b338bc98d7be2981a9c15f0bed23b2b.png"/>
    </p>
    <p>
     在
     <strong>
      OnInitialUpdate
     </strong>
     里调用这个方法，保证初始化的时候正确设置
    </p>
    <pre><code class="prism language-cpp">	<span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">OnCbnSelchangeCombo2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/6bc9a2fd2658ba12b46b783f2f60e1eb.png"/>
    </p>
    <p>
     调试运行
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/39d052208208319b8184029205ca7169.png"/>
    </p>
    <h5>
     <a id="_1396">
     </a>
     添加库存
    </h5>
    <p>
     双击
     <strong>
      添加库存
     </strong>
     按钮
    </p>
    <pre><code class="prism language-cpp">	<span class="token function">UpdateData</span><span class="token punctuation">(</span>TRUE<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>stockNumEditValue <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>stockPriceEditValue <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span>L<span class="token string">"数量必须大于 0，或价格不能低于 0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">int</span> curIdx <span class="token operator">=</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>stockProductComboBoxControl<span class="token punctuation">.</span><span class="token function">GetCurSel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	CString curText<span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>stockProductComboBoxControl<span class="token punctuation">.</span><span class="token function">GetLBText</span><span class="token punctuation">(</span>curIdx<span class="token punctuation">,</span> curText<span class="token punctuation">)</span><span class="token punctuation">;</span>

	productsVector products<span class="token punctuation">;</span>
	<span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">readProducts</span><span class="token punctuation">(</span>products<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>productsVector<span class="token double-colon punctuation">::</span>iterator product <span class="token operator">=</span> products<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> product <span class="token operator">!=</span> products<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>product<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>curText <span class="token operator">==</span> product<span class="token operator">-&gt;</span>name<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			product<span class="token operator">-&gt;</span>stock <span class="token operator">+=</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>stockNumEditValue<span class="token punctuation">;</span>
			CString msg<span class="token punctuation">;</span>
			productsVector tmpProduct <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token operator">*</span>product <span class="token punctuation">}</span><span class="token punctuation">;</span>
			<span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">modifyProducts</span><span class="token punctuation">(</span>tmpProduct<span class="token punctuation">)</span><span class="token punctuation">;</span>
			msg<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span>L<span class="token string">"增加库存：%d，库存总量：%d"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>stockNumEditValue<span class="token punctuation">,</span> product<span class="token operator">-&gt;</span>stock<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">MessageBox</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">this</span><span class="token operator">-&gt;</span>stockNumEditValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">UpdateData</span><span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/722b5f0ce7fca10452713aaaa7e2737e.png"/>
    </p>
    <p>
     调试运行
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/c0f4071bbcb0bf5f34d6d48b9ac1d155.png"/>
    </p>
    <h5>
     <a id="_1436">
     </a>
     取消库存设置
    </h5>
    <p>
     双击
     <strong>
      取消库存设置
     </strong>
     按钮
    </p>
    <pre><code class="prism language-cpp">	<span class="token keyword">this</span><span class="token operator">-&gt;</span>stockNumEditValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">UpdateData</span><span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/ffdf84fde80e9cfed14f0c799760cf66.png"/>
    </p>
    <h5>
     <a id="_1445">
     </a>
     添加新商品
    </h5>
    <p>
     双击
     <strong>
      添加新商品
     </strong>
     按钮
    </p>
    <pre><code class="prism language-cpp">	<span class="token function">UpdateData</span><span class="token punctuation">(</span>TRUE<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>newNumEditValue <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>newPriceEditValue <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>newProductEditValue<span class="token punctuation">.</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span>L<span class="token string">"输入信息有误"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	productStruct product<span class="token punctuation">;</span>
	product<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>newProductEditValue<span class="token punctuation">;</span>
	product<span class="token punctuation">.</span>price <span class="token operator">=</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>newPriceEditValue<span class="token punctuation">;</span>
	product<span class="token punctuation">.</span>stock <span class="token operator">=</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>newNumEditValue<span class="token punctuation">;</span>
	productsVector tmpProduct <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> product <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">writeProducts</span><span class="token punctuation">(</span>tmpProduct<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">this</span><span class="token operator">-&gt;</span>newProductEditValue<span class="token punctuation">.</span><span class="token function">Empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>newPriceEditValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>newNumEditValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">UpdateData</span><span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">OnInitialUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	CString msg<span class="token punctuation">;</span>
	msg<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span>L<span class="token string">"添加商品：%s，单价：%f，数量：%d"</span><span class="token punctuation">,</span> product<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> product<span class="token punctuation">.</span>price<span class="token punctuation">,</span> product<span class="token punctuation">.</span>stock<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">MessageBox</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/6ff90900a06cf87ab3074e9b91cccd27.png"/>
    </p>
    <p>
     调试运行
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/51f589e888b63bf16104d9e61e740f7b.png"/>
    </p>
    <h5>
     <a id="_1480">
     </a>
     取消商品设置
    </h5>
    <p>
     双击
     <strong>
      取消商品设置
     </strong>
     按钮
    </p>
    <pre><code class="prism language-cpp">	<span class="token keyword">this</span><span class="token operator">-&gt;</span>newProductEditValue<span class="token punctuation">.</span><span class="token function">Empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>newPriceEditValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>newNumEditValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">UpdateData</span><span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/cc7e2d4acfa8ee576fdc588f9406d25c.png"/>
    </p>
    <h3>
     <a id="_1492">
     </a>
     库存删除页面
    </h3>
    <h4>
     <a id="_1494">
     </a>
     界面设计
    </h4>
    <p>
     添加一个对话款
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/2f32f297b8648f9658de2ecc9d00c127.png"/>
    </p>
    <p>
     ID 改为
     <strong>
      DIALOG_DEL
     </strong>
     ，边框改为
     <strong>
      None
     </strong>
     ，样式改为
     <strong>
      Child
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/aba9a307a65593bff1ab1eb424665816.png"/>
    </p>
    <p>
     绘制界面，保留确定和取消按钮，Combo Box 类型改为
     <strong>
      下拉列表
     </strong>
     ，数量编辑框属性数字设置为
     <strong>
      True
     </strong>
     ，设置单价编辑框只读
     <br/>
     （Group Box、Static Text、Combo Box、Edit Control）
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/c84d69e0f7dcfe91551c48ebd130b0ed.png"/>
    </p>
    <p>
     为对话框添加类
     <strong>
      DelDialog
     </strong>
     ，基类
     <strong>
      CFormView
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/228dfffe816425e2b54f2d03a18d63b9.png"/>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/46cc0c6edd2e61021cebed757be2526f.png"/>
    </p>
    <p>
     为组合框和编辑框添加变量
     <br/>
     商品名
     <strong>
      productComboBoxControl
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/972efb1b0943ed4f468d618abf91d768.png"/>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/af1ac9a6b90e23e3c4b5c5ec54645989.png"/>
    </p>
    <p>
     单价
     <strong>
      priceEditValue
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/2ce56ca2ac1cd3be33e85b527b6fca41.png"/>
    </p>
    <p>
     数量
     <strong>
      numEditValue
     </strong>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/c99978ac20fd513fb37d38c0f02cad52.png"/>
    </p>
    <h4>
     <a id="_1521">
     </a>
     界面挂载
    </h4>
    <p>
     编辑
     <strong>
      CMainFrame
     </strong>
     类中
     <strong>
      onMyChange
     </strong>
     方法，在
     <strong>
      case NM_DEL
     </strong>
     下写入，注意引用头文件
     <strong>
      DelDialog.hpp
     </strong>
    </p>
    <pre><code class="prism language-cpp">			context<span class="token punctuation">.</span>m_pNewViewClass <span class="token operator">=</span> <span class="token function">RUNTIME_CLASS</span><span class="token punctuation">(</span>DelDialog<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token operator">-&gt;</span>splitter<span class="token punctuation">.</span><span class="token function">CreateView</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">RUNTIME_CLASS</span><span class="token punctuation">(</span>DelDialog<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">CSize</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">(</span><span class="token punctuation">(</span>DelDialog<span class="token operator">*</span><span class="token punctuation">)</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>splitter<span class="token punctuation">.</span><span class="token function">GetPane</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">OnInitialUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/c485269ffa3461b63f3219f7d06e39a9.png"/>
    </p>
    <p>
     调试运行
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/e41297baf5e264980e281571ea51fd8d.png"/>
    </p>
    <h4>
     <a id="_1534">
     </a>
     功能实现
    </h4>
    <h5>
     <a id="_1536">
     </a>
     初始化界面
    </h5>
    <p>
     重写
     <strong>
      OnInitialUpdate
     </strong>
     方法
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/41d3b94417c312a2ec89818953d57209.png"/>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/b521355e431ad000f142e90c2feaafc2.png"/>
    </p>
    <p>
     注意引用
     <strong>
      StoreManager.hpp
     </strong>
     头文件
    </p>
    <pre><code class="prism language-cpp">	productsVector products<span class="token punctuation">;</span>
	<span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">readProducts</span><span class="token punctuation">(</span>products<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span>productsVector<span class="token double-colon punctuation">::</span>iterator product <span class="token operator">=</span> products<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> product <span class="token operator">!=</span> products<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>product<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">this</span><span class="token operator">-&gt;</span>productComboBoxControl<span class="token punctuation">.</span><span class="token function">AddString</span><span class="token punctuation">(</span>product<span class="token operator">-&gt;</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>productComboBoxControl<span class="token punctuation">.</span><span class="token function">SetCurSel</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/49d14d8a346d48bff2f150c72ea4a1f1.png"/>
    </p>
    <p>
     调试运行
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/044652974bad7ab3cc0eb676299a2625.png"/>
    </p>
    <h5>
     <a id="_1558">
     </a>
     组合框切换
    </h5>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/24312f8c1ee9be2cf98448d538b067ff.png"/>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/0e3c2a38b6c0ec6d69cb60373616b706.png"/>
    </p>
    <pre><code class="prism language-cpp">	<span class="token keyword">int</span> curIdx <span class="token operator">=</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>productComboBoxControl<span class="token punctuation">.</span><span class="token function">GetCurSel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	CString curText<span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>productComboBoxControl<span class="token punctuation">.</span><span class="token function">GetLBText</span><span class="token punctuation">(</span>curIdx<span class="token punctuation">,</span> curText<span class="token punctuation">)</span><span class="token punctuation">;</span>

	productsVector products<span class="token punctuation">;</span>
	<span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">readProducts</span><span class="token punctuation">(</span>products<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>productsVector<span class="token double-colon punctuation">::</span>iterator product <span class="token operator">=</span> products<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> product <span class="token operator">!=</span> products<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>product<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>curText <span class="token operator">==</span> product<span class="token operator">-&gt;</span>name<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">this</span><span class="token operator">-&gt;</span>priceEditValue <span class="token operator">=</span> product<span class="token operator">-&gt;</span>price<span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token operator">-&gt;</span>numEditValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token function">UpdateData</span><span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/e410ab2d266d6368bdbeb3127ac592d4.png"/>
    </p>
    <pre><code class="prism language-cpp">	<span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">OnCbnSelchangeCombo1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/54e1861980c010265b8020463771ad63.png"/>
    </p>
    <p>
     调试运行
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/ea5dda9b1c38ff43110db1ebcb6de1e0.png"/>
    </p>
    <h5>
     <a id="_1590">
     </a>
     确定按钮
    </h5>
    <p>
     双击
     <strong>
      确定
     </strong>
     按钮
    </p>
    <pre><code class="prism language-cpp">	<span class="token function">UpdateData</span><span class="token punctuation">(</span>TRUE<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>numEditValue <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">MessageBox</span><span class="token punctuation">(</span>L<span class="token string">"数量必须大于 0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">int</span> curIdx <span class="token operator">=</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>productComboBoxControl<span class="token punctuation">.</span><span class="token function">GetCurSel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	CString curText<span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>productComboBoxControl<span class="token punctuation">.</span><span class="token function">GetLBText</span><span class="token punctuation">(</span>curIdx<span class="token punctuation">,</span> curText<span class="token punctuation">)</span><span class="token punctuation">;</span>

	productsVector products<span class="token punctuation">;</span>
	<span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">readProducts</span><span class="token punctuation">(</span>products<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>productsVector<span class="token double-colon punctuation">::</span>iterator product <span class="token operator">=</span> products<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> product <span class="token operator">!=</span> products<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>product<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>curText <span class="token operator">==</span> product<span class="token operator">-&gt;</span>name<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			product<span class="token operator">-&gt;</span>stock <span class="token operator">-=</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>numEditValue<span class="token punctuation">;</span>
			productsVector tmpProduct <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token operator">*</span>product <span class="token punctuation">}</span><span class="token punctuation">;</span>
			<span class="token class-name">StoreManager</span><span class="token double-colon punctuation">::</span><span class="token function">modifyProducts</span><span class="token punctuation">(</span>tmpProduct<span class="token punctuation">)</span><span class="token punctuation">;</span>
			CString msg<span class="token punctuation">;</span>
			msg<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span>L<span class="token string">"删除商品：%s, 单价：%f，数量：%d"</span><span class="token punctuation">,</span> product<span class="token operator">-&gt;</span>name<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> product<span class="token operator">-&gt;</span>price<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>numEditValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">MessageBox</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">this</span><span class="token operator">-&gt;</span>numEditValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">UpdateData</span><span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/18bb0bef030160cc9c645c1974a8df1b.png"/>
    </p>
    <p>
     调试运行
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/848f7bc1e18ae890bd366451178e4cba.png"/>
    </p>
    <h5>
     <a id="_1630">
     </a>
     取消按钮
    </h5>
    <p>
     双击
     <strong>
      取消
     </strong>
     按钮
    </p>
    <pre><code class="prism language-cpp">	<span class="token keyword">this</span><span class="token operator">-&gt;</span>numEditValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">UpdateData</span><span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/18896135041eb05a9e68922ca3d5bb8d.png"/>
    </p>
    <h3>
     <a id="_1639">
     </a>
     菜单栏
    </h3>
    <p>
     资源视图，Menu
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/295ddba539320b6bb6c92bc0560d2410.png"/>
    </p>
    <p>
     删除帮助以外的所有菜单栏
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/e813dedb0b6a50339766bbd9add7c20d.png"/>
    </p>
    <p>
     手动添加菜单
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/901aa2a0bdd1a723ef065a1b52a79e4b.png"/>
    </p>
    <p>
     添加事件处理程序
     <br/>
     个人信息
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/caf8f021759b8619683786de1b81adf4.png"/>
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/f97e575dbc4a0a80ee06469649e146c9.png"/>
    </p>
    <pre><code class="prism language-cpp">	<span class="token double-colon punctuation">::</span><span class="token function">PostMessage</span><span class="token punctuation">(</span><span class="token function">AfxGetMainWnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">GetSafeHwnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> NM_USER<span class="token punctuation">,</span> NM_USER<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/5aed181984c8de30e1255efcdd1ada34.png"/>
    </p>
    <p>
     销售管理
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/4d7fcaaf4d1b5e03903b482c7ee2f818.png"/>
    </p>
    <pre><code class="prism language-cpp">	<span class="token double-colon punctuation">::</span><span class="token function">PostMessage</span><span class="token punctuation">(</span><span class="token function">AfxGetMainWnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">GetSafeHwnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> NM_SELL<span class="token punctuation">,</span> NM_SELL<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/70ef6ab9481018a7a9afccee40943415.png"/>
    </p>
    <p>
     库存信息
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/9ad76cb76eba662700dc48cf8f964d4c.png"/>
    </p>
    <pre><code class="prism language-cpp">	<span class="token double-colon punctuation">::</span><span class="token function">PostMessage</span><span class="token punctuation">(</span><span class="token function">AfxGetMainWnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">GetSafeHwnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> NM_INFO<span class="token punctuation">,</span> NM_INFO<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/ff16d2b309baad8d23a16b8ab940d47a.png"/>
    </p>
    <p>
     库存添加
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/c5f4a90b313baea6f36f3ff79b576192.png"/>
    </p>
    <pre><code class="prism language-cpp">	<span class="token double-colon punctuation">::</span><span class="token function">PostMessage</span><span class="token punctuation">(</span><span class="token function">AfxGetMainWnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">GetSafeHwnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> NM_ADD<span class="token punctuation">,</span> NM_ADD<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/f1268cff2998cfdaf266be5ad59c64b6.png"/>
    </p>
    <p>
     库存删除
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/8b2129345aed1bed94ac35f18fc5db07.png"/>
    </p>
    <pre><code class="prism language-cpp">	<span class="token double-colon punctuation">::</span><span class="token function">PostMessage</span><span class="token punctuation">(</span><span class="token function">AfxGetMainWnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">GetSafeHwnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> NM_DEL<span class="token punctuation">,</span> NM_DEL<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/fb90f12d16b6c30b1394ae456eecbcc9.png"/>
    </p>
    <p>
     这样就可以通过菜单进行切换了
     <br/>
     <img alt="file" src="https://i-blog.csdnimg.cn/img_convert/62861269ef4bc7a5eb8b0a8c02b9a0b1.png"/>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f33363334393939372f:61727469636c652f64657461696c732f313436313636383534" class_="artid" style="display:none">
 </p>
</div>


