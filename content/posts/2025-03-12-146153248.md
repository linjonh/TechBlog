---
arturl_encode: "68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f36333839353235372f:61727469636c652f64657461696c732f313436313533323438"
layout: post
title: "静态路由配置实验相关过程"
date: 2025-03-12 14:15:23 +0800
description: "由于R1-R4各有两个环回接口，骨干链路共六条，则该拓扑图一共有14个广播域。配置过程中，需要注意每个经过手工汇总的路由后，一定要再配置其手工汇总的空接口。基于192.168.1.0/24划分过程如下。可以ping通，实验成功~"
keywords: "静态路由配置实验相关过程"
categories: ['Hcia']
tags: ['运维', '网络', '服务器']
artid: "146153248"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146153248
    alt: "静态路由配置实验相关过程"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146153248
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146153248
cover: https://bing.ee123.net/img/rand?artid=146153248
image: https://bing.ee123.net/img/rand?artid=146153248
img: https://bing.ee123.net/img/rand?artid=146153248
---

# 静态路由配置实验相关过程

**实验要求如下：**

> 1. 除R5的环回地址固定以外，整个其他所有网段基于192.168.1.0/24进行合理的ip地址划分
> 2. R1-R4每个路由器存在两个环回接口，用于模拟连接Pc的网段，地址也在192.168.1.0/24这个范围内
> 3. R1-R4上不能直接写到达5.5.5.0/24的静态路由，但依然可以访问
> 4. 全网可达，尽量减少每台路由器路由表条日数量，避免环路出现
> 5. R4与R5间，正常走1000M链路通信，故障时自动改为100M链路

**拓扑图如下：**

![](https://i-blog.csdnimg.cn/direct/676c9628fa7d4d4097293e8cc422d504.png)

实验步骤：

1. IP地址划分，统计拓扑图中一共有多少个广播域，分析各个网段需要的IP地址，分配IP
2. 配置各个路由器接口地址以及环回地址
3. 配置静态路由，使其全网可达

划分IP的思路：

由于R1-R4各有两个环回接口，骨干链路共六条，则该拓扑图一共有14个广播域。

IP分配地址如下：

|  |  |
| --- | --- |
| 基于192.168.1.0/24划分过程如下 | |
| 一个骨干 | 划分六个骨干链路 |
| 192.168.1.0/27 | 192.168.1.0/30  192.168.1.4/30  192.168.1.8/30  192.168.1.12/30  192.168.1.16/30  192.168.1.20/30 |
| 四个路由的环回 | 划分两个环回接口 |
| 192.168.32.0/27 | 192.168.1.32/28  192.168.1.48/28 |
| 192.168.1.64/27 | 192.168.1.64/28  192.168.1.80/28 |
| 192.168.1.96/27 | 192.168.1.96/28  192.168.1.112/28 |
| 192.168.1.128/27 | 192.168.1.128/28  192.168.1.144/28 |

R1配置如下：

```bash
#接口IP地址配置
[R1]int g0/0/0
[R1]ip add 192.168.1.1 30

[R1]disp this 
#静态路由配置如下
ip route-static 192.168.1.8 255.255.255.252 192.168.1.2
ip route-static 192.168.1.12 255.255.255.252 192.168.1.6
ip route-static 192.168.1.16 255.255.255.252 192.168.1.2
ip route-static 192.168.1.16 255.255.255.252 192.168.1.6
ip route-static 192.168.1.64 255.255.255.224 192.168.1.2
ip route-static 192.168.1.96 255.255.255.224 192.168.1.6
ip route-static 192.168.1.128 255.255.255.224 192.168.1.2
ip route-static 192.168.1.128 255.255.255.224 192.168.1.6

#手工汇总环回空接口配置，可防止路由黑洞
[R1]ip route-static 192.168.1.32 27 NULL 0

#缺省路由配置
[R1]ip route-static 0.0.0.0 0 192.168.1.2
[R1]ip route-static 0.0.0.0 0 192.168.1.6
```

R2配置如下：

```bash
#静态路由配置如下
[R2]ip route-static 192.168.1.128 27 192.168.1.10
[R2]ip route-static 192.168.1.12 30 192.168.1.10
[R2]ip route-static 192.168.1.96 27 192.168.1.10
[R2]ip route-static 192.168.1.96 27 192.168.1.1
[R2]ip route-static 192.168.1.4 30 192.168.1.1
[R2]ip route-static 192.168.1.16 30 192.168.1.10
[R2]ip route-static 192.168.1.32 27 192.168.1.1


#空接口配置
[R2]ip route-static 192.168.1.64 27 NULL 0

#缺省
[R2]ip route-static 0.0.0.0 0 192.168.1.10
```

R3配置如下：

```bash
[R3]dis this 

#静态路由以及空接口配置如下

ip route-static 192.168.1.0 255.255.255.252 192.168.1.5
ip route-static 192.168.1.8 255.255.255.252 192.168.1.14
ip route-static 192.168.1.16 255.255.255.252 192.168.1.14
ip route-static 192.168.1.32 255.255.255.224 192.168.1.5
ip route-static 192.168.1.64 255.255.255.224 192.168.1.5
ip route-static 192.168.1.64 255.255.255.224 192.168.1.14
ip route-static 192.168.1.96 255.255.255.224 NULL0
ip route-static 192.168.1.128 255.255.255.224 192.168.1.14

#缺省
[R3]ip route-static 0.0.0.0 0 192.168.1.14

```

R4配置如下：

```bash
[R4]display this 

#静态路由配置、空接口配置如下
ip route-static 0.0.0.0 0.0.0.0 192.168.1.18
ip route-static 192.168.1.0 255.255.255.252 192.168.1.9
ip route-static 192.168.1.4 255.255.255.252 192.168.1.13
ip route-static 192.168.1.32 255.255.255.224 192.168.1.13
ip route-static 192.168.1.32 255.255.255.224 192.168.1.9
ip route-static 192.168.1.64 255.255.255.224 192.168.1.9
ip route-static 192.168.1.96 255.255.255.224 192.168.1.13
ip route-static 192.168.1.128 255.255.255.224 NULL0

#缺省
[R4]ip route-static 0.0.0.0 0 192.168.1.18

#设置100M链路的优先级为61

[R4]ip route-static 0.0.0.0 0.0.0.0 192.168.1.22 preference 61
```

R5配置如下：

```bash

#静态路由配置如下
[R5]ip route-static 192.168.1.0 255.255.255.252 192.168.1.17
[R5]ip route-static 192.168.1.4 255.255.255.252 192.168.1.17
[R5]ip route-static 192.168.1.8 255.255.255.252 192.168.1.17
[R5]ip route-static 192.168.1.12 255.255.255.252 192.168.1.17
[R5]ip route-static 192.168.1.32 255.255.255.224 192.168.1.17
[R5]ip route-static 192.168.1.128 255.255.255.224 192.168.1.17
[R5]ip route-static 192.168.1.64 255.255.255.224 192.168.1.17
[R5]ip route-static 192.168.1.96 255.255.255.224 192.168.1.17

#配置100M链路的优先级为61
[R5]ip route-static 192.168.1.0 255.255.255.252 192.168.1.21 preference 61
[R5]ip route-static 192.168.1.4 255.255.255.252 192.168.1.21 preference 61
[R5]ip route-static 192.168.1.8 255.255.255.252 192.168.1.21 preference 61
[R5]ip route-static 192.168.1.12 255.255.255.252 192.168.1.21 preference 61
[R5]ip route-static 192.168.1.32 255.255.255.224 192.168.1.21 preference 61
[R5]ip route-static 192.168.1.128 255.255.255.224 192.168.1.21 preference 61
[R5]ip route-static 192.168.1.64 255.255.255.224 192.168.1.21 preference 61
[R5]ip route-static 192.168.1.96 255.255.255.224 192.168.1.21 preference 61

#！注意R5上的缺省也须配置优先级，不然依然不可到达5.5.5.0的网段

[R5]ip route-static 0.0.0.0 0.0.0.0 192.168.1.21 preference 61
```

到此，完成了所有实验要求，我们尝试用R1去ping通R5的环回，如下：

![](https://i-blog.csdnimg.cn/direct/c36b1070b9a54f8eaa6bb18b714bea80.png)

可以ping通，实验成功~

配置过程中，需要注意每个经过手工汇总的路由后，一定要再配置其手工汇总的空接口。