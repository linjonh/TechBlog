---
layout: post
title: "riscv-rust-是一个用-Rust-编写并编译为-WebAssembly-的RISC-V处理器和外围设备模拟器项目"
date: 2025-03-09 12:17:03 +0800
description: "【代码】riscv-rust 是一个用 Rust 编写并编译为 WebAssembly 的RISC-V处理器和外围设备模拟器项目。"
keywords: "riscv-rust 是一个用 Rust 编写并编译为 WebAssembly 的RISC-V处理器和外围设备模拟器项目"
categories: ['数字电路']
tags: ['Wasm', 'V', 'Rust']
artid: "146130285"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146130285
    alt: "riscv-rust-是一个用-Rust-编写并编译为-WebAssembly-的RISC-V处理器和外围设备模拟器项目"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146130285
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146130285
cover: https://bing.ee123.net/img/rand?artid=146130285
image: https://bing.ee123.net/img/rand?artid=146130285
img: https://bing.ee123.net/img/rand?artid=146130285
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     riscv-rust 是一个用 Rust 编写并编译为 WebAssembly 的RISC-V处理器和外围设备模拟器项目
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="riscvrust_0">
     </a>
     riscv-rust
    </h2>
    <p>
     <a href="https://travis-ci.org/takahirox/riscv-rust" rel="nofollow">
      <img alt="外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传" src="https://img-home.csdnimg.cn/images/20230724024159.png?origin_url=https%3A%2F%2Ftravis-ci.org%2Ftakahirox%2Friscv-rust.svg%3Fbranch%3Dmaster&amp;pos_id=img-C789q8Ll-1741465003233"/>
     </a>
     <br/>
     <a href="https://crates.io/crates/riscv_emu_rust" rel="nofollow">
      <img alt="外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传" src="https://img-home.csdnimg.cn/images/20230724024159.png?origin_url=https%3A%2F%2Fimg.shields.io%2Fcrates%2Fv%2Friscv_emu_rust.svg&amp;pos_id=img-QdS2hq4t-1741465003236"/>
     </a>
     <br/>
     <a href="https://badge.fury.io/js/riscv_emu_rust_wasm" rel="nofollow">
      <img alt="外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传" src="https://img-home.csdnimg.cn/images/20230724024159.png?origin_url=https%3A%2F%2Fbadge.fury.io%2Fjs%2Friscv_emu_rust_wasm.svg&amp;pos_id=img-vrgkVGmT-1741465003237"/>
     </a>
    </p>
    <p>
     riscv-rust is a
     <a href="https://riscv.org/" rel="nofollow">
      RISC-V
     </a>
     processor and peripheral devices emulator project written in Rust and compiled to WebAssembly. You can import RISC-V emulator into your Rust or JavaScript project. Refer to the
     <a href="https://docs.google.com/presentation/d/1qeR6KMSaJTR0ZSa2kLxgcBuc_zBo3l-kYbOpq1Wqmi0/edit?usp=sharing" rel="nofollow">
      Slides
     </a>
     for more detail.
    </p>
    <h3>
     <a id="Online_Demo_8">
     </a>
     Online Demo
    </h3>
    <p>
     You can run Linux or xv6 on the emulator in your browser.
     <a href="https://takahirox.github.io/riscv-rust/wasm/web/index.html" rel="nofollow">
      Online demo is here
     </a>
    </p>
    <h3>
     <a id="Screenshots_12">
     </a>
     Screenshots
    </h3>
    <p>
     <img alt="外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传" src="https://img-home.csdnimg.cn/images/20230724024159.png?origin_url=.%2Fscreenshots%2Fanimation.gif&amp;pos_id=img-1VtO9YJc-1741465003237">
      <br/>
      <img alt="外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传" src="https://img-home.csdnimg.cn/images/20230724024159.png?origin_url=.%2Fscreenshots%2Fdebugger.gif&amp;pos_id=img-wIBaUe5d-1741465003237"/>
     </img>
    </p>
    <h3>
     <a id="Documents_17">
     </a>
     Documents
    </h3>
    <ul>
     <li>
      <a href="https://docs.rs/riscv_emu_rust/0.2.0/riscv_emu_rust/" rel="nofollow">
       Document
      </a>
     </li>
    </ul>
    <h3>
     <a id="Features_21">
     </a>
     Features
    </h3>
    <ul>
     <li>
      Emulate RISC-V processor and peripheral devices
     </li>
     <li>
      Stable as
      <a href="https://risc-v-getting-started-guide.readthedocs.io/en/latest/linux-qemu.html" rel="nofollow">
       Linux
      </a>
      and
      <a href="https://github.com/mit-pdos/xv6-riscv">
       xv6-riscv
      </a>
      run on it
     </li>
     <li>
      Linux OpenSBI and legacy BBL boot support
     </li>
     <li>
      Runnable locally
     </li>
     <li>
      Also runnable in browser with WebAssembly
     </li>
     <li>
      Debugger
     </li>
     <li>
      You can import RISC-V emulator into your Rust or JavaScript project
     </li>
    </ul>
    <h3>
     <a id="InstructionsFeatures_support_status_31">
     </a>
     Instructions/Features support status
    </h3>
    <ul>
     <li class="task-list-item">
      <input checked="true" class="task-list-item-checkbox" disabled="disabled" type="checkbox"/>
      RV32/64I
     </li>
     <li class="task-list-item">
      <input checked="true" class="task-list-item-checkbox" disabled="disabled" type="checkbox"/>
      RV32/64M
     </li>
     <li class="task-list-item">
      <input checked="true" class="task-list-item-checkbox" disabled="disabled" type="checkbox"/>
      RV32/64F (almost)
     </li>
     <li class="task-list-item">
      <input checked="true" class="task-list-item-checkbox" disabled="disabled" type="checkbox"/>
      RV32/64D (almost)
     </li>
     <li class="task-list-item">
      <input class="task-list-item-checkbox" disabled="disabled" type="checkbox"/>
      RV32/64Q
     </li>
     <li class="task-list-item">
      <input checked="true" class="task-list-item-checkbox" disabled="disabled" type="checkbox"/>
      RV32/64A (almost)
     </li>
     <li class="task-list-item">
      <input checked="true" class="task-list-item-checkbox" disabled="disabled" type="checkbox"/>
      RV64C/32C (almost)
     </li>
     <li class="task-list-item">
      <input checked="true" class="task-list-item-checkbox" disabled="disabled" type="checkbox"/>
      RV32/64Zifencei (almost)
     </li>
     <li class="task-list-item">
      <input checked="true" class="task-list-item-checkbox" disabled="disabled" type="checkbox"/>
      RV32/64Zicsr (almost)
     </li>
     <li class="task-list-item">
      <input checked="true" class="task-list-item-checkbox" disabled="disabled" type="checkbox"/>
      CSR (almost)
     </li>
     <li class="task-list-item">
      <input checked="true" class="task-list-item-checkbox" disabled="disabled" type="checkbox"/>
      SV32/39
     </li>
     <li class="task-list-item">
      <input class="task-list-item-checkbox" disabled="disabled" type="checkbox"/>
      SV48
     </li>
     <li class="task-list-item">
      <input checked="true" class="task-list-item-checkbox" disabled="disabled" type="checkbox"/>
      Privileged instructions (almost)
     </li>
     <li class="task-list-item">
      <input class="task-list-item-checkbox" disabled="disabled" type="checkbox"/>
      PMP
     </li>
    </ul>
    <p>
     etc…
    </p>
    <p>
     The emulator supports almost all instructions listed above but some instructions which are not used in Linux or xv6 are not implemented yet. Your contribution is very welcome.
    </p>
    <h3>
     <a id="How_to_import_into_your_Rust_project_52">
     </a>
     How to import into your Rust project
    </h3>
    <p>
     The emulator module is released at
     <a href="https://crates.io/crates/riscv_emu_rust" rel="nofollow">
      crates.io
     </a>
     . Add the following line into Cargo.toml of your Rust project.
    </p>
    <pre><code>[dependencies]
riscv_emu_rust = "0.2.0"
</code></pre>
    <p>
     Refer to
     <a href="https://docs.rs/riscv_emu_rust/0.2.0/riscv_emu_rust/struct.Emulator.html" rel="nofollow">
      Document
     </a>
     for the API.
    </p>
    <h3>
     <a id="How_to_build_core_library_locally_64">
     </a>
     How to build core library locally
    </h3>
    <pre><code class="prism language-sh">$ <span class="token function">git</span> clone https://github.com/takahirox/riscv-rust.git
$ <span class="token builtin class-name">cd</span> riscv-rust
$ <span class="token function">cargo</span> build <span class="token parameter variable">--release</span>
</code></pre>
    <h3>
     <a id="How_to_run_Linux_or_xv6_as_desktop_application_72">
     </a>
     How to run Linux or xv6 as desktop application
    </h3>
    <pre><code class="prism language-sh">$ <span class="token builtin class-name">cd</span> riscv-rust/cli
<span class="token comment"># Run Linux</span>
$ <span class="token function">cargo</span> run <span class="token parameter variable">--release</span> <span class="token punctuation">..</span>/resources/linux/opensbi/fw_payload.elf <span class="token parameter variable">-f</span> <span class="token punctuation">..</span>/resources/linux/rootfs.img
<span class="token comment"># Run xv6</span>
$ <span class="token function">cargo</span> run <span class="token parameter variable">--release</span> <span class="token punctuation">..</span>/resources/xv6/kernel <span class="token parameter variable">-f</span> <span class="token punctuation">..</span>/resources/xv6/fs.img
</code></pre>
    <h3>
     <a id="How_to_run_riscvtests_82">
     </a>
     How to run riscv-tests
    </h3>
    <p>
     Prerequirements
    </p>
    <ul>
     <li>
      Install
      <a href="https://github.com/riscv/riscv-gnu-toolchain">
       riscv-gnu-toolchain
      </a>
     </li>
     <li>
      Install
      <a href="https://github.com/riscv/riscv-tests">
       riscv-tests
      </a>
     </li>
    </ul>
    <pre><code class="prism language-sh">$ <span class="token builtin class-name">cd</span> riscv-rust/cli
$ <span class="token function">cargo</span> run <span class="token variable">$path_to_riscv_tets</span>/isa/rv32ui-p-add <span class="token parameter variable">-n</span>
</code></pre>
    <h3>
     <a id="How_to_import_and_use_WebAssembly_RISCV_emulator_in_a_web_browser_93">
     </a>
     How to import and use WebAssembly RISC-V emulator in a web browser
    </h3>
    <p>
     See
     <a href="https://github.com/takahirox/riscv-rust/tree/master/wasm/web">
      wasm/web
     </a>
    </p>
    <h3>
     <a id="How_to_install_and_use_WebAssembly_RISCV_emulator_npm_package_97">
     </a>
     How to install and use WebAssembly RISC-V emulator npm package
    </h3>
    <p>
     See
     <a href="https://github.com/takahirox/riscv-rust/tree/master/wasm/npm">
      wasm/npm
     </a>
    </p>
    <h3>
     <a id="Links_101">
     </a>
     Links
    </h3>
    <h4>
     <a id="Linux_RISCV_port_103">
     </a>
     Linux RISC-V port
    </h4>
    <p>
     <a href="https://risc-v-getting-started-guide.readthedocs.io/en/latest/linux-qemu.html" rel="nofollow">
      Running 64- and 32-bit RISC-V Linux on QEMU
     </a>
    </p>
    <h4>
     <a id="xv6riscv_107">
     </a>
     xv6-riscv
    </h4>
    <p>
     <a href="https://github.com/mit-pdos/xv6-riscv">
      xv6-riscv
     </a>
     is the RISC-V port of
     <a href="https://pdos.csail.mit.edu/6.828/2019/xv6.html" rel="nofollow">
      xv6
     </a>
     which is UNIX V6 rewritten by MIT for x86 in the current C language.
    </p>
    <h4>
     <a id="Specifications_111">
     </a>
     Specifications
    </h4>
    <ul>
     <li>
      <a href="https://riscv.org/specifications/" rel="nofollow">
       RISC-V ISA
      </a>
     </li>
     <li>
      <a href="https://docs.oasis-open.org/virtio/virtio/v1.1/csprd01/virtio-v1.1-csprd01.html" rel="nofollow">
       Virtio Device
      </a>
     </li>
     <li>
      <a href="http://www.ti.com/lit/ug/sprugp1/sprugp1.pdf" rel="nofollow">
       UART
      </a>
     </li>
     <li>
      <a href="https://sifive.cdn.prismic.io/sifive%2Fc89f6e5a-cf9e-44c3-a3db-04420702dcc1_sifive+e31+manual+v19.08.pdf" rel="nofollow">
       CLINT, PLIC (SiFive E31 Manual)
      </a>
     </li>
     <li>
      <a href="https://sifive.cdn.prismic.io/sifive/0d163928-2128-42be-a75a-464df65e04e0_sifive-interrupt-cookbook.pdf" rel="nofollow">
       SiFive Interrupt Cookbook
      </a>
     </li>
    </ul>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f6c756f67616e747463632f:61727469636c652f64657461696c732f313436313330323835" class_="artid" style="display:none">
 </p>
</div>


