---
layout: post
title: "Java实现MQTT通信发布订阅消息"
date: 2024-08-20 22:17:46 +0800
description: "java实现MQTT的消息发布与订阅_java mqtt"
keywords: "java mqtt"
categories: ['网络编程']
tags: ['后端', '中间件', 'Spring', 'Java', 'Boot']
artid: "141347730"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=141347730
    alt: "Java实现MQTT通信发布订阅消息"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=141347730
featuredImagePreview: https://bing.ee123.net/img/rand?artid=141347730
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Java实现MQTT通信(发布订阅消息)
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <div class="toc">
     <h4>
      文章目录
     </h4>
     <ul>
      <li>
       <a href="#_4" rel="nofollow">
        前言
       </a>
      </li>
      <li>
       <a href="#pom_14" rel="nofollow">
        一、相关pom依赖
       </a>
      </li>
      <li>
       <a href="#_24" rel="nofollow">
        二、相关代码
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#1MQTT_25" rel="nofollow">
          1.MQTT工具类
         </a>
        </li>
        <li>
         <a href="#2MQTT_170" rel="nofollow">
          2.MQTT回调函数
         </a>
        </li>
        <li>
         <a href="#3_231" rel="nofollow">
          3.订阅消息
         </a>
        </li>
        <li>
         <a href="#4_269" rel="nofollow">
          4.发布消息
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a href="#mosquitto_291" rel="nofollow">
        三、安装mosquitto
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#1mosquitto_292" rel="nofollow">
          1.mosquitto简介
         </a>
        </li>
        <li>
         <a href="#2_296" rel="nofollow">
          2.下载
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a href="#MQTTfx_306" rel="nofollow">
        四、安装MQTT.fx
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#1MQTTfx_307" rel="nofollow">
          1.MQTT.fx简介
         </a>
        </li>
        <li>
         <a href="#2_312" rel="nofollow">
          2.下载
         </a>
        </li>
        <li>
         <a href="#3_316" rel="nofollow">
          3.使用
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a href="#java_324" rel="nofollow">
        五、java订阅消息
       </a>
      </li>
      <li>
       <a href="#java_385" rel="nofollow">
        六、java发布消息
       </a>
      </li>
     </ul>
    </div>
    <p>
    </p>
    <hr/>
    <h2>
     <a id="_4">
     </a>
     前言
    </h2>
    <p>
     MQTT是一种
     <strong>
      轻量级的物联网通信协议
     </strong>
     ，基于客户端-服务器的
     <strong>
      消息发布/订阅传输协议
     </strong>
     ，支持QoS级别，适用于低带宽、高延迟的网络环境。它具有精简的协议设计，开放的消息协议，以及广泛应用于物联网(IOT)、M2M通信、消息推送和智能设备等领域。MQTT协议涉及发布者、订阅者和消息代理（Broker）的角色，以及连接、订阅、发布消息的过程，并包含会话保持和心跳机制，确保消息的可靠传输。
    </p>
    <p>
     MQTT最大优点在于，
     <strong>
      可以以极少的代码和有限的带宽
     </strong>
     ，为连接远程设备提供实时可靠的消息服务。作为一种低开销、低带宽占用的即时通讯协议，使其在物联网、小型设备、移动应用等方面有较广泛的应用。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/10a04029c9a54f719f6081df72bd2787.png"/>
    </p>
    <hr/>
    <p>
     以下为使用Springboot实现MQTT发布订阅消息相关代码：
    </p>
    <h2>
     <a id="pom_14">
     </a>
     一、相关pom依赖
    </h2>
    <pre><code class="prism language-xml">        <span class="token comment">&lt;!-- MQTT --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.integration<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-integration-mqtt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <h2>
     <a id="_24">
     </a>
     二、相关代码
    </h2>
    <h3>
     <a id="1MQTT_25">
     </a>
     1.MQTT工具类
    </h3>
    <pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>eclipse<span class="token punctuation">.</span>paho<span class="token punctuation">.</span>client<span class="token punctuation">.</span>mqttv3<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>eclipse<span class="token punctuation">.</span>paho<span class="token punctuation">.</span>client<span class="token punctuation">.</span>mqttv3<span class="token punctuation">.</span>persist<span class="token punctuation">.</span></span><span class="token class-name">MemoryPersistence</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span></span><span class="token punctuation">;</span>
 
<span class="token comment">/**
 * MQTT工具类
 */</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MQTTConnect</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token constant">HOST</span> <span class="token operator">=</span> <span class="token string">"tcp://127.0.0.1:1883"</span><span class="token punctuation">;</span> <span class="token comment">//mqtt服务器的地址和端口号</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> clientId <span class="token operator">=</span> <span class="token string">"Test"</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> username <span class="token operator">=</span> <span class="token string">"test"</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> password <span class="token operator">=</span> <span class="token string">"123456"</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">MqttClient</span> mqttClient<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 测试订阅消息
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">MQTTConnect</span> mqttConnect <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MQTTConnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mqttConnect<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//订阅消息</span>
        mqttConnect<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span><span class="token string">"/topic/#"</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">MqttException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// host为主机名，clientid即连接MQTT的客户端ID，一般以唯一标识符表示，MemoryPersistence设置clientid的保存形式，默认为以内存保存</span>
        mqttClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MqttClient</span><span class="token punctuation">(</span><span class="token constant">HOST</span><span class="token punctuation">,</span> clientId <span class="token operator">+</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">MemoryPersistence</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// MQTT的连接设置</span>
        <span class="token class-name">MqttConnectOptions</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MqttConnectOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        options<span class="token punctuation">.</span><span class="token function">setUserName</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
        options<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span>password<span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 设置超时时间 单位为秒</span>
        options<span class="token punctuation">.</span><span class="token function">setConnectionTimeout</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">///默认：30</span>
        <span class="token comment">// 设置是否清空session,这里如果设置为false表示服务器会保留客户端的连接记录，设置为true表示每次连接到服务器都以新的身份连接</span>
        options<span class="token punctuation">.</span><span class="token function">setCleanSession</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//默认：true</span>
        <span class="token comment">// 设置断开后重新连接(设置为true时将启用自动重新连接)</span>
        options<span class="token punctuation">.</span><span class="token function">setAutomaticReconnect</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//默认：false</span>
        <span class="token comment">// 设置会话心跳时间 单位为秒 服务器会每隔1.5*20秒的时间向客户端发送个消息判断客户端是否在线，但这个方法并没有重连的机制</span>
        options<span class="token punctuation">.</span><span class="token function">setKeepAliveInterval</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//默认：60</span>
        <span class="token comment">// 设置回调</span>
        mqttClient<span class="token punctuation">.</span><span class="token function">setCallback</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mqttClient<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 自定义mqtt连接
     * @param host
     * @param clientId
     * @param userName
     * @param passWord
     * @param connectionTimeout
     * @param cleanSession
     * @param automaticReconnect
     * @param keepAliveInterval
     * @param mqttCallback
     * @throws MqttException
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token class-name">String</span> host<span class="token punctuation">,</span><span class="token class-name">String</span> clientId<span class="token punctuation">,</span> <span class="token class-name">String</span> userName<span class="token punctuation">,</span> <span class="token class-name">String</span> passWord<span class="token punctuation">,</span>
                      <span class="token keyword">int</span> connectionTimeout<span class="token punctuation">,</span> <span class="token keyword">boolean</span> cleanSession<span class="token punctuation">,</span><span class="token keyword">boolean</span> automaticReconnect<span class="token punctuation">,</span>
                      <span class="token keyword">int</span> keepAliveInterval<span class="token punctuation">,</span><span class="token class-name">MqttCallback</span> mqttCallback<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">MqttException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// host为主机名，clientid即连接MQTT的客户端ID，一般以唯一标识符表示，MemoryPersistence设置clientid的保存形式，默认为以内存保存</span>
        mqttClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MqttClient</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> clientId <span class="token operator">+</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">MemoryPersistence</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// MQTT的连接设置</span>
        <span class="token class-name">MqttConnectOptions</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MqttConnectOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        options<span class="token punctuation">.</span><span class="token function">setUserName</span><span class="token punctuation">(</span>userName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        options<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span>passWord<span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 设置超时时间 单位为秒</span>
        options<span class="token punctuation">.</span><span class="token function">setConnectionTimeout</span><span class="token punctuation">(</span>connectionTimeout<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">///默认：30</span>
        <span class="token comment">// 设置是否清空session,这里如果设置为false表示服务器会保留客户端的连接记录，设置为true表示每次连接到服务器都以新的身份连接</span>
        options<span class="token punctuation">.</span><span class="token function">setCleanSession</span><span class="token punctuation">(</span>cleanSession<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//默认：true</span>
        <span class="token comment">// 设置断开后重新连接(设置为true时将启用自动重新连接)</span>
        options<span class="token punctuation">.</span><span class="token function">setAutomaticReconnect</span><span class="token punctuation">(</span>automaticReconnect<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//默认：false</span>
        <span class="token comment">// 设置会话心跳时间 单位为秒 服务器会每隔1.5*20秒的时间向客户端发送个消息判断客户端是否在线，但这个方法并没有重连的机制</span>
        options<span class="token punctuation">.</span><span class="token function">setKeepAliveInterval</span><span class="token punctuation">(</span>keepAliveInterval<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//默认：60</span>
        <span class="token comment">// 设置回调</span>
        mqttClient<span class="token punctuation">.</span><span class="token function">setCallback</span><span class="token punctuation">(</span>mqttCallback<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mqttClient<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token comment">/**
     * 关闭MQTT连接
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">MqttException</span> <span class="token punctuation">{<!-- --></span>
        mqttClient<span class="token punctuation">.</span><span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mqttClient<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token comment">/**
     * 向某个主题发布消息 默认qos：1
     *
     * @param topic:发布的主题
     * @param msg：发布的消息
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">pub</span><span class="token punctuation">(</span><span class="token class-name">String</span> topic<span class="token punctuation">,</span> <span class="token class-name">String</span> msg<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">MqttException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">MqttMessage</span> mqttMessage <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MqttMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//mqttMessage.setQos(2);</span>
        mqttMessage<span class="token punctuation">.</span><span class="token function">setPayload</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">MqttTopic</span> mqttTopic <span class="token operator">=</span> mqttClient<span class="token punctuation">.</span><span class="token function">getTopic</span><span class="token punctuation">(</span>topic<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">MqttDeliveryToken</span> token <span class="token operator">=</span> mqttTopic<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span>mqttMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
        token<span class="token punctuation">.</span><span class="token function">waitForCompletion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token comment">/**
     * 向某个主题发布消息
     *
     * @param topic: 发布的主题
     * @param msg:   发布的消息
     * @param qos:   消息质量    Qos：0、1、2
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">pub</span><span class="token punctuation">(</span><span class="token class-name">String</span> topic<span class="token punctuation">,</span> <span class="token class-name">String</span> msg<span class="token punctuation">,</span> <span class="token keyword">int</span> qos<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">MqttException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">MqttMessage</span> mqttMessage <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MqttMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mqttMessage<span class="token punctuation">.</span><span class="token function">setQos</span><span class="token punctuation">(</span>qos<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mqttMessage<span class="token punctuation">.</span><span class="token function">setPayload</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">MqttTopic</span> mqttTopic <span class="token operator">=</span> mqttClient<span class="token punctuation">.</span><span class="token function">getTopic</span><span class="token punctuation">(</span>topic<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">MqttDeliveryToken</span> token <span class="token operator">=</span> mqttTopic<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span>mqttMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
        token<span class="token punctuation">.</span><span class="token function">waitForCompletion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token comment">/**
     * 订阅某一个主题 ，此方法默认的的Qos等级为：1
     *
     * @param topic 主题
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sub</span><span class="token punctuation">(</span><span class="token class-name">String</span> topic<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">MqttException</span> <span class="token punctuation">{<!-- --></span>
        mqttClient<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>topic<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token comment">/**
     * 订阅某一个主题，可携带Qos
     *
     * @param topic 所要订阅的主题
     * @param qos   消息质量：0、1、2
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sub</span><span class="token punctuation">(</span><span class="token class-name">String</span> topic<span class="token punctuation">,</span> <span class="token keyword">int</span> qos<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">MqttException</span> <span class="token punctuation">{<!-- --></span>
        mqttClient<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>topic<span class="token punctuation">,</span> qos<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="2MQTT_170">
     </a>
     2.MQTT回调函数
    </h3>
    <pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>eclipse<span class="token punctuation">.</span>paho<span class="token punctuation">.</span>client<span class="token punctuation">.</span>mqttv3<span class="token punctuation">.</span></span><span class="token class-name">IMqttDeliveryToken</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>eclipse<span class="token punctuation">.</span>paho<span class="token punctuation">.</span>client<span class="token punctuation">.</span>mqttv3<span class="token punctuation">.</span></span><span class="token class-name">MqttCallback</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>eclipse<span class="token punctuation">.</span>paho<span class="token punctuation">.</span>client<span class="token punctuation">.</span>mqttv3<span class="token punctuation">.</span></span><span class="token class-name">MqttMessage</span></span><span class="token punctuation">;</span>
 
<span class="token comment">/**
 * 常规MQTT回调函数
 * MqttCallback 接口定义了用于处理 MQTT 客户端异步事件的方法。
 * 当使用 Eclipse Paho MQTT 客户端库时，你可以实现这个接口来接收连接状态的变化和消息传递的通知。
 */</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Callback</span> <span class="token keyword">implements</span> <span class="token class-name">MqttCallback</span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">/**
     * MQTT 断开连接会执行此方法
     *
     * 方法说明：当客户端与 MQTT 服务器之间的连接丢失时，此方法被调用。
     * @param throwable 表示导致连接丢失的原因，通常为一个 Throwable 对象
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">connectionLost</span><span class="token punctuation">(</span><span class="token class-name">Throwable</span> throwable<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"断开了MQTT连接 ：{}"</span><span class="token punctuation">,</span> throwable<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>throwable<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> throwable<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * publish发布成功后会执行到这里
     *
     * 方法说明：当一个消息的交付完成并且所有必要的确认都已收到时，此方法被调用。
     * 注意事项：
     * 对于 QoS 0 消息，在消息被网络层接收后会调用此方法。
     * 对于 QoS 1 消息，在接收到 PUBACK 包后调用此方法。
     * 对于 QoS 2 消息，在接收到 PUBCOMP 包后调用此方法。
     * @param iMqttDeliveryToken the delivery token associated with the message.
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deliveryComplete</span><span class="token punctuation">(</span><span class="token class-name">IMqttDeliveryToken</span> iMqttDeliveryToken<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"发布消息成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 

    <span class="token comment">/**
     * subscribe订阅后得到的消息会执行到这里
     *
     * 方法说明：当从服务器接收到一条新消息时，此方法被调用
     * 注意事项：
     * 在此方法中抛出任何异常将会导致客户端关闭，并且未确认的消息可能会被重新发送。
     * 如果在此方法执行期间有其他消息到达，它们将被缓存直到此方法返回。
     * @param topic 消息发布的主题名称
     * @param message 实际的消息内容，类型为 MqttMessage
     * @throws Exception
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">messageArrived</span><span class="token punctuation">(</span><span class="token class-name">String</span> topic<span class="token punctuation">,</span> <span class="token class-name">MqttMessage</span> message<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//  TODO    此处可以将订阅得到的消息进行业务处理、数据存储</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"收到来自 "</span> <span class="token operator">+</span> topic <span class="token operator">+</span> <span class="token string">" 的消息：{}"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">getPayload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="3_231">
     </a>
     3.订阅消息
    </h3>
    <pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>eclipse<span class="token punctuation">.</span>paho<span class="token punctuation">.</span>client<span class="token punctuation">.</span>mqttv3<span class="token punctuation">.</span></span><span class="token class-name">MqttException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">ApplicationListener</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>event<span class="token punctuation">.</span></span><span class="token class-name">ContextRefreshedEvent</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span></span><span class="token punctuation">;</span>
 
<span class="token comment">/**
 * 项目启动 监听主题
 */</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MQTTListener</span> <span class="token keyword">implements</span> <span class="token class-name">ApplicationListener</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ContextRefreshedEvent</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{<!-- --></span>
 
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">MQTTConnect</span> server<span class="token punctuation">;</span>
 
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token class-name">MQTTListener</span><span class="token punctuation">(</span><span class="token class-name">MQTTConnect</span> server<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>server <span class="token operator">=</span> server<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onApplicationEvent</span><span class="token punctuation">(</span><span class="token class-name">ContextRefreshedEvent</span> contextRefreshedEvent<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            server<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            server<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span><span class="token string">"/topic/#"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"-----------消息订阅成功-----------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"-----------消息订阅失败-----------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="4_269">
     </a>
     4.发布消息
    </h3>
    <pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestParam</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MqttTestController</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">MQTTConnect</span> mqttConnect<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"mqttTest01"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"msg"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> msg<span class="token punctuation">,</span>
                     <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"topic"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> topic<span class="token punctuation">,</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"qos"</span><span class="token punctuation">)</span> <span class="token keyword">int</span> qos<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        mqttConnect<span class="token punctuation">.</span><span class="token function">pub</span><span class="token punctuation">(</span>topic<span class="token punctuation">,</span> msg<span class="token punctuation">,</span>qos<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h2>
     <a id="mosquitto_291">
     </a>
     三、安装mosquitto
    </h2>
    <h3>
     <a id="1mosquitto_292">
     </a>
     1.mosquitto简介
    </h3>
    <p>
     Mosquitto是用C语言实现MQTT协议的Broker。是一款实现了消息推送协议 MQTT v3.1 的开源消息代理软件，提供轻量级的，支持可发布/可订阅的的消息推送模式，使设备对设备之间的短消息通信变得简单，比如现在应用广泛的低功耗传感器，手机、嵌入式计算机、微型控制器等移动设备。一个典型的应用案例就是 Andy Stanford-ClarkMosquitto(MQTT协议创始人之一)在家中实现的远程监控和自动化。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/4bf502ccf3634d22b6a4f07421811433.png"/>
    </p>
    <h3>
     <a id="2_296">
     </a>
     2.下载
    </h3>
    <p>
     官网：https://mosquitto.org/download/
    </p>
    <p>
     百度网盘：https://pan.baidu.com/s/1nOECYW3hrigcrhbQlcZU_Q?pwd=1234
    </p>
    <p>
     <code>
      本文中使用mosquitto当MQTT Broker来处理客户端发布或订阅的消息。
     </code>
    </p>
    <p>
     下载完安装一直点击next即可，需要注意的是安装完成后打开服务查看mosquitto是否启动(可能会出现端口冲突导致启动失败)
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/a6d9c184ab9148e4b7dd170199447a31.png"/>
    </p>
    <h2>
     <a id="MQTTfx_306">
     </a>
     四、安装MQTT.fx
    </h2>
    <h3>
     <a id="1MQTTfx_307">
     </a>
     1.MQTT.fx简介
    </h3>
    <p>
     MQTT.fx是一个基于Eclipse Paho用Java编写的MQTT客户端软件。支持通过Topic订阅和发布消息，用来前期模拟设备和物理云平台等调试。
    </p>
    <p>
     <code>
      本文中使用MQTT.fx来模拟设备发送消息
     </code>
    </p>
    <h3>
     <a id="2_312">
     </a>
     2.下载
    </h3>
    <p>
     官网暂时无法打开
     <br/>
     百度云盘：https://pan.baidu.com/s/1txsSLKHi5IqUb1HooOHT-g?pwd=1234
    </p>
    <h3>
     <a id="3_316">
     </a>
     3.使用
    </h3>
    <p>
     下载完安装一直点击next即可，安装成功后先编辑连接信息
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/0364252ff21142fc90e804e27027b8cf.png">
      <br/>
      编辑连接
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/550215c07c9e4eb0b300d5d875bae968.png">
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/b8971e398b2c40b0a4a4214e940e9290.png">
        <br/>
        主界面
        <br/>
        <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/53085cec0bde45f38059f7f61466eef9.png"/>
       </img>
      </img>
     </img>
    </p>
    <h2>
     <a id="java_324">
     </a>
     五、java订阅消息
    </h2>
    <p>
     启动java程序
    </p>
    <pre><code class="prism language-java">	<span class="token comment">/**
     * 测试订阅消息
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">MQTTConnect</span> mqttConnect <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MQTTConnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mqttConnect<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//订阅消息</span>
        mqttConnect<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span><span class="token string">"/topic/#"</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
    <p>
     点击发送消息
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/8304b4f337234fc6bcee7b80b7c813e4.png">
      <br/>
      java输出台
     </img>
    </p>
    <pre><code>19:55:13.276 [MQTT Call: Test] INFO com.xxx.mqtt.Callback - 收到来自 /topic/qf 的消息：hello my name is qf
</code></pre>
    <p>
     也可以点击脚步进行编辑要持续发送的消息。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/a30c8294d8cf4a4f8b8425ae099931d5.png"/>
    </p>
    <p>
     JS脚本代码
    </p>
    <pre><code class="prism language-js"><span class="token keyword">var</span> Thread <span class="token operator">=</span> Java<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">"java.lang.Thread"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token parameter">action</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">out</span><span class="token punctuation">(</span><span class="token string">"Test Script: "</span> <span class="token operator">+</span> action<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">switchON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">switchOFF</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    action<span class="token punctuation">.</span><span class="token function">setExitCode</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    action<span class="token punctuation">.</span><span class="token function">setResultText</span><span class="token punctuation">(</span><span class="token string">"done."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">out</span><span class="token punctuation">(</span><span class="token string">"Test Script: Done"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> action<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">switchON</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">out</span><span class="token punctuation">(</span><span class="token string">"fountain ON"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    mqttManager<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token string">"/topic/qf"</span><span class="token punctuation">,</span> <span class="token string">"message01"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">switchOFF</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">out</span><span class="token punctuation">(</span><span class="token string">"fountain OFF"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    mqttManager<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token string">"/topic/qf"</span><span class="token punctuation">,</span> <span class="token string">"message02"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">out</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
     output<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/8d4d0a9d87b840968f1c0f8423932c5c.png"/>
    </p>
    <p>
     本文只简单介绍使用，如果需要了解更多MQTT.fx相关内容，可以查看以下的文章：
     <br/>
     https://blog.csdn.net/qq_33406883/article/details/107492604
    </p>
    <h2>
     <a id="java_385">
     </a>
     六、java发布消息
    </h2>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/7a6972ffd9344949b17493e86b814433.png"/>
    </p>
    <p>
     启动springboot项目，通过接口发布消息，
     <br/>
     http://127.0.0.1:8080/mqttTest01?topic=/topic/qf&amp;msg=hello qf !&amp;qos=0
    </p>
    <p>
     MQTT.fx即可收到消息
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/a5429db3c1b847f8aecef60ee19a6c62.png"/>
    </p>
    <hr/>
    <p>
     参考文章：
     <a href="https://blog.csdn.net/qq_37949192/article/details/103962848">
      java连接MQTT服务器(Springboot整合MQTT)
     </a>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34363432353636312f:61727469636c652f64657461696c732f313431333437373330" class_="artid" style="display:none">
 </p>
</div>


