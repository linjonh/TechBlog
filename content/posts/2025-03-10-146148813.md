---
layout: post
title: "基于parted-Linux-LVM实现多磁盘动态分配"
date: 2025-03-10 11:29:11 +0800
description: "::info一般，服务器会有多个硬盘，一块硬盘分区安装操作系统，另外多块硬盘分区做存储使用。该文档通过使用parted和LVM组合的形式_实现大于2TiB的动态磁盘分配_教学。"
keywords: "基于parted + Linux LVM实现多磁盘动态分配"
categories: ['未分类']
tags: ['运维', '服务器', 'Linux']
artid: "146148813"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146148813
    alt: "基于parted-Linux-LVM实现多磁盘动态分配"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146148813
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146148813
cover: https://bing.ee123.net/img/rand?artid=146148813
image: https://bing.ee123.net/img/rand?artid=146148813
img: https://bing.ee123.net/img/rand?artid=146148813
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     基于parted + Linux LVM实现多磁盘动态分配
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     :::info
     <br/>
     一般，服务器会有多个硬盘，一块硬盘分区安装操作系统，另外多块硬盘分区做存储使用。该文档通过使用parted和LVM组合的形式_
     <strong>
      实现大于2TiB的动态磁盘分配
     </strong>
     _教学。
    </p>
    <p>
     :::
    </p>
    <h2>
     <a id="2TiB_5">
     </a>
     一、新建（&gt;2TiB）
    </h2>
    <h3>
     <a id="11_6">
     </a>
     1.1查看磁盘
    </h3>
    <pre><code class="prism language-shell">lsblk
</code></pre>
    <p>
     如下图所示 ，有新增磁盘
     <em>
      <strong>
       <u>
        vdb
       </u>
      </strong>
      __
     </em>
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/6f2c3518a0245a2a9dbf111534f3b896.png"/>
    </p>
    <h3>
     <a id="12vdbvdb_15">
     </a>
     1.2、对vdb磁盘进行分区（实际不一定是vdb）
    </h3>
    <pre><code class="prism language-shell"><span class="token function">parted</span> /dev/vdb
mklabel gpt
mkpart primary <span class="token number">0</span>% <span class="token number">100</span>%
<span class="token builtin class-name">set</span> <span class="token number">1</span> lvm on
quit
</code></pre>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/ebef6783cad5ebb89de8b8c905cfebe7.png"/>
    </p>
    <h3>
     <a id="13pv_26">
     </a>
     1.3、创建pv
    </h3>
    <pre><code class="prism language-shell">pvcreate /dev/vdb1
</code></pre>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/fe6334e10a619914d0dcf64664f63498.png"/>
    </p>
    <h3>
     <a id="14vg_33">
     </a>
     1.4、创建vg
    </h3>
    <pre><code class="prism language-shell">vgcreate data /dev/vdb1
</code></pre>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/c1468f452aeee1f781f7efc451d661af.png"/>
    </p>
    <h3>
     <a id="15vg_40">
     </a>
     1.5、查看vg
    </h3>
    <pre><code class="prism language-shell">vgdisplay data <span class="token parameter variable">-v</span>
</code></pre>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/791b9613cb526809afd847c21dae0731.png"/>
    </p>
    <h3>
     <a id="16lv_47">
     </a>
     1.6、创建lv
    </h3>
    <pre><code class="prism language-shell">lvcreate <span class="token parameter variable">-l</span> <span class="token number">100</span>%FREE <span class="token parameter variable">-n</span> data_1 data
</code></pre>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/26113dd239bde97c1833204469b47957.png"/>
    </p>
    <h3>
     <a id="17lv_54">
     </a>
     1.7、查看lv状态
    </h3>
    <pre><code class="prism language-shell">lvdisplay data <span class="token parameter variable">-v</span>
</code></pre>
    <p>
     :::info
     <br/>
     下图中LV Path行表示逻辑卷目录（后面挂载的时候用得到）
    </p>
    <p>
     :::
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/c00628530538d581d85faaf334f4f54c.png"/>
    </p>
    <h3>
     <a id="18lv_66">
     </a>
     1.8、格式化lv
    </h3>
    <pre><code class="prism language-shell">mkfs.ext4 /dev/data/data_1
</code></pre>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/ede6b507fa9928ee2729af5e2aab650b.png"/>
    </p>
    <h3>
     <a id="19_73">
     </a>
     1.9、创建磁盘开机挂载
    </h3>
    <pre><code class="prism language-shell"><span class="token function">vim</span> /etc/fstab
</code></pre>
    <pre><code class="prism language-plain">/dev/data/data_1 /app ext4 defaults 0 0
</code></pre>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/68e2cb7a9f5c90decba4b6936e4e775e.png"/>
    </p>
    <pre><code class="prism language-shell"><span class="token function">mount</span> <span class="token parameter variable">-a</span>
</code></pre>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/36cb93841b6de229645046f8dd604124.png"/>
    </p>
    <pre><code class="prism language-shell"><span class="token function">df</span> <span class="token parameter variable">-Th</span>
</code></pre>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/52a948dc3067b2b44359f960b7f954e0.png"/>
    </p>
    <h2>
     <a id="_96">
     </a>
     二、扩容
    </h2>
    <p>
     :::info
     <br/>
     扩容开始前请先按照新建教程中的步骤，使用parted对新磁盘进行分区并修改磁盘格式为"Linux LVM"，此处以sdc磁盘为例演示分区过后的操作
    </p>
    <p>
     :::
    </p>
    <h3>
     <a id="21_102">
     </a>
     2.1、创建物理卷（在这之前先按照教程进行磁盘分区）
    </h3>
    <pre><code class="prism language-shell">pvcreate /dev/sdc1
</code></pre>
    <pre><code class="prism language-shell">pvdisplay
</code></pre>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/aca084ec106224e3a1bc5f1d5376655d.png"/>
    </p>
    <h3>
     <a id="22sdc1__ufont_stylecolorDF2A3Fdatafontu__font_stylecolorDF2A3F_font__113">
     </a>
     2.2、将新创建的逻辑卷（sdc1）加入到 _
     <u>
      data
     </u>
     __ _卷组中
    </h3>
    <p>
     :::info
     <br/>
     如果新建是按照此文档前半部分操作的 ，卷组名称一定是data
    </p>
    <p>
     :::
    </p>
    <pre><code class="prism language-shell">vgextend data /dev/sdc1
vgdisplay data
</code></pre>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/6dd33c871b5f6da7018d1bcb90d8ec93.png"/>
    </p>
    <pre><code class="prism language-shell">lvextend <span class="token parameter variable">-l</span> +100%FREE /dev/data/data_1
resize2fs /dev/data/data_1	<span class="token comment">#ext4</span>
xfs_growfs /dev/data/data_1	<span class="token comment">#xfs</span>
</code></pre>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/3378bc0e3716522d460833b45750c002.png"/>
    </p>
    <h3>
     <a id="23_136">
     </a>
     2.3、扩容前后对比
    </h3>
    <pre><code class="prism language-shell"><span class="token function">df</span> <span class="token parameter variable">-Th</span>
</code></pre>
    <p>
     扩容前：
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/b1a912c58e63f2ec0db1e3932701f715.png"/>
    </p>
    <p>
     扩容后：
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/8a5331004a2531a34d0170050c7773ca.png"/>
    </p>
    <p>
     :::info
     <br/>
     至此 ，磁盘扩容完毕
    </p>
    <p>
     :::
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f35333538373236312f:61727469636c652f64657461696c732f313436313438383133" class_="artid" style="display:none">
 </p>
</div>


