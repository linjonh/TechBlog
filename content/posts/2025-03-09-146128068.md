---
arturl_encode: "68747470733a2f2f62:6c6f672e6373646e2e6e65742f44323436303539363432312f:61727469636c652f64657461696c732f313436313238303638"
layout: post
title: "åˆè¯†Bert"
date: 2025-03-09 15:40:42 +08:00
description: "åœ¨å­¦ä¹ Bertä¹‹å‰æˆ‘ä»¬å…ˆäº†è§£â€œé€’å½’ç¥ç»ç½‘ç»œï¼ˆRNNå’Œ â€œé•¿çŸ­æœŸè®°å¿†ï¼ˆLSTM)â€æˆ‘ä»¬å¦‚æœä»…ä»…è¯†åˆ«æ¯ä¸ªå­—çš„å«ä¹‰ï¼Œé‚£ä¹ˆåœ¨ä¸€å¥è¯ä¸­æ²¡æœ‰ç›¸åŒçš„å­—è¿˜æ˜¯å¯ä»¥çš„ä½†æ˜¯å¦‚æœä¸€å¥è¯ä¸­æœ‰ç›¸åŒçš„å­—ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿›ä¸èƒ½è¯†åˆ«æ¯ä¸ªå­—çš„å«ä¹‰ï¼Œå› ä¸ºæœ‰å¯èƒ½ç›¸åŒçš„å­—ï¼Œä½ç½®ä¸ä¸€æ ·ï¼Œè¯æ€§ä¹Ÿä¸ä¸€æ ·ï¼Œé‚£ä¹ˆå«ä¹‰å°±ä¼šä¸ä¸€æ ·ã€‚å› æ­¤å°±å¼•å‡ºäº† é€’å½’ç¥ç»ç½‘ç»œï¼ˆRNNå’Œé•¿çŸ­æœŸè®°å¿†ï¼ˆLSTMã€‚"
keywords: "åˆè¯†Bert"
categories: ['æœªåˆ†ç±»']
tags: ['æ·±åº¦å­¦ä¹ ', 'Lstm', 'Bert']
artid: "146128068"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146128068
    alt: "åˆè¯†Bert"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146128068
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146128068
cover: https://bing.ee123.net/img/rand?artid=146128068
image: https://bing.ee123.net/img/rand?artid=146128068
img: https://bing.ee123.net/img/rand?artid=146128068
---

# åˆè¯†Bert

åœ¨å­¦ä¹ Bertä¹‹å‰æˆ‘ä»¬å…ˆäº†è§£â€œé€’å½’ç¥ç»ç½‘ç»œï¼ˆRNN


Recurrent neural network)â€
å’Œ â€œé•¿çŸ­æœŸè®°å¿†ï¼ˆLSTM
Long short-term memory
)â€

æˆ‘ä»¬å¦‚æœä»…ä»…è¯†åˆ«æ¯ä¸ªå­—çš„å«ä¹‰ï¼Œé‚£ä¹ˆåœ¨ä¸€å¥è¯ä¸­æ²¡æœ‰ç›¸åŒçš„å­—è¿˜æ˜¯å¯ä»¥çš„ä½†æ˜¯å¦‚æœä¸€å¥è¯ä¸­æœ‰ç›¸åŒçš„å­—ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿›ä¸èƒ½è¯†åˆ«æ¯ä¸ªå­—çš„å«ä¹‰ï¼Œå› ä¸ºæœ‰å¯èƒ½ç›¸åŒçš„å­—ï¼Œä½ç½®ä¸ä¸€æ ·ï¼Œè¯æ€§ä¹Ÿä¸ä¸€æ ·ï¼Œé‚£ä¹ˆå«ä¹‰å°±ä¼šä¸ä¸€æ ·ã€‚

![](https://i-blog.csdnimg.cn/direct/491986e1644f44fd9ecb18deef929013.png)

![](https://i-blog.csdnimg.cn/direct/f1e01f07678c45bfb18a643a3c40b6dc.png)

å› æ­¤å°±å¼•å‡ºäº† é€’å½’ç¥ç»ç½‘ç»œï¼ˆRNN


Recurrent neural network)
å’Œé•¿çŸ­æœŸè®°å¿†ï¼ˆLSTM
Long short-term memory
)

### é€’å½’ç¥ç»ç½‘ç»œ

RNNå°±æ˜¯åœ¨ä¼ å…¥æ¨¡å‹çš„æ—¶å€™ï¼Œä¹Ÿä¼ å…¥ä¸€ä¸ªå‘é‡ï¼Œå°±æ˜¯ä¸€ä¸ªè®°å¿†å•å…ƒï¼Œæˆ‘ä»¬å¯ä»¥å½¢è±¡çš„ç§°ä¸ºâ€œä¼ å®¶å®â€ï¼Œå› ä¸ºä¼ å®¶å®ä¼šä¸€ç›´ä¸²è¡Œçš„ä¼ ä¸‹å»è¿™æ ·å°±èƒ½ã€‚æœ‰äº†è¿™ä¸ªä¼ å®¶å®ï¼Œå°±å¯ä»¥æ ¹æ®ä¸Šæ–‡åˆ¤æ–­å½“å‰æ–‡å­—çš„è¯æ€§ã€‚

![](https://i-blog.csdnimg.cn/direct/0316c093d20247a6a814222d386e8a6d.png)

å› ä¸ºæ˜¯ä¸²è¡Œä¼ é€’ï¼Œå¦‚æœä¸€å¥è¯å¾ˆé•¿ï¼Œè¿™ä¹Ÿå¯¼è‡´RRNæ¨¡å‹ä¸­è®°å¿†å•å…ƒä¹Ÿå°±æ˜¯â€œä¼ å®¶å®â€ä¸­è®°å½•çš„ä¸œè¥¿è¿‡å¤šï¼Œå¯¼è‡´æœ€å‰é¢çš„ä¿¡æ¯å’Œæœ€åé¢çš„ä¿¡æ¯å¾ˆéš¾å¯¹åº”ï¼Œå¦‚ï¼š

![](https://i-blog.csdnimg.cn/direct/123a1e8ff4844b9e812f91e6721bd1b9.png)

å½“æˆ‘ä»¬é—®â€œ
è°ä¸èµ›ç½•å¡”æ‹‰ç»“ä¸‹äº†ä¸è§£ä¹‹ç¼˜ï¼Ÿâ€æ—¶ï¼Œâ€œä¼ å®¶å®â€é‡Œçš„ä¸œè¥¿å·²ç»è®°å½•å‰é¢çš„å¤ªå¤šä¿¡æ¯äº†ï¼Œæ— æ³•å‡†ç¡®çš„æ‰¾åˆ°ä¸»è¯­â€œæˆ‘â€ã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå› æ­¤å¼•å‡º
â€œé•¿çŸ­æœŸè®°å¿†ï¼ˆLSTM
Long short-term memory
)â€æ¨¡å‹ã€‚

### é•¿çŸ­æœŸè®°å¿†

LSTMæ¨¡å‹å°±æ˜¯ï¼Œè¿˜æ˜¯é‚£ä¸Šé¢çš„ä¾‹å­ï¼Œé—®â€œ
è°ä¸èµ›ç½•å¡”æ‹‰ç»“ä¸‹äº†ä¸è§£ä¹‹ç¼˜ï¼Ÿâ€æ—¶ï¼Œæˆ‘ä»¬å°±ä¼šæŠŠâ€œä¼ å®¶å®â€ä¸Šé”ï¼Œä¸ä¼šè®©ä¸­é—´æ— å…³ç´§è¦çš„ä¿¡æ¯è¿›å…¥â€œä¼ å®¶å®â€ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½åœ¨â€œä¼ å®¶å®â€å½“ä¸­æ‰¾åˆ°æˆ‘ä»¬æƒ³è¦çš„ç­”æ¡ˆã€‚

![](https://i-blog.csdnimg.cn/direct/c4bbd23015ae4d5d91c26045ce32efef.png)

### è‡ªæ³¨æ„åŠ›æœºåˆ¶

é€šè¿‡å­¦ä¹ RNNå’ŒLSTMæ¨¡å‹ï¼Œè™½ç„¶é—®é¢˜å·²ç»è§£å†³ï¼Œä½†æ˜¯é€Ÿåº¦è¿˜æ˜¯å¤ªæ…¢äº†ï¼Œå…ˆè¾ˆçš„å·¨äººä»¬å°±åˆ›é€ äº†Bartæ¨¡å‹ï¼Œåœ¨å­¦ä¹ Bartæ¨¡å‹å‰ï¼Œæˆ‘ä»¬è¦å…ˆäº†è§£è‡ªæ³¨æ„åŠ›æœºåˆ¶(Self-attention)

æ‰€è°“çš„æ³¨æ„åŠ›æœºåˆ¶å°±æ˜¯
æ˜¯ä¸€ä¸ªç‰¹å¾è½¬æ¢å™¨ï¼Œè€ƒè™‘äº†å¥å­æ•´ä½“çš„å‰åå…³ç³»ã€‚
æ³¨æ„åŠ›æœºåˆ¶å¯ä»¥è®©æ¨¡å‹åœ¨ç”Ÿæˆæ¯ä¸ªç›®æ ‡è¯çš„æ—¶å€™ï¼Œé€‰æ‹©æ€§åœ°â€œå…³æ³¨â€æºå¥å­ä¸­ç›¸å…³è”çš„éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯ç­‰åŒå¯¹å¾…æ•´ä¸ªæºå¥å­ã€‚

![](https://i-blog.csdnimg.cn/direct/7670d6b7c76547df9396a3962c148f49.png)

é€šä¿—ä¸€ç‚¹ï¼Œæ³¨æ„åŠ›æœºåˆ¶å°±æ˜¯å¯¹äºæ¯ä¸ªäº‹ä»¶æ‰€åˆ†æ‹…æ³¨æ„åŠ›çš„æ¯”ä¾‹æ˜¯å¤šå°‘ã€‚
![](https://i-blog.csdnimg.cn/direct/43e6b0c0f54d44cf8c27a1068e3c7b3f.png)
![](https://i-blog.csdnimg.cn/direct/b1ac6ab5f1ea41b9809ed3912e101f1a.png)

é‚£ä¹ˆ
ğ›¼1,1,

ğ›¼

1,2

,

ğ›¼

1,3

,

ğ›¼

1,4

è¿™äº›éƒ½æ˜¯æ€ä¹ˆæ±‚çš„å‘¢ï¼Ÿ

![](https://i-blog.csdnimg.cn/direct/1860342e29ba423ab4b23e39c98abe64.png)

![](https://i-blog.csdnimg.cn/direct/f3b68b4b58894a09999c36840a0c7173.png)

å¾—åˆ°çš„
ğ›¼1,1,

ğ›¼

1,2

,

ğ›¼

1,3

,

ğ›¼1,4

å…¶æ¦‚ç‡å’Œä¸ä¸º1ï¼Œå› æ­¤åœ¨ç»è¿‡ä¸€æ¬¡Soft-maxï¼Œå¾—åˆ°æ¦‚ç‡å’Œä¸º1ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº†

ğ›¼1

åˆ†é…ç»™æ¯ä¸ªå­—å¤šå°‘çš„æ³¨æ„åŠ›

![](https://i-blog.csdnimg.cn/direct/0509bbd84d2f4c53836e2bf59c7aad18.png)

b1å°±æ˜¯
ğ›¼1

çœ‹è¿‡æ•´å¥è¯ç»“åˆæ³¨æ„åŠ›å¾—åˆ°çš„å€¼
ï¼Œè¿™æ ·å¯ä»¥æ±‚å¾—b2,b3,b4ï¼Œåœ¨è®¡ç®—å¾—è¿‡ç¨‹ä¸­éƒ½æ˜¯å…¨éƒ¨éƒ½æ˜¯å¹¶è¡Œçš„ï¼Œå®Œå…¨ä¸éœ€è¦ç­‰å¾…å‰é¢å¾—å†…å®¹ï¼Œå› æ­¤é€Ÿåº¦å¾ˆå¿«ã€‚

### ä¸‹é¢æ˜¯å…·ä½“å¾—è®¡ç®—è¿‡ç¨‹ï¼Œ

![](https://i-blog.csdnimg.cn/direct/582ef8f8fe2d46dbbd5d228438cb634d.png)

![](https://i-blog.csdnimg.cn/direct/2cf95e8bbc5e41188f05566996a3d8c6.png)
![](https://i-blog.csdnimg.cn/direct/835dc38b81004577ac8961c5cac60ba2.png)
![](https://i-blog.csdnimg.cn/direct/7fa57074d1664c71841f2f54a8631ce2.png)
![](https://i-blog.csdnimg.cn/direct/df69696a5c444a87a21c48c5a5e5c1f2.png)

![](https://i-blog.csdnimg.cn/direct/82430dfe194d4bb1bd3bd7cc56d7b9e8.png)

æˆ‘ä»¬æŠŠæ¯ä¸ªå­—ï¼Œä¹Ÿå°±æ˜¯è¡¨ç¤ºæˆ768ç»´å‘é‡ç§°ä¹‹ä¸ºtoken

### 

### Bert

Bertå°±æ˜¯ä¸€ä¸ªç¼–ç å™¨ï¼Œä¸ä»–å¯¹åº”çš„å°±æ˜¯GPT-2è§£ç å™¨ï¼Œå…ˆé€æ­¥åˆ†æBertçš„è¿‡ç¨‹ï¼š

Inputså°±æ˜¯å°†ä¸€ä¸ªå­—ä»¥one-hotçš„ç¼–ç å½¢å¼å±•ç¤ºå‡ºæ¥ï¼Œä¼ å»Input Embeaddingä¸­ï¼Œå°±æ˜¯å¯¹åº”çš„â€œè¯Embeaddingâ€è¿›è¡Œçš„æ“ä½œå°±æ˜¯è¿›è¡Œä¸€æ¬¡å…¨è¿æ¥Linearï¼ˆ22128ï¼Œ768ï¼‰ï¼›åœ¨è¿›è¡Œä¸€æ¬¡Positional Encodingï¼Œå°±æ˜¯å¯¹åº”çš„â€œä½ç½® Embeaddingâ€ï¼Œè¿›è¡Œçš„æ“ä½œæ˜¯ä¸€æ¬¡å…¨è¿æ¥Linearï¼ˆ512ï¼Œ768ï¼‰ã€‚

ç»è¿‡ä¸¤æ¬¡å…¨è¿æ¥ï¼Œè¿›å…¥çš„å°±æ˜¯Muti-Head Attentionï¼ˆå¤šå¤´æ³¨æ„åŠ›æœºåˆ¶ï¼‰ï¼Œä¸‹é¢çš„ä¸‰ä¸ªç®­å¤´å°±æ˜¯Wqã€Wkã€Wvï¼Œéƒ½æ˜¯ï¼ˆ768ï¼Œ768ï¼‰çš„Linearï¼Œåé¢è¿›è¡ŒNorm,å°±æ˜¯å½’ä¸€åŒ–ï¼Œè§‚å¯Ÿåˆ°è¿˜æœ‰ä¸€ä¸ªç®­å¤´æŒ‡å‘Addï¼Œè¿™å°±æ˜¯ResNetæ®‹å·®è¿æ¥ï¼Œå› ä¸ºæœ‰æ®‹å·®è¿æ¥ï¼Œç½‘ç»œæ‰èƒ½èµ°å¾ˆæ·±ã€‚ä¼ å‡ºè¿˜æ˜¯768ç»´ã€‚

ä¼ å…¥Feed Forwardï¼ŒFeed Forwardçš„æ“ä½œå°±æ˜¯è¿›è¡Œä¸¤æ¬¡å…¨è¿æ¥ï¼šnn.linear(768,3072)ã€nn.linear(3072,768),å¾—åˆ°768ç»´ï¼Œåœ¨è¿›è¡Œä¸€æ¬¡å½’ä¸€åŒ–å’Œæ®‹å·®è¿æ¥ï¼Œè¿™å°±ç®—æŠŠç‰¹å¾æå–å‡ºæ¥äº†ã€‚

è¿™å°±æ˜¯Bertçš„ä¸€æ¬¡å®Œæ•´çš„è¿‡ç¨‹ï¼Œå½“ç„¶ï¼Œå› ä¸ºBertæ•´ä½“çš„è¿‡ç¨‹ä¸æ”¹å˜ç»´åº¦ï¼Œè¾“å…¥768ç»´ï¼Œè¾“å‡º768ç»´ï¼Œæ‰€ä»¥å¯ä»¥æ ¹æ®å…·ä½“çš„æƒ…å†µè¿›è¡ŒNæ¬¡ã€‚

![](https://i-blog.csdnimg.cn/direct/63468116e87c4b41bb72e9d4e6243d59.png)
![](https://i-blog.csdnimg.cn/direct/47a01da8ec8d429f8c9c983203cbb287.png)

![](https://i-blog.csdnimg.cn/direct/11bc361e3d60486691d599a41c353133.png)

![](https://i-blog.csdnimg.cn/direct/d69d2d0448c647d3984ed0352635b324.png)

è¿™å°±æ˜¯ä»–ä»¬ä¹‹é—´çš„å…³ç³»

![](https://i-blog.csdnimg.cn/direct/49f839fbd32f4ef880d16affb23ab446.png)