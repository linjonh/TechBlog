---
layout: post
title: "重学-Android-自定义-View-系列十一文字跑马灯剖析"
date: 2025-03-07 14:07:28 +0800
description: "一个可以横向滚动和纵向滚动的自定义文字跑马灯View，支持水平和垂直滚动、多段文本展示、点击事件回调等功能。该View 由是基于的自定义视图，功能包括：1.1水平滚动文本从右向左滚动，支持多段文本循环展示。每段文本滚动结束后可以设置停留时间。1.2垂直滚动文本从下向上滚动，支持多段文本循环展示。如果文本长度超过视图宽度，会自动触发水平滚动，直到文本完全显示。1.3点击事件支持点击暂停/恢复滚动。提供点击事件回调，返回当前滚动文本的下标和内容。1.4自定义属性。"
keywords: "重学 Android 自定义 View 系列(十一)：文字跑马灯剖析"
categories: ['重学Android']
tags: ['Android']
artid: "146091659"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146091659
    alt: "重学-Android-自定义-View-系列十一文字跑马灯剖析"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146091659
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146091659
cover: https://bing.ee123.net/img/rand?artid=146091659
image: https://bing.ee123.net/img/rand?artid=146091659
img: https://bing.ee123.net/img/rand?artid=146091659
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     重学 Android 自定义 View 系列(十一)：文字跑马灯剖析
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atelier-sulphurpool-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h4>
     <a id="_0">
     </a>
     前言
    </h4>
    <p>
     一个可以横向滚动和纵向滚动的自定义文字跑马灯View，支持水平和垂直滚动、多段文本展示、点击事件回调等功能。
    </p>
    <p>
     该View 由
     <a href="https://github.com/AnyLifeZLB/ScrollTextView/tree/master">
      ScrollTextView
     </a>
     ，改版而来，效果如下：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/5cb97b354c91450894848cce5f735b2b.gif"/>
    </p>
    <h3>
     <a id="1__5">
     </a>
     1. 功能介绍
    </h3>
    <hr/>
    <p>
     <strong>
      ScrollTextView
     </strong>
     是基于
     <strong>
      SurfaceView
     </strong>
     的自定义视图，功能包括：
    </p>
    <p>
     1.1
     <strong>
      水平滚动
     </strong>
     ：
    </p>
    <ul>
     <li>
      <p>
       文本从右向左滚动，支持多段文本循环展示。
      </p>
     </li>
     <li>
      <p>
       每段文本滚动结束后可以设置停留时间。
      </p>
     </li>
    </ul>
    <p>
     1.2
     <strong>
      垂直滚动
     </strong>
     ：
    </p>
    <ul>
     <li>
      <p>
       文本从下向上滚动，支持多段文本循环展示。
      </p>
     </li>
     <li>
      <p>
       如果文本长度超过视图宽度，会自动触发水平滚动，直到文本完全显示。
      </p>
     </li>
    </ul>
    <p>
     1.3
     <strong>
      点击事件
     </strong>
     ：
    </p>
    <ul>
     <li>
      <p>
       支持点击暂停/恢复滚动。
      </p>
     </li>
     <li>
      <p>
       提供点击事件回调，返回当前滚动文本的下标和内容。
      </p>
     </li>
    </ul>
    <p>
     1.4
     <strong>
      自定义属性
     </strong>
     ：
    </p>
    <ul>
     <li>
      支持通过 XML 或代码设置滚动速度、文本颜色、字体大小等属性。
     </li>
    </ul>
    <h3>
     <a id="2__31">
     </a>
     2. 关键技术点解析
    </h3>
    <hr/>
    <h4>
     <a id="21__SurfaceView__33">
     </a>
     2.1. 使用 SurfaceView 实现高效绘制
    </h4>
    <p>
     SurfaceView 是一个独立的绘图表面，适合需要频繁更新的 UI 场景（如滚动文本）。与普通 View 不同，SurfaceView 的绘制在非 UI 线程中进行，因此不会阻塞主线程。
    </p>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ScrollTextView</span> <span class="token keyword">extends</span> <span class="token class-name">SurfaceView</span> <span class="token keyword">implements</span> <span class="token class-name">SurfaceHolder<span class="token punctuation">.</span>Callback</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">SurfaceHolder</span> surfaceHolder<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">ScrollTextView</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">,</span> <span class="token class-name">AttributeSet</span> attrs<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> attrs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        surfaceHolder <span class="token operator">=</span> <span class="token function">getHolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        surfaceHolder<span class="token punctuation">.</span><span class="token function">addCallback</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">surfaceCreated</span><span class="token punctuation">(</span><span class="token class-name">SurfaceHolder</span> holder<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 启动滚动线程</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ScrollTextThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">surfaceDestroyed</span><span class="token punctuation">(</span><span class="token class-name">SurfaceHolder</span> holder<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 停止滚动线程</span>
        stopScroll <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="22__59">
     </a>
     2.2. 水平滚动逻辑
    </h4>
    <p>
     水平滚动的核心是通过不断更新文本的 X 坐标，实现从右向左的滚动效果。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/200cccc1ce6045bd8e4b2b29944f4d22.png#pic_center">
      <br/>
      水平滚动即从初始状态右侧View之外滑入，到左侧完全滑出为止。
     </img>
    </p>
    <pre><code class="prism language-bash">   <span class="token keyword">if</span> <span class="token punctuation">(</span>isHorizontal<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> // 水平滚动逻辑
   
       <span class="token keyword">if</span> <span class="token punctuation">(</span>pauseScroll<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>// 暂停
           sleep<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token builtin class-name">continue</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span>
   
       drawText<span class="token punctuation">(</span>viewWidth - textX, textY<span class="token punctuation">)</span><span class="token punctuation">;</span>// 绘制文本
       textX <span class="token operator">+=</span> speed<span class="token punctuation">;</span>// 文本滚动距离
       <span class="token keyword">if</span> <span class="token punctuation">(</span>textX <span class="token operator">&gt;</span> viewWidthPlusTextLength<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>// 文本从右至左滚动超出屏幕
           currentTextIndex++<span class="token punctuation">;</span>
           textX <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
           --needScrollTimes<span class="token punctuation">;</span>
   
           <span class="token keyword">if</span> <span class="token punctuation">(</span>currentTextIndex <span class="token operator">&gt;=</span> textList.size<span class="token punctuation">(</span><span class="token punctuation">))</span> <span class="token punctuation">{<!-- --></span>// 文字循环展示
               <span class="token keyword">if</span> <span class="token punctuation">(</span>isScrollForever<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                   currentTextIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
               <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                   stopScroll <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                   <span class="token builtin class-name">break</span><span class="token punctuation">;</span>
               <span class="token punctuation">}</span>
           <span class="token punctuation">}</span>
           measureTextParams<span class="token punctuation">(</span>false<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="23__91">
     </a>
     2.3. 垂直滚动逻辑
    </h4>
    <p>
     垂直滚动的核心是通过不断更新文本的 Y 坐标，实现从下向上的滚动效果。如果文本长度超过视图宽度，会自动触发水平滚动。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/6126bf36478648c09abaa2e767fe6afe.png#pic_center"/>
    </p>
    <ol>
     <li>
      <strong>
       阶段1
      </strong>
      ：
     </li>
    </ol>
    <ul>
     <li>
      <p>
       文本从视图底部之外滚动到基线位置。
      </p>
     </li>
     <li>
      <p>
       如果文本超长，准备触发水平滚动。
      </p>
     </li>
    </ul>
    <ol start="2">
     <li>
      <strong>
       阶段2
      </strong>
      ：
     </li>
    </ol>
    <ul>
     <li>
      <p>
       (若文本过长)文本从右向左水平滚动，直到文本末尾完全显示。
      </p>
     </li>
     <li>
      <p>
       水平滚动完成后，暂停 stayTimes 毫秒。
      </p>
     </li>
    </ul>
    <ol start="3">
     <li>
      <strong>
       阶段3
      </strong>
      ：
     </li>
    </ol>
    <ul>
     <li>
      <p>
       文本从基线位置继续向上滚动，直到完全离开视图顶部。
      </p>
     </li>
     <li>
      <p>
       切换到下一段文本，重复上述过程。
      </p>
     </li>
    </ul>
    <p>
     <strong>
      核心代码：
     </strong>
    </p>
    <pre><code class="prism language-java">    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">drawVerticalScroll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>currentTextIndex <span class="token operator">&gt;=</span> textList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token comment">// 计算基线</span>
        <span class="token class-name">String</span> text <span class="token operator">=</span> textList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>currentTextIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">float</span> fontHeight <span class="token operator">=</span> paint<span class="token punctuation">.</span><span class="token function">getFontMetrics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>bottom <span class="token operator">-</span> paint<span class="token punctuation">.</span><span class="token function">getFontMetrics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>top<span class="token punctuation">;</span>
        <span class="token class-name">Paint<span class="token punctuation">.</span>FontMetrics</span> fontMetrics <span class="token operator">=</span> paint<span class="token punctuation">.</span><span class="token function">getFontMetrics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">float</span> distance <span class="token operator">=</span> <span class="token punctuation">(</span>fontMetrics<span class="token punctuation">.</span>bottom <span class="token operator">-</span> fontMetrics<span class="token punctuation">.</span>top<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> fontMetrics<span class="token punctuation">.</span>bottom<span class="token punctuation">;</span>
        <span class="token keyword">float</span> baseLine <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span> viewHeight <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> distance<span class="token punctuation">;</span>
        <span class="token comment">// 是否需要水平滚动</span>
        <span class="token keyword">boolean</span> needHorizontalScroll <span class="token operator">=</span> paint<span class="token punctuation">.</span><span class="token function">measureText</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token operator">&gt;</span> viewWidth<span class="token punctuation">;</span>
        <span class="token comment">// 水平滚动偏移</span>
        <span class="token keyword">float</span> horizontalOffset <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token comment">// --- 阶段1：垂直滚动到基线位置（精准停止）---</span>
        <span class="token keyword">float</span> currentVerticalPos <span class="token operator">=</span> viewHeight <span class="token operator">+</span> fontHeight<span class="token punctuation">;</span> <span class="token comment">// 初始位置</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>currentVerticalPos <span class="token operator">&gt;</span> baseLine<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>stopScroll <span class="token operator">||</span> isSetNewText<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>pauseScroll<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> ignored<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token punctuation">}</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 计算下一步位置，避免越过基线</span>
            <span class="token keyword">float</span> nextPos <span class="token operator">=</span> currentVerticalPos <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>nextPos <span class="token operator">&lt;</span> baseLine<span class="token punctuation">)</span> nextPos <span class="token operator">=</span> baseLine<span class="token punctuation">;</span> <span class="token comment">// 确保不会越过基线</span>
            <span class="token function">drawText</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> nextPos<span class="token punctuation">)</span><span class="token punctuation">;</span>
            currentVerticalPos <span class="token operator">=</span> nextPos<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// --- 阶段1暂停：基线位置暂停 ---</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>needHorizontalScroll<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>stopScroll <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>isSetNewText<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">sleep</span><span class="token punctuation">(</span>stayTimes<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 原基线位置暂停</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// --- 阶段2：水平滚动（垂直位置固定为基线）---</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>needHorizontalScroll<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 计算最大水平滚动偏移</span>
            <span class="token keyword">float</span> maxHorizontalOffset <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span>paint<span class="token punctuation">.</span><span class="token function">measureText</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token operator">-</span> viewWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 水平滚动</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>horizontalOffset <span class="token operator">&gt;</span> maxHorizontalOffset<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span>stopScroll <span class="token operator">||</span> isSetNewText<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
                horizontalOffset <span class="token operator">-=</span> speed<span class="token punctuation">;</span>
                <span class="token function">drawText</span><span class="token punctuation">(</span>horizontalOffset<span class="token punctuation">,</span> baseLine<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// --- 阶段2暂停：水平滚动完成后暂停 ---</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>stopScroll <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>isSetNewText<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token function">sleep</span><span class="token punctuation">(</span>stayTimes<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 新增水平滚动完成后的暂停</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// --- 阶段3：继续垂直滚动到视图外 ---</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">float</span> i <span class="token operator">=</span> baseLine<span class="token punctuation">;</span> i <span class="token operator">&gt;</span> <span class="token operator">-</span>fontHeight<span class="token punctuation">;</span> i <span class="token operator">-=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>stopScroll <span class="token operator">||</span> isSetNewText<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>pauseScroll<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token function">drawText</span><span class="token punctuation">(</span>needHorizontalScroll <span class="token operator">?</span> horizontalOffset <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 切换到下一个文本</span>
        currentTextIndex<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>currentTextIndex <span class="token operator">&gt;=</span> textList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>isScrollForever<span class="token punctuation">)</span> currentTextIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span> stopScroll <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="24__190">
     </a>
     2.4. 点击事件处理
    </h4>
    <pre><code class="prism language-java"><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">onTouchEvent</span><span class="token punctuation">(</span><span class="token class-name">MotionEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>clickEnable <span class="token operator">&amp;&amp;</span> event<span class="token punctuation">.</span><span class="token function">getAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">MotionEvent</span><span class="token punctuation">.</span><span class="token constant">ACTION_DOWN</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        pauseScroll <span class="token operator">=</span> <span class="token operator">!</span>pauseScroll<span class="token punctuation">;</span> <span class="token comment">// 切换暂停状态</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>onTextClickListener <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 回调当前滚动文本的下标和内容</span>
            onTextClickListener<span class="token punctuation">.</span><span class="token function">onTextClick</span><span class="token punctuation">(</span>currentTextIndex<span class="token punctuation">,</span> textList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>currentTextIndex<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="3__205">
     </a>
     3. 自定义属性
    </h3>
    <hr/>
    <pre><code class="prism language-xml">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>declare-styleable</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ScrollTextView<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>attr</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>clickEnable<span class="token punctuation">"</span></span> <span class="token attr-name">format</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>boolean<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>attr</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>isHorizontal<span class="token punctuation">"</span></span> <span class="token attr-name">format</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>boolean<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>attr</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>speed<span class="token punctuation">"</span></span> <span class="token attr-name">format</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>integer<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>attr</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stTextColor<span class="token punctuation">"</span></span> <span class="token attr-name">format</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>color<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>attr</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stTextSize<span class="token punctuation">"</span></span> <span class="token attr-name">format</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dimension<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>attr</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>times<span class="token punctuation">"</span></span> <span class="token attr-name">format</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>integer<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>attr</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>isScrollForever<span class="token punctuation">"</span></span> <span class="token attr-name">format</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>boolean<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>declare-styleable</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <h3>
     <a id="4__219">
     </a>
     4. 完整代码
    </h3>
    <hr/>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ScrollTextView</span> <span class="token keyword">extends</span> <span class="token class-name">SurfaceView</span> <span class="token keyword">implements</span> <span class="token class-name">SurfaceHolder<span class="token punctuation">.</span>Callback</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">TAG</span> <span class="token operator">=</span> <span class="token string">"ScrollTextView"</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">SurfaceHolder</span> surfaceHolder<span class="token punctuation">;</span><span class="token comment">// SurfaceHolder管理SurfaceView的绘制表面</span>
    <span class="token keyword">private</span> <span class="token class-name">Paint</span> paint <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">boolean</span> stopScroll <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">// 停止滚动</span>
    <span class="token keyword">private</span> <span class="token keyword">boolean</span> pauseScroll <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">// 暂停滚动</span>
    <span class="token keyword">private</span> <span class="token keyword">boolean</span> clickEnable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">// 是否启用点击事件</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> isHorizontal <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">// 是否水平滚动</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> speed <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span><span class="token comment">// 滚动速度</span>
    <span class="token keyword">private</span> <span class="token keyword">long</span> stayTimes <span class="token operator">=</span> <span class="token number">5_000</span><span class="token punctuation">;</span><span class="token comment">// 横向滚动每段文字结束后的停留时间</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> textList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 存储多个文本内容</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> currentTextIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 当前滚动的文本索引</span>
    <span class="token keyword">private</span> <span class="token keyword">float</span> textSize <span class="token operator">=</span> <span class="token number">20f</span><span class="token punctuation">;</span><span class="token comment">// 文本字体大小</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> textColor<span class="token punctuation">;</span><span class="token comment">// 文本颜色</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> textBackColor <span class="token operator">=</span> <span class="token number">0x00000000</span><span class="token punctuation">;</span><span class="token comment">// 文本背景颜色</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> needScrollTimes <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token constant">MAX_VALUE</span><span class="token punctuation">;</span><span class="token comment">// 需要滚动的次数</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> viewWidth <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> viewHeight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">// 视图的宽度和高度</span>
    <span class="token keyword">private</span> <span class="token keyword">float</span> textWidth <span class="token operator">=</span> <span class="token number">0f</span><span class="token punctuation">,</span> textX <span class="token operator">=</span> <span class="token number">0f</span><span class="token punctuation">,</span> textY <span class="token operator">=</span> <span class="token number">0f</span><span class="token punctuation">;</span><span class="token comment">// 文本的宽度、X坐标、Y坐标</span>
    <span class="token keyword">private</span> <span class="token keyword">float</span> viewWidthPlusTextLength <span class="token operator">=</span> <span class="token number">0.0f</span><span class="token punctuation">;</span><span class="token comment">// 视图宽度加上文本长度</span>
    <span class="token keyword">boolean</span> isSetNewText <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">// 是否设置了新的文本</span>
    <span class="token keyword">boolean</span> isScrollForever <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">// 是否无限滚动</span>
    <span class="token keyword">private</span> <span class="token class-name">Canvas</span> canvas<span class="token punctuation">;</span><span class="token comment">// 画布，用于绘制文本</span>
    <span class="token keyword">private</span> <span class="token class-name">OnTextClickListener</span> onTextClickListener<span class="token punctuation">;</span><span class="token comment">// 点击事件监听器</span>

    <span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">OnTextClickListener</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">void</span> <span class="token function">onTextClick</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">,</span> <span class="token class-name">String</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setOnTextClickListener</span><span class="token punctuation">(</span><span class="token class-name">OnTextClickListener</span> listener<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>onTextClickListener <span class="token operator">=</span> listener<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">ScrollTextView</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">ScrollTextView</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">,</span> <span class="token class-name">AttributeSet</span> attrs<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> attrs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        surfaceHolder <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getHolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//get The surface holder</span>
        surfaceHolder<span class="token punctuation">.</span><span class="token function">addCallback</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        paint <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Paint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">TypedArray</span> arr <span class="token operator">=</span> <span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">obtainStyledAttributes</span><span class="token punctuation">(</span>attrs<span class="token punctuation">,</span> <span class="token class-name">R</span><span class="token punctuation">.</span>styleable<span class="token punctuation">.</span>ScrollTextView<span class="token punctuation">)</span><span class="token punctuation">;</span>
        clickEnable <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">getBoolean</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>styleable<span class="token punctuation">.</span>ScrollTextView_clickEnable<span class="token punctuation">,</span> clickEnable<span class="token punctuation">)</span><span class="token punctuation">;</span>
        isHorizontal <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">getBoolean</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>styleable<span class="token punctuation">.</span>ScrollTextView_isHorizontal<span class="token punctuation">,</span> isHorizontal<span class="token punctuation">)</span><span class="token punctuation">;</span>
        speed <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">getInteger</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>styleable<span class="token punctuation">.</span>ScrollTextView_speed<span class="token punctuation">,</span> speed<span class="token punctuation">)</span><span class="token punctuation">;</span>
        textColor <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">getColor</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>styleable<span class="token punctuation">.</span>ScrollTextView_stTextColor<span class="token punctuation">,</span> <span class="token class-name">Color</span><span class="token punctuation">.</span><span class="token constant">BLACK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        textSize <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">getDimension</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>styleable<span class="token punctuation">.</span>ScrollTextView_stTextSize<span class="token punctuation">,</span> textSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        needScrollTimes <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">getInteger</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>styleable<span class="token punctuation">.</span>ScrollTextView_times<span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token constant">MAX_VALUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        isScrollForever <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">getBoolean</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>styleable<span class="token punctuation">.</span>ScrollTextView_isScrollForever<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        paint<span class="token punctuation">.</span><span class="token function">setColor</span><span class="token punctuation">(</span>textColor<span class="token punctuation">)</span><span class="token punctuation">;</span>
        paint<span class="token punctuation">.</span><span class="token function">setTextSize</span><span class="token punctuation">(</span>textSize<span class="token punctuation">)</span><span class="token punctuation">;</span>

        paint<span class="token punctuation">.</span><span class="token function">setFlags</span><span class="token punctuation">(</span><span class="token class-name">Paint</span><span class="token punctuation">.</span><span class="token constant">ANTI_ALIAS_FLAG</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        paint<span class="token punctuation">.</span><span class="token function">setAntiAlias</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        paint<span class="token punctuation">.</span><span class="token function">setFilterBitmap</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">setZOrderOnTop</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//控制表面视图的表面位于其窗口的顶部。</span>
        <span class="token function">getHolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setFormat</span><span class="token punctuation">(</span><span class="token class-name">PixelFormat</span><span class="token punctuation">.</span><span class="token constant">TRANSLUCENT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">setFocusable</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        arr<span class="token punctuation">.</span><span class="token function">recycle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onMeasure</span><span class="token punctuation">(</span><span class="token keyword">int</span> widthMeasureSpec<span class="token punctuation">,</span> <span class="token keyword">int</span> heightMeasureSpec<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onMeasure</span><span class="token punctuation">(</span>widthMeasureSpec<span class="token punctuation">,</span> heightMeasureSpec<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">int</span> mHeight <span class="token operator">=</span> <span class="token function">getFontHeight</span><span class="token punctuation">(</span>textSize<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//实际的视图高</span>
        viewWidth <span class="token operator">=</span> <span class="token class-name">MeasureSpec</span><span class="token punctuation">.</span><span class="token function">getSize</span><span class="token punctuation">(</span>widthMeasureSpec<span class="token punctuation">)</span><span class="token punctuation">;</span>
        viewHeight <span class="token operator">=</span> <span class="token class-name">MeasureSpec</span><span class="token punctuation">.</span><span class="token function">getSize</span><span class="token punctuation">(</span>heightMeasureSpec<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 当布局的宽度或高度是wrap_content，应该初始化ScrollTextView的宽度/高度</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getLayoutParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">==</span> <span class="token class-name">ViewGroup<span class="token punctuation">.</span>LayoutParams</span><span class="token punctuation">.</span><span class="token constant">WRAP_CONTENT</span> <span class="token operator">&amp;&amp;</span> <span class="token function">getLayoutParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>height <span class="token operator">==</span> <span class="token class-name">ViewGroup<span class="token punctuation">.</span>LayoutParams</span><span class="token punctuation">.</span><span class="token constant">WRAP_CONTENT</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">setMeasuredDimension</span><span class="token punctuation">(</span>viewWidth<span class="token punctuation">,</span> mHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
            viewHeight <span class="token operator">=</span> mHeight<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getLayoutParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">==</span> <span class="token class-name">ViewGroup<span class="token punctuation">.</span>LayoutParams</span><span class="token punctuation">.</span><span class="token constant">WRAP_CONTENT</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">setMeasuredDimension</span><span class="token punctuation">(</span>viewWidth<span class="token punctuation">,</span> viewHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getLayoutParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>height <span class="token operator">==</span> <span class="token class-name">ViewGroup<span class="token punctuation">.</span>LayoutParams</span><span class="token punctuation">.</span><span class="token constant">WRAP_CONTENT</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">setMeasuredDimension</span><span class="token punctuation">(</span>viewWidth<span class="token punctuation">,</span> mHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
            viewHeight <span class="token operator">=</span> mHeight<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>


    <span class="token comment">/**
     * surfaceChanged
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">surfaceChanged</span><span class="token punctuation">(</span><span class="token class-name">SurfaceHolder</span> arg0<span class="token punctuation">,</span> <span class="token keyword">int</span> arg1<span class="token punctuation">,</span> <span class="token keyword">int</span> arg2<span class="token punctuation">,</span> <span class="token keyword">int</span> arg3<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token constant">TAG</span><span class="token punctuation">,</span> <span class="token string">"arg0:"</span> <span class="token operator">+</span> arg0<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"  arg1:"</span> <span class="token operator">+</span> arg1 <span class="token operator">+</span> <span class="token string">"  arg2:"</span> <span class="token operator">+</span> arg2 <span class="token operator">+</span> <span class="token string">"  arg3:"</span> <span class="token operator">+</span> arg3<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 界面出现，初始化一个新的滚动线程。
     *
     * @param holder holder
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">surfaceCreated</span><span class="token punctuation">(</span><span class="token class-name">SurfaceHolder</span> holder<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        stopScroll <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ScrollTextThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token constant">TAG</span><span class="token punctuation">,</span> <span class="token string">"ScrollTextTextView is created"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 界面退出，视图消失，自动调用
     *
     * @param arg0 SurfaceHolder
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">surfaceDestroyed</span><span class="token punctuation">(</span><span class="token class-name">SurfaceHolder</span> arg0<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            stopScroll <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token constant">TAG</span><span class="token punctuation">,</span> <span class="token string">"ScrollTextTextView is destroyed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">getFontHeight</span><span class="token punctuation">(</span><span class="token keyword">float</span> fontSize<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Paint</span> paint <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Paint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        paint<span class="token punctuation">.</span><span class="token function">setTextSize</span><span class="token punctuation">(</span>fontSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Paint<span class="token punctuation">.</span>FontMetrics</span> fm <span class="token operator">=</span> paint<span class="token punctuation">.</span><span class="token function">getFontMetrics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>fm<span class="token punctuation">.</span>descent <span class="token operator">-</span> fm<span class="token punctuation">.</span>ascent<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getBackgroundColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> textBackColor<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTextBackColor</span><span class="token punctuation">(</span><span class="token keyword">int</span> color<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setBackgroundColor</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>textBackColor <span class="token operator">=</span> color<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getTextBackColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> textBackColor<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getSpeed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> speed<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getCurrentTextIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> currentTextIndex<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTimes</span><span class="token punctuation">(</span><span class="token keyword">int</span> times<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>times <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"times was invalid integer, it must between &gt; 0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            needScrollTimes <span class="token operator">=</span> times<span class="token punctuation">;</span>
            isScrollForever <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 纵向滚动设置每段文字的停留时间
     * @param stayTimes
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setStayTimes</span><span class="token punctuation">(</span><span class="token keyword">long</span> stayTimes<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>stayTimes <span class="token operator">=</span> stayTimes<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getStayTimes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> stayTimes<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTextSize</span><span class="token punctuation">(</span><span class="token keyword">float</span> textSizeTem<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>textSizeTem <span class="token operator">&lt;</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"textSize must  &gt; 20"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>textSizeTem <span class="token operator">&gt;</span> <span class="token number">900</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"textSize must  &lt; 900"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>textSize <span class="token operator">=</span> <span class="token function">sp2px</span><span class="token punctuation">(</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> textSizeTem<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//重新设置Size</span>
            paint<span class="token punctuation">.</span><span class="token function">setTextSize</span><span class="token punctuation">(</span>textSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//视图区域也要改变</span>
            <span class="token function">measureTextParams</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//实际的视图高</span>
            <span class="token keyword">int</span> mHeight <span class="token operator">=</span> <span class="token function">getFontHeight</span><span class="token punctuation">(</span>textSizeTem<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token namespace">android<span class="token punctuation">.</span>view<span class="token punctuation">.</span></span>ViewGroup<span class="token punctuation">.</span>LayoutParams</span> lp <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getLayoutParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            lp<span class="token punctuation">.</span>width <span class="token operator">=</span> viewWidth<span class="token punctuation">;</span>
            lp<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token function">dip2px</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setLayoutParams</span><span class="token punctuation">(</span>lp<span class="token punctuation">)</span><span class="token punctuation">;</span>

            isSetNewText <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">dip2px</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">,</span> <span class="token keyword">float</span> dpValue<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">final</span> <span class="token keyword">float</span> scale <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getResources</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDisplayMetrics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>density<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>dpValue <span class="token operator">*</span> scale <span class="token operator">+</span> <span class="token number">0.5f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">sp2px</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">,</span> <span class="token keyword">float</span> spValue<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">float</span> fontScale <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getResources</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDisplayMetrics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>scaledDensity<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>spValue <span class="token operator">*</span> fontScale <span class="token operator">+</span> <span class="token number">0.5f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">px2sp</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">,</span> <span class="token keyword">float</span> pxValue<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">float</span> fontScale <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getResources</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDisplayMetrics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>scaledDensity<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>pxValue <span class="token operator">/</span> fontScale <span class="token operator">+</span> <span class="token number">0.5f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setHorizontal</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> horizontal<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        isHorizontal <span class="token operator">=</span> horizontal<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 设置多个文本内容</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTextList</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> textList<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>textList <span class="token operator">=</span> textList<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>currentTextIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        isSetNewText <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        stopScroll <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token function">measureTextParams</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTextColor</span><span class="token punctuation">(</span><span class="token annotation punctuation">@ColorInt</span> <span class="token keyword">int</span> color<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        textColor <span class="token operator">=</span> color<span class="token punctuation">;</span>
        paint<span class="token punctuation">.</span><span class="token function">setColor</span><span class="token punctuation">(</span>textColor<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getTextColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> textColor<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 设置滚动速度
     *
     * @param speed SCROLL SPEED [4,14] / 0?
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setSpeed</span><span class="token punctuation">(</span><span class="token keyword">int</span> speed<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>speed <span class="token operator">&gt;</span> <span class="token number">14</span> <span class="token operator">||</span> speed <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"Speed was invalid integer, it must between 4 and 14"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>speed <span class="token operator">=</span> speed<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 设置是否永远滚动文本
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setScrollForever</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> scrollForever<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        isScrollForever <span class="token operator">=</span> scrollForever<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isPauseScroll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> pauseScroll<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPauseScroll</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> pauseScroll<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>pauseScroll <span class="token operator">=</span> pauseScroll<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isClickEnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> clickEnable<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setClickEnable</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> clickEnable<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>clickEnable <span class="token operator">=</span> clickEnable<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">onTouchEvent</span><span class="token punctuation">(</span><span class="token class-name">MotionEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>clickEnable<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token function">getAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">case</span> <span class="token class-name">MotionEvent</span><span class="token punctuation">.</span><span class="token constant">ACTION_DOWN</span><span class="token operator">:</span>
                pauseScroll <span class="token operator">=</span> <span class="token operator">!</span>pauseScroll<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>onTextClickListener <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    onTextClickListener<span class="token punctuation">.</span><span class="token function">onTextClick</span><span class="token punctuation">(</span>currentTextIndex<span class="token punctuation">,</span> textList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>currentTextIndex<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">drawVerticalScroll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>currentTextIndex <span class="token operator">&gt;=</span> textList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token comment">// 计算基线</span>
        <span class="token class-name">String</span> text <span class="token operator">=</span> textList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>currentTextIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">float</span> fontHeight <span class="token operator">=</span> paint<span class="token punctuation">.</span><span class="token function">getFontMetrics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>bottom <span class="token operator">-</span> paint<span class="token punctuation">.</span><span class="token function">getFontMetrics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>top<span class="token punctuation">;</span>
        <span class="token class-name">Paint<span class="token punctuation">.</span>FontMetrics</span> fontMetrics <span class="token operator">=</span> paint<span class="token punctuation">.</span><span class="token function">getFontMetrics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">float</span> distance <span class="token operator">=</span> <span class="token punctuation">(</span>fontMetrics<span class="token punctuation">.</span>bottom <span class="token operator">-</span> fontMetrics<span class="token punctuation">.</span>top<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> fontMetrics<span class="token punctuation">.</span>bottom<span class="token punctuation">;</span>
        <span class="token keyword">float</span> baseLine <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span> viewHeight <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> distance<span class="token punctuation">;</span>
        <span class="token comment">// 是否需要水平滚动</span>
        <span class="token keyword">boolean</span> needHorizontalScroll <span class="token operator">=</span> paint<span class="token punctuation">.</span><span class="token function">measureText</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token operator">&gt;</span> viewWidth<span class="token punctuation">;</span>
        <span class="token comment">// 水平滚动偏移</span>
        <span class="token keyword">float</span> horizontalOffset <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token comment">// --- 阶段1：垂直滚动到基线位置（精准停止）---</span>
        <span class="token keyword">float</span> currentVerticalPos <span class="token operator">=</span> viewHeight <span class="token operator">+</span> fontHeight<span class="token punctuation">;</span> <span class="token comment">// 初始位置</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>currentVerticalPos <span class="token operator">&gt;</span> baseLine<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>stopScroll <span class="token operator">||</span> isSetNewText<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>pauseScroll<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> ignored<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token punctuation">}</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 计算下一步位置，避免越过基线</span>
            <span class="token keyword">float</span> nextPos <span class="token operator">=</span> currentVerticalPos <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>nextPos <span class="token operator">&lt;</span> baseLine<span class="token punctuation">)</span> nextPos <span class="token operator">=</span> baseLine<span class="token punctuation">;</span> <span class="token comment">// 确保不会越过基线</span>
            <span class="token function">drawText</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> nextPos<span class="token punctuation">)</span><span class="token punctuation">;</span>
            currentVerticalPos <span class="token operator">=</span> nextPos<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// --- 阶段1暂停：基线位置暂停 ---</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>needHorizontalScroll<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>stopScroll <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>isSetNewText<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">sleep</span><span class="token punctuation">(</span>stayTimes<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 原基线位置暂停</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// --- 阶段2：水平滚动（垂直位置固定为基线）---</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>needHorizontalScroll<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 计算最大水平滚动偏移</span>
            <span class="token keyword">float</span> maxHorizontalOffset <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span>paint<span class="token punctuation">.</span><span class="token function">measureText</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token operator">-</span> viewWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 水平滚动</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>horizontalOffset <span class="token operator">&gt;</span> maxHorizontalOffset<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span>stopScroll <span class="token operator">||</span> isSetNewText<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
                horizontalOffset <span class="token operator">-=</span> speed<span class="token punctuation">;</span>
                <span class="token function">drawText</span><span class="token punctuation">(</span>horizontalOffset<span class="token punctuation">,</span> baseLine<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// --- 阶段2暂停：水平滚动完成后暂停 ---</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>stopScroll <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>isSetNewText<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token function">sleep</span><span class="token punctuation">(</span>stayTimes<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 新增水平滚动完成后的暂停</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// --- 阶段3：继续垂直滚动到视图外 ---</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">float</span> i <span class="token operator">=</span> baseLine<span class="token punctuation">;</span> i <span class="token operator">&gt;</span> <span class="token operator">-</span>fontHeight<span class="token punctuation">;</span> i <span class="token operator">-=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>stopScroll <span class="token operator">||</span> isSetNewText<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>pauseScroll<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token function">drawText</span><span class="token punctuation">(</span>needHorizontalScroll <span class="token operator">?</span> horizontalOffset <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 切换到下一个文本</span>
        currentTextIndex<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>currentTextIndex <span class="token operator">&gt;=</span> textList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>isScrollForever<span class="token punctuation">)</span> currentTextIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span> stopScroll <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 绘制文本
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">drawText</span><span class="token punctuation">(</span><span class="token keyword">float</span> x<span class="token punctuation">,</span> <span class="token keyword">float</span> y<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            canvas <span class="token operator">=</span> surfaceHolder<span class="token punctuation">.</span><span class="token function">lockCanvas</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>canvas <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
            canvas<span class="token punctuation">.</span><span class="token function">drawColor</span><span class="token punctuation">(</span><span class="token class-name">Color</span><span class="token punctuation">.</span><span class="token constant">TRANSPARENT</span><span class="token punctuation">,</span> <span class="token class-name">PorterDuff<span class="token punctuation">.</span>Mode</span><span class="token punctuation">.</span><span class="token constant">CLEAR</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            canvas<span class="token punctuation">.</span><span class="token function">drawText</span><span class="token punctuation">(</span>textList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>currentTextIndex<span class="token punctuation">)</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> paint<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>canvas <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                surfaceHolder<span class="token punctuation">.</span><span class="token function">unlockCanvasAndPost</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>


    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onVisibilityChanged</span><span class="token punctuation">(</span><span class="token class-name">View</span> changedView<span class="token punctuation">,</span> <span class="token keyword">int</span> visibility<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onVisibilityChanged</span><span class="token punctuation">(</span>changedView<span class="token punctuation">,</span> visibility<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span>visibility<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 测量文本参数</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">measureTextParams</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> isInitialSetup<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>currentTextIndex <span class="token operator">&gt;=</span> textList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
        textWidth <span class="token operator">=</span> paint<span class="token punctuation">.</span><span class="token function">measureText</span><span class="token punctuation">(</span>textList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>currentTextIndex<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        viewWidthPlusTextLength <span class="token operator">=</span> viewWidth <span class="token operator">+</span> textWidth<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>isInitialSetup<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            textX <span class="token operator">=</span> viewWidth <span class="token operator">-</span> viewWidth <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">// 第一次创建 ，默认从居中的位置开始滚动</span>
            <span class="token class-name">Paint<span class="token punctuation">.</span>FontMetrics</span> fm <span class="token operator">=</span> paint<span class="token punctuation">.</span><span class="token function">getFontMetrics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">float</span> distance <span class="token operator">=</span> <span class="token punctuation">(</span>fm<span class="token punctuation">.</span>bottom <span class="token operator">-</span> fm<span class="token punctuation">.</span>top<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> fm<span class="token punctuation">.</span>bottom<span class="token punctuation">;</span>
            textY <span class="token operator">=</span> viewHeight <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> distance<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>


    <span class="token comment">/**
     * Scroll thread
     */</span>
    <span class="token keyword">class</span> <span class="token class-name">ScrollTextThread</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{<!-- --></span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">measureTextParams</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>stopScroll <span class="token operator">&amp;&amp;</span> surfaceHolder <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isInterrupted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span>isHorizontal<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 水平滚动逻辑</span>

                    <span class="token keyword">if</span> <span class="token punctuation">(</span>pauseScroll<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token comment">// 暂停</span>
                        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">continue</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                    <span class="token function">drawText</span><span class="token punctuation">(</span>viewWidth <span class="token operator">-</span> textX<span class="token punctuation">,</span> textY<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 绘制文本</span>
                    textX <span class="token operator">+=</span> speed<span class="token punctuation">;</span><span class="token comment">// 文本滚动距离</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>textX <span class="token operator">&gt;</span> viewWidthPlusTextLength<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token comment">// 文本从右至左滚动超出屏幕</span>
                        currentTextIndex<span class="token operator">++</span><span class="token punctuation">;</span>
                        textX <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                        <span class="token operator">--</span>needScrollTimes<span class="token punctuation">;</span>

                        <span class="token keyword">if</span> <span class="token punctuation">(</span>currentTextIndex <span class="token operator">&gt;=</span> textList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token comment">// 文字循环展示</span>
                            <span class="token keyword">if</span> <span class="token punctuation">(</span>isScrollForever<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                                currentTextIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                                stopScroll <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                                <span class="token keyword">break</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                        <span class="token punctuation">}</span>
                        <span class="token function">measureTextParams</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 垂直滚动逻辑</span>
                    <span class="token function">drawVerticalScroll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    isSetNewText <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                    <span class="token operator">--</span>needScrollTimes<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span>needScrollTimes <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> isScrollForever<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 滚动次数小于0，则滚动结束</span>
                    stopScroll <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token keyword">long</span> millis<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span>millis<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> ignored<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="5__668">
     </a>
     5. 使用示例
    </h3>
    <hr/>
    <pre><code class="prism language-bash">        // 文字列表
        val textList <span class="token operator">=</span> mutableListOf<span class="token punctuation">(</span>
            <span class="token string">"关于开展2025年市直公益性岗位征集工作的通知"</span>,
            <span class="token string">"国家发通知要求规范OTA升级 广汽将构建全域智行安全守护体系"</span>,
            <span class="token string">"2月28日，工信部联合市场监管总局发布了《关于进一步加强智能网联汽车准入、召回及软件在线升级管理的通知》（以下简称《通知》），为汽车产业健康有序发展提供了顶层指引。对此，广汽集团表示，承诺所有安全投入绝不转嫁用户成本。"</span>
        <span class="token punctuation">)</span>

        // 横向
        mBind.scrollTextH.apply <span class="token punctuation">{<!-- --></span>
            setTextList<span class="token punctuation">(</span>textList<span class="token punctuation">)</span>
            this.isHorizontal <span class="token operator">=</span> <span class="token boolean">true</span>
            speed <span class="token operator">=</span> <span class="token number">4</span>
            textColor <span class="token operator">=</span> Color.WHITE
            textBackColor <span class="token operator">=</span> R.color.teal_200
            isClickEnable <span class="token operator">=</span> <span class="token boolean">true</span>
            setOnTextClickListener <span class="token punctuation">{<!-- --></span> index, text -<span class="token operator">&gt;</span>
                ToastUtils.show<span class="token punctuation">(</span><span class="token string">"点击了 <span class="token variable">$index</span> <span class="token variable">$text</span>"</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        // 竖向
        mBind.scrollTextV.apply <span class="token punctuation">{<!-- --></span>
            setTextList<span class="token punctuation">(</span>textList<span class="token punctuation">)</span> // 文字列表
            this.isHorizontal <span class="token operator">=</span> <span class="token boolean">false</span> // 是否横向滚动
            speed <span class="token operator">=</span> <span class="token number">4</span> // 滚动速度
            stayTimes <span class="token operator">=</span> <span class="token number">3000</span> // 停留时间 3s
            textColor <span class="token operator">=</span> Color.WHITE // 文字颜色
            textBackColor <span class="token operator">=</span> R.color.teal_700 // 文字背景颜色
            isClickEnable <span class="token operator">=</span> <span class="token boolean">false</span> // 是否可点击
        <span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="6__703">
     </a>
     6. 最后
    </h3>
    <hr/>
    <p>
     以上功能可能只满足部分场景，如需要更多功能，比如：滚动方向，多行滚动等，可自行拓展。直接看代码，可能不容易理解，但是把功能的细节点全都剖析出来，在脑子里有个完整的轮廓，再去看代码，就事半功倍了。see you ~
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f57726974654275673030312f:61727469636c652f64657461696c732f313436303931363539" class_="artid" style="display:none">
 </p>
</div>


