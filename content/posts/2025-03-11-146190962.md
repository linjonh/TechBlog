---
layout: post
title: "Java-é›†åˆæ¡†æ¶å¤§å¸ˆè¯¾é›†åˆæ¡†æ¶æºç è§£å‰–å®¤äº”"
date: 2025-03-11 22:37:55 +0800
description: "ğŸ’£ è­¦å‘Šï¼šæœ¬ç« åŒ…å«å¤§é‡ï¼Œå»ºè®®æ­é…å’–å•¡å› é¥®æ–™é˜…è¯»ï¼â˜•ï¸ã€‚"
keywords: "Java é›†åˆæ¡†æ¶å¤§å¸ˆè¯¾ï¼šé›†åˆæ¡†æ¶æºç è§£å‰–å®¤ï¼ˆäº”ï¼‰"
categories: ['Java']
tags: ['å¼€å‘è¯­è¨€', 'Java']
artid: "146190962"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146190962
    alt: "Java-é›†åˆæ¡†æ¶å¤§å¸ˆè¯¾é›†åˆæ¡†æ¶æºç è§£å‰–å®¤äº”"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146190962
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146190962
cover: https://bing.ee123.net/img/rand?artid=146190962
image: https://bing.ee123.net/img/rand?artid=146190962
img: https://bing.ee123.net/img/rand?artid=146190962
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Java é›†åˆæ¡†æ¶å¤§å¸ˆè¯¾ï¼šé›†åˆæ¡†æ¶æºç è§£å‰–å®¤ï¼ˆäº”ï¼‰
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="Java__1">
     </a>
     ğŸ”¥Java é›†åˆæ¡†æ¶å¤§å¸ˆè¯¾ï¼šé›†åˆæ¡†æ¶æºç è§£å‰–å®¤ï¼ˆäº”ï¼‰
    </h2>
    <blockquote>
     <p>
      ğŸ’£ è­¦å‘Šï¼šæœ¬ç« åŒ…å«å¤§é‡
      <strong>
       è£¸ç çº§ç¡¬æ ¸åˆ†æ
      </strong>
      ï¼Œå»ºè®®æ­é…å’–å•¡å› é¥®æ–™é˜…è¯»ï¼â˜•ï¸
     </p>
    </blockquote>
    <hr/>
    <h3>
     <a id="_ArrayList__9">
     </a>
     ç¬¬ä¸€ç«  ArrayList çš„æ‰©å®¹ç„å­¦
    </h3>
    <h4>
     <a id="11__11">
     </a>
     1.1 åŠ¨æ€æ‰©å®¹æ ¸å¿ƒä»£ç å¤§å¸å…«å—
    </h4>
    <pre><code class="prism language-java"><span class="token comment">// ç¥–å¸ˆçˆ·ã®æ‰©å®¹é­”æ³• âœ¨</span>
<span class="token keyword">private</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">grow</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> oldCapacity <span class="token operator">=</span> elementData<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token comment">// 1.5å€å¢é•¿å…¬å¼ï¼ˆæš—è—æ•°å­¦ä¹‹ç¾ï¼‰</span>
    <span class="token keyword">int</span> newCapacity <span class="token operator">=</span> oldCapacity <span class="token operator">+</span> <span class="token punctuation">(</span>oldCapacity <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">return</span> elementData <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> newCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     ğŸ“Œ
     <strong>
      çµé­‚æ‹·é—®è¡¨
     </strong>
     ï¼š
    </p>
    <table>
     <thead>
      <tr>
       <th>
        ç°è±¡
       </th>
       <th>
        æ•°å­¦åŸç†
       </th>
       <th>
        æ€§èƒ½å½±å“
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        åˆå§‹å®¹é‡10
       </td>
       <td>
        2çš„å€æ•°+2ï¼ŸğŸ¤”
       </td>
       <td>
        å°æ•°æ®é›†çœå†…å­˜
       </td>
      </tr>
      <tr>
       <td>
        1.5å€å¢é•¿
       </td>
       <td>
        æ–æ³¢é‚£å¥‘æ•°åˆ—é€¼è¿‘ ğŸŒŠ
       </td>
       <td>
        å¹³è¡¡å†…å­˜ä¸æ‰©å®¹æ¬¡æ•°
       </td>
      </tr>
      <tr>
       <td>
        Arrays.copyOf
       </td>
       <td>
        å†…å­˜è¿ç»­åˆ†é… ğŸ“
       </td>
       <td>
        è¶…å¤§æ•°ç»„æ‰©å®¹å¡é¡¿é£é™©
       </td>
      </tr>
     </tbody>
    </table>
    <h4>
     <a id="12__31">
     </a>
     1.2 æ‰©å®¹æµç¨‹å¯è§†åŒ–
    </h4>
    <p>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/14499dc8c9e64684adbfdb24d3ac9aba.png"/>
    </p>
    <hr/>
    <h3>
     <a id="_HashMap__38">
     </a>
     ç¬¬äºŒç«  HashMap çš„å“ˆå¸Œæˆ˜äº‰
    </h3>
    <h4>
     <a id="21__40">
     </a>
     2.1 æ‰°åŠ¨å‡½æ•°ã®é»‘ç§‘æŠ€
    </h4>
    <pre><code class="prism language-java"><span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">hash</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> h<span class="token punctuation">;</span>
    <span class="token comment">// è®©é«˜ä½å‚ä¸å“ˆå¸Œè¿ç®—ï¼Œå‡å°‘ç¢°æ’ ğŸ’¥</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token punctuation">(</span>h <span class="token operator">=</span> key<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>h <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     ğŸ¯
     <strong>
      å“ˆå¸Œç¢°æ’å¤„ç†æ–¹æ¡ˆå¯¹æ¯”
     </strong>
     ï¼š
    </p>
    <table>
     <thead>
      <tr>
       <th>
        æ–¹æ¡ˆ
       </th>
       <th>
        æ•°æ®ç»“æ„
       </th>
       <th>
        æ—¶é—´å¤æ‚åº¦
       </th>
       <th>
        JDKç‰ˆæœ¬
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        é“¾è¡¨æ³•
       </td>
       <td>
        å•å‘é“¾è¡¨ ğŸš‚
       </td>
       <td>
        O(n)
       </td>
       <td>
        &lt;8
       </td>
      </tr>
      <tr>
       <td>
        çº¢é»‘æ ‘
       </td>
       <td>
        å¹³è¡¡äºŒå‰æ ‘ ğŸŒ³
       </td>
       <td>
        O(logn)
       </td>
       <td>
        â‰¥8
       </td>
      </tr>
      <tr>
       <td>
        å¼€æ”¾å¯»å€
       </td>
       <td>
        çº¿æ€§æ¢æµ‹ ğŸ”
       </td>
       <td>
        O(1)~O(n)
       </td>
       <td>
        å…¶ä»–å®ç°
       </td>
      </tr>
     </tbody>
    </table>
    <h4>
     <a id="22__58">
     </a>
     2.2 æ ‘åŒ–é˜ˆå€¼èƒŒåçš„åšå¼ˆ
    </h4>
    <pre><code class="prism language-java"><span class="token comment">// é“¾è¡¨è½¬çº¢é»‘æ ‘çš„ä¸´ç•Œç‚¹</span>
<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">TREEIFY_THRESHOLD</span> <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>

<span class="token comment">// ä¸ºä»€ä¹ˆæ˜¯8ï¼Ÿç»Ÿè®¡å­¦ã®é­”æ³• ğŸ²</span>
<span class="token comment">/*
* ç†æƒ³å“ˆå¸Œä¸‹é“¾è¡¨é•¿åº¦å‡ºç°8çš„æ¦‚ç‡ï¼š0.00000006
* æ­¤æ—¶æ ‘åŒ–çš„æ”¶ç›Šè¶…è¿‡ç»´æŠ¤æˆæœ¬
*/</span>
</code></pre>
    <hr/>
    <h3>
     <a id="_LinkedList__73">
     </a>
     ç¬¬ä¸‰ç«  LinkedList çš„åŒå‘æš—æ‹
    </h3>
    <h4>
     <a id="31__75">
     </a>
     3.1 èŠ‚ç‚¹ç»“æ„è§£å‰–å›¾
    </h4>
    <pre><code class="prism language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">E</span> item<span class="token punctuation">;</span>          <span class="token comment">// å½“å‰å…ƒç´  ğŸ</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> next<span class="token punctuation">;</span>    <span class="token comment">// ä¸‹ä¸ªèŠ‚ç‚¹ ğŸ‘‰</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> prev<span class="token punctuation">;</span>    <span class="token comment">// ä¸Šä¸ªèŠ‚ç‚¹ ğŸ‘ˆ</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     ğŸ“Š
     <strong>
      å¢åˆ æ“ä½œæ€§èƒ½çœŸç›¸
     </strong>
     ï¼š
    </p>
    <table>
     <thead>
      <tr>
       <th>
        æ“ä½œ
       </th>
       <th>
        ArrayList
       </th>
       <th>
        LinkedList
       </th>
       <th>
        çœŸç›¸å¤§ç™½ ğŸ˜
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        å¤´éƒ¨æ’å…¥
       </td>
       <td>
        O(n)
       </td>
       <td>
        O(1)
       </td>
       <td>
        LinkedListèƒœ
       </td>
      </tr>
      <tr>
       <td>
        éšæœºåˆ é™¤
       </td>
       <td>
        O(n)
       </td>
       <td>
        O(1)
       </td>
       <td>
        ä½†éœ€è¦å…ˆéå†æ‰¾èŠ‚ç‚¹ï¼ğŸ˜±
       </td>
      </tr>
      <tr>
       <td>
        å°¾éƒ¨è¿½åŠ 
       </td>
       <td>
        O(1)
       </td>
       <td>
        O(1)
       </td>
       <td>
        å¹³æ‰‹ ğŸ‘¯
       </td>
      </tr>
     </tbody>
    </table>
    <h4>
     <a id="32__93">
     </a>
     3.2 è¿­ä»£å™¨é™·é˜±æ¼”ç¤º
    </h4>
    <pre><code class="prism language-java"><span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// é”™è¯¯ç¤ºèŒƒï¼šç”¨forå¾ªç¯éšæœºè®¿é—®</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// O(n^2) è­¦å‘Šï¼ğŸ’£</span>
<span class="token punctuation">}</span>

<span class="token comment">// æ­£ç¡®å§¿åŠ¿ï¼šè¿­ä»£å™¨è®¿é—®</span>
<span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> it <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">while</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// O(n) ä¸æ»‘è®¿é—® ğŸ›·</span>
<span class="token punctuation">}</span>
</code></pre>
    <hr/>
    <h3>
     <a id="_ConcurrentHashMap__113">
     </a>
     ç¬¬å››ç«  ConcurrentHashMap çš„çº¿ç¨‹å®‰å…¨ç§˜ç±
    </h3>
    <h4>
     <a id="41___115">
     </a>
     4.1 ğŸ“Œ
     <strong>
      é”æœºåˆ¶å¯¹æ¯”è¡¨
     </strong>
     ï¼š
    </h4>
    <table>
     <thead>
      <tr>
       <th>
        ç‰ˆæœ¬
       </th>
       <th>
        æ•°æ®ç»“æ„
       </th>
       <th>
        é”ç²’åº¦
       </th>
       <th>
        ååé‡æå‡
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        JDK7
       </td>
       <td>
        Segment æ•°ç»„
       </td>
       <td>
        16ä¸ªç‹¬ç«‹åˆ†åŒº ğŸ”’
       </td>
       <td>
        4~6å€
       </td>
      </tr>
      <tr>
       <td>
        JDK8
       </td>
       <td>
        Node+CAS
       </td>
       <td>
        å•ä¸ªé“¾è¡¨å¤´ ğŸ”“
       </td>
       <td>
        10å€+
       </td>
      </tr>
      <tr>
       <td>
        JDK19
       </td>
       <td>
        åç¨‹+æ— é”
       </td>
       <td>
        æ— é”è®¿é—® ğŸš€
       </td>
       <td>
        å®éªŒé˜¶æ®µ
       </td>
      </tr>
     </tbody>
    </table>
    <h4>
     <a id="42_size__123">
     </a>
     4.2 size() æ–¹æ³•ã®ç»Ÿè®¡å­¦é­”æœ¯
    </h4>
    <pre><code class="prism language-java"><span class="token comment">// é«˜å¹¶å‘ä¸‹çš„sizeè®¡ç®—ç­–ç•¥</span>
<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">long</span> n <span class="token operator">=</span> <span class="token function">sumCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">0L</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token constant">MAX_VALUE</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token constant">MAX_VALUE</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// åˆ†ç‰‡è®¡æ•°å‡å°‘ç«äº‰ ğŸ¯</span>
<span class="token keyword">final</span> <span class="token keyword">long</span> <span class="token function">sumCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">CounterCell</span><span class="token punctuation">[</span><span class="token punctuation">]</span> as <span class="token operator">=</span> counterCells<span class="token punctuation">;</span> 
    <span class="token keyword">long</span> sum <span class="token operator">=</span> baseCount<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>as <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">CounterCell</span> a <span class="token operator">:</span> as<span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                sum <span class="token operator">+=</span> a<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> sum<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="43_putVal__145">
     </a>
     4.3 putVal() æ–¹æ³•æºç æ‹†è§£
    </h4>
    <pre><code class="prism language-java"><span class="token keyword">final</span> <span class="token class-name">V</span> <span class="token function">putVal</span><span class="token punctuation">(</span><span class="token class-name">K</span> key<span class="token punctuation">,</span> <span class="token class-name">V</span> value<span class="token punctuation">,</span> <span class="token keyword">boolean</span> onlyIfAbsent<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// å“ˆå¸Œæ‰°åŠ¨åŠ å¼ºç‰ˆ ğŸŒªï¸</span>
    <span class="token keyword">int</span> hash <span class="token operator">=</span> <span class="token function">spread</span><span class="token punctuation">(</span>key<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> binCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab <span class="token operator">=</span> table<span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> f<span class="token punctuation">;</span> <span class="token keyword">int</span> n<span class="token punctuation">,</span> i<span class="token punctuation">,</span> fh<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>tab <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token punctuation">(</span>n <span class="token operator">=</span> tab<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
            tab <span class="token operator">=</span> <span class="token function">initTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å»¶è¿Ÿåˆå§‹åŒ–</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>f <span class="token operator">=</span> <span class="token function">tabAt</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span> i <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> hash<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">casTabAt</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">// CAS æ— é”æ’å…¥æˆåŠŸï¼</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>fh <span class="token operator">=</span> f<span class="token punctuation">.</span>hash<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">MOVED</span><span class="token punctuation">)</span>
            tab <span class="token operator">=</span> <span class="token function">helpTransfer</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ååŠ©æ‰©å®¹</span>
        <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// çœŸæ­£çš„é”ç«äº‰åŒº ğŸ’¥</span>
            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>f<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">tabAt</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token operator">==</span> f<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// é“¾è¡¨/çº¢é»‘æ ‘æ’å…¥é€»è¾‘...</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">addCount</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">,</span> binCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     ğŸ¯
     <strong>
      å…³é”®æ“ä½œæµç¨‹å›¾
     </strong>
     ï¼š
    </p>
    <p>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/56b570b2c2e94df7ac79a6e2091fd6dd.png"/>
    </p>
    <hr/>
    <h3>
     <a id="__184">
     </a>
     ğŸ”¥ æ€§èƒ½è°ƒä¼˜é»„é‡‘æ³•åˆ™
    </h3>
    <pre><code class="prism language-java"><span class="token comment">// ArrayList æœ€ä½³å®è·µ</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">100_0000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é¢„åˆ†é…å®¹é‡ ğŸš€</span>

<span class="token comment">// HashMap é˜²å‘æŒ‡å—</span>
<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">0.75f</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ§åˆ¶è´Ÿè½½å› å­ âš–ï¸</span>

<span class="token comment">// LinkedList ä½¿ç”¨ç¦åŒº</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>éœ€è¦éšæœºè®¿é—®<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"åˆ«ç”¨æˆ‘ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> ğŸ’£
<span class="token punctuation">}</span>
</code></pre>
    <hr/>
    <h3>
     <a id="_LinkedHashMap__203">
     </a>
     ç¬¬äº”ç«  LinkedHashMap çš„æ—¶ç©ºç©¿æ¢­æœ¯
    </h3>
    <h4>
     <a id="51__205">
     </a>
     5.1 åŒå‘é“¾è¡¨ç»“æ„å¤§æ›å…‰
    </h4>
    <pre><code class="prism language-java"><span class="token comment">// ç»§æ‰¿è‡ª HashMap.Node çš„è¶…çº§èŠ‚ç‚¹ ğŸ¦¸</span>
<span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">extends</span> <span class="token class-name">HashMap<span class="token punctuation">.</span>Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> before<span class="token punctuation">,</span> after<span class="token punctuation">;</span> <span class="token comment">// æ—¶ç©ºéš§é“å…¥å£ ğŸ•³ï¸</span>
    <span class="token class-name">Entry</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> <span class="token class-name">K</span> key<span class="token punctuation">,</span> <span class="token class-name">V</span> value<span class="token punctuation">,</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> next<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> next<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// ç»´æŠ¤è®¿é—®é¡ºåºçš„æ ¸å¿ƒä»£ç  ğŸ”—</span>
<span class="token keyword">void</span> <span class="token function">afterNodeAccess</span><span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> last<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>accessOrder <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>last <span class="token operator">=</span> tail<span class="token punctuation">)</span> <span class="token operator">!=</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// æŠŠæœ€è¿‘è®¿é—®çš„èŠ‚ç‚¹ç§»åŠ¨åˆ°é“¾è¡¨å°¾éƒ¨</span>
        <span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> p <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span>e<span class="token punctuation">,</span> b <span class="token operator">=</span> p<span class="token punctuation">.</span>before<span class="token punctuation">,</span> a <span class="token operator">=</span> p<span class="token punctuation">.</span>after<span class="token punctuation">;</span>
        p<span class="token punctuation">.</span>after <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>b <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            head <span class="token operator">=</span> a<span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            b<span class="token punctuation">.</span>after <span class="token operator">=</span> a<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            a<span class="token punctuation">.</span>before <span class="token operator">=</span> b<span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            last <span class="token operator">=</span> b<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>last <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            head <span class="token operator">=</span> p<span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            p<span class="token punctuation">.</span>before <span class="token operator">=</span> last<span class="token punctuation">;</span>
            last<span class="token punctuation">.</span>after <span class="token operator">=</span> p<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        tail <span class="token operator">=</span> p<span class="token punctuation">;</span>
        <span class="token operator">++</span>modCount<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="52_LRU__243">
     </a>
     5.2 LRU ç¼“å­˜å®ç°åŸç†
    </h4>
    <pre><code class="prism language-java"><span class="token comment">// å®ç°ç®€æ˜“ LRU ç¼“å­˜ ğŸ—‚ï¸</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LRUCache</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">extends</span> <span class="token class-name">LinkedHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> maxCapacity<span class="token punctuation">;</span>
  
    <span class="token keyword">public</span> <span class="token class-name">LRUCache</span><span class="token punctuation">(</span><span class="token keyword">int</span> maxCapacity<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>maxCapacity<span class="token punctuation">,</span> <span class="token number">0.75f</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>maxCapacity <span class="token operator">=</span> maxCapacity<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">boolean</span> <span class="token function">removeEldestEntry</span><span class="token punctuation">(</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> eldest<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> maxCapacity<span class="token punctuation">;</span> <span class="token comment">// è‡ªåŠ¨æ·˜æ±°æœ€æ—§å…ƒç´  ğŸ—‘ï¸</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// ä½¿ç”¨ç¤ºä¾‹ï¼š</span>
<span class="token class-name">LRUCache</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LRUCache</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"user_9527"</span><span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ’å…¥æ–°æ•°æ®</span>
cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"user_1234"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// è®¿é—®æ•°æ®ä¼šæå‡æ–°é²œåº¦</span>
</code></pre>
    <hr/>
    <h3>
     <a id="_PriorityQueue__269">
     </a>
     ç¬¬å…­ç«  PriorityQueue çš„å †æ’åºé­”æ³•
    </h3>
    <h4>
     <a id="61__271">
     </a>
     6.1 æœ€å°å †å®ç°åŸç†
    </h4>
    <pre><code class="prism language-java"><span class="token comment">// ä¼˜å…ˆé˜Ÿåˆ—çš„éª¨æ¶æ•°ç»„ç»“æ„ ğŸ¦´</span>
<span class="token keyword">transient</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> queue<span class="token punctuation">;</span> 

<span class="token comment">// å…ƒç´ æ’å…¥æ—¶çš„ä¸Šæµ®æ“ä½œ ğŸŒŠ</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">siftUp</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">,</span> <span class="token class-name">E</span> x<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>comparator <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token function">siftUpUsingComparator</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        <span class="token function">siftUpComparable</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">siftUpComparable</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">,</span> <span class="token class-name">E</span> x<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Comparable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> key <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Comparable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">E</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span> x<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>k <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> parent <span class="token operator">=</span> <span class="token punctuation">(</span>k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// æ‰¾çˆ¶èŠ‚ç‚¹ä½ç½®</span>
        <span class="token class-name">Object</span> e <span class="token operator">=</span> queue<span class="token punctuation">[</span>parent<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>key<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">E</span><span class="token punctuation">)</span> e<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        queue<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span> <span class="token comment">// çˆ¶èŠ‚ç‚¹ä¸‹æ²‰</span>
        k <span class="token operator">=</span> parent<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    queue<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> key<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     ğŸ“Š
     <strong>
      å †æ“ä½œå¤æ‚åº¦è¡¨
     </strong>
     ï¼š
    </p>
    <table>
     <thead>
      <tr>
       <th>
        æ“ä½œ
       </th>
       <th>
        æ—¶é—´å¤æ‚åº¦
       </th>
       <th>
        åŸç†è¯´æ˜
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        æ’å…¥å…ƒç´ 
       </td>
       <td>
        O(logn)
       </td>
       <td>
        ä¸Šæµ®æ“ä½œè°ƒæ•´å †ç»“æ„ ğŸŒŠ
       </td>
      </tr>
      <tr>
       <td>
        å–å‡ºé˜Ÿé¦–
       </td>
       <td>
        O(logn)
       </td>
       <td>
        ä¸‹æ²‰æ“ä½œé‡å»ºå †ç»“æ„ âš“
       </td>
      </tr>
      <tr>
       <td>
        æŸ¥çœ‹é˜Ÿé¦–
       </td>
       <td>
        O(1)
       </td>
       <td>
        ç›´æ¥è¿”å›å †é¡¶å…ƒç´  ğŸ”ï¸
       </td>
      </tr>
      <tr>
       <td>
        æ‰¹é‡å»ºå †
       </td>
       <td>
        O(n)
       </td>
       <td>
        Floyd ç®—æ³•ä¼˜åŒ– ğŸš€
       </td>
      </tr>
     </tbody>
    </table>
    <h4>
     <a id="62__308">
     </a>
     6.2 å †ç»“æ„å¯è§†åŒ–
    </h4>
    <p>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/395187d1a01e4c41bd567143f7465250.png"/>
    </p>
    <hr/>
    <h3>
     <a id="__315">
     </a>
     ğŸ› ï¸ æ‰‹æ’•æºç æŒ‘æˆ˜èµ›
    </h3>
    <h4>
     <a id="ConcurrentHashMap__317">
     </a>
     æŒ‘æˆ˜ä¸€ï¼šConcurrentHashMap æ‰©å®¹è§¦å‘å™¨
    </h4>
    <pre><code class="prism language-java"><span class="token comment">// æ‰¾å‡ºè§¦å‘æ‰©å®¹çš„éšè—æ¡ä»¶</span>
<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">addCount</span><span class="token punctuation">(</span><span class="token keyword">long</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> check<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// å½“ counterCells ä¸ä¸ºç©ºæ—¶...</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>check <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab<span class="token punctuation">,</span> nt<span class="token punctuation">;</span> <span class="token keyword">int</span> n<span class="token punctuation">,</span> sc<span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>s <span class="token operator">&gt;=</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token punctuation">(</span>sc <span class="token operator">=</span> sizeCtl<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>tab <span class="token operator">=</span> table<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span>
               <span class="token punctuation">(</span>n <span class="token operator">=</span> tab<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token constant">MAXIMUM_CAPACITY</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// ç¥ç§˜æ‰©å®¹ä¿¡å· ğŸš¨</span>
            <span class="token keyword">int</span> rs <span class="token operator">=</span> <span class="token function">resizeStamp</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>sc <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>sc <span class="token operator">&gt;&gt;&gt;</span> <span class="token constant">RESIZE_STAMP_SHIFT</span><span class="token punctuation">)</span> <span class="token operator">!=</span> rs <span class="token operator">||</span> sc <span class="token operator">==</span> rs <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">||</span>
                    sc <span class="token operator">==</span> rs <span class="token operator">+</span> <span class="token constant">MAX_RESIZERS</span> <span class="token operator">||</span> <span class="token punctuation">(</span>nt <span class="token operator">=</span> nextTable<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span>
                    transferIndex <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">U</span><span class="token punctuation">.</span><span class="token function">compareAndSwapInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token constant">SIZECTL</span><span class="token punctuation">,</span> sc<span class="token punctuation">,</span> sc <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token function">transfer</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span> nt<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// å°è¯•å‘èµ·æ‰©å®¹çš„çº¿ç¨‹ä¼šèµ°åˆ°è¿™é‡Œ ğŸ’ª</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">U</span><span class="token punctuation">.</span><span class="token function">compareAndSwapInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token constant">SIZECTL</span><span class="token punctuation">,</span> sc<span class="token punctuation">,</span>
                                         <span class="token punctuation">(</span>rs <span class="token operator">&lt;&lt;</span> <span class="token constant">RESIZE_STAMP_SHIFT</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token function">transfer</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            s <span class="token operator">=</span> <span class="token function">sumCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="PriorityQueue__347">
     </a>
     æŒ‘æˆ˜äºŒï¼šPriorityQueue å †æ’åºç¼ºé™·
    </h4>
    <pre><code class="prism language-java"><span class="token comment">// å±é™©æ“ä½œï¼šç›´æ¥ä¿®æ”¹é˜Ÿåˆ—å…ƒç´ </span>
<span class="token class-name">PriorityQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PriorityQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
queue<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"Alice"</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
queue<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ä½œæ­»ä¿®æ”¹åˆ†æ•°å¯¼è‡´å †ç»“æ„ç ´å ğŸ’£</span>
queue<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>score <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span> 
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>queue<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¾“å‡ºç»“æœå¯èƒ½ä¸ç¬¦åˆé¢„æœŸï¼</span>

<span class="token comment">// æ­£ç¡®åšæ³•ï¼šåˆ é™¤åé‡æ–°æ’å…¥</span>
<span class="token class-name">Student</span> s <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
s<span class="token punctuation">.</span>score <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <hr/>
    <h4>
     <a id="__368">
     </a>
     ğŸ§˜â™‚ï¸ ä¸‹æœŸé¢„å‘Šï¼šã€Šé›†åˆæ¡†æ¶çš„æš—é»‘æ–™ç†â€”â€”å¼±å¼•ç”¨ä¸å¹½çµé˜Ÿåˆ—ã€‹ğŸ‘»
    </h4>
    <pre><code class="prism language-markdown">// å½©è›‹ä»£ç ï¼šHashMap çš„éšè—è¿­ä»£å™¨
final class KeyIterator extends HashIterator 
    implements Iterator&lt;K&gt;, Spliterator&lt;K&gt; {
    public final K next() { return nextNode().key; }
}
// å¿«é€Ÿå¤±è´¥ï¼ˆfail-fastï¼‰æœºåˆ¶çš„å®ç°ç§˜å¯† ğŸ”
</code></pre>
    <blockquote>
     <p>
      ğŸŒŸ
      <strong>
       ç»ˆæé¢†æ‚Ÿ
      </strong>
      ï¼šè¯»æºç å°±åƒç ´æ¡ˆï¼Œæ¯ä¸ªè®¾è®¡éƒ½æ˜¯æƒè¡¡çš„è‰ºæœ¯ï¼ä¸‹æ¬¡é¢è¯•è¢«é—®HashMapåŸç†æ—¶ï¼Œè¯·ä¼˜é›…åœ°ç”©å‡ºçº¢é»‘æ ‘é˜ˆå€¼è®¡ç®—å…¬å¼ ğŸŒˆ
     </p>
    </blockquote>
    <pre><code class="prism language-java"><span class="token comment">// å½©è›‹ï¼šHashMap æ ‘åŒ–é˜ˆå€¼è®¡ç®—å…¬å¼</span>
<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">TREEIFY_THRESHOLD</span> <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
<span class="token comment">// ä¸ºä»€ä¹ˆæ˜¯8ï¼Ÿå› ä¸º log8 = 3, åœ¨O(logn)å’ŒO(n)ä¹‹é—´æ‰¾åˆ°å¹³è¡¡ç‚¹ âš–ï¸</span>
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
  <div class="blog-extension-box" id="blogExtensionBox" style="width:400px;margin:auto;margin-top:12px">
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f7778647a756973686175692f:61727469636c652f64657461696c732f313436313930393632" class_="artid" style="display:none">
 </p>
</div>


