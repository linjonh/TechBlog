---
arturl_encode: "68747470733a2f2f626c6f67:2e6373646e2e6e65742f7a68616e67636f6e6779693432302f:61727469636c652f64657461696c732f313435353032333931"
layout: post
title: "AIGCOpenAI-é›†æˆ-Langchain-æ“ä½œå®æˆ˜ä½¿ç”¨è¯¦è§£"
date: 2025-03-13 21:30:58 +08:00
description: "OpenAI é›†æˆ Langchain æ“ä½œå®æˆ˜ä½¿ç”¨è¯¦è§£"
keywords: "ã€AIGCã€‘OpenAI é›†æˆ Langchain æ“ä½œå®æˆ˜ä½¿ç”¨è¯¦è§£"
categories: ['æ¶æ„æŠ€æœ¯æ ˆ', 'æŠ€æœ¯æ€»ç»“', 'åˆ†å¸ƒå¼æŠ€æœ¯']
tags: ['Langchain', 'Langchain', 'Langchain', 'Langchain', 'Langchain']
artid: "145502391"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=145502391
    alt: "AIGCOpenAI-é›†æˆ-Langchain-æ“ä½œå®æˆ˜ä½¿ç”¨è¯¦è§£"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=145502391
featuredImagePreview: https://bing.ee123.net/img/rand?artid=145502391
cover: https://bing.ee123.net/img/rand?artid=145502391
image: https://bing.ee123.net/img/rand?artid=145502391
img: https://bing.ee123.net/img/rand?artid=145502391
---

# ã€AIGCã€‘OpenAI é›†æˆ Langchain æ“ä½œå®æˆ˜ä½¿ç”¨è¯¦è§£

---

## ä¸€ã€å‰è¨€

OpenAIä½œä¸ºäººå·¥æ™ºèƒ½é¢†åŸŸçš„å…ˆé”‹ï¼Œå…¶æä¾›çš„APIä¸ºå¼€å‘è€…æ‰“å¼€äº†æ„å»ºæ™ºèƒ½åº”ç”¨çš„å¤§é—¨ã€‚è€Œä½œä¸ºLLMé¢†åŸŸçš„ä½¼ä½¼è€…Langchainï¼Œéšç€RAGåœ¨ä¼—å¤šçš„é¢†åŸŸè¿›è¡Œè½åœ°å®è·µï¼ŒLangchaninçš„çƒ­åº¦ä¹Ÿè¶Šæ¥è¶Šé«˜ï¼Œç„¶è€Œï¼Œæƒ³è¦åœ¨å®é™…é¡¹ç›®ä¸­æœ‰æ•ˆåˆ©ç”¨Langchaninæä¾›çš„å„ç§èƒ½åŠ›ï¼Œäº†è§£å¦‚ä½•ä½¿ç”¨Langchainè¿›è¡Œé›†æˆæ˜¯éå¸¸é‡è¦çš„ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨OpenAIé›†æˆLangchainï¼Œå¹¶ä½¿ç”¨Langchainçš„å„ç§æ ¸å¿ƒç»„ä»¶èƒ½åŠ›ã€‚

## äºŒã€å‰ç½®å‡†å¤‡

åœ¨æ­£å¼å¼€å§‹ä½¿ç”¨Langchainä¹‹å‰ï¼Œä½ éœ€è¦åœ¨æœ¬åœ°å‡†å¤‡åŸºç¡€çš„å¼€å‘å’Œè¿è¡Œç¯å¢ƒï¼Œæ¯”å¦‚pythonç¯å¢ƒã€Langchainç»„ä»¶ç­‰ï¼Œå‚è€ƒä¸‹é¢çš„æ“ä½œæ­¥éª¤å³å¯ã€‚

### 2.1 å®‰è£… Langchainå¿…é¡»çš„ä¾èµ–

#### 2.1.1 pythonç¯å¢ƒ

å»ºè®®ç‰ˆæœ¬ 3.10

![](https://i-blog.csdnimg.cn/direct/2ba1bc9956c3452cb499f9b011865b48.png)

#### 

#### 2.1.2 langchain openai ç¯å¢ƒ

ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤è¿›è¡Œå®‰è£…

```bash
pip install langchain openai
```

#### 

#### 2.1.3 å‡†å¤‡ä¸€ä¸ªapikey

åé¢ç¨‹åºä¸­è°ƒç”¨APIæ—¶å€™éœ€è¦ç”¨åˆ°

#### 2.1.4 langchain æ ¸å¿ƒç»„ä»¶

langchain å®˜ç½‘åœ°å€å¦‚ä¸‹ï¼š
[ChatOpenAI | ğŸ¦œï¸ğŸ”— LangChain](https://python.langchain.com/v0.2/docs/integrations/chat/openai/ "ChatOpenAI | ğŸ¦œï¸ğŸ”— LangChain")

![](https://i-blog.csdnimg.cn/direct/3e9f34d93fec418cba109032cb6f7d8b.png)

> å¯ä»¥åŸºäºæ­¤æ–‡æ¡£æŸ¥çœ‹langchainæä¾›çš„å„ä¸ªç»„ä»¶ä»¥åŠAPI

## ä¸‰ã€Langchain å„ç»„ä»¶ä½¿ç”¨

æ¥ä¸‹æ¥å°†é€šè¿‡å®é™…æ¡ˆä¾‹å±•ç¤ºLangchain å„ç»„ä»¶çš„è¯¦ç»†ä½¿ç”¨

### 3.1Â Chat modelsç»„ä»¶

æ–‡æ¡£åœ°å€ï¼š
[Chat models | ğŸ¦œï¸ğŸ”— LangChain](https://python.langchain.com/v0.2/docs/integrations/chat/ "Chat models | ğŸ¦œï¸ğŸ”— LangChain")
ï¼Œå®˜æ–¹å±•ç¤ºäº†å¯ä»¥å¯¹æ¥LangChainçš„å¤šç§å¤§æ¨¡å‹ï¼Œè¿™é‡Œé€‰æ‹©ChatOpenAiï¼›

![](https://i-blog.csdnimg.cn/direct/2aed52695e774397b4cba1fdb9731e29.png)

æ‰§è¡Œä¸‹é¢å‘½ä»¤å®‰è£…ä¾èµ–ç»„ä»¶

```bash
pip install -qU langchain-openai
```

#### 3.1.1 Invocation ä½¿ç”¨

å‚è€ƒå®˜æ–¹æä¾›æ¡ˆä¾‹

![](https://i-blog.csdnimg.cn/direct/0c466eae8760458ba64eebfd057beaf0.png)

ç„¶åç¼–å†™è‡ªå·±çš„ä»£ç ï¼Œå¦‚ä¸‹ï¼š

```python

#langchainèŠå¤©çš„æç¤ºè¯æ¨¡æ¿
from langchain_core.prompts import ChatPromptTemplate

#langchainçš„openaiçš„sdk
from langchain_openai import ChatOpenAI

llm = ChatOpenAI(
    # æ­¤å¤„éœ€è¦å¡«å…¥openaiçš„keyï¼Œå¯ä»¥ç›´æ¥å¡«å…¥ï¼Œä½†å»ºè®®æœ€å¥½å¯ä»¥é…ç½®åˆ°æœ¬åœ°ç¯å¢ƒå˜é‡ä¸­
    api_key ='sk-...'
)

messages = [
    (
        "system",
        "You are a helpful assistant that translates English to Chinese. Translate the user sentence.",
    ),
    ("human", "I love programming."),
]
ai_msg = llm.invoke(messages)
print(ai_msg)
```

è¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œå¯ä»¥çœ‹åˆ°ç›®æ ‡çš„è‹±æ–‡è¢«ç¿»è¯‘æˆäº†ä¸­æ–‡

![](https://i-blog.csdnimg.cn/direct/95be93311a954bf5b558e3f72b95f9cb.png)

æˆ–è€…ä½¿ç”¨ä¸‹é¢çš„è¿™ç§å†™æ³•ä¹Ÿæ˜¯å¯ä»¥çš„

```python
#langchainèŠå¤©çš„æç¤ºè¯æ¨¡æ¿
from langchain_core.prompts import ChatPromptTemplate
from langchain_core.messages import SystemMessage, HumanMessage

#langchainçš„openaiçš„sdk
from langchain_openai import ChatOpenAI

#llm=ChatOpenAI()

model = ChatOpenAI(
    # æ­¤å¤„éœ€è¦å¡«å…¥openaiçš„keyï¼Œå¯ä»¥ç›´æ¥å¡«å…¥ï¼Œä½†å»ºè®®æœ€å¥½å¯ä»¥é…ç½®åˆ°æœ¬åœ°ç¯å¢ƒå˜é‡ä¸­
    api_key ='sk-...'
)

msg=[
    SystemMessage(content="è¯·å°†ä¸‹é¢çš„å†…å®¹ç¿»è¯‘æˆè‹±è¯­."), 
    HumanMessage(content="ä½ å¥½ï¼Œè¯·é—®ä½ è¦å»å“ªé‡Œ")
]

res = model.invoke(msg)
print(res)

```

![](https://i-blog.csdnimg.cn/direct/bdef994309544803b222f7933751a63c.png)

##### 3.1.1.1 ç»“æœè§£æ

å¦‚æœä¸Šé¢çš„è¾“å‡ºç»“æœçœ‹èµ·æ¥ä¸å¤Ÿç›´è§‚ï¼Œlangchainçš„åŒ…é‡Œé¢è¿˜æä¾›äº†å†…å®¹è§£æçš„å·¥å…·ï¼Œåªéœ€è¦å¯¼å…¥StrOutputParseråŒ…å³å¯

```python
#langchainèŠå¤©çš„æç¤ºè¯æ¨¡æ¿
from langchain_core.prompts import ChatPromptTemplate

#langchainçš„openaiçš„sdk
from langchain_openai import ChatOpenAI
from langchain_core.output_parsers import StrOutputParser

#llm=ChatOpenAI()

llm = ChatOpenAI(
    # æ­¤å¤„éœ€è¦å¡«å…¥openaiçš„keyï¼Œå¯ä»¥ç›´æ¥å¡«å…¥ï¼Œä½†å»ºè®®æœ€å¥½å¯ä»¥é…ç½®åˆ°æœ¬åœ°ç¯å¢ƒå˜é‡ä¸­
    api_key ='sk-...'
)

prompt=ChatPromptTemplate.from_messages([
    ("system","æ‚¨æ˜¯ä¸–ç•Œçº§çš„æŠ€æœ¯ä¸“å®¶."),
    ("user","{input}"),
])

#é€šè¿‡langciançš„é“¾å¼è°ƒç”¨ï¼Œç”Ÿæˆä¸€ä¸ªæç¤ºè¯çš„chain
chain=prompt | llm

result=chain.invoke({"input":"å¸®æˆ‘å†™ä¸€ç¯‡AIçš„æŠ€æœ¯æ–‡ç« ï¼Œ100å­—ä»¥å†…"})

print(result)

parser = StrOutputParser()
parser_str = parser.invoke(result)
print(parser_str)
```

å†æ¬¡è¿è¡Œä¸Šé¢çš„ç¨‹åºï¼Œæ­¤æ—¶å¾—åˆ°çš„å°±æ˜¯çº¯ç²¹çš„å†…å®¹äº†

![](https://i-blog.csdnimg.cn/direct/6599dff5c316493c94f80761810ad8df.png)

### 3.2 æç¤ºè¯æ¨¡æ¿

#### 3.2.1 ä»€ä¹ˆæ˜¯æç¤ºè¯æ¨¡æ¿

è¯­è¨€æ¨¡å‹ä»¥æ–‡æœ¬ä½œä¸ºè¾“å…¥ï¼Œè¿™ä¸ªæ–‡æœ¬é€šå¸¸è¢«ç§°ä¸ºæç¤ºè¯ï¼Œåœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¯¹äºæç¤ºè¯æ¥è¯´ä¸èƒ½ç›´æ¥ç¡¬ç¼–ç ï¼Œè¿™æ ·ä¸åˆ©äºæç¤ºè¯ç®¡ç†ï¼Œè€Œæ˜¯é€šè¿‡æç¤ºè¯æ¨¡æ¿è¿›è¡Œç»´æŠ¤ï¼Œç±»ä¼¼äºå¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„çŸ­ä¿¡æ¨¡æ¿ï¼Œé‚®ä»¶æ¨¡æ¿ç­‰ã€‚

> æç¤ºè¯æ¨¡æ¿æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–‡æœ¬ï¼Œå®ƒ å¯ä»¥ä¸ºç‰¹å®šä»»åŠ¡æä¾›é¢å¤–çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚ åœ¨LLM åº” ç”¨ä¸­ï¼Œç”¨æˆ·è¾“å…¥é€šå¸¸ä¸ç›´æ¥è¢«ä¼ é€’ç»™æ¨¡å‹æœ¬èº«ï¼Œ è€Œæ˜¯è¢«æ·»åŠ åˆ°ä¸€ä¸ªæ›´å¤§çš„æ–‡æœ¬ï¼Œå³æç¤ºè¯æ¨¡æ¿ä¸­ã€‚æç¤ºè¯æ¨¡æ¿ä¸ºå½“å‰çš„å…·ä½“ä»»åŠ¡æä¾›äº†é¢å¤–çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè¿™èƒ½å¤Ÿæ›´å¥½åœ°å¼•å¯¼æ¨¡å‹ç”Ÿæˆé¢„æœŸçš„è¾“å‡ºã€‚

ä¸€ä¸ªæç¤ºè¯æ¨¡æ¿é€šå¸¸åŒ…å«å¦‚ä¸‹å†…å®¹ï¼š

* å‘ç»™å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰æŒ‡ä»¤ï¼›
* ä¸€ç»„é—®ç­”ç¤ºä¾‹ï¼Œä»¥å‘Šè¯‰AIä»¥ä»€ä¹ˆæ ¼å¼è¿”å›è¯·æ±‚ï¼›
* å‘ç»™å¤§è¯­è¨€æ¨¡å‹çš„é—®é¢˜ï¼›

#### 3.2.2 åˆ›å»ºæç¤ºè¯æ¨¡æ¿

åœ¨LangChainä¸­ï¼Œæœ€ç®€å•çš„ï¼Œå¯ä»¥ä½¿ç”¨PromptTemplateç±»åˆ›å»ºç®€å•çš„æç¤ºè¯æ¨¡æ¿ã€‚åœ¨æç¤ºè¯æ¨¡æ¿å¯ä»¥å†…åµŒä»»æ„æ•°é‡çš„æ¨¡æ¿å‚æ•°ï¼Œç„¶åé€šè¿‡å‚æ•°å€¼æ ¼å¼åŒ–æ¨¡æ¿å†…å®¹ã€‚

> ä¹Ÿå¯ä»¥ä½¿ç”¨MessagePromptTemplateæ¥åˆ›å»ºæç¤ºè¯æ¨¡æ¿ã€‚å¯ä»¥ç”¨ä¸€ä¸ªæˆ–å¤šMessagePromptTemplateåˆ›å»ºä¸€ä¸ªChatPromptTemplate

å¦‚ä¸‹ç¤ºä¾‹

```python
from langchain.prompts.chat import(
    ChatPromptTemplate,
    SystemMessagePromptTemplate,
    HumanMessagePromptTemplate,
)

template =
(
    "You are a helpful assistant that translates [input_languagel to""(output_language}."
)

system_message_prompt=
    SystemMessagePromptTemplate.from_template(template)
    human_template ="(text}"human_message_prompt
    HumanMessagePromptTemplate.from_template(human_template)
    chat_prompt =ChatPromptTemplate.from_messages([
    system_message_prompt,
    human_message_prompt

chat_prompt.format_messages(input_language="English",output_language="French",text="I love programming."
```

ä¸Šè¿°ä»£ç é¦–å…ˆå®šä¹‰äº†ä¸¤ä¸ªæ¨¡æ¿ï¼š

* ä¸€ä¸ªæ˜¯ç³»ç»Ÿæ¶ˆæ¯æ¨¡æ¿ï¼Œæè¿°äº†ä»»åŠ¡çš„ä¸Šä¸‹æ–‡(ç¿»è¯‘åŠ©æ‰‹çš„è§’è‰²å’Œç¿»è¯‘ä»»åŠ¡);
* å¦ä¸€ä¸ªæ˜¯äººç±»æ¶ˆæ¯æ¨¡æ¿ï¼Œå…¶ä¸­çš„å†…å®¹æ˜¯ç”¨æˆ·çš„è¾“å…¥ã€‚ç„¶åï¼Œä½¿ç”¨ChatPromptTemplateçš„from\_messagesæ–¹æ³•å°†è¿™ä¸¤ä¸ªæ¨¡æ¿ç»“åˆèµ·æ¥ï¼Œç”Ÿæˆä¸€ä¸ªèŠå¤©æç¤ºè¯æ¨¡æ¿ã€‚
* å½“æƒ³è¦æ£€æŸ¥å‘é€ç»™æ¨¡å‹çš„æç¤ºè¯æ˜¯å¦ç¡®å®ä¸é¢„æœŸçš„æç¤ºè¯ç›¸ç¬¦æ—¶ï¼Œå¯ä»¥è°ƒç”¨ChatPromptTemplateçš„format\_messagesæ–¹æ³•ï¼ŒæŸ¥çœ‹è¯¥æç¤ºè¯æ¨¡æ¿çš„æœ€ç»ˆå‘ˆç°

```python
msg=[
    SystemMessage(content="è¯·å°†ä¸‹é¢çš„å†…å®¹ç¿»è¯‘æˆè‹±è¯­."), 
    HumanMessage(content="ä½ å¥½ï¼Œè¯·é—®ä½ è¦å»å“ªé‡Œ")
]
```

é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä¸ä»…å¯ä»¥è®©èŠå¤©æ¨¡å‹åŒ…è£…å™¨ç”Ÿæˆé¢„æœŸçš„è¾“å‡ºï¼Œå¯¹å¼€å‘è€…æ¥è¯´ï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒæ˜¯å¦ç¬¦åˆæç¤ºè¯æ¶ˆæ¯åˆ—è¡¨çš„æ•°æ®æ ¼å¼ï¼Œåªéœ€è¦æä¾›å…·ä½“çš„ä»»åŠ¡æè¿°å³å¯ã€‚

##### 3.2.2.1 PromptTemplate ç®€å•æç¤ºè¯æ¨¡æ¿

è¿™æ˜¯æœ€ç®€å•çš„ä¸€ç§æç¤ºè¯æ¨¡æ¿ï¼Œè°ƒç”¨PromptTemplateçš„from\_templateæ–¹æ³•ï¼Œåœ¨æ¨¡æ¿å†…å®¹ä¸­é¢„ç•™å ä½ç¬¦ä½œä¸ºåç»­çš„è¾“å…¥å‚æ•°å³å¯

```python
#langchainèŠå¤©çš„æç¤ºè¯æ¨¡æ¿
from langchain_core.prompts import PromptTemplate

prompt_template = PromptTemplate.from_template("ç»™æˆ‘è®²ä¸€ä¸ªå…³äº{topic}çš„å†å²æ•…äº‹")

result = prompt_template.format(topic="è¶³çƒ")

print(result)
```

è¿è¡Œä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°ä¸‹é¢çš„æ•ˆæœï¼Œå¯ä»¥çœ‹åˆ°è°ƒç”¨formatæ–¹æ³•çš„æ—¶å€™ï¼Œæœ€ç»ˆâ€œè¶³çƒâ€å°±ä½œä¸ºå…¥å‚å¸¦å…¥åˆ°æ¨¡æ¿ä¸­è¾“å‡ºäº†

![](https://i-blog.csdnimg.cn/direct/6e1e97b81154476f870213afab3a73c3.png)

##### 3.2.2.2 ChatPromptTemplate èŠå¤©æç¤ºè¯æ¨¡æ¿

å¦‚ä¸‹æ˜¯ä¸€æ®µåŸºæœ¬çš„æç¤ºè¯æ¨¡æ¿ä»£ç æ¡ˆä¾‹ï¼Œè®¾ç½®äº†ä¸¤ä¸ªæ¨¡æ¿å‚æ•°ï¼Œè°ƒç”¨çš„æ—¶å€™åŠ¨æ€ä¼ å…¥

```python
#langchainèŠå¤©çš„æç¤ºè¯æ¨¡æ¿
from langchain_core.prompts import ChatPromptTemplate

#æ•°ç»„çš„æ¯ä¸€ä¸ªå…ƒç´ ä»£è¡¨ä¸€ä¸ªæ¶ˆæ¯ï¼Œæ¯ä¸ªæ¶ˆæ¯å…ƒç»„ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä»£è¡¨æ¶ˆæ¯è§’è‰²ï¼Œç¬¬äºŒä¸ªå‚æ•°ä»£è¡¨æ¶ˆæ¯å†…å®¹
#æ¶ˆæ¯è§’è‰²ï¼šsystemä»£è¡¨ç³»ç»Ÿæ¶ˆæ¯ï¼Œhumanä»£è¡¨äººç±»æ¶ˆæ¯ï¼Œaiä»£è¡¨LLMè¿”å›çš„æ¶ˆæ¯å†…å®¹
#æ¶ˆæ¯å®šä¹‰äº†2ä¸ªæ¨¡æ¿å‚æ•°nameå’Œuser_input
chat_template = ChatPromptTemplate.from_messages(
    [
        ("system","ä½ æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œä½ çš„åå­—æ˜¯{name}"),
        ("human","ä½ å¥½"),
        ("ai","æˆ‘å¾ˆå¥½"),
        ("human","{user_input}")
    ]
)

#é€šè¿‡æ¨¡æ¿å‚æ•°æ ¼å¼åŒ–æ¨¡æ¿å†…å®¹
result = chat_template.format_messages(name="å°æ˜",user_input="ä½ å«ä»€ä¹ˆå")
print(result)
```

è¿è¡Œä¸€ä¸‹çœ‹åˆ°å¦‚ä¸‹çš„æ•ˆæœè¾“å‡º

![](https://i-blog.csdnimg.cn/direct/308eec81db7640ff9618c5b0c1ebfa60.png)

**è¡¥å……ï¼š**

* ChatPromptTemplate ç”¨äºèŠå¤©å¯¹è¯çš„åœºæ™¯ä¸­ï¼›
* åç»­æ¥å…¥å¤§æ¨¡å‹ä¹‹åï¼Œå°±å¯ä»¥å°†å‚æ•°æ‹¼æ¥æ¨¡æ¿ä¸€èµ·ä¼ ç»™å¤§æ¨¡å‹ï¼Œå¤§æ¨¡å‹å°±å¯ä»¥è¿”å›é¢„æœŸçš„ç»“æœäº†

ChatPromptTemplate å³èŠå¤©æ¨¡å‹ï¼ˆChat Modelï¼‰æç¤ºè¯æ¨¡æ¿ï¼ŒèŠå¤©æ¨¡å‹ä»¥èŠå¤©æ¶ˆæ¯åˆ—è¡¨ä½œä¸ºè¾“å…¥ï¼Œè¿™ä¸ªèŠå¤©æ¶ˆæ¯åˆ—è¡¨çš„æ¶ˆæ¯å†…å®¹ä¹Ÿå¯ä»¥é€šè¿‡æç¤ºè¯æ¨¡æ¿è¿›è¡Œç®¡ç†ï¼Œè¿™äº›èŠå¤©æ¶ˆæ¯ä¸åŸå§‹çš„å­—ç¬¦ä¸²ä¸åŒï¼Œå› ä¸ºæ¯ä¸ªæ¶ˆæ¯éƒ½ä¸â€œè§’è‰²ï¼ˆRoleï¼‰â€ç›¸å…³è”ã€‚

ä¾‹å¦‚åœ¨OpenAIçš„Chat Completion APIä¸­ï¼ŒOpenAIçš„èŠå¤©æ¨¡å‹ï¼Œç»™ä¸åŒèŠå¤©æ¶ˆæ¯å®šä¹‰äº†ä¸‰ç§è§’è‰²ç±»å‹ï¼Œåˆ†åˆ«æ˜¯ï¼šåŠ©æ‰‹ï¼ˆAssistantï¼‰ï¼Œäººç±»ï¼ˆHumanï¼‰ï¼Œæˆ–ç³»ç»Ÿï¼ˆSystemï¼‰è§’è‰²ï¼š

* åŠ©æ‰‹ï¼ˆAssistantï¼‰æ¶ˆæ¯æŒ‡çš„æ˜¯å½“å‰æ¶ˆæ¯æ˜¯AIå›ç­”çš„å†…å®¹ï¼›
* äººç±»ï¼ˆHumanï¼‰æ¶ˆæ¯å€¼å¾—æ˜¯ä½ å‘ç»™AIçš„å†…å®¹ï¼›
* ç³»ç»Ÿï¼ˆSystemï¼‰æ¶ˆæ¯é€šå¸¸æ˜¯ç”¨æ¥ç»™AIèº«ä»½è¿›è¡Œæè¿°ï¼›

**ç¤ºä¾‹ä»£ç **

å‚è€ƒä¸‹é¢çš„æ¡ˆä¾‹ä»£ç ï¼Œç»“åˆä»£ç ä¸­çš„æ³¨é‡Šè¿›è¡Œç†è§£ï¼Œåœ¨æç¤ºè¯æ¨¡æ¿ä¸­ï¼Œæˆ‘ä»¬ä¼ å…¥äº†ä¸¤ä¸ªå˜é‡ï¼Œåç»­åœ¨è°ƒç”¨çš„æ—¶å€™ï¼Œåªéœ€è¦ç»™è¿™ä¸¤ä¸ªå˜é‡èµ‹å€¼å³å¯

```python
#langchainèŠå¤©çš„æç¤ºè¯æ¨¡æ¿
from langchain_core.prompts import ChatPromptTemplate
from langchain_core.messages import SystemMessage, HumanMessage
from langchain_core.output_parsers import StrOutputParser

#langchainçš„openaiçš„sdk
from langchain_openai import ChatOpenAI

model = ChatOpenAI(
    # æ­¤å¤„éœ€è¦å¡«å…¥openaiçš„keyï¼Œå¯ä»¥ç›´æ¥å¡«å…¥ï¼Œä½†å»ºè®®æœ€å¥½å¯ä»¥é…ç½®åˆ°æœ¬åœ°ç¯å¢ƒå˜é‡ä¸­
    api_key ='sk-...'
)

#å®šä¹‰æ¨¡æ¿
prompt_template=ChatPromptTemplate.from_messages([
    ("system","æ‚¨æ˜¯ä¸–ç•Œçº§çš„ç¿»è¯‘ä¸“å®¶ï¼Œä½¿ç”¨{language}è¯­è¨€ç¿»è¯‘å¦‚ä¸‹å†…å®¹"),
    ("user","{input}"),
])

#å†…å®¹è¾“å‡ºè§£æå™¨
output_parser=StrOutputParser()

#å¾—åˆ°ä¸€ä¸ªé“¾
chain = prompt_template | model | output_parser

#è¾“å‡ºç»“æœ
result = chain.invoke({'language':'ä¸­æ–‡','input':'hello world'})
print(result)

```

**æˆ–è€…ä½¿ç”¨ä¸‹é¢çš„è¿™ç§å†™æ³•**

* SystemMessageï¼Œå¯¹åº”ç€ä¸Šé¢ä¸€ç§å†™æ³•ä¸­çš„ 'system'ï¼Œç”±langchainè‡ªèº«APIæä¾›
* HumanMessageï¼Œå¯¹åº”ç€ä¸Šé¢ä¸€ç§å†™æ³•ä¸­çš„ 'user'ï¼Œç”±langchainè‡ªèº«APIæä¾›

```python
#langchainèŠå¤©çš„æç¤ºè¯æ¨¡æ¿
from langchain_core.prompts import ChatPromptTemplate
from langchain_core.messages import SystemMessage, HumanMessage

#langchainçš„openaiçš„sdk
from langchain_openai import ChatOpenAI

#llm=ChatOpenAI()

model = ChatOpenAI(
    # æ­¤å¤„éœ€è¦å¡«å…¥openaiçš„keyï¼Œå¯ä»¥ç›´æ¥å¡«å…¥ï¼Œä½†å»ºè®®æœ€å¥½å¯ä»¥é…ç½®åˆ°æœ¬åœ°ç¯å¢ƒå˜é‡ä¸­
    api_key ='sk-...'
)

msg=[
    SystemMessage(content="è¯·å°†ä¸‹é¢çš„å†…å®¹ç¿»è¯‘æˆè‹±è¯­."), 
    HumanMessage(content="ä½ å¥½ï¼Œè¯·é—®ä½ è¦å»å“ªé‡Œ")
]

res = model.invoke(msg)
print(res)
```

##### 3.2.2.3 MessagePlaceholer èŠå¤©æç¤ºè¯æ¨¡æ¿

è¿™ä¸ªæç¤ºè¯æ¨¡æ¿è´Ÿè´£åœ¨ç‰¹å®šçš„ä½ç½®æ·»åŠ æ¶ˆæ¯åˆ—è¡¨ï¼Œåœ¨ä¸Šé¢çš„ChatPromptTemplateä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å¦‚ä½•æ ¼å¼åŒ–ä¸¤æ¡æ¶ˆæ¯ï¼Œæ¯æ¡æ¶ˆæ¯éƒ½æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬å¸Œæœ›ç”¨æˆ·ä¼ å…¥ä¸€ä¸ªæ¶ˆæ¯åˆ—è¡¨ï¼Œå¹¶å°†å…¶æ’å…¥åˆ°ç‰¹å®šçš„ä½ç½®è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿè¿™å°±éœ€è¦ä½¿ç”¨åˆ°MessagePlaceholer çš„æ–¹å¼ã€‚å¦‚ä¸‹ç¤ºä¾‹ä»£ç ï¼š

```python
#langchainèŠå¤©çš„æç¤ºè¯æ¨¡æ¿
from langchain_core.prompts import ChatPromptTemplate,MessagesPlaceholder

from langchain_core.messages import SystemMessage, HumanMessage

prompt_template = ChatPromptTemplate.from_messages([
    ('system', 'You are a helpful assistant '),
    #è¿™é‡Œå¯ä»¥ä¼ å…¥ä¸€ç»„æ¶ˆæ¯
    MessagesPlaceholder('msgs')
])

result = prompt_template.invoke({"msgs":[HumanMessage(content="ä½ å¥½")]})
print(result)
```

![](https://i-blog.csdnimg.cn/direct/970f9573b4c34ef4a42819771f01900d.png)

é€šè¿‡ä¸Šé¢çš„è¿è¡Œç»“æœä¸éš¾çœ‹å‡ºï¼Œç»“æœç”Ÿæˆäº†2æ¡æ¶ˆæ¯ï¼Œç¬¬ä¸€æ¡æ˜¯ç³»ç»Ÿæ¶ˆæ¯ï¼Œç¬¬äºŒæ¡æ˜¯æˆ‘ä»¬ä¼ å…¥çš„HumanMessageï¼Œå¦‚æœæˆ‘ä»¬ä¼ å…¥äº†5æ¡æ¶ˆæ¯ï¼Œé‚£ä¹ˆä¸€å…±ä¼šç”Ÿæˆ6æ¡æ¶ˆæ¯ï¼ˆç³»ç»Ÿæ¶ˆæ¯åŠ ä¸Šä¼ å…¥çš„5æ¡ï¼‰ï¼Œè¿™å¯¹äºå°†ä¸€ç³»åˆ—æ¶ˆæ¯æ’å…¥åˆ°ç‰¹å®šçš„ä½ç½®éå¸¸æœ‰ç”¨ã€‚

è¿˜æœ‰ä¸€ç§å®ç°ç›¸åŒæ•ˆæœçš„çš„æ›¿ä»£æ–¹æ³•æ˜¯ï¼Œä¸ç›´æ¥ä½¿ç”¨MessagesPlaceholderï¼Œè€Œæ˜¯ä¸‹é¢è¿™ç§ï¼š

```python
#langchainèŠå¤©çš„æç¤ºè¯æ¨¡æ¿
from langchain_core.prompts import ChatPromptTemplate,MessagesPlaceholder

from langchain_core.messages import SystemMessage, HumanMessage

prompt_template = ChatPromptTemplate.from_messages([
    ('system', 'You are a helpful assistant '),
    #è¿™é‡Œå¯ä»¥ä¼ å…¥ä¸€ç»„æ¶ˆæ¯
    # MessagesPlaceholder('msgs')
    ('placeholder','{msgs}')
])

result = prompt_template.invoke({"msgs":[HumanMessage(content="ä½ å¥½")]})
print(result)
```

æ•ˆæœæ˜¯ä¸€æ ·çš„

![](https://i-blog.csdnimg.cn/direct/920a412a6eeb4928accd1eea14f011de.png)

##### 3.2.2.4 å°‘æ ·æœ¬æç¤ºè¯æ¨¡æ¿

å³Few-shot prompt template ï¼Œ è¿™ç§æç¤ºè¯æ¨¡æ¿ä¸­åŒ…å«äº†å°‘é‡çš„æ ·æœ¬ä¿¡æ¯ï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†å¸®åŠ©æ¨¡å‹æ›´å¥½çš„ç†è§£ç”¨æˆ·çš„æ„å›¾ï¼Œä»è€Œæ›´å¥½çš„å›ç­”é—®é¢˜æˆ–æ‰§è¡Œä»»åŠ¡ï¼Œå°‘æ ·æœ¬æç¤ºè¯æ¨¡æ¿æ˜¯æŒ‡ä½¿ç”¨ä¸€ç»„å°‘é‡çš„ç¤ºä¾‹æ¥æŒ‡å¯¼æ¨¡å‹å¤„ç†æ–°çš„è¾“å…¥ã€‚ä½¿ç”¨è¿™äº›æç¤ºè¯å¯ä»¥ç”¨æ¥è®­ç»ƒæ¨¡å‹ï¼Œä»¥ä¾¿æ¨¡å‹å¯ä»¥æ›´å¥½çš„ç†è§£æˆ–å›ç­”ç±»ä¼¼çš„é—®é¢˜ã€‚

```bash
Q:é’¢é“ä¾ æ˜¯è°ï¼Ÿ
Aï¼šé’¢é“ä¾ æ˜¯æ¼«å¨ä¸­çš„ä¸€ä¸ªè‹±é›„äººç‰©ã€‚

Q:ä»€ä¹ˆæ˜¯AIå¤§æ¨¡å‹ï¼Ÿ
A:...
```

å‘Šè¯‰æ¨¡å‹ï¼ŒQæ˜¯é—®é¢˜ï¼ŒAæ˜¯ç­”æ¡ˆï¼ŒæŒ‰ç…§è¿™ç§æ ¼å¼è¿›è¡Œäº¤äº’é—®ç­”ã€‚åç»­å¤§æ¨¡å‹åœ¨å›ç­”é—®é¢˜çš„æ—¶å€™ï¼Œå°±ä¼šå‚è€ƒä½ æä¾›ç»™å®ƒçš„ç¤ºä¾‹ï¼Œä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥é¿å…å¤§æ¨¡å‹å›ç­”æ—¶äº§ç”Ÿçš„å¹»è§‰é—®é¢˜ã€‚

```python
#langchainèŠå¤©çš„æç¤ºè¯æ¨¡æ¿
from langchain_core.prompts import ChatPromptTemplate,PromptTemplate
from langchain_core.prompts.few_shot import FewShotPromptTemplate

from langchain_core.messages import SystemMessage, HumanMessage

examples = [
    {
        "question":"ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½?",
        "answer":"äººå·¥æ™ºèƒ½(Artificial Intelligence)æ˜¯æŒ‡é€šè¿‡è®¡ç®—æœºæ¨¡æ‹Ÿã€æ‰©å±•æˆ–æ‰©å±•äººçš„æ™ºèƒ½æ¥æ„å»ºæ™ºèƒ½ç³»ç»Ÿçš„æŠ€æœ¯ã€‚"
    },
    {
        "question":"é’¢é“ä¾ åœ¨æ¼«å¨ç”µå½±ä¸­ä¸€å…±å‡ºç°äº†å‡ æ¬¡å˜èº«",
        "answer":"é’¢é“ä¾ åœ¨æ¼«å¨ç”µå½±ä¸­ä¸€å…±å‡ºç°äº†3æ¬¡å˜èº«ï¼Œåˆ†åˆ«æ˜¯é’¢é“ä¾ ã€æµ©å…‹å’Œç¾é˜Ÿã€‚"
    },
    {
        "question":"è©¹å§†æ–¯ä¸€å…±æ‰“äº†å¤šå°‘èµ›å­£çš„ç¯®çƒäº†ï¼Ÿ",
        "answer":"è©¹å§†æ–¯ä¸€å…±æ‰“äº†5ä¸ªèµ›å­£çš„ç¯®çƒï¼ŒåŒ…æ‹¬2003-2004èµ›å­£ï¼Œ2004-2005èµ›å­£ï¼Œ2005-2006èµ›å­£ï¼Œ2006-2007èµ›å­£ï¼Œ2007-2008èµ›å­£ã€‚"
    }
]

example_prompt = PromptTemplate(
    input_variables=["question","answer"],
    template="é—®é¢˜ï¼š{question}\nç­”æ¡ˆï¼š{answer}"
)

#æ¥æ”¶examplesç¤ºä¾‹æ•°ç»„å‚æ•°ï¼Œé€šè¿‡example_promptæç¤ºè¯æ¨¡æ¿æ‰¹é‡æ¸²æŸ“ç¤ºä¾‹å†…å®¹
#suffixå’Œinput_variableså‚æ•°ç”¨äºåœ¨æç¤ºè¯æ¨¡æ¿æœ€åè¿½åŠ å†…å®¹ï¼Œinput_variablesç”¨äºå®šä¹‰suffixä¸­åŒ…å«çš„æ¨¡æ¿å‚æ•°
prompt = FewShotPromptTemplate(
    examples=examples,
    example_prompt=example_prompt,
    suffix="é—®é¢˜ï¼š{input}",
    input_variables=["input"]
)

print(prompt.format(input="è©¹å§†æ–¯åœ¨å“ªäº›èµ›å­£ä¸­å‡ºç°è¿‡?"))

```

å¦‚ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨openaiè°ƒç”¨çš„å°‘æ ·æœ¬æ¡ˆä¾‹ä»£ç 

```python
from langchain_core.prompts import PromptTemplate, FewShotPromptTemplate
from langchain_openai import ChatOpenAI
import os

# è®¾ç½®OpenAI APIå¯†é’¥

# åˆ›å»ºç¤ºä¾‹æ ¼å¼åŒ–å™¨
example_prompt = PromptTemplate.from_template("Question: {question}\n{answer}")

# å‡†å¤‡ç¤ºä¾‹é›†
examples = [
    {"question": "1+1ç­‰äºå‡ ï¼Ÿ", "answer": "ç­”æ¡ˆæ˜¯2"},
    {"question": "åœ°çƒæ˜¯ä»€ä¹ˆå½¢çŠ¶ï¼Ÿ", "answer": "åœ°çƒè¿‘ä¼¼äºä¸€ä¸ªçƒä½“"},
]

# åˆ›å»ºFew-Shotæç¤ºæ¨¡æ¿
prompt = FewShotPromptTemplate(
    examples=examples,
    example_prompt=example_prompt,
    suffix="Question: {input}",
    input_variables=["input"],
)

# åˆ›å»ºOpenAIæ¨¡å‹å®ä¾‹
llm = ChatOpenAI(
    # æ­¤å¤„éœ€è¦å¡«å…¥openaiçš„keyï¼Œå¯ä»¥ç›´æ¥å¡«å…¥ï¼Œä½†å»ºè®®æœ€å¥½å¯ä»¥é…ç½®åˆ°æœ¬åœ°ç¯å¢ƒå˜é‡ä¸­
    api_key ='sk-...'
)

# ç”Ÿæˆæç¤ºå¹¶è·å–å›ç­”
user_question = "å¤ªé˜³ç³»ä¸­æœ€å¤§çš„è¡Œæ˜Ÿæ˜¯å“ªä¸ªï¼Ÿ"
full_prompt = prompt.invoke({"input": user_question}).to_string()
response = llm.invoke(full_prompt)

print(f"é—®é¢˜: {user_question}")
print(f"å›ç­”: {response}")

```

è¿è¡Œä¸€ä¸‹å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„ç»“æœ

![](https://i-blog.csdnimg.cn/direct/a375a9932fae44c8a1c644fac89465fb.png)

##### 3.2.2.5 ç¤ºä¾‹é€‰æ‹©å™¨

LangChainæä¾›ç¤ºä¾‹é€‰æ‹©å™¨æ¥æé«˜æ•ˆç‡ï¼Œé¿å…ä¸€æ¬¡æ€§å‘é€æ‰€æœ‰ç¤ºä¾‹ç»™æ¨¡å‹ï¼ŒåŒæ—¶å‡å°‘ä½¿ç”¨çš„Tokenæ•°é‡ã€‚å¦‚æœæœ‰å¤§é‡ç¤ºä¾‹ï¼Œå¯èƒ½éœ€è¦é€‰æ‹©è¦åŒ…å«åœ¨æç¤ºä¸­çš„ç¤ºä¾‹ï¼Œç¤ºä¾‹é€‰æ‹©å™¨æ˜¯è´Ÿè´£æ‰§è¡Œæ­¤æ“ä½œçš„ç±»ã€‚

**LangChainæœ‰å‡ ç§ä¸åŒç±»å‹çš„ç¤ºä¾‹é€‰æ‹©å™¨**

|  |  |
| --- | --- |
| åç§° | æè¿° |
| SemanticSimilarityExampleSelector | ä½¿ç”¨è¾“å…¥å’Œç¤ºä¾‹ä¹‹é—´çš„è¯­ä¹‰ç›¸ä¼¼æ€§æ¥å†³å®šé€‰æ‹©å“ªäº›ç¤ºä¾‹ã€‚ |
| MaxMarginalRelevanceExampleSelector | ä½¿ç”¨è¾“å…¥å’Œç¤ºä¾‹ä¹‹é—´çš„æœ€å¤§è¾¹é™…ç›¸å…³æ€§æ¥å†³å®šé€‰æ‹©å“ªäº›ç¤ºä¾‹ã€‚ |
| LengthBasedExampleSelector | æ ¹æ®ä¸€å®šé•¿åº¦å†…å¯ä»¥å®¹çº³çš„æ•°é‡æ¥é€‰æ‹©ç¤ºä¾‹ |
| NGramOverlapExampleSelector | ä½¿ç”¨è¾“å…¥å’Œç¤ºä¾‹ä¹‹é—´çš„ ngram é‡å æ¥å†³å®šé€‰æ‹©å“ªäº›ç¤ºä¾‹ã€‚ |

åœ¨ä¸‹é¢çš„æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨SemanticSimilarityExampleSelectorç±»ï¼Œè¯¥ç±»æ ¹æ®è¾“å…¥çš„ç›¸ä¼¼æ€§é€‰æ‹©å°æ ·æœ¬ç¤ºä¾‹ï¼Œå®ƒä½¿ç”¨åµŒå…¥æ¨¡å‹è®¡ç®—è¾“å…¥å’Œå°æ ·æœ¬ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼Œç„¶åä½¿ç”¨å‘é‡æ•°æ®åº“æ‰§è¡Œç›¸ä¼¼æ€§æœç´¢ï¼Œè·å–è¾“å…¥ç›¸ä¼¼çš„ç¤ºä¾‹ã€‚

* è¿™é‡Œæ¶‰åŠå‘é‡è®¡ç®—ã€å‘é‡æ•°æ®åº“ï¼Œåœ¨AIé¢†åŸŸè¿™ä¸¤ä¸ªä¸»è¦ç”¨äºæ•°æ®åº“ç›¸ä¼¼åº¦æœç´¢ï¼Œä¾‹å¦‚ï¼ŒæŸ¥è¯¢ç›¸ä¼¼æ–‡ç« å†…å®¹ï¼Œç›¸ä¼¼å›¾ç‰‡ã€è§†é¢‘ç­‰

å…ˆå®‰è£…ä¸‹é¢çš„å‘é‡æ•°æ®åº“

```bash
pip install chromadb
```

å®Œæ•´çš„ä»£ç å¦‚ä¸‹

```python
from langchain.prompts.example_selector import SemanticSimilarityExampleSelector
from langchain_community.vectorstores import Chroma

from langchain_openai import OpenAIEmbeddings

examples = [
    {
        "question":"ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½?",
        "answer":"äººå·¥æ™ºèƒ½(Artificial Intelligence)æ˜¯æŒ‡é€šè¿‡è®¡ç®—æœºæ¨¡æ‹Ÿã€æ‰©å±•æˆ–æ‰©å±•äººçš„æ™ºèƒ½æ¥æ„å»ºæ™ºèƒ½ç³»ç»Ÿçš„æŠ€æœ¯ã€‚"
    },
    {
        "question":"é’¢é“ä¾ åœ¨æ¼«å¨ç”µå½±ä¸­ä¸€å…±å‡ºç°äº†å‡ æ¬¡å˜èº«",
        "answer":"é’¢é“ä¾ åœ¨æ¼«å¨ç”µå½±ä¸­ä¸€å…±å‡ºç°äº†3æ¬¡å˜èº«ï¼Œåˆ†åˆ«æ˜¯é’¢é“ä¾ ã€æµ©å…‹å’Œç¾é˜Ÿã€‚"
    },
    {
        "question":"è©¹å§†æ–¯ä¸€å…±æ‰“äº†å¤šå°‘èµ›å­£çš„ç¯®çƒäº†ï¼Ÿ",
        "answer":"è©¹å§†æ–¯ä¸€å…±æ‰“äº†5ä¸ªèµ›å­£çš„ç¯®çƒï¼ŒåŒ…æ‹¬2003-2004èµ›å­£ï¼Œ2004-2005èµ›å­£ï¼Œ2005-2006èµ›å­£ï¼Œ2006-2007èµ›å­£ï¼Œ2007-2008èµ›å­£ã€‚"
    }
]

# åˆå§‹åŒ–ç¤ºä¾‹é€‰æ‹©å™¨
example_selector = SemanticSimilarityExampleSelector.from_examples(
    #æä¾›å¯é€‰æ‹©çš„ç¤ºä¾‹åˆ—è¡¨
    examples,
    #ç”¨äºç”ŸæˆåµŒå…¥çš„åµŒå…¥ç±»ï¼Œè¯¥åµŒå…¥ç”¨äºè¡¡é‡è¯­ä¹‰çš„ç›¸ä¼¼æ€§
    OpenAIEmbeddings(api_key='sk-...'),
    #ç”¨äºå­˜å‚¨åµŒå…¥å’Œæ‰§è¡Œç›¸ä¼¼åº¦æœç´¢çš„VectorStoreç±»
    Chroma,
    #ç”¨äºç”Ÿæˆçš„ç¤ºä¾‹æ•°
    k=1
)

question = "è©¹å§†æ–¯åœ¨å“ªäº›èµ›å­£æ‰“è¿‡ç¯®çƒï¼Ÿ"

result_examples = example_selector.select_examples({"question":question})

for example in result_examples:
    print("\\n")
    for key, value in example.items():
        print(f"{key}: {value}")
```

è¿è¡Œä¸€ä¸‹ä¸Šè¿°ä»£ç ï¼Œåœ¨è¾“å‡ºçš„ç»“æœä¸­å¯ä»¥çœ‹åˆ°å‚è€ƒäº†æˆ‘ä»¬ç»™å®šçš„ç¤ºä¾‹æ ·æœ¬ï¼Œé€‰æ‹©äº†æœ€æ¥è¿‘çš„é—®é¢˜çš„ç­”æ¡ˆ

![](https://i-blog.csdnimg.cn/direct/103fb81c20f24c47bf6a8449379ec023.png)

### 3.3 memoryç»„ä»¶

åœ¨å¤šè½®å¯¹è¯ä¸­ï¼Œä¸ºäº†ä½¿å¤§æ¨¡å‹èƒ½å¤Ÿè®°ä½ä¸Šä¸‹æ–‡å¯¹è¯ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨è¿™ä¸ªmemoryç»„ä»¶ï¼Œæå‰å®‰è£…ä¾èµ–åŒ…

```python
pip install langchain_community
```

![](https://i-blog.csdnimg.cn/direct/6edcb821dde3447a8dc48e69e4f2a052.png)

è¯¥æ¨¡å—ä¸­æä¾›äº†ChatHistoryï¼Œå®ƒå…è®¸èŠå¤©æœºå™¨äººè®°ä½è¿‡å»çš„äº’åŠ¨ï¼Œå¹¶åœ¨åç»­çš„å›ç­”é—®é¢˜æ—¶è€ƒè™‘å®ƒä»¬ï¼›

#### 3.3.1 ChatMessageHistory æ¡ˆä¾‹ä»£ç 

å‚è€ƒå¦‚ä¸‹ä»£ç 

```python

from langchain_community.chat_message_histories import ChatMessageHistory

#langchainèŠå¤©çš„æç¤ºè¯æ¨¡æ¿
from langchain_core.prompts import ChatPromptTemplate,MessagesPlaceholder
from langchain_core.messages import SystemMessage, HumanMessage
from langchain_core.runnables import RunnableWithMessageHistory

#langchainçš„openaiçš„sdk
from langchain_openai import ChatOpenAI
from langchain_core.output_parsers import StrOutputParser

#åˆ›å»ºæ¨¡å‹
model = ChatOpenAI(
    # æ­¤å¤„éœ€è¦å¡«å…¥openaiçš„keyï¼Œå¯ä»¥ç›´æ¥å¡«å…¥ï¼Œä½†å»ºè®®æœ€å¥½å¯ä»¥é…ç½®åˆ°æœ¬åœ°ç¯å¢ƒå˜é‡ä¸­
    api_key ='sk-...'
)

msg=[
    SystemMessage(content="è¯·å°†ä¸‹é¢çš„å†…å®¹ç¿»è¯‘æˆè‹±è¯­."), 
    HumanMessage(content="ä½ å¥½ï¼Œè¯·é—®ä½ è¦å»å“ªé‡Œ")
]

parser=StrOutputParser()

#å®šä¹‰æç¤ºè¯æ¨¡æ¿
prompt_template = ChatPromptTemplate = ChatPromptTemplate.from_messages([
    ('system','ä½ æ˜¯ä¸€ä¸ªä¹äºåŠ©äººçš„åŠ©æ‰‹ï¼Œè¯·ç”¨{language}å°½ä½ æ‰€èƒ½å›ç­”æ‰€æœ‰é—®é¢˜'),
    MessagesPlaceholder(variable_name="my_msg")

])

chain = prompt_template | model

#ä¿å­˜èŠå¤©çš„å†å²è®°å½•
store={}

#å®šä¹‰ä¸€ä¸ªè·å–session_idçš„å‡½æ•°ï¼Œè¿”å›ä¸€å…±æ¶ˆæ¯çš„å†å²å¯¹è±¡
def get_history(session_id: str):
    if session_id not in store:
        store[session_id] = ChatMessageHistory()
    return store[session_id]

do_msg = RunnableWithMessageHistory(
    chain,
    get_history,
   input_messages_key='my_msg' #æ¯æ¬¡èŠå¤©å‘é€æ¶ˆæ¯çš„key
)

#ç»™å½“å‰ä¼šè¯æ·»åŠ ä¸€ä¸ªsession
config={'configurable':{'session_id':'xm113'}}

#ç¬¬ä¸€è½®å¯¹è¯
result_1 = do_msg.invoke(
    {
        "my_msg": [HumanMessage(content="ä½ å¥½ï¼Œæˆ‘æ˜¯å°æ˜")],
        "language": "ä¸­æ–‡"
    },
    config=config
)

print(result_1.content)

#ç¬¬äºŒè½®å¯¹è¯
result_2 = do_msg.invoke(
    {
        "my_msg": [HumanMessage(content="è¯·é—®æˆ‘çš„åå­—æ˜¯ä»€ä¹ˆ")],
        "language": "ä¸­æ–‡"
    },
    config=config
)
print(result_2.content)
```

è¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œé€šè¿‡æ§åˆ¶å°çš„è¾“å‡ºç»“æœä¸éš¾çœ‹å‡ºï¼Œå¤§æ¨¡å‹åœ¨å›ç­”æˆ‘ä»¬çš„ç¬¬äºŒä¸ªé—®é¢˜çš„æ—¶å€™ï¼Œç”±äºä½¿ç”¨äº†ChatMessageHistoryï¼Œåœ¨ç¬¬ä¸€æ¬¡çš„å¯¹è¯ä¸­ï¼Œè®°ä½äº†ç¬¬ä¸€è½®å¯¹è¯çš„å†…å®¹ï¼Œæ‰€ä»¥ç¬¬äºŒè½®å¯¹è¯ä¸­å¯ä»¥æ­£ç¡®çš„è¾“å‡ºç­”æ¡ˆ

![](https://i-blog.csdnimg.cn/direct/0010b4d64b854a03b33985763fccf96f.png)

#### 

#### 3.3.2 æµå¼è¾“å‡ºæ¡ˆä¾‹ä»£ç 

æµå¼è¾“å‡ºæ˜¯ä¸€ç§å…è®¸æ•°æ®åœ¨ç”Ÿæˆçš„åŒæ—¶é€æ­¥ä¼ è¾“çš„æŠ€æœ¯ï¼Œè€Œæ— éœ€ç­‰å¾…æ•´ä¸ªè¿‡ç¨‹å®Œæˆ

> æµå¼è¾“å‡ºæŠ€æœ¯ä½¿å¾—æ•°æ®å¯ä»¥å®æ—¶åœ°ã€é€æ­¥åœ°ä¼ è¾“ï¼Œè€Œä¸æ˜¯ç­‰å¾…æ‰€æœ‰æ•°æ®ç”Ÿæˆå®Œæ¯•åå†ä¸€æ¬¡æ€§ä¼ è¾“ã€‚è¿™ç§æŠ€æœ¯ç‰¹åˆ«é€‚ç”¨äºå¤„ç†å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰å’ŒèŠå¤©æ¨¡å‹çš„è¾“å‡ºï¼Œå› ä¸ºè¿™äº›æ¨¡å‹çš„è¿è¡Œæ—¶é—´é€šå¸¸è¾ƒé•¿ï¼Œä¸”è¾“å‡ºæ•°æ®é‡å¯èƒ½å¾ˆå¤§ã€‚é€šè¿‡æµå¼è¾“å‡ºï¼Œç”¨æˆ·å¯ä»¥åœ¨æ•°æ®ç”Ÿæˆçš„è¿‡ç¨‹ä¸­å°±æ¥æ”¶åˆ°éƒ¨åˆ†ç»“æœï¼Œä»è€Œæé«˜æ•ˆç‡å’Œç”¨æˆ·ä½“éªŒã€‚

åŸºäºä¸Šä¸€ä¸ªæ¡ˆä¾‹ä¸­çš„2è½®å¯¹è¯ï¼Œæˆ‘ä»¬å†åŠ ä¸€è½®å¯¹è¯ï¼Œæ­¤æ—¶é‡‡ç”¨æµå¼è¾“å‡ºçš„æ–¹å¼ï¼Œåªéœ€è¦è°ƒæ•´ä¸‹è°ƒç”¨çš„apiå³å¯ï¼Œå¦‚ä¸‹ï¼š

```python
#ç¬¬ä¸‰è½®å¯¹è¯ï¼Œæ­¤æ—¶è¿”å›çš„æ•°æ®æ˜¯æµå¼çš„
for resp in do_msg.stream(
    {
        "my_msg": [HumanMessage(content="ç»™æˆ‘è®²ä¸€ä¸ªç¬‘è¯")],
        "language": "ä¸­æ–‡"
    },
    config=config
): 
    print(resp.content)
```

è¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œè§‚å¯Ÿè¾“å‡ºæ•ˆæœï¼Œå¯ä»¥çœ‹åˆ°ç»“æœæ˜¯ä¸€ä¸ªä¸€ä¸ªå­—è¾“å‡ºçš„

![](https://i-blog.csdnimg.cn/direct/bbac259e7a3949878739ae9a008a82c9.png)

### 3.4 å‘é‡æ•°æ®åº“ä¸æ–‡æ¡£æ£€ç´¢

å‘é‡æ•°æ®åº“æ˜¯å®ç°æ–‡æ¡£æ£€ç´¢çš„åŸºç¡€å¿…è¦å®ç°ç»„ä»¶ï¼Œç±»ä¼¼ä¸æˆ‘ä»¬åœ¨å­¦ä¹ esçš„æ—¶å€™ï¼Œä¸ºäº†èƒ½ä»esä¸­æœç´¢å‡ºç›¸ä¼¼åº¦æœ€é«˜çš„æ–‡æ¡£ï¼Œeséœ€è¦å…ˆå°†åŸå§‹å­˜å…¥çš„æ•°æ®è¿›è¡Œåˆ†è¯ä¹‹åå†å­˜å‚¨ã€‚

langchainæ„å»ºçš„å‘é‡æ•°æ®åº“ä¸æ–‡æ¡£æ£€ç´¢ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œä¸è¿‡æ–‡æ¡£å­˜å‚¨æ˜¯æ”¾åœ¨å‘é‡æ•°æ®åº“ä¸­ï¼Œå³æ–‡æ¡£å­˜å‚¨ä¹‹å‰éœ€è¦å…ˆè¿›è¡Œå‘é‡åŒ–ï¼Œè€Œåæ‰èƒ½è¿›è¡Œæœç´¢ã€‚

æ”¯æŒä»å‘é‡æ•°æ®åº“æˆ–å…¶ä»–æ•°æ®æºæ£€ç´¢æ•°æ®ï¼Œä»¥ä¾¿ä¸LLMï¼ˆå¤§è¯­è¨€æ¨¡å‹ï¼‰çš„å·¥ä½œæµé›†æˆï¼Œè¿™å¯¹äºåº”ç”¨ç¨‹åºæ¥è¯´éå¸¸é‡è¦ï¼Œè¿™äº›åº”ç”¨ç¨‹åºéœ€è¦è·å–æ•°æ®ä»¥ä½œä¸ºæ¨¡å‹æ¨ç†çš„ä¸€éƒ¨åˆ†è¿›è¡Œæ¨ç†ï¼Œå°±åƒæ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAGï¼‰çš„æƒ…å†µç±»ä¼¼ã€‚

#### 3.4.1 å®‰è£…å‘é‡æ•°æ®åº“

å‘é‡æ•°æ®åº“çš„å¯é€‰ç»„ä»¶æœ‰å¾ˆå¤šç§ï¼Œè¿™é‡Œé€‰ç”¨chromaï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å®‰è£…

```python
pip install langchain-chroma
```

![](https://i-blog.csdnimg.cn/direct/b0d21ed9ef46498cbad9cfb87206ec7d.png)

#### 

#### 3.4.2 ä»£ç æ“ä½œç¤ºä¾‹

å®Œæ•´çš„æ“ä½œæ­¥éª¤ï¼š

* åˆå§‹åŒ–æ–‡æ¡£ï¼›
* æ–‡æ¡£å­˜å…¥å‘é‡æ•°æ®åº“ï¼Œè¿›è¡Œæ–‡æ¡£å‘é‡åŒ–ï¼›
* ä½¿ç”¨æ£€ç´¢å™¨è¿›è¡Œæ–‡æ¡£æ£€ç´¢ï¼›

å‚è€ƒä¸‹é¢çš„å®Œæ•´ä»£ç 

```python

from langchain_community.chat_message_histories import ChatMessageHistory

from langchain_core.messages import SystemMessage, HumanMessage
from langchain_openai import ChatOpenAI

from langchain_core.documents import Document
from langchain_chroma import Chroma
from langchain_openai import OpenAIEmbeddings

import os

os.environ["OPENAI_API_KEY"] = 'sk-...'


#æä¾›æµ‹è¯•æ•°æ®ï¼Œä½œä¸ºå‘é‡æ•°æ®åº“æ•°æ®çš„æ¥æº
documents = [
    Document(
        page_content="ç‹—æ˜¯äººç±»çš„å¥½æœ‹å‹ï¼Œä»¥å¿ è¯šå’Œå‹å¥½è€Œæ–‡æ˜",
        metadata={"source": "å“ºä¹³åŠ¨ç‰©æ‰‹å†Œ"},
    ),
     Document(
        page_content="çŒ«æ˜¯æ¯”è¾ƒç‹¬ç«‹çš„å® ç‰©ï¼Œå–œæ¬¢æœ‰è‡ªå·±ç‹¬ç«‹çš„ç©ºé—´ï¼Œä½†æ˜¯å¯ä»¥ä¸ºäººç±»æä¾›ä¸€å®šçš„é™ªä¼´å’Œæƒ…ç»ªä»·å€¼",
        metadata={"source": "å“ºä¹³åŠ¨ç‰©æ‰‹å†Œ"},
    ),
     Document(
        page_content="å…”å­æ˜¯ä¸€ç§ä¹–å·§è€Œåé™çš„åŠ¨ç‰©ï¼Œæ—¢å¯ä»¥ä½œä¸ºå® ç‰©ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå®¶å…»åŠ¨ç‰©",
        metadata={"source": "é™æ€å® ç‰©æ‰‹å†Œ"},
    ),
     Document(
        page_content="è€è™æ˜¯ä¸€ä¸ªéå¸¸å‡¶çŒ›çš„åŠ¨ç‰©ï¼Œä½†æ˜¯åœ¨éæ´²å¯ä»¥ä½œä¸ºå® ç‰©ï¼Œä¸€èˆ¬æ˜¯æ•é£Ÿæ€§åŠ¨ç‰©",
        metadata={"source": "å¤§å‹åŠ¨ç‰©æ‰‹å†Œ"},
    ),
     Document(
        page_content="é•¿é¢ˆé¹¿æ˜¯ä¸€ç§éå¸¸å‘†èŒå¯çˆ±çš„åŠ¨ç‰©ï¼Œä¸€èˆ¬åœ¨åŠ¨ç‰©å›­æ‰èƒ½çœ‹åˆ°",
        metadata={"source": "å¤§å‹åŠ¨ç‰©æ‰‹å†Œ"}
    ),
]

#å®ä¾‹åŒ–å‘é‡ç©ºé—´
vector_store = Chroma.from_documents(documents, embedding = OpenAIEmbeddings())

#ç›¸ä¼¼åº¦æŸ¥è¯¢ï¼Œè¿”å›ç›¸ä¼¼åº¦åˆ†æ•°ï¼Œåˆ†æ•°è¶Šä½ï¼Œç›¸ä¼¼åº¦è¶Šé«˜
result = vector_store.similarity_search_with_score("ä¸œåŒ—è™")
print(result)
```

è¿è¡Œä¸Šè¿°çš„ä»£ç ï¼Œé€šè¿‡æ§åˆ¶å°çš„ç»“æœè¾“å‡ºä¸éš¾å‘ç°ï¼Œç”±äºæœ¬æ¬¡æ£€ç´¢çš„å…³é”®å­—é‡Œé¢åŒ…å«â€œè™â€œï¼Œåœ¨åŸå§‹çš„æ–‡æ¡£ä¸­ï¼Œä¸è™ç›¸å…³çš„æ–‡æ¡£æœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥æœ€ç»ˆæ£€ç´¢çš„ç»“æœä¸­ï¼Œå°†åŒ…å«è€è™çš„é‚£ä¸€æ¡æ”¾åœ¨æœ€å‰é¢ï¼Œè€Œä¸”åˆ†æ•°æœ€ä½ï¼Œè¿™ä¹Ÿå°±ç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸ

![](https://i-blog.csdnimg.cn/direct/00388c810b5046b0abb12bcb6d5df33c.png)

å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ£€ç´¢å™¨æ¥åšï¼Œå³RunnableLambdaè¿™ä¸ªå¯¹è±¡ï¼Œå¦‚ä¸‹ï¼š

```python
#å®ä¾‹åŒ–å‘é‡ç©ºé—´
vector_store = Chroma.from_documents(documents, embedding = OpenAIEmbeddings())

#ç›¸ä¼¼åº¦æŸ¥è¯¢ï¼Œè¿”å›ç›¸ä¼¼åº¦åˆ†æ•°ï¼Œåˆ†æ•°è¶Šä½ï¼Œç›¸ä¼¼åº¦è¶Šé«˜
# result = vector_store.similarity_search_with_score("ä¸œåŒ—è™")
# print(result)

#æ£€ç´¢å™¨ï¼Œk=1ï¼Œé€‰å–ç›¸ä¼¼åº¦æœ€é«˜çš„ç¬¬ä¸€ä¸ªè¿”å›
retriever = RunnableLambda(vector_store.similarity_search_with_score).bind(k=1)

target_doc = retriever.batch(['åå—è™','æ©˜çŒ«'])
print(target_doc)
```

å†æ¬¡è¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œæ­¤æ—¶è¿”å›äº†ç¬¦åˆæ¡ä»¶çš„ä¸¤ä¸ªæ–‡æ¡£

![](https://i-blog.csdnimg.cn/direct/9bb896eb8dc24bfd9508942a648bd235.png)

#### 

#### 3.4.3 ç»„åˆå¤§æ¨¡å‹ç»„ä»¶ä½¿ç”¨

äº‹å®ä¸Šï¼Œåœ¨å®é™…ä½¿ç”¨ä¸­å¯èƒ½ä¼šç»“åˆå¤§æ¨¡å‹ä¸€èµ·ä½¿ç”¨ï¼Œæ¯”å¦‚åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œç»“åˆå¤§æ¨¡å‹ä¸å‘é‡æ•°æ®åº“ä¸€èµ·ä½¿ç”¨ï¼ŒåŒæ—¶é—®é¢˜é€šè¿‡å‚æ•°çš„æ–¹å¼ä¼ å…¥ï¼Œè¿™æ ·æ›´ä¸ºçµæ´»ä¸€ç‚¹

```python

from langchain_community.chat_message_histories import ChatMessageHistory

from langchain_core.messages import SystemMessage, HumanMessage
from langchain_openai import ChatOpenAI

from langchain_core.documents import Document
from langchain_chroma import Chroma
from langchain_openai import OpenAIEmbeddings

from langchain_core.runnables import RunnableLambda,RunnablePassthrough
from langchain_core.prompts import ChatPromptTemplate,MessagesPlaceholder

import os

os.environ["OPENAI_API_KEY"] = 'sk...'

#åˆ›å»ºæ¨¡å‹
model = ChatOpenAI(
    # æ­¤å¤„éœ€è¦å¡«å…¥openaiçš„keyï¼Œå¯ä»¥ç›´æ¥å¡«å…¥ï¼Œä½†å»ºè®®æœ€å¥½å¯ä»¥é…ç½®åˆ°æœ¬åœ°ç¯å¢ƒå˜é‡ä¸­
    api_key ='sk...'
)

msg=[
    SystemMessage(content="è¯·å°†ä¸‹é¢çš„å†…å®¹ç¿»è¯‘æˆè‹±è¯­."), 
    HumanMessage(content="ä½ å¥½ï¼Œè¯·é—®ä½ è¦å»å“ªé‡Œ")
]

#æä¾›æµ‹è¯•æ•°æ®ï¼Œä½œä¸ºå‘é‡æ•°æ®åº“æ•°æ®çš„æ¥æº
documents = [
    Document(
        page_content="ç‹—æ˜¯äººç±»çš„å¥½æœ‹å‹ï¼Œä»¥å¿ è¯šå’Œå‹å¥½è€Œæ–‡æ˜",
        metadata={"source": "å“ºä¹³åŠ¨ç‰©æ‰‹å†Œ"},
    ),
     Document(
        page_content="çŒ«æ˜¯æ¯”è¾ƒç‹¬ç«‹çš„å® ç‰©ï¼Œå–œæ¬¢æœ‰è‡ªå·±ç‹¬ç«‹çš„ç©ºé—´ï¼Œä½†æ˜¯å¯ä»¥ä¸ºäººç±»æä¾›ä¸€å®šçš„é™ªä¼´å’Œæƒ…ç»ªä»·å€¼",
        metadata={"source": "å“ºä¹³åŠ¨ç‰©æ‰‹å†Œ"},
    ),
     Document(
        page_content="å…”å­æ˜¯ä¸€ç§ä¹–å·§è€Œåé™çš„åŠ¨ç‰©ï¼Œæ—¢å¯ä»¥ä½œä¸ºå® ç‰©ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå®¶å…»åŠ¨ç‰©",
        metadata={"source": "é™æ€å® ç‰©æ‰‹å†Œ"},
    ),
     Document(
        page_content="è€è™æ˜¯ä¸€ä¸ªéå¸¸å‡¶çŒ›çš„åŠ¨ç‰©ï¼Œä½†æ˜¯åœ¨éæ´²å¯ä»¥ä½œä¸ºå® ç‰©ï¼Œä¸€èˆ¬æ˜¯æ•é£Ÿæ€§åŠ¨ç‰©",
        metadata={"source": "å¤§å‹åŠ¨ç‰©æ‰‹å†Œ"},
    ),
     Document(
        page_content="é•¿é¢ˆé¹¿æ˜¯ä¸€ç§éå¸¸å‘†èŒå¯çˆ±çš„åŠ¨ç‰©ï¼Œä¸€èˆ¬åœ¨åŠ¨ç‰©å›­æ‰èƒ½çœ‹åˆ°",
        metadata={"source": "å¤§å‹åŠ¨ç‰©æ‰‹å†Œ"}
    ),
]

#å®ä¾‹åŒ–å‘é‡ç©ºé—´
vector_store = Chroma.from_documents(documents, embedding = OpenAIEmbeddings())

#ç›¸ä¼¼åº¦æŸ¥è¯¢ï¼Œè¿”å›ç›¸ä¼¼åº¦åˆ†æ•°ï¼Œåˆ†æ•°è¶Šä½ï¼Œç›¸ä¼¼åº¦è¶Šé«˜
# result = vector_store.similarity_search_with_score("ä¸œåŒ—è™")
# print(result)

#æ£€ç´¢å™¨ï¼Œk=1ï¼Œé€‰å–ç›¸ä¼¼åº¦æœ€é«˜çš„ç¬¬ä¸€ä¸ªè¿”å›
retriever = RunnableLambda(vector_store.similarity_search_with_score).bind(k=1)

#å¢åŠ æç¤ºè¯æ¨¡æ¿
message="""
    ä½¿ç”¨æä¾›çš„ä¸Šä¸‹æ–‡å›ç­”è¿™ä¸ªé—®é¢˜ï¼š
    {question}
    ä¸Šä¸‹æ–‡ï¼š
    {context}
"""

prompt_template = ChatPromptTemplate.from_messages([
    ('human',message)
])

#åŠ¨æ€ä¼ é€’é—®é¢˜ï¼Œå…è®¸ç”¨æˆ·çš„é—®é¢˜ä¹‹åä¼ é€’ç»™promptå’Œmodel
chain = {'question':RunnablePassthrough(),'context':retriever} | prompt_template | model

resp = chain.invoke("è¯·è°ˆè°ˆè€è™")

print(resp)
```

ä»è¾“å‡ºç»“æœä¸éš¾çœ‹å‡ºï¼Œæœ€ç»ˆçš„å›ç­”å‚è€ƒäº†æœ¬åœ°å‘é‡æ•°æ®åº“çš„ç­”æ¡ˆ

![](https://i-blog.csdnimg.cn/direct/d60fe63d64314872a1db3fc6c3c53e98.png)

## å››ã€å†™åœ¨æ–‡æœ«

æœ¬æ–‡é€šè¿‡æ¡ˆä¾‹è¯¦ç»†ä»‹ç»äº†OpenAI é›†æˆ Langchain çš„ä½¿ç”¨ï¼Œå¹¶é’ˆå¯¹Langchainçš„æ ¸å¿ƒç»„ä»¶ä»¥ä»£ç çš„æ–¹å¼è¿›è¡Œäº†æ“ä½œæ¼”ç¤ºï¼Œå¸Œæœ›å¯¹çœ‹åˆ°çš„åŒå­¦æœ‰ç”¨å“¦ï¼Œæœ¬ç¯‡åˆ°æ­¤ç»“æŸï¼Œæ„Ÿè°¢è§‚çœ‹ã€‚