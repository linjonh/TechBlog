---
layout: post
title: "Qt串口通信开发教程Linux下的串口调试工具实现"
date: 2025-03-10 18:29:00 +0800
description: "本文介绍一个基于Qt5和Linux的串口通信工具，该工具提供了一套完整的串口通信解决方案，可用于各种串口设备的调试和数据传输。自动检测和显示系统可用串口设备完整的串口参数配置（波特率、数据位、停止位、校验位）支持ASCII和十六进制数据的收发与显示大数据量自动清屏功能串口数据保存功能自动重连断开的串口添加时间戳功能本文介绍了一个基于Qt和ROS的串口通信工具的实现过程，包括环境配置、核心功能实现、UI设计和使用说明。该工具功能完善，界面友好，适用于各种串口设备的调试和开发工作。"
keywords: "Qt串口通信开发教程：Linux下的串口调试工具实现"
categories: ['未分类']
tags: ['开发语言', 'Qt', 'Linux', 'C']
artid: "146156620"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146156620
    alt: "Qt串口通信开发教程Linux下的串口调试工具实现"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146156620
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146156620
cover: https://bing.ee123.net/img/rand?artid=146156620
image: https://bing.ee123.net/img/rand?artid=146156620
img: https://bing.ee123.net/img/rand?artid=146156620
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Qt串口通信开发教程：Linux下的串口调试工具实现
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="QtLinux_0">
     </a>
     Qt串口通信开发教程：Linux下的串口调试工具实现
    </h2>
    <h3>
     <a id="_1">
     </a>
     文章前言：
    </h3>
    <p>
     源码地址：https://github.com/haoxiliangluo/robot_control
     <br/>
     不用做ros开发的可以将串口部分复制到新的项目中，也可以直接cmake使用，如果直接使用的话，请不要连接rosmaster，这可能会导致程序崩溃。
     <br/>
     本项目是我大一下学期时候在Linux为调试串口方便写的，当时用的都是很简单的语法，也没有开多线程，所以在一些方面可能为有一些问题，等我抽出来空再将他分离出来，并进行优化。
    </p>
    <h3>
     <a id="1__5">
     </a>
     1. 项目概述
    </h3>
    <p>
     本文介绍一个基于Qt5和ROS的串口通信工具，该工具提供了一套完整的串口通信解决方案，可用于各种串口设备的调试和数据传输。工具具有以下特点：
    </p>
    <ul>
     <li>
      自动检测和显示系统可用串口设备
     </li>
     <li>
      完整的串口参数配置（波特率、数据位、停止位、校验位）
     </li>
     <li>
      支持ASCII和十六进制数据的收发与显示
     </li>
     <li>
      大数据量自动清屏功能
     </li>
     <li>
      串口数据保存功能
     </li>
     <li>
      自动重连断开的串口
     </li>
     <li>
      添加时间戳功能
     </li>
    </ul>
    <h4>
     <a id="_16">
     </a>
     项目效果：
    </h4>
    <p>
     <img alt="Qt串口通信工具界面示意图" src="https://i-blog.csdnimg.cn/direct/ebdb6da542dd47d38daecaff09115dc8.png"/>
    </p>
    <h3>
     <a id="2__20">
     </a>
     2. 开发环境配置
    </h3>
    <h4>
     <a id="21__22">
     </a>
     2.1 开发环境
    </h4>
    <ul>
     <li>
      操作系统：Ubuntu 20.04
     </li>
     <li>
      ROS版本：ROS Noetic
     </li>
     <li>
      Qt版本：Qt 5.14.2（也可使用Qt 5.12或更高版本）
     </li>
     <li>
      编译器：GCC 9.3.0
     </li>
     <li>
      构建工具：CMake 3.16.3
     </li>
    </ul>
    <h4>
     <a id="22__30">
     </a>
     2.2 依赖库
    </h4>
    <ul>
     <li>
      QtSerialPort：Qt提供的串口通信模块
     </li>
     <li>
      QtWidgets：Qt图形界面库
     </li>
     <li>
      ROS相关库（可选，用于ROS集成）
     </li>
    </ul>
    <h4>
     <a id="23__36">
     </a>
     2.3 环境配置
    </h4>
    <ol>
     <li>
      <p>
       安装Qt开发环境：
      </p>
      <pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> qt5-default qtcreator
</code></pre>
     </li>
     <li>
      <p>
       安装Qt串口模块：
      </p>
      <pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libqt5serialport5-dev
</code></pre>
     </li>
     <li>
      <p>
       安装ROS（如果需要ROS集成）：
      </p>
      <pre><code class="prism language-bash"><span class="token comment"># 按ROS官方指南安装ROS Noetic</span>
</code></pre>
     </li>
    </ol>
    <h3>
     <a id="3__53">
     </a>
     3. 项目结构
    </h3>
    <pre><code>serial/
├── CMakeLists.txt         # CMake构建脚本
├── package.xml           # ROS包配置文件
├── mainpage.dox          # 文档配置
├── resources/            # 资源文件目录
│   └── images.qrc        # Qt资源配置文件
├── ui/                   # UI文件目录
│   └── main_window.ui    # 主窗口UI设计文件
├── include/              # 头文件目录
│   └── serailDemo/       # 项目头文件
│       ├── main_window.hpp  # 主窗口类定义
│       └── qnode.hpp     # ROS节点类定义
└── src/                 # 源代码目录
    ├── main.cpp         # 主函数
    ├── main_window.cpp  # 主窗口类实现
    └── qnode.cpp        # ROS节点类实现
</code></pre>
    <h3>
     <a id="4__74">
     </a>
     4. 核心功能实现
    </h3>
    <h4>
     <a id="41__76">
     </a>
     4.1 串口设备检测
    </h4>
    <p>
     使用
     <code>
      QSerialPortInfo
     </code>
     类获取系统可用串口设备列表：
    </p>
    <pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">report</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    ui<span class="token punctuation">.</span>serial_port_2<span class="token operator">-&gt;</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//清空下拉菜单</span>

    portList <span class="token operator">=</span> <span class="token class-name">QSerialPortInfo</span><span class="token double-colon punctuation">::</span><span class="token function">availablePorts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取端口列表</span>

    <span class="token comment">//添加下拉菜单</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>QSerialPortInfo <span class="token operator">&amp;</span>i <span class="token operator">:</span> portList<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        ui<span class="token punctuation">.</span>serial_port_2<span class="token operator">-&gt;</span><span class="token function">addItem</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span><span class="token function">portName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="42__95">
     </a>
     4.2 串口参数配置
    </h4>
    <p>
     设置串口参数，包括波特率、数据位、停止位和校验位：
    </p>
    <pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">slot_open_serial</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>   
    <span class="token comment">//相当于sudo，pkexec一般用于图形化编程</span>
    QString command <span class="token operator">=</span> <span class="token string">"pkexec chmod 666 /dev/"</span> <span class="token operator">+</span> portList<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span>ui<span class="token punctuation">.</span>serial_port_2<span class="token operator">-&gt;</span><span class="token function">currentIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">portName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">system</span><span class="token punctuation">(</span>command<span class="token punctuation">.</span><span class="token function">toUtf8</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">update_serial_date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    serial<span class="token punctuation">.</span><span class="token function">setParity</span><span class="token punctuation">(</span>parity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    serial<span class="token punctuation">.</span><span class="token function">setBaudRate</span><span class="token punctuation">(</span>baudRate<span class="token punctuation">)</span><span class="token punctuation">;</span>
    serial<span class="token punctuation">.</span><span class="token function">setDataBits</span><span class="token punctuation">(</span>dataBits<span class="token punctuation">)</span><span class="token punctuation">;</span>
    serial<span class="token punctuation">.</span><span class="token function">setStopBits</span><span class="token punctuation">(</span>stopBits<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>serial<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>QIODevice<span class="token double-colon punctuation">::</span>ReadWrite<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">logMessage</span><span class="token punctuation">(</span><span class="token string">"串口打开成功！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">logMessage</span><span class="token punctuation">(</span><span class="token string">"串口打开失败！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> serial<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="43__119">
     </a>
     4.3 数据发送功能
    </h4>
    <p>
     实现数据发送，支持ASCII和十六进制格式：
    </p>
    <pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">sendMessge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>serial<span class="token punctuation">.</span><span class="token function">isOpen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        QString message <span class="token operator">=</span> ui<span class="token punctuation">.</span>textEdit<span class="token operator">-&gt;</span><span class="token function">toPlainText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        QByteArray data <span class="token operator">=</span> message<span class="token punctuation">.</span><span class="token function">toUtf8</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>ui<span class="token punctuation">.</span>checkBox_3<span class="token operator">-&gt;</span><span class="token function">isChecked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            message <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">toHex</span><span class="token punctuation">(</span><span class="token char">' '</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUpper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将数据转换为十六进制字符串，并用空格分隔</span>
            serial<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{<!-- --></span>
            serial<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        receivedDataSize <span class="token operator">+=</span> data<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 检查是否需要200k清屏</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>ui<span class="token punctuation">.</span>checkBox_5<span class="token operator">-&gt;</span><span class="token function">isChecked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> receivedDataSize <span class="token operator">&gt;=</span> <span class="token number">200</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">cleanAccept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            receivedDataSize <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">logMessage</span><span class="token punctuation">(</span><span class="token string">"发送: "</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">logMessage</span><span class="token punctuation">(</span><span class="token string">"串口并没有被打开."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">warning</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">"warning！"</span><span class="token punctuation">,</span> <span class="token string">"串口并没有被打开,脑子不要可以捐了."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="44__152">
     </a>
     4.4 数据接收功能
    </h4>
    <p>
     使用
     <code>
      QSerialPort::read
     </code>
     方法读取串口数据，支持ASCII和十六进制显示：
    </p>
    <pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">readSerialData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>serial<span class="token punctuation">.</span><span class="token function">canReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        QByteArray data <span class="token operator">=</span> serial<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>serial<span class="token punctuation">.</span><span class="token function">bytesAvailable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        receivedDataSize <span class="token operator">+=</span> data<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>ui<span class="token punctuation">.</span>checkBox_5<span class="token operator">-&gt;</span><span class="token function">isChecked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> receivedDataSize <span class="token operator">&gt;=</span> <span class="token number">200</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">cleanAccept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            receivedDataSize <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        QString message<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>ui<span class="token punctuation">.</span>checkBox_2<span class="token operator">-&gt;</span><span class="token function">isChecked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            message <span class="token operator">=</span> <span class="token function">toHex</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span>  <span class="token punctuation">{<!-- --></span>
            message <span class="token operator">=</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">fromUtf8</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">logMessage</span><span class="token punctuation">(</span><span class="token string">"接收: "</span><span class="token operator">+</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="45__177">
     </a>
     4.5 十六进制转换
    </h4>
    <p>
     实现数据与十六进制字符串之间的转换：
    </p>
    <pre><code class="prism language-cpp">QString <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">toHex</span><span class="token punctuation">(</span><span class="token keyword">const</span> QByteArray <span class="token operator">&amp;</span>data<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QString hexString<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">char</span> byte <span class="token operator">:</span> data<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        hexString<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token function">QString</span><span class="token punctuation">(</span><span class="token string">"%1 "</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">arg</span><span class="token punctuation">(</span><span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>byte<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token function">QChar</span><span class="token punctuation">(</span><span class="token char">'0'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUpper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> hexString<span class="token punctuation">.</span><span class="token function">trimmed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="46__192">
     </a>
     4.6 自动重连功能
    </h4>
    <p>
     检测串口错误并自动尝试重新连接：
    </p>
    <pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">handleSerialError</span><span class="token punctuation">(</span>QSerialPort<span class="token double-colon punctuation">::</span>SerialPortError error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>error <span class="token operator">==</span> QSerialPort<span class="token double-colon punctuation">::</span>ResourceError<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">logMessage</span><span class="token punctuation">(</span><span class="token string">"串口连接断开，尝试重新连接..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        serial<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">QTimer</span><span class="token double-colon punctuation">::</span><span class="token function">singleShot</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>MainWindow<span class="token double-colon punctuation">::</span>slot_open_serial<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="47__206">
     </a>
     4.7 保存数据功能
    </h4>
    <p>
     将接收的数据保存到文件：
    </p>
    <pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token class-name">MainWindow</span><span class="token double-colon punctuation">::</span><span class="token function">save_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    QString filename <span class="token operator">=</span> <span class="token class-name">QFileDialog</span><span class="token double-colon punctuation">::</span><span class="token function">getSaveFileName</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token function">tr</span><span class="token punctuation">(</span><span class="token string">"选择保存路径"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    QFile <span class="token function">file</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
    file<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>QIODevice<span class="token double-colon punctuation">::</span>ReadWrite <span class="token operator">|</span> QIODevice<span class="token double-colon punctuation">::</span>Text<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//获取日志信息</span>
    QStringList saveData<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>ui<span class="token punctuation">.</span>listWidget<span class="token operator">-&gt;</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        QListWidgetItem<span class="token operator">*</span> item <span class="token operator">=</span> ui<span class="token punctuation">.</span>listWidget<span class="token operator">-&gt;</span><span class="token function">item</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        saveData <span class="token operator">&lt;&lt;</span> item<span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 将 QStringList 转换为单个 QString</span>
    QString saveDataString <span class="token operator">=</span> saveData<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 写入日志信息</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>saveDataString<span class="token punctuation">.</span><span class="token function">toUtf8</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 弹出成功对话框</span>
        <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">information</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token function">tr</span><span class="token punctuation">(</span><span class="token string">"保存数据"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">tr</span><span class="token punctuation">(</span><span class="token string">"保存成功！"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">QMessageBox</span><span class="token double-colon punctuation">::</span><span class="token function">warning</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token function">tr</span><span class="token punctuation">(</span><span class="token string">"保存数据"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">tr</span><span class="token punctuation">(</span><span class="token string">"保存失败！"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="5_CMake_237">
     </a>
     5. CMake配置
    </h3>
    <p>
     项目使用CMake构建，以下是
     <code>
      CMakeLists.txt
     </code>
     的核心部分：
    </p>
    <pre><code class="prism language-cmake">cmake_minimum_required(VERSION 2.8.0)
project(serailDemo)
set(CMAKE_INCLUDE_CURRENT_DIR ON)
set(CMAKE_PREFIX_PATH "/usr/lib/x86_64-linux-gnu/cmake/Qt5")
find_package(catkin REQUIRED COMPONENTS roscpp)
include_directories(${catkin_INCLUDE_DIRS})
find_package(Qt5 REQUIRED Core Widgets SerialPort)
set(QT_LIBRARIES Qt5::Widgets Qt5::SerialPort)
catkin_package()
file(GLOB QT_FORMS RELATIVE ${CMAKE_CURRENT_SOURCE_DIR} ui/*.ui)
file(GLOB QT_RESOURCES RELATIVE ${CMAKE_CURRENT_SOURCE_DIR} resources/*.qrc)
file(GLOB_RECURSE QT_MOC RELATIVE ${CMAKE_CURRENT_SOURCE_DIR} FOLLOW_SYMLINKS include/serailDemo/*.hpp *.h)
QT5_ADD_RESOURCES(QT_RESOURCES_CPP ${QT_RESOURCES})
QT5_WRAP_UI(QT_FORMS_HPP ${QT_FORMS})
QT5_WRAP_CPP(QT_MOC_HPP ${QT_MOC})
file(GLOB_RECURSE QT_SOURCES RELATIVE ${CMAKE_CURRENT_SOURCE_DIR} FOLLOW_SYMLINKS src/*.cpp)
add_executable(serailDemo ${QT_SOURCES} ${QT_RESOURCES_CPP} ${QT_FORMS_HPP} ${QT_MOC_HPP})
target_link_libraries(serailDemo ${QT_LIBRARIES} ${catkin_LIBRARIES})
install(TARGETS serailDemo RUNTIME DESTINATION ${CATKIN_PACKAGE_BIN_DESTINATION})
</code></pre>
    <h3>
     <a id="6_UI_263">
     </a>
     6. UI设计
    </h3>
    <p>
     通过Qt Designer创建界面，主要包含：
    </p>
    <ol>
     <li>
      串口配置区域：用于选择串口设备和设置串口参数
     </li>
     <li>
      接收区域：显示接收到的数据
     </li>
     <li>
      发送区域：用于编辑和发送数据
     </li>
     <li>
      控制按钮：打开/关闭串口、清空接收/发送区、保存数据等
     </li>
     <li>
      选项设置：十六进制显示/发送、添加时间戳、自动清屏等
     </li>
    </ol>
    <p>
     UI文件通过
     <code>
      QT5_WRAP_UI
     </code>
     命令转换为C++头文件，并在主窗口类中使用。
    </p>
    <h3>
     <a id="7__275">
     </a>
     7. 编译与运行
    </h3>
    <h4>
     <a id="71_catkin_277">
     </a>
     7.1 使用catkin编译
    </h4>
    <pre><code class="prism language-bash"><span class="token comment"># 在工作空间根目录下</span>
catkin_make
</code></pre>
    <h4>
     <a id="72__284">
     </a>
     7.2 运行程序
    </h4>
    <pre><code class="prism language-bash"><span class="token comment"># 在工作空间根目录下</span>
<span class="token builtin class-name">source</span> devel/setup.bash
rosrun serailDemo serailDemo<span class="token comment">#用ros开发的</span>
./build/devel/lib/serailDemo <span class="token comment">#原生linux开发的</span>
</code></pre>
    <h3>
     <a id="8__293">
     </a>
     8. 使用指南
    </h3>
    <ol>
     <li>
      <strong>
       选择串口设备
      </strong>
      ：从下拉菜单中选择要使用的串口设备
     </li>
     <li>
      <strong>
       配置串口参数
      </strong>
      ：设置波特率、数据位、停止位和校验位
     </li>
     <li>
      <strong>
       打开串口
      </strong>
      ：点击"打开串口"按钮
     </li>
     <li>
      <strong>
       发送数据
      </strong>
      ：在发送区输入要发送的数据，点击"发送消息"按钮
     </li>
     <li>
      <strong>
       接收数据
      </strong>
      ：接收到的数据将显示在接收区
     </li>
     <li>
      <strong>
       特殊功能
      </strong>
      ：
      <ul>
       <li>
        勾选"16进制显示"可将接收到的数据以十六进制显示
       </li>
       <li>
        勾选"16进制发送"可将发送的数据以十六进制发送
       </li>
       <li>
        勾选"200k清屏"当接收数据量超过200KB时自动清空接收区
       </li>
       <li>
        勾选"添加时间头"在日志前添加时间戳
       </li>
      </ul>
     </li>
     <li>
      <strong>
       保存数据
      </strong>
      ：点击"保存串口数据"按钮将接收到的数据保存到文件
     </li>
    </ol>
    <h3>
     <a id="9__307">
     </a>
     9. 常见问题与解决方案
    </h3>
    <ol>
     <li>
      <p>
       <strong>
        无法打开串口
       </strong>
      </p>
      <ul>
       <li>
        检查串口权限：确保当前用户有访问串口设备的权限
       </li>
       <li>
        检查串口是否被其他程序占用
       </li>
       <li>
        检查串口设备是否正确连接
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        数据接收显示乱码
       </strong>
      </p>
      <ul>
       <li>
        检查波特率设置是否正确
       </li>
       <li>
        检查数据位、停止位、校验位是否与设备匹配
       </li>
       <li>
        尝试以十六进制模式查看数据
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        程序闪退或卡死
       </strong>
      </p>
      <ul>
       <li>
        检查串口连接是否稳定
       </li>
       <li>
        减少高频率大数据量的传输
       </li>
       <li>
        启用自动清屏功能
       </li>
      </ul>
     </li>
    </ol>
    <h3>
     <a id="10__324">
     </a>
     10. 拓展与改进
    </h3>
    <p>
     本项目还可以进行以下改进：
    </p>
    <ol>
     <li>
      添加数据绘图功能，实时显示串口数据
     </li>
     <li>
      增加数据协议解析功能
     </li>
     <li>
      支持多串口同时操作
     </li>
    </ol>
    <h3>
     <a id="11__333">
     </a>
     11. 总结
    </h3>
    <p>
     本文介绍了一个基于Qt和ROS的串口通信工具的实现过程，包括环境配置、核心功能实现、UI设计和使用说明。该工具功能完善，界面友好，适用于各种串口设备的调试和开发工作。通过这个项目，我们可以了解Qt串口通信的基本原理和实现方法，为进一步的串口应用开发打下基础。
    </p>
    <p>
     希望这篇教程对大家学习Qt串口通信开发有所帮助！如有问题欢迎在评论区留言讨论。
    </p>
    <hr/>
    <p>
     欢迎分享、点赞、收藏！如果您对这个项目有兴趣，可以到我的GitHub仓库查看完整代码。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f35353231303131362f:61727469636c652f64657461696c732f313436313536363230" class_="artid" style="display:none">
 </p>
</div>


