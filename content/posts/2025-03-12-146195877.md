---
layout: post
title: "WPS二次开发系列Android-第三方应用如何获取WPS端内文档"
date: 2025-03-12 09:13:22 +0800
description: "WPS  文档 获取"
keywords: "WPS二次开发系列：Android 第三方应用如何获取WPS端内文档"
categories: ['未分类']
tags: ['Wps', 'Android']
artid: "146195877"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146195877
    alt: "WPS二次开发系列Android-第三方应用如何获取WPS端内文档"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146195877
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146195877
cover: https://bing.ee123.net/img/rand?artid=146195877
image: https://bing.ee123.net/img/rand?artid=146195877
img: https://bing.ee123.net/img/rand?artid=146195877
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     WPS二次开发系列：Android 第三方应用如何获取WPS端内文档
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h4>
     <a id="1_0">
     </a>
     1.需求场景
    </h4>
    <p>
     在项目开发中碰到这种情况，我们需要利用WPS的文档管理能力，比如需要调用WPS的文件选择器，来选择文档，同时需要得到WPS选择的文档结果返回给我们的应用。之前在网上找到了很久都没有找到WPS移动端有相关的API接口文档和解决方案，最近在逛WPS社区论坛的时看到了有一个WPS SDK相关介绍，经过申请SDK后一系列体验终于完美解决了问题。
    </p>
    <h4>
     <a id="2_3">
     </a>
     2、效果展示
    </h4>
    <p>
     <img alt="在这里插入图片描述" height="600" src="https://i-blog.csdnimg.cn/blog_migrate/033ba6f8d99fdb7651d272857d6f9115.gif#pic_center" width="300"/>
    </p>
    <h4>
     <a id="3_6">
     </a>
     3、具体实现步骤
    </h4>
    <p>
     通过WPS社区文章：
     <a href="https://bbs.wps.cn/topic/19205" rel="nofollow">
      解锁WPS二次开发新世界：Android开发用户专属极速接入秘籍！
     </a>
     获取相关WPS-SDK集成资料，然后一步步实现完成，先将如何获取WPS端内文档详细步骤总结如下：
    </p>
    <h5>
     <a id="31WPS_8">
     </a>
     3.1目标：获取WPS端内文件
    </h5>
    <h5>
     <a id="32__9">
     </a>
     3.2 实现步骤：
    </h5>
    <h6>
     <a id="321_10">
     </a>
     3.2.1添加依赖库
    </h6>
    <p>
     将WPS提供集成资源压缩包里面libs相关的aar文件集成到自己的工程中
     <br/>
     具体申请方式，参考：
     <br/>
     链接:
     <a href="https://365.kdocs.cn/l/clq8BwkjL5lF" rel="nofollow">
      WPS SDK集成资料申请
     </a>
    </p>
    <h6>
     <a id="322SDK_15">
     </a>
     3.2.2.SDK初始化
    </h6>
    <p>
     在自己工程Application的onCreate方法中调用SDK的初始化Api， 参考如下
    </p>
    <pre><code class="prism language-java"><span class="token class-name">SdkConfig</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SdkConfig<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token comment">//开启日志开关</span>
      <span class="token punctuation">.</span><span class="token function">setEnableDebug</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token comment">//是否禁止弹出安装更新提示框</span>
      <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//初始化</span>
<span class="token class-name">WpsSdk</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <h6>
     <a id="333WPS_26">
     </a>
     3.3.3.调用获取WPS端内文件功能接口
    </h6>
    <p>
     调用相关API接口，调起WPS文件选择器
     <br/>
     参考如下：
    </p>
    <pre><code class="prism language-java"> <span class="token class-name">FileManagerApi</span> fileManagerApi <span class="token operator">=</span> <span class="token class-name">WpsSdk</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getApi</span><span class="token punctuation">(</span><span class="token class-name">FileManagerApi</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>fileManagerApi <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            fileManagerApi<span class="token punctuation">.</span><span class="token function">selectFiles</span><span class="token punctuation">(</span><span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ResultCallback</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Uri</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token annotation punctuation">@OverridepublicvoidonCallback</span><span class="token punctuation">(</span><span class="token class-name">Result</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Uri</span><span class="token punctuation">&gt;</span></span> result<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>code <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token class-name">Uri</span> fileUri <span class="token operator">=</span> result<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
                        <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"WpsSdkLog"</span><span class="token punctuation">,</span> <span class="token string">"MainActivity selectFiles onCallback 转换输出路径：fileUri="</span> <span class="token operator">+</span> fileUri<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token comment">//从WPS路径拷贝到第三方应用路径//                        String outFile = FileUtil.copyFileFromUri(MainActivity.this, fileUri, "output");//                        Log.d("WpsSdkLog", "MainActivity selectFiles onCallback: outFile=" + outFile);</span>
                        <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">" 选择的文件路径："</span> <span class="token operator">+</span> fileUri<span class="token punctuation">,</span> <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token constant">LENGTH_SHORT</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">" 出现异常："</span> <span class="token operator">+</span> result<span class="token punctuation">.</span>msg<span class="token punctuation">,</span> <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token constant">LENGTH_SHORT</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre>
    <p>
     PS： 详细可参考 WpsSdkDemo工程 中MainActivity中的selectWpsFiles方法
     <br/>
     至此，如何实现在自己的应用中集成WPS-SDK调用WPS文档选择器的功能完成，是不是超级简单，如果能够帮助到您，请动动发财的小手来个一键三连💪，老铁们有兴趣可以加Q群：
     <font color="Red">
      628436767
     </font>
     ，吹牛摸鱼嗨起来！
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34333838303537362f:61727469636c652f64657461696c732f313436313935383737" class_="artid" style="display:none">
 </p>
</div>


