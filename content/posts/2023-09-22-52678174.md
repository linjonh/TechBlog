---
arturl_encode: "68747470733a2f:2f626c6f672e6373646e2e6e65742f77616e676c6631393836:2f61727469636c652f64657461696c732f3532363738313734"
layout: post
title: "常用的音视频QoS保障技术"
date: 2023-09-22 23:24:01 +0800
description: "本文转自：http://www.cnblogs.com/5iTech/articles/578849"
keywords: "视频qos"
categories: ['Rtp']
tags: ['无标签']
artid: "52678174"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=52678174
    alt: "常用的音视频QoS保障技术"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=52678174
featuredImagePreview: https://bing.ee123.net/img/rand?artid=52678174
---

# 常用的音视频QoS保障技术

本文转自：http://www.cnblogs.com/5iTech/articles/5788497.html

###### 一 IP网络的主要问题

在IP网络中，影响音视频会议质量的主要因素包括：
  
1. 带宽：指网络的两个节点之间特定应用业务流的平均速率，一般来说，带宽越高，就能允许更多的数据传输，从而会提供更好的音视频QoS。IP网络同时承载多种视频、语音和数据业务，具体包括VOIP、IPTV、即时通信、文件传输、网络游戏、BT、WEB、E-Mail等多种应用模式，不同应用模式的数据流量和突发性也有差别，导致音视频会议业务的带宽不平稳。
  
2. 延时：指数据包在网络的两个节点之间传送的平均往返时间。虽然音视频会议设备进行编解码以及同步处理等，也会产生延时，但其延时相对固定；而网络延时主要取决于网络的拓朴复杂性，及网络设备的处理时延等因素，对端到端的整体延时影响较大。音视频会议业务实时性要求高，对时延很敏感，一般认为如果时延超过300ms，通话双方交互的过程中能明显感觉到停顿，影响主观体验。
  
3. 抖动：指时延的变化，IP网络抖动取决于网络的动态路由，以及网络设备由于拥塞造成的延时等因素。一般的音视频解码器主要针对稳定的码流，如果经过线路传输后码流抖动较大，超过解码器的承受范围时，解码器进行丢弃（或进行大量的缓存），最终表现为丢包（或者延时），从而最终影响音视频的最终质量。
  
4. 丢包：指在网络传输过程中丢失报文的百分比，实际IP网络环境中由于网络设备拥塞而导致报文丢失，当有网络丢包时，将会影响音视频质量，比如：图像产生花屏或马赛克、声音出现断续等，严重时甚至会导致会议中断。

###### 二 常用的音视频QoS保障技术

QoS是Quality of Service（服务质量）的缩写，它表明信息在数据通信系统中传递时所获得的性能保证。音视频会议的音视频QoS保障是指音视频会议系统的一种能力，即在有影响音视频质量因素存在的IP网络上，为保障音视频业务提供所需要的服务。在网络条件保持不变的情况下，通过在音视频会议终端和MCU等网元上进行速率和误码控制等处理，可以在一定程度上做到QoS保障，提高音视频会议的音视频效果。常用的QoS保障技术包括IP优先权，速率调整，丢包重传（ARQ），前向纠错（FEC），后向纠错（PLC）等，这些QoS策略在一定程度上能控制数据包拥塞，消除传输中产生的差错，提高音视频质量。
  
IP优先级
  
IP优先级利用IP报文中的优先权部分，对音频、视频和RTCP数据流进行优先级划分，IP报文的包头中有一专用字节，称之为服务类型域“该字节前三个比特位用来定义数据报优先等级”IP优先是描述0-7等8个不同的优先等级。音视频会议系统中，当网络带宽低于一定标准时，可及时调整包的优先级级别，这样可帮助路由器选择IP包的发送与接收的优先级。一般来说音频包对时间延迟最为敏感，当网络采用IP优先权进行流量匹配时，可通过视频设备发出的修改过IP优先权字段信息的视音频包进行入队列处理，以保证音视频会议码流的优先传送。
  
速率调整
  
在一些恶劣的网络环境下，如果使用的音视频会议数据传输率引起网络的饱和，从而造成数据包丢失和严重的网络抖动，则不如降低数据传输率，消除数据包丢失和网络抖动，这种情况下降低会议码率将有助于提高视音频的连贯性，获得更好的音频和视频效果。如果视频设备支持动态速率调整技术，可以使终端和MCU能通过检测网络上有利和不利的因素来自动适应网络的容量和性能，通过动态调整音视频会议的码率，为终端用户提供尽可能好的视频质量。
  
音视频会议设备的自适应带宽调整功能主要是通过检测数据包丢失率来实现的，如果设备检测到数据包丢失率超过了指定的阀值，将自动降低音视频会议码率，提供一个具有最优视音频效果的会议码率。
  
丢包重传（ARQ）
  
当网络拥塞严重时，网络设备（如路由器）会根据缓存大小并配合相关处理机制丢掉一些视频包，音视频会议系统中视频包是采用UDP协议进行传输的，而UDP本身没有重传机制，因此会导致接收端出现图像丢帧或马赛克现象。支持丢包重传的视频设备可通过添加丢包检测和重传的机制来保证会议图像的连贯性。
  
ARQ是在网络丢包时自动重传差错的数据包，接收端需要缓冲和排序已收到的数据包，IP网络时延和抖动等因素对重传性能有很大影响，时延大时重传难以满足音视频会议业务实时性的需求。
  
FEC（Forward Error Correction）前向纠错
  
FEC算法是在发送端发出的音频数据中增加冗余信息，接收端根据冗余信息检测和纠正丢包造成的错误，由于纠错时不需要等待发送端重传丢失的信息，适合解决音视频会议这类实时业务中的网络适应性问题。FEC算法通过数据异或的方式生成交验包，同时设计播放缓冲区策略来降低延迟，网络上的延迟和抖动，减少丢包的出现。
  
在采用FEC 编码保证数据传输的可靠性的同时, 应注意选择编码方案的策略。一般来说FEC 编码的冗余度越大其纠错能力也越强, 但冗余度越大, 意味着冗余数据占用的带宽也越大, 带宽利用率越低。
  
PLC（Packet Loss Concealment）丢包隐藏算法
  
IP网络中出现音频数据包丢失时会导致语音失真，为了减轻信包丢失对语音感知质量的影响，PLC算法利用丢失信包的前一信包或邻接信包（在后一信包可获得的情况下）预测丢失的数据包，尽可能地恢复出原来的语音信息。PLC算法多数基于接收端处理，不需要发送端参与。
  
以上技术是视频会议系统中常用的音视频QOS保障技术，不同的技术对于不同的网络状况效果不同，比如ARQ重传在小丢包和较低网络延迟的网络情况下能够达到较理想的效果，因此视频会议系统的音视频QOS的关键问题是如何能够整合这些技术，使得各个技术能够发挥到最佳效果，从而提高音视频的体验。