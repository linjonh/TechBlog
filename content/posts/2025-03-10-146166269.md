---
layout: post
title: "pytest基础知识"
date: 2025-03-10 23:11:17 +0800
description: "(包含设置断点，pdb，获取最慢的10个用例的执行耗时)pytest-pytest.main()运行测试用例，pytest参数：报错 usage: runAll.py [options] [file_or_dir] [file_or_dir] [...]  ，是由于没有安装pytest-html。"
keywords: "pytest基础知识"
categories: ['未分类']
tags: ['Pytest']
artid: "146166269"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146166269
    alt: "pytest基础知识"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146166269
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146166269
cover: https://bing.ee123.net/img/rand?artid=146166269
image: https://bing.ee123.net/img/rand?artid=146166269
img: https://bing.ee123.net/img/rand?artid=146166269
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     pytest基础知识
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h2>
     pytest知识了解
    </h2>
    <p>
     pytest的基础知识了解：
     <a href="https://blog.csdn.net/lovedingd/article/details/98952868" title="Python测试框架之pytest详解_lovedingd的博客-CSDN博客_pytest框架">
      Python测试框架之pytest详解_lovedingd的博客-CSDN博客_pytest框架
     </a>
    </p>
    <p>
     (包含设置断点，pdb，获取最慢的10个用例的执行耗时)
    </p>
    <p>
    </p>
    <p>
     pytest-pytest.main()运行测试用例，pytest参数：
     <a href="https://blog.csdn.net/weixin_44006041/article/details/107934174" title="pytest-pytest.main()运行测试用例，pytest参数_小白爱吃饭的博客-CSDN博客">
      pytest-pytest.main()运行测试用例，pytest参数_小白爱吃饭的博客-CSDN博客
     </a>
    </p>
    <p>
     <img alt="" height="382" src="https://i-blog.csdnimg.cn/blog_migrate/a46bef0446a4e7deef71ee886ef46631.png" width="946"/>
    </p>
    <p>
     报错 usage: runAll.py [options] [file_or_dir] [file_or_dir] [...]  ，是由于没有安装pytest-html
    </p>
    <p>
     <img alt="" height="211" src="https://i-blog.csdnimg.cn/blog_migrate/61a450ad277b02dc7ef3a04b44489710.png" width="795"/>
    </p>
    <h3>
    </h3>
    <p>
    </p>
    <h2>
     pytest  的使用
    </h2>
    <p>
     pytest中标签名的使用 :
     <a href="https://www.cnblogs.com/benben-wu/p/11542105.html" rel="nofollow" title="pytest之mark的使用 - 奔奔-武 - 博客园">
      pytest之mark的使用 - 奔奔-武 - 博客园
     </a>
    </p>
    <p>
     Pytest装饰器   @pytest.mark.parametrize 的使用：
     <a href="https://blog.csdn.net/qq_36502272/article/details/100986069" title="Python Pytest装饰器@pytest.mark.parametrize详解_探索测试-CSDN博客_pytest.mark.parametrize">
      Python Pytest装饰器@pytest.mark.parametrize详解_探索测试-CSDN博客_pytest.mark.parametrize
     </a>
    </p>
    <p>
     @pytest.mark.xfail  :
     <a href="https://www.cnblogs.com/jescs/p/12107178.html" rel="nofollow" title="pytest xfail参数详解 - jescs - 博客园">
      pytest xfail参数详解 - jescs - 博客园
     </a>
    </p>
    <p>
     @pytest.mark.skipif()
     <img alt="" height="811" src="https://i-blog.csdnimg.cn/blog_migrate/0b34680e92b9ab74fe3912382c13d1e3.png" width="999">
      ​
     </img>
    </p>
    <h3>
    </h3>
    <h3>
    </h3>
    <h2>
     pytest 中的 fixture的使用
    </h2>
    <p>
     pytest 中的 fixture的使用（1）：
     <a href="https://www.cnblogs.com/linuxchao/p/linuxchao-pytest-fixture.html" rel="nofollow" title="pytest进阶之fixture - linux超 - 博客园">
      pytest进阶之fixture - linux超 - 博客园
     </a>
    </p>
    <p>
     pytest 的fixture的使用 （2）：
     <a href="https://www.cnblogs.com/shenh/p/11572657.html" rel="nofollow" title="Pytest 使用简介 - 三只松鼠 - 博客园">
      Pytest 使用简介 - 三只松鼠 - 博客园
     </a>
    </p>
    <p>
     将固件参数化：
    </p>
    <h3>
     <img alt="" height="876" src="https://i-blog.csdnimg.cn/blog_migrate/1e7dda3b54395385dd333511ac08e8f5.png" width="783"/>
    </h3>
    <p>
     <span style="color:#fe2c24">
      <strong>
       注意：
      </strong>
     </span>
    </p>
    <p>
     1. 需要安装 pytest-html
    </p>
    <p>
     2.
     <strong>
      若出现了 report.html 运行的0 test， 则说明是文件的命名不对
     </strong>
    </p>
    <p>
     pytest的命名规则：默认从当前目录中搜集测试用例,即在哪个目录下运行 pytest 命令,则中哪个目录中搜索
    </p>
    <p>
     -符合命令规则 test_*.py 或者 *_test.py 的文件
    </p>
    <p>
     -以 test_ 开头的函数名
    </p>
    <p>
     -以 Test 开头的测试类(没有__init__函数)当中,以 test_ 开头的函数
    </p>
    <p>
     3.  @pytest.fixture() 以及 @pytest.mark.usefixture() 的用法
    </p>
    <p>
     当function级别的 fixture 没有设置  autouse的时候，  执行完类级别的fixture，会直接执行 类中的函数
    </p>
    <p>
     <img alt="" height="589" src="https://i-blog.csdnimg.cn/blog_migrate/555e7949b72d604bc89ab9a6445e6b4f.png" width="1178"/>
    </p>
    <p>
     当function级别的 fixture 有设置  autouse的时候，  执行完类级别的fixture，会调用函数级别的fixture，再去执行类中的函数
    </p>
    <p>
     （autouse: 如果为True，则fixture func将为所有测试用例激活可以看到它。如果为False(默认值)，则需要显式激活fixture）
    </p>
    <h3>
    </h3>
    <p>
     4. 上述的案例中，fixture函数 和 测试用例写在同一文件内，如果存在多个py 文件调用的话，则需要建一个 confest文件 ，test_xxx.py 测试文件中无需 import  conftest， pytest 会自动搜索同级目录中的 conftest.py 文件
    </p>
    <p>
     5. 需要获得返回参数的时候，不可使用 @pytest.mark.usefixtures()，需要直接传参 ，因为fixture中返回的数据默认在fixture名字里面存储
    </p>
    <p>
     <img alt="" height="482" src="https://i-blog.csdnimg.cn/blog_migrate/6cf03be45552c772e9ccb83e37ab8e5e.png" width="690"/>
    </p>
    <p>
    </p>
    <h3>
    </h3>
    <h2>
     pyte st 的标签的使用 比如 @pytest.mark.demo :
    </h2>
    <p>
     <a href="https://blog.csdn.net/weixin_30257433/article/details/101093568" title="标签不生效的处理方法：PytestUnknownMarkWarning: Unknown pytest.mark.wallet - is this a typo?..._weixin_30257433的博客-CSDN博客">
      标签不生效的处理方法：PytestUnknownMarkWarning: Unknown pytest.mark.wallet - is this a typo?..._weixin_30257433的博客-CSDN博客
     </a>
    </p>
    <p>
    </p>
    <h2>
     Pytest：conftest.py在登录接口上的应用
    </h2>
    <h3>
     <a href="https://www.jianshu.com/p/cbd88a47c4d0" rel="nofollow" title="Pytest：conftest.py在登录接口上的应用 - 简书">
      Pytest：conftest.py在登录接口上的应用 - 简书
     </a>
    </h3>
    <p>
     注意： 登录接口： headers 中需要传参qtoken的值 ：  'qtoken':'VE9N35WLpFOYrEpOnrXC457xO8U2'
    </p>
    <p>
    </p>
    <h2>
     pytest 的 多进程运行cases  以及  重试运行cases
     <img alt="" height="779" src="https://i-blog.csdnimg.cn/blog_migrate/4757a33cf8bfe6315f694d7fb343315e.png" width="731">
      ​
     </img>
    </h2>
    <h3>
    </h3>
    <h3>
    </h3>
    <h2>
     py test 在命令行（terminal）运行：
    </h2>
    <p>
     pytest  test_skip.py          #运行test_skip.py文件
    </p>
    <p>
     pytest -v test_skip.py            #查看详细的运行信息
    </p>
    <p>
     pytest -m demo testCase/test_Search.py    # 运行 被标记为demo的 用例，比如说有的用例未完成，则可标记为finished，unfinished ，来方便调试
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
     pytest使用命令行来运行 测试用例：
     <a href="https://blog.csdn.net/df0128/article/details/91043150" title="pytest教程之命令行方式运行用例_df0128的专栏-CSDN博客_pytest执行命令">
      pytest教程之命令行方式运行用例_df0128的专栏-CSDN博客_pytest执行命令
     </a>
    </p>
    <p>
    </p>
    <h2 id="27.%20allure%E7%9A%84%E6%95%99%E7%A8%8B">
     <strong>
      pytest  allure的教程
     </strong>
    </h2>
    <p>
     pytest  allure的安装教程
     <a href="https://www.cnblogs.com/zhangwuxuan/p/12937998.html" rel="nofollow" title="Pytest+Allure生成自动化测试报告 - 一步一脚印丶 - 博客园">
      Pytest+Allure生成自动化测试报告 - 一步一脚印丶 - 博客园
     </a>
    </p>
    <p>
     安装allure报错提示JAVA_HOME is set to an invalid directory解决办法：
     <a href="https://blog.csdn.net/textwj/article/details/108214101" title="安装allure报错提示JAVA_HOME is set to an invalid directory解决办法_textwj的博客-CSDN博客">
      安装allure报错提示JAVA_HOME is set to an invalid directory解决办法_textwj的博客-CSDN博客
     </a>
    </p>
    <p>
     对应的安装 java jdk的教程:
     <a href="https://blog.csdn.net/weixin_42687361/article/details/82937770" title="JAVA_JDK下载与安装教程_weixin_42687361的博客-CSDN博客_javajdk安装步骤">
      JAVA_JDK下载与安装教程_weixin_42687361的博客-CSDN博客_javajdk安装步骤
     </a>
    </p>
    <p>
     安装jdk出现could not open 'D:\software\JAVA\lib\amd64\jvm.cfg' 的解决办法
     <a href="https://blog.csdn.net/lin1314yuan/article/details/82379906" title="win10安装jdk出现could not open 'D:\software\JAVA\lib\amd64\jvm.cfg'_lin1314yuan的博客-CSDN博客">
      win10安装jdk出现could not open 'D:\software\JAVA\lib\amd64\jvm.cfg'_lin1314yuan的博客-CSDN博客
     </a>
    </p>
    <p>
     allure 的用例描述使用 ：
     <a href="https://www.cnblogs.com/canglongdao/p/13414829.html" rel="nofollow" title="allure（三十）--allure描述用例详细讲解 - 星空6 - 博客园">
      allure（三十）--allure描述用例详细讲解 - 星空6 - 博客园
     </a>
    </p>
    <p>
     <strong>
      生成allure报告：
     </strong>
    </p>
    <p>
     方法1：
    </p>
    <p>
     if __name__ == '__main__':
    </p>
    <p>
     pytest.main(['-s', '-q', '--alluredir', './allure'])
    </p>
    <p>
     os.system('allure -c ./allure')
    </p>
    <p>
     os.system('allure serve ./allure-report')
    </p>
    <p>
     方法2：
    </p>
    <p>
     pytest  -n auto --alluredir=yourdir                                 #  -n auto：可以自动检测到系统的CPU核数 使用分布式运行用例  ；   --alluredir=yourdir    #只需添加 --alluredir 选项，并提供指向应存储结果的文件夹的路径   例如：pytest -n auto --alluredir .\report    或者 pytest -n auto --alluredir=report ， report是你要放置的文件夹名称
    </p>
    <p>
     allure serve report       #report 是已生成json , txt 数据的文件夹
    </p>
    <p>
    </p>
    <p>
     方法3：
    </p>
    <p>
     pytest -sq --alluredir=report     # 执行 pytest，指定 allure 结果目录为report文件夹
    </p>
    <p>
     allure generate -c -o ./allure-report    report
     <strong>
      #根据report文件夹中的文件， 生成 allure 的 html 报告 放在 allure-report文件夹下
     </strong>
    </p>
    <p>
     allure open ./allure-report     # 打开 allure 报告
    </p>
    <p>
     <img alt="" height="114" src="https://i-blog.csdnimg.cn/blog_migrate/de5d7b1d6a3a1a61cf41050bdbb7e373.png" width="873"/>
    </p>
    <p>
    </p>
    <p>
     <strong>
      清除之前生成的json，txt文件，生成新的文件
     </strong>
    </p>
    <p>
     pytest test_2.py  --alluredir=. /report   --clean-alluredir   #report为存放json，txt文件的文件夹 ， 注意clean 后面接的是 - ，不是=
    </p>
    <p>
    </p>
    <p>
     <strong>
      allure命令行
     </strong>
     ：
     <a href="https://www.cnblogs.com/poloyy/p/13890986.html" rel="nofollow" title="Pytest 系列（27）- allure 命令行参数 - 小菠萝测试笔记 - 博客园">
      Pytest 系列（27）- allure 命令行参数 - 小菠萝测试笔记 - 博客园
     </a>
    </p>
    <p>
    </p>
    <p>
    </p>
    <h3 id="29.%20yaml%E6%96%87%E4%BB%B6%EF%BC%9A">
     <strong>
      yaml文件：
     </strong>
    </h3>
    <p>
     yaml文件的使用
     <span contenteditable="false" tabindex="-1">
      <a href="https://www.cnblogs.com/xiaohuhu/p/9432770.html" rel="nofollow noopener noreferrer" target="_blank" title="自动化项目配置或用例文件格式推荐--yaml - hyx20160514 - 博客园">
       自动化项目配置或用例文件格式推荐--yaml - hyx20160514 - 博客园
      </a>
     </span>
    </p>
    <p>
     yaml 校验器
     <span contenteditable="false" tabindex="-1">
      <a href="http://www.bejson.com/validators/yaml_editor/" rel="nofollow noopener noreferrer" target="_blank" title="YAML、YML在线编辑器(格式化校验)-BeJSON.com">
       YAML、YML在线编辑器(格式化校验)-BeJSON.com
      </a>
     </span>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e6373:646e2e6e65742f4461656e6572797354617267617279656e2f:61727469636c652f64657461696c732f313436313636323639" class_="artid" style="display:none">
 </p>
</div>


