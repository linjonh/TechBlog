---
layout: post
title: "CORS-Django-跨域配置"
date: 2025-03-12 11:42:32 +0800
description: "之前学的跨域，最近访问页面总是时有时无的，今天下定决心好好研究。如需转载，标记出处"
keywords: "CORS + Django 跨域配置"
categories: ['未分类']
tags: ['Django', 'Cors']
artid: "146199911"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146199911
    alt: "CORS-Django-跨域配置"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146199911
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146199911
cover: https://bing.ee123.net/img/rand?artid=146199911
image: https://bing.ee123.net/img/rand?artid=146199911
img: https://bing.ee123.net/img/rand?artid=146199911
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     CORS + Django 跨域配置
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <blockquote>
     <p>
      之前学的跨域，最近访问页面总是时有时无的，今天下定决心好好研究。
     </p>
     <p>
      如需转载，标记出处
     </p>
    </blockquote>
    <p>
     关于 CORS（跨域资源共享） ，官方推荐使用第三方库是
     <a href="https://github.com/adamchainz/django-cors-headers" title="django-cors-headers">
      django-cors-headers
     </a>
     （ Django 跨域问题的标准工具）
    </p>
    <h2>
     一、教程
    </h2>
    <p>
     <br/>
     1. 安装 django-cors-headers
    </p>
    <blockquote>
     <p>
      pip install django-cors-headers
     </p>
    </blockquote>
    <p>
     2. 添加到 Django 项目中的 INSTALLED_APPS
    </p>
    <blockquote>
     <p>
      <br/>
      INSTALLED_APPS = [
      <br/>
      ...
      <br/>
      'corsheaders',
      <br/>
      ...
      <br/>
      ]
     </p>
    </blockquote>
    <p>
     <br/>
     3. 添加到 MIDDLEWARE（必须放在较前位置，建议第一个）
    </p>
    <blockquote>
     <p>
      <br/>
      MIDDLEWARE = [
      <br/>
      'corsheaders.middleware.CorsMiddleware',
      <br/>
      'django.middleware.common.CommonMiddleware',  # 确保也有CommonMiddleware
      <br/>
      ...
      <br/>
      ]
     </p>
    </blockquote>
    <p>
     <br/>
     4. 配置允许跨域的域名
     <br/>
     只允许特定域，这里就是你的前端url,ip地址也要带上，
    </p>
    <blockquote>
     <p>
      CORS_ALLOWED_ORIGINS = [
     </p>
     <p>
      <br/>
      "http://example.com:8080",   # 你的正式域名
      <br/>
      ]
     </p>
    </blockquote>
    <p>
     要是有具体的域名，需要配置hosts文件（参照中间的meiduo.site那一行）
    </p>
    <p>
     <img alt="" height="294" src="https://i-blog.csdnimg.cn/direct/8de0e07dd19b4b078b3eeb8e6b783140.png" width="536"/>
    </p>
    <p>
     5.指定哪些主机名（域名或 IP 地址）允许访问你的 Django 网站
    </p>
    <p>
     ALLOWED_HOSTS 是 Django 的访问白名单，只有写进去的域名或 IP 才能访问，否则拒绝访问。
    </p>
    <blockquote>
     <p>
      ALLOWED_HOSTS = ['www.meiduo.site','127.0.0.1']
     </p>
    </blockquote>
    <p>
     6.进阶配置（根据需要选择，可以不看）
    </p>
    <blockquote>
     <p>
      <br/>
      1）. 允许发送认证信息（如 cookie、凭证等）
      <br/>
      CORS_ALLOW_CREDENTIALS = True
      <br/>
      2）. 允许特定的 HTTP 方法
      <br/>
      CORS_ALLOW_METHODS = [
      <br/>
      "DELETE",
      <br/>
      "GET",
      <br/>
      "OPTIONS",
      <br/>
      "PATCH",
      <br/>
      "POST",
      <br/>
      "PUT",
      <br/>
      ]
     </p>
    </blockquote>
    <p>
    </p>
    <h2>
     二、我自己的配置如下:
    </h2>
    <p>
     前端www.meiduo.siteL:8080
    </p>
    <p>
     后端是8000
    </p>
    <pre><code class="language-python">
ALLOWED_HOSTS = ['www.meiduo.site','127.0.0.1']

# Application definition

INSTALLED_APPS = [
    'corsheaders',
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'apps.users',
    'apps.verifications'

]
#跨域添加白名单

CORS_ALLOWED_ORIGINS = [
    'http://127.0.0.1:8080',
    'http://localhost:8080',
    'http://www.meiduo.site:8080',
]
CORS_ALLOW_CREDENTIALS = True  # 允许携带cookie
CORS_ALLOW_METHODS = [
    "GET",
    "POST"
]
MIDDLEWARE = [
    'corsheaders.middleware.CorsMiddleware',
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
]</code></pre>
    <h2>
     三、运行
    </h2>
    <p>
     我的前后端目录放在同一个文件夹中
    </p>
    <p>
     <img alt="" height="247" src="https://i-blog.csdnimg.cn/direct/969b0669beac43e39b7d693d05ff2e99.png" width="484"/>
    </p>
    <p>
     进入前端目录里，开个终端
    </p>
    <blockquote>
     <p>
      python3 -m http.server 8080
      <br/>
     </p>
    </blockquote>
    <p>
     再启动django
    </p>
    <p>
     访问​​​​​​​
     <a href="http://www.meiduo.site:8080/index.html" rel="nofollow" title="http://www.meiduo.site:8080/index.html">
      http://www.meiduo.site:8080/index.html
     </a>
    </p>
    <p>
     搞定
    </p>
    <h2>
     问题集：
    </h2>
    <h3>
     1.ALLOWED_HOSTS和CORS_ALLOWED_ORIGINS 两者有什么区别？
    </h3>
    <table style="margin-left:3.1500pt">
     <tbody>
      <tr>
       <td style="vertical-align:center">
        <p style="margin-left:.0001pt; margin-right:0; text-align:center">
         <strong>
          <strong>
           配置
          </strong>
         </strong>
        </p>
       </td>
       <td style="vertical-align:center">
        <p style="margin-left:.0001pt; margin-right:0; text-align:center">
         <strong>
          <strong>
           作用
          </strong>
         </strong>
        </p>
       </td>
       <td style="vertical-align:center">
        <p style="margin-left:.0001pt; margin-right:0; text-align:center">
         <strong>
          <strong>
           针对的对象
          </strong>
         </strong>
        </p>
       </td>
      </tr>
      <tr>
       <td style="vertical-align:center">
        <p style="margin-left:.0001pt; margin-right:0; text-align:left">
         ALLOWED_HOSTS
        </p>
       </td>
       <td style="vertical-align:center">
        <p style="margin-left:.0001pt; margin-right:0; text-align:left">
         <strong>
          谁能访问 Django 服务器
         </strong>
        </p>
       </td>
       <td style="vertical-align:center">
        <p style="margin-left:.0001pt; margin-right:0; text-align:left">
         浏览器发出的所有请求
        </p>
        <p style="margin-left:.0001pt; margin-right:0; text-align:left">
         举例：http://www.meiduo.site
        </p>
       </td>
      </tr>
      <tr>
       <td style="vertical-align:center">
        <p style="margin-left:.0001pt; margin-right:0; text-align:left">
         CORS_ALLOWED_ORIGINS
        </p>
       </td>
       <td style="vertical-align:center">
        <p style="margin-left:.0001pt; margin-right:0; text-align:left">
         <strong>
          允许哪些前端域名跨域调用 Django API
         </strong>
        </p>
       </td>
       <td style="vertical-align:center">
        <p style="margin-left:.0001pt; margin-right:0; text-align:left">
         前端网页的 跨域请求
        </p>
        <p style="margin-left:.0001pt; margin-right:0; text-align:left">
         举例：http://www.meiduo.site:8080
        </p>
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     跨域（CORS, Cross-Origin Resource Sharing）指的是：
     <br/>
     浏览器限制，当前网页的 JavaScript 只能访问 "同源" 的资源。
    </p>
    <p style="text-align:left">
     只要「协议、域名、端口」有任何一个不同，都算不同源（跨域）
    </p>
    <p style="text-align:left">
     端口不同，哪怕 IP 和协议都相同，也算跨域。浏览器默认 不允许 JS 跨域请求接口，所以需要通过 CORS 告诉 Django：我允许 8080(前端的） 来调用我 8000 （后端的）接口
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323530345f39303236363737332f:61727469636c652f64657461696c732f313436313939393131" class_="artid" style="display:none">
 </p>
</div>


