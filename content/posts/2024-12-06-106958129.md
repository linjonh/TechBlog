---
layout: post
title: "Ajax配合后端实现Excel的导出"
date: 2024-12-06 06:44:50 +0800
description: "一、需求在我们的日常开发中，可能经常需要遇到excel的导出，以往excel的导出服务器端都是使用的"
keywords: "ajax导出excel文件"
categories: ['前端']
tags: ['Post', 'Post', 'Ajax', 'Ajax']
artid: "106958129"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=106958129
    alt: "Ajax配合后端实现Excel的导出"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=106958129
featuredImagePreview: https://bing.ee123.net/img/rand?artid=106958129
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Ajax配合后端实现Excel的导出
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-dracula" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="_0">
     </a>
     一、需求
    </h3>
    <p>
     在我们的日常开发中，可能经常需要遇到excel的导出，以往excel的导出服务器端都是使用的
     <code>
      GET
     </code>
     方法，但是某些情况下，服务器端只能使用
     <code>
      POST
     </code>
     方法，那么我们有没有好的方法实现excel的导出呢，并且页面最好不要刷新。
    </p>
    <h3>
     <a id="_2">
     </a>
     二、实现思路
    </h3>
    <p>
     1、方案一：我们可以使用
     <code>
      ajax
     </code>
     拿到服务器端返回的
     <code>
      数据下载流
     </code>
     ,然后借助
     <code>
      Blob
     </code>
     对象，在动态的创建一个
     <code>
      a
     </code>
     链接，那么也可以实现。
     <br/>
     2、方案二：动态创建一个
     <code>
      iframe
     </code>
     标签下载，这种方案可以
     <code>
      POST
     </code>
     请求可能就无法下载了。
     <br/>
     3、方案三：页面上动态的创建一个
     <code>
      form
     </code>
     然后提交这个
     <code>
      form
     </code>
     。
     <br/>
     此处我们使用
     <code>
      方案一
     </code>
     即使用
     <code>
      ajax
     </code>
     来实现。
    </p>
    <h3>
     <a id="_7">
     </a>
     三、实现步骤
    </h3>
    <p>
     1、
     <code>
      ajax
     </code>
     请求的发送我们使用
     <code>
      axios
     </code>
     库来完成，
     <code>
      axios
     </code>
     的
     <code>
      responseType
     </code>
     需要设置成
     <code>
      Blob
     </code>
     ,默认是
     <code>
      json
     </code>
     。
     <br/>
     2、创建
     <code>
      Blob
     </code>
     对象
     <br/>
     3、创建
     <code>
      a
     </code>
     标签
     <br/>
     4、触发下载动作
    </p>
    <h3>
     <a id="_12">
     </a>
     四、前端代码
    </h3>
    <pre><code class="prism language-html"><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>ajax 文件导出<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://unpkg.com/axios/dist/axios.min.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>exportExcel()<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>导出<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
    <span class="token keyword">function</span> <span class="token function">exportExcel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            method<span class="token punctuation">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>
            url<span class="token punctuation">:</span> <span class="token string">"http://localhost:8080/export"</span><span class="token punctuation">,</span>
            timeout<span class="token punctuation">:</span> <span class="token number">5000</span><span class="token punctuation">,</span>
            responseType<span class="token punctuation">:</span> <span class="token string">'blob'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">var</span> data <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
            <span class="token keyword">var</span> blob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>data<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>type<span class="token punctuation">:</span> <span class="token string">'application/octet-stream'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> exportLink <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            exportLink<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"download"</span><span class="token punctuation">,</span><span class="token string">"ajax文件下载.xlsx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            exportLink<span class="token punctuation">.</span>href <span class="token operator">=</span> url<span class="token punctuation">;</span>
            document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>exportLink<span class="token punctuation">)</span><span class="token punctuation">;</span>
            exportLink<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <h3>
     <a id="_46">
     </a>
     实现效果
    </h3>
    <p>
     <img alt="ajax-文件下载" src="https://i-blog.csdnimg.cn/blog_migrate/64c36083d5fdcc022fdbd9455cb1292c.gif"/>
    </p>
    <h3>
     <a id="_48">
     </a>
     完整代码如下
    </h3>
    <p>
     <a href="https://gitee.com/huan1993/front/tree/master/ajax-download" rel="nofollow">
      ajax文件下载
     </a>
     https://gitee.com/huan1993/front/tree/master/ajax-download
    </p>
   </div>
   <link href="./../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="./../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
  <div class="blog-extension-box" id="blogExtensionBox" style="width:400px;margin:auto;margin-top:12px">
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f66755f68756f5f313939332f:61727469636c652f64657461696c732f313036393538313239" class_="artid" style="display:none">
 </p>
</div>


