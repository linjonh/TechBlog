---
layout: post
title: "二Jenkins部署你的第一个自动化流程Vuepress项目"
date: 2025-03-10 00:33:35 +0800
description: "因为我们的代码是存放到github上的，大致的流程就是，首先我们需要将代码从github上面拉下来，然后使用pnpm打包工具，将前端项目打包成静态文件，然后通过SSH将生成的静态文件传送到指定的服务器上，使用nginx来代理。"
keywords: "二、Jenkins部署你的第一个自动化流程(Vuepress项目)"
categories: ['未分类']
tags: ['运维', '自动化', 'Jenkins']
artid: "146141520"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146141520
    alt: "二Jenkins部署你的第一个自动化流程Vuepress项目"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146141520
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146141520
cover: https://bing.ee123.net/img/rand?artid=146141520
image: https://bing.ee123.net/img/rand?artid=146141520
img: https://bing.ee123.net/img/rand?artid=146141520
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     二、Jenkins部署你的第一个自动化流程(Vuepress项目)
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="_0">
     </a>
     一、构建你的第一个自动部署流程
    </h3>
    <p>
     因为我们的代码是存放到github上的，大致的流程就是，首先我们需要将代码从github上面拉下来，然后使用pnpm打包工具，将前端项目打包成静态文件，然后通过SSH将生成的静态文件传送到指定的服务器上，使用nginx来代理。
    </p>
    <h4>
     <a id="11item_3">
     </a>
     1.1、创建item
    </h4>
    <p>
     Jenkins拉取git代码以来jenkins中git的插件，打包遍历依赖Nodejs插件，传输文件依赖SSH插件
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/1f5715400cdf4df1889b72ec9a169e1b.png"/>
    </p>
    <h4>
     <a id="12_6">
     </a>
     1.2、源文件管理
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/fa84a02734944e0293d0d3a1fb9affbd.png">
      <br/>
      如果使用的是公开的仓库，就不用选择下面的credentials，如果是私有的仓库的话，就需要添加credential，（添加Credentials界面如下）
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/4c93545e8626498dae2bcd45f5e9acb3.png">
       <br/>
       如果不知道如何生成github令牌，可以参考：
       <a href="https://zhuanlan.zhihu.com/p/501872439" rel="nofollow">
        github访问令牌token的创建方法
       </a>
      </img>
     </img>
    </p>
    <h4>
     <a id="13_13">
     </a>
     1.3、配置运行环境
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/c0676fb38f6f461b8179934e21b854d0.png">
      <br/>
      配置NodeJS
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/182e68ce9f65481cbabc1c419336aefc.png"/>
     </img>
    </p>
    <h4>
     <a id="14shell_18">
     </a>
     1.4、配置执行shell
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/1c36d068ed564d45bff5e1fa3e1c2266.png"/>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/259b3285cbeb43c090577bcd042fcd59.png"/>
    </p>
    <pre><code class="prism language-shell"><span class="token builtin class-name">echo</span> <span class="token variable">$WORKSPACE</span>
<span class="token function">node</span> <span class="token parameter variable">-v</span>
<span class="token function">npm</span> <span class="token parameter variable">-v</span>
<span class="token function">npm</span> <span class="token function">install</span> <span class="token parameter variable">-g</span> <span class="token function">pnpm</span>
<span class="token function">pnpm</span> <span class="token parameter variable">-v</span>
<span class="token function">pnpm</span> config <span class="token builtin class-name">set</span> registry https://registry.npmmirror.com

<span class="token function">pnpm</span> i
<span class="token function">pnpm</span> build
</code></pre>
    <h3>
     <a id="_33">
     </a>
     二、遇到的问题
    </h3>
    <h4>
     <a id="21_Github_34">
     </a>
     2.1 配置Github的链接，代码拉不下来
    </h4>
    <p>
     这一种拉不下来是因为网络的问题，在大陆访问github，使用过的人都知道。
     <br/>
     这里我在Jenkins服务器上面生成公钥和私钥，把公钥配置到github上面解决的。
    </p>
    <h4>
     <a id="22Github_37">
     </a>
     2.2、拉取私有的Github仓库代码
    </h4>
    <p>
     当时一直没有配置对，就是没有整明白credentials这个，使用Username Password要使用github生成的令牌，因为密码github在很久之前就放弃使用了。
    </p>
    <h4>
     <a id="23jenkins_39">
     </a>
     2.3、容器中jenkins用户没有创建目录的权限问题
    </h4>
    <p>
     当时以为拉不下来是因为jenkins没有创建目录的权限，但不是因为这个。
    </p>
    <h4>
     <a id="24Github_42">
     </a>
     2.4、Github公开仓库都拉取不到
    </h4>
    <pre><code class="prism language-shell">fatal: unable to access <span class="token string">'https://github.com/SmaxxxengC/bxxng.git/'</span><span class="token builtin class-name">:</span> Failed to connect to github.com port <span class="token number">443</span> after <span class="token number">130257</span> ms: Couldn't connect to server
</code></pre>
    <p>
     我是用gitee的就能拉取到，还是因为在国内拉github代码的网络问题。
    </p>
    <h4>
     <a id="25_49">
     </a>
     2.5、都配置好了，但是还是会有报错
    </h4>
    <pre><code class="prism language-shell">error: RPC failed<span class="token punctuation">;</span> <span class="token function">curl</span> <span class="token number">92</span> HTTP/2 stream <span class="token number">11</span> was not closed cleanly: CANCEL <span class="token punctuation">(</span>err <span class="token number">8</span><span class="token punctuation">)</span>
error: <span class="token number">30402</span> bytes of body are still expected
fetch-pack: unexpected disconnect <span class="token keyword">while</span> reading sideband packet
fatal: early EOF
fatal: fetch-pack: invalid index-pack output

	at PluginClassLoader <span class="token keyword">for</span> git-client//org.jenkinsci.plugins.gitclient.CliGitAPIImpl.launchCommandIn<span class="token punctuation">(</span>CliGitAPIImpl.java:2852<span class="token punctuation">)</span>
	at PluginClassLoader <span class="token keyword">for</span> git-client//org.jenkinsci.plugins.gitclient.CliGitAPIImpl.launchCommandWithCredentials<span class="token punctuation">(</span>CliGitAPIImpl.java:2188<span class="token punctuation">)</span>
	at PluginClassLoader <span class="token keyword">for</span> git-client//org.jenkinsci.plugins.gitclient.CliGitAPIImpl<span class="token variable">$1</span>.execute<span class="token punctuation">(</span>CliGitAPIImpl.java:638<span class="token punctuation">)</span>
	at PluginClassLoader <span class="token keyword">for</span> git//hudson.plugins.git.GitSCM.fetchFrom<span class="token punctuation">(</span>GitSCM.java:997<span class="token punctuation">)</span>
	<span class="token punctuation">..</span>. <span class="token number">12</span> <span class="token function">more</span>
ERROR: Error fetching remote repo <span class="token string">'origin'</span>
Finished: FAILURE
</code></pre>
    <p>
     今天早上重新拉取，不知道为什么就可以拉了，应该是当时网络的问题。
    </p>
    <h4>
     <a id="26_67">
     </a>
     2.6、将生成的文件推到指定服务器
    </h4>
    <p>
     实现：将构建后的文件推送到指定服务器上，需要哪些配置
    </p>
    <p>
     参考：
     <a href="https://blog.csdn.net/lzf9651/article/details/129416956">
      Jenkins拉取代码构建完成后部署到其他服务器（详解）
     </a>
    </p>
    <p>
     如果出现传输0个文件的问题，参考：
     <a href="https://www.jianshu.com/p/ef6a4022b7b5" rel="nofollow">
      解决SSH: Transferred 0 file(s)
     </a>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34313238383832342f:61727469636c652f64657461696c732f313436313431353230" class_="artid" style="display:none">
 </p>
</div>


