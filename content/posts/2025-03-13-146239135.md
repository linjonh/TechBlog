---
layout: post
title: "Python实战进阶No22-Python自动化办公实战ExcelWordPDF文件处理全攻略"
date: 2025-03-13 18:41:57 +0800
description: "本文将带你掌握Python在办公自动化领域的三大核心场景：Excel数据处理、Word文档生成与PDF文件操作。通过实战案例，你将学会如何用openpyxl、pandas、python-docx、PyPDF2等工具高效完成批量报表生成、动态文档创建和PDF合并水印添加，显著提升工作效率。"
keywords: "《Python实战进阶》No22 Python自动化办公实战：Excel/Word/PDF文件处理全攻略"
categories: ['Python']
tags: ['自动化', 'Python', 'Excel']
artid: "146239135"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146239135
    alt: "Python实战进阶No22-Python自动化办公实战ExcelWordPDF文件处理全攻略"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146239135
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146239135
cover: https://bing.ee123.net/img/rand?artid=146239135
image: https://bing.ee123.net/img/rand?artid=146239135
img: https://bing.ee123.net/img/rand?artid=146239135
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     《Python实战进阶》No22 Python自动化办公实战：Excel/Word/PDF文件处理全攻略
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="No22_PythonExcelWordPDF_0">
     </a>
     No22 Python自动化办公实战：Excel/Word/PDF文件处理全攻略
    </h2>
    <hr/>
    <h3>
     <a id="_4">
     </a>
     <strong>
      摘要
     </strong>
    </h3>
    <p>
     本文将带你掌握Python在办公自动化领域的三大核心场景：Excel数据处理、Word文档生成与PDF文件操作。通过实战案例，你将学会如何用
     <code>
      openpyxl
     </code>
     、
     <code>
      pandas
     </code>
     、
     <code>
      python-docx
     </code>
     、
     <code>
      PyPDF2
     </code>
     等工具高效完成批量报表生成、动态文档创建和PDF合并水印添加，显著提升工作效率。
    </p>
    <hr/>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/c7098451e82d4b3f89cbf41964161b37.png#pic_center"/>
    </p>
    <h3>
     <a id="_10">
     </a>
     <strong>
      环境准备
     </strong>
    </h3>
    <h4>
     <a id="_11">
     </a>
     <strong>
      运行环境
     </strong>
    </h4>
    <ul>
     <li>
      <strong>
       Python版本
      </strong>
      ：3.8+
     </li>
     <li>
      <strong>
       依赖库版本
      </strong>
      ：
      <pre><code class="prism language-bash"><span class="token assign-left variable">pandas</span><span class="token operator">==</span><span class="token number">2.0</span>.3
<span class="token assign-left variable">openpyxl</span><span class="token operator">==</span><span class="token number">3.1</span>.2
python-docx<span class="token operator">==</span><span class="token number">1.1</span>.0
<span class="token assign-left variable">PyPDF2</span><span class="token operator">==</span><span class="token number">3.0</span>.1
<span class="token assign-left variable">reportlab</span><span class="token operator">==</span><span class="token number">4.0</span>.4
</code></pre>
     </li>
    </ul>
    <h4>
     <a id="_22">
     </a>
     <strong>
      安装命令
     </strong>
    </h4>
    <pre><code class="prism language-bash">pip <span class="token function">install</span> pandas openpyxl python-docx PyPDF2 reportlab
</code></pre>
    <hr/>
    <h3>
     <a id="_29">
     </a>
     <strong>
      核心知识点与实战案例
     </strong>
    </h3>
    <h4>
     <a id="1_Excel_31">
     </a>
     <strong>
      1. Excel文件处理：批量生成销售报表
     </strong>
    </h4>
    <h5>
     <a id="_32">
     </a>
     <strong>
      场景需求
     </strong>
    </h5>
    <p>
     将多个部门的销售数据（CSV格式）合并到Excel报表，并添加数据透视表和图表。
    </p>
    <h5>
     <a id="_35">
     </a>
     <strong>
      代码实现
     </strong>
    </h5>
    <pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> random

<span class="token comment"># === 生成随机销售数据 ===</span>
departments <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"销售部"</span><span class="token punctuation">,</span> <span class="token string">"市场部"</span><span class="token punctuation">,</span> <span class="token string">"技术部"</span><span class="token punctuation">,</span> <span class="token string">"客服部"</span><span class="token punctuation">]</span>
quarters <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Q1"</span><span class="token punctuation">,</span> <span class="token string">"Q2"</span><span class="token punctuation">,</span> <span class="token string">"Q3"</span><span class="token punctuation">,</span> <span class="token string">"Q4"</span><span class="token punctuation">]</span>

data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"部门"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>departments<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">"季度"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>quarters<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">"销售额"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">,</span> <span class="token number">50000</span><span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
df<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">"sales_data.csv"</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8-sig'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"测试数据已生成：sales_data.csv"</span><span class="token punctuation">)</span>

<span class="token comment"># 读取CSV数据</span>
sales_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"sales_data.csv"</span><span class="token punctuation">)</span>

<span class="token comment"># 创建Excel文件并保存</span>
<span class="token keyword">with</span> pd<span class="token punctuation">.</span>ExcelWriter<span class="token punctuation">(</span><span class="token string">"sales_report.xlsx"</span><span class="token punctuation">,</span> engine<span class="token operator">=</span><span class="token string">'openpyxl'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> writer<span class="token punctuation">:</span>
    sales_data<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>writer<span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">'原始数据'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 生成数据透视表</span>
    pivot_table <span class="token operator">=</span> pd<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>
        sales_data<span class="token punctuation">,</span>
        values<span class="token operator">=</span><span class="token string">'销售额'</span><span class="token punctuation">,</span>
        index<span class="token operator">=</span><span class="token string">'部门'</span><span class="token punctuation">,</span>
        columns<span class="token operator">=</span><span class="token string">'季度'</span><span class="token punctuation">,</span>
        aggfunc<span class="token operator">=</span><span class="token string">'sum'</span>
    <span class="token punctuation">)</span>
    pivot_table<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>writer<span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">'数据透视表'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Excel报表生成成功！路径：sales_report.xlsx"</span><span class="token punctuation">)</span>
</code></pre>
    <h5>
     <a id="_74">
     </a>
     <strong>
      输入输出示例
     </strong>
    </h5>
    <ul>
     <li>
      <strong>
       输入文件
      </strong>
      ：
      <code>
       sales_data.csv
      </code>
      （包含部门、季度、销售额字段）
     </li>
     <li>
      <strong>
       输出文件
      </strong>
      ：生成包含原始数据和透视表的Excel文件
     </li>
    </ul>
    <pre><code class="prism language-bash">测试数据已生成：sales_data.csv
Excel报表生成成功！路径：sales_report.xlsx
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/36dfb649ff75463899a5fbd02c732ea9.png"/>
    </p>
    <hr/>
    <h4>
     <a id="2_Word_90">
     </a>
     <strong>
      2. Word文档处理：自动生成带图表的合同
     </strong>
    </h4>
    <h5>
     <a id="_91">
     </a>
     <strong>
      场景需求
     </strong>
    </h5>
    <p>
     根据模板自动生成包含客户名称、金额和柱状图的销售合同。
    </p>
    <h5>
     <a id="_94">
     </a>
     <strong>
      代码实现
     </strong>
    </h5>
    <pre><code class="prism language-python"><span class="token keyword">from</span> docx <span class="token keyword">import</span> Document
<span class="token keyword">from</span> docx<span class="token punctuation">.</span>shared <span class="token keyword">import</span> Pt<span class="token punctuation">,</span> Inches
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> os

<span class="token comment"># === 生成合同模板 ===</span>
<span class="token keyword">def</span> <span class="token function">create_contract_template</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    doc <span class="token operator">=</span> Document<span class="token punctuation">(</span><span class="token punctuation">)</span>
    doc<span class="token punctuation">.</span>add_heading<span class="token punctuation">(</span><span class="token string">"销售合同"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    doc<span class="token punctuation">.</span>add_paragraph<span class="token punctuation">(</span><span class="token string">"合同编号：_________"</span><span class="token punctuation">,</span> style<span class="token operator">=</span><span class="token string">'List Bullet'</span><span class="token punctuation">)</span>
    doc<span class="token punctuation">.</span>add_paragraph<span class="token punctuation">(</span><span class="token string">"签订日期：_________"</span><span class="token punctuation">,</span> style<span class="token operator">=</span><span class="token string">'List Bullet'</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 添加表格条款</span>
    table <span class="token operator">=</span> doc<span class="token punctuation">.</span>add_table<span class="token punctuation">(</span>rows<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> cols<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
    hdr_cells <span class="token operator">=</span> table<span class="token punctuation">.</span>rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cells
    hdr_cells<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">'条款'</span>
    hdr_cells<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">'内容'</span>
    table<span class="token punctuation">.</span>style <span class="token operator">=</span> <span class="token string">'Table Grid'</span>
    
    doc<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"contract_template.docx"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"合同模板已生成：contract_template.docx"</span><span class="token punctuation">)</span>

<span class="token comment"># 检查模板是否存在，不存在则创建</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"contract_template.docx"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    create_contract_template<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># === 原有代码扩展 ===</span>
<span class="token comment"># 创建图表</span>
plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Q1'</span><span class="token punctuation">,</span> <span class="token string">'Q2'</span><span class="token punctuation">,</span> <span class="token string">'Q3'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">230</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"季度销售额（万元）"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">"sales_chart.png"</span><span class="token punctuation">)</span>

<span class="token comment"># 填充Word文档</span>
doc <span class="token operator">=</span> Document<span class="token punctuation">(</span><span class="token string">"contract_template.docx"</span><span class="token punctuation">)</span>
doc<span class="token punctuation">.</span>add_paragraph<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"客户名称：ABC科技有限公司"</span></span><span class="token punctuation">,</span> style<span class="token operator">=</span><span class="token string">'List Bullet'</span><span class="token punctuation">)</span>
doc<span class="token punctuation">.</span>add_paragraph<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"合同金额：¥500,000"</span></span><span class="token punctuation">,</span> style<span class="token operator">=</span><span class="token string">'List Bullet'</span><span class="token punctuation">)</span>
doc<span class="token punctuation">.</span>add_picture<span class="token punctuation">(</span><span class="token string">"sales_chart.png"</span><span class="token punctuation">,</span> width<span class="token operator">=</span>Inches<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
doc<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"generated_contract.docx"</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"合同生成成功！路径：generated_contract.docx"</span><span class="token punctuation">)</span>
</code></pre>
    <h5>
     <a id="_138">
     </a>
     <strong>
      输入输出示例
     </strong>
    </h5>
    <ul>
     <li>
      <strong>
       输入模板
      </strong>
      ：
      <code>
       contract_template.docx
      </code>
      （含固定条款）
     </li>
     <li>
      <strong>
       输出文件
      </strong>
      ：动态插入文本和图表的完整合同
     </li>
    </ul>
    <pre><code class="prism language-bash">合同模板已生成：contract_template.docx
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/aa91d523a70043ffb6ef90342042e8b2.png#pic_center"/>
    </p>
    <hr/>
    <h4>
     <a id="3_PDF_152">
     </a>
     <strong>
      3. PDF处理：合并文件并添加水印
     </strong>
    </h4>
    <h5>
     <a id="_153">
     </a>
     <strong>
      场景需求
     </strong>
    </h5>
    <p>
     合并多个部门报告PDF，并统一添加"机密"水印。
    </p>
    <h5>
     <a id="_156">
     </a>
     <strong>
      代码实现
     </strong>
    </h5>
    <pre><code class="prism language-python"><span class="token keyword">from</span> PyPDF2 <span class="token keyword">import</span> PdfReader<span class="token punctuation">,</span> PdfWriter
<span class="token keyword">from</span> reportlab<span class="token punctuation">.</span>pdfgen <span class="token keyword">import</span> canvas
<span class="token keyword">from</span> reportlab<span class="token punctuation">.</span>lib<span class="token punctuation">.</span>pagesizes <span class="token keyword">import</span> letter
<span class="token keyword">import</span> os

<span class="token comment"># 生成测试PDF ===</span>
<span class="token keyword">def</span> <span class="token function">create_sample_pdf</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">:</span>
    c <span class="token operator">=</span> canvas<span class="token punctuation">.</span>Canvas<span class="token punctuation">(</span>filename<span class="token punctuation">,</span> pagesize<span class="token operator">=</span>letter<span class="token punctuation">)</span>
    text <span class="token operator">=</span> c<span class="token punctuation">.</span>beginText<span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">750</span><span class="token punctuation">)</span>
    text<span class="token punctuation">.</span>setFont<span class="token punctuation">(</span><span class="token string">"Courier"</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> line <span class="token keyword">in</span> content<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        text<span class="token punctuation">.</span>textLine<span class="token punctuation">(</span>line<span class="token punctuation">)</span>
    c<span class="token punctuation">.</span>drawText<span class="token punctuation">(</span>text<span class="token punctuation">)</span>
    c<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 生成测试PDF文件</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"report1.pdf"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    create_sample_pdf<span class="token punctuation">(</span><span class="token string">"report1.pdf"</span><span class="token punctuation">,</span> <span class="token string">"第一季度报告\n\n销售额：¥200,000\n完成率：120%"</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"report2.pdf"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    create_sample_pdf<span class="token punctuation">(</span><span class="token string">"report2.pdf"</span><span class="token punctuation">,</span> <span class="token string">"第二季度报告\n\n销售额：¥250,000\n完成率：135%"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"测试PDF已生成：report1.pdf &amp; report2.pdf"</span><span class="token punctuation">)</span>

<span class="token comment"># === 原有代码扩展 ===</span>
<span class="token comment"># 生成水印PDF</span>
c <span class="token operator">=</span> canvas<span class="token punctuation">.</span>Canvas<span class="token punctuation">(</span><span class="token string">"watermark.pdf"</span><span class="token punctuation">,</span> pagesize<span class="token operator">=</span>letter<span class="token punctuation">)</span>
c<span class="token punctuation">.</span>setFont<span class="token punctuation">(</span><span class="token string">"Courier-Bold"</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span>
c<span class="token punctuation">.</span>setFillGray<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">)</span>
c<span class="token punctuation">.</span>rotate<span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span>
c<span class="token punctuation">.</span>drawString<span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">"CONFIDENTIAL"</span><span class="token punctuation">)</span>
c<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 合并并添加水印</span>
writer <span class="token operator">=</span> PdfWriter<span class="token punctuation">(</span><span class="token punctuation">)</span>
files <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"report1.pdf"</span><span class="token punctuation">,</span> <span class="token string">"report2.pdf"</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> files<span class="token punctuation">:</span>
    reader <span class="token operator">=</span> PdfReader<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> page <span class="token keyword">in</span> reader<span class="token punctuation">.</span>pages<span class="token punctuation">:</span>
        <span class="token comment"># 合并水印</span>
        watermark <span class="token operator">=</span> PdfReader<span class="token punctuation">(</span><span class="token string">"watermark.pdf"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>pages<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        page<span class="token punctuation">.</span>merge_page<span class="token punctuation">(</span>watermark<span class="token punctuation">)</span>
        writer<span class="token punctuation">.</span>add_page<span class="token punctuation">(</span>page<span class="token punctuation">)</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"merged_report.pdf"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> out<span class="token punctuation">:</span>
    writer<span class="token punctuation">.</span>write<span class="token punctuation">(</span>out<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"PDF合并及水印添加完成！路径：merged_report.pdf"</span><span class="token punctuation">)</span>
</code></pre>
    <h5>
     <a id="_208">
     </a>
     <strong>
      输入输出示例
     </strong>
    </h5>
    <ul>
     <li>
      <strong>
       输入文件
      </strong>
      ：多个部门PDF报告
     </li>
     <li>
      <strong>
       输出文件
      </strong>
      ：带水印的合并PDF
     </li>
    </ul>
    <pre><code class="prism language-bash">测试PDF已生成：report1.pdf <span class="token operator">&amp;</span> report2.pdf
PDF合并及水印添加完成！路径：merged_report.pdf
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/57b7e9b42d1b49ffbb1ce1070ebacd60.png#pic_center"/>
    </p>
    <hr/>
    <h3>
     <a id="_224">
     </a>
     <strong>
      扩展思考
     </strong>
    </h3>
    <ol>
     <li>
      <p>
       <strong>
        企业级自动化流水线
       </strong>
       <br/>
       将上述脚本整合为定时任务（如Windows任务计划程序或Linux Cron），结合邮件发送模块（
       <code>
        smtplib
       </code>
       ），实现日报/周报自动推送。
      </p>
     </li>
     <li>
      <p>
       <strong>
        跨格式数据互操作
       </strong>
      </p>
      <ul>
       <li>
        使用
        <code>
         pandas
        </code>
        将Excel数据导出为JSON：
        <code>
         df.to_json('data.json')
        </code>
       </li>
       <li>
        通过
        <code>
         python-docx
        </code>
        读取Word表格到DataFrame：
        <pre><code class="prism language-python"><span class="token keyword">from</span> docx<span class="token punctuation">.</span>api <span class="token keyword">import</span> Document
doc <span class="token operator">=</span> Document<span class="token punctuation">(</span><span class="token string">"report.docx"</span><span class="token punctuation">)</span>
table <span class="token operator">=</span> doc<span class="token punctuation">.</span>tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>cell<span class="token punctuation">.</span>text <span class="token keyword">for</span> cell <span class="token keyword">in</span> row<span class="token punctuation">.</span>cells<span class="token punctuation">]</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> table<span class="token punctuation">.</span>rows<span class="token punctuation">]</span>
</code></pre>
       </li>
      </ul>
     </li>
    </ol>
    <hr/>
    <h3>
     <a id="_240">
     </a>
     <strong>
      总结
     </strong>
    </h3>
    <p>
     通过本文的实战案例，你已掌握：
    </p>
    <ol>
     <li>
      使用
      <code>
       pandas
      </code>
      和
      <code>
       openpyxl
      </code>
      处理Excel数据
     </li>
     <li>
      通过
      <code>
       python-docx
      </code>
      动态生成Word文档
     </li>
     <li>
      利用
      <code>
       PyPDF2
      </code>
      和
      <code>
       reportlab
      </code>
      操作PDF文件
     </li>
    </ol>
    <p>
     下一步可尝试将这些技术组合应用到实际工作中，例如：
    </p>
    <ul>
     <li>
      自动化财务对账流程
     </li>
     <li>
      批量生成员工考核报告
     </li>
     <li>
      构建文档版本控制系统
     </li>
    </ul>
    <p>
     <strong>
      立即动手改造你的工作流，让Python成为你的"数字员工"！
     </strong>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="6874747073:3a2f2f626c6f672e6373646e2e6e65742f7977656e6731382f:61727469636c652f64657461696c732f313436323339313335" class_="artid" style="display:none">
 </p>
</div>


