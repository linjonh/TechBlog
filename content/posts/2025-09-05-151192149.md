---
layout: post
title: "从零开始的云计算生活第五十九天,基于Jenkins自动打包并部署Tomcat环境"
date: 2025-09-05T09:14:21+0800
description: "本文介绍了传统和现代的网站部署流程，重点讲解了使用Tomcat部署项目的完整步骤。传统部署流程包括代码提交、备份、测试等环节，而现代主流方法则通过Jenkins实现自动化部署。文章详细列出了常用的Git命令和配置方法，并说明了如何配置Jenkins主机环境。最后，给出了在Tomcat上部署Maven项目的具体操作步骤，包括构建后执行的SSH命令和注意事项。整个部署过程涵盖了从代码管理到自动化构建、测试和发布的完整DevOps流程。"
keywords: "从零开始的云计算生活——第五十九天，基于Jenkins自动打包并部署Tomcat环境"
categories: ['未分类']
tags: ['运维', '生活', 'Jenkins']
artid: "151192149"
arturl: "https://blog.csdn.net/Britz_Kevin/article/details/151192149"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=151192149
    alt: "从零开始的云计算生活第五十九天,基于Jenkins自动打包并部署Tomcat环境"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=151192149
featuredImagePreview: https://bing.ee123.net/img/rand?artid=151192149
cover: https://bing.ee123.net/img/rand?artid=151192149
image: https://bing.ee123.net/img/rand?artid=151192149
img: https://bing.ee123.net/img/rand?artid=151192149
---



# 从零开始的云计算生活——第五十九天，基于Jenkins自动打包并部署Tomcat环境

---

## 一.故事背景

基于之前所学的知识，进行一个部署tomcat来实现项目完成

## 二.流程介绍

### 传统网站部署的流程

        在运维过程中，网站部署是运维的工作之一。传统的网站部署的流程大致分为:需求分 析-->原型设计-->开发代码-->提交代码-->内网部署-->内网测试-->确认上线-->备份数据-->外网更新-->外网测试-->发布完成。如果在内网测试时发现代码有异常，返回代码开发人员名字,调整代码；如果在外网测试时发现外网部署的代码有异常，可以及时进行网站回滚。

### 传统代码上线的过程

        开发人员发起代码上线的需求（邮件中包含开发做好的WAR包）-->运维人员连接线上负载调度器（Nginx）--> 隔离一组服务器（Tomcat）--> 连接服务器（Tomcat）--> 备份旧代码（tar打包）--> 删除旧代码目录 --> 上传新的WAR包 --> 外网测试 --> 测试不通过则通过备份回滚代码 --> 测试通过则利用rsync的脚本推送代码到其他服务器--> 统一外网测试 -->连接调度器恢复隔离机制 --> 隔离另一组服务器实施上线步骤 --> 上线完成。

### 目前主流网站部署的流程

目前主流网站部署方法：通过 Hudson/Jenkins 工具平台实现全自动部署+测试，是一个可扩展的持续集成引擎，属于开源软件项目，旨在提供一个开放易用的软件平台，使软件的持续集成变成可能。Jenkins 非常易于安装和配置，简单易用。

* 开发人员：写好代码，不需要自己进行源码编译、打包等工作，直接将代码分支存放在 SVN、Git 仓库即可。
* 运维人员：减轻人工干预的错误率，同时解放运维人员繁杂的上传代码、手动备份、更新等操作。
* 测试人员：可以通过 Jenkins 进行简单的代码及网站测试。

Jenkins 的工作原理是先将源代码从 SVN/Git 版本控制系统中拷贝一份到本地，然后根据设置的脚本调用Maven进行 build（构建）。整个系统的关键就是 build 脚本，build 脚本告诉Jenkins 在一次集成中需要执行的任务。

![](https://i-blog.csdnimg.cn/direct/cfe86d70c54e4b7a8b9bb7323712bbda.png)

## 三.常用Git命令清单

![](https://i-blog.csdnimg.cn/direct/48dd5ce4acb4495abb8c06eddd6bd1f9.png)

下面是整理的常用 Git 命令清单。几个专用名词的译名如下。

> * Workspace：工作区
> * Index / Stage：暂存区
> * Repository：仓库区（或本地仓库）
> * Remote：远程仓库

### git命令

> 用法：git [--version] [--help] [-c name=value]  
>             [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]  
>             [-p|--paginate|--no-pager] [--no-replace-objects] [--bare]  
>             [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]  
>             <command> [<args>]
>
> 最常用的 git 命令有：  
>     add        添加文件内容至索引  
>     bisect     通过二分查找定位引入 bug 的变更  
>     branch     列出、创建或删除分支  
>     checkout   检出一个分支或路径到工作区  
>     clone      克隆一个版本库到一个新目录  
>     commit     记录变更到版本库  
>     diff       显示提交之间、提交和工作区之间等的差异  
>     fetch      从另外一个版本库下载对象和引用  
>     grep       输出和模式匹配的行  
>     init       创建一个空的 Git 版本库或重新初始化一个已存在的版本库  
>     log        显示提交日志  
>     merge      合并两个或更多开发历史  
>     mv         移动或重命名一个文件、目录或符号链接  
>     pull       获取并合并另外的版本库或一个本地分支  
>     push       更新远程引用和相关的对象  
>     rebase     本地提交转移至更新后的上游分支中  
>     reset      重置当前HEAD到指定状态  
>     rm         从工作区和索引中删除文件  
>     show       显示各种类型的对象  
>     status     显示工作区状态  
>     tag        创建、列出、删除或校验一个GPG签名的 tag 对象

## 四.配置git主机

下载git

> yum install -y git

![](https://i-blog.csdnimg.cn/direct/1307b7af0e794deea6c413962457efec.png)

创建一个git用户，并且登录到该用户

![](https://i-blog.csdnimg.cn/direct/c5c9065c77ea45bcbae8e77e2928b1f4.png)

在object目录下新建一个git数据库

![](https://i-blog.csdnimg.cn/direct/d24b821831354a04b61d38b58def3d48.png)

显示当前的Git配置

> git config --list

![](https://i-blog.csdnimg.cn/direct/38c63ca06b5840db9ee5b1f06ddcef3b.png)

> git config --global init.defaultBranch master

### 1. 配置git用户信息

![](https://i-blog.csdnimg.cn/direct/3959cf507490467297ea89b2869cd74d.png)

### 2.克隆项目代码同步到自己创建的仓库中

> git clone git@192.168.71.131:/home/git/object.git

![](https://i-blog.csdnimg.cn/direct/03d65d2f52ad4b789b054dbaa087ee85.png)

将exam项目中的代码拷贝到dc/目录中

![](https://i-blog.csdnimg.cn/direct/bfd55283e80c4c1099569ab9d0133a13.png)

将当前目录下的所有修改或新增的文件添加到Git的暂存区，设置全局的用户邮箱地址，用户名

![](https://i-blog.csdnimg.cn/direct/3215f07e709d48198461a3793f2028ea.png)

将本地代码变更提交到本地仓库，并添加一条简短的提交信息

![](https://i-blog.csdnimg.cn/direct/8969ddb0e7b74fdeb57d73b12d832e60.png)

将本地仓库的提交推送（上传）到远程仓库

使用git config -e 设置如图，增加新内容

![](https://i-blog.csdnimg.cn/direct/e5695c4769d6400bb9c60124896592d7.png)

![](https://i-blog.csdnimg.cn/direct/0e717e4a93be4f58858b285b24fe6f5c.png)

### 五. 配置jenkins主机

#### 添加SSH

![](https://i-blog.csdnimg.cn/direct/d99d012380b74c539b549b4b43ed34c4.png)

#### 配置 JDK、Maven、Git 环境

![](https://i-blog.csdnimg.cn/direct/420823860d4043a3aa7efa21c0ae629e.png)

![](https://i-blog.csdnimg.cn/direct/ff8d4fd172e74bfc8fdb841ec73219cf.png)

![](https://i-blog.csdnimg.cn/direct/93a96bef2fa94765ab3852d6d72a4558.png)

![](https://i-blog.csdnimg.cn/direct/57f7500a3d024c65a174150c23774eba.png)

![](https://i-blog.csdnimg.cn/direct/b1c9dc75b58748439b7d7d17a2c1afd4.png)

修改阿里云仓库

![](https://i-blog.csdnimg.cn/direct/0ca8e635d42a440d98b7f77f5399a06a.png)

配置环境变量

> export MAVEN_HOME=/usr/local/maven3  
>  export PATH=${PATH}:${MAVEN_HOME}/bin

![](https://i-blog.csdnimg.cn/direct/296e4b8f003a42fd8a9658aeb5bb0729.png)

![](https://i-blog.csdnimg.cn/direct/a7b58640c74d4d7f92b19fc881f339fe.png)

![](https://i-blog.csdnimg.cn/direct/19dcf90d0c2946069a62c91501bb763d.png)

![](https://i-blog.csdnimg.cn/direct/6ff56b6a5d794b6caaef421102e99355.png)

![](https://i-blog.csdnimg.cn/direct/1d1180e1883e44579a47a15902f0f065.png)

![](https://i-blog.csdnimg.cn/direct/d172d5fa74a0487b9243506bf4f902fd.png)

## 六.下载配置tomcat

![](https://i-blog.csdnimg.cn/direct/a1a6dfeed9a846aead8aa25f496c14fd.png)

![](https://i-blog.csdnimg.cn/direct/de4c3e79bb5d4be6aab6ed2c2a724f7d.png)

访问测试tomcat 192.168.71.130:8080

![](https://i-blog.csdnimg.cn/direct/c827cb0b9fab40a4a01e8d76234c4134.png)

![](https://i-blog.csdnimg.cn/direct/b2f894e89dd64731bd30548fab64ca68.png)

### 备份删除ROOT内容

![](https://i-blog.csdnimg.cn/direct/542ab1b54d544ba5be09b883d1319bbf.png)

### **发布公钥给jenkins主机**

> ssh-keygen
>
> ssh-copy-id 192.168.71.131

![](https://i-blog.csdnimg.cn/direct/d8a3eec3f97f42638b5933eb23a36540.png)

## 七.新建Maven项目

![](https://i-blog.csdnimg.cn/direct/17fe9153fd4f4ed896b0f923c51001d1.png)

![](https://i-blog.csdnimg.cn/direct/b30a2f70b1304afc879ee1daeea3aa9d.png)

主机Jenkins默认用jenkins用户去连接git，所以用jenkins用户生成密钥对，并发送给git。

> su -s /bin/bash jenkins

![](https://i-blog.csdnimg.cn/direct/963fa75d9f38432f814cd583d4b3cbe2.png)

回来发现报错消失

![](https://i-blog.csdnimg.cn/direct/9f144f76c6a94d1a8ab78e5a2f286dbb.png)

#### 配置bulid

![](https://i-blog.csdnimg.cn/direct/81682d3566914069b29c1a97d96debc3.png)

![](https://i-blog.csdnimg.cn/direct/64d3bb05445a4328a434efca4a0f0934.png)

#### 构建后操作

选择“构建后操作“中的“send build artfacts over SSH” “Exec command”中执行命令的含义是:在自动部署前先杀掉 Tomcat 进程，然后删除 war 包，用 scp 远程拷贝命令将 Jenkins 自动打包好的项目包拷贝到当前 Tomcat 应用目录。 然后重启 Tomcat 。

![](https://i-blog.csdnimg.cn/direct/10386c501554465aa662a624a48e4b0d.png)

> /usr/local/tomcat/bin/shutdowm.sh
>
> rm -rf /usr/local/tomcat/webapps/*
>
> scp 192.168.71.129:/var/lib/jenkins/workspace/object/* /usr/local/tomcat/webapps/
>
> /usr/local/tomcat/bin/startup.sh

注意：项目需要匹配正确的java8版本以及maven版本，要考虑不兼容问题，下载正确的版本即可完成构建。

## 八.总结

        本文介绍了传统和现代的网站部署流程，重点讲解了使用Tomcat部署项目的完整步骤。传统部署流程包括代码提交、备份、测试等环节，而现代主流方法则通过Jenkins实现自动化部署。文章详细列出了常用的Git命令和配置方法，并说明了如何配置Jenkins主机环境。最后，给出了在Tomcat上部署Maven项目的具体操作步骤，包括构建后执行的SSH命令和注意事项。整个部署过程涵盖了从代码管理到自动化构建、测试和发布的完整DevOps流程。



