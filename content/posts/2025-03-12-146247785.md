---
layout: post
title: "oracle-数据库表导到xls"
date: 2025-03-12 08:58:07 +0800
description: "将 Oracle 数据库表的数据导出到 XLS(Excel)文件可以通过多种方式实现，下面为你介绍几种常见的方法：方法一：使用 SQL Developer 工具导出Oracle SQL Developer 是 Oracle 官方提供的免费集成开发环境，可方便地将表数据导出为 XLS 文件。打开 SQL Developer ..."
keywords: "oracle 数据库表导到xls"
categories: ['未分类']
tags: ['数据库', 'Oracle']
artid: "146247785"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146247785
    alt: "oracle-数据库表导到xls"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146247785
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146247785
cover: https://bing.ee123.net/img/rand?artid=146247785
image: https://bing.ee123.net/img/rand?artid=146247785
img: https://bing.ee123.net/img/rand?artid=146247785
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     oracle 数据库表导到xls
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <div class="article-content-wrap" style="font-size: 16px;">
     <div class="artical-content-bak main-content editor-side-new">
      <div class="con editor-preview-side" id="result">
       <div class="editor-container container am-engine" id="container">
        <p>
         将 Oracle 数据库表的数据导出到 XLS(Excel)文件可以通过多种方式实现，下面为你介绍几种常见的方法：
        </p>
        <h5 id="h0">
         方法一：使用 SQL Developer 工具导出
        </h5>
        <p>
         Oracle SQL Developer 是 Oracle 官方提供的免费集成开发环境，可方便地将表数据导出为 XLS 文件。
        </p>
        <ol>
         <li>
          <strong>
           打开 SQL Developer 并连接到数据库
          </strong>
          ：启动 SQL Developer 后，使用正确的用户名、密码、主机名、端口号和服务名连接到你的 Oracle 数据库。
         </li>
         <li>
          <strong>
           选择要导出的表
          </strong>
          ：在“连接”面板中展开相应的数据库连接，找到你要导出数据的表，右键单击该表，选择“导出”。
         </li>
         <li>
          <strong>
           配置导出选项
          </strong>
         </li>
        </ol>
        <ul>
         <li>
          在“导出向导”窗口中，选择“文件类型”为“Microsoft Excel(.xlsx)”。
         </li>
         <li>
          可以指定导出的列、数据筛选条件等。
         </li>
         <li>
          选择导出文件的保存路径和文件名。
         </li>
        </ul>
        <ol start="4">
         <li>
          <strong>
           完成导出
          </strong>
          ：点击“下一步”和“完成”按钮，SQL Developer 会将表中的数据导出到指定的 XLSX 文件中。
         </li>
        </ol>
        <h5 id="h1">
         方法二：使用 PL/SQL 结合 UTL_FILE 包导出数据到 CSV，再转换为 XLS
        </h5>
        <p>
         虽然不能直接使用 PL/SQL 将数据导出为 XLS 文件，但可以先将数据导出为 CSV 文件，然后在 Excel 中打开 CSV 文件并另存为 XLS 格式。 以下是一个示例 PL/SQL 代码：
        </p>
        <div>
         <div class="code-toolbar">
          <div class="hljs-cto">
           <div class="operation_box">
            <button class="copy_btn disable">
             登录后复制
            </button>
            <a class="downloadCode" title="登录后一键下载全文代码">
             <i class="iconblog blogimport">
             </i>
            </a>
           </div>
           <pre class="has" tabindex="0"><code class="language-plain has-numbering" id="code_id_0">DECLARE
    v_file UTL_FILE.FILE_TYPE;
    CURSOR c_data IS
        SELECT * FROM your_table_name; -- 替换为实际的表名
    v_row c_data%ROWTYPE;
BEGIN
    -- 打开文件，确保指定的目录存在且有写入权限
    v_file := UTL_FILE.FOPEN('YOUR_DIRECTORY', 'output.csv', 'W');
    -- 写入列标题
    UTL_FILE.PUT_LINE(v_file, 'column1,column2,column3'); -- 替换为实际的列名
    -- 遍历游标并写入数据
    OPEN c_data;
    LOOP
        FETCH c_data INTO v_row;
        EXIT WHEN c_data%NOTFOUND;
        UTL_FILE.PUT_LINE(v_file, v_row.column1 || ',' || v_row.column2 || ',' || v_row.column3); -- 替换为实际的列名
    END LOOP;
    CLOSE c_data;
    -- 关闭文件
    UTL_FILE.FCLOSE(v_file);
EXCEPTION
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE('Error: ' || SQLERRM);
END;</code></pre>
           <ul class="pre-numbering">
            <li>
             1.
            </li>
            <li>
             2.
            </li>
            <li>
             3.
            </li>
            <li>
             4.
            </li>
            <li>
             5.
            </li>
            <li>
             6.
            </li>
            <li>
             7.
            </li>
            <li>
             8.
            </li>
            <li>
             9.
            </li>
            <li>
             10.
            </li>
            <li>
             11.
            </li>
            <li>
             12.
            </li>
            <li>
             13.
            </li>
            <li>
             14.
            </li>
            <li>
             15.
            </li>
            <li>
             16.
            </li>
            <li>
             17.
            </li>
            <li>
             18.
            </li>
            <li>
             19.
            </li>
            <li>
             20.
            </li>
            <li>
             21.
            </li>
            <li>
             22.
            </li>
            <li>
             23.
            </li>
            <li>
             24.
            </li>
           </ul>
          </div>
         </div>
        </div>
        <p>
         上述代码中，你需要做以下替换：
        </p>
        <ul>
         <li>
          <code>
           your_table_name
          </code>
          ：替换为你要导出数据的表名。
         </li>
         <li>
          <code>
           YOUR_DIRECTORY
          </code>
          ：替换为你在数据库中创建的目录对象名称，需要使用
          <code>
           CREATE DIRECTORY
          </code>
          语句创建，例如：
         </li>
        </ul>
        <div>
         <div class="code-toolbar">
          <div class="hljs-cto">
           <div class="operation_box">
            <button class="copy_btn disable">
             登录后复制
            </button>
            <a class="downloadCode" title="登录后一键下载全文代码">
             <i class="iconblog blogimport">
             </i>
            </a>
           </div>
           <pre class="has" tabindex="0"><code class="language-plain has-numbering" id="code_id_1">CREATE DIRECTORY your_directory_name AS 'C:\your\path';
GRANT READ, WRITE ON DIRECTORY your_directory_name TO your_username;</code></pre>
           <ul class="pre-numbering">
            <li>
             1.
            </li>
            <li>
             2.
            </li>
           </ul>
          </div>
         </div>
        </div>
        <ul>
         <li>
          <code>
           column1, column2, column3
          </code>
          ：替换为表中的实际列名。
         </li>
        </ul>
        <p>
         执行完上述 PL/SQL 代码后，会在指定目录下生成一个 CSV 文件，你可以使用 Excel 打开该 CSV 文件，然后另存为 XLS 格式。
        </p>
        <h5 id="h2">
         方法三：使用 Python 结合
         <code>
          cx_Oracle
         </code>
         和
         <code>
          pandas
         </code>
         库导出
        </h5>
        <p>
         Python 提供了丰富的库来处理数据库和 Excel 文件，以下是一个示例代码：
        </p>
        <div>
         <div class="code-toolbar">
          <div class="hljs-cto">
           <div class="operation_box">
            <button class="copy_btn disable">
             登录后复制
            </button>
            <a class="downloadCode" title="登录后一键下载全文代码">
             <i class="iconblog blogimport">
             </i>
            </a>
           </div>
           <pre class="has" tabindex="0"><code class="language-plain has-numbering" id="code_id_2">import cx_Oracle
import pandas as pd

# 连接到 Oracle 数据库
dsn = cx_Oracle.makedsn('your_host', 'your_port', service_name='your_service_name')
conn = cx_Oracle.connect(user='your_username', password='your_password', dsn=dsn)

# 执行 SQL 查询
query = "SELECT * FROM your_table_name"  # 替换为实际的表名
df = pd.read_sql(query, conn)

# 关闭数据库连接
conn.close()

# 将数据保存为 XLS 文件
df.to_excel('output.xls', index=False)</code></pre>
           <ul class="pre-numbering">
            <li>
             1.
            </li>
            <li>
             2.
            </li>
            <li>
             3.
            </li>
            <li>
             4.
            </li>
            <li>
             5.
            </li>
            <li>
             6.
            </li>
            <li>
             7.
            </li>
            <li>
             8.
            </li>
            <li>
             9.
            </li>
            <li>
             10.
            </li>
            <li>
             11.
            </li>
            <li>
             12.
            </li>
            <li>
             13.
            </li>
            <li>
             14.
            </li>
            <li>
             15.
            </li>
            <li>
             16.
            </li>
           </ul>
          </div>
         </div>
        </div>
        <p>
         在上述代码中，你需要将
         <code>
          your_host
         </code>
         、
         <code>
          your_port
         </code>
         、
         <code>
          your_service_name
         </code>
         、
         <code>
          your_username
         </code>
         、
         <code>
          your_password
         </code>
         和
         <code>
          your_table_name
         </code>
         替换为实际的数据库连接信息和表名。运行代码后，会在当前目录下生成一个名为
         <code>
          output.xls
         </code>
         的文件。
        </p>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34313732323932382f:61727469636c652f64657461696c732f313436323437373835" class_="artid" style="display:none">
 </p>
</div>


