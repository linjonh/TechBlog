---
layout: post
title: "TDengine-中的标签索引"
date: 2025-03-07 20:26:55 +0800
description: "本节说明 TDengine 的索引机制。在 TDengine 3.0.3.0 版本之前（不含），默认在第一列 TAG 上建立索引，但不支持给其它列动态添加索引。从 3.0.3.0 版本开始，可以动态地为其它 TAG 列添加索引。对于第一个 TAG 列上自动建立的索引，其在查询中默认生效，且用户无法对其进行任何干预。适当地使用索引能够有效地提升查询性能。"
keywords: "TDengine 中的标签索引"
categories: ['手册', 'Sql']
tags: ['物联网', '时序数据库', '数据库', '搜索引擎', '大数据', 'Tdengine', 'Iotdb']
artid: "146104292"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146104292
    alt: "TDengine-中的标签索引"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146104292
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146104292
cover: https://bing.ee123.net/img/rand?artid=146104292
image: https://bing.ee123.net/img/rand?artid=146104292
img: https://bing.ee123.net/img/rand?artid=146104292
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     TDengine 中的标签索引
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="_0">
     </a>
     简介
    </h2>
    <p>
     本节说明 TDengine 的索引机制。在 TDengine 3.0.3.0 版本之前（不含），默认在第一列 TAG 上建立索引，但不支持给其它列动态添加索引。从 3.0.3.0 版本开始，可以动态地为其它 TAG 列添加索引。对于第一个 TAG 列上自动建立的索引，其在查询中默认生效，且用户无法对其进行任何干预。适当地使用索引能够有效地提升查询性能。
    </p>
    <h3>
     <a id="_4">
     </a>
     语法
    </h3>
    <p>
     创建索引的语法如下
    </p>
    <pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> index_name <span class="token keyword">ON</span> tbl_name <span class="token punctuation">(</span>tagColName<span class="token punctuation">)</span>
</code></pre>
    <p>
     其中
     <code>
      index_name
     </code>
     为索引名称，
     <code>
      tbl_name
     </code>
     为超级表名称，
     <code>
      tagColName
     </code>
     为要在其上建立索引的 tag 列的名称。
     <code>
      tagColName
     </code>
     的类型不受限制，即任何类型的 tag 列都可以建立索引。
    </p>
    <p>
     删除索引的语法如下
    </p>
    <pre><code class="prism language-sql"><span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> index_name
</code></pre>
    <p>
     其中
     <code>
      index_name
     </code>
     为已经建立的某个索引的名称，如果该索引不存在则该命令执行失败，但不会对系统产生任何其它影响。
    </p>
    <p>
     查看系统中已经存在的索引
    </p>
    <pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span>INS_INDEXES 
</code></pre>
    <p>
     也可以为上面的查询语句加上过滤条件以缩小查询范围。
    </p>
    <p>
     或者通过 SHOW 命令查看指定表上的索引
    </p>
    <pre><code class="prism language-sql"><span class="token keyword">SHOW</span> INDEXES <span class="token keyword">FROM</span> tbl_name <span class="token punctuation">[</span><span class="token keyword">FROM</span> db_name<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> INDEXES <span class="token keyword">FROM</span> <span class="token punctuation">[</span>db_name<span class="token punctuation">.</span><span class="token punctuation">]</span>tbl_name<span class="token punctuation">;</span>
</code></pre>
    <h3>
     <a id="_37">
     </a>
     使用说明
    </h3>
    <ol>
     <li>
      <p>
       索引使用得当能够提升数据过滤的效率，目前支持的过滤算子有
       <code>
        =
       </code>
       、
       <code>
        &gt;
       </code>
       、
       <code>
        &gt;=
       </code>
       、
       <code>
        &lt;
       </code>
       、
       <code>
        &lt;=
       </code>
       。如果查询过滤条件中使用了这些算子，则索引能够明显提升查询效率。但如果查询过滤条件中使用的是其它算子，则索引起不到作用，查询效率没有变化。未来会逐步添加更多的算子。
      </p>
     </li>
     <li>
      <p>
       针对一个 tag 列只能建立一个索引，如果重复创建索引则会报错。
      </p>
     </li>
     <li>
      <p>
       每次只能针对一个 tag 列建立一个索引，不能同时对多个 tag 建立索引。
      </p>
     </li>
     <li>
      <p>
       整个系统中不管是哪种类型的索引，其名称必须唯一。
      </p>
     </li>
     <li>
      <p>
       对索引个数没有限制，但每增加一个索引都会导致系统中的元数据增加，过多的索引会降低元数据存取的效率从而降低整个系统的性能。所以请尽量避免添加不必要的索引。
      </p>
     </li>
     <li>
      <p>
       不支持对普通和子表建立索引。
      </p>
     </li>
     <li>
      <p>
       如果某个 tag 列的唯一值较少时，不建议对其建立索引，这种情况下收效甚微。
      </p>
     </li>
     <li>
      <p>
       新建立的超级表，会给第一列 tag，随机生成一个indexNewName，生成规则是：tag0的name + 23个byte，在系统表可以查,也可以按需要drop，行为和其他列 tag 的索引一样
      </p>
     </li>
    </ol>
    <h3>
     <a id="_56">
     </a>
     访问官网
    </h3>
    <p>
     更多内容欢迎访问
     <a href="https://www.taosdata.com/?utm_source=web&amp;utm_medium=all-staff&amp;utm_campaign=2025-01-12" rel="nofollow">
      TDengine 官网
     </a>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f7469636b7469636b3939392f:61727469636c652f64657461696c732f313436313034323932" class_="artid" style="display:none">
 </p>
</div>


