---
layout: post
title: "音视频处理工具-FFmpeg-指令的使用超级详细"
date: 2025-03-13 09:11:16 +0800
description: "将输入文件的帧速率(仅对原始格式有效)强制为 1 fps，将输出文件的帧速率强制为 24 fps。给定所需的视频宽度，例如 538 像素，您可以使用以下方法将视频调整为该宽度，同时保持宽高比。像这样从它们创建一个视频。将第一个输入文件的视频流和第二个输入文件的音频流拷贝到 out.mp4。裁剪到宽度 360，高度 640，从坐标 (10, 20) 开始。命令用于指定索引文件，以及索引文件中流类型和它的索引。将输出文件的视频比特率设置为 64 kbit/s。合并多个音频，自定义背景图片，生成视频音乐。"
keywords: "音视频处理工具 FFmpeg 指令的使用（超级详细！）"
categories: ['Linux']
tags: ['音视频', '运维', '网络', '服务器', 'Linux', 'Ffmpeg']
artid: "146221967"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146221967
    alt: "音视频处理工具-FFmpeg-指令的使用超级详细"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146221967
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146221967
cover: https://bing.ee123.net/img/rand?artid=146221967
image: https://bing.ee123.net/img/rand?artid=146221967
img: https://bing.ee123.net/img/rand?artid=146221967
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     音视频处理工具 FFmpeg 指令的使用（超级详细！）
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <h2>
     <a id="FFmpeg__3">
     </a>
     FFmpeg 备忘清单
    </h2>
    <p>
     本备忘清单是
     <a href="https://ffmpeg.org/" rel="nofollow">
      FFmpeg
     </a>
     中常见视频处理操作的备忘清单
    </p>
    <p>
     参考：
    </p>
    <ul>
     <li>
      <a href="https://ffmpeg.org/" rel="nofollow">
       FFmpeg 官网地址
      </a>
      <em>
       (ffmpeg.org)
      </em>
     </li>
     <li>
      <a href="https://lzone.de/cheat-sheet/ffmpeg" rel="nofollow">
       FFmpeg Cheat Sheet
      </a>
      <em>
       (lzone.de)
      </em>
     </li>
     <li>
      <a href="https://devhints.io/ffmpeg" rel="nofollow">
       FFmpeg Cheat Sheet
      </a>
      <em>
       (devhints.io)
      </em>
     </li>
     <li>
      <a href="https://github.com/yuanqing/ffmpeg-cheatsheet">
       FFmpeg Cheat Sheet
      </a>
      <em>
       (github.com)
      </em>
     </li>
     <li>
      <a href="https://cheatography.com/thetartankilt/cheat-sheets/ffmpeg/" rel="nofollow">
       FFmpeg Cheat Sheet
      </a>
      <em>
       (cheatography.com)
      </em>
     </li>
    </ul>
    <h3>
     <a id="FFmpeg__15">
     </a>
     FFmpeg 参考
    </h3>
    <h4>
     <a id="_18">
     </a>
     安装
    </h4>
    <p>
     Linux
    </p>
    <pre><code>$ apt-get install ffmpeg
$ yum install ffmpeg
</code></pre>
    <p>
     MacOS
    </p>
    <pre><code class="prism language-bash">$ brew <span class="token function">install</span> ffmpeg
</code></pre>
    <h4>
     <a id="_34">
     </a>
     示例
    </h4>
    <p>
     mp4 转 avi:
    </p>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> input.mp4 output.avi
</code></pre>
    <p>
     webm 转 mp4:
    </p>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> movie.webm movie.mp4
</code></pre>
    <h4>
     <a id="_49">
     </a>
     全局选项
    </h4>
    <table>
     <thead>
      <tr>
       <th align="left">
        :-
       </th>
       <th>
        -
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td align="left">
        <code>
         -y
        </code>
       </td>
       <td>
        覆盖输出文件
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -n
        </code>
       </td>
       <td>
        不要覆盖输出文件
       </td>
      </tr>
     </tbody>
    </table>
    <h4>
     <a id="_56">
     </a>
     主要选项
    </h4>
    <table>
     <thead>
      <tr>
       <th align="left">
        :-
       </th>
       <th>
        -
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td align="left">
        <code>
         -f fmt
        </code>
       </td>
       <td>
        强制输入或输出文件格式
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -i fName
        </code>
       </td>
       <td>
        输入文件名，未指定显示内容流的摘要
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -c codecName
        </code>
       </td>
       <td>
        指定编解码器 [输入或输出]
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -fs Nbytes
        </code>
       </td>
       <td>
        以 Nbytes 指定最大输出文件大小
       </td>
      </tr>
     </tbody>
    </table>
    <h4>
     <a id="_65">
     </a>
     基础参数
    </h4>
    <table>
     <thead>
      <tr>
       <th align="left">
        :-
       </th>
       <th>
        -
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td align="left">
        <code>
         -codecs
        </code>
       </td>
       <td>
        列出可用编码
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -formats
        </code>
       </td>
       <td>
        列出支持的格式
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -protocols
        </code>
       </td>
       <td>
        列出支持的协议
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -i input.mp4
        </code>
       </td>
       <td>
        指定输入文件
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -c:v libx264
        </code>
       </td>
       <td>
        指定视频编码
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -c:a aac
        </code>
       </td>
       <td>
        指定音频编码
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -vcodec libx264
        </code>
       </td>
       <td>
        旧写法
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -acodec aac
        </code>
       </td>
       <td>
        旧写法
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -fs SIZE
        </code>
       </td>
       <td>
        指定文件大小
       </td>
      </tr>
     </tbody>
    </table>
    <h4>
     <a id="_79">
     </a>
     视频参数
    </h4>
    <table>
     <thead>
      <tr>
       <th align="left">
        :-
       </th>
       <th>
        -
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td align="left">
        <code>
         -b bRate
        </code>
       </td>
       <td>
        设置视频比特率(单位 kbit/s)
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -fixaspect
        </code>
       </td>
       <td>
        固定纵横比
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -bt tolerance
        </code>
       </td>
       <td>
        设置视频比特率容差(单位 kbit/s)
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -maxrate bRate
        </code>
       </td>
       <td>
        设置最大视频比特率容差(单位 kbit/s)
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -minrate bRate
        </code>
       </td>
       <td>
        设置最小视频比特率容差(单位 kbit/s)
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -bufsize size
        </code>
       </td>
       <td>
        设置速率控制缓冲区大小(以 kByte 为单位)
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -sameq
        </code>
       </td>
       <td>
        使用与源相同的视频质量(意味着 VBR)
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -newvideo
        </code>
       </td>
       <td>
        将新的视频流添加到当前输出流
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -aspect RATIO
        </code>
       </td>
       <td>
        纵横比(4:3、16:9 或 1.25)
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -r RATE
        </code>
       </td>
       <td>
        每秒帧率
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -s WIDTHxHEIGHT
        </code>
       </td>
       <td>
        帧大小
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -vn
        </code>
       </td>
       <td>
        没有视频
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -crf
        </code>
       </td>
       <td>
        指定编码的质量，数值越大压缩越高，一般范围是 18-28
       </td>
      </tr>
     </tbody>
    </table>
    <h4>
     <a id="_98">
     </a>
     码率设置
    </h4>
    <pre><code class="prism language-bash"><span class="token parameter variable">-b:v</span> 1M      <span class="token comment"># 视频比特率(1M = 1Mbit/s)</span>
<span class="token parameter variable">-b:a</span> 1M      <span class="token comment"># 音频比特率(1M = 1Mbit/s)</span>
</code></pre>
    <h4>
     <a id="_105">
     </a>
     尺寸规格
    </h4>
    <table>
     <thead>
      <tr>
       <th align="left">
        :-
       </th>
       <th>
        -
       </th>
       <th>
        -
       </th>
       <th>
        -
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td align="left">
        <code>
         K
        </code>
        或
        <code>
         k
        </code>
       </td>
       <td>
        103
       </td>
       <td>
        1000 字节
       </td>
       <td>
        千字节 Kilobytes
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         M
        </code>
       </td>
       <td>
        106
       </td>
       <td>
        1000000 字节
       </td>
       <td>
        兆字节 Megabytes
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         G
        </code>
       </td>
       <td>
        109
       </td>
       <td>
        1000000000
       </td>
       <td>
        千兆字节 Gigabytes
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         Ki
        </code>
       </td>
       <td>
        210
       </td>
       <td>
        1024
       </td>
       <td>
        千字节 Kibibyte
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         Mi
        </code>
       </td>
       <td>
        220
       </td>
       <td>
        1048576
       </td>
       <td>
        兆字节 Mebibyte
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         Gi
        </code>
       </td>
       <td>
        230
       </td>
       <td>
        1073741824
       </td>
       <td>
        Gibibyte
       </td>
      </tr>
     </tbody>
    </table>
    <h4>
     <a id="_116">
     </a>
     音频参数
    </h4>
    <table>
     <thead>
      <tr>
       <th align="left">
        :-
       </th>
       <th>
        -
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td align="left">
        <code>
         -ab bRate
        </code>
       </td>
       <td>
        设置音频比特率(单位 kbit/s)
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -aframes N
        </code>
       </td>
       <td>
        设置要录制的音频帧数 [-frames:a 的别名]
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -aq q
        </code>
       </td>
       <td>
        设置音频质量(特定于编解码器，VBR) [-q:a 的别名]
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -an
        </code>
       </td>
       <td>
        禁用录音
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -acodec codec
        </code>
       </td>
       <td>
        设置音频编解码器。[-codec:a 的别名] 使用 ‘copy’ 复制流。
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -vol
        </code>
       </td>
       <td>
        以 256 的倍数更改音频音量，其中 256 = 100%(正常)音量。例如 512 = 200%
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -newaudio
        </code>
       </td>
       <td>
        将新的音频流添加到当前输出流
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -alang code
        </code>
       </td>
       <td>
        设置当前音频流的 ISO 639 语言代码(3 个字母)
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         -ac nTract
        </code>
       </td>
       <td>
        指定立体声通道数（n个声道）。例如 nTract = 2 即2个声道
       </td>
      </tr>
     </tbody>
    </table>
    <h3>
     <a id="_131">
     </a>
     视频编辑
    </h3>
    <h4>
     <a id="_135">
     </a>
     剪切视频部分
    </h4>
    <pre><code class="prism language-bash"><span class="token comment"># 从1分45秒开始剪切2分35秒</span>
$ ffmpeg <span class="token parameter variable">-i</span> <span class="token operator">&lt;</span>input<span class="token operator">&gt;</span> <span class="token parameter variable">-ss</span> 00:01:45 <span class="token parameter variable">-t</span> 00:02:35 <span class="token parameter variable">-vcodec</span> copy <span class="token parameter variable">-acodec</span> copy <span class="token operator">&lt;</span>output<span class="token operator">&gt;</span>
<span class="token comment"># 从1分45秒开始剪切到第4分20秒，与上一行等效</span>
$ ffmpeg <span class="token parameter variable">-i</span> <span class="token operator">&lt;</span>input<span class="token operator">&gt;</span> <span class="token parameter variable">-ss</span> 00:01:45 <span class="token parameter variable">-to</span> 00:04:20 <span class="token parameter variable">-codec</span> copy <span class="token operator">&lt;</span>output<span class="token operator">&gt;</span>
$ ffmpeg <span class="token parameter variable">-ss</span> 00:00:30 <span class="token parameter variable">-i</span> orginalfile.mpg <span class="token parameter variable">-t</span> 00:00:05 <span class="token parameter variable">-vcodec</span> copy <span class="token parameter variable">-acodec</span> copy newfile.mpg
<span class="token comment"># 从 4.5 秒开始的 5 秒长的视频</span>
$ ffmpeg <span class="token parameter variable">-i</span> in.mp4 <span class="token parameter variable">-ss</span> <span class="token number">4.5</span> <span class="token parameter variable">-t</span> <span class="token number">5</span> out.mp4
</code></pre>
    <h4>
     <a id="_149">
     </a>
     视频帧速率
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> input.avi <span class="token parameter variable">-r</span> <span class="token number">24</span> output.avi
</code></pre>
    <p>
     将输出文件的帧速率强制为 24 fps
    </p>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-r</span> <span class="token number">1</span> <span class="token parameter variable">-i</span> input.m2v <span class="token parameter variable">-r</span> <span class="token number">24</span> output.avi
</code></pre>
    <p>
     将输入文件的帧速率(仅对原始格式有效)强制为 1 fps，将输出文件的帧速率强制为 24 fps
    </p>
    <h4>
     <a id="H265_2pass__163">
     </a>
     H265 2-pass 编码
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-y</span> <span class="token parameter variable">-i</span> <span class="token operator">&lt;</span>input<span class="token operator">&gt;</span> <span class="token parameter variable">-c:v</span> libx265 <span class="token parameter variable">-b:v</span> 2600k <span class="token punctuation">\</span>
  -x265-params <span class="token assign-left variable">pass</span><span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">-an</span> <span class="token parameter variable">-f</span> mp4 /dev/null <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
    ffmpeg <span class="token parameter variable">-i</span> <span class="token operator">&lt;</span>input<span class="token operator">&gt;</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-c:v</span> libx265 <span class="token parameter variable">-b:v</span> 2600k <span class="token punctuation">\</span>
        -x265-params <span class="token assign-left variable">pass</span><span class="token operator">=</span><span class="token number">2</span> <span class="token punctuation">\</span>
        <span class="token parameter variable">-c:a</span> aac <span class="token parameter variable">-b:a</span> 128k output.mp4
</code></pre>
    <p>
     对于
     <code>
      H265 2-pass
     </code>
     编码，您需要组合
     <code>
      2
     </code>
     个
     <code>
      ffmpeg
     </code>
     调用
    </p>
    <h4>
     <a id="_179">
     </a>
     视频比特率设置
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> input.avi <span class="token parameter variable">-b:v</span> 64k <span class="token parameter variable">-bufsize</span> 64k output.avi
</code></pre>
    <p>
     将输出文件的视频比特率设置为 64 kbit/s
    </p>
    <h4>
     <a id="_187">
     </a>
     固定旋转
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> <span class="token operator">&lt;</span>input<span class="token operator">&gt;</span> <span class="token parameter variable">-c</span> copy -metadata:s:v:0 <span class="token assign-left variable">rotate</span><span class="token operator">=</span><span class="token number">90</span> <span class="token operator">&lt;</span>output<span class="token operator">&gt;</span>
</code></pre>
    <p>
     不要为旋转重新编码，而是简单地为旋转角度添加一个视频元数据字段
    </p>
    <h4>
     <a id="_196">
     </a>
     缩放到特定宽度
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> in.mp4 <span class="token parameter variable">-filter:v</span> <span class="token assign-left variable">scale</span><span class="token operator">=</span><span class="token string">"538:trunc(ow/a/2)*2"</span> <span class="token parameter variable">-c:a</span> copy out.mp4
</code></pre>
    <p>
     给定所需的视频宽度，例如 538 像素，您可以使用以下方法将视频调整为该宽度，同时保持宽高比
    </p>
    <h3>
     <a id="_204">
     </a>
     重新包装
    </h3>
    <h4>
     <a id="_207">
     </a>
     提取音频流
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> file.mp4 <span class="token parameter variable">-vn</span> <span class="token parameter variable">-c</span> copy output.aac 
</code></pre>
    <p>
     <code>
      -vn
     </code>
     (过滤视频)，使用
     <code>
      -c copy
     </code>
     ，不会重新解码和编码，加快速度。
    </p>
    <h4>
     <a id="_216">
     </a>
     提取视频流
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> file.mp4 <span class="token parameter variable">-an</span> <span class="token parameter variable">-c</span> copy output.mp4
</code></pre>
    <h4>
     <a id="_id3__222">
     </a>
     处理 id3 标签
    </h4>
    <p>
     提取
    </p>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> file.mp3 <span class="token parameter variable">-f</span> ffmetadata metadata.txt
</code></pre>
    <p>
     设置
    </p>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> file.mp3 <span class="token parameter variable">-acodec</span> copy <span class="token parameter variable">-metadata</span> <span class="token assign-left variable">title</span><span class="token operator">=</span><span class="token string">"&lt;title&gt;"</span> <span class="token parameter variable">-metadata</span> <span class="token assign-left variable">artist</span><span class="token operator">=</span><span class="token string">"&lt;artist&gt;"</span> <span class="token parameter variable">-metadata</span> <span class="token assign-left variable">album</span><span class="token operator">=</span><span class="token string">"&lt;album&gt;"</span> out.mp3
</code></pre>
    <p>
     更多
     <a href="https://gist.github.com/eyecatchup/0757b3d8b989fe433979db2ea7d95a01" rel="nofollow">
      请查看
     </a>
    </p>
    <h4>
     <a id="_241">
     </a>
     重新采样/转换音频
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> file.aac <span class="token parameter variable">-acodec</span> mp3 <span class="token parameter variable">-ar</span> <span class="token number">44100</span> <span class="token parameter variable">-ab</span> <span class="token number">128000</span> output.mp3
</code></pre>
    <h4>
     <a id="_DVD_PAL__248">
     </a>
     将输入文件转码为 DVD PAL 格式
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-y</span> <span class="token parameter variable">-threads</span> <span class="token number">8</span> <span class="token parameter variable">-i</span> inFile <span class="token parameter variable">-target</span> pal-dvd <span class="token parameter variable">-ac</span> <span class="token number">2</span> <span class="token parameter variable">-aspect</span> <span class="token number">16</span>:9 <span class="token parameter variable">-acodec</span> mp2 <span class="token parameter variable">-ab</span> <span class="token number">224000</span> <span class="token parameter variable">-vf</span> <span class="token assign-left variable">pad</span><span class="token operator">=</span><span class="token number">0</span>:­0:0:0 outFile
</code></pre>
    <h4>
     <a id="map__255">
     </a>
     -map 命令
    </h4>
    <p>
     <code>
      -map
     </code>
     命令用于指定索引文件，以及索引文件中流类型和它的索引
    </p>
    <hr/>
    <pre><code class="prism language-bash"><span class="token parameter variable">-map</span> index:stram_type:stream_index
</code></pre>
    <hr/>
    <table>
     <thead>
      <tr>
       <th align="left">
        :-
       </th>
       <th>
        -
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td align="left">
        <code>
         input_file_index
        </code>
       </td>
       <td>
        输入的文件索引(从 0 开始)
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         stream_type
        </code>
       </td>
       <td>
        指定文件流的类型(a -&gt; 音频，v -&gt; 视频，s -&gt; 字幕)
       </td>
      </tr>
      <tr>
       <td align="left">
        <code>
         stream_index
        </code>
       </td>
       <td>
        指定流类型的索引(从 0 开始)
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     将第一个输入文件的第二个音频拷贝到 out.mp3
    </p>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> input.mp4 <span class="token parameter variable">-map</span> <span class="token number">0</span>:a:1 <span class="token parameter variable">-c</span> copy out.mp3
</code></pre>
    <p>
     将第一个输入文件的视频流和第二个输入文件的音频流拷贝到 out.mp4
    </p>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> i1.mp4 <span class="token parameter variable">-i</span> i2.mp4 <span class="token parameter variable">-map</span> <span class="token number">0</span>:v <span class="token parameter variable">-map</span> <span class="token number">0</span>:a <span class="token parameter variable">-c</span> copy out.mp4
</code></pre>
    <p>
     反向 -map 命令
    </p>
    <p>
     反向的 map 命令（在 map 命令的参数前加负号）。例如，
     <code>
      -map -0:a:0
     </code>
     ，忽略第一个文件中的第一个音频流。
    </p>
    <h4>
     <a id="_292">
     </a>
     切换容器(转换类型)
    </h4>
    <p>
     将容器从
     <code>
      MKV
     </code>
     更改为
     <code>
      MP4
     </code>
    </p>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> file.mkv <span class="token parameter variable">-acodec</span> copy <span class="token parameter variable">-vcodec</span> copy file.mp4
</code></pre>
    <p>
     要将视频从
     <code>
      .mov
     </code>
     更改为
     <code>
      .mp4
     </code>
    </p>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> in.mov out.mp4
</code></pre>
    <h4>
     <a id="_307">
     </a>
     音视频同步
    </h4>
    <p>
     将音频延迟 3 秒
    </p>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> input.mov <span class="token parameter variable">-itsoffset</span> <span class="token number">3</span> <span class="token parameter variable">-i</span> input.mov <span class="token parameter variable">-map</span> <span class="token number">0</span>:v <span class="token parameter variable">-map</span> <span class="token number">1</span>:a <span class="token parameter variable">-codec:a</span> copy <span class="token parameter variable">-codec:v</span> copy output.mov
</code></pre>
    <p>
     将视频延迟 3 秒(即将音频提前 3 秒)
    </p>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> input.mov <span class="token parameter variable">-itsoffset</span> <span class="token number">3</span> <span class="token parameter variable">-i</span> input.mov <span class="token parameter variable">-map</span> <span class="token number">1</span>:v <span class="token parameter variable">-map</span> <span class="token number">0</span>:a <span class="token parameter variable">-codec:a</span> copy <span class="token parameter variable">-codec:v</span> copy output.mov
</code></pre>
    <h4>
     <a id="_324">
     </a>
     图片中的视频
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-f</span> image2 <span class="token parameter variable">-i</span> image%d.jpg video.mp4
</code></pre>
    <p>
     多个编号的图像 image1.jpg、image2.jpg… 像这样从它们创建一个视频
    </p>
    <h4>
     <a id="_333">
     </a>
     将视频拆分为图像
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> video.mp4 image%d.jpg
</code></pre>
    <h4>
     <a id="_339">
     </a>
     录屏
    </h4>
    <h5>
     <a id="_342">
     </a>
     查找所有可用设备
    </h5>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-f</span> avfoundation <span class="token parameter variable">-list_devices</span> <span class="token boolean">true</span> <span class="token parameter variable">-i</span> <span class="token string">""</span>
</code></pre>
    <p>
     一定要选择好设备，根据设备进行配置。
    </p>
    <h5>
     <a id="windows__351">
     </a>
     windows 下录屏
    </h5>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-hide_banner</span> <span class="token parameter variable">-loglevel</span> error <span class="token parameter variable">-stats</span> <span class="token parameter variable">-f</span> gdigrab <span class="token parameter variable">-framerate</span> <span class="token number">60</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-offset_x</span> <span class="token number">0</span> <span class="token parameter variable">-offset_y</span> <span class="token number">0</span> <span class="token parameter variable">-video_size</span> 1920x1080 <span class="token parameter variable">-draw_mouse</span> <span class="token number">1</span> <span class="token parameter variable">-i</span> deskop <span class="token punctuation">\</span>
<span class="token parameter variable">-c:v</span> libx264 <span class="token parameter variable">-r</span> <span class="token number">60</span> <span class="token parameter variable">-preset</span> ultrafast <span class="token parameter variable">-pix_fmt</span> yuv420p <span class="token parameter variable">-y</span> screen_record.mp4
</code></pre>
    <h5>
     <a id="mac__359">
     </a>
     mac 下录屏
    </h5>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-f</span> avfoundation <span class="token parameter variable">-i</span> <span class="token number">1</span>:0 <span class="token parameter variable">-preset</span> ultrafast out.mkv
</code></pre>
    <h4>
     <a id="_365">
     </a>
     合并音频与图片
    </h4>
    <p>
     合并多个音频，自定义背景图片，生成视频音乐
    </p>
    <pre><code class="prism language-bash"><span class="token comment"># mylist.txt &gt;&gt;&gt;</span>
<span class="token function">file</span> <span class="token string">'1.mp3'</span>
<span class="token function">file</span> <span class="token string">'2.mp3'</span>
<span class="token function">file</span> <span class="token string">'3.mp3'</span>

<span class="token comment"># OBS: 46500 = 25:50 minutes * 60 * 30fps</span>
<span class="token comment"># echo "00:25:50" | awk -F: '{ print (($1 * 3600) + ($2 * 60) + $3) * 30 }'</span>
$ ffmpeg <span class="token parameter variable">-y</span> <span class="token parameter variable">-loop</span> <span class="token number">1</span> <span class="token parameter variable">-i</span> cover.jpg <span class="token parameter variable">-f</span> concat <span class="token parameter variable">-i</span> mylist.txt <span class="token parameter variable">-c:v</span> libx264 <span class="token parameter variable">-r</span> <span class="token number">30</span> <span class="token parameter variable">-pix_fmt</span> yuv420p <span class="token parameter variable">-vframes</span> <span class="token number">46500</span> <span class="token parameter variable">-c:a</span> aac <span class="token parameter variable">-b:a</span> 192k <span class="token parameter variable">-strict</span> experimental <span class="token parameter variable">-shortest</span> output.mp4
</code></pre>
    <h4>
     <a id="_Gif_381">
     </a>
     转换为 Gif
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-ss</span> <span class="token number">2</span> <span class="token parameter variable">-t</span> <span class="token number">28</span> <span class="token parameter variable">-i</span> input.mp4 <span class="token parameter variable">-vf</span> <span class="token string">"fps=10,scale=1080:-1:flags=lanczos,split[s0][s1];[s0]palettegen[p];[s1][p]paletteuse"</span> <span class="token parameter variable">-loop</span> <span class="token number">0</span> output.gif
</code></pre>
    <p>
     上面有关更多信息，请参阅
     <a href="https://superuser.com/a/556031" rel="nofollow">
      StackOverflow 问题
     </a>
    </p>
    <pre><code class="prism language-bash"><span class="token comment"># 转换为 GIF</span>
$ ffmpeg <span class="token parameter variable">-i</span> input.mov output.gif
<span class="token comment"># 从 GIF 转换</span>
$ ffmpeg <span class="token parameter variable">-i</span> input.gif output.mov
<span class="token comment"># 在非 GIF 格式之间转换</span>
$ ffmpeg <span class="token parameter variable">-i</span> input.mov <span class="token parameter variable">-codec:v</span> copy <span class="token parameter variable">-codec:a</span> copy output.mp4
</code></pre>
    <h4>
     <a id="_400">
     </a>
     转换为灰度
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-y</span> <span class="token parameter variable">-i</span> inFile <span class="token parameter variable">-flags</span> gray outFile
</code></pre>
    <h4>
     <a id="_406">
     </a>
     字幕格式转换
    </h4>
    <pre><code class="prism language-bash"><span class="token comment"># srt -&gt; ass</span>
$ ffmpeg <span class="token parameter variable">-i</span> subtitle.srt subtitle.ass
<span class="token comment"># ass -&gt; vtt</span>
$ ffmpeg <span class="token parameter variable">-i</span> subtitle.ass subtitle.vtt
</code></pre>
    <p>
     srt、ass、vtt 等格式之间可以相互转换
    </p>
    <h4>
     <a id="_419">
     </a>
     字幕
    </h4>
    <p>
     将字幕写入视频
    </p>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> input.mov <span class="token parameter variable">-filter:v</span> <span class="token string">'subtitles=subtitles.srt'</span> <span class="token parameter variable">-codec:a</span> copy output.mov
</code></pre>
    <p>
     将字幕写入视频，具有自定义字幕样式
    </p>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> input.mov <span class="token parameter variable">-filter:v</span> <span class="token string">"subtitles=subtitles.srt:force_style='FontName=Menlo Bold,Fontsize=18'"</span> <span class="token parameter variable">-codec:a</span> copy output.mov
</code></pre>
    <h4>
     <a id="_1__435">
     </a>
     制造 1 分钟的音频噪音
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-ar</span> <span class="token number">48000</span> <span class="token parameter variable">-t</span> <span class="token number">60</span> <span class="token parameter variable">-f</span> s16le <span class="token parameter variable">-acodec</span> pcm_s16le <span class="token parameter variable">-i</span> /dev/u­random <span class="token parameter variable">-ab</span> 64K <span class="token parameter variable">-f</span> mp2 <span class="token parameter variable">-acodec</span> mp2 <span class="token parameter variable">-y</span> noise.mp2
</code></pre>
    <h4>
     <a id="_442">
     </a>
     从视频中提取图像
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> foo.avi <span class="token parameter variable">-r</span> <span class="token number">1</span> <span class="token parameter variable">-s</span> WxH <span class="token parameter variable">-f</span> image2 outFil­e%0­3d.png
</code></pre>
    <h4>
     <a id="_449">
     </a>
     音量
    </h4>
    <p>
     将音量减半
    </p>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> input.mov <span class="token parameter variable">-codec:v</span> copy <span class="token parameter variable">-filter:a</span> <span class="token string">'volume=0.5'</span> output.mov
</code></pre>
    <p>
     音量加倍
    </p>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> input.mov <span class="token parameter variable">-codec:v</span> copy <span class="token parameter variable">-filter:a</span> <span class="token string">'volume=2'</span> output.mov
</code></pre>
    <h4>
     <a id="_464">
     </a>
     将图像文件转换为其他格式
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> foo012­2.png foo.tiff 
</code></pre>
    <p>
     pgm, ppm, pam, pgmyuv, jpeg, gif, png, tiff, sgi
    </p>
    <h4>
     <a id="_AVI__472">
     </a>
     将图像转换为 AVI 文件
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-f</span> image2 <span class="token parameter variable">-i</span> foo-%0­3d.jpeg <span class="token parameter variable">-r</span> <span class="token number">12</span> <span class="token parameter variable">-s</span> WxH foo.avi
</code></pre>
    <h4>
     <a id="_WAV__MP3_479">
     </a>
     将 WAV 文件转换为 MP3
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> source­_so­ng.wav <span class="token parameter variable">-vn</span> <span class="token parameter variable">-ar</span> <span class="token number">44100</span> <span class="token parameter variable">-ac</span> <span class="token number">2</span> <span class="token parameter variable">-ab</span> <span class="token number">192</span> <span class="token parameter variable">-f</span> mp3 final_­son­g.mp3
</code></pre>
    <h4>
     <a id="_MP3_486">
     </a>
     从视频中提取音频，将其转码为 MP3
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> source.avi <span class="token parameter variable">-vn</span> <span class="token parameter variable">-ar</span> <span class="token number">44100</span> <span class="token parameter variable">-ac</span> <span class="token number">2</span> <span class="token parameter variable">-ab</span> <span class="token number">192</span> <span class="token parameter variable">-f</span> mp3 sound.mp3
</code></pre>
    <h4>
     <a id="_avi__flv_493">
     </a>
     将 .avi 转换为 .flv
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> source.avi <span class="token parameter variable">-ab</span> <span class="token number">56</span> <span class="token parameter variable">-ar</span> <span class="token number">44100</span> <span class="token parameter variable">-b</span> <span class="token number">200</span> <span class="token parameter variable">-r</span> <span class="token number">15</span> <span class="token parameter variable">-s</span> 320x240 <span class="token parameter variable">-f</span> flv output.flv
</code></pre>
    <h4>
     <a id="_mp3_500">
     </a>
     将图片附加到 mp3
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> input.mp3 <span class="token parameter variable">-i</span> cover.png <span class="token parameter variable">-c</span> copy -metad­ata:s:v <span class="token assign-left variable">title</span><span class="token operator">=</span>­<span class="token string">"­Album cover"</span> -metad­ata:s:v commen­t<span class="token operator">=</span><span class="token string">"Cover (Front­)"</span> out.mp3
</code></pre>
    <h4>
     <a id="_507">
     </a>
     将视频与声音文件混合
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> song.wav <span class="token parameter variable">-i</span> source­_vi­deo.avi outvid­eo.mpg
</code></pre>
    <h4>
     <a id="_ID3v23__ID3v1__mp3_514">
     </a>
     编写带有 ID3v2.3 页眉和 ID3v1 页脚的 mp3
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> inFile -id3v2­_ve­rsion <span class="token number">3</span> -write­_id3v1 <span class="token number">1</span> outFil­e.mp3
</code></pre>
    <h4>
     <a id="_521">
     </a>
     连接输入文件
    </h4>
    <pre><code class="prism language-bash">$ <span class="token function">cat</span> inFile1 inFile2 <span class="token operator">|</span> ffmpeg <span class="token parameter variable">-f</span> mpeg <span class="token parameter variable">-i</span> - <span class="token parameter variable">-vcodec</span> copy <span class="token parameter variable">-acodec</span> copy outFil­e.mpg
</code></pre>
    <h4>
     <a id="_mp3__528">
     </a>
     使用比特率和 mp3 音频的编解码器对剪辑进行编码
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> clip.avi <span class="token parameter variable">-vcodec</span> libxvid <span class="token parameter variable">-b</span> <span class="token number">800000</span> <span class="token parameter variable">-acodec</span> libmp3lame <span class="token parameter variable">-ab</span> <span class="token number">128</span> new-cl­ip.avi
</code></pre>
    <h4>
     <a id="_535">
     </a>
     将音频流与来自不同文件的视频流合并
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> audioS.mp4 <span class="token parameter variable">-i</span> videoS.mp4 <span class="token parameter variable">-c</span> copy <span class="token parameter variable">-map</span> <span class="token number">0</span>:a <span class="token parameter variable">-map</span> <span class="token number">1</span>:v outFil­e.mp4
</code></pre>
    <h4>
     <a id="_542">
     </a>
     合并视频
    </h4>
    <p>
     合并相同规格(解码/分辨率/帧率)视频
    </p>
    <pre><code class="prism language-bash"><span class="token comment"># mylist.txt &gt;&gt;&gt;</span>
<span class="token function">file</span> <span class="token string">'1.mp4'</span>
<span class="token function">file</span> <span class="token string">'2.mp4'</span>
<span class="token function">file</span> <span class="token string">'3.mp4'</span>

<span class="token comment"># 这些文件是相对路径，如使用绝对路径需要添加 `-safe 0` 参数</span>
$ ffmpeg <span class="token parameter variable">-f</span> concat <span class="token parameter variable">-i</span> mylist.txt <span class="token parameter variable">-c</span> copy output.mp4
</code></pre>
    <p>
     合并当前目录下所有视频
    </p>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-f</span> concat <span class="token parameter variable">-safe</span> <span class="token number">0</span> <span class="token parameter variable">-i</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token keyword">for</span> <span class="token for-or-select variable">f</span> <span class="token keyword">in</span> ./*.mp4<span class="token punctuation">;</span> <span class="token keyword">do</span> <span class="token builtin class-name">echo</span> <span class="token string">"file '<span class="token environment constant">$PWD</span>/<span class="token variable">$f</span>'"</span><span class="token punctuation">;</span> <span class="token keyword">done</span><span class="token punctuation">)</span> <span class="token parameter variable">-c</span> copy output.mp4
</code></pre>
    <p>
     合并不同规格视频，保证视频不变形
    </p>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> <span class="token number">1</span>.mp4 <span class="token parameter variable">-c</span> copy <span class="token parameter variable">-bsf:v</span> h264_mp4toannexb <span class="token parameter variable">-f</span> mpegts tmp1.ts
$ ffmpeg <span class="token parameter variable">-i</span> <span class="token number">2</span>.mp4 <span class="token parameter variable">-c</span> copy <span class="token parameter variable">-bsf:v</span> h264_mp4toannexb <span class="token parameter variable">-f</span> mpegts tmp2.ts
$ ffmpeg <span class="token parameter variable">-i</span> <span class="token number">3</span>.mp4 <span class="token parameter variable">-c</span> copy <span class="token parameter variable">-bsf:v</span> h264_mp4toannexb <span class="token parameter variable">-f</span> mpegts tmp3.ts

$ ffmpeg <span class="token parameter variable">-threads</span> <span class="token number">2</span> <span class="token parameter variable">-i</span> <span class="token string">"concat:tmp1.ts|tmp2.ts|tmp3.ts"</span>  <span class="token parameter variable">-vf</span> <span class="token string">"scale=720:1080:force_original_aspect_ratio=decrease,pad=720:1080:(ow-iw)/2:(oh-ih)/2"</span> <span class="token parameter variable">-pix_fmt</span> yuvj420p <span class="token parameter variable">-shortest</span> <span class="token parameter variable">-y</span> output.mp4
</code></pre>
    <p>
     合并不同解码视频
    </p>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> input1.mp4 <span class="token parameter variable">-i</span> input2.webm <span class="token parameter variable">-i</span> input3.mov <span class="token punctuation">\</span>
<span class="token parameter variable">-filter_complex</span> <span class="token string">"[0:v:0][0:a:0][1:v:0][1:a:0][2:v:0][2:a:0]concat=n=3:v=1:a=1[outv][outa]"</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-map</span> <span class="token string">"[outv]"</span> <span class="token parameter variable">-map</span> <span class="token string">"[outa]"</span> output.mkv
</code></pre>
    <p>
     合并视频并重新编码音频
    </p>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-f</span> concat <span class="token parameter variable">-i</span> mylist.txt <span class="token parameter variable">-c:v</span> copy <span class="token parameter variable">-c:a</span> flac <span class="token parameter variable">-strict</span> <span class="token parameter variable">-2</span> output.mp4
</code></pre>
    <h3>
     <a id="_593">
     </a>
     视频过滤器
    </h3>
    <h4>
     <a id="_597">
     </a>
     格式
    </h4>
    <p>
     如果一个 fliter 有多个参数，需要使用
     <code>
      ,
     </code>
     分隔
    </p>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> test.avi <span class="token parameter variable">-c:v</span> libx264 <span class="token parameter variable">-vf</span> <span class="token string">"scale=1024:-1,transpose=1,crop=iw/3:ih/3"</span> output.mp4
</code></pre>
    <h4>
     <a id="_605">
     </a>
     缩放
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> input.mp4 <span class="token parameter variable">-vf</span> <span class="token string">"scale=640:480"</span> out.mp4
<span class="token comment"># -1 → 指根据另一个参数帮我们推断</span>
$ ffmpeg <span class="token parameter variable">-i</span> input.mp4 <span class="token parameter variable">-vf</span> <span class="token string">"scale=720:-1"</span> out.mp4
<span class="token comment"># 宽度和高度</span>
ffmpeg <span class="token parameter variable">-i</span> input.mp4 <span class="token parameter variable">-vf</span> <span class="token string">"scale=w=800:h=600"</span> output.mp4
<span class="token comment"># in_w\in_h 输入尺寸</span>
ffmpeg <span class="token parameter variable">-i</span> input.mkv <span class="token parameter variable">-vf</span> <span class="token string">"scale=w=1/2*in_w:h=1/2*in_h"</span> output.mkv
</code></pre>
    <h4>
     <a id="_619">
     </a>
     裁剪
    </h4>
    <p>
     从左上角开始，复制
     <code>
      x=0px
     </code>
     <code>
      y=0px
     </code>
     的相应窗口来创建
     <code>
      1280x720
     </code>
     大小的输出视频
    </p>
    <pre><code class="prism language-bash">ffmpeg <span class="token parameter variable">-i</span> input.mp4 <span class="token parameter variable">-vf</span> <span class="token string">"crop=w=1280:h=720:x=0:y=0"</span> output.mp4
</code></pre>
    <p>
     裁剪到宽度 360，高度 640，从坐标 (10, 20) 开始
    </p>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> input.mov <span class="token parameter variable">-vf</span> <span class="token string">'crop=360:640:10:20'</span> output.mov
</code></pre>
    <h4>
     <a id="_635">
     </a>
     去除水印
    </h4>
    <p>
     设置一个矩形覆盖区域 x=10:y=10:w=120:h=45
    </p>
    <pre><code class="prism language-bash"><span class="token comment"># show=1 为可选参数，设置显示边框，方便调试用的</span>
ffmpeg <span class="token parameter variable">-i</span> <span class="token number">1</span>.mp4 <span class="token parameter variable">-b:v</span> 548k <span class="token parameter variable">-vf</span> <span class="token assign-left variable">delogo</span><span class="token operator">=</span>x<span class="token operator">=</span><span class="token number">10</span>:y<span class="token operator">=</span><span class="token number">10</span>:w<span class="token operator">=</span><span class="token number">120</span>:h<span class="token operator">=</span><span class="token number">45</span>:show<span class="token operator">=</span><span class="token number">1</span> output.mp4
</code></pre>
    <h4>
     <a id="_645">
     </a>
     创建缩略图
    </h4>
    <p>
     在 10 秒时创建一个缩略图
    </p>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-ss</span> <span class="token number">10</span> <span class="token parameter variable">-i</span> <span class="token operator">&lt;</span>input file<span class="token operator">&gt;</span> <span class="token parameter variable">-vframes</span> <span class="token number">1</span> <span class="token parameter variable">-vcodec</span> png <span class="token parameter variable">-an</span> thumb.png
</code></pre>
    <p>
     例如，要每
     <code>
      n
     </code>
     秒创建一次缩略图，请使用
     <code>
      -vf fps=1/n
     </code>
    </p>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> <span class="token operator">&lt;</span>input file<span class="token operator">&gt;</span> <span class="token parameter variable">-vf</span> <span class="token assign-left variable">fps</span><span class="token operator">=</span><span class="token number">1</span>/60 thumbnails/thumb%03d.png
</code></pre>
    <h4>
     <a id="_661">
     </a>
     添加水印
    </h4>
    <p>
     在视频左上方 20,20 的位置插入 logo.png 图片
    </p>
    <pre><code class="prism language-bash"><span class="token comment"># -b:v 548k 可选参数，设置视频比特率，默认 200k 最好设置与原视频一致</span>
ffmpeg <span class="token parameter variable">-i</span> <span class="token number">1</span>.mp4 <span class="token parameter variable">-acodec</span> copy <span class="token parameter variable">-b:v</span> 548k <span class="token parameter variable">-vf</span> <span class="token string">"movie=logo.png[watermark];[in][watermark]overlay=20:20"</span> output.mp4
</code></pre>
    <h4>
     <a id="_671">
     </a>
     视频旋转
    </h4>
    <pre><code class="prism language-bash"><span class="token comment"># 顺时针旋转 90</span>
$ ffmpeg <span class="token parameter variable">-i</span> input.avi <span class="token parameter variable">-vf</span> <span class="token string">"rotate=90*PI/180"</span> out.mp4 
<span class="token comment"># 顺时针旋转 180，翻转 90</span>
$ ffmpeg <span class="token parameter variable">-i</span> input.mp4 <span class="token parameter variable">-vf</span> <span class="token string">"rotate=PI"</span> out.mp4
</code></pre>
    <h4>
     <a id="_680">
     </a>
     更改视频播放速度
    </h4>
    <pre><code class="prism language-bash"><span class="token comment"># 加速 2 倍</span>
$ ffmpeg <span class="token parameter variable">-i</span> input.mkv <span class="token parameter variable">-vf</span> <span class="token string">"setpts=0.5*PTS"</span> output.mkv 
<span class="token comment"># 减速 2 倍</span>
$ ffmpeg <span class="token parameter variable">-i</span> input.mp4 <span class="token parameter variable">-vf</span> <span class="token string">"setpts=2*PTS"</span> output.mp4
</code></pre>
    <h4>
     <a id="_689">
     </a>
     添加背景音乐
    </h4>
    <pre><code class="prism language-bash"><span class="token comment"># -t 10 文件时长，单位为秒，建议取值原始视频总时长</span>
$ ffmpeg <span class="token parameter variable">-i</span> <span class="token number">1</span>.mp4 <span class="token parameter variable">-i</span> test.mp3 <span class="token punctuation">\</span>
  <span class="token parameter variable">-filter_complex</span> <span class="token string">"[1:a]aloop=loop=-1:size=2e+09[out];[out][0:a]amix"</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">-t</span> <span class="token number">10</span> out.mp4
</code></pre>
    <h3>
     <a id="_698">
     </a>
     音频过滤器
    </h3>
    <h4>
     <a id="_702">
     </a>
     调节音量
    </h4>
    <pre><code class="prism language-bash"><span class="token comment"># 增大音量</span>
$ ffmpeg <span class="token parameter variable">-i</span> test.mp4 <span class="token parameter variable">-af</span> <span class="token string">"volumn=1.5"</span> out.mp4
</code></pre>
    <h4>
     <a id="_709">
     </a>
     更改音频速度
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> input.wav <span class="token parameter variable">-af</span> <span class="token string">"atempo=0.75"</span> output.wav 
<span class="token comment"># 加速 4 倍</span>
$ ffmpeg <span class="token parameter variable">-i</span> input.mp3 <span class="token parameter variable">-af</span> <span class="token string">"atempo=2.0,atempo=2.0"</span> ouutput.mp3
</code></pre>
    <p>
     <code>
      atempo
     </code>
     它只接受
     <code>
      0.5
     </code>
     (半速) 到
     <code>
      2
     </code>
     (倍速)之间的值。为了越过这个限制，你可以链式使用这个过滤器
    </p>
    <h4>
     <a id="_720">
     </a>
     统一视频的音量
    </h4>
    <pre><code class="prism language-bash">$ ffmpeg <span class="token parameter variable">-i</span> test.mp4 <span class="token parameter variable">-af</span> <span class="token string">"loudnorm=I=-5:LRA=1"</span> out.mp4
</code></pre>
    <h4>
     <a id="_726">
     </a>
     重新映射通道数
    </h4>
    <pre><code class="prism language-bash"><span class="token comment"># 使左右耳的声音同时出现</span>
$ ffmpeg <span class="token parameter variable">-i</span> input.mp3 <span class="token parameter variable">-af</span> <span class="token string">"channelmap=1-0|1-1"</span> output.mp3
</code></pre>
    <h3>
     <a id="_733">
     </a>
     流处理
    </h3>
    <h4>
     <a id="_737">
     </a>
     拉流
    </h4>
    <pre><code class="prism language-bash"><span class="token comment"># 拉取rtmp流并存储到本地</span>
$ ffmpeg <span class="token parameter variable">-i</span> <span class="token string">"rtsp://127.0.0.1/test"</span> test.mp4
</code></pre>
    <h4>
     <a id="_744">
     </a>
     推流
    </h4>
    <pre><code class="prism language-bash"><span class="token comment"># 推送test.mp4到远程</span>
$ ffmpeg <span class="token parameter variable">-re</span> <span class="token parameter variable">-i</span> test.mp4 <span class="token parameter variable">-f</span> flv rtmp://127.0.0.1/test
</code></pre>
    <h4>
     <a id="_751">
     </a>
     转发
    </h4>
    <pre><code class="prism language-bash"><span class="token comment"># 拉取流并转发</span>
$ ffmpeg <span class="token parameter variable">-i</span> <span class="token string">"rtsp://127.0.0.1/test"</span> <span class="token parameter variable">-f</span> mpegts <span class="token parameter variable">-codec:v</span> mpeg1video http://127.0.0.1/demo
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
  <div class="blog-extension-box" id="blogExtensionBox" style="width:400px;margin:auto;margin-top:12px">
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f6375695f796f6e676875612f:61727469636c652f64657461696c732f313436323231393637" class_="artid" style="display:none">
 </p>
</div>


