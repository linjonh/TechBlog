---
layout: post
title: "程序员的自我修养链接装载与库-对书中常见段的讲解总结"
date: 2025-03-11 17:24:52 +0800
description: "书中通过分析目标文件的结构（如 ELF 格式），解释了这些段如何被链接器组织、操作系统加载，最终形成进程的内存映像。理解这些段的划分，对优化程序体积、分析内存泄漏、调试底层问题至关重要。"
keywords: "《程序员的自我修养—链接、装载与库》-- 对书中常见段的讲解总结"
categories: ['未分类']
tags: ['开发语言']
artid: "146184623"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146184623
    alt: "程序员的自我修养链接装载与库-对书中常见段的讲解总结"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146184623
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146184623
cover: https://bing.ee123.net/img/rand?artid=146184623
image: https://bing.ee123.net/img/rand?artid=146184623
img: https://bing.ee123.net/img/rand?artid=146184623
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     《程序员的自我修养—链接、装载与库》-- 对书中常见段的讲解总结
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h4>
     <a id="1__0">
     </a>
     <strong>
      1. 核心段的作用与特点
     </strong>
    </h4>
    <h5>
     <a id="1_text__1">
     </a>
     <strong>
      (1)
      <code>
       .text
      </code>
      段（代码段）
     </strong>
    </h5>
    <ul>
     <li>
      <strong>
       内容
      </strong>
      ：存放程序的
      <strong>
       可执行指令
      </strong>
      （机器码），例如函数的实现代码。
     </li>
     <li>
      <strong>
       特点
      </strong>
      ：
      <ul>
       <li>
        通常是
        <strong>
         只读
        </strong>
        的（防止程序意外修改指令）。
       </li>
       <li>
        在程序运行前已确定大小，多个进程可共享同一份代码段（节省内存）。
       </li>
       <li>
        编译器优化（如函数内联）可能影响其内容。
       </li>
      </ul>
     </li>
    </ul>
    <h5>
     <a id="2_data__8">
     </a>
     <strong>
      (2)
      <code>
       .data
      </code>
      段（数据段）
     </strong>
    </h5>
    <ul>
     <li>
      <strong>
       内容
      </strong>
      ：存放
      <strong>
       已初始化
      </strong>
      的
      <strong>
       全局变量
      </strong>
      和
      <strong>
       静态变量
      </strong>
      （包括全局/局部静态变量）。
     </li>
     <li>
      <strong>
       特点
      </strong>
      ：
      <ul>
       <li>
        变量在编译时已明确初始值，这些值直接保存在目标文件中。
       </li>
       <li>
        例如：
        <code>
         int global_var = 42;
        </code>
        或函数内的
        <code>
         static int s_var = 10;
        </code>
        。
       </li>
      </ul>
     </li>
    </ul>
    <h5>
     <a id="3_bss_Block_Started_by_Symbol_14">
     </a>
     <strong>
      (3)
      <code>
       .bss
      </code>
      段（Block Started by Symbol）
     </strong>
    </h5>
    <ul>
     <li>
      <strong>
       内容
      </strong>
      ：存放
      <strong>
       未初始化
      </strong>
      的
      <strong>
       全局变量
      </strong>
      和
      <strong>
       静态变量
      </strong>
      （或初始化为
      <code>
       0
      </code>
      的变量）。
     </li>
     <li>
      <strong>
       特点
      </strong>
      ：
      <ul>
       <li>
        <strong>
         不占用目标文件的物理存储空间
        </strong>
        （仅记录变量的大小和符号）。
       </li>
       <li>
        程序加载时由操作系统分配内存并初始化为零（节省磁盘空间）。
       </li>
       <li>
        例如：
        <code>
         int uninit_var;
        </code>
        或
        <code>
         static int s_uninit;
        </code>
        。
       </li>
      </ul>
     </li>
    </ul>
    <h5>
     <a id="4_rodata__21">
     </a>
     <strong>
      (4)
      <code>
       .rodata
      </code>
      段（只读数据段）
     </strong>
    </h5>
    <ul>
     <li>
      <strong>
       内容
      </strong>
      ：存放
      <strong>
       只读数据
      </strong>
      ，如字符串常量、
      <code>
       const
      </code>
      修饰的全局变量等。
     </li>
     <li>
      <strong>
       特点
      </strong>
      ：
      <ul>
       <li>
        程序运行时不可修改，尝试写入会触发段错误（Segmentation Fault）。
       </li>
       <li>
        例如：
        <code>
         const char* str = "Hello";
        </code>
        中的
        <code>
         "Hello"
        </code>
        会存放在此段。
       </li>
      </ul>
     </li>
    </ul>
    <hr/>
    <h4>
     <a id="2__29">
     </a>
     <strong>
      2. 内存布局中的其他区域
     </strong>
    </h4>
    <p>
     虽然严格来说不属于目标文件的段，但程序运行时内存中的关键区域：
    </p>
    <h5>
     <a id="1_Heap_31">
     </a>
     <strong>
      (1) 堆（Heap）
     </strong>
    </h5>
    <ul>
     <li>
      <strong>
       动态分配的内存区域
      </strong>
      （如
      <code>
       malloc
      </code>
      /
      <code>
       new
      </code>
      申请的内存）。
     </li>
     <li>
      由程序员手动管理（分配和释放），空间通常从低地址向高地址增长。
     </li>
    </ul>
    <h5>
     <a id="2_Stack_35">
     </a>
     <strong>
      (2) 栈（Stack）
     </strong>
    </h5>
    <ul>
     <li>
      <strong>
       存放局部变量、函数参数、返回地址
      </strong>
      等。
     </li>
     <li>
      由编译器自动管理，空间从高地址向低地址增长。
     </li>
     <li>
      函数调用时压栈（push），返回时弹栈（pop）。
     </li>
    </ul>
    <hr/>
    <h4>
     <a id="3__42">
     </a>
     <strong>
      3. 其他辅助段
     </strong>
    </h4>
    <h5>
     <a id="1_comment_43">
     </a>
     <strong>
      (1)
      <code>
       .comment
      </code>
     </strong>
    </h5>
    <ul>
     <li>
      存放编译器版本、作者等注释信息，不参与程序运行。
     </li>
    </ul>
    <h5>
     <a id="2_debug_46">
     </a>
     <strong>
      (2)
      <code>
       .debug
      </code>
     </strong>
    </h5>
    <ul>
     <li>
      调试信息（如符号表、行号映射），用于 GDB 等调试工具。
     </li>
    </ul>
    <h5>
     <a id="3_plt__got_49">
     </a>
     <strong>
      (3)
      <code>
       .plt
      </code>
      &amp;
      <code>
       .got
      </code>
      （动态链接相关）
     </strong>
    </h5>
    <ul>
     <li>
      <code>
       .plt
      </code>
      （过程链接表）和
      <code>
       .got
      </code>
      （全局偏移表）用于动态链接库的延迟绑定（Lazy Binding）。
     </li>
    </ul>
    <hr/>
    <h4>
     <a id="4__54">
     </a>
     <strong>
      4. 关键区别与设计思想
     </strong>
    </h4>
    <table>
     <thead>
      <tr>
       <th>
        段名
       </th>
       <th>
        是否占用磁盘空间
       </th>
       <th>
        初始化方式
       </th>
       <th>
        典型内容
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <code>
         .text
        </code>
       </td>
       <td>
        ✔️
       </td>
       <td>
        编译时确定
       </td>
       <td>
        函数代码
       </td>
      </tr>
      <tr>
       <td>
        <code>
         .data
        </code>
       </td>
       <td>
        ✔️
       </td>
       <td>
        编译时写入初始值
       </td>
       <td>
        已初始化的全局变量
       </td>
      </tr>
      <tr>
       <td>
        <code>
         .bss
        </code>
       </td>
       <td>
        ❌
       </td>
       <td>
        运行时由操作系统初始化为零
       </td>
       <td>
        未初始化的全局变量
       </td>
      </tr>
      <tr>
       <td>
        <code>
         .rodata
        </code>
       </td>
       <td>
        ✔️
       </td>
       <td>
        编译时确定，运行时不可修改
       </td>
       <td>
        字符串常量、
        <code>
         const
        </code>
        变量
       </td>
      </tr>
     </tbody>
    </table>
    <h5>
     <a id="_bss__62">
     </a>
     <strong>
      为什么需要
      <code>
       .bss
      </code>
      段？
     </strong>
    </h5>
    <ul>
     <li>
      <strong>
       节省磁盘空间
      </strong>
      ：未初始化的变量无需在文件中存储零值。
     </li>
     <li>
      <strong>
       提升加载效率
      </strong>
      ：程序启动时操作系统批量清零
      <code>
       .bss
      </code>
      段，比读取大量零值更高效。
     </li>
    </ul>
    <hr/>
    <h4>
     <a id="5__68">
     </a>
     <strong>
      5. 实例验证
     </strong>
    </h4>
    <p>
     以下 C 代码的变量存储位置：
    </p>
    <pre><code class="prism language-c"><span class="token keyword">int</span> global_init <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>         <span class="token comment">// .data</span>
<span class="token keyword">int</span> global_uninit<span class="token punctuation">;</span>            <span class="token comment">// .bss</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> static_init <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>  <span class="token comment">// .data</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> static_uninit<span class="token punctuation">;</span>     <span class="token comment">// .bss</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> global_const <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>  <span class="token comment">// .rodata</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">static</span> <span class="token keyword">int</span> local_static_init <span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">;</span>   <span class="token comment">// .data</span>
    <span class="token keyword">static</span> <span class="token keyword">int</span> local_static_uninit<span class="token punctuation">;</span>      <span class="token comment">// .bss</span>
    <span class="token keyword">char</span><span class="token operator">*</span> str <span class="token operator">=</span> <span class="token string">"Hello"</span><span class="token punctuation">;</span>                 <span class="token comment">// str在栈，字符串在.rodata</span>
    <span class="token keyword">int</span> local_var<span class="token punctuation">;</span>                       <span class="token comment">// 栈</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <hr/>
    <h4>
     <a id="_88">
     </a>
     <strong>
      总结
     </strong>
    </h4>
    <p>
     书中通过分析目标文件的结构（如 ELF 格式），解释了这些段如何被链接器组织、操作系统加载，最终形成进程的内存映像。理解这些段的划分，对优化程序体积、分析内存泄漏、调试底层问题至关重要。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f67:2e6373646e2e6e65742f6c6f6e65776f6c663532313132352f:61727469636c652f64657461696c732f313436313834363233" class_="artid" style="display:none">
 </p>
</div>


