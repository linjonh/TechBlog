---
layout: post
title: "什么是SWAP虚拟内存使用服务器如何开启SWAP虚拟内存"
date: 2025-03-13 17:51:39 +0800
description: "通过上述操作，您可以在莱卡云服务器上快速启用 SWAP 虚拟内存，平衡内存资源与成本，确保服务稳定运行。建议根据实际负载动态调整 SWAP 大小及 swappiness 参数。SWAP（交换分区）是磁盘上的一块空间，用于在物理内存（RAM）不足时，将部分不活跃的内存数据临时存储到磁盘中，避免系统因内存耗尽而崩溃。分配 1GB 的 SWAP 文件（根据需求调整大小）控制内存换出频率，值越低越少使用 SWAP。删除 /etc/fstab 中相关行。编辑 /etc/fstab。调整 swappiness。"
keywords: "什么是SWAP虚拟内存?使用服务器如何开启SWAP虚拟内存"
categories: ['未分类']
tags: ['服务器', '数据库', '云计算', 'Linux', 'Github', 'Ddos']
artid: "146238480"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146238480
    alt: "什么是SWAP虚拟内存使用服务器如何开启SWAP虚拟内存"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146238480
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146238480
cover: https://bing.ee123.net/img/rand?artid=146238480
image: https://bing.ee123.net/img/rand?artid=146238480
img: https://bing.ee123.net/img/rand?artid=146238480
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     什么是SWAP虚拟内存?使用服务器如何开启SWAP虚拟内存
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       一、SWAP 虚拟内存是什么？
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       ‌
      </span>
     </strong>
    </p>
    <div style="margin-left:0; margin-right:0; text-align:center">
    </div>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       ‌
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       定义
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       ‌
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       ：
       <br/>
       SWAP（交换分区）是磁盘上的一块空间，用于在物理内存（RAM）不足时，将部分不活跃的内存数据临时存储到磁盘中，避免系统因内存耗尽而崩溃。
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       ‌
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       核心作用
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       ‌
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       ：
      </span>
     </strong>
    </p>
    <ol>
     <li style="text-align:justify">
      <span style="color:#333333">
       <strong>
        ‌
       </strong>
       <strong>
        扩展可用内存
       </strong>
       <strong>
        ‌
       </strong>
       <strong>
        ：防止应用程序因内存不足（OOM）被强制终止
       </strong>
       <strong>
        ‌
       </strong>
       <strong>
        12
       </strong>
       <strong>
        。
       </strong>
      </span>
     </li>
     <li style="text-align:justify">
      <span style="color:#333333">
       <strong>
        ‌
       </strong>
       <strong>
        提升系统稳定性
       </strong>
       <strong>
        ‌
       </strong>
       <strong>
        ：缓解突发高负载下的内存压力，降低宕机风险
       </strong>
       <strong>
        ‌
       </strong>
       <strong>
        34
       </strong>
       <strong>
        。
       </strong>
      </span>
     </li>
     <li style="text-align:justify">
      <span style="color:#333333">
       <strong>
        ‌
       </strong>
       <strong>
        优化资源利用
       </strong>
       <strong>
        ‌
       </strong>
       <strong>
        ：允许系统将长期未使用的内存页移至 SWAP，释放物理内存供急需进程使用
       </strong>
       <strong>
        ‌
       </strong>
       <strong>
        56
       </strong>
       <strong>
        。
       </strong>
      </span>
     </li>
    </ol>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       ‌
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       适用场景
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       ‌
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       ：
      </span>
     </strong>
    </p>
    <ul>
     <li style="text-align:justify">
      <span style="color:#333333">
       <strong>
        物理内存较小（如 1-2GB 的轻量级服务器）。
       </strong>
      </span>
     </li>
     <li style="text-align:justify">
      <span style="color:#333333">
       <strong>
        运行内存密集型应用（如数据库、Java 服务）。
       </strong>
      </span>
     </li>
    </ul>
    <div style="margin-left:0; margin-right:0; text-align:center">
     <hr/>
    </div>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       **
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       二、莱卡云服务器开启 SWAP 的步骤
      </span>
     </strong>
    </p>
    <p style="margin-left:0px; margin-right:0px; text-align:center">
     <strong>
      <span style="color:#333333">
       <img alt="" src="https://i-blog.csdnimg.cn/direct/26a8480c195e4cb1a3c0e36d845a4cda.png"/>
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       ‌
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       1.
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       创建 SWAP 文件
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       ‌
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       bashCopy Code
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <em>
       <span style="color:#333333">
        #
       </span>
      </em>
     </strong>
     <strong>
      <em>
       <span style="color:#333333">
        分配 1GB 的 SWAP 文件（根据需求调整大小）
       </span>
      </em>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       sudo fallocate -l 1G /swapfile
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <em>
       <span style="color:#333333">
        #
       </span>
      </em>
     </strong>
     <strong>
      <em>
       <span style="color:#333333">
        若 fallocate 不可用，改用 dd 命令
       </span>
      </em>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       sudo dd if=/dev/zero of=/swapfile bs=1M count=1024
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <em>
       <span style="color:#333333">
        #
       </span>
      </em>
     </strong>
     <strong>
      <em>
       <span style="color:#333333">
        设置权限
       </span>
      </em>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       sudo chmod 600 /swapfile
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       ‌
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       2.
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       格式化为 SWAP 分区
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       ‌
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       bashCopy Code
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       sudo mkswap /swapfile
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       ‌
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       3.
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       激活 SWAP
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       ‌
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       bashCopy Code
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       sudo swapon /swapfile
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       ‌
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       4.
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       永久生效配置
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       ‌
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       bashCopy Code
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <em>
       <span style="color:#333333">
        #
       </span>
      </em>
     </strong>
     <strong>
      <em>
       <span style="color:#333333">
        编辑 /etc/fstab
       </span>
      </em>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       sudo nano /etc/fstab
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <em>
       <span style="color:#333333">
        #
       </span>
      </em>
     </strong>
     <strong>
      <em>
       <span style="color:#333333">
        添加以下行
       </span>
      </em>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       /swapfile none swap sw 0 0
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       ‌
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       5.
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       验证 SWAP 状态
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       ‌
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       bashCopy Code
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       free -h
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <em>
       <span style="color:#333333">
        #
       </span>
      </em>
     </strong>
     <strong>
      <em>
       <span style="color:#333333">
        输出示例：
       </span>
      </em>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <em>
       <span style="color:#333333">
        #               total   used    free
       </span>
      </em>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <em>
       <span style="color:#333333">
        # Swap:         1.0G    0B      1.0G
       </span>
      </em>
     </strong>
    </p>
    <div style="margin-left:0; margin-right:0; text-align:center">
     <hr/>
    </div>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       ‌
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       三、SWAP 配置优化建议
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       ‌
      </span>
     </strong>
    </p>
    <table border="1">
     <thead>
      <tr>
       <td style="border-color:black">
        <p style="margin-left:0; margin-right:0; text-align:justify">
         <strong>
          <span style="color:#333333">
           ‌
          </span>
         </strong>
         <strong>
          <span style="color:#333333">
           参数
          </span>
         </strong>
         <strong>
          <span style="color:#333333">
           ‌
          </span>
         </strong>
        </p>
       </td>
       <td style="border-color:black">
        <p style="margin-left:0; margin-right:0; text-align:justify">
         <strong>
          <span style="color:#333333">
           ‌
          </span>
         </strong>
         <strong>
          <span style="color:#333333">
           推荐值
          </span>
         </strong>
         <strong>
          <span style="color:#333333">
           ‌
          </span>
         </strong>
        </p>
       </td>
       <td style="border-color:black">
        <p style="margin-left:0; margin-right:0; text-align:justify">
         <strong>
          <span style="color:#333333">
           ‌
          </span>
         </strong>
         <strong>
          <span style="color:#333333">
           说明
          </span>
         </strong>
         <strong>
          <span style="color:#333333">
           ‌
          </span>
         </strong>
        </p>
       </td>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td style="border-color:black">
        <p style="margin-left:0; margin-right:0; text-align:justify">
         <strong>
          <span style="color:#333333">
           ‌
          </span>
         </strong>
         <strong>
          <span style="color:#333333">
           SWAP
          </span>
         </strong>
         <strong>
          <span style="color:#333333">
           大小
          </span>
         </strong>
         <strong>
          <span style="color:#333333">
           ‌
          </span>
         </strong>
        </p>
       </td>
       <td>
        <p style="margin-left:0; margin-right:0; text-align:justify">
         <strong>
          <span style="color:#333333">
           1-2
          </span>
         </strong>
         <strong>
          <span style="color:#333333">
           倍物理内存（≤8GB）
          </span>
         </strong>
        </p>
       </td>
       <td>
        <p style="margin-left:0; margin-right:0; text-align:justify">
         <strong>
          <span style="color:#333333">
           内存≤4GB 时建议 2 倍；内存≥8GB 时 1 倍
          </span>
         </strong>
         <strong>
          <span style="color:#333333">
           ‌
          </span>
         </strong>
         <strong>
          <span style="color:#333333">
           35
          </span>
         </strong>
        </p>
       </td>
      </tr>
      <tr>
       <td style="border-color:black">
        <p style="margin-left:0; margin-right:0; text-align:justify">
         <strong>
          <span style="color:#333333">
           ‌
          </span>
         </strong>
         <strong>
          <span style="color:#333333">
           swappiness
          </span>
         </strong>
         <strong>
          <span style="color:#333333">
           ‌
          </span>
         </strong>
        </p>
       </td>
       <td>
        <p style="margin-left:0; margin-right:0; text-align:justify">
         <strong>
          <span style="color:#333333">
           10-30
          </span>
         </strong>
         <strong>
          <span style="color:#333333">
           （默认 60）
          </span>
         </strong>
        </p>
       </td>
       <td>
        <p style="margin-left:0; margin-right:0; text-align:justify">
         <strong>
          <span style="color:#333333">
           控制内存换出频率，值越低越少使用 SWAP
          </span>
         </strong>
         <strong>
          <span style="color:#333333">
           ‌
          </span>
         </strong>
         <strong>
          <span style="color:#333333">
           46
          </span>
         </strong>
        </p>
       </td>
      </tr>
     </tbody>
    </table>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       ‌
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       调整 swappiness
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       ‌
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       ：
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       bashCopy Code
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <em>
       <span style="color:#333333">
        #
       </span>
      </em>
     </strong>
     <strong>
      <em>
       <span style="color:#333333">
        临时生效
       </span>
      </em>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       sudo sysctl vm.swappiness=10
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <em>
       <span style="color:#333333">
        #
       </span>
      </em>
     </strong>
     <strong>
      <em>
       <span style="color:#333333">
        永久生效
       </span>
      </em>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       sudo nano /etc/sysctl.conf
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <em>
       <span style="color:#333333">
        #
       </span>
      </em>
     </strong>
     <strong>
      <em>
       <span style="color:#333333">
        添加或修改：
       </span>
      </em>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       vm.swappiness=10
      </span>
     </strong>
    </p>
    <div style="margin-left:0; margin-right:0; text-align:center">
     <hr/>
    </div>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       ‌
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       四、注意事项
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       ‌
      </span>
     </strong>
    </p>
    <ol>
     <li style="text-align:justify">
      <span style="color:#333333">
       <strong>
        ‌
       </strong>
       <strong>
        性能影响
       </strong>
       <strong>
        ‌
       </strong>
       <strong>
        ：
       </strong>
      </span>
      <ul>
       <li style="text-align:justify">
        <span style="color:#333333">
         <strong>
          SWAP
         </strong>
         <strong>
          依赖磁盘 I/O，频繁读写可能降低性能（尤其是 HDD 磁盘）
         </strong>
         <strong>
          ‌
         </strong>
         <strong>
          56
         </strong>
         <strong>
          。
         </strong>
        </span>
       </li>
       <li style="text-align:justify">
        <span style="color:#333333">
         <strong>
          莱卡云服务器建议搭配 SSD 云盘使用，减少延迟
         </strong>
         <strong>
          ‌
         </strong>
         <strong>
          6
         </strong>
         <strong>
          。
         </strong>
        </span>
       </li>
      </ul>
     </li>
     <li style="text-align:justify">
      <span style="color:#333333">
       <strong>
        ‌
       </strong>
       <strong>
        监控与维护
       </strong>
       <strong>
        ‌
       </strong>
       <strong>
        ：
       </strong>
      </span>
      <ul>
       <li style="text-align:justify">
        <span style="color:#333333">
         <strong>
          使用 htop 或 vmstat 1 监控 SWAP 使用率。
         </strong>
        </span>
       </li>
       <li style="text-align:justify">
        <span style="color:#333333">
         <strong>
          内存长期不足时，优先考虑升级莱卡云实例内存配置。
         </strong>
        </span>
       </li>
      </ul>
     </li>
     <li style="text-align:justify">
      <span style="color:#333333">
       <strong>
        ‌
       </strong>
       <strong>
        禁用 SWAP
       </strong>
       <strong>
        ‌
       </strong>
       <strong>
        ：
       </strong>
      </span>
     </li>
    </ol>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       bashCopy Code
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       sudo swapoff /swapfile
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       sudo rm -f /swapfile
      </span>
     </strong>
    </p>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <em>
       <span style="color:#333333">
        #
       </span>
      </em>
     </strong>
     <strong>
      <em>
       <span style="color:#333333">
        删除 /etc/fstab 中相关行
       </span>
      </em>
     </strong>
    </p>
    <div style="margin-left:0; margin-right:0; text-align:center">
     <hr/>
    </div>
    <p style="margin-left:0; margin-right:0; text-align:justify">
     <strong>
      <span style="color:#333333">
       通过上述操作，您可以在莱卡云服务器上快速启用 SWAP 虚拟内存，平衡内存资源与成本，确保服务稳定运行。建议根据实际负载动态调整 SWAP 大小及 swappiness 参数
      </span>
     </strong>
     <strong>
      <span style="color:#333333">
       ‌
      </span>
     </strong>
     <br/>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f36393438343535372f:61727469636c652f64657461696c732f313436323338343830" class_="artid" style="display:none">
 </p>
</div>


