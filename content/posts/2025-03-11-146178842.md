---
layout: post
title: "Stable-Diffusion-模型文件-.ckpt-与-.safetensors-的区别"
date: 2025-03-11 14:45:05 +0800
description: "定义：全称为“检查点”（Checkpoint），最初为 TensorFlow/PyTorch 框架中的通用训练存档格式。用途：主要用于保存训练过程中的完整模型状态，包括模型权重参数（生成图像的核心数据）、优化器状态（如梯度、学习率等训练进度信息）、训练元数据（如当前训练步数、超参数等）。适用场景：适用于模型训练、微调或需要从特定节点恢复训练的场景。特性.ckpt核心用途训练存档、恢复推理部署、轻量化生成安全性较低（可能含代码）高（纯权重无代码）文件体积较大较小（优化压缩）"
keywords: "Stable Diffusion 模型文件 .ckpt 与 .safetensors 的区别"
categories: ['未分类']
tags: ['Stable', 'Diffusion']
artid: "146178842"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146178842
    alt: "Stable-Diffusion-模型文件-.ckpt-与-.safetensors-的区别"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146178842
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146178842
cover: https://bing.ee123.net/img/rand?artid=146178842
image: https://bing.ee123.net/img/rand?artid=146178842
img: https://bing.ee123.net/img/rand?artid=146178842
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Stable Diffusion 模型文件 .ckpt 与 .safetensors 的区别
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-github-gist" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="1__1">
     </a>
     1. 格式定义与核心用途
    </h3>
    <h4>
     <a id="ckptCheckpoint_3">
     </a>
     .ckpt（Checkpoint）
    </h4>
    <ul>
     <li>
      <strong>
       定义
      </strong>
      ：全称为“检查点”（Checkpoint），最初为 TensorFlow/PyTorch 框架中的通用训练存档格式。
     </li>
     <li>
      <strong>
       用途
      </strong>
      ：主要用于保存训练过程中的完整模型状态，包括模型权重参数（生成图像的核心数据）、优化器状态（如梯度、学习率等训练进度信息）、训练元数据（如当前训练步数、超参数等）。
     </li>
     <li>
      <strong>
       适用场景
      </strong>
      ：适用于模型训练、微调或需要从特定节点恢复训练的场景。
     </li>
    </ul>
    <h4>
     <a id="safetensors_9">
     </a>
     .safetensors
    </h4>
    <ul>
     <li>
      <strong>
       定义
      </strong>
      ：由 Hugging Face 团队设计的专用格式，专为安全高效存储大模型权重而生。
     </li>
     <li>
      <strong>
       用途
      </strong>
      ：仅保存模型的最终权重参数，不包含任何训练相关的附加信息（如优化器状态或代码）。
     </li>
     <li>
      <strong>
       适用场景
      </strong>
      ：专注于生成图像（推理任务）、模型部署或共享，强调安全性与轻量化。
     </li>
    </ul>
    <h3>
     <a id="2__15">
     </a>
     2. 安全性对比
    </h3>
    <h4>
     <a id="ckpt__17">
     </a>
     .ckpt 风险
    </h4>
    <ul>
     <li>
      可能包含执行代码（如恶意脚本），存在潜在安全隐患。
     </li>
     <li>
      在非信任来源的模型文件中需谨慎使用。
     </li>
    </ul>
    <h4>
     <a id="safetensors__22">
     </a>
     .safetensors 优势
    </h4>
    <ul>
     <li>
      通过纯权重存储避免代码注入风险，安全性更高。
     </li>
     <li>
      文件结构经过加密和校验设计，防止数据篡改。
     </li>
    </ul>
    <h3>
     <a id="3__27">
     </a>
     3. 文件体积与加载效率
    </h3>
    <h4>
     <a id="_29">
     </a>
     文件大小
    </h4>
    <ul>
     <li>
      <strong>
       .safetensors
      </strong>
      比
      <strong>
       .ckpt
      </strong>
      体积小约 30%-50%（例如 2GB 模型可压缩至 1.4GB 左右）。
     </li>
     <li>
      原因：.safetensors 仅保留必要权重，而 .ckpt 包含冗余训练信息。
     </li>
    </ul>
    <h4>
     <a id="_34">
     </a>
     加载速度
    </h4>
    <ul>
     <li>
      <strong>
       .safetensors
      </strong>
      支持内存映射（Memory Mapping），加载时无需完全载入显存，速度更快。
     </li>
     <li>
      <strong>
       .ckpt
      </strong>
      需完整加载所有数据，耗时较长（尤其在大模型场景下）。
     </li>
    </ul>
    <h3>
     <a id="4__39">
     </a>
     4. 框架兼容性
    </h3>
    <h4>
     <a id="ckpt_41">
     </a>
     .ckpt
    </h4>
    <ul>
     <li>
      广泛应用于 TensorFlow、PyTorch 等主流框架的训练流程。
     </li>
     <li>
      在 Stable Diffusion 生态中仍广泛存在（尤其是早期模型）。
     </li>
    </ul>
    <h4>
     <a id="safetensors_46">
     </a>
     .safetensors
    </h4>
    <ul>
     <li>
      主要与 Hugging Face 生态兼容，但已逐渐成为 Stable Diffusion 社区推荐的标准推理格式。
     </li>
     <li>
      支持 PyTorch、TensorFlow 等框架的快速权重加载接口。
     </li>
    </ul>
    <h3>
     <a id="5__51">
     </a>
     5. 实际使用场景建议
    </h3>
    <h4>
     <a id="_53">
     </a>
     训练与微调
    </h4>
    <ul>
     <li>
      使用
      <strong>
       .ckpt
      </strong>
      保存中间训练状态，便于恢复训练或调试模型。
     </li>
    </ul>
    <h4>
     <a id="_57">
     </a>
     生成与部署
    </h4>
    <ul>
     <li>
      优先选择
      <strong>
       .safetensors
      </strong>
      ，兼顾安全性、速度和轻量化。
     </li>
     <li>
      例如：Stable Diffusion WebUI 和 ComfyUI 均默认支持 .safetensors 模型加载。
     </li>
    </ul>
    <h4>
     <a id="_62">
     </a>
     模型共享
    </h4>
    <ul>
     <li>
      推荐使用
      <strong>
       .safetensors
      </strong>
      格式，降低安全风险并减少传输耗时。
     </li>
    </ul>
    <h3>
     <a id="_66">
     </a>
     总结
    </h3>
    <table>
     <thead>
      <tr>
       <th>
        特性
       </th>
       <th>
        .ckpt
       </th>
       <th>
        .safetensors
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        核心用途
       </td>
       <td>
        训练存档、恢复
       </td>
       <td>
        推理部署、轻量化生成
       </td>
      </tr>
      <tr>
       <td>
        安全性
       </td>
       <td>
        较低（可能含代码）
       </td>
       <td>
        高（纯权重无代码）
       </td>
      </tr>
      <tr>
       <td>
        文件体积
       </td>
       <td>
        较大
       </td>
       <td>
        较小（优化压缩）
       </td>
      </tr>
      <tr>
       <td>
        加载速度
       </td>
       <td>
        较慢
       </td>
       <td>
        更快（内存映射）
       </td>
      </tr>
      <tr>
       <td>
        框架支持
       </td>
       <td>
        广泛（TF/PyTorch）
       </td>
       <td>
        专注 Hugging Face 生态
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     在 Stable Diffusion 工作流中，建议根据需求灵活选择格式：训练用 .ckpt，生成用 .safetensors。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a:2f2f626c6f672e6373646e2e6e65742f4c697564656630362f:61727469636c652f64657461696c732f313436313738383432" class_="artid" style="display:none">
 </p>
</div>


