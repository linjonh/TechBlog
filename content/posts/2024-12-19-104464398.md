---
layout: post
title: "前端使用nginx进行代理设置"
date: 2024-12-19 20:57:48 +0800
description: "1.开发为什么进行nginx代理设置？一般在前端开发中设置ngin"
keywords: "nginx前端代理怎么更改title"
categories: ['前端']
tags: ['Nginx', 'Javascript']
artid: "104464398"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=104464398
    alt: "前端使用nginx进行代理设置"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=104464398
featuredImagePreview: https://bing.ee123.net/img/rand?artid=104464398
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     前端使用nginx进行代理设置
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h4>
     <a id="1nginx_0">
     </a>
     1.开发为什么进行nginx代理设置？
    </h4>
    <p>
     一般在前端开发中设置nginx代理是为了解决跨域问题，问什么要进跨域行为设置呢？因为浏览器的同源策略，导致在a站点拿不到b站点的资源，然而前后端分离开发，前端开起的服务和后端起的服务IP地址不同，导致拿不到资源。如下图所示：
     <br/>
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/64b2b2b91b5b2e242480bc493f65d9f7.png">
      <br/>
      上图两个cookie是后端设置在服务器端的用来验证请求是否合法，前端需要拿到这个cookie传给后端来通过验证，但是这个是在a站点，前端开发环境在b站点，那怎么拿到这个cookie并顺利通过验证呢？
     </img>
    </p>
    <h4>
     <a id="2_4">
     </a>
     2.上面问题有了，那该怎么解决问题呢？
    </h4>
    <p>
     那么下面我们就来进行nginx配置来解决这个问题，首先在前端项目进行，以vue-cli3为例：先在config文件中配置代理如下所示：
    </p>
    <pre><code class="prism language-javascript"><span class="token comment">// vue.config.js</span>
devServer<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
   <span class="token comment">// contentBase: path.join(__dirname, 'dist'),</span>
   compress<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
   host<span class="token punctuation">:</span> <span class="token string">'100.110.xxx.xxx'</span><span class="token punctuation">,</span> <span class="token comment">// 本地IP</span>
   port<span class="token punctuation">:</span> <span class="token string">'8099'</span><span class="token punctuation">,</span> <span class="token comment">// 项目运行端口</span>
   proxy<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
     <span class="token string">'/api'</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
       target<span class="token punctuation">:</span> <span class="token string">'http://100.119.xxx.xxx:8070'</span><span class="token punctuation">,</span> <span class="token comment">// 代理地址，api需要访问地址</span>
       ws<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
       changeOrigin<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
       pathRewrite<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
         <span class="token string">'^/api'</span> <span class="token punctuation">:</span> <span class="token string">''</span>
       <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
 <span class="token comment">// dev.env.js</span>
 module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  <span class="token constant">NODE_ENV</span><span class="token punctuation">:</span> <span class="token string">'"development"'</span><span class="token punctuation">,</span>
  <span class="token constant">ENV_CONFIG</span><span class="token punctuation">:</span> <span class="token string">'"dev"'</span><span class="token punctuation">,</span>
  <span class="token constant">BASE_API</span><span class="token punctuation">:</span> <span class="token string">'"http://100.100.xxx.xxx:8321"'</span> <span class="token comment">//访问本地ip地址服务，此服务由nginx开启</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     这样配置之后前端访问的API地址已经变成了http://100.100.xxx.xxx:8321/api/login这样子，服务器在收到这个请求之后，会在http://100.100.xxx.xxx这个地址下面种下cookie，前端就可以顺利拿到cookie进行访问。
     <br/>
     接下来我们看看nginx
    </p>
    <pre><code class="prism language-javascript">upstream temple <span class="token punctuation">{<!-- --></span>
    server <span class="token number">100.119</span><span class="token punctuation">.</span>xxx<span class="token punctuation">.</span>xxx<span class="token punctuation">:</span><span class="token number">8070</span><span class="token punctuation">;</span>
    #check interval<span class="token operator">=</span><span class="token number">3000</span> rise<span class="token operator">=</span><span class="token number">2</span> fall<span class="token operator">=</span><span class="token number">5</span> timeout<span class="token operator">=</span><span class="token number">1000</span> type<span class="token operator">=</span>http<span class="token punctuation">;</span>
    #check_http_send <span class="token string">"HEAD /mwmonitor/check.jsp HTTP/1.0\r\n\r\n"</span><span class="token punctuation">;</span>
    #check_http_expect_alive http_2xx<span class="token punctuation">;</span> 
<span class="token punctuation">}</span>

server <span class="token punctuation">{<!-- --></span>
    listen       <span class="token number">8321</span><span class="token punctuation">;</span> #监听端口
    server_name  localhost<span class="token punctuation">;</span> #开启一个本地服务
	location <span class="token operator">/</span>api<span class="token punctuation">{<!-- --></span> 
	#rewrite <span class="token operator">^</span><span class="token operator">/</span>api<span class="token operator">/</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">)</span>$ <span class="token operator">/</span>$<span class="token number">1</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
		proxy_pass http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>temple<span class="token punctuation">;</span> #服务代理地址
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     运行nginx，就可以了，总结一下关于nginx代理。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/898a2f555904f964e9a2aded8c9f8c21.png"/>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34353237323332392f:61727469636c652f64657461696c732f313034343634333938" class_="artid" style="display:none">
 </p>
</div>


