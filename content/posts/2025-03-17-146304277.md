---
layout: post
title: "React二JSX语法解析综合案例"
date: 2025-03-17 00:09:20 +0800
description: "实际上，jsx 仅仅只是 React.createElement(component, props, ...children) 函数的语法糖→所有的jsx最终都会被转换成React.createElement的函数调用。假设有一个btnClick函数，但它并不是我们主动调用的，而是当button发生改变时，React内部调用→内部调用时，并不知道要如何绑定正确的this。2.获取更多参数：可通过传入一个箭头函数，主动执行的事件函数，并且传入相关的其他参数。1.获取默认参数：即event对象。"
keywords: "React（二）：JSX语法解析+综合案例"
categories: ['React']
tags: ['前端', 'React']
artid: "146304277"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146304277
    alt: "React二JSX语法解析综合案例"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146304277
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146304277
cover: https://bing.ee123.net/img/rand?artid=146304277
image: https://bing.ee123.net/img/rand?artid=146304277
img: https://bing.ee123.net/img/rand?artid=146304277
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     React（二）：JSX语法解析+综合案例
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h4 id="wsEgN" style="background-color:transparent">
     事件绑定
    </h4>
    <h5 id="Dpazi">
     this绑定方式
    </h5>
    <blockquote>
     <p id="u846fb8c2">
      <strong>
       问题：
      </strong>
      在事件执行后，需获取当前类的对象中相关属性，此时需要this——当打印时，发现this为undefined,这又是为啥？
     </p>
     <p id="u21525bfc">
      假设有一个btnClick函数，但它并不是我们主动调用的，而是当button发生改变时，React内部调用→内部调用时，并不知道要如何绑定正确的this
     </p>
    </blockquote>
    <p id="u0cba1193">
     <strong>
      解决办法：
     </strong>
    </p>
    <ol>
     <li id="u03be1091">
      bind给btnClick显示绑定this
     </li>
     <li id="u99e73de0">
      使用 ES6 class fields 语法
     </li>
     <li id="u711361fd">
      事件监听时传入箭头函数（较为推荐）
     </li>
    </ol>
    <pre id="iN6Cs"><code class="language-html">&lt;body&gt;
  &lt;div id="root"&gt;&lt;/div&gt;

  &lt;script src="../lib/react.js"&gt;&lt;/script&gt;
  &lt;script src="../lib/react-dom.js"&gt;&lt;/script&gt;
  &lt;script src="../lib/babel.js"&gt;&lt;/script&gt;

  &lt;script type="text/babel"&gt;
    /* 
    this的四种绑定规则 
     1.默认绑定：独立执行foo()
     2.隐式绑定：被一个对象执行obj.foo() -&gt;obj
     3.显示绑定：call/apply/bind  foo.call('aaa') -&gt;String('aaa')
     4.new绑定：new Foo() -&gt; 创建一个新对象，并赋值给this
    */
    //1.创建root
    const root = ReactDOM.createRoot(document.getElementById('root'))

    //2..定义App根组件
    class App extends React.Component {
      constructor() {
        super()

        this.state = {
          count:100
        }
      }

      btn1Click() {
        this.setState({ 
          count:this.state.count+1
        })
      }

      // 箭头函数无this,只能去上一层找
      btn2Click = () =&gt; {
        this.setState({ 
          count:this.state.count-1
        })
      }

      btn3Click() {
        this.setState({ 
          count:this.state.count-1
        })
      }

      render(){
        const {count} = this.state
        return (
          &lt;div&gt;
            &lt;h1&gt;{ count }&lt;/h1&gt;
            {/* 1.this绑定方式一：bind绑定 */}
            &lt;button onClick={this.btn1Click.bind(this)}&gt;按钮1&lt;/button&gt;

            {/* 2.this绑定方式二：箭头函数ES6 class fields */}
            &lt;button onClick={this.btn2Click}&gt;按钮2&lt;/button&gt;

            {/* 3.this绑定方式三：直接传入一个箭头函数 */}
            &lt;button onClick={() =&gt; this.btn3Click()}&gt;按钮3&lt;/button&gt;
          &lt;/div&gt;
        )
      }
    }

    // 3.将App组件渲染到root上
    root.render(&lt;App /&gt;)
  &lt;/script&gt;
&lt;/body&gt;</code></pre>
    <h5 id="YlDtt">
     事件参数传递
    </h5>
    <p id="u51ac9f02">
     1.获取默认参数：即event对象
    </p>
    <p id="u418d6368">
     2.获取更多参数：可通过传入一个箭头函数，主动执行的事件函数，并且传入相关的其他参数
    </p>
    <pre id="rVYVf"><code class="language-html">&lt;body&gt;
  &lt;div id="root"&gt;&lt;/div&gt;

  &lt;script src="../lib/react.js"&gt;&lt;/script&gt;
  &lt;script src="../lib/react-dom.js"&gt;&lt;/script&gt;
  &lt;script src="../lib/babel.js"&gt;&lt;/script&gt;

  &lt;script type="text/babel"&gt;
    //1.创建root
    const root = ReactDOM.createRoot(document.getElementById('root'))

    //2..定义App根组件
    class App extends React.Component {
      constructor() {
        super()

        this.state = {
          message:"Hello World"
        }
      }

      btnClick (event,name,age) {
        console.log("点击事件", event,this);
        console.log("name:", name, "age:",age);
      }

      render(){
        const {message} = this.state
        return (
          &lt;div&gt;
            {/* 1.event参数的传递 */}
            &lt;button onClick={this.btnClick}&gt;按钮1&lt;/button&gt;
            &lt;button onClick={(event) =&gt; this.btnClick(event)}&gt;按钮2&lt;/button&gt;

            {/* 2.传递额外的参数 */}
            &lt;button onClick={(event) =&gt; this.btnClick(event, "why", 30)}&gt;按钮3&lt;/button&gt;
          &lt;/div&gt;
        )
      }
    }

    // 3.将App组件渲染到root上
    root.render(&lt;App /&gt;)
  &lt;/script&gt;
&lt;/body&gt;</code></pre>
    <h4 id="LkLjn">
     条件渲染
    </h4>
    <p id="ub441a38a">
     在vue中，我们会通过指令来控制：比如v-if、v-show；
    </p>
    <p id="u38e9c22d">
     在React中，所有的条件判断都和普通的JavaScript代码一致；
    </p>
    <p id="u5ffe0f34">
     <strong>
      常见条件渲染方式：
     </strong>
    </p>
    <p id="u99801a9e">
     1.条件判断语句
    </p>
    <p id="uf4323331">
     2.三元运算符
    </p>
    <p id="u7bea1da5">
     3.与运算符&amp;&amp;
    </p>
    <pre id="S0la7"><code class="language-html">&lt;body&gt;
  &lt;div id="root"&gt;&lt;/div&gt;

  &lt;script src="../lib/react.js"&gt;&lt;/script&gt;
  &lt;script src="../lib/react-dom.js"&gt;&lt;/script&gt;
  &lt;script src="../lib/babel.js"&gt;&lt;/script&gt;

  &lt;script type="text/babel"&gt;
    //1.创建root
    const root = ReactDOM.createRoot(document.getElementById('root'))

    //2..定义App根组件
    class App extends React.Component {
      constructor() {
        super()

        this.state = {
          isReady:true,

          friend:{
            name:"lucy",
            age:22,
            gender:"女"
          }
        }
      }

      render(){
        const {isReady,friend} = this.state
        // 1.条件判断方式一：使用if进行条件判断
        let showElement = null
        if(isReady) {
          showElement = &lt;h2&gt;准备开始比赛吧&lt;/h2&gt;
        }else{
          showElement = &lt;h1&gt;我还没有准备好嘞&lt;/h1&gt;
        }
        return (
          &lt;div&gt;
            {/* 方式一：根据条件给变量赋值不同的内容 */}
            &lt;div&gt;{ showElement }&lt;/div&gt;

            {/* 方式二：三元运算符 */}
            &lt;div&gt;{isReady? &lt;button&gt;准备开始&lt;/button&gt; : &lt;button&gt;还没有准备好&lt;/button&gt; }&lt;/div&gt;

            {/* 方式三：&amp;&amp;运算符 */}
            {/* 场景：当某一个值，有可能为undefined时，使用&amp;&amp;进行条件判断 */}
            &lt;div&gt;{ friend &amp;&amp; &lt;div&gt;{friend.name + friend.age + friend.gender}&lt;/div&gt; }&lt;/div&gt;
          &lt;/div&gt;
        )
      }
    }

    // 3.将App组件渲染到root上
    root.render(&lt;App /&gt;)
  &lt;/script&gt;
&lt;/body&gt;</code></pre>
    <p id="u6dcea91f">
     <strong>
      实现v-show的效果：
     </strong>
    </p>
    <pre id="QRsFr"><code class="language-javascript">class App extends React.Component {
  constructor() {
    super()

    this.state = {
      message:"Hello World",
      isShow:true
    }
  }

  ediClick() {
    this.setState({
      isShow:!this.state.isShow
    })
  }
  render(){
    const {message,isShow} = this.state
    return (
      &lt;div&gt;
        &lt;button onClick={this.ediClick.bind(this)}&gt;切换1&lt;/button&gt;
        &lt;h1 &gt;{ isShow? message : "" }&lt;/h1&gt;

        {/* v-show的效果 */}
        &lt;button onClick={this.ediClick.bind(this)}&gt;切换2&lt;/button&gt;
        &lt;h1 style={<!-- -->{display:isShow ? "block" : "none"}}&gt;{ message }&lt;/h1&gt;
      &lt;/div&gt;
    )
  }
}</code></pre>
    <h4 id="zHgQy">
     列表渲染
    </h4>
    <pre id="CYtWS"><code class="language-javascript">class App extends React.Component {
  constructor() {
    super()

    this.state = {
      students:[
        {id:1, name:'Jack', age:18},
        {id:2, name:'Tom', age:20},
        {id:3, name:'Lucy', age:22},
        {id:4, name:'Lily', age:24}
      ]
    }
  }

  render(){
    const {students} = this.state

    // 展示年龄大于20的
    const filterStudents = students.filter(item =&gt; item.age &gt;= 20)
    return (
      &lt;div&gt;
        &lt;h2&gt;学生信息列表&lt;/h2&gt;
        &lt;div className="list"&gt;
          {/* 绑定唯一标识key:提高diff算法时的效率 */}
          {filterStudents.map(item =&gt; 
            &lt;div key={item.id} className="item"&gt;
              &lt;p&gt;id:{item.id}&lt;/p&gt;
              &lt;p&gt;姓名：{item.name}&lt;/p&gt;
              &lt;p&gt;年龄：{item.age}&lt;/p&gt;
            &lt;/div&gt;
          )}
        &lt;/div&gt;
      &lt;/div&gt;
    )
  }
}</code></pre>
    <h4 id="mogRa">
     原理本质
    </h4>
    <h5 id="mFXlA">
     babel转换
    </h5>
    <p id="u3245ed59">
     实际上，jsx 仅仅只是 React.createElement(component, props, ...children) 函数的语法糖→所有的jsx最终都会被转换成React.createElement的函数调用
    </p>
    <p id="u47e7e5de">
     createElement需要传递三个参数：
    </p>
    <p id="ue30d1344">
     1.参数一：type
    </p>
    <ul>
     <li id="u8fac3bdf">
      当前ReactElement的类型；
     </li>
     <li id="u8e6134a7">
      如果是标签元素，那么就使用字符串表示 “div”；
     </li>
     <li id="u646fdd7a">
      如果是组件元素，那么就直接使用组件的名称；
     </li>
    </ul>
    <p id="ub76e3054">
     2.参数二：config
    </p>
    <ul>
     <li id="u03926658">
      所有jsx中的属性都在config中以对象的属性和值的形式存储；
     </li>
     <li id="ue282f465">
      比如传入className作为元素的class；
     </li>
    </ul>
    <p id="uf4d9ad60">
     3.参数三：children
    </p>
    <ul>
     <li id="u848f120c">
      存放在标签中的内容，以children数组的方式进行存储；
     </li>
    </ul>
    <p id="u4f567c2b">
     直接编写jsx代码：
    </p>
    <pre id="rEGGH"><code class="language-javascript">&lt;div&gt;
  &lt;div className="header"&gt;header&lt;/div&gt;
  &lt;div className="Content"&gt;
    &lt;div&gt;Banner&lt;/div&gt;
    &lt;ul&gt;
      &lt;li&gt;数据列表1&lt;/li&gt;
      &lt;li&gt;数据列表2&lt;/li&gt;
      &lt;li&gt;数据列表3&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/div&gt;
  &lt;div className="footer"&gt;footer&lt;/div&gt;
&lt;/div&gt;
</code></pre>
    <p id="u3a74da08">
     经过babel转译后：
    </p>
    <pre id="UGDlP"><code class="language-javascript">React.createElement(
'div',
null,
React.createElement('div', { className: 'header' }, 'header'),
React.createElement(
  'div',
  { className: 'Content' },
  React.createElement('div', null, 'Banner'),
  React.createElement(
    'ul',
    null,
    React.createElement('li', null, '数据列表1'),
    React.createElement('li', null, '数据列表2'),
    React.createElement('li', null, '数据列表3')
  )
),
React.createElement('div', { className: 'footer' }, 'footer')
);</code></pre>
    <h5 id="GhLRB">
     虚拟DOM生成
    </h5>
    <p id="ub6be2095">
     通过React.createElement最终创建出一个ReactElement对象→它组成了一个JS对象树→即虚拟DOM
    </p>
    <p id="u5b41cc1d">
    </p>
    <p class="img-center">
     <img alt="" height="797" id="ucfff0635" src="https://i-blog.csdnimg.cn/img_convert/d50fc219512d02dda2e34646ac58f16a.png" width="1060"/>
    </p>
    <h3 id="AUtQY">
     阶段案例-购物车
    </h3>
    <p id="u061be5d6">
    </p>
    <p class="img-center">
     <img alt="" height="424" id="u725dd8f7" src="https://i-blog.csdnimg.cn/img_convert/43df075c7b606242b5f8db792fc18572.png" width="957"/>
    </p>
    <pre id="xW01M"><code class="language-html">&lt;body&gt;
  
  &lt;div id="root"&gt;&lt;/div&gt;

  &lt;script src="../lib/react.js"&gt;&lt;/script&gt;
  &lt;script src="../lib/react-dom.js"&gt;&lt;/script&gt;
  &lt;script src="../lib/babel.js"&gt;&lt;/script&gt;

  &lt;script src="./data.js"&gt;&lt;/script&gt;
  &lt;script src="./format.js"&gt;&lt;/script&gt;

  &lt;script type="text/babel"&gt;
    // 1.定义App根组件
    class App extends React.Component {
      constructor() {
        super()
        this.state = {
          books: books
        }
      }

      getTotalPrice() {
        const totalPrice = this.state.books.reduce((preValue, item) =&gt; {
          return preValue + item.count * item.price
        }, 0)
        return totalPrice
      }

      changeCount(index, count) {
        const newBooks = [...this.state.books]
        newBooks[index].count += count
        this.setState({ books: newBooks })
      }

      removeItem(index) {
        const newBooks = [...this.state.books]
        newBooks.splice(index, 1)
        this.setState({ books: newBooks })
      }

      renderBookList() {
        const { books } = this.state

        return &lt;div&gt;
          &lt;table&gt;
            &lt;thead&gt;
              &lt;tr&gt;
                &lt;th&gt;序号&lt;/th&gt;
                &lt;th&gt;书籍名称&lt;/th&gt;
                &lt;th&gt;出版日期&lt;/th&gt;
                &lt;th&gt;价格&lt;/th&gt;
                &lt;th&gt;购买数量&lt;/th&gt;
                &lt;th&gt;操作&lt;/th&gt;
              &lt;/tr&gt;
            &lt;/thead&gt;
            &lt;tbody&gt;
              {
                books.map((item, index) =&gt; {
                  return (
                    &lt;tr key={item.id}&gt;
                      &lt;td&gt;{index + 1}&lt;/td&gt;
                      &lt;td&gt;{item.name}&lt;/td&gt;
                      &lt;td&gt;{item.date}&lt;/td&gt;
                      &lt;td&gt;{formatPrice(item.price)}&lt;/td&gt;
                      &lt;td&gt;
                        &lt;button 
                          disabled={item.count &lt;= 1}
                          onClick={() =&gt; this.changeCount(index, -1)}
                        &gt;
                          -
                        &lt;/button&gt;
                        {item.count}
                        &lt;button onClick={() =&gt; this.changeCount(index, 1)}&gt;+&lt;/button&gt;
                      &lt;/td&gt;
                      &lt;td&gt;&lt;button onClick={() =&gt; this.removeItem(index)}&gt;删除&lt;/button&gt;&lt;/td&gt;
                    &lt;/tr&gt;
                  )
                })
              }
            &lt;/tbody&gt;
          &lt;/table&gt;
          &lt;h2&gt;总价格: {formatPrice(this.getTotalPrice())}&lt;/h2&gt;
        &lt;/div&gt;
      }

      renderBookEmpty() {
        return &lt;div&gt;&lt;h2&gt;购物车为空, 请添加书籍~&lt;/h2&gt;&lt;/div&gt;
      }

      render() {
        const { books } = this.state
        return books.length ? this.renderBookList(): this.renderBookEmpty()
      }
    }

    // 2.创建root并且渲染App组件
    const root = ReactDOM.createRoot(document.querySelector("#root"))
    root.render(&lt;App/&gt;)
  &lt;/script&gt;

&lt;/body&gt;</code></pre>
    <p id="uf5e222be">
     format.js(数值格式化文件）
    </p>
    <pre id="BR7pR"><code class="language-javascript">function formatPrice(price) {
  return "¥" + Number(price).toFixed(2)
}</code></pre>
    <p>
     data.js(数据文件)
    </p>
    <pre id="qTyo0"><code class="language-javascript">const books = [
  {
    id: 1,
    name: '《算法导论》',
    date: '2006-9',
    price: 85.00,
    count: 1
  },
  {
    id: 2,
    name: '《UNIX编程艺术》',
    date: '2006-2',
    price: 59.00,
    count: 1
  },
  {
    id: 3,
    name: '《编程珠玑》',
    date: '2008-10',
    price: 39.00,
    count: 1
  },
  {
    id: 4,
    name: '《代码大全》',
    date: '2006-3',
    price: 128.00,
    count: 1
  },
]</code></pre>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f36323833313037362f:61727469636c652f64657461696c732f313436333034323737" class_="artid" style="display:none">
 </p>
</div>


