---
layout: post
title: "java八股文之消息中间件"
date: 2025-03-11 17:30:48 +0800
description: "/ Kafka服务器地址。// Kafka服务器地址。// 配置生产者属性。// 创建生产者实例。// 创建消费者实例。"
keywords: "java八股文之消息中间件"
categories: ['未分类']
tags: ['Linq', 'C']
artid: "146184868"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146184868
    alt: "java八股文之消息中间件"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146184868
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146184868
cover: https://bing.ee123.net/img/rand?artid=146184868
image: https://bing.ee123.net/img/rand?artid=146184868
img: https://bing.ee123.net/img/rand?artid=146184868
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     java八股文之消息中间件
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     &lt;在Java中使用消息中间件时，通常会选择一些流行的开源解决方案，如Apache Kafka、RabbitMQ、ActiveMQ等。这些消息中间件提供了高效、可靠的消息传递机制，广泛应用于企业级应用中。下面我将介绍如何在Java中使用Apache Kafka进行消息传递的基本步骤和示例代码。
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     1. 添加Kafka依赖
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     首先，你需要在你的Java项目中添加Kafka的依赖。如果你使用Maven，可以在pom.xml文件中添加以下依赖：
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     &lt;dependencies&gt;
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     &lt;!-- Apache Kafka clients --&gt;
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     &lt;dependency&gt;
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     &lt;groupId&gt;org.apache.kafka&lt;/groupId&gt;
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     &lt;artifactId&gt;kafka-clients&lt;/artifactId&gt;
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     &lt;version&gt;3.0.0&lt;/version&gt; &lt;!-- 请使用最新版本 --&gt;
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     &lt;/dependency&gt;
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     &lt;/dependencies&gt;
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     2. 创建生产者
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     生产者（Producer）是发送消息到Kafka的一个客户端。以下是一个简单的生产者示例：
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     import org.apache.kafka.clients.producer.KafkaProducer;
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     import org.apache.kafka.clients.producer.ProducerRecord;
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     import org.apache.kafka.clients.producer.ProducerConfig;
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     import org.apache.kafka.common.serialization.StringSerializer;
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     import java.util.Properties;
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     public class SimpleProducer {
     <!-- -->
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     public static void main(String[] args) {
     <!-- -->
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     // 配置生产者属性
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     Properties props = new Properties();
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, "localhost:9092"); // Kafka服务器地址
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     // 创建生产者实例
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     KafkaProducer&lt;String, String&gt; producer = new KafkaProducer&lt;&gt;(props);
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     // 发送消息
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     String topic = "test-topic";
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     String value = "Hello, Kafka!";
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     ProducerRecord&lt;String, String&gt; record = new ProducerRecord&lt;&gt;(topic, value);
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     producer.send(record);
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     System.out.println("Message sent successfully!");
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     // 关闭生产者
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     producer.close();
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     }
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     }
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     3. 创建消费者
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     消费者（Consumer）是从Kafka接收消息的一个客户端。以下是一个简单的消费者示例：
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     import org.apache.kafka.clients.consumer.ConsumerRecord;
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     import org.apache.kafka.clients.consumer.ConsumerRecords;
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     import org.apache.kafka.clients.consumer.KafkaConsumer;
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     import org.apache.kafka.clients.consumer.ConsumerConfig;
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     import org.apache.kafka.common.serialization.StringDeserializer;
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     import java.time.Duration;
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     import java.util.Collections;
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     import java.util.Properties;
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     public class SimpleConsumer {
     <!-- -->
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     public static void main(String[] args) {
     <!-- -->
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     // 配置消费者属性
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     Properties props = new Properties();
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     props.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, "localhost:9092"); // Kafka服务器地址
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     props.put(ConsumerConfig.GROUP_ID_CONFIG, "test-group"); // 消费者组ID
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     props.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class.getName());
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     props.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class.getName());
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     props.put(ConsumerConfig.AUTO_OFFSET_RESET_CONFIG, "earliest"); // 从最早的记录开始消费
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     // 创建消费者实例
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     KafkaConsumer&lt;String, String&gt; consumer = new KafkaConsumer&lt;&gt;(props);
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     consumer.subscribe(Collections.singletonList("test-topic")); // 订阅主题
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     // 轮询消息并处理它们
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     while (true) {
     <!-- -->
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     ConsumerRecords&lt;String, String&gt; records = consumer.poll(Duration.ofMillis(100)); // 轮询消息，等待时间为100ms
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     for (ConsumerRecord&lt;String, String&gt; record : records) {
     <!-- -->
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     System.out.printf("Received message: (%s, %s)%n", record.key(), record.value());
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     }
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     }
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     }
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     }
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     4. 运行和测试
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     确保你的Kafka服务正在运行，并且主题test-topic已经创建。你可以使用Kafka自带的命令行工具kafka-topics来创建主题：
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     kafka-topics --create --topic test-topic
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f52766572646f7365722f:61727469636c652f64657461696c732f313436313834383638" class_="artid" style="display:none">
 </p>
</div>


