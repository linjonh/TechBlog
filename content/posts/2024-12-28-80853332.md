---
layout: post
title: "关于热敏电阻温度校准问题的测试和解决"
date: 2024-12-28 18:55:57 +0800
description: "测温偏差较大的问题一、问题描述首先对1.0版本温度贴硬件做一个简单描述：该方案的测温方式是使用热敏电"
keywords: "ntc温度校准"
categories: ['未分类']
tags: ['热敏电阻', '温度校准', '全桥电路硬件设计']
artid: "80853332"
image:
  path: https://api.vvhan.com/api/bing?rand=sj&artid=80853332
  alt: "关于热敏电阻温度校准问题的测试和解决"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=80853332
featuredImagePreview: https://bing.ee123.net/img/rand?artid=80853332
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     关于热敏电阻温度校准问题的测试和解决
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h2 align="center">
     <strong>
      <span style="font-family:'宋体';">
       测温偏差较大的问题
      </span>
     </strong>
    </h2>
    <p align="justify">
     一、
     <strong>
      问题描述
     </strong>
    </p>
    <p align="justify">
     <span style="font-family:'宋体';">
      首先对
     </span>
     1.0
     <span style="font-family:'宋体';">
      版本温度贴硬件做一个简单描述：该方案的测温方式是使用热敏电阻
     </span>
     <span style="font-family:Calibri;">
      NTC
     </span>
     <span style="font-family:'宋体';">
      ，采集其模拟电压并转换为相应的温度值，原理图如图
     </span>
     <span style="font-family:Calibri;">
      1
     </span>
     <span style="font-family:'宋体';">
      所示，使用单运放
     </span>
     <span style="font-family:Calibri;">
      TLV521
     </span>
     <span style="font-family:'宋体';">
      搭建一个桥，起初，对多片焊接完整的温度贴线路板进行温度准确度测试，发现测得温度与实际水温偏差较大且不一致，正偏和负偏均存在，无规律可寻，由于本产品对测温精度的要求为
     </span>
     <span style="font-family:Calibri;">
      -0.1~+0.1
     </span>
     <span style="font-family:'宋体';">
      °，所以该结果未能满足要求，一开始想过对不同偏差的板子通过一条拟合曲线对温度进行校准，但采集了多组数据后找到一条拟合曲线加进去后仍无法全部满足要求且耗时较长，放弃了此方式校准，故进行了以下分析测试；
     </span>
    </p>
    <p align="justify">
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/35e109f56a6abeb81db37f3cfc2d7d9d.png"/>
    </p>
    <p align="center">
     <span style="font-family:'宋体';">
      图
     </span>
     1
    </p>
    <p align="justify">
     二、
     <strong>
      该问题造成的影响
     </strong>
    </p>
    <p align="justify">
     <span style="font-family:'宋体';">
      正如问题描述中提到的，本产品对测温精度的要求是
     </span>
     -0.1~+0.1
     <span style="font-family:'宋体';">
      °，然而对
     </span>
     <span style="font-family:Calibri;">
      30+
     </span>
     <span style="font-family:'宋体';">
      片的温度测试发现，有相当多的一部分未能满足要求，这里说明一下，当时的具体测试数据未能保留下来，是个疏忽。
     </span>
    </p>
    <p align="justify">
     三、
     <strong>
      对该问题的分析过程
     </strong>
    </p>
    <p align="justify">
     <span style="font-family:'宋体';">
      发现这个问题后，由于当时我经验不足，请教了一些人，寻求到一些建议，从以下方面对该问题逐一分析：
     </span>
     1
     <span style="font-family:'宋体';">
      、热敏电阻精度一致性；
     </span>
     <span style="font-family:Calibri;">
      2
     </span>
     <span style="font-family:'宋体';">
      、
     </span>
     <span style="font-family:Calibri;">
      CPU
     </span>
     <span style="font-family:'宋体';">
      的
     </span>
     <span style="font-family:Calibri;">
      ADC
     </span>
     <span style="font-family:'宋体';">
      采集误差；
     </span>
     <span style="font-family:Calibri;">
      3
     </span>
     <span style="font-family:'宋体';">
      、外围电路元器件精度；
     </span>
    </p>
    <p align="justify">
     1、
     <span style="font-family:'宋体';">
      热敏电阻精度一致性：因热敏电阻本身存在一定的差异，所以率先验证该因素是否为影响测温准确度的主要因素，具体步骤为，在上述
     </span>
     30+
     <span style="font-family:'宋体';">
      片温度贴里取三片（附带原热敏电阻），①号温度偏低，②号温度接近水温，③号温度偏高，重新在一相对恒定水浴温度内测得三片裸板的对应温度并记录下来，然后将三片裸板上的热敏电阻一一取下，分别对应
     </span>
     <span style="font-family:Calibri;">
      a
     </span>
     <span style="font-family:'宋体';">
      、
     </span>
     <span style="font-family:Calibri;">
      b
     </span>
     <span style="font-family:'宋体';">
      、
     </span>
     <span style="font-family:Calibri;">
      c
     </span>
     <span style="font-family:'宋体';">
      ，然后彼此之间两两交换，并测量后记录结果，发现相比之下①号总是偏低，②号接近水温，③号温度偏高，三轮测试之后可以基本确定，同一批次的热敏电阻导致该温度误差的可能性已经可以被排除；
     </span>
    </p>
    <p align="justify">
     2、CPU
     <span style="font-family:'宋体';">
      的
     </span>
     <span style="font-family:Calibri;">
      ADC
     </span>
     <span style="font-family:'宋体';">
      采集误差：将三片裸板的
     </span>
     <span style="font-family:Calibri;">
      TLV521
     </span>
     <span style="font-family:'宋体';">
      取下，断开其与
     </span>
     <span style="font-family:Calibri;">
      CPU
     </span>
     <span style="font-family:'宋体';">
      的连接，将
     </span>
     <span style="font-family:Calibri;">
      ADIN
     </span>
     <span style="font-family:'宋体';">
      接
     </span>
     <span style="font-family:Calibri;">
      GND
     </span>
     <span style="font-family:'宋体';">
      ，读取采集到的值转化成电压值，三片一致性较好，几乎为
     </span>
     <span style="font-family:Calibri;">
      0
     </span>
     <span style="font-family:'宋体';">
      ，故
     </span>
     <span style="font-family:Calibri;">
      ADC
     </span>
     <span style="font-family:'宋体';">
      的影响可以忽略；
     </span>
    </p>
    <p align="justify">
     3、
     <span style="font-family:'宋体';">
      外围电路元器件精度：首先验证桥上各个电阻阻值大小及精度对温度准确度的影响，选取上述图
     </span>
     1
     <span style="font-family:'宋体';">
      中的一组
     </span>
     <span style="font-family:Calibri;">
      1%
     </span>
     <span style="font-family:'宋体';">
      精度电阻值后，先后换了两组，测试数据发现温度并无大的改善，也没变得更差，基本排除电阻值对温度准确度的影响；其次就是对
     </span>
     <span style="font-family:Calibri;">
      TLV521
     </span>
     <span style="font-family:'宋体';">
      的测试，可以从图
     </span>
     <span style="font-family:Calibri;">
      2
     </span>
     <span style="font-family:'宋体';">
      中观察到
     </span>
     <span style="font-family:Calibri;">
      TLV521
     </span>
     <span style="font-family:'宋体';">
      的电气特性第一项
     </span>
     <span style="font-family:Calibri;">
      Vos
     </span>
     <span style="font-family:'宋体';">
      较大，当前硬件设计中模拟电压约
     </span>
     <span style="font-family:Calibri;">
      5mV
     </span>
     <span style="font-family:'宋体';">
      对应
     </span>
     <span style="font-family:Calibri;">
      0.1
     </span>
     <span style="font-family:'宋体';">
      °，所以极有可能是因为这个特性指标造成温度误差较大，接下来的测试就是针对
     </span>
     <span style="font-family:Calibri;">
      TLV521
     </span>
     <span style="font-family:'宋体';">
      进行，第一步，我先把当前状态下的三片裸板（①号温度偏低，②号温度接近水温，③号温度偏高）温度贴再次测试一下恒温水浴下的温度并一一记录数据，然后将三片板子上的
     </span>
     <span style="font-family:Calibri;">
      TLV521
     </span>
     <span style="font-family:'宋体';">
      两两互换，保证其他量不变，发现①号的
     </span>
     <span style="font-family:Calibri;">
      TLV521
     </span>
     <span style="font-family:'宋体';">
      无论换到哪块板子上，测试出的温度始终是低的，且与其在①号上时近似，然后将②号板子上的
     </span>
     <span style="font-family:Calibri;">
      TLV521
     </span>
     <span style="font-family:'宋体';">
      取下放在另外两块板子上，发现测得温度与②号板子之前的数据近似，如此操作，对下一个验证，结论仍是如此，到此基本可以确定，
     </span>
     <span style="font-family:Calibri;">
      TLV521
     </span>
     <span style="font-family:'宋体';">
      的影响是造成温度准确度不够的主要因素。
     </span>
    </p>
    <p align="justify">
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/6706ceacb6810688ed906741f930cce1.png"/>
    </p>
    <p align="center">
     <span style="font-family:'宋体';">
      图
     </span>
     2
    </p>
    <p align="justify">
     四、
     <strong>
      解决该问题的修改方案
     </strong>
    </p>
    <p align="justify">
     <span style="font-family:'宋体';">
      针对以上分析的结果，已经基本确定是
     </span>
     TLV521
     <span style="font-family:'宋体';">
      的
     </span>
     <span style="font-family:Calibri;">
      Vos
     </span>
     <span style="font-family:'宋体';">
      电压导致，所以，综合部门总管和嵌入式软件工程师的讨论，有两种解决办法：
     </span>
     <span style="font-family:Calibri;">
      a
     </span>
     <span style="font-family:'宋体';">
      、换一个性能更好的运放，如
     </span>
     <span style="font-family:Calibri;">
      TLV333
     </span>
     <span style="font-family:'宋体';">
      ；
     </span>
     <span style="font-family:Calibri;">
      b
     </span>
     <span style="font-family:'宋体';">
      、可以用
     </span>
     <span style="font-family:Calibri;">
      ADC
     </span>
     <span style="font-family:'宋体';">
      采集热敏电阻阻值在
     </span>
     <span style="font-family:Calibri;">
      30K
     </span>
     <span style="font-family:'宋体';">
      （对应
     </span>
     <span style="font-family:Calibri;">
      37
     </span>
     <span style="font-family:'宋体';">
      °）时的电压值与标准电压值作比较，并自动补偿该差值写入
     </span>
     <span style="font-family:Calibri;">
      flash
     </span>
     <span style="font-family:'宋体';">
      ，之后的计算调用该值以达到校准的目的；显然，从成本和当前情况来看，
     </span>
     <span style="font-family:Calibri;">
      a
     </span>
     <span style="font-family:'宋体';">
      方案是不可行的，所以采取了
     </span>
     <span style="font-family:Calibri;">
      b
     </span>
     <span style="font-family:'宋体';">
      方案，具体可行性分析还要经过验证；接下来嵌入式软件工程师针对当前现象以及讨论的解决方案进行了固件改进，搭载硬件烧写工具进行了再一次测试，前期选取的样本仍是之前测试的三片板子，烧写过最新修改的固件版本以后，可以读取写入的偏移量，初步计算后发现不同板子的偏移量值均处于
     </span>
     <span style="font-family:Calibri;">
      -15.00~+15.00mV
     </span>
     <span style="font-family:'宋体';">
      区间范围内，然后放入恒温水浴测试，结果发现，三片板子测得的数据一致性较之前有很大提高，且均处在
     </span>
     <span style="font-family:Calibri;">
      37
     </span>
     <span style="font-family:'宋体';">
      °±
     </span>
     <span style="font-family:Calibri;">
      0.1
     </span>
     <span style="font-family:'宋体';">
      °范围内，该结果已初步验证了上述解决方案的可行性，为了确保万无一失，我又进行了多片抽样验证，最终的测试结果与前三片一致，故说明定位的问题及解决方案均正确，该问题算是基本解决，但为了产品升级的需要，且后来发现一个问题，热敏电阻的一致性仅限于每一批次，即同一批次生产出来的热敏电阻我们认为它的曲线一致性较好，但下一次批次就会有所偏差，或偏大或偏小，所以为了更好地校准热敏电阻，嵌入式软件
     </span>
     <span style="font-family:Calibri;">
      APP
     </span>
     <span style="font-family:'宋体';">
      端计算好的拟合曲线没办法对每一批次修改升级，后期嵌入式软件又加入了对不同批次的热敏电阻进行抽检预测试，即通过抽检确定该批次的一个误差范围，然后将该误差通过嵌入式软件中分配一块区域存储并后期计算时调用，这样就解决了升级却不会修改测温精度的问题，希望这种工程案例能对你们有所启发和帮助。
     </span>
    </p>
    <p align="justify">
     五、
     <strong>
      最终结果
     </strong>
    </p>
    <p align="justify">
     <span style="font-family:'宋体';">
      以上描述是解决温度贴
     </span>
     1.0
     <span style="font-family:'宋体';">
      版本温度不准确的一些重要步骤，当然还有一些中间进行的操作没有具体说明，或者说是因个人能力不够做了一些无用功，没能够快速准确地定位到是
     </span>
     <span style="font-family:Calibri;">
      TLV521
     </span>
     <span style="font-family:'宋体';">
      导致的，庆幸的是，在部门总管和众人的帮助下，终于找到问题所在并成功解决，这算是我工作中的一个学习和进步。
     </span>
    </p>
    <p align="justify">
    </p>
    <p align="justify">
    </p>
    <p align="justify">
    </p>
    <p align="justify">
    </p>
    <p align="justify">
    </p>
    <p align="justify">
    </p>
    <p align="justify">
    </p>
    <p align="justify">
    </p>
    <p align="justify">
    </p>
    <p align="justify">
    </p>
    <p align="justify">
    </p>
    <p align="justify">
    </p>
    <p align="justify">
    </p>
    <p align="justify">
     <strong>
      附：
     </strong>
    </p>
    <p align="justify">
     <span style="font-family:'宋体';">
      当然，上述陈述中是前期温度贴
     </span>
     1.0
     <span style="font-family:'宋体';">
      版本存在的一个较大的问题，后期我们有发现了一些额外的问题：
     </span>
     <span style="font-family:Calibri;">
      a
     </span>
     <span style="font-family:'宋体';">
      、不同温度状态下，测得温度与实际水温存在偏差，如
     </span>
     <span style="font-family:Calibri;">
      25~35
     </span>
     <span style="font-family:'宋体';">
      °时偏高超出
     </span>
     <span style="font-family:Calibri;">
      0.1
     </span>
     <span style="font-family:'宋体';">
      °，
     </span>
     <span style="font-family:Calibri;">
      36~39
     </span>
     <span style="font-family:'宋体';">
      °时偏低在
     </span>
     <span style="font-family:Calibri;">
      0.1
     </span>
     <span style="font-family:'宋体';">
      °内，
     </span>
     <span style="font-family:Calibri;">
      39~45
     </span>
     <span style="font-family:'宋体';">
      °高出实际水温
     </span>
     <span style="font-family:Calibri;">
      0.2~0.4
     </span>
     <span style="font-family:'宋体';">
      °；
     </span>
     <span style="font-family:Calibri;">
      b
     </span>
     <span style="font-family:'宋体';">
      、正确使用方式下测得的温度偏低于人体温度，我们欲使其偏高于准确温度
     </span>
     <span style="font-family:Calibri;">
      0.1
     </span>
     <span style="font-family:'宋体';">
      °，故后面又经过了一轮新的测试；
     </span>
     <span style="font-family:Calibri;">
      c
     </span>
     <span style="font-family:'宋体';">
      、人体测温时升温速度慢；
     </span>
    </p>
    <p align="justify">
     <span style="font-family:'宋体';">
      针对上述问题
     </span>
     a
     <span style="font-family:'宋体';">
      、
     </span>
     <span style="font-family:Calibri;">
      b
     </span>
     <span style="font-family:'宋体';">
      的现象，后面增加了一些测试及验证，因怀疑不同批次的热敏电阻存在
     </span>
     <span style="font-family:Calibri;">
      R-T
     </span>
     <span style="font-family:'宋体';">
      曲线误差，所以为了解决
     </span>
     <span style="font-family:Calibri;">
      a
     </span>
     <span style="font-family:'宋体';">
      、
     </span>
     <span style="font-family:Calibri;">
      b
     </span>
     <span style="font-family:'宋体';">
      问题，我们对
     </span>
     <span style="font-family:Calibri;">
      R-T
     </span>
     <span style="font-family:'宋体';">
      曲线做了取舍，将原来的拟合范围由
     </span>
     <span style="font-family:Calibri;">
      25~45
     </span>
     <span style="font-family:'宋体';">
      °缩小至
     </span>
     <span style="font-family:Calibri;">
      30~40
     </span>
     <span style="font-family:'宋体';">
      °，能够保证在
     </span>
     <span style="font-family:Calibri;">
      30~40
     </span>
     <span style="font-family:'宋体';">
      °范围内准确度在±
     </span>
     <span style="font-family:Calibri;">
      0.1
     </span>
     <span style="font-family:'宋体';">
      °内，然后为了使其正偏，即高于实际水温（
     </span>
     <span style="font-family:Calibri;">
      0,0.1
     </span>
     <span style="font-family:'宋体';">
      ）°，而且能够适应不同批次的热敏电阻，嵌入式软件工程师在
     </span>
     <span style="font-family:Calibri;">
      flash
     </span>
     <span style="font-family:'宋体';">
      中预留一定字节的空间来存储校准系数，且经过首轮验证和再次验证，成功证实了该方案的可行性，只是有些繁琐且必要的前期测试要做，如针对每一批次的热敏电阻抽取一定的样本，经过测试和验证，确定出一条适用于该批次的温度拟合曲线，将其系数写入
     </span>
     <span style="font-family:Calibri;">
      flash
     </span>
     <span style="font-family:'宋体';">
      以得到符合既定要求的温度数据。
     </span>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f67:2e6373646e2e6e65742f77656978696e5f3339353339393839:2f61727469636c652f64657461696c732f3830383533333332" class_="artid" style="display:none">
 </p>
</div>
