---
arturl_encode: "68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34343136373539352f:61727469636c652f64657461696c732f313332363038323734"
layout: post
title: "ubuntu16bind9-搭建dns服务器"
date: 2023-08-31 18:32:55 +0800
description: "4：在/etc/bind/zones/路径下创建区文件，我这里创建的是db.tor.com，和前面定"
keywords: "ubuntu16+bind9 搭建dns服务器"
categories: ['未分类']
tags: ['服务器']
artid: "132608274"
image:
  path: https://api.vvhan.com/api/bing?rand=sj&artid=132608274
  alt: "ubuntu16bind9-搭建dns服务器"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=132608274
featuredImagePreview: https://bing.ee123.net/img/rand?artid=132608274
---

# ubuntu16+bind9 搭建dns服务器

需求：使用bind9搭建一台dns服务器，为其他服务器之间的访问提供dns解析服务

> dns服务器：192.168.xx.32
>   
> web服务器：192.168.xx.31
>   
> db服务器：192.168.xx.33

#### 1：安装bind9

```
apt install bind9

```

#### 2：编辑bind配置文件（/etc/bind/named.conf.local）指定域的区块文件

```
vim /etc/bind/named.conf.local

```

添加下列内容

```
zone "tor.com"{                          # “tor.com”可以理解为监听区域，根据自己的域名设置
    type master;
    file "/etc/bind/zones/db.tor.com";   # 区文件路径（稍后在相应位置创建区文件就好，路径不必严格照搬）

}; # zone 可以定义多个

```

#### 3：进入/etc/bind/目录下，没有 zones 文件夹就创建。

#### 4：在/etc/bind/zones/路径下创建区文件

```
cp /etc/bind/db.empty /etc/bind/zones/db.tor.com

```

我这里创建的是 db.tor.com，和前面定义的路径匹配就行

#### 5：编辑区文件 db.tor.com

```
; BIND reverse data file for empty rfc1918 zone
;
; DO NOT EDIT THIS FILE - it is used for multiple zones.
; Instead, copy it, edit named.conf, and use that copy.
;
$TTL 86400
@ IN SOA ns1.tor.com. admin.tor.com. (
1 ; Serial
604800 ; Refresh
86400 ; Retry
2419200 ; Expire
86400 ) ; Negative Cache TTL
;
@ IN NS localhost. #域名服务器
;tor.com IN NS 192.168.xx.32  
;@ IN A 127.0.0.1 #ipv4 地址
;@ IN AAAA ::1 #ipv6 地址

web IN A 192.168.xx.31 #提供 web 服务的服务器
db IN A 192.168.xx.33 #提供数据库服务的服务器

```

SerialNumber ：每次编辑区文件后数字请自行+1，用于从服务器判断何时获取最新的区数据
  
@：表示当前域
  
NS：域名服务器
  
“;”：注释

#### 6：编辑 named.conf.options 文件

```
vim named.conf.options

```

设置监听端口（在 options 内加入）

> listen-on port 53 {127.0.0.1;192.168.xx.32; }; # 此处填写 ns1 的内网 IP 地址。仅在内网监听

#### 7：重启 bind 服务

```
service bind9 restart

```

#### 8：配置服务器 dns 指向 dns 服务器

例如在角色为 web 的服务器上编辑 /etc/resolv.conf 文件，加入如下内容

> nameserver 192.168.xx.32 #dns 服务器地址
>   
> search DHCP HOST

保存退出，接下来在
**web**
服务器上
`ping db.tor.com`
就可以自动解析到角色为
**db**
的服务器地址
  
也可以使用
`nslookup db.tor.com`
验证

[区文件配置说明参考](https://blog.51cto.com/ylive/389892)

[bind9 配置说明](https://www.cnblogs.com/liyuanhong/articles/7400854.html)

[dns 解析过程全解](http://www.cnblogs.com/liyuanhong/articles/7353974.html)

[常用域名记录解释](https://www.cnblogs.com/liyuanhong/articles/7355153.html)

### 本文参考

[ubuntu 下配置 bind9 为局域网的 DNS 服务器](https://blog.csdn.net/lyhDream/article/details/77620932)

[ubuntu16.04 下搭建 bind9 记录](https://blog.csdn.net/w450093854/article/details/88357179)

### PS:自由域

![zone](https://i-blog.csdnimg.cn/blog_migrate/a7f1a58737e837f4c144cf686dea1902.png#pic_center)
  
![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/764094e61e51ed683470778b2862bf3a.png#pic_center)