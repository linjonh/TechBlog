---
layout: post
title: "python-timestamp和datetime之间的转换_Python-datetime与timestamp之间的转换"
date: 2022-05-12 14:24:42 +0800
description: "本文介绍了Python中datetime与timestamp转换时遇到的时区问题，特别是time.m"
keywords: "pythontimestamp变成datetime"
categories: ['未分类']
tags: ['Timestamp', 'Python']
artid: "113493974"
image:
  path: https://api.vvhan.com/api/bing?rand=sj&artid=113493974
  alt: "python-timestamp和datetime之间的转换_Python-datetime与timestamp之间的转换"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=113493974
featuredImagePreview: https://bing.ee123.net/img/rand?artid=113493974
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     python timestamp和datetime之间的转换_Python datetime与timestamp之间的转换
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <div style="font-size:16px;">
     <p>
      # !!!! Python 2 datetime.datetime 对象没有timestamp方法！
     </p>
     <p>
      在用Python处理datetime和timestamp的转换时发现在时区方面，Python的处理是个大坑。
     </p>
     <p>
      因为Python的time是默认localtime输入来处理的，导致脚本在本地运行和在服务器运行会得到不一样的结果。一不注意就会中招。
     </p>
     <p>
      R中也会碰到时区的问题，但是R的方法提供了tz选项来指定日期的时区，简化了问题。而Python 中的time.mktime无法对时区进行指定，带来了很多麻烦。查了很久，发现有一个time.timezone的属性，可以根据运行脚本的机器的时间，来灵活处理时区问题。
     </p>
     <p>
      以下是datetime与timestamp转换的方法, 输入和输出都以GMT0为准.
     </p>
     <p>
      from datetime import datetime
     </p>
     <p>
      import time
     </p>
     <p>
      def timestamp_datetime(ts):
     </p>
     <p>
      if isinstance(ts, (int, float, str)):
     </p>
     <p>
      try:
     </p>
     <p>
      ts = int(ts)
     </p>
     <p>
      except ValueError:
     </p>
     <p>
      raise
     </p>
     <p>
      if len(str(ts)) == 13:
     </p>
     <p>
      ts = int(ts / 1000)
     </p>
     <p>
      if len(str(ts)) != 10:
     </p>
     <p>
      raise ValueError
     </p>
     <p>
      else:
     </p>
     <p>
      raise ValueError()
     </p>
     <p>
      return datetime.fromtimestamp(ts)
     </p>
     <p>
      def datetime_timestamp(dt, type='ms'):
     </p>
     <p>
      if isinstance(dt, str):
     </p>
     <p>
      try:
     </p>
     <p>
      if len(dt) == 10:
     </p>
     <p>
      dt = datetime.strptime(dt.replace('/', '-'), '%Y-%m-%d')
     </p>
     <p>
      elif len(dt) == 19:
     </p>
     <p>
      dt = datetime.strptime(dt.replace('/', '-'), '%Y-%m-%d %H:%M:%S')
     </p>
     <p>
      else:
     </p>
     <p>
      raise ValueError()
     </p>
     <p>
      except ValueError as e:
     </p>
     <p>
      raise ValueError(
     </p>
     <p>
      "{0} is not supported datetime format." \
     </p>
     <p>
      "dt Format example: 'yyyy-mm-dd' or yyyy-mm-dd HH:MM:SS".format(dt)
     </p>
     <p>
      )
     </p>
     <p>
      if isinstance(dt, time.struct_time):
     </p>
     <p>
      dt = datetime.strptime(time.stftime('%Y-%m-%d %H:%M:%S', dt), '%Y-%m-%d %H:%M:%S')
     </p>
     <p>
      if isinstance(dt, datetime):
     </p>
     <p>
      if type == 'ms':
     </p>
     <p>
      ts = int(dt.timestamp()) * 1000
     </p>
     <p>
      else:
     </p>
     <p>
      ts = int(dt.timestamp())
     </p>
     <p>
      else:
     </p>
     <p>
      raise ValueError(
     </p>
     <p>
      "dt type not supported. dt Format example: 'yyyy-mm-dd' or yyyy-mm-dd HH:MM:SS"
     </p>
     <p>
      )
     </p>
     <p>
      return ts
     </p>
     <p>
      if __name__ == '__main__':
     </p>
     <p>
      try:
     </p>
     <p>
      print(datetime_timestamp('2015-01-01 20:20:00', 's'))
     </p>
     <p>
      print(timestamp_datetime(1420114800))
     </p>
     <p>
      print(timestamp_datetime(1420114800123))
     </p>
     <p>
      except Exception as e:
     </p>
     <p>
      print(e.args[0])
     </p>
     <p>
      python—时间与时间戳之间的转换
     </p>
     <p>
      python-时间与时间戳之间的转换 对于时间数据,如2016-05-05 20:28:54,有时需要与时间戳进行相互的运算,此时就需要对两种形式进行转换,在Python中,转换时需要用到time模块 ...
     </p>
     <p>
      Python数字与字符之间的转换
     </p>
     <p>
      Python数字与字符之间的转换 命令 意义 int(x [,base ]) 将x转换为一个整数 long(x [,base ]) 将x转换为一个长整数 float(x ) 将x转换到一个浮点数 co ...
     </p>
     <p>
      c&amp;num; datetime与 timeStamp时间戳 互相转换
     </p>
     <p>
      将时间格式转化为一个int类型 // ::26时间转完后为:1389675686数字 为什么使用时间戳? 关于Unix时间戳,大概是这个意思,从1970年0时0分0秒开始到现在的秒数.使用它来获得的是 ...
     </p>
     <p>
      常见的时间字符串与timestamp之间的转换 时间戳
     </p>
     <p>
      这里说的字符串不是一般意义上的字符串,是指在读取日期类型的数据时,如果还没有及时解析字符串,它就还不是日期类型,那么此时的字符串该怎么与时间戳之间进行转换呢? ① 时间字符串转化成时间戳 将时间字符串 ...
     </p>
     <p>
      python中进制之间的转换
     </p>
     <p>
      参考于:http://www.360doc.com/content/14/0428/11/16044571_372866302.shtml  在此非常感谢! ~~~~~~~~~~~~~~~~~~~~~ ...
     </p>
     <p>
      msyql DATETIME类型和Timestamp之间的转换
     </p>
     <p>
      DATETIME -&gt; Timestamp: UNIX_TIMESTAMP(...) Timestamp -&gt; DATETIME: FROM_UNIXTIME(...) select da ...
     </p>
     <p>
      python 时间与时间戳之间的转换
     </p>
     <p>
      https://blog.csdn.net/kl28978113/article/details/79271518 对于时间数据,如2016-05-05 20:28:54,有时需要与时间戳进行相互的运 ...
     </p>
     <p>
      String和Date、Timestamp之间的转换
     </p>
     <p>
      一.String与Date(java.util.Date)互转 1.1 String -&gt; Date String dateStr = "2010/05/04 12:34:23&amp;quo ...
     </p>
     <p>
      Java：String和Date、Timestamp之间的转换
     </p>
     <p>
      一.String与Date(java.util.Date)互转 1.1 String -&gt; Date String dateStr = "2016-9-28 12:25:55&amp;quot ...
     </p>
     <p>
      随机推荐
     </p>
     <p>
      Oracle insert大量数据经验之谈(转)
     </p>
     <p>
      在很多时候,我们会需要对一个表进行插入大量的数据,并且希望在尽可能短的时间内完成该工作,这里,和大家分享下我平时在做大量数据insert的一些经验. 前提:在做insert数据之前,如果是非生产环境, ...
     </p>
     <p>
      前端js的书写规范和高效维护的方案&amp;lowbar;自我总结使用的方案
     </p>
     <p>
      作为程序员,人生最值得幸福的事有几件: 解决困扰了很长时间的问题 升职加薪 找个漂亮又靠谱的对象 深得领导的喜欢 带领团队冲锋陷阵 ... 哈哈,这些都是梦想,暂时想想就好了.这肯定和我说的东西不符合 ...
     </p>
     <p>
      paip&amp;period;mysql备份慢的解决
     </p>
     <p>
      paip.mysql备份慢的解决.txt 作者Attilax ,  EMAIL:1466519819@qq.com  来源:attilax的专栏 地址:http://blog.csdn.net/att ...
     </p>
     <p>
      chmod chgrp chown
     </p>
     <p>
      Linux系统中的每个文件和目录都有访问许可权限,用它来确定谁可以通过何种方式对文件和目录进行访问和操作. 文件或目录的访问权限分为只读,只写和可执行三种.以文件为例,只读权限表示只允许读其内容,而禁 ...
     </p>
     <p>
      smarty 中时间格式化的用法
     </p>
     <p>
      大家都知道PHP中输出时间和日期可以用 date("Y-m-d H:i:s",时间戳)  , 但是在smarty模板中,$time|date_format:'%Y-%m-%d %H ...
     </p>
     <p>
      Sicily 4495&amp;period; Print permutations
     </p>
     <p>
      http://soj.me/4495 按字典序生成字符串的全排列 直接递归: #include #include #include &amp;l ...
     </p>
     <p>
      poj3984迷宫问题
     </p>
     <p>
      一个5 × 5的二维数组,表示一个迷宫.其中的1表示墙壁,0表示可以走的路,只能横着走或竖着走,不能斜着走,要求编程序找出从左上角到右下角的最短路线. 很简单的一道题,迷宫问题,一般都选择两种优先搜索 ...
     </p>
     <p>
      Qt下载地址
     </p>
     <p>
      上Qt官网http://www.qt.io/download/想下载Qt,速度很慢,在这里记录下在Qt官网看到的镜像下载地址: 1. 所有Qt版本下载地址: http://download.qt.io ...
     </p>
     <p>
      neutron-----openstack网络操作
     </p>
     <p>
      #查看子网 openstack subnet list #删除子网 openstack subnet delete name/id #查看网络 openstack network list #删除网络 ...
     </p>
    </div>
   </div>
  </div>
  <div id="recommendDown">
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34303030373031362f:61727469636c652f64657461696c732f313133343933393734" class_="artid" style="display:none">
 </p>
</div>
