---
layout: post
title: "华为eNSP配置单区域OSPF"
date: 2025-03-07 12:12:10 +0800
description: "OSPF（Open Shortest Path First，开放最短路径优先）是一种链路状态路由协议，属于内部网关协议（IGP），主要用于在单一自治系统（AS）内部动态发现和分发路由信息。它是为大型复杂网络设计的协议，具有高效、快速收敛和分层管理的特点。1、OSPF通过链路状态数据库和SPF算法实现高效路由，是构建稳定、可扩展网络的理想选择。其分层设计、快速收敛和对复杂网络的支持，使其成为企业、数据中心和运营商网络中最常用的IGP协议之一2、OSPF在网络中扮演动态路由引擎。"
keywords: "ensp的ofps 1 area 0 network是干嘛的"
categories: ['未分类']
tags: ['华为']
artid: "146091612"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146091612
    alt: "华为eNSP配置单区域OSPF"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146091612
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146091612
cover: https://bing.ee123.net/img/rand?artid=146091612
image: https://bing.ee123.net/img/rand?artid=146091612
img: https://bing.ee123.net/img/rand?artid=146091612
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     华为eNSP:配置单区域OSPF
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h3>
     一、什么是OSPF？
    </h3>
    <p>
     OSPF（Open Shortest Path First，开放最短路径优先）是一种
     <strong>
      链路状态路由协议
     </strong>
     ，属于
     <strong>
      内部网关协议（IGP）
     </strong>
     ，主要用于在单一自治系统（AS）内部动态发现和分发路由信息。它是为大型复杂网络设计的协议，具有高效、快速收敛和分层管理的特点。
    </p>
    <h3>
     二、OSPF在网络中起什么作用？
    </h3>
    <p>
     OSPF（开放最短路径优先协议）在网络中主要承担
     <strong>
      动态路由发现、路径计算和网络拓扑维护
     </strong>
     的核心作用，是构建高效、稳定、可扩展网络的关键协议。以下是其具体作用：
    </p>
    <h5>
     <strong>
      1. 动态路由发现与维护
     </strong>
    </h5>
    <ul>
     <li>
      <h5>
       <strong>
        自动发现邻居
       </strong>
       ：
       <br/>
       通过
       <strong>
        Hello包
       </strong>
       周期性地发现相邻路由器，并建立邻居关系，无需手动配置路由条目。
      </h5>
     </li>
     <li>
      <h5>
       <strong>
        同步链路状态数据库（LSDB）
       </strong>
       ：
       <br/>
       所有OSPF路由器通过交换
       <strong>
        LSA（链路状态通告）
       </strong>
       ，维护一致的网络拓扑视图，确保每个路由器了解全网结构。
      </h5>
     </li>
    </ul>
    <h5>
     <strong>
      2. 智能路径计算
     </strong>
    </h5>
    <ul>
     <li>
      <h5>
       <strong>
        最短路径优先（SPF算法）
       </strong>
       ：
       <br/>
       基于链路状态数据库，使用Dijkstra算法计算到所有目标网络的最短路径（考虑带宽、延迟等链路成本），生成最优路由表。
      </h5>
     </li>
     <li>
      <h5>
       <strong>
        负载均衡
       </strong>
       ：
       <br/>
       支持等价多路径（ECMP），允许多条等成本路径同时转发流量，提升带宽利用率。
      </h5>
     </li>
    </ul>
    <h5>
     <strong>
      3. 快速网络收敛
     </strong>
    </h5>
    <ul>
     <li>
      <h5>
       <strong>
        实时更新拓扑变化
       </strong>
       ：
       <br/>
       当网络链路故障或新增设备时，OSPF通过洪泛机制（Flooding）快速通知全网路由器，触发SPF重新计算，实现秒级收敛（通常1-3秒）。
      </h5>
     </li>
     <li>
      <h5>
       <strong>
        减少网络中断时间
       </strong>
       ：
       <br/>
       相比RIP等协议，OSPF的快速收敛特性显著降低了因拓扑变化导致的数据包丢失风险。
      </h5>
     </li>
    </ul>
    <h5>
     <strong>
      4. 分层网络管理（区域划分）
     </strong>
    </h5>
    <ul>
     <li>
      <h5>
       <strong>
        骨干区域（Area 0）与非骨干区域
       </strong>
       ：
       <br/>
       将大型网络划分为多个区域，限制LSA洪泛范围，降低路由器资源消耗（如CPU和内存）。
      </h5>
     </li>
     <li>
      <h5>
       <strong>
        减少路由更新流量
       </strong>
       ：
       <br/>
       区域边界路由器（ABR）汇总区域间路由信息，避免全网路由条目洪泛，提升扩展性。
      </h5>
     </li>
    </ul>
    <h5>
     <strong>
      5. 优化多路访问网络
     </strong>
    </h5>
    <ul>
     <li>
      <h5>
       <strong>
        DR/BDR机制
       </strong>
       ：
       <br/>
       在以太网等多路访问网络中，选举
       <strong>
        指定路由器（DR）
        <strong>
         和
        </strong>
        备份指定路由器（BDR）
       </strong>
       ，由它们集中处理LSA洪泛，避免重复广播，减少网络开销。
      </h5>
     </li>
    </ul>
    <h5>
     <strong>
      6. 支持复杂网络需求
     </strong>
    </h5>
    <ul>
     <li>
      <h5>
       <strong>
        灵活寻址
       </strong>
       ：
       <br/>
       支持VLSM（可变长子网掩码）和CIDR（无类域间路由），适应现代IP地址规划需求。
      </h5>
     </li>
     <li>
      <h5>
       <strong>
        IPv4/IPv6双栈支持
       </strong>
       ：
       <br/>
       OSPFv2用于IPv4，OSPFv3专为IPv6设计，满足下一代网络部署需求。
      </h5>
     </li>
     <li>
      <h5>
       <strong>
        特殊区域类型
       </strong>
       ：
       <br/>
       如Stub区域、NSSA（非纯末梢区域）等，优化外部路由传播，减少不必要流量。
      </h5>
     </li>
    </ul>
    <h5>
     <strong>
      7. 高可靠性与安全性
     </strong>
    </h5>
    <ul>
     <li>
      <h5>
       <strong>
        认证机制
       </strong>
       ：
       <br/>
       支持明文或MD5/SHA认证，防止非法路由器加入OSPF域。
      </h5>
     </li>
     <li>
      <h5>
       <strong>
        冗余设计
       </strong>
       ：
       <br/>
       通过多区域划分和ECMP，提供链路冗余和路径冗余，增强网络容灾能力。
      </h5>
     </li>
    </ul>
    <h5>
     <strong>
      8. 应用场景
     </strong>
    </h5>
    <ul>
     <li>
      <h5>
       <strong>
        企业网/园区网
       </strong>
       ：
       <br/>
       动态适应频繁变化的内部网络拓扑，提供高效路由。
      </h5>
     </li>
     <li>
      <h5>
       <strong>
        数据中心
       </strong>
       ：
       <br/>
       支持大规模服务器和虚拟化环境，保障低延迟、高吞吐量。
      </h5>
     </li>
     <li>
      <h5>
       <strong>
        运营商网络
       </strong>
       ：
       <br/>
       通过分层区域设计和路由汇总，管理超大规模路由表。
      </h5>
     </li>
    </ul>
    <p>
    </p>
    <h3>
     三、实验拓扑与实验命令及步骤
    </h3>
    <p>
     <img alt="" height="206" src="https://i-blog.csdnimg.cn/direct/14befbf80e16402b8e1ee3b42e14774c.png" width="763"/>
    </p>
    <p>
     实验目的：
     <br/>
     1. 实现单区域OSPF的配置
     <br/>
     2. 描述OSPF在多路访问中
     <br/>
     邻居关系建立的过程
    </p>
    <p>
     实验步骤：
     <br/>
     1. 对路由器重命名
     <br/>
     2. 配置路由器接口IP地址
     <br/>
     3. 运行OSPF
     <br/>
     4. 查看使能OSPF的接口//
     <br/>
     display ospf interface all
     <br/>
     5. 查看当前设备邻居关系状态//
     <br/>
     display ospf peer
     <br/>
     6. 查看当前设备LSDB//
     <br/>
     display ospf lsdb
     <br/>
     7. 观察OSPF状态机迁移//
     <br/>
     terminal debugging
     <br/>
     terminal monitor
     <br/>
     debugging ospf event
     <br/>
     debugging ospf packet
    </p>
    <p>
     实验命令：
    </p>
    <blockquote>
     <p>
      R1:
     </p>
     <p>
      [Huawei]sysname AR1
      <br/>
      [AR1]int g0/0/0
      <br/>
      [AR1-GigabitEthernet0/0/0]ip address 12.1.1.1 24
      <br/>
      [AR1-GigabitEthernet0/0/0]q
      <br/>
      [AR1]int LoopBack 0
     </p>
     <p>
      [AR1-LoopBack0]ip address 1.1.1.1 24
      <br/>
      [AR1-LoopBack0]q
      <br/>
      [AR1]ospf router-id 1.1.1.1
      <br/>
      [AR1-ospf-1]area 0
      <br/>
      [AR1-ospf-1-area-0.0.0.0]network 12.1.1.0 0.0.0.255
     </p>
     <p>
      [AR1-ospf-1-area-0.0.0.0]network 1.1.1.0 0.0.0.255
     </p>
     <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
      &lt;AR1&gt;terminal debugging        //使能终端显示Debug信息功能
     </p>
     <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
      &lt;AR1&gt;terminal monitor    //使能终端显示信息中心发送信息的功能
     </p>
     <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
      &lt;AR1&gt;debugging ospf event   //用来查看OSPF协议工作过程中的所有事件
     </p>
     <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
      &lt;AR1&gt;debugging ospf packet   //用来查看OSPF协议工作过程中的所有报文
     </p>
     <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
      &lt;AR1&gt;sys
     </p>
     <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
      [AR1]int g0/0/0
     </p>
     <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
      [AR1-GigabitEthernet0/0/0]shutdown
     </p>
     <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
      [AR1-GigabitEthernet0/0/0]undo shutdown
     </p>
     <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
      [AR1-GigabitEthernet0/0/0]q
     </p>
     <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
      [AR1]info-center enable
     </p>
     <p>
      R2:
     </p>
     <p>
      [Huawei]sysname AR2
      <br/>
      [AR2]int g0/0/1
      <br/>
      [AR2-GigabitEthernet0/0/1]ip address 12.1.1.2 24
      <br/>
      [AR2-GigabitEthernet0/0/1]int g0/0/0
      <br/>
      [AR2-GigabitEthernet0/0/0]ip address 23.1.1.2 24
     </p>
     <p>
      [AR2]int LoopBack 0
     </p>
     <p>
      [AR2-LoopBack0]ip address 2.2.2.2 24
      <br/>
      [AR2-LoopBack0]q
     </p>
     <p>
      [AR2]ospf router-id 2.2.2.2
      <br/>
      [AR2-ospf-1]area 0
      <br/>
      [AR2-ospf-1-area-0.0.0.0]network 12.1.1.0 0.0.0.255
      <br/>
      [AR2-ospf-1-area-0.0.0.0]network 23.1.1.0 0.0.0.255
     </p>
     <p>
      [AR2-ospf-1-area-0.0.0.0]network 2.2.2.0 0.0.0.255
      <br/>
      [AR2-ospf-1-area-0.0.0.0]q
     </p>
     <p>
      R3：
     </p>
     <p>
      [Huawei]sysname AR3
     </p>
     <p>
      [AR3]int g0/0/1
     </p>
     <p>
      [AR3-GigabitEthernet0/0/1]ip address  23.1.1.3 24
     </p>
     <p>
      [AR3]int LoopBack 0
     </p>
     <p>
      [AR3-LoopBack0]ip address 2.2.2.2 24
      <br/>
      [AR3-LoopBack0]q
      <br/>
      [AR3]ospf router-id 3.3.3.3
      <br/>
      [AR3-ospf-1]area 0
      <br/>
      [AR3-ospf-1-area-0.0.0.0]network 23.1.1.0 0.0.0.255
     </p>
     <p>
      [AR2-ospf-1-area-0.0.0.0]network 3.3.3.0 0.0.0.255
     </p>
    </blockquote>
    <p>
     实验测试
    </p>
    <p>
     查看使能OSPF的接口
    </p>
    <p class="img-center">
     <img alt="" height="305" src="https://i-blog.csdnimg.cn/direct/ce80295c218b4b6ba3cc7595108ca783.png" width="624"/>
    </p>
    <p>
     查看当前设备邻居关系状态
    </p>
    <p class="img-center">
     <img alt="" height="244" src="https://i-blog.csdnimg.cn/direct/dad13b4958c643ed86b54c20106d6c80.png" width="558"/>
    </p>
    <p>
     查看当前设备LSDB
    </p>
    <p class="img-center">
     <img alt="" height="234" src="https://i-blog.csdnimg.cn/direct/b0fd8b4e8e964113b8c36e0dce6fa24c.png" width="620"/>
    </p>
    <h3>
     四、总结
    </h3>
    <p>
     1、OSPF通过链路状态数据库和SPF算法实现高效路由，是构建稳定、可扩展网络的理想选择。其分层设计、快速收敛和对复杂网络的支持，使其成为企业、数据中心和运营商网络中最常用的IGP协议之一
    </p>
    <p>
     2、OSPF在网络中扮演
     <strong>
      动态路由引擎
     </strong>
     的角色，通过实时同步拓扑信息、智能计算最优路径、快速响应网络变化，确保数据高效、可靠地传输。其分层设计、高扩展性和对复杂网络的支持，使其成为企业、运营商和数据中心网络的
     <strong>
      首选内部路由协议
     </strong>
     。
    </p>
   </div>
  </div>
 </article>
 <p alt="6874747073:3a2f2f626c6f672e6373646e2e6e65742f6e616e6b6f6e5f2f:61727469636c652f64657461696c732f313436303931363132" class_="artid" style="display:none">
 </p>
</div>


