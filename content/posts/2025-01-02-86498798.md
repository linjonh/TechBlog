---
layout: post
title: "前端调用接口乱码问题"
date: 2025-01-02 10:19:50 +0800
description: "1、通过乱码判断这是什么编码，方便确认出了什么错。ISO-8859-1的乱码GBK的乱码UTF-8的"
keywords: "接口乱码"
categories: ['Tomcat', 'Javascript']
tags: ['前端接口数据乱码', '前后端数据中文乱码', '中文问号', '中文乱码']
artid: "86498798"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=86498798
    alt: "前端调用接口乱码问题"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=86498798
featuredImagePreview: https://bing.ee123.net/img/rand?artid=86498798
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     前端调用接口乱码问题
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h2>
     <strong>
      1、通过乱码判断这是什么编码，方便确认出了什么错。
     </strong>
    </h2>
    <p>
     ISO-8859-1的乱码
    </p>
    <p>
     <img alt="" class="has" height="57" src="https://i-blog.csdnimg.cn/blog_migrate/974dc8c98dc2ddc9eb665ce44cd4ceac.png" width="252"/>
    </p>
    <p>
     GBK的乱码
    </p>
    <p>
     <img alt="" class="has" height="56" src="https://i-blog.csdnimg.cn/blog_migrate/c047c010e779d381e6b1db2ed95dbc17.png" width="335"/>
    </p>
    <p>
     UTF-8的乱码
    </p>
    <p>
     <img alt="" class="has" height="31" src="https://i-blog.csdnimg.cn/blog_migrate/56f15621c60655d3f29bd78dc4d649f5.png" width="316"/>
    </p>
    <p>
     显示问号
    </p>
    <p>
     <img alt="" class="has" height="48" src="https://i-blog.csdnimg.cn/blog_migrate/63653723fe3fa44bd24fb48f51110e2b.png" width="580"/>
    </p>
    <p>
    </p>
    <h2>
     <strong>
      2、分析原因
     </strong>
    </h2>
    <h4>
     1、前端html未设置charset utf-8
    </h4>
    <p>
     <img alt="" class="has" height="39" src="https://i-blog.csdnimg.cn/blog_migrate/06f4678b5e57b9a2e90293854ff278bb.png" width="319"/>
    </p>
    <h4>
     2、数据库varchar类型未设置utf8格式
    </h4>
    <p>
     <img alt="" class="has" height="98" src="https://i-blog.csdnimg.cn/blog_migrate/a716807bb319f6940a7364beddf1ab4b.png" width="672"/>
    </p>
    <h4>
     3、数据库配置未设置utf8（可能设置为了lantin）
    </h4>
    <p>
     方案：默认C盘中mysql文件夹中my.ini文件中设置 ==》 default-character-set=utf8
    </p>
    <p>
     注意：windows和linux系统默认是gbk的字符集，如果用dos命令或者终端命令形式查询出来可能中文乱码。
    </p>
    <p>
     所以最好设置为 default-character-set=gbk
    </p>
    <p>
     <img alt="" class="has" height="26" src="https://i-blog.csdnimg.cn/blog_migrate/008c6cf7e0323804a311fb0b83aa0e68.png" width="649"/>
    </p>
    <pre class="has"><code class="language-cpp"># MySQL Server Instance Configuration File
# ----------------------------------------------------------------------
# Generated by the MySQL Server Instance Configuration Wizard
#
#
# Installation Instructions
# ----------------------------------------------------------------------
#
# On Linux you can copy this file to /etc/my.cnf to set global options,
# mysql-data-dir/my.cnf to set server-specific options
# (@localstatedir@ for this installation) or to
# ~/.my.cnf to set user-specific options.
#
# On Windows you should keep this file in the installation directory 
# of your server (e.g. C:\Program Files\MySQL\MySQL Server X.Y). To
# make sure the server reads the config file use the startup option 
# "--defaults-file". 
#
# To run run the server from the command line, execute this in a 
# command line shell, e.g.
# mysqld --defaults-file="C:\Program Files\MySQL\MySQL Server X.Y\my.ini"
#
# To install the server as a Windows service manually, execute this in a 
# command line shell, e.g.
# mysqld --install MySQLXY --defaults-file="C:\Program Files\MySQL\MySQL Server X.Y\my.ini"
#
# And then execute this in a command line shell to start the server, e.g.
# net start MySQLXY
#
#
# Guildlines for editing this file
# ----------------------------------------------------------------------
#
# In this file, you can use all long options that the program supports.
# If you want to know the options a program supports, start the program
# with the "--help" option.
#
# More detailed information about the individual options can also be
# found in the manual.
#
#
# CLIENT SECTION
# ----------------------------------------------------------------------
#
# The following options will be read by MySQL client applications.
# Note that only client applications shipped by MySQL are guaranteed
# to read this section. If you want your own MySQL client program to
# honor these values, you need to specify it as an option during the
# MySQL client library initialization.
#
[client]

port=3306

[mysql]

default-character-set=utf8


# SERVER SECTION
# ----------------------------------------------------------------------
#
# The following options will be read by the MySQL Server. Make sure that
# you have installed the server correctly (see above) so it reads this 
# file.
#
[mysqld]

# The TCP/IP Port the MySQL Server will listen on
port=3306


#Path to installation directory. All paths are usually resolved relative to this.
basedir="C:/Program Files (x86)/MySQL/MySQL Server 5.0/"

#Path to the database root
datadir="C:/Program Files (x86)/MySQL/MySQL Server 5.0/Data/"

# The default character set that will be used when a new schema or table is
# created and no character set is defined
default-character-set=utf8

# The default storage engine that will be used when create new tables when
default-storage-engine=INNODB

# Set the SQL mode to strict
sql-mode="STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION"

# The maximum amount of concurrent sessions the MySQL server will
# allow. One of these connections will be reserved for a user with
# SUPER privileges to allow the administrator to login even if the
# connection limit has been reached.
max_connections=100

# Query cache is used to cache SELECT results and later return them
# without actual executing the same query once again. Having the query
# cache enabled may result in significant speed improvements, if your
# have a lot of identical queries and rarely changing tables. See the
# "Qcache_lowmem_prunes" status variable to check if the current value
# is high enough for your load.
# Note: In case your tables change very often or if your queries are
# textually different every time, the query cache may result in a
# slowdown instead of a performance improvement.
query_cache_size=15M

# The number of open tables for all threads. Increasing this value
# increases the number of file descriptors that mysqld requires.
# Therefore you have to make sure to set the amount of open files
# allowed to at least 4096 in the variable "open-files-limit" in
# section [mysqld_safe]
table_cache=256

# Maximum size for internal (in-memory) temporary tables. If a table
# grows larger than this value, it is automatically converted to disk
# based table This limitation is for a single table. There can be many
# of them.
tmp_table_size=18M


# How many threads we should keep in a cache for reuse. When a client
# disconnects, the client's threads are put in the cache if there aren't
# more than thread_cache_size threads from before.  This greatly reduces
# the amount of thread creations needed if you have a lot of new
# connections. (Normally this doesn't give a notable performance
# improvement if you have a good thread implementation.)
thread_cache_size=8

#*** MyISAM Specific options

# The maximum size of the temporary file MySQL is allowed to use while
# recreating the index (during REPAIR, ALTER TABLE or LOAD DATA INFILE.
# If the file-size would be bigger than this, the index will be created
# through the key cache (which is slower).
myisam_max_sort_file_size=100G

# If the temporary file used for fast index creation would be bigger
# than using the key cache by the amount specified here, then prefer the
# key cache method.  This is mainly used to force long character keys in
# large tables to use the slower key cache method to create the index.
myisam_sort_buffer_size=35M

# Size of the Key Buffer, used to cache index blocks for MyISAM tables.
# Do not set it larger than 30% of your available memory, as some memory
# is also required by the OS to cache rows. Even if you're not using
# MyISAM tables, you should still set it to 8-64M as it will also be
# used for internal temporary disk tables.
key_buffer_size=23M

# Size of the buffer used for doing full table scans of MyISAM tables.
# Allocated per thread, if a full scan is needed.
read_buffer_size=64K
read_rnd_buffer_size=256K

# This buffer is allocated when MySQL needs to rebuild the index in
# REPAIR, OPTIMZE, ALTER table statements as well as in LOAD DATA INFILE
# into an empty table. It is allocated per thread so be careful with
# large settings.
sort_buffer_size=256K


#*** INNODB Specific options ***


# Use this option if you have a MySQL server with InnoDB support enabled
# but you do not plan to use it. This will save memory and disk space
# and speed up some things.
#skip-innodb

# Additional memory pool that is used by InnoDB to store metadata
# information.  If InnoDB requires more memory for this purpose it will
# start to allocate it from the OS.  As this is fast enough on most
# recent operating systems, you normally do not need to change this
# value. SHOW INNODB STATUS will display the current amount used.
innodb_additional_mem_pool_size=2M

# If set to 1, InnoDB will flush (fsync) the transaction logs to the
# disk at each commit, which offers full ACID behavior. If you are
# willing to compromise this safety, and you are running small
# transactions, you may set this to 0 or 2 to reduce disk I/O to the
# logs. Value 0 means that the log is only written to the log file and
# the log file flushed to disk approximately once per second. Value 2
# means the log is written to the log file at each commit, but the log
# file is only flushed to disk approximately once per second.
innodb_flush_log_at_trx_commit=1

# The size of the buffer InnoDB uses for buffering log data. As soon as
# it is full, InnoDB will have to flush it to disk. As it is flushed
# once per second anyway, it does not make sense to have it very large
# (even with long transactions).
innodb_log_buffer_size=1M

# InnoDB, unlike MyISAM, uses a buffer pool to cache both indexes and
# row data. The bigger you set this the less disk I/O is needed to
# access data in tables. On a dedicated database server you may set this
# parameter up to 80% of the machine physical memory size. Do not set it
# too large, though, because competition of the physical memory may
# cause paging in the operating system.  Note that on 32bit systems you
# might be limited to 2-3.5G of user level memory per process, so do not
# set it too high.
innodb_buffer_pool_size=42M

# Size of each log file in a log group. You should set the combined size
# of log files to about 25%-100% of your buffer pool size to avoid
# unneeded buffer pool flush activity on log file overwrite. However,
# note that a larger logfile size will increase the time needed for the
# recovery process.
innodb_log_file_size=10M

# Number of threads allowed inside the InnoDB kernel. The optimal value
# depends highly on the application, hardware as well as the OS
# scheduler properties. A too high value may lead to thread thrashing.
innodb_thread_concurrency=10
skip-grant-tables</code></pre>
    <h4>
     4、配置tomcat安装文件夹下config中的server.xml文件中修改端口配置，设定为utf8
    </h4>
    <p>
     <img alt="" class="has" height="31" src="https://i-blog.csdnimg.cn/blog_migrate/21612f49c8e050469fcdc9eec4b4c7eb.png" width="623"/>
    </p>
    <pre class="has"><code class="language-java">&lt;Connector port="8080" protocol="HTTP/1.1" 
               connectionTimeout="20000" 
               redirectPort="8443" 
               URIEncoding="UTF-8"  
               useBodyEncodingForURI="true" /&gt;</code></pre>
    <p>
     同时在项目中的web.xml中增加如下代码
    </p>
    <pre class="has"><code class="language-java">&lt;filter&gt;
     &lt;filter-name&gt;CharacterEncoding&lt;/filter-name&gt;
     &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt;
     &lt;init-param&gt;
        &lt;param-name&gt;encoding&lt;/param-name&gt;
        &lt;param-value&gt;UTF-8&lt;/param-value&gt;
     &lt;/init-param&gt;
  &lt;/filter&gt;
  &lt;filter-mapping&gt;
     &lt;filter-name&gt;CharacterEncoding&lt;/filter-name&gt;
     &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
  &lt;/filter-mapping&gt;</code></pre>
    <p>
    </p>
    <p>
     5、依旧没有解决。在控制器中打印输出依旧显示乱码
    </p>
    <p>
     尝试将收到的参数进行转码打印输出应该就可以实现。
    </p>
    <pre class="has"><code class="language-java">String aString = new String(operationName.getBytes("ISO8859_1"),"utf-8");
		System.out.println(aString);</code></pre>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="6874:7470733a2f2f626c6f672e6373646e2e6e65742f49545f3935:2f61727469636c652f64657461696c732f3836343938373938" class_="artid" style="display:none">
 </p>
</div>


