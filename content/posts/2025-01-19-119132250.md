---
layout: post
title: "IEC60870-5-104通信协议测试方法"
date: 2025-01-19 20:25:00 +0800
description: "1 前言IEC60870-5-104规定了采用标准传输协议子集的IEC60870-5-101网络访问"
keywords: "iec60870-5-104"
categories: ['通信协议']
tags: ['网络通信', '测试工具', '功能测试']
artid: "119132250"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=119132250
    alt: "IEC60870-5-104通信协议测试方法"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=119132250
featuredImagePreview: https://bing.ee123.net/img/rand?artid=119132250
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     IEC60870-5-104通信协议测试方法
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h4>
     1 前言
    </h4>
    <p>
     IEC60870-5-104规定了采用标准传输协议子集的IEC60870-5-101网络访问。IEC60870-5-101基本远动任务通信规约提供了在主站和远动子站之间发送基本远动报文的通信文件集, 在主站和每个远动子站之间是采用固定连接的数据电路，用于厂站与调度主站间通讯。相关的国家标准有DL/T634.5104-2002通信协议。
     <br/>
     本文将以DL/T634.5104-2002通信协议为基础，介绍如何使用
     <strong>
      格西调试精灵（原格西烽火）
     </strong>
     通信测试软件进行编写测试项目，进行测试符合DL/T634.5104-2002通信协议的设备。
    </p>
    <h4>
     2 通信协议
    </h4>
    <p>
     2.1 术语
    </p>
    <p>
     <strong>
      信息对象组（group of information object）
     </strong>
     <br/>
     一个信息对象的组是公共地址或信息地址一个集。
    </p>
    <p>
     <strong>
      控制方向control direction
     </strong>
     <br/>
     从控制站(主站)到被控站(子站)的传输方向。
    </p>
    <p>
     <strong>
      监视方向monitoring direction
     </strong>
     <br/>
     从被控站(子站)到控制站(主站)的传输方向。
    </p>
    <p>
     2.2 通信接口
    </p>
    <p>
     支持以太网接口，支持多点连接，支持TCP/IP协议，保留2404端口访问。
    </p>
    <p>
     2.3 应用层
    </p>
    <p>
     DL/T634.5104-2002通信协议定义了
     <br/>
     应用规约数据单元：APDU（Application protocal data unit）
     <br/>
     应用规约控制信息：APCI（Application protocal control information）
     <br/>
     应用服务数据单元：ASDU（Application service data unit）
     <br/>
     三个部分的关系为APDU=APCI + ASDU。
    </p>
    <p>
     2.3.1 帧格式
    </p>
    <p>
     帧是传送信息的基本单元。应用规约数据单元APDU格式如下图所示。
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/583824d431438134ba1e8edbdffd6190.png"/>
    </p>
    <p>
     说明：
     <br/>
     1）长度规范：报文最大长度255字节，应用规约数据单元的最大长度为253字节，控制域的长度是4字节，应用服务数据单元的最大长度为249字节。
     <br/>
     2）控制域：控制域定义抗报文丢失和重复传送的控制信息、报文传输的启动和停止、传输连接的监视。控制域的这些类型被用于完成计数的信息传输的（I格式）、计数的监视功能（S格式）和不计数控制功能（U格式）。
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/4bba13e2b56dcac0273ded87952f8949.png"/>
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/107a23830ed0608675dd15ac7dff5c40.png"/>
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/5c97aed8d278dbd7cd2fd117f4a3ed65.png"/>
    </p>
    <p>
     2.3.2 控制域
    </p>
    <p>
     控制域定义抗报文丢失和重复传送的控制信息、报文传输的启动和停止、传输连接的监视。控制域的这些类型被用于完成计数的信息传输的（I格式）、计数的监视功能（S格式）和不计数控制功能（U格式）。
    </p>
    <p>
     2.3.3 应用服务数据单元ASDU
    </p>
    <p>
     标准规定每一个应用规约数据单元（APDU）只有一个应用服务数据单元（ASDU）。应用服务数据单元由数据单元标识符和一个或多个信息体所组成。数据单元标识符在所有应用服务数据单元中常有相同的结构，一个应用服务数据单元中的信息体常有相同的结构和类型，它们由类型标识域所定义。
     <br/>
     ASDU结构如下图所示。
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/7694ea67db03084ca3606a7a53bf495b.png"/>
    </p>
    <p>
     ASDU类型标识1字节，在主站侧表示的是主站召唤的数据类型，在子站侧表示的是子站上传的信息元素的类型。
     <br/>
     信息对象地址分配如下：
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/52b45e07297ffcf2c42dd87a5b71584c.png"/>
    </p>
    <p>
     2.3.4 规约交互过程
    </p>
    <p>
     当主站软件重新启动或链路故障时，主站将向子站发出建立链路的请求报文。当链路建立后，主站召唤一次全数据，随后定时召唤全数据，子站主动传送变化数据。主站收到数据帧后发送数据确认帧。
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/9d9cd0472ead86c8c29b99e78e16e1c6.png"/>
    </p>
    <h4>
     3 测试项目编制
    </h4>
    <p>
     3.1 基本协议编制
    </p>
    <p>
     3.1.1 协议项分类
    </p>
    <p>
     利用格西调试精灵软件的协议激励的功能，把DL/T634.5104-2002通信规约按照树形结构分类组织，使得管理上更加有条理，查找也更加方便。
     <br/>
     首先，根据DL/T634.5104-2002通信协议的控制功能码，建立命令模版协议集，作为基本规约模版使用。
     <br/>
     然后，根据ASDU类型标识编码表进行协议分类，建立基本命令集。一条命令由数条子命令构成，命令的执行是一个数个回合的交互过程。
     <br/>
     按照树形结构分类组织的规约项目结构如图所示。
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/b5f7f699997c0c320d8d144a700e4546.png"/>
    </p>
    <p>
     3.1.2 协议项编制
    </p>
    <p>
     根据协议帧格式，为了方便控制和显示，把协议项的数据按照功能进行拆分。
     <br/>
     例子1：命令模版的“对时”命令编制方法。
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/6b5a7c7f732575214950472d8174d2ea.png"/>
    </p>
    <p>
     主站请求帧
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/eb1a67a73702b1ad5375d7117d33bf70.png"/>
    </p>
    <p>
     从站应答帧
    </p>
    <p>
     基本命令集的命令是由子命令构成的，子命令从命令模版中引用并作修改。
    </p>
    <p>
     基本命令的“总召唤”命令编制方法。
     <br/>
     首先，创建一个协议集，命名为“总召唤”；
     <br/>
     其次，通过复制和粘贴功能，从命令模版中把对应命令复制到协议集“总召唤”中，实际运行测试用例，需要根据返回帧的数量调整接收数据的接收次数。
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/72cda83434636bf051feaa59e32fb22f.png"/>
    </p>
    <p>
     3.1.3 公共协议库
    </p>
    <p>
     通过对基本协议项的编写、测试和验证，建立一个由基本协议项组成的公共协议库。
    </p>
    <p>
     3.2 测试用例编制
    </p>
    <p>
     测试用例（Test Case）是为某个特殊目标而编制的一组测试输入、执行条件以及预期结果，以便测试某个程序路径或核实是否满足某个特定需求。通信协议测试属于黑盒测试，可以采用黑盒测试常用的等价类划分法、边界值分析法、错误推测法、因果图法等基本方法来设计测试用例。
    </p>
    <p>
     测试方案设计完成后，格西调试精灵软件能够利用编制完成的公共协议库，采用搭积木的方式，通过复制和粘贴命令即可非常快捷的创建测试用例。测试用例的组织方式通常是根据测试方案的设计层次采用树形结构分类组织。
    </p>
    <h4>
     4 测试方法
    </h4>
    <p>
     4.1 测试系统构成
    </p>
    <p style="text-align:center;">
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/3e7f02d9043050bf17724542b62a23bf.png"/>
    </p>
    <p>
     4.2 单项测试与整体测试
    </p>
    <p>
     格西调试精灵软件支持单项测试和整体测试，一次测试一个测试项或者整个测试集。执行的方法是选中需要测试的测试项或者测试集，然后执行激励命令即可。
     <br/>
     下面以执行“总召唤”测试项为例说明。
    </p>
    <p style="text-align:center;">
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/4e999aba29b7b4c51448935fdc5c36fe.png"/>
    </p>
    <p>
     协议数据解析界面
    </p>
    <p style="text-align:center;">
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/5e1eead825ff70c261f7998381b13bd3.png"/>
    </p>
    <p>
     协议激励报告界面
    </p>
    <p>
     4.3 单次测试与循环测试
    </p>
    <p>
     格西调试精灵软件支持单次测试和循环测试，能很好满足各种调试测试和性能测试的需求。执行的方法是选中需要测试的测试项或者测试集，然后执行激励或循环激励命令即可。
    </p>
    <p style="text-align:center;">
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/7777d77bab526473199468a29a2a64e5.png"/>
    </p>
    <p>
     <strong>
      <span style="color:#fe2c24;">
      </span>
      <a href="http://www.geshe.com/home/solutions/PowerElectronics/Projects/zh-CN.GBeacon_Power_IEC60870-5-104_Demo.rar" rel="nofollow">
       <span style="color:#fe2c24;">
        示例下载
       </span>
      </a>
     </strong>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f67657368656d61737465722f:61727469636c652f64657461696c732f313139313332323530" class_="artid" style="display:none">
 </p>
</div>


