---
layout: post
title: "EG边缘计算网关连接阿里云物联网平台MQTT协议"
date: 2024-09-09 11:30:08 +0800
description: "通过EG边缘计算网关连接阿里云物联网平台，用户可以实现工业设备的数据采集、远程管理和云端监控。这一架"
keywords: "eg800k连接阿里云"
categories: ['边缘计算网关', '物联网', '工业网关']
tags: ['阿里云', '边缘计算', '物联网']
artid: "142054407"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=142054407
    alt: "EG边缘计算网关连接阿里云物联网平台MQTT协议"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=142054407
featuredImagePreview: https://bing.ee123.net/img/rand?artid=142054407
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     EG边缘计算网关连接阿里云物联网平台（MQTT协议）
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     上文：
     <a href="https://blog.csdn.net/zonghengzhikong/article/details/141956421?spm=1001.2014.3001.5501" title="EG边缘计算网关连接华为云物联网平台（MQTT协议）​​​​​​">
      EG边缘计算网关连接华为云物联网平台（MQTT协议）​​​​​​
     </a>
    </p>
    <h3 id="trkZr">
     需求概述
    </h3>
    <p id="u1b92418b">
     本章节主要实现一个流程：EG8200采集Modbus RTU数据，通过MQTT协议连接阿里云物联网平台（使用第三方阿里云节点实现）。
    </p>
    <p id="u5f10077c">
     Modbus RTU采集此处不做过多赘述，可参考其他案例（
     <a href="https://iotrouter.yuque.com/org-wiki-iotrouter-rlzwv5/eg8000/dcg93lzw7bgvwx02" rel="nofollow" title="串口读取Modbus传感器数据">
      串口读取Modbus传感器数据
     </a>
     ）介绍。下文默认已经采集到Modbus RTU数据。
    </p>
    <p id="u010b6fa0">
     要采集的Modbus点位表：
    </p>
    <table id="eVa1N">
     <tbody>
      <tr>
       <td>
        <p id="u282b78ca">
         地址(Doc)
        </p>
       </td>
       <td>
        <p id="uca4c03ed">
         数据类型
        </p>
       </td>
       <td>
        <p id="u25fd70fd">
         属性
        </p>
       </td>
       <td>
        <p id="uf290f0c2">
         名称
        </p>
       </td>
      </tr>
      <tr>
       <td>
        <p id="uf6ed27d4">
         00001
        </p>
       </td>
       <td>
        <p id="u33bbc3f7">
         Boolean
        </p>
       </td>
       <td>
        <p id="ub74544ab">
         读写
        </p>
       </td>
       <td>
        <p id="u2b7a07ad">
         MotorControl1
        </p>
       </td>
      </tr>
      <tr>
       <td>
        <p id="ufa6259e7">
         00002
        </p>
       </td>
       <td>
        <p id="u28339ddf">
         Uint16
        </p>
       </td>
       <td>
        <p id="u2c5a6bf5">
         读写
        </p>
       </td>
       <td>
        <p id="u7bfeddd6">
         MotorControl2
        </p>
       </td>
      </tr>
      <tr>
       <td>
        <p id="u0a77b294">
         40001
        </p>
       </td>
       <td>
        <p id="uf93fc1b0">
         Uint16
        </p>
       </td>
       <td>
        <p id="uc2504f7a">
         读写
        </p>
       </td>
       <td>
        <p id="u97242dd3">
         Requency1
        </p>
       </td>
      </tr>
      <tr>
       <td>
        <p id="u06b0a073">
         40002
        </p>
       </td>
       <td>
        <p id="u68df775c">
         Uint16
        </p>
       </td>
       <td>
        <p id="u53eea2db">
         读写
        </p>
       </td>
       <td>
        <p id="u528f31c6">
         Requency2
        </p>
       </td>
      </tr>
     </tbody>
    </table>
    <h3 id="g0jHQ">
     需求分析
    </h3>
    <p id="u3b95ef7a">
     网关配置：
    </p>
    <p id="u962a878e">
     第一步：采集Modbus RTU数据
    </p>
    <p id="uad24853c">
     第二步：安装第三方阿里云节点
    </p>
    <p id="ufb86eded">
     第三步：MQTT上报
    </p>
    <p id="u5e972e93">
     第四步：下行写Modbus RTU
    </p>
    <p id="u168af510">
     平台配置：
    </p>
    <p id="uda78e6b0">
     第一步：添加产品
    </p>
    <p id="u0f17d7b8">
     第二步：添加设备
    </p>
    <p id="uc3e5ba98">
     第三步：添加物模型
    </p>
    <p id="u0ee0f7b4">
     第四步：数据展示
    </p>
    <p id="u720808a5">
     第五步：下发写数据演示
    </p>
    <h3 id="dYZgu">
     需求实现
    </h3>
    <h4 id="ViIAn">
     网关配置
    </h4>
    <h5 id="a1ND0">
     第一步：采集多个PLC的数据
    </h5>
    <p id="u8a97b590">
     此处为采集Modbus RTU数据，不在过多赘述，可参考其他案例。采集到Modbus RTU的流程如下：
    </p>
    <p>
     此处为语雀内容卡片，点击链接查看：
     <a href="https://iotrouter.yuque.com/org-wiki-iotrouter-rlzwv5/eg8000/dcg93lzw7bgvwx02" rel="nofollow" title="Modbus RTU 读数据 · IOTRouter">
      Modbus RTU 读数据 · IOTRouter
     </a>
    </p>
    <p id="u235c2611">
    </p>
    <p class="img-center">
     <img alt="" height="951" id="u805ee846" src="https://img-blog.csdnimg.cn/img_convert/5df963e40b65fd8e281a1a796f747e98.png" width="1200"/>
    </p>
    <h5 id="CQjVN">
     第二步：安装第三方阿里云节点
    </h5>
    <p id="u5edfbc9d">
     节点名称：node-red-contrib-alibabacloud
    </p>
    <p id="u8f5204be">
     点击安装后等待安装成功（注意：网关需要成功连网络才能安装节点）
    </p>
    <p id="ue96458b9">
    </p>
    <p class="img-center">
     <img alt="" height="939" id="u563b1c0b" src="https://img-blog.csdnimg.cn/img_convert/da8e8a415b0f9fed8e6bccb1b85974d7.gif" width="1200"/>
    </p>
    <p id="ueb0c24ed">
     安装成功后节点库会出现刚才安装的节点：
    </p>
    <p id="u5aceec13">
    </p>
    <p class="img-center">
     <img alt="" height="952" id="u9f67bcb0" src="https://img-blog.csdnimg.cn/img_convert/9d13adac4eaa8308f190849518e62f70.png" width="1200"/>
    </p>
    <h5 id="ykpCy">
     第三步：MQTT上报
    </h5>
    <p id="u06270e13">
     使用
     <code>
      属性上报
     </code>
     节点，参考平台配置
     <a href="%E7%AC%AC%E4%B8%89%E6%AD%A5%EF%BC%9A%E6%BF%80%E6%B4%BB%E8%AE%BE%E5%A4%87" rel="nofollow">
      第三步
     </a>
     的内容填写MQTT链接信息：
    </p>
    <p id="u4099709b">
     设备名称：阿里云三要素之一 deviceName
    </p>
    <p id="u454947d9">
     设备实例所在区域：cn-shanghai
    </p>
    <p id="u81981e66">
     productKey：阿里云三要素之一 productKey
    </p>
    <p id="u59710ae3">
     deviceSecret：阿里云三要素之一 deviceSecret
    </p>
    <p id="u9acac014">
    </p>
    <p class="img-center">
     <img alt="" height="939" id="u2533ddfe" src="https://img-blog.csdnimg.cn/img_convert/0694f12a234dd5d72c94bbf9023b671a.gif" width="1200"/>
    </p>
    <h5 id="sILHT">
     第四步：下行写Modbus RTU
    </h5>
    <p id="uac55cfc6">
     使用
     <code>
      属性设置
     </code>
     节点接收下行指令，使用
     <code>
      函数节点
     </code>
     将阿里云物联网平台下行的Json格式转换为Modbus格式，
     <code>
      queue
     </code>
     节点限制数据的发送频率（200ms一次，防止发送过快导致粘包），
     <code>
      Modbus写
     </code>
     节点用于向从机写入数据，演示请参考平台配置
     <a href="%E7%AC%AC%E5%85%AD%E6%AD%A5%EF%BC%9A%E4%B8%8B%E5%8F%91%E5%86%99%E6%95%B0%E6%8D%AE" rel="nofollow">
      第六步
     </a>
     ：
    </p>
    <p id="u134ceeae">
    </p>
    <p class="img-center">
     <img alt="" height="956" id="uc9d55e88" src="https://img-blog.csdnimg.cn/img_convert/6acaaf6a1bbdc5004459baac18fe3ae5.png" width="1200"/>
    </p>
    <h4 id="jYAUC">
     平台配置
    </h4>
    <h5 id="hfqtJ">
     第一步：添加产品
    </h5>
    <p id="u990af8ca">
     进入阿里云物联网平台：
    </p>
    <p id="u87c9b88b">
     设备管理-&gt;产品-&gt;创建产品
    </p>
    <p id="u4ff30980">
     产品名称：自定义
    </p>
    <p id="u0ce7ada8">
     所属类型：标准品类（根据自己实际使用类型来选择）
    </p>
    <p id="u69b917ba">
     节点类型：直连设备
    </p>
    <p id="uf6d63482">
     联网方式：蜂窝
    </p>
    <p id="ub8cf8ed6">
     数据格式：Alink JSON
    </p>
    <p id="u0d07d986">
     其他默认：
    </p>
    <p id="u242ef13d">
    </p>
    <p class="img-center">
     <img alt="" height="939" id="u5e14a728" src="https://img-blog.csdnimg.cn/img_convert/36436d26d0a3e19dcb85ddb8cb1e25a9.gif" width="1200"/>
    </p>
    <h5 id="HlnDn">
     第二步：添加设备
    </h5>
    <p id="uf86a3efe">
     设备管理-&gt;设备-&gt;添加设备：
    </p>
    <p id="ub81936a9">
     产品：现在第一步创建的产品
    </p>
    <p id="u8371911c">
     DeviceName：自定义填入(这里使用网关SN)
    </p>
    <p id="ua8f112c0">
     备注名称：自定义
    </p>
    <p id="u37b27599">
    </p>
    <p class="img-center">
     <img alt="" height="939" id="uef4a85b2" src="https://img-blog.csdnimg.cn/img_convert/16b26a1448f0750bff45e0e4762187f5.gif" width="1200"/>
    </p>
    <h5 id="YiQIl">
     第三步：激活设备
    </h5>
    <p id="u2c7af2f4">
     设备管理-&gt;设备-&gt;查看：
    </p>
    <p id="uea92c7c1">
    </p>
    <p class="img-center">
     <img alt="" height="939" id="u10e05afa" src="https://img-blog.csdnimg.cn/img_convert/9e645a9166d2b23e7c9f1961a5d65aa6.gif" width="1200"/>
    </p>
    <p id="u3a558cc1">
     将三要素填入
     <code>
      阿里云属性上报节点
     </code>
     ，详见网关配置第三步：
    </p>
    <p id="ubc07ed3b">
    </p>
    <p class="img-center">
     <img alt="" height="865" id="u0a1e5b24" src="https://img-blog.csdnimg.cn/img_convert/cbc7a15e06174ec1a5d9b54164f769a9.png" width="1200"/>
    </p>
    <p id="udbaa53b0">
     此时可以看到设备已经在线：
    </p>
    <p id="u026fca00">
    </p>
    <p class="img-center">
     <img alt="" height="910" id="u3fc9d627" src="https://img-blog.csdnimg.cn/img_convert/f5210ec7b604760ee5d88d7eb5a4d998.png" width="1200"/>
    </p>
    <h5 id="F3QpK">
     第四步：添加物模型
    </h5>
    <p id="u2be8eafa">
     设备管理-&gt;产品-&gt;产看-&gt;功能定义
    </p>
    <p id="u6cf7c5e1">
     前往编辑草稿-&gt;添加自定义功能
    </p>
    <p id="uab44148f">
     功能名称：自定义
    </p>
    <p id="u8de79e5a">
     标识符：数据上报的Key名相同
    </p>
    <p id="udafe94bd">
     类型：根据自己的类型选择
    </p>
    <p id="ua3484751">
    </p>
    <p class="img-center">
     <img alt="" height="939" id="u2fb42a20" src="https://img-blog.csdnimg.cn/img_convert/30f9ff7f7d049dc0eceb90e1368156e3.gif" width="1200"/>
    </p>
    <p id="u099eb5d0">
     添加完成后点击发布：
    </p>
    <p id="u53e08e82">
    </p>
    <p class="img-center">
     <img alt="" height="903" id="ufd0a9d00" src="https://img-blog.csdnimg.cn/img_convert/f658bc8e0b471f97b73d05e327b3a237.png" width="1200"/>
    </p>
    <h5 id="Oaa4S">
     第五步：数据展示
    </h5>
    <p id="uc5984d7b">
     设备管理-&gt;设备-&gt;查看-&gt;物模型数据：
    </p>
    <p id="u383f2c39">
     网关触发数据发送，可以看到阿里云物联网平台物模型数据更新：
    </p>
    <p id="ufbe50cea">
    </p>
    <p class="img-center">
     <img alt="" height="951" id="u71c2f547" src="https://img-blog.csdnimg.cn/img_convert/8752a2d197dca67b48401c368c3ca24d.png" width="1200"/>
    </p>
    <h5 id="oeX0M">
     第六步：下发写数据
    </h5>
    <p id="u2b34167b">
     向两个开关发送闭合指令，两个发送频率分别为50和60。从设备端可以看见节点返回了true即表示写入成功，同时阿里云物联网平台监控界面数据也同步发生变化：
    </p>
    <p class="img-center">
     <img alt="" height="939" id="u3b9f2629" src="https://img-blog.csdnimg.cn/img_convert/290443d0f3959b9898e1153ba440eeb7.gif" width="1200"/>
    </p>
    <h3 id="Wt68D">
     总结
    </h3>
    <p id="ubad6860b">
     通过EG边缘计算网关连接阿里云物联网平台，用户可以实现工业设备的数据采集、远程管理和云端监控。这一架构结合了边缘计算和云端平台的优势，既可以在本地进行数据处理和预处理，又能通过阿里云物联网平台实现大规模设备管理和智能分析。随着物联网的不断发展，EG网关与阿里云的结合将为工业自动化、智慧城市等领域提供强大的技术支撑。
    </p>
    <p>
     更多了解：
     <a href="https://www.iotrouter.com" rel="nofollow" title="成都纵横智控">
      成都纵横智控
     </a>
    </p>
   </div>
  </div>
  <div class="blog-extension-box" id="blogExtensionBox" style="width:400px;margin:auto;margin-top:12px">
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f7a6f6e6768656e677a68696b6f6e672f:61727469636c652f64657461696c732f313432303534343037" class_="artid" style="display:none">
 </p>
</div>


