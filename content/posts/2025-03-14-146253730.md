---
layout: post
title: "LLaMA-Factory-训练数据默认使用-instructioninputoutput-三个-key"
date: 2025-03-14 11:45:14 +0800
description: "LLaMA-Factory 训练数据默认使用 instruction、input、output 三个 key。✅ 确保 JSON 格式正确，否则模型无法正确学习。✅ 如果要自定义 key，建议修改 LLaMA-Factory 的代码（不推荐），或保持默认格式。✅ 数据结构要根据任务类型调整，比如：问答、闲聊：instruction + output翻译任务：instruction + input + output代码生成：instruction + output文本摘要：instructio"
keywords: "LLaMA-Factory 训练数据默认使用 instruction、input、output 三个 key"
categories: ['模型微调']
tags: ['大模型微调', '人工智能', 'Llama']
artid: "146253730"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146253730
    alt: "LLaMA-Factory-训练数据默认使用-instructioninputoutput-三个-key"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146253730
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146253730
cover: https://bing.ee123.net/img/rand?artid=146253730
image: https://bing.ee123.net/img/rand?artid=146253730
img: https://bing.ee123.net/img/rand?artid=146253730
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     LLaMA-Factory 训练数据默认使用 instruction、input、output 三个 key
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     在 LLaMA-Factory 进行 SFT（Directive supervision fine-tuning 指令监督微调）时，
     <strong>
      训练数据的格式
     </strong>
     非常重要，因为大模型依赖标准化的数据结构来学习
     <strong>
      指令-响应
     </strong>
     模式。
    </p>
    <p>
     <code>
      identity.json
     </code>
     文件的数据采用了
     <strong>
      “instruction”、“input”、“output”
     </strong>
     这三个 key，它们的作用如下：
    </p>
    <table>
     <thead>
      <tr>
       <th>
        <strong>
         Key
        </strong>
       </th>
       <th>
        <strong>
         作用
        </strong>
       </th>
       <th>
        <strong>
         示例
        </strong>
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <strong>
         “instruction”
        </strong>
       </td>
       <td>
        代表用户给 AI 的指令（问题或任务描述）。
       </td>
       <td>
        <code>
         "instruction": "Who are you?"
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         “input”
        </strong>
       </td>
       <td>
        可选，表示提供给 AI 的额外输入信息。
       </td>
       <td>
        <code>
         "input": ""
        </code>
        （如果不需要额外输入，可以留空）
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         “output”
        </strong>
       </td>
       <td>
        期望 AI 生成的回答（AI 的理想输出）。
       </td>
       <td>
        <code>
         "output": "I am {
         <!-- -->
         {name}}, an AI assistant developed by {
         <!-- -->
         {author}}."
        </code>
       </td>
      </tr>
     </tbody>
    </table>
    <hr/>
    <h3>
     <a id="1_LLaMAFactory__12">
     </a>
     <strong>
      1. LLaMA-Factory 训练数据的格式要求
     </strong>
    </h3>
    <p>
     如果你要换用自己的数据集，格式应该符合
     <strong>
      以下 JSON 结构
     </strong>
     ：
    </p>
    <p>
     identity.json文件
    </p>
    <pre><code class="prism language-json"><span class="token punctuation">[</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"instruction"</span><span class="token operator">:</span> <span class="token string">"请介绍一下你自己。"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"input"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
    <span class="token string-property property">"output"</span><span class="token operator">:</span> <span class="token string">"我是Llama-Chinese，由LLaMA Factory开发。我可以帮助您回答问题、提供信息和进行对话。"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"instruction"</span><span class="token operator">:</span> <span class="token string">"翻译下面的句子："</span><span class="token punctuation">,</span>
    <span class="token string-property property">"input"</span><span class="token operator">:</span> <span class="token string">"Hello, how are you?"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"output"</span><span class="token operator">:</span> <span class="token string">"你好，你怎么样？"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"instruction"</span><span class="token operator">:</span> <span class="token string">"请用Python写一个计算斐波那契数列的函数。"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"input"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
    <span class="token string-property property">"output"</span><span class="token operator">:</span> <span class="token string">"```python\ndef fibonacci(n):\n    if n &lt;= 1:\n        return n\n    return fibonacci(n-1) + fibonacci(n-2)\n```"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre>
    <h4>
     <a id="_35">
     </a>
     <strong>
      格式要求
     </strong>
    </h4>
    <ol>
     <li>
      <strong>
       JSON 格式的数组
      </strong>
      ，每个数据点是一个字典
      <code>
       {}
      </code>
      。
     </li>
     <li>
      <strong>
       必须包含
       <code>
        instruction
       </code>
       和
       <code>
        output
       </code>
      </strong>
      ，
      <code>
       input
      </code>
      可选。
     </li>
     <li>
      <strong>
       <code>
        instruction
       </code>
       是给 AI 的指令，
       <code>
        output
       </code>
       是期望的 AI 输出
      </strong>
      。
     </li>
     <li>
      <strong>
       <code>
        input
       </code>
       只有在额外信息需要提供时才填
      </strong>
      （例如机器翻译任务）。
     </li>
    </ol>
    <hr/>
    <h3>
     <a id="2__key_43">
     </a>
     <strong>
      2. 你可以使用哪些 key？如何让大模型正确学习？
     </strong>
    </h3>
    <h4>
     <a id="1__44">
     </a>
     <strong>
      (1) 基础的三元结构
     </strong>
    </h4>
    <ul>
     <li>
      <strong>
       最通用的格式
      </strong>
      ：
      <pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"instruction"</span><span class="token operator">:</span> <span class="token string">"请翻译这句话："</span><span class="token punctuation">,</span>
  <span class="token string-property property">"input"</span><span class="token operator">:</span> <span class="token string">"The weather is great today."</span><span class="token punctuation">,</span>
  <span class="token string-property property">"output"</span><span class="token operator">:</span> <span class="token string">"今天天气很好。"</span>
<span class="token punctuation">}</span>
</code></pre>
     </li>
     <li>
      适用于：
      <strong>
       对话数据、翻译、问答任务
      </strong>
      。
     </li>
    </ul>
    <hr/>
    <h4>
     <a id="2__instruction__output_57">
     </a>
     <strong>
      (2) 只有
      <code>
       instruction
      </code>
      和
      <code>
       output
      </code>
     </strong>
    </h4>
    <ul>
     <li>
      如果任务不需要额外输入，可以省略
      <code>
       input
      </code>
      ：
      <pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"instruction"</span><span class="token operator">:</span> <span class="token string">"写一个Python函数，计算平方数。"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"output"</span><span class="token operator">:</span> <span class="token string">"```python\ndef square(x):\n    return x * x\n```"</span>
<span class="token punctuation">}</span>
</code></pre>
     </li>
     <li>
      适用于：
      <strong>
       代码生成、开放性问题、一般问答任务
      </strong>
      。
     </li>
    </ul>
    <hr/>
    <h4>
     <a id="3__input__output_69">
     </a>
     <strong>
      (3) 只有
      <code>
       input
      </code>
      和
      <code>
       output
      </code>
      （极少数情况）
     </strong>
    </h4>
    <ul>
     <li>
      某些任务
      <code>
       instruction
      </code>
      可以省略：
      <pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"input"</span><span class="token operator">:</span> <span class="token string">"What is the capital of France?"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"output"</span><span class="token operator">:</span> <span class="token string">"Paris"</span>
<span class="token punctuation">}</span>
</code></pre>
     </li>
     <li>
      适用于：
      <strong>
       部分问答任务、无明确指令的情况
      </strong>
      。
     </li>
     <li>
      但在 LLaMA-Factory 里，
      <strong>
       通常
       <code>
        instruction
       </code>
       是必须的
      </strong>
      ，所以不建议这么做。
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="3__key_82">
     </a>
     <strong>
      3. 如何自定义数据集 key？
     </strong>
    </h3>
    <p>
     如果你想改 key 的名字，比如你想用
     <code>
      "query"
     </code>
     代替
     <code>
      "instruction"
     </code>
     ，那你需要
     <strong>
      在
      <code>
       LLaMA-Factory
      </code>
      里修改解析代码
     </strong>
     ，否则模型不会正确识别你的数据。
    </p>
    <p>
     但
     <strong>
      最简单的做法
     </strong>
     是
     <strong>
      保持
      <code>
       instruction
      </code>
      、
      <code>
       input
      </code>
      、
      <code>
       output
      </code>
      这三个 key
     </strong>
     ，因为 LLaMA-Factory 默认支持这种格式，不需要额外修改代码。
    </p>
    <hr/>
    <h3>
     <a id="4__89">
     </a>
     <strong>
      4. 如何确认你的数据格式正确？
     </strong>
    </h3>
    <p>
     在
     <strong>
      训练之前
     </strong>
     ，可以用 Python 代码检查 JSON 格式：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> json

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"your_dataset.json"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    dataset <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>f<span class="token punctuation">)</span>

<span class="token keyword">for</span> sample <span class="token keyword">in</span> dataset<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">:</span>  <span class="token comment"># 只检查前3条数据</span>
    <span class="token keyword">assert</span> <span class="token string">"instruction"</span> <span class="token keyword">in</span> sample<span class="token punctuation">,</span> <span class="token string">"数据缺少 instruction 字段"</span>
    <span class="token keyword">assert</span> <span class="token string">"output"</span> <span class="token keyword">in</span> sample<span class="token punctuation">,</span> <span class="token string">"数据缺少 output 字段"</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>sample<span class="token punctuation">)</span>
</code></pre>
    <p>
     如果没有报错，说明格式正确。
    </p>
    <hr/>
    <h3>
     <a id="5__106">
     </a>
     <strong>
      5. 其他数据格式示例
     </strong>
    </h3>
    <h4>
     <a id="1__107">
     </a>
     <strong>
      (1) 翻译任务
     </strong>
    </h4>
    <pre><code class="prism language-json"><span class="token punctuation">[</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"instruction"</span><span class="token operator">:</span> <span class="token string">"请把以下文本翻译成法语。"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"input"</span><span class="token operator">:</span> <span class="token string">"Hello, how are you?"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"output"</span><span class="token operator">:</span> <span class="token string">"Bonjour, comment ça va?"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre>
    <p>
     适用于
     <strong>
      机器翻译微调
     </strong>
     。
    </p>
    <hr/>
    <h4>
     <a id="2__121">
     </a>
     <strong>
      (2) 代码生成任务
     </strong>
    </h4>
    <pre><code class="prism language-json"><span class="token punctuation">[</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"instruction"</span><span class="token operator">:</span> <span class="token string">"写一个 Python 函数，判断一个数是否是素数。"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"input"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
    <span class="token string-property property">"output"</span><span class="token operator">:</span> <span class="token string">"```python\ndef is_prime(n):\n    if n &lt; 2:\n        return False\n    for i in range(2, int(n ** 0.5) + 1):\n        if n % i == 0:\n            return False\n    return True```"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre>
    <p>
     适用于
     <strong>
      代码生成模型微调
     </strong>
     。
    </p>
    <hr/>
    <h4>
     <a id="3__135">
     </a>
     <strong>
      (3) 文本摘要任务
     </strong>
    </h4>
    <pre><code class="prism language-json"><span class="token punctuation">[</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"instruction"</span><span class="token operator">:</span> <span class="token string">"请总结以下文章的主要内容。"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"input"</span><span class="token operator">:</span> <span class="token string">"最近人工智能技术取得了重大突破，许多公司开始投入大规模模型的研究。"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"output"</span><span class="token operator">:</span> <span class="token string">"人工智能技术发展迅速，公司纷纷加大对大模型的投入。"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre>
    <p>
     适用于
     <strong>
      文本摘要微调
     </strong>
     。
    </p>
    <hr/>
    <h3>
     <a id="6__149">
     </a>
     <strong>
      6. 总结
     </strong>
    </h3>
    <p>
     ✅
     <strong>
      LLaMA-Factory 训练数据默认使用
      <code>
       instruction
      </code>
      、
      <code>
       input
      </code>
      、
      <code>
       output
      </code>
      三个 key
     </strong>
     。
     <br/>
     ✅
     <strong>
      确保 JSON 格式正确，否则模型无法正确学习
     </strong>
     。
     <br/>
     ✅
     <strong>
      如果要自定义 key，建议修改 LLaMA-Factory 的代码（不推荐）
     </strong>
     ，或保持默认格式。
     <br/>
     ✅
     <strong>
      数据结构要根据任务类型调整
     </strong>
     ，比如：
    </p>
    <ul>
     <li>
      问答、闲聊：
      <code>
       instruction
      </code>
      +
      <code>
       output
      </code>
     </li>
     <li>
      翻译任务：
      <code>
       instruction
      </code>
      +
      <code>
       input
      </code>
      +
      <code>
       output
      </code>
     </li>
     <li>
      代码生成：
      <code>
       instruction
      </code>
      +
      <code>
       output
      </code>
     </li>
     <li>
      文本摘要：
      <code>
       instruction
      </code>
      +
      <code>
       input
      </code>
      +
      <code>
       output
      </code>
     </li>
    </ul>
    <p>
     💡
     <strong>
      结论：如果你想换数据集，只需要用
      <code>
       instruction
      </code>
      、
      <code>
       input
      </code>
      、
      <code>
       output
      </code>
      结构组织数据，并替换内容，就可以直接用于 LLaMA-Factory 训练！
     </strong>
     🚀
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f753031333536353133332f:61727469636c652f64657461696c732f313436323533373330" class_="artid" style="display:none">
 </p>
</div>


