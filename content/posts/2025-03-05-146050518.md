---
layout: post
title: "FastExcelEasyExcel简介以及源码解析"
date: 2025-03-05 20:04:23 +0800
description: "基于MIT协议。"
keywords: "FastExcel/EasyExcel简介以及源码解析"
categories: ['未分类']
tags: ['Java']
artid: "146050518"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146050518
    alt: "FastExcelEasyExcel简介以及源码解析"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146050518
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146050518
cover: https://bing.ee123.net/img/rand?artid=146050518
image: https://bing.ee123.net/img/rand?artid=146050518
img: https://bing.ee123.net/img/rand?artid=146050518
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     FastExcel/EasyExcel简介以及源码解析
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="_0">
     </a>
     简介
    </h2>
    <p>
     <a href="https://idev.cn/fastexcel/zh-CN" rel="nofollow">
      官网地址
     </a>
     <br/>
     <a href="https://github.com/CodePhiliaX/fastexcel">
      GitHub地址
     </a>
     <br/>
     基于MIT协议
    </p>
    <h4>
     <a id="_4">
     </a>
     发展历史
    </h4>
    <p>
     由EasyExcel发展而来
     <br/>
     2018/02/07：发布1.0.0
     <br/>
     2019/09/17：发布2.0.0
     <br/>
     2021/10/21：发布3.0.1
     <br/>
     2024/06/18：发布4.0.0
     <br/>
     2024/11/06：进入维护模式
     <br/>
     2024/12/05：发布FastExcel1.0.0
    </p>
    <h4>
     <a id="_13">
     </a>
     主要特性
    </h4>
    <ul>
     <li>
      高性能读写
     </li>
     <li>
      简单易用
     </li>
     <li>
      流式操作
     </li>
     <li>
      读取执行行数
     </li>
    </ul>
    <h4>
     <a id="_20">
     </a>
     技术原理
    </h4>
    <ul>
     <li>
      内存优化：基于流式读取技术，不需要一次性将整个Excel文件加载到内存中，逐行或逐块读取数据。
     </li>
     <li>
      事件驱动模型：基于实现ReadListener接口处理读取操作。当读取到数据时，会触发接口中的方法，如invoke方法，支持开发者对每行数据进行即时处理。
     </li>
     <li>
      注解映射：用注解将Excel文件中的列与Java对象的属性进行映射。开发者能轻松地将Excel数据转换为Java对象，同时也支持反方向操作，将Java对象写入Excel
     </li>
    </ul>
    <h4>
     <a id="_24">
     </a>
     横向对比
    </h4>
    <table>
     <thead>
      <tr>
       <th>
       </th>
       <th>
        jxl
       </th>
       <th>
        poi
       </th>
       <th>
        fastExcel
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        性能对比
       </td>
       <td>
        效率低
       </td>
       <td>
        细致和完整的操作支持，OOM的问题
       </td>
       <td>
        流式处理机制，仅逐行读写数据，极大地减少了内存消耗
       </td>
      </tr>
      <tr>
       <td>
        API 易用性
       </td>
       <td>
        纯javaAPI，对中文支持非常好，操作简单
       </td>
       <td>
        较为底层和繁琐
       </td>
       <td>
        事件驱动模型，支持自定义注解进行数据映射
       </td>
      </tr>
      <tr>
       <td>
        灵活性与扩展性
       </td>
       <td>
        格式只支持老版本报表
       </td>
       <td>
        能够应对各种定制化需求
       </td>
       <td>
        主要针对常规的读写场景进行了优化
       </td>
      </tr>
     </tbody>
    </table>
    <h2>
     <a id="_31">
     </a>
     源码解析
    </h2>
    <h4>
     <a id="_32">
     </a>
     设计理念
    </h4>
    <ul>
     <li>
      API友好
     </li>
     <li>
      业务扩展性
     </li>
     <li>
      内存使用率
     </li>
    </ul>
    <h4>
     <a id="_36">
     </a>
     设计模式
    </h4>
    <ul>
     <li>
      建造者模式
      <ul>
       <li>
        ExcelWriterBuilder
       </li>
       <li>
        ExcelWriterSheetBuilder
       </li>
       <li>
        ExcelWriterTableBuilder
       </li>
       <li>
        ExcelReaderSheetBuilder
       </li>
      </ul>
     </li>
     <li>
      观察者模式
      <ul>
       <li>
        ReadListener
       </li>
       <li>
        AnalysisEventListener
       </li>
      </ul>
     </li>
     <li>
      责任链设计模式
      <ul>
       <li>
        WorkbookHandlerExecutionChain
       </li>
       <li>
        SheetHandlerExecutionChain
       </li>
       <li>
        RowHandlerExecutionChain
       </li>
       <li>
        CellHandlerExecutionChain
       </li>
      </ul>
     </li>
     <li>
      桥接模式
      <ul>
       <li>
        ExcelAnalyser
       </li>
       <li>
        ExcelReadExecutor
       </li>
      </ul>
     </li>
     <li>
      工厂模式
      <ul>
       <li>
        FastExcelFactory
       </li>
      </ul>
     </li>
     <li>
      模板模式
      <ul>
       <li>
        CellWriteHandler
       </li>
       <li>
        RowTagHandler
       </li>
       <li>
        CellTagHandler
       </li>
       <li>
        BlankRecordHandler
       </li>
      </ul>
     </li>
    </ul>
    <h3>
     <a id="Read_Excel_61">
     </a>
     Read Excel源码解析
    </h3>
    <pre><code class="prism language-java"><span class="token comment">// 代码示例</span>
<span class="token class-name">FastExcel</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>fileNameTotal<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">BaseEntity</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">UploadDataListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">doRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <h4>
     <a id="Read_Excel__67">
     </a>
     Read Excel 初始化
    </h4>
    <pre><code class="prism language-java"><span class="token comment">// 运用门面模式，降低使用者的难度，有利于框架的传播</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FastExcel</span> <span class="token keyword">extends</span> <span class="token class-name">FastExcelFactory</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
</code></pre>
    <pre><code class="prism language-java"><span class="token comment">// 所有的read()方法都会返回ExcelReaderBuilder</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ExcelReaderBuilder</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token class-name">String</span> pathName<span class="token punctuation">,</span> <span class="token class-name">Class</span> head<span class="token punctuation">,</span> <span class="token class-name">ReadListener</span> readListener<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">ExcelReaderBuilder</span> excelReaderBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelReaderBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        excelReaderBuilder<span class="token punctuation">.</span><span class="token function">file</span><span class="token punctuation">(</span>pathName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>head <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            excelReaderBuilder<span class="token punctuation">.</span><span class="token function">head</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>readListener <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            excelReaderBuilder<span class="token punctuation">.</span><span class="token function">registerReadListener</span><span class="token punctuation">(</span>readListener<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> excelReaderBuilder<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
    <pre><code class="prism language-java"><span class="token comment">// 所有的sheet()方法都会到这里</span>
<span class="token comment">// 其中new ExcelReaderSheetBuilder(build())的build()方法会执行前置的初始化操作</span>
<span class="token keyword">public</span> <span class="token class-name">ExcelReaderSheetBuilder</span> <span class="token function">sheet</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> sheetNo<span class="token punctuation">,</span> <span class="token class-name">String</span> sheetName<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">ExcelReaderSheetBuilder</span> excelReaderSheetBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelReaderSheetBuilder</span><span class="token punctuation">(</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>sheetNo <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            excelReaderSheetBuilder<span class="token punctuation">.</span><span class="token function">sheetNo</span><span class="token punctuation">(</span>sheetNo<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>sheetName <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            excelReaderSheetBuilder<span class="token punctuation">.</span><span class="token function">sheetName</span><span class="token punctuation">(</span>sheetName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> excelReaderSheetBuilder<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
    <pre><code class="prism language-java"><span class="token comment">// 到这里会根据文件类型来进行解析</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">choiceExcelExecutor</span><span class="token punctuation">(</span><span class="token class-name">ReadWorkbook</span> readWorkbook<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
			<span class="token comment">//  如果是xlsx格式，会进到这里</span>
            <span class="token keyword">case</span> <span class="token constant">XLSX</span><span class="token operator">:</span>
                <span class="token class-name">XlsxReadContext</span> xlsxReadContext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultXlsxReadContext</span><span class="token punctuation">(</span>readWorkbook<span class="token punctuation">,</span> <span class="token class-name">ExcelTypeEnum</span><span class="token punctuation">.</span><span class="token constant">XLSX</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                analysisContext <span class="token operator">=</span> xlsxReadContext<span class="token punctuation">;</span>
                excelReadExecutor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XlsxSaxAnalyser</span><span class="token punctuation">(</span>xlsxReadContext<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre>
    <pre><code class="prism language-java"><span class="token comment">// 会到这个构造方法里 执行readOpcPackage()方法  </span>
<span class="token comment">// 此方法内会调用poi的OPCPackage包来打开excel文件获取文件内每个sheet的数据，包括comment和hyperlink，方便后续进行处理，至此初始化部分已完成</span>
    <span class="token keyword">public</span> <span class="token class-name">XlsxSaxAnalyser</span><span class="token punctuation">(</span><span class="token class-name">XlsxReadContext</span> xlsxReadContext<span class="token punctuation">,</span> <span class="token class-name">InputStream</span> decryptedStream<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>xlsxReadContext <span class="token operator">=</span> xlsxReadContext<span class="token punctuation">;</span>
        <span class="token class-name">XlsxReadWorkbookHolder</span> xlsxReadWorkbookHolder <span class="token operator">=</span> xlsxReadContext<span class="token punctuation">.</span><span class="token function">xlsxReadWorkbookHolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">OPCPackage</span> pkg <span class="token operator">=</span> <span class="token function">readOpcPackage</span><span class="token punctuation">(</span>xlsxReadWorkbookHolder<span class="token punctuation">,</span> decryptedStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="Read_Excel__127">
     </a>
     Read Excel 解析
    </h4>
    <p>
     回到前面sheet()方法，会返回ExcelReaderSheetBuilder
     <br/>
     然后调用ExcelReaderSheetBuilder里的doRead()方法
    </p>
    <pre><code class="prism language-java">    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>excelReader <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ExcelGenerateException</span><span class="token punctuation">(</span><span class="token string">"Must use 'FastExcelFactory.read().sheet()' to call this method"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        excelReader<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        excelReader<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token comment">// 最后会调用初始化生成的执行器</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">analysis</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ReadSheet</span><span class="token punctuation">&gt;</span></span> readSheetList<span class="token punctuation">,</span> <span class="token class-name">Boolean</span> readAll<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>readAll <span class="token operator">&amp;&amp;</span> <span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>readSheetList<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"Specify at least one read sheet."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            analysisContext<span class="token punctuation">.</span><span class="token function">readWorkbookHolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setParameterSheetDataList</span><span class="token punctuation">(</span>readSheetList<span class="token punctuation">)</span><span class="token punctuation">;</span>
            analysisContext<span class="token punctuation">.</span><span class="token function">readWorkbookHolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setReadAll</span><span class="token punctuation">(</span>readAll<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                excelReadExecutor<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>            
   <span class="token punctuation">}</span>
</code></pre>
    <pre><code class="prism language-java">    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ReadSheet</span> readSheet <span class="token operator">:</span> sheetList<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            readSheet <span class="token operator">=</span> <span class="token class-name">SheetUtils</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>readSheet<span class="token punctuation">,</span> xlsxReadContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>readSheet <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                    xlsxReadContext<span class="token punctuation">.</span><span class="token function">currentSheet</span><span class="token punctuation">(</span>readSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 这里传入分页数据以及处理handler</span>
                    <span class="token function">parseXmlSource</span><span class="token punctuation">(</span>sheetMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>readSheet<span class="token punctuation">.</span><span class="token function">getSheetNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">XlsxRowHandler</span><span class="token punctuation">(</span>xlsxReadContext<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">readComments</span><span class="token punctuation">(</span>readSheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ExcelAnalysisStopSheetException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>log<span class="token punctuation">.</span><span class="token function">isDebugEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"Custom stop!"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                xlsxReadContext<span class="token punctuation">.</span><span class="token function">analysisEventProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">endSheet</span><span class="token punctuation">(</span>xlsxReadContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
    <pre><code class="prism language-java"><span class="token comment">// 这边会去调用SAX解析，解析时会执行xmlReader.setContentHandler(handler)里的方法</span>
<span class="token comment">// SAX 解析。SAX 每次解析只在内存中加载 XML 文件的一小部分，即使针对较大的 XML 文件，它也不需要占用太多的内存，也不会存在内存溢出的问题。</span>
<span class="token comment">// 优点： 1.采用事件驱动模式一段一段的来解析数据，占用内存小 2.只在读取数据时检查数据，不需要保存在内存中 3.效率和性能较高，能解析大于系统内存的文档当然 </span>
<span class="token comment">// 缺点： 1.与 DOM 解析器相比，使用 SAX 解析器读取 XML 文件时，解析逻辑比较复杂 2.同时无法定位文档层次，很难同时访问同一文档的不同部分数据，不支持 XPath</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">parseXmlSource</span><span class="token punctuation">(</span><span class="token class-name">InputStream</span> inputStream<span class="token punctuation">,</span> <span class="token class-name">ContentHandler</span> handler<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">InputSource</span> inputSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InputSource</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">SAXParserFactory</span> saxFactory<span class="token punctuation">;</span>
            <span class="token class-name">String</span> xlsxSAXParserFactoryName <span class="token operator">=</span> xlsxReadContext<span class="token punctuation">.</span><span class="token function">xlsxReadWorkbookHolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSaxParserFactoryName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>xlsxSAXParserFactoryName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                saxFactory <span class="token operator">=</span> <span class="token class-name">SAXParserFactory</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                saxFactory <span class="token operator">=</span> <span class="token class-name">SAXParserFactory</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span>xlsxSAXParserFactoryName<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                saxFactory<span class="token punctuation">.</span><span class="token function">setFeature</span><span class="token punctuation">(</span><span class="token string">"http://apache.org/xml/features/disallow-doctype-decl"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> ignore<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                saxFactory<span class="token punctuation">.</span><span class="token function">setFeature</span><span class="token punctuation">(</span><span class="token string">"http://xml.org/sax/features/external-general-entities"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> ignore<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                saxFactory<span class="token punctuation">.</span><span class="token function">setFeature</span><span class="token punctuation">(</span><span class="token string">"http://xml.org/sax/features/external-parameter-entities"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> ignore<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
            <span class="token class-name">SAXParser</span> saxParser <span class="token operator">=</span> saxFactory<span class="token punctuation">.</span><span class="token function">newSAXParser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">XMLReader</span> xmlReader <span class="token operator">=</span> saxParser<span class="token punctuation">.</span><span class="token function">getXMLReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            xmlReader<span class="token punctuation">.</span><span class="token function">setContentHandler</span><span class="token punctuation">(</span>handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
            xmlReader<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>inputSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
            inputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> <span class="token operator">|</span> <span class="token class-name">ParserConfigurationException</span> <span class="token operator">|</span> <span class="token class-name">SAXException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ExcelAnalysisException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>inputStream <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                    inputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ExcelAnalysisException</span><span class="token punctuation">(</span><span class="token string">"Can not close 'inputStream'!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
    <p>
     我们查看传入的Handler，查看RowTagHandler，继承了AbstractXlsxTagHandler
    </p>
    <pre><code class="prism language-java"><span class="token comment">// 会在操作前后执行动作</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">startElement</span><span class="token punctuation">(</span><span class="token class-name">XlsxReadContext</span> xlsxReadContext<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">Attributes</span> attributes<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">endElement</span><span class="token punctuation">(</span><span class="token class-name">XlsxReadContext</span> xlsxReadContext<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token comment">// 在这里调用了endRow()方法</span>
    xlsxReadContext<span class="token punctuation">.</span><span class="token function">analysisEventProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">endRow</span><span class="token punctuation">(</span>xlsxReadContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>
</code></pre>
    <pre><code class="prism language-java">	<span class="token comment">// 会在dealData()方法里处理数据</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">endRow</span><span class="token punctuation">(</span><span class="token class-name">AnalysisContext</span> analysisContext<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">RowTypeEnum</span><span class="token punctuation">.</span><span class="token constant">EMPTY</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>analysisContext<span class="token punctuation">.</span><span class="token function">readRowHolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRowType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">isDebugEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"Empty row!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>analysisContext<span class="token punctuation">.</span><span class="token function">readWorkbookHolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getIgnoreEmptyRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">dealData</span><span class="token punctuation">(</span>analysisContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
    <pre><code class="prism language-java">    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">dealData</span><span class="token punctuation">(</span><span class="token class-name">AnalysisContext</span> analysisContext<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">ReadRowHolder</span> readRowHolder <span class="token operator">=</span> analysisContext<span class="token punctuation">.</span><span class="token function">readRowHolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">ReadCellData</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> cellDataMap <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token punctuation">)</span>readRowHolder<span class="token punctuation">.</span><span class="token function">getCellMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        readRowHolder<span class="token punctuation">.</span><span class="token function">setCurrentRowAnalysisResult</span><span class="token punctuation">(</span>cellDataMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> rowIndex <span class="token operator">=</span> readRowHolder<span class="token punctuation">.</span><span class="token function">getRowIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> currentHeadRowNumber <span class="token operator">=</span> analysisContext<span class="token punctuation">.</span><span class="token function">readSheetHolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHeadRowNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">boolean</span> isData <span class="token operator">=</span> rowIndex <span class="token operator">&gt;=</span> currentHeadRowNumber<span class="token punctuation">;</span>


        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isData <span class="token operator">&amp;&amp;</span> currentHeadRowNumber <span class="token operator">==</span> rowIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">buildHead</span><span class="token punctuation">(</span>analysisContext<span class="token punctuation">,</span> cellDataMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
		<span class="token comment">// 到这边就会回调监听器生成对象并且到我们自定义的监听器处理数据</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ReadListener</span> readListener <span class="token operator">:</span> analysisContext<span class="token punctuation">.</span><span class="token function">currentReadHolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readListenerList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>isData<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    readListener<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>readRowHolder<span class="token punctuation">.</span><span class="token function">getCurrentRowAnalysisResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> analysisContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    readListener<span class="token punctuation">.</span><span class="token function">invokeHead</span><span class="token punctuation">(</span>cellDataMap<span class="token punctuation">,</span> analysisContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token function">onException</span><span class="token punctuation">(</span>analysisContext<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>readListener<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span>analysisContext<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ExcelAnalysisStopException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      点击invoke()到ModelBuildEventListener生成对象监听器里，查看buildUserModel()方法，可以看到此方法在ReadSheetHolder（注解）获取对象信息，通过反射创建对象，然后对各个属性进行赋值，只会在处理到这行数据的时候封装成对应的java对象。
      <br/>
      这也就是为什么fastexcel占用内存少的原因
     </strong>
    </p>
    <pre><code class="prism language-java">    <span class="token keyword">private</span> <span class="token class-name">Object</span> <span class="token function">buildUserModel</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">ReadCellData</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> cellDataMap<span class="token punctuation">,</span> <span class="token class-name">ReadSheetHolder</span> readSheetHolder<span class="token punctuation">,</span>
        <span class="token class-name">AnalysisContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">ExcelReadHeadProperty</span> excelReadHeadProperty <span class="token operator">=</span> readSheetHolder<span class="token punctuation">.</span><span class="token function">excelReadHeadProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Object</span> resultModel<span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            resultModel <span class="token operator">=</span> excelReadHeadProperty<span class="token punctuation">.</span><span class="token function">getHeadClazz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ExcelDataConvertException</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">readRowHolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRowIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">ReadCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">CellDataTypeEnum</span><span class="token punctuation">.</span><span class="token constant">EMPTY</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
                <span class="token string">"Can not instance class: "</span> <span class="token operator">+</span> excelReadHeadProperty<span class="token punctuation">.</span><span class="token function">getHeadClazz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Head</span><span class="token punctuation">&gt;</span></span> headMap <span class="token operator">=</span> excelReadHeadProperty<span class="token punctuation">.</span><span class="token function">getHeadMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">BeanMap</span> dataMap <span class="token operator">=</span> <span class="token class-name">BeanMapUtils</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>resultModel<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Head</span><span class="token punctuation">&gt;</span></span> entry <span class="token operator">:</span> headMap<span class="token punctuation">.</span><span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Integer</span> index <span class="token operator">=</span> entry<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Head</span> head <span class="token operator">=</span> entry<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> fieldName <span class="token operator">=</span> head<span class="token punctuation">.</span><span class="token function">getFieldName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cellDataMap<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">ReadCellData</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> cellData <span class="token operator">=</span> cellDataMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Object</span> value <span class="token operator">=</span> <span class="token class-name">ConverterUtils</span><span class="token punctuation">.</span><span class="token function">convertToJavaObject</span><span class="token punctuation">(</span>cellData<span class="token punctuation">,</span> head<span class="token punctuation">.</span><span class="token function">getField</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token class-name">ClassUtils</span><span class="token punctuation">.</span><span class="token function">declaredExcelContentProperty</span><span class="token punctuation">(</span>dataMap<span class="token punctuation">,</span> readSheetHolder<span class="token punctuation">.</span><span class="token function">excelReadHeadProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHeadClazz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    fieldName<span class="token punctuation">,</span> readSheetHolder<span class="token punctuation">)</span><span class="token punctuation">,</span> readSheetHolder<span class="token punctuation">.</span><span class="token function">converterMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> context<span class="token punctuation">,</span>
                context<span class="token punctuation">.</span><span class="token function">readRowHolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRowIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                dataMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>fieldName<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> resultModel<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="6874747073:3a2f2f626c6f672e6373646e2e6e65742f4879656e615f5f2f:61727469636c652f64657461696c732f313436303530353138" class_="artid" style="display:none">
 </p>
</div>


