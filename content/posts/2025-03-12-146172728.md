---
layout: post
title: "MongoDB中的游标Cursor"
date: 2025-03-12 20:18:58 +0800
description: "定义。"
keywords: "MongoDB中的游标（Cursor）"
categories: ['未分类']
tags: ['数据库', 'Mongodb']
artid: "146172728"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146172728
    alt: "MongoDB中的游标Cursor"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146172728
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146172728
cover: https://bing.ee123.net/img/rand?artid=146172728
image: https://bing.ee123.net/img/rand?artid=146172728
img: https://bing.ee123.net/img/rand?artid=146172728
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     MongoDB中的游标（Cursor）
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     游标（Cursor）在MongoDB中是一个重要的概念，它用于逐条遍历查询结果集，特别适用于处理大量数据时。
    </p>
    <h2>
     一、游标的定义与作用
    </h2>
    <ol>
     <li>
      <h3>
       <strong>
        定义
       </strong>
       ：
      </h3>
      <ul>
       <li>
        游标是一种能从数据记录的结果集中每次提取一条记录的机制。
       </li>
       <li>
        在MongoDB中，游标相当于一个指向查询结果集的指针，允许用户逐条访问结果集中的文档。
       </li>
      </ul>
     </li>
     <li>
      <h3>
       <strong>
        作用
       </strong>
       ：
      </h3>
      <ul>
       <li>
        通过游标，可以逐步提取数据而不是一次性加载到内存中，从而减少内存占用。
       </li>
       <li>
        客户端可以通过游标对最终结果集进行有效的控制，如限制返回数量、跳过记录、按字段排序等。
       </li>
      </ul>
     </li>
    </ol>
    <h2>
     二、游标的生命周期
    </h2>
    <ol>
     <li>
      <h3>
       <strong>
        定义与打开
       </strong>
       ：
      </h3>
      <ul>
       <li>
        当执行一个查询操作（如
        <code>
         db.collection.find()
        </code>
        ）时，MongoDB会返回一个游标对象。
       </li>
       <li>
        此时，游标处于打开状态，可以开始遍历结果集。
       </li>
      </ul>
     </li>
     <li>
      <h3>
       <strong>
        读取
       </strong>
       ：
      </h3>
      <ul>
       <li>
        通过游标的方法（如
        <code>
         next()
        </code>
        ）可以逐条访问结果集中的文档。
       </li>
       <li>
        每次调用
        <code>
         next()
        </code>
        方法，游标都会指向结果集中的下一个文档，并返回该文档。
       </li>
      </ul>
     </li>
     <li>
      <h3>
       <strong>
        关闭
       </strong>
       ：
      </h3>
      <ul>
       <li>
        当游标不再需要时，应该将其关闭以释放资源。
       </li>
       <li>
        在MongoDB Shell中，如果游标没有被显式关闭，它会在一段时间后自动关闭（取决于服务器的配置）。
       </li>
       <li>
        在应用程序中，通常需要使用特定的方法来关闭游标，如Node.js中的
        <code>
         cursor.close()
        </code>
        方法。
       </li>
      </ul>
     </li>
    </ol>
    <p>
    </p>
    <h2>
     三、游标的相关操作与参数
    </h2>
    <ol>
     <li>
      <h3>
       <strong>
        限制返回数量
       </strong>
       ：
      </h3>
      <ul>
       <li>
        可以使用
        <code>
         limit()
        </code>
        方法来限制游标返回的文档数量。
       </li>
      </ul>
     </li>
     <li>
      <h3>
       <strong>
        跳过记录
       </strong>
       ：
      </h3>
      <ul>
       <li>
        可以使用
        <code>
         skip()
        </code>
        方法来跳过游标中的指定数量的文档。
       </li>
      </ul>
     </li>
     <li>
      <h3>
       <strong>
        排序
       </strong>
       ：
      </h3>
      <ul>
       <li>
        可以使用
        <code>
         sort()
        </code>
        方法按照指定的字段对游标中的文档进行排序。
       </li>
      </ul>
     </li>
     <li>
      <h3>
       <strong>
        设置批大小
       </strong>
       ：
      </h3>
      <ul>
       <li>
        可以使用
        <code>
         batchSize()
        </code>
        方法来设置游标每次从服务器获取文档的批大小。这有助于控制内存使用和网络I/O。
       </li>
      </ul>
     </li>
     <li>
      <h3>
       <strong>
        游标超时
       </strong>
       ：
      </h3>
      <ul>
       <li>
        如果一个游标在一定时间内没有被使用，它可能会被服务器自动关闭以防止资源泄漏。可以通过设置
        <code>
         cursorTimeoutMillis
        </code>
        参数来调整游标的超时时间。
       </li>
      </ul>
     </li>
    </ol>
    <p>
    </p>
    <h2>
     注意
    </h2>
    <p>
     <strong>
      <code>
       pretty()
      </code>
      方法通常用于格式化
      <code>
       find()
      </code>
      方法返回的游标（cursor）对象的输出，使其更易于阅读。而
      <code>
       findOne()
      </code>
      方法返回的是一个单一的文档对象，不是游标，因此它不支持
      <code>
       pretty()
      </code>
      方法。
     </strong>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323430335f38333134373132342f:61727469636c652f64657461696c732f313436313732373238" class_="artid" style="display:none">
 </p>
</div>


