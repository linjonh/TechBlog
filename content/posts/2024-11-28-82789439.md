---
layout: post
title: "运筹系列10线性规划开源软件GLPK和PyMathProg"
date: 2024-11-28 04:12:15 +0800
description: "1. GLPKGLPK全称GNU Linear Programming Kit，是一个开源的求解线性"
keywords: "glpk"
categories: ['运筹学']
tags: ['无标签']
artid: "82789439"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=82789439
    alt: "运筹系列10线性规划开源软件GLPK和PyMathProg"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=82789439
featuredImagePreview: https://bing.ee123.net/img/rand?artid=82789439
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     运筹系列10：线性规划开源软件GLPK和PyMathProg
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="1_GLPK_1">
     </a>
     1. GLPK
    </h2>
    <p>
     GLPK全称GNU Linear Programming Kit，是一个开源的求解线性规划问题的工具套件，由c写成，可以求解大规模线性规划问题、混合整数规划问题。GLPK是免费的，在大规模问题上的性能要逊色于商用软件，求解的性能可以参考安装文件doc目录下的miplib2.txt，miplib3.txt和netlib.txt这三个文件，下面是截图：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/c2b0319d5937827a991da4fbd842e4c1.png"/>
    </p>
    <p>
     GLPK安装非常简单，在centos系统下，执行：
    </p>
    <blockquote>
     <p>
      sudo yum install glpk
     </p>
    </blockquote>
    <p>
     GLPK使用MathProg（mathematical programming language）建模语言，可以使用GLPSOL这个cmd应用来进行交互。作为示例，新建一个文件problem.mod，输入：
    </p>
    <pre><code>var x1;
var x2;
maximize obj: 0.6 * x1 + 0.5 * x2;
s.t. c1: x1 + 2 * x2 &lt;= 1;
s.t. c2: 3 * x1 + x2 &lt;= 2;
solve;
display x1, x2;
end;
</code></pre>
    <p>
     然后退出文件编辑，输入glpsol -m p.mod，最后输出了求解结果。
    </p>
    <pre><code>GLPSOL: GLPK LP/MIP Solver, v4.65
Parameter(s) specified in the command line:
 --math short.mod
Reading model section from short.mod...
9 lines were read
Generating obj...
Generating c1...
Generating c2...
Model has been successfully generated
GLPK Simplex Optimizer, v4.65
3 rows, 2 columns, 6 non-zeros
Preprocessing...
2 rows, 2 columns, 4 non-zeros
Scaling...
 A: min|aij| =  1.000e+00  max|aij| =  3.000e+00  ratio =  3.000e+00
Problem data seem to be well scaled
Constructing initial basis...
Size of triangular part is 2
*     0: obj =  -0.000000000e+00 inf =   0.000e+00 (2)
*     2: obj =   4.600000000e-01 inf =   0.000e+00 (0)
OPTIMAL LP SOLUTION FOUND
Time used:   0.0 secs
Memory used: 0.1 Mb (102250 bytes)
Display statement at line 8
x1.val = 0.6
x2.val = 0.2
Model has been successfully processed
</code></pre>
    <h2>
     <a id="2_PyMathProg_50">
     </a>
     2. PyMathProg
    </h2>
    <p>
     python环境下可以使用PyMathProg进行建模并用GLPK求解。
    </p>
    <blockquote>
     <p>
      pip install pymprog
     </p>
    </blockquote>
    <p>
     下面是个简单的例子：
    </p>
    <pre><code class="prism language-java">from pymprog <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token function">begin</span><span class="token punctuation">(</span><span class="token string">'bike production'</span><span class="token punctuation">)</span>
x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token function">var</span><span class="token punctuation">(</span><span class="token string">'x, y'</span><span class="token punctuation">)</span> # variables
<span class="token function">maximize</span><span class="token punctuation">(</span><span class="token number">15</span> <span class="token operator">*</span> x <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">*</span> y<span class="token punctuation">,</span> <span class="token string">'profit'</span><span class="token punctuation">)</span>
x <span class="token operator">&lt;=</span> <span class="token number">3</span> # mountain bike limit
y <span class="token operator">&lt;=</span> <span class="token number">4</span> # racer production limit
x <span class="token operator">+</span> y <span class="token operator">&lt;=</span> <span class="token number">5</span> # metal finishing limit
<span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     下面是几种定义变量的方式：
    </p>
    <pre><code class="prism language-java">x<span class="token punctuation">,</span>y <span class="token operator">=</span> <span class="token function">var</span><span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span><span class="token string">'y'</span><span class="token punctuation">)</span> #默认变量是非负连续变量
z <span class="token operator">=</span> <span class="token function">var</span><span class="token punctuation">(</span><span class="token string">'z'</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> #非负连续变量数组
a <span class="token operator">=</span> <span class="token function">var</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span>kind<span class="token operator">=</span>bool<span class="token punctuation">)</span> #<span class="token number">0</span><span class="token operator">/</span><span class="token number">1</span>变量。其他还有：<span class="token keyword">float</span> <span class="token punctuation">(</span>默认<span class="token punctuation">)</span><span class="token operator">:</span> 连续变量；<span class="token keyword">int</span><span class="token operator">:</span> 整数变量；bool<span class="token operator">:</span> <span class="token number">0</span><span class="token operator">/</span><span class="token number">1</span>变量
b <span class="token operator">=</span> <span class="token function">var</span><span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">,</span>bounds <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> #限制上下界的连续变量
cindex <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'c1'</span><span class="token punctuation">,</span><span class="token string">'c2'</span><span class="token punctuation">,</span><span class="token string">'c3'</span><span class="token punctuation">)</span>
c <span class="token operator">=</span> <span class="token function">var</span><span class="token punctuation">(</span><span class="token string">'c'</span><span class="token punctuation">,</span>cindex<span class="token punctuation">)</span> #使用自定义index set来定义变量
</code></pre>
    <p>
     下面是关于index的一些示例：
    </p>
    <pre><code class="prism language-java">A <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> #interable的python类型（比如tuple，list，set……）都可以作为index。
B <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>
C <span class="token operator">=</span> <span class="token function">iprod</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">)</span> #可以用这种方式形成更大的index集合。
x <span class="token operator">=</span> <span class="token function">var</span><span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span>C<span class="token punctuation">)</span> #使用index集合创建变量
x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name
</code></pre>
    <p>
     下面是关于parameter的一些示例：
    </p>
    <pre><code class="prism language-java">k <span class="token operator">=</span> <span class="token function">par</span><span class="token punctuation">(</span><span class="token string">'k'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> #内容是list<span class="token operator">/</span>tuple的话，那生成的就是一个parameter的list
p <span class="token operator">=</span> <span class="token function">par</span><span class="token punctuation">(</span><span class="token string">'P'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token string">'east'</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'west'</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'south'</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'north'</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span> #内容是dict的话，生成的是以dict的key为下标的list
a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token function">par</span><span class="token punctuation">(</span><span class="token string">'a,b,c'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> #可以一次定义多个参数
r <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>
R <span class="token operator">=</span> <span class="token function">par</span><span class="token punctuation">(</span><span class="token string">'R'</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span> #可以recusive定义参数
x <span class="token operator">=</span> <span class="token function">var</span><span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
x<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">10</span> #可以重新定义参数值
</code></pre>
    <p>
     下面是关于contraint的一些示例：
    </p>
    <pre><code class="prism language-java">x <span class="token operator">=</span> <span class="token function">var</span><span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> <span class="token function">var</span><span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">)</span>
c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token function">sum</span><span class="token punctuation">(</span>p<span class="token operator">*</span>q <span class="token keyword">for</span> p<span class="token punctuation">,</span>q in <span class="token function">zip</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> y #可以直接添加约束
<span class="token function">st</span><span class="token punctuation">(</span> <span class="token function">sum</span><span class="token punctuation">(</span>p<span class="token operator">*</span>q <span class="token keyword">for</span> p<span class="token punctuation">,</span>q in <span class="token function">zip</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> y <span class="token punctuation">)</span> #也可以用st表明这是一个约束
</code></pre>
    <p>
     目标函数定义很简单：
    </p>
    <pre><code class="prism language-java"><span class="token function">maximize</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i in <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'Profit'</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     可以调用的solver有四种，线性规划有simplex、exact、interior三种（默认是simplex），整数规划是intopt，可以显式调用，例如：
    </p>
    <pre><code class="prism language-java"><span class="token function">solve</span><span class="token punctuation">(</span>simplex<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">vobj</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> #获取目标函数值
<span class="token function">print</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>primal<span class="token punctuation">)</span> #获取变量求解值
</code></pre>
    <p>
     下面是营养问题的综合示例：
    </p>
    <pre><code class="prism language-java">from pymprog <span class="token keyword">import</span> <span class="token operator">*</span>
minlev <span class="token operator">=</span> <span class="token function">group</span><span class="token punctuation">(</span><span class="token string">'minlev'</span><span class="token punctuation">)</span>
fruits <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'apple'</span><span class="token punctuation">,</span> <span class="token string">'pear'</span><span class="token punctuation">,</span> <span class="token string">'orange'</span><span class="token punctuation">)</span>
nutrit <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'fat'</span><span class="token punctuation">,</span> <span class="token string">'fibre'</span><span class="token punctuation">,</span> <span class="token string">'vitamin'</span><span class="token punctuation">)</span>
ntrmin <span class="token operator">=</span> <span class="token punctuation">(</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">30</span> <span class="token punctuation">)</span> # min nutrition intake
#nutrition ingredients of each fruit
ingred <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'apple'</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'pear'</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token string">'orange'</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
diet <span class="token operator">=</span> <span class="token function">var</span><span class="token punctuation">(</span><span class="token string">'diet'</span><span class="token punctuation">,</span> fruits<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token function">minimize</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span>diet<span class="token punctuation">[</span>frt<span class="token punctuation">]</span> <span class="token keyword">for</span> frt in fruits<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'mindiet'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> n<span class="token punctuation">,</span> ntr in <span class="token function">enumerate</span><span class="token punctuation">(</span>nutrit<span class="token punctuation">)</span><span class="token operator">:</span>
   minlev<span class="token punctuation">[</span>ntr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span> diet<span class="token punctuation">[</span>frt<span class="token punctuation">]</span> <span class="token operator">*</span> ingred<span class="token punctuation">[</span>frt<span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token keyword">for</span> frt in fruits<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> ntrmin<span class="token punctuation">[</span>n<span class="token punctuation">]</span>
</code></pre>
    <p>
     点击
     <a href="http://pymprog.sourceforge.net/advanced.html" rel="nofollow">
      这里
     </a>
     可以参考更多例子。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470:733a2f2f626c6f672e6373646e2e6e65742f6b697474797a63:2f61727469636c652f64657461696c732f3832373839343339" class_="artid" style="display:none">
 </p>
</div>


