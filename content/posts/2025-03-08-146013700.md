---
layout: post
title: "第七章C语言指针全解4终章混沌终焉指针圣域的湮灭与重构"
date: 2025-03-08 13:37:21 +0800
description: "各位blogmem,欢迎来到回调地狱的入口！这里是函数指针的暴走领域，是qsort的混沌祭坛——你们将见证动态逻辑的基因突变！握紧你们的比较函数，这是突破稳定代码的最后防线！"
keywords: "第七章、C语言指针全解（4）终章：混沌终焉！指针圣域的湮灭与重构！"
categories: ['未分类']
tags: ['重构', '算法', 'C']
artid: "146013700"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146013700
    alt: "第七章C语言指针全解4终章混沌终焉指针圣域的湮灭与重构"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146013700
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146013700
cover: https://bing.ee123.net/img/rand?artid=146013700
image: https://bing.ee123.net/img/rand?artid=146013700
img: https://bing.ee123.net/img/rand?artid=146013700
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     第七章、C语言指针全解（4）终章：混沌终焉！指针圣域的湮灭与重构！
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="C4_0">
     </a>
     第七章、C语言指针全解（4）终章：混沌终焉！指针圣域的湮灭与重构！
    </h2>
    <p>
    </p>
    <p>
    </p>
    <blockquote>
     <p>
      各位blogmem,欢迎来到回调地狱的入口！这里是函数指针的暴走领域，是qsort的混沌祭坛——你们将见证动态逻辑的基因突变！握紧你们的比较函数，这是突破稳定代码的最后防线！
     </p>
    </blockquote>
    <h3>
     <a id="_4">
     </a>
     一、回调函数：时间线跳跃的暗码
    </h3>
    <blockquote>
     <p>
      回调函数不是普通调用，是向程序注入未来指令的时光胶囊！它允许你在运行时逆转因果链，让函数行为在事后被重新定义！
      <br/>
      回调函数是代码的延时炸弹，触发时机由宿主函数全权掌控！
     </p>
    </blockquote>
    <ul>
     <li>
      回调函数就是⼀个
      <strong>
       通过函数指针调⽤
      </strong>
      的
      <strong>
       函数。
      </strong>
     </li>
    </ul>
    <p>
     如果你把
     <strong>
      函数的指针
     </strong>
     （地址）作为参数
     <strong>
      传递给另⼀个函数
     </strong>
     ，当这个指针
     <strong>
      被⽤来调⽤其所指向的函数
     </strong>
     时，
     <strong>
      被调⽤的函数
     </strong>
     就是
     <strong>
      回调函数
     </strong>
     。
     <strong>
      回调函数不是被直接调⽤
     </strong>
     ，⽽是在特定的事件或条件发⽣时由
     <strong>
      另外的⼀⽅调⽤
     </strong>
     的，⽤于对该事件或条件进⾏响应。
    </p>
    <p>
     上面的概念多少有些生硬，接下来给个例子让大家清晰的进行理解：
     <br/>
     <strong>
      函数指针转递方—— 中间调用方——被调函数方（回调函数）
     </strong>
     之间的数据交互逻辑
     <br/>
     这里可以用上篇博客的计算器进行回调函数改造：
    </p>
    <pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
 <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">sub</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
 <span class="token keyword">return</span> a <span class="token operator">-</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">mul</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">return</span> a <span class="token operator">*</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">div</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
 <span class="token keyword">return</span> a <span class="token operator">/</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//以上都为回调函数</span>
<span class="token keyword">void</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">(</span><span class="token operator">*</span>pf<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span>	<span class="token comment">//函数调用方</span>
<span class="token punctuation">{<!-- --></span>
 <span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
 <span class="token keyword">int</span> x<span class="token punctuation">,</span> y<span class="token punctuation">;</span>
 <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"输⼊操作数："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d %d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>x<span class="token punctuation">,</span> <span class="token operator">&amp;</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
 ret <span class="token operator">=</span> <span class="token function">pf</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"ret = %d\n"</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
  <span class="token keyword">int</span> input <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">do</span>
  <span class="token punctuation">{<!-- --></span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"*************************\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">" 1:add                2:sub \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">" 3:mul                 4:div \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	 <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"*************************\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"请选择："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
 	<span class="token keyword">switch</span> <span class="token punctuation">(</span>input<span class="token punctuation">)</span>
  	<span class="token punctuation">{<!-- --></span>
	  <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
	    	<span class="token function">calc</span><span class="token punctuation">(</span>add<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//函数指针传递方</span>
 			<span class="token keyword">break</span><span class="token punctuation">;</span>
 	  <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
 			<span class="token function">calc</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//函数指针传递方</span>
 			<span class="token keyword">break</span><span class="token punctuation">;</span>
 	  <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>
 			<span class="token function">calc</span><span class="token punctuation">(</span>mul<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//函数指针传递方</span>
 			<span class="token keyword">break</span><span class="token punctuation">;</span>
 	  <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span>
 			<span class="token function">calc</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//函数指针传递方</span>
 			<span class="token keyword">break</span><span class="token punctuation">;</span>
 			<span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
 			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"退出程序\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 			<span class="token keyword">break</span><span class="token punctuation">;</span>
	  <span class="token keyword">default</span><span class="token operator">:</span>
 			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"选择错误\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 			<span class="token keyword">break</span><span class="token punctuation">;</span>
 	<span class="token punctuation">}</span>
  <span class="token punctuation">}</span> 
  <span class="token keyword">while</span> <span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="qsort_81">
     </a>
     二、qsort：混沌数据的归一仪式
    </h3>
    <blockquote>
     <p>
      qsort不是排序，是以比较函数为祭品的维度规整！通过回调函数，你能定义任意数据的混沌度衡量法则！
      <br/>
      qsort的第四个参数是向编译器递交的灵魂契约，错配类型将引发未定义行为的降维打击！
     </p>
    </blockquote>
    <p>
     qsort是C语言中的一个库函数：
     <br/>
     这个函数是
     <strong>
      用来给函数进行排序的
     </strong>
     ，qsort底层使用的是快速排序的算法思想。（
     <mark>
      <strong>
       默认为升序排列
      </strong>
     </mark>
     ）
     <br/>
     <strong>
      头文件为：stdlib.h
     </strong>
    </p>
    <p>
     像之前我们学过
     <strong>
      冒泡排序
     </strong>
     的排序方法，但
     <strong>
      只学过用在排列整型数组
     </strong>
     的情况。
     <br/>
     那当我们要排序
     <strong>
      字符数组、字符串、浮点数、结构体
     </strong>
     时，很显然冒泡排序是行不通的，这时
     <strong>
      qsort
     </strong>
     的含金量就体现出来了。
    </p>
    <p>
     qsort函数：
    </p>
    <pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">qsort</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span> base<span class="token punctuation">,</span> <span class="token comment">//指向待排数组的第一个元素的指针</span>
			<span class="token class-name">size_t</span> num<span class="token punctuation">,</span> <span class="token comment">//base指向数组中元素的个数</span>
			<span class="token class-name">size_t</span> size<span class="token punctuation">,</span> <span class="token comment">//base指向数组中一个元素的大小，单位是字节。</span>
			<span class="token keyword">int</span>  <span class="token punctuation">(</span><span class="token operator">*</span>cmp<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">void</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token comment">//函数指针 —— 传递函数的地址</span>
			）；
</code></pre>
    <blockquote>
     <ul>
      <li>
       其中，第四个参数是
       <strong>
        用来比较
       </strong>
       的函数指针，具体用来比较什么类型，
       <strong>
        用户需要自己设定
       </strong>
       。
      </li>
      <li>
       该
       <strong>
        cmp函数
       </strong>
       中，第一个传参的值 &gt; 第二个传参的值 时返回 &gt;0的数字
      </li>
      <li>
       该
       <strong>
        cmp函数
       </strong>
       中，第一个传参的值 &lt; 第二个传参的值 时返回 &lt;0的数字
      </li>
      <li>
       该
       <strong>
        cmp函数
       </strong>
       中，第一个传参的值 = 第二个传参的值 时返回 0.
       <br/>
       接下来测试qsort 排列整型数组：
      </li>
     </ul>
    </blockquote>
    <pre><code class="prism language-c"><span class="token function">cmp_int</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">void</span><span class="token operator">*</span> p1<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>p2<span class="token punctuation">)</span> <span class="token comment">//此函数是用来比较元素的。</span>
<span class="token punctuation">{<!-- --></span>
 	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">{<!-- --></span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span>p1 <span class="token operator">&gt;</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span>p2<span class="token punctuation">)</span> <span class="token comment">//因为接收参数使用的时void *类型的指针，不能对其直接解引用，所以要对其强制类型转换再进行解引用操作。</span>
 	<span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
 	<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span>p1 <span class="token operator">&lt;</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span>p2<span class="token punctuation">)</span>
 	<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
 	<span class="token keyword">else</span> 
 	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>size sz<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> sz<span class="token punctuation">;</span>i <span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> sz <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">qsort</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span>sz<span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>cmp_int<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">Print</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span>sz<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     在继续测试qsort对结构体的排序之前，我们先回忆关于访问结构体内容的两种方法：
    </p>
    <pre><code class="prism language-c"><span class="token keyword">struct</span> <span class="token class-name">Stu</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">struct</span> <span class="token class-name">Stu</span> s <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span><span class="token string">"zhangsan"</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span><span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">struct</span> 	<span class="token class-name">Stu</span> <span class="token operator">*</span>ps <span class="token operator">=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">;</span> <span class="token comment">//访问结构体内容要通过指针来进行。</span>
<span class="token punctuation">}</span>
</code></pre>
    <ul>
     <li>
      <mark>
       结构体成员的直接访问：结构体变量名 + .(点操作符)访问
      </mark>
     </li>
    </ul>
    <p>
     这里也可以“多此一举”的用
     <strong>
      结构体指针变量 解引用
     </strong>
     再 + . 访问
    </p>
    <pre><code class="prism language-c"><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s %d"</span><span class="token punctuation">,</span>ps<span class="token punctuation">.</span>name<span class="token punctuation">,</span>ps<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s %d"</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token operator">*</span>ps<span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token operator">*</span>ps<span class="token punctuation">)</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <ul>
     <li>
      <mark>
       <strong>
        结构体成员的间接访问：结构体指针-&gt;成员名
       </strong>
      </mark>
     </li>
    </ul>
    <pre><code class="prism language-c"><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s %d"</span><span class="token punctuation">,</span>ps<span class="token operator">-&gt;</span>name<span class="token punctuation">,</span>ps<span class="token operator">-&gt;</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     接下来再使用qsort
     <strong>
      排序结构数据
     </strong>
     ：
    </p>
    <ul>
     <li>
      结构体的大小比较就取决于，你要用里面具体
      <strong>
       哪种变量
      </strong>
      来比较。比如以下的例子，
      <strong>
       按姓名（长度），或按年龄大小比较
      </strong>
      。
     </li>
     <li>
      无论你想比较什么类型的数据，写
      <strong>
       cmp函数
      </strong>
      时，
      <strong>
       形式参数
      </strong>
      都要写成
      <strong>
       void
      </strong>
      * 类型，和qsort函数的设定保持一致。
     </li>
     <li>
      以下是按姓名比的，姓名是字符串，
      <strong>
       字符串比较是使用strcmp函数
      </strong>
      的
     </li>
     <li>
      <strong>
       strcmp 函数比较大小后的返回值和qsort函数中cmp要求的返回值相吻合
      </strong>
     </li>
    </ul>
    <pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string.h&gt;</span></span>
<span class="token function">cmp_stu_by_name</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">void</span><span class="token operator">*</span> p1<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">void</span><span class="token operator">*</span> p2<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">strcmp</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Stu</span><span class="token operator">*</span><span class="token punctuation">)</span>p1<span class="token punctuation">)</span><span class="token operator">-&gt;</span>name <span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Stu</span><span class="token operator">*</span><span class="token punctuation">)</span>p2<span class="token punctuation">)</span><span class="token operator">-&gt;</span>age<span class="token punctuation">)</span> <span class="token comment">//先强制类型转换成结构体指针再指向成员名。</span>
<span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token keyword">struct</span> <span class="token class-name">Stu</span> <span class="token comment">//学生</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">char</span>	name<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token punctuation">;</span> <span class="token comment">// 姓名</span>
	<span class="token keyword">int</span> age<span class="token punctuation">;</span> <span class="token comment">//年龄</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span>  main
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">struct</span> <span class="token class-name">Stu</span> arr<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token punctuation">{<!-- --></span><span class="token string">"zhangsan"</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">(</span><span class="token string">"lisi"</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span><span class="token string">"wangwu"</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//定义结构体变量</span>
	<span class="token keyword">int</span> sz <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">qsort</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span>sz<span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>cmp_stu_by_name<span class="token punctuation">)</span>
	
<span class="token punctuation">}</span>
</code></pre>
    <p>
     按年龄来比时，cmp函数的写法：
    </p>
    <pre><code class="prism language-c"><span class="token function">cmp_stu_by_age</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">void</span><span class="token operator">*</span>p1<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">void</span><span class="token operator">*</span> p2<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Stu</span><span class="token operator">*</span><span class="token punctuation">)</span>p1<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> age <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Stu</span><span class="token operator">*</span><span class="token punctuation">)</span>p2<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> age<span class="token punctuation">;</span>
	<span class="token comment">//这里年龄相减的正负0恰好和他们的大小比较所对应的返回值相符。 </span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="qsort__192">
     </a>
     qsort 的降序排列：
    </h4>
    <blockquote>
     <p>
      由于
      <strong>
       qsort内置默认为升序
      </strong>
      排列，所以要想让它的作用效果为
      <strong>
       降序
      </strong>
      ，那只能
      <strong>
       更改cmp函数的逻辑
      </strong>
      。
     </p>
    </blockquote>
    <p>
     这里以上面的cmp代码为例，要想降序该这样修改：
    </p>
    <pre><code class="prism language-c"><span class="token function">cmp_stu_by_age</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">void</span><span class="token operator">*</span>p1<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">void</span><span class="token operator">*</span> p2<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Stu</span><span class="token operator">*</span><span class="token punctuation">)</span>p2<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> age <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Stu</span><span class="token operator">*</span><span class="token punctuation">)</span>p1<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="qsort_202">
     </a>
     三、冒泡排序模拟qsort：自制维度规整引擎
    </h3>
    <blockquote>
     <p>
      手写泛型排序？这是在内存荒漠中徒手搭建巴别塔！需要精准操控每一个字节的量子态！
     </p>
    </blockquote>
    <p>
     接下来我们将bubble_sort改造成通用的排序算法，可以排任意类型的数据：
     <br/>
     思考逻辑：
     <br/>
     1、由于我们不知道将来要给什么样类型的数组进行排序，所以
     <strong>
      接收数组的形参类型为void
     </strong>
     *。
    </p>
    <pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">Swap</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> buf1<span class="token punctuation">,</span><span class="token keyword">char</span><span class="token operator">*</span> buf2<span class="token punctuation">,</span><span class="token class-name">size_t</span> width<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//这里并不知道数组里的类型是什么样的，所以并不能强制类型转换来比较，否则这个函数并不通用。</span>
	<span class="token comment">//所以我们采取一个字节一个字节的比较：</span>
	<span class="token comment">//这里传入了width 我们就可以将width个字节为一循环比较：</span>
	<span class="token keyword">char</span> tmp <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> width<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		tmp <span class="token operator">=</span> <span class="token operator">*</span>buf1<span class="token punctuation">;</span>
		<span class="token operator">*</span>buf1 <span class="token operator">=</span> <span class="token operator">*</span>buf2<span class="token punctuation">;</span>
		<span class="token operator">*</span>buf2 <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
		buf1 <span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//向后推进指针直到该元素被置换完成</span>
		buf2 <span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//</span>
	<span class="token punctuation">}</span>
	
	
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">bubble_sort</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span> base<span class="token punctuation">,</span><span class="token class-name">size_t</span> sz<span class="token punctuation">,</span><span class="token class-name">size_t</span> width<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>cmp<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">void</span><span class="token operator">*</span>p1<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">void</span><span class="token operator">*</span> p2<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//趟数：</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> sz <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">//一趟内部的两两比较：</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>j <span class="token operator">&lt;</span> sz <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>j <span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>	
			<span class="token comment">//比较两个元素：</span>
			<span class="token comment">// if(arr[j]&gt;arr[j+1])</span>
			 <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">cmp</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>base <span class="token operator">+</span> j<span class="token operator">*</span>width<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>base <span class="token operator">+</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>width<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span>
			 <span class="token punctuation">{<!-- --></span>
			 	<span class="token comment">//交换两个元素：</span>
			 	<span class="token function">Swap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>base <span class="token operator">+</span> j<span class="token operator">*</span>width<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>base <span class="token operator">+</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>width<span class="token punctuation">,</span>width<span class="token punctuation">)</span><span class="token punctuation">;</span> 
			 <span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="sizeof_vs_strlen_245">
     </a>
     四、sizeof vs strlen：虚空测量的双生诅咒
    </h3>
    <h4>
     <a id="sizeof_246">
     </a>
     sizeof
    </h4>
    <p>
     sizeof 计算变量所占内存内存空间⼤⼩的，单位是字节，如果操作数是类型的话，计算的是使⽤类型创建的变量所占内存空间的⼤⼩。
     <strong>
      sizeof是操作符不是函数
     </strong>
    </p>
    <p>
     <em>
      <strong>
       sizeof 只关注占⽤内存空间的⼤⼩，不在乎内存中存放什么数据。
      </strong>
     </em>
     <br/>
     比如：
    </p>
    <pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">inculde</span> <span class="token expression"><span class="token operator">&lt;</span>stdio<span class="token punctuation">.</span>h<span class="token operator">&gt;</span></span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
 <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
 <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
 <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="strlen_263">
     </a>
     strlen
    </h4>
    <p>
     strlen 是C语⾔库函数，功能是求字符串⻓度。函数原型如下：
    </p>
    <pre><code>size_t strlen ( const char * str );
</code></pre>
    <p>
     统计的是从 strlen 函数的参数 str 中这个地址开始向后， \0 之前字符串中字符的个数。strlen 函数会⼀直向后找 \0 字符，直到找到为⽌，所以可能存在越界查找。
    </p>
    <h3>
     <a id="_270">
     </a>
     五、数组/指针题解：次元裂隙的审判日
    </h3>
    <h4>
     <a id="_271">
     </a>
     一维数组：
    </h4>
    <pre><code>int a[] = {1,2,3,4};
printf("%d\n",sizeof(a));			//16     数组名单独放在sizeof 内部，计算的是整个数组的大小
printf("%d\n",sizeof(a+0));			//4 /8   这里的a是数组名表示首元素的地址，地址大小只和环境有关。
printf("%d\n",sizeof(*a));			//1		 这里a同样是首元素的地址
printf("%d\n",sizeof(a+1));			//4 / 8
printf("%d\n",sizeof(a[1]));		//2
printf("%d\n",sizeof(&amp;a));			//4 / 8	 这里的数组名表示整个数组，&amp;a就是整个数组的地址，数组的地址也是地址，并不是数组的地址就nb，同样也是4或8字节。
printf("%d\n",sizeof(*&amp;a));			//16     这里的*和&amp;抵消，所以sizeof(*&amp;a)  ==  sizeof(a)
printf("%d\n",sizeof(&amp;a+1));		//4 / 8  &amp;a是数组的地址，&amp;a+1是跳过整个数组后的那个位置的地址
printf("%d\n",sizeof(&amp;a[0]); 		//4/8
printf("%d\n",sizeof(&amp;a[0]+1);		//4/8
</code></pre>
    <h4>
     <a id="_286">
     </a>
     字符数组：
    </h4>
    <h5>
     <a id="sizeof__287">
     </a>
     sizeof 系列
    </h5>
    <pre><code class="prism language-c"><span class="token keyword">char</span> arr<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token char">'a'</span><span class="token punctuation">,</span><span class="token char">'b'</span><span class="token punctuation">,</span><span class="token char">'c'</span><span class="token punctuation">,</span><span class="token char">'d'</span><span class="token punctuation">,</span><span class="token char">'e'</span><span class="token punctuation">,</span><span class="token char">'f'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//6		这里arr表示整个数组</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>arr<span class="token operator">+</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  	<span class="token comment">//4/8	这里arr表示首元素地址	</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">*</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//1		这里arr表示该数组的首元素</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 	<span class="token comment">//1		这里arr[1]表示该数组的第二个元素</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//4/8	这里&amp;arr表示整个数组的地址</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>arr<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//4/8	这里&amp;arr+1是跳过整个数组后的那个地址</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//4/8	这里&amp;arr[0]+1该数组第二个元素的地址</span>
</code></pre>
    <pre><code class="prism language-c"><span class="token keyword">char</span> arr<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"abcdef"</span><span class="token punctuation">;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//7		这里arr是整个数组，大小为7（记得包含)</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>arr<span class="token operator">+</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//4/8</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">*</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//1</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//1</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//4/8</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>arr<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//4/8</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//4/8</span>
</code></pre>
    <pre><code class="prism language-c"><span class="token keyword">char</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token string">"abcdef"</span><span class="token punctuation">;</span>		
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">//4/8		p是指向字符串首元素的指针变量，计算的是指针变量p的大小</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>p<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//4/8		p+1是1第二个元素的地址 地址的大小就是4/8个字节</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">//1</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//1</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">//4/8		&amp;p是指针变量p的地址 &amp;p —char** 二级指针</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>p<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//4/8		&amp;p +1是跳过了p变量，指向了p的后面</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//4/8		&amp;p[0] == &amp;*(p+0) == p  所以&amp;p[0]+1就是第二个元素'b'的地址</span>
</code></pre>
    <h5>
     <a id="strlen_318">
     </a>
     strlen系列
    </h5>
    <pre><code class="prism language-c"><span class="token keyword">char</span> arr<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token char">'a'</span><span class="token punctuation">,</span><span class="token char">'b'</span><span class="token punctuation">,</span><span class="token char">'c'</span><span class="token punctuation">,</span><span class="token char">'d'</span><span class="token punctuation">,</span><span class="token char">'e'</span><span class="token punctuation">,</span><span class="token char">'f'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//随机数    这里的arr为首元素地址，传入strlen中会从该地址开始往后读取直到遇到\0.而该数组arr中无\0，strlen会持续读取越界到数组外直到遇到\0</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>arr<span class="token operator">+</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//随机数    arr+0是首元素的地址，传到strlen中从该地址向后读取直到遇到\0</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token operator">*</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//程序崩溃  *arr 为首元素，将'a'传入strlen相当于其ASCLL码‘97’传入按地址读取，但并无权限无法读取。</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//程序崩溃  这里arr[1]为数组第二个元素'b'。</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//随机数    这里&amp;arr为整个数组的地址，传入strlen依然是从第一个元素开始读取</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>arr<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//随机数    从第二个元素开始读取</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//随机数  从第二个元素开始读取</span>
</code></pre>
    <pre><code class="prism language-c"><span class="token keyword">char</span> arr<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"abcdef"</span><span class="token punctuation">;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	 <span class="token comment">//6</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>arr<span class="token operator">+</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	 <span class="token comment">//6</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token operator">*</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  	 <span class="token comment">//程序崩溃</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//程序崩溃</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	 <span class="token comment">//6</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>arr<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	 <span class="token comment">//随机数</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//5		从第二个元素开始读取</span>
</code></pre>
    <pre><code class="prism language-c"><span class="token keyword">char</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token string">"abcdef"</span><span class="token punctuation">;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		 <span class="token comment">//6</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>p<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	 <span class="token comment">//5</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		 <span class="token comment">//程序崩溃</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	 <span class="token comment">//程序崩溃</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		 <span class="token comment">//随机数</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>p<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	 <span class="token comment">//随机数</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//5</span>
</code></pre>
    <h4>
     <a id="_349">
     </a>
     二维数组：
    </h4>
    <pre><code class="prism language-c"><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">//48	a作为数组名单独放在了sizeof内部，计算的是整个数组的大小</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//4		计算的是第一行第一个元素的大小</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//16	a[0]是第一行的数组名，单独放在sizeof内部，计算的是数组的大小</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//4/8 	a[0]是第一行的数组名，但没有单独放在数的内部，那么只能数组首元素的地址——&amp;a[0][0]。 +1是第一行第二个元素的地址——*a[0][1]</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//4		在上面的基础上解引用是第一行第二个元素 </span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">//4/8	a是二维数组的数组名，并没有单独放在sizeof内部，a表示首元素的地址—也就是第一行的地址，+1后就成了第二行的地址	</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//16    第二行的地址解引用后就是第二行的所有元素</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//4/8	a[0]是第一行的数组名，&amp;数组名其实就是第一行的地址，&amp;a[0]+1就是第二行的地址</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//16	第二行的地址解引用是整个第二行的所有元素</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">*</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">//4/8	这里的a是二维数组的数组名，没有单独放在sizeof中,所以是首元素（第一行）的地址</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//16	a[3]是第四行的数组名，单独放在了sizeof中，所以是整个第三行的元素。</span>
<span class="token comment">//这个情况并没有越界，因为sizeof内部并不会真实计算，所以不会去访问.</span>
</code></pre>
    <p>
     所以把握好以上的关键点如下：
    </p>
    <ul>
     <li>
      <strong>
       数组名
      </strong>
      是否
      <mark>
       单独
      </mark>
      在sizeof内部，如果
      <strong>
       是
      </strong>
      ，此处的
      <strong>
       数组名表示整个数组元素
      </strong>
      ，如果
      <strong>
       不是
      </strong>
      ，则此处数组名表示的是
      <strong>
       该数组首元素的地址
      </strong>
      。
     </li>
     <li>
      <strong>
       sizeof
      </strong>
      如果传入的是
      <strong>
       字符串
      </strong>
      ，要记得
      <strong>
       加上\0
      </strong>
      。
     </li>
     <li>
      <strong>
       strlen
      </strong>
      中传入
      <strong>
       只能是地址
      </strong>
      ，才能从该地址处向后读取。如果传入的是元素，则会程序崩溃。
     </li>
     <li>
      strlen
      <strong>
       计算的是\0之前的字符串长度
      </strong>
      。字符数组（字符串中）的元素
      <strong>
       不包含\0时
      </strong>
      ，结果都为
      <strong>
       随机数
      </strong>
      。
     </li>
     <li>
      sizeof中如果传入的是二维数组：例如该二维数组为a[3][4]
      <br/>
      则
      <strong>
       单独传入a
      </strong>
      时表示的是
      <strong>
       该二维数组的整个元素
      </strong>
      <br/>
      <mark>
       <strong>
        传入a，但不单独时
       </strong>
       ，表示的是该
       <strong>
        二维数组的首元素地址
       </strong>
       ，也就是
       <strong>
        第一行的数组元素的地址
       </strong>
      </mark>
      <br/>
      <strong>
       单独传入a[2]时
      </strong>
      ，表示的是该
      <strong>
       第三行的数组的整个元素
      </strong>
      <br/>
      <mark>
       传入
       <strong>
        a[2]，但不单独时
       </strong>
       ，表示的是
       <strong>
        第三行数组的首元素地址
       </strong>
       ，也就是
       <strong>
        第三行第一个元素的地址
       </strong>
      </mark>
      <br/>
      传入a[5]时，并不会造成越界，因为sizeof内部并不会实际计算，所以也能照常输出
     </li>
    </ul>
    <blockquote>
     <p>
      当回调函数开始递归自指，整个逻辑宇宙将归于虚无！
      <br/>
      El Psy Kongroo！
     </p>
    </blockquote>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323430315f38383733393735312f:61727469636c652f64657461696c732f313436303133373030" class_="artid" style="display:none">
 </p>
</div>


