---
layout: post
title: "使用Wireshark截取并解密摄像头画面"
date: 2025-03-06 12:00:01 +0800
description: "在物联网（IoT）设备普及的今天，安全摄像头等智能设备在追求便捷的同时，往往忽视了数据传输过程中的加密保护。很多摄像头默认通过 HTTP 协议传输数据，而非加密的 HTTPS，从而给潜在攻击者留下了可乘之机。本文将从原理、工具配置、攻击步骤、局限性以及防御措施等多个角度，详细解析如何利用 Wireshark 截获摄像头传输的图像数据。"
keywords: "wireshark 捕获相机图像"
categories: ['未分类']
tags: ['网络', '测试工具', 'Wireshark']
artid: "146061078"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146061078
    alt: "使用Wireshark截取并解密摄像头画面"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146061078
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146061078
cover: https://bing.ee123.net/img/rand?artid=146061078
image: https://bing.ee123.net/img/rand?artid=146061078
img: https://bing.ee123.net/img/rand?artid=146061078
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     使用Wireshark截取并解密摄像头画面
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <hr/>
    <p>
     在物联网（IoT）设备普及的今天，安全摄像头等智能设备在追求便捷的同时，往往忽视了数据传输过程中的加密保护。很多摄像头默认通过 HTTP 协议传输数据，而非加密的 HTTPS，从而给潜在攻击者留下了可乘之机。本文将从原理、工具配置、攻击步骤、局限性以及防御措施等多个角度，详细解析如何利用 Wireshark 截获摄像头传输的图像数据。
    </p>
    <hr/>
    <h3>
     <a id="1__7">
     </a>
     1. 背景与技术原理
    </h3>
    <h4>
     <a id="11_IoT__9">
     </a>
     1.1 IoT 设备的安全隐患
    </h4>
    <ul>
     <li>
      <p>
       <strong>
        便捷性优先，安全性不足
       </strong>
       <br/>
       许多摄像头在设计时为了降低使用门槛，选择了直接通过 HTTP 提供后台管理和视频预览功能。这种设计虽然使用简单，但因数据以明文方式传输，使得在局域网内的其他用户（如拥有 Wi-Fi 密码者）有机会截获并解析敏感数据。
      </p>
     </li>
     <li>
      <p>
       <strong>
        开放端口问题
       </strong>
       <br/>
       常见的 HTTP 服务一般会绑定在 80、81、8080、或 8081 等端口上。通过网络扫描工具（如 Nmap）可以快速发现这些开放端口，进而定位目标设备。
      </p>
     </li>
    </ul>
    <h4>
     <a id="12_Wireshark__17">
     </a>
     1.2 Wireshark 与无线流量分析
    </h4>
    <p>
     Wireshark 是一款功能强大的网络抓包工具，它能捕获并解析通过网络传输的各类数据包。在无线网络环境下，借助支持监控模式的无线网卡，Wireshark 能够监听目标网络的数据流量，若能获取到 WPA/WPA2 四次握手，则可以对流量进行解密分析，从而还原出原始的 HTTP 数据。
    </p>
    <hr/>
    <h3>
     <a id="2__23">
     </a>
     2. 攻击流程详解
    </h3>
    <h4>
     <a id="21__25">
     </a>
     2.1 前期准备
    </h4>
    <h5>
     <a id="211__27">
     </a>
     2.1.1 获取网络访问权限
    </h5>
    <ul>
     <li>
      <p>
       <strong>
        已知密码方案
       </strong>
       <br/>
       若你已经知晓目标 Wi-Fi 网络的密码，可将密码添加到 Wireshark 的解密设置中，这样在捕获到四次握手包后即可对流量进行解密。
      </p>
     </li>
     <li>
      <p>
       <strong>
        获取四次握手包
       </strong>
       <br/>
       四次握手是 WPA/WPA2 协议中用于建立加密连接的关键步骤。捕获这个握手包是解密网络流量的前提，因此确保目标设备在观看摄像头视频时能够生成握手包非常重要。
      </p>
     </li>
    </ul>
    <h5>
     <a id="212__35">
     </a>
     2.1.2 配置支持监控模式的无线网卡
    </h5>
    <ul>
     <li>
      <p>
       <strong>
        无线网卡选择
       </strong>
       <br/>
       使用一块支持监控模式（monitor mode）的无线网卡（如 Alfa AWUS036NHA）进行抓包。监控模式允许网卡接收所有经过的无线信号，而非仅限于发送到本机的数据包。
      </p>
     </li>
     <li>
      <p>
       <strong>
        进入监控模式
       </strong>
       <br/>
       利用工具
       <code>
        airmon-ng
       </code>
       将无线网卡（例如 wlan0）切换到监控模式：
      </p>
      <pre><code class="prism language-bash">airmon-ng start wlan0
</code></pre>
      <p>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/93c3e97b51694ab18865af8134a62b24.png"/>
      </p>
      <p>
       完成后，网卡通常会变更名称（例如 wlan0mon），这时候开始扫描周边无线网络。
      </p>
      <pre><code class="prism language-bash">airodump-ng wlan0mon
</code></pre>
     </li>
     <li>
      <p>
       <strong>
        信道锁定
       </strong>
       <br/>
       根据 airodump-ng 的扫描结果，确定目标网络所使用的信道（Channel），然后固定无线网卡在该信道上，以便持续捕获目标流量。例如，如果目标网络在信道 12，则执行：
      </p>
      <pre><code class="prism language-bash">airmon-ng start wlan0mon <span class="token number">12</span>
</code></pre>
     </li>
    </ul>
    <hr/>
    <h4>
     <a id="22_Wireshark__64">
     </a>
     2.2 Wireshark 数据捕获与解密配置
    </h4>
    <h5>
     <a id="221__Wireshark__66">
     </a>
     2.2.1 启动 Wireshark 抓包
    </h5>
    <ul>
     <li>
      <strong>
       选择正确的网卡
      </strong>
      <br/>
      打开 Wireshark 后，选择已进入监控模式并固定在目标信道的无线网卡开始捕获数据。初始抓包时，由于数据是加密传输，Wireshark中显示的内容大多为乱码。
     </li>
    </ul>
    <h5>
     <a id="222__WiFi__71">
     </a>
     2.2.2 添加 Wi-Fi 解密密钥
    </h5>
    <ul>
     <li>
      <p>
       <strong>
        配置解密选项
       </strong>
       <br/>
       进入 Wireshark 的“编辑” → “首选项”菜单，选择左侧的“协议”列表中的 “IEEE 802.11”。在该选项中勾选“启用解密”。
      </p>
      <p>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/95dde3f74fac40c1b3d3c28c164933e1.png"/>
      </p>
     </li>
     <li>
      <p>
       <strong>
        输入解密密钥
       </strong>
       <br/>
       点击“编辑”按钮，在弹出的窗口中添加解密密钥。一般使用格式
       <code>
        password:networkname
       </code>
       （例如
       <code>
        MyWiFiPass:HomeNetwork
       </code>
       ），然后点击保存。此时，若捕获到了正确的四次握手包，Wireshark 就能自动将捕获到的明文 HTTP 流量解密并显示出来。
      </p>
     </li>
    </ul>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/8215da36b5e1478991e3e0e835a51bc2.png"/>
    </p>
    <h5>
     <a id="223__84">
     </a>
     2.2.3 流量过滤与目标定位
    </h5>
    <ul>
     <li>
      <strong>
       应用过滤器
      </strong>
      <br/>
      为了排除局域网中其他无关流量，可以通过 MAC 地址或 IP 地址过滤目标设备的数据包。例如：在捕获的数据包列表中，右键点击某个目标设备的“接收地址”，选择“应用为过滤器”，只显示该设备的数据通信。
     </li>
    </ul>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/6960bbfd766b495c92496c821067eda7.png"/>
    </p>
    <ul>
     <li>
      <strong>
       HTTP 流量过滤
      </strong>
      <br/>
      在 Wireshark 的过滤器栏中输入
      <code>
       http
      </code>
      ，进一步筛选出 HTTP 协议相关的数据包，聚焦于摄像头视频流的传输数据。
     </li>
    </ul>
    <hr/>
    <h4>
     <a id="23__96">
     </a>
     2.3 主动生成四次握手
    </h4>
    <p>
     在某些情况下，目标设备可能长时间处于稳定连接状态，导致没有新的四次握手被捕获。此时，可以采用“断连重连”策略：
    </p>
    <ul>
     <li>
      <p>
       <strong>
        断开目标连接
       </strong>
       <br/>
       使用工具 MDK3 对目标设备发起断连攻击，迫使其重新连接网络，从而生成新的四次握手包。示例命令如下（确保无线网卡已锁定到目标信道，如信道 12）：
      </p>
      <pre><code class="prism language-bash">mdk3 wlan0mon d <span class="token parameter variable">-c</span> <span class="token number">12</span>
</code></pre>
     </li>
     <li>
      <p>
       <strong>
        观察重新连接
       </strong>
       <br/>
       一旦目标设备重新连接，Wireshark 将捕获到新的四次握手包。使用 airodump-ng 命令辅助检查是否捕获成功，从而确保数据解密的有效性。
      </p>
     </li>
    </ul>
    <hr/>
    <h4>
     <a id="24__112">
     </a>
     2.4 导出与解析截获的图像数据
    </h4>
    <h5>
     <a id="241__HTTP__114">
     </a>
     2.4.1 导出 HTTP 对象
    </h5>
    <ul>
     <li>
      <p>
       <strong>
        停止抓包
       </strong>
       <br/>
       当你确信已经捕获到足够的数据后，停止 Wireshark 的数据捕获过程。
      </p>
     </li>
     <li>
      <p>
       <strong>
        导出数据包内容
       </strong>
       <br/>
       通过 Wireshark 的菜单依次选择“文件” → “导出对象” → “HTTP”，此时会弹出一个对象列表，其中包含了所有经过 HTTP 协议传输的文件。寻找列表中类型为 JPEG 的文件，即为摄像头传输的图像帧。
      </p>
     </li>
    </ul>
    <h5>
     <a id="242__123">
     </a>
     2.4.2 分析与查看截获图像
    </h5>
    <ul>
     <li>
      <p>
       <strong>
        保存文件
       </strong>
       <br/>
       选择目标图像文件，然后点击“保存”或“全部保存”，将文件保存到指定目录。
      </p>
      <p>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/35d1f2d14eb84e64ab15453fbe282db5.png">
        <br/>
        <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/a9b2733c873c4fd1a2b2bb81ef7d3dd7.png"/>
       </img>
      </p>
     </li>
     <li>
      <p>
       <strong>
        打开文件
       </strong>
       <br/>
       直接使用图像查看器打开保存的 JPEG 文件，即可看到目标设备所接收到的摄像头图像。多张连续的图像还可能揭示视频流的动态内容。
      </p>
     </li>
    </ul>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/8e7e8876b8364cdea10dcdd9db226ea5.png"/>
    </p>
    <hr/>
    <h3>
     <a id="3__138">
     </a>
     3. 攻击局限性
    </h3>
    <ul>
     <li>
      <p>
       <strong>
        网络密码必须已知
       </strong>
       <br/>
       如果攻击者不知道目标网络的 Wi-Fi 密码，即使抓到四次握手也无法解密数据。
      </p>
     </li>
     <li>
      <p>
       <strong>
        有效信号范围
       </strong>
       <br/>
       攻击者必须处于足够接近目标网络的范围内，才能捕获到完整的无线信号。如果距离过远，信号强度不足，将影响抓包效果。
      </p>
     </li>
     <li>
      <p>
       <strong>
        目标设备状态
       </strong>
       <br/>
       若摄像头处于关闭状态或未有人观看视频，其传输的流量可能极少，导致抓包难度加大。
      </p>
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="4__151">
     </a>
     4. 防御措施与安全建议
    </h3>
    <p>
     为防止此类攻击，用户和设备管理者可以采取以下安全防护措施：
    </p>
    <ul>
     <li>
      <p>
       <strong>
        启用 HTTPS
       </strong>
       <br/>
       对摄像头管理和预览界面启用 HTTPS 加密，防止数据传输过程中被截获。
      </p>
     </li>
     <li>
      <p>
       <strong>
        强密码策略
       </strong>
       <br/>
       为 Wi-Fi 网络和摄像头管理界面设置高强度密码，并定期更换，避免使用默认密码。
      </p>
     </li>
     <li>
      <p>
       <strong>
        网络隔离
       </strong>
       <br/>
       将摄像头及其他 IoT 设备部署在独立子网内，减少与主网络的交互，降低攻击面。
      </p>
     </li>
     <li>
      <p>
       <strong>
        禁用不必要的端口
       </strong>
       <br/>
       关闭不必要的开放端口，限制对管理接口的访问，降低被扫描和攻击的风险。
      </p>
     </li>
     <li>
      <p>
       <strong>
        定期更新固件
       </strong>
       <br/>
       确保摄像头和其他设备固件及时更新，以修补可能的安全漏洞。
      </p>
     </li>
    </ul>
    <hr/>
    <blockquote>
     <p>
      <strong>
       温馨提示：
      </strong>
      本文所有内容均基于公开技术资料和安全研究，切勿用于任何非法用途，合法合规始终是网络安全工作的前提。
     </p>
    </blockquote>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
  <div class="blog-extension-box" id="blogExtensionBox" style="width:400px;margin:auto;margin-top:12px">
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34333532363434332f:61727469636c652f64657461696c732f313436303631303738" class_="artid" style="display:none">
 </p>
</div>


