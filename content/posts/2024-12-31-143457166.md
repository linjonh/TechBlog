---
layout: post
title: "Unity网络通信part4.Socket"
date: 2024-12-31 00:00:00 +0800
description: "在Unity网络通信的系列探讨中，我们已经了解了序列化和反序列化的基础知识和应用。接下来，我们将深入"
keywords: "unity socket"
categories: ['Unity']
tags: ['网络', '游戏', '开发语言', 'Websocket', 'Unity', 'C']
artid: "143457166"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=143457166
    alt: "Unity网络通信part4.Socket"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=143457166
featuredImagePreview: https://bing.ee123.net/img/rand?artid=143457166
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Unity网络通信（part4.Socket）
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p id="main-toc">
     <strong>
      目录
     </strong>
    </p>
    <p id="%E5%89%8D%E8%A8%80-toc" style="margin-left:0px;">
     <a href="#%E5%89%8D%E8%A8%80" rel="nofollow">
      前言
     </a>
    </p>
    <p id="Socket%E5%A5%97%E6%8E%A5%E5%AD%97%E7%9A%84%E4%BD%9C%E7%94%A8-toc" style="margin-left:0px;">
     <a href="#Socket%E5%A5%97%E6%8E%A5%E5%AD%97%E7%9A%84%E4%BD%9C%E7%94%A8" rel="nofollow">
      Socket套接字的作用
     </a>
    </p>
    <p id="Socket%E7%9A%84%E7%B1%BB%E5%9E%8B-toc" style="margin-left:0px;">
     <a href="#Socket%E7%9A%84%E7%B1%BB%E5%9E%8B" rel="nofollow">
      Socket的类型
     </a>
    </p>
    <p id="%E5%8F%82%E6%95%B0%E4%B8%80-toc" style="margin-left:40px;">
     <a href="#%E5%8F%82%E6%95%B0%E4%B8%80" rel="nofollow">
      参数一
     </a>
    </p>
    <p id="%E5%8F%82%E6%95%B0%E4%BA%8C-toc" style="margin-left:40px;">
     <a href="#%E5%8F%82%E6%95%B0%E4%BA%8C" rel="nofollow">
      参数二
     </a>
    </p>
    <p id="%E5%8F%82%E6%95%B0%E4%B8%89-toc" style="margin-left:40px;">
     <a href="#%E5%8F%82%E6%95%B0%E4%B8%89" rel="nofollow">
      参数三
     </a>
    </p>
    <p id="Socket%E7%9A%84%E5%B8%B8%E7%94%A8%E5%B1%9E%E6%80%A7-toc" style="margin-left:0px;">
     <a href="#Socket%E7%9A%84%E5%B8%B8%E7%94%A8%E5%B1%9E%E6%80%A7" rel="nofollow">
      Socket的常用属性
     </a>
    </p>
    <p id="Socket%E7%9A%84%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95-toc" style="margin-left:0px;">
     <a href="#Socket%E7%9A%84%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95" rel="nofollow">
      Socket的常用方法
     </a>
    </p>
    <p id="Socket%E5%A5%97%E6%8E%A5%E5%AD%97TCP%E9%80%9A%E4%BF%A1-toc" style="margin-left:0px;">
     <a href="#Socket%E5%A5%97%E6%8E%A5%E5%AD%97TCP%E9%80%9A%E4%BF%A1" rel="nofollow">
      Socket套接字TCP通信
     </a>
    </p>
    <p id="TCP%E5%8D%8F%E8%AE%AE%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E7%9A%84%E4%BD%93%E7%8E%B0-toc" style="margin-left:40px;">
     <a href="#TCP%E5%8D%8F%E8%AE%AE%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E7%9A%84%E4%BD%93%E7%8E%B0" rel="nofollow">
      TCP协议三次握手的体现
     </a>
    </p>
    <p id="TCP%E5%8D%8F%E8%AE%AE%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B%E7%9A%84%E4%BD%93%E7%8E%B0-toc" style="margin-left:40px;">
     <a href="#TCP%E5%8D%8F%E8%AE%AE%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B%E7%9A%84%E4%BD%93%E7%8E%B0" rel="nofollow">
      TCP协议四次挥手的体现
     </a>
    </p>
    <p id="%E6%80%BB%E7%BB%93-toc" style="margin-left:0px;">
     <a href="#%E6%80%BB%E7%BB%93" rel="nofollow">
      总结
     </a>
    </p>
    <hr id="hr-toc"/>
    <h2>
     前言
    </h2>
    <p>
     <img alt="" height="394" src="https://i-blog.csdnimg.cn/direct/79a48f1a67bf461e974f2244a8f47905.png" width="812"/>
    </p>
    <p id="">
     在Unity网络通信的系列探讨中，我们已经了解了序列化和反序列化的基础知识和应用。接下来，我们将深入探讨Socket通信，这是Unity网络通信中的核心部分。
    </p>
    <hr/>
    <h2 id="Socket%E5%A5%97%E6%8E%A5%E5%AD%97%E7%9A%84%E4%BD%9C%E7%94%A8">
     Socket套接字的作用
    </h2>
    <p>
     它是C#提供给我们用于网络通信的一个类（在其它语言当中也有对应的Socket类）
     <br/>
     类名：Socket
     <br/>
     命名空间：System.Net.Sockets
    </p>
    <p>
     Socket套接字是支持TCP/IP网络通信的基本操作单位
     <br/>
     一个套接字对象包含以下关键信息：
     <br/>
     <span style="color:#fe2c24;">
      1.本机的IP地址和端口
      <br/>
      2.对方主机的IP地址和端口
      <br/>
      3.双方通信的协议信息
     </span>
    </p>
    <p>
     一个Sccket对象表示一个本地或者远程套接字信息
     <br/>
     它可以被视为一个数据通道
     <br/>
     这个通道连接与客户端和服务端之间
     <br/>
     数据的发送和接受均通过这个通道进行
    </p>
    <p>
     一般在制作长连接游戏时，我们会使用Socket套接字作为我们的通信方案
     <br/>
     我们通过它连接客户端和服务端，通过它来收发消息
     <br/>
     可以把它抽象的想象成一根管子，插在客户端和服务端应用程序上，通过这个管子来传递交换信息
    </p>
    <hr/>
    <h2 id="Socket%E7%9A%84%E7%B1%BB%E5%9E%8B">
     Socket的类型
    </h2>
    <p>
     Socket套接字有3种不同的类型
     <br/>
     <span style="color:#ff9900;">
     </span>
     <span style="color:#fe2c24;">
      1.流套接字
      <br/>
      主要用于实现TCP通信，提供了面向连接、可靠的、有序的、数据无差错且无重复的数据传输服务
      <br/>
      2.数据报套接字
      <br/>
      主要用于实现UDP通信，提供了无连接的通信服务，数据包的长度不能大于32KB，不提供正确性检查，不保证顺序，可能出现重发、丢失等情况
      <br/>
      3.原始套接字（不常用，不深入讲解）
      <br/>
      主要用于实现IP数据包通信，用于直接访问协议的较低层，常用于侦听和分析数据包
     </span>
    </p>
    <p>
     通过Socket的构造函数 我们可以申明不同类型的套接字
    </p>
    <blockquote>
     <p>
      Socket s = new Socket();
     </p>
    </blockquote>
    <h3 id="%E5%8F%82%E6%95%B0%E4%B8%80">
     参数一
    </h3>
    <p>
     AddressFamily 网络寻址 枚举类型，决定寻址方案
    </p>
    <p>
     <span style="color:#fe2c24;">
      常用：
      <br/>
      1.InterNetwork  IPv4寻址
      <br/>
      2.InterNetwork6 IPv6寻址
     </span>
    </p>
    <p>
     做了解：
     <br/>
     1.UNIX          UNIX本地到主机地址
     <br/>
     2.ImpLink       ARPANETIMP地址
     <br/>
     3.Ipx           IPX或SPX地址
     <br/>
     4.Iso           ISO协议的地址
     <br/>
     5.Osi           OSI协议的地址
     <br/>
     7.NetBios       NetBios地址
     <br/>
     9.Atm           本机ATM服务地址
    </p>
    <p>
    </p>
    <h3 id="%E5%8F%82%E6%95%B0%E4%BA%8C">
     参数二
    </h3>
    <p>
     SocketType 套接字枚举类型，决定使用的套接字类型
    </p>
    <p>
     <span style="color:#fe2c24;">
      常用：
      <br/>
      1.Dgram         支持数据报，最大长度固定的无连接、不可靠的消息(主要用于UDP通信)
      <br/>
      2.Stream        支持可靠、双向、基于连接的字节流（主要用于TCP通信）
     </span>
    </p>
    <p>
     做了解：
     <br/>
     1.Raw           支持对基础传输协议的访问
     <br/>
     2.Rdm           支持无连接、面向消息、以可靠方式发送的消息
     <br/>
     3.Seqpacket     提供排序字节流的面向连接且可靠的双向传输
    </p>
    <p>
    </p>
    <h3 id="%E5%8F%82%E6%95%B0%E4%B8%89">
     参数三
    </h3>
    <p>
     ProtocolType 协议类型枚举类型，决定套接字使用的通信协议
    </p>
    <p>
     <span style="color:#fe2c24;">
      常用：
      <br/>
      1.TCP           TCP传输控制协议
      <br/>
      2.UDP           UDP用户数据报协议
     </span>
    </p>
    <p>
     做了解：
     <br/>
     1.IP            IP网际协议
     <br/>
     2.Icmp          Icmp网际消息控制协议
     <br/>
     3.Igmp          Igmp网际组管理协议
     <br/>
     4.Ggp           网关到网关协议
     <br/>
     5.IPv4          Internet协议版本4
     <br/>
     6.Pup           PARC通用数据包协议
     <br/>
     7.Idp           Internet数据报协议
     <br/>
     8.Raw           原始IP数据包协议
     <br/>
     9.Ipx           Internet数据包交换协议
     <br/>
     10.Spx          顺序包交换协议
     <br/>
     11.IcmpV6       用于IPv6的Internet控制消息协议
    </p>
    <p>
     参数的常用搭配：
     <br/>
     SocketType.Dgram + ProtocolType.Udp = UDP协议通信（常用，主要学习）
     <br/>
     SocketType.Stream + ProtocolType.Tcp = TCP协议通信（常用，主要学习）
     <br/>
     SocketType.Raw + ProtocolType.Icmp = Internet控制报文协议（了解）
     <br/>
     SocketType.Raw + ProtocolType.Raw = 简单的IP包通信（了解）
    </p>
    <p>
     <span style="color:#fe2c24;">
      我们必须掌握的
     </span>
    </p>
    <blockquote>
     <p>
      //TCP流套接字
      <br/>
      Socket socketTcp = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
     </p>
     <p>
      //UDP数据报套接字
      <br/>
      Socket socketUdp = new Socket(AddressFamily.InterNetwork, SocketType.Dgram, ProtocolType.Udp);
     </p>
    </blockquote>
    <hr/>
    <h2 id="Socket%E7%9A%84%E5%B8%B8%E7%94%A8%E5%B1%9E%E6%80%A7">
     Socket的常用属性
    </h2>
    <blockquote>
     <p>
      //1.套接字的连接状态
      <br/>
      if(socketTcp.Connected)
      <br/>
      {
      <!-- -->
     </p>
     <p>
      }
      <br/>
      //2.获取套接字的类型
      <br/>
      print(socketTcp.SocketType);
      <br/>
      //3.获取套接字的协议类型
      <br/>
      print(socketTcp.ProtocolType);
      <br/>
      //4.获取套接字的寻址方案
      <br/>
      print(socketTcp.AddressFamily);
     </p>
     <p>
      //5.从网络中获取准备读取的数据数据量
      <br/>
      print(socketTcp.Available);
     </p>
     <p>
      //6.获取本机EndPoint对象(注意 ：IPEndPoint继承EndPoint)
      <br/>
      //socketTcp.LocalEndPoint as IPEndPoint
     </p>
     <p>
      //7.获取远程EndPoint对象
      <br/>
      //socketTcp.RemoteEndPoint as IPEndPoint
     </p>
    </blockquote>
    <hr/>
    <h2 id="Socket%E7%9A%84%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95" style="background-color:transparent;">
     Socket的常用方法
    </h2>
    <blockquote>
     <p>
      //1.主要用于服务端
      <br/>
      //  1-1:绑定IP和端口
      <br/>
      IPEndPoint ipPoint = new IPEndPoint(IPAddress.Parse("127.0.0.1"), 8080);
      <br/>
      socketTcp.Bind(ipPoint);
      <br/>
      //  1-2:设置客户端连接的最大数量
      <br/>
      socketTcp.Listen(10);
      <br/>
      //  1-3:等待客户端连入
      <br/>
      socketTcp.Accept();
     </p>
     <p>
      //2.主要用于客户端
      <br/>
      //  1-1:连接远程服务端
      <br/>
      socketTcp.Connect(IPAddress.Parse("118.12.123.11"), 8080);
     </p>
     <p>
      //3.客户端服务端都会用的
      <br/>
      //  1-1:同步发送和接收数据
      <br/>
      //  1-2:异步发送和接收数据
      <br/>
      //  1-3:释放连接并关闭Socket，先与Close调用
      <br/>
      socketTcp.Shutdown(SocketShutdown.Both);
      <br/>
      //  1-4:关闭连接，释放所有Socket关联资源
      <br/>
      socketTcp.Close();
     </p>
    </blockquote>
    <p>
     <span style="color:#fe2c24;">
      TCP和UDP两种长连接通信方案都是基于Socket套接字的
     </span>
    </p>
    <h2 id="Socket%E5%A5%97%E6%8E%A5%E5%AD%97TCP%E9%80%9A%E4%BF%A1">
     Socket套接字TCP通信
    </h2>
    <p class="img-center">
     <img alt="" height="656" src="https://i-blog.csdnimg.cn/direct/410ccde77b054688b11d1afb2b3d93e9.png" width="356"/>
    </p>
    <h3 id="TCP%E5%8D%8F%E8%AE%AE%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E7%9A%84%E4%BD%93%E7%8E%B0">
     TCP协议三次握手的体现
    </h3>
    <p>
     <img alt="" height="441" src="https://i-blog.csdnimg.cn/direct/80551bb3eb0e4cf99dde4bc21a8ea627.png" width="483"/>
    </p>
    <p>
     <img alt="" height="534" src="https://i-blog.csdnimg.cn/direct/99b0f1a6481645dda764c27537957d4e.png" width="535"/>
    </p>
    <h3 id="TCP%E5%8D%8F%E8%AE%AE%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B%E7%9A%84%E4%BD%93%E7%8E%B0" style="background-color:transparent;">
     TCP协议四次挥手的体现
    </h3>
    <p>
     <img alt="" height="491" src="https://i-blog.csdnimg.cn/direct/442bd7c8214e4fd6b14207679b8e4bcf.png" width="507"/>
    </p>
    <p>
     <img alt="" height="558" src="https://i-blog.csdnimg.cn/direct/0e4b06af4dde4d398452fabd3564f9fb.png" width="504"/>
    </p>
    <h2 id="%E6%80%BB%E7%BB%93">
     总结
    </h2>
    <p>
     Socket通信是Unity网络通信中的基础且重要的部分。通过深入理解Socket的原理和使用方法，开发者可以实现高效、安全、可靠的网络通信功能，为Unity游戏或应用提供稳定的网络连接和数据传输服务。
    </p>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f36373637343638362f:61727469636c652f64657461696c732f313433343537313636" class_="artid" style="display:none">
 </p>
</div>


