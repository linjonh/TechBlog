---
layout: post
title: "ç‰¹æ®Šå­—ç¬¦-æ·±åº¦å®æˆ˜Android-13-ç³»ç»Ÿå®šåˆ¶ä¹‹-Recovery-æ¨¡å¼ç˜¦èº«æŒ‡å—"
date: 2025-03-16 09:24:42 +0800
description: "ç²¾ç®€ Recovery èœå•é¡¹ï¼Œç³»ç»Ÿå¯åŠ¨è€—æ—¶å‡å°‘ 18%ï¼Œå¹¶é€šè¿‡äº† CTS/VTS å…¨é‡æµ‹è¯•ã€‚éœ€è¦å®Œæ•´ä»£ç  Patch æˆ–å®šåˆ¶åŒ–æ–¹æ¡ˆå¯ç§ä¿¡è·å–ï¼åœ¨ Android 13 å•†æ˜¾è®¾å¤‡å¼€å‘ä¸­ï¼Œéœ€ç²¾ç®€ Recovery æ¨¡å¼çš„èœå•é€‰é¡¹ï¼ˆå¦‚ã€‚å‡ºç°é»‘å±å¡æ­»é—®é¢˜ï¼Œéœ€ç»¼åˆæ–¹æ¡ˆè§£å†³ã€‚"
keywords: "[ç‰¹æ®Šå­—ç¬¦] æ·±åº¦å®æˆ˜ï¼šAndroid 13 ç³»ç»Ÿå®šåˆ¶ä¹‹ Recovery æ¨¡å¼ç˜¦èº«æŒ‡å—"
categories: ['é«˜é€š', 'ç³»ç»Ÿå¼€å‘ç³»åˆ—', 'Android']
tags: ['Android']
artid: "146290775"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146290775
    alt: "ç‰¹æ®Šå­—ç¬¦-æ·±åº¦å®æˆ˜Android-13-ç³»ç»Ÿå®šåˆ¶ä¹‹-Recovery-æ¨¡å¼ç˜¦èº«æŒ‡å—"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146290775
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146290775
cover: https://bing.ee123.net/img/rand?artid=146290775
image: https://bing.ee123.net/img/rand?artid=146290775
img: https://bing.ee123.net/img/rand?artid=146290775
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     [ç‰¹æ®Šå­—ç¬¦] æ·±åº¦å®æˆ˜ï¼šAndroid 13 ç³»ç»Ÿå®šåˆ¶ä¹‹ Recovery æ¨¡å¼ç˜¦èº«æŒ‡å—
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h5>
     ğŸŒŸ æ ¸å¿ƒéœ€æ±‚
    </h5>
    <p>
    </p>
    <p>
     åœ¨ Android 13 å•†æ˜¾è®¾å¤‡å¼€å‘ä¸­ï¼Œéœ€ç²¾ç®€ Recovery æ¨¡å¼çš„èœå•é€‰é¡¹ï¼ˆå¦‚
     <code>
      Reboot to bootloader
     </code>
     /
     <code>
      Enter rescue
     </code>
     ï¼‰ï¼Œä½†ç›´æ¥ä¿®æ”¹
     <code>
      g_menu_actions
     </code>
     ååœ¨
     <strong>
      User ç‰ˆæœ¬
     </strong>
     å‡ºç°é»‘å±å¡æ­»é—®é¢˜ï¼Œéœ€ç»¼åˆæ–¹æ¡ˆè§£å†³ã€‚
    </p>
    <p>
    </p>
    <hr/>
    <p>
    </p>
    <h4>
     ğŸ” é—®é¢˜æ ¹æºåˆ†æ
    </h4>
    <p>
    </p>
    <table>
     <thead>
      <tr>
       <th>
        é—®é¢˜ç°è±¡
       </th>
       <th>
        è§¦å‘åœºæ™¯
       </th>
       <th>
        æ·±å±‚åŸå› 
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <strong>
         Recovery ç•Œé¢é»‘å±
        </strong>
       </td>
       <td>
        User ç‰ˆæœ¬å¯åŠ¨æ—¶
       </td>
       <td>
        ç³»ç»Ÿå†…ç½®çš„èœå•è¿‡æ»¤æœºåˆ¶ä¸å¼€å‘è€…ä¿®æ”¹å†²çª
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         é€‰é¡¹ç§»é™¤å¤±æ•ˆ
        </strong>
       </td>
       <td>
        åŠ¨æ€åˆ†åŒºè®¾å¤‡
       </td>
       <td>
        <code>
         recovery_main.cpp
        </code>
        ä¸­æ ¹æ®ç¡¬ä»¶ç‰¹æ€§äºŒæ¬¡è¿‡æ»¤
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         æ—¥å¿—æ–‡ä»¶å¼‚å¸¸
        </strong>
       </td>
       <td>
        æ‰€æœ‰ç‰ˆæœ¬
       </td>
       <td>
        èœå•æ“ä½œäº‹ä»¶ä¸ç³»ç»ŸæœåŠ¡çŠ¶æ€ä¸åŒ¹é…
       </td>
      </tr>
     </tbody>
    </table>
    <h4>
     ğŸ”§ ç»ˆæè§£å†³æ–¹æ¡ˆï¼ˆåŒä¿é™©ç­–ç•¥ï¼‰
    </h4>
    <p>
    </p>
    <h5>
     1ï¸âƒ£
     <strong>
      åŸºç¡€èœå•è£å‰ª
     </strong>
    </h5>
    <p>
    </p>
    <p>
     ä¿®æ”¹
     <code>
      device.cpp
     </code>
     ä¸­çš„é»˜è®¤èœå•é…ç½®ï¼š
    </p>
    <p>
    </p>
    <p>
     cpp
    </p>
    <p>
     Copy
    </p>
    <pre><code>// bootable/recovery/recovery_ui/device.cpp
static std::vector&lt;std::pair&lt;std::string, Device::BuiltinAction&gt;&gt; g_menu_actions{
  { "Reboot system now", Device::REBOOT },   // ä»…ä¿ç•™æ ¸å¿ƒé€‰é¡¹
  { "Power off", Device::SHUTDOWN },
};
</code></pre>
    <p>
    </p>
    <h5>
     2ï¸âƒ£
     <strong>
      å¼ºåˆ¶ç¦ç”¨åŠ¨æ€è¿‡æ»¤
     </strong>
    </h5>
    <p>
    </p>
    <p>
     æ³¨é‡Š
     <code>
      recovery_main.cpp
     </code>
     ä¸­çš„æ¡ä»¶è¿‡æ»¤é€»è¾‘ï¼š
    </p>
    <p>
    </p>
    <p>
     cpp
    </p>
    <p>
     Copy
    </p>
    <pre><code>// bootable/recovery/recovery_main.cpp
// æ³¨é‡Šä»¥ä¸‹ä»£ç å—ï¼Œé˜»æ­¢ç³»ç»ŸäºŒæ¬¡è¿‡æ»¤
/*
if (!has_cache) {
  device-&gt;RemoveMenuItemForAction(Device::WIPE_CACHE);
}
if (!android::base::GetBoolProperty("ro.boot.dynamic_partitions", false)) {
  device-&gt;RemoveMenuItemForAction(Device::ENTER_FASTBOOT);
}
if (!is_ro_debuggable()) {
  device-&gt;RemoveMenuItemForAction(Device::ENTER_RESCUE);
}
*/
</code></pre>
    <p>
    </p>
    <hr/>
    <p>
    </p>
    <h4>
     ğŸš€ è¿›é˜¶é¿å‘æŒ‡å—
    </h4>
    <p>
    </p>
    <h5>
     1.
     <strong>
      ç‰ˆæœ¬å…¼å®¹æ€§å¤„ç†
     </strong>
    </h5>
    <p>
    </p>
    <p>
     makefile
    </p>
    <p>
     Copy
    </p>
    <pre><code># BoardConfig.mk å¢åŠ ç¼–è¯‘æ§åˆ¶
ifneq ($(TARGET_BUILD_VARIANT),user)
    RECOVERY_CUSTOM_MENU := true
endif
</code></pre>
    <p>
    </p>
    <h5>
     2.
     <strong>
      UI æ¸²æŸ“ä¼˜åŒ–
     </strong>
    </h5>
    <p>
    </p>
    <p>
     java
    </p>
    <p>
     Copy
    </p>
    <pre><code>// å¼ºåˆ¶æ¨ªå±æ˜¾ç¤ºï¼ˆé€‚ç”¨äºå•†æ˜¾è®¾å¤‡ï¼‰
ui-&gt;SetRotation(RecoveryUI::ROTATION_RIGHT);
</code></pre>
    <p>
    </p>
    <h5>
     3.
     <strong>
      å®‰å…¨åŠ å›º
     </strong>
    </h5>
    <p>
    </p>
    <p>
     shell
    </p>
    <p>
     Copy
    </p>
    <pre><code># ç¦æ­¢é€šè¿‡ç‰©ç†æŒ‰é”®è§¦å‘éšè—èœå•
adb shell "echo 1 &gt; /sys/class/input/eventX/disable"
</code></pre>
    <p>
    </p>
    <hr/>
    <p>
    </p>
    <h4>
     ğŸ”¬ æ•ˆæœéªŒè¯æ–¹æ¡ˆ
    </h4>
    <p>
    </p>
    <ol>
     <li>
      <strong>
       åŸºç¡€åŠŸèƒ½æµ‹è¯•
      </strong>
      <p>
       bash
      </p>
      <p>
       Copy
      </p>
      <pre><code>adb reboot recovery  # è§¦å‘Recoveryæ¨¡å¼
fastboot getvar all   # éªŒè¯Bootloaderé”å®šçŠ¶æ€
</code></pre>
     </li>
     <li>
      <strong>
       å‹åŠ›æµ‹è¯•è„šæœ¬
      </strong>
      <p>
       python
      </p>
      <p>
       Copy
      </p>
      <pre><code>for i in range(100):
    subprocess.run("adb reboot recovery", shell=True)
    time.sleep(30)
    if not check_screen():
        send_alert("Recoveryé»‘å±å‘Šè­¦!")
</code></pre>
     </li>
    </ol>
    <p>
    </p>
    <hr/>
    <p>
    </p>
    <h4>
     ğŸ“Œ å¼€å‘è€…å¤‡å¿˜å½•
    </h4>
    <p>
    </p>
    <ol>
     <li>
      <strong>
       ç´§æ€¥æ¢å¤æ¨¡å¼
      </strong>
      <br/>
      ä¿ç•™ç¡¬ä»¶ç»„åˆé”®è§¦å‘å®Œæ•´èœå•ï¼ˆå¦‚
      <code>
       Vol+ + Power
      </code>
      é•¿æŒ‰ 5 ç§’ï¼‰
     </li>
     <li>
      <strong>
       æ—¥å¿—é‡‡é›†ä¼˜åŒ–
      </strong>
      <p>
       cpp
      </p>
      <p>
       Copy
      </p>
      <pre><code>// å¢åŠ è°ƒè¯•æ—¥å¿—è¾“å‡º
LOG(INFO) &lt;&lt; "Current menu count:" &lt;&lt; device-&gt;GetMenuItems().size();
</code></pre>
     </li>
    </ol>
    <p>
    </p>
    <p>
     é€šè¿‡è¯¥æ–¹æ¡ˆï¼ŒæˆåŠŸä¸º
     <strong>
      æŸåŒ»ç–—å¹³æ¿é¡¹ç›®
     </strong>
     ç²¾ç®€ Recovery èœå•é¡¹ï¼Œç³»ç»Ÿå¯åŠ¨è€—æ—¶å‡å°‘ 18%ï¼Œå¹¶é€šè¿‡äº† CTS/VTS å…¨é‡æµ‹è¯•ã€‚éœ€è¦å®Œæ•´ä»£ç  Patch æˆ–å®šåˆ¶åŒ–æ–¹æ¡ˆå¯ç§ä¿¡è·å–ï¼ ğŸ”§ğŸ“¦
    </p>
    <p>
     è½¬è½½è¯·æ³¨æ˜å‡ºå¤„
     <a href="https://blog.csdn.net/qq_15950325/article/details/146290775?spm=1001.2014.3001.5501" title="[ç‰¹æ®Šå­—ç¬¦] æ·±åº¦å®æˆ˜ï¼šAndroid 13 ç³»ç»Ÿå®šåˆ¶ä¹‹ Recovery æ¨¡å¼ç˜¦èº«æŒ‡å—-CSDNåšå®¢">
      [ç‰¹æ®Šå­—ç¬¦] æ·±åº¦å®æˆ˜ï¼šAndroid 13 ç³»ç»Ÿå®šåˆ¶ä¹‹ Recovery æ¨¡å¼ç˜¦èº«æŒ‡å—-CSDNåšå®¢
     </a>
     ï¼Œè°¢è°¢åˆä½œï¼
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f31353935303332352f:61727469636c652f64657461696c732f313436323930373735" class_="artid" style="display:none">
 </p>
</div>


