---
arturl_encode: "68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f31353935303332352f:61727469636c652f64657461696c732f313436323930373735"
layout: post
title: "ç‰¹æ®Šå­—ç¬¦-æ·±åº¦å®æˆ˜Android-13-ç³»ç»Ÿå®šåˆ¶ä¹‹-Recovery-æ¨¡å¼ç˜¦èº«æŒ‡å—"
date: 2025-03-16 09:24:42 +0800
description: "ç²¾ç®€ Recovery èœå•é¡¹ï¼Œç³»ç»Ÿå¯åŠ¨è€—æ—¶å‡å°‘ 18%ï¼Œå¹¶é€šè¿‡äº† CTS/VTS å…¨é‡æµ‹è¯•ã€‚éœ€è¦å®Œæ•´ä»£ç  Patch æˆ–å®šåˆ¶åŒ–æ–¹æ¡ˆå¯ç§ä¿¡è·å–ï¼åœ¨ Android 13 å•†æ˜¾è®¾å¤‡å¼€å‘ä¸­ï¼Œéœ€ç²¾ç®€ Recovery æ¨¡å¼çš„èœå•é€‰é¡¹ï¼ˆå¦‚ã€‚å‡ºç°é»‘å±å¡æ­»é—®é¢˜ï¼Œéœ€ç»¼åˆæ–¹æ¡ˆè§£å†³ã€‚"
keywords: "[ç‰¹æ®Šå­—ç¬¦] æ·±åº¦å®æˆ˜ï¼šAndroid 13 ç³»ç»Ÿå®šåˆ¶ä¹‹ Recovery æ¨¡å¼ç˜¦èº«æŒ‡å—"
categories: ['é«˜é€š', 'ç³»ç»Ÿå¼€å‘ç³»åˆ—', 'Android']
tags: ['Android']
artid: "146290775"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146290775
    alt: "ç‰¹æ®Šå­—ç¬¦-æ·±åº¦å®æˆ˜Android-13-ç³»ç»Ÿå®šåˆ¶ä¹‹-Recovery-æ¨¡å¼ç˜¦èº«æŒ‡å—"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146290775
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146290775
cover: https://bing.ee123.net/img/rand?artid=146290775
image: https://bing.ee123.net/img/rand?artid=146290775
img: https://bing.ee123.net/img/rand?artid=146290775
---

# [ç‰¹æ®Šå­—ç¬¦] æ·±åº¦å®æˆ˜ï¼šAndroid 13 ç³»ç»Ÿå®šåˆ¶ä¹‹ Recovery æ¨¡å¼ç˜¦èº«æŒ‡å—

##### ğŸŒŸ æ ¸å¿ƒéœ€æ±‚

åœ¨ Android 13 å•†æ˜¾è®¾å¤‡å¼€å‘ä¸­ï¼Œéœ€ç²¾ç®€ Recovery æ¨¡å¼çš„èœå•é€‰é¡¹ï¼ˆå¦‚
`Reboot to bootloader`
/
`Enter rescue`
ï¼‰ï¼Œä½†ç›´æ¥ä¿®æ”¹
`g_menu_actions`
ååœ¨
**User ç‰ˆæœ¬**
å‡ºç°é»‘å±å¡æ­»é—®é¢˜ï¼Œéœ€ç»¼åˆæ–¹æ¡ˆè§£å†³ã€‚

---

#### ğŸ” é—®é¢˜æ ¹æºåˆ†æ

| é—®é¢˜ç°è±¡ | è§¦å‘åœºæ™¯ | æ·±å±‚åŸå›  |
| --- | --- | --- |
| **Recovery ç•Œé¢é»‘å±** | User ç‰ˆæœ¬å¯åŠ¨æ—¶ | ç³»ç»Ÿå†…ç½®çš„èœå•è¿‡æ»¤æœºåˆ¶ä¸å¼€å‘è€…ä¿®æ”¹å†²çª |
| **é€‰é¡¹ç§»é™¤å¤±æ•ˆ** | åŠ¨æ€åˆ†åŒºè®¾å¤‡ | `recovery_main.cpp` ä¸­æ ¹æ®ç¡¬ä»¶ç‰¹æ€§äºŒæ¬¡è¿‡æ»¤ |
| **æ—¥å¿—æ–‡ä»¶å¼‚å¸¸** | æ‰€æœ‰ç‰ˆæœ¬ | èœå•æ“ä½œäº‹ä»¶ä¸ç³»ç»ŸæœåŠ¡çŠ¶æ€ä¸åŒ¹é… |

#### ğŸ”§ ç»ˆæè§£å†³æ–¹æ¡ˆï¼ˆåŒä¿é™©ç­–ç•¥ï¼‰

##### 1ï¸âƒ£ **åŸºç¡€èœå•è£å‰ª**

ä¿®æ”¹
`device.cpp`
ä¸­çš„é»˜è®¤èœå•é…ç½®ï¼š

cpp

Copy

```
// bootable/recovery/recovery_ui/device.cpp
static std::vector<std::pair<std::string, Device::BuiltinAction>> g_menu_actions{
  { "Reboot system now", Device::REBOOT },   // ä»…ä¿ç•™æ ¸å¿ƒé€‰é¡¹
  { "Power off", Device::SHUTDOWN },
};

```

##### 2ï¸âƒ£ **å¼ºåˆ¶ç¦ç”¨åŠ¨æ€è¿‡æ»¤**

æ³¨é‡Š
`recovery_main.cpp`
ä¸­çš„æ¡ä»¶è¿‡æ»¤é€»è¾‘ï¼š

cpp

Copy

```
// bootable/recovery/recovery_main.cpp
// æ³¨é‡Šä»¥ä¸‹ä»£ç å—ï¼Œé˜»æ­¢ç³»ç»ŸäºŒæ¬¡è¿‡æ»¤
/*
if (!has_cache) {
  device->RemoveMenuItemForAction(Device::WIPE_CACHE);
}
if (!android::base::GetBoolProperty("ro.boot.dynamic_partitions", false)) {
  device->RemoveMenuItemForAction(Device::ENTER_FASTBOOT);
}
if (!is_ro_debuggable()) {
  device->RemoveMenuItemForAction(Device::ENTER_RESCUE);
}
*/

```

---

#### ğŸš€ è¿›é˜¶é¿å‘æŒ‡å—

##### 1. **ç‰ˆæœ¬å…¼å®¹æ€§å¤„ç†**

makefile

Copy

```
# BoardConfig.mk å¢åŠ ç¼–è¯‘æ§åˆ¶
ifneq ($(TARGET_BUILD_VARIANT),user)
    RECOVERY_CUSTOM_MENU := true
endif

```

##### 2. **UI æ¸²æŸ“ä¼˜åŒ–**

java

Copy

```
// å¼ºåˆ¶æ¨ªå±æ˜¾ç¤ºï¼ˆé€‚ç”¨äºå•†æ˜¾è®¾å¤‡ï¼‰
ui->SetRotation(RecoveryUI::ROTATION_RIGHT);

```

##### 3. **å®‰å…¨åŠ å›º**

shell

Copy

```
# ç¦æ­¢é€šè¿‡ç‰©ç†æŒ‰é”®è§¦å‘éšè—èœå•
adb shell "echo 1 > /sys/class/input/eventX/disable"

```

---

#### ğŸ”¬ æ•ˆæœéªŒè¯æ–¹æ¡ˆ

1. **åŸºç¡€åŠŸèƒ½æµ‹è¯•**

   bash

   Copy

   ```
   adb reboot recovery  # è§¦å‘Recoveryæ¨¡å¼
   fastboot getvar all   # éªŒè¯Bootloaderé”å®šçŠ¶æ€

   ```
2. **å‹åŠ›æµ‹è¯•è„šæœ¬**

   python

   Copy

   ```
   for i in range(100):
       subprocess.run("adb reboot recovery", shell=True)
       time.sleep(30)
       if not check_screen():
           send_alert("Recoveryé»‘å±å‘Šè­¦!")

   ```

---

#### ğŸ“Œ å¼€å‘è€…å¤‡å¿˜å½•

1. **ç´§æ€¥æ¢å¤æ¨¡å¼**
     
   ä¿ç•™ç¡¬ä»¶ç»„åˆé”®è§¦å‘å®Œæ•´èœå•ï¼ˆå¦‚
   `Vol+ + Power`
   é•¿æŒ‰ 5 ç§’ï¼‰
2. **æ—¥å¿—é‡‡é›†ä¼˜åŒ–**

   cpp

   Copy

   ```
   // å¢åŠ è°ƒè¯•æ—¥å¿—è¾“å‡º
   LOG(INFO) << "Current menu count:" << device->GetMenuItems().size();

   ```

é€šè¿‡è¯¥æ–¹æ¡ˆï¼ŒæˆåŠŸä¸º
**æŸåŒ»ç–—å¹³æ¿é¡¹ç›®**
ç²¾ç®€ Recovery èœå•é¡¹ï¼Œç³»ç»Ÿå¯åŠ¨è€—æ—¶å‡å°‘ 18%ï¼Œå¹¶é€šè¿‡äº† CTS/VTS å…¨é‡æµ‹è¯•ã€‚éœ€è¦å®Œæ•´ä»£ç  Patch æˆ–å®šåˆ¶åŒ–æ–¹æ¡ˆå¯ç§ä¿¡è·å–ï¼ ğŸ”§ğŸ“¦

è½¬è½½è¯·æ³¨æ˜å‡ºå¤„
[[ç‰¹æ®Šå­—ç¬¦] æ·±åº¦å®æˆ˜ï¼šAndroid 13 ç³»ç»Ÿå®šåˆ¶ä¹‹ Recovery æ¨¡å¼ç˜¦èº«æŒ‡å—-CSDNåšå®¢](https://blog.csdn.net/qq_15950325/article/details/146290775?spm=1001.2014.3001.5501 "[ç‰¹æ®Šå­—ç¬¦] æ·±åº¦å®æˆ˜ï¼šAndroid 13 ç³»ç»Ÿå®šåˆ¶ä¹‹ Recovery æ¨¡å¼ç˜¦èº«æŒ‡å—-CSDNåšå®¢")
ï¼Œè°¢è°¢åˆä½œï¼