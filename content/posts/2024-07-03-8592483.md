---
layout: post
title: "TC脚本开发-窗口句柄的捕捉方法总结"
date: 2024-07-03 08:40:54 +0800
description: "标题获得方法：整型 窗口句柄窗口句柄=窗口.找到窗口(\"脚本编写算法.txt - 记事本“)如果(窗"
keywords: "tc窗口快速找字"
categories: ['Tc']
tags: ['脚本开发', 'Tc', 'Tc']
artid: "8592483"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=8592483
    alt: "TC脚本开发-窗口句柄的捕捉方法总结"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=8592483
featuredImagePreview: https://bing.ee123.net/img/rand?artid=8592483
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     TC脚本开发-窗口句柄的捕捉方法总结
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     <span style="font-size:14px">
      <span style="color:#000099">
       标题获得方法：
      </span>
     </span>
    </p>
    <p>
    </p>
    <p align="left">
     <span style="font-size:14px">
      <span style="color:blue">
       整型
      </span>
      窗口句柄
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      窗口句柄=窗口.找到窗口(
      <span style="color:#ff0000">
       "脚本编写算法.txt - 记事本“
      </span>
      )
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      <span style="color:blue">
       如果
      </span>
      (窗口句柄==0)
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      辅助.消息框("没有找到窗口")
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      <br/>
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      红色字体为窗口标题，必须输入准确的标题，不支持模糊捕捉。
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      要找到准确的标题 可以用AB抓抓捕捉.
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      AB抓抓使用方法：先点击 下图的鼠标窗口句柄。   然后 点击F9热键 开始捕捉，发现随着鼠标的移动在不同窗口之间，会捕捉到相关的信息.
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      我们把鼠标指在记事本的蓝条标题栏上 就捕捉到了 我们需要的标题.
     </span>
    </p>
    <p align="left">
     <img alt="" src="https://img-my.csdn.net/uploads/201302/19/1361279637_9490.png">
      <br/>
     </img>
    </p>
    <p align="left">
     <span style="font-size:14px; color:#ff0000">
      PS：有些游戏由于有游戏保护，AB抓抓会捕捉不到它的信息.我们只能再试试下面的其他方法.
     </span>
    </p>
    <span style="font-size:14px">
     <br/>
    </span>
    <p>
     <span style="font-size:14px">
     </span>
    </p>
    <p align="left">
     <strong>
      <span style="font-size:14px">
       <span style="color:#000099">
        顶层句柄-窗口得到顶层句柄
       </span>
      </span>
     </strong>
    </p>
    <p align="left">
     <span style="font-size:14px">
      命名空间: 窗口
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      函数功能:得到顶层窗口句柄
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      函数原型:
      <span style="color:blue">
       整型
      </span>
      <strong>
      </strong>
      顶层窗口句柄()
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      参数:
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      无
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      返回值: 返回整型类型的顶层窗口句柄整型值
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      举例:
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      窗口.顶层窗口句柄()
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      <br/>
     </span>
    </p>
    <p align="left">
     <u>
      <span style="color:purple">
       <span style="font-size:14px">
        详细举例
       </span>
      </span>
     </u>
    </p>
    <p align="left">
     <span style="font-size:14px">
      <span style="color:blue">
       整型
      </span>
      窗口句柄
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      <span style="color:blue">
       字符型
      </span>
      顶层句柄
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      窗口句柄=窗口.顶层窗口句柄()
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      顶层句柄=转换.整型转字符型(窗口句柄)
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      辅助.消息框(顶层句柄)
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      执行结果：得到当前活动的窗口句柄  721486
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      <br/>
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      <br/>
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px; color:#ff0000">
      PS：可以得到有游戏保护的窗口句柄，已测试.
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      <br/>
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      <br/>
     </span>
    </p>
    <p align="left">
     <strong>
      <span style="font-size:14px">
       <span style="color:#000099">
        鼠标所在窗口句柄-得到鼠标窗口句柄
       </span>
      </span>
     </strong>
    </p>
    <p align="left">
     <span style="font-size:14px">
      命名空间: 窗口
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      函数功能:得到鼠标移动的窗口句柄
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      函数原型:
      <span style="color:blue">
       整型
      </span>
      鼠标所在窗口句柄()
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      参数:
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      无
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      返回值: 返回
      <span style="color:blue">
       整型
      </span>
      类型的窗口句柄整型值
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      举例:
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      窗口.鼠标所在窗口句柄()
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      <br/>
     </span>
    </p>
    <p align="left">
     <u>
      <span style="color:purple">
       <span style="font-size:14px">
        详细举例
       </span>
      </span>
     </u>
    </p>
    <p align="left">
     <span style="font-size:14px">
      <span style="color:blue">
       整型
      </span>
      窗口句柄
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      <span style="color:blue">
       字符型
      </span>
      鼠标所在窗口句柄
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      窗口句柄=窗口.鼠标所在窗口句柄()
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      鼠标所在窗口句柄=转换.整型转字符型(窗口句柄)
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      辅助.消息框(鼠标所在窗口句柄)
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      执行结果：得到鼠标移动的窗口句柄 3277994
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      <br/>
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      <span style="color:rgb(255,0,0); font-size:14px">
       PS：可以得到有游戏保护的窗口句柄，已测试.
      </span>
      <br/>
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      <br/>
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      <br/>
     </span>
    </p>
    <p align="left">
     <strong>
      <span style="font-size:14px; background-color:rgb(255,255,255)">
       <span style="color:#000099">
        焦点窗口-得到当前焦点窗口
       </span>
      </span>
     </strong>
    </p>
    <p align="left">
     <span style="font-size:14px">
      命名空间: 窗口
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      函数功能:得到当前焦点的窗口句柄
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      函数原型:
      <span style="color:blue">
       整型
      </span>
      当前焦点句柄()
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      参数:
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      无
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      返回值: 返回整型类型的焦点窗口句柄整型值
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      举例:
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      窗口.焦点窗口()
     </span>
    </p>
    <p align="left">
     <u>
      <span style="color:purple">
       <span style="font-size:14px">
        详细举例
       </span>
      </span>
     </u>
    </p>
    <p align="left">
     <span style="font-size:14px">
      <span style="color:blue">
       整型
      </span>
      焦点窗口句柄
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      <span style="color:blue">
       字符型
      </span>
      内容
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      焦点窗口句柄=窗口.焦点窗口()
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      内容=转换.整型转字符型(焦点窗口句柄)
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      辅助.消息框(内容)
     </span>
    </p>
    <p align="left">
     <span style="font-size:14px">
      执行结果: 得到当前键盘焦点的窗口句柄 2490940
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      <span style="color:rgb(255,0,0); font-size:14px">
       PS：可以得到有游戏保护的窗口句柄，已测试.
      </span>
      <br/>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      <br/>
     </span>
    </p>
    <p>
     <span style="background-color:rgb(255,255,255)">
      <span style="font-size:14px; color:#000099">
       枚举
      </span>
     </span>
    </p>
    <p>
    </p>
    <table cellspacing="0" style="border-left:#ccc 1px solid; border-top:#ccc 1px solid" width="100%">
     <tbody>
      <tr style="height:25px">
       <td align="middle" class="tdwidth tdline bgblue">
        功能原型：
       </td>
       <td class="tdline bgblue" style="padding-left:5px; background:#c8e2ff">
        <a id="Function" target="_blank">
         系统.枚举(名称,类型)
        </a>
       </td>
      </tr>
      <tr style="height:25px">
       <td align="middle" class="tdline bgblue">
        功能说明：
       </td>
       <td class="tdline" style="padding-left:5px">
        <a id="FunctionDec" target="_blank">
         根据类型枚举需要的类型,返回枚举后的结果,未找到返回空字符,类型:0:窗口名枚举窗口句柄,1:类名枚举窗口句柄,2:进程名枚举进程句柄,3:父窗口句柄枚举子窗口句柄(参数1为空串"",将以桌面句柄为父窗口句柄)
        </a>
       </td>
      </tr>
      <tr style="height:25px">
       <td align="middle" class="tdline bgblue">
        功能举例：
       </td>
       <td class="tdline" style="padding-bottom:0px; padding-left:5px; padding-right:5px; padding-top:5px">
        <table border="0" cellpadding="0" cellspacing="0" width="100%">
         <tbody>
          <tr>
           <td style="padding-bottom:5px; padding-left:0px; padding-right:0px; padding-top:5px" width="98%">
            <a id="FunctionExample" target="_blank">
             返回值=系统.枚举(
             <span style="color:red">
              "计算器"
             </span>
             ,
             <span style="color:teal">
              0
             </span>
             )
             <br/>
             辅助.消息框(返回值)
            </a>
           </td>
          </tr>
         </tbody>
        </table>
       </td>
      </tr>
     </tbody>
    </table>
    <span style="color:rgb(255,0,0); font-size:14px">
     PS：无法得到有游戏保护的窗口句柄，已测试.
    </span>
    <br/>
    <p>
    </p>
    <p>
     <br/>
    </p>
    <p>
     <br/>
    </p>
    <p>
     <span style="font-size:14px; color:#000099">
      进程
     </span>
    </p>
    <p>
     <span style="font-size:14px">
     </span>
    </p>
    <table cellspacing="0" style="border-left:#ccc 1px solid; border-top:#ccc 1px solid" width="100%">
     <tbody>
      <tr style="height:25px">
       <td align="middle" class="tdwidth tdline bgblue">
        功能原型：
       </td>
       <td class="tdline bgblue" style="padding-left:5px; background:#c8e2ff">
        <a id="Function" target="_blank">
         进程.获取窗口句柄(handle,type=0)
        </a>
       </td>
      </tr>
      <tr style="height:25px">
       <td align="middle" class="tdline bgblue">
        功能说明：
       </td>
       <td class="tdline" style="padding-left:5px">
        <a id="FunctionDec" target="_blank">
         通过进程相关信息获取窗口句柄,type：0 通过进程句柄,1 通过进程PID
        </a>
       </td>
      </tr>
      <tr style="height:25px">
       <td align="middle" class="tdline bgblue">
        功能举例：
       </td>
       <td class="tdline" style="padding-bottom:0px; padding-left:5px; padding-right:5px; padding-top:5px">
        <table border="0" cellpadding="0" cellspacing="0" width="100%">
         <tbody>
          <tr>
           <td style="padding-bottom:5px; padding-left:0px; padding-right:0px; padding-top:5px" width="98%">
            <a id="FunctionExample" target="_blank">
             handle=进程.打开(
             <span style="color:red">
              "d:\\MF\\wow.exe"
             </span>
             )
             <br/>
             进程.等待初始化(hanlde,
             <span style="color:teal">
              1000
             </span>
             )
             <br/>
             hwnd=进程.获取窗口句柄(handle)
            </a>
           </td>
          </tr>
         </tbody>
        </table>
       </td>
      </tr>
     </tbody>
    </table>
    <span style="color:rgb(255,0,0); font-size:14px">
     PS：无法得到有游戏保护的窗口句柄，已测试
    </span>
    <br/>
    <p>
    </p>
    <p>
     <span style="font-size:14px">
      <span style="color:rgb(255,0,0); font-size:14px">
       <br/>
      </span>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      <span style="color:rgb(255,0,0); font-size:14px">
       <br/>
      </span>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      <span style="font-size:14px">
       <span style="color:#ff6600">
        大漠和天使插件的找窗口功能比较强大，能获得TC自身取不到的窗口
       </span>
      </span>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      <span style="font-size:14px">
       <span style="color:#ff6600">
        不过要先注册  下面是天使的注册方法，大漠的类似
       </span>
      </span>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      <span style="color:rgb(255,0,0); font-size:14px">
       <img alt="" src="https://img-my.csdn.net/uploads/201302/21/1361457245_2618.png">
        <br/>
       </img>
      </span>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      <span style="color:rgb(255,0,0); font-size:14px">
       <img alt="" src="https://img-my.csdn.net/uploads/201302/21/1361457261_6771.png">
        <br/>
       </img>
      </span>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      <span style="color:rgb(255,0,0); font-size:14px">
       <br/>
      </span>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      <span style="color:rgb(255,0,0); font-size:14px">
       <span style="color:rgb(255,0,0); font-size:14px">
        然后引用命名空间.
       </span>
       <br/>
      </span>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      <span style="color:rgb(255,0,0); font-size:14px">
       <img alt="" src="https://img-my.csdn.net/uploads/201302/21/1361457274_3083.png">
        <br/>
       </img>
      </span>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      <span style="color:rgb(255,0,0); font-size:14px">
       <br/>
      </span>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      <span style="color:rgb(255,0,0); font-size:14px">
       <br/>
      </span>
     </span>
    </p>
    <p>
     <br/>
    </p>
    <p>
     <span style="font-size:14px">
      <br/>
     </span>
    </p>
    <p>
     <span style="font-size:14px; color:#000099">
      大漠
     </span>
    </p>
    <p>
     <span style="font-size:14px; color:#000099">
      <span style="font-size:14px">
       查找符合类名或者标题名
      </span>
      <br/>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
     </span>
    </p>
    <div>
     <p>
      函数简介:
     </p>
     <p>
      查找符合类名或者标题名的顶层可见窗口
     </p>
     <p>
      函数原型:
      <br/>
      <br/>
      long FindWindow(class,title)
     </p>
     <p>
      参数定义:
     </p>
     <p>
      class 字符串: 窗口类名，如果为空，则匹配所有. 这里的匹配是模糊匹配.
     </p>
     <p>
      title 字符串: 窗口标题,如果为空，则匹配所有.这里的匹配是模糊匹配.
     </p>
     <p>
      返回值:
     </p>
     <p>
      整形数:
      <br/>
      整形数表示的窗口句柄，没找到返回0
     </p>
     <p>
      示例:
     </p>
     <p>
      hwnd = dm.FindWindow("","记事本")
     </p>
     <p>
      <br/>
     </p>
     <p>
      <span style="color:#000099">
       枚举系统中符合条件的窗口
      </span>
      <br/>
     </p>
     <p>
     </p>
     <div>
      <p>
       函数简介:
      </p>
      <p>
       根据指定条件,枚举系统中符合条件的窗口,可以枚举到按键自带的无法枚举到的窗口
      </p>
      <p>
       函数原型:
       <br/>
       <br/>
       string EnumWindow(parent,title,class_name,filter)
      </p>
      <p>
       参数定义:
      </p>
      <p>
       parent
       <span style="color:maroon">
        整形数
       </span>
       : 获得的窗口句柄是该窗口的子窗口的窗口句柄,取0时为获得桌面句柄
      </p>
      <p>
       title
       <span style="color:gray">
        字符串
       </span>
       : 窗口标题. 此参数是模糊匹配.
      </p>
      <p>
       class_name
       <span style="color:gray">
        字符串
       </span>
       : 窗口类名. 此参数是模糊匹配.
      </p>
      <p>
       filter
       <span style="color:maroon">
        整形数
       </span>
       : 取值定义如下
      </p>
      <p>
       1 : 匹配窗口标题,参数title有效
      </p>
      <p>
       2 : 匹配窗口类名,参数class_name有效.
      </p>
      <p>
       4 : 只匹配指定父窗口的第一层孩子窗口
      </p>
      <p>
       8 : 匹配所有者窗口为0的窗口,即顶级窗口
      </p>
      <p>
       16 : 匹配可见的窗口
      </p>
      <p>
       32 : 匹配出的窗口按照窗口打开顺序依次排列
       <a href="" rel="nofollow">
        &lt;收费功能，具体详情点击查看&gt;
       </a>
      </p>
      <p>
       这些值可以相加,比如4+8+16就是类似于任务管理器中的窗口列表
      </p>
      <p>
       返回值:
      </p>
      <p>
       <span style="color:gray">
        字符串 :
       </span>
       <br/>
       返回所有匹配的窗口句柄字符串,格式"hwnd1,hwnd2,hwnd3"
      </p>
      <p>
       示例:
      </p>
      <p>
       hwnds = dm.EnumWindow(0,"QQ三国","",1+4+8+16)
      </p>
      <p>
       这句是获取到所有标题栏中有QQ三国这个字符串的窗口句柄集合
      </p>
      <p>
       hwnds = split(hwnds,",")
      </p>
      <p>
       转换为数组后,就可以处理了
      </p>
      <p>
       这里注意,hwnds数组里的是字符串,要用于使用,比如BindWindow时,还得强制类型转换,比如int(hwnds(0))
      </p>
      <p>
      </p>
     </div>
     <p>
     </p>
    </div>
    <p>
    </p>
    <p>
     <span style="font-size:14px">
      <br/>
     </span>
    </p>
    <p>
     <span style="font-size:14px; color:#000099; background-color:rgb(255,255,255)">
      天使
     </span>
    </p>
    <p>
     <span style="font-size:14px; color:#000099; background-color:rgb(255,255,255)">
      <span style="font-size:14px">
       查找符合类名或者标题名
      </span>
      <br/>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
     </span>
    </p>
    <div>
     <p style="background-color:rgb(255,255,255)">
      函数简介:
     </p>
     <p style="background-color:rgb(255,255,255)">
      查找符合类名或者标题名的顶层可见窗口
     </p>
     <p style="background-color:rgb(255,255,255)">
      函数原型:
      <br/>
      <br/>
      int FindWindow(string class,string title)
     </p>
     <p style="background-color:rgb(255,255,255)">
      参数定义:
     </p>
     <p style="background-color:rgb(255,255,255)">
      class 字符串: 窗口类名，如果为空，则匹配所有. 这里的匹配是模糊匹配.
     </p>
     <p style="background-color:rgb(255,255,255)">
      title 字符串: 窗口标题,如果为空，则匹配所有.这里的匹配是模糊匹配.
     </p>
     <p style="background-color:rgb(255,255,255)">
      返回值:
     </p>
     <p style="background-color:rgb(255,255,255)">
      整型数:
      <br/>
      整型数表示的窗口句柄，没找到返回0
     </p>
     <p style="background-color:rgb(255,255,255)">
      示例:
     </p>
     <p style="background-color:rgb(255,255,255)">
      hwnd = ts.FindWindow("","记事本")
     </p>
     <p style="background-color:rgb(255,255,255)">
      <br/>
     </p>
     <p style="background-color:rgb(255,255,255)">
      <br/>
     </p>
     <p style="background-color:rgb(255,255,255)">
      <span style="font-size:18px">
       <span style="color:#000099">
        根据指定的进程名字
       </span>
      </span>
      <br/>
     </p>
     <p style="background-color:rgb(255,255,255)">
     </p>
     <div class="Section1">
      <p class="style1">
       <span style="font-size:13.5pt">
        函数简介
        <span lang="EN-US">
         :
        </span>
       </span>
      </p>
      <p>
       <span style="font-size:13.5pt">
        根据指定的进程名字，来查找可见窗口
        <span lang="EN-US">
         .
        </span>
       </span>
      </p>
      <p>
       <span class="style11">
        <span style="font-size:13.5pt">
         函数原型
         <span lang="EN-US">
          :
         </span>
        </span>
       </span>
       <span lang="EN-US" style="font-size:13.5pt">
        <br/>
        <br/>
        int
        <span class="SpellE">
         FindWindowByProcess
        </span>
        (
        <span class="SpellE">
         string process_name,string class,string title
        </span>
        )
       </span>
      </p>
      <p>
       <span class="style11">
        <span style="font-size:13.5pt">
         参数定义
         <span lang="EN-US">
          :
          <br/>
          <br/>
         </span>
        </span>
       </span>
       <span class="SpellE">
        <span lang="EN-US">
         process_name
        </span>
       </span>
       <span lang="EN-US">
       </span>
       <span style="color:gray; font-size:13.5pt">
        字符串
       </span>
       <span lang="EN-US">
        :
       </span>
       进程名
       <span lang="EN-US">
        .
       </span>
       比如
       <span lang="EN-US">
        (notepad.exe).
       </span>
       这里是精确匹配
       <span lang="EN-US">
        ,
       </span>
       但不区分大小写
       <span lang="EN-US">
        .
       </span>
       <span class="style11">
        <span lang="EN-US" style="font-size:13.5pt">
         <br/>
         <br/>
        </span>
       </span>
       <span lang="EN-US">
        class
       </span>
       <span style="color:gray; font-size:13.5pt">
        字符串
       </span>
       <span lang="EN-US">
        :
       </span>
       窗口类名，如果为空，则匹配所有
       <span lang="EN-US">
        .
       </span>
       <span lang="EN-US">
       </span>
       这里的匹配是模糊匹配
       <span lang="EN-US">
        .
       </span>
       <span lang="EN-US" style="font-size:13.5pt">
       </span>
      </p>
      <p>
       <span lang="EN-US" style="font-size:13.5pt">
        title
       </span>
       <span style="color:gray; font-size:13.5pt">
        字符串
       </span>
       <span lang="EN-US" style="font-size:13.5pt">
        :
       </span>
       <span style="font-size:13.5pt">
        窗口标题
        <span lang="EN-US">
         ,
        </span>
        如果为空，则匹配所有
        <span lang="EN-US">
         .
        </span>
        这里的匹配是模糊匹配
        <span lang="EN-US">
         .
        </span>
       </span>
      </p>
      <p>
       <span class="style11">
        <span style="font-size:13.5pt">
         返回值
         <span lang="EN-US">
          :
         </span>
        </span>
       </span>
       <span lang="EN-US" style="font-size:13.5pt">
        <br/>
        <br/>
       </span>
       <span style="color:maroon; font-size:13.5pt">
        整型数
        <span lang="EN-US">
         :
        </span>
       </span>
       <span lang="EN-US" style="font-size:13.5pt">
        <br/>
       </span>
       <span style="font-size:13.5pt">
        整型数表示的窗口句柄，没找到返回
        <span lang="EN-US">
         0
        </span>
       </span>
      </p>
      <p>
       <span class="style11">
        <span style="font-size:13.5pt">
         示例
         <span lang="EN-US">
          :
         </span>
        </span>
       </span>
       <span lang="EN-US" style="font-size:13.5pt">
       </span>
      </p>
      <p>
       <span class="SpellE">
        <span lang="EN-US" style="font-size:13.5pt">
         hwnd
        </span>
       </span>
       <span lang="EN-US" style="font-size:13.5pt">
        =
        <span class="SpellE">
         ts.FindWindowByProcess
        </span>
        ("noteapd.exe","","
       </span>
       <span style="font-size:13.5pt">
        记事本
        <span lang="EN-US">
         ")
        </span>
       </span>
      </p>
      <p>
       <span style="font-size:13.5pt">
        <span lang="EN-US">
         <br/>
        </span>
       </span>
      </p>
      <p>
       <span style="font-size:13.5pt">
        <span lang="EN-US">
         <span style="font-size:18px">
          <span style="color:#000099">
           枚举
          </span>
         </span>
         <br/>
        </span>
       </span>
      </p>
      <p>
       <span style="font-size:13.5pt">
        <span lang="EN-US">
        </span>
       </span>
      </p>
      <div>
       <p>
        函数简介:
       </p>
       <p>
        根据指定条件,枚举系统中符合条件的窗口,可以枚举到TC自带的无法枚举到的窗口
       </p>
       <p>
        函数原型:
        <br/>
        <br/>
        string EnumWindow(int parent,string title,string class_name,int filter)
       </p>
       <p>
        参数定义:
       </p>
       <p>
        parent
        <span style="color:maroon">
         整型数
        </span>
        : 获得的窗口句柄是该窗口的子窗口的窗口句柄,取0时为获得桌面句柄
       </p>
       <p>
        title
        <span style="color:gray">
         字符串
        </span>
        : 窗口标题. 此参数是模糊匹配.
       </p>
       <p>
        class_name
        <span style="color:gray">
         字符串
        </span>
        : 窗口类名. 此参数是模糊匹配.
       </p>
       <p>
        filter
        <span style="color:maroon">
         整型数
        </span>
        : 取值定义如下
       </p>
       <p>
        1 : 匹配窗口标题,参数title有效
       </p>
       <p>
        2 : 匹配窗口类名,参数class_name有效.
       </p>
       <p>
        4 : 只匹配指定父窗口的第一层子窗口
       </p>
       <p>
        8 : 匹配所有者窗口为0的窗口,即顶级窗口
       </p>
       <p>
        16 : 匹配可见的窗口
       </p>
       <p>
        这些值可以相加,比如4+8+16就是类似于任务管理器中的窗口列表
       </p>
       <p>
        返回值:
       </p>
       <p>
        <span style="color:gray">
         字符串 :
        </span>
        <br/>
        返回所有匹配的窗口句柄字符串,格式"hwnd1,hwnd2,hwnd3"
       </p>
       <p>
        示例:
       </p>
       <p>
        hwnds = ts.EnumWindow(0,"QQ三国","",1+4+8+16)
       </p>
       <p>
        这句是获取到所有标题栏中有QQ三国这个字符串的窗口句柄集合
       </p>
       <p>
        hwnd=array[]
        <br/>
        str.split(hwnds,",",hwnd)
       </p>
       <p>
        转换为数组后,就可以处理了
       </p>
       <p>
        这里注意,hwnds数组里的是字符串,要用于使用,比如BindWindow时,还得强制类型转换,比如type.cint(hwnds(0))
       </p>
       <p>
       </p>
      </div>
      <span style="font-size:18px">
       <span style="color:#000099">
        获取鼠标指向的窗口句柄
       </span>
      </span>
      <br/>
      <p>
      </p>
     </div>
     <p>
     </p>
     <p class="style1">
      <span style="font-size:13.5pt">
       函数简介
       <span lang="EN-US">
        :
       </span>
      </span>
     </p>
     <p>
      <span style="font-size:13.5pt">
       获取鼠标指向的窗口句柄
       <span lang="EN-US">
        ,
       </span>
       可以获取到TC自带的插件无法获取到的句柄
       <span lang="EN-US">
       </span>
      </span>
     </p>
     <p>
      <span class="style11">
       <span style="font-size:13.5pt">
        函数原型
        <span lang="EN-US">
         :
        </span>
       </span>
      </span>
      <span lang="EN-US" style="font-size:13.5pt">
       <br/>
       <br/>
       int GetMousePointWindow()
      </span>
     </p>
     <p>
      <span class="style11">
       <span style="font-size:13.5pt">
        参数定义
        <span lang="EN-US">
         :
        </span>
       </span>
      </span>
      <span lang="EN-US" style="font-size:13.5pt">
      </span>
     </p>
     <p>
      <span class="style11">
       <span style="font-size:13.5pt">
        返回值
        <span lang="EN-US">
         :
        </span>
       </span>
      </span>
      <span lang="EN-US" style="font-size:13.5pt">
      </span>
     </p>
     <p>
      <span style="color:maroon; font-size:13.5pt">
       整型数
       <span lang="EN-US">
        :
       </span>
      </span>
      <span lang="EN-US" style="font-size:13.5pt">
       <br/>
      </span>
      <span style="font-size:13.5pt">
       返回整型表示的窗口句柄
       <span lang="EN-US">
       </span>
      </span>
     </p>
     <p>
      <span class="style11">
       <span style="font-size:13.5pt">
        示例
        <span lang="EN-US">
         :
        </span>
       </span>
      </span>
      <span lang="EN-US" style="font-size:13.5pt">
      </span>
     </p>
     <p>
      <span lang="EN-US" style="font-size:13.5pt">
       hwnd = ts.GetMousePointWindow()
      </span>
     </p>
     <br/>
    </div>
    <p>
    </p>
    <p>
     <span style="font-size:18px; background-color:rgb(255,255,255)">
      <span style="color:#000099">
       获取给定坐标的窗口句柄
      </span>
     </span>
     <br/>
    </p>
    <p style="background-color:rgb(255,255,255)">
    </p>
    <p class="style1">
     <span style="font-size:13.5pt">
      函数简介
      <span lang="EN-US">
       :
      </span>
     </span>
    </p>
    <p>
     <span style="font-size:13.5pt">
      获取给定坐标的窗口句柄
      <span lang="EN-US">
       ,
      </span>
      可以获取到TC自带的插件无法获取到的句柄
      <span lang="EN-US">
      </span>
     </span>
    </p>
    <p>
     <span class="style11">
      <span style="font-size:13.5pt">
       函数原型
       <span lang="EN-US">
        :
       </span>
      </span>
     </span>
     <span lang="EN-US" style="font-size:13.5pt">
      <br/>
      <br/>
      int GetPointWindow(int x,int y)
     </span>
    </p>
    <p>
     <span class="style11">
      <span style="font-size:13.5pt">
       参数定义
       <span lang="EN-US">
        :
       </span>
      </span>
     </span>
     <span lang="EN-US" style="font-size:13.5pt">
     </span>
    </p>
    <p>
     <span lang="EN-US" style="font-size:13.5pt">
      X
     </span>
     <span style="color:maroon; font-size:13.5pt">
      整型数
     </span>
     <span lang="EN-US" style="font-size:13.5pt">
      :
     </span>
     <span style="font-size:13.5pt">
      屏幕
      <span lang="EN-US">
       X
      </span>
      坐标
      <span lang="EN-US">
      </span>
     </span>
    </p>
    <p>
     <span lang="EN-US" style="font-size:13.5pt">
      Y
     </span>
     <span style="color:maroon; font-size:13.5pt">
      整型数
     </span>
     <span lang="EN-US" style="font-size:13.5pt">
      :
     </span>
     <span style="font-size:13.5pt">
      屏幕
      <span lang="EN-US">
       Y
      </span>
      坐标
      <span lang="EN-US">
      </span>
     </span>
    </p>
    <p>
     <span class="style11">
      <span style="font-size:13.5pt">
       返回值
       <span lang="EN-US">
        :
       </span>
      </span>
     </span>
     <span lang="EN-US" style="font-size:13.5pt">
     </span>
    </p>
    <p>
     <span style="color:maroon; font-size:13.5pt">
      整型数
      <span lang="EN-US">
       :
      </span>
     </span>
     <span lang="EN-US" style="font-size:13.5pt">
      <br/>
     </span>
     <span style="font-size:13.5pt">
      返回整型表示的窗口句柄
      <span lang="EN-US">
      </span>
     </span>
    </p>
    <p>
     <span class="style11">
      <span style="font-size:13.5pt">
       示例
       <span lang="EN-US">
        :
       </span>
      </span>
     </span>
     <span lang="EN-US" style="font-size:13.5pt">
     </span>
    </p>
    <p>
     <span lang="EN-US" style="font-size:13.5pt">
      hwnd = ts.GetPointWindow(100,100)
     </span>
    </p>
    <p>
     <span lang="EN-US" style="font-size:13.5pt">
      <br/>
     </span>
    </p>
    <p>
     <span lang="EN-US" style="font-size:13.5pt">
      <br/>
     </span>
    </p>
    <p>
     <span lang="EN-US" style="font-size:13.5pt">
      <span style="font-size:18px">
       <span style="color:#000099">
        获取顶层活动窗口中具有输入焦点的窗口句柄
       </span>
      </span>
      <br/>
     </span>
    </p>
    <p>
     <span lang="EN-US" style="font-size:13.5pt">
     </span>
    </p>
    <p class="style1">
     <span style="font-size:13.5pt">
      函数简介
      <span lang="EN-US">
       :
      </span>
     </span>
    </p>
    <p>
     <span style="font-size:13.5pt">
      获取顶层活动窗口中具有输入焦点的窗口句柄
      <span lang="EN-US">
      </span>
     </span>
    </p>
    <p>
     <span class="style11">
      <span style="font-size:13.5pt">
       函数原型
       <span lang="EN-US">
        :
       </span>
      </span>
     </span>
     <span lang="EN-US" style="font-size:13.5pt">
      <br/>
      <br/>
      int GetForegroundFocus()
     </span>
    </p>
    <p>
     <span class="style11">
      <span style="font-size:13.5pt">
       参数定义
       <span lang="EN-US">
        :
       </span>
      </span>
     </span>
     <span lang="EN-US" style="font-size:13.5pt">
     </span>
    </p>
    <p>
     <span class="style11">
      <span style="font-size:13.5pt">
       返回值
       <span lang="EN-US">
        :
       </span>
      </span>
     </span>
     <span lang="EN-US" style="font-size:13.5pt">
     </span>
    </p>
    <p>
     <span style="color:maroon; font-size:13.5pt">
      整型数
      <span lang="EN-US">
       :
      </span>
     </span>
     <span lang="EN-US" style="font-size:13.5pt">
      <br/>
     </span>
     <span style="font-size:13.5pt">
      返回整型表示的窗口句柄
      <span lang="EN-US">
      </span>
     </span>
    </p>
    <p>
     <span class="style11">
      <span style="font-size:13.5pt">
       示例
       <span lang="EN-US">
        :
       </span>
      </span>
     </span>
     <span lang="EN-US" style="font-size:13.5pt">
     </span>
    </p>
    <p>
     <span lang="EN-US" style="font-size:13.5pt">
      hwnd = ts.GetForegroundFocus()
     </span>
    </p>
    <br/>
    <br/>
    <p style="background-color:rgb(255,255,255)">
     <br/>
    </p>
    <p style="background-color:rgb(255,255,255)">
     <br/>
    </p>
    <br/>
   </div>
  </div>
 </article>
 <p alt="68747470733a:2f2f626c6f672e6373646e2e6e65742f713338333936353337:342f61727469636c652f64657461696c732f38353932343833" class_="artid" style="display:none">
 </p>
</div>


