---
layout: post
title: "在-macOS-上优化-Vim-用于开发"
date: 2025-03-16 14:52:20 +0800
description: "这篇指南将带你通过一系列步骤，如何在macOS上优化Vim，使其具备 代码补全、语法高亮、代码格式化、代码片段管理、目录树等功能。"
keywords: "在 macOS 上优化 Vim 用于开发"
categories: ['Macos']
tags: ['Vim', 'Macos', 'Excel']
artid: "146295411"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146295411
    alt: "在-macOS-上优化-Vim-用于开发"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146295411
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146295411
cover: https://bing.ee123.net/img/rand?artid=146295411
image: https://bing.ee123.net/img/rand?artid=146295411
img: https://bing.ee123.net/img/rand?artid=146295411
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     在 macOS 上优化 Vim 用于开发
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="_0">
     </a>
     <strong>
      简介
     </strong>
    </h3>
    <p>
     这篇指南将带你通过一系列步骤，如何在
     <strong>
      macOS
     </strong>
     上优化
     <strong>
      Vim
     </strong>
     ，使其具备
     <strong>
      代码补全、语法高亮、代码格式化、代码片段管理、目录树等功能
     </strong>
     。此外，我们还会解决在安装过程中可能遇到的常见错误。
    </p>
    <hr/>
    <h3>
     <a id="1__6">
     </a>
     <strong>
      1. 安装必备工具
     </strong>
    </h3>
    <p>
     在开始 Vim 配置之前，我们需要确保你的
     <strong>
      macOS
     </strong>
     系统中安装了以下工具：
    </p>
    <h4>
     <a id="_Homebrew_10">
     </a>
     <strong>
      安装 Homebrew
     </strong>
     （如果未安装）
    </h4>
    <p>
     Homebrew 是 macOS 上的包管理器，它帮助我们安装各种软件包。
    </p>
    <pre><code class="prism language-bash">/bin/bash <span class="token parameter variable">-c</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">curl</span> <span class="token parameter variable">-fsSL</span> https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh<span class="token variable">)</span></span>"</span>
</code></pre>
    <h4>
     <a id="_Vim_17">
     </a>
     <strong>
      安装 Vim
     </strong>
    </h4>
    <p>
     通过
     <strong>
      Homebrew
     </strong>
     安装最新版本的 Vim：
    </p>
    <pre><code class="prism language-bash">brew <span class="token function">install</span> <span class="token function">vim</span>
</code></pre>
    <h4>
     <a id="_24">
     </a>
     <strong>
      安装其他依赖工具
     </strong>
    </h4>
    <p>
     我们还需要安装一些额外的工具，例如
     <strong>
      Node.js 和 npm
     </strong>
     （用于插件
     <code>
      coc.nvim
     </code>
     和
     <code>
      prettier
     </code>
     ），以及其他必要工具：
    </p>
    <pre><code class="prism language-bash">brew <span class="token function">install</span> <span class="token function">node</span>
brew <span class="token function">install</span> dos2unix
brew <span class="token function">install</span> fzf
</code></pre>
    <hr/>
    <h3>
     <a id="2___vimplug_35">
     </a>
     <strong>
      2. 安装插件管理器 - vim-plug
     </strong>
    </h3>
    <p>
     我们将使用
     <strong>
      vim-plug
     </strong>
     来管理 Vim 插件。通过以下命令来安装
     <strong>
      vim-plug
     </strong>
     插件管理器：
    </p>
    <pre><code class="prism language-bash"><span class="token function">curl</span> <span class="token parameter variable">-fLo</span> ~/.vim/autoload/plug.vim --create-dirs     https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
</code></pre>
    <hr/>
    <h3>
     <a id="3__vimrc__45">
     </a>
     <strong>
      3. 配置
      <code>
       ~/.vimrc
      </code>
      文件
     </strong>
    </h3>
    <p>
     使用 Vim 打开配置文件：
    </p>
    <pre><code class="prism language-bash"><span class="token function">vim</span> ~/.vimrc
</code></pre>
    <p>
     然后，粘贴以下配置到
     <code>
      ~/.vimrc
     </code>
     ：
    </p>
    <pre><code class="prism language-vim">" 🔹 自动安装 vim-plug（如果未安装）
if empty(glob('~/.vim/autoload/plug.vim'))
  silent !curl -fLo ~/.vim/autoload/plug.vim --create-dirs       https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
  autocmd VimEnter * PlugInstall | source $MYVIMRC
endif

" 📌 基础配置
set number             " 显示行号
set relativenumber     " 相对行号
set cursorline         " 高亮当前行
set mouse=a            " 允许鼠标操作
set clipboard=unnamedplus  " 复制同步到系统剪贴板

" 📝 代码缩进
set tabstop=4
set shiftwidth=4
set expandtab          " 用空格替代 Tab
set autoindent
set smartindent

" 🔍 搜索优化
set ignorecase         " 忽略大小写
set smartcase          " 智能区分大小写
set incsearch          " 增量搜索
set hlsearch           " 高亮搜索结果

" 🚀 启动优化
set lazyredraw         " 需要时才重绘，提高性能
set updatetime=300     " 降低 CursorHold 触发时间

" 🔗 启用文件类型检测 &amp; 插件支持
filetype plugin indent on

" 📌 插件管理
call plug#begin('~/.vim/plugged')

" 代码补全 &amp; 语法检查（必装）
Plug 'neoclide/coc.nvim', {'branch': 'release'}

" 语法解析 &amp; 高亮（推荐）
Plug 'nvim-treesitter/nvim-treesitter', {'do': ':TSUpdate'}

" 代码片段
Plug 'SirVer/ultisnips'
Plug 'honza/vim-snippets'

" 代码格式化（Python &amp; JS）
Plug 'psf/black', { 'for': 'python' }
Plug 'prettier/vim-prettier', { 'do': 'npm install' }

" 目录树（文件管理）
Plug 'preservim/nerdtree'

" 状态栏美化（更清晰的状态栏）
Plug 'vim-airline/vim-airline'

call plug#end()

" 🚀 绑定快捷键
nnoremap &lt;leader&gt;n :NERDTreeToggle&lt;CR&gt;  " &lt;leader&gt;n 打开/关闭目录树
nnoremap &lt;leader&gt;f :Files&lt;CR&gt;  " &lt;leader&gt;f 搜索文件（需要 fzf）

" 代码补全（Coc.nvim）
inoremap &lt;silent&gt;&lt;expr&gt; &lt;TAB&gt; pumvisible() ? "\&lt;C-n&gt;" : "\&lt;TAB&gt;"
nnoremap &lt;silent&gt; gd &lt;Plug&gt;(coc-definition)  " 跳转到定义
nnoremap &lt;silent&gt; K :call CocActionAsync('doHover')&lt;CR&gt;  " 显示文档
nnoremap &lt;leader&gt;f :CocFix&lt;CR&gt;  " 自动修复代码

" 代码格式化
nnoremap &lt;leader&gt;b :Black&lt;CR&gt;  " Python 代码格式化
nnoremap &lt;leader&gt;p :Prettier&lt;CR&gt;  " JS/TS/HTML 代码格式化
</code></pre>
    <p>
     保存并退出：
    </p>
    <pre><code class="prism language-vim">:wq
</code></pre>
    <hr/>
    <h3>
     <a id="4__137">
     </a>
     <strong>
      4. 安装插件
     </strong>
    </h3>
    <p>
     打开 Vim 后，运行以下命令安装所有插件：
    </p>
    <pre><code class="prism language-vim">:PlugInstall
</code></pre>
    <hr/>
    <h3>
     <a id="5__LSPCocnvim_147">
     </a>
     <strong>
      5. 安装 LSP（Coc.nvim）
     </strong>
    </h3>
    <p>
     安装需要的语言服务器，如
     <strong>
      Python、C/C++、JavaScript
     </strong>
     ：
    </p>
    <pre><code class="prism language-vim">:CocInstall coc-python coc-clangd coc-tsserver
</code></pre>
    <hr/>
    <h3>
     <a id="6_NERDTree_157">
     </a>
     <strong>
      6. 目录树（NERDTree）
     </strong>
    </h3>
    <p>
     使用快捷键打开或关闭
     <strong>
      目录树
     </strong>
     ：
    </p>
    <pre><code class="prism language-vim">&lt;leader&gt;n
</code></pre>
    <p>
     （如果
     <code>
      leader
     </code>
     是
     <code>
      \
     </code>
     ，那么
     <code>
      \n
     </code>
     将打开/关闭 NERDTree。）
    </p>
    <hr/>
    <h3>
     <a id="7_Prettier__Black_168">
     </a>
     <strong>
      7. 代码格式化（Prettier &amp; Black）
     </strong>
    </h3>
    <pre><code class="prism language-vim">\b  " 格式化 Python 代码
\p  " 格式化 JS/TS/HTML 代码
</code></pre>
    <hr/>
    <h3>
     <a id="8___nvimtreesitter_177">
     </a>
     <strong>
      8. 语法解析 + 代码高亮（nvim-treesitter）
     </strong>
    </h3>
    <p>
     安装语法解析器（Python、JavaScript、C/C++ 等）：
    </p>
    <pre><code class="prism language-vim">:TSInstall python javascript c cpp html css json
</code></pre>
    <p>
     然后在
     <code>
      ~/.vimrc
     </code>
     文件中添加：
    </p>
    <pre><code class="prism language-vim">lua &lt;&lt; EOF
require'nvim-treesitter.configs'.setup {
  ensure_installed = "all",
  highlight = { enable = true },
  indent = { enable = true },
}
EOF
</code></pre>
    <hr/>
    <h3>
     <a id="9__199">
     </a>
     <strong>
      9. 终极优化
     </strong>
    </h3>
    <p>
     通过以下快捷键更快速地切换窗口：
    </p>
    <pre><code class="prism language-vim">nnoremap &lt;C-h&gt; &lt;C-w&gt;h
nnoremap &lt;C-l&gt; &lt;C-w&gt;l
nnoremap &lt;C-j&gt; &lt;C-w&gt;j
nnoremap &lt;C-k&gt; &lt;C-w&gt;k
</code></pre>
    <hr/>
    <h3>
     <a id="_212">
     </a>
     <strong>
      常见错误及解决方案
     </strong>
    </h3>
    <h4>
     <a id="_1_vimprettier_Exit__1_214">
     </a>
     <strong>
      错误 1:
      <code>
       vim-prettier
      </code>
      Exit 状态 1
     </strong>
    </h4>
    <p>
     <strong>
      问题：
     </strong>
     <code>
      vim-prettier
     </code>
     更新失败，出现
     <code>
      Exit status: 1
     </code>
     。
    </p>
    <p>
     <strong>
      解决方案：
     </strong>
     运行以下命令来解决依赖问题：
    </p>
    <pre><code class="prism language-bash"><span class="token builtin class-name">cd</span> ~/.vim/plugged/vim-prettier
<span class="token function">npm</span> <span class="token function">install</span> --legacy-peer-deps
</code></pre>
    <p>
     如果还是失败，强制安装：
    </p>
    <pre><code class="prism language-bash"><span class="token function">npm</span> <span class="token function">install</span> <span class="token parameter variable">--force</span>
</code></pre>
    <p>
     然后返回 Vim，运行：
    </p>
    <pre><code class="prism language-vim">:PlugUpdate
</code></pre>
    <h4>
     <a id="_2_TSUpdate__237">
     </a>
     <strong>
      错误 2:
      <code>
       TSUpdate
      </code>
      不是编辑器命令
     </strong>
    </h4>
    <p>
     <strong>
      问题：
     </strong>
     安装
     <code>
      nvim-treesitter
     </code>
     时出现
     <code>
      E492: Not an editor command: TSUpdate
     </code>
     。
    </p>
    <p>
     <strong>
      解决方案：
     </strong>
     这是因为
     <strong>
      Neovim
     </strong>
     是必须的，
     <strong>
      Vim
     </strong>
     不支持
     <code>
      nvim-treesitter
     </code>
     。你可以安装
     <strong>
      Neovim
     </strong>
     ：
    </p>
    <pre><code class="prism language-bash">brew <span class="token function">install</span> neovim
</code></pre>
    <p>
     然后使用
     <strong>
      Neovim
     </strong>
     (
     <code>
      nvim
     </code>
     而非
     <code>
      vim
     </code>
     ) 打开配置文件并运行：
    </p>
    <pre><code class="prism language-vim">:TSInstall python javascript c cpp html css json
</code></pre>
    <p>
     如果不想使用 Neovim，可以从
     <code>
      ~/.vimrc
     </code>
     删除
     <code>
      nvim-treesitter
     </code>
     插件，然后重新运行：
    </p>
    <pre><code class="prism language-vim">:PlugClean
:PlugInstall
</code></pre>
    <hr/>
    <h3>
     <a id="_262">
     </a>
     <strong>
      总结
     </strong>
    </h3>
    <p>
     通过上述步骤，你的
     <strong>
      macOS
     </strong>
     上的
     <strong>
      Vim
     </strong>
     已经优化完成，具备了：
    </p>
    <ul>
     <li>
      <strong>
       代码补全
      </strong>
      （Coc.nvim）
     </li>
     <li>
      <strong>
       语法高亮
      </strong>
      （nvim-treesitter）
     </li>
     <li>
      <strong>
       代码格式化
      </strong>
      （Prettier 和 Black）
     </li>
     <li>
      <strong>
       代码片段管理
      </strong>
      （UltiSnips）
     </li>
     <li>
      <strong>
       目录管理
      </strong>
      （NERDTree）
     </li>
     <li>
      <strong>
       状态栏美化
      </strong>
      （Airline）
     </li>
    </ul>
    <p>
     现在你可以享受一个
     <strong>
      强大的 Vim 开发环境
     </strong>
     ！🚀
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f35383634383839302f:61727469636c652f64657461696c732f313436323935343131" class_="artid" style="display:none">
 </p>
</div>


