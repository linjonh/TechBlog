---
layout: post
title: "抽象工厂模式的C实现示例"
date: 2025-03-14 00:30:57 +0800
description: "抽象工厂模式通过提供一种方式来创建一系列相关或依赖的对象，确保这些对象是兼容的，并且将客户端代码与具体类解耦。它适用于需要创建产品族的场景，并且易于扩展和维护。然而，它也会增加系统的复杂性，并且在支持新种类的产品时可能需要修改抽象工厂接口及其所有实现类。"
keywords: "抽象工厂模式的C++实现示例"
categories: ['C']
tags: ['设计模式', '算法', '抽象工厂模式', 'C']
artid: "146245667"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146245667
    alt: "抽象工厂模式的C实现示例"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146245667
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146245667
cover: https://bing.ee123.net/img/rand?artid=146245667
image: https://bing.ee123.net/img/rand?artid=146245667
img: https://bing.ee123.net/img/rand?artid=146245667
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     抽象工厂模式的C++实现示例
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="_0">
     </a>
     核心思想
    </h2>
    <p>
     抽象工厂模式（Abstract Factory Pattern）是一种创建型设计模式，它提供了一种方式，可以创建一系列相关或依赖的对象，而无需指定它们的具体类。抽象工厂模式的核心思想是：
     <br/>
     <strong>
      抽象工厂接口
     </strong>
     ：定义一个接口，用于创建一系列相关或依赖的对象。
     <br/>
     <strong>
      具体工厂实现
     </strong>
     ：实现抽象工厂接口，创建具体的对象。
     <br/>
     <strong>
      抽象产品接口
     </strong>
     ：定义一类产品的接口。
     <br/>
     <strong>
      具体产品实现
     </strong>
     ：实现抽象产品接口，创建具体的产品。
    </p>
    <h2>
     <a id="_6">
     </a>
     解决的问题
    </h2>
    <p>
     <strong>
      产品族创建
     </strong>
     ：当需要创建一系列相关或依赖的对象时，抽象工厂模式可以确保这些对象是兼容的。
     <br/>
     <strong>
      客户端与具体类解耦
     </strong>
     ：客户端代码只需要知道抽象工厂和抽象产品接口，而不需要知道具体的实现类，从而降低了耦合度。
     <br/>
     <strong>
      易于扩展
     </strong>
     ：当需要增加新的产品族时，只需要增加新的工厂类和产品类，而不需要修改现有代码。
    </p>
    <h2>
     <a id="_10">
     </a>
     使用场景
    </h2>
    <p>
     <strong>
      产品族创建
     </strong>
     ：当需要创建一系列相关或依赖的对象时，例如不同操作系统的界面组件（按钮、文本框等）。
     <br/>
     <strong>
      系统独立性
     </strong>
     ：当需要确保系统与具体类解耦，以便于扩展和维护。
     <br/>
     <strong>
      配置文件驱动
     </strong>
     ：当需要通过配置文件或其他方式动态选择产品族时。
    </p>
    <h2>
     <a id="_14">
     </a>
     优点
    </h2>
    <p>
     <strong>
      产品族一致性
     </strong>
     ：确保创建的对象是兼容的。
     <br/>
     <strong>
      客户端与具体类解耦
     </strong>
     ：客户端代码只需要知道抽象接口，而不需要知道具体实现类。
     <br/>
     <strong>
      易于扩展
     </strong>
     ：增加新的产品族时，只需要增加新的工厂类和产品类，而不需要修改现有代码。
    </p>
    <h2>
     <a id="_18">
     </a>
     缺点
    </h2>
    <p>
     <strong>
      复杂性增加
     </strong>
     ：增加了系统的复杂性，需要更多的类和接口。
     <br/>
     <strong>
      不易于支持新种类的产品
     </strong>
     ：如果需要增加新的种类的产品，需要修改抽象工厂接口及其所有实现类。
    </p>
    <h2>
     <a id="_21">
     </a>
     示例代码
    </h2>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;memory&gt;</span></span>

<span class="token comment">// 抽象产品A</span>
<span class="token keyword">class</span> <span class="token class-name">AbstractProductA</span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">AbstractProductA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 具体产品A1</span>
<span class="token keyword">class</span> <span class="token class-name">ProductA1</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">AbstractProductA</span></span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">{<!-- --></span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Using ProductA1"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 具体产品A2</span>
<span class="token keyword">class</span> <span class="token class-name">ProductA2</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">AbstractProductA</span></span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">{<!-- --></span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Using ProductA2"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 抽象产品B</span>
<span class="token keyword">class</span> <span class="token class-name">AbstractProductB</span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">AbstractProductB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 具体产品B1</span>
<span class="token keyword">class</span> <span class="token class-name">ProductB1</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">AbstractProductB</span></span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">{<!-- --></span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Using ProductB1"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 具体产品B2</span>
<span class="token keyword">class</span> <span class="token class-name">ProductB2</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">AbstractProductB</span></span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">{<!-- --></span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Using ProductB2"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 抽象工厂</span>
<span class="token keyword">class</span> <span class="token class-name">AbstractFactory</span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> std<span class="token double-colon punctuation">::</span>unique_ptr<span class="token operator">&lt;</span>AbstractProductA<span class="token operator">&gt;</span> <span class="token function">createProductA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> std<span class="token double-colon punctuation">::</span>unique_ptr<span class="token operator">&lt;</span>AbstractProductB<span class="token operator">&gt;</span> <span class="token function">createProductB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">AbstractFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 具体工厂1</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteFactory1</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">AbstractFactory</span></span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    std<span class="token double-colon punctuation">::</span>unique_ptr<span class="token operator">&lt;</span>AbstractProductA<span class="token operator">&gt;</span> <span class="token function">createProductA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">make_unique</span><span class="token generic class-name"><span class="token operator">&lt;</span>ProductA1<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    std<span class="token double-colon punctuation">::</span>unique_ptr<span class="token operator">&lt;</span>AbstractProductB<span class="token operator">&gt;</span> <span class="token function">createProductB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">make_unique</span><span class="token generic class-name"><span class="token operator">&lt;</span>ProductB1<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 具体工厂2</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteFactory2</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">AbstractFactory</span></span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    std<span class="token double-colon punctuation">::</span>unique_ptr<span class="token operator">&lt;</span>AbstractProductA<span class="token operator">&gt;</span> <span class="token function">createProductA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">make_unique</span><span class="token generic class-name"><span class="token operator">&lt;</span>ProductA2<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    std<span class="token double-colon punctuation">::</span>unique_ptr<span class="token operator">&lt;</span>AbstractProductB<span class="token operator">&gt;</span> <span class="token function">createProductB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">make_unique</span><span class="token generic class-name"><span class="token operator">&lt;</span>ProductB2<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 客户端代码</span>
<span class="token keyword">void</span> <span class="token function">clientCode</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>unique_ptr<span class="token operator">&lt;</span>AbstractFactory<span class="token operator">&gt;</span> factory<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">auto</span> productA <span class="token operator">=</span> factory<span class="token operator">-&gt;</span><span class="token function">createProductA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">auto</span> productB <span class="token operator">=</span> factory<span class="token operator">-&gt;</span><span class="token function">createProductB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    productA<span class="token operator">-&gt;</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    productB<span class="token operator">-&gt;</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Client: Testing client code with the first factory type:"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    <span class="token function">clientCode</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">make_unique</span><span class="token generic class-name"><span class="token operator">&lt;</span>ConcreteFactory1<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Client: Testing client code with the second factory type:"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    <span class="token function">clientCode</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span><span class="token generic-function"><span class="token function">make_unique</span><span class="token generic class-name"><span class="token operator">&lt;</span>ConcreteFactory2<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h2>
     <a id="_123">
     </a>
     代码解析
    </h2>
    <p>
     <strong>
      抽象产品
     </strong>
     ：AbstractProductA 和 AbstractProductB 是抽象产品接口，定义了产品的行为。
     <br/>
     <strong>
      具体产品
     </strong>
     ：ProductA1、ProductA2、ProductB1 和 ProductB2 是具体产品实现类。
     <br/>
     <strong>
      抽象工厂
     </strong>
     ：AbstractFactory 是抽象工厂接口，定义了创建产品的方法。
     <br/>
     <strong>
      具体工厂
     </strong>
     ：ConcreteFactory1 和 ConcreteFactory2 是具体工厂实现类，分别创建不同的产品族。
     <br/>
     <strong>
      客户端代码
     </strong>
     ：clientCode 函数使用抽象工厂接口创建产品，并调用产品的方法。
    </p>
    <h2>
     <a id="_129">
     </a>
     总结
    </h2>
    <p>
     抽象工厂模式通过提供一种方式来创建一系列相关或依赖的对象，确保这些对象是兼容的，并且将客户端代码与具体类解耦。它适用于需要创建产品族的场景，并且易于扩展和维护。然而，它也会增加系统的复杂性，并且在支持新种类的产品时可能需要修改抽象工厂接口及其所有实现类。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c:6f672e6373646e2e6e65742f7777706c68353532303337302f:61727469636c652f64657461696c732f313436323435363637" class_="artid" style="display:none">
 </p>
</div>


