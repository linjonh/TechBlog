---
arturl_encode: "68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f35333434303437372f:61727469636c652f64657461696c732f313436313539313638"
layout: post
title: "ESP32çš„IDFå¼€å‘å­¦ä¹ -ç§»æ¤lvglå¹¶æ˜¾ç¤ºç®€å•uiä»¥gc9a01ä¸ºä¾‹"
date: 2025-03-10 17:18:59 +08:00
description: "å†ç»æ•°æ—¥çš„è°ƒè¯•ä¸ä¼˜åŒ–ï¼Œç»ˆäºæˆåŠŸæ”»å…‹GC9A01æ˜¾ç¤ºå±çš„é©±åŠ¨å¼€å‘ï¼ğŸ‰ æœ¬æ–‡å°†èšç„¦LVGLå›¾å½¢åº“çš„ç§»æ¤ä¸å®è·µï¼Œè¯¦ç»†ä»‹ç»å¦‚ä½•åœ¨ESP32-S3å¹³å°ä¸Šå®ç°åŸºç¡€UIæ¸²æŸ“ï¼Œä¸ºåç»­å¤æ‚ç•Œé¢å¼€å‘å¥ å®šåŸºç¡€ã€‚"
keywords: "ESP32çš„IDFå¼€å‘å­¦ä¹ -ç§»æ¤lvglå¹¶æ˜¾ç¤ºç®€å•ui(ä»¥gc9a01ä¸ºä¾‹)"
categories: ['æœªåˆ†ç±»']
tags: ['å­¦ä¹ ', 'Ui']
artid: "146159168"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146159168
    alt: "ESP32çš„IDFå¼€å‘å­¦ä¹ -ç§»æ¤lvglå¹¶æ˜¾ç¤ºç®€å•uiä»¥gc9a01ä¸ºä¾‹"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146159168
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146159168
cover: https://bing.ee123.net/img/rand?artid=146159168
image: https://bing.ee123.net/img/rand?artid=146159168
img: https://bing.ee123.net/img/rand?artid=146159168
---

# ESP32çš„IDFå¼€å‘å­¦ä¹ -ç§»æ¤lvglå¹¶æ˜¾ç¤ºç®€å•ui(ä»¥gc9a01ä¸ºä¾‹)

### ğŸ“– å‰è¨€

å†ç»æ•°æ—¥çš„è°ƒè¯•ä¸ä¼˜åŒ–ï¼Œç»ˆäºæˆåŠŸæ”»å…‹GC9A01æ˜¾ç¤ºå±çš„é©±åŠ¨å¼€å‘ï¼ğŸ‰ æœ¬æ–‡å°†èšç„¦
**LVGLå›¾å½¢åº“çš„ç§»æ¤ä¸å®è·µ**
ï¼Œè¯¦ç»†ä»‹ç»å¦‚ä½•åœ¨ESP32-S3å¹³å°ä¸Šå®ç°åŸºç¡€UIæ¸²æŸ“ï¼Œä¸ºåç»­å¤æ‚ç•Œé¢å¼€å‘å¥ å®šåŸºç¡€ã€‚

---

### ğŸ› ï¸ LVGLç»„ä»¶é›†æˆ

#### 1ï¸âƒ£ **ç»„ä»¶å®‰è£…**

é€šè¿‡
**ESP-IDFç»„ä»¶ç®¡ç†å™¨**
å¿«é€Ÿé›†æˆLVGLï¼š

1. æ‰“å¼€ç»„ä»¶æ³¨å†Œå™¨ï¼Œæœç´¢
   `lvgl`
     
   ![](https://i-blog.csdnimg.cn/img_convert/bc60e23ea1fadd12f6d273a94323edbe.png)
2. é€‰æ‹©
   **v8.xç‰ˆæœ¬**
   ï¼ˆæ›´ç¨³å®šçš„é•¿æœŸæ”¯æŒç‰ˆæœ¬ï¼‰å¹¶å®‰è£…
     
   ![](https://i-blog.csdnimg.cn/img_convert/75bc10303848fdea8b5dd658130baad7.png)
3. åŒæ—¶å®‰è£…
   **lvgl\_port**
   ç«¯å£é€‚é…å±‚
     
   ![](https://i-blog.csdnimg.cn/img_convert/1e06473cf727c7d89c66341365797616.png)

#### 2ï¸âƒ£ **å…³é”®é…ç½®**

```c
lvgl_port_cfg_t port_cfg = ESP_LVGL_PORT_INIT_CONFIG(); 
lvgl_port_init(&port_cfg); 

```

ğŸ“Œ
**é…ç½®é¡¹è§£æ**
ï¼š

* **`task_priority`**
  : å»ºè®®è®¾ä¸º
  `5`
  ï¼ˆä½äºWiFi/BTç­‰é«˜ä¼˜å…ˆçº§ä»»åŠ¡ï¼‰
* **`task_stack`**
  : è‡³å°‘
  `4096`
  å­—ï¼ˆå¤æ‚UIéœ€å¢å¤§ï¼‰
* **`task_affinity`**
  : ç»‘å®šåˆ°
  `CPU1`
  å¯éš”ç¦»æ¸²æŸ“ä»»åŠ¡ä¸å…¶ä»–é€»è¾‘

âš ï¸
**é‡è¦æç¤º**
ï¼š

> * è‹¥æ˜¾ç¤ºå±å‡ºç°æ’•è£‚ï¼Œéœ€è°ƒæ•´
>   `timer_period_ms`
>   ä¸åˆ·æ–°ç‡åŒæ­¥
> * å¤šä»»åŠ¡æ“ä½œLVGLå‰å¿…é¡»
>   **åŠ é”**

---

### ğŸ–¥ï¸ æ˜¾ç¤ºå™¨æ³¨å†Œä¸é…ç½®

#### 1ï¸âƒ£ **ç¡¬ä»¶å®šä¹‰**

```c
#define gc9a01_swap_xy  false // XYè½´äº¤æ¢ï¼ˆé€‚é…å±å¹•æ–¹å‘ï¼‰
#define gc9a01_mirror_x true  // Xè½´é•œåƒï¼ˆç‰©ç†å®‰è£…æ–¹å‘è¡¥å¿ï¼‰
#define gc9a01_mirror_y false // Yè½´é•œåƒ

esp_lcd_panel_io_handle_t io_handle = NULL; // LCDæ€»çº¿å¥æŸ„
esp_lcd_panel_handle_t panel_handle = NULL; // é¢æ¿æ§åˆ¶å¥æŸ„
lv_disp_t *disp_ = NULL; // LVGLæ˜¾ç¤ºè®¾å¤‡å¯¹è±¡

```

#### 2ï¸âƒ£ **æ˜¾ç¤ºç«¯å£æ³¨å†Œ**

```c
const lvgl_port_display_cfg_t display_cfg = {
    .io_handle = io_handle, 
    .panel_handle = panel_handle,
    .buffer_size = LCD_WIDTH * 80,   // åŒç¼“å†²æ¯å¸§80è¡Œ
    .double_buffer = true,           // âœ… å¯ç”¨åŒç¼“å†²é˜²æ’•è£‚
    .hres = LCD_WIDTH,               // æ°´å¹³åˆ†è¾¨ç‡
    .vres = LCD_HEIGHT,              // å‚ç›´åˆ†è¾¨ç‡
    .rotation = {
        .swap_xy = gc9a01_swap_xy,   // åæ ‡ç³»å˜æ¢
        .mirror_x = gc9a01_mirror_x, 
        .mirror_y = gc9a01_mirror_y,
    },
    .flags = {
        .buff_dma = 1,               // ğŸš€ DMAåŠ é€Ÿä¼ è¾“
        .buff_spiram = 0,            // ç¦ç”¨PSRAMï¼ˆç‰‡ä¸Šå†…å­˜å……è¶³æ—¶ï¼‰
        .sw_rotate = 0, // ä¸ä½¿ç”¨è½¯ä»¶æ—‹è½¬
        .full_refresh = 0, // ä¸ä½¿ç”¨å…¨å±åˆ·æ–°
        .direct_mode = 0, // ä¸ä½¿ç”¨ç›´æ¥æ¨¡å¼
    },
};

disp_ = lvgl_port_add_disp(&display_cfg); // æ³¨å†Œæ˜¾ç¤ºå™¨åˆ°LVGL

```

ğŸ”§
**è°ƒè¯•æŠ€å·§**
ï¼š

* è‹¥å¸§ç‡ä¸è¶³ï¼Œå¯å°è¯•å¢å¤§
  `buffer_size`
  è‡³å…¨å±å°ºå¯¸ï¼ˆç‰ºç‰²å†…å­˜æ¢å–é€Ÿåº¦ï¼‰
* `sw_rotate=1`
  å¯åœ¨ä¸ä¿®æ”¹ç¡¬ä»¶æ’çº¿çš„æƒ…å†µä¸‹è½¯ä»¶æ—‹è½¬å±å¹•
* PSRAMå’ŒDMAä¸èƒ½åŒæ—¶å¼€å¯

---

### ğŸ” **æ ¸å¿ƒä»£ç å‰–æ**

#### `lvgl_port_init()` å‡½æ•°è¯¦è§£

è¯¥å‡½æ•°å®ç°äº†LVGLä¸FreeRTOSçš„æ·±åº¦æ•´åˆï¼Œä¸»è¦åŠŸèƒ½å¦‚ä¸‹ï¼š

| æ¨¡å— | åŠŸèƒ½è¯´æ˜ |
| --- | --- |
| **å¿ƒè·³å®šæ—¶å™¨** | é€šè¿‡ `lvgl_port_tick_init()` æ³¨å…¥ç³»ç»Ÿæ—¶é’Ÿï¼Œç»´æŒLVGLåŠ¨ç”»/äº‹ä»¶å¤„ç†ï¼ˆé»˜è®¤5msä¸­æ–­ï¼‰ |
| **äº’æ–¥é‡ä¿æŠ¤** | é€’å½’é”é˜²æ­¢å¤šçº¿ç¨‹ç«äº‰LVGLå¯¹è±¡ï¼ˆå¦‚UIçº¿ç¨‹ä¸ä¼ æ„Ÿå™¨æ•°æ®æ›´æ–°çº¿ç¨‹ï¼‰ |
| **ä»»åŠ¡ç»‘å®š** | å¯æŒ‡å®šæ¸²æŸ“ä»»åŠ¡è¿è¡Œçš„CPUæ ¸å¿ƒï¼Œæå‡å¤šæ ¸åˆ©ç”¨ç‡ |

âš ï¸
**çº¿ç¨‹å®‰å…¨è­¦å‘Š**
ï¼š

> æ‰€æœ‰LVGLå¯¹è±¡æ“ä½œå¿…é¡»åŒ…è£¹åœ¨é”å†…ï¼š
>
> ```c
> xSemaphoreTakeRecursive(lvgl_port_ctx.lvgl_mux, portMAX_DELAY); 
> lv_label_set_text(label, "New Value"); 
> xSemaphoreGiveRecursive(lvgl_port_ctx.lvgl_mux);
>
> ```

---

### ğŸ¨ åŸºç¡€UIå¼€å‘ç¤ºä¾‹

```c
// è·å–é»˜è®¤å±å¹•å¯¹è±¡
lv_obj_t *scr = lv_disp_get_scr_act(disp_);

// è®¾ç½®èƒŒæ™¯æ ·å¼ï¼ˆ50%é€æ˜åº¦ï¼Œç™½è‰²åº•è‰²ï¼‰
lv_obj_set_style_bg_opa(scr, LV_OPA_50, LV_STATE_DEFAULT);
lv_obj_set_style_bg_color(scr, lv_color_white(), LV_PART_MAIN); 

// åˆ›å»ºæ–‡æœ¬æ ‡ç­¾å¹¶å®šä½
lv_obj_t *label = lv_label_create(scr);
lv_label_set_text(label, "Hello ESP32");
lv_obj_align(label, LV_ALIGN_CENTER, 0, 0); // å±…ä¸­æ˜¾ç¤º

ESP_LOGI(TAG, "UIåˆå§‹åŒ–å®Œæˆâœ…");

```

ç¼–è¯‘çƒ§å½•åæ•ˆæœï¼š
  
![](https://i-blog.csdnimg.cn/img_convert/aeb6a5fd81bfe9818ab8aa7da74e90bd.jpeg)
  
å¤§åŠŸå‘Šæˆï¼ï¼ï¼