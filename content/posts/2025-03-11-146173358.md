---
layout: post
title: "通过-ElasticSearch的Python-API和curl-命令获取Elasticsearch-所有索引名称"
date: 2025-03-11 11:10:17 +0800
description: "通过 Python 客户端，只需几行代码即可快速获取 Elasticsearch 的所有索引名称，灵活应对开发与运维需求。根据实际场景选择合适的方法，并结合权限管理和安全配置，你可以更安全、高效地操作 Elasticsearch 系统。如需深入探讨其他 Elasticsearch 技巧，欢迎在评论区留言。"
keywords: "通过 ElasticSearch的Python API和`curl` 命令获取Elasticsearch 所有索引名称"
categories: ['未分类']
tags: ['大数据', 'Jenkins', 'Elasticsearch']
artid: "146173358"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146173358
    alt: "通过-ElasticSearch的Python-API和curl-命令获取Elasticsearch-所有索引名称"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146173358
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146173358
cover: https://bing.ee123.net/img/rand?artid=146173358
image: https://bing.ee123.net/img/rand?artid=146173358
img: https://bing.ee123.net/img/rand?artid=146173358
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     通过 ElasticSearch的Python API和`curl` 命令获取Elasticsearch 所有索引名称
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-tomorrow-night" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h4>
     <a id="_0">
     </a>
     导言
    </h4>
    <hr/>
    <p>
     在大数据管理和实时搜索场景中，Elasticsearch 是一款不可或缺的工具。无论是开发调试、数据维护，还是系统监控，
     <strong>
      快速列出所有索引名称
     </strong>
     都是一个高频需求。本文将手把手教你如何通过 Python 客户端连接 Elasticsearch，并用两种方法获取索引列表，同时提供代码示例和实战技巧，助你高效掌控 Elasticsearch 的索引管理。
    </p>
    <hr/>
    <h5>
     <a id="_8">
     </a>
     一、为什么需要列出索引名称？
    </h5>
    <p>
     在 Elasticsearch 中，索引是存储和检索数据的逻辑容器。通过列出所有索引名称，你可以：
    </p>
    <ul>
     <li>
      <strong>
       监控系统状态
      </strong>
      ：确认哪些索引存在或已删除。
     </li>
     <li>
      <strong>
       调试开发问题
      </strong>
      ：快速定位目标索引是否存在或是否符合预期。
     </li>
     <li>
      <strong>
       自动化运维
      </strong>
      ：结合脚本批量管理索引（如清理旧数据、备份等）。
      <br/>
      本文将通过 Python 的
      <code>
       elasticsearch
      </code>
      客户端库，实现这一需求。
     </li>
    </ul>
    <hr/>
    <h5>
     <a id="Python__Elasticsearch__17">
     </a>
     二、快速上手：Python 列出 Elasticsearch 索引名称
    </h5>
    <h6>
     <a id="1__19">
     </a>
     <strong>
      1. 安装依赖库
     </strong>
    </h6>
    <p>
     首先安装 Python 的官方 Elasticsearch 客户端库：
    </p>
    <pre><code class="prism language-bash">pip <span class="token function">install</span> elasticsearch
</code></pre>
    <h6>
     <a id="2__Elasticsearch__25">
     </a>
     <strong>
      2. 连接到 Elasticsearch 实例
     </strong>
    </h6>
    <p>
     创建客户端连接对象：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">from</span> elasticsearch <span class="token keyword">import</span> Elasticsearch

<span class="token comment"># 默认连接本地（http://localhost:9200）</span>
client <span class="token operator">=</span> Elasticsearch<span class="token punctuation">(</span><span class="token string">"http://localhost:9200"</span><span class="token punctuation">)</span>

<span class="token comment"># 如需远程连接或认证（示例）：</span>
<span class="token comment"># client = Elasticsearch(</span>
<span class="token comment">#     "https://your-host:9200",</span>
<span class="token comment">#     http_auth=("username", "password"),</span>
<span class="token comment">#     verify_certs=True</span>
<span class="token comment"># )</span>
</code></pre>
    <h6>
     <a id="3__indicesget__41">
     </a>
     <strong>
      3. 方法一：使用
      <code>
       indices.get()
      </code>
      获取索引列表
     </strong>
    </h6>
    <p>
     通过
     <code>
      indices.get
     </code>
     方法直接获取所有索引的元数据，返回一个字典，键为索引名称：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">try</span><span class="token punctuation">:</span>
    indices_info <span class="token operator">=</span> client<span class="token punctuation">.</span>indices<span class="token punctuation">.</span>get<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token string">"*"</span><span class="token punctuation">)</span>  <span class="token comment"># "*" 表示匹配所有索引</span>
    index_names <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>indices_info<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"索引列表："</span><span class="token punctuation">,</span> index_names<span class="token punctuation">)</span>
<span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"错误：</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  <span class="token comment"># 捕获连接或权限异常</span>
</code></pre>
    <p>
     <strong>
      优点
     </strong>
     ：直接返回索引名列表，简单高效。
     <br/>
     <strong>
      注意
     </strong>
     ：若索引数量庞大，此方法可能加载全部元数据，性能需权衡。
    </p>
    <hr/>
    <h6>
     <a id="4__catindices__57">
     </a>
     <strong>
      4. 方法二：通过
      <code>
       cat.indices
      </code>
      获取索引列表
     </strong>
    </h6>
    <p>
     <code>
      cat
     </code>
     API 提供轻量级、易解析的输出格式，适合仅需索引名称的场景：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">try</span><span class="token punctuation">:</span>
    <span class="token comment"># 获取索引信息（指定返回字段为 "index"，格式为 JSON）</span>
    response <span class="token operator">=</span> client<span class="token punctuation">.</span>cat<span class="token punctuation">.</span>indices<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token string">"*"</span><span class="token punctuation">,</span> h<span class="token operator">=</span><span class="token string">"index"</span><span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">"json"</span><span class="token punctuation">)</span>
    index_names <span class="token operator">=</span> <span class="token punctuation">[</span>item<span class="token punctuation">[</span><span class="token string">"index"</span><span class="token punctuation">]</span> <span class="token keyword">for</span> item <span class="token keyword">in</span> response<span class="token punctuation">]</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"索引列表："</span><span class="token punctuation">,</span> index_names<span class="token punctuation">)</span>
<span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"错误：</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
</code></pre>
    <p>
     <strong>
      优点
     </strong>
     ：返回轻量数据，适合仅获取名称的场景。
     <br/>
     <strong>
      注意
     </strong>
     ：需遍历 JSON 列表解析字段。
    </p>
    <hr/>
    <h6>
     <a id="5__74">
     </a>
     <strong>
      5. 完整代码示例
     </strong>
    </h6>
    <pre><code class="prism language-python"><span class="token keyword">from</span> elasticsearch <span class="token keyword">import</span> Elasticsearch

<span class="token keyword">def</span> <span class="token function">list_elasticsearch_indices</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 初始化客户端</span>
    client <span class="token operator">=</span> Elasticsearch<span class="token punctuation">(</span><span class="token string">"http://localhost:9200"</span><span class="token punctuation">)</span>
    
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token comment"># 方法一：indices.get</span>
        indices_method1 <span class="token operator">=</span> client<span class="token punctuation">.</span>indices<span class="token punctuation">.</span>get<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"方法一结果："</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">(</span>indices_method1<span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 方法二：cat.indices</span>
        cat_response <span class="token operator">=</span> client<span class="token punctuation">.</span>cat<span class="token punctuation">.</span>indices<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token string">"*"</span><span class="token punctuation">,</span> h<span class="token operator">=</span><span class="token string">"index"</span><span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">"json"</span><span class="token punctuation">)</span>
        indices_method2 <span class="token operator">=</span> <span class="token punctuation">[</span>item<span class="token punctuation">[</span><span class="token string">"index"</span><span class="token punctuation">]</span> <span class="token keyword">for</span> item <span class="token keyword">in</span> cat_response<span class="token punctuation">]</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"方法二结果："</span><span class="token punctuation">,</span> indices_method2<span class="token punctuation">)</span>
        
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Error: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    list_elasticsearch_indices<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <hr/>
    <h5>
     <a id="_101">
     </a>
     三、注意事项
    </h5>
    <ol>
     <li>
      <p>
       <strong>
        连接配置
       </strong>
      </p>
      <ul>
       <li>
        确保 Elasticsearch 服务已启动，且端口（默认
        <code>
         9200
        </code>
        ）可访问。
       </li>
       <li>
        若启用安全认证（如 X-Pack），需提供
        <code>
         http_auth
        </code>
        参数或 API Key。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        权限问题
       </strong>
      </p>
      <ul>
       <li>
        客户端账号需具备
        <code>
         monitor
        </code>
        或
        <code>
         manage
        </code>
        权限才能查看索引。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        性能优化
       </strong>
      </p>
      <ul>
       <li>
        若索引数量巨大，使用
        <code>
         cat.indices
        </code>
        更节省资源。
       </li>
       <li>
        排除系统索引（如
        <code>
         .kibana
        </code>
        ）可通过正则表达式过滤：
        <pre><code class="prism language-python">index_names <span class="token operator">=</span> <span class="token punctuation">[</span>name <span class="token keyword">for</span> name <span class="token keyword">in</span> index_names <span class="token keyword">if</span> <span class="token keyword">not</span> name<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre>
       </li>
      </ul>
     </li>
    </ol>
    <hr/>
    <h5>
     <a id="_118">
     </a>
     四、进阶应用
    </h5>
    <p>
     你可以结合其他 Elasticsearch API 实现更多场景：
    </p>
    <ul>
     <li>
      <strong>
       删除索引
      </strong>
      ：
      <code>
       client.indices.delete(index="your_index")
      </code>
     </li>
     <li>
      <strong>
       创建索引
      </strong>
      ：
      <code>
       client.indices.create(index="new_index")
      </code>
     </li>
     <li>
      <strong>
       查询索引详情
      </strong>
      ：
      <code>
       client.indices.get_settings(index="your_index")
      </code>
     </li>
    </ul>
    <hr/>
    <h4>
     <a id="_curl_Elasticsearch__126">
     </a>
     调试技巧：通过
     <code>
      curl
     </code>
     命令获取Elasticsearch 所有索引名称
    </h4>
    <p>
     通过
     <code>
      curl
     </code>
     命令访问
     <strong>
      localhost:9200
     </strong>
     的 Elasticsearch 并获取所有索引名称，同时需要输入用户名和密码进行认证，可以使用以下命令：
    </p>
    <hr/>
    <h5>
     <a id="_1_132">
     </a>
     方法 1：直接在命令中指定用户名和密码
    </h5>
    <pre><code class="prism language-bash"><span class="token function">curl</span> <span class="token parameter variable">-u</span> username:password <span class="token parameter variable">-X</span> GET <span class="token string">"http://localhost:9200/_cat/indices?v"</span>
</code></pre>
    <ul>
     <li>
      <strong>
       <code>
        -u username:password
       </code>
      </strong>
      ：指定认证的用户名和密码。
     </li>
     <li>
      <strong>
       <code>
        -X GET
       </code>
      </strong>
      ：指定 HTTP 请求方法为
      <code>
       GET
      </code>
      。
     </li>
     <li>
      <strong>
       <code>
        /_cat/indices?v
       </code>
      </strong>
      ：Elasticsearch 的内置端点，用于列出所有索引名称及详细信息（如
      <code>
       v
      </code>
      会格式化输出）。
     </li>
    </ul>
    <hr/>
    <h5>
     <a id="_2_142">
     </a>
     方法 2：交互式输入密码（更安全）
    </h5>
    <p>
     如果不想将密码明文写在命令中，可以交互式输入：
    </p>
    <pre><code class="prism language-bash"><span class="token function">curl</span> <span class="token parameter variable">-u</span> username <span class="token parameter variable">-X</span> GET <span class="token string">"http://localhost:9200/_cat/indices?v"</span>
</code></pre>
    <p>
     执行命令后，终端会提示你输入密码。
    </p>
    <hr/>
    <h5>
     <a id="_151">
     </a>
     注意事项：
    </h5>
    <ol>
     <li>
      <p>
       <strong>
        认证方式
       </strong>
       ：
      </p>
      <ul>
       <li>
        Elasticsearch 默认可能使用
        <code>
         basic auth
        </code>
        认证（非 HTTPS 的默认配置）。
       </li>
       <li>
        若 Elasticsearch 启用了 HTTPS（如生产环境），需要将
        <code>
         http://
        </code>
        改为
        <code>
         https://
        </code>
        ，并可能需要添加
        <code>
         --insecure
        </code>
        参数忽略 SSL 证书验证（慎用生产环境）：
        <pre><code class="prism language-bash"><span class="token function">curl</span> <span class="token parameter variable">-u</span> username:password <span class="token parameter variable">-k</span> <span class="token parameter variable">-X</span> GET <span class="token string">"https://localhost:9200/_cat/indices?v"</span>
</code></pre>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        权限问题
       </strong>
       ：
      </p>
      <ul>
       <li>
        确保用户名（如
        <code>
         username
        </code>
        ）有权限访问
        <code>
         /_cat/indices
        </code>
        端点。
       </li>
       <li>
        默认管理员用户可能是
        <code>
         elastic
        </code>
        ，但需确认具体权限配置。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        端点说明
       </strong>
       ：
      </p>
      <ul>
       <li>
        <code>
         /_cat/indices
        </code>
        返回所有索引的基本信息（名称、文档数、状态等）。
       </li>
       <li>
        如果仅需要索引名称，可以用
        <code>
         awk
        </code>
        或其他工具过滤输出：
        <pre><code class="prism language-bash"><span class="token function">curl</span> <span class="token parameter variable">-u</span> username:password <span class="token parameter variable">-X</span> GET <span class="token string">"http://localhost:9200/_cat/indices?v"</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print $3}'</span>
</code></pre>
       </li>
      </ul>
     </li>
    </ol>
    <hr/>
    <p>
     如果遇到
     <strong>
      认证失败
     </strong>
     或
     <strong>
      连接错误
     </strong>
     ，检查以下几点：
    </p>
    <ol>
     <li>
      Elasticsearch 是否启用了安全认证（如
      <code>
       xpack.security.enabled: true
      </code>
      ）。
     </li>
     <li>
      用户名和密码是否正确。
     </li>
     <li>
      是否监听在
      <code>
       localhost:9200
      </code>
      端口（可通过
      <code>
       curl http://localhost:9200
      </code>
      测试基础连接）。
     </li>
    </ol>
    <h5>
     <a id="403_AuthorizationException_current_license_is_noncompliant_for_security__178">
     </a>
     错误排查：许可证过期可能会遇到
     <code>
      403 AuthorizationException: current license is non-compliant for [security]
     </code>
     错误
    </h5>
    <p>
     <code>
      403 AuthorizationException: current license is non-compliant for [security]
     </code>
     错误，通常与
     <strong>
      Elasticsearch 许可证（License）
     </strong>
     问题相关。具体来说，Elasticsearch 的某些功能（如安全功能，即
     <strong>
      X-Pack Security
     </strong>
     ）需要有效的许可证才能使用。以下是详细的排查和解决方案：
    </p>
    <hr/>
    <h6>
     <a id="1__184">
     </a>
     <strong>
      1. 错误原因分析
     </strong>
    </h6>
    <ul>
     <li>
      <strong>
       许可证级别不足
      </strong>
      ：默认的 Basic 许可证不支持安全功能（如用户认证、角色管理等）。你需要
      <strong>
       Gold 或更高版本的许可证
      </strong>
      才能启用安全功能。
     </li>
     <li>
      <strong>
       许可证过期
      </strong>
      ：试用许可证（Basic 30天试用）过期后，安全功能会被禁用。
     </li>
     <li>
      <strong>
       未激活许可证
      </strong>
      ：即使拥有许可证文件，也可能未正确加载到 Elasticsearch 中。
     </li>
    </ul>
    <hr/>
    <h6>
     <a id="2__191">
     </a>
     <strong>
      2. 解决方案步骤
     </strong>
    </h6>
    <h6>
     <a id="_193">
     </a>
     <strong>
      方法一：检查现有的许可证状态
     </strong>
    </h6>
    <p>
     运行以下命令查看当前许可证信息：
    </p>
    <pre><code class="prism language-bash"><span class="token function">curl</span> <span class="token parameter variable">-X</span> GET <span class="token string">"http://localhost:9200/_license"</span> <span class="token parameter variable">-u</span> <span class="token string">"username:password"</span>
<span class="token comment"># 或使用 Python 客户端：</span>
from elasticsearch <span class="token function">import</span> Elasticsearch
client <span class="token operator">=</span> Elasticsearch<span class="token punctuation">(</span><span class="token string">"http://localhost:9200"</span>, <span class="token assign-left variable">basic_auth</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">"username"</span>, <span class="token string">"password"</span><span class="token punctuation">))</span>
print<span class="token punctuation">(</span>client.license.get<span class="token punctuation">(</span><span class="token punctuation">))</span>
</code></pre>
    <p>
     <strong>
      典型输出示例
     </strong>
     ：
    </p>
    <pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"license"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"status"</span><span class="token operator">:</span> <span class="token string">"active"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"uid"</span><span class="token operator">:</span> <span class="token string">"..."</span><span class="token punctuation">,</span>
    <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"basic"</span><span class="token punctuation">,</span>      # 关键字段！<span class="token string">"basic"</span> 表示基础版（免费但无安全功能）
    <span class="token string-property property">"issue_date"</span><span class="token operator">:</span> <span class="token string">"..."</span><span class="token punctuation">,</span>
    <span class="token string-property property">"issue_date_in_millis"</span><span class="token operator">:</span> <span class="token operator">...</span><span class="token punctuation">,</span>
    <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"..."</span><span class="token punctuation">,</span>
    <span class="token string-property property">"expiry_date"</span><span class="token operator">:</span> <span class="token string">"..."</span><span class="token punctuation">,</span>
    <span class="token string-property property">"expiry_date_in_millis"</span><span class="token operator">:</span> <span class="token operator">...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <ul>
     <li>
      如果
      <code>
       type
      </code>
      是
      <code>
       basic
      </code>
      ，且你需要安全功能，必须更换许可证。
     </li>
     <li>
      如果
      <code>
       status
      </code>
      是
      <code>
       expired
      </code>
      ，则许可证已过期。
     </li>
    </ul>
    <hr/>
    <h6>
     <a id="_224">
     </a>
     <strong>
      方法二：获取并安装正确的许可证
     </strong>
    </h6>
    <h6>
     <a id="1_225">
     </a>
     <strong>
      选项1：临时试用高级许可证
     </strong>
    </h6>
    <ol>
     <li>
      <strong>
       获取 7 天试用许可证
      </strong>
      （适用于测试环境）：
      <pre><code class="prism language-bash"><span class="token function">curl</span> <span class="token parameter variable">-X</span> POST <span class="token string">"http://localhost:9200/_security/license/start_basic"</span> <span class="token parameter variable">-u</span> <span class="token string">"username:password"</span>
<span class="token function">curl</span> <span class="token parameter variable">-X</span> POST <span class="token string">"http://localhost:9200/_security/license/start_trial?acknowledge=true&amp;pretty"</span> <span class="token parameter variable">-u</span> <span class="token string">"username:password"</span>
</code></pre>
     </li>
     <li>
      验证许可证是否生效：
      <pre><code class="prism language-bash"><span class="token function">curl</span> <span class="token parameter variable">-X</span> GET <span class="token string">"http://localhost:9200/_license"</span> <span class="token parameter variable">-u</span> <span class="token string">"username:password"</span>
</code></pre>
     </li>
    </ol>
    <h6>
     <a id="2_236">
     </a>
     <strong>
      选项2：使用正式许可证文件
     </strong>
    </h6>
    <ol>
     <li>
      <strong>
       获取许可证文件
      </strong>
      （如
      <code>
       license ElvisBasic.lic
      </code>
      或
      <code>
       gold.lic
      </code>
      ）：
      <ul>
       <li>
        联系 Elastic 支持团队获取正式许可证。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       安装许可证
      </strong>
      ：
      <pre><code class="prism language-bash"><span class="token function">curl</span> <span class="token parameter variable">-X</span> PUT <span class="token string">"http://localhost:9200/_license"</span> <span class="token parameter variable">-u</span> <span class="token string">"username:password"</span> <span class="token parameter variable">-H</span> <span class="token string">'Content-Type: application/yaml'</span> <span class="token parameter variable">-d</span> @/path/to/license.lic
</code></pre>
     </li>
    </ol>
    <hr/>
    <h6>
     <a id="_246">
     </a>
     <strong>
      方法三：禁用安全功能（仅限测试环境）
     </strong>
    </h6>
    <p>
     如果确认不需要安全功能，可以临时禁用它（
     <strong>
      生产环境不建议
     </strong>
     ）：
    </p>
    <ol>
     <li>
      编辑 Elasticsearch 配置文件
      <code>
       elasticsearch.yml
      </code>
      ：
      <pre><code class="prism language-yaml"><span class="token key atrule">xpack.security.enabled</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
</code></pre>
     </li>
     <li>
      重启 Elasticsearch 服务：
      <pre><code class="prism language-bash"><span class="token comment"># Linux</span>
<span class="token function">sudo</span> systemctl restart elasticsearch
</code></pre>
     </li>
    </ol>
    <p>
     禁用后，无需许可证即可使用基础功能（如列出索引）：
    </p>
    <pre><code class="prism language-python">client <span class="token operator">=</span> Elasticsearch<span class="token punctuation">(</span><span class="token string">"http://localhost:9200"</span><span class="token punctuation">)</span>  <span class="token comment"># 无需认证</span>
indices <span class="token operator">=</span> client<span class="token punctuation">.</span>indices<span class="token punctuation">.</span>get<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token string">"*"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>indices<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
    <hr/>
    <h6>
     <a id="_267">
     </a>
     <strong>
      方法四：检查用户权限
     </strong>
    </h6>
    <p>
     即使许可证有效，用户权限不足也会导致
     <code>
      403
     </code>
     错误：
    </p>
    <ol>
     <li>
      <p>
       确认当前用户（如
       <code>
        elastic
       </code>
       超级用户）有
       <code>
        monitor
       </code>
       或
       <code>
        manage
       </code>
       权限：
      </p>
      <pre><code class="prism language-bash"><span class="token function">curl</span> <span class="token parameter variable">-X</span> GET <span class="token string">"http://localhost:9200/_security/user"</span> <span class="token parameter variable">-u</span> <span class="token string">"username:password"</span>
</code></pre>
     </li>
     <li>
      <p>
       如果用户权限不足，可分配角色：
      </p>
      <pre><code class="prism language-bash"><span class="token comment"># 为用户分配 "superuser" 角色</span>
<span class="token function">curl</span> <span class="token parameter variable">-X</span> POST <span class="token string">"http://localhost:9200/_security/user/username/_password"</span> <span class="token parameter variable">-H</span> <span class="token string">'Content-Type: application/json'</span> -d<span class="token string">'
{
  "password" : "new_password",
  "roles" : ["superuser"]
}'</span>
</code></pre>
     </li>
    </ol>
    <hr/>
    <h5>
     <a id="3__286">
     </a>
     <strong>
      3. 验证修复
     </strong>
    </h5>
    <p>
     完成以上步骤后，重新运行代码尝试列出索引：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">from</span> elasticsearch <span class="token keyword">import</span> Elasticsearch

client <span class="token operator">=</span> Elasticsearch<span class="token punctuation">(</span>
    <span class="token string">"http://localhost:9200"</span><span class="token punctuation">,</span>
    basic_auth<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">,</span> <span class="token string">"password"</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
indices <span class="token operator">=</span> client<span class="token punctuation">.</span>cat<span class="token punctuation">.</span>indices<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token string">"*"</span><span class="token punctuation">,</span> h<span class="token operator">=</span><span class="token string">"index"</span><span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">"json"</span><span class="token punctuation">)</span>
index_names <span class="token operator">=</span> <span class="token punctuation">[</span>item<span class="token punctuation">[</span><span class="token string">"index"</span><span class="token punctuation">]</span> <span class="token keyword">for</span> item <span class="token keyword">in</span> indices<span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>index_names<span class="token punctuation">)</span>
</code></pre>
    <hr/>
    <h5>
     <a id="4__302">
     </a>
     <strong>
      4. 其他注意事项
     </strong>
    </h5>
    <ol>
     <li>
      <strong>
       许可证激活问题
      </strong>
      <ul>
       <li>
        如果许可证文件存在但未生效，检查日志文件
        <code>
         elasticsearch.log
        </code>
        中是否有错误提示。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       单节点许可证限制
      </strong>
      <ul>
       <li>
        某些许可证（如 Basic）仅支持单节点部署，多节点集群需升级。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       文档参考
      </strong>
      <ul>
       <li>
        官方许可证指南：
        <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/license-management.html" rel="nofollow">
         Elastic License Management
        </a>
       </li>
      </ul>
     </li>
    </ol>
    <hr/>
    <h4>
     <a id="_312">
     </a>
     总结
    </h4>
    <p>
     通过 Python 客户端，只需
     <strong>
      几行代码
     </strong>
     即可快速获取 Elasticsearch 的所有索引名称，灵活应对开发与运维需求。根据实际场景选择合适的方法，并结合权限管理和安全配置，你可以更安全、高效地操作 Elasticsearch 系统。
    </p>
    <p>
     如果本文帮助你解决了问题，欢迎点赞、收藏或分享给需要的人！如需深入探讨其他 Elasticsearch 技巧，欢迎在评论区留言。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f676f6c6474696d65732f:61727469636c652f64657461696c732f313436313733333538" class_="artid" style="display:none">
 </p>
</div>


