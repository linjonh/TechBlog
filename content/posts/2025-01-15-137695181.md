---
layout: post
title: "HarmonyOS实战开发-如何实现窗口沉浸式和小窗口等功能"
date: 2025-01-15 14:28:51 +0800
description: "本示例展示了1.在应用主窗口中创建和拉起子窗口，并对子窗口设置窗口相关属性，以及设置窗口规避区域、窗"
keywords: "windowstage窗口管理怎么使用"
categories: ['鸿蒙工程师', '鸿蒙', 'Harmonyos']
tags: ['鸿蒙开发', '鸿蒙应用开发', '鸿蒙', '华为', 'Openharmony', 'Harmonyos', 'Harmonyos']
artid: "137695181"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=137695181
    alt: "HarmonyOS实战开发-如何实现窗口沉浸式和小窗口等功能"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=137695181
featuredImagePreview: https://bing.ee123.net/img/rand?artid=137695181
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     HarmonyOS实战开发-如何实现窗口沉浸式和小窗口等功能。
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="_0">
     </a>
     介绍
    </h3>
    <p>
     本示例展示了
    </p>
    <p>
     1.在应用主窗口中创建和拉起子窗口，并对子窗口设置窗口相关属性，以及设置窗口规避区域、窗口沉浸式和小窗口等功能。
    </p>
    <p>
     2.在应用中获取系统栏的属性
    </p>
    <p>
     3.在应用中设置窗口可触摸区域
    </p>
    <p>
     本示例使用窗口管理
    </p>
    <h3>
     <a id="_12">
     </a>
     效果预览
    </h3>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/81c80770e8552af2e5d6285275993c2c.png">
      <br/>
      窗口视频-使用说明：
     </img>
    </p>
    <p>
     1.启动应用,点击窗口视频跳转到播放页。
    </p>
    <p>
     2.点击视频屏幕可以拉起小窗口播放视频，小窗口可以拖拽，再次点击视频可以关闭小窗口。
    </p>
    <p>
     3.点击全屏播放并切换窗口方向按钮可以全屏播放视频并且改变窗口方向。
    </p>
    <p>
     4.点击视频屏幕拉起小窗口播放视频, 界面显示小窗口状态为“获焦状态”; 再次点击视频关闭小窗口, 界面显示小窗口状态为“失焦状态”
    </p>
    <p>
     5.点击视频屏幕拉起小窗口视频，再点击小窗口中的“拉起悬浮应用”按钮，成功拉起WindowRatio悬浮应用
    </p>
    <p>
     获取系统栏属性-使用说明:
    </p>
    <p>
     1.启动应用,点击获取系统状态栏属性页
    </p>
    <p>
     2.点击获取系统状态栏属性，展示系统状态栏相关属性到页面
    </p>
    <p>
     设置窗口可触摸区域-使用说明:
    </p>
    <p>
     1.启动应用,点击获取设置窗口可触摸区域页
    </p>
    <p>
     2.页面启动时，将窗口上25%高度区域（区域1）和最下25%高度区域（区域4）设置为可以触摸区域，其它区域不可触摸
    </p>
    <p>
     3.可以点击区域1和区域4可以触发点击事件并使用ShowToast显示点击的区域信息，其它区域则无法触发事件
    </p>
    <h3>
     <a id="_40">
     </a>
     工程目录
    </h3>
    <pre><code class="prism language-clike">entry<span class="token operator">/</span>src<span class="token operator">/</span>main<span class="token operator">/</span>ets<span class="token operator">/</span>
<span class="token operator">|</span><span class="token operator">--</span><span class="token operator">-</span>Application
<span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span><span class="token operator">-</span>MyAbilityStage<span class="token punctuation">.</span>ts                   
<span class="token operator">|</span><span class="token operator">--</span><span class="token operator">-</span>MainAbility
<span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span><span class="token operator">-</span>MainAbility<span class="token punctuation">.</span>ts                    
<span class="token operator">|</span><span class="token operator">--</span><span class="token operator">-</span>pages
<span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span><span class="token operator">-</span>Index<span class="token punctuation">.</span>ets                      <span class="token comment">// 首页</span>
<span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span><span class="token operator">-</span>SubWindowPage<span class="token punctuation">.</span>ets              <span class="token comment">// 全屏播放</span>
<span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span><span class="token operator">-</span>Video<span class="token punctuation">.</span>ets                      <span class="token comment">// 视频播放</span>
<span class="token operator">|</span><span class="token operator">--</span><span class="token operator">-</span>system_bar
<span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span><span class="token operator">-</span>pages
<span class="token operator">|</span>   <span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span><span class="token operator">-</span>GetPropertiesOfSystemBar<span class="token punctuation">.</span>ets <span class="token comment">//获取系统状态栏属性</span>
<span class="token operator">|</span><span class="token operator">--</span><span class="token operator">-</span>touchable
<span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span><span class="token operator">-</span>pages
<span class="token operator">|</span>   <span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span><span class="token operator">-</span>SetTouchableAreas<span class="token punctuation">.</span>ets       <span class="token comment">//设置可触摸区域</span>
<span class="token operator">|</span><span class="token operator">--</span><span class="token operator">-</span>utils
<span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span><span class="token operator">-</span>Logger<span class="token punctuation">.</span>ets                      <span class="token comment">//日志工具类</span>
</code></pre>
    <h3>
     <a id="_62">
     </a>
     具体实现
    </h3>
    <ul>
     <li>
      本示例主要分为五个模块
     </li>
     <li>
      首页入口模块
     </li>
     <li>
      使用WindowStage实例化一个窗口，引入WindowManger方法设置一个主窗口与子窗口
     </li>
     <li>
      窗口视频模块
     </li>
     <li>
      这里用到依赖window-components中WindowComponent方法来进行视频的播放
     </li>
     <li>
      全屏播放窗口并切换窗口方向模块
     </li>
     <li>
      通过EventPriority方法表示事件被发送的优先级，emitter.emit方法发送指定的事件进行全屏播放和切换窗口方向
     </li>
     <li>
      获取系统状态栏属性页
     </li>
     <li>
      通过Button触发当前window.getWindowSystemBarProperties()方法，通过Text组件展示到界面
     </li>
     <li>
      设置窗口可触摸区域页
     </li>
     <li>
      通过window.setTouchableAreas(rects:
      <br/>
      Array)方法，设置窗口内的可触摸区域，通过4个区域内的Text组件的点击事件触发，来展示对窗口触摸区域的限制
     </li>
    </ul>
    <h3>
     <a id="_77">
     </a>
     相关权限
    </h3>
    <p>
     本示例需要在module.json5中配置如下权限:
    </p>
    <p>
     允许应用使用悬浮窗的能力：ohos.permission.SYSTEM_FLOAT_WINDOW
    </p>
    <h3>
     <a id="_83">
     </a>
     依赖
    </h3>
    <p>
     本示例需要依赖窗口比例 sample，本示例点击“拉起悬浮应用”按钮之后会以悬浮窗模式拉起窗口比例 sample。
    </p>
    <h3>
     <a id="_87">
     </a>
     约束与限制
    </h3>
    <p>
     1.本示例仅支持标准系统上运行,支持设备:RK3568；
    </p>
    <p>
     2.本示例不支持release版本,仅支持master版本,当前software version为OpenHarmony 5.0.0.19
    </p>
    <p>
     3.本示例仅支持API12版本SDK，版本号:5.0.0.19,本涉及涉及使用系统接口：window.setTouchableAreas(rects: Array): void;，需要手动替换Full SDK才能编译通过
    </p>
    <p>
     4.本示例需要使用DevEco Studio 版本号(Build Version: 4.1.3.500, built on January 20, 2024)及以上版本才可编译运行。
    </p>
    <p>
     5.本示例所配置的权限ohos.permission.SYSTEM_FLOAT_WINDOW为system_basic级别( 相关权限级别可通过权限定义列表 查看)
    </p>
    <h3>
     <a id="_99">
     </a>
     下载
    </h3>
    <p>
     如需单独下载本工程，执行如下命令：
    </p>
    <pre><code class="prism language-clike">git init
git config core<span class="token punctuation">.</span>sparsecheckout <span class="token boolean">true</span>
echo code<span class="token operator">/</span>BasicFeature<span class="token operator">/</span>WindowManagement<span class="token operator">/</span>WindowManage<span class="token operator">/</span> <span class="token operator">&gt;</span> <span class="token punctuation">.</span>git<span class="token operator">/</span>info<span class="token operator">/</span>sparse<span class="token operator">-</span>checkout
git remote add origin https<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>gitee<span class="token punctuation">.</span>com<span class="token operator">/</span>openharmony<span class="token operator">/</span>applications_app_samples<span class="token punctuation">.</span>git
git pull origin master
</code></pre>
    <p>
     <strong>
      为了帮助大家更深入有效的学习到鸿蒙开发知识点，小编特意给大家准备了一份全套最新版的HarmonyOS NEXT学习资源，获取完整版方式请点击→
      <a href="https://docs.qq.com/doc/DZVVBYlhuRkZQZlB3" rel="nofollow">
       <code>
        https://docs.qq.com/doc/DZVVBYlhuRkZQZlB3
       </code>
      </a>
     </strong>
    </p>
    <h3>
     <a id="HarmonyOSArkTSTypeScriptArkUI_112">
     </a>
     HarmonyOS教学视频：语法ArkTS、TypeScript、ArkUI等…视频教程
    </h3>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/aea1e6c141bc8c99ab42da227c42faf8.png">
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/75c6c8de2261b1536ee2ac285b9fcadc.png"/>
     </img>
    </p>
    <p>
     <strong>
      鸿蒙生态应用开发白皮书V2.0PDF： 获取完整版白皮书方式请点击→
      <a href="https://docs.qq.com/doc/DZVVkRGRUd3pHSnFG?u=a42c4946d1514235863bb82a7b2ac128" rel="nofollow">
       <code>
        https://docs.qq.com/doc/DZVVkRGRUd3pHSnFG?u=a42c4946d1514235863bb82a7b2ac128
       </code>
      </a>
     </strong>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/814deef583460c5a36ff7e3c9fa251c2.png"/>
    </p>
    <h3>
     <a id="_Harmony_OS_121">
     </a>
     鸿蒙 (Harmony OS)开发学习手册
    </h3>
    <h3>
     <a id="httpsdocsqqcomdocDZVVBYlhuRkZQZlB3httpsdocsqqcomdocDZVVBYlhuRkZQZlB3_123">
     </a>
     一、入门必看→
     <a href="https://docs.qq.com/doc/DZVVBYlhuRkZQZlB3" rel="nofollow">
      <code>
       https://docs.qq.com/doc/DZVVBYlhuRkZQZlB3
      </code>
     </a>
    </h3>
    <p>
     1.应用开发导读(ArkTS)
     <br/>
     2………
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/fe5d05c2054be077a99f779cd8fe6b4c.png"/>
    </p>
    <h3>
     <a id="HarmonyOS_httpsdocsqqcomdocDZVVBYlhuRkZQZlB3httpsdocsqqcomdocDZVVBYlhuRkZQZlB3_129">
     </a>
     二、HarmonyOS 概念→
     <a href="https://docs.qq.com/doc/DZVVBYlhuRkZQZlB3" rel="nofollow">
      <code>
       https://docs.qq.com/doc/DZVVBYlhuRkZQZlB3
      </code>
     </a>
    </h3>
    <p>
     1.系统定义
     <br/>
     2.技术架构
     <br/>
     3.技术特性
     <br/>
     4.系统安全
     <br/>
     5.…
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/e3fefac51cd81c75e883b7cece34009c.png"/>
    </p>
    <h3>
     <a id="httpsdocsqqcomdocDZVVBYlhuRkZQZlB3httpsdocsqqcomdocDZVVBYlhuRkZQZlB3_137">
     </a>
     三、如何快速入门？→
     <a href="https://docs.qq.com/doc/DZVVBYlhuRkZQZlB3" rel="nofollow">
      <code>
       https://docs.qq.com/doc/DZVVBYlhuRkZQZlB3
      </code>
     </a>
    </h3>
    <p>
     1.基本概念
     <br/>
     2.构建第一个ArkTS应用
     <br/>
     3………
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/87796dae90a8e892b42709fd56e26af8.png"/>
    </p>
    <h3>
     <a id="httpsdocsqqcomdocDZVVBYlhuRkZQZlB3httpsdocsqqcomdocDZVVBYlhuRkZQZlB3_141">
     </a>
     四、开发基础知识→
     <a href="https://docs.qq.com/doc/DZVVBYlhuRkZQZlB3" rel="nofollow">
      <code>
       https://docs.qq.com/doc/DZVVBYlhuRkZQZlB3
      </code>
     </a>
    </h3>
    <p>
     1.应用基础知识
     <br/>
     2.配置文件
     <br/>
     3.应用数据管理
     <br/>
     4.应用安全管理
     <br/>
     5.应用隐私保护
     <br/>
     6.三方应用调用管控机制
     <br/>
     7.资源分类与访问
     <br/>
     8.学习ArkTS语言
     <br/>
     9.……
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/530d30151c2e24e9cca6beff6671aa87.png"/>
    </p>
    <h3>
     <a id="ArkTS_httpsdocsqqcomdocDZVVBYlhuRkZQZlB3httpsdocsqqcomdocDZVVBYlhuRkZQZlB3_152">
     </a>
     五、基于ArkTS 开发→
     <a href="https://docs.qq.com/doc/DZVVBYlhuRkZQZlB3" rel="nofollow">
      <code>
       https://docs.qq.com/doc/DZVVBYlhuRkZQZlB3
      </code>
     </a>
    </h3>
    <p>
     1.Ability开发
     <br/>
     2.UI开发
     <br/>
     3.公共事件与通知
     <br/>
     4.窗口管理
     <br/>
     5.媒体
     <br/>
     6.安全
     <br/>
     7.网络与链接
     <br/>
     8.电话服务
     <br/>
     9.数据管理
     <br/>
     10.后台任务(Background Task)管理
     <br/>
     11.设备管理
     <br/>
     12.设备使用信息统计
     <br/>
     13.DFX
     <br/>
     14.国际化开发
     <br/>
     15.折叠屏系列
     <br/>
     16.……
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/1b88cc622a7358efc0004b6db5a00aac.png"/>
    </p>
    <p>
     <strong>
      更多了解更多鸿蒙开发的相关知识可以参考：
      <a href="https://docs.qq.com/doc/DZVVBYlhuRkZQZlB3" rel="nofollow">
       <code>
        https://docs.qq.com/doc/DZVVBYlhuRkZQZlB3
       </code>
      </a>
     </strong>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323430315f38323534363232382f:61727469636c652f64657461696c732f313337363935313831" class_="artid" style="display:none">
 </p>
</div>


