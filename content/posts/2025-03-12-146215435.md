---
layout: post
title: "C结构体Struct详解"
date: 2025-03-12 21:37:36 +0800
description: "在 C# 中，结构体（struct）是一种值类型（value type），用于组织和存储相关数据。在 C# 中，结构体是值类型数据结构，这样使得一个单一变量可以存储各种数据类型的相关数据。struct 关键字用于创建结构体。在 C# 中，结构体（struct）是一种值类型（value type），用于组织和存储相关数据。在 C# 中，结构体是值类型数据结构，这样使得一个单一变量可以存储各种数据类型的相关数据。struct 关键字用于创建结构体。"
keywords: "C#结构体(Struct)详解"
categories: ['基础从入门到精通', 'C']
tags: ['开发语言', 'Visual', 'Studio', 'C']
artid: "146215435"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146215435
    alt: "C结构体Struct详解"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146215435
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146215435
cover: https://bing.ee123.net/img/rand?artid=146215435
image: https://bing.ee123.net/img/rand?artid=146215435
img: https://bing.ee123.net/img/rand?artid=146215435
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     C#结构体(Struct)详解
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     <strong>
      在 C# 中，‌结构体（struct）‌ 是一种值类型数据类型，适用于封装小型数据组。与类（class）不同，结构体在栈（Stack）上分配内存，且赋值时会发生值复制。以下是结构体的核心特性和用法：
     </strong>
    </p>
    <hr/>
    <p>
     <strong>
      ‌结构体核心特点‌
     </strong>
     <br/>
     结构提供了一种轻量级的数据类型，适用于表示简单的数据结构，具有较好的性能特性和值语义：
    </p>
    <ul>
     <li>
      值类型‌：赋值时复制整个数据，修改副本不影响原数据。
     </li>
     <li>
      结构可带有方法、字段、索引、属性、运算符方法和事件，适用于表示轻量级数据的情况，如坐标、范围、日期、时间等。
     </li>
     <li>
      结构可定义构造函数，但不能定义析构函数。但是，您不能为结构定义无参构造函数。无参构造函数(默认)是自动- 定义的，且不能被改变（C# 10 前不能定义无参构造器，所有字段需在构造器中初始化。）。
     </li>
     <li>
      与类不同，结构不能继承其他的结构或类。
     </li>
     <li>
      结构不能作为其他结构或类的基础结构。
     </li>
     <li>
      结构可实现一个或多个接口。
     </li>
     <li>
      结构成员不能指定为 abstract、virtual 或 protected。
     </li>
     <li>
      当您使用 New 操作符创建一个结构对象时，会调用适当的构造函数来创建结构。与类不同，结构可以不使用 New 操作符即可被实例化。
     </li>
     <li>
      如果不使用 New 操作符，只有在所有的字段都被初始化之后，字段才被赋值，对象才被使用。
     </li>
     <li>
      结构变量通常分配在栈上，这使得它们的创建和销毁速度更快。但是，如果将结构用作类的字段，且这个类是引用类型，那么结构将存储在堆上。
     </li>
     <li>
      结构默认情况下是可变的，这意味着你可以修改它们的字段。但是，如果结构定义为只读，那么它的字段将是不可变的。
     </li>
    </ul>
    <hr/>
    <p>
     <strong>
      ‌结构体 vs 类‌
     </strong>
    </p>
    <table>
     <thead>
      <tr>
       <th>
        特性
       </th>
       <th>
        结构体（struct）
       </th>
       <th>
        类（class）
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        类型
       </td>
       <td>
        值类型（栈内存）
       </td>
       <td>
        引用类型（堆内存）
       </td>
      </tr>
      <tr>
       <td>
        继承
       </td>
       <td>
        不支持
       </td>
       <td>
        支持
       </td>
      </tr>
      <tr>
       <td>
        默认构造器
       </td>
       <td>
        C# 10 前无隐式无参构造器
       </td>
       <td>
        有隐式无参构造器
       </td>
      </tr>
      <tr>
       <td>
        赋值行为
       </td>
       <td>
        复制值
       </td>
       <td>
        复制引用
       </td>
      </tr>
      <tr>
       <td>
        适用场景
       </td>
       <td>
        小型、频繁创建的数据
       </td>
       <td>
        复杂对象、需要继承的场景
       </td>
      </tr>
     </tbody>
    </table>
    <hr/>
    <p>
     <strong>
      ‌结构体定义示例‌
     </strong>
    </p>
    <pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">struct</span> <span class="token class-name">Point</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> X<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> Y<span class="token punctuation">;</span>

    <span class="token comment">// C# 10+ 允许显式无参构造器</span>
    <span class="token keyword">public</span> <span class="token function">Point</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        X <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        Y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">Point</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> x<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> y<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        X <span class="token operator">=</span> x<span class="token punctuation">;</span>
        Y <span class="token operator">=</span> y<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"(</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">X</span><span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">Y</span><span class="token punctuation">}</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     ‌使用结构体‌
    </p>
    <pre><code class="prism language-csharp"><span class="token comment">// 创建结构体实例</span>
<span class="token class-name">Point</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Point</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Point</span> p2 <span class="token operator">=</span> p1<span class="token punctuation">;</span> <span class="token comment">// 值复制</span>

p2<span class="token punctuation">.</span>X <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>     <span class="token comment">// 修改副本不影响原数据</span>
p1<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 输出: (10, 20)</span>
p2<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 输出: (30, 20)</span>

<span class="token comment">// 使用无参构造器（C# 10+）</span>
<span class="token class-name">Point</span> p3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Point</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p3<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 输出: (0, 0)</span>
</code></pre>
    <hr/>
    <p>
     <strong>
      ‌何时使用结构体？‌
     </strong>
    </p>
    <ol>
     <li>
      数据量小‌：字段较少（通常少于 16 字节）。
     </li>
     <li>
      不可变需求‌：设计为不可变类型（所有字段只读）。
     </li>
     <li>
      ‌避免装箱‌：减少值类型与引用类型转换的性能损耗。
     </li>
     <li>
      ‌高频实例化‌：如游戏中的坐标计算，减少堆内存压力。
     </li>
    </ol>
    <p>
     <strong>
      ‌注意事项‌
     </strong>
    </p>
    <ul>
     <li>
      避免大型结构体‌：复制成本高，可能降低性能。
     </li>
     <li>
      ‌慎用可变结构体‌：修改副本可能导致预期外的行为。
     </li>
     <li>
      ‌构造器必须初始化所有字段‌：否则编译报错。
     </li>
     <li>
      ‌实现接口需谨慎‌：可能导致装箱操作（将结构体转为 object 或接口类型时）。
     </li>
    </ul>
    <p>
     <strong>
      通过合理使用结构体，可以优化内存分配和程序性能，但需根据场景权衡值与引用类型的优缺点。
     </strong>
    </p>
   </div>
   <link href="./../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="./../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f70755f79755f68756e5f6a696e2f:61727469636c652f64657461696c732f313436323135343335" class_="artid" style="display:none">
 </p>
</div>


