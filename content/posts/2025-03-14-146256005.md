---
layout: post
title: "Kotlin-apply-方法的用法和使用场景"
date: 2025-03-14 14:10:03 +0800
description: "apply 函数：用于对象的初始化和配置，返回对象本身。"
keywords: "Kotlin apply 方法的用法和使用场景"
categories: ['Kotlin']
tags: ['Kotlin', 'Kotlin', 'Apply', 'Android']
artid: "146256005"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146256005
    alt: "Kotlin-apply-方法的用法和使用场景"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146256005
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146256005
cover: https://bing.ee123.net/img/rand?artid=146256005
image: https://bing.ee123.net/img/rand?artid=146256005
img: https://bing.ee123.net/img/rand?artid=146256005
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Kotlin apply 方法的用法和使用场景
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h4>
     <a id="Kotlin_apply__1">
     </a>
     Kotlin
     <code>
      apply
     </code>
     方法的用法和使用场景
    </h4>
    <h5>
     <a id="1__3">
     </a>
     1.
     <strong>
      方法简介
     </strong>
    </h5>
    <p>
     <code>
      apply
     </code>
     是 Kotlin 标准库中的一个扩展函数，用于对对象执行一系列操作，并返回该对象本身。它的语法如下：
    </p>
    <pre><code class="prism language-kotlin"><span class="token keyword">inline</span> <span class="token keyword">fun</span> <span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> T<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>block<span class="token operator">:</span> T<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit<span class="token punctuation">)</span><span class="token operator">:</span> T
</code></pre>
    <ul>
     <li>
      <strong>
       参数
      </strong>
      ：
      <code>
       block
      </code>
      是一个 lambda 表达式，接收当前对象作为其接收者（
      <code>
       this
      </code>
      ），并在其中可以对该对象进行操作。
     </li>
     <li>
      <strong>
       返回值
      </strong>
      ：执行完
      <code>
       block
      </code>
      后，返回调用
      <code>
       apply
      </code>
      的对象本身, 作用类似于Java设计模式中的构建者模式，使用起来更加方便
     </li>
    </ul>
    <h5>
     <a id="2__14">
     </a>
     2.
     <strong>
      基本用法
     </strong>
    </h5>
    <p>
     <code>
      apply
     </code>
     通常用于需要对某个对象进行初始化或配置的场景，同时希望保留该对象本身作为结果。
    </p>
    <p>
     示例：
    </p>
    <pre><code class="prism language-kotlin"><span class="token keyword">val</span> person <span class="token operator">=</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span> <span class="token punctuation">{<!-- --></span>
    name <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"Alice"</span></span>
    age <span class="token operator">=</span> <span class="token number">30</span>
<span class="token punctuation">}</span>
<span class="token function">println</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// 输出: Alice</span>
<span class="token function">println</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>age<span class="token punctuation">)</span>  <span class="token comment">// 输出: 30</span>
</code></pre>
    <p>
     在这个例子中，
     <code>
      apply
     </code>
     被用来初始化
     <code>
      Person
     </code>
     对象的属性。
    </p>
    <h5>
     <a id="3__30">
     </a>
     3.
     <strong>
      使用场景
     </strong>
    </h5>
    <h6>
     <a id="_1_32">
     </a>
     场景 1：对象初始化
    </h6>
    <p>
     当需要创建并初始化一个对象时，
     <code>
      apply
     </code>
     可以使代码更加简洁。
    </p>
    <pre><code class="prism language-kotlin"><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">Config</span><span class="token punctuation">(</span><span class="token keyword">var</span> host<span class="token operator">:</span> String <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">,</span> <span class="token keyword">var</span> port<span class="token operator">:</span> Int <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>

<span class="token keyword">val</span> config <span class="token operator">=</span> <span class="token function">Config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span> <span class="token punctuation">{<!-- --></span>
    host <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"localhost"</span></span>
    port <span class="token operator">=</span> <span class="token number">8080</span>
<span class="token punctuation">}</span>

<span class="token function">println</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>host<span class="token punctuation">)</span> <span class="token comment">// 输出: localhost</span>
<span class="token function">println</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>port<span class="token punctuation">)</span> <span class="token comment">// 输出: 8080</span>
</code></pre>
    <h6>
     <a id="_2_48">
     </a>
     场景 2：链式调用
    </h6>
    <p>
     在需要对某个对象进行多次操作后继续使用该对象时，
     <code>
      apply
     </code>
     非常有用。
    </p>
    <pre><code class="prism language-kotlin"><span class="token keyword">val</span> list <span class="token operator">=</span> mutableListOf<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">add</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"Apple"</span></span><span class="token punctuation">)</span>
    <span class="token function">add</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"Banana"</span></span><span class="token punctuation">)</span>
    <span class="token function">add</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"Cherry"</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">println</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span>size<span class="token punctuation">)</span> <span class="token comment">// 输出: 3</span>
<span class="token function">println</span><span class="token punctuation">(</span>list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>   <span class="token comment">// 输出: Apple</span>
</code></pre>
    <h6>
     <a id="_3UI__63">
     </a>
     场景 3：UI 组件配置
    </h6>
    <p>
     在 Android 开发中，
     <code>
      apply
     </code>
     常用于配置 UI 组件。
    </p>
    <pre><code class="prism language-kotlin"><span class="token keyword">val</span> button <span class="token operator">=</span> <span class="token function">Button</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span> <span class="token punctuation">{<!-- --></span>
    text <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"Click Me"</span></span>
    setOnClickListener <span class="token punctuation">{<!-- --></span> 
        <span class="token function">println</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"Button clicked!"</span></span><span class="token punctuation">)</span> 
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h6>
     <a id="_4_76">
     </a>
     场景 4：简化嵌套对象的初始化
    </h6>
    <p>
     对于复杂的嵌套对象，
     <code>
      apply
     </code>
     可以让代码更易读。
    </p>
    <pre><code class="prism language-kotlin"><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">Address</span><span class="token punctuation">(</span><span class="token keyword">var</span> street<span class="token operator">:</span> String <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">,</span> <span class="token keyword">var</span> city<span class="token operator">:</span> String <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">)</span>
<span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token keyword">var</span> name<span class="token operator">:</span> String <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">,</span> <span class="token keyword">var</span> address<span class="token operator">:</span> Address <span class="token operator">=</span> <span class="token function">Address</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">val</span> user <span class="token operator">=</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span> <span class="token punctuation">{<!-- --></span>
    name <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"Bob"</span></span>
    address <span class="token operator">=</span> <span class="token function">Address</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span> <span class="token punctuation">{<!-- --></span>
        street <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"123 Main St"</span></span>
        city <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"Springfield"</span></span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span>       <span class="token comment">// 输出: Bob</span>
<span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>address<span class="token punctuation">.</span>street<span class="token punctuation">)</span> <span class="token comment">// 输出: 123 Main St</span>
<span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>address<span class="token punctuation">.</span>city<span class="token punctuation">)</span>   <span class="token comment">// 输出: Springfield</span>
</code></pre>
    <h5>
     <a id="4__97">
     </a>
     4.
     <strong>
      与其他作用域函数的区别
     </strong>
    </h5>
    <p>
     Kotlin 提供了多个作用域函数（如
     <code>
      let
     </code>
     ,
     <code>
      run
     </code>
     ,
     <code>
      with
     </code>
     ,
     <code>
      also
     </code>
     等），它们各有不同的适用场景。以下是
     <code>
      apply
     </code>
     与一些常见作用域函数的对比：
    </p>
    <table>
     <thead>
      <tr>
       <th>
        函数
       </th>
       <th>
        返回值
       </th>
       <th>
        接收者/上下文
       </th>
       <th>
        使用场景
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <code>
         apply
        </code>
       </td>
       <td>
        调用对象本身
       </td>
       <td>
        <code>
         this
        </code>
       </td>
       <td>
        初始化或配置对象
       </td>
      </tr>
      <tr>
       <td>
        <code>
         let
        </code>
       </td>
       <td>
        Lambda 的返回值
       </td>
       <td>
        <code>
         it
        </code>
       </td>
       <td>
        安全地操作可空对象
       </td>
      </tr>
      <tr>
       <td>
        <code>
         run
        </code>
       </td>
       <td>
        Lambda 的返回值
       </td>
       <td>
        <code>
         this
        </code>
        或无
       </td>
       <td>
        执行逻辑并返回结果
       </td>
      </tr>
      <tr>
       <td>
        <code>
         with
        </code>
       </td>
       <td>
        Lambda 的返回值
       </td>
       <td>
        <code>
         this
        </code>
       </td>
       <td>
        在已有对象上执行一系列操作
       </td>
      </tr>
      <tr>
       <td>
        <code>
         also
        </code>
       </td>
       <td>
        调用对象本身
       </td>
       <td>
        <code>
         it
        </code>
       </td>
       <td>
        执行副作用操作
       </td>
      </tr>
     </tbody>
    </table>
    <h5>
     <a id="5__108">
     </a>
     5.
     <strong>
      总结
     </strong>
    </h5>
    <p>
     apply 函数：用于对象的初始化和配置，返回对象本身。
    </p>
    <ul>
     <li>
      <strong>
       优点
      </strong>
      ：
      <code>
       apply
      </code>
      让对象的初始化和配置更加简洁、直观，通过合理使用 apply 函数，可以显著提高代码的可维护性和可读性
     </li>
     <li>
      <strong>
       适用场景
      </strong>
      ：对象初始化、链式调用、UI 组件配置、嵌套对象初始化、在集合和构建器模式中使用等。
     </li>
     <li>
      <strong>
       注意事项
      </strong>
      ：如果需要返回其他值而不是对象本身，可以选择其他作用域函数（如
      <code>
       let
      </code>
      或
      <code>
       run
      </code>
      ）。
     </li>
    </ul>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f33373633393930302f:61727469636c652f64657461696c732f313436323536303035" class_="artid" style="display:none">
 </p>
</div>


