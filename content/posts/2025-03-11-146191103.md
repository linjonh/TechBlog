---
layout: post
title: "Kaiming-Uniform-初始化神经网络权重初始化的优雅解决方案"
date: 2025-03-11 22:44:52 +0800
description: "Kaiming 初始化通过分析网络的方差传播，提出了一种基于层输入和输出维度的初始化方法，确保信号在深层网络中的稳定传递。"
keywords: "Kaiming Uniform 初始化：神经网络权重初始化的优雅解决方案"
categories: ['Llm', 'Learning', 'Deep']
tags: ['神经网络', '深度学习', '人工智能']
artid: "146191103"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146191103
    alt: "Kaiming-Uniform-初始化神经网络权重初始化的优雅解决方案"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146191103
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146191103
cover: https://bing.ee123.net/img/rand?artid=146191103
image: https://bing.ee123.net/img/rand?artid=146191103
img: https://bing.ee123.net/img/rand?artid=146191103
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Kaiming Uniform 初始化：神经网络权重初始化的优雅解决方案
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-github-gist" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="Kaiming_Uniform__2">
     </a>
     Kaiming Uniform 初始化：神经网络权重初始化的优雅解决方案
    </h2>
    <p>
     在深度学习的模型训练中，权重初始化的选择对网络的收敛速度和性能有着深远影响。传统的随机初始化（如高斯分布）在浅层网络中尚可接受，但随着网络深度增加，梯度消失或爆炸的问题变得愈发严重。为了解决这一问题，Kaiming He 等人在 2015 年提出了 Kaiming 初始化（也称为 He 初始化），其中
     <code>
      kaiming_uniform_
     </code>
     是 PyTorch 中实现的一种均匀分布形式。本文将深入探讨其原理、实现细节以及在 LoRA（Low-Rank Adaptation）中的应用。
    </p>
    <h3>
     <a id="_6">
     </a>
     一、背景与动机
    </h3>
    <p>
     在深度神经网络（如 CNN 或 Transformer）中，前向传播和反向传播的稳定性依赖于每一层的输入和输出的数值范围。如果权重初始化不当，可能导致：
    </p>
    <ul>
     <li>
      <strong>
       梯度消失
      </strong>
      ：每一层的激活值过小，梯度在反向传播中逐渐衰减至零。
     </li>
     <li>
      <strong>
       梯度爆炸
      </strong>
      ：激活值过大，梯度在反向传播中指数增长，导致训练不稳定。
     </li>
    </ul>
    <p>
     Kaiming 初始化通过分析网络的方差传播，提出了一种基于层输入和输出维度的初始化方法，确保信号在深层网络中的稳定传递。它最初在论文
     <em>
      Delving Deep into Rectifiers: Surpassing Human-Level Performance on ImageNet Classification
     </em>
     （He et al., 2015）中提出，针对 ReLU 激活函数设计，后来被广泛应用于各类网络。
    </p>
    <h3>
     <a id="Kaiming_Uniform__14">
     </a>
     二、Kaiming Uniform 的数学原理
    </h3>
    <p>
     Kaiming 初始化假设网络使用 ReLU 或其变体（如 Leaky ReLU）作为激活函数，其核心目标是保持每一层的输出方差与输入方差一致。
    </p>
    <h4>
     <a id="1__18">
     </a>
     1. 前向传播的方差分析
    </h4>
    <p>
     考虑一个线性层：
     <br/>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         y 
         
        
          = 
         
        
          W 
         
        
          x 
         
        
       
         y = W x
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           y
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.1389em;">
           W
          </span>
          <span class="mord mathnormal">
           x
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <ul>
     <li>
      (
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         x 
         
        
          ∈ 
         
         
         
           R 
          
          
          
            n 
           
           
           
             i 
            
           
             n 
            
           
          
         
        
       
         x \in \mathbb{R}^{n_{in}}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;">
          </span>
          <span class="mord mathnormal">
           x
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           ∈
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.6889em;">
          </span>
          <span class="mord">
           <span class="mord mathbb">
            R
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.6644em;">
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    n
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3281em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight">
                           in
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      )：输入向量，(
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         n 
          
          
          
            i 
           
          
            n 
           
          
         
        
       
         n_{in}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            n
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   in
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ) 是输入维度。
     </li>
     <li>
      (
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         W 
         
        
          ∈ 
         
         
         
           R 
          
          
           
           
             n 
            
            
            
              o 
             
            
              u 
             
            
              t 
             
            
           
          
            × 
           
           
           
             n 
            
            
            
              i 
             
            
              n 
             
            
           
          
         
        
       
         W \in \mathbb{R}^{n_{out} \times n_{in}}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.7224em; vertical-align: -0.0391em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.1389em;">
           W
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           ∈
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.7713em;">
          </span>
          <span class="mord">
           <span class="mord mathbb">
            R
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.7713em;">
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    n
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.2963em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight">
                           o
                          </span>
                          <span class="mord mathnormal mtight">
                           u
                          </span>
                          <span class="mord mathnormal mtight">
                           t
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mbin mtight">
                   ×
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    n
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3281em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight">
                           in
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      )：权重矩阵，(
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         n 
          
          
          
            o 
           
          
            u 
           
          
            t 
           
          
         
        
       
         n_{out}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            n
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2806em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   o
                  </span>
                  <span class="mord mathnormal mtight">
                   u
                  </span>
                  <span class="mord mathnormal mtight">
                   t
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ) 是输出维度。
     </li>
     <li>
      (
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         y 
         
        
          ∈ 
         
         
         
           R 
          
          
          
            n 
           
           
           
             o 
            
           
             u 
            
           
             t 
            
           
          
         
        
       
         y \in \mathbb{R}^{n_{out}}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.7335em; vertical-align: -0.1944em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           y
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           ∈
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.6889em;">
          </span>
          <span class="mord">
           <span class="mord mathbb">
            R
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.6644em;">
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    n
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.2963em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight">
                           o
                          </span>
                          <span class="mord mathnormal mtight">
                           u
                          </span>
                          <span class="mord mathnormal mtight">
                           t
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      )：输出向量。
     </li>
    </ul>
    <p>
     假设：
    </p>
    <ul>
     <li>
      (
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         x 
         
        
       
         x
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.4306em;">
          </span>
          <span class="mord mathnormal">
           x
          </span>
         </span>
        </span>
       </span>
      </span>
      ) 的每个元素是独立同分布（i.i.d.），方差为 (
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         Var 
         
        
          ( 
         
        
          x 
         
        
          ) 
         
        
       
         \text{Var}(x)
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord text">
           <span class="mord">
            Var
           </span>
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord mathnormal">
           x
          </span>
          <span class="mclose">
           )
          </span>
         </span>
        </span>
       </span>
      </span>
      )。
     </li>
     <li>
      (
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         W 
         
        
       
         W
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.1389em;">
           W
          </span>
         </span>
        </span>
       </span>
      </span>
      ) 的每个元素也是 i.i.d.，初始方差为 (
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         Var 
         
        
          ( 
         
        
          W 
         
        
          ) 
         
        
       
         \text{Var}(W)
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord text">
           <span class="mord">
            Var
           </span>
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord mathnormal" style="margin-right: 0.1389em;">
           W
          </span>
          <span class="mclose">
           )
          </span>
         </span>
        </span>
       </span>
      </span>
      )。
     </li>
    </ul>
    <p>
     则输出 (
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        y 
         
        
          i 
         
        
       
      
        y_i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           y
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ) 的方差为：
     <br/>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         Var 
         
        
          ( 
         
         
         
           y 
          
         
           i 
          
         
        
          ) 
         
        
          = 
         
        
          Var 
         
         
         
           ( 
          
          
          
            ∑ 
           
           
           
             j 
            
           
             = 
            
           
             1 
            
           
           
           
             n 
            
            
            
              i 
             
            
              n 
             
            
           
          
          
          
            W 
           
           
           
             i 
            
           
             j 
            
           
          
          
          
            x 
           
          
            j 
           
          
         
           ) 
          
         
        
          = 
         
         
         
           ∑ 
          
          
          
            j 
           
          
            = 
           
          
            1 
           
          
          
          
            n 
           
           
           
             i 
            
           
             n 
            
           
          
         
        
          Var 
         
        
          ( 
         
         
         
           W 
          
          
          
            i 
           
          
            j 
           
          
         
         
         
           x 
          
         
           j 
          
         
        
          ) 
         
        
       
         \text{Var}(y_i) = \text{Var}\left( \sum_{j=1}^{n_{in}} W_{ij} x_j \right) = \sum_{j=1}^{n_{in}} \text{Var}(W_{ij} x_j)
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord text">
           <span class="mord">
            Var
           </span>
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0359em;">
            y
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose">
           )
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 3.1638em; vertical-align: -1.4138em;">
          </span>
          <span class="mord text">
           <span class="mord">
            Var
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="minner">
           <span class="mopen delimcenter" style="top: 0em;">
            <span class="delimsizing size4">
             (
            </span>
           </span>
           <span class="mop op-limits">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.6625em;">
               <span class="" style="top: -1.8723em; margin-left: 0em;">
                <span class="pstrut" style="height: 3.05em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                   j
                  </span>
                  <span class="mrel mtight">
                   =
                  </span>
                  <span class="mord mtight">
                   1
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.05em;">
                <span class="pstrut" style="height: 3.05em;">
                </span>
                <span class="">
                 <span class="mop op-symbol large-op">
                  ∑
                 </span>
                </span>
               </span>
               <span class="" style="top: -4.3111em; margin-left: 0em;">
                <span class="pstrut" style="height: 3.05em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    n
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3281em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight">
                           in
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 1.4138em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mspace" style="margin-right: 0.1667em;">
           </span>
           <span class="mord">
            <span class="mord mathnormal" style="margin-right: 0.1389em;">
             W
            </span>
            <span class="msupsub">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 0.3117em;">
                <span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;">
                 <span class="pstrut" style="height: 2.7em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                    ij
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                ​
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 0.2861em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mord">
            <span class="mord mathnormal">
             x
            </span>
            <span class="msupsub">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 0.3117em;">
                <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                 <span class="pstrut" style="height: 2.7em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                   j
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                ​
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 0.2861em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mclose delimcenter" style="top: 0em;">
            <span class="delimsizing size4">
             )
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 3.0763em; vertical-align: -1.4138em;">
          </span>
          <span class="mop op-limits">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 1.6625em;">
              <span class="" style="top: -1.8723em; margin-left: 0em;">
               <span class="pstrut" style="height: 3.05em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                 <span class="mrel mtight">
                  =
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.05em;">
               <span class="pstrut" style="height: 3.05em;">
               </span>
               <span class="">
                <span class="mop op-symbol large-op">
                 ∑
                </span>
               </span>
              </span>
              <span class="" style="top: -4.3111em; margin-left: 0em;">
               <span class="pstrut" style="height: 3.05em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   n
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3281em;">
                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         <span class="mord mathnormal mtight">
                          in
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      ​
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.143em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 1.4138em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mord text">
           <span class="mord">
            Var
           </span>
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.1389em;">
            W
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                   ij
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            x
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose">
           )
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     若 (
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        W 
         
         
         
           i 
          
         
           j 
          
         
        
       
      
        W_{ij}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.1389em;">
           W
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  ij
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ) 和 (
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        x 
         
        
          j 
         
        
       
      
        x_j
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           x
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                 j
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ) 独立：
     <br/>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         Var 
         
        
          ( 
         
         
         
           y 
          
         
           i 
          
         
        
          ) 
         
        
          = 
         
         
         
           n 
          
          
          
            i 
           
          
            n 
           
          
         
        
          ⋅ 
         
        
          Var 
         
        
          ( 
         
         
         
           W 
          
          
          
            i 
           
          
            j 
           
          
         
        
          ) 
         
        
          ⋅ 
         
        
          Var 
         
        
          ( 
         
         
         
           x 
          
         
           j 
          
         
        
          ) 
         
        
          = 
         
         
         
           n 
          
          
          
            i 
           
          
            n 
           
          
         
        
          ⋅ 
         
        
          Var 
         
        
          ( 
         
        
          W 
         
        
          ) 
         
        
          ⋅ 
         
        
          Var 
         
        
          ( 
         
        
          x 
         
        
          ) 
         
        
       
         \text{Var}(y_i) = n_{in} \cdot \text{Var}(W_{ij}) \cdot \text{Var}(x_j) = n_{in} \cdot \text{Var}(W) \cdot \text{Var}(x)
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord text">
           <span class="mord">
            Var
           </span>
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0359em;">
            y
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose">
           )
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.5945em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            n
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   in
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           ⋅
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1.0361em; vertical-align: -0.2861em;">
          </span>
          <span class="mord text">
           <span class="mord">
            Var
           </span>
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.1389em;">
            W
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                   ij
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose">
           )
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           ⋅
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1.0361em; vertical-align: -0.2861em;">
          </span>
          <span class="mord text">
           <span class="mord">
            Var
           </span>
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            x
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose">
           )
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.5945em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            n
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   in
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           ⋅
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord text">
           <span class="mord">
            Var
           </span>
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord mathnormal" style="margin-right: 0.1389em;">
           W
          </span>
          <span class="mclose">
           )
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           ⋅
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord text">
           <span class="mord">
            Var
           </span>
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord mathnormal">
           x
          </span>
          <span class="mclose">
           )
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     对于 ReLU 激活 (
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        f 
        
       
         ( 
        
       
         y 
        
       
         ) 
        
       
         = 
        
       
         max 
        
       
         ⁡ 
        
       
         ( 
        
       
         0 
        
       
         , 
        
       
         y 
        
       
         ) 
        
       
      
        f(y) = \max(0, y)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1076em;">
          f
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          y
         </span>
         <span class="mclose">
          )
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mop">
          max
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord">
          0
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          y
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     )，输出方差减半（因为一半的激活被置零）：
     <br/>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         Var 
         
        
          ( 
         
        
          f 
         
        
          ( 
         
        
          y 
         
        
          ) 
         
        
          ) 
         
        
          = 
         
         
         
           1 
          
         
           2 
          
         
         
         
           n 
          
          
          
            i 
           
          
            n 
           
          
         
        
          ⋅ 
         
        
          Var 
         
        
          ( 
         
        
          W 
         
        
          ) 
         
        
          ⋅ 
         
        
          Var 
         
        
          ( 
         
        
          x 
         
        
          ) 
         
        
       
         \text{Var}(f(y)) = \frac{1}{2} n_{in} \cdot \text{Var}(W) \cdot \text{Var}(x)
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord text">
           <span class="mord">
            Var
           </span>
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord mathnormal" style="margin-right: 0.1076em;">
           f
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           y
          </span>
          <span class="mclose">
           ))
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 2.0074em; vertical-align: -0.686em;">
          </span>
          <span class="mord">
           <span class="mopen nulldelimiter">
           </span>
           <span class="mfrac">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.3214em;">
               <span class="" style="top: -2.314em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  2
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.23em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="frac-line" style="border-bottom-width: 0.04em;">
                </span>
               </span>
               <span class="" style="top: -3.677em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  1
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.686em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mclose nulldelimiter">
           </span>
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            n
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   in
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           ⋅
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord text">
           <span class="mord">
            Var
           </span>
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord mathnormal" style="margin-right: 0.1389em;">
           W
          </span>
          <span class="mclose">
           )
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           ⋅
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord text">
           <span class="mord">
            Var
           </span>
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord mathnormal">
           x
          </span>
          <span class="mclose">
           )
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     为了保持 (
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        Var 
        
       
         ( 
        
       
         f 
        
       
         ( 
        
       
         y 
        
       
         ) 
        
       
         ) 
        
       
         = 
        
       
         Var 
        
       
         ( 
        
       
         x 
        
       
         ) 
        
       
      
        \text{Var}(f(y)) = \text{Var}(x)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord text">
          <span class="mord">
           Var
          </span>
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1076em;">
          f
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          y
         </span>
         <span class="mclose">
          ))
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord text">
          <span class="mord">
           Var
          </span>
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          x
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     )：
     <br/>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         1 
          
         
           2 
          
         
         
         
           n 
          
          
          
            i 
           
          
            n 
           
          
         
        
          ⋅ 
         
        
          Var 
         
        
          ( 
         
        
          W 
         
        
          ) 
         
        
          = 
         
        
          1 
           
        
          ⟹ 
           
        
          Var 
         
        
          ( 
         
        
          W 
         
        
          ) 
         
        
          = 
         
         
         
           2 
          
          
          
            n 
           
           
           
             i 
            
           
             n 
            
           
          
         
        
       
         \frac{1}{2} n_{in} \cdot \text{Var}(W) = 1 \implies \text{Var}(W) = \frac{2}{n_{in}}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 2.0074em; vertical-align: -0.686em;">
          </span>
          <span class="mord">
           <span class="mopen nulldelimiter">
           </span>
           <span class="mfrac">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.3214em;">
               <span class="" style="top: -2.314em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  2
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.23em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="frac-line" style="border-bottom-width: 0.04em;">
                </span>
               </span>
               <span class="" style="top: -3.677em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  1
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.686em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mclose nulldelimiter">
           </span>
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            n
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   in
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           ⋅
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord text">
           <span class="mord">
            Var
           </span>
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord mathnormal" style="margin-right: 0.1389em;">
           W
          </span>
          <span class="mclose">
           )
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.6684em; vertical-align: -0.024em;">
          </span>
          <span class="mord">
           1
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           ⟹
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord text">
           <span class="mord">
            Var
           </span>
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord mathnormal" style="margin-right: 0.1389em;">
           W
          </span>
          <span class="mclose">
           )
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 2.1574em; vertical-align: -0.836em;">
          </span>
          <span class="mord">
           <span class="mopen nulldelimiter">
           </span>
           <span class="mfrac">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.3214em;">
               <span class="" style="top: -2.314em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  <span class="mord mathnormal">
                   n
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3117em;">
                      <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mtight">
                         <span class="mord mathnormal mtight">
                          in
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      ​
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.15em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.23em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="frac-line" style="border-bottom-width: 0.04em;">
                </span>
               </span>
               <span class="" style="top: -3.677em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  2
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.836em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mclose nulldelimiter">
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <h4>
     <a id="2__48">
     </a>
     2. 均匀分布的参数
    </h4>
    <p>
     Kaiming 初始化使用均匀分布 (
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        U 
        
       
         ( 
        
       
         − 
        
       
         a 
        
       
         , 
        
       
         a 
        
       
         ) 
        
       
      
        U(-a, a)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.109em;">
          U
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord">
          −
         </span>
         <span class="mord mathnormal">
          a
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          a
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     ) 初始化权重，其中 (
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        a 
        
       
      
        a
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          a
         </span>
        </span>
       </span>
      </span>
     </span>
     ) 是边界值。对于均匀分布：
     <br/>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         Var 
         
        
          ( 
         
        
          W 
         
        
          ) 
         
        
          = 
         
         
          
          
            ( 
           
          
            a 
           
          
            − 
           
          
            ( 
           
          
            − 
           
          
            a 
           
          
            ) 
           
           
           
             ) 
            
           
             2 
            
           
          
         
           12 
          
         
        
          = 
         
         
          
          
            ( 
           
          
            2 
           
          
            a 
           
           
           
             ) 
            
           
             2 
            
           
          
         
           12 
          
         
        
          = 
         
         
          
          
            4 
           
           
           
             a 
            
           
             2 
            
           
          
         
           12 
          
         
        
          = 
         
         
          
          
            a 
           
          
            2 
           
          
         
           3 
          
         
        
       
         \text{Var}(W) = \frac{(a - (-a))^2}{12} = \frac{(2a)^2}{12} = \frac{4a^2}{12} = \frac{a^2}{3}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord text">
           <span class="mord">
            Var
           </span>
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord mathnormal" style="margin-right: 0.1389em;">
           W
          </span>
          <span class="mclose">
           )
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 2.1771em; vertical-align: -0.686em;">
          </span>
          <span class="mord">
           <span class="mopen nulldelimiter">
           </span>
           <span class="mfrac">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.4911em;">
               <span class="" style="top: -2.314em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  12
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.23em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="frac-line" style="border-bottom-width: 0.04em;">
                </span>
               </span>
               <span class="" style="top: -3.677em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mopen">
                  (
                 </span>
                 <span class="mord mathnormal">
                  a
                 </span>
                 <span class="mspace" style="margin-right: 0.2222em;">
                 </span>
                 <span class="mbin">
                  −
                 </span>
                 <span class="mspace" style="margin-right: 0.2222em;">
                 </span>
                 <span class="mopen">
                  (
                 </span>
                 <span class="mord">
                  −
                 </span>
                 <span class="mord mathnormal">
                  a
                 </span>
                 <span class="mclose">
                  )
                 </span>
                 <span class="mclose">
                  <span class="mclose">
                   )
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.8141em;">
                      <span class="" style="top: -3.063em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mtight">
                         2
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.686em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mclose nulldelimiter">
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 2.1771em; vertical-align: -0.686em;">
          </span>
          <span class="mord">
           <span class="mopen nulldelimiter">
           </span>
           <span class="mfrac">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.4911em;">
               <span class="" style="top: -2.314em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  12
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.23em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="frac-line" style="border-bottom-width: 0.04em;">
                </span>
               </span>
               <span class="" style="top: -3.677em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mopen">
                  (
                 </span>
                 <span class="mord">
                  2
                 </span>
                 <span class="mord mathnormal">
                  a
                 </span>
                 <span class="mclose">
                  <span class="mclose">
                   )
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.8141em;">
                      <span class="" style="top: -3.063em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mtight">
                         2
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.686em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mclose nulldelimiter">
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 2.1771em; vertical-align: -0.686em;">
          </span>
          <span class="mord">
           <span class="mopen nulldelimiter">
           </span>
           <span class="mfrac">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.4911em;">
               <span class="" style="top: -2.314em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  12
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.23em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="frac-line" style="border-bottom-width: 0.04em;">
                </span>
               </span>
               <span class="" style="top: -3.677em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  4
                 </span>
                 <span class="mord">
                  <span class="mord mathnormal">
                   a
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.8141em;">
                      <span class="" style="top: -3.063em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mtight">
                         2
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.686em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mclose nulldelimiter">
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 2.1771em; vertical-align: -0.686em;">
          </span>
          <span class="mord">
           <span class="mopen nulldelimiter">
           </span>
           <span class="mfrac">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.4911em;">
               <span class="" style="top: -2.314em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  3
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.23em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="frac-line" style="border-bottom-width: 0.04em;">
                </span>
               </span>
               <span class="" style="top: -3.677em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  <span class="mord mathnormal">
                   a
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.8141em;">
                      <span class="" style="top: -3.063em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mtight">
                         2
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.686em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mclose nulldelimiter">
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     令：
     <br/>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         a 
           
          
            2 
           
          
         
           3 
          
         
        
          = 
         
         
         
           2 
          
          
          
            n 
           
           
           
             i 
            
           
             n 
            
           
          
         
        
       
         \frac{a^2}{3} = \frac{2}{n_{in}}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 2.1771em; vertical-align: -0.686em;">
          </span>
          <span class="mord">
           <span class="mopen nulldelimiter">
           </span>
           <span class="mfrac">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.4911em;">
               <span class="" style="top: -2.314em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  3
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.23em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="frac-line" style="border-bottom-width: 0.04em;">
                </span>
               </span>
               <span class="" style="top: -3.677em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  <span class="mord mathnormal">
                   a
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.8141em;">
                      <span class="" style="top: -3.063em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mtight">
                         2
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.686em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mclose nulldelimiter">
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 2.1574em; vertical-align: -0.836em;">
          </span>
          <span class="mord">
           <span class="mopen nulldelimiter">
           </span>
           <span class="mfrac">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.3214em;">
               <span class="" style="top: -2.314em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  <span class="mord mathnormal">
                   n
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3117em;">
                      <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mtight">
                         <span class="mord mathnormal mtight">
                          in
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      ​
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.15em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.23em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="frac-line" style="border-bottom-width: 0.04em;">
                </span>
               </span>
               <span class="" style="top: -3.677em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  2
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.836em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mclose nulldelimiter">
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     解得：
     <br/>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         a 
         
        
          = 
         
         
          
          
            6 
           
           
           
             n 
            
            
            
              i 
             
            
              n 
             
            
           
          
         
        
       
         a = \sqrt{\frac{6}{n_{in}}}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.4306em;">
          </span>
          <span class="mord mathnormal">
           a
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 2.44em; vertical-align: -0.8634em;">
          </span>
          <span class="mord sqrt">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 1.5766em;">
              <span class="svg-align" style="top: -4.4em;">
               <span class="pstrut" style="height: 4.4em;">
               </span>
               <span class="mord" style="padding-left: 1em;">
                <span class="mord">
                 <span class="mopen nulldelimiter">
                 </span>
                 <span class="mfrac">
                  <span class="vlist-t vlist-t2">
                   <span class="vlist-r">
                    <span class="vlist" style="height: 1.3214em;">
                     <span class="" style="top: -2.314em;">
                      <span class="pstrut" style="height: 3em;">
                      </span>
                      <span class="mord">
                       <span class="mord">
                        <span class="mord mathnormal">
                         n
                        </span>
                        <span class="msupsub">
                         <span class="vlist-t vlist-t2">
                          <span class="vlist-r">
                           <span class="vlist" style="height: 0.3117em;">
                            <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                             <span class="pstrut" style="height: 2.7em;">
                             </span>
                             <span class="sizing reset-size6 size3 mtight">
                              <span class="mord mtight">
                               <span class="mord mathnormal mtight">
                                in
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                           <span class="vlist-s">
                            ​
                           </span>
                          </span>
                          <span class="vlist-r">
                           <span class="vlist" style="height: 0.15em;">
                            <span class="">
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="" style="top: -3.23em;">
                      <span class="pstrut" style="height: 3em;">
                      </span>
                      <span class="frac-line" style="border-bottom-width: 0.04em;">
                      </span>
                     </span>
                     <span class="" style="top: -3.677em;">
                      <span class="pstrut" style="height: 3em;">
                      </span>
                      <span class="mord">
                       <span class="mord">
                        6
                       </span>
                      </span>
                     </span>
                    </span>
                    <span class="vlist-s">
                     ​
                    </span>
                   </span>
                   <span class="vlist-r">
                    <span class="vlist" style="height: 0.836em;">
                     <span class="">
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mclose nulldelimiter">
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.5366em;">
               <span class="pstrut" style="height: 4.4em;">
               </span>
               <span class="hide-tail" style="min-width: 1.02em; height: 2.48em;">
                <svg height="2.48em" preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 2592" width="400em">
                 <path d="M424,2478
c-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514
c0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20
s-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121
s209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081
l0 -0c4,-6.7,10,-10,18,-10 H400000
v40H1014.6
s-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185
c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2z M1001 80
h400000v40h-400000z">
                 </path>
                </svg>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8634em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     因此，权重初始化为：
     <br/>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         W 
         
        
          ∼ 
         
        
          U 
         
         
         
           ( 
          
         
           − 
          
          
           
           
             6 
            
            
            
              n 
             
             
             
               i 
              
             
               n 
              
             
            
           
          
         
           , 
          
          
           
           
             6 
            
            
            
              n 
             
             
             
               i 
              
             
               n 
              
             
            
           
          
         
           ) 
          
         
        
       
         W \sim U\left(-\sqrt{\frac{6}{n_{in}}}, \sqrt{\frac{6}{n_{in}}}\right)
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.1389em;">
           W
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           ∼
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 2.5266em; vertical-align: -0.95em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.109em;">
           U
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="minner">
           <span class="mopen delimcenter" style="top: 0em;">
            <span class="delimsizing size3">
             (
            </span>
           </span>
           <span class="mord">
            −
           </span>
           <span class="mord sqrt">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.5766em;">
               <span class="svg-align" style="top: -4.4em;">
                <span class="pstrut" style="height: 4.4em;">
                </span>
                <span class="mord" style="padding-left: 1em;">
                 <span class="mord">
                  <span class="mopen nulldelimiter">
                  </span>
                  <span class="mfrac">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 1.3214em;">
                      <span class="" style="top: -2.314em;">
                       <span class="pstrut" style="height: 3em;">
                       </span>
                       <span class="mord">
                        <span class="mord">
                         <span class="mord mathnormal">
                          n
                         </span>
                         <span class="msupsub">
                          <span class="vlist-t vlist-t2">
                           <span class="vlist-r">
                            <span class="vlist" style="height: 0.3117em;">
                             <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                              <span class="pstrut" style="height: 2.7em;">
                              </span>
                              <span class="sizing reset-size6 size3 mtight">
                               <span class="mord mtight">
                                <span class="mord mathnormal mtight">
                                 in
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                            <span class="vlist-s">
                             ​
                            </span>
                           </span>
                           <span class="vlist-r">
                            <span class="vlist" style="height: 0.15em;">
                             <span class="">
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="" style="top: -3.23em;">
                       <span class="pstrut" style="height: 3em;">
                       </span>
                       <span class="frac-line" style="border-bottom-width: 0.04em;">
                       </span>
                      </span>
                      <span class="" style="top: -3.677em;">
                       <span class="pstrut" style="height: 3em;">
                       </span>
                       <span class="mord">
                        <span class="mord">
                         6
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      ​
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.836em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mclose nulldelimiter">
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.5366em;">
                <span class="pstrut" style="height: 4.4em;">
                </span>
                <span class="hide-tail" style="min-width: 1.02em; height: 2.48em;">
                 <svg height="2.48em" preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 2592" width="400em">
                  <path d="M424,2478
c-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514
c0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20
s-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121
s209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081
l0 -0c4,-6.7,10,-10,18,-10 H400000
v40H1014.6
s-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185
c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2z M1001 80
h400000v40h-400000z">
                  </path>
                 </svg>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.8634em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mpunct">
            ,
           </span>
           <span class="mspace" style="margin-right: 0.1667em;">
           </span>
           <span class="mord sqrt">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.5766em;">
               <span class="svg-align" style="top: -4.4em;">
                <span class="pstrut" style="height: 4.4em;">
                </span>
                <span class="mord" style="padding-left: 1em;">
                 <span class="mord">
                  <span class="mopen nulldelimiter">
                  </span>
                  <span class="mfrac">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 1.3214em;">
                      <span class="" style="top: -2.314em;">
                       <span class="pstrut" style="height: 3em;">
                       </span>
                       <span class="mord">
                        <span class="mord">
                         <span class="mord mathnormal">
                          n
                         </span>
                         <span class="msupsub">
                          <span class="vlist-t vlist-t2">
                           <span class="vlist-r">
                            <span class="vlist" style="height: 0.3117em;">
                             <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                              <span class="pstrut" style="height: 2.7em;">
                              </span>
                              <span class="sizing reset-size6 size3 mtight">
                               <span class="mord mtight">
                                <span class="mord mathnormal mtight">
                                 in
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                            <span class="vlist-s">
                             ​
                            </span>
                           </span>
                           <span class="vlist-r">
                            <span class="vlist" style="height: 0.15em;">
                             <span class="">
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="" style="top: -3.23em;">
                       <span class="pstrut" style="height: 3em;">
                       </span>
                       <span class="frac-line" style="border-bottom-width: 0.04em;">
                       </span>
                      </span>
                      <span class="" style="top: -3.677em;">
                       <span class="pstrut" style="height: 3em;">
                       </span>
                       <span class="mord">
                        <span class="mord">
                         6
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      ​
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.836em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mclose nulldelimiter">
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.5366em;">
                <span class="pstrut" style="height: 4.4em;">
                </span>
                <span class="hide-tail" style="min-width: 1.02em; height: 2.48em;">
                 <svg height="2.48em" preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 2592" width="400em">
                  <path d="M424,2478
c-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514
c0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20
s-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121
s209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081
l0 -0c4,-6.7,10,-10,18,-10 H400000
v40H1014.6
s-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185
c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2z M1001 80
h400000v40h-400000z">
                  </path>
                 </svg>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.8634em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mclose delimcenter" style="top: 0em;">
            <span class="delimsizing size3">
             )
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <h4>
     <a id="3___a___66">
     </a>
     3. 参数 (
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        a 
        
       
      
        a
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          a
         </span>
        </span>
       </span>
      </span>
     </span>
     ) 的调整
    </h4>
    <p>
     在 PyTorch 的
     <code>
      nn.init.kaiming_uniform_
     </code>
     中，参数 (
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        a 
        
       
      
        a
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          a
         </span>
        </span>
       </span>
      </span>
     </span>
     ) 允许用户调整分布的宽度，默认值为 (
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        5 
         
        
       
      
        \sqrt{5}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.04em; vertical-align: -0.1328em;">
         </span>
         <span class="mord sqrt">
          <span class="vlist-t vlist-t2">
           <span class="vlist-r">
            <span class="vlist" style="height: 0.9072em;">
             <span class="svg-align" style="top: -3em;">
              <span class="pstrut" style="height: 3em;">
              </span>
              <span class="mord" style="padding-left: 0.833em;">
               <span class="mord">
                5
               </span>
              </span>
             </span>
             <span class="" style="top: -2.8672em;">
              <span class="pstrut" style="height: 3em;">
              </span>
              <span class="hide-tail" style="min-width: 0.853em; height: 1.08em;">
               <svg height="1.08em" preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 1080" width="400em">
                <path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z">
                </path>
               </svg>
              </span>
             </span>
            </span>
            <span class="vlist-s">
             ​
            </span>
           </span>
           <span class="vlist-r">
            <span class="vlist" style="height: 0.1328em;">
             <span class="">
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     )（对应 Xavier 初始化的一种变体）。但在 Kaiming 原始设计中，(
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        a 
        
       
         = 
        
       
         0 
        
       
      
        a = 0
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          a
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          0
         </span>
        </span>
       </span>
      </span>
     </span>
     )（纯 ReLU）或基于激活函数的斜率调整。
    </p>
    <hr/>
    <h3>
     <a id="PyTorch__71">
     </a>
     三、PyTorch 中的实现
    </h3>
    <p>
     PyTorch 提供了
     <code>
      nn.init.kaiming_uniform_
     </code>
     函数，签名如下：
    </p>
    <pre><code class="prism language-python">torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>init<span class="token punctuation">.</span>kaiming_uniform_<span class="token punctuation">(</span>tensor<span class="token punctuation">,</span> a<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">'fan_in'</span><span class="token punctuation">,</span> nonlinearity<span class="token operator">=</span><span class="token string">'relu'</span><span class="token punctuation">)</span>
</code></pre>
    <ul>
     <li>
      <strong>
       tensor
      </strong>
      ：要初始化的张量，通常是权重矩阵（形状为 (
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         [ 
         
         
         
           n 
          
          
          
            o 
           
          
            u 
           
          
            t 
           
          
         
        
          , 
         
         
         
           n 
          
          
          
            i 
           
          
            n 
           
          
         
        
          ] 
         
        
       
         [n_{out}, n_{in}]
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mopen">
           [
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            n
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2806em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   o
                  </span>
                  <span class="mord mathnormal mtight">
                   u
                  </span>
                  <span class="mord mathnormal mtight">
                   t
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            n
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   in
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose">
           ]
          </span>
         </span>
        </span>
       </span>
      </span>
      )）。
     </li>
     <li>
      <strong>
       a
      </strong>
      ：负斜率参数，对于 ReLU 通常为 0，对于 Leaky ReLU 为斜率值。
     </li>
     <li>
      <strong>
       mode
      </strong>
      ：选择
      <code>
       fan_in
      </code>
      （输入维度，推荐用于前向稳定性）或
      <code>
       fan_out
      </code>
      （输出维度，用于反向稳定性）。
     </li>
     <li>
      <strong>
       nonlinearity
      </strong>
      ：激活函数类型（如
      <code>
       'relu'
      </code>
      或
      <code>
       'leaky_relu'
      </code>
      ）。
     </li>
    </ul>
    <p>
     在 LoRA 的代码中（例如 Microsoft LoRA 实现,
     <a href="https://github.com/huggingface/peft/blob/main/src/peft/tuners/lora/layer.py">
      https://github.com/huggingface/peft/blob/main/src/peft/tuners/lora/layer.py
     </a>
     ）：
    </p>
    <pre><code class="prism language-python">nn<span class="token punctuation">.</span>init<span class="token punctuation">.</span>kaiming_uniform_<span class="token punctuation">(</span>self<span class="token punctuation">.</span>lora_A<span class="token punctuation">[</span>adapter_name<span class="token punctuation">]</span><span class="token punctuation">.</span>weight<span class="token punctuation">,</span> a<span class="token operator">=</span>math<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
    <ul>
     <li>
      这里 (
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         a 
         
        
          = 
         
         
         
           5 
          
         
        
       
         a = \sqrt{5}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.4306em;">
          </span>
          <span class="mord mathnormal">
           a
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1.04em; vertical-align: -0.1328em;">
          </span>
          <span class="mord sqrt">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.9072em;">
              <span class="svg-align" style="top: -3em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="mord" style="padding-left: 0.833em;">
                <span class="mord">
                 5
                </span>
               </span>
              </span>
              <span class="" style="top: -2.8672em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="hide-tail" style="min-width: 0.853em; height: 1.08em;">
                <svg height="1.08em" preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 1080" width="400em">
                 <path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z">
                 </path>
                </svg>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.1328em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ) 是 Xavier 初始化的遗留参数，但实际效果接近 Kaiming。
     </li>
     <li>
      <code>
       self.lora_A.weight
      </code>
      是 (
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         [ 
         
        
          d 
         
        
          , 
         
        
          r 
         
        
          ] 
         
        
       
         [d, r]
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mopen">
           [
          </span>
          <span class="mord mathnormal">
           d
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           r
          </span>
          <span class="mclose">
           ]
          </span>
         </span>
        </span>
       </span>
      </span>
      ) 形状的矩阵，(
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         d 
         
        
       
         d
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6944em;">
          </span>
          <span class="mord mathnormal">
           d
          </span>
         </span>
        </span>
       </span>
      </span>
      ) 是输入维度，(
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         r 
         
        
       
         r
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.4306em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           r
          </span>
         </span>
        </span>
       </span>
      </span>
      ) 是秩。
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="_LoRA__91">
     </a>
     四、在 LoRA 中的应用
    </h3>
    <p>
     LoRA（Low-Rank Adaptation）通过低秩矩阵 (
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        A 
        
       
      
        A
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal">
          A
         </span>
        </span>
       </span>
      </span>
     </span>
     ) 和 (
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        B 
        
       
      
        B
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0502em;">
          B
         </span>
        </span>
       </span>
      </span>
     </span>
     ) 对预训练权重进行微调。在
     <code>
      reset_lora_parameters
     </code>
     函数中：
    </p>
    <ul>
     <li>
      (
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         A 
         
        
       
         A
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord mathnormal">
           A
          </span>
         </span>
        </span>
       </span>
      </span>
      ) 使用
      <code>
       kaiming_uniform_
      </code>
      初始化：
      <pre><code class="prism language-python">nn<span class="token punctuation">.</span>init<span class="token punctuation">.</span>kaiming_uniform_<span class="token punctuation">(</span>self<span class="token punctuation">.</span>lora_A<span class="token punctuation">[</span>adapter_name<span class="token punctuation">]</span><span class="token punctuation">.</span>weight<span class="token punctuation">,</span> a<span class="token operator">=</span>math<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
     </li>
     <li>
      (
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         B 
         
        
       
         B
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0502em;">
           B
          </span>
         </span>
        </span>
       </span>
      </span>
      ) 初始化为零：
      <pre><code class="prism language-python">nn<span class="token punctuation">.</span>init<span class="token punctuation">.</span>zeros_<span class="token punctuation">(</span>self<span class="token punctuation">.</span>lora_B<span class="token punctuation">[</span>adapter_name<span class="token punctuation">]</span><span class="token punctuation">.</span>weight<span class="token punctuation">)</span>
</code></pre>
     </li>
    </ul>
    <h4>
     <a id="1__Kaiming___A__103">
     </a>
     1. 为什么用 Kaiming 初始化 (
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        A 
        
       
      
        A
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal">
          A
         </span>
        </span>
       </span>
      </span>
     </span>
     )？
    </h4>
    <ul>
     <li>
      <strong>
       数值稳定性
      </strong>
      ：(
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         A 
         
        
          ∈ 
         
         
         
           R 
          
          
          
            d 
           
          
            × 
           
          
            r 
           
          
         
        
       
         A \in \mathbb{R}^{d \times r}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.7224em; vertical-align: -0.0391em;">
          </span>
          <span class="mord mathnormal">
           A
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           ∈
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.8491em;">
          </span>
          <span class="mord">
           <span class="mord mathbb">
            R
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.8491em;">
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   d
                  </span>
                  <span class="mbin mtight">
                   ×
                  </span>
                  <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                   r
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ) 的初始值需要适度随机化，以确保训练早期 (
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         Δ 
         
        
          W 
         
        
          = 
         
        
          A 
         
        
          B 
         
        
       
         \Delta W = A B
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord">
           Δ
          </span>
          <span class="mord mathnormal" style="margin-right: 0.1389em;">
           W
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord mathnormal">
           A
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0502em;">
           B
          </span>
         </span>
        </span>
       </span>
      </span>
      ) 能够探索不同的低秩子空间。Kaiming 初始化根据输入维度 (
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         d 
         
        
       
         d
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6944em;">
          </span>
          <span class="mord mathnormal">
           d
          </span>
         </span>
        </span>
       </span>
      </span>
      ) 设置合理的方差，避免 (
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         A 
         
        
       
         A
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord mathnormal">
           A
          </span>
         </span>
        </span>
       </span>
      </span>
      ) 的值过大或过小。
     </li>
     <li>
      <strong>
       与 ( B ) 零初始化的配合
      </strong>
      ：(
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         B 
         
        
          = 
         
        
          0 
         
        
       
         B = 0
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0502em;">
           B
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.6444em;">
          </span>
          <span class="mord">
           0
          </span>
         </span>
        </span>
       </span>
      </span>
      ) 确保初始 (
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         Δ 
         
        
          W 
         
        
          = 
         
        
          0 
         
        
       
         \Delta W = 0
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord">
           Δ
          </span>
          <span class="mord mathnormal" style="margin-right: 0.1389em;">
           W
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.6444em;">
          </span>
          <span class="mord">
           0
          </span>
         </span>
        </span>
       </span>
      </span>
      )，而 (
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         A 
         
        
       
         A
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord mathnormal">
           A
          </span>
         </span>
        </span>
       </span>
      </span>
      ) 的 Kaiming 初始化为后续更新提供了非零起点，避免训练陷入全零状态。
     </li>
     <li>
      <strong>
       兼容性
      </strong>
      ：LoRA 常用于 Transformer 等深层模型，Kaiming 初始化与这些架构的 ReLU 或 GELU 激活兼容。
     </li>
    </ul>
    <h4>
     <a id="2__a__sqrt5___108">
     </a>
     2. (
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        a 
        
       
         = 
        
        
        
          5 
         
        
       
      
        a = \sqrt{5}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          a
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.04em; vertical-align: -0.1328em;">
         </span>
         <span class="mord sqrt">
          <span class="vlist-t vlist-t2">
           <span class="vlist-r">
            <span class="vlist" style="height: 0.9072em;">
             <span class="svg-align" style="top: -3em;">
              <span class="pstrut" style="height: 3em;">
              </span>
              <span class="mord" style="padding-left: 0.833em;">
               <span class="mord">
                5
               </span>
              </span>
             </span>
             <span class="" style="top: -2.8672em;">
              <span class="pstrut" style="height: 3em;">
              </span>
              <span class="hide-tail" style="min-width: 0.853em; height: 1.08em;">
               <svg height="1.08em" preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 1080" width="400em">
                <path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z">
                </path>
               </svg>
              </span>
             </span>
            </span>
            <span class="vlist-s">
             ​
            </span>
           </span>
           <span class="vlist-r">
            <span class="vlist" style="height: 0.1328em;">
             <span class="">
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ) 的意义
    </h4>
    <ul>
     <li>
      (
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         a 
         
        
          = 
         
         
         
           5 
          
         
        
       
         a = \sqrt{5}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.4306em;">
          </span>
          <span class="mord mathnormal">
           a
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1.04em; vertical-align: -0.1328em;">
          </span>
          <span class="mord sqrt">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.9072em;">
              <span class="svg-align" style="top: -3em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="mord" style="padding-left: 0.833em;">
                <span class="mord">
                 5
                </span>
               </span>
              </span>
              <span class="" style="top: -2.8672em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="hide-tail" style="min-width: 0.853em; height: 1.08em;">
                <svg height="1.08em" preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 1080" width="400em">
                 <path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z">
                 </path>
                </svg>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.1328em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ) 实际上是向后兼容 Xavier 初始化的一种选择，但与 Kaiming 的 (
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         a 
         
        
          = 
         
        
          0 
         
        
       
         a = 0
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.4306em;">
          </span>
          <span class="mord mathnormal">
           a
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.6444em;">
          </span>
          <span class="mord">
           0
          </span>
         </span>
        </span>
       </span>
      </span>
      )（纯 ReLU）略有不同。它使得分布稍宽，可能增加初始探索性，但仍接近 (
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         6 
           
           
           
             n 
            
            
            
              i 
             
            
              n 
             
            
           
          
         
        
       
         \sqrt{\frac{6}{n_{in}}}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1.84em; vertical-align: -0.655em;">
          </span>
          <span class="mord sqrt">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 1.185em;">
              <span class="svg-align" style="top: -3.8em;">
               <span class="pstrut" style="height: 3.8em;">
               </span>
               <span class="mord" style="padding-left: 1em;">
                <span class="mord">
                 <span class="mopen nulldelimiter">
                 </span>
                 <span class="mfrac">
                  <span class="vlist-t vlist-t2">
                   <span class="vlist-r">
                    <span class="vlist" style="height: 0.8451em;">
                     <span class="" style="top: -2.655em;">
                      <span class="pstrut" style="height: 3em;">
                      </span>
                      <span class="sizing reset-size6 size3 mtight">
                       <span class="mord mtight">
                        <span class="mord mtight">
                         <span class="mord mathnormal mtight">
                          n
                         </span>
                         <span class="msupsub">
                          <span class="vlist-t vlist-t2">
                           <span class="vlist-r">
                            <span class="vlist" style="height: 0.3281em;">
                             <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                              <span class="pstrut" style="height: 2.5em;">
                              </span>
                              <span class="sizing reset-size3 size1 mtight">
                               <span class="mord mtight">
                                <span class="mord mathnormal mtight">
                                 in
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                            <span class="vlist-s">
                             ​
                            </span>
                           </span>
                           <span class="vlist-r">
                            <span class="vlist" style="height: 0.143em;">
                             <span class="">
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="" style="top: -3.23em;">
                      <span class="pstrut" style="height: 3em;">
                      </span>
                      <span class="frac-line" style="border-bottom-width: 0.04em;">
                      </span>
                     </span>
                     <span class="" style="top: -3.394em;">
                      <span class="pstrut" style="height: 3em;">
                      </span>
                      <span class="sizing reset-size6 size3 mtight">
                       <span class="mord mtight">
                        <span class="mord mtight">
                         6
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                    <span class="vlist-s">
                     ​
                    </span>
                   </span>
                   <span class="vlist-r">
                    <span class="vlist" style="height: 0.4451em;">
                     <span class="">
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mclose nulldelimiter">
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.145em;">
               <span class="pstrut" style="height: 3.8em;">
               </span>
               <span class="hide-tail" style="min-width: 1.02em; height: 1.88em;">
                <svg height="1.88em" preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 1944" width="400em">
                 <path d="M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z">
                 </path>
                </svg>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.655em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ) 的理论值。
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="_113">
     </a>
     五、优势与局限性
    </h3>
    <h4>
     <a id="_115">
     </a>
     优势
    </h4>
    <ul>
     <li>
      <strong>
       稳定性
      </strong>
      ：通过控制方差，Kaiming 初始化显著减少了深层网络中的梯度问题。
     </li>
     <li>
      <strong>
       通用性
      </strong>
      ：适用于大多数使用 ReLU 及其变体的网络。
     </li>
     <li>
      <strong>
       简单性
      </strong>
      ：只需输入维度即可计算，无需复杂调参。
     </li>
    </ul>
    <h4>
     <a id="_120">
     </a>
     局限性
    </h4>
    <ul>
     <li>
      <strong>
       激活函数依赖
      </strong>
      ：主要针对 ReLU 设计，对于 Sigmoid 或 Tanh 等激活可能不适用。
     </li>
     <li>
      <strong>
       固定假设
      </strong>
      ：假设输入是 i.i.d.，在实际复杂数据中可能不完全成立。
     </li>
     <li>
      <strong>
       LoRA 场景的特殊性
      </strong>
      ：(
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         r 
         
        
       
         r
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.4306em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           r
          </span>
         </span>
        </span>
       </span>
      </span>
      ) 远小于 (
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         d 
         
        
       
         d
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6944em;">
          </span>
          <span class="mord mathnormal">
           d
          </span>
         </span>
        </span>
       </span>
      </span>
      )，低秩约束可能削弱初始化的理论效果。
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="_127">
     </a>
     六、扩展与改进方向
    </h3>
    <p>
     对于 LoRA 或其他场景，可以考虑以下改进：
    </p>
    <ol>
     <li>
      <strong>
       动态调整 (
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          a 
          
         
        
          a
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 0.4306em;">
           </span>
           <span class="mord mathnormal">
            a
           </span>
          </span>
         </span>
        </span>
       </span>
       )
      </strong>
      ：根据 (
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         r 
         
        
       
         r
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.4306em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           r
          </span>
         </span>
        </span>
       </span>
      </span>
      ) 或任务复杂度自适应选择 (
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         a 
         
        
       
         a
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.4306em;">
          </span>
          <span class="mord mathnormal">
           a
          </span>
         </span>
        </span>
       </span>
      </span>
      )，而不是固定为 (
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         5 
          
         
        
       
         \sqrt{5}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1.04em; vertical-align: -0.1328em;">
          </span>
          <span class="mord sqrt">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.9072em;">
              <span class="svg-align" style="top: -3em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="mord" style="padding-left: 0.833em;">
                <span class="mord">
                 5
                </span>
               </span>
              </span>
              <span class="" style="top: -2.8672em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="hide-tail" style="min-width: 0.853em; height: 1.08em;">
                <svg height="1.08em" preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 1080" width="400em">
                 <path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z">
                 </path>
                </svg>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.1328em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      )。
     </li>
     <li>
      <strong>
       正交初始化
      </strong>
      ：对于低秩矩阵 (
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         A 
         
        
       
         A
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord mathnormal">
           A
          </span>
         </span>
        </span>
       </span>
      </span>
      )，尝试
      <code>
       torch.nn.init.orthogonal_
      </code>
      ，可能提升多样性。
     </li>
     <li>
      <strong>
       与 scaling 结合
      </strong>
      ：LoRA 中的
      <code>
       scaling = lora_alpha / r
      </code>
      可以与初始化协同设计，避免重复调整幅度。
     </li>
    </ol>
    <hr/>
    <h3>
     <a id="_136">
     </a>
     七、结语
    </h3>
    <p>
     <code>
      nn.init.kaiming_uniform_
     </code>
     是深度学习中权重初始化的经典方法，通过均匀分布确保信号在网络中的稳定传播。在 LoRA 中，它为 (
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        A 
        
       
      
        A
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal">
          A
         </span>
        </span>
       </span>
      </span>
     </span>
     ) 提供了合理的初始值，与 (
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        B 
        
       
      
        B
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0502em;">
          B
         </span>
        </span>
       </span>
      </span>
     </span>
     ) 的零初始化配合，兼顾了稳定性和学习能力。对于研究者而言，理解其背后的数学原理不仅有助于调参，还能启发新的初始化策略。欢迎在评论区分享你的使用经验或改进想法！
    </p>
    <h3>
     <a id="_141">
     </a>
     后记
    </h3>
    <p>
     2025年3月11日22点44分于上海，在Grok 3大模型辅助下完成。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f7368697a68656e675f4c692f:61727469636c652f64657461696c732f313436313931313033" class_="artid" style="display:none">
 </p>
</div>


