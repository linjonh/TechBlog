---
layout: post
title: "Linux上位机开发实战qt编译之谜"
date: 2025-03-12 09:03:18 +0800
description: "【 声明：版权所有，欢迎转载，请勿用于商业用途。 联系信箱：feixiaoxing @163.com】        很多同学都喜欢用IDE，也能理解。因为不管是visual studio qt插件，还是qt creator其实都帮我们做了很多额外的工作。这里面最重要的部分，就是利用uic、moc和rcc命令帮我们生成了额外的h文件、moc cpp文件、qrc cpp文件。换句话说，这些操作对我们来说都是透明的。但只要我们了解清楚了里面的原理，就会发现其实就是那么回事。"
keywords: "Linux上位机开发实战（qt编译之谜）"
categories: ['Linux']
tags: ['运维', '服务器', 'Linux']
artid: "146195293"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146195293
    alt: "Linux上位机开发实战qt编译之谜"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146195293
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146195293
cover: https://bing.ee123.net/img/rand?artid=146195293
image: https://bing.ee123.net/img/rand?artid=146195293
img: https://bing.ee123.net/img/rand?artid=146195293
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Linux上位机开发实战（qt编译之谜）
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     【 声明：版权所有，欢迎转载，请勿用于商业用途。 联系信箱：feixiaoxing @163.com】
    </p>
    <p>
    </p>
    <p>
     很多同学都喜欢用IDE，也能理解。因为不管是visual studio qt插件，还是qt creator其实都帮我们做了很多额外的工作。这里面最重要的部分，就是利用uic、moc和rcc命令帮我们生成了额外的h文件、moc cpp文件、qrc cpp文件。换句话说，这些操作对我们来说都是透明的。但只要我们了解清楚了里面的原理，就会发现其实就是那么回事。
    </p>
    <p class="img-center">
     <img alt="" height="231" src="https://i-blog.csdnimg.cn/direct/5d3c36f99ad440a1b39064962093a7e6.png" width="429"/>
    </p>
    <p>
    </p>
    <h2>
     <span style="color:#4da8ee">
      1、uic命令
     </span>
    </h2>
    <p>
     我们都知道，qt的图形界面就是ui文件。ui文件一般用qt designer生成。那么ui文件怎么和具体的class绑定在一起呢？方法就在uic工具，一般用uic可以直接生成h头文件，类似于这样，
    </p>
    <pre><code>uic QtWidgetsApplication.ui -o ui_QtWidgetsApplication.h</code></pre>
    <p>
     有了这个ui_QtWidgetsApplication.h头文件之后，我们就可以在QtWidgetsApplication.h里面自由使用ui对象里面的控件了，
    </p>
    <pre><code>#include &lt;QtWidgets/QMainWindow&gt;
#include "ui_QtWidgetsApplication.h"

class QtWidgetsApplication : public QMainWindow
{
    Q_OBJECT

public:
    QtWidgetsApplication(QWidget *parent = nullptr);
    ~QtWidgetsApplication();

private:
    Ui::QtWidgetsApplicationClass ui;
};</code></pre>
    <p>
    </p>
    <h2>
     <span style="color:#4da8ee">
      2、moc命令
     </span>
    </h2>
    <p>
     刚才分析QtWidgetsApplication类的时候，不知道大家有没有注意，这里面还包含了一个Q_OBJECT宏。通过这个宏以及moc命令，qt就可以帮我们生成额外的cpp代码。例如，我们使用qt的时候很方便，直接把控件和slot槽函数做一个connect就可以了。但是具体怎么调用的，其实是moc自动生成的cpp文件来完成的，
    </p>
    <pre><code>INCLUDE_DIR=-I /usr/include/aarch64-linux-gnu/qt5 \
            -I /usr/include/aarch64-linux-gnu/qt5/QtWidgets\
            -I /usr/include/aarch64-linux-gnu/qt5/QtGui \
            -I /usr/include/aarch64-linux-gnu/qt5/QtCore

moc_QtWidgetsApplication.o : moc_QtWidgetsApplication.cpp
	g++ -g -c moc_QtWidgetsApplication.cpp -o moc_QtWidgetsApplication.o $(INCLUDE_DIR)

moc_QtWidgetsApplication.cpp : QtWidgetsApplication.h
	moc -o moc_QtWidgetsApplication.cpp QtWidgetsApplication.h</code></pre>
    <p>
     生成的moc_QtWidgetsApplication.cpp最终也要链接到可执行文件里面去的。
    </p>
    <p>
    </p>
    <h2>
     <span style="color:#4da8ee">
      3、rcc命令
     </span>
    </h2>
    <p>
     除了上面说的ui文件、Q_OBJECT宏处理，还有一种qrc文件也需要进行处理。这种qrc文件，类似于原来windows系统里面的rc资源文件。qt一般是通过rcc命令，把它变成cpp文件来处理。这样就可以同样链接到最终可执行文件中去了。
    </p>
    <pre><code>INCLUDE_DIR=-I /usr/include/aarch64-linux-gnu/qt5 \
            -I /usr/include/aarch64-linux-gnu/qt5/QtWidgets\
            -I /usr/include/aarch64-linux-gnu/qt5/QtGui \
            -I /usr/include/aarch64-linux-gnu/qt5/QtCore

obj/qrc_QtWidgetsApplication.o: qrc_QtWidgetsApplication.cpp
	g++ -c -g qrc_QtWidgetsApplication.cpp -o obj/qrc_QtWidgetsApplication.o $(INCLUDE_DIR)

qrc_QtWidgetsApplication.cpp:
	rcc  QtWidgetsApplication.qrc -o qrc_QtWidgetsApplication.cpp</code></pre>
    <p>
    </p>
    <h2>
     <span style="color:#4da8ee">
      4、总结
     </span>
    </h2>
    <p>
     qt程序的编译，其实没有脱离常见的编译法则，比如编译、链接、静态库、动态库、可执行文件。只是很多操作都被隐藏掉了，比如这里说的uic、moc、rcc命令。我们常用的visual studio qt插件，或者是qt creator，都默认帮我们做了这些工作，这才导致我们并不是很清楚qt的编译原理。等到明白过来之后，其实就可以自由地编写Makefile，自由地去组织文件的编译和生成了。
    </p>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f6665697869616f78696e672f:61727469636c652f64657461696c732f313436313935323933" class_="artid" style="display:none">
 </p>
</div>


