---
layout: post
title: "C基础ProcessStartInfo类和Process类-"
date: 2025-09-02T14:35:13+0800
description: "摘要：ProcessStartInfo是C#中用于配置外部程序启动参数的类（位于System.Diagnostics命名空间），常用于指定程序路径、启动参数、窗口样式等。配合Process类可实现对程序的启动与管理。基本用法包括：通过FileName属性设置程序路径，Arguments传递参数（如文件路径或网址），WindowStyle控制窗口状态。Process类提供WaitForExit()等待程序结束、Kill()强制关闭等功能，二者结合可实现自动化程序控制。例如：启动记事本并自动打开指定文件，或延时"
keywords: "C#基础（⑤ProcessStartInfo类和Process类） "
categories: ['未分类']
tags: ['开发语言', 'C']
artid: "151112781"
arturl: "https://blog.csdn.net/hongsegeming/article/details/151112781"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=151112781
    alt: "C基础ProcessStartInfo类和Process类-"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=151112781
featuredImagePreview: https://bing.ee123.net/img/rand?artid=151112781
cover: https://bing.ee123.net/img/rand?artid=151112781
image: https://bing.ee123.net/img/rand?artid=151112781
img: https://bing.ee123.net/img/rand?artid=151112781
---



# C#基础（⑤ProcessStartInfo类和Process类）



## 1. 它是什么？

ProcessStartInfo 是 C# 里的一个类（属于 System.Diagnostics 命名空间），作用是：

定义要启动的程序路径（比如 notepad.exe）

设置启动时的参数（比如打开哪个文件）

控制启动后的窗口样式（比如最大化、最小化）

配置其他启动选项（比如是否隐藏窗口、是否使用管理员权限等）

## 2. 为什么需要它？

如果我们想在自己的 C# 程序里打开另一个程序（比如用代码打开记事本并自动加载一个文本文件），就需要用 `ProcessStartInfo` 来 "描述" 这个操作，然后配合 `Process` 类执行启动。

没有它的话，我们只能简单启动程序，无法精确控制启动方式。

## 3. 最基础的用法

先看一个最简单的例子：用代码打开记事本。

```

using System;
using System.Diagnostics; // 必须引入这个命名空间

class Program
{
    static void Main()
    {
        // 1. 创建"启动说明书"
        ProcessStartInfo startInfo = new ProcessStartInfo();
        // 告诉电脑要启动的程序路径（这里是记事本）
        startInfo.FileName = "notepad.exe";

        // 2. 按照说明书启动程序
        Process.Start(startInfo);
    }
}
```

运行这段代码，你会发现记事本被自动打开了。

## 4. 常用的属性（配置项）

`ProcessStartInfo` 有很多属性，用来配置启动细节，小白常用的有这些：

| 属性名 | 作用举例 |
| --- | --- |
| `FileName` | 必须设置，指定要启动的程序路径（如 `notepad.exe`、`chrome.exe`） |
| `Arguments` | 启动程序时的参数（如打开的文件路径、网址） |
| `WindowStyle` | 窗口样式（最大化、最小化等） |
| `UseShellExecute` | 是否用系统外壳启动（简单理解：设为 `false` 更灵活，设为 `true` 可启动网址 / 文件） |

## 5. 举例：带参数启动程序

比如，用记事本打开一个指定的文本文件（假设文件路径是 `C:\test.txt`）：

```

using System;
using System.Diagnostics;

class Program
{
    static void Main()
    {
        ProcessStartInfo startInfo = new ProcessStartInfo();
        startInfo.FileName = "notepad.exe"; // 程序：记事本
        startInfo.Arguments = "C:\\test.txt"; // 参数：要打开的文件路径

        Process.Start(startInfo); // 启动后，记事本会自动打开 test.txt
    }
}
```

再比如，用浏览器打开百度：

```

ProcessStartInfo startInfo = new ProcessStartInfo();
startInfo.FileName = "chrome.exe"; // 谷歌浏览器（如果是Edge则写"msedge.exe"）
startInfo.Arguments = "https://www.baidu.com"; // 参数：网址
Process.Start(startInfo);
```

## 6. 控制窗口样式

通过 `WindowStyle` 可以设置程序启动后的窗口状态，比如：

```

ProcessStartInfo startInfo = new ProcessStartInfo();
startInfo.FileName = "notepad.exe";
// 设置窗口最大化（可选值：Normal、Maximized、Minimized、Hidden）
startInfo.WindowStyle = ProcessWindowStyle.Maximized;

Process.Start(startInfo);
```

---

`Process` 类（同样在 `System.Diagnostics` 命名空间下）是用来 "操作" 外部程序的工具，比如启动程序、关闭程序、获取程序的运行状态等。

它和之前讲的 `ProcessStartInfo` 通常一起使用：`ProcessStartInfo` 负责 "描述如何启动"，`Process` 负责 "执行启动并管理这个程序"。

## 1. 最基础的用法：启动程序

直接用 `Process.Start()` 可以快速启动程序，甚至不用显式创建 `ProcessStartInfo`：

```

using System;
using System.Diagnostics;

class Program
{
    static void Main()
    {
        // 启动记事本（最简单的方式）
        Process.Start("notepad.exe");
    }
}
```

如果需要带参数（比如用记事本打开文件），可以这样写：

```

// 启动记事本并打开 C:\test.txt
Process.Start("notepad.exe", "C:\\test.txt");
```

## 2. 完整流程：创建 Process 实例并控制程序

如果需要更精细地控制程序（比如等待程序结束、关闭程序），可以创建 `Process` 实例：

```

using System;
using System.Diagnostics;

class Program
{
    static void Main()
    {
        // 1. 创建启动配置（ProcessStartInfo）
        ProcessStartInfo startInfo = new ProcessStartInfo();
        startInfo.FileName = "notepad.exe"; // 程序路径
        startInfo.Arguments = "C:\\test.txt"; // 启动参数

        // 2. 创建 Process 实例，并关联配置
        Process process = new Process();
        process.StartInfo = startInfo; // 告诉 Process 如何启动程序

        // 3. 启动程序
        process.Start();

        // 4. 可选：等待程序关闭后再继续执行后续代码
        Console.WriteLine("记事本已启动，等待关闭...");
        process.WaitForExit(); // 程序会卡在这行，直到记事本被关闭

        // 5. 程序关闭后执行
        Console.WriteLine("记事本已关闭！");
    }
}
```

## 3. 常用功能：关闭已启动的程序

如果需要用代码关闭启动的程序，可以调用 `Kill()` 方法：

```

using System;
using System.Diagnostics;
using System.Threading;

class Program
{
    static void Main()
    {
        // 启动记事本
        Process process = Process.Start("notepad.exe");
        Console.WriteLine("记事本已启动，3秒后自动关闭...");

        // 等待3秒
        Thread.Sleep(3000);

        // 关闭程序
        process.Kill();
        Console.WriteLine("记事本已被关闭！");
    }
}
```

## 4. 常用属性和方法

| 成员 | 作用 |
| --- | --- |
| `Start()` | 启动程序 |
| `Kill()` | 强制关闭程序 |
| `WaitForExit()` | 等待程序自行关闭后再继续执行代码 |
| `HasExited` | 判断程序是否已经关闭（true 表示已关闭） |
| `Id` | 获取程序的进程 ID（系统中唯一的编号） |

123



