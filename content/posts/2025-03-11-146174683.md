---
layout: post
title: "mysql-数据库部署"
date: 2025-03-11 11:41:48 +0800
description: "通过以上步骤，可在 CentOS 7 上完成 MySQL 的完整部署。若需特定版本（如 MySQL 8.0），需调整 Yum 源配置（如启用。使用 MySQL 客户端工具（如 Navicat、DBeaver）配置 IP、端口、用户信息测试连接。：确保 SELinux 未阻止访问，可临时关闭或配置策略。若仍失败，重启服务或检查磁盘空间。：此错误因未验证软件包签名导致。：生产环境不推荐简化策略。：开放 3306 端口。"
keywords: "mysql 数据库部署"
categories: ['未分类']
tags: ['运维', '网络安全', '网络', '数据库']
artid: "146174683"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146174683
    alt: "mysql-数据库部署"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146174683
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146174683
cover: https://bing.ee123.net/img/rand?artid=146174683
image: https://bing.ee123.net/img/rand?artid=146174683
img: https://bing.ee123.net/img/rand?artid=146174683
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     mysql 数据库部署
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     以下是基于 CentOS 7 系统部署 MySQL 数据库的详细步骤及常见问题解决方案：
    </p>
    <h4>
     一、卸载旧版本 MySQL/MariaDB
    </h4>
    <ol>
     <li>
      <strong>
       停止服务并检查残留
      </strong>
      <pre><code>systemctl stop mariadb # 停止 MariaDB 服务 rpm -qa | grep mariadb # 检查 MariaDB 安装包 rpm -e --nodeps mariadb-libs-* # 强制卸载 MariaDB 及其依赖包 rm -rf /etc/my.cnf /var/lib/mysql # 删除残留配置和数据文件</code></pre>
      <strong>
       说明
      </strong>
      ：CentOS 7 默认集成 MariaDB（MySQL 分支），需彻底卸载避免冲突
      <br/>
     </li>
    </ol>
    <h4>
     二、安装 MySQL 官方 Yum 源
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        下载并配置 Yum 源
       </strong>
      </p>
      <pre><code>wget https://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm rpm -ivh mysql57-community-release-el7-11.noarch.rpm</code></pre>
      <p>
       <strong>
        验证
       </strong>
       ：检查
       <code>
        /etc/yum.repos.d/
       </code>
       目录是否生成
       <code>
        mysql-community.repo
       </code>
       文件
      </p>
     </li>
     <li>
      <p>
       <strong>
        解决 GPG 公钥错误
       </strong>
       若安装时报错
       <code>
        Public key not installed
       </code>
       ，执行：
      </p>
      <pre><code>rpm --import https://repo.mysql.com/RPM-GPG-KEY-mysql-2022 yum install mysql-community-server -y # 重新安装</code></pre>
      <p>
       <strong>
        提示
       </strong>
       ：此错误因未验证软件包签名导致
      </p>
     </li>
    </ol>
    <h4>
     三、启动 MySQL 服务及初始化
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        启动服务并设置开机自启
       </strong>
      </p>
      <pre><code>systemctl start mysqld # 启动服务 systemctl enable mysqld # 设置开机自启 systemctl status mysqld # 检查状态</code></pre>
     </li>
     <li>
      <p>
       <strong>
        获取初始临时密码
       </strong>
      </p>
      <pre><code>grep 'temporary password' /var/log/mysqld.log</code></pre>
      <p>
       输出示例：
       <code>
        A temporary password is generated for root@localhost: xxxxxx
       </code>
       ，记下此密码
      </p>
     </li>
     <li>
      <p>
       <strong>
        修改 root 密码
       </strong>
      </p>
      <pre><code>mysql -uroot -p # 输入临时密码登录 ALTER USER 'root'@'localhost' IDENTIFIED BY 'NewPassword123!'; # 新密码需包含大小写、数字、符号</code></pre>
      <p>
       <strong>
        简化密码策略（可选）
       </strong>
       ： 若需使用简单密码，修改密码策略后重：
      </p>
      <pre><code>qSET GLOBAL validate_password_policy=LOW; SET GLOBAL validate_password_length=6; ALTER USER 'root'@'localhost' IDENTIFIED BY '123456';</code></pre>
      <p>
       <strong>
        注意
       </strong>
       ：生产环境不推荐简化策略
      </p>
     </li>
    </ol>
    <h4>
     四、配置 MySQL 字符集与远程访问
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        修改字符集为 UTF-8
       </strong>
       编辑配置文件
       <code>
        /etc/my.cnf
       </code>
       ：
      </p>
      <pre><code>[mysqld] character-set-server=utf8 collation-server=utf8_general_ci [client] default-character-set=utf8</code></pre>
      <p>
       重启服务生效：
       <code>
        systemctl restart mysqld
       </code>
      </p>
     </li>
     <li>
      <p>
       <strong>
        允许远程访问
       </strong>
      </p>
      <pre><code>CREATE USER 'remote_user'@'%' IDENTIFIED BY 'Remote_Pass123!'; GRANT ALL PRIVILEGES ON *.* TO 'remote_user'@'%' WITH GRANT OPTION; FLUSH PRIVILEGES;</code></pre>
      <p>
       <strong>
        防火墙设置
       </strong>
       ：开放 3306 端口
      </p>
      <pre><code>firewall-cmd --zone=public --add-port=3306/tcp --permanent firewall-cmd --reload</code></pre>
      <p>
       <strong>
        说明
       </strong>
       ：确保 SELinux 未阻止访问，可临时关闭或配置策略
      </p>
     </li>
    </ol>
    <h4>
     五、常见问题解决
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        服务启动失败
       </strong>
      </p>
      <ul>
       <li>
        检查
        <code>
         /var/log/mysqld.log
        </code>
        中的错误日志。
       </li>
       <li>
        确保
        <code>
         /var/lib/mysql
        </code>
        目录权限正确：
        <code>
         chown -R mysql:mysql /var/lib/mysql
        </code>
        <p>
        </p>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        无法找到 mysql.sock
       </strong>
      </p>
      <pre><code>find / -name mysql.sock # 查找 sock 文件路径 ln -s /tmp/mysql.sock /var/lib/mysql/mysql.sock # 创建软链接</code></pre>
      <p>
       若仍失败，重启服务或检查磁盘空间
      </p>
     </li>
     <li>
      <p>
       <strong>
        JDBC 连接失败
       </strong>
      </p>
      <ul>
       <li>
        错误
        <code>
         Access denied
        </code>
        ：检查用户权限及密码。
       </li>
       <li>
        错误
        <code>
         Communications link failure
        </code>
        ：确认防火墙和 MySQL 监听地址（
        <code>
         bind-address=0.0.0.0
        </code>
        ）
        <br/>
       </li>
      </ul>
     </li>
    </ol>
    <h4>
     六、验证部署
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        本地登录测试
       </strong>
      </p>
      <pre><code>mysql -uroot -p # 输入密码后进入 MySQL Shell SHOW DATABASES; # 查看数据库列表</code></pre>
     </li>
     <li>
      <p>
       <strong>
        远程连接测试
       </strong>
       使用 MySQL 客户端工具（如 Navicat、DBeaver）配置 IP、端口、用户信息测试连接。
      </p>
     </li>
    </ol>
    <p>
     通过以上步骤，可在 CentOS 7 上完成 MySQL 的完整部署。若需特定版本（如 MySQL 8.0），需调整 Yum 源配置（如启用
     <code>
      mysql80-community
     </code>
     仓库）
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323430325f38363732353630362f:61727469636c652f64657461696c732f313436313734363833" class_="artid" style="display:none">
 </p>
</div>


