---
arturl_encode: "68747470:733a2f2f626c6f672e6373646e2e6e65742f5965617574792f:61727469636c652f64657461696c732f313436323737313936"
layout: post
title: "ä¸‰åˆ†é’ŸæŒæ¡è§†é¢‘å‰ªè¾‘-åœ¨-Rust-ä¸­ä¼˜é›…åœ°é›†æˆ-FFmpeg"
date: 2025-03-15 12:00:05 +08:00
description: "åœ¨å½“ä»Šçš„çŸ­è§†é¢‘æ—¶ä»£ï¼Œé«˜æ•ˆçš„è§†é¢‘å‰ªè¾‘å·²æˆä¸ºå†…å®¹åˆ›ä½œè€…å’Œå¼€å‘è€…çš„è¿«åˆ‡éœ€æ±‚ã€‚æ— è®ºæ˜¯è£å‰ªè§†é¢‘å¼€å¤´ç»“å°¾ã€æå–é«˜å…‰æ—¶åˆ»ï¼Œè¿˜æ˜¯åˆ¶ä½œ GIFã€å»é™¤å¹¿å‘Šï¼Œå‰ªè¾‘éƒ½æ˜¯å¿…ä¸å¯å°‘çš„ä¸€ç¯ã€‚"
keywords: "ä¸‰åˆ†é’ŸæŒæ¡è§†é¢‘å‰ªè¾‘ | åœ¨ Rust ä¸­ä¼˜é›…åœ°é›†æˆ FFmpeg"
categories: ['æœªåˆ†ç±»']
tags: ['éŸ³é¢‘', 'éŸ³è§†é¢‘', 'è§†é¢‘', 'Rust', 'Ffmpeg']
artid: "146277196"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146277196
    alt: "ä¸‰åˆ†é’ŸæŒæ¡è§†é¢‘å‰ªè¾‘-åœ¨-Rust-ä¸­ä¼˜é›…åœ°é›†æˆ-FFmpeg"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146277196
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146277196
cover: https://bing.ee123.net/img/rand?artid=146277196
image: https://bing.ee123.net/img/rand?artid=146277196
img: https://bing.ee123.net/img/rand?artid=146277196
---

# ä¸‰åˆ†é’ŸæŒæ¡è§†é¢‘å‰ªè¾‘ | åœ¨ Rust ä¸­ä¼˜é›…åœ°é›†æˆ FFmpeg

### **å‰è¨€**

åœ¨å½“ä»Šçš„çŸ­è§†é¢‘æ—¶ä»£ï¼Œ
**é«˜æ•ˆçš„è§†é¢‘å‰ªè¾‘**
å·²æˆä¸ºå†…å®¹åˆ›ä½œè€…å’Œå¼€å‘è€…çš„è¿«åˆ‡éœ€æ±‚ã€‚æ— è®ºæ˜¯è£å‰ªè§†é¢‘å¼€å¤´ç»“å°¾ã€æå–é«˜å…‰æ—¶åˆ»ï¼Œè¿˜æ˜¯åˆ¶ä½œ GIFã€å»é™¤å¹¿å‘Šï¼Œå‰ªè¾‘éƒ½æ˜¯å¿…ä¸å¯å°‘çš„ä¸€ç¯ã€‚

ç„¶è€Œï¼Œ
**æ‰¹é‡å¤„ç†å¤§é‡è§†é¢‘**
å¹¶éæ˜“äº‹ï¼Œå¸¸è§çš„æŒ‘æˆ˜åŒ…æ‹¬ï¼š

* **æ‰‹åŠ¨å‰ªè¾‘**
  ï¼šè´¹æ—¶è´¹åŠ›ï¼Œæ•ˆç‡ä½ä¸‹ã€‚
* **ä½¿ç”¨ä¸“ä¸šè½¯ä»¶ï¼ˆå¦‚ Premiereã€After Effectsï¼‰**
  ï¼šé€‚åˆä¸“ä¸šå‰ªè¾‘ï¼Œä½†è‡ªåŠ¨åŒ–æ‰¹é‡å¤„ç†éš¾ä»¥å®ç°ã€‚
* **FFmpeg å‘½ä»¤è¡Œ**
  ï¼šåŠŸèƒ½å¼ºå¤§ï¼Œä½†å‚æ•°å¤æ‚ï¼Œå®¹æ˜“å‡ºé”™ã€‚

å¯¹äº Rust å¼€å‘è€…è€Œè¨€ï¼Œå¦‚ä½•åœ¨ç¨‹åºä¸­
**ä¼˜é›…åœ°å®ç°è§†é¢‘å‰ªè¾‘**
ï¼Œä»¥æ»¡è¶³è‡ªåŠ¨åŒ–å’Œé«˜æ•ˆå¤„ç†çš„éœ€æ±‚ï¼Ÿ

### **Rust ä¸­çš„è§†é¢‘å‰ªè¾‘æŒ‘æˆ˜**

FFmpeg æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å¤šåª’ä½“å¤„ç†å·¥å…·ï¼Œå¹¿æ³›åº”ç”¨äºè§†é¢‘å‰ªè¾‘ã€æ ¼å¼è½¬æ¢ç­‰é¢†åŸŸã€‚ç„¶è€Œï¼Œç›´æ¥åœ¨ Rust ä¸­è°ƒç”¨ FFmpeg çš„ C è¯­è¨€ API å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š

* **å¤æ‚æ€§**
  ï¼šéœ€è¦æ·±å…¥ç†è§£ FFmpeg çš„åº•å±‚å®ç°å’Œå‚æ•°é…ç½®ï¼Œå­¦ä¹ æˆæœ¬é«˜ã€‚
* **å†…å­˜ç®¡ç†**
  ï¼šç›´æ¥ä½¿ç”¨ C è¯­è¨€ APIï¼Œå®¹æ˜“å¼•å‘å†…å­˜æ³„æ¼ã€éæ³•è®¿é—®ç­‰é—®é¢˜ï¼Œå½±å“ç¨‹åºç¨³å®šæ€§ã€‚
* **å¼€å‘æ•ˆç‡**
  ï¼šå¤æ‚çš„æ¥å£å’Œç¹ççš„é…ç½®ï¼Œå¯èƒ½é™ä½å¼€å‘æ•ˆç‡ï¼Œå¢åŠ å‡ºé”™é£é™©ã€‚

### **è§£å†³æ–¹æ¡ˆï¼šåœ¨ Rust ä¸­ä¼˜é›…åœ°ä½¿ç”¨ FFmpeg**

ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼ŒRust ç¤¾åŒºæä¾›äº†å¤šç§å°è£…åº“ï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿæ›´ç®€æ´ã€å®‰å…¨åœ°ä½¿ç”¨ FFmpegã€‚ä¾‹å¦‚ï¼Œ
**`ez-ffmpeg`**
åº“é€šè¿‡ FFI è°ƒç”¨ FFmpeg çš„åº•å±‚ C ä»£ç ï¼Œä¸º Rust å¼€å‘è€…æä¾›äº†ä¸€ä¸ªå®‰å…¨ä¸”ç¬¦åˆäººä½“å·¥å­¦çš„æ¥å£ã€‚è¯¥åº“çš„è®¾è®¡ç›®æ ‡æ˜¯ç®€åŒ– FFmpeg çš„ä½¿ç”¨ï¼Œé¿å…ç›´æ¥æ“ä½œå¤æ‚çš„åŸç”Ÿ APIï¼Œä»è€Œé™ä½å¼€å‘éš¾åº¦ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚

### **å¿«é€Ÿä¸Šæ‰‹ï¼šç”¨ Rust å‰ªè¾‘è§†é¢‘ç‰‡æ®µ**

å‡è®¾ä½ æœ‰ä¸€ä¸ª
`test.mp4`
ï¼Œæƒ³ä»
**ç¬¬ 5 ç§’å¼€å§‹**
æå–
**3 ç§’**
çš„ç‰‡æ®µï¼Œç”Ÿæˆ
`output.mp4`
ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œï¼š

#### **1. å®‰è£… FFmpeg**

å¦‚æœä½ çš„ç¯å¢ƒå°šæœªå®‰è£… FFmpegï¼Œå¯ä»¥æŒ‰ä»¥ä¸‹æ–¹å¼å®‰è£…ï¼š

##### macOSï¼š

```bash
brew install ffmpeg

```

##### Windowsï¼š

```bash
vcpkg install ffmpeg
# å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡å®‰è£… vcpkgï¼Œè¿˜éœ€è®¾ç½®ç¯å¢ƒå˜é‡ VCPKG_ROOT

```

#### **2. æ·»åŠ  Rust ä¾èµ–**

åœ¨
`Cargo.toml`
ä¸­å¼•å…¥
`ez-ffmpeg`
ï¼š

```toml
[dependencies]
ez-ffmpeg = "*"

```

#### **3. ç¼–å†™å¹¶è¿è¡Œä»£ç **

```rust
use ez_ffmpeg::{FfmpegContext, Input, Output};

fn main() -> Result<(), Box<dyn std::error::Error>> {
    // åˆ›å»ºä¸€ä¸ª FFmpeg ä¸Šä¸‹æ–‡ï¼Œä»ç¬¬ 5 ç§’å¼€å§‹å‰ªè¾‘ 3 ç§’
    FfmpegContext::builder()
        .input(Input::from("test.mp4")
            .set_start_time_us(5_000_000) // ä» 5 ç§’å¼€å§‹ï¼ˆFFmpeg ä»¥å¾®ç§’ä¸ºå•ä½ï¼‰
            .set_recording_time_us(3_000_000)) // å½•åˆ¶ 3 ç§’
        .output("output.mp4")
        .build()?
        .start()?
        .wait()?;
    Ok(())
}

```

### **ä»£ç è§£æ**

è¿™æ®µä»£ç çš„ä¸»è¦æ­¥éª¤åŒ…æ‹¬ï¼š

1. **åŠ è½½è¾“å…¥è§†é¢‘**

   ```rust
   .input(Input::from("test.mp4")

   ```

   è¿™é‡Œçš„
   `test.mp4`
   æ˜¯éœ€è¦å‰ªè¾‘çš„åŸå§‹è§†é¢‘ã€‚
2. **è®¾ç½®å‰ªè¾‘æ—¶é—´**

   ```rust
   .set_start_time_us(5_000_000) // ä» 5 ç§’å¼€å§‹
   .set_recording_time_us(3_000_000) // å½•åˆ¶ 3 ç§’

   ```

   * `set_start_time_us(5_000_000)`
     ï¼šä»
     **ç¬¬ 5 ç§’**
     å¼€å§‹å‰ªè¾‘ã€‚
   * `set_recording_time_us(3_000_000)`
     ï¼šå‰ªè¾‘
     **3 ç§’**
     çš„å†…å®¹ã€‚
3. **æŒ‡å®šè¾“å‡ºæ–‡ä»¶**

   ```rust
   .output("output.mp4")

   ```

   * å¤„ç†åçš„è§†é¢‘ä¼šä¿å­˜åœ¨
     `output.mp4`
     ã€‚
4. **å¯åŠ¨å¹¶ç­‰å¾…å‰ªè¾‘å®Œæˆ**

   ```rust
   .build()?.start()?.wait()?;

   ```

   * **æ„å»º**
     FFmpeg ä»»åŠ¡ã€‚
   * **å¯åŠ¨å‰ªè¾‘**
     è¿‡ç¨‹ã€‚
   * **ç­‰å¾…æ‰§è¡Œå®Œæˆ**
     ã€‚

### **æ›´å¤šå‰ªè¾‘åœºæ™¯**

#### **1. åªå‰ªè¾‘è§†é¢‘çš„å‰ 10 ç§’**

å¦‚æœä½ åªæƒ³
**ä¿ç•™è§†é¢‘çš„å‰ 10 ç§’**
ï¼Œå¯ä»¥è¿™æ ·å†™ï¼š

```rust
.input(Input::from("test.mp4").set_recording_time_us(10_000_000))

```

è¿™ä¼šç”Ÿæˆä¸€ä¸ª
**åªæœ‰ 10 ç§’**
çš„
`output.mp4`
ã€‚

#### **2. ä» 10 ç§’å¼€å§‹ï¼Œä¸€ç›´å‰ªåˆ°è§†é¢‘ç»“æŸ**

```rust
.input(Input::from("test.mp4").set_start_time_us(10_000_000))

```

è¿™ä¼šå‰ªæ‰
**å‰ 10 ç§’**
ï¼Œç„¶åä¿å­˜å‰©ä½™éƒ¨åˆ†ã€‚

#### **3. å‰ªåˆ‡æˆ GIF**

å¦‚æœä½ æƒ³
**æŠŠå‰ªè¾‘åçš„è§†é¢‘è½¬æ¢æˆ GIF**
ï¼Œåªéœ€ä¿®æ”¹è¾“å‡ºæ ¼å¼ï¼š

```rust
FfmpegContext::builder()
    .input(Input::from("test.mp4")
        .set_start_time_us(5_000_000)
        .set_recording_time_us(3_000_000))
    .output("output.gif") // ç›´æ¥è¾“å‡º GIF
    .build()?
    .start()?
    .wait()?;

```

è¿™æ ·ï¼Œ
`output.gif`
å°±ä¼šç”Ÿæˆä¸€ä¸ª
**3 ç§’é•¿çš„ GIF åŠ¨å›¾**
ã€‚

### **æ€»ç»“**

é€šè¿‡åœ¨ Rust ä¸­ä½¿ç”¨ç±»ä¼¼
`ez-ffmpeg`
çš„å°è£…åº“ï¼Œå¼€å‘è€…å¯ä»¥ï¼š

* **ç®€åŒ–æ“ä½œ**
  ï¼šé€šè¿‡é“¾å¼è°ƒç”¨ï¼Œå‡ è¡Œä»£ç å³å¯å®Œæˆè§†é¢‘å‰ªè¾‘ä»»åŠ¡ã€‚
* **ç¡®ä¿å®‰å…¨**
  ï¼šRust çš„å†…å­˜å®‰å…¨ç‰¹æ€§ï¼Œé¿å…äº†ç›´æ¥ä½¿ç”¨ C è¯­è¨€ API æ—¶å¯èƒ½å‡ºç°çš„å†…å­˜æ³„æ¼ç­‰é—®é¢˜ã€‚
* **æé«˜æ•ˆç‡**
  ï¼šä¸“æ³¨äºä¸šåŠ¡é€»è¾‘ï¼Œæ— éœ€æ·±å…¥äº†è§£ FFmpeg çš„å¤æ‚å‚æ•°é…ç½®ã€‚

å¦‚æœä½ æ­£åœ¨å¼€å‘ä¸çŸ­è§†é¢‘ã€ç›´æ’­å‰ªè¾‘ã€å†…å®¹ç”Ÿæˆç­‰ç›¸å…³çš„ Rust åº”ç”¨ï¼Œåˆ©ç”¨
`ez-ffmpeg`
å°†ä½¿ä½ äº‹åŠåŠŸå€ã€‚

ğŸ”—
**å¼€æºé¡¹ç›®åœ°å€**
ï¼š
[ez-ffmpeg](https://github.com/YeautyYE/ez-ffmpeg)