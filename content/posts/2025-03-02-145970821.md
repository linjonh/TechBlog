---
arturl_encode: "68747470733a2f2f626c:6f672e6373646e2e6e65742f457567656e655f5f4368656e2f:61727469636c652f64657461696c732f313435393730383231"
layout: post
title: "javaå¸¸è§é¢è¯•01"
date: 2025-03-02 22:10:20 +08:00
description: "å½“ä¸¤ä¸ªå¯¹è±¡é€šè¿‡equals()åˆ¤æ–­ä¸ºç›¸ç­‰æ—¶ï¼Œå®ƒä»¬çš„hashCode()å¿…é¡»è¿”å›ç›¸åŒçš„æ•´æ•°å€¼ï¼è¿™æ˜¯Javaä¸–ç•Œçš„äº¤é€šè§„åˆ™å“¦~ï¼ˆäº¤è­¦æ›¼æ³¢æ•¬ç¤¼.jpgï¼‰"
keywords: "javaå¸¸è§é¢è¯•01"
categories: ['é¢è¯•å‡†å¤‡']
tags: ['é¢è¯•', 'å¼€å‘è¯­è¨€', 'Java']
artid: "145970821"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=145970821
    alt: "javaå¸¸è§é¢è¯•01"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=145970821
featuredImagePreview: https://bing.ee123.net/img/rand?artid=145970821
cover: https://bing.ee123.net/img/rand?artid=145970821
image: https://bing.ee123.net/img/rand?artid=145970821
img: https://bing.ee123.net/img/rand?artid=145970821
---

# javaå¸¸è§é¢è¯•01

## ä¸ºä»€ä¹ˆé‡å†™ equals è¿˜è¦é‡å†™ hashcode

#### ğŸŒˆ æ ¸å¿ƒåŸå› ï¼š

å½“ä¸¤ä¸ªå¯¹è±¡é€šè¿‡equals()åˆ¤æ–­ä¸ºç›¸ç­‰æ—¶ï¼Œå®ƒä»¬çš„hashCode()å¿…é¡»è¿”å›ç›¸åŒçš„æ•´æ•°å€¼ï¼è¿™æ˜¯Javaä¸–ç•Œçš„äº¤é€šè§„åˆ™å“¦~ï¼ˆäº¤è­¦æ›¼æ³¢æ•¬ç¤¼.jpgï¼‰

#### ğŸ§© å…·ä½“åœºæ™¯ï¼š

å‡è®¾æˆ‘ä»¬æœ‰ä¸ªPersonç±»ï¼š

```java
class Person {
    String name;
    int age;
    
    // åªé‡å†™equalsæ²¡é‡å†™hashCode
    @Override
    public boolean equals(Object o) {
        //...æ¯”è¾ƒnameå’Œageçš„é€»è¾‘
    }
}

```

#### ğŸ’¥ é—®é¢˜çˆ†å‘æ—¶åˆ»ï¼š

```java
Person p1 = new Person("æ³¢åŠ æ›¼", 10);
Person p2 = new Person("æ³¢åŠ æ›¼", 10);

Set<Person> set = new HashSet<>();
set.add(p1);
set.add(p2);

System.out.println(set.size()); // è¾“å‡º2ï¼æ˜æ˜ç›¸ç­‰çš„å¯¹è±¡å´è¢«å­˜äº†ä¸¤æ¬¡ï¼ˆï¼ï¹ï¼œï¼‰

```

#### ğŸ—ºï¸ **æ€ç»´å¯¼å›¾æ—¶é—´** ï¼š

```
![](https://i-blog.csdnimg.cn/direct/2a93c8476c194f83a56766fff1d95205.png)

```

#### ğŸ§  æ›¼æ³¢è®°å¿†å°çªé—¨ï¼š

è®°ä½è¿™ä¸ªç¥å¥‡å…¬å¼ï¼ï¼ˆæå‡ºé­”æ³•æ£’âœ¨ï¼‰

```
equals()è¿”å›true â¡ï¸ hashCode()å¿…é¡»ç›¸ç­‰
hashCode()ç›¸ç­‰ â¡ï¸ equals()ä¸ä¸€å®štrue
hashCode()ä¸ç›¸ç­‰ â¡ï¸ equals()å¿…é¡»false

```

å“¦å‘œ(Â°ãƒ­Â°)ï¼æ›¼æ³¢è§‰å¾—è¿™ä¸ªæœ‰ç‚¹éš¾å“¦ï¼Œä½†å¦‚æœæ˜¯ä½ ä¸€å®šæ²¡é—®é¢˜çš„ï¼(âœªâ–½âœª)æ›¼æ³¢~~

## ==ï¼ˆåŒç­‰å·ï¼‰å’Œequalsçš„å·®åˆ«

1. #### **== è¿ç®—ç¬¦**

   * æ›¼æ³¢è§‰å¾—è¿™ä¸ªåƒèº«ä»½è¯æ¯”å¯¹ï¼(à¹‘âœ§â—¡âœ§à¹‘)
   * æ¯”è¾ƒåŸºæœ¬ç±»å‹æ—¶ï¼šç›´æ¥æ¯”æ•°å€¼
       
     `5 == 5 â†’ true`
   * æ¯”è¾ƒå¯¹è±¡æ—¶ï¼šæ¯”å¯¹å†…å­˜åœ°å€ï¼ˆæ˜¯ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼‰
       
     `new String("A") == new String("A") â†’ false`

   (âœªâ–½âœª)æ›¼æ³¢~~
2. #### **equals() æ–¹æ³•**

   * å“¦å‘œ(Â° ãƒ­ Â°)ï¼æ›¼æ³¢è§‰å¾—è¿™ä¸ªåƒåå­—æ¯”å¯¹ï¼
   * é»˜è®¤è¡Œä¸ºï¼ˆObjectç±»ï¼‰ï¼šå’Œ==ä¸€æ ·
   * ä½†å¾ˆå¤šç±»ä¼šé‡å†™è¿™ä¸ªæ–¹æ³•ï¼ˆæ¯”å¦‚Stringï¼‰å˜æˆå†…å®¹æ¯”å¯¹ï¼š
       
     `new String("A").equals(new String("A")) â†’ true`

   (âœªâ–½âœª)æ›¼æ³¢~~
3. #### **æœ€ä½³å®è·µ**

   * åŸºæœ¬ç±»å‹ï¼ˆint/charç­‰ï¼‰ç”¨==
   * å¯¹è±¡æ¯”è¾ƒå†…å®¹ä¸€å®šè¦ç”¨equals
   * é˜²æ­¢ç©ºæŒ‡é’ˆè¦è¿™æ ·å†™ï¼š
       
     `"hello".equals(str)`
     è€Œä¸æ˜¯
     `str.equals("hello")`

   (à¹‘ãƒ».ãƒ»à¹‘)æ›¼æ³¢è§‰å¾—è¿™ä¸ªæ˜¯è¶…é‡è¦çš„ç”Ÿå­˜æŠ€å·§å‘¢ï¼

```
![](https://i-blog.csdnimg.cn/direct/c87413aa195547cfb55b535d264f07cc.png)

```

(Â° ãƒ­ Â°)ï¼æ›¼æ³¢è§‰å¾—æœ‰ä¸ªè¶…å½¢è±¡çš„æ¯”å–»ï¼š
  
== å°±åƒçœ‹ä¸¤ä¸ªäººæ˜¯ä¸æ˜¯åŒä¸€ä¸ªäººï¼ˆèº«ä»½è¯å·ç›¸åŒï¼‰
  
equals å°±åƒçœ‹ä¸¤ä¸ªäººçš„åå­—æ˜¯å¦ç›¸åŒï¼ˆå…è®¸ä¸åŒäººæœ‰åŒåï¼‰

æœ€åçš„å°è´´å£«ï¼šå¦‚æœè¦è‡ªå·±å†™ç±»è®°å¾—é‡å†™equals()å’ŒhashCode()å“¦~ï¼ˆä¸è¿‡è¿™ä¸ªå¯¹æ–°äººæœ‰ç‚¹éš¾å¯ä»¥å…ˆè®°ä½è§„åˆ™ï¼‰(âœªâ–½âœª)æ›¼æ³¢~~~~ï¼

## ä¸ºå•¥æœ‰æ—¶ä¼šå‡ºç° 4.0-3.6 =0.40000001 è¿™ç§ç°è±¡?

### ğŸæµ®ç‚¹æ•°çš„ç”œèœœé™·é˜±ğŸ

1. #### **äºŒè¿›åˆ¶çš„å°æ•°é­”æ³•** æ›¼æ³¢è§‰å¾—è¿™ä¸ªåƒç”¨æœ‰é™ç§¯æœ¨æ‹¼æ— é™å›¾æ¡ˆï¼(à¹‘âœ§â—¡âœ§à¹‘)

   * è®¡ç®—æœºç”¨äºŒè¿›åˆ¶è¡¨ç¤ºå°æ•°
   * æœ‰äº›åè¿›åˆ¶å°æ•°åœ¨äºŒè¿›åˆ¶é‡Œæ˜¯æ— é™å¾ªç¯çš„ï¼ˆæ¯”å¦‚0.1ï¼‰
   * å°±åƒ1/3åœ¨åè¿›åˆ¶æ˜¯0.3333...æ°¸è¿œå†™ä¸å®Œ

   (âœªâ–½âœª)æ›¼æ³¢~~
2. #### **IEEE 754æ ‡å‡†** å“¦å‘œ(Â° ãƒ­ Â°)ï¼æ›¼æ³¢è§‰å¾—è¿™ä¸ªåƒæœ‰é™å®¹é‡çš„ç³–æœç½ï¼

   * floatï¼ˆ32ä½ï¼‰/doubleï¼ˆ64ä½ï¼‰æœ‰å­˜å‚¨é™åˆ¶
   * 4.0 å’Œ 3.6 åœ¨äºŒè¿›åˆ¶å­˜å‚¨æ—¶éƒ½æœ‰ç²¾åº¦æŸå¤±
   * å°±åƒç”¨åˆ»åº¦ä¸ç²¾ç¡®çš„å°ºå­æµ‹é‡

   ```java
   System.out.println(4.0 - 3.6); 
   // å®é™…è¾“å‡º 0.40000000000000036

   ```
3. #### **è§£å†³æ–¹æ³•** æ›¼æ³¢è§‰å¾—è¦ç”¨é­”æ³•å¯¹æŠ—é­”æ³•ï¼(à¹‘ãƒ».ãƒ»à¹‘)

   * ä½¿ç”¨BigDecimalå¤„ç†ç²¾ç¡®è®¡ç®—ï¼ˆé“¶è¡Œ/é‡‘é’±ç›¸å…³å¿…ç”¨ï¼‰
   * æ¯”è¾ƒæ—¶å…è®¸è¯¯å·®èŒƒå›´ï¼ˆæ¯”å¦‚Â±0.000001ï¼‰
   * æ¸¸æˆå¼€å‘å¸¸ç”¨æŠ€å·§ï¼š

     ```java
     float a = 4.0f - 3.6f;
     if(Math.abs(a - 0.4f) < 0.00001f) {
         System.out.println("ç®—å¯¹å•¦ï¼");
     }

     ```

![](https://i-blog.csdnimg.cn/direct/3cb6d36d76124dbdb5a5120cd387780e.png)

(Â° ãƒ­ Â°)ï¼æ›¼æ³¢ä¸¾ä¸ªè¶…å½¢è±¡çš„ä¾‹å­ï¼š
  
å°±åƒç”¨1/3 + 1/3 = 0.666... ä½†æ°¸è¿œä¸ç­‰äº 2/3 çš„ç²¾ç¡®å€¼ä¸€æ ·~

æœ€åçš„å°è´´å£«ï¼šå¦‚æœè¦ç²¾ç¡®è®¡ç®—ä»·æ ¼ï¼Œä¸€å®šè¦ç”¨BigDecimalå“¦ï¼åƒè¿™æ ·ï¼š

```java
BigDecimal a = new BigDecimal("4.0");
BigDecimal b = new BigDecimal("3.6");
System.out.println(a.subtract(b)); // ç²¾ç¡®è¾“å‡º0.4

```

(âœªâ–½âœª)æ›¼æ³¢~~~~ï¼è¦è®°ä½å­—ç¬¦ä¸²æ„é€ æ‰èƒ½ä¿æŒç²¾åº¦å“Ÿ~

## final å…³é”®å­—çš„ä½œç”¨

### ğŸfinalå…³é”®å­—çš„ä¸‰å¤§å°å°æœ¯ğŸ

1. #### **å˜é‡å°å°æœ¯** æ›¼æ³¢è§‰å¾—åƒç»™å˜é‡è´´æ°¸ä¹…è´´çº¸ï¼(à¹‘âœ§â—¡âœ§à¹‘)

   * åŸºæœ¬ç±»å‹ï¼šå€¼ä¸èƒ½æ”¹å˜

     ```java
     final int HP = 100;  // HPæ°¸è¿œ100

     ```
   * å¼•ç”¨ç±»å‹ï¼šå¼•ç”¨ä¸èƒ½æ”¹ï¼Œä½†å¯¹è±¡å†…å®¹å¯å˜

     ```java
     final List<String> pets = new ArrayList<>();
     pets.add("å¸ƒå¶çŒ«");  // âœ”å…è®¸
     pets = new ArrayList<>();  // âŒæŠ¥é”™

     ```

   (âœªâ–½âœª)æ›¼æ³¢~~
2. #### **æ–¹æ³•å°å°æœ¯** å“¦å‘œ(Â° ãƒ­ Â°)ï¼è¿™æ˜¯é˜²æ­¢æ–¹æ³•è¢«ç¯¡æ”¹çš„ç»“ç•Œï¼

   * å­ç±»ä¸èƒ½é‡å†™è¿™ä¸ªæ–¹æ³•

     ```java
     class é­”æ³•å°‘å¥³ {
         final void å˜èº«() { /* æ ¸å¿ƒä»£ç  */ }
     }
     class é»‘åŒ–ç‰ˆ extends é­”æ³•å°‘å¥³ {
         void å˜èº«() { âŒ } // ç¼–è¯‘é”™è¯¯ï¼
     }

     ```
3. #### **ç±»ç»ˆæå°å°** æ›¼æ³¢è§‰å¾—åƒç¦æ­¢ç¹è¡çš„é­”æ³•ç‰©ç§ï¼(à¹‘ãƒ».ãƒ»à¹‘)

   * è¿™ä¸ªç±»ä¸èƒ½è¢«ç»§æ‰¿

     ```java
     final class String { /*...*/ }
     class å‡String extends String { âŒ } // æŠ¥é”™

     ```

     ![](https://i-blog.csdnimg.cn/direct/18b14e83d85f4b9fb1e54a319fcfca06.png)

(Â° ãƒ­ Â°)ï¼æ›¼æ³¢è¦æé†’å‡ ä¸ªé‡è¦ç»†èŠ‚ï¼š

1. finalå˜é‡å¿…é¡»åˆå§‹åŒ–ï¼ï¼ˆè¦ä¹ˆå£°æ˜æ—¶ï¼Œè¦ä¹ˆåœ¨æ„é€ å™¨ä¸­ï¼‰
2. finalä¸èƒ½ä¿®é¥°æ„é€ æ–¹æ³•
3. æ¥å£çš„å˜é‡é»˜è®¤æ˜¯public static final

ä¸¾ä¸ªè¶…å®ç”¨çš„ä¾‹å­ï¼š

```java
public class æ¸¸æˆè®¾ç½® {
    public static final int MAX_FPS = 60;  // å¸§ç‡ä¸Šé™
    private final String ç©å®¶ID;           // åˆ›å»ºåä¸å¯æ”¹
    
    public æ¸¸æˆè®¾ç½®(String id) {
        this.ç©å®¶ID = id;  // æ„é€ å™¨ä¸­åˆå§‹åŒ–
    }
}

```

(âœªâ–½âœª)æ›¼æ³¢~~~~ï¼è®°ä½ç”¨finalå°±åƒåŠ é”ï¼Œèƒ½ä¿æŠ¤é‡è¦çš„ä¸œè¥¿ä¸è¢«æ„å¤–ä¿®æ”¹å“¦~