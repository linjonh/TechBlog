---
layout: post
title: "SQL题型组合两个表"
date: 2025-03-05 18:34:41 +0800
description: "相反，它会返回右表中的所有记录，无论左表中是否有匹配的记录。对于右表中的每一条记录，如果左表中有匹配的记录，则将匹配的记录组合在一起；如果左表中没有匹配的记录，则左表中的列将填充为。）会返回左表中的所有记录，无论右表中是否有匹配的记录。对于左表中的每一条记录，如果右表中有匹配的记录，则将匹配的记录组合在一起；如果右表中没有匹配的记录，则右表中的列将填充为。问题：编写 SQL 查询所有学生的姓名及其选修的课程科目（包括未选课的学生）该表包含一些人的 ID 和他们的姓和名的信息。表中的记录都会被保留，无论。"
keywords: "select b.编码,b.名称 as 项目,c.名称 as 科室, sum(a.金额) as 金额 from (selec"
categories: ['Mysql']
tags: ['数据库', 'Sql', 'Mysql']
artid: "146049106"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146049106
    alt: "SQL题型组合两个表"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146049106
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146049106
cover: https://bing.ee123.net/img/rand?artid=146049106
image: https://bing.ee123.net/img/rand?artid=146049106
img: https://bing.ee123.net/img/rand?artid=146049106
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     SQL题型：组合两个表
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     例题：
    </p>
    <p>
     表:
     <code>
      Person
     </code>
    </p>
    <pre>+-------------+---------+
| 列名         | 类型     |
+-------------+---------+
| PersonId    | int     |
| FirstName   | varchar |
| LastName    | varchar |
+-------------+---------+
<strong>personId</strong> 是该表的主键（具有唯一值的列）。
该表包含一些人的 ID 和他们的姓和名的信息。</pre>
    <p>
     表:
     <code>
      Address
     </code>
    </p>
    <pre>+-------------+---------+
| 列名         | 类型    |
+-------------+---------+
| AddressId   | int     |
| PersonId    | int     |
| City        | varchar |
| State       | varchar |
+-------------+---------+
addressId 是该表的主键（具有唯一值的列）。
该表的每一行都包含一个 ID = <strong>PersonId </strong>的人的城市和州的信息。</pre>
    <p>
     要求：
     <span style="background-color:#ffd900">
      编写解决方案，报告
     </span>
     <code>
      <span style="background-color:#ffd900">
       Person
      </span>
     </code>
     <span style="background-color:#ffd900">
      表中每个人的姓、名、城市和州。如果
     </span>
     <code>
      <span style="background-color:#ffd900">
       personId
      </span>
     </code>
     <span style="background-color:#ffd900">
      的地址不在
     </span>
     <code>
      <span style="background-color:#ffd900">
       Address
      </span>
     </code>
     <span style="background-color:#ffd900">
      表中，则报告为
     </span>
     <code>
      <span style="background-color:#ffd900">
       null
      </span>
     </code>
     <span style="background-color:#ffd900">
      。以
     </span>
     <strong>
      <span style="background-color:#ffd900">
       任意顺序
      </span>
     </strong>
     <span style="background-color:#ffd900">
      返回结果表。
     </span>
    </p>
    <p>
     <span style="color:null">
      <span style="background-color:#ffd900">
       解析：
      </span>
     </span>
    </p>
    <p>
     将
     <code>
      Person
     </code>
     表（存储姓名）与
     <code>
      Address
     </code>
     表（存储地址）关联，展示每个人的完整信息。
    </p>
    <p>
     <strong>
      <code>
       LEFT JOIN
      </code>
     </strong>
     ：保证所有
     <code>
      Person
     </code>
     表中的记录都会被保留，无论
     <code>
      Address
     </code>
     表中是否有匹配的地址。
    </p>
    <p>
     <strong>
      匹配条件
     </strong>
     ：通过
     <code>
      PersonId
     </code>
     关联两张表，确保同一个人的姓名和地址被正确对应。
    </p>
    <p>
     所以结果应该是
    </p>
    <ul>
     <li>
      若某人有地址，显示其姓名、城市和州。
     </li>
     <li>
      若某人无地址，姓名正常显示，但城市和州为
      <code>
       NULL
      </code>
      。
     </li>
    </ul>
    <p>
     解答代码：
    </p>
    <pre><code class="language-sql">select p.FirstName,p.LastName,a.City,a.State
from Person as p
left join Address as a on p.PersonId=a.PersonId;</code></pre>
    <p class="img-center">
     <img alt="" height="329" src="https://i-blog.csdnimg.cn/direct/9b4275b186f54726bb516d546658b88c.png" width="384"/>
    </p>
    <p>
     类似的题目：
    </p>
    <p>
     <strong>
      题目 1：学生与课程表
     </strong>
     <br/>
     表结构：
     <br/>
     Student
     <br/>
     +-----------+---------+
     <br/>
     | StudentId | int |
     <br/>
     | Name | varchar |
     <br/>
     +-----------+---------+
     <br/>
     主键：StudentId
    </p>
    <p>
     Course
     <br/>
     +-----------+---------+
     <br/>
     | CourseId | int |
     <br/>
     | StudentId | int |
     <br/>
     | Subject | varchar |
     <br/>
     +-----------+---------+
     <br/>
     主键：CourseId
    </p>
    <p>
     <span style="background-color:#ffd900">
      问题：编写 SQL 查询所有学生的姓名及其选修的课程科目（包括未选课的学生）
     </span>
    </p>
    <pre><code class="language-sql">SELECT s.Name, c.Subject
FROM Student AS s
LEFT JOIN Course AS c ON s.StudentId = c.StudentId;</code></pre>
    <p>
     <strong>
      题目 2：员工与部门表
     </strong>
     <br/>
     表结构：
     <br/>
     Employee
     <br/>
     +-----------+---------+
     <br/>
     | EmpId | int |
     <br/>
     | Name | varchar |
     <br/>
     +-----------+---------+
     <br/>
     主键：EmpId
    </p>
    <p>
     Department
     <br/>
     +-----------+---------+
     <br/>
     | DeptId | int |
     <br/>
     | EmpId | int |
     <br/>
     | DeptName | varchar |
     <br/>
     +-----------+---------+
     <br/>
     主键：DeptId
    </p>
    <p>
     <span style="background-color:#ffd900">
      问题：编写 SQL 查询在 "技术部" 工作的员工姓名
     </span>
    </p>
    <pre><code class="language-sql">SELECT e.Name
FROM Employee AS e
INNER JOIN Department AS d ON e.EmpId = d.EmpId
WHERE d.DeptName = '技术部';</code></pre>
    <p>
     <strong>
      题目 3：用户与订单表
     </strong>
     <br/>
     表结构：
     <br/>
     User
     <br/>
     +---------+---------+
     <br/>
     | UserId | int |
     <br/>
     | Name | varchar |
     <br/>
     +---------+---------+
     <br/>
     主键：UserId
    </p>
    <p>
     Order
     <br/>
     +---------+---------+
     <br/>
     | OrderId | int |
     <br/>
     | UserId | int |
     <br/>
     | Amount | decimal |
     <br/>
     +---------+---------+
     <br/>
     主键：OrderId
    </p>
    <p>
     <span style="background-color:#ffd900">
      问题：编写 SQL 查询所有用户的姓名及其订单总金额（没有订单的显示 0）
     </span>
    </p>
    <pre><code class="language-sql">select u.Name, COALESCE(SUM(o.Amount), 0) as TotalAmount
from User as u
left join Order as o on u.UserId = o.UserId
group by u.UserId, u.Name;</code></pre>
    <p>
     <strong>
      题目 4：书籍与作者表
     </strong>
     <br/>
     表结构：
     <br/>
     Book
     <br/>
     +---------+---------+
     <br/>
     | BookId | int |
     <br/>
     | Title | varchar |
     <br/>
     +---------+---------+
     <br/>
     主键：BookId
    </p>
    <p>
     Author
     <br/>
     +---------+---------+
     <br/>
     | AuthorId| int |
     <br/>
     | BookId | int |
     <br/>
     | Name | varchar |
     <br/>
     +---------+---------+
     <br/>
     主键：AuthorId
    </p>
    <p>
     <span style="background-color:#ffd900">
      问题：编写 SQL 查询所有书籍的标题及其作者（包括未分配作者的书籍）
     </span>
    </p>
    <pre><code class="language-sql">select b.Title,a.Name
from Book as b
left join Author as a on b.AuthorId=a.AuthorId</code></pre>
    <p>
     <strong>
      题目 5：客户与地址表
     </strong>
     <br/>
     表结构：
     <br/>
     Customer
     <br/>
     +-----------+---------+
     <br/>
     | CustId | int |
     <br/>
     | Name | varchar |
     <br/>
     +-----------+---------+
     <br/>
     主键：CustId
    </p>
    <p>
     Shipping
     <br/>
     +-----------+---------+
     <br/>
     | ShipId | int |
     <br/>
     | CustId | int |
     <br/>
     | Address | varchar |
     <br/>
     +-----------+---------+
     <br/>
     主键：ShipId
    </p>
    <p>
     <span style="background-color:#ffd900">
      问题：编写 SQL 查询所有客户的姓名及其最近一次发货地址（假设最近一次发货地址由 ShipId 降序决定）
     </span>
    </p>
    <pre><code class="language-sql">SELECT c.Name, s.Address
FROM Customer as c
LEFT JOIN (
    SELECT CustId, Address
    FROM Shipping
    WHERE ShipId = (SELECT MAX(ShipId) FROM Shipping as s2 WHERE s2.CustId = Shipping.CustId)
) as s ON c.CustId = s.CustId;</code></pre>
    <p>
     <span style="background-color:#fe2c24">
      笔记：
     </span>
    </p>
    <p>
     1、
     <code>
      INNER JOIN
     </code>
     （内连接）
    </p>
    <p>
     <code>
      INNER JOIN
     </code>
     只返回两个表中满足连接条件的记录组合。也就是说，只有当左表和右表中的记录在连接条件上匹配时，这些记录才会出现在结果集中。不满足连接条件的记录会被过滤掉。
    </p>
    <pre><code class="language-sql">SELECT 列名
FROM 表1
INNER JOIN 表2
ON 表1.列 = 表2.列;</code></pre>
    <p>
     2、
     <code>
      LEFT JOIN
     </code>
     （左连接）
    </p>
    <p>
     <code>
      LEFT JOIN
     </code>
     （也称为
     <code>
      LEFT OUTER JOIN
     </code>
     ）会返回左表中的所有记录，无论右表中是否有匹配的记录。对于左表中的每一条记录，如果右表中有匹配的记录，则将匹配的记录组合在一起；如果右表中没有匹配的记录，则右表中的列将填充为
     <code>
      NULL
     </code>
     。
    </p>
    <pre><code class="language-sql">SELECT 列名
FROM 左表
LEFT JOIN 右表
ON 左表.列 = 右表.列;</code></pre>
    <p>
     3、
     <code>
      RIGHT JOIN
     </code>
     （右连接）
    </p>
    <p>
     <code>
      RIGHT JOIN
     </code>
     （也称为
     <code>
      RIGHT OUTER JOIN
     </code>
     ）与
     <code>
      LEFT JOIN
     </code>
     相反，它会返回右表中的所有记录，无论左表中是否有匹配的记录。对于右表中的每一条记录，如果左表中有匹配的记录，则将匹配的记录组合在一起；如果左表中没有匹配的记录，则左表中的列将填充为
     <code>
      NULL
     </code>
     。
    </p>
    <pre><code class="language-sql">SELECT 列名
FROM 左表
RIGHT JOIN 右表
ON 左表.列 = 右表.列;</code></pre>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a:2f2f626c6f672e6373646e2e6e65742f4e6572766f7573722f:61727469636c652f64657461696c732f313436303439313036" class_="artid" style="display:none">
 </p>
</div>


