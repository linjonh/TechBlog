---
layout: post
title: "TWind-的黑马点评随笔"
date: 2025-03-06 21:19:27 +0800
description: "完结撒花 🎉 🎉 🎉接下来就是写几篇博客巩固一下…"
keywords: "TWind 的黑马点评随笔"
categories: ['未分类']
tags: ['Redis', 'Java']
artid: "146080594"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146080594
    alt: "TWind-的黑马点评随笔"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146080594
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146080594
cover: https://bing.ee123.net/img/rand?artid=146080594
image: https://bing.ee123.net/img/rand?artid=146080594
img: https://bing.ee123.net/img/rand?artid=146080594
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     TWind 的黑马点评随笔
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="TWind__1">
     </a>
     TWind 的黑马点评随笔
    </h2>
    <p>
     ​ 目前是把黑马点评的技术部分完全做完了，不能说吃得饱饱，也算个半饱吧。
    </p>
    <p>
     ​ 黑马点评严格来说不算项目，因为它给的前端过于垃圾，内容又重在Redis，所以称之为Redis练习貌似跟贴切。
    </p>
    <p>
     ​ 尽管如此，这个项目仍然非常适合新手入门，亮点尤其在带你一步步解决抢优惠卷带来的一系列线程问题展开，从表层到深入，非常不错。
    </p>
    <p>
     ​ 但是，对于异步编程，集群，分布式等内容建议还是移步spring cloud，这个是专业的，黑马点评更多注重于Redis的运用(后面的关于签到，位置，推文这些建议还是别看了，这已经脱离了初衷)
    </p>
    <p>
     ​ 后面应该会写一些关于Redis消息队列的文章
    </p>
    <hr/>
    <h3>
     <a id="_15">
     </a>
     坑合集
    </h3>
    <pre><code>### 坑1
</code></pre>
    <p>
     首当其冲的是黑马的构思前端，登录时无法选中阅读协议！！！
    </p>
    <p>
     解决办法是到nginx里面的前端代码手动修改，把
     <strong>
      login.html
     </strong>
     里面的
    </p>
    <blockquote>
     <pre><code class="prism language-java"><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
<span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token operator">!</span> <span class="token keyword">this</span><span class="token punctuation">.</span>radio<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
 <span class="token keyword">this</span><span class="token punctuation">.</span>$message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"请先确认阅读用户协议！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">return</span>
<span class="token punctuation">}</span>
</code></pre>
    </blockquote>
    <p>
     惊叹号去掉！
    </p>
    <h4>
     <a id="2_33">
     </a>
     坑2
    </h4>
    <p>
     紧随其后的是redis序列化器
    </p>
    <p>
     你大可直接用黑马视频用的自带的stringRedisTemplate，但是你这样做的话就得在使用Map互转Bean时尽享那一串的构思修复代码
    </p>
    <p>
     这里建议直接一步到位，用
     <strong>
      Jackson2JsonRedisSerializer
     </strong>
     作为所有的序列化反序列化器
    </p>
    <blockquote>
     <pre><code class="prism language-java"><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">RedisTemplate</span> <span class="token function">redisTemplate</span><span class="token punctuation">(</span><span class="token class-name">RedisConnectionFactory</span> redisConnectionFactory<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"开始创建redis模板对象..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">ObjectMapper</span> objectMapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
objectMapper<span class="token punctuation">.</span><span class="token function">registerModule</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JavaTimeModule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 注册 JavaTimeModule 处理 LocalDateTime</span>
objectMapper<span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token class-name">SerializationFeature</span><span class="token punctuation">.</span><span class="token constant">WRITE_DATES_AS_TIMESTAMPS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 禁用时间戳格式</span>

<span class="token class-name">Jackson2JsonRedisSerializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> jackson2JsonRedisSerializer <span class="token operator">=</span>
      <span class="token keyword">new</span> <span class="token class-name">Jackson2JsonRedisSerializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
jackson2JsonRedisSerializer<span class="token punctuation">.</span><span class="token function">setObjectMapper</span><span class="token punctuation">(</span>objectMapper<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> redisTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
redisTemplate<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>redisConnectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
redisTemplate<span class="token punctuation">.</span><span class="token function">setKeySerializer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
redisTemplate<span class="token punctuation">.</span><span class="token function">setValueSerializer</span><span class="token punctuation">(</span>jackson2JsonRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
redisTemplate<span class="token punctuation">.</span><span class="token function">setHashValueSerializer</span><span class="token punctuation">(</span>jackson2JsonRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> redisTemplate<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    </blockquote>
    <p>
     **redisTemplate.setKeySerializer(new StringRedisSerializer());**这里不用jackson的原因是用了key会乱码（虽然不影响就是了）
    </p>
    <p>
     注意！要用的话要用一套（dubug了好久），redis默认的是string类的序列化器！远古java版本的LocalDateTime有兼容性问题！
    </p>
    <h4>
     <a id="3_67">
     </a>
     坑3
    </h4>
    <p>
     你可能在传参数到Lua脚本时发现Lua接受到的始终为
     <strong>
      nil
     </strong>
     ，这是因为我们用的是:
    </p>
    <blockquote>
     <pre><code class="prism language-java"><span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">RedisTemplat</span> redisTemplate<span class="token punctuation">;</span>
</code></pre>
    </blockquote>
    <p>
     序列化出了问题:
     <strong>
      Lua脚本不知道传进去的数据是什么类型！
     </strong>
     （Redis是知道的但它没给Lua说），得手动指定:
    </p>
    <blockquote>
     <pre><code class="prism language-java"><span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> redisTemplate<span class="token punctuation">;</span>
</code></pre>
    </blockquote>
    <p>
     这样就完美解决
    </p>
    <h4>
     <a id="4_85">
     </a>
     坑4
    </h4>
    <p>
     严格来说不算坑，是自己学艺不精…
    </p>
    <p>
     同时看到了一篇错误的CSDN博客…
    </p>
    <p>
     就是
    </p>
    <blockquote>
     <pre><code class="prism language-java">stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read
</code></pre>
    </blockquote>
    <p>
     <strong>
      它对应的是消费者组操作中的XREADGROUP ，是既可以访问消息队列也可以访问pending-list队列的！
     </strong>
    </p>
    <p>
     <strong>
      取决于其ID
     </strong>
    </p>
    <p>
     <s>
      所以stringRedisTemplate.opsForStream().pending的意义在哪呢
     </s>
    </p>
    <hr/>
    <h3>
     <a id="_105">
     </a>
     总结
    </h3>
    <p>
     完结撒花 🎉 🎉 🎉
    </p>
    <p>
     接下来就是写几篇博客巩固一下…
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f33303030343531332f:61727469636c652f64657461696c732f313436303830353934" class_="artid" style="display:none">
 </p>
</div>


