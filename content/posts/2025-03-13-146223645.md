---
layout: post
title: "sklearn中生成完整标签数据集半监督数据集,多标签数据集的模拟方法"
date: 2025-03-13 10:30:43 +0800
description: "是库中的一个模块，它提供了许多用于生成样本数据集和加载真实世界数据集的工具。"
keywords: "sklearn中生成完整标签数据集、半监督数据集，多标签数据集的模拟方法"
categories: ['未分类']
tags: ['人工智能', 'Sklearn', 'Python']
artid: "146223645"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146223645
    alt: "sklearn中生成完整标签数据集半监督数据集,多标签数据集的模拟方法"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146223645
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146223645
cover: https://bing.ee123.net/img/rand?artid=146223645
image: https://bing.ee123.net/img/rand?artid=146223645
img: https://bing.ee123.net/img/rand?artid=146223645
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     sklearn中生成完整标签数据集、半监督数据集，多标签数据集的模拟方法
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     <code>
      sklearn.datasets
     </code>
     是
     <code>
      scikit-learn
     </code>
     库中的一个模块，它提供了许多用于生成样本数据集和加载真实世界数据集的工具。以下是一些常用的函数和它们的用法：
    </p>
    <h4>
     <a id="_2">
     </a>
     生成有监督数据集
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        <code>
         make_classification(n_samples=100, n_features=20, ..., random_state=None)
        </code>
       </strong>
      </p>
      <ul>
       <li>
        生成一个模拟的二分类数据集。
       </li>
       <li>
        <code>
         n_samples
        </code>
        : 样本数量。
       </li>
       <li>
        <code>
         n_features
        </code>
        : 特征数量。
       </li>
       <li>
        <code>
         n_informative
        </code>
        : 有用的特征数量。
       </li>
       <li>
        <code>
         n_redundant
        </code>
        : 冗余的特征数量（与其他特征线性相关）。
       </li>
       <li>
        <code>
         n_repeated
        </code>
        : 重复的特征数量（与另一个特征完全相同）。
       </li>
       <li>
        <code>
         n_classes
        </code>
        : 类别数量。
       </li>
       <li>
        <code>
         random_state
        </code>
        : 控制随机数生成器的种子。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        <code>
         make_regression(n_samples=100, n_features=1, ..., random_state=None)
        </code>
       </strong>
      </p>
      <ul>
       <li>
        生成一个模拟的回归数据集。
       </li>
       <li>
        <code>
         n_samples
        </code>
        : 样本数量。
       </li>
       <li>
        <code>
         n_features
        </code>
        : 特征数量。
       </li>
       <li>
        <code>
         n_informative
        </code>
        : 有用的特征数量。
       </li>
       <li>
        <code>
         n_targets
        </code>
        : 目标变量的数量。
       </li>
       <li>
        <code>
         noise
        </code>
        : 噪声的大小。
       </li>
       <li>
        <code>
         random_state
        </code>
        : 控制随机数生成器的种子。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        <code>
         make_blobs(n_samples=100, centers=3, ..., random_state=None)
        </code>
       </strong>
      </p>
      <ul>
       <li>
        生成由子集组成的数据集，每个子集位于低维、孤立的区域。
       </li>
       <li>
        <code>
         n_samples
        </code>
        : 样本数量。
       </li>
       <li>
        <code>
         centers
        </code>
        : 中心点的数量。
       </li>
       <li>
        <code>
         cluster_std
        </code>
        : 簇内的标准差。
       </li>
       <li>
        <code>
         random_state
        </code>
        : 控制随机数生成器的种子。
       </li>
      </ul>
     </li>
    </ol>
    <h4>
     <a id="_30">
     </a>
     加载真实世界数据集
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        <code>
         load_iris()
        </code>
       </strong>
      </p>
      <ul>
       <li>
        加载鸢尾花数据集。
       </li>
       <li>
        返回数据和目标，以及特征名称和目标名称。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        <code>
         load_diabetes()
        </code>
       </strong>
      </p>
      <ul>
       <li>
        加载糖尿病数据集。
       </li>
       <li>
        返回数据和目标，以及特征名称和描述。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        <code>
         fetch_california_housing()
        </code>
       </strong>
      </p>
      <ul>
       <li>
        加载加州住房数据集。
       </li>
       <li>
        返回数据和目标，以及特征名称和描述。
       </li>
      </ul>
     </li>
    </ol>
    <h4>
     <a id="_44">
     </a>
     完整标签数据集示例代码
    </h4>
    <pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_classification<span class="token punctuation">,</span> load_iris

<span class="token comment"># 生成一个二分类数据集</span>
X<span class="token punctuation">,</span> y <span class="token operator">=</span> make_classification<span class="token punctuation">(</span>n_samples<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> n_features<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> n_informative<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> n_redundant<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>

<span class="token comment"># 加载鸢尾花数据集</span>
iris <span class="token operator">=</span> load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span>
X_iris<span class="token punctuation">,</span> y_iris <span class="token operator">=</span> iris<span class="token punctuation">.</span>data<span class="token punctuation">,</span> iris<span class="token punctuation">.</span>target
feature_names <span class="token operator">=</span> iris<span class="token punctuation">.</span>feature_names
target_names <span class="token operator">=</span> iris<span class="token punctuation">.</span>target_names

<span class="token keyword">print</span><span class="token punctuation">(</span>X_iris<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> y_iris<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>feature_names<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>target_names<span class="token punctuation">)</span>
</code></pre>
    <h4>
     <a id="_62">
     </a>
     生成半监督数据集
    </h4>
    <p>
     使用现实数据集生成半监督数据集（也称为弱标签数据集或不完全标注数据集）通常涉及以下步骤：
    </p>
    <ol>
     <li>
      <p>
       <strong>
        选择一个完整的标签数据集
       </strong>
       ：首先，你需要有一个已经标注好的完整数据集。
      </p>
     </li>
     <li>
      <p>
       <strong>
        随机移除一部分标签
       </strong>
       ：从完整数据集中随机选择一部分样本，并移除它们的标签，从而创建部分标签数据集。
      </p>
     </li>
     <li>
      <p>
       <strong>
        根据需要调整标签
       </strong>
       ：在某些情况下，你可能需要根据特定的模式或规则来移除标签，而不是完全随机。
      </p>
     </li>
     <li>
      <p>
       <strong>
        验证数据集
       </strong>
       ：确保生成的部分标签数据集符合你的研究或应用需求。
      </p>
     </li>
    </ol>
    <p>
     以下是一个使用Python和
     <code>
      scikit-learn
     </code>
     库从完整标签数据集中生成半监督数据集的示例：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_iris
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>utils <span class="token keyword">import</span> shuffle

<span class="token comment"># 加载一个完整的标签数据集，例如鸢尾花数据集</span>
iris <span class="token operator">=</span> load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span>
X<span class="token punctuation">,</span> y <span class="token operator">=</span> iris<span class="token punctuation">.</span>data<span class="token punctuation">,</span> iris<span class="token punctuation">.</span>target

<span class="token comment"># 确定要保留的有标签样本，例如保留70%的标签</span>
retain_ratio <span class="token operator">=</span> <span class="token number">0.7</span>
num_retain <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> retain_ratio<span class="token punctuation">)</span>

<span class="token comment"># 随机打乱数据集</span>
X<span class="token punctuation">,</span> y <span class="token operator">=</span> shuffle<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>

<span class="token comment"># 保留部分标签</span>
X_labeled<span class="token punctuation">,</span> y_labeled <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span>num_retain<span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span><span class="token punctuation">:</span>num_retain<span class="token punctuation">]</span>
X_unlabeled <span class="token operator">=</span> X<span class="token punctuation">[</span>num_retain<span class="token punctuation">:</span><span class="token punctuation">]</span>

<span class="token comment"># 现在 X_labeled 和 y_labeled 是有标签的数据，X_unlabeled 是无标签的数据</span>
</code></pre>
    <p>
     在这个示例中，我们首先加载了鸢尾花数据集，然后随机打乱了数据。接着，我们根据保留比例计算出需要保留的样本数量，并从打乱后的数据集中分割出有标签和无标签的部分。最后，我们得到了一个半监督标签数据集，其中一部分样本有标签，另一部分样本没有标签。
    </p>
    <p>
     请注意，这种方法生成的部分标签数据集可能不适用于所有类型的研究或应用。在实际应用中，你可能需要根据具体情况调整标签移除的策略。
    </p>
    <h4>
     <a id="_101">
     </a>
     多标签数据集生成方法
    </h4>
    <p>
     要生成多标签数据集，可以使用
     <code>
      scikit-learn
     </code>
     库中的
     <code>
      make_multilabel_classification
     </code>
     函数。这个函数可以生成多标签数据的随机样本，其中每个样本有两个特征的计数，这两个特征在两个类别中的每一个中分布不同。
    </p>
    <p>
     以下是使用
     <code>
      make_multilabel_classification
     </code>
     函数生成多标签数据集的基本示例：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_multilabel_classification

<span class="token comment"># 生成多标签数据集</span>
X<span class="token punctuation">,</span> Y <span class="token operator">=</span> make_multilabel_classification<span class="token punctuation">(</span>
    n_samples<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>  <span class="token comment"># 样本数量</span>
    n_features<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span>  <span class="token comment"># 特征数量</span>
    n_classes<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>    <span class="token comment"># 类别数量</span>
    n_labels<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>     <span class="token comment"># 每个样本的平均标签数量</span>
    random_state<span class="token operator">=</span><span class="token number">42</span> <span class="token comment"># 随机种子</span>
<span class="token punctuation">)</span>

<span class="token comment"># 查看生成的数据集形状</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"特征矩阵 X 的形状:"</span><span class="token punctuation">,</span> X<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"标签矩阵 Y 的形状:"</span><span class="token punctuation">,</span> Y<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
</code></pre>
    <p>
     在这个示例中，
     <code>
      n_samples
     </code>
     参数控制生成的样本数量，
     <code>
      n_features
     </code>
     参数控制每个样本的特征数量，
     <code>
      n_classes
     </code>
     参数控制类别的数量，
     <code>
      n_labels
     </code>
     参数控制每个样本的平均标签数量，而
     <code>
      random_state
     </code>
     参数确保每次生成的数据集是相同的。
    </p>
    <p>
     用现实数据集制作多标签数据集(部分标签数据集)方法见
     <a href="https://blog.csdn.net/qq_52810166/article/details/146076028?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=%E5%A6%82%E4%BD%95%E7%94%9F%E6%88%90%E9%83%A8%E5%88%86%E6%A0%87%E7%AD%BE%E6%95%B0%E6%8D%AE%E9%9B%86&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-146076028.142%5Ev102%5Epc_search_result_base4&amp;spm=1018.2226.3001.4187">
      部分标签数据集制作方法
     </a>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f35323831303136362f:61727469636c652f64657461696c732f313436323233363435" class_="artid" style="display:none">
 </p>
</div>


