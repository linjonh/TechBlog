---
layout: post
title: "go的三方包学习"
date: 2025-03-09 16:00:36 +0800
description: "本博文源于博主的学习，内容包含第三方包fasthttp,jsoniterator,gorm,xorm,yaml,toml,excel的学习"
keywords: "go的三方包学习"
categories: ['Go']
tags: ['开发语言', '学习', 'Golang']
artid: "146106450"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146106450
    alt: "go的三方包学习"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146106450
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146106450
cover: https://bing.ee123.net/img/rand?artid=146106450
image: https://bing.ee123.net/img/rand?artid=146106450
img: https://bing.ee123.net/img/rand?artid=146106450
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     go的三方包学习
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-tomorrow-night" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     本博文源于博主的学习，内容包含第三方包fasthttp,jsoniterator,gorm,xorm,yaml,toml,excel的学习
     <br/>
    </p>
    <p>
    </p>
    <h2>
     <a id="fasthttp_2">
     </a>
     fasthttp
    </h2>
    <p>
     为什么比net/http快
    </p>
    <ul>
     <li>
      使用连接池，不再像net/http一样每accept一个请求就分配一个新的goroutine处理请求（在请求量大的时候会有性能问题）
     </li>
     <li>
      对象池化
     </li>
     <li>
      使用[]byte缓冲池，减少内存分配
     </li>
     <li>
      避免[]byte和string之间的转化，[]byte和string和转化会产生内存拷贝，fasthttp实现了无需内存拷贝的转化方法
     </li>
    </ul>
    <h3>
     <a id="1helloserver_10">
     </a>
     例子1：hello,server
    </h3>
    <pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"flag"</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"github.com/valyala/fasthttp"</span>
	<span class="token string">"log"</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> <span class="token punctuation">(</span>
	addr     <span class="token operator">=</span> flag<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token string">"addr"</span><span class="token punctuation">,</span> <span class="token string">":8080"</span><span class="token punctuation">,</span> <span class="token string">"TCP address to listen to"</span><span class="token punctuation">)</span>
	compress <span class="token operator">=</span> flag<span class="token punctuation">.</span><span class="token function">Bool</span><span class="token punctuation">(</span><span class="token string">"compress"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">"whether to enable transparent response compression"</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	flag<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	h <span class="token operator">:=</span> requestHandler
	<span class="token keyword">if</span> <span class="token operator">*</span>compress <span class="token punctuation">{<!-- --></span>
		h <span class="token operator">=</span> fasthttp<span class="token punctuation">.</span><span class="token function">CompressHandler</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> err <span class="token operator">:=</span> fasthttp<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token operator">*</span>addr<span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">"Error in ListenAndServe: %s"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">requestHandler</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>fasthttp<span class="token punctuation">.</span>RequestCtx<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token string">"Hello, world!\n\n"</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token string">"Request method is %q\n"</span><span class="token punctuation">,</span> ctx<span class="token punctuation">.</span><span class="token function">Method</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token string">"RequestURI  is %q\n"</span><span class="token punctuation">,</span> ctx<span class="token punctuation">.</span><span class="token function">RequestURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token string">"Request path is %q\n"</span><span class="token punctuation">,</span> ctx<span class="token punctuation">.</span><span class="token function">Path</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token string">"Host is %q\n"</span><span class="token punctuation">,</span> ctx<span class="token punctuation">.</span><span class="token function">Host</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token string">"Query string is %q\n"</span><span class="token punctuation">,</span> ctx<span class="token punctuation">.</span><span class="token function">QueryArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token string">"User-Agent is  %q\n"</span><span class="token punctuation">,</span> ctx<span class="token punctuation">.</span><span class="token function">UserAgent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token string">"Connectioin has been established at  %s\n"</span><span class="token punctuation">,</span> ctx<span class="token punctuation">.</span><span class="token function">ConnTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token string">"Request has been started at %s \n"</span><span class="token punctuation">,</span> ctx<span class="token punctuation">.</span><span class="token function">Time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token string">"Serial request number for the current cnnection is %d\n"</span><span class="token punctuation">,</span> ctx<span class="token punctuation">.</span><span class="token function">ConnRequestNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token string">"Your ip is %q\n"</span><span class="token punctuation">,</span> ctx<span class="token punctuation">.</span><span class="token function">RemoteIP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token string">"Raw request is:\n---CUT---\n%s\n---CUT---"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>ctx<span class="token punctuation">.</span>Request<span class="token punctuation">)</span>
	ctx<span class="token punctuation">.</span><span class="token function">SetContentType</span><span class="token punctuation">(</span><span class="token string">"text/plain; charset=utf-8"</span><span class="token punctuation">)</span>
	ctx<span class="token punctuation">.</span>Response<span class="token punctuation">.</span>Header<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">"X-My-Header"</span><span class="token punctuation">,</span> <span class="token string">"my-header-value"</span><span class="token punctuation">)</span>
	<span class="token keyword">var</span> c fasthttp<span class="token punctuation">.</span>Cookie
	c<span class="token punctuation">.</span><span class="token function">SetKey</span><span class="token punctuation">(</span><span class="token string">"cookie-name"</span><span class="token punctuation">)</span>
	c<span class="token punctuation">.</span><span class="token function">SetValue</span><span class="token punctuation">(</span><span class="token string">"cookie-value"</span><span class="token punctuation">)</span>
	ctx<span class="token punctuation">.</span>Response<span class="token punctuation">.</span>Header<span class="token punctuation">.</span><span class="token function">SetCookie</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>c<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre>
    <p>
     或者另外一种精简的方式
    </p>
    <pre><code class="prism language-go"><span class="token keyword">func</span> <span class="token function">requestHandler</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>fasthttp<span class="token punctuation">.</span>RequestCtx<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	ctx<span class="token punctuation">.</span><span class="token function">SetStatusCode</span><span class="token punctuation">(</span>fasthttp<span class="token punctuation">.</span>StatusOK<span class="token punctuation">)</span>
	ctx<span class="token punctuation">.</span><span class="token function">SetBodyString</span><span class="token punctuation">(</span><span class="token string">"Hello,FastHTTP"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"http://127.0.0.1:8083"</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">:=</span> fasthttp<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">":8083"</span><span class="token punctuation">,</span> requestHandler<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"Error in ListenAndServe: %s"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
    <p>
     请求路径上的参数
    </p>
    <pre><code class="prism language-go">
<span class="token keyword">func</span> <span class="token function">requestHandler</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>fasthttp<span class="token punctuation">.</span>RequestCtx<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	name <span class="token operator">:=</span> <span class="token function">string</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">QueryArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Peek</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> name <span class="token operator">==</span> <span class="token string">""</span> <span class="token punctuation">{<!-- --></span>
		name <span class="token operator">=</span> <span class="token string">"Guest"</span> <span class="token comment">// 如果没有提供 name 参数，默认使用 "Guest"</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// 设置响应内容</span>
	ctx<span class="token punctuation">.</span><span class="token function">SetStatusCode</span><span class="token punctuation">(</span>fasthttp<span class="token punctuation">.</span>StatusOK<span class="token punctuation">)</span>
	ctx<span class="token punctuation">.</span><span class="token function">SetBodyString</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"Hello %s"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"http://127.0.0.1:8084?name=zhangsan"</span><span class="token punctuation">)</span>
	handler <span class="token operator">:=</span> fasthttp<span class="token punctuation">.</span><span class="token function">RequestHandler</span><span class="token punctuation">(</span>requestHandler<span class="token punctuation">)</span>
	err <span class="token operator">:=</span> fasthttp<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">":8084"</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"Error in ListenAndServe: %s"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
    <p>
     处理json请求和响应，建议用postman进行认证
    </p>
    <pre><code class="prism language-go"><span class="token keyword">type</span> Message <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	Name    <span class="token builtin">string</span> <span class="token string">`json:"name"`</span>
	Message <span class="token builtin">string</span> <span class="token string">`json:"message"`</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">requestHandler</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>fasthttp<span class="token punctuation">.</span>RequestCtx<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token function">string</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">Method</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"POST"</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">var</span> msg Message
		<span class="token keyword">if</span> err <span class="token operator">:=</span> json<span class="token punctuation">.</span><span class="token function">Unmarshal</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">PostBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
			ctx<span class="token punctuation">.</span><span class="token function">SetStatusCode</span><span class="token punctuation">(</span>fasthttp<span class="token punctuation">.</span>StatusBadRequest<span class="token punctuation">)</span>
			ctx<span class="token punctuation">.</span><span class="token function">SetBodyString</span><span class="token punctuation">(</span><span class="token string">"Invalid JSON"</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span>
		<span class="token punctuation">}</span>

		response <span class="token operator">:=</span> Message<span class="token punctuation">{<!-- --></span>
			Name<span class="token punctuation">:</span>    msg<span class="token punctuation">.</span>Name<span class="token punctuation">,</span>
			Message<span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">"Hello %s,Your message was :%s"</span><span class="token punctuation">,</span> msg<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> msg<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>
		ctx<span class="token punctuation">.</span><span class="token function">SetContentType</span><span class="token punctuation">(</span><span class="token string">"application/json"</span><span class="token punctuation">)</span>
		responseJSON<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> json<span class="token punctuation">.</span><span class="token function">Marshal</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span>
		ctx<span class="token punctuation">.</span><span class="token function">SetStatusCode</span><span class="token punctuation">(</span>fasthttp<span class="token punctuation">.</span>StatusOK<span class="token punctuation">)</span>
		ctx<span class="token punctuation">.</span><span class="token function">SetBody</span><span class="token punctuation">(</span>responseJSON<span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
		ctx<span class="token punctuation">.</span><span class="token function">SetStatusCode</span><span class="token punctuation">(</span>fasthttp<span class="token punctuation">.</span>StatusMethodNotAllowed<span class="token punctuation">)</span>
		ctx<span class="token punctuation">.</span><span class="token function">SetBodyString</span><span class="token punctuation">(</span><span class="token string">"Method Not Allowed"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     采用中间件
    </p>
    <pre><code class="prism language-go"><span class="token keyword">func</span> <span class="token function">logRequest</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>fasthttp<span class="token punctuation">.</span>RequestCtx<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	startTime <span class="token operator">:=</span> time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token function">requestHandler</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
	duration <span class="token operator">:=</span> time<span class="token punctuation">.</span><span class="token function">Since</span><span class="token punctuation">(</span>startTime<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"Request %s %s took %v\n"</span><span class="token punctuation">,</span> ctx<span class="token punctuation">.</span><span class="token function">Method</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ctx<span class="token punctuation">.</span><span class="token function">RequestURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> duration<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">requestHandler</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>fasthttp<span class="token punctuation">.</span>RequestCtx<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	ctx<span class="token punctuation">.</span><span class="token function">SetStatusCode</span><span class="token punctuation">(</span>fasthttp<span class="token punctuation">.</span>StatusOK<span class="token punctuation">)</span>
	ctx<span class="token punctuation">.</span><span class="token function">SetBodyString</span><span class="token punctuation">(</span><span class="token string">"hello, fasthttp with middleware!"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	handler <span class="token operator">:=</span> fasthttp<span class="token punctuation">.</span><span class="token function">RequestHandler</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>fasthttp<span class="token punctuation">.</span>RequestCtx<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token function">logRequest</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"http://127.0.0.1:8085/"</span><span class="token punctuation">)</span>
	err <span class="token operator">:=</span> fasthttp<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">":8085"</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"Error starting server: %s\n"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     文件服务器
    </p>
    <pre><code class="prism language-go"><span class="token keyword">func</span> <span class="token function">requestHandler</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>fasthttp<span class="token punctuation">.</span>RequestCtx<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	filePath <span class="token operator">:=</span> filepath<span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span><span class="token string">"E:"</span><span class="token punctuation">,</span> <span class="token function">string</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">Path</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	fasthttp<span class="token punctuation">.</span><span class="token function">ServeFile</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> filePath<span class="token punctuation">)</span>
	ctx<span class="token punctuation">.</span><span class="token function">SetStatusCode</span><span class="token punctuation">(</span>fasthttp<span class="token punctuation">.</span>StatusOK<span class="token punctuation">)</span>

<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"http://127.0.0.1:8086/b.txt"</span><span class="token punctuation">)</span>
	err <span class="token operator">:=</span> fasthttp<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">":8086"</span><span class="token punctuation">,</span> requestHandler<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"Error starting server:%s\n"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
    <h2>
     <a id="jsoniterator_179">
     </a>
     json-iterator
    </h2>
    <pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"github.com/json-iterator/go"</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> UserInfo <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	Id  <span class="token builtin">int</span> <span class="token string">`json:"id"`</span>
	Age <span class="token builtin">int</span> <span class="token string">`json:"age"`</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">//js := jsoniter.ConfigCompatibleWithStandardLibrary</span>
	<span class="token comment">//user := UserInfo{Id: 1, Age: 10}</span>
	<span class="token comment">//marshal, err := js.Marshal(&amp;user)</span>
	<span class="token comment">//if err != nil {<!-- --></span>
	<span class="token comment">//	fmt.Println(err)</span>
	<span class="token comment">//}</span>
	<span class="token comment">//fmt.Println(string(marshal))</span>
	js <span class="token operator">:=</span> jsoniter<span class="token punctuation">.</span>ConfigCompatibleWithStandardLibrary
	s <span class="token operator">:=</span> <span class="token string">`{"Id":110,"Age":20}`</span>
	<span class="token keyword">var</span> user UserInfo
	err <span class="token operator">:=</span> js<span class="token punctuation">.</span><span class="token function">Unmarshal</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>user<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre>
    <h2>
     <a id="gorm_214">
     </a>
     gorm
    </h2>
    <p>
     gorm的增删查改、事务、聚合查询
    </p>
    <pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"gorm.io/driver/mysql"</span>
	<span class="token string">"gorm.io/gorm"</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> db <span class="token operator">*</span>gorm<span class="token punctuation">.</span>DB
<span class="token keyword">var</span> err <span class="token builtin">error</span>

<span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	ID   <span class="token builtin">uint</span>   <span class="token string">`gorm:"primarykey"`</span>
	Name <span class="token builtin">string</span> <span class="token string">`gorm:"size:100;not null"`</span>
	Age  <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	dsn <span class="token operator">:=</span> <span class="token string">"ad:123456@tcp(127.0.0.1:3306)/goGateWay?charset=utf8"</span>
	db<span class="token punctuation">,</span> err <span class="token operator">=</span> gorm<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span>mysql<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span>dsn<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>gorm<span class="token punctuation">.</span>Config<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"数据库连接失败"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//迁移数据库</span>
	err <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">AutoMigrate</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>User<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"数据库迁移失败"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//插入数据库</span>
	user <span class="token operator">:=</span> User<span class="token punctuation">{<!-- --></span>Name<span class="token punctuation">:</span> <span class="token string">"John Deo"</span><span class="token punctuation">,</span> Age<span class="token punctuation">:</span> <span class="token number">15</span><span class="token punctuation">}</span>
	result <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span>
	<span class="token keyword">if</span> result<span class="token punctuation">.</span>Error <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"插入数据库失败"</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	users <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>User<span class="token punctuation">{<!-- --></span>
		<span class="token punctuation">{<!-- --></span>Name<span class="token punctuation">:</span> <span class="token string">"Alice"</span><span class="token punctuation">,</span> Age<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{<!-- --></span>Name<span class="token punctuation">:</span> <span class="token string">"Jane"</span><span class="token punctuation">,</span> Age<span class="token punctuation">:</span> <span class="token number">16</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{<!-- --></span>Name<span class="token punctuation">:</span> <span class="token string">"Alex"</span><span class="token punctuation">,</span> Age<span class="token punctuation">:</span> <span class="token number">26</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{<!-- --></span>Name<span class="token punctuation">:</span> <span class="token string">"WuYiFan"</span><span class="token punctuation">,</span> Age<span class="token punctuation">:</span> <span class="token number">56</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	result <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>users<span class="token punctuation">)</span>
	<span class="token keyword">if</span> result<span class="token punctuation">.</span>Error <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"插入数据库失败"</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"成功插入数据库"</span><span class="token punctuation">,</span> user<span class="token punctuation">)</span>
	<span class="token comment">//查询数据</span>
	<span class="token keyword">var</span> queryUser User
	result <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>queryUser<span class="token punctuation">,</span> <span class="token string">"name = ?"</span><span class="token punctuation">,</span> <span class="token string">"Alice"</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> result<span class="token punctuation">.</span>Error <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"查询失败"</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//查询多个记录</span>
	<span class="token keyword">var</span> queryUsers <span class="token punctuation">[</span><span class="token punctuation">]</span>User
	result <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>queryUsers<span class="token punctuation">)</span>
	<span class="token keyword">if</span> result<span class="token punctuation">.</span>Error <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"查询失败"</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"查询到所有数据"</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> user <span class="token operator">:=</span> <span class="token keyword">range</span> queryUsers <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"id:"</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">"name"</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token string">"age"</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span>Age<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//更新数据</span>
	queryUser<span class="token punctuation">.</span>Age <span class="token operator">=</span> <span class="token number">24</span>
	result <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>queryUser<span class="token punctuation">)</span>
	<span class="token keyword">if</span> result<span class="token punctuation">.</span>Error <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"更新失败..."</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"成功更新用户"</span><span class="token punctuation">,</span> queryUser<span class="token punctuation">)</span>
	tx <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>User<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">"age = ?"</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> tx<span class="token punctuation">.</span>Error <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"删除失败:"</span><span class="token punctuation">,</span> tx<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"删除用户成功..."</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">///开启事务1</span>
	dsn <span class="token operator">:=</span> <span class="token string">"ad:123456@tcp(127.0.0.1:3306)/goGateWay?charset=utf8"</span>
	db<span class="token punctuation">,</span> err <span class="token operator">=</span> gorm<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span>mysql<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span>dsn<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>gorm<span class="token punctuation">.</span>Config<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"数据库连接失败"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	tx <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	user <span class="token operator">:=</span> User<span class="token punctuation">{<!-- --></span>Name<span class="token punctuation">:</span> <span class="token string">"Leo"</span><span class="token punctuation">,</span> Age<span class="token punctuation">:</span> <span class="token number">15</span><span class="token punctuation">}</span>
	<span class="token keyword">if</span> err <span class="token operator">:=</span> tx<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span><span class="token punctuation">.</span>Error<span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		tx<span class="token punctuation">.</span><span class="token function">Rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"插入用户1失败"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	user2 <span class="token operator">:=</span> User<span class="token punctuation">{<!-- --></span>Name<span class="token punctuation">:</span> <span class="token string">"Amy"</span><span class="token punctuation">,</span> Age<span class="token punctuation">:</span> <span class="token number">43</span><span class="token punctuation">}</span>
	<span class="token keyword">if</span> err <span class="token operator">:=</span> tx<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user2<span class="token punctuation">)</span><span class="token punctuation">.</span>Error<span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		tx<span class="token punctuation">.</span><span class="token function">Rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"插入用户2失败"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	tx<span class="token punctuation">.</span><span class="token function">Commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"事务成功，插入两个用户"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	dsn <span class="token operator">:=</span> <span class="token string">"ad:123456@tcp(127.0.0.1:3306)/goGateWay?charset=utf8"</span>
	db<span class="token punctuation">,</span> err <span class="token operator">=</span> gorm<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span>mysql<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span>dsn<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>gorm<span class="token punctuation">.</span>Config<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token keyword">var</span> avgAge <span class="token builtin">float64</span>
	result <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>User<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span><span class="token string">"avg(age)"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Scan</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>avgAge<span class="token punctuation">)</span>
	<span class="token keyword">if</span> result<span class="token punctuation">.</span>Error <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"查询失败"</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"平均年龄:"</span><span class="token punctuation">,</span> avgAge<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre>
    <h2>
     <a id="xorm_338">
     </a>
     xorm
    </h2>
    <h3>
     <a id="_339">
     </a>
     映射数据库
    </h3>
    <pre><code class="prism language-go">	dsn <span class="token operator">:=</span> <span class="token string">"ad:123456@tcp(127.0.0.1:3306)/goGateWay?charset=utf8"</span>
	<span class="token keyword">var</span> err <span class="token builtin">error</span>
	engine<span class="token punctuation">,</span> err <span class="token operator">=</span> xorm<span class="token punctuation">.</span><span class="token function">NewEngine</span><span class="token punctuation">(</span><span class="token string">"mysql"</span><span class="token punctuation">,</span> dsn<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	engine<span class="token punctuation">.</span><span class="token function">ShowSQL</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>

</code></pre>
    <h3>
     <a id="_352">
     </a>
     迁移数据表
    </h3>
    <pre><code class="prism language-go">	err <span class="token operator">=</span> engine<span class="token punctuation">.</span><span class="token function">Sync2</span><span class="token punctuation">(</span><span class="token function">new</span><span class="token punctuation">(</span>User<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span><span class="token string">"表创建关联: %v"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"表创建成功"</span><span class="token punctuation">)</span>
	
</code></pre>
    <h3>
     <a id="_363">
     </a>
     创建记录
    </h3>
    <pre><code class="prism language-go">	user <span class="token operator">:=</span> <span class="token operator">&amp;</span>User<span class="token punctuation">{<!-- --></span>Name<span class="token punctuation">:</span> <span class="token string">"John"</span><span class="token punctuation">,</span> Age<span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">}</span>
	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> engine<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span><span class="token string">"插入失败"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"插入成功:"</span><span class="token punctuation">,</span> user<span class="token punctuation">)</span>
</code></pre>
    <h3>
     <a id="_374">
     </a>
     查询记录
    </h3>
    <pre><code class="prism language-go">user <span class="token operator">:=</span> User<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
	has<span class="token punctuation">,</span> err <span class="token operator">:=</span> engine<span class="token punctuation">.</span><span class="token function">ID</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span><span class="token string">"查询失败:%v"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> has <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"查询到用户"</span><span class="token punctuation">,</span> user<span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"没有找到该用户"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	users <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>User<span class="token punctuation">{<!-- --></span>
		<span class="token punctuation">{<!-- --></span>Name<span class="token punctuation">:</span> <span class="token string">"Alice"</span><span class="token punctuation">,</span> Age<span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{<!-- --></span>Name<span class="token punctuation">:</span> <span class="token string">"Amy"</span><span class="token punctuation">,</span> Age<span class="token punctuation">:</span> <span class="token number">48</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{<!-- --></span>Name<span class="token punctuation">:</span> <span class="token string">"Alex"</span><span class="token punctuation">,</span> Age<span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> engine<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"insert success"</span><span class="token punctuation">)</span>
</code></pre>
    <h3>
     <a id="_398">
     </a>
     查询所有记录
    </h3>
    <pre><code class="prism language-go"><span class="token keyword">var</span> users <span class="token punctuation">[</span><span class="token punctuation">]</span>User
	err <span class="token operator">=</span> engine<span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>users<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> user <span class="token operator">:=</span> <span class="token keyword">range</span> users <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="_411">
     </a>
     更新记录
    </h3>
    <pre><code class="prism language-go">user <span class="token operator">:=</span> User<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
	has<span class="token punctuation">,</span> err <span class="token operator">:=</span> engine<span class="token punctuation">.</span><span class="token function">ID</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> has <span class="token punctuation">{<!-- --></span>
		user<span class="token punctuation">.</span>Age <span class="token operator">=</span> <span class="token number">77</span>
		<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> engine<span class="token punctuation">.</span><span class="token function">ID</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
			log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span><span class="token string">"更新失败"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"成功更新用户:"</span><span class="token punctuation">,</span> user<span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"未找到该用户"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="_431">
     </a>
     删除记录
    </h3>
    <pre><code class="prism language-go">user <span class="token operator">:=</span> User<span class="token punctuation">{<!-- --></span>ID<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span>
	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> engine<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span><span class="token string">"删除失败:"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"成功删除用户"</span><span class="token punctuation">)</span>
</code></pre>
    <h3>
     <a id="_442">
     </a>
     聚合查询
    </h3>
    <pre><code class="prism language-go"><span class="token keyword">var</span> result <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
		Average <span class="token builtin">float64</span> <span class="token string">`xorm:"avg(age)"`</span>
	<span class="token punctuation">}</span>
	has<span class="token punctuation">,</span> err <span class="token operator">:=</span> engine<span class="token punctuation">.</span><span class="token function">Table</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span><span class="token string">"avg(age)"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>result<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> has <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>Average<span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"没有数据"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="_459">
     </a>
     事务
    </h3>
    <pre><code class="prism language-go">session <span class="token operator">:=</span> engine<span class="token punctuation">.</span><span class="token function">NewSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">defer</span> session<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token comment">//开始事务</span>
	err <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">Begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span><span class="token string">"事务开始失败"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	user1 <span class="token operator">:=</span> User<span class="token punctuation">{<!-- --></span>Name<span class="token punctuation">:</span> <span class="token string">"Mini"</span><span class="token punctuation">,</span> Age<span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">}</span>
	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user1<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		session<span class="token punctuation">.</span><span class="token function">Rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span><span class="token string">"插入用户失败"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	user2 <span class="token operator">:=</span> User<span class="token punctuation">{<!-- --></span>Name<span class="token punctuation">:</span> <span class="token string">"Bob"</span><span class="token punctuation">,</span> Age<span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">}</span>
	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user2<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		session<span class="token punctuation">.</span><span class="token function">Rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span><span class="token string">"插入用户失败"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	err <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">Commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"事务成功，插入两个用户"</span><span class="token punctuation">)</span>
</code></pre>
    <h2>
     <a id="yaml_488">
     </a>
     yaml
    </h2>
    <h3>
     <a id="unmarshal_marshal_489">
     </a>
     unmarshal 与marshal
    </h3>
    <p>
     文件example.yaml
    </p>
    <pre><code class="prism language-go">a<span class="token punctuation">:</span> Easy<span class="token operator">!</span>
b<span class="token punctuation">:</span>
  c<span class="token punctuation">:</span> <span class="token number">2</span>
  d<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
</code></pre>
    <pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"gopkg.in/yaml.v3"</span>
	<span class="token string">"io/ioutil"</span>
	<span class="token string">"log"</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token string">`
a: Easy!
b:
  c: 2
  d: [3, 4]
`</span>

<span class="token keyword">type</span> T <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	A <span class="token builtin">string</span>
	B <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
		RenamedC <span class="token builtin">int</span>   <span class="token string">`yaml:"c"`</span>
		D        <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span> <span class="token string">`yaml:",flow"`</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">//将文件映射到结构体中</span>
	t <span class="token operator">:=</span> T<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>

	data<span class="token punctuation">,</span> err <span class="token operator">:=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadFile</span><span class="token punctuation">(</span><span class="token string">"./example.yaml"</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	err <span class="token operator">=</span> yaml<span class="token punctuation">.</span><span class="token function">Unmarshal</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>t<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"将文件进行解析成结构体变量"</span><span class="token punctuation">,</span> t<span class="token punctuation">.</span>A<span class="token punctuation">,</span> t<span class="token punctuation">.</span>B<span class="token punctuation">)</span>
	m <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token keyword">interface</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	err <span class="token operator">=</span> yaml<span class="token punctuation">.</span><span class="token function">Unmarshal</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>m<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">"error:%v"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"----m:\n%v\n\n"</span><span class="token punctuation">,</span> m<span class="token punctuation">)</span>

	d<span class="token punctuation">,</span> err <span class="token operator">:=</span> yaml<span class="token punctuation">.</span><span class="token function">Marshal</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>t<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">"error:%v"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"---------t dump:\n%s\n\n"</span><span class="token punctuation">,</span> <span class="token function">string</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span>
	d<span class="token punctuation">,</span> err <span class="token operator">=</span> yaml<span class="token punctuation">.</span><span class="token function">Marshal</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>m<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">"error:%v"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"---------t dump:\n%s\n\n"</span><span class="token punctuation">,</span> <span class="token function">string</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre>
    <h2>
     <a id="toml_558">
     </a>
     toml
    </h2>
    <h3>
     <a id="_559">
     </a>
     文件映射到结构体
    </h3>
    <p>
     变量映射
    </p>
    <pre><code class="prism language-go">	doc <span class="token operator">:=</span> <span class="token string">`
	version = 2
	name = "go-toml"
	tags = ["tag1", "tag2"]
	`</span>
	<span class="token keyword">var</span> conf MyConfig
	err <span class="token operator">:=</span> toml<span class="token punctuation">.</span><span class="token function">Unmarshal</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>doc<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>conf<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		<span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>conf<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> conf<span class="token punctuation">.</span>Tags<span class="token punctuation">,</span> conf<span class="token punctuation">.</span>Version<span class="token punctuation">)</span>
</code></pre>
    <p>
     文件里读取
    </p>
    <pre><code class="prism language-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	file<span class="token punctuation">,</span> err <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token string">"./abc.toml"</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">defer</span> file<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	fileContent<span class="token punctuation">,</span> err <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">ReadFile</span><span class="token punctuation">(</span><span class="token string">"./abc.toml"</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">var</span> conf MyConfig
	err <span class="token operator">=</span> toml<span class="token punctuation">.</span><span class="token function">Unmarshal</span><span class="token punctuation">(</span>fileContent<span class="token punctuation">,</span> <span class="token operator">&amp;</span>conf<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>conf<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> conf<span class="token punctuation">.</span>Tags<span class="token punctuation">,</span> conf<span class="token punctuation">.</span>Version<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="toml_596">
     </a>
     结构体映射到toml里
    </h3>
    <pre><code class="prism language-go">cfg <span class="token operator">:=</span> MyConfig<span class="token punctuation">{<!-- --></span>
		Version<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
		Name<span class="token punctuation">:</span>    <span class="token string">"test"</span><span class="token punctuation">,</span>
		Tags<span class="token punctuation">:</span>    <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{<!-- --></span><span class="token string">"go"</span><span class="token punctuation">,</span> <span class="token string">"toml"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	b<span class="token punctuation">,</span> err <span class="token operator">:=</span> toml<span class="token punctuation">.</span><span class="token function">Marshal</span><span class="token punctuation">(</span>cfg<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		<span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">string</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     另一种方式进行映射
    </p>
    <pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"github.com/BurntSushi/toml"</span>
	<span class="token string">"log"</span>
	<span class="token string">"os"</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> Config <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	Title <span class="token builtin">string</span>
	Owner <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
		Name <span class="token builtin">string</span>
		Org  <span class="token builtin">string</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	config <span class="token operator">:=</span> Config<span class="token punctuation">{<!-- --></span>
		Title<span class="token punctuation">:</span> <span class="token string">"Example Config"</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	config<span class="token punctuation">.</span>Owner<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">"Alex"</span>
	config<span class="token punctuation">.</span>Owner<span class="token punctuation">.</span>Org <span class="token operator">=</span> <span class="token string">"GoLang"</span>

	file<span class="token punctuation">,</span> err <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token string">"./config.toml"</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">defer</span> file<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	err <span class="token operator">=</span> toml<span class="token punctuation">.</span><span class="token function">NewEncoder</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Encode</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Created config file."</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre>
    <h3>
     <a id="_650">
     </a>
     嵌套结构体映射
    </h3>
    <p>
     abc.toml文件
    </p>
    <pre><code class="prism language-go"><span class="token punctuation">[</span>owner<span class="token punctuation">]</span>
name <span class="token operator">=</span> <span class="token string">"Tom Preston-Werner"</span>
dob <span class="token operator">=</span> <span class="token number">1979</span><span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span>27T07<span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">:</span>00Z

<span class="token punctuation">[</span>database<span class="token punctuation">]</span>
server <span class="token operator">=</span> <span class="token string">"192.168.1.1"</span>
ports <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">8001</span><span class="token punctuation">,</span> <span class="token number">8002</span><span class="token punctuation">]</span>
Connectionmax <span class="token operator">=</span> <span class="token number">5000</span>
enabled <span class="token operator">=</span> <span class="token boolean">true</span>

</code></pre>
    <pre><code class="prism language-go"><span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"github.com/BurntSushi/toml"</span>
	<span class="token string">"log"</span>
	<span class="token string">"time"</span>
<span class="token punctuation">)</span>


<span class="token keyword">type</span> Owner <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	Name <span class="token builtin">string</span>
	Dob  time<span class="token punctuation">.</span>Time
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Database <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	Server        <span class="token builtin">string</span>
	Ports         <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span>
	ConnectionMax <span class="token builtin">int</span>
	Enabled       <span class="token builtin">bool</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Config <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	Owner    Owner
	Database Database
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">var</span> config Config
	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> toml<span class="token punctuation">.</span><span class="token function">DecodeFile</span><span class="token punctuation">(</span><span class="token string">"./abc.toml"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>config<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"Owner:%s,Date of Birth:%v\n"</span><span class="token punctuation">,</span> config<span class="token punctuation">.</span>Owner<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> config<span class="token punctuation">.</span>Owner<span class="token punctuation">.</span>Dob<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"Database:%v\n"</span><span class="token punctuation">,</span> config<span class="token punctuation">.</span>Database<span class="token punctuation">.</span>Server<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"Ports:%v\n"</span><span class="token punctuation">,</span> config<span class="token punctuation">.</span>Database<span class="token punctuation">.</span>Ports<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"Max Connections:%d\n"</span><span class="token punctuation">,</span> config<span class="token punctuation">.</span>Database<span class="token punctuation">.</span>ConnectionMax<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"Database Enabled:%v\n"</span><span class="token punctuation">,</span> config<span class="token punctuation">.</span>Database<span class="token punctuation">.</span>Enabled<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre>
    <p>
     嵌套版本
    </p>
    <pre><code class="prism language-go"><span class="token punctuation">[</span>server<span class="token punctuation">]</span>
name <span class="token operator">=</span> <span class="token string">"My Server"</span>
enabled <span class="token operator">=</span> <span class="token boolean">true</span>
address <span class="token operator">=</span> <span class="token string">"127.0.0.1"</span>

<span class="token punctuation">[</span>server<span class="token punctuation">.</span>ports<span class="token punctuation">]</span>
http <span class="token operator">=</span> <span class="token number">80</span>
https <span class="token operator">=</span> <span class="token number">443</span>

<span class="token punctuation">[</span>logging<span class="token punctuation">]</span>
level <span class="token operator">=</span> <span class="token string">"debug"</span>
files <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"app.log"</span><span class="token punctuation">,</span> <span class="token string">"error.log"</span><span class="token punctuation">]</span>

<span class="token punctuation">[</span><span class="token punctuation">[</span>databases<span class="token punctuation">]</span><span class="token punctuation">]</span>
name <span class="token operator">=</span> <span class="token string">"db1"</span>
enabled <span class="token operator">=</span> <span class="token boolean">true</span>
host <span class="token operator">=</span> <span class="token string">"192.168.0.2"</span>

<span class="token punctuation">[</span><span class="token punctuation">[</span>databases<span class="token punctuation">]</span><span class="token punctuation">]</span>
name <span class="token operator">=</span> <span class="token string">"db2"</span>
enabled <span class="token operator">=</span> <span class="token boolean">false</span>
host <span class="token operator">=</span> <span class="token string">"192.168.0.3"</span>

</code></pre>
    <p>
     编写的代码
    </p>
    <pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"github.com/BurntSushi/toml"</span>
	<span class="token string">"log"</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> Server <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	Name    <span class="token builtin">string</span>
	Enabled <span class="token builtin">bool</span>
	Address <span class="token builtin">string</span>
	Ports   <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Logging <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	Level <span class="token builtin">string</span>
	Files <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Database <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	Name    <span class="token builtin">string</span>
	Enabled <span class="token builtin">bool</span>
	Host    <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Config <span class="token keyword">struct</span> <span class="token punctuation">{<!-- --></span>
	Server    Server
	Logging   Logging
	Databases <span class="token punctuation">[</span><span class="token punctuation">]</span>Database
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">var</span> config Config
	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> toml<span class="token punctuation">.</span><span class="token function">DecodeFile</span><span class="token punctuation">(</span><span class="token string">"./abc.toml"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>config<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"Server Name:%s\n"</span><span class="token punctuation">,</span> config<span class="token punctuation">.</span>Server<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"Server Enabled:%v\n"</span><span class="token punctuation">,</span> config<span class="token punctuation">.</span>Server<span class="token punctuation">.</span>Enabled<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"Server Address:%s\n"</span><span class="token punctuation">,</span> config<span class="token punctuation">.</span>Server<span class="token punctuation">.</span>Address<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"Server Ports:%v\n"</span><span class="token punctuation">,</span> config<span class="token punctuation">.</span>Server<span class="token punctuation">.</span>Ports<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"Server Level:%s\n"</span><span class="token punctuation">,</span> config<span class="token punctuation">.</span>Logging<span class="token punctuation">.</span>Level<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"Logging Files:%v\n"</span><span class="token punctuation">,</span> config<span class="token punctuation">.</span>Logging<span class="token punctuation">.</span>Files<span class="token punctuation">)</span>

	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> db <span class="token operator">:=</span> <span class="token keyword">range</span> config<span class="token punctuation">.</span>Databases <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"Database Name:%s,Enabled:%v,Host:%s\n"</span><span class="token punctuation">,</span> db<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> db<span class="token punctuation">.</span>Enabled<span class="token punctuation">,</span> db<span class="token punctuation">.</span>Host<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
    <h2>
     <a id="excel_788">
     </a>
     excel
    </h2>
    <h3>
     <a id="excel_789">
     </a>
     某个单元格写入内容，保存成excel
    </h3>
    <pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"github.com/xuri/excelize/v2"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">//将文件映射到结构体中</span>
	f <span class="token operator">:=</span> excelize<span class="token punctuation">.</span><span class="token function">NewFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> err <span class="token operator">:=</span> f<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	index<span class="token punctuation">,</span> err <span class="token operator">:=</span> f<span class="token punctuation">.</span><span class="token function">NewSheet</span><span class="token punctuation">(</span><span class="token string">"Sheet1"</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	f<span class="token punctuation">.</span><span class="token function">SetCellValue</span><span class="token punctuation">(</span><span class="token string">"Sheet1"</span><span class="token punctuation">,</span> <span class="token string">"A2"</span><span class="token punctuation">,</span> <span class="token string">"Hello World"</span><span class="token punctuation">)</span>
	f<span class="token punctuation">.</span><span class="token function">SetCellValue</span><span class="token punctuation">(</span><span class="token string">"Sheet1"</span><span class="token punctuation">,</span> <span class="token string">"B2"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
	f<span class="token punctuation">.</span><span class="token function">SetActiveSheet</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">:=</span> f<span class="token punctuation">.</span><span class="token function">SaveAs</span><span class="token punctuation">(</span><span class="token string">"Book1.xlsx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre>
    <h3>
     <a id="excel_822">
     </a>
     从excel读取数据
    </h3>
    <pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"github.com/xuri/excelize/v2"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	f<span class="token punctuation">,</span> err <span class="token operator">:=</span> excelize<span class="token punctuation">.</span><span class="token function">OpenFile</span><span class="token punctuation">(</span><span class="token string">"./Book1.xlsx"</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> err <span class="token operator">:=</span> f<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	cell<span class="token punctuation">,</span> err <span class="token operator">:=</span> f<span class="token punctuation">.</span><span class="token function">GetCellValue</span><span class="token punctuation">(</span><span class="token string">"Sheet1"</span><span class="token punctuation">,</span> <span class="token string">"B2"</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>cell<span class="token punctuation">)</span>
	rows<span class="token punctuation">,</span> err <span class="token operator">:=</span> f<span class="token punctuation">.</span><span class="token function">GetRows</span><span class="token punctuation">(</span><span class="token string">"Sheet1"</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> row <span class="token operator">:=</span> <span class="token keyword">range</span> rows <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> colCell <span class="token operator">:=</span> <span class="token keyword">range</span> row <span class="token punctuation">{<!-- --></span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>colCell<span class="token punctuation">,</span> <span class="token string">"\t"</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre>
    <h3>
     <a id="excel_864">
     </a>
     用代码绘制excel表格
    </h3>
    <pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"github.com/xuri/excelize/v2"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	f <span class="token operator">:=</span> excelize<span class="token punctuation">.</span><span class="token function">NewFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> err <span class="token operator">:=</span> f<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> idx<span class="token punctuation">,</span> row <span class="token operator">:=</span> <span class="token keyword">range</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">{<!-- --></span>
		<span class="token punctuation">{<!-- --></span><span class="token boolean">nil</span><span class="token punctuation">,</span> <span class="token string">"Apple"</span><span class="token punctuation">,</span> <span class="token string">"Orange"</span><span class="token punctuation">,</span> <span class="token string">"Pear"</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token string">"Small"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{<!-- --></span><span class="token string">"Normal"</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token string">"Large"</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span> <span class="token punctuation">{<!-- --></span>
		cell<span class="token punctuation">,</span> err <span class="token operator">:=</span> excelize<span class="token punctuation">.</span><span class="token function">CoordinatesToCellName</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> idx<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
			<span class="token keyword">return</span>
		<span class="token punctuation">}</span>
		f<span class="token punctuation">.</span><span class="token function">SetSheetRow</span><span class="token punctuation">(</span><span class="token string">"Sheet1"</span><span class="token punctuation">,</span> cell<span class="token punctuation">,</span> <span class="token operator">&amp;</span>row<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> err <span class="token operator">:=</span> f<span class="token punctuation">.</span><span class="token function">AddChart</span><span class="token punctuation">(</span><span class="token string">"Sheet1"</span><span class="token punctuation">,</span> <span class="token string">"E1"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>excelize<span class="token punctuation">.</span>Chart<span class="token punctuation">{<!-- --></span>
		Type<span class="token punctuation">:</span> excelize<span class="token punctuation">.</span>Col3DClustered<span class="token punctuation">,</span>
		Series<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>excelize<span class="token punctuation">.</span>ChartSeries<span class="token punctuation">{<!-- --></span>
			<span class="token punctuation">{<!-- --></span>
				Name<span class="token punctuation">:</span>       <span class="token string">"Sheet1!$A$2"</span><span class="token punctuation">,</span>
				Categories<span class="token punctuation">:</span> <span class="token string">"Sheet1!$B$1:$D$1"</span><span class="token punctuation">,</span>
				Values<span class="token punctuation">:</span>     <span class="token string">"Sheet1!$B$2:$D$2"</span><span class="token punctuation">,</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token punctuation">{<!-- --></span>
				Name<span class="token punctuation">:</span>       <span class="token string">"Sheet1!$A$3"</span><span class="token punctuation">,</span>
				Categories<span class="token punctuation">:</span> <span class="token string">"Sheet1!$B$1:$D$1"</span><span class="token punctuation">,</span>
				Values<span class="token punctuation">:</span>     <span class="token string">"Sheet1!$B$3:$D$3"</span><span class="token punctuation">,</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token punctuation">{<!-- --></span>
				Name<span class="token punctuation">:</span>       <span class="token string">"Sheet1!$A$4"</span><span class="token punctuation">,</span>
				Categories<span class="token punctuation">:</span> <span class="token string">"Sheet1!$B$1:$D$1"</span><span class="token punctuation">,</span>
				Values<span class="token punctuation">:</span>     <span class="token string">"Sheet1!$B$4:$D$4"</span><span class="token punctuation">,</span>
			<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		Title<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>excelize<span class="token punctuation">.</span>RichTextRun<span class="token punctuation">{<!-- --></span>
			<span class="token punctuation">{<!-- --></span>
				Text<span class="token punctuation">:</span> <span class="token string">"Fruit 3D Clustered Column Chart"</span><span class="token punctuation">,</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> err <span class="token operator">:=</span> f<span class="token punctuation">.</span><span class="token function">SaveAs</span><span class="token punctuation">(</span><span class="token string">"Book2.xlsx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
    <h3>
     <a id="excelsheet_925">
     </a>
     遍历一个excel的多个sheet
    </h3>
    <pre><code class="prism language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"github.com/xuri/excelize/v2"</span>
	<span class="token string">"log"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	f<span class="token punctuation">,</span> err <span class="token operator">:=</span> excelize<span class="token punctuation">.</span><span class="token function">OpenFile</span><span class="token punctuation">(</span><span class="token string">"./book3.xlsx"</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	sheets <span class="token operator">:=</span> f<span class="token punctuation">.</span><span class="token function">GetSheetList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> sheet <span class="token operator">:=</span> <span class="token keyword">range</span> sheets <span class="token punctuation">{<!-- --></span>
		log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"Reading data from sheet:%s"</span><span class="token punctuation">,</span> sheet<span class="token punctuation">)</span>
		rows<span class="token punctuation">,</span> err <span class="token operator">:=</span> f<span class="token punctuation">.</span><span class="token function">GetRows</span><span class="token punctuation">(</span>sheet<span class="token punctuation">)</span>
		<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{<!-- --></span>
			log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> row <span class="token operator">:=</span> <span class="token keyword">range</span> rows <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> cell <span class="token operator">:=</span> <span class="token keyword">range</span> row <span class="token punctuation">{<!-- --></span>
				log<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span>cell<span class="token punctuation">,</span> <span class="token string">"\t"</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
			log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f33373134393036322f:61727469636c652f64657461696c732f313436313036343530" class_="artid" style="display:none">
 </p>
</div>


