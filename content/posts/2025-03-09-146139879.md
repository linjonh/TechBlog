---
layout: post
title: "Godot4.4浅尝Godot中的MVC"
date: 2025-03-09 22:15:44 +0800
description: "基于一个Unity的视频。学习了一下基本的MVC概念，并尝试在Godot中实现了一下。原始的MVC：Godot中的MVC：Model、View和Controller各自应该实现的功能如下：属性(数据字段)数据存取方法数据更新信号控件节点引用UI更新方法界面元素信号处理，比如按钮点击等调用View的界面更新方法Controller //UI界面根节点，空的Control节点Model //空的Control节点View //容器或Control节点其他界面元素在。"
keywords: "【Godot4.4】浅尝Godot中的MVC"
categories: ['Godot', 'Godot']
tags: ['Mvc', 'Godot']
artid: "146139879"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146139879
    alt: "Godot4.4浅尝Godot中的MVC"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146139879
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146139879
cover: https://bing.ee123.net/img/rand?artid=146139879
image: https://bing.ee123.net/img/rand?artid=146139879
img: https://bing.ee123.net/img/rand?artid=146139879
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     【Godot4.4】浅尝Godot中的MVC
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="_0">
     </a>
     概述
    </h3>
    <p>
     基于一个Unity的视频。学习了一下基本的MVC概念，并尝试在Godot中实现了一下。
    </p>
    <p>
     原始的MVC：
    </p>
    <p>
     <img alt="原始的MVC" src="https://i-blog.csdnimg.cn/img_convert/e5eeb74f868bbe8a2af186cbf4115f32.png#pic_center" width="600">
      <br/>
      Godot中的MVC：
      <br/>
      <img alt="Godot中的MVC，特点是独特的信号系统和节点系统​​​​​​" src="https://i-blog.csdnimg.cn/img_convert/704b91082a2b585298698cb29c0d96ed.png"/>
     </img>
    </p>
    <p>
     Model、View和Controller各自应该实现的功能如下：
    </p>
    <p>
     Model:
    </p>
    <ul>
     <li>
      属性(数据字段)
     </li>
     <li>
      数据存取方法
     </li>
     <li>
      数据更新信号
     </li>
    </ul>
    <p>
     View:
    </p>
    <ul>
     <li>
      控件节点引用
     </li>
     <li>
      UI更新方法
      <code>
       ui_update()
      </code>
     </li>
    </ul>
    <p>
     Controller:
    </p>
    <ul>
     <li>
      界面元素信号处理，比如按钮点击等
     </li>
     <li>
      调用View的界面更新方法
     </li>
    </ul>
    <p>
     在Godot中实现：
    </p>
    <pre><code class="prism language-swift"><span class="token class-name">Controller</span>  <span class="token comment">//UI界面根节点，空的Control节点</span>
    <span class="token class-name">Model</span>   <span class="token comment">//空的Control节点</span>
    <span class="token class-name">View</span>    <span class="token comment">//容器或Control节点</span>
        其他界面元素
</code></pre>
    <p>
     在
     <code>
      MainView
     </code>
     中：
    </p>
    <ul>
     <li>
      进行元素的引用
     </li>
     <li>
      编写
      <code>
       ui_update()
      </code>
      方法，参数
      <code>
       data
      </code>
      为
      <code>
       MainModel
      </code>
      类型
     </li>
    </ul>
    <p>
     在
     <code>
      MainController
     </code>
     中：
    </p>
    <ul>
     <li>
      进行元素的引用
     </li>
     <li>
      放置所有元素的信号处理函数
     </li>
     <li>
      放置
      <code>
       MainModel
      </code>
      的数据更新信号处理函数
      <code>
       data_updated()
      </code>
     </li>
    </ul>
    <p>
     在
     <code>
      MainModel
     </code>
     中：
    </p>
    <ul>
     <li>
      定义所需保存的数据字段
     </li>
     <li>
      定义数据的加载、更新以及保存方法
     </li>
     <li>
      定义
      <code>
       data_updated()
      </code>
      信号
     </li>
    </ul>
    <h3>
     <a id="_52">
     </a>
     实际测试
    </h3>
    <p>
     <img alt="MVC测试场景" src="https://i-blog.csdnimg.cn/img_convert/65f1c437379cd8dde7c0f5d3f3b140b8.png#pic_center" width="600"/>
    </p>
    <p>
     通常是一个界面分别对应一个Model、View和Controller。
    </p>
    <p>
     为了方便管理，建立名为Model、View和Controller的文件夹。
    </p>
    <p>
     <img alt="文件构成" src="https://i-blog.csdnimg.cn/img_convert/3141ece2a2947ecccdcc39e458d8754c.png#pic_center" width="300"/>
    </p>
    <h4>
     <a id="MainView_61">
     </a>
     MainView
    </h4>
    <p>
     <code>
      View
     </code>
     只负责节点引用和实现一个界面更新方法：
    </p>
    <pre><code class="prism language-swift"># <span class="token class-name">MainView</span>
extends <span class="token class-name">Control</span>

# <span class="token constant">UI</span>节点引用
<span class="token attribute atrule">@onready</span> <span class="token keyword">var</span> text_edit<span class="token punctuation">:</span> <span class="token class-name">TextEdit</span> <span class="token operator">=</span> <span class="token operator">%</span><span class="token class-name">TextEdit</span>

# 界面更新方法
<span class="token keyword">func</span> <span class="token function-definition function">ui_update</span><span class="token punctuation">(</span>text<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	text_edit<span class="token punctuation">.</span>text <span class="token operator">=</span> text
</code></pre>
    <h4>
     <a id="MainModel_76">
     </a>
     MainModel
    </h4>
    <p>
     <code>
      Model
     </code>
     ：
    </p>
    <ul>
     <li>
      设计需要存储的数据字段
     </li>
     <li>
      数据存取方法
     </li>
     <li>
      定义数据更新信号
     </li>
    </ul>
    <pre><code class="prism language-swift"># <span class="token class-name">MainModel</span>
extends <span class="token class-name">Control</span>

signal <span class="token function">data_updated</span><span class="token punctuation">(</span>text<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">)</span> # 数据更新信号

# 保存路径
<span class="token keyword">var</span> path<span class="token punctuation">:</span><span class="token class-name">String</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">""</span></span>

# 数据字段
<span class="token keyword">var</span> text<span class="token punctuation">:</span><span class="token class-name">String</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">""</span></span>


# 保存数据
<span class="token keyword">func</span> <span class="token function-definition function">save_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">var</span> file <span class="token operator">=</span> <span class="token class-name">FileAccess</span><span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span><span class="token class-name">FileAccess</span><span class="token punctuation">.</span><span class="token constant">WRITE</span><span class="token punctuation">)</span>
	file<span class="token punctuation">.</span><span class="token function">store_string</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>
	file<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

# 加载数据
<span class="token keyword">func</span> <span class="token function-definition function">load_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">if</span> <span class="token class-name">FileAccess</span><span class="token punctuation">.</span><span class="token function">file_exists</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>
		text <span class="token operator">=</span> <span class="token class-name">FileAccess</span><span class="token punctuation">.</span><span class="token function">get_file_as_string</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>
	<span class="token function">emit_signal</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"data_updated"</span></span><span class="token punctuation">,</span>text<span class="token punctuation">)</span>  # 触发数据更新信号
</code></pre>
    <h4>
     <a id="MainController_109">
     </a>
     MainController
    </h4>
    <p>
     <code>
      Controller
     </code>
     ：
    </p>
    <ul>
     <li>
      将View的所有界面元素信号处理链接到
      <code>
       Controller
      </code>
     </li>
     <li>
      将Model的数据更新信号处理链接到
      <code>
       Controller
      </code>
     </li>
     <li>
      其他处理逻辑
     </li>
    </ul>
    <pre><code class="prism language-swift"># <span class="token class-name">MainController</span>
extends <span class="token class-name">Control</span>

<span class="token attribute atrule">@onready</span> <span class="token keyword">var</span> main_view<span class="token punctuation">:</span> <span class="token class-name">Control</span> <span class="token operator">=</span> <span class="token operator">%</span><span class="token class-name">MainView</span>
<span class="token attribute atrule">@onready</span> <span class="token keyword">var</span> main_model<span class="token punctuation">:</span> <span class="token class-name">Control</span> <span class="token operator">=</span> <span class="token operator">%</span><span class="token class-name">MainModel</span>
<span class="token attribute atrule">@onready</span> <span class="token keyword">var</span> text_edit<span class="token punctuation">:</span> <span class="token class-name">TextEdit</span> <span class="token operator">=</span> <span class="token operator">%</span><span class="token class-name">TextEdit</span>


<span class="token keyword">func</span> <span class="token function-definition function">_ready</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> void<span class="token punctuation">:</span>
	main_model<span class="token punctuation">.</span>path <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"data/mian.txt"</span></span>
	main_model<span class="token punctuation">.</span><span class="token function">load_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

# <span class="token operator">===============</span> 所有界面元素的信号处理  <span class="token operator">===============</span>
<span class="token keyword">func</span> <span class="token function-definition function">_on_button_pressed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> void<span class="token punctuation">:</span>
	main_model<span class="token punctuation">.</span>text <span class="token operator">=</span> text_edit<span class="token punctuation">.</span>text
	main_model<span class="token punctuation">.</span><span class="token function">save_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

# <span class="token class-name">MainModel</span>的数据更新信号
<span class="token keyword">func</span> <span class="token function-definition function">_on_main_model_data_updated</span><span class="token punctuation">(</span>text<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> void<span class="token punctuation">:</span>
	main_view<span class="token punctuation">.</span><span class="token function">ui_update</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>

</code></pre>
    <h3>
     <a id="_140">
     </a>
     总结
    </h3>
    <p>
     这只是一种粗略的实现和实践。将界面和处理逻辑分开是我之前在实践的事情，可以很好的减少UI场景中的代码。并且让逻辑可以以类的形式存在和复用。
    </p>
    <p>
     MVC是一种更高层次的设计，将处理逻辑分为逻辑和数据两部分，并巧妙的通过信号和方法调用，完成了“UI交互-逻辑处理-数据存储”和“反向更新UI”的功能。
    </p>
    <p>
     对MVC的认识和实践有自己的业余性，期望大佬指正错误。
    </p>
   </div>
   <link href="./../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="./../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f67726179706967656e313939302f:61727469636c652f64657461696c732f313436313339383739" class_="artid" style="display:none">
 </p>
</div>


