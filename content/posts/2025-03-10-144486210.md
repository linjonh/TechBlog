---
layout: post
title: "深入理解string从模拟实现看本质"
date: 2025-03-10 09:51:25 +0800
description: "本文将通过模拟实现一个简单的 String 类，深入探讨字符串的底层实现原理，包括内存管理、深浅拷贝、深赋值、常用操作以及性能优化等方面，帮助读者更好地理解和使用字符串。关键词： String, 模拟实现, 内存管理, 深浅拷贝, 深赋值, 字符串操作, 性能优化我们首先定义一个String：字符串：字符串的长度：字符串的容量构造函数、析构函数、拷贝构造函数、赋值运算符。常用操作：字符串连接、子串查找、字符串比较、访问元素、获取长度等。常用操作符：==、!=、>>、<<等。"
keywords: "深入理解string：从模拟实现看本质"
categories: ['C', 'C']
tags: ['C']
artid: "144486210"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=144486210
    alt: "深入理解string从模拟实现看本质"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=144486210
featuredImagePreview: https://bing.ee123.net/img/rand?artid=144486210
cover: https://bing.ee123.net/img/rand?artid=144486210
image: https://bing.ee123.net/img/rand?artid=144486210
img: https://bing.ee123.net/img/rand?artid=144486210
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     深入理解string：从模拟实现看本质
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <h2>
     <a id="_1">
     </a>
     摘要：
    </h2>
    <blockquote>
     <p>
      <font size="4">
       本文将通过模拟实现一个简单的 String 类，深入探讨字符串的底层实现原理，包括内存管理、深浅拷贝、深赋值、常用操作以及性能优化等方面，帮助读者更好地理解和使用字符串。
      </font>
     </p>
    </blockquote>
    <p>
     <font size="4">
      关键词： String, 模拟实现, 内存管理, 深浅拷贝, 深赋值, 字符串操作, 性能优化
     </font>
    </p>
    <h2>
     <a id="_7">
     </a>
     一、引言
    </h2>
    <blockquote>
     <p>
      <font size="4">
       在 C++ 中，string 是一个表示字符串的类，它提供了一系列用于字符串操作的方法。string 类的对象可以存储文本数据，支持多种操作，如赋值、连接、比较和搜索。本文将通过模拟实现string类来理解string的底层实现原理，并以此为基础，深入探讨字符串的相关知识。
      </font>
     </p>
    </blockquote>
    <h2>
     <a id="string_11">
     </a>
     二、string的模拟实现
    </h2>
    <h3>
     <a id="21_string_12">
     </a>
     2.1 string类的定义
    </h3>
    <p>
     <font size="4">
      我们首先定义一个
      <strong>
       String
      </strong>
      类，包含以下成员变量和成员函数：
     </font>
    </p>
    <ul>
     <li>
      <p>
       <font size="4">
        <strong>
         成员变量：
        </strong>
       </font>
      </p>
      <ul>
       <li>
        <font size="4">
         char* _str = nullptr; ：字符串
        </font>
       </li>
       <li>
        <font size="4">
         size_t _size = 0; ：字符串的长度
        </font>
       </li>
       <li>
        <font size="4">
         size_t _capacity = 0; ：字符串的容量
        </font>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <font size="4">
        <strong>
         成员函数：
        </strong>
       </font>
      </p>
      <ul>
       <li>
        <font size="4">
         构造函数、析构函数、拷贝构造函数、赋值运算符。
        </font>
       </li>
       <li>
        <font size="4">
         常用操作：字符串连接、子串查找、字符串比较、访问元素、获取长度等。
        </font>
       </li>
       <li>
        <font size="4">
         常用操作符：==、!=、&gt;&gt;、&lt;&lt;等。
        </font>
       </li>
      </ul>
     </li>
    </ul>
    <pre><code class="prism language-cpp"><span class="token keyword">namespace</span> dza 
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">class</span> <span class="token class-name">string</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">public</span><span class="token operator">:</span>
		<span class="token comment">///*重新定义一个新的变量名*///</span>
		<span class="token comment">//typedef char* iterator;</span>

		<span class="token keyword">using</span> iterator <span class="token operator">=</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">;</span>
		<span class="token keyword">using</span> const_iterator <span class="token operator">=</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">;</span>

		<span class="token comment">/*成员函数*/</span>

		<span class="token comment">//构造函数</span>
		<span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
		string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span>string s<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">//析构函数</span>
		<span class="token operator">~</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">///*迭代器*/</span>

		iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _str<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _str <span class="token operator">+</span> _size<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		const_iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _str<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		const_iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _str <span class="token operator">+</span> _size<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		size_t <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _size<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _str<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">//*容量操作*</span>
		
		<span class="token comment">//预留空间</span>
		<span class="token keyword">void</span> <span class="token function">reserve</span><span class="token punctuation">(</span>size_t len<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
			_size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">*元素访问*//</span>
        
		<span class="token comment">//[]元素符重载</span>
		<span class="token keyword">char</span><span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>size_t i<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">assert</span><span class="token punctuation">(</span>i <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">return</span> _str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>size_t i<span class="token punctuation">)</span> <span class="token keyword">const</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">assert</span><span class="token punctuation">(</span>i <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">return</span> _str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">/*修饰符*/</span>

		<span class="token comment">// 尾插</span>
		<span class="token keyword">void</span> <span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 尾插</span>
		<span class="token keyword">void</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// +=运算符的重载</span>
		string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
		string<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">//头插</span>
		<span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> <span class="token keyword">char</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">//擦除</span>
		<span class="token keyword">void</span> <span class="token function">erase</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> size_t len <span class="token operator">=</span> npos<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">//交换</span>
		<span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">*字符串操作*///</span>

		<span class="token comment">//寻找</span>
		size_t <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">,</span> size_t pos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		size_t <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">,</span> size_t pos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">//在一个字符串里面拷贝构造一个子字符串</span>
		string <span class="token function">substr</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span>size_t len <span class="token operator">=</span> npos<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">///*非成员函数重载*</span>

	<span class="token keyword">private</span><span class="token operator">:</span>
		<span class="token comment">//因为是私有成员。初始化列表的时候会按照这里初始化的顺序进行初始化。为了防止初始化列表出现问题。建议直接在定义的时候初始化</span>
		<span class="token comment">//如果这里没有初始化，初始化列表的时候可能会因为搞错初始化的顺序而导致程序报错</span>
		<span class="token keyword">char</span><span class="token operator">*</span> _str <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
		size_t _size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		size_t _capacity <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token keyword">public</span><span class="token operator">:</span>
		<span class="token comment">// static const size_t npos = -1;</span>
		<span class="token keyword">static</span> <span class="token keyword">const</span> size_t npos<span class="token punctuation">;</span><span class="token comment">// 这里的npos编译器自动初始化为0.但是在.cpp文件中又重新初始化为-1</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>

	<span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>string<span class="token operator">&amp;</span> s1<span class="token punctuation">,</span> string<span class="token operator">&amp;</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span> <span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&gt;=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span>

	ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">,</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
	istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span>istream<span class="token operator">&amp;</span> is<span class="token punctuation">,</span>string<span class="token operator">&amp;</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
	istream<span class="token operator">&amp;</span> <span class="token function">getline</span><span class="token punctuation">(</span>istream<span class="token operator">&amp;</span> is<span class="token punctuation">,</span>string<span class="token operator">&amp;</span> str<span class="token punctuation">,</span><span class="token keyword">char</span> delim <span class="token operator">=</span> <span class="token char">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h2>
     <a id="_166">
     </a>
     三、深拷贝和深赋值
    </h2>
    <h3>
     <a id="31__167">
     </a>
     3.1 深浅拷贝构造函数
    </h3>
    <p>
     <font size="4">
      默认的拷贝构造函数和赋值运算符是浅拷贝，即只复制指针的值，而不是指针指向的内存内容。这会导致多个对象共享同一块内存，从而引发以下问题：
     </font>
    </p>
    <ul>
     <li>
      <font size="4">
       修改一个对象会影响其他对象。
      </font>
     </li>
     <li>
      <font size="4">
       析构时可能导致重复释放同一块内存，引发程序崩溃。
      </font>
     </li>
    </ul>
    <p>
     <font size="4">
      深拷贝是指不仅复制指针的值，还复制指针指向的内存内容。
     </font>
    </p>
    <p>
     <img alt="深拷贝与浅拷贝" src="https://i-blog.csdnimg.cn/direct/a6d00d540e434222bb6e93eb75e3d44f.png#pic_center"/>
    </p>
    <h3>
     <a id="32__176">
     </a>
     3.2 深赋值运算符
    </h3>
    <p>
     <font size="4">
      深赋值运算符不仅需要深拷贝新内容，还需要释放原有内存，避免内存泄漏。同时，需要检查自我赋值的情况，避免释放自身内存导致错误。
     </font>
    </p>
    <p>
     <font size="4">
      以下是深赋值的实现：
     </font>
    </p>
    <pre><code class="prism language-cpp">String<span class="token operator">&amp;</span> String<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> String<span class="token operator">&amp;</span> other<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">!=</span> <span class="token operator">&amp;</span>other<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>                 <span class="token comment">// 检查自我赋值</span>
        <span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">;</span>                    <span class="token comment">// 释放原有内存</span>
        length <span class="token operator">=</span> other<span class="token punctuation">.</span>length<span class="token punctuation">;</span>           <span class="token comment">// 复制长度</span>
        data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>     <span class="token comment">// 动态分配内存</span>
        <span class="token function">strcpy</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> other<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 复制内容</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>                        <span class="token comment">// 返回当前对象的引用</span>
<span class="token punctuation">}</span>
</code></pre>
    <h2>
     <a id="_194">
     </a>
     四、总结
    </h2>
    <p>
     <font size="4">
      通过模拟实现 String 类，我们可以更深入地理解字符串的底层实现原理，包括内存管理、深浅拷贝、深赋值、常用操作以及性能优化等方面。在实际编程中，我们应该根据具体需求选择合适的字符串实现方式，并注意避免常见的内存错误和性能问题。
     </font>
    </p>
    <h2>
     <a id="_196">
     </a>
     五、附录
    </h2>
    <h3>
     <a id="51__197">
     </a>
     5.1 完整代码
    </h3>
    <pre><code class="prism language-cpp"><span class="token keyword">namespace</span> dza <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">const</span> size_t string<span class="token double-colon punctuation">::</span>npos <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token comment">/*成员函数*/</span>

	<span class="token comment">//完全通过初始化列表这种方式来初始化。可能会有问题</span>
	<span class="token comment">/*string::string()
		:_str(new char[1]{ '\0' })
		, _size(0)
		, _capacity(0)
	{}*/</span>

	<span class="token comment">//构造函数</span>
	string<span class="token double-colon punctuation">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span>
		<span class="token operator">:</span><span class="token function">_size</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//只初始化size</span>
	<span class="token punctuation">{<!-- --></span>
		_capacity <span class="token operator">=</span> _size<span class="token punctuation">;</span>
		_str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>_size <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

		<span class="token function">strcpy</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//传统写法</span>
	string<span class="token double-colon punctuation">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>s<span class="token punctuation">.</span>_capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token function">strcpy</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		_size <span class="token operator">=</span> s<span class="token punctuation">.</span>_size<span class="token punctuation">;</span>
		_capacity <span class="token operator">=</span> s<span class="token punctuation">.</span>_capacity<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">现代写法</span>
	<span class="token comment">//string::string(const string&amp; s)</span>
	<span class="token comment">//{<!-- --></span>
	<span class="token comment">//	string tmp(s._str);</span>
	<span class="token comment">//	swap(tmp);</span>
	<span class="token comment">//}</span>

	<span class="token comment">//传统写法</span>
	string<span class="token operator">&amp;</span> string<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span>string s<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">!=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> _str<span class="token punctuation">;</span>
			_str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>s<span class="token punctuation">.</span>_capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token function">strcpy</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
			_size <span class="token operator">=</span> s<span class="token punctuation">.</span>_size<span class="token punctuation">;</span>
			_capacity <span class="token operator">=</span> s<span class="token punctuation">.</span>_capacity<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">现代写法</span>
	<span class="token comment">//string&amp; string::operator=(string s)</span>
	<span class="token comment">//{<!-- --></span>
	<span class="token comment">//	swap(s);</span>
	<span class="token comment">//	return *this;</span>
	<span class="token comment">//}</span>

	<span class="token comment">//析构函数</span>
	<span class="token class-name">string</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> _str<span class="token punctuation">;</span>
		_str <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
		_size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		_capacity <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">///*迭代器*/</span>
	<span class="token keyword">void</span> string<span class="token double-colon punctuation">::</span><span class="token function">reserve</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">char</span><span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">//strcpy(_str, tmp);</span>
			<span class="token function">strcpy</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> _str<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">// strcpy和swap不一样。参数不能调换</span>
			<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> _str<span class="token punctuation">;</span>
			_str <span class="token operator">=</span> tmp<span class="token punctuation">;</span>

			_capacity <span class="token operator">=</span> n<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// 插入字符</span>
	<span class="token keyword">void</span> string<span class="token double-colon punctuation">::</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">//两种写法</span>
		<span class="token comment">//第一种</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">==</span> _capacity<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">reserve</span><span class="token punctuation">(</span>_capacity <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">4</span> <span class="token operator">:</span> _capacity <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		_str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span>
		_size<span class="token operator">++</span><span class="token punctuation">;</span>

		<span class="token comment">//第二种</span>
		<span class="token comment">//insert(_size,ch);</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// 插入字符串</span>
	<span class="token keyword">void</span> string<span class="token double-colon punctuation">::</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">//两种写法</span>
		<span class="token comment">//①</span>
		size_t len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">+</span> len <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			size_t newCapacity <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> _capacity<span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>newCapacity <span class="token operator">&lt;</span> _size <span class="token operator">+</span> len<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				newCapacity <span class="token operator">=</span> _size <span class="token operator">+</span> len<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token function">reserve</span><span class="token punctuation">(</span>newCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token function">strcpy</span><span class="token punctuation">(</span>_str <span class="token operator">+</span> _size<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		_size <span class="token operator">+=</span> len<span class="token punctuation">;</span>

		<span class="token comment">②</span>
		<span class="token comment">//insert(_size, str);</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// 底层逻辑是push_back。所以和push_back的使用一样</span>
	string<span class="token operator">&amp;</span> string<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">push_back</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	string<span class="token operator">&amp;</span> string<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">append</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// </span>
	<span class="token keyword">void</span> string<span class="token double-colon punctuation">::</span><span class="token function">insert</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> <span class="token keyword">char</span> ch<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;=</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">==</span> _capacity<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">reserve</span><span class="token punctuation">(</span>_capacity <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">4</span> <span class="token operator">:</span> _capacity <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		size_t end <span class="token operator">=</span> _size <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>end <span class="token operator">&gt;</span> pos<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_str<span class="token punctuation">[</span>end<span class="token punctuation">]</span> <span class="token operator">=</span> _str<span class="token punctuation">[</span>end <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token operator">--</span>end<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		_str<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span>
		_size<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">void</span> string<span class="token double-colon punctuation">::</span><span class="token function">insert</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;=</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>

		size_t len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">+</span> len <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			size_t newCapacity <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> _capacity<span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>newCapacity <span class="token operator">&lt;</span> _size <span class="token operator">+</span> len<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				newCapacity <span class="token operator">=</span> _size <span class="token operator">+</span> len<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token function">reserve</span><span class="token punctuation">(</span>newCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		size_t end <span class="token operator">=</span> _size <span class="token operator">+</span> len<span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>end <span class="token operator">&gt;</span> pos <span class="token operator">+</span> len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_str<span class="token punctuation">[</span>end<span class="token punctuation">]</span> <span class="token operator">=</span> _str<span class="token punctuation">[</span>end <span class="token operator">-</span> len<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token operator">--</span>end<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_str<span class="token punctuation">[</span>pos <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		_size <span class="token operator">+=</span> len<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">void</span> string<span class="token double-colon punctuation">::</span><span class="token function">erase</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> size_t len<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">&gt;=</span> _size <span class="token operator">-</span> pos<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_str<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
			_size <span class="token operator">=</span> pos<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">{<!-- --></span>
			size_t end <span class="token operator">=</span> pos <span class="token operator">+</span> len<span class="token punctuation">;</span>
			<span class="token keyword">while</span> <span class="token punctuation">(</span>end <span class="token operator">&lt;=</span> _size<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				_str<span class="token punctuation">[</span>end <span class="token operator">-</span> len<span class="token punctuation">]</span> <span class="token operator">=</span> _str<span class="token punctuation">[</span>end<span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token operator">++</span>end<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			_size <span class="token operator">-=</span> len<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	size_t string<span class="token double-colon punctuation">::</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">,</span>size_t pos<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> pos<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> _size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>ch <span class="token operator">==</span> _str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token keyword">return</span> i<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">return</span> npos<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	size_t string<span class="token double-colon punctuation">::</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">,</span> size_t pos<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> ptr <span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>_str <span class="token operator">+</span> pos<span class="token punctuation">,</span> _str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>ptr <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> npos<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> 
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> ptr <span class="token operator">-</span> _str<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	string string<span class="token double-colon punctuation">::</span><span class="token function">substr</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> size_t len<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">assert</span><span class="token punctuation">(</span><span class="token generic-function"><span class="token function">pos</span> <span class="token generic class-name"><span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">&gt;</span></span></span> <span class="token punctuation">(</span>_size <span class="token operator">-</span> pos<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			len <span class="token operator">=</span> _size <span class="token operator">-</span> pos<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		dza<span class="token double-colon punctuation">::</span>string sub<span class="token punctuation">;</span>
		sub<span class="token punctuation">.</span><span class="token function">reserve</span><span class="token punctuation">(</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			sub <span class="token operator">+=</span> _str<span class="token punctuation">[</span>pos <span class="token operator">+</span> i<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">return</span> sub<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">void</span> string<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span>s<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_size<span class="token punctuation">,</span>s<span class="token punctuation">.</span>_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
		std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_capacity<span class="token punctuation">,</span>s<span class="token punctuation">.</span>_capacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">///</span>
	
	<span class="token comment">// 这个swap是为了防止没有使用定义内的swap。</span>
	<span class="token comment">// 编译器自带的swap在交换时，会调用三次构造和三次析构。大大降低程序效率</span>
	<span class="token comment">// 自己定义的swap就只是交换两个对象所指向的资源。效率快很多</span>
	<span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>string<span class="token operator">&amp;</span> s1<span class="token punctuation">,</span> string<span class="token operator">&amp;</span> s2<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		s1<span class="token punctuation">.</span><span class="token function">swap</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span> <span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">// strcmp。两个字符串相等返回0。lhs大于rhs返回大于0的数，lhs小于rhs返回小于0的数</span>
		<span class="token comment">// 相等则是真，其余情况都是返回假</span>
		<span class="token keyword">return</span> <span class="token function">strcmp</span><span class="token punctuation">(</span>lhs<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rhs<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 如果lhs等于rhs，则返回假</span>
		<span class="token comment">// 如果lhs不等于rhs，则返回真。</span>
		<span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span>lhs <span class="token operator">==</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 如果lhs小于rhs。那么strcmp返回的是小于0的数。</span>
		<span class="token comment">// 然后判断。若是小于0，则为真；其他情况都为假</span>
		<span class="token keyword">return</span> <span class="token function">strcmp</span><span class="token punctuation">(</span>lhs<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rhs<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 如果lhs大于rhs，则为假，返回假说明 rhs 不大于 lhs ；等于或者大于都是真，说明 rhs 大于等于 lhs</span>
		<span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span>lhs <span class="token operator">&lt;=</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&lt;=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">// lhs &gt; rhs 为假，返回假，说明 lhs 不小于等于 rhs 。其余情况都说明 lhs 大于等于 rhs</span>
		<span class="token keyword">return</span> lhs <span class="token operator">&lt;</span> rhs <span class="token operator">||</span> lhs <span class="token operator">==</span> rhs<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">&gt;=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> lhs<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">// </span>
		<span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span>lhs <span class="token operator">&lt;</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> os<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> str<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 遍历 str 的内容</span>
		<span class="token comment">// 这个os是什么？return os是返回什么？</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> str<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token generic-function"><span class="token function">os</span> <span class="token generic class-name"><span class="token operator">&lt;&lt;</span> str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> os<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&gt;&gt;</span></span></span><span class="token punctuation">(</span>istream<span class="token operator">&amp;</span> is<span class="token punctuation">,</span> string<span class="token operator">&amp;</span> str<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 在流插入之前，把字符串的内部清空</span>
		str<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 使用内置类型的数组。可以避免自定义类型的频繁扩容</span>
		<span class="token comment">// 因为内置类型的数组空间开创在栈中，空间扩容比位于堆中的自定义类型方便</span>
		<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">char</span> buff<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

		<span class="token comment">// 定义一个ch，用来记录输入的数据</span>
		<span class="token comment">// get()函数是编译器提供输入数据的函数。这里如果使用 &gt;&gt; 来输入数据，字符串就无法输入' ' 和 '\0'</span>
		<span class="token comment">// get()则是用户自己定义结束标志</span>
		<span class="token keyword">char</span> ch<span class="token punctuation">;</span>
		<span class="token comment">//cin &gt;&gt; ch;</span>
		ch <span class="token operator">=</span> is<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 这里定义的结束标志为 ' ' 和 '\0'。与编译器一致</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">!=</span> <span class="token char">' '</span> <span class="token operator">&amp;&amp;</span> ch <span class="token operator">!=</span> <span class="token char">'\n'</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">// i++。记录输入的数据的实际长度</span>
			buff<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span>
			<span class="token comment">// 如果数据长度超过256，那么先让str的长度扩大256。再把i清0。重新记录数据的长度</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">255</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				buff<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
				str <span class="token operator">+=</span> buff<span class="token punctuation">;</span>
				i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token comment">// 把数据放进数组中</span>
			ch <span class="token operator">=</span> is<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 这里是避免ch已经读取完。但是buff数组里面还有残余的数据没有输入进str</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			buff<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
			str <span class="token operator">+=</span> buff<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">return</span> is<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	istream<span class="token operator">&amp;</span> <span class="token function">getline</span><span class="token punctuation">(</span>istream<span class="token operator">&amp;</span> is<span class="token punctuation">,</span> string<span class="token operator">&amp;</span> str<span class="token punctuation">,</span> <span class="token keyword">char</span> delim<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		str<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">char</span> buff<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

		<span class="token keyword">char</span> ch<span class="token punctuation">;</span>
		ch <span class="token operator">=</span> is<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">!=</span> delim<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			buff<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">255</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				buff<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
				str <span class="token operator">+=</span> buff<span class="token punctuation">;</span>
				i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			ch <span class="token operator">=</span> is<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			buff<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
			str <span class="token operator">+=</span> buff<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">return</span> is<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="62__603">
     </a>
     6.2 测试用例
    </h3>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"string的模拟实现.h"</span></span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	dza<span class="token double-colon punctuation">::</span>string <span class="token function">s1</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"s1.size() == "</span> <span class="token operator">&lt;&lt;</span> s1<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	dza<span class="token double-colon punctuation">::</span>string s2<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"s2.size() == "</span> <span class="token operator">&lt;&lt;</span> s2<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	<span class="token comment">// push_back只能插入一个字符</span>
	s2<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token char">'h'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	s2<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token char">'e'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	s2<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token char">'l'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	s2<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token char">'l'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	s2<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token char">'o'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> ch <span class="token operator">:</span> s1<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> ch <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	s1<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token char">'5'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> ch <span class="token operator">:</span> s1<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> ch <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>


	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> ch <span class="token operator">:</span> s2<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> ch <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	s1 <span class="token operator">+=</span> <span class="token char">'6'</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> ch <span class="token operator">:</span> s1<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> ch <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	dza<span class="token double-colon punctuation">::</span>string s3<span class="token punctuation">;</span>
	<span class="token comment">// append可以插入一个字符串</span>
	s3<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"12345"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	s3<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"上山打老虎"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 范围for不能打印汉字。因为范围for是一个一个字节的打印。但是汉字一般有两个字节以上</span>
	<span class="token comment">/*for (auto ch : s3)
	{
		cout &lt;&lt; ch &lt;&lt; " ";
	}*/</span>
	cout <span class="token operator">&lt;&lt;</span>s3 <span class="token operator">&lt;&lt;</span>  endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	dza<span class="token double-colon punctuation">::</span>string <span class="token function">s1</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> ch <span class="token operator">:</span> s1<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> ch <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	s1<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> ch <span class="token operator">:</span> s1<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> ch <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	s1<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token char">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	s1<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token char">'3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	s1<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token char">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	s1<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token char">'4'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> ch <span class="token operator">:</span> s1<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> ch <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	<span class="token comment">// 从位置为1开始，删除两个字符</span>
	s1<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> ch <span class="token operator">:</span> s1<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> ch <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	<span class="token comment">// 从位置为1开始，删除一个字符</span>
	s1<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> ch <span class="token operator">:</span> s1<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> ch <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	<span class="token comment">// 从位置为1开始，删除后面所有字符</span>
	s1<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> ch <span class="token operator">:</span> s1<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> ch <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"--------------------------------------------------------------------------------"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	dza<span class="token double-colon punctuation">::</span>string <span class="token function">s2</span><span class="token punctuation">(</span><span class="token string">"1234"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> ch <span class="token operator">:</span> s2<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> ch <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	s2<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token char">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> ch <span class="token operator">:</span> s2<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> ch <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	s2<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token char">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> ch <span class="token operator">:</span> s2<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> ch <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

	<span class="token comment">// 位置必须给，不是默认从0开始</span>
	<span class="token comment">/*s2.insert('0');
	for (auto ch : s2)
	{
		cout &lt;&lt; ch &lt;&lt; " ";
	}
	cout &lt;&lt; endl;*/</span>

	s2<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>s2<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token char">'9'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> ch <span class="token operator">:</span> s2<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> ch <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test03</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// 提取网址</span>
	dza<span class="token double-colon punctuation">::</span>string s1 <span class="token operator">=</span> <span class="token string">"https://legacy.cplusplus.com/reference/cstring/strstr/?kw=strstr"</span><span class="token punctuation">;</span>
	<span class="token comment">//bit::string s1 = "https://blog.csdn.net/ww753951/article/details/130427526";</span>
	
	<span class="token comment">// pos1先找到网址中的 :</span>
	size_t pos1 <span class="token operator">=</span> s1<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token char">':'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token comment">// pos2从pos1加3的位置开始找'/'。最后得到网址中的地址</span>
	size_t pos2 <span class="token operator">=</span> s1<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token char">'/'</span><span class="token punctuation">,</span> pos1 <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token keyword">if</span> <span class="token punctuation">(</span>pos1 <span class="token operator">!=</span> string<span class="token double-colon punctuation">::</span>npos <span class="token operator">&amp;&amp;</span> pos2 <span class="token operator">!=</span> string<span class="token double-colon punctuation">::</span>npos<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">// substr的作用是提取字符串中的一段。来创建一个全新的子字符串</span>
		dza<span class="token double-colon punctuation">::</span>string domain <span class="token operator">=</span> s1<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>pos1 <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">,</span> pos2 <span class="token operator">-</span> <span class="token punctuation">(</span>pos1 <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> domain<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

		dza<span class="token double-colon punctuation">::</span>string uri <span class="token operator">=</span> s1<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>pos2 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> uri<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test04</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	dza<span class="token double-colon punctuation">::</span>string <span class="token function">s1</span><span class="token punctuation">(</span><span class="token string">"12345"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> s1<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	dza<span class="token double-colon punctuation">::</span>string <span class="token function">s2</span><span class="token punctuation">(</span><span class="token string">"hello world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> s2<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">test04</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre>
    <h2>
     <a id="_792">
     </a>
     六、致谢
    </h2>
    <p>
     <font size="4">
      感谢您的阅读，希望本文对您有所帮助。如果您有任何疑问或建议，欢迎留言交流。
     </font>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323330325f38303833363935362f:61727469636c652f64657461696c732f313434343836323130" class_="artid" style="display:none">
 </p>
</div>


