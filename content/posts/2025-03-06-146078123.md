---
layout: post
title: "reactä¸­çš„useContext-å¼Šç«¯äºŒ"
date: 2025-03-06 19:19:13 +0800
description: "æ–¹é¢éå¸¸æœ‰ç”¨ï¼Œä½†å®ƒå¹¶ä¸æ˜¯ä¸‡èƒ½çš„ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®ƒå¯èƒ½ä¼šå¸¦æ¥ã€‚ä¸­å­˜å‚¨çš„æ•°æ®ç»“æ„è¿‡äºå¤æ‚ï¼Œä¼šå¯¼è‡´ä»£ç å˜å¾—éš¾ä»¥ç®¡ç†ã€‚ï¼Œå› ä¸ºå®ƒä¼šå¯¼è‡´æ•´ä¸ªç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚åªèƒ½åœ¨ React ç»„ä»¶æ ‘çš„ã€‚å¦‚æœæŸä¸ªçŠ¶æ€å˜åŒ–éå¸¸é¢‘ç¹ï¼ˆå¦‚ã€‚ï¼Œä»£ç æ›´æ¸…æ™°ï¼Œç»´æŠ¤æ›´å®¹æ˜“ã€‚"
keywords: "react usecontentçš„ç¼ºç‚¹"
categories: ['React']
tags: ['å‰ç«¯', 'React', 'Javascript']
artid: "146078123"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146078123
    alt: "reactä¸­çš„useContext-å¼Šç«¯äºŒ"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146078123
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146078123
cover: https://bing.ee123.net/img/rand?artid=146078123
image: https://bing.ee123.net/img/rand?artid=146078123
img: https://bing.ee123.net/img/rand?artid=146078123
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     reactä¸­çš„useContext-å¼Šç«¯ï¼ˆäºŒï¼‰
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-dracula" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     <code>
      useContext
     </code>
     åœ¨è§£å†³
     <strong>
      â€œprops ä¼ é€’åœ°ç‹±â€
     </strong>
     æ–¹é¢éå¸¸æœ‰ç”¨ï¼Œä½†å®ƒå¹¶ä¸æ˜¯ä¸‡èƒ½çš„ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®ƒå¯èƒ½ä¼šå¸¦æ¥
     <strong>
      æ€§èƒ½é—®é¢˜å’Œç»´æŠ¤ä¸Šçš„æŒ‘æˆ˜
     </strong>
     ã€‚ä»¥ä¸‹æ˜¯
     <code>
      useContext
     </code>
     çš„å‡ ä¸ªä¸»è¦å¼Šç«¯ï¼š
    </p>
    <hr/>
    <h3>
     <a id="1__Context_4">
     </a>
     <strong>
      1. ç»„ä»¶æ›´æ–°å¯èƒ½å½±å“æ•´ä¸ª Context
     </strong>
    </h3>
    <p>
     <strong>
      é—®é¢˜
     </strong>
     ï¼šå½“
     <code>
      Context
     </code>
     çš„å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œ
     <strong>
      æ‰€æœ‰ä½¿ç”¨è¯¥ Context çš„ç»„ä»¶éƒ½ä¼šé‡æ–°æ¸²æŸ“
     </strong>
     ï¼Œå³ä½¿å®ƒä»¬åªä¾èµ–
     <code>
      Context
     </code>
     çš„éƒ¨åˆ†æ•°æ®ã€‚
    </p>
    <ul>
     <li>
      è¿™å¯èƒ½ä¼šå¯¼è‡´
      <strong>
       ä¸å¿…è¦çš„æ¸²æŸ“
      </strong>
      ï¼Œé™ä½åº”ç”¨çš„æ€§èƒ½ã€‚
     </li>
    </ul>
    <h4>
     <a id="_8">
     </a>
     <strong>
      ç¤ºä¾‹ï¼šæ•´ä¸ªç»„ä»¶æ ‘éƒ½è¢«é‡æ–°æ¸²æŸ“
     </strong>
    </h4>
    <pre><code class="prism language-jsx">const UserContext = createContext();

const UserProvider = ({ children }) =&gt; {
  const [user, setUser] = useState({ name: "John", age: 24 });

  return (
    &lt;UserContext.Provider value={<!-- -->{ user, setUser }}&gt;
      {children}
    &lt;/UserContext.Provider&gt;
  );
};

// å­ç»„ä»¶ 1ï¼šåªæ˜¾ç¤ºç”¨æˆ·å§“å
const UserName = () =&gt; {
  const { user } = useContext(UserContext);
  console.log("UserName ç»„ä»¶æ›´æ–°");
  return &lt;h2&gt;å§“å: {user.name}&lt;/h2&gt;;
};

// å­ç»„ä»¶ 2ï¼šä¿®æ”¹ç”¨æˆ·å¹´é¾„
const UserAgeUpdater = () =&gt; {
  const { setUser } = useContext(UserContext);
  console.log("UserAgeUpdater ç»„ä»¶æ›´æ–°");

  return &lt;button onClick={() =&gt; setUser(prev =&gt; ({ ...prev, age: prev.age + 1 }))}&gt;å¢åŠ å¹´é¾„&lt;/button&gt;;
};

// App ç»„ä»¶
const App = () =&gt; (
  &lt;UserProvider&gt;
    &lt;UserName /&gt;
    &lt;UserAgeUpdater /&gt;
  &lt;/UserProvider&gt;
);

export default App;
</code></pre>
    <h4>
     <a id="_47">
     </a>
     <strong>
      é—®é¢˜å‡ºç°äº†ï¼
     </strong>
    </h4>
    <ul>
     <li>
      å½“
      <code>
       UserAgeUpdater
      </code>
      æ›´æ–°
      <code>
       age
      </code>
      æ—¶ï¼Œ
      <code>
       UserName
      </code>
      ç»„ä»¶
      <strong>
       ä¹Ÿä¼šé‡æ–°æ¸²æŸ“
      </strong>
      ï¼Œå°½ç®¡å®ƒ
      <strong>
       æ²¡æœ‰ä½¿ç”¨
       <code>
        age
       </code>
      </strong>
      ï¼
     </li>
     <li>
      è¿™ä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™ï¼Œå°¤å…¶æ˜¯å½“
      <code>
       Context
      </code>
      ä¸­çš„æ•°æ®é‡å¾ˆå¤§ï¼Œæˆ–è€…ç»„ä»¶å±‚çº§å¾ˆæ·±æ—¶ã€‚
     </li>
    </ul>
    <h4>
     <a id="_51">
     </a>
     <strong>
      è§£å†³æ–¹æ¡ˆ
     </strong>
    </h4>
    <p>
     <strong>
      æ‹†åˆ†
      <code>
       Context
      </code>
     </strong>
     ï¼Œè®©ä¸åŒæ•°æ®ç‹¬ç«‹ç®¡ç†ï¼Œé¿å…ä¸å¿…è¦çš„æ¸²æŸ“ï¼š
    </p>
    <pre><code class="prism language-jsx">const UserNameContext = createContext();
const UserAgeContext = createContext();

const UserProvider = ({ children }) =&gt; {
  const [name, setName] = useState("John");
  const [age, setAge] = useState(24);

  return (
    &lt;UserNameContext.Provider value={<!-- -->{ name, setName }}&gt;
      &lt;UserAgeContext.Provider value={<!-- -->{ age, setAge }}&gt;
        {children}
      &lt;/UserAgeContext.Provider&gt;
    &lt;/UserNameContext.Provider&gt;
  );
};
</code></pre>
    <p>
     âœ… è¿™æ ·ï¼Œ
     <code>
      UserName
     </code>
     ç»„ä»¶åªä¼šåœ¨
     <code>
      name
     </code>
     å˜åŒ–æ—¶æ›´æ–°ï¼Œ
     <code>
      UserAgeUpdater
     </code>
     åªä¼šåœ¨
     <code>
      age
     </code>
     å˜åŒ–æ—¶æ›´æ–°ï¼
    </p>
    <hr/>
    <h3>
     <a id="2__Context__74">
     </a>
     <strong>
      2. å¤æ‚çš„
      <code>
       Context
      </code>
      å¯èƒ½éš¾ä»¥ç»´æŠ¤
     </strong>
    </h3>
    <p>
     å¦‚æœ
     <code>
      Context
     </code>
     ä¸­å­˜å‚¨çš„æ•°æ®ç»“æ„è¿‡äºå¤æ‚ï¼Œä¼šå¯¼è‡´ä»£ç å˜å¾—éš¾ä»¥ç®¡ç†ã€‚ä¾‹å¦‚ï¼š
    </p>
    <pre><code class="prism language-jsx">const AppContext = createContext();

const AppProvider = ({ children }) =&gt; {
  const [state, setState] = useState({
    user: { name: "John", age: 24 },
    theme: "dark",
    language: "zh",
    notifications: [],
  });

  return (
    &lt;AppContext.Provider value={<!-- -->{ state, setState }}&gt;
      {children}
    &lt;/AppContext.Provider&gt;
  );
};
</code></pre>
    <p>
     <strong>
      é—®é¢˜
     </strong>
     ï¼š
    </p>
    <ul>
     <li>
      <code>
       Context
      </code>
      å˜æˆäº†ä¸€ä¸ª
      <strong>
       å¤§æ‚çƒ©
      </strong>
      ï¼Œæ‰€æœ‰çŠ¶æ€éƒ½å­˜æ”¾åœ¨ä¸€èµ·ã€‚
     </li>
     <li>
      ä»»ä½•ä¸€ä¸ªçŠ¶æ€å˜åŒ–ï¼Œéƒ½ä¼šè§¦å‘æ•´ä¸ª
      <code>
       Context
      </code>
      ç›¸å…³çš„ç»„ä»¶æ›´æ–°ã€‚
     </li>
    </ul>
    <h4>
     <a id="_98">
     </a>
     <strong>
      è§£å†³æ–¹æ¡ˆ
     </strong>
    </h4>
    <p>
     <strong>
      æ‹†åˆ†å¤šä¸ª Context
     </strong>
     ï¼Œæ¯”å¦‚ï¼š
    </p>
    <pre><code class="prism language-jsx">const UserContext = createContext();
const ThemeContext = createContext();
const LanguageContext = createContext();
</code></pre>
    <p>
     âœ… è¿™æ ·ï¼Œæ¯ä¸ª
     <code>
      Context
     </code>
     åªç®¡ç†
     <strong>
      ç‰¹å®šçš„æ•°æ®
     </strong>
     ï¼Œä»£ç æ›´æ¸…æ™°ï¼Œç»´æŠ¤æ›´å®¹æ˜“ã€‚
    </p>
    <hr/>
    <h3>
     <a id="3_useContext__109">
     </a>
     <strong>
      3.
      <code>
       useContext
      </code>
      é€‚ç”¨äºâ€œé™æ€æ•°æ®â€ï¼Œä½†ä¸é€‚åˆé«˜é¢‘ç‡å˜åŒ–çš„çŠ¶æ€
     </strong>
    </h3>
    <p>
     å¦‚æœæŸä¸ªçŠ¶æ€å˜åŒ–éå¸¸é¢‘ç¹ï¼ˆå¦‚
     <strong>
      é¼ æ ‡ç§»åŠ¨ä½ç½®ã€WebSocket æ•°æ®ã€å€’è®¡æ—¶
     </strong>
     ï¼‰ï¼Œä½¿ç”¨
     <code>
      useContext
     </code>
     å¯èƒ½ä¼šå¯¼è‡´
     <strong>
      æ€§èƒ½é—®é¢˜
     </strong>
     ï¼Œå› ä¸ºå®ƒä¼šå¯¼è‡´æ•´ä¸ªç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚
    </p>
    <h4>
     <a id="_112">
     </a>
     <strong>
      ç¤ºä¾‹ï¼šé«˜é¢‘ç‡å˜åŒ–çš„æ•°æ®
     </strong>
    </h4>
    <pre><code class="prism language-jsx">const MouseContext = createContext();

const MouseProvider = ({ children }) =&gt; {
  const [position, setPosition] = useState({ x: 0, y: 0 });

  useEffect(() =&gt; {
    const handleMouseMove = (event) =&gt; {
      setPosition({ x: event.clientX, y: event.clientY });
    };
    window.addEventListener("mousemove", handleMouseMove);
    return () =&gt; window.removeEventListener("mousemove", handleMouseMove);
  }, []);

  return (
    &lt;MouseContext.Provider value={position}&gt;
      {children}
    &lt;/MouseContext.Provider&gt;
  );
};
</code></pre>
    <p>
     <strong>
      é—®é¢˜
     </strong>
     ï¼š
    </p>
    <ul>
     <li>
      <code>
       position
      </code>
      å˜åŒ–
      <strong>
       éå¸¸é¢‘ç¹
      </strong>
      ï¼Œå¯¼è‡´
      <strong>
       æ‰€æœ‰ä½¿ç”¨
       <code>
        MouseContext
       </code>
       çš„ç»„ä»¶éƒ½é‡æ–°æ¸²æŸ“
      </strong>
      ï¼Œå½±å“æ€§èƒ½ã€‚
     </li>
    </ul>
    <h4>
     <a id="_137">
     </a>
     <strong>
      è§£å†³æ–¹æ¡ˆ
     </strong>
    </h4>
    <ul>
     <li>
      âœ…
      <strong>
       æ”¹ç”¨
       <code>
        useRef
       </code>
       æˆ–
       <code>
        useState
       </code>
       åªæ›´æ–°éœ€è¦çš„ç»„ä»¶
      </strong>
      ã€‚
     </li>
     <li>
      âœ…
      <strong>
       ç”¨
       <code>
        Redux
       </code>
       ã€
       <code>
        Recoil
       </code>
       è¿™ç±»çŠ¶æ€ç®¡ç†å·¥å…·ï¼Œä¼˜åŒ–æ€§èƒ½
      </strong>
      ã€‚
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="4_useContext__143">
     </a>
     <strong>
      4.
      <code>
       useContext
      </code>
      ä¸èƒ½è·¨åº”ç”¨ä½¿ç”¨
     </strong>
    </h3>
    <p>
     <code>
      useContext
     </code>
     åªèƒ½åœ¨ React ç»„ä»¶æ ‘çš„
     <strong>
      åŒä¸€ä¸ªå±‚çº§
     </strong>
     ä¸‹ä½¿ç”¨ï¼Œ
     <strong>
      ä¸èƒ½è·¨é¡µé¢æˆ–è·¨åº”ç”¨å…±äº«
     </strong>
     æ•°æ®ã€‚ä¾‹å¦‚ï¼š
    </p>
    <ul>
     <li>
      <strong>
       å¦‚æœä½ åœ¨
       <code>
        App1
       </code>
       é‡Œåˆ›å»ºäº†
       <code>
        UserContext
       </code>
       ï¼Œå®ƒåœ¨
       <code>
        App2
       </code>
       ä¸­æ— æ³•ä½¿ç”¨
      </strong>
      ã€‚
     </li>
     <li>
      <strong>
       å¦‚æœä½ æœ‰å¤šä¸ª React æ¸²æŸ“æ ¹ï¼ˆå¤šä¸ª
       <code>
        ReactDOM.createRoot()
       </code>
       ï¼‰ï¼Œå®ƒä»¬çš„
       <code>
        Context
       </code>
       æ˜¯ç‹¬ç«‹çš„
      </strong>
      ã€‚
     </li>
    </ul>
    <p>
     <strong>
      è§£å†³æ–¹æ¡ˆ
     </strong>
     ï¼š
    </p>
    <ul>
     <li>
      <strong>
       ä½¿ç”¨å…¨å±€çŠ¶æ€ç®¡ç†å·¥å…·ï¼Œå¦‚ Reduxã€Recoilã€Zustand
      </strong>
      ï¼Œå®ƒä»¬æ”¯æŒè·¨åº”ç”¨å…±äº«æ•°æ®ã€‚
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="5__ContextProvider_153">
     </a>
     <strong>
      5. ä¾èµ–
      <code>
       Context.Provider
      </code>
      ï¼Œæ— æ³•ç‹¬ç«‹ä½¿ç”¨
     </strong>
    </h3>
    <p>
     ä½¿ç”¨
     <code>
      useContext
     </code>
     å¿…é¡»åœ¨
     <code>
      Context.Provider
     </code>
     <strong>
      å†…éƒ¨
     </strong>
     ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼š
    </p>
    <pre><code class="prism language-jsx">const MyComponent = () =&gt; {
  const { user } = useContext(UserContext); // âŒ é”™è¯¯
  return &lt;p&gt;{user.name}&lt;/p&gt;;
};

// å¿…é¡»åœ¨ `UserProvider` åŒ…è£¹ä¸‹ä½¿ç”¨
const App = () =&gt; (
  &lt;UserProvider&gt;
    &lt;MyComponent /&gt;
  &lt;/UserProvider&gt;
);
</code></pre>
    <p>
     <strong>
      é—®é¢˜
     </strong>
     ï¼š
    </p>
    <ul>
     <li>
      å¦‚æœä½ 
      <strong>
       å¿˜è®°åœ¨
       <code>
        Provider
       </code>
       é‡ŒåŒ…è£¹ç»„ä»¶
      </strong>
      ï¼Œ
      <code>
       useContext
      </code>
      ä¼šæŠ¥é”™ã€‚
     </li>
     <li>
      <strong>
       å¦‚æœç»„ä»¶å¯èƒ½åœ¨å¤šä¸ªåœ°æ–¹å¤ç”¨
      </strong>
      ï¼ˆæœ‰äº›åœ°æ–¹æ²¡æœ‰
      <code>
       Provider
      </code>
      ï¼‰ï¼Œä»£ç å°±ä¼šå‡ºé—®é¢˜ã€‚
     </li>
    </ul>
    <p>
     âœ…
     <strong>
      è§£å†³æ–¹æ¡ˆ
     </strong>
     ï¼šå¯ä»¥åœ¨
     <code>
      useContext
     </code>
     é‡ŒåŠ ä¸€ä¸ªé»˜è®¤å€¼ï¼Œé¿å…æŠ¥é”™ï¼š
    </p>
    <pre><code class="prism language-jsx">const UserContext = createContext({ user: { name: "é»˜è®¤ç”¨æˆ·" } });
</code></pre>
    <hr/>
    <h3>
     <a id="_179">
     </a>
     <strong>
      æ€»ç»“
     </strong>
    </h3>
    <table>
     <thead>
      <tr>
       <th>
        <code>
         useContext
        </code>
        çš„ä¼˜ç‚¹
       </th>
       <th>
        <code>
         useContext
        </code>
        çš„ç¼ºç‚¹
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <strong>
         é¿å… props ä¼ é€’åœ°ç‹±
        </strong>
       </td>
       <td>
        <strong>
         æ‰€æœ‰ä½¿ç”¨
         <code>
          Context
         </code>
         çš„ç»„ä»¶éƒ½ä¼šé‡æ–°æ¸²æŸ“
        </strong>
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         ä»£ç æ›´æ¸…æ™°
        </strong>
       </td>
       <td>
        <strong>
         ä¸é€‚åˆé«˜é¢‘ç‡å˜åŒ–çš„æ•°æ®
        </strong>
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         é€‚ç”¨äºå…±äº«çŠ¶æ€ï¼ˆç”¨æˆ·ã€ä¸»é¢˜ã€è¯­è¨€ç­‰ï¼‰
        </strong>
       </td>
       <td>
        <strong>
         å¤æ‚
         <code>
          Context
         </code>
         å¯èƒ½å˜å¾—éš¾ä»¥ç»´æŠ¤
        </strong>
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         æ¯” Reduxã€Recoil è½»é‡
        </strong>
       </td>
       <td>
        <strong>
         æ— æ³•è·¨åº”ç”¨å…±äº«æ•°æ®
        </strong>
       </td>
      </tr>
     </tbody>
    </table>
    <hr/>
    <h3>
     <a id="_189">
     </a>
     <strong>
      æœ€ä½³å®è·µ
     </strong>
    </h3>
    <p>
     âœ…
     <strong>
      ç”¨
      <code>
       useContext
      </code>
      ç®¡ç†â€œå…¨å±€ä½†å˜åŒ–ä¸é¢‘ç¹çš„æ•°æ®â€
     </strong>
     ï¼ˆå¦‚
     <strong>
      ä¸»é¢˜ã€ç”¨æˆ·ä¿¡æ¯ã€è¯­è¨€
     </strong>
     ï¼‰ã€‚
     <br/>
     âœ…
     <strong>
      é¿å…å°†é«˜é¢‘ç‡å˜åŒ–çš„çŠ¶æ€æ”¾å…¥
      <code>
       useContext
      </code>
     </strong>
     ï¼Œæ”¹ç”¨
     <code>
      useState
     </code>
     æˆ–
     <code>
      useRef
     </code>
     ã€‚
     <br/>
     âœ…
     <strong>
      å¦‚æœ
      <code>
       Context
      </code>
      å¤ªå¤§ï¼Œæ‹†åˆ†å¤šä¸ª Contextï¼Œé¿å…ä¸å¿…è¦çš„æ¸²æŸ“
     </strong>
     ã€‚
     <br/>
     âœ…
     <strong>
      å¯¹äºå¤æ‚çŠ¶æ€ç®¡ç†ï¼ˆå¦‚ Reduxã€Recoilã€Zustandï¼‰ï¼Œå¯ä»¥ç»“åˆ
      <code>
       useContext
      </code>
      ä½¿ç”¨
     </strong>
     ã€‚
    </p>
    <hr/>
    <p>
     ğŸ’¡
     <strong>
      æ€»ç»“ä¸€å¥è¯ï¼š
      <code>
       useContext
      </code>
      å¾ˆå¥½ç”¨ï¼Œä½†å¦‚æœç”¨é”™åœ°æ–¹ï¼Œå¯èƒ½ä¼šæ‹–ç´¯æ€§èƒ½ï¼
     </strong>
     ğŸš€
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f753031323434363936332f:61727469636c652f64657461696c732f313436303738313233" class_="artid" style="display:none">
 </p>
</div>


