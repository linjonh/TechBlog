---
arturl_encode: "68747470733a2f2f:626c6f672e6373646e2e6e65742f753031323434363936332f:61727469636c652f64657461696c732f313436303738313233"
layout: post
title: "reactä¸­çš„useContext-å¼Šç«¯äºŒ"
date: 2025-03-06 19:19:13 +08:00
description: "æ–¹é¢éå¸¸æœ‰ç”¨ï¼Œä½†å®ƒå¹¶ä¸æ˜¯ä¸‡èƒ½çš„ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®ƒå¯èƒ½ä¼šå¸¦æ¥ã€‚ä¸­å­˜å‚¨çš„æ•°æ®ç»“æ„è¿‡äºå¤æ‚ï¼Œä¼šå¯¼è‡´ä»£ç å˜å¾—éš¾ä»¥ç®¡ç†ã€‚ï¼Œå› ä¸ºå®ƒä¼šå¯¼è‡´æ•´ä¸ªç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚åªèƒ½åœ¨ React ç»„ä»¶æ ‘çš„ã€‚å¦‚æœæŸä¸ªçŠ¶æ€å˜åŒ–éå¸¸é¢‘ç¹ï¼ˆå¦‚ã€‚ï¼Œä»£ç æ›´æ¸…æ™°ï¼Œç»´æŠ¤æ›´å®¹æ˜“ã€‚"
keywords: "react usecontentçš„ç¼ºç‚¹"
categories: ['React']
tags: ['å‰ç«¯', 'React', 'Javascript']
artid: "146078123"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146078123
    alt: "reactä¸­çš„useContext-å¼Šç«¯äºŒ"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146078123
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146078123
cover: https://bing.ee123.net/img/rand?artid=146078123
image: https://bing.ee123.net/img/rand?artid=146078123
img: https://bing.ee123.net/img/rand?artid=146078123
---

# reactä¸­çš„useContext-å¼Šç«¯ï¼ˆäºŒï¼‰

`useContext`
åœ¨è§£å†³
**â€œprops ä¼ é€’åœ°ç‹±â€**
æ–¹é¢éå¸¸æœ‰ç”¨ï¼Œä½†å®ƒå¹¶ä¸æ˜¯ä¸‡èƒ½çš„ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®ƒå¯èƒ½ä¼šå¸¦æ¥
**æ€§èƒ½é—®é¢˜å’Œç»´æŠ¤ä¸Šçš„æŒ‘æˆ˜**
ã€‚ä»¥ä¸‹æ˜¯
`useContext`
çš„å‡ ä¸ªä¸»è¦å¼Šç«¯ï¼š

---

### **1. ç»„ä»¶æ›´æ–°å¯èƒ½å½±å“æ•´ä¸ª Context**

**é—®é¢˜**
ï¼šå½“
`Context`
çš„å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œ
**æ‰€æœ‰ä½¿ç”¨è¯¥ Context çš„ç»„ä»¶éƒ½ä¼šé‡æ–°æ¸²æŸ“**
ï¼Œå³ä½¿å®ƒä»¬åªä¾èµ–
`Context`
çš„éƒ¨åˆ†æ•°æ®ã€‚

* è¿™å¯èƒ½ä¼šå¯¼è‡´
  **ä¸å¿…è¦çš„æ¸²æŸ“**
  ï¼Œé™ä½åº”ç”¨çš„æ€§èƒ½ã€‚

#### **ç¤ºä¾‹ï¼šæ•´ä¸ªç»„ä»¶æ ‘éƒ½è¢«é‡æ–°æ¸²æŸ“**

```jsx
const UserContext = createContext();

const UserProvider = ({ children }) => {
  const [user, setUser] = useState({ name: "John", age: 24 });

  return (
    <UserContext.Provider value={{ user, setUser }}>
      {children}
    </UserContext.Provider>
  );
};

// å­ç»„ä»¶ 1ï¼šåªæ˜¾ç¤ºç”¨æˆ·å§“å
const UserName = () => {
  const { user } = useContext(UserContext);
  console.log("UserName ç»„ä»¶æ›´æ–°");
  return <h2>å§“å: {user.name}</h2>;
};

// å­ç»„ä»¶ 2ï¼šä¿®æ”¹ç”¨æˆ·å¹´é¾„
const UserAgeUpdater = () => {
  const { setUser } = useContext(UserContext);
  console.log("UserAgeUpdater ç»„ä»¶æ›´æ–°");

  return <button onClick={() => setUser(prev => ({ ...prev, age: prev.age + 1 }))}>å¢åŠ å¹´é¾„</button>;
};

// App ç»„ä»¶
const App = () => (
  <UserProvider>
    <UserName />
    <UserAgeUpdater />
  </UserProvider>
);

export default App;

```

#### **é—®é¢˜å‡ºç°äº†ï¼**

* å½“
  `UserAgeUpdater`
  æ›´æ–°
  `age`
  æ—¶ï¼Œ
  `UserName`
  ç»„ä»¶
  **ä¹Ÿä¼šé‡æ–°æ¸²æŸ“**
  ï¼Œå°½ç®¡å®ƒ
  **æ²¡æœ‰ä½¿ç”¨
  `age`**
  ï¼
* è¿™ä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™ï¼Œå°¤å…¶æ˜¯å½“
  `Context`
  ä¸­çš„æ•°æ®é‡å¾ˆå¤§ï¼Œæˆ–è€…ç»„ä»¶å±‚çº§å¾ˆæ·±æ—¶ã€‚

#### **è§£å†³æ–¹æ¡ˆ**

**æ‹†åˆ†
`Context`**
ï¼Œè®©ä¸åŒæ•°æ®ç‹¬ç«‹ç®¡ç†ï¼Œé¿å…ä¸å¿…è¦çš„æ¸²æŸ“ï¼š

```jsx
const UserNameContext = createContext();
const UserAgeContext = createContext();

const UserProvider = ({ children }) => {
  const [name, setName] = useState("John");
  const [age, setAge] = useState(24);

  return (
    <UserNameContext.Provider value={{ name, setName }}>
      <UserAgeContext.Provider value={{ age, setAge }}>
        {children}
      </UserAgeContext.Provider>
    </UserNameContext.Provider>
  );
};

```

âœ… è¿™æ ·ï¼Œ
`UserName`
ç»„ä»¶åªä¼šåœ¨
`name`
å˜åŒ–æ—¶æ›´æ–°ï¼Œ
`UserAgeUpdater`
åªä¼šåœ¨
`age`
å˜åŒ–æ—¶æ›´æ–°ï¼

---

### **2. å¤æ‚çš„ `Context` å¯èƒ½éš¾ä»¥ç»´æŠ¤**

å¦‚æœ
`Context`
ä¸­å­˜å‚¨çš„æ•°æ®ç»“æ„è¿‡äºå¤æ‚ï¼Œä¼šå¯¼è‡´ä»£ç å˜å¾—éš¾ä»¥ç®¡ç†ã€‚ä¾‹å¦‚ï¼š

```jsx
const AppContext = createContext();

const AppProvider = ({ children }) => {
  const [state, setState] = useState({
    user: { name: "John", age: 24 },
    theme: "dark",
    language: "zh",
    notifications: [],
  });

  return (
    <AppContext.Provider value={{ state, setState }}>
      {children}
    </AppContext.Provider>
  );
};

```

**é—®é¢˜**
ï¼š

* `Context`
  å˜æˆäº†ä¸€ä¸ª
  **å¤§æ‚çƒ©**
  ï¼Œæ‰€æœ‰çŠ¶æ€éƒ½å­˜æ”¾åœ¨ä¸€èµ·ã€‚
* ä»»ä½•ä¸€ä¸ªçŠ¶æ€å˜åŒ–ï¼Œéƒ½ä¼šè§¦å‘æ•´ä¸ª
  `Context`
  ç›¸å…³çš„ç»„ä»¶æ›´æ–°ã€‚

#### **è§£å†³æ–¹æ¡ˆ**

**æ‹†åˆ†å¤šä¸ª Context**
ï¼Œæ¯”å¦‚ï¼š

```jsx
const UserContext = createContext();
const ThemeContext = createContext();
const LanguageContext = createContext();

```

âœ… è¿™æ ·ï¼Œæ¯ä¸ª
`Context`
åªç®¡ç†
**ç‰¹å®šçš„æ•°æ®**
ï¼Œä»£ç æ›´æ¸…æ™°ï¼Œç»´æŠ¤æ›´å®¹æ˜“ã€‚

---

### **3. `useContext` é€‚ç”¨äºâ€œé™æ€æ•°æ®â€ï¼Œä½†ä¸é€‚åˆé«˜é¢‘ç‡å˜åŒ–çš„çŠ¶æ€**

å¦‚æœæŸä¸ªçŠ¶æ€å˜åŒ–éå¸¸é¢‘ç¹ï¼ˆå¦‚
**é¼ æ ‡ç§»åŠ¨ä½ç½®ã€WebSocket æ•°æ®ã€å€’è®¡æ—¶**
ï¼‰ï¼Œä½¿ç”¨
`useContext`
å¯èƒ½ä¼šå¯¼è‡´
**æ€§èƒ½é—®é¢˜**
ï¼Œå› ä¸ºå®ƒä¼šå¯¼è‡´æ•´ä¸ªç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚

#### **ç¤ºä¾‹ï¼šé«˜é¢‘ç‡å˜åŒ–çš„æ•°æ®**

```jsx
const MouseContext = createContext();

const MouseProvider = ({ children }) => {
  const [position, setPosition] = useState({ x: 0, y: 0 });

  useEffect(() => {
    const handleMouseMove = (event) => {
      setPosition({ x: event.clientX, y: event.clientY });
    };
    window.addEventListener("mousemove", handleMouseMove);
    return () => window.removeEventListener("mousemove", handleMouseMove);
  }, []);

  return (
    <MouseContext.Provider value={position}>
      {children}
    </MouseContext.Provider>
  );
};

```

**é—®é¢˜**
ï¼š

* `position`
  å˜åŒ–
  **éå¸¸é¢‘ç¹**
  ï¼Œå¯¼è‡´
  **æ‰€æœ‰ä½¿ç”¨
  `MouseContext`
  çš„ç»„ä»¶éƒ½é‡æ–°æ¸²æŸ“**
  ï¼Œå½±å“æ€§èƒ½ã€‚

#### **è§£å†³æ–¹æ¡ˆ**

* âœ…
  **æ”¹ç”¨
  `useRef`
  æˆ–
  `useState`
  åªæ›´æ–°éœ€è¦çš„ç»„ä»¶**
  ã€‚
* âœ…
  **ç”¨
  `Redux`
  ã€
  `Recoil`
  è¿™ç±»çŠ¶æ€ç®¡ç†å·¥å…·ï¼Œä¼˜åŒ–æ€§èƒ½**
  ã€‚

---

### **4. `useContext` ä¸èƒ½è·¨åº”ç”¨ä½¿ç”¨**

`useContext`
åªèƒ½åœ¨ React ç»„ä»¶æ ‘çš„
**åŒä¸€ä¸ªå±‚çº§**
ä¸‹ä½¿ç”¨ï¼Œ
**ä¸èƒ½è·¨é¡µé¢æˆ–è·¨åº”ç”¨å…±äº«**
æ•°æ®ã€‚ä¾‹å¦‚ï¼š

* **å¦‚æœä½ åœ¨
  `App1`
  é‡Œåˆ›å»ºäº†
  `UserContext`
  ï¼Œå®ƒåœ¨
  `App2`
  ä¸­æ— æ³•ä½¿ç”¨**
  ã€‚
* **å¦‚æœä½ æœ‰å¤šä¸ª React æ¸²æŸ“æ ¹ï¼ˆå¤šä¸ª
  `ReactDOM.createRoot()`
  ï¼‰ï¼Œå®ƒä»¬çš„
  `Context`
  æ˜¯ç‹¬ç«‹çš„**
  ã€‚

**è§£å†³æ–¹æ¡ˆ**
ï¼š

* **ä½¿ç”¨å…¨å±€çŠ¶æ€ç®¡ç†å·¥å…·ï¼Œå¦‚ Reduxã€Recoilã€Zustand**
  ï¼Œå®ƒä»¬æ”¯æŒè·¨åº”ç”¨å…±äº«æ•°æ®ã€‚

---

### **5. ä¾èµ– `Context.Provider` ï¼Œæ— æ³•ç‹¬ç«‹ä½¿ç”¨**

ä½¿ç”¨
`useContext`
å¿…é¡»åœ¨
`Context.Provider`
**å†…éƒ¨**
ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼š

```jsx
const MyComponent = () => {
  const { user } = useContext(UserContext); // âŒ é”™è¯¯
  return <p>{user.name}</p>;
};

// å¿…é¡»åœ¨ `UserProvider` åŒ…è£¹ä¸‹ä½¿ç”¨
const App = () => (
  <UserProvider>
    <MyComponent />
  </UserProvider>
);

```

**é—®é¢˜**
ï¼š

* å¦‚æœä½ 
  **å¿˜è®°åœ¨
  `Provider`
  é‡ŒåŒ…è£¹ç»„ä»¶**
  ï¼Œ
  `useContext`
  ä¼šæŠ¥é”™ã€‚
* **å¦‚æœç»„ä»¶å¯èƒ½åœ¨å¤šä¸ªåœ°æ–¹å¤ç”¨**
  ï¼ˆæœ‰äº›åœ°æ–¹æ²¡æœ‰
  `Provider`
  ï¼‰ï¼Œä»£ç å°±ä¼šå‡ºé—®é¢˜ã€‚

âœ…
**è§£å†³æ–¹æ¡ˆ**
ï¼šå¯ä»¥åœ¨
`useContext`
é‡ŒåŠ ä¸€ä¸ªé»˜è®¤å€¼ï¼Œé¿å…æŠ¥é”™ï¼š

```jsx
const UserContext = createContext({ user: { name: "é»˜è®¤ç”¨æˆ·" } });

```

---

### **æ€»ç»“**

| `useContext` çš„ä¼˜ç‚¹ | `useContext` çš„ç¼ºç‚¹ |
| --- | --- |
| **é¿å… props ä¼ é€’åœ°ç‹±** | **æ‰€æœ‰ä½¿ç”¨ `Context` çš„ç»„ä»¶éƒ½ä¼šé‡æ–°æ¸²æŸ“** |
| **ä»£ç æ›´æ¸…æ™°** | **ä¸é€‚åˆé«˜é¢‘ç‡å˜åŒ–çš„æ•°æ®** |
| **é€‚ç”¨äºå…±äº«çŠ¶æ€ï¼ˆç”¨æˆ·ã€ä¸»é¢˜ã€è¯­è¨€ç­‰ï¼‰** | **å¤æ‚ `Context` å¯èƒ½å˜å¾—éš¾ä»¥ç»´æŠ¤** |
| **æ¯” Reduxã€Recoil è½»é‡** | **æ— æ³•è·¨åº”ç”¨å…±äº«æ•°æ®** |

---

### **æœ€ä½³å®è·µ**

âœ…
**ç”¨
`useContext`
ç®¡ç†â€œå…¨å±€ä½†å˜åŒ–ä¸é¢‘ç¹çš„æ•°æ®â€**
ï¼ˆå¦‚
**ä¸»é¢˜ã€ç”¨æˆ·ä¿¡æ¯ã€è¯­è¨€**
ï¼‰ã€‚
  
âœ…
**é¿å…å°†é«˜é¢‘ç‡å˜åŒ–çš„çŠ¶æ€æ”¾å…¥
`useContext`**
ï¼Œæ”¹ç”¨
`useState`
æˆ–
`useRef`
ã€‚
  
âœ…
**å¦‚æœ
`Context`
å¤ªå¤§ï¼Œæ‹†åˆ†å¤šä¸ª Contextï¼Œé¿å…ä¸å¿…è¦çš„æ¸²æŸ“**
ã€‚
  
âœ…
**å¯¹äºå¤æ‚çŠ¶æ€ç®¡ç†ï¼ˆå¦‚ Reduxã€Recoilã€Zustandï¼‰ï¼Œå¯ä»¥ç»“åˆ
`useContext`
ä½¿ç”¨**
ã€‚

---

ğŸ’¡
**æ€»ç»“ä¸€å¥è¯ï¼š
`useContext`
å¾ˆå¥½ç”¨ï¼Œä½†å¦‚æœç”¨é”™åœ°æ–¹ï¼Œå¯èƒ½ä¼šæ‹–ç´¯æ€§èƒ½ï¼**
ğŸš€