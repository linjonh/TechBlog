---
layout: post
title: "Python-数据分析Pandas四一维数组Series的统计计算,分组和聚合"
date: 2025-03-16 09:53:41 +0800
description: "Pandas中的一维数组Series提供了丰富的统计计算功能，包括均值、方差、标准差等，用户可以通过简单的语法快速进行这些计算。此外，Pandas支持对Series进行分组和聚合操作，使得可以根据特定条件对数据进行分类统计，方便分析各组的特征和趋势。"
keywords: "Python----数据分析（Pandas四：一维数组Series的统计计算，分组和聚合）"
categories: ['数据分析', 'Python']
tags: ['数据分析', 'Python', 'Pandas']
artid: "145883816"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=145883816
    alt: "Python-数据分析Pandas四一维数组Series的统计计算,分组和聚合"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=145883816
featuredImagePreview: https://bing.ee123.net/img/rand?artid=145883816
cover: https://bing.ee123.net/img/rand?artid=145883816
image: https://bing.ee123.net/img/rand?artid=145883816
img: https://bing.ee123.net/img/rand?artid=145883816
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Python----数据分析（Pandas四：一维数组Series的统计计算，分组和聚合）
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h3>
     一、统计计算
    </h3>
    <h3>
     1.1、 count
    </h3>
    <p>
     用于计算 Series中非NaN（非空）值的数量。
    </p>
    <pre><code class="language-python">import pandas as pd

s = pd.Series([1, 2, None, 4, None])

count_non_na = s.count()
print(count_non_na)</code></pre>
    <h3>
     1.2、 sum
    </h3>
    <p>
     sum() 函数会计算所有值的总和。
    </p>
    <pre><code class="language-python">Series.sum(axis=None, skipna=True, numeric_only=None, min_count=0)</code></pre>
    <table align="center" border="1" cellpadding="1" cellspacing="1">
     <thead>
      <tr>
       <th>
        描述
       </th>
       <th>
        说明
       </th>
      </tr>
      <tr>
       <td>
        axis
       </td>
       <td>
        对于 Series对象来说，这个参数通常不起作用，因为 Series是一维的。 它主要在 DataFrame对象中用于指定操作的轴（0表示按列求和，1表示按行求 和）。
       </td>
      </tr>
      <tr>
       <td>
        skipna
       </td>
       <td>
        布尔值，默认为True,如果为True，则在计算总和时会忽略NaN值 。 如果为False，则返回NaN。
       </td>
      </tr>
      <tr>
       <td>
        numeric_only
       </td>
       <td>
        布尔值，默认为None。如果为True，则只对数字类型的数据进行计算，只针对DataFrame。
       </td>
      </tr>
      <tr>
       <td>
        min_count
       </td>
       <td>
        int值，默认为0。表示在计算总和之前，至少需要多少个非NaN值.如果非NaN值的数量小于min_count，则结果为 NaN。
       </td>
      </tr>
     </thead>
    </table>
    <pre><code class="language-python">import pandas as pd
s = pd.Series([1, 2, None, 4, 5])
total = s.sum(min_count=5)
print(total)</code></pre>
    <h3>
     1.3、 mean
    </h3>
    <p>
     mean() 函数会计算所有值的平均值。
    </p>
    <pre><code class="language-python">Series.mean(axis=None, skipna=True, numeric_only=None)</code></pre>
    <table align="center" border="1" cellpadding="1" cellspacing="1">
     <thead>
      <tr>
       <th>
        描述
       </th>
       <th>
        说明
       </th>
      </tr>
      <tr>
       <td>
        axis
       </td>
       <td>
        对于 Series对象来说，这个参数通常不起作用，因为 Series是一维的。 它主要在 DataFrame对象中用于指定操作的轴（0表示按列计算平均值，1表示按 行计算平均值）。
       </td>
      </tr>
      <tr>
       <td>
        skipna
       </td>
       <td>
        布尔值，默认为True,如果为True，则在计算总和时会忽略NaN值 。 如果为False，则返回NaN。
       </td>
      </tr>
      <tr>
       <td>
        numeric_only
       </td>
       <td>
        布尔值，默认为None。如果为True，则只对数字类型的数据进行计算，只针对DataFrame。
       </td>
      </tr>
     </thead>
    </table>
    <h3>
     1.4、 median
    </h3>
    <p>
     median()函数用于计算DataFrame或Series中的中位数。
    </p>
    <pre><code class="language-python">Series.median(axis=0, skipna=True, numeric_only=False)</code></pre>
    <table align="center" border="1" cellpadding="1" cellspacing="1">
     <thead>
      <tr>
       <th>
        描述
       </th>
       <th>
        说明
       </th>
      </tr>
      <tr>
       <td>
        axis
       </td>
       <td>
        对于 Series对象来说，这个参数通常不起作用，因为 Series是一维的。 它主要在 DataFrame对象中用于指定操作的轴（0表示按列计算中位数，1表示按 行计算中位数）。
       </td>
      </tr>
      <tr>
       <td>
        skipna
       </td>
       <td>
        布尔值，默认为True,如果为True，则在计算总和时会忽略NaN值 。 如果为False，则返回NaN。
       </td>
      </tr>
      <tr>
       <td>
        numeric_only
       </td>
       <td>
        布尔值，默认为None。如果为True，则只对数字类型的数据进行计算，只针对DataFrame。
       </td>
      </tr>
     </thead>
    </table>
    <pre><code class="language-python">import pandas as pd

s = pd.Series([1, 2, 3, 4, 5])
median_value = s.median()
print(median_value)</code></pre>
    <h3>
     1.5、 min和max
    </h3>
    <p>
     Series.min()函数用于计算Series对象中的最小值， Series.max()函数用于计算Series对象中的最大值。
    </p>
    <pre><code class="language-python">Series.min(axis=0, skipna=True, numeric_only=False)</code></pre>
    <pre><code class="language-python">Series.max(axis=0, skipna=True, numeric_only=False)</code></pre>
    <table align="center" border="1" cellpadding="1" cellspacing="1">
     <thead>
      <tr>
       <th>
        描述
       </th>
       <th>
        说明
       </th>
      </tr>
      <tr>
       <td>
        axis
       </td>
       <td>
        对于 Series对象来说，这个参数通常不起作用，因为 Series是一维的。 它主要在 DataFrame对象中用于指定操作的轴（0表示按列计算最大最小值，1表示按 行计算最大最小值）。
       </td>
      </tr>
      <tr>
       <td>
        skipna
       </td>
       <td>
        布尔值，默认为True,如果为True，则在计算总和时会忽略NaN值 。 如果为False，则返回NaN。
       </td>
      </tr>
      <tr>
       <td>
        numeric_only
       </td>
       <td>
        布尔值，默认为None。如果为True，则只对数字类型的数据进行计算，只针对DataFrame。
       </td>
      </tr>
     </thead>
    </table>
    <pre><code class="language-python">import pandas as pd
s = pd.Series([1, 2, 3, 4, 5])
min_value = s.min()
max_value = s.max()
print('最小值是：', min_value)
print('最大值是：', max_value)</code></pre>
    <h3>
     1.6、 var
    </h3>
    <p>
     Series.var()函数用于计算Series对象的方差。
    </p>
    <pre><code class="language-python">Series.var(axis=None, skipna=True, ddof=1, numeric_only=False)</code></pre>
    <table align="center" border="1" cellpadding="1" cellspacing="1">
     <thead>
      <tr>
       <th>
        描述
       </th>
       <th>
        说明
       </th>
      </tr>
      <tr>
       <td>
        axis
       </td>
       <td>
        对于 在DataFrame中， Series对象，这个参数不会产生任何效果，因为 Series是一维的。axis用于指定沿着哪个轴计算方差。
       </td>
      </tr>
      <tr>
       <td>
        skipna
       </td>
       <td>
        布尔值，默认为 True。如果为 True，则在计算方差之前会忽略 NaN 值。如果设置为 False，计算方差时会包括 NaN值，通常会导致结果也是 NaN。
       </td>
      </tr>
      <tr>
       <td>
        ddof
       </td>
       <td>
        整数，默认为1。Delta Degrees of Freedom，用于贝塞尔校正，以得到 样本方差的估计。对于无偏估计（样本方差）， ddof通常设置为1。如果计算总 体方差，应该将 ddof设置为0。
       </td>
      </tr>
      <tr>
       <td>
        numeric_only
       </td>
       <td>
        布尔值，默认为False，如果为True ，则只对数字类型的数据进行方差计算，忽略非数字类型的数据。
       </td>
      </tr>
     </thead>
    </table>
    <pre><code class="language-python">import pandas as pd
import numpy as np
s = pd.Series([1, 2, np.nan, 4, 5])
variance = s.var()
print('方差是：', variance)</code></pre>
    <h3>
     1.7、 std
    </h3>
    <p>
     Series.std()函数用于计算Series对象的标准差。
    </p>
    <pre><code class="language-python">Series.std(axis=None, skipna=True, ddof=1, numeric_only=False, **kwargs)</code></pre>
    <table align="center" border="1" cellpadding="1" cellspacing="1">
     <thead>
      <tr>
       <th>
        描述
       </th>
       <th>
        说明
       </th>
      </tr>
      <tr>
       <td>
        axis
       </td>
       <td>
        对于Series来说，这个参数不会产生任何效果，因为Series是一维的。它 主要用于DataFrame，以指定沿着哪个轴计算标准差。
       </td>
      </tr>
      <tr>
       <td>
        skipna
       </td>
       <td>
        布尔值，默认为True。如果为True，则在计算标准差之前会忽略NaN 值，如果为False，则返回NaN。
       </td>
      </tr>
      <tr>
       <td>
        ddof
       </td>
       <td>
        整数，默认为1。Delta Degrees of Freedom，是贝塞尔校正的参数。对 于无偏估计（样本标准差），ddof通常设置为1。
       </td>
      </tr>
      <tr>
       <td>
        numeric_only
       </td>
       <td>
        布尔值，默认为False。如果为True，则只对数字类型的数据进 行计算，只针对DataFrame。
       </td>
      </tr>
      <tr>
       <td>
        **kwargs
       </td>
       <td>
        其他关键字参数
       </td>
      </tr>
     </thead>
    </table>
    <pre><code class="language-python">import pandas as pd
import numpy as np
s = pd.Series([1, 2, np.nan, 4, 5])
std_dev = s.std()
print('标准差是：', std_dev)</code></pre>
    <h3>
     1.8、 quantile
    </h3>
    <p>
     Series.quantile() 方法用于计算Series中数值的分位数。
    </p>
    <pre><code class="language-python">Series.quantile(q=0.5, interpolation='linear')</code></pre>
    <table align="center" border="1" cellpadding="1" cellspacing="1">
     <thead>
      <tr>
       <th>
        描述
       </th>
       <th>
        说明
       </th>
      </tr>
      <tr>
       <td>
        q
       </td>
       <td>
        这个参数是必需的，它表示要计算的分位数值。可以是单一的数值，也可以 是一个数值列表。例如， q=0.5 表示计算中位数（50%分位数）。
       </td>
      </tr>
      <tr>
       <td>
        interpolation
       </td>
       <td>
        这个参数决定了当所需的分位数位于两个数据点之间时，应该 如何插值。默认值是 'linear'，表示线性插值。其他选项包括 近的值）、 'lower'（选择较小的值）、 'nearest'（最 'higher'（选择较大的 值）、 'midpoint'（两个值的中间点）。
       </td>
      </tr>
     </thead>
    </table>
    <p>
     <img src="https://i-blog.csdnimg.cn/direct/80742f37ac294e038596af9873f2e224.png"/>
    </p>
    <blockquote>
     <p>
      计算0.5分位数
     </p>
     <pre><code class="language-python">import pandas as pd

s = pd.Series([1, 2, 3, 4, 5])

median_value = s.quantile(q=0.5, interpolation='linear')
print(median_value)</code></pre>
    </blockquote>
    <h3>
     1.9、 cummax
    </h3>
    <p>
     该方法用于计算Series中元素的累积最大值，返回一个相同长度的Series，其中每个 位置上的值表示从Series开始到当前位置（包括当前位置）的最大值。
    </p>
    <pre><code class="language-python">Series.cummax(axis=None, skipna=True, *args, **kwargs)</code></pre>
    <table align="center" border="1" cellpadding="1" cellspacing="1">
     <thead>
      <tr>
       <th>
        描述
       </th>
       <th>
        说明
       </th>
      </tr>
      <tr>
       <td>
        axis
       </td>
       <td>
        对于Series来说，这个参数不起作用，因为Series是一维的。在 DataFrame上使用时， axis=0（默认）表示按列计算， axis=1表示按行计算。
       </td>
      </tr>
      <tr>
       <td>
        skipna
       </td>
       <td>
        布尔值，默认为True。如果为True，则在计算累积最大值时会忽略NaN 值；如果为False，则任何NaN值都会导致结果在该位置及之后的值都为NaN。
       </td>
      </tr>
      <tr>
       <td>
        *args, **kwargs
       </td>
       <td>
        这些参数用于兼容性，通常不需要使用。
       </td>
      </tr>
     </thead>
    </table>
    <pre><code class="language-python">import pandas as pd

s = pd.Series([1, 2, None, 4, 5])

cumsum_series = s.cummax()
print(cumsum_series)</code></pre>
    <h3>
     1.10、 cummin
    </h3>
    <p>
     该方法用于计算Series中元素的累积最小值，返回一个相同长度的Series，其中每个 位置上的值表示从Series开始到当前位置（包括当前位置）的最小值。
    </p>
    <pre><code class="language-python">Series.cummin(axis=None, skipna=True, *args, **kwargs)</code></pre>
    <table align="center" border="1" cellpadding="1" cellspacing="1">
     <thead>
      <tr>
       <th>
        描述
       </th>
       <th>
        说明
       </th>
      </tr>
      <tr>
       <td>
        axis
       </td>
       <td>
        对于Series来说，这个参数不起作用，因为Series是一维的。在 DataFrame上使用时， axis=0（默认）表示按列计算， axis=1表示按行计算。
       </td>
      </tr>
      <tr>
       <td>
        skipna
       </td>
       <td>
        布尔值，默认为True。如果为True，则在计算累积最小值时会忽略NaN 值；如果为False，则任何NaN值都会导致结果在该位置及之后的值都为NaN。
       </td>
      </tr>
      <tr>
       <td>
        *args, **kwargs
       </td>
       <td>
        这些参数用于兼容性，通常不需要使用。
       </td>
      </tr>
     </thead>
    </table>
    <pre><code class="language-python">import pandas as pd

s = pd.Series([1, 2, None, 4, 5])

cumsum_series = s.cummin()
print(cumsum_series)</code></pre>
    <h3>
     1.11、 cumsum
    </h3>
    <p>
     用于计算Series中元素的累积和。该方法返回一个相同长度的Series，其中每个位置 上的值表示从Series开始到当前位置（包括当前位置）的所有元素的累加和。
    </p>
    <pre><code class="language-python">Series.cumsum(axis=None, skipna=True, *args, **kwargs)</code></pre>
    <table align="center" border="1" cellpadding="1" cellspacing="1">
     <thead>
      <tr>
       <th>
        描述
       </th>
       <th>
        说明
       </th>
      </tr>
      <tr>
       <td>
        axis
       </td>
       <td>
        对于Series来说，这个参数不起作用，因为Series是一维的。在 DataFrame上使用时， axis=0（默认）表示按列计算， axis=1表示按行计算。
       </td>
      </tr>
      <tr>
       <td>
        skipna
       </td>
       <td>
        布尔值，默认为True。如果为True，则在计算累积和时会忽略NaN 值；如果为False，则任何NaN值都会导致结果在该位置及之后的值都为NaN。
       </td>
      </tr>
      <tr>
       <td>
        *args, **kwargs
       </td>
       <td>
        这些参数用于兼容性，通常不需要使用。
       </td>
      </tr>
     </thead>
    </table>
    <pre><code class="language-python">import pandas as pd

s = pd.Series([1, 2, None, 4, 5])

cumsum_series = s.cumsum()
print(cumsum_series)</code></pre>
    <h3>
     1.12、 cumprod
    </h3>
    <p>
     用于计算Series中元素的累积乘积。该方法返回一个相同长度的Series，其中每个位 置上的值表示从Series开始到当前位置（包括当前位置）的所有元素的累积乘积。
    </p>
    <pre><code class="language-python">Series.cumprod(axis=None, skipna=True, *args, **kwargs)</code></pre>
    <table align="center" border="1" cellpadding="1" cellspacing="1">
     <thead>
      <tr>
       <th>
        描述
       </th>
       <th>
        说明
       </th>
      </tr>
      <tr>
       <td>
        axis
       </td>
       <td>
        对于Series来说，这个参数不起作用，因为Series是一维的。在 DataFrame上使用时， axis=0（默认）表示按列计算， axis=1表示按行计算。
       </td>
      </tr>
      <tr>
       <td>
        skipna
       </td>
       <td>
        布尔值，默认为True。如果为True，则在计算累积乘积时会忽略NaN 值；如果为False，则任何NaN值都会导致结果在该位置及之后的值都为NaN。
       </td>
      </tr>
      <tr>
       <td>
        *args, **kwargs
       </td>
       <td>
        这些参数用于兼容性，通常不需要使用。
       </td>
      </tr>
     </thead>
    </table>
    <pre><code class="language-python">import pandas as pd

s = pd.Series([1, 2, None, 4, 5])

cumprod_series = s.cumprod()
print(cumprod_series)</code></pre>
    <h3>
     二、分组和聚合
    </h3>
    <h3>
     2.1、groupby
    </h3>
    <p>
     用于将Series中的数据分组，并允许你对这些分组进行操作，比如计算每个组的总 和、平均值、最大值、最小值等。
    </p>
    <pre><code class="language-python">Series.groupby(by=None, axis=0, level=None, as_index=True, sort=True, group_keys=True, observed=False, dropna=True)</code></pre>
    <table align="center" border="1" cellpadding="1" cellspacing="1">
     <thead>
      <tr>
       <th>
        描述
       </th>
       <th>
        说明
       </th>
      </tr>
      <tr>
       <td>
        by
       </td>
       <td>
        确定分组依据，如果 by 是一个函数，它会在对象索引的每个值上调用。如 果传递了字典或Series，将使用这些对象的值来确定组。如果传递了长度等于所 选轴的列表或 ndarray，则直接使用这些值来确定组。
       </td>
      </tr>
      <tr>
       <td>
        axis
       </td>
       <td>
        用于分组的轴。对于Series，这个参数通常设置为0（默认值），因为 Series是一维数据结构。
       </td>
      </tr>
      <tr>
       <td>
        level
       </td>
       <td>
        如果索引是多级索引（MultiIndex），则此参数用于指定分组所依据的 级别，by和level同时只能存在一个，且必须存在一个。
       </td>
      </tr>
      <tr>
       <td>
        as_index
       </td>
       <td>
        是否将分组键作为结果的索引，默认值为True。仅与DataFrame 输入相关。
       </td>
      </tr>
      <tr>
       <td>
        sort
       </td>
       <td>
        是否对结果进行排序。默认值为 True。
       </td>
      </tr>
      <tr>
       <td>
        group_keys
       </td>
       <td>
        是否在结果中包含分组键。默认值为 True。
       </td>
      </tr>
      <tr>
       <td>
        observed
       </td>
       <td>
        是否仅包含实际观察到的分类值。默认值为 False。
       </td>
      </tr>
      <tr>
       <td>
        dropna
       </td>
       <td>
        是否从结果中排除包含 NaN 的组。默认值为 True。
       </td>
      </tr>
     </thead>
    </table>
    <pre><code class="language-python">import pandas as pd

data = [10, 20, 10, 30, 20, 10]
series = pd.Series(data)

grouped = series.groupby(series).count()
print(grouped)</code></pre>
    <h3>
     2.2、agg
    </h3>
    <p>
     Series.agg() 方法用于对Series中的数据进行聚合操作。
    </p>
    <pre><code class="language-python">Series.agg(func=None, axis=0, *args, **kwargs)</code></pre>
    <table align="center" border="1" cellpadding="1" cellspacing="1">
     <thead>
      <tr>
       <th>
        描述
       </th>
       <th>
        说明
       </th>
      </tr>
      <tr>
       <td>
        func
       </td>
       <td>
        聚合函数或函数列表/字典。可以是一个函数名称（字符串），也可以是实 际的函数对象，或者是这些的列表或字典。如果是字典，则键将是输出列的名 称，值应该是应用于Series的函数。
       </td>
      </tr>
      <tr>
       <td>
        axis
       </td>
       <td>
        整数或字符串，默认为0。由于Series是一维数据结构，这个参数实际上在 Series的上下文中不起作用。在DataFrame的上下文中，axis=0 表示按列进行 聚合， axis=1 表示按行进行聚合。
       </td>
      </tr>
      <tr>
       <td>
        *args
       </td>
       <td>
        位置参数，可以传递给 func。
       </td>
      </tr>
      <tr>
       <td>
        **kwargs
       </td>
       <td>
        关键字参数，可以传递给func。
       </td>
      </tr>
     </thead>
    </table>
    <pre><code class="language-python">import pandas as pd
s = pd.Series([1, 2, 3, 4, 5])

result = s.agg('mean')
print(result)  

result = s.agg(['max', 'min'])
print(result) 

result = s.agg({'Maximum': 'max', 'Minimum': 'min'})
print(result)  

def custom_agg(x, power):
    return (x ** power).sum()
result = s.agg(custom_agg, power=2)
print(result)</code></pre>
    <h2>
     三、思维导图
    </h2>
    <p>
     <img src="https://i-blog.csdnimg.cn/direct/d0d14f9f613a4103acabfd0c6e4e0754.png"/>
    </p>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f36343131303538392f:61727469636c652f64657461696c732f313435383833383136" class_="artid" style="display:none">
 </p>
</div>


