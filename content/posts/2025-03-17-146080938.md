---
layout: post
title: "Clist下list类的模拟实现含反向迭代器实现"
date: 2025-03-17 00:00:44 +0800
description: "list类的的模拟实现、ist的迭代器失效问题 以及 list与vector的对比。【C++】list(上)：list类的常用接口介绍。"
keywords: "【C++】list(下)：list类的模拟实现（含反向迭代器实现）"
categories: ['C']
tags: ['Windows', 'List', 'C']
artid: "146080938"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146080938
    alt: "Clist下list类的模拟实现含反向迭代器实现"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146080938
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146080938
cover: https://bing.ee123.net/img/rand?artid=146080938
image: https://bing.ee123.net/img/rand?artid=146080938
img: https://bing.ee123.net/img/rand?artid=146080938
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     【C++】list(下)：list类的模拟实现（含反向迭代器实现）
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <hr/>
    <h2>
     <a id="_4">
     </a>
     前言
    </h2>
    <blockquote>
     <p>
      <strong>
       list类的的模拟实现、ist的迭代器失效问题 以及 list与vector的对比。配套博客:
       <a href="https://blog.csdn.net/2302_76713442/article/details/145976786?spm=1001.2014.3001.5501">
        【C++】list(上)：list类的常用接口介绍
       </a>
      </strong>
     </p>
    </blockquote>
    <hr/>
    <h2>
     <a id="list_13">
     </a>
     一、list类的模拟实现
    </h2>
    <h3>
     <a id="1list_14">
     </a>
     1.list类的整体框架（声明）
    </h3>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;assert.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;initializer_list&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">namespace</span> zh
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// list的节点类</span>
    <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
    <span class="token keyword">struct</span> <span class="token class-name">listnode</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">listnode</span><span class="token punctuation">(</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> val <span class="token operator">=</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        listnode<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">*</span> _pre<span class="token punctuation">;</span>
        listnode<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">*</span> _next<span class="token punctuation">;</span>
        T _val<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// list的迭代器类</span>
    <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token punctuation">,</span><span class="token keyword">class</span> <span class="token class-name">reference</span><span class="token punctuation">,</span><span class="token keyword">class</span> <span class="token class-name">pointer</span><span class="token operator">&gt;</span>
    <span class="token keyword">struct</span> <span class="token class-name">listiterator</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">typedef</span> listnode<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> node<span class="token punctuation">;</span>
        <span class="token keyword">typedef</span> listiterator<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> reference<span class="token punctuation">,</span> pointer<span class="token operator">&gt;</span> lsiter<span class="token punctuation">;</span>

        <span class="token function">listiterator</span><span class="token punctuation">(</span>node<span class="token operator">*</span> fnode <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 默认构造</span>
        <span class="token function">listiterator</span><span class="token punctuation">(</span><span class="token keyword">const</span> lsiter<span class="token operator">&amp;</span> it<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 拷贝构造</span>
        lsiter<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> lsiter<span class="token operator">&amp;</span> it<span class="token punctuation">)</span><span class="token punctuation">;</span>
        reference <span class="token keyword">operator</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pointer <span class="token keyword">operator</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        lsiter<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        lsiter <span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 后置++</span>
        lsiter<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">--</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        lsiter <span class="token keyword">operator</span><span class="token operator">--</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 后置--</span>
        <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> lsiter<span class="token operator">&amp;</span> it<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> lsiter<span class="token operator">&amp;</span> it<span class="token punctuation">)</span><span class="token punctuation">;</span>

        node<span class="token operator">*</span> _node<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// list类</span>
    <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
    <span class="token keyword">class</span> <span class="token class-name">list</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">typedef</span> listnode<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> node<span class="token punctuation">;</span>
        <span class="token keyword">void</span> <span class="token function">greate_sentinel_guard</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 创建哨兵卫</span>
        <span class="token punctuation">{<!-- --></span>
            _head <span class="token operator">=</span> <span class="token keyword">new</span> node<span class="token punctuation">;</span>
            _head<span class="token operator">-&gt;</span>_pre <span class="token operator">=</span> _head<span class="token punctuation">;</span>
            _head<span class="token operator">-&gt;</span>_next <span class="token operator">=</span> _head<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token keyword">public</span><span class="token operator">:</span>
        <span class="token keyword">typedef</span> listiterator<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> T<span class="token operator">&amp;</span><span class="token punctuation">,</span> T<span class="token operator">*</span><span class="token operator">&gt;</span> iterator<span class="token punctuation">;</span>
        <span class="token keyword">typedef</span> listiterator<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">*</span><span class="token operator">&gt;</span> const_iterator<span class="token punctuation">;</span>
        <span class="token comment">///</span>
        <span class="token comment">// List的构造</span>
        <span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">list</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span> value <span class="token operator">=</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">InputIterator</span><span class="token operator">&gt;</span>
        <span class="token function">list</span><span class="token punctuation">(</span>InputIterator first<span class="token punctuation">,</span> InputIterator last<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token function">list</span><span class="token punctuation">(</span>initializer_list<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> il<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">list</span><span class="token punctuation">(</span><span class="token keyword">const</span> list<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">&amp;</span> lst<span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span>list<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> lst<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">~</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">///</span>
        <span class="token comment">// List Iterator</span>
        iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        const_iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
        const_iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>

        <span class="token comment">///</span>
        <span class="token comment">// List Capacity</span>
        size_t <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span><span class="token punctuation">;</span>
        <span class="token keyword">bool</span> <span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span><span class="token punctuation">;</span>

        <span class="token comment"></span>
        <span class="token comment">// List Access</span>
        T<span class="token operator">&amp;</span> <span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> T<span class="token operator">&amp;</span> <span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
        T<span class="token operator">&amp;</span> <span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> T<span class="token operator">&amp;</span> <span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>

        <span class="token comment"></span>
        <span class="token comment">// List Modify</span>
        <span class="token keyword">void</span> <span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">void</span> <span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">void</span> <span class="token function">push_front</span><span class="token punctuation">(</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">void</span> <span class="token function">pop_front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 在pos位置前插入值为val的节点</span>
        iterator <span class="token function">insert</span><span class="token punctuation">(</span>iterator pos<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 删除pos位置的节点，返回该节点的下一个位置</span>
        iterator <span class="token function">erase</span><span class="token punctuation">(</span>iterator pos<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>list<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">&amp;</span> lst<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span><span class="token operator">:</span>
        node<span class="token operator">*</span> _head<span class="token punctuation">;</span>
        size_t _size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="2list_121">
     </a>
     2.list的节点类模拟实现
    </h3>
    <pre><code class="prism language-cpp"><span class="token keyword">namespace</span> zh
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// list的节点类</span>
    <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
    <span class="token keyword">struct</span> <span class="token class-name">listnode</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">listnode</span><span class="token punctuation">(</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> val <span class="token operator">=</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token operator">:</span><span class="token function">_pre</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
            <span class="token punctuation">,</span><span class="token function">_next</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
            <span class="token punctuation">,</span><span class="token function">_val</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span> <span class="token punctuation">}</span>

        listnode<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">*</span> _pre<span class="token punctuation">;</span>
        listnode<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">*</span> _next<span class="token punctuation">;</span>
        T _val<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>    
</code></pre>
    <h3>
     <a id="3list_142">
     </a>
     3.list的迭代器类模拟实现
    </h3>
    <pre><code class="prism language-cpp"><span class="token keyword">namespace</span> zh
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// list的迭代器类</span>
    <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token punctuation">,</span><span class="token keyword">class</span> <span class="token class-name">reference</span><span class="token punctuation">,</span><span class="token keyword">class</span> <span class="token class-name">pointer</span><span class="token operator">&gt;</span>
    <span class="token keyword">struct</span> <span class="token class-name">listiterator</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">typedef</span> listnode<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> node<span class="token punctuation">;</span>
        <span class="token keyword">typedef</span> listiterator<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> reference<span class="token punctuation">,</span> pointer<span class="token operator">&gt;</span> lsiter<span class="token punctuation">;</span>

        <span class="token function">listiterator</span><span class="token punctuation">(</span>node<span class="token operator">*</span> fnode <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span>
            <span class="token operator">:</span><span class="token function">_node</span><span class="token punctuation">(</span>fnode<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span> <span class="token punctuation">}</span>

        <span class="token function">listiterator</span><span class="token punctuation">(</span><span class="token keyword">const</span> lsiter<span class="token operator">&amp;</span> it<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            _node <span class="token operator">=</span> it<span class="token punctuation">.</span>_node<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        lsiter<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> lsiter<span class="token operator">&amp;</span> it<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            _node <span class="token operator">=</span> it<span class="token punctuation">.</span>_node<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        reference <span class="token keyword">operator</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> _node<span class="token operator">-&gt;</span>_val<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        pointer <span class="token keyword">operator</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token operator">&amp;</span>_node<span class="token operator">-&gt;</span>_val<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        lsiter<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            _node <span class="token operator">=</span> _node<span class="token operator">-&gt;</span>_next<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        lsiter <span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            lsiter <span class="token function">tmp</span><span class="token punctuation">(</span>_node<span class="token punctuation">)</span><span class="token punctuation">;</span>
            _node <span class="token operator">=</span> _node<span class="token operator">-&gt;</span>_next<span class="token punctuation">;</span>
            <span class="token keyword">return</span> tmp<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        lsiter<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">--</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            _node <span class="token operator">=</span> _node<span class="token operator">-&gt;</span>_pre<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        lsiter <span class="token keyword">operator</span><span class="token operator">--</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            lsiter <span class="token function">tmp</span><span class="token punctuation">(</span>_node<span class="token punctuation">)</span><span class="token punctuation">;</span>
            _node <span class="token operator">=</span> _node<span class="token operator">-&gt;</span>_pre<span class="token punctuation">;</span>
            <span class="token keyword">return</span> tmp<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> lsiter<span class="token operator">&amp;</span> it<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> _node <span class="token operator">!=</span> it<span class="token punctuation">.</span>_node<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> lsiter<span class="token operator">&amp;</span> it<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> _node <span class="token operator">==</span> it<span class="token punctuation">.</span>_node<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        node<span class="token operator">*</span> _node<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="4list_219">
     </a>
     4.list类的常用接口的模拟实现
    </h3>
    <pre><code class="prism language-cpp"><span class="token keyword">namespace</span> zh
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//list类</span>
    <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
    <span class="token keyword">class</span> <span class="token class-name">list</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">typedef</span> listnode<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> node<span class="token punctuation">;</span>
        <span class="token keyword">void</span> <span class="token function">greate_sentinel_guard</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 创建哨兵卫</span>
        <span class="token punctuation">{<!-- --></span>
            _head <span class="token operator">=</span> <span class="token keyword">new</span> node<span class="token punctuation">;</span>
            _head<span class="token operator">-&gt;</span>_pre <span class="token operator">=</span> _head<span class="token punctuation">;</span>
            _head<span class="token operator">-&gt;</span>_next <span class="token operator">=</span> _head<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token keyword">public</span><span class="token operator">:</span>
        <span class="token keyword">typedef</span> listiterator<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> T<span class="token operator">&amp;</span><span class="token punctuation">,</span> T<span class="token operator">*</span><span class="token operator">&gt;</span> iterator<span class="token punctuation">;</span>
        <span class="token keyword">typedef</span> listiterator<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">*</span><span class="token operator">&gt;</span> const_iterator<span class="token punctuation">;</span>
        <span class="token comment">///</span>
        <span class="token comment">// List的构造</span>
        <span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">greate_sentinel_guard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token function">list</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span> value <span class="token operator">=</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">greate_sentinel_guard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>n<span class="token operator">--</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token function">push_back</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">InputIterator</span><span class="token operator">&gt;</span>
        <span class="token function">list</span><span class="token punctuation">(</span>InputIterator first<span class="token punctuation">,</span> InputIterator last<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">greate_sentinel_guard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>first <span class="token operator">!=</span> last<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token function">push_back</span><span class="token punctuation">(</span><span class="token operator">*</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span>
                first<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token function">list</span><span class="token punctuation">(</span>initializer_list<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> il<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">greate_sentinel_guard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">auto</span> it <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">begin</span><span class="token punctuation">(</span>il<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>it <span class="token operator">!=</span> std<span class="token double-colon punctuation">::</span><span class="token function">end</span><span class="token punctuation">(</span>il<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token function">push_back</span><span class="token punctuation">(</span><span class="token operator">*</span>it<span class="token punctuation">)</span><span class="token punctuation">;</span>
                it<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">list</span><span class="token punctuation">(</span><span class="token keyword">const</span> list<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">&amp;</span> lst<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">greate_sentinel_guard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> it <span class="token operator">:</span> lst<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token function">push_back</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        list<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span>list<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> lst<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">swap</span><span class="token punctuation">(</span>lst<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token operator">~</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">delete</span> _head<span class="token punctuation">;</span>
            _head <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">///</span>
        <span class="token comment">// List Iterator</span>
        iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token function">iterator</span><span class="token punctuation">(</span>_head<span class="token operator">-&gt;</span>_next<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token function">iterator</span><span class="token punctuation">(</span>_head<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        const_iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token function">const_iterator</span><span class="token punctuation">(</span>_head<span class="token operator">-&gt;</span>_next<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        const_iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token function">const_iterator</span><span class="token punctuation">(</span>_head<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">///</span>
        <span class="token comment">// List Capacity</span>
        size_t <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> _size<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">bool</span> <span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> _size <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment"></span>
        <span class="token comment">// List Access</span>
        T<span class="token operator">&amp;</span> <span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">assert</span><span class="token punctuation">(</span>_size <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token operator">*</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">const</span> T<span class="token operator">&amp;</span> <span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">assert</span><span class="token punctuation">(</span>_size <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token operator">*</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        T<span class="token operator">&amp;</span> <span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">assert</span><span class="token punctuation">(</span>_size <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">--</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">const</span> T<span class="token operator">&amp;</span> <span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">assert</span><span class="token punctuation">(</span>_size <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">--</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment"></span>
        <span class="token comment">// List Modify</span>
        <span class="token keyword">void</span> <span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> val<span class="token punctuation">)</span> 
        <span class="token punctuation">{<!-- --></span> 
            <span class="token function">insert</span><span class="token punctuation">(</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span>
        <span class="token keyword">void</span> <span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
        <span class="token punctuation">{<!-- --></span> 
            <span class="token function">erase</span><span class="token punctuation">(</span><span class="token operator">--</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span>
        <span class="token keyword">void</span> <span class="token function">push_front</span><span class="token punctuation">(</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> val<span class="token punctuation">)</span> 
        <span class="token punctuation">{<!-- --></span> 
            <span class="token function">insert</span><span class="token punctuation">(</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span>
        <span class="token keyword">void</span> <span class="token function">pop_front</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
        <span class="token punctuation">{<!-- --></span> 
            <span class="token function">erase</span><span class="token punctuation">(</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span>
        <span class="token comment">// 在pos位置前插入值为val的节点</span>
        iterator <span class="token function">insert</span><span class="token punctuation">(</span>iterator pos<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span> val<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            node<span class="token operator">*</span> newnode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">node</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
            node<span class="token operator">*</span> pre <span class="token operator">=</span> pos<span class="token punctuation">.</span>_node<span class="token operator">-&gt;</span>_pre<span class="token punctuation">;</span>
            pre<span class="token operator">-&gt;</span>_next <span class="token operator">=</span> newnode<span class="token punctuation">;</span>
            newnode<span class="token operator">-&gt;</span>_pre <span class="token operator">=</span> pre<span class="token punctuation">;</span>
            newnode<span class="token operator">-&gt;</span>_next <span class="token operator">=</span> pos<span class="token punctuation">.</span>_node<span class="token punctuation">;</span>
            pos<span class="token punctuation">.</span>_node<span class="token operator">-&gt;</span>_pre <span class="token operator">=</span> newnode<span class="token punctuation">;</span>
            _size<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token operator">--</span>pos<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 删除pos位置的节点，返回该节点的下一个位置</span>
        iterator <span class="token function">erase</span><span class="token punctuation">(</span>iterator pos<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">assert</span><span class="token punctuation">(</span>_size <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            node<span class="token operator">*</span> pre <span class="token operator">=</span> pos<span class="token punctuation">.</span>_node<span class="token operator">-&gt;</span>_pre<span class="token punctuation">;</span>
            pre<span class="token operator">-&gt;</span>_next <span class="token operator">=</span> pos<span class="token punctuation">.</span>_node<span class="token operator">-&gt;</span>_next<span class="token punctuation">;</span>
            pos<span class="token punctuation">.</span>_node<span class="token operator">-&gt;</span>_next <span class="token operator">=</span> pre<span class="token punctuation">;</span>
            <span class="token keyword">delete</span> pos<span class="token punctuation">.</span>_node<span class="token punctuation">;</span>
            _size<span class="token operator">--</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token function">iterator</span><span class="token punctuation">(</span>pre<span class="token operator">-&gt;</span>_next<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            node<span class="token operator">*</span> cur <span class="token operator">=</span> _head<span class="token operator">-&gt;</span>_next<span class="token punctuation">;</span>
            node<span class="token operator">*</span> next <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>_next<span class="token punctuation">;</span>
            _head<span class="token operator">-&gt;</span>_next <span class="token operator">=</span> _head<span class="token punctuation">;</span>
            _head<span class="token operator">-&gt;</span>_pre <span class="token operator">=</span> _head<span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>cur <span class="token operator">!=</span> _head<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">delete</span> cur<span class="token punctuation">;</span>
                cur <span class="token operator">=</span> next<span class="token punctuation">;</span>
                next <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>_next<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            _size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>list<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">&amp;</span> lst<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_head<span class="token punctuation">,</span> lst<span class="token punctuation">.</span>_head<span class="token punctuation">)</span><span class="token punctuation">;</span>
            std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_size<span class="token punctuation">,</span> lst<span class="token punctuation">.</span>_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
<span class="token keyword">private</span><span class="token operator">:</span>
        node<span class="token operator">*</span> _head<span class="token punctuation">;</span>
        size_t _size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>   
</code></pre>
    <h2>
     <a id="list_419">
     </a>
     二、list的迭代器失效问题
    </h2>
    <p>
     list作为双向链表，它的迭代器失效情况比vector少很多。因为vector的元素是连续存储的，在插入元素时，可能会扩容导致内存重新分配，所有迭代器都失效，即使容量足够，插入位置及其之后的迭代器也会失效。而list的每个元素独立存储，通过指针连接，
     <strong>
      list的插入操作（如push_back、push_front、insert）不会使任何现有的迭代器失效；而删除操作（如erase、pop_back、pop_front等）会导致指向被删除元素的迭代器、指针和引用失效，但其他迭代器仍然有效。比如，删除一个节点后，指向它的迭代器就无效了，但其他节点的迭代器不受影响。
     </strong>
    </p>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;list&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> lst<span class="token punctuation">{<!-- --></span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">auto</span> it <span class="token operator">=</span> lst<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>it <span class="token operator">!=</span> lst<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		lst<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// erase()函数执行后，it所指向的节点已被删除，因此it无效，在下一次使用it时，必须先给其赋值</span>
		<span class="token operator">++</span>it<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/0b8cb6f5f038444495c914359ec1ee3e.png#pic_center">
      <br/>
      <strong>
       修正后：
      </strong>
     </img>
    </p>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;list&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> lst<span class="token punctuation">{<!-- --></span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">auto</span> it <span class="token operator">=</span> lst<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>it <span class="token operator">!=</span> lst<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		it <span class="token operator">=</span> lst<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// erase()函数执行后，it所指向的节点已被删除，因此it无效，在下一次使用it时，必须先给其赋值</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/1627f49e727d4b7abb48b0d289fd84d7.png#pic_center"/>
    </p>
    <h2>
     <a id="listvector_459">
     </a>
     三、list与vector的对比
    </h2>
    <p>
     <strong>
      vector与list都是STL中非常重要的序列式容器，由于两个容器的底层结构不同，导致其特性以及应用场景不同，其主要不同如下：
     </strong>
    </p>
    <table>
     <thead>
      <tr>
       <th>
       </th>
       <th>
        vector
       </th>
       <th>
        list
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        底层结构
       </td>
       <td>
        动态顺序表（数组），一段连续空间
       </td>
       <td>
        带哨兵节点的双向循环链表
       </td>
      </tr>
      <tr>
       <td>
        元素访问
       </td>
       <td>
        支持随机访问，访问某个元素效率O(1)
       </td>
       <td>
        不支持随机访问，访问某个元素效率O(N)
       </td>
      </tr>
      <tr>
       <td>
        插入和删除
       </td>
       <td>
        任意位置插入和删除效率低，需要搬移元素，时间复杂度为O(N)，插入时有可能需要增容，增容：开辟新空间，拷贝元素，释放旧空间，导致效率更低
       </td>
       <td>
        任意位置插入和删除效率高，不需要搬移元素，时间复杂度为O(1)
       </td>
      </tr>
      <tr>
       <td>
        空间利用率
       </td>
       <td>
        底层为连续空间，不容易造成内存碎片，空间利用率高，缓存利用率高
       </td>
       <td>
        底层节点动态开辟，小节点容易造成内存碎片，空间利用率低，缓存利用率低
       </td>
      </tr>
      <tr>
       <td>
        迭代器
       </td>
       <td>
        原生态指针（早期库中实现方式）
       </td>
       <td>
        对原生态指针(节点指针)进行封装
       </td>
      </tr>
      <tr>
       <td>
        使用场景
       </td>
       <td>
        需要高效存储，支持随机访问，不关心插入删除效率
       </td>
       <td>
        大量插入和删除操作，不关心随机访问
       </td>
      </tr>
     </tbody>
    </table>
    <h2>
     <a id="_470">
     </a>
     四、反向迭代器（了解）
    </h2>
    <p>
     <strong>
      反向迭代器本质是⼀个适配器，使用模版实现，传递哪个容器的迭代器就可以封装适配出对应的反向迭代器。因为反向迭代器的功能跟正向的迭代器功能高度相似，只是遍历的方向相反，类似operator++ 底层调用迭代器的 operator-- 等，所以封装一下就可以实现。
     </strong>
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/d1770d73073c4b82a8207588d9a2d21b.png#pic_center"/>
    </p>
    <pre><code class="prism language-cpp"><span class="token keyword">namespace</span> zh
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 用正向迭代器适配出的反向迭代器</span>
    <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">iterator</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">reference</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">pointer</span><span class="token operator">&gt;</span>
    <span class="token keyword">struct</span> <span class="token class-name">reverseiterator</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">typedef</span> reverseiterator<span class="token operator">&lt;</span>iterator<span class="token punctuation">,</span> reference<span class="token punctuation">,</span> pointer<span class="token operator">&gt;</span> reiter<span class="token punctuation">;</span>

        <span class="token function">reverseiterator</span><span class="token punctuation">(</span>iterator it <span class="token operator">=</span> <span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token operator">:</span><span class="token function">_it</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span> <span class="token punctuation">}</span>

        <span class="token function">reverseiterator</span><span class="token punctuation">(</span><span class="token keyword">const</span> reiter<span class="token operator">&amp;</span> it<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            _it <span class="token operator">=</span> it<span class="token punctuation">.</span>_it<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        reiter<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> reiter<span class="token operator">&amp;</span> it<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            _it <span class="token operator">=</span> it<span class="token punctuation">.</span>_it<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        reference <span class="token keyword">operator</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            iterator tmp <span class="token operator">=</span> _it<span class="token punctuation">;</span>
            tmp<span class="token operator">--</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token operator">*</span>tmp<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        pointer <span class="token keyword">operator</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token keyword">operator</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        reiter<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            _it<span class="token operator">--</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        reiter <span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            reiter <span class="token function">tmp</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            _it<span class="token operator">--</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> tmp<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        reiter<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">--</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            _it<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        reiter <span class="token keyword">operator</span><span class="token operator">--</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            reiter <span class="token function">tmp</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            _it<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> tmp<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> reiter<span class="token operator">&amp;</span> it<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> _it <span class="token operator">!=</span> it<span class="token punctuation">.</span>_it<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> reiter<span class="token operator">&amp;</span> it<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> _it <span class="token operator">==</span> it<span class="token punctuation">.</span>_it<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        iterator _it<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// list类与反向迭代器相关联部分节选 //</span>
    <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
    <span class="token keyword">class</span> <span class="token class-name">list</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">typedef</span> listnode<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> node<span class="token punctuation">;</span>
        <span class="token keyword">void</span> <span class="token function">greate_sentinel_guard</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 创建哨兵卫</span>
        <span class="token punctuation">{<!-- --></span>
            _head <span class="token operator">=</span> <span class="token keyword">new</span> node<span class="token punctuation">;</span>
            _head<span class="token operator">-&gt;</span>_pre <span class="token operator">=</span> _head<span class="token punctuation">;</span>
            _head<span class="token operator">-&gt;</span>_next <span class="token operator">=</span> _head<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token keyword">public</span><span class="token operator">:</span>
        <span class="token keyword">typedef</span> listiterator<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> T<span class="token operator">&amp;</span><span class="token punctuation">,</span> T<span class="token operator">*</span><span class="token operator">&gt;</span> iterator<span class="token punctuation">;</span>
        <span class="token keyword">typedef</span> listiterator<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">*</span><span class="token operator">&gt;</span> const_iterator<span class="token punctuation">;</span>
        <span class="token keyword">typedef</span> reverseiterator<span class="token operator">&lt;</span>iterator<span class="token punctuation">,</span> T<span class="token operator">&amp;</span><span class="token punctuation">,</span> T<span class="token operator">*</span><span class="token operator">&gt;</span> reverse_iterator<span class="token punctuation">;</span>
        <span class="token keyword">typedef</span> reverseiterator<span class="token operator">&lt;</span>const_iterator<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">*</span><span class="token operator">&gt;</span> const_reverse_iterator<span class="token punctuation">;</span>
        <span class="token comment">///</span>
        <span class="token comment">// List的构造</span>
        <span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">greate_sentinel_guard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        <span class="token comment">///</span>
        <span class="token comment">// List Iterator</span>
        iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token function">iterator</span><span class="token punctuation">(</span>_head<span class="token operator">-&gt;</span>_next<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token function">iterator</span><span class="token punctuation">(</span>_head<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        const_iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token function">const_iterator</span><span class="token punctuation">(</span>_head<span class="token operator">-&gt;</span>_next<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        const_iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token function">const_iterator</span><span class="token punctuation">(</span>_head<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        reverse_iterator <span class="token function">rbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token function">reverse_iterator</span><span class="token punctuation">(</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        reverse_iterator <span class="token function">rend</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token function">reverse_iterator</span><span class="token punctuation">(</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        const_reverse_iterator <span class="token function">rbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token function">const_reverse_iterator</span><span class="token punctuation">(</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        const_reverse_iterator <span class="token function">rend</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token function">const_reverse_iterator</span><span class="token punctuation">(</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
    <span class="token keyword">private</span><span class="token operator">:</span>
        node<span class="token operator">*</span> _head<span class="token punctuation">;</span>
        size_t _size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      反向迭代器的operator*的实现方式比较特殊，内部访问的是迭代器当前位置的前⼀个位置。这个要结合容器中rbegin和rend实现才能看懂，rbegin返回的是封装end位置的反向迭代器，rend返回的是封装begin位置迭代器的反向迭代器，这里是为了实现出⼀个对称，所以解引用访问的是当前位置的前⼀个位置。
     </strong>
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/bd5df87ee98e43d1b1580beda7682e1a.png#pic_center"/>
    </p>
    <hr/>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323330325f37363731333434322f:61727469636c652f64657461696c732f313436303830393338" class_="artid" style="display:none">
 </p>
</div>


