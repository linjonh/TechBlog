---
layout: post
title: "利用axios库的爬虫程序如何使用HTTP"
date: 2025-03-12 15:30:29 +0800
description: "在 JavaScript 中，`axios` 是一个非常流行的 HTTP 客户端库，它可以用来发送各种 HTTP 请求（如 `GET`, `POST` 等），并处理响应。我们可以使用 `axios` 来编写一个简单的爬虫程序，该程序抓取网页内容并提取需要的信息。"
keywords: "利用axios库的爬虫程序如何使用HTTP"
categories: ['未分类']
tags: ['网络协议', '爬虫', 'Http']
artid: "146206522"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146206522
    alt: "利用axios库的爬虫程序如何使用HTTP"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146206522
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146206522
cover: https://bing.ee123.net/img/rand?artid=146206522
image: https://bing.ee123.net/img/rand?artid=146206522
img: https://bing.ee123.net/img/rand?artid=146206522
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     利用axios库的爬虫程序如何使用HTTP
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     在 JavaScript 中，
     <code>
      axios
     </code>
     是一个非常流行的 HTTP 客户端库，它可以用来发送各种 HTTP 请求（如
     <code>
      GET
     </code>
     ,
     <code>
      POST
     </code>
     等），并处理响应。我们可以使用
     <code>
      axios
     </code>
     来编写一个简单的爬虫程序，该程序抓取网页内容并提取需要的信息。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/31fda6e208d441c89d55543b71438577.png#pic_center"/>
    </p>
    <h4>
     <a id="1_Axios_5">
     </a>
     1、
     <strong>
      安装 Axios
     </strong>
    </h4>
    <p>
     首先，你需要安装
     <code>
      axios
     </code>
     。在 Node.js 项目中，你可以通过 npm 安装它：
    </p>
    <pre><code class="prism language-bash"><span class="token function">npm</span> <span class="token function">install</span> axios
</code></pre>
    <h4>
     <a id="2_13">
     </a>
     2、
     <strong>
      编写爬虫程序
     </strong>
    </h4>
    <p>
     假设你要抓取某个网页上的图片，以下是一个简单的示例，演示如何使用
     <code>
      axios
     </code>
     发送 HTTP 请求并下载网页上的图片。
    </p>
    <h5>
     <a id="_17">
     </a>
     代码示例：
    </h5>
    <pre><code class="prism language-javascript"><span class="token keyword">const</span> axios <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'axios'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cheerio <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cheerio'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 使用 cheerio 解析 HTML 内容</span>

<span class="token comment">// 下载图片的函数</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">downloadImage</span><span class="token punctuation">(</span><span class="token parameter">imageUrl<span class="token punctuation">,</span> filename</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> writer <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> imageUrl<span class="token punctuation">,</span>
    <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">'GET'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">responseType</span><span class="token operator">:</span> <span class="token string">'stream'</span><span class="token punctuation">,</span>  <span class="token comment">// 以流的方式处理响应</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  response<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>writer<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 将响应流写入文件</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    writer<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'finish'</span><span class="token punctuation">,</span> resolve<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 下载完成后解决 Promise</span>
    writer<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> reject<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 如果有错误则拒绝 Promise</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 抓取网页并下载所有图片的函数</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">crawlAndDownloadImages</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 1. 请求网页内容</span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> html <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">;</span>

    <span class="token comment">// 2. 使用 cheerio 解析网页内容</span>
    <span class="token keyword">const</span> $ <span class="token operator">=</span> cheerio<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> imgTags <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 获取所有 &lt;img&gt; 标签</span>

    <span class="token comment">// 3. 提取每个 &lt;img&gt; 标签的 src 属性，作为图片的 URL</span>
    <span class="token keyword">const</span> imageUrls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    imgTags<span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span> img</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">const</span> imgUrl <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>imgUrl<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 处理相对路径图片</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>imgUrl<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">const</span> parsedUrl <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>imgUrl<span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 将相对路径转换为绝对路径</span>
          imageUrls<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>parsedUrl<span class="token punctuation">.</span>href<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
          imageUrls<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>imgUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 4. 下载所有图片</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> imageUrls<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">const</span> imageUrl <span class="token operator">=</span> imageUrls<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> imageName <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">basename</span><span class="token punctuation">(</span>imageUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 获取图片名称</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">下载图片: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>imageUrl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">await</span> <span class="token function">downloadImage</span><span class="token punctuation">(</span>imageUrl<span class="token punctuation">,</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'downloads'</span><span class="token punctuation">,</span> imageName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 保存图片到本地</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">图片下载完成: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>imageName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'爬虫出错:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 运行爬虫程序</span>
<span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">'https://example.com'</span><span class="token punctuation">;</span>  <span class="token comment">// 替换为你想抓取的网页</span>
<span class="token function">crawlAndDownloadImages</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <h4>
     <a id="3_84">
     </a>
     3、
     <strong>
      代码说明
     </strong>
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        安装依赖
       </strong>
       ：
      </p>
      <ul>
       <li>
        <code>
         axios
        </code>
        ：用于发送 HTTP 请求。
       </li>
       <li>
        <code>
         cheerio
        </code>
        ：用于解析 HTML 文档并提取 DOM 元素。
       </li>
       <li>
        <code>
         fs
        </code>
        ：用于文件操作（保存图片到本地）。
       </li>
       <li>
        <code>
         path
        </code>
        ：用于处理文件路径。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        <code>
         downloadImage
        </code>
        函数
       </strong>
       ：此函数接收一个图片 URL 和文件名，使用
       <code>
        axios
       </code>
       发送
       <code>
        GET
       </code>
       请求并将返回的图片数据保存到本地。图片数据是以流的方式处理的，因此我们使用
       <code>
        .pipe()
       </code>
       方法将响应流写入到文件中。
      </p>
     </li>
     <li>
      <p>
       <strong>
        <code>
         crawlAndDownloadImages
        </code>
        函数
       </strong>
       ：此函数抓取网页内容并解析出所有的
       <code>
        &lt;img&gt;
       </code>
       标签，然后提取其
       <code>
        src
       </code>
       属性（即图片 URL）。接着，它会下载每个图片。
      </p>
     </li>
     <li>
      <p>
       <strong>
        <code>
         cheerio.load
        </code>
       </strong>
       ：
       <code>
        cheerio
       </code>
       是一个非常轻量级的 jQuery 实现，可以用来解析 HTML 页面并操作 DOM 元素。我们使用
       <code>
        cheerio
       </code>
       提取所有
       <code>
        &lt;img&gt;
       </code>
       标签并获取其
       <code>
        src
       </code>
       属性。
      </p>
     </li>
     <li>
      <p>
       <strong>
        图片 URL 处理
       </strong>
       ：对于相对路径的图片，我们使用
       <code>
        new URL(imgUrl, url)
       </code>
       将其转换为绝对路径。
      </p>
     </li>
     <li>
      <p>
       <strong>
        图片下载
       </strong>
       ：使用
       <code>
        axios
       </code>
       发送 HTTP 请求并以流的形式下载图片，最后保存到本地。
      </p>
     </li>
     <li>
      <p>
       <strong>
        运行爬虫
       </strong>
       ：调用
       <code>
        crawlAndDownloadImages(url)
       </code>
       启动爬虫，传入目标网页的 URL，程序将抓取网页上的所有图片并保存到
       <code>
        downloads
       </code>
       文件夹中。
      </p>
     </li>
    </ol>
    <h4>
     <a id="4_104">
     </a>
     4、
     <strong>
      执行程序
     </strong>
    </h4>
    <ol>
     <li>
      在项目目录中创建
      <code>
       index.js
      </code>
      文件，并将上述代码粘贴进去。
     </li>
     <li>
      执行爬虫程序：
     </li>
    </ol>
    <pre><code class="prism language-bash"><span class="token function">node</span> index.js
</code></pre>
    <ol start="3">
     <li>
      程序将下载网页中的所有图片并保存在当前目录下的
      <code>
       downloads
      </code>
      文件夹中。
     </li>
    </ol>
    <h4>
     <a id="5_115">
     </a>
     5、
     <strong>
      总结
     </strong>
    </h4>
    <p>
     通过
     <code>
      axios
     </code>
     和
     <code>
      cheerio
     </code>
     ，你可以轻松地编写一个爬虫程序来抓取网页并下载其中的图片。
     <code>
      axios
     </code>
     负责发送 HTTP 请求，
     <code>
      cheerio
     </code>
     用于解析 HTML 内容，提取需要的元素。这个爬虫程序能够处理相对路径的图片 URL，并将所有下载的图片保存在本地目录中。你可以根据需要扩展此程序，处理更多类型的资源或实现更复杂的爬取逻辑。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34343631373635312f:61727469636c652f64657461696c732f313436323036353232" class_="artid" style="display:none">
 </p>
</div>


