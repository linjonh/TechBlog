---
layout: post
title: "Selenium-自动化测试学习总结"
date: 2025-03-12 12:31:21 +0800
description: "大概了解一下即可，现在主要用的自动化工具是 playWright，它可以录制操作。selenium是老款自动化测试工具，仍有很多可取之处。"
keywords: "Selenium 自动化测试学习总结"
categories: ['未分类']
tags: ['测试工具', '学习', 'Selenium']
artid: "146199562"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146199562
    alt: "Selenium-自动化测试学习总结"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146199562
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146199562
cover: https://bing.ee123.net/img/rand?artid=146199562
image: https://bing.ee123.net/img/rand?artid=146199562
img: https://bing.ee123.net/img/rand?artid=146199562
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Selenium 自动化测试学习总结
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     大概了解一下即可，现在主要用的自动化工具是 playWright，它可以录制操作。
     <br/>
     selenium是老款自动化测试工具，仍有很多可取之处。
    </p>
    <h3>
     安装：
    </h3>
    <p>
     pip install selenium即可。然后下载浏览器的驱动包，注意不是浏览器！
     <br/>
     然后解压驱动包，将里面的exe程序放入python下载的位置。就不用添加环境变量了，因为python这个位置一般都已经添加了环境变量。
    </p>
    <p>
     使用驱动打开浏览器的方式：wd = webdriver.Chrome()  //最简洁方式，已经添加到环境变量中了。    wd = webdriver.Edge(service=Service(r'D:\work_soft\python\msedgedriver.exe'))  //未添加到环境变量，需要指定路径。
    </p>
    <p>
     <strong>
      对比playWright
     </strong>
     ，selenium需要下载对应驱动包。而playwright一个命令即可完成。且操作命令也有些不同，但css选择器是一样的，html文档的节点也是一样的。
    </p>
    <h3 id="_1">
     选择元素的方法：
    </h3>
    <p id="id">
     <strong>
      根据 id属性 选择元素
     </strong>
     ：# 根据id选择元素，返回的就是该元素对应的WebElement对象
     <a id="__codelineno-0-11" name="__codelineno-0-11">
     </a>
     element = wd.find_element(By.ID, 'kw')
     <br/>
     通过element.send_keys(‘信息’)方法操作元素。//输入文本信息
    </p>
    <p id="classtag">
     <strong>
      根据 class属性：
     </strong>
     wd.find_elements(By.CLASS_NAME, 'animal')    注意这里find_elements多一个s，表示返回多个元素。通过for element in elements: print(element.text)  打印文本信息。
    </p>
    <p>
     <strong>
      tag名 选择元素
     </strong>
     ：elements = wd.find_elements(By.TAG_NAME, 'div')  用法同上。
    </p>
    <p>
     find_element与find_elements返回的数量不一样。
    </p>
    <p id="webelement">
     <strong>
      通过WebElement对象选择元素
     </strong>
     ：实质就是嵌套。第一个元素对象还可以使用find_element的方法。
    </p>
    <p id="_2">
     <strong>
      等待界面元素出现
     </strong>
     ：# 等待 1 秒 from time import sleep sleep(1)   。注意palyWright的等待界面元素出现的方法不能用sleep。
    </p>
    <h3>
     操控元素的方法：
    </h3>
    <p>
     点击元素：调用webElement对象的click方法。
    </p>
    <p>
     输入元素信息：send_keys方法。
    </p>
    <pre>wd.find_elements(By.CLASS_NAME,'result-item').send_keys("文本信息")</pre>
    <p>
     <strong>
      获取元素信息
     </strong>
     ：print(element.text)
     <br/>
     <strong>
      获取输入框的文字
     </strong>
     ：element.get_attribute('value')
     <br/>
     <strong>
      获取元素的属性值
     </strong>
     ：element.get_attribute('class')
    </p>
    <p>
    </p>
    <h3>
     <strong>
      CSS表达式
     </strong>
     ：
    </h3>
    <p>
     通过
     <code>
      CSS selector
     </code>
     语法选择元素。
     <br/>
     选择单个元素：find_element(By.css_SELECTOR，CSS Selector参数)
    </p>
    <p id="tagidclass">
     <strong>
      根据 tag名、id、class 选择元素
     </strong>
     ：例如：element = wd.find_element(By.CSS_SELECTOR, '#searchtext')
    </p>
    <p id="_1">
     <strong>
      选择 子元素 和 后代元素
     </strong>
     ：如果
     <code>
      元素2
     </code>
     是
     <code>
      元素1
     </code>
     的 直接子元素， CSS Selector 选择子元素的语法是这样的：元素1&gt;元素2
    </p>
    <p id="_2">
     <strong>
      根据属性选择
     </strong>
     ：css 选择器支持通过任何属性来选择元素，语法是用一个方括号
     <code>
      []
     </code>
     。&lt;a href="http://www.miitbeian.gov.cn"&gt;苏ICP备88885574号&lt;/a&gt;
    </p>
    <p>
     比如要选择上面的a元素，就可以使用
     <code>
      [href="http://www.miitbeian.gov.cn"]
     </code>
     。这个表达式的意思是，选择 属性href值为
     <code>
      http://www.miitbeian.gov.cn
     </code>
     的元素。
    </p>
    <p>
     当然，前面可以加上标签名的限制，比如
     <code>
      div[class='SKnet']
     </code>
     表示 选择所有 标签名为div，且class属性值为SKnet的元素。
    </p>
    <pre><code># 根据属性选择元素
element = wd.find_element(By.CSS_SELECTOR, 'div[class="daad"]')</code></pre>
    <p>
     如果一个元素具有多个属性
    </p>
    <pre id="__code_18"><code>&lt;div class="misc" ctype="gun"&gt;沙漠之鹰&lt;/div&gt;
</code></pre>
    <p>
     CSS 选择器 可以指定 选择的元素要 同时具有多个属性的限制，像这样
     <code>
      div[class=misc][ctype=gun]
     </code>
    </p>
    <p id="css-selector_1">
    </p>
    <h3>
     frame切换/窗口切换:
    </h3>
    <p>
     # 切换回 最外部的 HTML 中 wd.switch_to.default_content()
    </p>
    <p>
     # 然后再 选择操作 外部的 HTML 中 的元素 wd.find_element_by_id('outerbutton').click()
    </p>
    <p id="_1">
    </p>
    <h3>
     选择框:
    </h3>
    <pre><code>&lt;div id="s_radio"&gt;
  &lt;input type="radio" name="teacher" value="小江老师"&gt;小江老师&lt;br&gt;
  &lt;input type="radio" name="teacher" value="小雷老师"&gt;小雷老师&lt;br&gt;
  &lt;input type="radio" name="teacher" value="小凯老师" checked="checked"&gt;小凯老师
&lt;/div&gt;</code></pre>
    <p>
     上述是单选按钮，# 获取当前选中的元素
    </p>
    <p>
     <a id="__codelineno-1-2" name="__codelineno-1-2">
     </a>
     element = wd.find_element(By.CSS_SELECTOR,
     <a id="__codelineno-1-3" name="__codelineno-1-3">
     </a>
     '#s_radio input[name="teacher"]:checked')
     <a id="__codelineno-1-4" name="__codelineno-1-4">
     </a>
     print('当前选中的是: ' + element.get_attribute('value'))
    </p>
    <p>
     其中
     <code>
      #s_radio input[name="teacher"]:checked
     </code>
     里面的
     <code>
      :checked
     </code>
     是CSS伪类选择
    </p>
    <p id="checkbox">
     <strong>
      checkbox框
     </strong>
     ：它的用法同单选框。都是由input标签得到。
    </p>
    <p id="select">
     <strong>
      select框
     </strong>
     ：对于Select 选择框， Selenium 专门提供了一个
     <code>
      Select类
     </code>
     进行操作。即select_by_value方法。复选框，存在次序，即select_by_index(次序)，从0开始。
    </p>
    <pre><code># 导入Select类
from selenium.webdriver.support.ui import Select

# 创建Select对象
select = Select(wd.find_element(By.ID, "ss_single"))

# 通过 Select 对象选中小雷老师
select.select_by_visible_text("小雷老师")

# 清除所有 已经选中 的选项
select.deselect_all()</code></pre>
    <h3>
    </h3>
    <h3>
     实战技巧：
    </h3>
    <h4 id="_8">
     手机模式：
    </h4>
    <pre><code>from selenium import webdriver

mobile_emulation = { "deviceName": "Nexus 5" }

edge_options = webdriver.EdgeOptions()
edge_options.add_experimental_option("mobileEmulation", mobile_emulation)
driver = webdriver.Edge(options=edge_options)

driver.get('http://www.baidu.com')

input()
driver.quit()</code></pre>
    <h3 style="background-color:transparent">
     Xpath选择器：
    </h3>
    <p>
     前面都是CSS 选择器的方式，例如，input[ name ='  ']这样表示参数。
    </p>
    <p>
     此外也需要学习Xpath，它还有其他领域会使用到，比如 爬虫框架 Scrapy， 手机App框架 Appium。
    </p>
    <p>
     xpath表达式
     <code>
      /html/body/div
     </code>
     ，就是一个绝对路径的xpath表达式， 等价于 css表达式
     <code>
      html&gt;body&gt;div
     </code>
    </p>
    <p id="_4">
     <strong>
      根据属性选择
     </strong>
     ：根据属性来选择元素 是通过 这种格式来的
     <code>
      [@属性名='属性值']
     </code>
    </p>
    <p>
     选择所有 select 元素中 class为 single_choice 的元素，可以这样
     <code>
      //select[@class='single_choice']
     </code>
     <br/>
     选择 id 为 west 的元素，可以这样
     <code>
      //*[@id='west']
     </code>
    </p>
    <p>
     如果一个元素class 有多个，比如
    </p>
    <pre id="__code_6"><code>&lt;p id="beijing" class='capital huge-city'&gt;
    北京    
&lt;/p&gt;
</code></pre>
    <p>
     如果要选 它， 对应的 xpath 就应该是
     <code>
      //p[@class="capital huge-city"]
     </code>
     不能只写一个属性，像这样
     <code>
      //p[@class="capital"]
     </code>
     则不行。
    </p>
    <p id="_7">
     要在某个元素内部使用xpath选择元素， 需要
     <code>
      在xpath表达式最前面加个点
     </code>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f35353932383038362f:61727469636c652f64657461696c732f313436313939353632" class_="artid" style="display:none">
 </p>
</div>


