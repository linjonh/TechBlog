---
layout: post
title: "rpath添加依赖库搜索路径"
date: 2025-01-13 17:49:53 +0800
description: "from: http://blog.csdn.net/ibingow/article/details"
keywords: "qt 添加依赖库路径"
categories: ['Linux']
tags: ['Linux', 'C']
artid: "40891593"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=40891593
    alt: "rpath添加依赖库搜索路径"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=40891593
featuredImagePreview: https://bing.ee123.net/img/rand?artid=40891593
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     rpath添加依赖库搜索路径
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
      from: http://blog.csdn.net/ibingow/article/details/7882098
     </span>
    </p>
    <p>
     <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
      windows 下一个程序的dll搜索路径首先是程序目录，然后是一些系统目录。linux 下的可以通过设置 LD_LIBRARY_PATH 等方法来添加搜索路径，但是这些路径是定死的，如果要实现程序目录，就要使用链接时的rpath选项。rpath 适用于 elf 文件，不适用 pe。
     </span>
    </p>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <h5 style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     <a name="t0" style="color:rgb(51,102,153)" target="_blank">
     </a>
     Linux 上动态库搜索顺序：
    </h5>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     <span style="color:rgb(51,0,153)">
      Unless loading object has RUNPATH:
      <br/>
      RPATH of the loading object,
      <br/>
      then the RPATH of its loader (unless it has a RUNPATH), ...,
      <br/>
      until the end of the chain, which is either the executable
      <br/>
      or an object loaded by dlopen(loader 为可执行程序或被 dlopen 打开的对象)
      <br/>
      Unless executable has RUNPATH:
      <br/>
      RPATH of the executable
      <br/>
      LD_LIBRARY_PATH
      <br/>
      RUNPATH of the loading object
      <br/>
      ld.so.cache
      <br/>
      default dirs
     </span>
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <h5 style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     <a name="t1" style="color:rgb(51,102,153)" target="_blank">
     </a>
     rpath 用法
    </h5>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     ld:
    </span>
    <div class="dp-highlighter bg_plain" style="font-family:Consolas,'Courier New',Courier,mono,serif; width:700.90625px; overflow:auto; padding-top:1px; color:rgb(51,51,51); line-height:26px; margin:18px 0px!important; background-color:rgb(231,229,220)">
     <div class="bar" style="padding-left:45px">
      <div class="tools" style="padding:3px 8px 10px 10px; font-size:9px; line-height:normal; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; color:silver; border-left-width:3px; border-left-style:solid; border-left-color:rgb(108,226,108); background-color:rgb(248,248,248)">
       <strong>
        [plain]
       </strong>
       <a class="ViewSource" href="http://blog.csdn.net/ibingow/article/details/7882098#" rel="noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; text-indent:-2000px; background-color:inherit" target="_blank" title="view plain">
        view plain
       </a>
       <a class="CopyToClipboard" href="http://blog.csdn.net/ibingow/article/details/7882098#" rel="noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; text-indent:-2000px; background-color:inherit" target="_blank" title="copy">
        copy
       </a>
       <div style="position:absolute; left:568px; top:942px; width:18px; height:18px; z-index:99">
       </div>
      </div>
     </div>
     <ol start="1" style="padding:0px; border:none; list-style-position:initial; color:rgb(92,92,92); margin:0px 0px 1px 45px!important; background-color:rgb(255,255,255)">
      <li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important">
       <span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">
        <span style="margin:0px; padding:0px; border:none; background-color:inherit">
         -rpath dir or --rpath=dir
        </span>
       </span>
      </li>
     </ol>
    </div>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     为了兼容其他 ELF 链接器，如果 -R 选项的值是个目录而不是文件，那么此时相当与 -rpath
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     注：-R filename 与 --just-symbols=filename 等价
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     如果链接时没使用 '-rpath' ，那么如果定义了 LD_RUN_PATH 就会使用该值作为 rpath
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     ld 如果不是直接被调用的，而是是通过一个驱动程序如 gcc 调用，那么的所有的链接选项都需要加上前缀 "-Wl,"， 选项和值之间用","隔开
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <p style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     所以gcc的rpath用法:
    </p>
    <p style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
    </p>
    <div class="dp-highlighter bg_plain" style="font-family:Consolas,'Courier New',Courier,mono,serif; width:700.90625px; overflow:auto; padding-top:1px; color:rgb(51,51,51); line-height:26px; margin:18px 0px!important; background-color:rgb(231,229,220)">
     <div class="bar" style="padding-left:45px">
      <div class="tools" style="padding:3px 8px 10px 10px; font-size:9px; line-height:normal; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; color:silver; border-left-width:3px; border-left-style:solid; border-left-color:rgb(108,226,108); background-color:rgb(248,248,248)">
       <strong>
        [plain]
       </strong>
       <a class="ViewSource" href="http://blog.csdn.net/ibingow/article/details/7882098#" rel="noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; text-indent:-2000px; background-color:inherit" target="_blank" title="view plain">
        view plain
       </a>
       <a class="CopyToClipboard" href="http://blog.csdn.net/ibingow/article/details/7882098#" rel="noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; text-indent:-2000px; background-color:inherit" target="_blank" title="copy">
        copy
       </a>
       <div style="position:absolute; left:568px; top:1251px; width:18px; height:18px; z-index:99">
       </div>
      </div>
     </div>
     <ol start="1" style="padding:0px; border:none; list-style-position:initial; color:rgb(92,92,92); margin:0px 0px 1px 45px!important; background-color:rgb(255,255,255)">
      <li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important">
       <span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">
        <span style="margin:0px; padding:0px; border:none; background-color:inherit">
         -Wl,-rpath,dir
        </span>
       </span>
      </li>
     </ol>
    </div>
    <p style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
    </p>
    <p style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     多个dir之间用冒号分隔:
    </p>
    <p style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
    </p>
    <div class="dp-highlighter bg_plain" style="font-family:Consolas,'Courier New',Courier,mono,serif; width:700.90625px; overflow:auto; padding-top:1px; color:rgb(51,51,51); line-height:26px; margin:18px 0px!important; background-color:rgb(231,229,220)">
     <div class="bar" style="padding-left:45px">
      <div class="tools" style="padding:3px 8px 10px 10px; font-size:9px; line-height:normal; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; color:silver; border-left-width:3px; border-left-style:solid; border-left-color:rgb(108,226,108); background-color:rgb(248,248,248)">
       <strong>
        [plain]
       </strong>
       <a class="ViewSource" href="http://blog.csdn.net/ibingow/article/details/7882098#" rel="noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; text-indent:-2000px; background-color:inherit" target="_blank" title="view plain">
        view plain
       </a>
       <a class="CopyToClipboard" href="http://blog.csdn.net/ibingow/article/details/7882098#" rel="noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; text-indent:-2000px; background-color:inherit" target="_blank" title="copy">
        copy
       </a>
       <div style="position:absolute; left:568px; top:1364px; width:18px; height:18px; z-index:99">
       </div>
      </div>
     </div>
     <ol start="1" style="padding:0px; border:none; list-style-position:initial; color:rgb(92,92,92); margin:0px 0px 1px 45px!important; background-color:rgb(255,255,255)">
      <li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important">
       <span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">
        <span style="margin:0px; padding:0px; border:none; background-color:inherit">
         -Wl,-rpath,dir1:dir2:...:dirN
        </span>
       </span>
      </li>
     </ol>
    </div>
    <p style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
    </p>
    <h5 style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     <a name="t2" style="color:rgb(51,102,153)" target="_blank">
     </a>
     <br/>
    </h5>
    <h5 style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     <a name="t3" style="color:rgb(51,102,153)" target="_blank">
     </a>
     $ORIGING
    </h5>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     代表程序目录，需要加单引号，否则会被解释为变量ORIGIN的值。这样gcc的链接flags为
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <div class="dp-highlighter bg_plain" style="font-family:Consolas,'Courier New',Courier,mono,serif; width:700.90625px; overflow:auto; padding-top:1px; color:rgb(51,51,51); line-height:26px; margin:18px 0px!important; background-color:rgb(231,229,220)">
     <div class="bar" style="padding-left:45px">
      <div class="tools" style="padding:3px 8px 10px 10px; font-size:9px; line-height:normal; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; color:silver; border-left-width:3px; border-left-style:solid; border-left-color:rgb(108,226,108); background-color:rgb(248,248,248)">
       <strong>
        [plain]
       </strong>
       <a class="ViewSource" href="http://blog.csdn.net/ibingow/article/details/7882098#" rel="noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; text-indent:-2000px; background-color:inherit" target="_blank" title="view plain">
        view plain
       </a>
       <a class="CopyToClipboard" href="http://blog.csdn.net/ibingow/article/details/7882098#" rel="noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; text-indent:-2000px; background-color:inherit" target="_blank" title="copy">
        copy
       </a>
       <div style="position:absolute; left:568px; top:1529px; width:18px; height:18px; z-index:99">
       </div>
      </div>
     </div>
     <ol start="1" style="padding:0px; border:none; list-style-position:initial; color:rgb(92,92,92); margin:0px 0px 1px 45px!important; background-color:rgb(255,255,255)">
      <li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important">
       <span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">
        <span style="margin:0px; padding:0px; border:none; background-color:inherit">
         -Wl,-rpath,'$ORIGIN'
        </span>
       </span>
      </li>
     </ol>
    </div>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     或
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <div class="dp-highlighter bg_plain" style="font-family:Consolas,'Courier New',Courier,mono,serif; width:700.90625px; overflow:auto; padding-top:1px; color:rgb(51,51,51); line-height:26px; margin:18px 0px!important; background-color:rgb(231,229,220)">
     <div class="bar" style="padding-left:45px">
      <div class="tools" style="padding:3px 8px 10px 10px; font-size:9px; line-height:normal; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; color:silver; border-left-width:3px; border-left-style:solid; border-left-color:rgb(108,226,108); background-color:rgb(248,248,248)">
       <strong>
        [plain]
       </strong>
       <a class="ViewSource" href="http://blog.csdn.net/ibingow/article/details/7882098#" rel="noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; text-indent:-2000px; background-color:inherit" target="_blank" title="view plain">
        view plain
       </a>
       <a class="CopyToClipboard" href="http://blog.csdn.net/ibingow/article/details/7882098#" rel="noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; text-indent:-2000px; background-color:inherit" target="_blank" title="copy">
        copy
       </a>
       <div style="position:absolute; left:568px; top:1642px; width:18px; height:18px; z-index:99">
       </div>
      </div>
     </div>
     <ol start="1" style="padding:0px; border:none; list-style-position:initial; color:rgb(92,92,92); margin:0px 0px 1px 45px!important; background-color:rgb(255,255,255)">
      <li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important">
       <span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">
        <span style="margin:0px; padding:0px; border:none; background-color:inherit">
         '-Wl,-rpath,$ORIGIN'
        </span>
       </span>
      </li>
     </ol>
    </div>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     用 readelf 查看编译后的程序
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <div class="dp-highlighter bg_plain" style="font-family:Consolas,'Courier New',Courier,mono,serif; width:700.90625px; overflow:auto; padding-top:1px; color:rgb(51,51,51); line-height:26px; margin:18px 0px!important; background-color:rgb(231,229,220)">
     <div class="bar" style="padding-left:45px">
      <div class="tools" style="padding:3px 8px 10px 10px; font-size:9px; line-height:normal; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; color:silver; border-left-width:3px; border-left-style:solid; border-left-color:rgb(108,226,108); background-color:rgb(248,248,248)">
       <strong>
        [plain]
       </strong>
       <a class="ViewSource" href="http://blog.csdn.net/ibingow/article/details/7882098#" rel="noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; text-indent:-2000px; background-color:inherit" target="_blank" title="view plain">
        view plain
       </a>
       <a class="CopyToClipboard" href="http://blog.csdn.net/ibingow/article/details/7882098#" rel="noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; text-indent:-2000px; background-color:inherit" target="_blank" title="copy">
        copy
       </a>
       <div style="position:absolute; left:568px; top:1781px; width:18px; height:18px; z-index:99">
       </div>
      </div>
     </div>
     <ol start="1" style="padding:0px; border:none; list-style-position:initial; color:rgb(92,92,92); margin:0px 0px 1px 45px!important; background-color:rgb(255,255,255)">
      <li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important">
       <span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">
        <span style="margin:0px; padding:0px; border:none; background-color:inherit">
         readelf -d path
        </span>
       </span>
      </li>
     </ol>
    </div>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     会发现多了类似与这么一行
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <div class="dp-highlighter bg_plain" style="font-family:Consolas,'Courier New',Courier,mono,serif; width:700.90625px; overflow:auto; padding-top:1px; color:rgb(51,51,51); line-height:26px; margin:18px 0px!important; background-color:rgb(231,229,220)">
     <div class="bar" style="padding-left:45px">
      <div class="tools" style="padding:3px 8px 10px 10px; font-size:9px; line-height:normal; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; color:silver; border-left-width:3px; border-left-style:solid; border-left-color:rgb(108,226,108); background-color:rgb(248,248,248)">
       <strong>
        [plain]
       </strong>
       <a class="ViewSource" href="http://blog.csdn.net/ibingow/article/details/7882098#" rel="noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; text-indent:-2000px; background-color:inherit" target="_blank" title="view plain">
        view plain
       </a>
       <a class="CopyToClipboard" href="http://blog.csdn.net/ibingow/article/details/7882098#" rel="noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; text-indent:-2000px; background-color:inherit" target="_blank" title="copy">
        copy
       </a>
       <div style="position:absolute; left:568px; top:1894px; width:18px; height:18px; z-index:99">
       </div>
      </div>
     </div>
     <ol start="1" style="padding:0px; border:none; list-style-position:initial; color:rgb(92,92,92); margin:0px 0px 1px 45px!important; background-color:rgb(255,255,255)">
      <li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important">
       <span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">
        <span style="margin:0px; padding:0px; border:none; background-color:inherit">
         0x0000000f (RPATH)                      Library rpath: [$ORIGIN]
        </span>
       </span>
      </li>
     </ol>
    </div>
    <p style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     这样，程序运行前会先搜索程序所在路径有没有依赖的库。
    </p>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <h5 style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     <a name="t4" style="color:rgb(51,102,153)" target="_blank">
     </a>
     Makefile 中的写法:
    </h5>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     注意Makefile里要用两个$$，只用一个$会展开成变量值，$$相当与转义成$
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <div class="dp-highlighter bg_plain" style="font-family:Consolas,'Courier New',Courier,mono,serif; width:700.90625px; overflow:auto; padding-top:1px; color:rgb(51,51,51); line-height:26px; margin:18px 0px!important; background-color:rgb(231,229,220)">
     <div class="bar" style="padding-left:45px">
      <div class="tools" style="padding:3px 8px 10px 10px; font-size:9px; line-height:normal; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; color:silver; border-left-width:3px; border-left-style:solid; border-left-color:rgb(108,226,108); background-color:rgb(248,248,248)">
       <strong>
        [plain]
       </strong>
       <a class="ViewSource" href="http://blog.csdn.net/ibingow/article/details/7882098#" rel="noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; text-indent:-2000px; background-color:inherit" target="_blank" title="view plain">
        view plain
       </a>
       <a class="CopyToClipboard" href="http://blog.csdn.net/ibingow/article/details/7882098#" rel="noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; text-indent:-2000px; background-color:inherit" target="_blank" title="copy">
        copy
       </a>
       <div style="position:absolute; left:568px; top:2099px; width:18px; height:18px; z-index:99">
       </div>
      </div>
     </div>
     <ol start="1" style="padding:0px; border:none; list-style-position:initial; color:rgb(92,92,92); margin:0px 0px 1px 45px!important; background-color:rgb(255,255,255)">
      <li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important">
       <span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">
        <span style="margin:0px; padding:0px; border:none; background-color:inherit">
         LFLAGS += '-Wl,-rpath,$$dir'
        </span>
       </span>
      </li>
     </ol>
    </div>
    <h5 style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     <a name="t5" style="color:rgb(51,102,153)" target="_blank">
     </a>
     <br/>
    </h5>
    <h5 style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     <a name="t6" style="color:rgb(51,102,153)" target="_blank">
     </a>
     qmake 工程中的写法:
    </h5>
    <div class="dp-highlighter bg_plain" style="font-family:Consolas,'Courier New',Courier,mono,serif; width:700.90625px; overflow:auto; padding-top:1px; color:rgb(51,51,51); line-height:26px; margin:18px 0px!important; background-color:rgb(231,229,220)">
     <div class="bar" style="padding-left:45px">
      <div class="tools" style="padding:3px 8px 10px 10px; font-size:9px; line-height:normal; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; color:silver; border-left-width:3px; border-left-style:solid; border-left-color:rgb(108,226,108); background-color:rgb(248,248,248)">
       <strong>
        [plain]
       </strong>
       <a class="ViewSource" href="http://blog.csdn.net/ibingow/article/details/7882098#" rel="noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; text-indent:-2000px; background-color:inherit" target="_blank" title="view plain">
        view plain
       </a>
       <a class="CopyToClipboard" href="http://blog.csdn.net/ibingow/article/details/7882098#" rel="noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; text-indent:-2000px; background-color:inherit" target="_blank" title="copy">
        copy
       </a>
       <div style="position:absolute; left:568px; top:2238px; width:18px; height:18px; z-index:99">
       </div>
      </div>
     </div>
     <ol start="1" style="padding:0px; border:none; list-style-position:initial; color:rgb(92,92,92); margin:0px 0px 1px 45px!important; background-color:rgb(255,255,255)">
      <li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important">
       <span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">
        <span style="margin:0px; padding:0px; border:none; background-color:inherit">
         QMAKE_LFLAGS += -Wl,-rpath,\'\$\$dir\'
        </span>
       </span>
      </li>
     </ol>
    </div>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     或
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <div class="dp-highlighter bg_plain" style="font-family:Consolas,'Courier New',Courier,mono,serif; width:700.90625px; overflow:auto; padding-top:1px; color:rgb(51,51,51); line-height:26px; margin:18px 0px!important; background-color:rgb(231,229,220)">
     <div class="bar" style="padding-left:45px">
      <div class="tools" style="padding:3px 8px 10px 10px; font-size:9px; line-height:normal; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; color:silver; border-left-width:3px; border-left-style:solid; border-left-color:rgb(108,226,108); background-color:rgb(248,248,248)">
       <strong>
        [plain]
       </strong>
       <a class="ViewSource" href="http://blog.csdn.net/ibingow/article/details/7882098#" rel="noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; text-indent:-2000px; background-color:inherit" target="_blank" title="view plain">
        view plain
       </a>
       <a class="CopyToClipboard" href="http://blog.csdn.net/ibingow/article/details/7882098#" rel="noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; text-indent:-2000px; background-color:inherit" target="_blank" title="copy">
        copy
       </a>
       <div style="position:absolute; left:568px; top:2351px; width:18px; height:18px; z-index:99">
       </div>
      </div>
     </div>
     <ol start="1" style="padding:0px; border:none; list-style-position:initial; color:rgb(92,92,92); margin:0px 0px 1px 45px!important; background-color:rgb(255,255,255)">
      <li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important">
       <span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">
        <span style="margin:0px; padding:0px; border:none; background-color:inherit">
         QMAKE_RPATHDIR += :\'\$\$dir\'
        </span>
       </span>
      </li>
     </ol>
    </div>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     注意QMAKE_RPATHDIR最开始要加冒号，因为生成Makefile会自动在前面加上-Wl,-rpath,$$PWD
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <h5 style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     <a name="t7" style="color:rgb(51,102,153)" target="_blank">
     </a>
     <br/>
    </h5>
    <h5 style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     <a name="t8" style="color:rgb(51,102,153)" target="_blank">
     </a>
     bash 里执行 make 命令：
    </h5>
    <div class="dp-highlighter bg_plain" style="font-family:Consolas,'Courier New',Courier,mono,serif; width:700.90625px; overflow:auto; padding-top:1px; color:rgb(51,51,51); line-height:26px; margin:18px 0px!important; background-color:rgb(231,229,220)">
     <div class="bar" style="padding-left:45px">
      <div class="tools" style="padding:3px 8px 10px 10px; font-size:9px; line-height:normal; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; color:silver; border-left-width:3px; border-left-style:solid; border-left-color:rgb(108,226,108); background-color:rgb(248,248,248)">
       <strong>
        [plain]
       </strong>
       <a class="ViewSource" href="http://blog.csdn.net/ibingow/article/details/7882098#" rel="noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; text-indent:-2000px; background-color:inherit" target="_blank" title="view plain">
        view plain
       </a>
       <a class="CopyToClipboard" href="http://blog.csdn.net/ibingow/article/details/7882098#" rel="noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; text-indent:-2000px; background-color:inherit" target="_blank" title="copy">
        copy
       </a>
       <div style="position:absolute; left:568px; top:2516px; width:18px; height:18px; z-index:99">
       </div>
      </div>
     </div>
     <ol start="1" style="padding:0px; border:none; list-style-position:initial; color:rgb(92,92,92); margin:0px 0px 1px 45px!important; background-color:rgb(255,255,255)">
      <li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important">
       <span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">
        <span style="margin:0px; padding:0px; border:none; background-color:inherit">
         make LDFLAGS="'-Wl,-R,\$\$ORIGIN'"
        </span>
       </span>
      </li>
     </ol>
    </div>
    <h5 style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     <a name="t9" style="color:rgb(51,102,153)" target="_blank">
     </a>
     <br/>
    </h5>
    <h5 style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     <a name="t10" style="color:rgb(51,102,153)" target="_blank">
     </a>
     其他有待调查的问题
    </h5>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     1. ld -z -origin 或 g++ -Wl,-z,origin
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     不知道这个有什么作用，文档里一笔带过没看明白。readelf 看了下多了类似与如下的一行
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     0x6ffffffb (FLAGS_1)                    Flags: ORIGIN
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     2. macx
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     @executable_path : relative to the main executable
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     @loader_path : relative to the referring binary
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     @rpath : relative to any of a list of paths.
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     from qtcreator/src/rpath.pri:
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     !isEmpty(TIGER_COMPAT_MODE) {
     <!-- -->
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     QMAKE_LFLAGS_SONAME = -Wl,-install_name,@executable_path/../PlugIns/
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     } else {
     <!-- -->
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     QMAKE_LFLAGS_SONAME = -Wl,-install_name,@rpath/PlugIns/
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     QMAKE_LFLAGS += -Wl,-rpath,@loader_path,-rpath,@executable_path
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     }
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     使用 otool 查看
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     3. clang
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     4. RUNPATH, DT_RUNPATH
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <h5 style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     <a name="t11" style="color:rgb(51,102,153)" target="_blank">
     </a>
     参考文献：
    </h5>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     http://itee.uq.edu.au/~daniel/using_origin/
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     http://stackoverflow.com/questions/9263256/can-you-please-help-me-understand-how-mach-o-libraries-work-in-mac-os-x
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     http://itee.uq.edu.au/~daniel/using_origin/
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     http://stackoverflow.com/questions/6324131/rpath-origin-not-having-desired-effect
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     http://www.delorie.com/gnu/docs/binutils/ld_3.html
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     http://labs.qt.nokia.com/2011/10/28/rpath-and-runpath/
    </span>
    <br style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px"/>
    <span style="color:rgb(51,51,51); font-family:Arial; font-size:14px; line-height:26px">
     http://blog.csdn.net/dbzhang800/article/details/6918413
    </span>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c:6f672e6373646e2e6e65742f6b6576696e5f6461726b656c66:2f61727469636c652f64657461696c732f3430383931353933" class_="artid" style="display:none">
 </p>
</div>


