---
layout: post
title: "Mybatis语法bug"
date: 2025-03-13 22:14:34 +0800
description: "根据您的代码和报错信息分析，这是一个 MyBatis XML 文件中的 SQL 语法问题。补充说明：若使用 Oracle 数据库需改用。建议检查数据库类型并统一时间函数的使用规范。若使用 MySQL 数据库，推荐改用。是 XML 保留字符，必须转义为。，PostgreSQL 建议使用。XML 特殊字符问题。数据库函数兼容性建议。CDATA 区块方案。"
keywords: "Mybatis语法bug"
categories: ['未分类']
tags: ['Mybatis', 'Bug']
artid: "146243700"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146243700
    alt: "Mybatis语法bug"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146243700
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146243700
cover: https://bing.ee123.net/img/rand?artid=146243700
image: https://bing.ee123.net/img/rand?artid=146243700
img: https://bing.ee123.net/img/rand?artid=146243700
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Mybatis语法bug
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     <br/>
     select *
     <br/>
     from appointment
     <br/>
     where status = ‘ACCEPTED’
     <br/>
     and expire_time&lt; now()
     <br/>
     <br/>
     idea显示now（）这里一直报错：
     <br/>
     应为标记名称
     <br/>
     应为=
     <br/>
     <strong>
      Deepseek:
     </strong>
    </p>
    <p>
     根据您的代码和报错信息分析，这是一个 MyBatis XML 文件中的 SQL 语法问题。具体原因及解决方案如下：
    </p>
    <ol>
     <li>
      <p>
       XML 特殊字符问题
       <br/>
       <code>
        &lt; now()
       </code>
       中的小于号
       <code>
        &lt;
       </code>
       是 XML 保留字符，必须转义为
       <code>
        &amp;lt;
       </code>
       ，建议将条件改为：
      </p>
      <pre><code class="prism language-xml">expire_time <span class="token entity named-entity" title="&lt;">&amp;lt;</span> now()
</code></pre>
     </li>
     <li>
      <p>
       数据库函数兼容性建议
       <br/>
       若使用 MySQL 数据库，推荐改用
       <code>
        CURRENT_TIMESTAMP
       </code>
       替代
       <code>
        now()
       </code>
       （功能相同但更符合 SQL 标准）：
      </p>
      <pre><code class="prism language-xml">expire_time <span class="token entity named-entity" title="&lt;">&amp;lt;</span> CURRENT_TIMESTAMP
</code></pre>
     </li>
     <li>
      <p>
       CDATA 区块方案
       <br/>
       对于含特殊字符的 SQL 片段，可用 CDATA 包裹避免转义：
      </p>
      <pre><code class="prism language-xml"><span class="token cdata">&lt;![CDATA[
expire_time &lt; CURRENT_TIMESTAMP
]]&gt;</span>
</code></pre>
     </li>
     <li>
      <p>
       完整修正示例
      </p>
      <pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>getTimeoutAppointments<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cn.edu.hactcm.vitallink.entity.user.Appointment<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    SELECT * 
    FROM appointment 
    WHERE status = 'ACCEPTED' 
    AND expire_time <span class="token entity named-entity" title="&lt;">&amp;lt;</span> CURRENT_TIMESTAMP
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre>
     </li>
    </ol>
    <p>
     补充说明：若使用 Oracle 数据库需改用
     <code>
      SYSDATE
     </code>
     ，PostgreSQL 建议使用
     <code>
      CURRENT_TIMESTAMP
     </code>
     。建议检查数据库类型并统一时间函数的使用规范。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323330325f38313134313134352f:61727469636c652f64657461696c732f313436323433373030" class_="artid" style="display:none">
 </p>
</div>


