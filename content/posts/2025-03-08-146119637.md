---
layout: post
title: "深度学习篇-Opencv中的机器学习和深度学习"
date: 2025-03-08 17:56:45 +0800
description: "OpenCV 是一个开源的计算机视觉库，广泛应用于图像处理、视频分析对象检测等领域。它不仅提供了传统的计算机视觉算法，还集成了机器学习和深度学习的功能。以下是对 OpenCV 中机器学习和深度学习的详细介绍，包括使用步骤、优点和缺点。OpenCV 提供了多种经典的机器学习算法支持向量机 (SVM)K近邻 (K-Nearest Neighbors, KNN)决策树 (Decision Trees)随机森林 (Random Forests)朴素贝叶斯 (Naive Bayes)"
keywords: "深度学习篇---Opencv中的机器学习和深度学习"
categories: ['深度学习篇', '图像处理篇']
tags: ['深度学习', '机器学习', 'Python', 'Opencv']
artid: "146119637"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146119637
    alt: "深度学习篇-Opencv中的机器学习和深度学习"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146119637
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146119637
cover: https://bing.ee123.net/img/rand?artid=146119637
image: https://bing.ee123.net/img/rand?artid=146119637
img: https://bing.ee123.net/img/rand?artid=146119637
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     深度学习篇---Opencv中的机器学习和深度学习
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <hr/>
    <p>
    </p>
    <p>
    </p>
    <hr/>
    <h2>
     <a id="_10">
     </a>
     前言
    </h2>
    <p>
     OpenCV 是一个
     <strong>
      开源的计算机视觉库
     </strong>
     ，广泛应用于
     <strong>
      图像处理、视频分析
     </strong>
     、
     <strong>
      对象检测
     </strong>
     等领域。它不仅提供了传统的
     <strong>
      计算机视觉算法
     </strong>
     ，还集成了
     <strong>
      机器学习和深度学习的功能
     </strong>
     。以下是对 OpenCV 中机器学习和深度学习的详细介绍，包括使用步骤、优点和缺点。
    </p>
    <hr/>
    <h2>
     <a id="OpenCV__18">
     </a>
     一、OpenCV 中的机器学习
    </h2>
    <h3>
     <a id="1__19">
     </a>
     1. 概述
    </h3>
    <p>
     OpenCV 提供了多种
     <strong>
      经典的机器学习算法
     </strong>
     ，包括：
    </p>
    <ol>
     <li>
      支持向量机 (SVM)
     </li>
     <li>
      K近邻 (K-Nearest Neighbors, KNN)
     </li>
     <li>
      决策树 (Decision Trees)
     </li>
     <li>
      随机森林 (Random Forests)
     </li>
     <li>
      朴素贝叶斯 (Naive Bayes)
     </li>
     <li>
      K均值聚类 (K-Means Clustering)
      <br/>
      这些算法可以用于
      <strong>
       分类、回归、聚类
      </strong>
      等任务。
     </li>
    </ol>
    <h3>
     <a id="2__30">
     </a>
     2. 使用步骤
    </h3>
    <p>
     以
     <strong>
      SVM 为例
     </strong>
     ，介绍
     <strong>
      OpenCV 中机器学习
     </strong>
     的使用步骤：
    </p>
    <h4>
     <a id="_1_33">
     </a>
     步骤 1：准备数据
    </h4>
    <pre><code class="prism language-python"><span class="token keyword">import</span> cv2
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token comment">#创建训练数据</span>
train_data <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
labels <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
</code></pre>
    <h4>
     <a id="_2_43">
     </a>
     步骤 2：创建模型
    </h4>
    <pre><code class="prism language-python"><span class="token comment">#创建 SVM 模型</span>
svm <span class="token operator">=</span> cv2<span class="token punctuation">.</span>ml<span class="token punctuation">.</span>SVM_create<span class="token punctuation">(</span><span class="token punctuation">)</span>
svm<span class="token punctuation">.</span>setKernel<span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>ml<span class="token punctuation">.</span>SVM_LINEAR<span class="token punctuation">)</span>  <span class="token comment"># 设置核函数</span>
svm<span class="token punctuation">.</span>setType<span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>ml<span class="token punctuation">.</span>SVM_C_SVC<span class="token punctuation">)</span>    <span class="token comment"># 设置类型为分类</span>
</code></pre>
    <h4>
     <a id="_3_52">
     </a>
     步骤 3：训练模型
    </h4>
    <pre><code class="prism language-bash">svm.train<span class="token punctuation">(</span>train_data, cv2.ml.ROW_SAMPLE, labels<span class="token punctuation">)</span>
</code></pre>
    <h4>
     <a id="_4_58">
     </a>
     步骤 4：预测
    </h4>
    <pre><code class="prism language-bash"><span class="token comment">#创建测试数据</span>
test_data <span class="token operator">=</span> np.random.randint<span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">100</span>, <span class="token punctuation">(</span><span class="token number">5</span>, <span class="token number">2</span><span class="token punctuation">))</span>.astype<span class="token punctuation">(</span>np.float32<span class="token punctuation">)</span>
<span class="token comment">#预测</span>
_, result <span class="token operator">=</span> svm.predict<span class="token punctuation">(</span>test_data<span class="token punctuation">)</span>
print<span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre>
    <h3>
     <a id="3__68">
     </a>
     3. 优点
    </h3>
    <h4>
     <a id="_69">
     </a>
     简单易用
    </h4>
    <p>
     简单易用：
     <strong>
      OpenCV 提供了统一的 API，易于上手。
     </strong>
    </p>
    <h4>
     <a id="_71">
     </a>
     轻量级
    </h4>
    <p>
     轻量级：适合
     <strong>
      嵌入式设备或资源受限的环境
     </strong>
     。
    </p>
    <h4>
     <a id="_73">
     </a>
     实时性
    </h4>
    <p>
     实时性：传统
     <strong>
      机器学习算法通常计算量较小
     </strong>
     ，
     <strong>
      适合实时应用
     </strong>
     。
    </p>
    <h3>
     <a id="4__76">
     </a>
     4. 缺点
    </h3>
    <h4>
     <a id="_77">
     </a>
     特征依赖
    </h4>
    <p>
     特征依赖：需要
     <strong>
      手动提取特征
     </strong>
     ，
     <strong>
      特征工程的质量直接影响模型性能
     </strong>
     。
    </p>
    <h4>
     <a id="_79">
     </a>
     性能有限
    </h4>
    <p>
     性能有限：
     <strong>
      相比深度学习，传统机器学习在处理复杂任务
     </strong>
     （如图像分类、目标检测）时性能较差。
    </p>
    <h2>
     <a id="OpenCV__82">
     </a>
     二、OpenCV 中的深度学习
    </h2>
    <h3>
     <a id="1__83">
     </a>
     1. 概述
    </h3>
    <p>
     OpenCV 从
     <strong>
      3.1 版本
     </strong>
     开始支持
     <strong>
      深度学习模块（dnn）
     </strong>
     ，可以
     <strong>
      加载预训练的深度学习模型（如 TensorFlow、PyTorch、Caffe 等框架训练的模型）
     </strong>
     ，并进行推理。支持的模型包括：
    </p>
    <h4>
     <a id="_ResNetMobileNet_85">
     </a>
     图像分类（如 ResNet、MobileNet）
    </h4>
    <h4>
     <a id="_YOLOSSD_87">
     </a>
     目标检测（如 YOLO、SSD）
    </h4>
    <h4>
     <a id="_DeepLab_89">
     </a>
     语义分割（如 DeepLab）
    </h4>
    <h4>
     <a id="_OpenFace_91">
     </a>
     人脸检测（如 OpenFace）
    </h4>
    <h3>
     <a id="2__93">
     </a>
     2. 使用步骤
    </h3>
    <p>
     以 YOLO 目标检测为例，介绍 OpenCV 中深度学习的使用步骤：
    </p>
    <h4>
     <a id="_1_96">
     </a>
     步骤 1：加载模型
    </h4>
    <pre><code class="prism language-python"><span class="token keyword">import</span> cv2
<span class="token comment">#加载 YOLO 模型</span>
net <span class="token operator">=</span> cv2<span class="token punctuation">.</span>dnn<span class="token punctuation">.</span>readNet<span class="token punctuation">(</span><span class="token string">"yolov3.weights"</span><span class="token punctuation">,</span> <span class="token string">"yolov3.cfg"</span><span class="token punctuation">)</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"coco.names"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    classes <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
</code></pre>
    <h4>
     <a id="_2_106">
     </a>
     步骤 2：准备输入数据
    </h4>
    <pre><code class="prism language-python"><span class="token comment">#加载图像</span>
image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">"image.jpg"</span><span class="token punctuation">)</span>
height<span class="token punctuation">,</span> width<span class="token punctuation">,</span> _ <span class="token operator">=</span> image<span class="token punctuation">.</span>shape

<span class="token comment">#将图像转换为 blob 格式</span>
blob <span class="token operator">=</span> cv2<span class="token punctuation">.</span>dnn<span class="token punctuation">.</span>blobFromImage<span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">255.0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">416</span><span class="token punctuation">,</span> <span class="token number">416</span><span class="token punctuation">)</span><span class="token punctuation">,</span> swapRB<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> crop<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
net<span class="token punctuation">.</span>setInput<span class="token punctuation">(</span>blob<span class="token punctuation">)</span>
</code></pre>
    <h4>
     <a id="_3_118">
     </a>
     步骤 3：推理
    </h4>
    <pre><code class="prism language-python"><span class="token comment">#获取输出层</span>
layer_names <span class="token operator">=</span> net<span class="token punctuation">.</span>getLayerNames<span class="token punctuation">(</span><span class="token punctuation">)</span>
output_layers <span class="token operator">=</span> <span class="token punctuation">[</span>layer_names<span class="token punctuation">[</span>i<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> net<span class="token punctuation">.</span>getUnconnectedOutLayers<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token comment">#前向传播</span>
detections <span class="token operator">=</span> net<span class="token punctuation">.</span>forward<span class="token punctuation">(</span>output_layers<span class="token punctuation">)</span>
</code></pre>
    <h4>
     <a id="_4_129">
     </a>
     步骤 4：解析结果
    </h4>
    <pre><code class="prism language-python"><span class="token keyword">for</span> detection <span class="token keyword">in</span> detections<span class="token punctuation">:</span>
    <span class="token keyword">for</span> obj <span class="token keyword">in</span> detection<span class="token punctuation">:</span>
        scores <span class="token operator">=</span> obj<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
        class_id <span class="token operator">=</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>scores<span class="token punctuation">)</span>
        confidence <span class="token operator">=</span> scores<span class="token punctuation">[</span>class_id<span class="token punctuation">]</span>
        <span class="token keyword">if</span> confidence <span class="token operator">&gt;</span> <span class="token number">0.5</span><span class="token punctuation">:</span>  <span class="token comment"># 过滤低置信度的检测结果</span>
            <span class="token comment"># 获取检测框坐标</span>
            center_x<span class="token punctuation">,</span> center_y<span class="token punctuation">,</span> w<span class="token punctuation">,</span> h <span class="token operator">=</span> <span class="token punctuation">(</span>obj<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">"int"</span><span class="token punctuation">)</span>
            x <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>center_x <span class="token operator">-</span> w <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span>
            y <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>center_y <span class="token operator">-</span> h <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span>
            <span class="token comment"># 绘制检测框</span>
            cv2<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x <span class="token operator">+</span> w<span class="token punctuation">,</span> y <span class="token operator">+</span> h<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
            <span class="token comment"># 显示类别和置信度</span>
            label <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>classes<span class="token punctuation">[</span>class_id<span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>confidence<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">"</span></span>
            cv2<span class="token punctuation">.</span>putText<span class="token punctuation">(</span>image<span class="token punctuation">,</span> label<span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">-</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>FONT_HERSHEY_SIMPLEX<span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
</code></pre>
    <h4>
     <a id="_5_149">
     </a>
     步骤 5：显示结果
    </h4>
    <pre><code class="prism language-python">cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">"Image"</span><span class="token punctuation">,</span> image<span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>destroyAllWindows<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <h3>
     <a id="3__157">
     </a>
     3. 优点
    </h3>
    <h4>
     <a id="_158">
     </a>
     高性能
    </h4>
    <p>
     高性能：
     <strong>
      深度学习模型在复杂任务（如图像分类、目标检测）上表现优异
     </strong>
     。
    </p>
    <h4>
     <a id="_160">
     </a>
     预训练模型
    </h4>
    <p>
     预训练模型：可以
     <strong>
      直接加载预训练模型，无需从头训练
     </strong>
     。
    </p>
    <h4>
     <a id="_162">
     </a>
     跨框架支持
    </h4>
    <p>
     跨框架支持：
     <strong>
      支持多种深度学习框架的模型
     </strong>
     。
    </p>
    <h3>
     <a id="4__165">
     </a>
     4. 缺点
    </h3>
    <h4>
     <a id="_166">
     </a>
     计算资源要求高
    </h4>
    <p>
     计算资源需求高：深度学习模型通常
     <strong>
      需要 GPU 加速，对硬件要求较高
     </strong>
     。
    </p>
    <h4>
     <a id="_168">
     </a>
     训练复杂
    </h4>
    <p>
     训练复杂：OpenCV 的
     <strong>
      dnn 模块仅支持推理
     </strong>
     ，不支持训练，
     <strong>
      训练需要在其他框架（如 TensorFlow、PyTorch）中完成。
     </strong>
    </p>
    <h4>
     <a id="_170">
     </a>
     实时性受限
    </h4>
    <p>
     实时性受限：部分复杂模型（如 YOLOv4、ResNet）在
     <strong>
      CPU 上推理速度较慢
     </strong>
     。
    </p>
    <h2>
     <a id="_173">
     </a>
     三、机器学习与深度学习的对比
    </h2>
    <blockquote>
     <p>
      特性 机器学习 深度学习
      <br/>
      <strong>
       特征提取
      </strong>
      需要
      <strong>
       手动设计
      </strong>
      特征
      <strong>
       自动学习
      </strong>
      特征
      <br/>
      <strong>
       性能
      </strong>
      适合
      <strong>
       简单任务
      </strong>
      适合
      <strong>
       复杂任务
      </strong>
      <br/>
      <strong>
       计算资源
      </strong>
      计算量小，适合 CPU 计算量大，通常需要 GPU
      <br/>
      <strong>
       训练数据
      </strong>
      <strong>
       数据需求较少
      </strong>
      需要
      <strong>
       大量标注数据
      </strong>
      <br/>
      <strong>
       实时性
      </strong>
      <strong>
       实时性较好
      </strong>
      <em>
       复杂模型实时性较差
      </em>
      <br/>
      <strong>
       灵活性
      </strong>
      <strong>
       灵活性较低
      </strong>
      <strong>
       灵活性高，支持多种任务
      </strong>
     </p>
    </blockquote>
    <h2>
     <a id="_181">
     </a>
     四、总结
    </h2>
    <h3>
     <a id="_182">
     </a>
     机器学习
    </h3>
    <p>
     机器学习：适合
     <strong>
      资源受限的场景或简单任务
     </strong>
     ，
     <strong>
      特征工程是关键。
     </strong>
    </p>
    <h3>
     <a id="_184">
     </a>
     深度学习
    </h3>
    <p>
     深度学习：适合
     <strong>
      复杂任务，性能优越，但对硬件和数据要求较高
     </strong>
     。
    </p>
    <p>
     OpenCV 提供了
     <strong>
      机器学习和深度学习
     </strong>
     的接口，开发者可以根据具体需求选择合适的工具。
    </p>
    <hr/>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323330315f37393535363430322f:61727469636c652f64657461696c732f313436313139363337" class_="artid" style="display:none">
 </p>
</div>


