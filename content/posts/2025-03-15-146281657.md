---
layout: post
title: "Blender-MCP服务源码4-初始化项目解读"
date: 2025-03-15 17:49:07 +0800
description: "上篇文章针对Blender开发框架完成了一个基础模板的搭建，并在Blender中成功进行了运行，那这个初始化项目中是如何进行页面效果呈现的，尝试手动进行功能精简来拆解项目代码。"
keywords: "addon.py blender"
categories: ['Blendermcp', 'Ai']
tags: ['Blender']
artid: "146281657"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146281657
    alt: "Blender-MCP服务源码4-初始化项目解读"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146281657
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146281657
cover: https://bing.ee123.net/img/rand?artid=146281657
image: https://bing.ee123.net/img/rand?artid=146281657
img: https://bing.ee123.net/img/rand?artid=146281657
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Blender-MCP服务源码4-初始化项目解读
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="BlenderMCP4_0">
     </a>
     Blender-MCP服务源码4-初始化项目解读
    </h2>
    <blockquote>
     <p>
      上篇文章针对Blender开发框架完成了一个基础模板的搭建，并在Blender中成功进行了运行，那这个初始化项目中是如何进行页面效果呈现的，尝试手动进行功能精简来拆解项目代码
     </p>
    </blockquote>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/direct/2673e6f47d584b229843adcdaa7fb4a4.jpeg"/>
    </p>
    <hr/>
    <h3>
     <a id="1_6">
     </a>
     1-核心知识点
    </h3>
    <ul>
     <li>
      1）如何绘制Blender的插件UI-&gt;如何编写自己的UI界面
     </li>
     <li>
      2）了解如何快速使用Blender的开发框架-&gt;知道在哪里添加自己的核心业务
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="2_11">
     </a>
     2-思路整理
    </h3>
    <ul>
     <li>
      1）Blender开发框架-如何快速的搭建项目
      <ul>
       <li>
        1）main.py修改项目配置
       </li>
       <li>
        2）create.py创建项目
       </li>
       <li>
        3）test.py进行blender调试
       </li>
      </ul>
     </li>
     <li>
      2）只需要在AddonPanels.py修改业务逻辑即可
      <ul>
       <li>
        1）因为当前项目依赖test.py进行调试-&gt;框架中使用了国际化不能随便移除
       </li>
       <li>
        2）尝试了多次，如果是尝试核心业务就不要删除代码的逻辑和目录结构
       </li>
       <li>
        3）代码的调试和发布都是编排好的脚本-&gt;不要乱动
       </li>
      </ul>
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="3_23">
     </a>
     3-参考网址
    </h3>
    <ul>
     <li>
      Blender-MCP-Github地址：https://github.com/ahujasid/blender-mcp
     </li>
     <li>
      B站大佬开源Blender开发框架:https://github.com/xzhuah/BlenderAddonPackageTool
     </li>
     <li>
      <a href="https://www.bilibili.com/video/BV1VBqcY4E6x" rel="nofollow">
       B站大佬开源Blender开发框架教程
      </a>
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="4_30">
     </a>
     4-上手实操
    </h3>
    <h5>
     <a id="1_32">
     </a>
     1-定位代码
    </h5>
    <ul>
     <li>
      右侧：示例插件
     </li>
     <li>
      左侧：示例功能
      <br/>
      <img alt="" src="https://i-blog.csdnimg.cn/direct/00429efc54e34d8bb4da64dabeac0b7d.png"/>
     </li>
     <li>
      文字定位
     </li>
    </ul>
    <blockquote>
     <p>
      定义在一个字典中，针对左右的英文再进行代码定位
     </p>
    </blockquote>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/direct/69dd89f855044f2895eda265654b529b.png"/>
    </p>
    <ul>
     <li>
      代码定位
     </li>
    </ul>
    <blockquote>
     <p>
      貌似核心的代码都在这个文件中[AddonPanels.py]（Blender-MCP在进行插件安装时候-也只有一个blender插件addon.py）-&gt; 貌似我们已经快要接触到代码的本质了
     </p>
    </blockquote>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/direct/36161e69cc1f498791bbae0472af3381.png"/>
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> bpy

<span class="token keyword">from</span> <span class="token punctuation">.</span><span class="token punctuation">.</span>config <span class="token keyword">import</span> __addon_name__  <span class="token comment"># 导入插件名称常量</span>
<span class="token keyword">from</span> <span class="token punctuation">.</span><span class="token punctuation">.</span>operators<span class="token punctuation">.</span>AddonOperators <span class="token keyword">import</span> ExampleOperator  <span class="token comment"># 导入自定义操作符类</span>
<span class="token keyword">from</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>common<span class="token punctuation">.</span>i18n<span class="token punctuation">.</span>i18n <span class="token keyword">import</span> i18n  <span class="token comment"># 导入国际化函数</span>
<span class="token keyword">from</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>common<span class="token punctuation">.</span>types<span class="token punctuation">.</span>framework <span class="token keyword">import</span> reg_order  <span class="token comment"># 导入注册顺序装饰器</span>


<span class="token comment"># 基础面板类</span>
<span class="token keyword">class</span> <span class="token class-name">BasePanel</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    bl_space_type <span class="token operator">=</span> <span class="token string">"VIEW_3D"</span>  <span class="token comment"># 面板所在的空间类型为 3D 视图</span>
    bl_region_type <span class="token operator">=</span> <span class="token string">"UI"</span>  <span class="token comment"># 面板所在的区域类型为 UI 区域</span>
    bl_category <span class="token operator">=</span> <span class="token string">"ExampleAddon"</span>  <span class="token comment"># 面板的分类名称</span>

    <span class="token decorator annotation punctuation">@classmethod</span>
    <span class="token keyword">def</span> <span class="token function">poll</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> context<span class="token punctuation">:</span> bpy<span class="token punctuation">.</span>types<span class="token punctuation">.</span>Context<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>  <span class="token comment"># 始终显示面板</span>


<span class="token comment"># 使用注册顺序装饰器，值为 0，优先级较高</span>
<span class="token decorator annotation punctuation">@reg_order</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">ExampleAddonPanel</span><span class="token punctuation">(</span>BasePanel<span class="token punctuation">,</span> bpy<span class="token punctuation">.</span>types<span class="token punctuation">.</span>Panel<span class="token punctuation">)</span><span class="token punctuation">:</span>
    bl_label <span class="token operator">=</span> <span class="token string">"Example Addon Side Bar Panel"</span>  <span class="token comment"># 面板标签名称</span>
    bl_idname <span class="token operator">=</span> <span class="token string">"SCENE_PT_sample"</span>  <span class="token comment"># 面板的唯一标识符</span>

    <span class="token keyword">def</span> <span class="token function">draw</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> context<span class="token punctuation">:</span> bpy<span class="token punctuation">.</span>types<span class="token punctuation">.</span>Context<span class="token punctuation">)</span><span class="token punctuation">:</span>
        addon_prefs <span class="token operator">=</span> context<span class="token punctuation">.</span>preferences<span class="token punctuation">.</span>addons<span class="token punctuation">[</span>__addon_name__<span class="token punctuation">]</span><span class="token punctuation">.</span>preferences  <span class="token comment"># 获取插件偏好设置</span>

        layout <span class="token operator">=</span> self<span class="token punctuation">.</span>layout  <span class="token comment"># 获取布局对象</span>

        <span class="token comment"># 显示国际化文本和偏好设置中的数字</span>
        layout<span class="token punctuation">.</span>label<span class="token punctuation">(</span>text<span class="token operator">=</span>i18n<span class="token punctuation">(</span><span class="token string">"Example Functions"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">": "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>addon_prefs<span class="token punctuation">.</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment"># 显示并允许编辑文件路径属性</span>
        layout<span class="token punctuation">.</span>prop<span class="token punctuation">(</span>addon_prefs<span class="token punctuation">,</span> <span class="token string">"filepath"</span><span class="token punctuation">)</span>
        layout<span class="token punctuation">.</span>separator<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 添加分隔线</span>

        row <span class="token operator">=</span> layout<span class="token punctuation">.</span>row<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 创建一行布局</span>
        <span class="token comment"># 在同一行显示并允许编辑数字和布尔属性</span>
        row<span class="token punctuation">.</span>prop<span class="token punctuation">(</span>addon_prefs<span class="token punctuation">,</span> <span class="token string">"number"</span><span class="token punctuation">)</span>
        row<span class="token punctuation">.</span>prop<span class="token punctuation">(</span>addon_prefs<span class="token punctuation">,</span> <span class="token string">"boolean"</span><span class="token punctuation">)</span>

        <span class="token comment"># 添加操作符按钮</span>
        layout<span class="token punctuation">.</span>operator<span class="token punctuation">(</span>ExampleOperator<span class="token punctuation">.</span>bl_idname<span class="token punctuation">)</span>

    <span class="token decorator annotation punctuation">@classmethod</span>
    <span class="token keyword">def</span> <span class="token function">poll</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> context<span class="token punctuation">:</span> bpy<span class="token punctuation">.</span>types<span class="token punctuation">.</span>Context<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>  <span class="token comment"># 始终显示面板</span>


<span class="token comment"># 这个面板将在 ExampleAddonPanel 之后绘制，因为其注册顺序值更高</span>
<span class="token decorator annotation punctuation">@reg_order</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">ExampleAddonPanel2</span><span class="token punctuation">(</span>BasePanel<span class="token punctuation">,</span> bpy<span class="token punctuation">.</span>types<span class="token punctuation">.</span>Panel<span class="token punctuation">)</span><span class="token punctuation">:</span>
    bl_label <span class="token operator">=</span> <span class="token string">"Example Addon Side Bar Panel"</span>  <span class="token comment"># 面板标签名称</span>
    bl_idname <span class="token operator">=</span> <span class="token string">"SCENE_PT_sample2"</span>  <span class="token comment"># 面板的唯一标识符</span>

    <span class="token keyword">def</span> <span class="token function">draw</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> context<span class="token punctuation">:</span> bpy<span class="token punctuation">.</span>types<span class="token punctuation">.</span>Context<span class="token punctuation">)</span><span class="token punctuation">:</span>
        layout <span class="token operator">=</span> self<span class="token punctuation">.</span>layout  <span class="token comment"># 获取布局对象</span>
        layout<span class="token punctuation">.</span>label<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">"Second Panel"</span><span class="token punctuation">)</span>  <span class="token comment"># 显示标签文本</span>
        layout<span class="token punctuation">.</span>operator<span class="token punctuation">(</span>ExampleOperator<span class="token punctuation">.</span>bl_idname<span class="token punctuation">)</span>  <span class="token comment"># 添加操作符按钮</span>
</code></pre>
    <hr/>
    <h5>
     <a id="2_107">
     </a>
     2-待完善
    </h5>
    <blockquote>
     <p>
      通过对上面代码的阅读，去除代码中高阶的国际化等功能，我们只保留一个【按钮】点击之后将窗口的物体放大2倍！
     </p>
    </blockquote>
    <blockquote>
     <p>
      后续会尝试在Blender中部署一个socket和MCP本地的服务器进行通讯
     </p>
    </blockquote>
    <ul>
     <li>
      1）文字定义，否则页面展示不出来
      <br/>
      <img alt="" src="https://i-blog.csdnimg.cn/direct/3259816470104975ba835b3ea2e73344.png"/>
     </li>
     <li>
      2）定义的操作
     </li>
    </ul>
    <blockquote>
     <p>
      比如页面上要定义的点击事件，示例：点击按钮让图形缩小0.8倍（3步骤）
     </p>
     <ul>
      <li>
       1）先定义Operator-&gt;直接拷贝示例后修改
      </li>
      <li>
       2）再配置你的Operator-&gt;在国际化配置中配置
      </li>
      <li>
       3）更换你自己的事件
      </li>
     </ul>
    </blockquote>
    <pre><code class="prism language-python"><span class="token keyword">import</span> bpy

<span class="token keyword">from</span> <span class="token punctuation">.</span><span class="token punctuation">.</span>config <span class="token keyword">import</span> __addon_name__
<span class="token keyword">from</span> <span class="token punctuation">.</span><span class="token punctuation">.</span>preference<span class="token punctuation">.</span>AddonPreferences <span class="token keyword">import</span> ExampleAddonPreferences

<span class="token comment"># 自己定义的Operator</span>
<span class="token keyword">class</span> <span class="token class-name">BlenderMCPServer</span><span class="token punctuation">(</span>bpy<span class="token punctuation">.</span>types<span class="token punctuation">.</span>Operator<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''ExampleAddon'''</span>
    bl_idname <span class="token operator">=</span> <span class="token string">"object.blender_mcp_server"</span>
    bl_label <span class="token operator">=</span> <span class="token string">"BlenderMCPServer"</span>

    <span class="token comment"># 确保在操作之前备份数据，用户撤销操作时可以恢复</span>
    bl_options <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'REGISTER'</span><span class="token punctuation">,</span> <span class="token string">'UNDO'</span><span class="token punctuation">}</span>

    <span class="token decorator annotation punctuation">@classmethod</span>
    <span class="token keyword">def</span> <span class="token function">poll</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> context<span class="token punctuation">:</span> bpy<span class="token punctuation">.</span>types<span class="token punctuation">.</span>Context<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> context<span class="token punctuation">.</span>active_object <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span>

    <span class="token keyword">def</span> <span class="token function">execute</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> context<span class="token punctuation">:</span> bpy<span class="token punctuation">.</span>types<span class="token punctuation">.</span>Context<span class="token punctuation">)</span><span class="token punctuation">:</span>
        addon_prefs <span class="token operator">=</span> bpy<span class="token punctuation">.</span>context<span class="token punctuation">.</span>preferences<span class="token punctuation">.</span>addons<span class="token punctuation">[</span>__addon_name__<span class="token punctuation">]</span><span class="token punctuation">.</span>preferences
        <span class="token keyword">assert</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>addon_prefs<span class="token punctuation">,</span> ExampleAddonPreferences<span class="token punctuation">)</span>

        <span class="token comment"># manipulate the scale directly</span>
        context<span class="token punctuation">.</span>active_object<span class="token punctuation">.</span>scale <span class="token operator">*=</span> <span class="token number">0.8</span>
        <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span><span class="token string">'FINISHED'</span><span class="token punctuation">}</span>

</code></pre>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/direct/6479d0ee103c41eda3b25adadc999a42.png"/>
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/direct/e16970148edb4baab132a45f8521584c.png">
      <br/>
      <img alt="" src="https://i-blog.csdnimg.cn/direct/3ab7322a4d1b4c7f97b0c6ef2489dbdf.png"/>
     </img>
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/direct/2c0bcb9367674836b08470afb75a8632.png"/>
    </p>
    <hr/>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323330315f37373731373134382f:61727469636c652f64657461696c732f313436323831363537" class_="artid" style="display:none">
 </p>
</div>


