---
layout: post
title: "13.-Pandas-使用-to_excel-方法写入-Excel文件"
date: 2025-03-13 11:22:46 +0800
description: "一 to_excel 方法的相关参数一 to_excel 方法的相关参数用它来指定要将 DataFrame 写入哪些工作表的哪些单元格，以及是否需要包含列标题和 DataFrame 索引。如何处理特殊值（如np.nan和np.infsheet_name：指定将DataFrame写入的工作表名称。若不存在，pandas会创建一个新的工作表。和startcol：指定从哪个行和列开始写入数据。在工作表中指定一个特定的位置来放置数据。header：布尔值，指定是否写入列标题。默认是True。index。"
keywords: "pandas numpy写入excel sheet"
categories: ['Python', 'Excel']
tags: ['数据挖掘', '大数据', 'Python', 'Pandas', 'Numpy', 'Excel']
artid: "146223802"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146223802
    alt: "13.-Pandas-使用-to_excel-方法写入-Excel文件"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146223802
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146223802
cover: https://bing.ee123.net/img/rand?artid=146223802
image: https://bing.ee123.net/img/rand?artid=146223802
img: https://bing.ee123.net/img/rand?artid=146223802
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     13. Pandas ：使用 to_excel 方法写入 Excel文件
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h2>
     <span style="color:#0d0016">
      一 to_excel 方法的相关参数
     </span>
    </h2>
    <p>
    </p>
    <p>
    </p>
    <p>
     <span style="color:#0d0016">
      用它来指定要将 DataFrame 写入哪些工作表的哪些单元格，以及是否需要包含列标题和 DataFrame 索引。如何处理特殊值（如
      <code>
       np.nan
      </code>
      和
      <code>
       np.inf
      </code>
      ）。
     </span>
    </p>
    <p>
    </p>
    <p>
    </p>
    <h3>
     <span style="color:#0d0016">
      <strong>
       1.指定工作表和单元格
      </strong>
     </span>
    </h3>
    <p>
    </p>
    <p>
     <span style="color:#0d0016">
      <code>
       sheet_name
      </code>
      ：指定将
      <code>
       DataFrame
      </code>
      写入的工作表名称。若不存在，
      <code>
       pandas
      </code>
      会创建一个新的工作表。
     </span>
    </p>
    <pre><code class="language-python"> sheet_name="MySheet",   # 写入的工作表名称</code></pre>
    <p>
     <span style="color:#0d0016">
      <code>
       startrow
      </code>
      和
      <code>
       startcol
      </code>
      ：指定从哪个行和列开始写入数据。在工作表中指定一个特定的位置来放置数据。
     </span>
    </p>
    <pre><code class="language-python">startrow=2,             # 从第三行开始写入（索引从0开始）
startcol=1,             # 从第二列开始写入（索引从0开始）</code></pre>
    <h4>
    </h4>
    <h3>
     <span style="color:#0d0016">
      <strong>
       2.是否包含列标题和索引
      </strong>
     </span>
    </h3>
    <p>
    </p>
    <p>
     <span style="color:#0d0016">
      <code>
       header
      </code>
      ：布尔值，指定是否写入列标题。默认是
      <code>
       True
      </code>
      。
     </span>
    </p>
    <p>
     <span style="color:#0d0016">
      <code>
       index
      </code>
      ：布尔值，指定是否写入行索引。默认是
      <code>
       True
      </code>
      。
     </span>
    </p>
    <pre><code class="language-python">header=True,            # 包含列标题
index=False,            # 不包含行索引</code></pre>
    <h4>
    </h4>
    <h3>
     <span style="color:#0d0016">
      <strong>
       3.处理特殊值
      </strong>
     </span>
    </h3>
    <p>
    </p>
    <p>
     <span style="color:#0d0016">
      <code>
       na_rep
      </code>
      ：指定如何将
      <code>
       NaN
      </code>
      值表示在 Excel 中。默认是空字符串
      <code>
       ""
      </code>
      。
     </span>
    </p>
    <p>
     <span style="color:#0d0016">
      <code>
       inf_rep
      </code>
      ：指定如何将正无穷大（
      <code>
       np.inf
      </code>
      ）和负无穷大（
      <code>
       -np.inf
      </code>
      ）表示在 Excel 中。默认是
      <code>
       "inf"
      </code>
      和
      <code>
       "-inf"
      </code>
      。
     </span>
    </p>
    <pre><code class="language-python">na_rep="NA",            # 将 NaN 表示为 "NA"
inf_rep="Infinity"      # 将 inf 和 -inf 表示为 "Infinity"</code></pre>
    <h4>
    </h4>
    <h3>
     <span style="color:#0d0016">
      4.示例代码1
     </span>
    </h3>
    <p>
    </p>
    <pre><code class="language-python">import pandas as pd
import numpy as np
import datetime as dt

data=[[dt.datetime(2020,1,1, 10, 13), 2.222, 1, True],
[dt.datetime(2020,1,2), np.nan, 2, False],
[dt.datetime(2020,1,2), np.inf, 3, True]]

df = pd.DataFrame(data=data,
columns=["Dates", "Floats", "Integers", "Booleans"])

df.index.name="index"
print(df)

df.to_excel("written_with_pandas.xlsx", 
sheet_name="Output",
startrow=1, 
startcol=1, 
index=True, 
header=True,
na_rep="&lt;NA&gt;", 
inf_rep="&lt;INF&gt;")</code></pre>
    <p class="img-center">
     <img alt="" height="201" src="https://i-blog.csdnimg.cn/direct/fb5f9302da224693b50c0886472ec4f8.png" width="477"/>
    </p>
    <p class="img-center">
     <img alt="" height="158" src="https://i-blog.csdnimg.cn/direct/6c05fba46d864fd2bdd8521ce7ed99eb.png" width="604"/>
    </p>
    <h4>
    </h4>
    <h4>
     <span style="color:#0d0016">
      1.导入库
     </span>
    </h4>
    <p>
    </p>
    <pre><code class="language-python">import datetime as dt</code></pre>
    <p>
     <span style="color:#0d0016">
      <code>
       datetime
      </code>
      ：用于处理日期和时间的库。
     </span>
    </p>
    <p>
    </p>
    <h4>
     <span style="color:#0d0016">
      2.创建数据
     </span>
    </h4>
    <p>
    </p>
    <pre><code class="language-python">data = [
    [dt.datetime(2020, 1, 1, 10, 13), 2.222, 1, True],
    [dt.datetime(2020, 1, 2), np.nan, 2, False],
    [dt.datetime(2020, 1, 2), np.inf, 3, True]
]</code></pre>
    <p>
     <span style="color:#0d0016">
      <code>
       data
      </code>
      是一个列表，其中每个子列表代表
      <code>
       DataFrame
      </code>
      的一行。
     </span>
    </p>
    <p>
     <span style="color:#0d0016">
      每一行包含四个值：一个日期时间对象、一个浮点数、一个整数和一个布尔值。
     </span>
    </p>
    <p>
     <span style="color:#0d0016">
      第二行包含一个
      <code>
       NaN
      </code>
      值（
      <code>
       np.nan
      </code>
      ），表示缺失数据。
     </span>
    </p>
    <p>
     <span style="color:#0d0016">
      第三行包含一个正无穷大值（
      <code>
       np.inf
      </code>
      ）。
     </span>
    </p>
    <p>
     <span style="color:#0d0016">
      <img alt="" height="198" src="https://i-blog.csdnimg.cn/direct/3a55b9bb8e6a4090874aea2133860f50.png" width="840"/>
     </span>
    </p>
    <h4>
    </h4>
    <h4>
     <span style="color:#0d0016">
      3.创建 DataFrame
     </span>
    </h4>
    <p>
    </p>
    <pre><code class="language-python">df = pd.DataFrame(data=data, 
columns=["Dates", "Floats", "Integers", "Booleans"])

df.index.name = "index"</code></pre>
    <p>
     <span style="color:#0d0016">
      <img alt="" height="157" src="https://i-blog.csdnimg.cn/direct/e892d5de599f408481c60777775c73e7.png" width="665"/>
     </span>
    </p>
    <h4>
    </h4>
    <h4>
     <span style="color:#0d0016">
      4.写入 Excel 文件
     </span>
    </h4>
    <p>
    </p>
    <pre><code class="language-python">df.to_excel(
    "written_with_pandas.xlsx",
    sheet_name="Output",
    startrow=1,
    startcol=1,
    index=True,
    header=True,
    na_rep="&lt;NA&gt;",
    inf_rep="&lt;INF&gt;"
)</code></pre>
    <p>
     <span style="color:#0d0016">
      <code>
       to_excel
      </code>
      方法用于将
      <code>
       DataFrame
      </code>
      写入 Excel 文件。
     </span>
    </p>
    <p>
     <span style="color:#0d0016">
      <code>
       "written_with_pandas.xlsx"
      </code>
      ：输出的 Excel 文件名。
     </span>
    </p>
    <p>
     <span style="color:#0d0016">
      <code>
       sheet_name="Output"
      </code>
      ：将数据写入名为
      <code>
       "Output"
      </code>
      的工作表。
     </span>
    </p>
    <p>
     <span style="color:#0d0016">
      <code>
       startrow=1
      </code>
      和
      <code>
       startcol=1
      </code>
      ：数据将从 Excel 文件的第二行和第二列开始写入（索引从 0 开始）。
     </span>
    </p>
    <p>
     <span style="color:#0d0016">
      <code>
       index=True
      </code>
      ：包括
      <code>
       DataFrame
      </code>
      的索引。
     </span>
    </p>
    <p>
     <span style="color:#0d0016">
      <code>
       header=True
      </code>
      ：包括列标题。
     </span>
    </p>
    <p>
     <span style="color:#0d0016">
      <code>
       na_rep="&lt;NA&gt;"
      </code>
      ：将
      <code>
       NaN
      </code>
      值替换为
      <code>
       "&lt;NA&gt;"
      </code>
      。
     </span>
    </p>
    <p>
     <span style="color:#0d0016">
      <code>
       inf_rep="&lt;INF&gt;"
      </code>
      ：将
      <code>
       np.inf
      </code>
      和
      <code>
       -np.inf
      </code>
      替换为
      <code>
       "&lt;INF&gt;"
      </code>
      。
     </span>
    </p>
    <p>
    </p>
    <h3>
     <span style="color:#0d0016">
      5.示例代码2
     </span>
    </h3>
    <p>
    </p>
    <p>
     <span style="color:#0d0016">
      用 with
     </span>
    </p>
    <pre><code class="language-python">import pandas as pd
import numpy as np

# 创建一个示例 DataFrame
data = {
    'A': [1, 2, np.nan, 4],
    'B': [np.inf, 5, 6, -np.inf],
    'C': [7, 8, 9, 10]
}
df = pd.DataFrame(data)

# 将 DataFrame 写入 Excel 文件
with pd.ExcelWriter("output.xlsx") as writer:
    df.to_excel(
        writer,
        sheet_name="MySheet",   # 写入的工作表名称
        startrow=2,             # 从第三行开始写入（索引从0开始）
        startcol=1,             # 从第二列开始写入（索引从0开始）
        header=True,            # 包含列标题
        index=False,            # 不包含行索引
        na_rep="NA",            # 将 NaN 表示为 "NA"
        inf_rep="Infinity"      # 将 inf 和 -inf 表示为 "Infinity"
    )</code></pre>
    <h2>
    </h2>
    <hr/>
    <h2>
     <span style="color:#0d0016">
      二 to_excel 方法和 ExcelClass 类
     </span>
    </h2>
    <p>
    </p>
    <p>
     <span style="color:#0d0016">
      可以将多个 DataFrame 写入同一张或多张工作表。
     </span>
    </p>
    <div>
     <span style="color:#0d0016">
      分 3 次将同一个 DataFrame 写入工作表，前两次写入了工作表 1 的两个位置，第三次写入了工作表 2：
     </span>
    </div>
    <div>
    </div>
    <div>
     <span style="color:#0d0016">
      <img alt="" height="106" src="https://i-blog.csdnimg.cn/direct/efd3d62b39884c52b72fbeb7f36613eb.png" width="702"/>
     </span>
    </div>
    <p>
    </p>
    <p>
     <span style="color:#0d0016">
      将 ExcelClass 用作了上下文管理器，因此当文件离开上下文管理器时（也就是离开由缩进定义的代码块时）会被自动写入磁盘。如果不像这样写的话，则必须显式地调用 writer.save() 。
     </span>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f37343732373137302f:61727469636c652f64657461696c732f313436323233383032" class_="artid" style="display:none">
 </p>
</div>


