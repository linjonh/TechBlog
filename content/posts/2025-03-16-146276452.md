---
layout: post
title: "Docker生存手册安装到服务一本通"
date: 2025-03-16 00:12:13 +0800
description: "Docker 是一种开源的容器化平台，允许开发者将应用程序及其依赖项打包到一个轻量级、可移植的容器中。通过 Docker，应用程序可以在任何环境中快速部署和运行，确保开发、测试和生产环境的一致性。"
keywords: "Docker生存手册：安装到服务一本通"
categories: ['未分类']
tags: ['容器', 'Docker']
artid: "146276452"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146276452
    alt: "Docker生存手册安装到服务一本通"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146276452
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146276452
cover: https://bing.ee123.net/img/rand?artid=146276452
image: https://bing.ee123.net/img/rand?artid=146276452
img: https://bing.ee123.net/img/rand?artid=146276452
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Docker生存手册：安装到服务一本通
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-tomorrow-night" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <hr/>
    <h2>
     <a id="_Docker__4">
     </a>
     一. Docker 容器介绍
    </h2>
    <h3>
     <a id="11_Docker_5">
     </a>
     1.1 什么是Docker容器？
    </h3>
    <p>
     Docker 是一种开源的容器化平台，允许开发者将应用程序及其依赖项打包到一个轻量级、可移植的容器中。通过 Docker，应用程序可以在任何环境中快速部署和运行，确保开发、测试和生产环境的一致性。
    </p>
    <h3>
     <a id="12_Docker_8">
     </a>
     1.2 为什么需要Docker容器？
    </h3>
    <p>
     <strong>
      项目部署的困扰：
     </strong>
    </p>
    <ul>
     <li>
      <p>
       环境一致性：开发、测试、生产环境应当保持一致，但由于各种原因，往往会出现环境差异，导致部署出现问题。
      </p>
     </li>
     <li>
      <p>
       版本管理：不同开发人员在开发过程中，可能会使用不同的开发工具、编程语言、框架，导致版本管理混乱。
      </p>
     </li>
     <li>
      <p>
       依赖管理：不同项目依赖不同的库，如果没有统一的依赖管理，部署会出现问题。
       <br/>
       Docker如何解决这些问题？
      </p>
     </li>
     <li>
      <p>
       Docker 容器化：Docker 容器化解决了环境一致性问题，将开发环境、测试环境、生产环境打包成一个容器，确保开发、测试、生产环境的一致性。
      </p>
     </li>
     <li>
      <p>
       Docker 镜像：Docker 镜像解决了版本管理问题，将开发环境、测试环境、生产环境的依赖打包成镜像，确保开发人员使用统一的开发工具、编程语言、框架。
      </p>
     </li>
     <li>
      <p>
       Docker 仓库：Docker 仓库解决了依赖管理问题，将镜像上传到仓库，其他开发人员可以下载使用。
      </p>
     </li>
    </ul>
    <h3>
     <a id="13_Docker_20">
     </a>
     1.3 Docker架构
    </h3>
    <ul>
     <li>
      服务端(server): Docker守护进程，负责处理Docker指令，管理镜像、容器等
     </li>
     <li>
      客户端(client): 通过命令或RestAP向Docker服务端发送指令。可以在本地或远程向服务端发送指令
     </li>
     <li>
      远程仓库(registry): 远程仓库是Docker用来保存镜像的地方，可以理解为代码仓库。
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/d4c36290d99e40319ac6ff0399044f62.png"/>
     </li>
    </ul>
    <h3>
     <a id="14_Docker__25">
     </a>
     1.4 Docker 相关概念
    </h3>
    <ul>
     <li>
      镜像(Image): Docker镜像是一个只读的模板，包含了运行容器所需的一切。
     </li>
     <li>
      容器(Container): 容器是一个运行中的镜像实例，可以启动、停止、删除、暂停等。
     </li>
     <li>
      仓库(Repository): Docker仓库是一个集中存放镜像文件的地方，每个镜像都有唯一的ID，并可以被推送到多个仓库。
     </li>
     <li>
      标签(Tag): 标签是镜像的版本，可以用来区分同一个镜像的不同版本。
     </li>
     <li>
      Dockerfile: Dockerfile是用来构建Docker镜像的文本文件，包含了一条条的指令来构建镜像。
     </li>
     <li>
      卷(Volume): 卷是一个可供一个或多个容器使用的目录，它可以绕过联合文件系统，直接存取底层文件系统。
     </li>
    </ul>
    <h3>
     <a id="15_Docker_33">
     </a>
     1.5 Docker特点
    </h3>
    <ul>
     <li>
      轻量级：Docker 容器的大小仅几十MB，相比虚拟机镜像大小只有几百MB。
     </li>
     <li>
      便携：Docker 可以在任何 Linux 机器上运行，并不需要安装Docker软件，只需要安装Docker引擎。
     </li>
     <li>
      隔离：Docker 使用容器技术，容器之间互相隔离，互不影响，更安全。文件隔离、系统隔离、资源隔离、网络隔离、日志隔离等。每个容器都完全独立运行在一个沙盒中，所有数据、资源都是隔离的，比如，CPU、内存等等，网络上会为每个容器虚拟一个ip地址，docker为每个容器都提供自己的日志，互不影响。
     </li>
    </ul>
    <h2>
     <a id="_Docker__39">
     </a>
     二. Docker 安装
    </h2>
    <h3>
     <a id="21_Linux_40">
     </a>
     2.1 查看Linux内核版本
    </h3>
    <pre><code class="prism language-bash"><span class="token function">uname</span> <span class="token parameter variable">-r</span>
</code></pre>
    <p>
     要求3.0版本以上
    </p>
    <h3>
     <a id="22_docker_47">
     </a>
     2.2 卸载老版本docker，避免产生影响
    </h3>
    <p>
     如果服务器安装过docker，没有卸载再次安装会导致安装失败，首先要卸载老版本（咱们没安装过docker，可以不需要这个操作，不过可以试一下。）
    </p>
    <pre><code class="prism language-bash">yum remove <span class="token function">docker</span> <span class="token punctuation">\</span>
    docker-client <span class="token punctuation">\</span>
    docker-client-latest <span class="token punctuation">\</span>
    docker-common <span class="token punctuation">\</span>
    docker-latest <span class="token punctuation">\</span>
    docker-latest-logrotate <span class="token punctuation">\</span>
    docker-logrotate <span class="token punctuation">\</span>
    docker-selinux <span class="token punctuation">\</span>
    docker-engine-selinux <span class="token punctuation">\</span>
    docker-engine <span class="token punctuation">\</span>
    docker-ce
</code></pre>
    <h3>
     <a id="23_yum__65">
     </a>
     2.3 升级yum 和配置源
    </h3>
    <p>
     yum工具可以安装软件，安装docker时需要更多工具，操作系统自带不够，所以要升级。
    </p>
    <pre><code class="prism language-bash">yum <span class="token function">install</span> <span class="token parameter variable">-y</span> yum-utils
</code></pre>
    <p>
     配置本地镜像源
    </p>
    <pre><code class="prism language-bash">yum-config-manager <span class="token punctuation">\</span>
    --add-repo <span class="token punctuation">\</span>
    https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
</code></pre>
    <pre><code class="prism language-bash"><span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">'s/download.docker.com/mirrors.aliyun.com\/docker-ce/g'</span> /etc/yum.repos.d/docker-ce.repo
</code></pre>
    <p>
     更新镜像源
    </p>
    <pre><code class="prism language-bash">yum makecache fast
</code></pre>
    <h3>
     <a id="24_Docker_87">
     </a>
     2.4 安装Docker
    </h3>
    <pre><code class="prism language-bash">yum <span class="token function">install</span> <span class="token parameter variable">-y</span> docker-ce
</code></pre>
    <p>
     docker-ce是社区版，docker-ee是企业版，这里安装的是社区版。社区版是免费的，企业版收费。
    </p>
    <h3>
     <a id="25_Docker_94">
     </a>
     2.5 启动Docker
    </h3>
    <pre><code class="prism language-bash">systemctl start <span class="token function">docker</span>
</code></pre>
    <h3>
     <a id="26_Docker_99">
     </a>
     2.6 验证Docker
    </h3>
    <pre><code class="prism language-bash"><span class="token function">docker</span> version
</code></pre>
    <h3>
     <a id="27_Docker_105">
     </a>
     2.7 设置Docker开机自启
    </h3>
    <pre><code class="prism language-bash">systemctl <span class="token builtin class-name">enable</span> <span class="token function">docker</span>
</code></pre>
    <h3>
     <a id="28__110">
     </a>
     2.8 配置镜像加速器
    </h3>
    <pre><code class="prism language-bash"><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /etc/docker
<span class="token function">tee</span> /etc/docker/daemon.json <span class="token operator">&lt;&lt;-</span><span class="token string">'EOF'
{
  "registry-mirrors": ["https://hub-mirror.c.163.com"]
}
EOF</span>
systemctl restart <span class="token function">docker</span>
</code></pre>
    <p>
     或者阿里云加速器
    </p>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /etc/docker
<span class="token function">sudo</span> <span class="token function">tee</span> /etc/docker/daemon.json <span class="token operator">&lt;&lt;-</span><span class="token string">'EOF'
{
  "registry-mirrors": ["https://wm7fopru.mirror.aliyuncs.com"]
}
EOF</span>
<span class="token function">sudo</span> systemctl daemon-reload
<span class="token function">sudo</span> systemctl restart <span class="token function">docker</span>
</code></pre>
    <p>
     或者修改/etc/docker/daemon.json文件
    </p>
    <pre><code class="prism language-bash"><span class="token punctuation">{<!-- --></span>
  <span class="token string">"registry-mirrors"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">"https://docker.registry.cyou"</span>,
<span class="token string">"https://docker-cf.registry.cyou"</span>,
<span class="token string">"https://dockercf.jsdelivr.fyi"</span>,
<span class="token string">"https://docker.jsdelivr.fyi"</span>,
<span class="token string">"https://dockertest.jsdelivr.fyi"</span>,
<span class="token string">"https://mirror.aliyuncs.com"</span>,
<span class="token string">"https://dockerproxy.com"</span>,
<span class="token string">"https://mirror.baidubce.com"</span>,
<span class="token string">"https://docker.m.daocloud.io"</span>,
<span class="token string">"https://docker.nju.edu.cn"</span>,
<span class="token string">"https://docker.mirrors.sjtug.sjtu.edu.cn"</span>,
<span class="token string">"https://docker.mirrors.ustc.edu.cn"</span>,
<span class="token string">"https://mirror.iscas.ac.cn"</span>,
<span class="token string">"https://docker.rainbond.cc"</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     然后重启Docker
    </p>
    <pre><code class="prism language-bash">systemctl daemon-reload
systemctl restart <span class="token function">docker</span>
</code></pre>
    <h3>
     <a id="29__163">
     </a>
     2.9 验证镜像加速是否生效
    </h3>
    <pre><code class="prism language-bash"><span class="token function">docker</span> info
</code></pre>
    <p>
     其中Registry Mirrors就是镜像加速器的地址。
    </p>
    <h3>
     <a id="210_Docker_171">
     </a>
     2.10 卸载Docker
    </h3>
    <pre><code class="prism language-bash">yum remove docker-ce
</code></pre>
    <h2>
     <a id="_Docker__177">
     </a>
     三. Docker 命令
    </h2>
    <h3>
     <a id="31__178">
     </a>
     3.1 镜像命令
    </h3>
    <ul>
     <li>
      镜像名称一般分两部分组成[tag]。
     </li>
     <li>
      在没有指定tag时，默认是latest，代表最新版本的镜像
     </li>
    </ul>
    <pre><code class="prism language-bash"><span class="token function">docker</span> images：查看本地镜像列表
<span class="token function">docker</span> pull：拉取镜像
<span class="token function">docker</span> rmi：删除镜像
<span class="token function">docker</span> tag：给镜像打标签
<span class="token function">docker</span> save：保存镜像
<span class="token function">docker</span> load：加载镜像
<span class="token function">docker</span> build：构建镜像
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/757fd5d78f314c2493dcbb845887f781.png">
      <br/>
      案例：拉取nginx镜像
     </img>
    </p>
    <pre><code class="prism language-bash"><span class="token function">docker</span> pull nginx
</code></pre>
    <p>
     如果不指定镜像名称，则默认拉取latest版本的镜像（最新版本）。
    </p>
    <p>
     案例：删除镜像
    </p>
    <pre><code class="prism language-bash"><span class="token function">docker</span> rmi nginx
</code></pre>
    <p>
     如果有版本号，则删除指定版本的镜像。 如果镜像正在运行，则无法删除。
    </p>
    <p>
     案例：给镜像打标签
    </p>
    <pre><code class="prism language-bash"><span class="token function">docker</span> tag nginx:latest my-nginx:v1.0
</code></pre>
    <p>
     案例：保存镜像
    </p>
    <pre><code class="prism language-bash"><span class="token function">docker</span> save <span class="token parameter variable">-o</span> nginx.tar nginx:latest
</code></pre>
    <p>
     案例：加载镜像
    </p>
    <pre><code class="prism language-bash"><span class="token function">docker</span> load <span class="token parameter variable">-i</span> nginx.tar
</code></pre>
    <p>
     案例：构建镜像
    </p>
    <pre><code class="prism language-bash"><span class="token function">docker</span> build <span class="token parameter variable">-t</span> my-nginx:v1.0 <span class="token builtin class-name">.</span>
</code></pre>
    <ul>
     <li>
      <code>
       docker build
      </code>
      命令的
      <code>
       -t
      </code>
      参数指定镜像的名称和标签，
      <code>
       .
      </code>
      表示当前目录。
     </li>
     <li>
      <code>
       docker build
      </code>
      命令的
      <code>
       .
      </code>
      表示Dockerfile文件所在目录。
     </li>
     <li>
      <code>
       docker build
      </code>
      命令的
      <code>
       -t
      </code>
      参数可以指定多个镜像名称和标签，多个镜像之间用空格隔开。
     </li>
    </ul>
    <h3>
     <a id="32__231">
     </a>
     3.2 容器命令
    </h3>
    <ul>
     <li>
      容器名称一般分两部分组成[id]。
     </li>
     <li>
      在没有指定name时，默认是随机生成的。
     </li>
    </ul>
    <pre><code class="prism language-bash"><span class="token function">docker</span> run：运行容器
<span class="token function">docker</span> ps：查看容器列表
<span class="token function">docker</span> start：启动容器
<span class="token function">docker</span> stop：停止容器
<span class="token function">docker</span> restart：重启容器
<span class="token function">docker</span> rm：删除容器
<span class="token function">docker</span> logs：查看容器日志
<span class="token function">docker</span> exec：进入容器
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/99af63d25b874e588285f4edcc5c28e6.png">
      <br/>
      案例：运行nginx容器
     </img>
    </p>
    <pre><code class="prism language-bash"><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">80</span>:80 <span class="token parameter variable">--name</span> my-nginx nginx
</code></pre>
    <p>
     docker run 命令参数说明：
    </p>
    <ul>
     <li>
      <code>
       docker run
      </code>
      命令的
      <code>
       -d
      </code>
      参数表示后台运行容器。
     </li>
     <li>
      <code>
       docker run
      </code>
      命令的
      <code>
       -p
      </code>
      参数表示将容器的80端口映射到主机的80端口。如：如：
      <code>
       -p 81:80
      </code>
      表示将容器的80端口映射到主机的81端口。
     </li>
     <li>
      <code>
       docker run
      </code>
      命令的
      <code>
       --name
      </code>
      参数表示给容器指定名称。如果不指定名称，则默认随机生成名称。
     </li>
     <li>
      <code>
       docker run
      </code>
      命令的
      <code>
       nginx
      </code>
      参数表示启动的镜像名称。必须指定镜像名称，否则会报错。
     </li>
     <li>
      <code>
       docker run
      </code>
      命令的
      <code>
       -v
      </code>
      参数表示将主机的目录挂载到容器的目录。如：
      <code>
       -v /data/my-data:/usr/share/nginx/html
      </code>
      表示将主机的
      <code>
       /data/my-data
      </code>
      目录挂载到容器的
      <code>
       /usr/share/nginx/html
      </code>
      目录。
     </li>
     <li>
      <code>
       docker run
      </code>
      命令的
      <code>
       -e
      </code>
      参数表示设置环境变量。
     </li>
     <li>
      <code>
       docker run
      </code>
      命令的
      <code>
       -it
      </code>
      参数表示进入交互模式。
     </li>
     <li>
      <code>
       docker run
      </code>
      命令的
      <code>
       --network
      </code>
      参数表示指定容器的网络模式。如
      <code>
       --network=host
      </code>
      表示容器使用宿主机的网络。
     </li>
     <li>
      <code>
       docker run
      </code>
      命令的
      <code>
       --restart
      </code>
      参数表示设置容器的重启策略。如
      <code>
       --restart=always
      </code>
      表示容器总是重启。
     </li>
    </ul>
    <p>
     案例：查看容器列表
    </p>
    <pre><code class="prism language-bash"><span class="token function">docker</span> <span class="token function">ps</span>
</code></pre>
    <p>
     docker ps 命令参数说明
    </p>
    <ul>
     <li>
      <code>
       docker ps
      </code>
      命令 默认只显示运行中的容器。
     </li>
     <li>
      <code>
       docker ps
      </code>
      命令的
      <code>
       -a
      </code>
      参数表示显示所有容器，包括停止的容器。
     </li>
     <li>
      <code>
       docker ps
      </code>
      命令的
      <code>
       -q
      </code>
      参数表示只显示容器的ID。
     </li>
     <li>
      <code>
       docker ps
      </code>
      命令的
      <code>
       -f
      </code>
      参数表示根据条件过滤容器。
     </li>
    </ul>
    <p>
     案例：启动容器
    </p>
    <pre><code class="prism language-bash"><span class="token function">docker</span> start my-nginx
</code></pre>
    <p>
     案例：停止容器
    </p>
    <pre><code class="prism language-bash"><span class="token function">docker</span> stop my-nginx
</code></pre>
    <p>
     案例：重启容器
    </p>
    <pre><code class="prism language-bash"><span class="token function">docker</span> restart my-nginx
</code></pre>
    <p>
     案例：删除容器
    </p>
    <pre><code class="prism language-bash"><span class="token function">docker</span> <span class="token function">rm</span> my-nginx
</code></pre>
    <p>
     docker rm命令的参数说明：
    </p>
    <ul>
     <li>
      <code>
       docker rm
      </code>
      命令的
      <code>
       -f
      </code>
      参数表示强制删除容器。
     </li>
    </ul>
    <p>
     案例：查看容器日志
    </p>
    <pre><code class="prism language-bash"><span class="token function">docker</span> logs my-nginx
</code></pre>
    <p>
     案例：进入容器
    </p>
    <pre><code class="prism language-bash"><span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> my-nginx /bin/bash
</code></pre>
    <ul>
     <li>
      <code>
       docker exec
      </code>
      命令的
      <code>
       -it
      </code>
      参数表示进入交互模式。
     </li>
     <li>
      <code>
       docker exec
      </code>
      命令的
      <code>
       my-nginx
      </code>
      参数表示容器名称。
     </li>
     <li>
      <code>
       docker exec
      </code>
      命令的
      <code>
       /bin/bash
      </code>
      参数表示进入容器的bash命令行。
     </li>
    </ul>
    <h3>
     <a id="33__316">
     </a>
     3.3 数据卷命令
    </h3>
    <p>
     数据卷可以让容器之间共享数据，容器之间的数据修改会立即同步到所有容器。
    </p>
    <ul>
     <li>
      docker volume create：创建数据卷
     </li>
     <li>
      docker volume ls：查看数据卷列表
     </li>
     <li>
      docker volume inspect：查看数据卷详情
     </li>
     <li>
      docker volume rm：删除数据卷
     </li>
     <li>
      docker run：使用数据卷
     </li>
    </ul>
    <p>
     案例：创建数据卷
    </p>
    <pre><code class="prism language-bash"><span class="token function">docker</span> volume create my-data
</code></pre>
    <p>
     案例：查看数据卷列表
    </p>
    <pre><code class="prism language-bash"><span class="token function">docker</span> volume <span class="token function">ls</span>
</code></pre>
    <p>
     案例：查看数据卷详情
    </p>
    <pre><code class="prism language-bash"><span class="token function">docker</span> volume inspect my-data
</code></pre>
    <p>
     案例：删除数据卷
    </p>
    <pre><code class="prism language-bash"><span class="token function">docker</span> volume <span class="token function">rm</span> my-data
</code></pre>
    <p>
     案例：使用数据卷
    </p>
    <pre><code class="prism language-bash"><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">80</span>:80 <span class="token parameter variable">--name</span> my-nginx <span class="token parameter variable">-v</span> my-data:/usr/share/nginx/html nginx
</code></pre>
    <ul>
     <li>
      <code>
       docker run
      </code>
      命令的
      <code>
       -v
      </code>
      参数表示将主机的
      <code>
       my-data
      </code>
      目录挂载到容器的
      <code>
       /usr/share/nginx/html
      </code>
      目录。
     </li>
     <li>
      这样，主机的
      <code>
       my-data
      </code>
      目录中的内容会同步到容器的
      <code>
       /usr/share/nginx/html
      </code>
      目录，容器的
      <code>
       /usr/share/nginx/html
      </code>
      目录中的内容会同步到主机的
      <code>
       my-data
      </code>
      目录。
     </li>
    </ul>
    <h3>
     <a id="34__354">
     </a>
     3.4 其他命令
    </h3>
    <ul>
     <li>
      复制内容到主机
     </li>
    </ul>
    <pre><code class="prism language-bash"><span class="token function">docker</span> <span class="token function">cp</span> my-nginx:/usr/share/nginx/html/ /data/my-data/
</code></pre>
    <ul>
     <li>
      导入/导出镜像
     </li>
    </ul>
    <pre><code class="prism language-bash"><span class="token function">docker</span> save <span class="token parameter variable">-o</span> my-nginx.tar my-nginx:v1.0
<span class="token function">docker</span> load <span class="token parameter variable">-i</span> my-nginx.tar
</code></pre>
    <ul>
     <li>
      导入/导出容器
     </li>
    </ul>
    <pre><code class="prism language-bash"><span class="token function">docker</span> <span class="token builtin class-name">export</span> <span class="token parameter variable">-o</span> my-nginx.tar my-nginx
<span class="token function">docker</span> <span class="token function">import</span> my-nginx.tar my-nginx:v1.0
</code></pre>
    <h3>
     <a id="35__372">
     </a>
     3.5 参考
    </h3>
    <p>
     <a href="https://www.runoob.com/docker/docker-command-manual.html" rel="nofollow">
      Docker命令大全
     </a>
     <br/>
     <a href="https://docs.docker.com/" rel="nofollow">
      Docker官方文档
     </a>
     <br/>
     <a href="https://www.docker.org.cn/" rel="nofollow">
      Docker中文文档
     </a>
     <br/>
     <a href="https://www.runoob.com/docker/docker-tutorial.html" rel="nofollow">
      Docker入门教程
     </a>
     <br/>
     <a href="https://www.yuque.com/docs/share/5d5d9a0a-d57d-476d-b57d-d5d5d9a0ad57?#" rel="nofollow">
      Docker从入门到实践
     </a>
    </p>
    <h2>
     <a id="Docker_383">
     </a>
     四、Docker安装常用服务指南
    </h2>
    <h3>
     <a id="41__DockerNginx_385">
     </a>
     4.1 ◆ Docker安装Nginx
    </h3>
    <h4>
     <a id="411__386">
     </a>
     4.1.1 普通安装方式
    </h4>
    <p>
     <strong>
      操作流程：
     </strong>
    </p>
    <ol>
     <li>
      拉取镜像
     </li>
    </ol>
    <pre><code class="prism language-bash"><span class="token function">docker</span> pull nginx
<span class="token comment"># 或加载本地镜像</span>
<span class="token function">docker</span> load <span class="token parameter variable">-i</span> nginx.tar
</code></pre>
    <ol start="2">
     <li>
      运行容器
     </li>
    </ol>
    <pre><code class="prism language-bash"><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">80</span>:80 <span class="token parameter variable">--name</span> nginx-test nginx
</code></pre>
    <p>
     <strong>
      参数说明：
     </strong>
    </p>
    <ul>
     <li>
      <code>
       -d
      </code>
      ：后台运行
     </li>
     <li>
      <code>
       -p 80:80
      </code>
      ：端口映射（主机:容器）
     </li>
     <li>
      <code>
       --name
      </code>
      ：容器命名
     </li>
    </ul>
    <h4>
     <a id="412__405">
     </a>
     4.1.2 挂载配置方案
    </h4>
    <h5>
     <a id="Volume_406">
     </a>
     方案一：Volume数据卷挂载
    </h5>
    <pre><code class="prism language-bash"><span class="token comment"># 创建数据卷</span>
<span class="token function">docker</span> volume create nginx-<span class="token punctuation">{<!-- --></span>html,conf<span class="token punctuation">}</span>-volume

<span class="token comment"># 启动容器</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">80</span>:80 <span class="token parameter variable">--name</span> nginx-test <span class="token punctuation">\</span>
  <span class="token parameter variable">-v</span> nginx-html-volume:/usr/share/nginx/html <span class="token punctuation">\</span>
  <span class="token parameter variable">-v</span> nginx-conf-volume:/etc/nginx <span class="token punctuation">\</span>
  nginx
</code></pre>
    <h5>
     <a id="_418">
     </a>
     方案二：目录挂载（生产推荐）
    </h5>
    <pre><code class="prism language-bash"><span class="token comment"># 创建本地目录</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /opt/mount/nginx/<span class="token punctuation">{<!-- --></span>html,conf.d<span class="token punctuation">}</span>

<span class="token comment"># 复制默认配置</span>
<span class="token function">docker</span> <span class="token function">cp</span> nginx-test:/usr/share/nginx/html /opt/mount/nginx/
<span class="token function">docker</span> <span class="token function">cp</span> nginx-test:/etc/nginx/conf.d /opt/mount/nginx/

<span class="token comment"># 重新挂载启动</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">80</span>:80 <span class="token parameter variable">--name</span> nginx-prod <span class="token punctuation">\</span>
  <span class="token parameter variable">-v</span> /opt/mount/nginx/html:/usr/share/nginx/html <span class="token punctuation">\</span>
  <span class="token parameter variable">-v</span> /opt/mount/nginx/conf.d:/etc/nginx/conf.d <span class="token punctuation">\</span>
  nginx
</code></pre>
    <p>
     <strong>
      注意事项：
     </strong>
    </p>
    <ul>
     <li>
      访问验证：
      <code>
       curl http://localhost
      </code>
     </li>
     <li>
      配置文件修改后需重启容器生效
     </li>
     <li>
      生产环境建议绑定80+443端口
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="42__DockerMySQL_441">
     </a>
     4.2 ◆ Docker安装MySQL
    </h3>
    <h4>
     <a id="421__442">
     </a>
     4.2.1 基础安装步骤
    </h4>
    <ol>
     <li>
      拉取镜像
     </li>
    </ol>
    <pre><code class="prism language-bash"><span class="token function">docker</span> pull mysql:8.0
</code></pre>
    <ol start="2">
     <li>
      启动容器
     </li>
    </ol>
    <pre><code class="prism language-bash"><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">3306</span>:3306 <span class="token parameter variable">--name</span> mysql-test <span class="token punctuation">\</span>
  <span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> <span class="token punctuation">\</span>
  mysql:8.0
</code></pre>
    <h4>
     <a id="422__455">
     </a>
     4.2.2 数据持久化方案
    </h4>
    <h5>
     <a id="_456">
     </a>
     数据卷挂载模式
    </h5>
    <pre><code class="prism language-bash"><span class="token function">docker</span> volume create mysql-<span class="token punctuation">{<!-- --></span>data,conf<span class="token punctuation">}</span>-volume

<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">3306</span>:3306 <span class="token parameter variable">--name</span> mysql-prod <span class="token punctuation">\</span>
  <span class="token parameter variable">-v</span> mysql-data-volume:/var/lib/mysql <span class="token punctuation">\</span>
  <span class="token parameter variable">-v</span> mysql-conf-volume:/etc/mysql/conf.d <span class="token punctuation">\</span>
  <span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> <span class="token punctuation">\</span>
  mysql:8.0
</code></pre>
    <h5>
     <a id="_467">
     </a>
     目录挂载模式（推荐）
    </h5>
    <pre><code class="prism language-bash"><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /opt/mount/mysql/<span class="token punctuation">{<!-- --></span>data,conf.d<span class="token punctuation">}</span>

<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">3306</span>:3306 <span class="token parameter variable">--name</span> mysql-prod <span class="token punctuation">\</span>
  <span class="token parameter variable">-v</span> /opt/mount/mysql/data:/var/lib/mysql <span class="token punctuation">\</span>
  <span class="token parameter variable">-v</span> /opt/mount/mysql/conf.d:/etc/mysql/conf.d <span class="token punctuation">\</span>
  <span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> <span class="token punctuation">\</span>
  mysql:8.0
</code></pre>
    <p>
     <strong>
      关键配置说明：
     </strong>
    </p>
    <pre><code class="prism language-ini"># my.cnf 配置文件示例
[mysqld]
character-set-server=utf8mb4
default_authentication_plugin=mysql_native_password
</code></pre>
    <hr/>
    <h3>
     <a id="43__DockerNacos_488">
     </a>
     4.3 ◆ Docker安装Nacos集群
    </h3>
    <h4>
     <a id="431__489">
     </a>
     4.3.1 单节点部署
    </h4>
    <pre><code class="prism language-bash"><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">--name</span> nacos-standalone <span class="token punctuation">\</span>
  <span class="token parameter variable">-p</span> <span class="token number">8848</span>:8848 <span class="token parameter variable">-p</span> <span class="token number">9848</span>:9848 <span class="token parameter variable">-p</span> <span class="token number">9849</span>:9849 <span class="token punctuation">\</span>
  <span class="token parameter variable">-e</span> <span class="token assign-left variable">MODE</span><span class="token operator">=</span>standalone <span class="token punctuation">\</span>
  <span class="token parameter variable">-e</span> <span class="token assign-left variable">JVM_XMS</span><span class="token operator">=</span>512m <span class="token parameter variable">-e</span> <span class="token assign-left variable">JVM_XMX</span><span class="token operator">=</span>512m <span class="token punctuation">\</span>
  nacos/nacos-server:v2.3.0
</code></pre>
    <h4>
     <a id="432__499">
     </a>
     4.3.2 集群部署方案
    </h4>
    <ol>
     <li>
      准备3台服务器（node1/node2/node3）
     </li>
     <li>
      每台执行：
     </li>
    </ol>
    <pre><code class="prism language-bash"><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /opt/nacos/<span class="token punctuation">{<!-- --></span>logs,conf,data<span class="token punctuation">}</span>

<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">--name</span> nacos-cluster <span class="token punctuation">\</span>
  <span class="token parameter variable">--network</span><span class="token operator">=</span>host <span class="token punctuation">\</span>
  <span class="token parameter variable">-v</span> /opt/nacos/logs:/home/nacos/logs <span class="token punctuation">\</span>
  <span class="token parameter variable">-v</span> /opt/nacos/conf:/home/nacos/conf <span class="token punctuation">\</span>
  <span class="token parameter variable">-v</span> /opt/nacos/data:/home/nacos/data <span class="token punctuation">\</span>
  <span class="token parameter variable">-e</span> <span class="token assign-left variable">MODE</span><span class="token operator">=</span>cluster <span class="token punctuation">\</span>
  <span class="token parameter variable">-e</span> <span class="token assign-left variable">NACOS_SERVERS</span><span class="token operator">=</span><span class="token string">"node1:8848,node2:8848,node3:8848"</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">-e</span> <span class="token assign-left variable">JVM_XMS</span><span class="token operator">=</span>2g <span class="token parameter variable">-e</span> <span class="token assign-left variable">JVM_XMX</span><span class="token operator">=</span>2g <span class="token punctuation">\</span>
  nacos/nacos-server:v2.3.0
</code></pre>
    <p>
     <strong>
      MySQL集成配置：
     </strong>
    </p>
    <pre><code class="prism language-bash"><span class="token parameter variable">-e</span> <span class="token assign-left variable">SPRING_DATASOURCE_PLATFORM</span><span class="token operator">=</span>mysql <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_SERVICE_HOST</span><span class="token operator">=</span><span class="token number">192.168</span>.1.100 <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_SERVICE_DB_NAME</span><span class="token operator">=</span>nacos_config <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_SERVICE_USER</span><span class="token operator">=</span>nacos <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_SERVICE_PASSWORD</span><span class="token operator">=</span>Nacos@1234
</code></pre>
    <hr/>
    <h3>
     <a id="44__DockerRedis_528">
     </a>
     4.4 ◆ Docker安装Redis
    </h3>
    <h4>
     <a id="441__529">
     </a>
     4.4.1 基础安装
    </h4>
    <pre><code class="prism language-bash"><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">--name</span> redis-test <span class="token punctuation">\</span>
  <span class="token parameter variable">-p</span> <span class="token number">6379</span>:6379 <span class="token punctuation">\</span>
  redis:7.0
</code></pre>
    <h4>
     <a id="442__537">
     </a>
     4.4.2 持久化配置
    </h4>
    <h5>
     <a id="_538">
     </a>
     配置文件挂载
    </h5>
    <pre><code class="prism language-bash"><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /opt/mount/redis/<span class="token punctuation">{<!-- --></span>conf,data<span class="token punctuation">}</span>

<span class="token comment"># redis.conf 核心配置</span>
<span class="token builtin class-name">echo</span> <span class="token string">'
bind 0.0.0.0
protected-mode no
requirepass 123456
appendonly yes
'</span> <span class="token operator">&gt;</span> /opt/mount/redis/conf/redis.conf

<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">--name</span> redis-prod <span class="token punctuation">\</span>
  <span class="token parameter variable">-p</span> <span class="token number">6379</span>:6379 <span class="token punctuation">\</span>
  <span class="token parameter variable">-v</span> /opt/mount/redis/conf:/usr/local/etc/redis <span class="token punctuation">\</span>
  <span class="token parameter variable">-v</span> /opt/mount/redis/data:/data <span class="token punctuation">\</span>
  redis:7.0 redis-server /usr/local/etc/redis/redis.conf
</code></pre>
    <p>
     <strong>
      性能调优参数：
     </strong>
    </p>
    <pre><code class="prism language-ini">maxmemory 2gb
maxmemory-policy allkeys-lru
</code></pre>
    <hr/>
    <h3>
     <a id="45__DockerElasticSearch_566">
     </a>
     4.5 ◆ Docker安装ElasticSearch
    </h3>
    <h4>
     <a id="451_ElasticSearch_567">
     </a>
     4.5.1 ElasticSearch部署
    </h4>
    <pre><code class="prism language-bash"><span class="token comment"># 创建专用网络</span>
<span class="token function">docker</span> network create es-net

<span class="token comment"># 单节点运行</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">--name</span> es-node <span class="token punctuation">\</span>
  <span class="token parameter variable">--network</span> es-net <span class="token punctuation">\</span>
  <span class="token parameter variable">-p</span> <span class="token number">9200</span>:9200 <span class="token parameter variable">-p</span> <span class="token number">9300</span>:9300 <span class="token punctuation">\</span>
  <span class="token parameter variable">-e</span> <span class="token string">"discovery.type=single-node"</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">-e</span> <span class="token string">"ES_JAVA_OPTS=-Xms4g -Xmx4g"</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">-v</span> es-data:/usr/share/elasticsearch/data <span class="token punctuation">\</span>
  elasticsearch:8.6.0
</code></pre>
    <h4>
     <a id="452_Kibana_583">
     </a>
     4.5.2 Kibana可视化
    </h4>
    <pre><code class="prism language-bash"><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">--name</span> kibana <span class="token punctuation">\</span>
  <span class="token parameter variable">--network</span> es-net <span class="token punctuation">\</span>
  <span class="token parameter variable">-p</span> <span class="token number">5601</span>:5601 <span class="token punctuation">\</span>
  <span class="token parameter variable">-e</span> <span class="token assign-left variable">ELASTICSEARCH_HOSTS</span><span class="token operator">=</span>http://es-node:9200 <span class="token punctuation">\</span>
  kibana:8.6.0
</code></pre>
    <p>
     <strong>
      安全配置建议：
     </strong>
    </p>
    <pre><code class="prism language-yaml"><span class="token comment"># elasticsearch.yml</span>
<span class="token key atrule">xpack.security.enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token key atrule">xpack.security.transport.ssl.enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre>
    <hr/>
    <h3>
     <a id="46__602">
     </a>
     4.6 服务验证清单
    </h3>
    <table>
     <thead>
      <tr>
       <th>
        服务
       </th>
       <th>
        验证方式
       </th>
       <th>
        预期结果
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        Nginx
       </td>
       <td>
        <code>
         curl -I http://localhost
        </code>
       </td>
       <td>
        HTTP/1.1 200 OK
       </td>
      </tr>
      <tr>
       <td>
        MySQL
       </td>
       <td>
        <code>
         mysql -h 127.0.0.1 -P 3306 -u root -p
        </code>
       </td>
       <td>
        成功登录
       </td>
      </tr>
      <tr>
       <td>
        Redis
       </td>
       <td>
        <code>
         redis-cli -h 127.0.0.1 -a 123456 ping
        </code>
       </td>
       <td>
        PONG
       </td>
      </tr>
      <tr>
       <td>
        ElasticSearch
       </td>
       <td>
        <code>
         curl http://localhost:9200
        </code>
       </td>
       <td>
        JSON格式节点信息
       </td>
      </tr>
      <tr>
       <td>
        Kibana
       </td>
       <td>
        浏览器访问
        <code>
         http://IP:5601
        </code>
       </td>
       <td>
        Kibana欢迎界面
       </td>
      </tr>
     </tbody>
    </table>
    <hr/>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="687474:70733a2f2f626c6f672e6373646e2e6e65742f6a647868622f:61727469636c652f64657461696c732f313436323736343532" class_="artid" style="display:none">
 </p>
</div>


