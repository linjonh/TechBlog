---
layout: post
title: "青少年编程与数学-02-010-C程序设计基础-43课题MFC"
date: 2025-03-14 15:36:38 +0800
description: "MFC是一个用于简化Windows应用程序开发的C++库，封装了Windows API的大部分功能，提供了丰富的类和函数，特别适用于开发具有复杂用户界面的应用程序。文章详细阐述了MFC的主要特点，包括封装Windows API、文档/视图架构、丰富的控件和对话框以及消息映射机制。"
keywords: "青少年编程与数学 02-010 C++程序设计基础 43课题、MFC"
categories: ['编程与数学', '第02阶段']
tags: ['青少年编程', '编程与数学', '开发语言', 'C']
artid: "146258889"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146258889
    alt: "青少年编程与数学-02-010-C程序设计基础-43课题MFC"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146258889
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146258889
cover: https://bing.ee123.net/img/rand?artid=146258889
image: https://bing.ee123.net/img/rand?artid=146258889
img: https://bing.ee123.net/img/rand?artid=146258889
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     青少年编程与数学 02-010 C++程序设计基础 43课题、MFC
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-tomorrow-night" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <blockquote>
     <p>
      课题摘要:MFC是一个用于简化Windows应用程序开发的C++库，封装了Windows API的大部分功能，提供了丰富的类和函数，特别适用于开发具有复杂用户界面的应用程序。文章详细阐述了MFC的主要特点，包括封装Windows API、文档/视图架构、丰富的控件和对话框以及消息映射机制。通过一个简单的MFC应用程序示例，展示了如何创建项目、添加控件、编写消息处理函数以及编译和运行应用程序。此外，还介绍了MFC编程的最佳实践，如使用资源编辑器、消息映射、文档/视图架构、异常处理和资源管理。希望这些内容能帮助读者更好地理解和使用MFC进行编程。
     </p>
    </blockquote>
    <hr/>
    <h2>
     <a id="MFC_6">
     </a>
     一、MFC
    </h2>
    <p>
     MFC（Microsoft Foundation Classes）是一个由微软提供的C++库，用于简化Windows应用程序的开发。MFC封装了Windows API的大部分功能，并提供了一系列的类和函数，使得开发Windows应用程序更加容易和高效。MFC特别适用于开发具有复杂用户界面的应用程序，如桌面应用程序、工具软件等。
    </p>
    <h4>
     <a id="MFC_10">
     </a>
     MFC的主要特点
    </h4>
    <ol>
     <li>
      <strong>
       封装Windows API
      </strong>
      ：
      <ul>
       <li>
        MFC封装了Windows API的大部分功能，提供了更易于使用的C++类和函数。
       </li>
       <li>
        例如，
        <code>
         CWnd
        </code>
        类封装了Windows窗口的功能，
        <code>
         CFile
        </code>
        类封装了文件操作的功能。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       文档/视图架构
      </strong>
      ：
      <ul>
       <li>
        MFC提供了文档/视图架构，使得开发多文档界面（MDI）和单文档界面（SDI）应用程序更加容易。
       </li>
       <li>
        文档类（如
        <code>
         CDocument
        </code>
        ）管理数据，视图类（如
        <code>
         CView
        </code>
        ）负责显示数据。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       丰富的控件和对话框
      </strong>
      ：
      <ul>
       <li>
        MFC提供了丰富的控件类，如
        <code>
         CButton
        </code>
        、
        <code>
         CEdit
        </code>
        、
        <code>
         CListBox
        </code>
        等，用于创建用户界面。
       </li>
       <li>
        对话框类（如
        <code>
         CDialog
        </code>
        ）简化了对话框的创建和管理。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       消息映射
      </strong>
      ：
      <ul>
       <li>
        MFC使用消息映射机制，使得处理Windows消息更加直观和方便。
       </li>
       <li>
        通过在类中定义消息映射表，可以轻松地将消息与处理函数关联起来。
       </li>
      </ul>
     </li>
    </ol>
    <h4>
     <a id="MFC_25">
     </a>
     MFC的使用示例
    </h4>
    <h5>
     <a id="1_MFC_27">
     </a>
     1. 创建一个简单的MFC应用程序
    </h5>
    <p>
     以下是一个简单的MFC应用程序示例，展示了如何创建一个窗口并处理基本的消息。
    </p>
    <ol>
     <li>
      <strong>
       创建MFC应用程序项目
      </strong>
      ：
      <ul>
       <li>
        使用Visual Studio创建一个新的MFC应用程序项目。
       </li>
       <li>
        选择“MFC应用程序”模板，输入项目名称，如
        <code>
         SimpleMFCApp
        </code>
        。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       添加一个按钮控件
      </strong>
      ：
      <ul>
       <li>
        在资源视图中，打开主对话框资源（通常是
        <code>
         IDD_SIMPLEMFCAPI_DIALOG
        </code>
        ）。
       </li>
       <li>
        使用工具箱中的按钮控件，添加一个按钮，并设置其ID为
        <code>
         IDC_MYBUTTON
        </code>
        。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       添加消息处理函数
      </strong>
      ：
      <ul>
       <li>
        在类视图中，右键点击对话框类（如
        <code>
         CSimpleMFCAppDlg
        </code>
        ），选择“添加成员函数”。
       </li>
       <li>
        选择消息映射，添加
        <code>
         BN_CLICKED
        </code>
        消息处理函数，处理按钮点击事件。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       编写消息处理函数
      </strong>
      ：
      <ul>
       <li>
        在生成的函数中，添加处理逻辑。
       </li>
      </ul>
     </li>
    </ol>
    <pre><code class="prism language-cpp"><span class="token comment">// SimpleMFCAppDlg.h</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"afxdialogex.h"</span></span>

<span class="token keyword">class</span> <span class="token class-name">CSimpleMFCAppDlg</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">CDialogEx</span></span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 构造函数</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">CSimpleMFCAppDlg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 对话框数据</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">AFX_DESIGN_TIME</span></span>
    <span class="token keyword">enum</span> <span class="token punctuation">{<!-- --></span> IDD <span class="token operator">=</span> IDD_SIMPLEMFCAPI_DIALOG <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>

<span class="token keyword">protected</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">DoDataExchange</span><span class="token punctuation">(</span>CDataExchange<span class="token operator">*</span> pDX<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// DDX/DDV 支持</span>

    <span class="token comment">// 实现</span>
<span class="token keyword">protected</span><span class="token operator">:</span>
    HICON m_hIcon<span class="token punctuation">;</span>

    <span class="token comment">// 生成的消息映射函数</span>
    <span class="token keyword">virtual</span> BOOL <span class="token function">OnInitDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    afx_msg <span class="token keyword">void</span> <span class="token function">OnSysCommand</span><span class="token punctuation">(</span>UINT nID<span class="token punctuation">,</span> LPARAM lParam<span class="token punctuation">)</span><span class="token punctuation">;</span>
    afx_msg <span class="token keyword">void</span> <span class="token function">OnPaint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    afx_msg HCURSOR <span class="token function">OnQueryDragIcon</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">DECLARE_MESSAGE_MAP</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">public</span><span class="token operator">:</span>
    afx_msg <span class="token keyword">void</span> <span class="token function">OnBnClickedMybutton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// SimpleMFCAppDlg.cpp</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"stdafx.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"SimpleMFCApp.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"SimpleMFCAppDlg.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"afxdialogex.h"</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">_DEBUG</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">new</span> <span class="token expression">DEBUG_NEW</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>

<span class="token comment">// 应用程序对话框</span>

<span class="token class-name">CSimpleMFCAppDlg</span><span class="token double-colon punctuation">::</span><span class="token function">CSimpleMFCAppDlg</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token function">CDialogEx</span><span class="token punctuation">(</span>IDD_SIMPLEMFCAPI_DIALOG<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">CSimpleMFCAppDlg</span><span class="token double-colon punctuation">::</span><span class="token function">DoDataExchange</span><span class="token punctuation">(</span>CDataExchange<span class="token operator">*</span> pDX<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name">CDialogEx</span><span class="token double-colon punctuation">::</span><span class="token function">DoDataExchange</span><span class="token punctuation">(</span>pDX<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">BEGIN_MESSAGE_MAP</span><span class="token punctuation">(</span>CSimpleMFCAppDlg<span class="token punctuation">,</span> CDialogEx<span class="token punctuation">)</span>
    <span class="token function">ON_WM_SYSCOMMAND</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">ON_WM_PAINT</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">ON_WM_QUERYDRAGICON</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">ON_BN_CLICKED</span><span class="token punctuation">(</span>IDC_MYBUTTON<span class="token punctuation">,</span> <span class="token operator">&amp;</span>CSimpleMFCAppDlg<span class="token double-colon punctuation">::</span>OnBnClickedMybutton<span class="token punctuation">)</span>
<span class="token function">END_MESSAGE_MAP</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// CSimpleMFCAppDlg 消息处理程序</span>

BOOL <span class="token class-name">CSimpleMFCAppDlg</span><span class="token double-colon punctuation">::</span><span class="token function">OnInitDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name">CDialogEx</span><span class="token double-colon punctuation">::</span><span class="token function">OnInitDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 设置图标</span>
    m_hIcon <span class="token operator">=</span> <span class="token function">AfxGetApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">LoadIcon</span><span class="token punctuation">(</span>IDR_MAINFRAME<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">SetIcon</span><span class="token punctuation">(</span>m_hIcon<span class="token punctuation">,</span> TRUE<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 设置大图标</span>
    <span class="token function">SetIcon</span><span class="token punctuation">(</span>m_hIcon<span class="token punctuation">,</span> FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 设置小图标</span>

    <span class="token keyword">return</span> TRUE<span class="token punctuation">;</span>  <span class="token comment">// return TRUE 除非你设置了焦点</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">CSimpleMFCAppDlg</span><span class="token double-colon punctuation">::</span><span class="token function">OnSysCommand</span><span class="token punctuation">(</span>UINT nID<span class="token punctuation">,</span> LPARAM lParam<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>nID <span class="token operator">&amp;</span> <span class="token number">0xFFF0</span><span class="token punctuation">)</span> <span class="token operator">==</span> IDM_ABOUTBOX<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        CAboutDlg dlgAbout<span class="token punctuation">;</span>
        dlgAbout<span class="token punctuation">.</span><span class="token function">DoModal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">CDialogEx</span><span class="token double-colon punctuation">::</span><span class="token function">OnSysCommand</span><span class="token punctuation">(</span>nID<span class="token punctuation">,</span> lParam<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">CSimpleMFCAppDlg</span><span class="token double-colon punctuation">::</span><span class="token function">OnPaint</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">IsIconic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        CPaintDC <span class="token function">dc</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设备上下文用于绘制</span>

        <span class="token function">SendMessage</span><span class="token punctuation">(</span>WM_ICONERASEBKGND<span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">reinterpret_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>WPARAM<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>dc<span class="token punctuation">.</span><span class="token function">GetSafeHdc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 使图标在工作区矩形中居中</span>
        <span class="token keyword">int</span> cxIcon <span class="token operator">=</span> <span class="token function">GetSystemMetrics</span><span class="token punctuation">(</span>SM_CXICON<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> cyIcon <span class="token operator">=</span> <span class="token function">GetSystemMetrics</span><span class="token punctuation">(</span>SM_CYICON<span class="token punctuation">)</span><span class="token punctuation">;</span>
        CRect rect<span class="token punctuation">;</span>
        <span class="token function">GetClientRect</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>rect<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token punctuation">(</span>rect<span class="token punctuation">.</span><span class="token function">Width</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> cxIcon <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token punctuation">(</span>rect<span class="token punctuation">.</span><span class="token function">Height</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> cyIcon <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>

        <span class="token comment">// 绘制图标</span>
        dc<span class="token punctuation">.</span><span class="token function">DrawIcon</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> m_hIcon<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">CDialogEx</span><span class="token double-colon punctuation">::</span><span class="token function">OnPaint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

HCURSOR <span class="token class-name">CSimpleMFCAppDlg</span><span class="token double-colon punctuation">::</span><span class="token function">OnQueryDragIcon</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>HCURSOR<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>m_hIcon<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">CSimpleMFCAppDlg</span><span class="token double-colon punctuation">::</span><span class="token function">OnBnClickedMybutton</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 按钮点击事件处理</span>
    <span class="token function">AfxMessageBox</span><span class="token punctuation">(</span><span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"按钮被点击了！"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="MFC_171">
     </a>
     MFC的最佳实践
    </h4>
    <ol>
     <li>
      <strong>
       使用资源编辑器
      </strong>
      ：
      <ul>
       <li>
        使用Visual Studio的资源编辑器创建和管理用户界面元素，如对话框、菜单、工具栏等。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       消息映射
      </strong>
      ：
      <ul>
       <li>
        使用消息映射机制处理消息，使代码更加清晰和易于维护。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       文档/视图架构
      </strong>
      ：
      <ul>
       <li>
        对于复杂的文档编辑应用程序，使用文档/视图架构可以更好地分离数据和视图逻辑。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       异常处理
      </strong>
      ：
      <ul>
       <li>
        使用异常处理机制处理运行时错误，确保应用程序的健壮性。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       资源管理
      </strong>
      ：
      <ul>
       <li>
        使用RAII技术管理资源，确保资源在作用域结束时自动释放。
       </li>
      </ul>
     </li>
    </ol>
    <h4>
     <a id="_184">
     </a>
     总结
    </h4>
    <p>
     MFC是一个强大的C++库，用于简化Windows应用程序的开发。通过封装Windows API的功能，MFC提供了丰富的类和函数，使得开发具有复杂用户界面的应用程序更加容易和高效。希望这些内容能帮助你更好地理解和使用MFC。
    </p>
    <h2>
     <a id="_188">
     </a>
     二、使用步骤
    </h2>
    <p>
     以下是如何使用MFC进行编程的详细步骤和示例。
    </p>
    <h4>
     <a id="1__192">
     </a>
     1. 安装和配置开发环境
    </h4>
    <h5>
     <a id="11_Visual_Studio_194">
     </a>
     1.1 安装Visual Studio
    </h5>
    <p>
     MFC开发通常需要使用Visual Studio。确保安装了Visual Studio，并且选择了“使用C++的桌面开发”工作负载。
    </p>
    <h5>
     <a id="12__198">
     </a>
     1.2 配置项目
    </h5>
    <p>
     创建一个新的MFC应用程序项目：
    </p>
    <ol>
     <li>
      打开Visual Studio。
     </li>
     <li>
      选择“创建新项目”。
     </li>
     <li>
      在项目类型中选择“MFC应用程序”。
     </li>
     <li>
      输入项目名称和位置，点击“创建”。
     </li>
     <li>
      在MFC应用程序向导中，选择应用程序类型（如单文档、多文档、对话框等），点击“完成”。
     </li>
    </ol>
    <h4>
     <a id="2__208">
     </a>
     2. 创建用户界面
    </h4>
    <h5>
     <a id="21__210">
     </a>
     2.1 使用资源编辑器
    </h5>
    <p>
     Visual Studio的资源编辑器可以方便地创建和管理用户界面元素，如对话框、菜单、工具栏等。
    </p>
    <ol>
     <li>
      <strong>
       添加对话框
      </strong>
      ：
      <ul>
       <li>
        在资源视图中，右键点击“资源文件”，选择“添加” -&gt; “资源”。
       </li>
       <li>
        选择“对话框”，点击“新建”。
       </li>
       <li>
        使用工具箱中的控件（如按钮、编辑框、列表框等）添加到对话框中。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       添加控件
      </strong>
      ：
      <ul>
       <li>
        例如，添加一个按钮控件，并设置其ID为
        <code>
         IDC_MYBUTTON
        </code>
        。
       </li>
      </ul>
     </li>
    </ol>
    <h4>
     <a id="3__221">
     </a>
     3. 编写代码
    </h4>
    <h5>
     <a id="31__223">
     </a>
     3.1 添加消息处理函数
    </h5>
    <ol>
     <li>
      <strong>
       添加消息处理函数
      </strong>
      ：
      <ul>
       <li>
        在类视图中，右键点击对话框类（如
        <code>
         CSimpleMFCAppDlg
        </code>
        ），选择“添加成员函数”。
       </li>
       <li>
        选择消息映射，添加
        <code>
         BN_CLICKED
        </code>
        消息处理函数，处理按钮点击事件。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       编写消息处理函数
      </strong>
      ：
      <ul>
       <li>
        在生成的函数中，添加处理逻辑。
       </li>
      </ul>
     </li>
    </ol>
    <pre><code class="prism language-cpp"><span class="token comment">// SimpleMFCAppDlg.h</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"afxdialogex.h"</span></span>

<span class="token keyword">class</span> <span class="token class-name">CSimpleMFCAppDlg</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">CDialogEx</span></span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 构造函数</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">CSimpleMFCAppDlg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 对话框数据</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">AFX_DESIGN_TIME</span></span>
    <span class="token keyword">enum</span> <span class="token punctuation">{<!-- --></span> IDD <span class="token operator">=</span> IDD_SIMPLEMFCAPI_DIALOG <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>

<span class="token keyword">protected</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">DoDataExchange</span><span class="token punctuation">(</span>CDataExchange<span class="token operator">*</span> pDX<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// DDX/DDV 支持</span>

    <span class="token comment">// 实现</span>
<span class="token keyword">protected</span><span class="token operator">:</span>
    HICON m_hIcon<span class="token punctuation">;</span>

    <span class="token comment">// 生成的消息映射函数</span>
    <span class="token keyword">virtual</span> BOOL <span class="token function">OnInitDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    afx_msg <span class="token keyword">void</span> <span class="token function">OnSysCommand</span><span class="token punctuation">(</span>UINT nID<span class="token punctuation">,</span> LPARAM lParam<span class="token punctuation">)</span><span class="token punctuation">;</span>
    afx_msg <span class="token keyword">void</span> <span class="token function">OnPaint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    afx_msg HCURSOR <span class="token function">OnQueryDragIcon</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">DECLARE_MESSAGE_MAP</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">public</span><span class="token operator">:</span>
    afx_msg <span class="token keyword">void</span> <span class="token function">OnBnClickedMybutton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// SimpleMFCAppDlg.cpp</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"stdafx.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"SimpleMFCApp.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"SimpleMFCAppDlg.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"afxdialogex.h"</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">_DEBUG</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">new</span> <span class="token expression">DEBUG_NEW</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>

<span class="token comment">// 应用程序对话框</span>

<span class="token class-name">CSimpleMFCAppDlg</span><span class="token double-colon punctuation">::</span><span class="token function">CSimpleMFCAppDlg</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token function">CDialogEx</span><span class="token punctuation">(</span>IDD_SIMPLEMFCAPI_DIALOG<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">CSimpleMFCAppDlg</span><span class="token double-colon punctuation">::</span><span class="token function">DoDataExchange</span><span class="token punctuation">(</span>CDataExchange<span class="token operator">*</span> pDX<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name">CDialogEx</span><span class="token double-colon punctuation">::</span><span class="token function">DoDataExchange</span><span class="token punctuation">(</span>pDX<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">BEGIN_MESSAGE_MAP</span><span class="token punctuation">(</span>CSimpleMFCAppDlg<span class="token punctuation">,</span> CDialogEx<span class="token punctuation">)</span>
    <span class="token function">ON_WM_SYSCOMMAND</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">ON_WM_PAINT</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">ON_WM_QUERYDRAGICON</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">ON_BN_CLICKED</span><span class="token punctuation">(</span>IDC_MYBUTTON<span class="token punctuation">,</span> <span class="token operator">&amp;</span>CSimpleMFCAppDlg<span class="token double-colon punctuation">::</span>OnBnClickedMybutton<span class="token punctuation">)</span>
<span class="token function">END_MESSAGE_MAP</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// CSimpleMFCAppDlg 消息处理程序</span>

BOOL <span class="token class-name">CSimpleMFCAppDlg</span><span class="token double-colon punctuation">::</span><span class="token function">OnInitDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name">CDialogEx</span><span class="token double-colon punctuation">::</span><span class="token function">OnInitDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 设置图标</span>
    m_hIcon <span class="token operator">=</span> <span class="token function">AfxGetApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">LoadIcon</span><span class="token punctuation">(</span>IDR_MAINFRAME<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">SetIcon</span><span class="token punctuation">(</span>m_hIcon<span class="token punctuation">,</span> TRUE<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 设置大图标</span>
    <span class="token function">SetIcon</span><span class="token punctuation">(</span>m_hIcon<span class="token punctuation">,</span> FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 设置小图标</span>

    <span class="token keyword">return</span> TRUE<span class="token punctuation">;</span>  <span class="token comment">// return TRUE 除非你设置了焦点</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">CSimpleMFCAppDlg</span><span class="token double-colon punctuation">::</span><span class="token function">OnSysCommand</span><span class="token punctuation">(</span>UINT nID<span class="token punctuation">,</span> LPARAM lParam<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>nID <span class="token operator">&amp;</span> <span class="token number">0xFFF0</span><span class="token punctuation">)</span> <span class="token operator">==</span> IDM_ABOUTBOX<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        CAboutDlg dlgAbout<span class="token punctuation">;</span>
        dlgAbout<span class="token punctuation">.</span><span class="token function">DoModal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">CDialogEx</span><span class="token double-colon punctuation">::</span><span class="token function">OnSysCommand</span><span class="token punctuation">(</span>nID<span class="token punctuation">,</span> lParam<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">CSimpleMFCAppDlg</span><span class="token double-colon punctuation">::</span><span class="token function">OnPaint</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">IsIconic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        CPaintDC <span class="token function">dc</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设备上下文用于绘制</span>

        <span class="token function">SendMessage</span><span class="token punctuation">(</span>WM_ICONERASEBKGND<span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">reinterpret_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>WPARAM<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>dc<span class="token punctuation">.</span><span class="token function">GetSafeHdc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 使图标在工作区矩形中居中</span>
        <span class="token keyword">int</span> cxIcon <span class="token operator">=</span> <span class="token function">GetSystemMetrics</span><span class="token punctuation">(</span>SM_CXICON<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> cyIcon <span class="token operator">=</span> <span class="token function">GetSystemMetrics</span><span class="token punctuation">(</span>SM_CYICON<span class="token punctuation">)</span><span class="token punctuation">;</span>
        CRect rect<span class="token punctuation">;</span>
        <span class="token function">GetClientRect</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>rect<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token punctuation">(</span>rect<span class="token punctuation">.</span><span class="token function">Width</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> cxIcon <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token punctuation">(</span>rect<span class="token punctuation">.</span><span class="token function">Height</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> cyIcon <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>

        <span class="token comment">// 绘制图标</span>
        dc<span class="token punctuation">.</span><span class="token function">DrawIcon</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> m_hIcon<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">CDialogEx</span><span class="token double-colon punctuation">::</span><span class="token function">OnPaint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

HCURSOR <span class="token class-name">CSimpleMFCAppDlg</span><span class="token double-colon punctuation">::</span><span class="token function">OnQueryDragIcon</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>HCURSOR<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>m_hIcon<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">CSimpleMFCAppDlg</span><span class="token double-colon punctuation">::</span><span class="token function">OnBnClickedMybutton</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 按钮点击事件处理</span>
    <span class="token function">AfxMessageBox</span><span class="token punctuation">(</span><span class="token function">_T</span><span class="token punctuation">(</span><span class="token string">"按钮被点击了！"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="4__359">
     </a>
     4. 编译和运行
    </h4>
    <ol>
     <li>
      <strong>
       编译项目
      </strong>
      ：
      <ul>
       <li>
        在Visual Studio中，选择“生成” -&gt; “生成解决方案”。
       </li>
       <li>
        如果编译成功，会生成可执行文件。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       运行应用程序
      </strong>
      ：
      <ul>
       <li>
        选择“调试” -&gt; “开始调试”或按F5键运行应用程序。
       </li>
       <li>
        应用程序窗口将显示，点击按钮会弹出消息框。
       </li>
      </ul>
     </li>
    </ol>
    <h4>
     <a id="5_MFC_368">
     </a>
     5. MFC编程的最佳实践
    </h4>
    <ol>
     <li>
      <strong>
       使用资源编辑器
      </strong>
      ：
      <ul>
       <li>
        使用Visual Studio的资源编辑器创建和管理用户界面元素，如对话框、菜单、工具栏等。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       消息映射
      </strong>
      ：
      <ul>
       <li>
        使用消息映射机制处理消息，使代码更加清晰和易于维护。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       文档/视图架构
      </strong>
      ：
      <ul>
       <li>
        对于复杂的文档编辑应用程序，使用文档/视图架构可以更好地分离数据和视图逻辑。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       异常处理
      </strong>
      ：
      <ul>
       <li>
        使用异常处理机制处理运行时错误，确保应用程序的健壮性。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       资源管理
      </strong>
      ：
      <ul>
       <li>
        使用RAII技术管理资源，确保资源在作用域结束时自动释放。
       </li>
      </ul>
     </li>
    </ol>
    <h4>
     <a id="_381">
     </a>
     总结
    </h4>
    <p>
     MFC是一个强大的C++类库，用于简化Windows应用程序的开发。通过封装Windows API的功能，MFC提供了丰富的类和函数，使得开发具有复杂用户界面的应用程序更加容易和高效。希望这些内容能帮助你更好地理解和使用MFC进行编程。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
  <div class="blog-extension-box" id="blogExtensionBox" style="width:400px;margin:auto;margin-top:12px">
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34303037313538352f:61727469636c652f64657461696c732f313436323538383839" class_="artid" style="display:none">
 </p>
</div>


