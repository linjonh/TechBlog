---
layout: post
title: "IDEA新版中Java-Flight-Recorder程序性能监视工具的使用"
date: 2024-06-30 14:22:13 +0800
description: "Java Flight Recorder简介研发人员在遇到线上报警或需要优化系统性能时，常常需要分析"
keywords: "run with java flight recorder"
categories: ['Recorder', 'Java', 'Java', 'Idea', 'Flight']
tags: ['火焰图', '性能监视工具', 'Recorder', 'Java', 'Java', 'Idea', 'Flight']
artid: "102545780"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=102545780
    alt: "IDEA新版中Java-Flight-Recorder程序性能监视工具的使用"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=102545780
featuredImagePreview: https://bing.ee123.net/img/rand?artid=102545780
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     IDEA新版中Java Flight Recorder程序性能监视工具的使用
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h4>
     Java Flight Recorder简介
    </h4>
    <p>
     研发人员在遇到线上报警或需要优化系统性能时，常常需要分析程序运行行为和性能瓶颈。而
     <strong>
      <em>
       <span style="color:rgba(39,40,44,.7);">
        Java Flight Recorder
       </span>
      </em>
     </strong>
     （JFR）是一种监视工具，可在应用程序执行期间收集有关Java虚拟机中特定时间实例中事件（数据片段）的信息。
    </p>
    <h4>
     如何使用？
    </h4>
    <ol style="margin-left:0px;">
     <li id="d9358cd7">
      <p style="margin-left:0px;">
       <span style="color:inherit;">
        从主菜单中，选择
       </span>
       <strong>
        Run | Edit Configurations
       </strong>
       <span style="color:inherit;">
        <strong>
         ，
        </strong>
        然后从左侧列表中选择要使用JFR分析的运行配置。
       </span>
      </p>
     </li>
     <li id="984674eb">
      <p style="margin-left:0px;">
       <span style="color:inherit;">
        在
       </span>
       <strong>
        Configuration
       </strong>
       <span style="color:inherit;">
        选项卡上，展开
       </span>
       <strong>
        Environment
       </strong>
       <span style="color:inherit;">
        部分。
       </span>
      </p>
     </li>
     <li id="7c34470f">
      <p style="margin-left:0px;">
       <span style="color:inherit;">
        在
       </span>
       <strong>
        VM options
       </strong>
       <span style="color:inherit;">
        ，添加：
        <code>
         -XX:+UnlockCommercialFeatures
        </code>
        。（没有配置此项，
       </span>
       <strong>
        Run xxx with Java Flight Recorder
       </strong>
       <span style="color:inherit;">
        启动会报错）
       </span>
      </p>
     </li>
     <li id="562580be">
      <p style="margin-left:0px;">
       <span style="color:inherit;">
        应用更改并关闭对话框。
       </span>
      </p>
     </li>
     <li>
      <p style="margin-left:0px;">
       单击右上角的
       <strong>
        Run xxx with Java Flight Recorder
       </strong>
       启动项目或者在启动类右键
       <strong>
        Run xxx with Java Flight Recorder
       </strong>
       ,如下图
      </p>
     </li>
    </ol>
    <p style="margin-left:0px;">
     <img alt="" class="has" height="57" src="https://i-blog.csdnimg.cn/blog_migrate/13f8fe826bd66cf64bb89d223477707c.png" width="353"/>
    </p>
    <p style="margin-left:0px;">
     <img alt="" class="has" src="https://i-blog.csdnimg.cn/blog_migrate/b31a694d039286b9b686405c47a93052.png"/>
    </p>
    <p style="margin-left:0px;">
     6. 项目启动完成后打开下方的
     <strong>
      Profiler，
     </strong>
     可以看到已运行时长，一定时间后（推荐5min），点击
     <strong>
      Stop Profiling and Show Results
     </strong>
     ,即可查看火焰图
     <img alt="" class="has" src="https://i-blog.csdnimg.cn/blog_migrate/0c87061edda79717d7bbfdccfc9601d2.png"/>
    </p>
    <h4 style="margin-left:0px;">
     火焰图
    </h4>
    <p>
     <img alt="" class="has" src="https://i-blog.csdnimg.cn/blog_migrate/021ae4dd0b4d604003caca4b1e3339e0.png"/>
    </p>
    <p>
     火焰图是根据调用栈的样本集生成的可视化性能分析图，《
     <a href="http://www.ruanyifeng.com/blog/2017/09/flame-graph.html" rel="nofollow">
      如何读懂火焰图？
     </a>
     》一文对火焰图进行了不错的讲解，大家可以参考一下。简而言之，看火焰图时我们需要关注“平顶”，因为那里就是我们程序的CPU热点。调用树是另一种可视化分析的手段，与火焰图一样，也是根据同一份样本集而生成，按需选择即可。
    </p>
    <p>
     将鼠标悬停在任何块上可以查看详细信息。
    </p>
    <p>
     y 轴表示调用栈，每一层都是一个函数。调用栈越深，火焰就越高，顶部就是正在执行的函数，下方都是它的父函数。
    </p>
    <p>
     x 轴表示抽样数，如果一个函数在 x 轴占据的宽度越宽，就表示它被抽到的次数多，即执行的时间长。注意，x 轴不代表时间，而是所有的调用栈合并后，按字母顺序排列的。
    </p>
    <p>
     <strong>
      火焰图就是看顶层的哪个函数占据的宽度最大。只要有"平顶"（plateaus），就表示该函数可能存在性能问题。
     </strong>
    </p>
    <p>
     <strong>
      <strong>
       <img alt="" class="has" height="40" src="https://i-blog.csdnimg.cn/blog_migrate/97758d86bc470e51bb25eb0e819d809c.gif" width="50"/>
      </strong>
      如果生活欺骗了你，不要着急 — 拿出美颜相机，去欺骗生活。
     </strong>
    </p>
    <p>
     <img alt="" class="has" height="42" src="https://i-blog.csdnimg.cn/blog_migrate/f85ececbc7798d968f6f660b903bddc5.jpeg" width="47">
      <em>
       喜欢就点个赞关注一下呗 ~~
      </em>
     </img>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
     <strong>
      一个从装环境开始的学习记录公众号，欢迎大家关注：
     </strong>
    </p>
    <p>
     <img alt="" height="258" src="https://i-blog.csdnimg.cn/blog_migrate/67c95f01de08b1029258f82afd95e378.jpeg" width="258"/>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f33373535323939332f:61727469636c652f64657461696c732f313032353435373830" class_="artid" style="display:none">
 </p>
</div>


