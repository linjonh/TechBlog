---
arturl_encode: "68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f33383733343437322f:61727469636c652f64657461696c732f313436323031363639"
layout: post
title: "rust-rustå­¦ä¹ "
date: 2025-03-12 12:30:58 +0800
description: "âœ…ã€‚"
keywords: "[rust] rustå­¦ä¹ "
categories: ['Rust']
tags: ['å¼€å‘è¯­è¨€', 'å­¦ä¹ ', 'Rust']
artid: "146201669"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146201669
    alt: "rust-rustå­¦ä¹ "
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146201669
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146201669
cover: https://bing.ee123.net/img/rand?artid=146201669
image: https://bing.ee123.net/img/rand?artid=146201669
img: https://bing.ee123.net/img/rand?artid=146201669
---

# [rust] rustå­¦ä¹ 

## rustå­¦ä¹ 

### 1. é¡¹ç›®ç»„ç»‡ç»“æ„

#### å·¥ç¨‹

```
# åˆ›å»ºä¸€ä¸ªå·¥ç¨‹
cargo new my-project

```

#### å·¥ä½œç©ºé—´

åœ¨
**Rust**
ä¸­ï¼Œ
**å·¥ä½œç©ºé—´ï¼ˆWorkspaceï¼‰**
æ˜¯ä¸€ä¸ª
**åŒ…å«å¤šä¸ª Rust é¡¹ç›®çš„å…±äº«ç¯å¢ƒ**
ï¼Œç”¨äºç®¡ç†å¤šä¸ª crateï¼ˆåº“æˆ–å¯æ‰§è¡Œæ–‡ä»¶ï¼‰ã€‚å®ƒå…è®¸å¤šä¸ª Rust é¡¹ç›®å…±äº«
`Cargo.lock`
ã€ä¾èµ–é¡¹å’Œ
`target/`
ç›®å½•ï¼Œæé«˜ç¼–è¯‘æ•ˆç‡ï¼Œå¹¶ä¸”é€‚ç”¨äº
**å¤šåŒ…ç®¡ç†ã€æ¨¡å—åŒ–å¼€å‘**
ã€‚

---

### **ğŸ”¹ ä¸ºä»€ä¹ˆä½¿ç”¨ Rust å·¥ä½œç©ºé—´ï¼Ÿ**

Rust å·¥ä½œç©ºé—´é€‚ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š

1. **ç®¡ç†å¤šä¸ªç›¸å…³çš„ crate**
   ï¼ˆç±»ä¼¼äº monorepoï¼‰

   * æ¯”å¦‚ï¼Œä½ æœ‰ä¸€ä¸ªä¸»ç¨‹åº
     `app`
     ï¼Œä½†
     `app`
     ä¾èµ–äº
     `lib1`
     å’Œ
     `lib2`
     ï¼Œå¯ä»¥ç”¨å·¥ä½œç©ºé—´ç®¡ç†å®ƒä»¬ã€‚
2. **å…±äº«ä¾èµ–**
   ï¼Œå‡å°‘é‡å¤æ„å»ºï¼Œæé«˜ç¼–è¯‘é€Ÿåº¦ã€‚

   * ä¾‹å¦‚
     `app`
     å’Œ
     `lib1`
     éƒ½ä¾èµ–
     `serde`
     ï¼ŒRust åªä¼šç¼–è¯‘ä¸€æ¬¡ã€‚
3. **ç»Ÿä¸€ç®¡ç†
   `Cargo.lock`**
   ï¼Œä¿è¯æ‰€æœ‰ crate ä¾èµ–ç‰ˆæœ¬ä¸€è‡´ã€‚

---

### **ğŸ”¹ å¦‚ä½•åˆ›å»º Rust å·¥ä½œç©ºé—´ï¼Ÿ**

#### **1ï¸âƒ£ åˆ›å»ºä¸€ä¸ª Rust é¡¹ç›®**

```sh
mkdir my_workspace
cd my_workspace
cargo new --lib lib1
cargo new --lib lib2
cargo new --bin app

```

ä½ ä¼šå¾—åˆ°å¦‚ä¸‹ç›®å½•ç»“æ„ï¼š

```
my_workspace/
â”œâ”€â”€ Cargo.toml  # å·¥ä½œç©ºé—´çš„æ ¹ Cargo.toml
â”œâ”€â”€ lib1/
â”‚   â”œâ”€â”€ Cargo.toml
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â””â”€â”€ lib.rs
â”œâ”€â”€ lib2/
â”‚   â”œâ”€â”€ Cargo.toml
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â””â”€â”€ lib.rs
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ Cargo.toml
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â””â”€â”€ main.rs

```

---

#### **2ï¸âƒ£ é…ç½® `Cargo.toml`**

åœ¨
`my_workspace/Cargo.toml`
ï¼ˆæ ¹ç›®å½•ï¼‰ä¸­æ·»åŠ ï¼š

```toml
[workspace]
members = ["lib1", "lib2", "app"]
resolver = "2" # ä½¿ç”¨ Cargo v2 ä¾èµ–è§£æ

```

è¿™æ ·ï¼ŒRust çŸ¥é“è¿™ 3 ä¸ªé¡¹ç›®å±äºåŒä¸€ä¸ªå·¥ä½œç©ºé—´ã€‚

---

#### **3ï¸âƒ£ åœ¨ `app` ä¾èµ– `lib1` å’Œ `lib2`**

ä¿®æ”¹
`app/Cargo.toml`
ï¼š

```toml
[dependencies]
lib1 = { path = "../lib1" }
lib2 = { path = "../lib2" }

```

åœ¨
`app/src/main.rs`
ï¼š

```rust
use lib1::hello;
use lib2::world;

fn main() {
    hello();
    world();
}

```

åœ¨
`lib1/src/lib.rs`
ï¼š

```rust
pub fn hello() {
    println!("Hello from lib1!");
}

```

åœ¨
`lib2/src/lib.rs`
ï¼š

```rust
pub fn world() {
    println!("World from lib2!");
}

```

---

#### **4ï¸âƒ£ è¿è¡Œå·¥ä½œç©ºé—´**

ä½ å¯ä»¥åœ¨
`my_workspace/`
ç›®å½•ä¸‹ç›´æ¥è¿è¡Œï¼š

```sh
cargo run -p app

```

è¾“å‡ºï¼š

```
Hello from lib1!
World from lib2!

```

ä½ ä¹Ÿå¯ä»¥
**ä¸€æ¬¡æ€§ç¼–è¯‘æ‰€æœ‰ crate**
ï¼š

```sh
cargo build

```

---

### **ğŸ”¹ å·¥ä½œç©ºé—´çš„é¢å¤–åŠŸèƒ½**

#### **âœ” å…±äº« `Cargo.lock`**

æ‰€æœ‰ crate å…±äº«
`Cargo.lock`
ï¼Œä¿è¯ç›¸åŒçš„ä¾èµ–ç‰ˆæœ¬ï¼š

```
my_workspace/
â”œâ”€â”€ Cargo.lock  # ç»Ÿä¸€ç®¡ç†æ‰€æœ‰ crate çš„ä¾èµ–
â”œâ”€â”€ ...

```

#### **âœ” ä½¿ç”¨ `workspace.dependencies`**

å¦‚æœå¤šä¸ª crate éœ€è¦ç›¸åŒçš„ä¾èµ–é¡¹ï¼Œå¯ä»¥åœ¨æ ¹
`Cargo.toml`
ç»Ÿä¸€å£°æ˜ï¼š

```toml
[workspace.dependencies]
serde = "1.0"

```

ç„¶åï¼Œåœ¨
`lib1/Cargo.toml`
å’Œ
`lib2/Cargo.toml`
è¿™æ ·å†™ï¼š

```toml
[dependencies]
serde = { workspace = true }

```

è¿™æ ·å¯ä»¥ç¡®ä¿
`lib1`
å’Œ
`lib2`
ä½¿ç”¨ç›¸åŒç‰ˆæœ¬çš„
`serde`
ï¼Œé¿å…ç‰ˆæœ¬å†²çªã€‚

---

### **ğŸ”¹ æ€»ç»“**

âœ…
**Rust å·¥ä½œç©ºé—´**
é€‚ç”¨äº
**ç®¡ç†å¤šä¸ª crate**
ï¼Œä¼˜ç‚¹åŒ…æ‹¬ï¼š

* **æé«˜ç¼–è¯‘æ•ˆç‡**
  ï¼ˆå…±äº«
  `target/`
  ï¼‰
* **ç»Ÿä¸€ä¾èµ–ç®¡ç†**
  ï¼ˆå…±äº«
  `Cargo.lock`
  å’Œ
  `workspace.dependencies`
  ï¼‰
* **æ¨¡å—åŒ–å¼€å‘**
  ï¼ˆé€‚åˆ Monorepoï¼‰

é€‚ç”¨äºï¼š

* **å¤§å‹é¡¹ç›®ï¼ˆå¾®æœåŠ¡ã€å¤šç»„ä»¶ï¼‰**
* **åº“+CLI å·¥å…·**
* **æ¡†æ¶å¼€å‘ï¼ˆå¦‚ Web æ¡†æ¶ï¼‰**

ä½ æœ‰å…·ä½“çš„ Rust é¡¹ç›®éœ€æ±‚å—ï¼Ÿæˆ‘å¯ä»¥å¸®ä½ ä¼˜åŒ–å·¥ä½œç©ºé—´ç»“æ„ï¼ ğŸš€

### 2. å¸¸ä½¿ç”¨çš„åº“

* serde = { version = â€œ1.0â€, features = [â€œderiveâ€] } # åºåˆ—åŒ–æ”¯æŒ
* serde\_json = â€œ1.0â€ # JSON åºåˆ—åŒ–
* tokio = { version = â€œ1.35â€, features = [â€œfullâ€] }
* axum = â€œ0.7.9â€