---
layout: post
title: "常见问题二打印Failed-to-start-Switch-Root错误,导致系统进入紧急模式的解决方法"
date: 2024-12-03 10:25:04 +0800
description: "本期为服务器操作系统常见问题第二篇，介绍系统启动时进入紧急模式（emergency模式），打印Fai"
keywords: "failed to start switch root"
categories: ['服务器操作系统常见问题']
tags: ['运维', '服务器', 'Linux']
artid: "132706739"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=132706739
    alt: "常见问题二打印Failed-to-start-Switch-Root错误,导致系统进入紧急模式的解决方法"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=132706739
featuredImagePreview: https://bing.ee123.net/img/rand?artid=132706739
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     【常见问题（二）】打印Failed to start Switch Root错误，导致系统进入紧急模式的解决方法
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p id="main-toc">
     <strong>
      目录
     </strong>
    </p>
    <p id="1%20%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0-toc" style="margin-left:0px;">
     <a href="#1%20%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0" rel="nofollow">
      1 问题描述
     </a>
    </p>
    <p id="2%20%E8%BF%87%E7%A8%8B%E5%88%86%E6%9E%90-toc" style="margin-left:0px;">
     <a href="#2%20%E8%BF%87%E7%A8%8B%E5%88%86%E6%9E%90" rel="nofollow">
      2 过程分析
     </a>
    </p>
    <p id="3%20%E9%97%AE%E9%A2%98%E6%A0%B9%E5%9B%A0-toc" style="margin-left:0px;">
     <a href="#3%20%E9%97%AE%E9%A2%98%E6%A0%B9%E5%9B%A0" rel="nofollow">
      3 问题根因
     </a>
    </p>
    <p id="4%20%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88-toc" style="margin-left:0px;">
     <a href="#4%20%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88" rel="nofollow">
      4 解决方案
     </a>
    </p>
    <p id="4.1%20%E6%AD%A5%E9%AA%A4%E4%B8%80-toc" style="margin-left:40px;">
     <a href="#4.1%20%E6%AD%A5%E9%AA%A4%E4%B8%80" rel="nofollow">
      4.1 步骤一
     </a>
    </p>
    <p id="4.2%20%E6%AD%A5%E9%AA%A4%E4%BA%8C-toc" style="margin-left:40px;">
     <a href="#4.2%20%E6%AD%A5%E9%AA%A4%E4%BA%8C" rel="nofollow">
      4.2 步骤二
     </a>
    </p>
    <p id="4.3%20%E6%AD%A5%E9%AA%A4%E4%B8%89-toc" style="margin-left:40px;">
     <a href="#4.3%20%E6%AD%A5%E9%AA%A4%E4%B8%89" rel="nofollow">
      4.3 步骤三
     </a>
    </p>
    <p id="4.4%20%E6%AD%A5%E9%AA%A4%E5%9B%9B-toc" style="margin-left:40px;">
     <a href="#4.4%20%E6%AD%A5%E9%AA%A4%E5%9B%9B" rel="nofollow">
      4.4 步骤四
     </a>
    </p>
    <hr id="hr-toc"/>
    <blockquote>
     <p>
      本期为服务器操作系统常见问题第二篇，介绍系统启动时进入紧急模式（emergency模式），打印Failed to start Switch Root报错的应对策略。
     </p>
    </blockquote>
    <h2>
     1 问题描述
    </h2>
    <p>
     系统启动时进入紧急模式（emergency模式），打印Failed to start Switch Root报错，具体如下：
    </p>
    <p class="img-center">
     <img alt="" height="295" src="https://i-blog.csdnimg.cn/blog_migrate/b153221ad582784695bee9618442e070.png" width="563"/>
    </p>
    <h2 id="2%20%E8%BF%87%E7%A8%8B%E5%88%86%E6%9E%90">
     2 过程分析
    </h2>
    <p>
     （1）根据提示，执行vi /run/initramfs/rdsosreport.txt命令查看rdsosreport.txt日志。
    </p>
    <p>
     从日志中看，系统进入emergency模式的原因是：root文件系统没有挂载或者系统缺少os-release文件，造成initrd-switch-root.service服务启动失败。
    </p>
    <p>
    </p>
    <p class="img-center">
     <img alt="图片" height="165" src="https://i-blog.csdnimg.cn/blog_migrate/9e82862a4d257ffae7f55745f17b1e0e.png" width="592"/>
    </p>
    <p>
     查看kernel启动参数，系统启动参数中没有包含“root=”，造成系统启动过程中不会挂载root文件系统。
    </p>
    <p>
    </p>
    <p class="img-center">
     <img alt="图片" height="193" src="https://i-blog.csdnimg.cn/blog_migrate/045290792b1a28794c4a3506ff467500.png" width="602"/>
    </p>
    <p>
     （2）重启系统，在grub界面按e键编辑当前系统启动选项，linux行中的root启动参数缺失。
    </p>
    <p>
    </p>
    <p class="img-center">
     <img alt="图片" height="113" src="https://i-blog.csdnimg.cn/blog_migrate/4b95f801600bee22219605222e436d5b.png" width="591"/>
    </p>
    <p>
     （3）按Esc回到grub界面，按e键进入修复模式启动选项的编辑模式，root启动参数存在，按Ctrl+x键通过当前修复模式进入系统。
    </p>
    <p>
    </p>
    <p class="img-center">
     <img alt="图片" height="76" src="https://i-blog.csdnimg.cn/blog_migrate/9f78659ce29a7c2c14507eb7bbfda3cd.png" width="602"/>
    </p>
    <p>
     （4）进入系统后，检查/boot/grub2/grubenv文件，发现grubenv被清空。
    </p>
    <p>
    </p>
    <p class="img-center">
     <img alt="图片" height="79" src="https://i-blog.csdnimg.cn/blog_migrate/73c76345a03983afa88e34dc440b31e3.png" width="440"/>
    </p>
    <h2 id="3%20%E9%97%AE%E9%A2%98%E6%A0%B9%E5%9B%A0">
     3 问题根因
    </h2>
    <p>
     /boot/grub2/grubenv文件被清空或者损坏。
    </p>
    <h2 id="4%20%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88">
     4 解决方案
    </h2>
    <h3 id="4.1%20%E6%AD%A5%E9%AA%A4%E4%B8%80">
     4.1 步骤一
    </h3>
    <p>
     通过修复模式进入系统；
    </p>
    <h3 id="4.2%20%E6%AD%A5%E9%AA%A4%E4%BA%8C">
     4.2 步骤二
    </h3>
    <p>
     根据如下方法修复grubenv文件：
    </p>
    <p>
     <strong>
      Legacy模式：
     </strong>
    </p>
    <p>
     （1）创建一个空的grubenv文件。
    </p>
    <pre><code class="hljs">  # grub2-editenv /boot/grub2/grubenv create</code></pre>
    <p>
     （2）重新生成grub.cfg文件，在生成grub.cfg的同时会自动写入grubenv文件。
    </p>
    <pre><code class="hljs"> # grub2-mkconfig -o /boot/grub2/grub.cfg</code></pre>
    <p>
     <strong>
      UEFI模式：
     </strong>
    </p>
    <p>
     （1）创建一个空的grubenv。
    </p>
    <pre><code class="hljs">  # grub2-editenv /boot/efi/EFI/实际系统路径/grubenv create</code></pre>
    <p>
     （2）创建 /boot/grub2/grubenv和 /boot/efi/EFI/实际系统路径/grubenv的软链接。
    </p>
    <pre><code class="hljs"># ln -sf /boot/efi/EFI/实际系统路径/grubenv /boot/grub2/grubenv</code></pre>
    <p>
     （3）重新生成grub.cfg文件，在生成grub.cfg的同时会自动写入grubenv文件。
    </p>
    <pre><code class="hljs">  # grub2-mkconfig -o /boot/efi/EFI/实际系统路径/grub.cfg</code></pre>
    <h3 id="4.3%20%E6%AD%A5%E9%AA%A4%E4%B8%89">
     4.3 步骤三
    </h3>
    <p>
     检查grubenv文件是否生成kernelopts=&lt;paramater&gt;参数。
    </p>
    <p>
    </p>
    <p class="img-center">
     <img alt="图片" height="114" src="https://i-blog.csdnimg.cn/blog_migrate/09432d5aeb39008e5745d73129bb5358.png" width="552"/>
    </p>
    <h3 id="4.4%20%E6%AD%A5%E9%AA%A4%E5%9B%9B">
     4.4 步骤四
    </h3>
    <p>
     执行reboot重启系统。
    </p>
    <p class="img-center">
     <img alt="" height="371" src="https://i-blog.csdnimg.cn/blog_migrate/03ee825f2cfdb8f65226c03e80044ed6.png" width="900"/>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f4b6579617263684f532f:61727469636c652f64657461696c732f313332373036373339" class_="artid" style="display:none">
 </p>
</div>


