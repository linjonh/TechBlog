---
arturl_encode: "68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f35343136393939382f:61727469636c652f64657461696c732f313232393830383930"
layout: post
title: "Cè¯­è¨€å®ç°æ¨ç®±å­-æ•°æ®åº“è¿æ¥é¡¹ç›®æ‰“åŒ…å‘å¸ƒ"
date: 2022-02-22 23:27:49 +0800
description: "å°æ—¶å€™éƒ½ç©è¿‡æ¨ç®±å­è¿™ä¸ªç»å…¸çš„å°æ¸¸æˆï¼Œå®ƒä¼´éšç€æˆ‘ä»¬çš„ç«¥å¹´ï¼Œå¸¦ç»™æˆ‘ä»¬äº†è®¸å¤šçš„ä¹è¶£ã€‚ä»Šå¤©å‘¢å°ç¼–ä¸ºå¤§å®¶åˆ†äº«ä¸€"
keywords: "cè¯­è¨€æ‰“åŒ…æ¸¸æˆ"
categories: ['å®ç°å„ç§å°æ¸¸æˆ', 'Mysql', 'C', 'C']
tags: ['ç®—æ³•', 'C']
artid: "122980890"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=122980890
    alt: "Cè¯­è¨€å®ç°æ¨ç®±å­-æ•°æ®åº“è¿æ¥é¡¹ç›®æ‰“åŒ…å‘å¸ƒ"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=122980890
featuredImagePreview: https://bing.ee123.net/img/rand?artid=122980890
---

# Cè¯­è¨€å®ç°æ¨ç®±å­ ï¼ˆæ•°æ®åº“è¿æ¥+é¡¹ç›®æ‰“åŒ…å‘å¸ƒï¼‰

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/8f2cbe0b286d6d63417b41fc622cfb1d.png)

å°æ—¶å€™éƒ½ç©è¿‡æ¨ç®±å­è¿™ä¸ªç»å…¸çš„å°æ¸¸æˆï¼Œå®ƒä¼´éšç€æˆ‘ä»¬çš„ç«¥å¹´ï¼Œå¸¦ç»™æˆ‘ä»¬äº†è®¸å¤šçš„ä¹è¶£ã€‚ä»Šå¤©å‘¢å°ç¼–ä¸ºå¤§å®¶åˆ†äº«ä¸€ä¸‹ä½¿ç”¨Cè¯­è¨€æ¥å®Œæˆæ¨ç®±å­æ¸¸æˆã€‚ä»¥åŠå¦‚ä½•å°†æ¸¸æˆä¸æ•°æ®åº“è¿æ¥å’Œé¡¹ç›®çš„æ‰“åŒ…å‘å¸ƒã€‚

ä¸‹é¢æ˜¯å®Œæˆä¹‹åçš„æ•ˆæœå±•ç¤ºï¼š

**â‘ é¡¹ç›®æ‰“åŒ…åæˆ‘ä»¬ä¼šè·å¾—ä¸€ä¸ªå®‰è£…ç¨‹åºï¼Œç‚¹å‡»å®‰è£…ç¨‹åºå°±èƒ½å°†æ¨ç®±å­æ¸¸æˆå®‰è£…åœ¨ç”µè„‘ä¸Šã€‚**
è¿™æ—¶å€™ä¹Ÿå¯ä»¥å°†å®‰è£…ç¨‹åºå‘ç»™æœ‹å‹å®‰è£…è¯•ç©ï¼ˆå› ä¸ºæ—¶é—´åŸå› æ²¡æœ‰åšç™»å½•é¡µé¢ï¼‰

![9b5091ce3a484531ac98f9fe033caa8e.gif](https://i-blog.csdnimg.cn/blog_migrate/90788d007aacfcaaee6b1391925a7e84.gif)

**â‘¡æ¸¸æˆå†…æ•ˆæœï¼Œä¸€å…±è®¾è®¡äº†å››ç§åœ°å›¾ï¼Œæ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥ç»§ç»­åœ¨è‡ªå·±çš„æ•°æ®åº“ä¸­æ·»åŠ åœ°å›¾ã€‚**

![aada0b539c204d22a1c1653d50d2a80b.gif](https://i-blog.csdnimg.cn/blog_migrate/e845cb5f1b31cf04898d6e78a5dce82c.gif)
â€‹ä¸‹é¢æˆ‘æŒ‰ç…§ æ¨ç®±å­æ¸¸æˆå®ç° â†’ æ•°æ®åº“è¿æ¥ â†’ ç¨‹åºæ‰“åŒ… çš„è·¯çº¿åˆ†äº«æœ¬æ¬¡é¡¹ç›®

## ä¸€ã€æ¨ç®±å­æ¸¸æˆæºç ï¼ˆå¯ç›´æ¥æ‹·è´è¿è¡Œï¼‰

æ¸¸æˆå›¾ç‰‡ä¸‹è½½ï¼ˆå°†å›¾ç‰‡ä¸ä»£ç æ”¾åœ¨åŒä¸€æ–‡ä»¶å¤¹ä¸‹ï¼‰ã€‚
[å›¾ç‰‡ä¸‹è½½

![](https://i-blog.csdnimg.cn/blog_migrate/108103d72789eafe62012253d677a985.png)
https://download.csdn.net/download/qq\_54169998/81551789](https://download.csdn.net/download/qq_54169998/81551789 "å›¾ç‰‡ä¸‹è½½")
**è¿™é‡Œä¸ºåˆ†äº«çš„æºç æ˜¯ä»¥æ–‡æ¡£åšæ•°æ®ç»“æ„ã€‚ä¸‹é¢æˆ‘ä¼šä»‹ç»ä¸MySQLç›¸è¿**

```cpp
#include<graphics.h>
#include<iostream>
#include<stdlib.h>
#include<string>
#include<conio.h>	
#include<fstream>
#include<sstream>
using namespace std;

#define LINE 48
#define COLUMN 48

#define RATIO 40
#define SCREEN_WIDTH 740
#define SCREEN_HEIGHT 500

#define START_X 50
#define START_Y 75

#define KEY_UP 'W'
#define KEY_LEFT 'A'
#define KEY_RIGHT 'D'
#define KEY_DOWN 'S'
#define KEY_OUT 'Q'
#define GAME_AGAIN 'R'

#define MAX_RETRY_TIMES 4
#define BG_IMAGE -1
#define isValid(next_pos) next_pos.x > 0 && next_pos.x < LINE && next_pos.y>0 && next_pos.y < COLUMN

#define USERS "users.txt"
#define LEVELS "levels.txt"
#define ROUND 4

typedef enum  _PROPS {
	WALL,	//å¢™
	FLOOR,	//åœ°æ¿
	BOX_DES,//ç®±å­ç›®çš„åœ°
	MAN,	//å°äºº
	BOX,	//ç®±å­
	HIT,	//ç®±å­å‘½ä¸­ç›®æ ‡
	MAN_DES,	//äººç«™åœ¨ç›®æ ‡ä¸Š
	VECTOR	//é€šå…³å›¾ç‰‡
}PROPS;

typedef enum  _DIRECTION {
	UP,
	DOWN,
	LEFT,
	RIGHT
}DIRECTION;

typedef struct _POS {
	int x;	//å°äººæ‰€åœ¨äºŒç»´æ•°ç»„çš„è¡Œæ•°
	int y;	//å°äººæ‰€åœ¨äºŒç»´æ•°ç»„çš„åˆ—æ•°
}POS;

typedef struct _userinfo {
	//è¿™é‡Œå°†å­—ç¬¦ä¸²åˆå§‹ä¸ºç©º
	_userinfo() :id(0), username(""), password(""), level_id(0) {};
	_userinfo(int _id, string _username, string _password, int _level_id) :id(_id), username(_username), password(_password), level_id(_level_id) {};
	int id;	// ç”¨æˆ·id
	string username;
	string password;	// å¯†ç 
	int level_id;
}userinfo;

typedef struct _levelinfo {
	_levelinfo() :id(0), name(""), map_row(0), map_column(0), map_data(""), next_level(0) {};
	_levelinfo(int _id, string _name, int _map_row, int _map_column, string _map_data, int _next_level) :id(_id), name(_name), map_row(_map_row), map_column(_map_column), map_data(_map_data), next_level(_next_level) {};
	int id;	// å…³å¡id
	string name;	// å…³å¡åå­—
	int map_row;	// åœ°å›¾è¡Œæ•°
	int map_column;	//åœ°å›¾åˆ—æ•°
	string map_data;	// äºŒç»´åœ°å›¾æ•°æ®
	int next_level;	//ä¸‹ä¸€å…³å¡id
}levelinfo;

levelinfo game_data[4];
struct _POS man;
IMAGE images[9];
int map[LINE][COLUMN] = { 0 };

/******************************
 * åŠŸèƒ½ï¼šæ•°æ®é‡ç½®ï¼Œå½“æ•°æ®æ–‡æ¡£é”™ä¹±æ—¶å¯è°ƒç”¨æ­¤å‡½æ•°ä¸€æ¬¡å°†æ•°æ®é‡è£…
 * è¾“å…¥ï¼š
 *		æ— 
 *
 * è¿”å›å€¼ï¼š
 *		æ— 
 *****************************/
void resetting_data() {
	levelinfo levels[ROUND] = { {1,"å°è¯•ç‰›åˆ€â†’ç¬¬ä¸€å…³",8,10,"-1,0,0,0,0,0,0,0,-1,-1|-1,0,2,2,2,2,1,0,-1,-1|0,0,0,2,2,2,4,0,0,0|0,1,1,4,0,4,1,4,1,0|0,1,4,4,1,1,0,4,1,0|0,1,1,1,3,0,1,1,1,0|0,0,0,0,1,1,1,0,0,0,|-1,-1,-1,0,0,0,0,0,-1,-1",2},
							{2,"ç»åœ°å¼ºè€…â†’ç¬¬äºŒå…³",6,6,"0,0,0,0,0,0|0,2,2,1,1,0|0,4,4,1,3,0|0,2,1,4,0,0|0,1,1,1,0,-1|0,0,0,0,0,-1",3},
							{3,"å¤©å¤–å¼ºäººâ†’ç¬¬ä¸‰å…³",8,10,"-1,-1,0,0,0,0,0,0,-1,-1|0,0,0,1,1,1,0,0,0,0|0,1,1,1,4,1,4,1,1,0|0,1,4,1,1,1,4,1,3,0|0,0,0,4,4,0,0,0,0,0,|-1,-1,0,1,1,2,2,0,-1,-1|-1,-1,0,2,2,2,2,0,-1,-1|-1,-1,0,0,0,0,0,0,-1,-1",4},
							{4,"æ­»è€Œå¤ç”Ÿâ†’BOSSå…³",8,8,"-1,0,0,0,0,0,0,-1|-1,0,2,1,2,2,0,-1|-1,0,2,1,4,2,0,-1|0,0,0,1,1,4,0,0|0,1,4,1,1,4,1,0|0,1,0,4,0,0,1,0|0,1,1,1,3,1,1,0|0,0,0,0,0,0,0,0",0}
	};
	ofstream ofs;
	ofs.open(LEVELS, ios::out);
	for (int i = 0; i < ROUND; ++i) {
		stringstream str_stream;
		str_stream << levels[i].id << " " << levels[i].name << " " << levels[i].map_row << " " << levels[i].map_column << " " << levels[i].map_data << " " << levels[i].next_level << endl;
		ofs << str_stream.str();
	}
	ofs.close();
	ofs.open(USERS, ios::out);
	userinfo user = { 1,"Jack","123456" ,1 };
	stringstream str;
	str << user.id << " " << user.username << " " << user.password << " " << user.level_id;
	ofs << str.str();
	ofs.close();
}

/******************************
 * åŠŸèƒ½ï¼šåœ°å›¾æ•°æ®åŠ è½½
 * è¾“å…¥ï¼š
 *		æ— 
 *
 * è¿”å›å€¼ï¼š
 *		æ— 
 *****************************/
void load_data() {
	ifstream ifs;
	ifs.open(LEVELS);
	int index = 0;
	while (index < ROUND) {
		string line;
		getline(ifs, line);
		//cout << line << endl;
		int _id;
		char _name[64];
		int _map_row;
		int _map_column;
		char _map_data[2304];
		int _next_level_id;
		levelinfo info;
		sscanf_s(line.c_str(), "%d %s %d %d %s %d", &_id, _name, (unsigned int)sizeof(_name), &_map_row, &_map_column, _map_data, (unsigned int)sizeof(_map_data), &_next_level_id);
		game_data[index] = { _id,_name,_map_row,_map_column,_map_data,_next_level_id };
		index++;
	}
}


/******************************
 *åŠŸèƒ½ï¼šé€šè¿‡ç”¨æˆ·åå’Œå¯†ç è·å–ç”¨æˆ·ä¿¡æ¯
 * è¾“å…¥ï¼š
 *		user - ç”¨æˆ·ä¿¡æ¯ç»“æ„ä½“
 *
 * è¿”å›å€¼ï¼š
 *		è·å–æˆåŠŸè¿”å›trueï¼Œå¤±è´¥false
 *****************************/
bool fetch_user_info(userinfo& user) {
	ifstream ifs;
	ifs.open(USERS);
	if (!ifs) {
		return false;
	}
	string line;
	while (1) {
		getline(ifs, line);
		int _id;
		char _username[64];
		char _password[64];
		int _level_id;
		sscanf_s(line.c_str(), "%d%s%s%d", &_id, _username, (unsigned int)sizeof(_username), _password, (unsigned int)sizeof(_password), &_level_id);
		if (_username == user.username && _password == user.password) {
			user.id = _id;
			user.level_id = _level_id;
			return true;
		}
		if (ifs.eof()) {
			break;
		}
	}
	return false;
}

/*********************************
 *åŠŸèƒ½ï¼šæ ¹æ®å…³å¡idè·å–å®Œæ•´çš„å…³å¡ä¿¡æ¯ï¼ˆå¦‚ï¼šåœ°å›¾ï¼Œä¸‹ä¸€å…³ç­‰ï¼‰
 * è¾“å…¥ï¼š
 *		level - ä¿å­˜å…³å¡ä¿¡æ¯çš„ç»“æ„ä½“
 *		level_id - è·å–å…³å¡id
 * è¿”å›å€¼ï¼š
 *		0  - æŸ¥æ‰¾ç»“æœä¸ºç©ºï¼ˆç”¨æˆ·å·²é€šå…³ï¼‰
 *		1 - æŸ¥æ‰¾æˆåŠŸ
 *********************************/
bool fetch_level_info(levelinfo& level, int level_id) {
	if (level_id == 0) {
		return false;
	}
	else {
		level = game_data[level_id - 1];
		return true;
	}
}

/******************************
 *åŠŸèƒ½ï¼šå°†è·å¾—çš„å…³å¡æ•°æ®è½¬æ¢åˆ°mapåœ°å›¾æ•°ç»„ä¸­
 * è¾“å…¥ï¼š
 *		level - å…³å¡æ•°æ®
 *		map - äºŒç»´åœ°å›¾æ•°ç»„
 *
 * è¿”å›å€¼ï¼š
 *		false - è½¬æ¢å¤±è´¥
 *		true - è½¬æ¢æˆåŠŸ
 *****************************/
bool transform_map_db2array(levelinfo& level, int map[][COLUMN]) {
	if (level.map_row > LINE || level.map_column > COLUMN) {
		printf("åœ°å›¾è¿‡å¤§ï¼Œè¯·é‡æ–°è®¾ç½®\n");
		return false;
	}
	if (level.map_data.length() < 1) {
		printf("åœ°å›¾æ•°æ®æœ‰è¯¯ï¼Œè¯·é‡æ–°è®¾ç½®ï¼\n");
		return false;
	}
	long long start = 0, end = 0;
	int row = 0, column = 0;
	do {
		/******************************
		 *findè¿”å›size_tç±»å‹å€¼ï¼Œsize_tåœ¨64ä½ä¸‹æ˜¯8å­—èŠ‚é•¿åº¦ï¼Œå› æ­¤è¿™é‡ŒæŠŠstartå’Œendè®¾ç½®æˆlong longç±»å‹ï¼ˆä¸è®¾ç½®ä¼šæœ‰â€œæ•°æ®ä¸¢å¤±â€è­¦å‘Šï¼‰ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ç®€å•ç²—æš´çš„ä¿®æ”¹è­¦å‘Šè®¾ç½®
		******************************/
		end = level.map_data.find('|', start);
		if (end == -1) {
			end = level.map_data.length();
		}
		//åˆæ³•æ€§æ£€æŸ¥ï¼Œç»“æŸæ—¶end=level.map_data.lengthï¼Œstart=end+1
		if (start >= end)
			break;
		string line = level.map_data.substr(start, end - start);
		// å¯¹è¡Œæ•°æ®è¿›è¡Œè§£æï¼š0,1,0,1,1,1,1,1,1,1,0,0
		char* next_token = NULL;
		//lineè½¬ä¸ºconst char*ï¼ˆCè¯­è¨€ä¸­çš„å­—ç¬¦ä¸²ï¼‰ï¼Œstrtok_sä¼šä¿®æ”¹lineé‡Œçš„å€¼ï¼ŒæŒ‰ç…§æŸä¸ªç‰¹å®šå­—ç¬¦ï¼Œæ‰€ä»¥éœ€è¦å°†line.c_str()è½¬ä¸ºchar *
		// strtok_sç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦åŠˆå¼€çš„å­—ç¬¦ä¸²ï¼ˆè¦æ±‚æ˜¯ä¸€ä¸ªchar *ç±»å‹çš„ï¼‰ï¼›ç¬¬äºŒä¸ªå‚æ•°æ˜¯æŒ‰æŸä¸ªå­—ç¬¦åŠˆå¼€ï¼ˆä¼šæŠŠâ€œï¼Œâ€é€—å·å˜æˆâ€˜\0â€™ç»“æŸç¬¦ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼šä¿®æ”¹åŸæ¥å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥è¦æŠŠåŸæ¥çš„const char*è½¬ä¸ºchar*ï¼‰ï¼›ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯è¿™ä¸ªæ¥å£
		// éœ€è¦çš„ï¼Œç”¨æ¥åšå®šä½åŠŸèƒ½ï¼Œ
		char* item = strtok_s((char*)line.c_str(), ",", &next_token);
		column = 0;
		//printf("%p", next_token);
		//::system("pause");
		//å¦‚æœæŸè¡Œæ•°æ®ä¸ªæ•°å¤šä½™è¿™ä¸ªåœ°å›¾åˆ—æ•°ï¼Œæ§åˆ¶åªè¯»å–level.map_column-1ä¸ª
		while (item && column < level.map_column) {
			map[row][column] = atoi(item);
			column++;
			//å†ä½¿ç”¨strtok_sæ¥å£ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥å†™NULLï¼Œåº”è¯¥æ˜¯next_tokenå‚æ•°ä¸Šä¸€æ¬¡åšå®šä½åŠŸèƒ½æ—¶å·²ç»è®°å½•äº†è¦åŠˆå¼€å­—ç¬¦ä¸²ç»™çš„æŸä¸ªä½ç½®
			item = strtok_s(NULL, ",", &next_token);
		}
		//åˆæ³•æ€§æ£€æŸ¥
		if (column < level.map_column) {	// æŸè¡Œçš„æ•°æ®ä¸ªæ•°å°äºè¿™ä¸ªåœ°å›¾çš„åˆ—æ•°
			printf("åœ°å›¾æ•°æ®è§£æå‡ºé”™ï¼Œç»ˆæ­¢ï¼\n");
			return false;
		}
		row++;

		//åˆ—æ•°å¤šä½™çš„è¯ç›´æ¥èˆå¼ƒ
		if (row >= level.map_row) {
			break;
		}
		start = end + 1;
	} while (1 == 1);
	//åˆ—æ•°å¤šä½™åˆ™ç›´æ¥æŠ¥é”™
	if (row < level.map_row) {
		printf("åœ°å›¾è¡Œæ•°å°‘äºè®¾å®šï¼Œç»ˆæ­¢ï¼");
		return false;
	}
	return true;
}

/******************************
 *åŠŸèƒ½ï¼šæ›´æ–°ç”¨æˆ·æ¸¸æˆè¿›åº¦ä¿¡æ¯
 * è¾“å…¥ï¼š
 *		user - ç”¨æˆ·ä¿¡æ¯
 *		next_level_id - æ¸¸æˆè¿›åº¦
 *
 * è¿”å›å€¼ï¼š
 *		è·å–æˆåŠŸè¿”å›trueï¼Œå¤±è´¥false
 *****************************/
bool update_user_level(userinfo& user, int next_level_id) {
	ifstream ifs;
	ifs.open(USERS);
	if (!ifs) {
		return false;
	}
	int user_index = 1;
	string strFileData = "";
	while (1) {
		if (user_index == user.id) {
			{string temp;
			getline(ifs, temp); }
			user_index++;
			continue;
		}
		if (ifs.eof()) {
			break;
		}
		string line;
		getline(ifs, line);
		strFileData += line;
		strFileData += '\n';

	}
	ifs.close();
	stringstream str_stream;
	str_stream << user.id << " " << user.username << " " << user.password << " " << next_level_id << endl;
	strFileData += str_stream.str();
	ofstream ofs;
	ofs.open(USERS);
	ofs.flush();
	ofs << strFileData;
	ofs.close();
	user.level_id = next_level_id;
	return true;
}

/*****************************
* åŠŸèƒ½ï¼šåˆ¤æ–­æ¸¸æˆæ˜¯å¦ç»“æŸ
* è¾“å…¥ï¼š
*		æ— 
* è¾“å‡ºï¼š
*		true - æœªç»“æŸ
*		flase - ç»“æŸ
*****************************/
bool isGameOver() {
	for (int i = 0; i < LINE; ++i) {
		for (int j = 0; j < COLUMN; ++j) {
			if (map[i][j] == BOX_DES)
				return false;
		}
	}
	return true;
}

/*****************************
* åŠŸèƒ½ï¼šåŠ è½½æ¸¸æˆç»“æŸå›¾ç‰‡
* è¾“å…¥ï¼š
*		æ— 
* è¾“å‡ºï¼š
*		æ— 
*****************************/
void show_over() {
	cleardevice();
	IMAGE game_over;
	loadimage(&game_over, _T("gameover.png"), SCREEN_WIDTH, SCREEN_HEIGHT, true);
	putimage(0, 0, &game_over);
}

/*****************************
* åŠŸèƒ½ï¼šåœ¨æŒ‡å®šä½ç½®æ›´æ”¹åœ°å›¾ä¿¡æ¯ æ˜¾ç¤ºæŒ‡å®šå›¾ç‰‡
* è¾“å…¥ï¼š
*		next_pos - æŒ‡å®šä½ç½®
*		prop - æŒ‡å®šå›¾ç‰‡
* è¾“å‡ºï¼š
*		æ— 
*****************************/
void changeMap(POS* next_pos, PROPS prop) {
	map[next_pos->x][next_pos->y] = prop;
	putimage(START_X + next_pos->y * RATIO, START_Y + next_pos->x * RATIO, &images[prop]);
}

/*****************************
* åŠŸèƒ½ï¼šåœ¨æŒ‡å®šä½ç½®æ˜¾ç¤ºæŒ‡å®šå›¾ç‰‡
* è¾“å…¥ï¼š
*		next_pos - æŒ‡å®šä½ç½®
*		prop - æŒ‡å®šå›¾ç‰‡
* è¾“å‡ºï¼š
*		æ— 
*****************************/
void changeMap2(POS* next_pos, PROPS prop) {
	putimage(START_X + next_pos->y * RATIO, START_Y + next_pos->x * RATIO, &images[prop]);
}

/*****************************
* åŠŸèƒ½ï¼šæ§åˆ¶å°äººå‘æŒ‡å®šæ–¹å‘ç§»åŠ¨
* è¾“å…¥ï¼š
*		direct - æŒ‡å®šæ–¹å‘
* è¾“å‡ºï¼š
*		æ— 
*****************************/
void gameControl(DIRECTION direct) {
	POS next_pos = man;
	POS next_next_pos = man;
	switch (direct) {
	case UP:
		next_pos.x--;
		next_next_pos.x -= 2;
		break;
	case DOWN:
		next_pos.x++;
		next_next_pos.x += 2;
		break;
	case LEFT:
		next_pos.y--;
		next_next_pos.y -= 2;
		break;
	case RIGHT:
		next_pos.y++;
		next_next_pos.y += 2;
		break;
	}
	//å®å±•å¼€next_pos.x > 0 && next_pos.x < LINE && next_pos.y>0 && next_pos.y < COLUMN
	// äººçš„å‰æ–¹æ˜¯åœ°æ¿
	if (isValid(next_pos) && map[next_pos.x][next_pos.y] == FLOOR) {
		//äººçš„è„šä¸‹æ˜¯ç›®çš„åœ°
		if (map[man.x][man.y] == BOX_DES) {
			changeMap(&next_pos, MAN);
			changeMap2(&man, BOX_DES);
		}
		else {
			changeMap(&man, FLOOR);
			changeMap(&next_pos, MAN);
		}
		man = next_pos;
	}
	// äººçš„å‰æ–¹æ˜¯ç®±å­
	else if (isValid(next_next_pos) && map[next_pos.x][next_pos.y] == BOX) {
		if (map[next_next_pos.x][next_next_pos.y] == FLOOR) {	// ç®±å­çš„å‰æ–¹æ˜¯åœ°æ¿
			changeMap(&next_next_pos, BOX);
			changeMap(&next_pos, MAN);
			if (map[man.x][man.y] == BOX_DES) {
				changeMap(&man, BOX_DES);
			}
			else {
				changeMap(&man, FLOOR);
			}
			man = next_pos;
		}
		else if (map[next_next_pos.x][next_next_pos.y] == BOX_DES) {	// ç®±å­å‰é¢æ˜¯ç›®çš„åœ°
			changeMap(&next_next_pos, HIT);
			changeMap(&next_pos, MAN);
			if (map[man.x][man.y] == BOX_DES) {
				changeMap(&man, BOX_DES);
			}
			else {
				changeMap(&man, FLOOR);
			}
			man = next_pos;
		}
	}
	//å‰æ–¹æ˜¯ç›®çš„åœ°
	else if (isValid(next_pos) && map[next_pos.x][next_pos.y] == BOX_DES) {
		//å°äººè„šä¸‹ä¹Ÿæ˜¯ç›®çš„åœ°
		if (map[man.x][man.y] == BOX_DES) {
			changeMap2(&next_pos, MAN_DES);
			changeMap(&man, BOX_DES);
		}
		else {
			changeMap(&man, FLOOR);
			changeMap2(&next_pos, MAN_DES);

		}
		man = next_pos;
	}
	//å‰æ–¹æ˜¯ç®±å­å‘½ä¸­ç‚¹
	else if (isValid(next_pos) && map[next_pos.x][next_pos.y] == HIT) {
		if (map[next_next_pos.x][next_next_pos.y] == FLOOR) {	// ç®±å­çš„å‰æ–¹æ˜¯åœ°æ¿
			changeMap(&next_next_pos, BOX);
			changeMap(&next_pos, BOX_DES);
			changeMap2(&next_pos, MAN_DES);
			//äººçš„è„šä¸‹æ˜¯ç›®çš„åœ°
			if (map[man.x][man.y] == BOX_DES) {
				changeMap(&man, BOX_DES);
			}
			else {
				changeMap(&man, FLOOR);
			}
			man = next_pos;
		}
		else if (map[next_next_pos.x][next_next_pos.y] == BOX_DES) {	// ç®±å­å‰é¢æ˜¯ç›®çš„åœ°
			changeMap(&next_next_pos, HIT);
			changeMap(&next_pos, BOX_DES);
			changeMap2(&next_pos, MAN_DES);
			//äººçš„è„šä¸‹æ˜¯ç›®çš„åœ°
			if (map[man.x][man.y] == BOX_DES) {
				changeMap(&man, BOX_DES);
			}
			else {
				changeMap(&man, FLOOR);
			}
			man = next_pos;
		}
	}
}

/*****************************
* åŠŸèƒ½ï¼šç”¨æˆ·ç™»å½•
* è¾“å…¥ï¼š
*		user - ç”¨æˆ·ä¿¡æ¯
* è¾“å‡ºï¼š
*		false - ç™»å½•å¤±è´¥
*		true - ç™»å½•æˆåŠŸ
*****************************/
bool login(userinfo& user) {
	int times = 0;
	bool ret = false;
	do {
		cout << "è¯·è¾“å…¥ç”¨æˆ·åï¼š";
		cin >> user.username;
		cout << "è¯·è¾“å…¥å¯†ç ï¼š";
		cin >> user.password;
		ret = fetch_user_info(user);
		times++;
		if (times >= MAX_RETRY_TIMES)
			break;
		if (ret == false) {
			cout << "ç™»å½•å¤±è´¥ï¼Œè¯·é‡æ–°è¾“å…¥ï¼" << endl;
		}
	} while (!ret);
	return ret;
}

/*****************************
* åŠŸèƒ½ï¼šåŠ è½½æ¸¸æˆç´ æ
* è¾“å…¥ï¼š
*		æ— 
* è¾“å‡ºï¼š
*		æ— 
*****************************/
void init_graph() {
	initgraph(SCREEN_WIDTH, SCREEN_HEIGHT);
	loadimage(&images[WALL], _T("wall_right.bmp"), RATIO, RATIO, true);
	loadimage(&images[FLOOR], _T("floor.bmp"), RATIO, RATIO, true);
	loadimage(&images[BOX_DES], _T("des.bmp"), RATIO, RATIO, true);
	loadimage(&images[MAN], _T("man.bmp"), RATIO, RATIO, true);
	loadimage(&images[BOX], _T("box.jpg"), RATIO, RATIO, true);
	loadimage(&images[HIT], _T("box_des.jpg"), RATIO, RATIO, true);
	loadimage(&images[MAN_DES], _T("man_des.bmp"), RATIO, RATIO, true);
	loadimage(&images[VECTOR], _T("vector.png"), 6 * RATIO, 6 * RATIO, true);
}

/*****************************
* åŠŸèƒ½ï¼šæ˜¾ç¤ºæŒ‡å®šåœ°å›¾
* è¾“å…¥ï¼š
*		level - æŒ‡å®šåœ°å›¾
* è¾“å‡ºï¼š
*		æ— 
*****************************/
void show_images(levelinfo& level) {
	cleardevice();	// æ¯æ¬¡è´´å›¾æ¸…å±ä¸€ä¸‹
	IMAGE bg_img;
	//å›¾ç‰‡çš„å®½ï¼Œé«˜æœ€åä¸€ä¸ªå‚æ•°â€œæ˜¯å¦æ‹‰ä¼¸â€
	loadimage(&bg_img, _T("bgimage.png"), SCREEN_WIDTH, SCREEN_HEIGHT, true);
	putimage(0, 0, &bg_img);
	for (int i = 0; i < level.map_row; ++i) {
		for (int j = 0; j < level.map_column; ++j) {
			if (map[i][j] == MAN) {
				man.x = i;
				man.y = j;
			}
			if (map[i][j] == BG_IMAGE)
				continue;
			putimage(START_X + j * RATIO, START_Y + i * RATIO, &images[map[i][j]]);
		}
	}
	const char* str = level.name.c_str();
	setbkmode(TRANSPARENT);
	setfont(RATIO, 0, _T("åæ–‡æ¥·ä½“"));
	setcolor(WHITE);
	outtextxy(200, 25, str);
}

/*****************************
* åŠŸèƒ½ï¼šè½½å…¥PNGå›¾å¹¶å»é€æ˜éƒ¨åˆ†
* è¾“å…¥ï¼š
*		æ— 
* è¾“å‡ºï¼š
*		æ— 
*****************************/
void drawAlpha(IMAGE* picture, int  picture_x, int picture_y) //xä¸ºè½½å…¥å›¾ç‰‡çš„Xåæ ‡ï¼Œyä¸ºYåæ ‡
{
	// å˜é‡åˆå§‹åŒ–
	DWORD* dst = GetImageBuffer();    // GetImageBuffer()å‡½æ•°ï¼Œç”¨äºè·å–ç»˜å›¾è®¾å¤‡çš„æ˜¾å­˜æŒ‡é’ˆï¼ŒEASYXè‡ªå¸¦
	DWORD* draw = GetImageBuffer();
	DWORD* src = GetImageBuffer(picture); //è·å–pictureçš„æ˜¾å­˜æŒ‡é’ˆ
	int picture_width = picture->getwidth(); //è·å–pictureçš„å®½åº¦ï¼ŒEASYXè‡ªå¸¦
	int picture_height = picture->getheight(); //è·å–pictureçš„é«˜åº¦ï¼ŒEASYXè‡ªå¸¦
	int graphWidth = getwidth();       //è·å–ç»˜å›¾åŒºçš„å®½åº¦ï¼ŒEASYXè‡ªå¸¦
	int graphHeight = getheight();     //è·å–ç»˜å›¾åŒºçš„é«˜åº¦ï¼ŒEASYXè‡ªå¸¦
	int dstX = 0;    //åœ¨æ˜¾å­˜é‡Œåƒç´ çš„è§’æ ‡

	// å®ç°é€æ˜è´´å›¾ å…¬å¼ï¼š Cp=Î±p*FP+(1-Î±p)*BP ï¼Œ è´å¶æ–¯å®šç†æ¥è¿›è¡Œç‚¹é¢œè‰²çš„æ¦‚ç‡è®¡ç®—
	for (int iy = 0; iy < picture_height; iy++)
	{
		for (int ix = 0; ix < picture_width; ix++)
		{
			int srcX = ix + iy * picture_width; //åœ¨æ˜¾å­˜é‡Œåƒç´ çš„è§’æ ‡
			int sa = ((src[srcX] & 0xff000000) >> 24); //0xAArrggbb;AAæ˜¯é€æ˜åº¦
			int sr = ((src[srcX] & 0xff0000) >> 16); //è·å–RGBé‡Œçš„R
			int sg = ((src[srcX] & 0xff00) >> 8);   //G
			int sb = src[srcX] & 0xff;              //B
			if (ix >= 0 && ix <= graphWidth && iy >= 0 && iy <= graphHeight && dstX <= graphWidth * graphHeight)
			{
				dstX = (ix + picture_x) + (iy + picture_y) * graphWidth; //åœ¨æ˜¾å­˜é‡Œåƒç´ çš„è§’æ ‡
				int dr = ((dst[dstX] & 0xff0000) >> 16);
				int dg = ((dst[dstX] & 0xff00) >> 8);
				int db = dst[dstX] & 0xff;
				draw[dstX] = ((sr * sa / 255 + dr * (255 - sa) / 255) << 16)  //å…¬å¼ï¼š Cp=Î±p*FP+(1-Î±p)*BP  ï¼› Î±p=sa/255 , FP=sr , BP=dr
					| ((sg * sa / 255 + dg * (255 - sa) / 255) << 8)         //Î±p=sa/255 , FP=sg , BP=dg
					| (sb * sa / 255 + db * (255 - sa) / 255);              //Î±p=sa/255 , FP=sb , BP=db
			}
		}
	}
}

/*****************************
* åŠŸèƒ½ï¼šè½½å…¥â€œæ­å–œé€šå…³â€å›¾ç‰‡
* è¾“å…¥ï¼š
*		æ— 
* è¾“å‡ºï¼š
*		æ— 
*****************************/
void promot_over() {
	setbkmode(TRANSPARENT);
	drawAlpha(&images[VECTOR], 250, 130);     // è½½å…¥PNGå›¾å¹¶å»é€æ˜éƒ¨åˆ†
	Sleep(1100);
}

/*****************************
* åŠŸèƒ½ï¼šä¼‘çœ 
* è¾“å…¥ï¼š
*		interval - ä¼‘çœ æ—¶é—´
* è¾“å‡ºï¼š
*		æ— 
*****************************/
void wait(int interval) {
	int count = interval / 10;
	for (int i = 0; i < count; ++i) {
		Sleep(10);
		if (_kbhit())
			return;
	}
}

/*****************************
* åŠŸèƒ½ï¼šæ¸¸æˆæ§åˆ¶
* è¾“å…¥ï¼š
*		level - æŒ¡å¢™å…³å¡æ•°æ®
*		user - ç”¨æˆ·ä¿¡æ¯
* è¾“å‡ºï¼š
*		æ— 
*****************************/
void game_operation(levelinfo& level, userinfo& user) {
	bool quit = false;
	do {
		//åˆ¤æ–­æ˜¯å¦æœ‰æŒ‰é”®æŒ‰ä¸‹
		if (_kbhit()) {
			//æ— ç¼“å†²è¯»å–
			char ch = _getch();
			if (ch == KEY_UP) {
				gameControl(UP);
			}
			else if (ch == KEY_DOWN) {
				gameControl(DOWN);
			}
			else if (ch == KEY_LEFT) {
				gameControl(LEFT);
			}
			else if (ch == KEY_RIGHT) {
				gameControl(RIGHT);
			}
			else if (ch == GAME_AGAIN) {
				fetch_level_info(level, user.level_id);
				transform_map_db2array(level, map);
				show_images(level);
			}
			else if (ch == KEY_OUT) {
				closegraph();
				exit(0);
			}
			if (isGameOver()) {
				//æ›´æ–°ç”¨æˆ·ä¸‹ä¸€å…³å…³å¡ä¿¡æ¯ï¼ˆç”¨æˆ·é€šå…³åç›´æ¥è·³è½¬ä¸‹ä¸€å…³ï¼‰
				update_user_level(user, level.next_level);
				quit = true;
			}
		}
		wait(100);
	} while (quit == false);
}

/*****************************
* åŠŸèƒ½ï¼šæ ¹æ®â€œç”±ç”¨æˆ·IDè·å–å…³å¡æ•°æ®â€çš„è¿”å›ç»“æœè¿›è¡Œåˆ¤æ–­
* è¾“å…¥ï¼š
*		result - è¿”å›ç»“æœï¼ˆ-1ï¼šè·å–å¤±è´¥  0ï¼šç”¨æˆ·å·²é€šå…³  1ï¼šè·å–æˆåŠŸï¼‰
*		level - å…³å¡æ•°æ®
*		user - ç”¨æˆ·ä¿¡æ¯
* è¾“å‡ºï¼š
*		æ— 
*****************************/
void judge_by_result(levelinfo& level, userinfo& user) {
	show_over();
	do {
		//åˆ¤æ–­æ˜¯å¦æœ‰æŒ‰é”®æŒ‰ä¸‹
		if (_kbhit()) {
			//æ— ç¼“å†²è¯»å–
			char ch = _getch();
			if (ch == KEY_OUT) {
				closegraph();
				exit(0);
			}
			else if (ch == GAME_AGAIN) {
				if (!update_user_level(user, 1)) {
					std::system("pause");
					closegraph();
					exit(0);
				}
				break;
			}
		}
		Sleep(50);
	} while (1);
	fetch_level_info(level, user.level_id);
}
int main() {
//ä½œä¸ºæ•°æ®åˆå§‹åŒ–ï¼Œåªéœ€è¿è¡Œä¸€æ¬¡    
	resetting_data();
	load_data();
	//ç”¨æˆ·èº«ä»½éªŒè¯
	userinfo user;
	levelinfo level;
	if (!login(user)) {
		cout << "ç™»å½•å¤±è´¥ï¼Œè¯·é‡æ–°ç™»å½•ï¼" << endl;
		::system("pause");
		exit(-1);
	}
	init_graph();
	//å¾ªç¯ï¼ˆè¯»å–å…³å¡â†’ç”¨æˆ·æ“ä½œï¼‰
	do {
		//æ ¹æ®ç”¨æˆ·ä¿¡æ¯åŠ è½½å…³å¡æ•°æ®
		if (!fetch_level_info(level, user.level_id)) {
			judge_by_result(level, user);
		}
		//å°†å…³å¡æ•°æ®æ•°æ®è½¬æ¢åˆ°mapæ¸¸æˆåœ°å›¾ä¸­
		transform_map_db2array(level, map);
		//åŠ è½½æ¸¸æˆå›¾ç‰‡
		show_images(level);
		//å°äººç§»åŠ¨
		game_operation(level, user);
		//æ­å–œé€šå…³
		promot_over();
	} while (1);
	std::system("pause");
	closegraph();
	return 0;
}
```

## **ç›®å½•**

[ä¸€ã€
**æ¨ç®±å­æ¸¸æˆæºç ï¼ˆå¯ç›´æ¥æ‹·è´è¿è¡Œï¼‰**](#%E4%B8%80%E3%80%81%E6%8E%A8%E7%AE%B1%E5%AD%90%E6%B8%B8%E6%88%8F%E6%BA%90%E7%A0%81%EF%BC%88%E5%8F%AF%E7%9B%B4%E6%8E%A5%E6%8B%B7%E8%B4%9D%E8%BF%90%E8%A1%8C%EF%BC%89)

[äºŒã€Cè¯­è¨€æ¨ç®±å­æ¸¸æˆå®ç°](#%E4%BA%8C%E3%80%81C%E8%AF%AD%E8%A8%80%E6%8E%A8%E7%AE%B1%E5%AD%90%E6%B8%B8%E6%88%8F%E5%AE%9E%E7%8E%B0)

[1.åœ°å›¾åˆå§‹åŒ– init\_graph( ) + show\_images( )](#1.%E5%9C%B0%E5%9B%BE%E5%88%9D%E5%A7%8B%E5%8C%96%20init_graph%28%20%29%20+%20show_images%28%20%29)

[2.åœ°å›¾è¡¨ç¤º](#%C2%A0%202.%E5%9C%B0%E5%9B%BE%E8%A1%A8%E7%A4%BA)

[3.è®¾è®¡æ“ä½œæ¡†æ¶ ğŸ‘‰ å¾ªç¯ï¼ˆè¯»å–å…³å¡â†’ç”¨æˆ·æ“ä½œï¼‰](#%C2%A0%203.%E8%AE%BE%E8%AE%A1%E6%93%8D%E4%BD%9C%E6%A1%86%E6%9E%B6%20%F0%9F%91%89%20%E5%BE%AA%E7%8E%AF%EF%BC%88%E8%AF%BB%E5%8F%96%E5%85%B3%E5%8D%A1%E2%86%92%E7%94%A8%E6%88%B7%E6%93%8D%E4%BD%9C%EF%BC%89)

[4.ç®±å­æ§åˆ¶game\_operation( )](#%C2%A0%204.%E7%AE%B1%E5%AD%90%E6%8E%A7%E5%88%B6game_operation%28%20%29)

[â‘ è®¾è®¡ç”¨æˆ·æ“ä½œæ¡†æ¶](#%E2%91%A0%E8%AE%BE%E8%AE%A1%E7%94%A8%E6%88%B7%E6%93%8D%E4%BD%9C%E6%A1%86%E6%9E%B6)

[â‘¡æ§åˆ¶å°äººæŒ‡å®šæ–¹å‘ç§»åŠ¨](#%E2%91%A1%E6%8E%A7%E5%88%B6%E5%B0%8F%E4%BA%BA%E6%8C%87%E5%AE%9A%E6%96%B9%E5%90%91%E7%A7%BB%E5%8A%A8)

[â‘¢æ¸¸æˆé€€å‡º](#%E2%91%A2%E6%B8%B8%E6%88%8F%E9%80%80%E5%87%BA)

[â‘£æ¸¸æˆé‡æ–°å¼€å§‹](#%E2%91%A3%E6%B8%B8%E6%88%8F%E9%87%8D%E6%96%B0%E5%BC%80%E5%A7%8B)

[â‘¤æ¸¸æˆç»“æŸåˆ¤æ–­](#%E2%91%A4%E6%B8%B8%E6%88%8F%E7%BB%93%E6%9D%9F%E5%88%A4%E6%96%AD)

[â‘¥ç”¨æˆ·æ“ä½œæ¡†æ¶è¡¥å……](#%C2%A0%E2%91%A5%E7%94%A8%E6%88%B7%E6%93%8D%E4%BD%9C%E6%A1%86%E6%9E%B6%E8%A1%A5%E5%85%85)

[5.åŠ è½½æ¸¸æˆé€šå…³å›¾ç‰‡ï¼ˆå¦‚ä½•åŠ è½½pngé€æ˜å›¾ç‰‡ï¼‰](#%C2%A0%205.%E5%8A%A0%E8%BD%BD%E6%B8%B8%E6%88%8F%E9%80%9A%E5%85%B3%E5%9B%BE%E7%89%87%EF%BC%88%E5%A6%82%E4%BD%95%E5%8A%A0%E8%BD%BDpng%E9%80%8F%E6%98%8E%E5%9B%BE%E7%89%87%EF%BC%89)

[äºŒã€ç¼–å†™æ•°æ®åº“è¿æ¥ç¨‹åº](#%E4%BA%8C%E3%80%81%E7%BC%96%E5%86%99%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E7%A8%8B%E5%BA%8F)

[å‰è¨€ï¼š
**ä¸è¿æ¥MySQLæ•°æ®åº“æºç **](#%E5%89%8D%E8%A8%80%EF%BC%9A%E4%B8%8E%E8%BF%9E%E6%8E%A5MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E6%BA%90%E7%A0%81)

[1.æ•°æ®åº“è¡¨çš„è®¾è®¡ && C++ç»“æ„ä½“è®¾è®¡](#%C2%A0%20%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E7%9A%84%E8%AE%BE%E8%AE%A1%20&&%20C++%E7%BB%93%E6%9E%84%E4%BD%93%E8%AE%BE%E8%AE%A1)

[â‘ SQLè¯­å¥åˆ›å»ºæ•°æ®](#%C2%A0%C2%A0%C2%A0%20%E2%91%A0SQL%E8%AF%AD%E5%8F%A5%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE)

[â‘¡C++ç»“æ„ä½“è®¾è®¡](#%C2%A0%20%C2%A0%20%E2%91%A1C++%E7%BB%93%E6%9E%84%E4%BD%93%E8%AE%BE%E8%AE%A1)

[2.ç”¨æˆ·ç™»å½• fetch\_user\_info( )](#%C2%A0%20%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%20fetch_user_info%28%20%29)

[3.è·å–å…³å¡ä¿¡æ¯](#%C2%A0%20%E8%8E%B7%E5%8F%96%E5%85%B3%E5%8D%A1%E4%BF%A1%E6%81%AF)

[4.åœ°å›¾è½¬æ¢](#%C2%A0%20%E5%9C%B0%E5%9B%BE%E8%BD%AC%E6%8D%A2)

[5.è·³è½¬ä¸‹ä¸€å…³](#%C2%A0%20%E8%B7%B3%E8%BD%AC%E4%B8%8B%E4%B8%80%E5%85%B3)

[ä¸‰ã€ä¿®æ”¹æ¸¸æˆä»£ç é€‚åº”ä¸æ•°æ®åº“è¿æ¥](#%E4%B8%89%E3%80%81%E5%8D%87%E7%BA%A7%E6%8E%A8%E7%AE%B1%E5%AD%90%E6%B8%B8%E6%88%8F%E4%BB%A3%E7%A0%81%E4%B8%8E%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9B%B8%E8%BF%9E)

[1.æå®šç”¨æˆ·ç™»å½•åŠŸèƒ½](#1.%E6%90%9E%E5%AE%9A%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E5%8A%9F%E8%83%BD)

[2.å¯¹ç”¨æˆ·çš„æ¸¸æˆè¿›åº¦åšå‡ºåˆ¤æ–­](#2.%E5%AF%B9%E7%94%A8%E6%88%B7%E7%9A%84%E6%B8%B8%E6%88%8F%E8%BF%9B%E5%BA%A6%E5%81%9A%E5%87%BA%E5%88%A4%E6%96%AD)

[å››ã€ç¨‹åºæ‰“åŒ…å‘å¸ƒ](#%E5%9B%9B%E3%80%81%E7%A8%8B%E5%BA%8F%E6%89%93%E5%8C%85%E5%8F%91%E5%B8%83)

[1.ä¸‹è½½ç¨‹åºæ‰“åŒ…ç»„ä»¶](#%C2%A0%E4%B8%80%E3%80%81%E4%B8%8B%E8%BD%BD%E7%A8%8B%E5%BA%8F%E6%89%93%E5%8C%85%E7%BB%84%E4%BB%B6)

[2.è®¾ç½®VSç¼–è¯‘å™¨](#%C2%A0%E4%BA%8C%E3%80%81%E8%AE%BE%E7%BD%AEVS%E7%BC%96%E8%AF%91%E5%99%A8)

[3.åœ¨åŒä¸€è§£å†³æ–¹æ¡ˆä¸‹åˆ›å»ºSetupé¡¹ç›®](#%E4%B8%89%E3%80%81%E5%9C%A8%E5%90%8C%E4%B8%80%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E4%B8%8B%E5%88%9B%E5%BB%BASetup%E9%A1%B9%E7%9B%AE)

[4.æ·»åŠ é¡¹ç›®æ–‡ä»¶åˆ°Setupé¡¹ç›®ä¸­](#%E5%9B%9B%E3%80%81%E6%B7%BB%E5%8A%A0%E9%A1%B9%E7%9B%AE%E6%96%87%E4%BB%B6%E5%88%B0Setup%E9%A1%B9%E7%9B%AE%E4%B8%AD)

[5.æ·»åŠ é¡¹ç›®è¾“å‡º](#%E4%BA%94%E3%80%81%E6%B7%BB%E5%8A%A0%E9%A1%B9%E7%9B%AE%E8%BE%93%E5%87%BA)

[6.å°†å¿«æ·æ–¹å¼æ”¾å…¥ç”¨æˆ·æ¡Œé¢ä¸­](#%E5%85%AD%E3%80%81%E5%B0%86%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F%E6%94%BE%E5%85%A5%E7%94%A8%E6%88%B7%E6%A1%8C%E9%9D%A2%E4%B8%AD)

[7.ä¸ºç¨‹åºé€‰æ‹©ä¸€ä¸ªå›¾æ ‡](#%E4%B8%83%E3%80%81%E4%B8%BA%E7%A8%8B%E5%BA%8F%E9%80%89%E6%8B%A9%E4%B8%80%E4%B8%AA%E5%9B%BE%E6%A0%87)

[8.å°†å›¾æ ‡ä¸å¿«æ·æ–¹å¼ç»‘å®š](#%E5%85%AB%E3%80%81%E5%B0%86%E5%9B%BE%E6%A0%87%E4%B8%8E%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F%E7%BB%91%E5%AE%9A)

[äº”ã€ä¸è¶³ä¹‹å¤„](#%E4%BA%94%E3%80%81%E4%B8%8D%E8%B6%B3%E4%B9%8B%E5%A4%84)

---

## äºŒã€Cè¯­è¨€æ¨ç®±å­æ¸¸æˆå®ç°

### 1.åœ°å›¾åˆå§‹åŒ– init\_graph( ) + show\_images( )

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/4d816b925fd4b3e77af2dbb7c8f72be3.png)
â€‹

æˆ‘ä»¬é¦–å…ˆéœ€è¦åˆå§‹åŒ–ç”»å¸ƒï¼ŒåŠ è½½æ¸¸æˆèƒŒæ™¯å›¾ä»¥åŠæ‰€éœ€å…¶ä»–å›¾ç‰‡ç´ æã€‚

```cpp
typedef enum  _PROPS {
	WALL,	//å¢™
	FLOOR,	//åœ°æ¿
	BOX_DES,//ç®±å­ç›®çš„åœ°
	MAN,	//å°äºº
	BOX,	//ç®±å­
	HIT,	//ç®±å­å‘½ä¸­ç›®æ ‡
	MAN_DES,	//äººç«™åœ¨ç›®æ ‡ä¸Š
	VECTOR	//é€šå…³å›¾ç‰‡
}PROPS;

/*****************************
* åŠŸèƒ½ï¼šåŠ è½½æ¸¸æˆç´ æ
* è¾“å…¥ï¼š
*		æ— 
* è¾“å‡ºï¼š
*		æ— 
*****************************/
void init_graph() {
	initgraph(SCREEN_WIDTH, SCREEN_HEIGHT);
	loadimage(&images[WALL], _T("wall_right.bmp"), RATIO, RATIO, true);
	loadimage(&images[FLOOR], _T("floor.bmp"), RATIO, RATIO, true);
	loadimage(&images[BOX_DES], _T("des.bmp"), RATIO, RATIO, true);
	loadimage(&images[MAN], _T("man.bmp"), RATIO, RATIO, true);
	loadimage(&images[BOX], _T("box.jpg"), RATIO, RATIO, true);
	loadimage(&images[HIT], _T("box_des.jpg"), RATIO, RATIO, true);
	loadimage(&images[MAN_DES], _T("man_des.bmp"), RATIO, RATIO, true);
	loadimage(&images[VECTOR], _T("vector.png"), 6 * RATIO, 6 * RATIO, true);
}

/*****************************
* åŠŸèƒ½ï¼šæ˜¾ç¤ºæŒ‡å®šåœ°å›¾
* è¾“å…¥ï¼š
*		level - æŒ‡å®šåœ°å›¾
* è¾“å‡ºï¼š
*		æ— 
*****************************/
void show_images(levelinfo& level) {
	cleardevice();	// æ¯æ¬¡è´´å›¾æ¸…å±ä¸€ä¸‹
	IMAGE bg_img;
	//å›¾ç‰‡çš„å®½ï¼Œé«˜æœ€åä¸€ä¸ªå‚æ•°â€œæ˜¯å¦æ‹‰ä¼¸â€
	loadimage(&bg_img, _T("bgimage.png"), SCREEN_WIDTH, SCREEN_HEIGHT, true);
	putimage(0, 0, &bg_img);
	for (int i = 0; i < level.map_row; ++i) {
		for (int j = 0; j < level.map_column; ++j) {
			if (map[i][j] == MAN) {
				man.x = i;
				man.y = j;
			}
			if (map[i][j] == BG_IMAGE)
				continue;
			putimage(START_X + j * RATIO, START_Y + i * RATIO, &images[map[i][j]]);
		}
	}
	const char* str = level.name.c_str();
	setbkmode(TRANSPARENT);
	setfont(RATIO, 0, _T("åæ–‡æ¥·ä½“"));
	setcolor(WHITE);
	outtextxy(200, 25, str);
}
```

### 2.åœ°å›¾è¡¨ç¤º

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/b06164ecf9438ebf1cc61b3c76e9d646.png)
â€‹

æ¸¸æˆåœ°å›¾ä½¿ç”¨äºŒç»´æ•°ç»„å­˜å‚¨ï¼Œå¯¹ä¸åŒçš„å›¾å½¢ç”¨ä¸åŒçš„æ•°å­—è¡¨ç¤º

```cpp
//å¢™: 0ï¼›åœ°æ¿: 1ï¼›ç®±å­ç›®çš„åœ°: 2,ï¼›å°äºº: 3ï¼›ç®±å­: 4ï¼›èƒŒæ™¯å›¾ï¼š-1ï¼›ç›®æ ‡: 5
int mapdata[LINE][COLUMN] = {
    {-1,0,0,0,0,0,0,0,-1,-1 },
    { -1, 0, 2, 2, 2, 2, 1, 0, -1, -1 },
    {0, 0, 0, 2, 2, 2, 4, 0, 0, 0 },
    {0, 1, 1, 4, 0, 4, 1, 4, 1, 0 },
    {0, 1, 4, 4, 1, 1, 0, 4, 1, 0 },
    {0, 1, 1, 1, 3, 0, 1, 1, 1, 0 },
    {0, 0, 0, 0, 1, 1, 1, 0, 0, 0, },
    {-1, -1, -1, 0, 0, 0, 0, 0, -1, -1}
};
```

### **3.è®¾è®¡æ“ä½œæ¡†æ¶ ğŸ‘‰** å¾ªç¯ï¼ˆè¯»å–å…³å¡â†’ç”¨æˆ·æ“ä½œï¼‰

æ¯æ¬¡è¯»å–å…³å¡ï¼Œç„¶åæ˜¯ç”¨æˆ·æ“ä½œï¼Œç”¨æˆ·é€šå…³åç»§ç»­è¯»å–ä¸‹ä¸€å…³å¡ã€‚å¦‚æœç”¨æˆ·ä¸­é€”æŒ‰ä¸‹é€€å‡ºé”®åˆ™ä¼šé€€å‡ºæ¸¸æˆã€‚

```cpp
int main() {    
    //è¯»å–åœ°å›¾ä¿¡æ¯
    memcpy(map, mapdata, sizeof(mapdata));
    init_graph();//å¾ªç¯ï¼ˆè¯»å–å…³å¡â†’ç”¨æˆ·æ“ä½œï¼‰
    do {
        //åŠ è½½æ¸¸æˆå›¾ç‰‡
        show_images();
        //ç”¨æˆ·æ“ä½œ
        game_operation();
        //æ­å–œé€šå…³
        promot_over();
        } while (1);
    std::system("pause");
    closegraph();
    return 0;
}
```

### 4.ç®±å­æ§åˆ¶game\_operation( )

#### â‘ è®¾è®¡ç”¨æˆ·æ“ä½œæ¡†æ¶

é€šè¿‡å¾ªç¯ï¼Œæ¯æ¬¡è¯»å–ç”¨æˆ·æŒ‰é”®ï¼Œæ ¹æ®æŒ‰é”®åšå‡ºç›¸åº”æ¸¸æˆæ•ˆæœå®ç°ã€‚å°äººæ¯æ¬¡å¯ä»¥ä¸Šä¸‹å·¦å³å››ä¸ªæ–¹å‘ç§»åŠ¨ï¼Œä»¥åŠç”¨æˆ·çš„é€€å‡ºå’Œé‡æ–°å¼€å§‹å…±å…­ä¸ªçƒ­é”®ã€‚å½“æ¸¸æˆç»“æŸæ—¶é€€å‡ºå¾ªç¯ï¼Œå¦‚æœç”¨æˆ·æŒ‰ä¸‹é€€å‡ºåˆ™ç›´æ¥ç»“æŸæ¸¸æˆã€‚

```cpp
#define KEY_UP 'W'    //ä¸Šç§»
#define KEY_LEFT 'A'    //å·¦ç§»
#define KEY_RIGHT 'D'    //å³ç§»
#define KEY_DOWN 'S'    //ä¸‹ç§»
#define KEY_OUT 'Q'    //é€€å‡º
#define GAME_AGAIN 'R'    //é‡è¯•/
*****************************
* åŠŸèƒ½ï¼šæ¸¸æˆæ§åˆ¶
* è¾“å…¥ï¼š        
*    æ— 
* è¾“å‡ºï¼š
*    æ— 
*****************************/
void game_operation() {
    bool quit = false;    //è®°å½•æ˜¯å¦æ¸¸æˆç»“æŸ
    do {
        //åˆ¤æ–­æ˜¯å¦æœ‰æŒ‰é”®æŒ‰ä¸‹
        if (_kbhit()) {
            //æ— ç¼“å†²è¯»å–
            char ch = _getch();
            if (ch == KEY_UP) {
                // to do
            }else if (ch == KEY_DOWN) {
                // to do
            }else if (ch == KEY_LEFT) {
                // to do
            }else if (ch == KEY_RIGHT) {
                // to do
            }else if (ch == GAME_AGAIN) {
                // to do
            }else if (ch == KEY_OUT) {
                // to do
            }if (isGameOver()) {
                // to do
            }
        }wait(100);
    } while (quit == false);
}
```

#### â‘¡æ§åˆ¶å°äººæŒ‡å®šæ–¹å‘ç§»åŠ¨

å¯¹äºå°äººå¯ä»¥ç§»åŠ¨çš„æƒ…å†µå¯ä»¥åˆ†æˆå››ç§ï¼š

â… ï¼šå°äººå‰é¢æ˜¯åœ°æ¿

â…¡ï¼šå°äººå‰é¢æ˜¯ç›®çš„åœ°

â…¢ï¼šå°äººé¡¹ç›®æ˜¯ç®±å­

â…£ï¼šå°äººå‰é¢æ˜¯å·²ç»åœ¨ç›®çš„åœ°ä¸Šçš„ç®±å­

è¿˜æœ‰å…¶ä»–å¯èƒ½å‡ºç°çš„æƒ…å†µéƒ½å±äºä¸èƒ½ç§»åŠ¨ã€‚é‚£ä¸ºä»€ä¹ˆè¦åˆ†æˆè¿™å››ç§æƒ…å†µå‘¢ï¼Ÿå¦‚æœå°äººå‰é¢æ˜¯åœ°æ¿æˆ–è€…ç®±å­æ—¶ï¼Œæ¯æ¬¡ç§»åŠ¨æˆ‘ä»¬è¦å»æ›´æ”¹åœ°å›¾ä¿¡æ¯ï¼ˆä¸ºåˆ¤æ–­æ¸¸æˆç»“æŸåšå‡†å¤‡ï¼‰ï¼Œè€Œå¦‚æœå°äººå‰é¢æ˜¯ç›®çš„åœ°æˆ–è€…æ˜¯å·²ç»åœ¨ç›®çš„åœ°ä¸Šçš„ç®±å­é‚£å°±ä¸èƒ½æ›´æ”¹åœ°å›¾ä¿¡æ¯äº†ã€‚

```cpp
#define isValid(next_pos) next_pos.x > 0 && next_pos.x < LINE && next_pos.y>0 && next_pos.y < COLUMN

/*****************************
* åŠŸèƒ½ï¼šåœ¨æŒ‡å®šä½ç½®æ›´æ”¹åœ°å›¾ä¿¡æ¯ æ˜¾ç¤ºæŒ‡å®šå›¾ç‰‡
* è¾“å…¥ï¼š
*		next_pos - æŒ‡å®šä½ç½®
*		prop - æŒ‡å®šå›¾ç‰‡
* è¾“å‡ºï¼š	
*		æ— 
*****************************/
void changeMap(POS* next_pos, PROPS prop) {
	map[next_pos->x][next_pos->y] = prop;
	putimage(START_X + next_pos->y * RATIO, START_Y + next_pos->x * RATIO, &images[prop]);
}

/*****************************
* åŠŸèƒ½ï¼šåœ¨æŒ‡å®šä½ç½®æ˜¾ç¤ºæŒ‡å®šå›¾ç‰‡
* è¾“å…¥ï¼š
*		next_pos - æŒ‡å®šä½ç½®
*		prop - æŒ‡å®šå›¾ç‰‡
* è¾“å‡ºï¼š
*		æ— 
*****************************/
void changeMap2(POS* next_pos, PROPS prop) {
	putimage(START_X + next_pos->y * RATIO, START_Y + next_pos->x * RATIO, &images[prop]);
}

/*****************************
* åŠŸèƒ½ï¼šæ§åˆ¶å°äººå‘æŒ‡å®šæ–¹å‘ç§»åŠ¨
* è¾“å…¥ï¼š
*		direct - æŒ‡å®šæ–¹å‘
* è¾“å‡ºï¼š
*		æ— 
*****************************/
void gameControl(DIRECTION direct) {
	POS next_pos = man;
	POS next_next_pos = man;
	switch (direct) {
	case UP:
		next_pos.x--;
		next_next_pos.x -= 2;
		break;
	case DOWN:
		next_pos.x++;
		next_next_pos.x += 2;
		break;
	case LEFT :
		next_pos.y--;
		next_next_pos.y -= 2;
		break;
	case RIGHT:
		next_pos.y++;
		next_next_pos.y += 2;
		break;
	}	
	//å®å±•å¼€next_pos.x > 0 && next_pos.x < LINE && next_pos.y>0 && next_pos.y < COLUMN
	// äººçš„å‰æ–¹æ˜¯åœ°æ¿
	if (isValid(next_pos) && map[next_pos.x][next_pos.y] == FLOOR) {
		//äººçš„è„šä¸‹æ˜¯ç›®çš„åœ°
		if (map[man.x][man.y] == BOX_DES) {
			changeMap(&next_pos, MAN);
			changeMap2(&man, BOX_DES);
		}
		else {
			changeMap(&man, FLOOR);
			changeMap(&next_pos, MAN);
		}	
		man = next_pos;
	}
	// äººçš„å‰æ–¹æ˜¯ç®±å­
	else if (isValid(next_next_pos) && map[next_pos.x][next_pos.y] == BOX) {	
		if (map[next_next_pos.x][next_next_pos.y] == FLOOR) {	// ç®±å­çš„å‰æ–¹æ˜¯åœ°æ¿
			changeMap(&next_next_pos, BOX);
			changeMap(&next_pos, MAN);
			if (map[man.x][man.y] == BOX_DES) {
				changeMap(&man, BOX_DES);
			}
			else {
				changeMap(&man, FLOOR);
			}
			man = next_pos;
		}
		else if (map[next_next_pos.x][next_next_pos.y] == BOX_DES) {	// ç®±å­å‰é¢æ˜¯ç›®çš„åœ°
			changeMap(&next_next_pos, HIT);
			changeMap(&next_pos, MAN);
			if (map[man.x][man.y] == BOX_DES) {
				changeMap(&man, BOX_DES);
			}
			else {
				changeMap(&man, FLOOR);
			}
			man = next_pos;
		}	
	}
	//å‰æ–¹æ˜¯ç›®çš„åœ°
	else if (isValid(next_pos) && map[next_pos.x][next_pos.y] == BOX_DES) {
		//å°äººè„šä¸‹ä¹Ÿæ˜¯ç›®çš„åœ°
		if (map[man.x][man.y] == BOX_DES) {
			changeMap2(&next_pos, MAN_DES);
			changeMap(&man, BOX_DES);
		}
		else {
			changeMap(&man, FLOOR);
			changeMap2(&next_pos, MAN_DES);
			
		}
		man = next_pos;
	}
	//å‰æ–¹æ˜¯ç®±å­å‘½ä¸­ç‚¹
	else if (isValid(next_pos) && map[next_pos.x][next_pos.y] == HIT) {
		if (map[next_next_pos.x][next_next_pos.y] == FLOOR) {	// ç®±å­çš„å‰æ–¹æ˜¯åœ°æ¿
			changeMap(&next_next_pos, BOX);
			changeMap(&next_pos, BOX_DES);
			changeMap2(&next_pos, MAN_DES);
			//äººçš„è„šä¸‹æ˜¯ç›®çš„åœ°
			if (map[man.x][man.y] == BOX_DES) {
				changeMap(&man, BOX_DES);
			}
			else {
				changeMap(&man, FLOOR);
			}
			man = next_pos;
		}
		else if (map[next_next_pos.x][next_next_pos.y] == BOX_DES) {	// ç®±å­å‰é¢æ˜¯ç›®çš„åœ°
			changeMap(&next_next_pos, HIT);
			changeMap(&next_pos, BOX_DES);
			changeMap2(&next_pos, MAN_DES);
			//äººçš„è„šä¸‹æ˜¯ç›®çš„åœ°
			if (map[man.x][man.y] == BOX_DES) {
				changeMap(&man, BOX_DES);
			}
			else {
				changeMap(&man, FLOOR);
			}
			man = next_pos;
		}
	}
}
```

#### â‘¢æ¸¸æˆé€€å‡º

å¦‚æœç”¨æˆ·æŒ‰ä¸‹â€œQâ€é”®å¯ä»¥ç›´æ¥é€€å‡ºæ¸¸æˆï¼Œè¿™ä¸ªè¿˜æ˜¯æ¯”è¾ƒå¥½å†™çš„ç›´æ¥ä¸€ä¸ªexit(0)

```cpp
else if (ch == KEY_OUT) {
    closegraph();exit(0);
}
```

#### â‘£æ¸¸æˆé‡æ–°å¼€å§‹

å¦‚æœç”¨æˆ·æŒ‰ä¸‹â€œRâ€é”®ï¼Œé‡ç½®æ¸¸æˆã€‚ç°åœ¨è¿˜æ²¡æœ‰è¿æ¥æ•°æ®åº“ï¼Œè¿™ä¸ªåŠŸèƒ½è¿˜æ˜¯å®¹æ˜“å®Œæˆï¼Œåªè¦é‡ç½®åœ°å›¾ä¿¡æ¯ç„¶åæ˜¾ç¤ºå‡ºæ¥å³å¯

```cpp
else if (ch == GAME_AGAIN) {
    memcpy(map, mapdata, sizeof(mapdata));
    show_images();
}
```

#### â‘¤æ¸¸æˆç»“æŸåˆ¤æ–­

æ¯æ¬¡å°†ç®±å­æ¨åˆ°ç›®çš„åœ°æ—¶æˆ‘ä»¬å·²ç»æ›´æ”¹åœ°å›¾ä¿¡æ¯ï¼Œæ‰€ä»¥å¯¹äºæ¸¸æˆæ˜¯å¦ç»“æŸåˆ¤æ–­æˆ‘ä»¬å¯ä»¥éå†åœ°å›¾ï¼Œåªè¦æ‰¾ä¸åˆ°â€œç›®çš„åœ°â€åˆ™ä»£è¡¨æ¸¸æˆç»“æŸã€‚

```cpp
/*****************************
* åŠŸèƒ½ï¼šåˆ¤æ–­æ¸¸æˆæ˜¯å¦ç»“æŸ
* è¾“å…¥ï¼š
*		æ— 
* è¾“å‡ºï¼š
*		true - æœªç»“æŸ
*		flase - ç»“æŸ
*****************************/
bool isGameOver() {
	for (int i = 0; i < LINE; ++i) {
		for (int j = 0; j < COLUMN; ++j) {
			if (map[i][j] == BOX_DES)
				return false;
		}
	}
	return true;
}
```

#### â‘¥ç”¨æˆ·æ“ä½œæ¡†æ¶è¡¥å……

å°†ä¸Šè¿°å®ç°åŠŸèƒ½è¡¥å……åˆ°ç”¨æˆ·æ“ä½œæ¡†æ¶ä¸­

```cpp
/*****************************
* åŠŸèƒ½ï¼šæ¸¸æˆæ§åˆ¶
* è¾“å…¥ï¼š
*		level - æŒ¡å¢™å…³å¡æ•°æ®
*		user - ç”¨æˆ·ä¿¡æ¯
* è¾“å‡ºï¼š
*		æ— 
*****************************/
void game_operation() {
	bool quit = false;
	do {
		//åˆ¤æ–­æ˜¯å¦æœ‰æŒ‰é”®æŒ‰ä¸‹
		if (_kbhit()) {
			//æ— ç¼“å†²è¯»å–
			char ch = _getch();
			if (ch == KEY_UP) {
				gameControl(UP);
			}
			else if (ch == KEY_DOWN) {
				gameControl(DOWN);
			}
			else if (ch == KEY_LEFT) {
				gameControl(LEFT);
			}
			else if (ch == KEY_RIGHT) {
				gameControl(RIGHT);
			}
			else if (ch == GAME_AGAIN) {
				memcpy(map, mapdata, sizeof(mapdata));
				show_images();
			}
			else if (ch == KEY_OUT) {
				closegraph();
				exit(0);
			}
			if (isGameOver()) {
				quit = true;
			}
		}
		wait(100);
	} while (quit == false);
}

```

### 5.åŠ è½½æ¸¸æˆé€šå…³å›¾ç‰‡ï¼ˆå¦‚ä½•åŠ è½½pngé€æ˜å›¾ç‰‡ï¼‰

å…¶å®åŠ è½½æ¸¸æˆé€šå…³å›¾ç‰‡åªéœ€ä½¿ç”¨putimageå‡½æ•°å³å¯ï¼Œè¿™é‡Œä¹‹æ‰€ä»¥å•ç‹¬ä½œä¸ºä¸€ä¸ªæ ‡é¢˜æ˜¯å› ä¸ºä½¿ç”¨putimageæ—¶å¦‚æœæ—¶pngé€æ˜å›¾ç‰‡åŠ è½½å‡ºæ¥æ—¶è¿˜æ˜¯ä¼šæœ‰èƒŒæ™¯ï¼Œè¿™é‡Œä¸ºå¤§å®¶æä¾›ä¸€ä¸ªå¯ä»¥åŠ è½½pngé€æ˜èƒŒæ™¯å›¾ç‰‡çš„ç®—æ³•ï¼ˆå¯ä»¥å•ç‹¬æ‹·è´ä½¿ç”¨ï¼‰

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/6d81b879a1bb08699b15eca78f8d92af.png)
â€‹

```cpp
/*****************************
* åŠŸèƒ½ï¼šè½½å…¥PNGå›¾å¹¶å»é€æ˜éƒ¨åˆ†
* è¾“å…¥ï¼š
*		æ— 
* è¾“å‡ºï¼š
*		æ— 
*****************************/
void drawAlpha(IMAGE* picture, int  picture_x, int picture_y) //xä¸ºè½½å…¥å›¾ç‰‡çš„Xåæ ‡ï¼Œyä¸ºYåæ ‡
{

	// å˜é‡åˆå§‹åŒ–
	DWORD* dst = GetImageBuffer();    // GetImageBuffer()å‡½æ•°ï¼Œç”¨äºè·å–ç»˜å›¾è®¾å¤‡çš„æ˜¾å­˜æŒ‡é’ˆï¼ŒEASYXè‡ªå¸¦
	DWORD* draw = GetImageBuffer();
	DWORD* src = GetImageBuffer(picture); //è·å–pictureçš„æ˜¾å­˜æŒ‡é’ˆ
	int picture_width = picture->getwidth(); //è·å–pictureçš„å®½åº¦ï¼ŒEASYXè‡ªå¸¦
	int picture_height = picture->getheight(); //è·å–pictureçš„é«˜åº¦ï¼ŒEASYXè‡ªå¸¦
	int graphWidth = getwidth();       //è·å–ç»˜å›¾åŒºçš„å®½åº¦ï¼ŒEASYXè‡ªå¸¦
	int graphHeight = getheight();     //è·å–ç»˜å›¾åŒºçš„é«˜åº¦ï¼ŒEASYXè‡ªå¸¦
	int dstX = 0;    //åœ¨æ˜¾å­˜é‡Œåƒç´ çš„è§’æ ‡

	// å®ç°é€æ˜è´´å›¾ å…¬å¼ï¼š Cp=Î±p*FP+(1-Î±p)*BP ï¼Œ è´å¶æ–¯å®šç†æ¥è¿›è¡Œç‚¹é¢œè‰²çš„æ¦‚ç‡è®¡ç®—
	for (int iy = 0; iy < picture_height; iy++)
	{
		for (int ix = 0; ix < picture_width; ix++)
		{
			int srcX = ix + iy * picture_width; //åœ¨æ˜¾å­˜é‡Œåƒç´ çš„è§’æ ‡
			int sa = ((src[srcX] & 0xff000000) >> 24); //0xAArrggbb;AAæ˜¯é€æ˜åº¦
			int sr = ((src[srcX] & 0xff0000) >> 16); //è·å–RGBé‡Œçš„R
			int sg = ((src[srcX] & 0xff00) >> 8);   //G
			int sb = src[srcX] & 0xff;              //B
			if (ix >= 0 && ix <= graphWidth && iy >= 0 && iy <= graphHeight && dstX <= graphWidth * graphHeight)
			{
				dstX = (ix + picture_x) + (iy + picture_y) * graphWidth; //åœ¨æ˜¾å­˜é‡Œåƒç´ çš„è§’æ ‡
				int dr = ((dst[dstX] & 0xff0000) >> 16);
				int dg = ((dst[dstX] & 0xff00) >> 8);
				int db = dst[dstX] & 0xff;
				draw[dstX] = ((sr * sa / 255 + dr * (255 - sa) / 255) << 16)  //å…¬å¼ï¼š Cp=Î±p*FP+(1-Î±p)*BP  ï¼› Î±p=sa/255 , FP=sr , BP=dr
					| ((sg * sa / 255 + dg * (255 - sa) / 255) << 8)         //Î±p=sa/255 , FP=sg , BP=dg
					| (sb * sa / 255 + db * (255 - sa) / 255);              //Î±p=sa/255 , FP=sb , BP=db
			}
		}
	}
}

/*****************************
* åŠŸèƒ½ï¼šè½½å…¥â€œæ­å–œé€šå…³â€å›¾ç‰‡
* è¾“å…¥ï¼š
*		æ— 
* è¾“å‡ºï¼š
*		æ— 
*****************************/
void promot_over() {
	setbkmode(TRANSPARENT);
	drawAlpha(&images[VECTOR], 250, 130);     // è½½å…¥PNGå›¾å¹¶å»é€æ˜éƒ¨åˆ†
	Sleep(1100);
}
```

**åˆ°è¿™é‡Œæ¨ç®±å­æ¸¸æˆå°±å·²ç»å®Œæˆäº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å°†æ•°æ®åº“ä¸æ¸¸æˆè¿æ¥èµ·æ¥ã€‚**

## äºŒã€ç¼–å†™æ•°æ®åº“è¿æ¥ç¨‹åº

ä¸Šé¢ åˆ†äº«çš„æºç æ˜¯åŸºäºæ–‡æœ¬æ–‡æ¡£åšä¸ºæ•°æ®åº“å­˜å‚¨ï¼Œå°ç¼–å°±ä½¿ä¸åšè¿‡å¤šè¯´æ˜ã€‚è¿™é‡Œä¸ºå¤§å®¶åˆ†äº«å¦‚ä½•ä¸MySQLæ•°æ®åº“è¿æ¥

### å‰è¨€ï¼šä¸è¿æ¥MySQLæ•°æ®åº“æºç 

[è¿æ¥MySQLæ•°æ®åº“æºç 

![](https://i-blog.csdnimg.cn/blog_migrate/108103d72789eafe62012253d677a985.png)
https://download.csdn.net/download/qq\_54169998/81166262](https://download.csdn.net/download/qq_54169998/81166262 "è¿æ¥MySQLæ•°æ®åº“æºç ")
åœ¨ç¼–å†™ç¨‹åºä¹‹å‰ï¼Œé¦–å…ˆè¦åšçš„æ˜¯é…ç½®VSç¼–è¯‘å™¨ï¼Œå¦‚æœæœ‰ä¸ä¼šçš„æœ‹å‹å¯ä»¥å‚è€ƒä¸‹é¢çš„é…ç½®æ•™ç¨‹

[C/C++è¿æ¥MySQLæ•°æ®åº“ é…ç½®VSç¼–è¯‘å™¨

![](https://i-blog.csdnimg.cn/blog_migrate/47d24f4aaa077eeb7345bbfa47a6853e.png)
https://blog.csdn.net/qq\_54169998/article/details/122764798?spm=1001.2014.3001.5501](https://blog.csdn.net/qq_54169998/article/details/122764798?spm=1001.2014.3001.5501 "C/C++è¿æ¥MySQLæ•°æ®åº“   é…ç½®VSç¼–è¯‘å™¨")

### 1.æ•°æ®åº“è¡¨çš„è®¾è®¡ && C++ç»“æ„ä½“è®¾è®¡

* ç”¨æˆ·è¡¨

|  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- |
| ****è¡¨å**** | ****Users**** | | | | |
| ****å­—æ®µå**** | ****ç±»å‹**** | ****æ˜¯å¦ä¸ºç©º**** | ****é»˜è®¤å€¼**** | ****ä¸»ã€å¤–é”®**** | ****å¤‡æ³¨**** |
| id | int(11) | NOT | 1,è‡ªå¢é•¿ | PK | ç”¨æˆ·id |
| username | varchar(64) | NOT |  |  | ç”¨æˆ·åï¼šè‹±æ–‡å­—ç¬¦ã€æ•°å­—å’Œç‰¹æ®Šç¬¦å·çš„ç»„åˆ |
| password | varchar(32) | NOT |  |  | å¯†ç ï¼šè‹±æ–‡å­—ç¬¦ã€æ•°å­—å’Œç‰¹æ®Šç¬¦å·çš„ç»„åˆï¼Œ8-16ä½ |
| level\_id | int |  | 1 |  | å½“å‰å…³å¡ï¼Œå…³è”Levelsè¡¨ä¸­çš„id |

* å…³å¡è¡¨

|  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- |
| ****è¡¨å**** | ****Levels**** | | | | |
| ****å­—æ®µå**** | ****ç±»å‹**** | ****æ˜¯å¦ä¸ºç©º**** | ****é»˜è®¤å€¼**** | ****ä¸»ã€å¤–é”®**** | ****å¤‡æ³¨**** |
| id | int | NOT | 1 | PK | æ¸¸æˆå…³å¡åºå·ï¼Œä»1å¼€å§‹ |
| name | varchar(64) | NOT |  |  | åœ°å›¾åç§° |
| map\_row | int | NOT |  |  | åœ°å›¾äºŒä½ç»„çš„æ€»è¡Œæ•° |
| map\_column | int | NOT |  |  | åœ°å›¾äºŒç»´ç»„çš„æ€»åˆ—æ•° |
| map\_data | varchar(4096) | NOT |  |  | åœ°å›¾æ•°æ®ï¼ŒäºŒç»´æ•°ç»„å¯¹åº”çš„è¡Œåˆ—å¼ï¼Œå¤šè¡Œä»¥|åˆ†å¼€,åˆ—ä»¥é€—å·åˆ†éš”ï¼Œæœ€å¤§æ¥è¿‘æ”¯æŒ45x45çš„åœ°å›¾ |
| next\_level\_id | int |  | 0 |  | ä¸‹ä¸€å…³çš„å…³å¡id,0ä»£è¡¨é€šå…³ |

#### â‘ SQLè¯­å¥åˆ›å»ºæ•°æ®

```sql
create database box_man if not exists;
use box_man;
create table users ( 
    id int not null auto_increment,
    username varchar(64) not null,
    password varchar(32) not null,
    level_id int default 1,
    primary key(id),
    unique key username(username)
);

create table levels(
    id int not null auto_increment,
    name varchar(64) not null,
    map_row int not null,
    map_column int not null,
    map_data varchar(4096) not null,
    next_level_id int default 0 comment 'ä¸‹ä¸€å…³çš„idï¼Œ0ä»£è¡¨é€šå…³',
    primary key(id)
);
insert into users 
    values(1,'Jack',md5(123456),1);
insert into levels 
    values(1,'å°è¯•ç‰›åˆ€â†’ç¬¬ä¸€å…³',8,10,'-1,0,0,0,0,0,0,0,-1,-1|-1,0,2,2,2,2,1,0,-1,-1|0,0,0,2,2,2,4,0,0,0|0,1,1,4,0,4,1,4,1,0|0,1,4,4,1,1,0,4,1,0|0,1,1,1,3,0,1,1,1,0|0,0,0,0,1,1,1,0,0,0,|-1,-1,-1,0,0,0,0,0,-1,-1',2),
    (2,'ç»åœ°å¼ºè€…â†’ç¬¬äºŒå…³',6,6,'0,0,0,0,0,0|0,2,2,1,1,0|0,4,4,1,3,0|0,2,1,4,0,0|0,1,1,1,0,-1|0,0,0,0,0,-1',3),
    (3,'å¤©å¤–å¼ºäººâ†’ç¬¬ä¸‰å…³',8,10,'-1,-1,0,0,0,0,0,0,-1,-1|0,0,0,1,1,1,0,0,0,0|0,1,1,1,4,1,4,1,1,0|0,1,4,1,1,1,4,1,3,0|0,0,0,4,4,0,0,0,0,0,|-1,-1,0,1,1,2,2,0,-1,-1|-1,-1,0,2,2,2,2,0,-1,-1|-1,-1,0,0,0,0,0,0,-1,-1',4),
    (4,'æ­»è€Œå¤ç”Ÿâ†’BOSSå…³',8,8,'-1,0,0,0,0,0,0,-1|-1,0,2,1,2,2,0,-1|-1,0,2,1,4,2,0,-1|0,0,0,1,1,4,0,0|0,1,4,1,1,4,1,0|0,1,0,4,0,0,1,0|0,1,1,1,3,1,1,0|0,0,0,0,0,0,0,0',0);


```

#### â‘¡C++ç»“æ„ä½“è®¾è®¡

```cpp
typedef struct _userinfo {
	//è¿™é‡Œå°†å­—ç¬¦ä¸²åˆå§‹ä¸ºç©º
	_userinfo() :id(0), username(""), password(""), level_id(0) {};
	int id;	// ç”¨æˆ·id
	string username;
	string password;	// å¯†ç 
	int level_id;
}userinfo;

typedef struct _levelinfo {
	_levelinfo() :id(0), name(""), map_row(0), map_column(0), map_data(""), next_level(0) {};
	int id;	// å…³å¡id
	string name;	// å…³å¡åå­—
	int map_row;	// åœ°å›¾è¡Œæ•°
	int map_column;	//åœ°å›¾åˆ—æ•°
	string map_data;	// äºŒç»´åœ°å›¾æ•°æ®
	int next_level;	//ä¸‹ä¸€å…³å¡id
}levelinfo;
```

### 2.ç”¨æˆ·ç™»å½• fetch\_user\_info( )

å®ç°ç”¨æˆ·ç™»å½•åŠŸèƒ½é¦–å…ˆæ˜¯è·å–ç”¨æˆ·è¾“å…¥çš„è´¦å·å’Œå¯†ç ï¼Œæ¥ç€åœ¨æ•°æ®åº“ä¸­è¿›è¡ŒæŸ¥æ‰¾ï¼Œå¦‚æœæ‰¾åˆ°åˆ™è¯»å–æ¸¸æˆè¿›åº¦ç„¶åè¿›å…¥æ¸¸æˆç•Œé¢ï¼Œå¦‚æœæ²¡æ‰¾åˆ°åˆ™æç¤ºç”¨æˆ·æ˜¯å¦æœ‰è¾“å…¥é”™è¯¯ã€‚

è·å–ç”¨æˆ·è¾“å…¥çš„è´¦å·å’Œå¯†ç å› ä¸ºç§ï¼ˆæœ¬ï¼‰ç§ï¼ˆäººï¼‰åŸï¼ˆè¾ƒï¼‰å› ï¼ˆæ‡’ï¼‰æ²¡æœ‰è®¾ç½®é¡µé¢ï¼Œè€Œæ˜¯åœ¨æ§åˆ¶å°ä¸­è¾“å…¥ï¼Œæ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥æ ¹æ®è‡ªå·±é£æ ¼è®¾è®¡é¡µé¢ã€‚åœ¨æ§åˆ¶å°ä¸­è¯»å–ç”¨æˆ·è¾“å…¥å†…å®¹è¿˜æ˜¯éå¸¸å®¹æ˜“å®ç°ï¼Œå…³é”®è¿˜æ˜¯åœ¨äºå’Œæ•°æ®åº“çš„æ“ä½œã€‚å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡MySQLè¿æ¥C++ä½¿ç”¨çš„åŒ–å…¶å®ä¹Ÿä¸ç”¨æƒŠæ…Œï¼Œå› ä¸ºå¾ˆå¤šè¯­æ³•éƒ½æ˜¯é«˜é‡å¤æ€§ï¼Œå­¦ä¼šä¸€äº›å…¶ä½™çš„åªéœ€è¦ï¼š

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_19,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/174449b4c0209d38a9dffc42734cdca3.jpeg)
â€‹

å°±å¯ä»¥äº†ã€‚

å½“æˆ‘ä»¬åœ¨MySQLä¸­å¯¹æ•°æ®æ“ä½œæ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦å¯åŠ¨MySQLï¼Œæ‰§è¡Œæ“ä½œï¼Œå…³é—­MySQLã€‚è€Œä¸C++è¿æ¥åè¿™äº›æ“ä½œåˆ™ä¼šç¨æœ‰æ”¹å˜ï¼Œåœ¨æ¯æ¬¡å•ä¸€æ“ä½œç»“æŸåæˆ‘ä»¬å°±è¦å»å…³é—­ä¸æ•°æ®åº“è¿æ¥ï¼Œä¾‹å¦‚æˆ‘æŸ¥æ‰¾æ‰¾å®Œç”¨æˆ·ä¿¡æ¯åæˆ‘å°±è¦å»å…³é—­æ•°æ®åº“è¿æ¥ï¼Œæ¥ç€æ˜¯è¯»å–å…³å¡ä¿¡æ¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦ç»§ç»­æ‰“å¼€æ•°æ®åº“ï¼Œè¯»å–å…³å¡ä¿¡æ¯ï¼Œç„¶åå…³é—­ã€‚

å› æ­¤æˆ‘ä»¬å¯ä»¥å…ˆå°†ä¸æ•°æ®åº“è¿æ¥åŠŸèƒ½å®ç°ï¼Œ
**è¿™é‡Œå¤§å®¶è®°å¾—å°†ç”¨æˆ·åå’Œå¯†ç æ”¹æˆè‡ªå·±çš„**

```cpp
#define DB_NAME	"box_man"    //æ•°æ®åº“å
#define DB_HOST	"127.0.0.1"    //IPåœ°å€
#define DB_PORT 3306            //ç«¯å£å·
#define DB_USER "root"           //ç”¨æˆ·å
#define DB_USER_PASSWORD "******"    //å¯†ç 



/******************************
 *åŠŸèƒ½ï¼šæ•°æ®åº“é“¾æ¥
 * è¾“å…¥ï¼š
 *		mysql - æ•°æ®åº“è®¿é—®å¥æŸ„
 *
 * è¿”å›å€¼ï¼š
 *		true - è¿æ¥æˆåŠŸ
 *		false - è¿æ¥å¤±è´¥
 *****************************/
bool connect_db(MYSQL& mysql) {
	//1.åˆå§‹æ•°æ®åº“å¥æŸ„
	mysql_init(&mysql);

	//2.è®¾ç½®å­—ç¬¦ç¼–ç ï¼ˆä¸ºå¥æŸ„è®¾ç½®ï¼‰
	//windowsæ”¯æŒä¸­æ–‡ï¼Œåœ¨windowsä¸Šä¸€èˆ¬æ˜¯gbkå­—ç¬¦é›†ï¼ŒgbkåŒ…å«ä¸­æ–‡ç®€ä½“å’Œç¹ä½“ï¼Œç®€ä½“æ˜¯gbk2312
	mysql_options(&mysql, MYSQL_SET_CHARSET_NAME, "gbk");

	//3.è¿æ¥æ•°æ®åº“
	//å¥æŸ„ï¼Œä¸»æœºï¼Œç”¨æˆ·åï¼Œå¯†ç ï¼Œæ•°æ®åº“ï¼Œç«¯å£å·ï¼Œâ€”â€”ï¼Œâ€”â€”
	if (mysql_real_connect(&mysql, DB_HOST, DB_USER, DB_USER_PASSWORD, DB_NAME, DB_PORT, NULL, 0) == NULL) {
		printf("æ•°æ®åº“è¿æ¥å¤±è´¥ï¼Œé”™è¯¯åŸå› ï¼š%s\n", mysql_error(&mysql));
		return false;
	}
	return true;
}

```

æ•°æ®åº“è¿æ¥åŠŸèƒ½å®ç°å¥½åæ¥ä¸‹æ¥å°±æ˜¯ä¼ å…¥ç”¨æˆ·è¾“å…¥çš„ä¿¡æ¯ï¼Œç¼–å†™SQLæŸ¥è¯¢è¯­å¥è¿›è¡ŒæŸ¥æ‰¾ã€‚æˆ‘å°†è¿™å¥—åŠ¨ä½œåˆ†æˆå››æ­¥ï¼Œè¿™å››æ­¥ä¹ŸåŸºæœ¬å¯ä»¥æ»¡è¶³å¹³æ—¶è®¾è®¡ç¨‹åºæ‰€éœ€

1.è¿æ¥æ•°æ®åº“

2.ç¼–å†™SQLè¯­å¥

3.è¿›è¡ŒæŸ¥æ‰¾æˆ–ä¿®æ”¹

4.è¿”å›æŸ¥è¯¢ç»“æœå¹¶å…³é—­æ•°æ®åº“

```cpp
/******************************
 *åŠŸèƒ½ï¼šé€šè¿‡ç”¨æˆ·åå’Œå¯†ç è·å–ç”¨æˆ·ä¿¡æ¯
 * è¾“å…¥ï¼š
 *		user - ç”¨æˆ·ä¿¡æ¯ç»“æ„ä½“
 *
 * è¿”å›å€¼ï¼š
 *		è·å–æˆåŠŸè¿”å›trueï¼Œå¤±è´¥false
 *****************************/
bool fetch_user_info(userinfo& user) {
	MYSQL mysql;	//å®šä¹‰ä¸€ä¸ªå¥æŸ„ï¼Œå¯¹mysqlçš„è®¿é—®éƒ½æ˜¯é€šè¿‡è¿™ä¸ªå¥æŸ„ï¼ˆå°±æ˜¯ä¸€ä¸ªé›†åˆï¼‰
	MYSQL_RES* res;		// æŸ¥è¯¢çš„ç»“æœé›†
	MYSQL_ROW row;		// å¦‚æœç»“æœé›†æœ‰å¤šæ¡ï¼Œå¯ä»¥ä½¿ç”¨rowè·å–
	char sql[256];
	bool ret = false;
	//1.è¿æ¥æ•°æ®åº“
	if (connect_db(mysql) == false) {
		return false;
	}
	//2.è®¾ç½®SQLæŸ¥è¯¢è¯­å¥
	//snprintfå‡½æ•°ï¼Œè®¾å°†å¯å˜å‚æ•°(...)æŒ‰ç…§ format æ ¼å¼åŒ–æˆå­—ç¬¦ä¸²ï¼Œå¹¶å°†å­—ç¬¦ä¸²å¤åˆ¶åˆ° str ä¸­ï¼Œsize ä¸ºè¦å†™å…¥çš„å­—ç¬¦çš„æœ€å¤§æ•°ç›®ï¼Œè¶…è¿‡ size ä¼šè¢«æˆªæ–­ã€‚
	snprintf(sql, 256, "select id,level_id from users where username='%s' and password = md5('%s');", user.username.c_str(), user.password.c_str());
	ret = mysql_query(&mysql, sql);	//mysqlæŸ¥è¯¢ï¼ŒæˆåŠŸè¿”å›0
	if (ret) {
		printf("æ•°æ®åº“æŸ¥è¯¢å‡ºé”™ï¼Œ%sé”™è¯¯åŸå› ï¼š%s\n", sql, mysql_error(&mysql));
		// å…³é—­æ•°æ®åº“
		mysql_close(&mysql);
		return false;
	}
	
	//3.è·å–æŸ¥åˆ°çš„ç»“æœ
	res = mysql_store_result(&mysql);
	//rowè·å¾—ç»“æœé›†é‡Œçš„ä¸€è¡Œè®°å½•ï¼Œå†é€šè¿‡ä¸‹æ ‡è®¿é—®è®°å½•é‡Œçš„æ•°æ®ï¼Œå¦‚æœç»“æœé›†æœ‰å¤šè¡Œæ—¶å¯ä»¥é€šè¿‡ while(row = mysql_fetch_row(res)){ }å¾ªç¯è·å¾—
	row = mysql_fetch_row(res);

	if (row == NULL) {	//æ²¡æœ‰æŸ¥åˆ°è®°å½•
		//1.é‡Šæ”¾ç»“æœé›†
		mysql_free_result(res);
		//1.å…³é—­æ•°æ®åº“
		mysql_close(&mysql);
		return false;
	}
	user.id = atoi(row[0]);	// å­—ç¬¦ä¸²è½¬æ•´æ•°
	user.level_id = atoi(row[1]);
	//4.è¿”å›ç»“æœ
	mysql_free_result(res);
	mysql_close(&mysql);
	return true;
}

```

### 3.è·å–å…³å¡ä¿¡æ¯

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/2558646d24c47e73cecaf43ca9df3e7d.png)
â€‹

åœ°å›¾æ•°æ®ä½¿ç”¨äºŒç»´æ•°ç»„è¡¨ç¤ºï¼Œå¯¹äºä¸åŒå›¾å½¢ç”¨ä¸åŒç¼–å·è¡¨ç¤º

åœ¨æ•°æ®åº“å½•å…¥ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸åŒæ•°å­—ä»£è¡¨ä¸åŒå›¾å½¢ï¼Œå¹¶ä¸”ä½¿ç”¨â€œ|â€ç¬¦å·ä½œä¸ºæ¯è¡Œçš„åˆ†éš”ç¬¦ï¼Œæˆ‘ä»¬åªéœ€æ ¹æ®è¯»å–åˆ°çš„ç”¨æˆ·ä¿¡æ¯ä¸­çš„æ¸¸æˆè¿›åº¦ï¼Œæ¥è·å¾—å¯¹åº”å…³å¡æ•°æ®å³å¯ã€‚

```cpp
/*********************************
 *åŠŸèƒ½ï¼šæ ¹æ®å…³å¡idè·å–å®Œæ•´çš„å…³å¡ä¿¡æ¯ï¼ˆå¦‚ï¼šåœ°å›¾ï¼Œä¸‹ä¸€å…³ç­‰ï¼‰
 * è¾“å…¥ï¼š
 *		level - ä¿å­˜å…³å¡ä¿¡æ¯çš„ç»“æ„ä½“
 *		level_id - è·å–å…³å¡id
 * è¿”å›å€¼ï¼š
 *		-1 - æ•°æ®åº“è¿æ¥æˆ–æŸ¥è¯¢å‡ºé”™
 *		0  - æŸ¥æ‰¾ç»“æœä¸ºç©º
 *		1 - æŸ¥æ‰¾æˆåŠŸ
 *********************************/
int fetch_level_info(levelinfo& level, int level_id) {
	MYSQL mysql;	//å®šä¹‰ä¸€ä¸ªå¥æŸ„ï¼Œå¯¹mysqlçš„è®¿é—®éƒ½æ˜¯é€šè¿‡è¿™ä¸ªå¥æŸ„ï¼ˆå°±æ˜¯ä¸€ä¸ªé›†åˆï¼‰
	MYSQL_RES* res;		// æŸ¥è¯¢çš„ç»“æœé›†
	MYSQL_ROW row;		// å¦‚æœç»“æœé›†æœ‰å¤šæ¡ï¼Œå¯ä»¥ä½¿ç”¨rowè·å–
	char sql[256];
	bool ret = false;
	//1.è¿æ¥æ•°æ®åº“
	if (connect_db(mysql) == false) {
		return -1;
	}
	//2.ç¼–å†™SQLè¯­å¥
	snprintf(sql, 256, "select name,map_row,  map_column,map_data,next_level_id from levels where id=%d;", level_id);
	ret = mysql_query(&mysql, sql);	//mysqlæŸ¥è¯¢ï¼ŒæˆåŠŸè¿”å›0
	if (ret) {
		printf("æ•°æ®åº“æŸ¥è¯¢å‡ºé”™ï¼Œ%sé”™è¯¯åŸå› ï¼š%s\n", sql, mysql_error(&mysql));
		// å…³é—­æ•°æ®åº“
		mysql_close(&mysql);
		return -1;
	}

	//3.è·å–æŸ¥åˆ°çš„ç»“æœ
	res = mysql_store_result(&mysql);
	//rowè·å¾—ç»“æœé›†é‡Œçš„ä¸€è¡Œè®°å½•ï¼Œå†é€šè¿‡ä¸‹æ ‡è®¿é—®è®°å½•é‡Œçš„æ•°æ®ï¼Œå¦‚æœç»“æœé›†æœ‰å¤šè¡Œæ—¶å¯ä»¥é€šè¿‡ while(row = mysql_fetch_row(res)){ }å¾ªç¯è·å¾—
	row = mysql_fetch_row(res);

	if (row == NULL) {	//æ²¡æœ‰æŸ¥åˆ°è®°å½•
		//1.é‡Šæ”¾ç»“æœé›†
		mysql_free_result(res);
		//1.å…³é—­æ•°æ®åº“
		mysql_close(&mysql);
		return 0;
	}
	level.id = level_id;
	level.name = row[0];
	level.map_row = atoi(row[1]);
	level.map_column = atoi(row[2]);
	level.map_data = row[3];
	level.next_level = atoi(row[4]);
	//stringç”¨printfè¾“å‡ºï¼Œä½¿ç”¨.c_str()å¯ä»¥è¿”å›ä¸€ä¸ªconst char* çš„æŒ‡é’ˆ
	//printf("level id: %d  name: %s map row: %d  map column: %d map data: %s next level: %d\n", level.id, level.name.c_str(), level.map_row, level.map_column, level.map_data.c_str(), level.next_level);
	
	//4.è¿”å›ç»“æœ
	mysql_free_result(res);
	mysql_close(&mysql);
	return 1;
}
```

### 4.åœ°å›¾è½¬æ¢

è·å¾—çš„å…³å¡æ•°æ®æ˜¯ç”±ç»“æ„ä½“å­˜å‚¨ï¼Œæˆ‘ä»¬éœ€è¦å°†åœ°å›¾ä¿¡æ¯è½¬ä¸ºäºŒç»´æ•°ç»„å­˜å‚¨ï¼Œä¹Ÿå°±æ˜¯å°†stringå­˜å‚¨çš„åœ°å›¾ä¿¡æ¯è½¬ä¸ºint map[ ][ ] å­˜å‚¨

```cpp
/******************************
 *åŠŸèƒ½ï¼šå°†è·å¾—çš„å…³å¡æ•°æ®è½¬æ¢åˆ°mapåœ°å›¾æ•°ç»„ä¸­
 * è¾“å…¥ï¼š
 *		level - å…³å¡æ•°æ®
 *		map - äºŒç»´åœ°å›¾æ•°ç»„
 *
 * è¿”å›å€¼ï¼š
 *		false - è½¬æ¢å¤±è´¥
 *		true - è½¬æ¢æˆåŠŸ
 *****************************/
bool transform_map_db2array(levelinfo& level, int map[][COLUMN]) {
	if (level.map_row > LINE || level.map_column > COLUMN) {
		printf("åœ°å›¾è¿‡å¤§ï¼Œè¯·é‡æ–°è®¾ç½®\n");
		return false;
	}
	if (level.map_data.length() < 1) {
		printf("åœ°å›¾æ•°æ®æœ‰è¯¯ï¼Œè¯·é‡æ–°è®¾ç½®ï¼\n");
		return false;
	}
	long long start = 0, end = 0;
	int row = 0, column = 0;
	do {
		/******************************
		 *findè¿”å›size_tç±»å‹å€¼ï¼Œsize_tåœ¨64ä½ä¸‹æ˜¯8å­—èŠ‚é•¿åº¦ï¼Œå› æ­¤è¿™é‡ŒæŠŠstartå’Œendè®¾ç½®æˆlong longç±»å‹ï¼ˆä¸è®¾ç½®ä¼šæœ‰â€œæ•°æ®ä¸¢å¤±â€è­¦å‘Šï¼‰ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ç®€å•ç²—æš´çš„ä¿®æ”¹è­¦å‘Šè®¾ç½®
		******************************/
		end = level.map_data.find('|', start);
		if (end == -1) {
			end = level.map_data.length();
		}
		//åˆæ³•æ€§æ£€æŸ¥ï¼Œç»“æŸæ—¶end=level.map_data.lengthï¼Œstart=end+1
		if (start >= end)
			break;
		string line = level.map_data.substr(start, end - start);
		//printf("get-lineï¼š%s\n", line.c_str());
		// å¯¹è¡Œæ•°æ®è¿›è¡Œè§£æï¼š0,1,0,1,1,1,1,1,1,1,0,0
		char* next_token = NULL;
		//lineè½¬ä¸ºconst char*ï¼ˆCè¯­è¨€ä¸­çš„å­—ç¬¦ä¸²ï¼‰ï¼Œstrtok_sä¼šä¿®æ”¹lineé‡Œçš„å€¼ï¼ŒæŒ‰ç…§æŸä¸ªç‰¹å®šå­—ç¬¦ï¼Œæ‰€ä»¥éœ€è¦å°†line.c_str()è½¬ä¸ºchar *
		// strtok_sç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦åŠˆå¼€çš„å­—ç¬¦ä¸²ï¼ˆè¦æ±‚æ˜¯ä¸€ä¸ªchar *ç±»å‹çš„ï¼‰ï¼›ç¬¬äºŒä¸ªå‚æ•°æ˜¯æŒ‰æŸä¸ªå­—ç¬¦åŠˆå¼€ï¼ˆä¼šæŠŠâ€œï¼Œâ€é€—å·å˜æˆâ€˜\0â€™ç»“æŸç¬¦ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼šä¿®æ”¹åŸæ¥å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥è¦æŠŠåŸæ¥çš„const char*è½¬ä¸ºchar*ï¼‰ï¼›ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯è¿™ä¸ªæ¥å£
		// éœ€è¦çš„ï¼Œç”¨æ¥åšå®šä½åŠŸèƒ½ï¼Œ
		//printf("%p\n", &line[2]);
		char* item = strtok_s((char*)line.c_str(), ",", &next_token);
		column = 0;
	    //printf("%p", next_token);
		//::system("pause");
		//å¦‚æœæŸè¡Œæ•°æ®ä¸ªæ•°å¤šä½™è¿™ä¸ªåœ°å›¾åˆ—æ•°ï¼Œæ§åˆ¶åªè¯»å–level.map_column-1ä¸ª
		while (item&&column<level.map_column) {
			map[row][column] = atoi(item);
			column++;
			//å†ä½¿ç”¨strtok_sæ¥å£ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥å†™NULLï¼Œåº”è¯¥æ˜¯next_tokenå‚æ•°ä¸Šä¸€æ¬¡åšå®šä½åŠŸèƒ½æ—¶å·²ç»è®°å½•äº†è¦åŠˆå¼€å­—ç¬¦ä¸²ç»™çš„æŸä¸ªä½ç½®
			item = strtok_s(NULL, ",", &next_token);
		}

		//åˆæ³•æ€§æ£€æŸ¥
		if (column < level.map_column) {	// æŸè¡Œçš„æ•°æ®ä¸ªæ•°å°äºè¿™ä¸ªåœ°å›¾çš„åˆ—æ•°
			printf("åœ°å›¾æ•°æ®è§£æå‡ºé”™ï¼Œç»ˆæ­¢ï¼\n");
			return false;
		}
		row++;

		//åˆ—æ•°å¤šä½™çš„è¯ç›´æ¥èˆå¼ƒ
		if (row >= level.map_row) {
			break;
		}
		start = end + 1;
	} while (1 == 1);
	//åˆ—æ•°å¤šä½™åˆ™ç›´æ¥æŠ¥é”™
	if (row < level.map_row) {
		printf("åœ°å›¾è¡Œæ•°å°‘äºè®¾å®šï¼Œç»ˆæ­¢ï¼");
		return false;
	}
	return true;
}
```

### 5.è·³è½¬ä¸‹ä¸€å…³

æ¯å½“ ç”¨æˆ·é€šå…³åï¼Œä¾¿æ›´æ–°ç”¨æˆ·çš„æ¸¸æˆè¿›åº¦ï¼Œå®ç°ä¸‹ä¸€å…³çš„è·³è½¬

```cpp
/******************************
 *åŠŸèƒ½ï¼šæ›´æ–°ç”¨æˆ·æ¸¸æˆè¿›åº¦ä¿¡æ¯
 * è¾“å…¥ï¼š
 *		user - ç”¨æˆ·ä¿¡æ¯
 *		next_level_id - æ¸¸æˆè¿›åº¦
 *
 * è¿”å›å€¼ï¼š
 *		è·å–æˆåŠŸè¿”å›trueï¼Œå¤±è´¥false
 *****************************/
bool update_user_level(userinfo& user, int next_level_id) {
	MYSQL mysql;	//å®šä¹‰ä¸€ä¸ªå¥æŸ„ï¼Œå¯¹mysqlçš„è®¿é—®éƒ½æ˜¯é€šè¿‡è¿™ä¸ªå¥æŸ„ï¼ˆå°±æ˜¯ä¸€ä¸ªé›†åˆï¼‰
	char sql[256];
	bool ret = false;
	//1.è¿æ¥æ•°æ®åº“
	if (connect_db(mysql) == false) {
		return false;
	}
	//2.ç¼–å†™SQLè¯­å¥
	snprintf(sql, 256, "update users set level_id=%d where id=%d", next_level_id, user.id);
	ret = mysql_query(&mysql, sql);

	if (ret) {
		printf("æ•°æ®åº“æ›´æ–°å‡ºé”™ï¼Œ%sé”™è¯¯åŸå› ï¼š%s\n", sql, mysql_error(&mysql));
		// å…³é—­æ•°æ®åº“
		mysql_close(&mysql);
		return false;
	}
	user.level_id = next_level_id;
	mysql_close(&mysql);
	return true;
}
```

## ä¸‰ã€ä¿®æ”¹æ¸¸æˆä»£ç é€‚åº”ä¸æ•°æ®åº“è¿æ¥

### 1.æå®šç”¨æˆ·ç™»å½•åŠŸèƒ½

æ•°æ®åº“è¿æ¥ç¨‹åºå†™å¥½åï¼Œä¸‹é¢å°±æ˜¯å¯¹æ¨ç®±å­æ¸¸æˆçš„ç¨‹åºå‡çº§ï¼Œé¦–å…ˆå‘¢å°±æ˜¯æ›´æ”¹æ¸¸æˆæ¡†æ¶ï¼Œåœ¨åˆå§‹åŒ–ç”»å¸ƒä¹‹å‰å°±æ˜¯å…ˆè®©ç”¨æˆ·ç™»å½•ï¼Œæˆ‘ä»¬è§„å…è®¸ç”¨æˆ·è¾“å…¥å¤±è´¥æ¬¡æ•°ï¼Œè‹¥è¾¾åˆ°æ¬¡æ•°é™åˆ¶ååˆ™å¼ºåˆ¶é€€å‡ºã€‚

```cpp
/*****************************
* åŠŸèƒ½ï¼šç”¨æˆ·ç™»å½•
* è¾“å…¥ï¼š
*		user - ç”¨æˆ·ä¿¡æ¯
* è¾“å‡ºï¼š
*		false - ç™»å½•å¤±è´¥
*		true - ç™»å½•æˆåŠŸ
*****************************/
bool login(userinfo& user) {
	int times = 0;
	bool ret = false;
	do {
		cout << "è¯·è¾“å…¥ç”¨æˆ·åï¼š";
		cin >> user.username;
		cout << "è¯·è¾“å…¥å¯†ç ï¼š";
		cin >> user.password;
		ret = fetch_user_info(user);
		times++;
		if (times >= MAX_RETRY_TIMES)
			break;
		if (ret == false) {
			cout << "ç™»å½•å¤±è´¥ï¼Œè¯·é‡æ–°è¾“å…¥ï¼" << endl;
		}
	} while (!ret);
	return ret;
}
```

### 2.å¯¹ç”¨æˆ·çš„æ¸¸æˆè¿›åº¦åšå‡ºåˆ¤æ–­

ç”¨æˆ·ç™»å½•æˆåŠŸåå°±è¦å¯¹ç”¨æˆ·çš„æ¸¸æˆè¿›åº¦åšå‡ºåˆ¤æ–­ï¼Œå¦‚æœè¿”å›-1ï¼Œåˆ™ä»£è¡¨æ•°æ®åº“æŸ¥è¯¢ä¸­å¤±è´¥äº†ï¼Œæ­¤æ—¶å°±è¦å¼ºåˆ¶é€€å‡ºç¨‹åºï¼›å¦‚æœè¿”å›0ï¼Œåˆ™ä»£è¡¨ç”¨æˆ·å·²é€šå…³ï¼Œæ­¤æ—¶å°±è¦æ˜¯è¦é‡æ–°å¼€å§‹è¿˜æ˜¯è¦é€€å‡ºï¼›å¦‚æœè¿”å›1ï¼Œåˆ™ä»£è¡¨æŸ¥è¯¢æˆåŠŸï¼Œè¿›å…¥æ¸¸æˆé¡µé¢ã€‚

å¯¹äºè¿”å›-1æˆ–è€…0éœ€è¦å•ç‹¬å¤„ç†

```cpp
/*****************************
* åŠŸèƒ½ï¼šæ ¹æ®â€œç”±ç”¨æˆ·IDè·å–å…³å¡æ•°æ®â€çš„è¿”å›ç»“æœè¿›è¡Œåˆ¤æ–­
* è¾“å…¥ï¼š
*		result - è¿”å›ç»“æœï¼ˆ-1ï¼šè·å–å¤±è´¥  0ï¼šç”¨æˆ·å·²é€šå…³  1ï¼šè·å–æˆåŠŸï¼‰
*		level - å…³å¡æ•°æ®
*		user - ç”¨æˆ·ä¿¡æ¯
* è¾“å‡ºï¼š
*		æ— 
*****************************/
void judge_by_result(int result, levelinfo& level, userinfo& user) {
	if (result == 1) {
		return;
	}
	else if (result == -1) {
		closegraph();
		cout << "è·å–å…³å¡æ•°æ®å¤±è´¥ï¼Œè¯·é‡è¯•ï¼" << endl;
		std::system("pause");
		exit(-1);
	}
	else if (result == 0) {
		show_over();
		do {
			//åˆ¤æ–­æ˜¯å¦æœ‰æŒ‰é”®æŒ‰ä¸‹
			if (_kbhit()) {
				//æ— ç¼“å†²è¯»å–
				char ch = _getch();
				if (ch == KEY_OUT) {
					closegraph();
					exit(0);
				}
				else if (ch == GAME_AGAIN) {
					if (!update_user_level(user,1)) {
						std::system("pause");
						closegraph();
						exit(0);
					}
					break;
				}
			}
			Sleep(50);
		} while (1);
		fetch_level_info(level, user.level_id);
	}
}
```

è¯»å– ç”¨æˆ·è¿›åº¦åï¼Œæ¥ä¸‹æ¥ä¾¿æ˜¯è°ƒç”¨åœ°å›¾ä¿¡æ¯è½¬æ¢åŠŸèƒ½ï¼Œå°†åœ°å›¾ä¿¡æ¯è½¬æ¢åˆ°äºŒç»´æ•°ç»„ä¸­ï¼Œåˆ°è¿™é‡Œå¯¹ç¨‹åºçš„å‡çº§å·¥ä½œä¹Ÿç®—æ˜¯å¤§åŠŸå‘Šæˆäº†ã€‚

## **å››ã€ç¨‹åºæ‰“åŒ…å‘å¸ƒ**

å°†æ¨ç®±å­æ¸¸æˆè¿æ¥æ•°æ®åº“ä¹‹åä¹Ÿç®—æ˜¯ç»™æ¸¸æˆå‡äº†ä¸€ä¸ªé€¼æ ¼ï¼Œä½†å½“æˆ‘ä»¬æ¯æ¬¡æƒ³ç©çš„æ—¶å€™è¿˜è¦å»æ‰“å¼€ç¼–è¯‘å™¨ï¼Œç”šè‡³æƒ³å‘ç»™è‡ªå·±çš„æœ‹å‹éƒ½ä¸è¡Œï¼Œéš¾é“è¿˜è¦è®©åˆ«äººä¸‹è½½ä¸€ä¸ªç¼–è¯‘å™¨è¿˜ä¸æˆã€‚å› æ­¤ï¼Œè¿™é‡Œä¸ºå¤§å®¶å¸¦æ¥ä¸€ç§ç¨‹åºæ‰“åŒ…æ–¹æ³•ï¼Œè®©ä½ çš„é¡¹ç›®ä¹Ÿå¯ä»¥åƒè½¯ä»¶å®‰è£…ä¸€æ ·ç›´æ¥å®‰è£…è¿è¡Œ

![b9c6fe35a84c48e1a1ac607602b1551a.gif](https://i-blog.csdnimg.cn/blog_migrate/958b3ac13e1085f66e499cee36113a8e.gif)
â€‹

### 1.ä¸‹è½½ç¨‹åºæ‰“åŒ…ç»„ä»¶

[VS 2022ç¨‹åºæ‰“åŒ…ç»„ä»¶](https://marketplace.visualstudio.com/items?itemName=VisualStudioClient.MicrosoftVisualStudio2017InstallerProjects "VS 2022ç¨‹åºæ‰“åŒ…ç»„ä»¶")

[VS 2017-2019ç¨‹åºæ‰“åŒ…ç»„ä»¶](https://marketplace.visualstudio.com/items?itemName=VisualStudioClient.MicrosoftVisualStudio2017InstallerProjects "VS 2017-2019ç¨‹åºæ‰“åŒ…ç»„ä»¶")

ä¸‹è½½å¥½çš„ç»„ä»¶ç›´æ¥æ‰“å¼€å®‰è£…

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/652ff218d61687b4702e94282e4923be.png)
â€‹

### 2.è®¾ç½®VSç¼–è¯‘å™¨

1ï¼‰è®¾ç½®ä¸ºreleaseæ¨¡å¼ï¼Œå¹¶æŠŠç›¸å…³çš„è®¾ç½®ä¹Ÿé‡æ–°é…ç½®ï¼ˆsdlæ£€æŸ¥ã€å­—ç¬¦é›†ç­‰ç­‰ï¼‰

2ï¼‰æŠŠé¡¹ç›®å±æ€§ä¸­çš„è¿è¡Œåº“ï¼Œæ›´æ”¹ä¸ºâ€œå¤šçº¿ç¨‹(/MT)â€

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/beb13dbf7352ad54662aa2a6ffc6357f.png)
â€‹

### 3.åœ¨åŒä¸€è§£å†³æ–¹æ¡ˆä¸‹åˆ›å»ºSetupé¡¹ç›®

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/e179acf277f0211c167568379e719572.png)
â€‹

### **4.æ·»åŠ é¡¹ç›®æ–‡ä»¶åˆ°Setupé¡¹ç›®ä¸­**

**è¿™é‡Œæ¼”ç¤ºæˆ‘çš„æ¨ç®±å­é¡¹ç›®**

**è¿™é‡Œå°†æ¼”ç¤ºä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯ç¨‹åºéœ€è¦çš„ç´ ææ–‡ä»¶ä¸ç¨‹åºæ–‡ä»¶åœ¨åŒä¸€ç›®å½•ä¸‹ï¼Œå¦ä¸€ç§æ˜¯ç´ ææ–‡ä»¶åœ¨äºŒçº§ç›®å½•ä¸‹**

**ç¬¬ä¸€ç§æƒ…å†µ**

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/bf76e53d9e8d28f4d02937685378a8a1.png)
â€‹

åœ¨åº”ç”¨ç¨‹åºæ–‡ä»¶å¤¹ï¼ˆApplication Folder)ä¸­æ·»åŠ é¡¹ç›®è·¯å¾„

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/219329a9a6ce5d67404e1e9dc0645344.png)
â€‹ å› ä¸ºæˆ‘çš„å›¾ç‰‡å’Œè¿è¡Œç¨‹åºåœ¨åŒä¸€ç›®å½•ä¸‹ï¼Œæ‰€ä»¥è¿™é‡Œæ·»åŠ æ–‡ä»¶æ˜¯è¦å…¨éƒ¨åŒ…æ‹¬

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/e0e3ab80883256faa1fbbdfec31c0d8b.png)
â€‹

---

**ç¬¬äºŒç§æƒ…å†µ**

å¦‚æœè¿è¡Œç¨‹åºå’Œå›¾ç‰‡ä¸åœ¨åŒä¸€çº§ç›®å½•æ—¶

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/2847c9fb5c47e08756d99dd261e69603.png)
â€‹

åœ¨åº”ç”¨ç¨‹åºæ–‡ä»¶å¤¹ï¼ˆApplication Folder)ä¸­å…ˆå°†å…¨éƒ¨ç¨‹åºæ–‡ä»¶æ·»åŠ è¿›æ¥

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/c4ad4447169914f42b5b6dfa97648bb3.png)
â€‹

åœ¨ åº”ç”¨ç¨‹åºæ–‡ä»¶å¤¹ï¼ˆApplication Folder) åˆ›å»ºä¸€ä¸ªå­æ–‡ä»¶å¤¹

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/ed5917e93df4441a33cb02bd782f839f.png)
â€‹

å°†å­æ–‡ä»¶å¤¹é‡å‘½åï¼Œå¹¶å°†å…¨éƒ¨å›¾ç‰‡æ·»åŠ è¿›æ¥

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/71f05f9e1cad2aae682c6268279dc968.png)
â€‹

æ·»åŠ å¥½ååœ¨ç¨‹åºæ–‡ä»¶å¤¹é‡Œä¾¿æ˜¯æ‰€æœ‰çš„ç¨‹åºæ–‡ä»¶å’Œä¸€ä¸ªimagesæ–‡ä»¶ï¼Œåœ¨imagesæ–‡ä»¶ä¸­æ˜¯å…¨éƒ¨çš„å›¾ç‰‡æ–‡ä»¶

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/2149816201711251019821d6b1186e44.png)
â€‹

**å¦‚æœåœ¨imagseè¿˜æœ‰å­æ–‡ä»¶å¤¹ï¼Œåˆ™éœ€è¦æŒ‰ä¸Šé¢æ­¥éª¤ç»§ç»­æ·»åŠ åŒçº§æ–‡ä»¶å¤¹æˆ–åˆ™å­æ–‡ä»¶å¤¹å³å¯**

### 5.æ·»åŠ é¡¹ç›®è¾“å‡º

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/281a381c02321dcbe14faf2b2194d1f4.png)
â€‹

é€‰æ‹©â€œä¸»è¾“å‡ºâ€åç‚¹å‡»ç¡®å®šï¼Œåœ¨å·²å¯¼å…¥çš„æ–‡ä»¶ç›®å½•é‡Œå°±ä¼šå¤šäº†ä¸€ä¸ªä¸»è¾“å‡º

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/3e950673e4523bfc305b8c0ba8d087a7.png)
â€‹

å³é”®å•å‡»ä¸»è¾“å‡ºï¼Œåˆ›å»ºå¿«æ·æ–¹å¼ï¼Œå¯ä»¥ç»™å¿«æ·æ–¹å¼æ”¹ä¸€ä¸ªæƒ³è¦çš„åå­—ï¼ˆæœ€ç»ˆç¨‹åºå®‰è£…æ—¶åå­—ä¾¿ä¼šä»¥è¿™ä¸ªåå­—ä¸ºå‡†ï¼‰ã€‚

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/bab562f9f441e4ff59eaedacefce0da1.png)
â€‹

### 6.å°†å¿«æ·æ–¹å¼æ”¾å…¥ç”¨æˆ·æ¡Œé¢ä¸­

æˆªåˆ‡å¿«æ·æ–¹å¼ï¼Œåˆ°ç”¨æˆ·æ¡Œé¢ï¼ˆUser's Desktopï¼‰ä¸­

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/8f0764e237477f66109e15d135179692.png)
â€‹ å¦‚ä¸‹æ•ˆæœ

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/42768dccfe3731c96d4f251a1a44e87d.png)
â€‹

### 7.ä¸ºç¨‹åºé€‰æ‹©ä¸€ä¸ªå›¾æ ‡

æ‰¾ä¸€å¼ æ­£æ–¹å½¢å›¾ç‰‡ï¼Œä¾‹å¦‚æˆ‘çš„æ¨ç®±å­æ¸¸æˆçš„å›¾æ ‡ä¸º

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_11,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/fb236c06864016f927bcf7a84b5afb19.png)
â€‹

å°†é€‰æ‹©çš„å›¾ç‰‡è½¬ä¸ºicoå›¾æ ‡ï¼Œè¿™é‡Œç»™å¤§å®¶æä¾›ä¸€ä¸ª
[icoå›¾æ ‡åœ¨çº¿åˆ¶ä½œ](https://www.bitbug.net/ "icoå›¾æ ‡åœ¨çº¿åˆ¶ä½œ")

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/f0621dc5b0a626c7d56a79bfc9bb2bb2.png)
â€‹

### 8.å°†å›¾æ ‡ä¸å¿«æ·æ–¹å¼ç»‘å®š

å°†å›¾æ ‡æ”¾å…¥åº”ç”¨ç¨‹åºæ–‡ä»¶å¤¹ï¼ˆApplication Folder)ä¸­

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/f5e8bc7a8ca8e0cbd7c3862e79b785f0.png)
â€‹

å³å‡»å¿«æ·æ–¹å¼ï¼Œé€‰æ‹©å±æ€§çª—å£ï¼Œåœ¨iconä¸­æµè§ˆåˆ°åˆšæ‰æ·»åŠ çš„å›¾æ ‡ï¼Œä¸€ç›´ç‚¹å‡»OK

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/b4131b30b266cee94388d8a741b3f6e9.png)
â€‹

é€‰æ‹©å®‰è£…é¡¹ç›®ï¼Œå³å‡»é€‰æ‹©â€œé‡æ–°ç”Ÿæˆâ€

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/682121d8dc206a992eaa2264270e9877.png)
â€‹

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/35e567765e22a8e1dba1b0a868b46b23.png)
â€‹

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/62ddcb90280bac7a35a5d9617c183486.png)
â€‹

å®‰è£…ç¨‹åºå¹¶è¿è¡Œ

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/dd4bdbc10bfea4f4c42f37aab62b8ce1.png)
â€‹

![watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Zy46YGT5bCP5piO,size_20,color_FFFFFF,t_70,g_se,x_16](https://i-blog.csdnimg.cn/blog_migrate/ad5f4b31beec46382832c9b26be553fd.png)
â€‹

è¿è¡Œç»“æœç®€ç›´å°±æ˜¯ä¸‰ä¸ªå­—ï¼šæ£’æ£’æ£’ï¼ï¼ï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§

![575aa5c86ff04c5c8b2b0ef5ca04a4db.gif](https://i-blog.csdnimg.cn/blog_migrate/930843dff3fc15946e8319804326a4bd.gif)
â€‹

## äº”ã€ä¸è¶³ä¹‹å¤„

1. æ¸¸æˆæœªè®¾è®¡æ³¨å†ŒåŠŸèƒ½ï¼Œç™»å½•é¡µé¢è¿‡äºç®€å•
2. ä½¿ç”¨çš„æ˜¯æœ¬åœ°æ•°æ®åº“ï¼Œäº‘ç«¯æœåŠ¡å™¨ä¼šæ›´å¥½ä¸€ç‚¹
3. å…³å¡é‡è¾ƒå°‘

å¦‚æœè§‰å¾—æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹ä¸ªèµæ”¯æŒä¸€ä¸‹å§

![38d94eb7c8c14d3488e81977cfd8ae2b.png](https://i-blog.csdnimg.cn/blog_migrate/05ac6d49385459bd54fbca111196c790.jpeg)