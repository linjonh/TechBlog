---
layout: post
title: "Java调用Cdll全过程"
date: 2022-10-21 14:59:25 +0800
description: "Java调用C#dll全过程Java调用默认邮件程序(Windows live ma"
keywords: "java调用c# dll"
categories: ['Java']
tags: ['组件注册', 'Java', 'Java', 'Com', 'C']
artid: "9943435"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=9943435
    alt: "Java调用Cdll全过程"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=9943435
featuredImagePreview: https://bing.ee123.net/img/rand?artid=9943435
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Java调用C#dll全过程
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     <strong>
      <span style="font-size:18px">
       <br/>
      </span>
     </strong>
    </p>
    <p>
     <strong>
      <span style="font-size:18px">
       Java调用C#dll全过程
       <br/>
      </span>
     </strong>
    </p>
    <p>
     <strong>
      <span style="font-size:18px">
       <span style="font-family:'Microsoft YaHei'; font-size:14px">
        Java调用默认邮件程序(Windows live mail &amp; IBM Lotus)的同时加上附件
       </span>
       <br/>
      </span>
     </strong>
    </p>
    <p>
     <strong>
      <span style="font-size:18px">
       目录
      </span>
     </strong>
     ——看目录者，原地满血满蓝复活！
    </p>
    <p>
     <span style="font-size:14px">
      1.吐槽Java
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      2.实现的功能描述及概述
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      3.Java调用C# dll 步骤
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      4.总结
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      --------------------------------------------------
      <span style="font-size:14px">
       --------------
      </span>
      -------------------分割线------------------------------
      <span style="font-size:14px">
       ---------------
      </span>
      -------------------------------------------
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      <br/>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      写在前面：着急找Java调用C#步骤的，请无视其他部分，直接跳到Part 3
     </span>
    </p>
    <p>
     <br/>
    </p>
    <p>
     <span style="font-size:14px">
      -------------------------------------------------------
      <span style="font-size:14px">
       --------------
      </span>
      ------------
      <span style="font-size:14px">
       1.吐槽Java
      </span>
      -----------------------
      <span style="font-size:14px">
       --------------
      </span>
      -----------------------------------------------
     </span>
     <br/>
    </p>
    <p>
     <span style="font-size:14px">
      1.吐槽Java
     </span>
     <br/>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      为了实现一个Java调用默认邮件程序(Windows live mail &amp; IBM Lotus)的同时加上附件的简单功能,查了一个星期的百度 google。尝试使用Java调用C++实现,无奈C++不懂,找别人写的代码说要用MFC才能实现，Java调用win32 dll还好，调用MFC是一团麻。终于在codeproject网下载C#&amp;VB可以实现调用默认邮件程序加附件的功能，问题又来了，Java调用C#步骤有点复杂，调用成功后还要在客户机注册。尝试过使用Java.awt.desktop mail(URI uri)方法实现，不能添加附件；Javamail  是后台写邮件，不符合需求；使用开源项目JDIC调用，JDIC对browser支持还好，对email程序，不支持。经过了这些，发现Java对桌面应用的支持很差，也没有开源项目研究Java调用桌面应用的插件（有个JDIC，08年就不更新了）。所以，如果想用Java调用桌面应用的话，你会发现是一件很痛苦的事情，你需要使用JNI或者JNA调用C/C++/C#写的DLL，间接实现，还要考虑兼容等问题。目前看来，Java的定位是web服务器端应用开发，对桌面应用的支持已经不做关心了,要操作桌面应用还是用C++/C#实现吧。
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      <br/>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      <br/>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      <br/>
      <span style="font-size:14px">
       ---------------------------------------------
      </span>
      <span style="font-size:14px">
       ----------
      </span>
      <span style="font-size:14px">
       -----------2
      </span>
      <span style="font-size:14px">
       .
       <span style="font-size:14px">
        实现的功能描述及概述
       </span>
      </span>
      <span style="font-size:14px">
       -----------------------
      </span>
      <span style="font-size:14px">
       --------------
      </span>
      <span style="font-size:14px">
       ------------------------------------------
      </span>
      <br/>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      <span style="font-family:Microsoft YaHei">
       <span style="font-size:14px">
        2
       </span>
       <span style="font-size:14px">
        .实现的功能描述及概述
       </span>
       <br/>
      </span>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      <span style="font-family:Microsoft YaHei">
       实现的功能：Java调用默认邮件程序
       <span style="font-size:14px">
        (Windows live mail &amp; IBM Lotus)
       </span>
       发邮件，同时添加附件。
       <br/>
      </span>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      <span style="font-family:Microsoft YaHei">
       概述：查了很多网站，内容就不copy过来了，有参考资料的地方就给链接。可能会有些小标题，请自行研究。
      </span>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      <span style="font-family:Microsoft YaHei">
       关于java为何不能直接调用C#DLL(引用别人写的一句话)：
      </span>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
     </span>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei">
      <span style="color:#454545; background:white">
       C#
      </span>
      <span style="color:#454545; background:white">
       的
      </span>
      <span style="color:#454545; background:white">
       COM
      </span>
      <span style="color:#454545; background:white">
       组件是一个
      </span>
      <span style="color:#454545; background:white">
       DLL
      </span>
      <span style="color:#454545; background:white">
       形式的文件，那么能不能像其他
      </span>
      <span style="color:#454545; background:white">
       DLL
      </span>
      <span style="color:#454545; background:white">
       一样如系统
      </span>
      <span style="color:#454545; background:white">
       kernel32.dll
      </span>
      <span style="color:#454545; background:white">
       直接在
      </span>
      <span style="color:#454545; background:white">
       C
      </span>
      <span style="color:#454545; background:white">
       代码（或
      </span>
      <span style="color:#454545; background:white">
       C++
      </span>
      <span style="color:#454545; background:white">
       代码）中使用呢？也就是不通过
      </span>
      <span style="color:#454545; background:white">
       COM
      </span>
      <span style="color:#454545; background:white">
       的封装而是直接使用。这样做是行不通的。因为
      </span>
      <span style="color:#454545; background:white">
       C#
      </span>
      <span style="color:#454545; background:white">
       的类库必然是托管类库，虽然文件扩展名也是
      </span>
      <span style="color:#454545; background:white">
       DLL
      </span>
      <span style="color:#454545; background:white">
       ，但它不是一种传统意义上的
      </span>
      <span style="color:#454545; background:white">
       DLL
      </span>
      <span style="color:#454545; background:white">
       ，例如没有输出表，所以得经过
      </span>
      <span style="color:#454545; background:white">
       COM
      </span>
      <span style="color:#454545; background:white">
       封装才能给非托管代码使用。至于托管代码使用托管
      </span>
      <span style="color:#454545; background:white">
       DLL
      </span>
      <span style="color:#454545; background:white">
       如
      </span>
      <span style="color:#454545; background:white">
       C#
      </span>
      <span style="color:#454545; background:white">
       调用
      </span>
      <span style="color:#454545; background:white">
       C#
      </span>
      <span style="color:#454545; background:white">
       写的类库那就没必要经过
      </span>
      <span style="color:#454545; background:white">
       COM
      </span>
      <span style="color:#454545; background:white">
       的封装了。
      </span>
     </span>
    </p>
    <br/>
    <p>
     <span style="font-size:14px">
      <br/>
     </span>
    </p>
    <p>
     <br/>
    </p>
    <p>
     <span style="font-size:14px">
      <span style="font-size:14px">
       ---------------------------------------------
      </span>
      <span style="font-size:14px">
       -------------
      </span>
      <span style="font-size:14px">
       -----------
      </span>
      <span style="font-size:14px">
       3.Java调用C# dll 步骤
      </span>
      <span style="font-size:14px">
      </span>
      <span style="font-size:14px">
       -----------------------
      </span>
      <span style="font-size:14px">
       --------------
      </span>
      <span style="font-size:14px">
       --------------------------------------------
      </span>
      <br/>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      <br/>
     </span>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      Step 1：
     </span>
    </p>
    <h2 style="margin:0px; padding:0px; list-style:none; width:410px; height:30px; overflow:hidden; line-height:30px; white-space:nowrap; text-overflow:ellipsis; color:rgb(51,51,51)" title="Java调用C#com方法">
     <span style="font-weight:normal">
      <span style="font-family:Microsoft YaHei; font-size:14px">
       Java调用C#com方法
      </span>
     </span>
    </h2>
    <span style="font-family:Microsoft YaHei; font-size:14px">
     http://download.csdn.net/detail/truelove12358/5923893
    </span>
    <p>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      或 http://wenku.baidu.com/view/1a2551639b6648d7c1c746f9.html
      <br/>
     </span>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      这里要说的是：按照步骤来就没问题。可能遇到的问题com注册的问题，Visual Studio Command Prompt 命令行在
      <span style="font-size:14px">
       Visual Studio 2010》
      </span>
      tools》
      <span style="font-size:14px">
       Visual Studio Command Prompt 。执行gacutil -i 或regasm命令时 dll路径请写绝对路径，如果路径中有空格请用双引号引起来。
      </span>
     </span>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      用VS2010，先对着文章里面的代码copy过去做个Demo调试出来。
     </span>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      推荐使用JNA，因为JNA一直在更新。
     </span>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      如果JNA调用C++ dll 出问题的，同样请先参照资料写个JNA   Helloworld
     </span>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      http://songwensheng.iteye.com/blog/675270
      <br/>
     </span>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      JNA官网 https://github.com/twall/jna
     </span>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      <br/>
     </span>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      Step 2：需要什么接口模仿Demo的写法自行改代码，再次按照Step 1里的资料做成自己要的东西。
     </span>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      <br/>
     </span>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      这里公布下C#&amp;VB调用默认邮件程序同时加附件的源码地址：
     </span>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      http://download.csdn.net/detail/truelove12358/5923861
      <br/>
     </span>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei">
      <span style="font-size:14px">
       或
      </span>
      <span style="font-size:14px">
       http://www.codeproject.com/Articles/17561/Programmatically-adding-attachments-to-emails-in-C
      </span>
     </span>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      获取源码后请读Step 2
     </span>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      <br/>
     </span>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      Step 3:对于C#非纯正dll的在客户机上的注册
     </span>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      <span style="font-size:14px">
       如果以上两步都做好了，不要兴奋的太早了，
       <span style="font-size:14px">
        对于C#非纯正dll的在客户机上的注册
       </span>
       <span style="font-size:14px">
        还是个问题。
       </span>
      </span>
      <br/>
     </span>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      如果你已经按照Step 1中的资料做了一遍了，你会发现需要用
      <span style="font-size:14px">
       Visual Studio Command Prompt 进行
      </span>
     </span>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      <span style="font-size:14px">
       <span style="font-size:14px">
        gacutil -i 和regasm命令注册com组件。
       </span>
       <br/>
      </span>
     </span>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei">
      <span style="font-size:14px">
       <span style="font-size:14px">
        <span style="font-size:14px">
         对于GAC
        </span>
       </span>
      </span>
      <span style="font-size:14px">
       全局程序集缓存 喜欢历史的请看这里
      </span>
     </span>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      <span style="font-size:14px">
      </span>
     </span>
    </p>
    <p>
     <span style="color:#333333; background:whitesmoke">
      <a href="http://blog.csdn.net/ghj1976/article/details/5529745" rel="noopener noreferrer" target="_blank">
       http://blog.csdn.net/ghj1976/article/details/5529745
      </a>
     </span>
    </p>
    目前NetFrameWork4.5的注册方式
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      <span style="font-size:14px">
       http://msdn.microsoft.com/zh-CN/library/yf1d93sz.aspx
      </span>
     </span>
    </p>
    <p>
    </p>
    <p style="color:rgb(42,42,42); margin-top:0px; margin-bottom:0px; padding-bottom:15px; line-height:18px; font-size:13px">
     <span class="sentence" id="mt9">
      <span style="font-family:Microsoft YaHei">
       有两种方法可以将程序集部署到全局程序集缓存中：
      </span>
     </span>
    </p>
    <ul style="font-size:13px; line-height:17px">
     <li style="">
      <p style="color:rgb(42,42,42); margin-top:0px; margin-bottom:0px; padding-bottom:15px; line-height:18px">
       <span style="font-family:Microsoft YaHei">
        <span class="sentence" id="mt10">
         使用专用于全局程序集缓存的安装程序。
        </span>
        <span class="sentence" id="mt11">
         该方法是将程序集安装到全局程序集缓存的首选方法。
        </span>
       </span>
      </p>
     </li>
     <li style="">
      <p style="color:rgb(42,42,42); margin-top:0px; margin-bottom:0px; padding-bottom:15px; line-height:18px">
       <span class="sentence" id="mt12">
        <span style="font-family:Microsoft YaHei">
         使用 Windows 软件开发包 (SDK) 提供的名为
         <a href="http://msdn.microsoft.com/zh-CN/library/ex0ss12c.aspx" rel="nofollow noopener noreferrer" style="text-decoration:none; color:rgb(3,105,122)" target="_blank">
          全局程序集缓存工具 (Gacutil.exe)
         </a>
         的开发工具。
        </span>
       </span>
      </p>
     </li>
    </ul>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
     </span>
    </p>
    <p>
     C# COM 组件添加到GAV(全局程序集缓存)  +
     <span style="color:#333333; background:whitesmoke">
      注册
     </span>
     <span style="color:#333333; background:whitesmoke">
      ——正解在此
     </span>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      <span style="background-color:rgb(245,245,245)">
       Stepone:GAV   path:
      </span>
      <span style="background-color:rgb(245,245,245)">
       C:\Program Files\MicrosoftSDKs\Windows\v7.0A\bin
      </span>
     </span>
    </p>
    <p align="left">
     <span style="font-family:Microsoft YaHei; font-size:14px">
      <span style="background-color:silver">
       如果我们需要用
      </span>
      <span style="background-color:silver">
       gacutil
      </span>
      <span style="background-color:silver">
       去注册
      </span>
      <span style="background-color:silver">
       dll
      </span>
      <span style="background-color:silver">
       ，就需要使用
      </span>
      <span style="background-color:silver">
       VisualStudio
      </span>
      <span style="background-color:silver">
       的
      </span>
      <span style="background-color:silver">
       CommandPrompt,
      </span>
      <span style="background-color:silver">
       前提是需要安装
      </span>
      <span style="background-color:silver">
       VisualStudio
      </span>
      <span style="background-color:silver">
       ，但是客户端上一般是没有安装
      </span>
      <span style="background-color:silver">
       VS
      </span>
      <span style="background-color:silver">
       的，所以你就需要将
      </span>
      <span style="background-color:silver">
       gacutil
      </span>
      <span style="background-color:silver">
       的文件夹拷贝到部署的客户机上。在
      </span>
      <span style="background-color:silver">
       C
      </span>
      <span style="background-color:silver">
       盘搜索
      </span>
      <span style="background-color:silver">
       gacutil.exe
      </span>
      <span style="background-color:silver">
       ，我们会搜索到三个文件，其中有一个是正确的，路径如下：
      </span>
     </span>
    </p>
    <div style="background:white">
     <p align="left">
      <span style="font-family:Microsoft YaHei; font-size:14px">
       <span style="background-color:silver">
        1.
       </span>
       C:\Program Files\Microsoft SDKs\Windows\v7.0A\bin\NETFX 4.0 Tools
      </span>
     </p>
    </div>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      <span style="background-color:silver">
       （这是
      </span>
      <span style="background-color:silver">
       WIN7
      </span>
      <span style="background-color:silver">
       ，
      </span>
      <span style="background-color:silver">
       VS2010
      </span>
      <span style="background-color:silver">
       环境下）。里面就有
      </span>
      <span style="background-color:silver">
       gacutil.exe
      </span>
      <span style="background-color:silver">
       。
      </span>
     </span>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      <span style="background-color:rgb(245,245,245)">
       Steptwo:
      </span>
      <span style="background-color:rgb(188,211,229)">
       regasm
      </span>
      <span style="background-color:rgb(188,211,229)">
       注册
      </span>
     </span>
    </p>
    <p>
     <span style="background-color:rgb(188,211,229)">
      <span style="font-family:Microsoft YaHei; font-size:14px">
       Regasm myDll.dll
      </span>
     </span>
    </p>
    <span style="font-size:14px">
     令附两个文件下载地址：
    </span>
    <p>
     <span style="font-size:14px">
      http://download.csdn.net/detail/truelove12358/5923843
      <br/>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      http://download.csdn.net/detail/truelove12358/5923821
      <br/>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      <span style="font-size:14px">
       ---------------------------------------------
      </span>
      <span style="font-size:14px">
       -------------------------------------
      </span>
      <span style="font-size:14px">
       -----------
      </span>
      <span style="font-size:14px">
       <span style="font-size:14px">
        4.总结
       </span>
      </span>
      <span style="font-size:14px">
       -----------------------
      </span>
      <span style="font-size:14px">
       --------------
      </span>
      <span style="font-size:14px">
       --------------------------------------------
      </span>
      <br/>
     </span>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      <span style="font-size:14px">
       4.总结
      </span>
      <br/>
     </span>
    </p>
    <p>
     <span style="font-family:Microsoft YaHei; font-size:14px">
      <span style="font-size:14px">
       经过“
       <span style="font-size:14px">
        3.Java调用C# dll 步骤
       </span>
       ”你应该已经了解了，Java调用C# com组件之麻烦了，我的建议是，如果可以用C++的还是用C++来实现然后用java调用吧。
      </span>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      <br/>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      疑惑：如果不将C# com 注册为GAC，有没有办法在C++封装后让java调用呢。
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      <br/>
     </span>
    </p>
    <p>
     <span style="font-size:14px">
      <br/>
     </span>
    </p>
    <h2 style="font-size:20px; margin:0px; padding:0px; list-style:none; width:410px; height:30px; overflow:hidden; line-height:30px; font-family:'Microsoft YaHei'; white-space:nowrap; text-overflow:ellipsis; color:rgb(51,51,51)" title="Java调用C#com方法">
     <br/>
    </h2>
    <p>
    </p>
    <p>
     <span style="font-size:14px">
      <br/>
     </span>
    </p>
    <p>
     <br/>
    </p>
    <p>
     <br/>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f747275656c6f766531323335:382f61727469636c652f64657461696c732f39393433343335" class_="artid" style="display:none">
 </p>
</div>


