---
layout: post
title: "一款基于Python的从常规文档里提取图片的简单工具开发方案"
date: 2025-03-16 17:41:53 +0800
description: "一款基于Python的从常规文档里提取图片的简单工具开发方案"
keywords: "一款基于Python的从常规文档里提取图片的简单工具开发方案"
categories: ['未分类']
tags: ['经验分享', '笔记', '开发语言', '学习方法', 'Python']
artid: "146298285"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146298285
    alt: "一款基于Python的从常规文档里提取图片的简单工具开发方案"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146298285
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146298285
cover: https://bing.ee123.net/img/rand?artid=146298285
image: https://bing.ee123.net/img/rand?artid=146298285
img: https://bing.ee123.net/img/rand?artid=146298285
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     一款基于Python的从常规文档里提取图片的简单工具开发方案
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="Python_0">
     </a>
     <strong>
      一款基于Python的从常规文档里提取图片的简单工具开发方案
     </strong>
    </h2>
    <hr/>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/9d0d0ed5f2a94b4fbb18f7bfcdad1a67.png#pic_center"/>
    </p>
    <h3>
     <a id="1__4">
     </a>
     <strong>
      1. 环境准备
     </strong>
    </h3>
    <h4>
     <a id="_5">
     </a>
     <strong>
      安装必需库
     </strong>
    </h4>
    <pre><code class="prism language-bash">pip <span class="token function">install</span> python-docx PyMuPDF openpyxl beautifulsoup4 pillow
pip <span class="token function">install</span> pdfplumber  <span class="token comment"># PDF解析备用方案</span>
pip <span class="token function">install</span> tk          <span class="token comment"># Python自带，无需安装</span>
</code></pre>
    <h4>
     <a id="_12">
     </a>
     <strong>
      工具选择
     </strong>
    </h4>
    <ul>
     <li>
      <strong>
       开发环境
      </strong>
      ：VSCode + Python插件
     </li>
     <li>
      <strong>
       调试工具
      </strong>
      ：Python IDLE（初学者友好）
     </li>
     <li>
      <strong>
       打包工具
      </strong>
      ：pyinstaller（可选，用于生成exe）
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="2__19">
     </a>
     <strong>
      2. 项目架构设计
     </strong>
    </h3>
    <pre><code>image-extractor/
├── main.py            # 主程序入口
├── core/
│   ├── docx_extractor.py
│   ├── pdf_extractor.py
│   ├── excel_extractor.py
│   └── html_extractor.py
└── outputs/           # 默认输出目录
</code></pre>
    <hr/>
    <h3>
     <a id="3__33">
     </a>
     <strong>
      3. 核心功能实现
     </strong>
    </h3>
    <h4>
     <a id="1_Word_docx_extractorpy_35">
     </a>
     <strong>
      (1) Word文档提取 (
      <code>
       docx_extractor.py
      </code>
      )
     </strong>
    </h4>
    <pre><code class="prism language-python"><span class="token keyword">import</span> zipfile
<span class="token keyword">import</span> os
<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image

<span class="token keyword">def</span> <span class="token function">extract_docx_images</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> output_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 解压docx文件</span>
    <span class="token keyword">with</span> zipfile<span class="token punctuation">.</span>ZipFile<span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> zip_ref<span class="token punctuation">:</span>
        <span class="token comment"># 提取media文件夹内的图片</span>
        image_files <span class="token operator">=</span> <span class="token punctuation">[</span>f <span class="token keyword">for</span> f <span class="token keyword">in</span> zip_ref<span class="token punctuation">.</span>namelist<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> f<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'word/media/'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        
        <span class="token keyword">for</span> img_file <span class="token keyword">in</span> image_files<span class="token punctuation">:</span>
            <span class="token comment"># 保存图片到输出目录</span>
            zip_ref<span class="token punctuation">.</span>extract<span class="token punctuation">(</span>img_file<span class="token punctuation">,</span> output_dir<span class="token punctuation">)</span>
            <span class="token comment"># 重命名文件</span>
            src <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>output_dir<span class="token punctuation">,</span> img_file<span class="token punctuation">)</span>
            dst <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>output_dir<span class="token punctuation">,</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>basename<span class="token punctuation">(</span>img_file<span class="token punctuation">)</span><span class="token punctuation">)</span>
            os<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>src<span class="token punctuation">,</span> dst<span class="token punctuation">)</span>
            
    <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>image_files<span class="token punctuation">)</span>
</code></pre>
    <h4>
     <a id="2_PDF_pdf_extractorpy_58">
     </a>
     <strong>
      (2) PDF文件提取 (
      <code>
       pdf_extractor.py
      </code>
      )
     </strong>
    </h4>
    <pre><code class="prism language-python"><span class="token keyword">import</span> fitz  <span class="token comment"># PyMuPDF</span>
<span class="token keyword">import</span> os

<span class="token keyword">def</span> <span class="token function">extract_pdf_images</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> output_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
    doc <span class="token operator">=</span> fitz<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
    img_count <span class="token operator">=</span> <span class="token number">0</span>
    
    <span class="token keyword">for</span> page_num <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>doc<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        page <span class="token operator">=</span> doc<span class="token punctuation">.</span>load_page<span class="token punctuation">(</span>page_num<span class="token punctuation">)</span>
        images <span class="token operator">=</span> page<span class="token punctuation">.</span>get_images<span class="token punctuation">(</span>full<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        
        <span class="token keyword">for</span> img_index<span class="token punctuation">,</span> img <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>images<span class="token punctuation">)</span><span class="token punctuation">:</span>
            xref <span class="token operator">=</span> img<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            base_image <span class="token operator">=</span> doc<span class="token punctuation">.</span>extract_image<span class="token punctuation">(</span>xref<span class="token punctuation">)</span>
            img_data <span class="token operator">=</span> base_image<span class="token punctuation">[</span><span class="token string">"image"</span><span class="token punctuation">]</span>
            
            <span class="token comment"># 保存为PNG</span>
            img_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>output_dir<span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f"pdf_page</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>page_num<span class="token punctuation">}</span></span><span class="token string">_img</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>img_index<span class="token punctuation">}</span></span><span class="token string">.png"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>img_path<span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>img_data<span class="token punctuation">)</span>
            img_count <span class="token operator">+=</span> <span class="token number">1</span>
                
    <span class="token keyword">return</span> img_count
</code></pre>
    <h4>
     <a id="3_Excel_excel_extractorpy_85">
     </a>
     <strong>
      (3) Excel文件提取 (
      <code>
       excel_extractor.py
      </code>
      )
     </strong>
    </h4>
    <pre><code class="prism language-python"><span class="token keyword">from</span> openpyxl <span class="token keyword">import</span> load_workbook
<span class="token keyword">import</span> os

<span class="token keyword">def</span> <span class="token function">extract_excel_images</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> output_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
    wb <span class="token operator">=</span> load_workbook<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
    img_count <span class="token operator">=</span> <span class="token number">0</span>
    
    <span class="token keyword">for</span> sheet <span class="token keyword">in</span> wb<span class="token punctuation">.</span>worksheets<span class="token punctuation">:</span>
        <span class="token keyword">for</span> image <span class="token keyword">in</span> sheet<span class="token punctuation">.</span>_images<span class="token punctuation">:</span>
            <span class="token comment"># 获取图片数据</span>
            img <span class="token operator">=</span> image<span class="token punctuation">.</span>_data
            img_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>output_dir<span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f"excel_</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>sheet<span class="token punctuation">.</span>title<span class="token punctuation">}</span></span><span class="token string">_img</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>img_count<span class="token punctuation">}</span></span><span class="token string">.png"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>img_path<span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>img<span class="token punctuation">)</span>
            img_count <span class="token operator">+=</span> <span class="token number">1</span>
                
    <span class="token keyword">return</span> img_count
</code></pre>
    <h4>
     <a id="4_HTML_html_extractorpy_106">
     </a>
     <strong>
      (4) HTML文件提取 (
      <code>
       html_extractor.py
      </code>
      )
     </strong>
    </h4>
    <pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup
<span class="token keyword">import</span> os
<span class="token keyword">import</span> base64

<span class="token keyword">def</span> <span class="token function">extract_html_images</span><span class="token punctuation">(</span>html_path<span class="token punctuation">,</span> output_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> html_path<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>html_path<span class="token punctuation">)</span>
        soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">,</span> <span class="token string">'html.parser'</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>html_path<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'html.parser'</span><span class="token punctuation">)</span>
    
    img_tags <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span>
    img_count <span class="token operator">=</span> <span class="token number">0</span>
    
    <span class="token keyword">for</span> img <span class="token keyword">in</span> img_tags<span class="token punctuation">:</span>
        src <span class="token operator">=</span> img<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> src<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'data:image'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 处理base64编码图片</span>
            header<span class="token punctuation">,</span> data <span class="token operator">=</span> src<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
            img_format <span class="token operator">=</span> header<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">';'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            img_data <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
            img_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>output_dir<span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f"html_img</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>img_count<span class="token punctuation">}</span></span><span class="token string">.</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>img_format<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>img_path<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>img_data<span class="token punctuation">)</span>
            img_count <span class="token operator">+=</span> <span class="token number">1</span>
                
    <span class="token keyword">return</span> img_count
</code></pre>
    <hr/>
    <h3>
     <a id="4__mainpy_141">
     </a>
     <strong>
      4. 交互界面开发 (
      <code>
       main.py
      </code>
      )
     </strong>
    </h3>
    <pre><code class="prism language-python"><span class="token keyword">import</span> tkinter <span class="token keyword">as</span> tk
<span class="token keyword">from</span> tkinter <span class="token keyword">import</span> filedialog<span class="token punctuation">,</span> messagebox
<span class="token keyword">from</span> core <span class="token keyword">import</span> docx_extractor<span class="token punctuation">,</span> pdf_extractor<span class="token punctuation">,</span> excel_extractor<span class="token punctuation">,</span> html_extractor
<span class="token keyword">import</span> os

<span class="token keyword">class</span> <span class="token class-name">ImageExtractorApp</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> root<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>root <span class="token operator">=</span> root
        self<span class="token punctuation">.</span>root<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"多格式图片提取工具"</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 文件路径变量</span>
        self<span class="token punctuation">.</span>file_path <span class="token operator">=</span> tk<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>output_dir <span class="token operator">=</span> tk<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"outputs"</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 创建界面组件</span>
        self<span class="token punctuation">.</span>create_widgets<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">create_widgets</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 文件选择</span>
        tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>self<span class="token punctuation">.</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"选择文件:"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> padx<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
        tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>self<span class="token punctuation">.</span>root<span class="token punctuation">,</span> textvariable<span class="token operator">=</span>self<span class="token punctuation">.</span>file_path<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
        tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>self<span class="token punctuation">.</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"浏览"</span><span class="token punctuation">,</span> command<span class="token operator">=</span>self<span class="token punctuation">.</span>select_file<span class="token punctuation">)</span><span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 输出目录</span>
        tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>self<span class="token punctuation">.</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"输出目录:"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
        tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>self<span class="token punctuation">.</span>root<span class="token punctuation">,</span> textvariable<span class="token operator">=</span>self<span class="token punctuation">.</span>output_dir<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
        tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>self<span class="token punctuation">.</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"选择目录"</span><span class="token punctuation">,</span> command<span class="token operator">=</span>self<span class="token punctuation">.</span>select_output_dir<span class="token punctuation">)</span><span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 执行按钮</span>
        tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>self<span class="token punctuation">.</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"开始提取"</span><span class="token punctuation">,</span> command<span class="token operator">=</span>self<span class="token punctuation">.</span>start_extraction<span class="token punctuation">)</span><span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 日志区域</span>
        self<span class="token punctuation">.</span>log_text <span class="token operator">=</span> tk<span class="token punctuation">.</span>Text<span class="token punctuation">(</span>self<span class="token punctuation">.</span>root<span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> columnspan<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">select_file</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        file_types <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token punctuation">(</span><span class="token string">'支持的文件类型'</span><span class="token punctuation">,</span> <span class="token string">'*.docx *.pdf *.xlsx *.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token string">'Word文档'</span><span class="token punctuation">,</span> <span class="token string">'*.docx'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token string">'PDF文件'</span><span class="token punctuation">,</span> <span class="token string">'*.pdf'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token string">'Excel文件'</span><span class="token punctuation">,</span> <span class="token string">'*.xlsx'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token string">'网页文件'</span><span class="token punctuation">,</span> <span class="token string">'*.html'</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>file_path<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>filedialog<span class="token punctuation">.</span>askopenfilename<span class="token punctuation">(</span>filetypes<span class="token operator">=</span>file_types<span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">select_output_dir</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>output_dir<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>filedialog<span class="token punctuation">.</span>askdirectory<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">start_extraction</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        file_path <span class="token operator">=</span> self<span class="token punctuation">.</span>file_path<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
        output_dir <span class="token operator">=</span> self<span class="token punctuation">.</span>output_dir<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>output_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
            os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span>output_dir<span class="token punctuation">)</span>
            
        ext <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>splitext<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> ext <span class="token operator">==</span> <span class="token string">'.docx'</span><span class="token punctuation">:</span>
                count <span class="token operator">=</span> docx_extractor<span class="token punctuation">.</span>extract_docx_images<span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> output_dir<span class="token punctuation">)</span>
            <span class="token keyword">elif</span> ext <span class="token operator">==</span> <span class="token string">'.pdf'</span><span class="token punctuation">:</span>
                count <span class="token operator">=</span> pdf_extractor<span class="token punctuation">.</span>extract_pdf_images<span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> output_dir<span class="token punctuation">)</span>
            <span class="token keyword">elif</span> ext <span class="token operator">==</span> <span class="token string">'.xlsx'</span><span class="token punctuation">:</span>
                count <span class="token operator">=</span> excel_extractor<span class="token punctuation">.</span>extract_excel_images<span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> output_dir<span class="token punctuation">)</span>
            <span class="token keyword">elif</span> ext <span class="token operator">==</span> <span class="token string">'.html'</span><span class="token punctuation">:</span>
                count <span class="token operator">=</span> html_extractor<span class="token punctuation">.</span>extract_html_images<span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> output_dir<span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                messagebox<span class="token punctuation">.</span>showerror<span class="token punctuation">(</span><span class="token string">"错误"</span><span class="token punctuation">,</span> <span class="token string">"不支持的文件类型"</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span>
                
            self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>insert<span class="token punctuation">(</span>tk<span class="token punctuation">.</span>END<span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f"成功提取 </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>count<span class="token punctuation">}</span></span><span class="token string"> 张图片到 </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>output_dir<span class="token punctuation">}</span></span><span class="token string">\n"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            messagebox<span class="token punctuation">.</span>showerror<span class="token punctuation">(</span><span class="token string">"错误"</span><span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f"提取失败: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    root <span class="token operator">=</span> tk<span class="token punctuation">.</span>Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>
    app <span class="token operator">=</span> ImageExtractorApp<span class="token punctuation">(</span>root<span class="token punctuation">)</span>
    root<span class="token punctuation">.</span>mainloop<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <hr/>
    <h3>
     <a id="5__225">
     </a>
     <strong>
      5. 使用说明
     </strong>
    </h3>
    <h4>
     <a id="_226">
     </a>
     <strong>
      操作步骤
     </strong>
    </h4>
    <ol>
     <li>
      运行
      <code>
       main.py
      </code>
     </li>
     <li>
      点击
      <strong>
       浏览
      </strong>
      选择文件 (支持.docx/.pdf/.xlsx/.html)
     </li>
     <li>
      选择输出目录（默认 outputs）
     </li>
     <li>
      点击
      <strong>
       开始提取
      </strong>
     </li>
     <li>
      查看底部日志区域的提取结果
     </li>
    </ol>
    <h4>
     <a id="_233">
     </a>
     <strong>
      效果示例
     </strong>
    </h4>
    <pre><code>成功提取 5 张图片到 outputs/
成功提取 3 张图片到 outputs/
</code></pre>
    <hr/>
    <h3>
     <a id="6__241">
     </a>
     <strong>
      6. 常见问题解决
     </strong>
    </h3>
    <h4>
     <a id="Q1_Excel_242">
     </a>
     <strong>
      Q1: Excel图片无法提取？
     </strong>
    </h4>
    <ul>
     <li>
      原因：openpyxl只能提取嵌入式图片，无法提取浮动图片
     </li>
     <li>
      解决方案：改用
      <code>
       xlrd
      </code>
      +图像坐标识别（需更复杂处理）
     </li>
    </ul>
    <h4>
     <a id="Q2_PDF_246">
     </a>
     <strong>
      Q2: PDF提取的图片模糊？
     </strong>
    </h4>
    <ul>
     <li>
      原因：PDF内嵌低分辨率图片
     </li>
     <li>
      解决方案：使用
      <code>
       pdfplumber
      </code>
      的更高精度提取模式
     </li>
    </ul>
    <h4>
     <a id="Q3__250">
     </a>
     <strong>
      Q3: 程序无响应？
     </strong>
    </h4>
    <ul>
     <li>
      原因：大文件处理耗时阻塞主线程
     </li>
     <li>
      解决方案：改用多线程处理（参考
      <code>
       threading
      </code>
      模块）
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="7__256">
     </a>
     <strong>
      7. 项目扩展建议
     </strong>
    </h3>
    <ol>
     <li>
      <strong>
       增加批量处理
      </strong>
      ：支持文件夹批量导入
     </li>
     <li>
      <strong>
       添加图片预览
      </strong>
      ：在界面中显示缩略图
     </li>
     <li>
      <strong>
       支持压缩包
      </strong>
      ：直接解压ZIP/RAR文件并处理内容
     </li>
     <li>
      <strong>
       增加格式转换
      </strong>
      ：自动转换HEIC/WEBP等特殊格式
     </li>
    </ol>
    <hr/>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a:2f2f626c6f672e6373646e2e6e65742f64656570657665722f:61727469636c652f64657461696c732f313436323938323835" class_="artid" style="display:none">
 </p>
</div>


