---
layout: post
title: "Vite-不支持-require-解决方案三种情况require-is-not-defined"
date: 2025-03-10 09:37:01 +0800
description: "首先，Vite中没有require相关方法，因为它默认支持ESM方式加载模块！所以，我们要理清如下两个方法。"
keywords: "Vite 不支持 require 解决方案（三种情况/require is not defined）"
categories: ['未分类']
tags: ['Vue', 'Vite', 'Javascript']
artid: "146144563"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146144563
    alt: "Vite-不支持-require-解决方案三种情况require-is-not-defined"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146144563
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146144563
cover: https://bing.ee123.net/img/rand?artid=146144563
image: https://bing.ee123.net/img/rand?artid=146144563
img: https://bing.ee123.net/img/rand?artid=146144563
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Vite 不支持 require 解决方案（三种情况/require is not defined）
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h3 id="devmenu1">
     前言
    </h3>
    <p>
     首先，
     <code>
      Vite
     </code>
     中没有
     <code>
      require
     </code>
     相关方法，因为它默认支持
     <code>
      ESM
     </code>
     方式加载模块！
    </p>
    <p>
     所以，我们要理清如下两个
     <strong>
      方法
     </strong>
     ：
    </p>
    <h4 id="devmenu2">
     方法 require()
    </h4>
    <ul>
     <li>
      <p>
       <a href="https://link.csdn.net/?target=https%3A%2F%2Fnodejs.org%2Fdocs%2Flatest%2Fapi%2Fmodules.html%23requireid%3Flogin%3Dfrom_csdn" rel="nofollow" title="Node.JS 原生方法">
        Node.JS 原生方法
       </a>
       ，以
       <code>
        CommonJS
       </code>
       方式加载
       <strong>
        模块/文件/图片
       </strong>
       ；
      </p>
     </li>
     <li>
      <p>
       <a href="https://link.csdn.net/?target=https%3A%2F%2Fwebpack.docschina.org%2Fapi%2Fmodule-methods%2F%23require%3Flogin%3Dfrom_csdn" rel="nofollow" title="Webpack 默认支持">
        Webpack 默认支持
       </a>
       ，
       <code>
        Vite
       </code>
       不支持；
      </p>
     </li>
    </ul>
    <h4 id="devmenu3">
     方法 require.context()
    </h4>
    <ul>
     <li>
      <a href="https://link.csdn.net/?target=https%3A%2F%2Fwebpack.docschina.org%2Fapi%2Fmodule-methods%2F%23webpack%3Flogin%3Dfrom_csdn" rel="nofollow" title="Webpack 特定方法">
       Webpack 特定方法
      </a>
      ，此方法可
      <a href="https://link.csdn.net/?target=https%3A%2F%2Fwebpack.docschina.org%2Fguides%2Fdependency-management%2F%23requirecontext%3Flogin%3Dfrom_csdn" rel="nofollow" title="实现自定义上下文">
       实现自定义上下文
      </a>
      ；
     </li>
     <li>
      <code>
       Vite
      </code>
      不支持；
     </li>
    </ul>
    <p>
     但
     <code>
      Vite
     </code>
     提供解决方案，请接着往下看！
    </p>
    <h3 id="devmenu4">
     解决方案
    </h3>
    <h4 id="devmenu5">
     require() 加载模块
    </h4>
    <p>
     <strong>
      报错 require 未定义
     </strong>
    </p>
    <blockquote>
     <p>
      <code>
       Uncaught (in promise) ReferenceError: require is not defined
      </code>
     </p>
    </blockquote>
    <pre><code class="language-javascript">// 报错。CommonJS 方式加载
initNav() {
	const ElementResizeDetector = require('element-resize-detector');
	const erd = ElementResizeDetector();
}</code></pre>
    <p>
     <strong>
      解决方案
     </strong>
    </p>
    <ul>
     <li>
      使用
      <a href="https://link.csdn.net/?target=https%3A%2F%2Fwangdoc.com%2Fes6%2Fmodule%23import%3Flogin%3Dfrom_csdn" rel="nofollow" title="EMS import()">
       EMS import()
      </a>
      方法；
     </li>
     <li>
      注意
      <code>
       require()
      </code>
      是
      <strong>
       同步
      </strong>
      加载；
     </li>
     <li>
      <code>
       import()
      </code>
      是
      <strong>
       异步
      </strong>
      加载，推荐使用
      <code>
       await
      </code>
      命令。当然也可以使用
      <code>
       then()
      </code>
      方法，因为其返回
      <code>
       Promise
      </code>
      对象；
     </li>
    </ul>
    <pre><code class="language-javascript">// 正确。方式一（推荐）：ESM 方式加载，使用 await 命令
async initNav() {
	const ElementResizeDetector = await import('element-resize-detector');
	const erd = elementResizeDetectorMaker.default();
}


// 正确。方式二：ESM 方式加载，使用 then() 方法
initNav() {
	import('element-resize-detector').then(module =&gt; {
        const erd = module.default();        
    }).catch(err =&gt; {
        console.error('加载失败');
    });
}</code></pre>
    <h4 id="devmenu6">
     require() 加载图片
    </h4>
    <p>
     <strong>
      报错 require 未定义
     </strong>
    </p>
    <blockquote>
     <p>
      <code>
       Possible Unhandled Promise Rejection: ReferenceError: require is not defined
      </code>
     </p>
    </blockquote>
    <pre><code class="language-html">&lt;template&gt;
	&lt;img class="pwd-icon" :src="pwdIcon" &gt;
&lt;/template&gt;
&lt;script&gt;
export default {
	data () {
		return {
			pwdIcon2: require('../assets/images/pwd-icon.png'),
		}
	}
}
&lt;/script&gt;</code></pre>
    <p>
     <strong>
      解决方案
     </strong>
    </p>
    <p>
     使用
     <a href="https://link.csdn.net/?target=https%3A%2F%2Fwangdoc.com%2Fes6%2Fmodule%23import-%25E5%2591%25BD%25E4%25BB%25A4%3Flogin%3Dfrom_csdn" rel="nofollow" title="EMS import">
      EMS import
     </a>
     命令；
    </p>
    <pre><code class="language-html">&lt;template&gt;
	&lt;img class="pwd-icon" :src="pwdIcon" &gt;
&lt;/template&gt;
&lt;script&gt;
import PwdIcon from '../assets/images/pwd-icon.png'
export default {
	data () {
		return {
			pwdIcon: PwdIcon,
		}
	}
}
&lt;/script&gt;</code></pre>
    <h4 id="devmenu7">
     require.context() 批量加载文件
    </h4>
    <p>
     <strong>
      报错 require 未定义
     </strong>
    </p>
    <blockquote>
     <p>
      <code>
       Possible Unhandled Promise Rejection: ReferenceError: require is not defined
      </code>
     </p>
    </blockquote>
    <pre><code class="language-javascript">// require 是同步加载
const modulesFiles = require.context('./src/components', true, /\.vue$/);

const modules = modulesFiles.keys().reduce((modules, modulePath) =&gt; {
    const moduleName = modulePath.replace(/^\.\/(.*)\.\w+$/, '$1');
    modules[moduleName] = modulesFiles(modulePath).default;
    return modules;
}, {});</code></pre>
    <p>
     <strong>
      解决方案
     </strong>
    </p>
    <p>
     使用
     <a href="https://link.csdn.net/?target=https%3A%2F%2Fcn.vitejs.dev%2Fguide%2Fmigration-from-v2%23importmetaglob%3Flogin%3Dfrom_csdn" rel="nofollow" title="import.meta.glob">
      import.meta.glob
     </a>
     ，可
     <strong>
      异步
     </strong>
     和
     <strong>
      同步
     </strong>
     加载。详见
     <a href="https://link.csdn.net/?target=https%3A%2F%2Fblog.csdn.net%2Fsinat_31213021%2Farticle%2Fdetails%2F135548940%3Flogin%3Dfrom_csdn" rel="nofollow" title="《Vite 基础知识：使用 Glob 动态加载 .vue 文件》">
      《Vite 基础知识：使用 Glob 动态加载 .vue 文件》
     </a>
    </p>
    <pre><code class="language-javascript">// 异步，返回 Promise 对象
const modules = import.meta.glob('./src/components/**/*.vue');

for (const path in modules) {
    modules[path]().then((mod) =&gt; {
        console.log(path, mod.default);
    })
}

// 同步，配置参数 { eager: true }
const modules = import.meta.glob('./src/components/**/*.vue', { eager: true });

for (const path in modules) {
    console.log(path, modules[path].default);
}</code></pre>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f33383138383438352f:61727469636c652f64657461696c732f313436313434353633" class_="artid" style="display:none">
 </p>
</div>


