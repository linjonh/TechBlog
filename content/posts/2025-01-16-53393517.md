---
layout: post
title: "前端编程中,如何消除浏览器缓存"
date: 2025-01-16 11:17:29 +0800
description: "在前端编程中，Brackets与nginx是我最喜欢的组合，调试代码与接口全在本地，完全能达到那种飞"
keywords: "es6 import from清除浏览器缓存"
categories: ['精进的前端']
tags: ['浏览器缓存', '前端编程', 'Nginx']
artid: "53393517"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=53393517
    alt: "前端编程中,如何消除浏览器缓存"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=53393517
featuredImagePreview: https://bing.ee123.net/img/rand?artid=53393517
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     前端编程中，如何消除浏览器缓存
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     在前端编程中，Brackets与nginx是我最喜欢的组合，调试代码与接口全在本地，完全能达到那种飞一般的编程感觉。
    </p>
    <p>
     但在开发中，最容易郁闷的是，html与js文件容易被浏览器缓存，文件都已经更新了，但感觉服务器返回的文件依然是上上上次的，非要手动清除一次浏览器的缓存，才能查看到最新的文件，这特么的也太烦了不是？
    </p>
    <p>
     查看静态文件的请求头信息，如下：
    </p>
    <pre class="prettyprint"><code class="hljs ruby"><span class="hljs-constant">Accept</span>-<span class="hljs-constant">Ranges</span><span class="hljs-symbol">:bytes</span>
<span class="hljs-constant">Content</span>-<span class="hljs-constant">Length</span><span class="hljs-symbol">:</span><span class="hljs-number">211089</span>
<span class="hljs-constant">Content</span>-<span class="hljs-constant">Type</span><span class="hljs-symbol">:application/javascript</span>
<span class="hljs-constant">Date</span><span class="hljs-symbol">:Tue</span>, <span class="hljs-number">29</span> <span class="hljs-constant">Nov</span> <span class="hljs-number">2016</span> <span class="hljs-number">04</span><span class="hljs-symbol">:</span><span class="hljs-number">26</span><span class="hljs-symbol">:</span><span class="hljs-number">40</span> <span class="hljs-constant">GMT</span>
<span class="hljs-constant">ETag</span><span class="hljs-symbol">:<span class="hljs-string">"583c0ad3-33891"</span></span>
<span class="hljs-constant">Last</span>-<span class="hljs-constant">Modified</span><span class="hljs-symbol">:Mon</span>, <span class="hljs-number">28</span> <span class="hljs-constant">Nov</span> <span class="hljs-number">2016</span> <span class="hljs-number">10</span><span class="hljs-symbol">:</span><span class="hljs-number">45</span><span class="hljs-symbol">:</span><span class="hljs-number">39</span> <span class="hljs-constant">GMT</span>
<span class="hljs-constant">Server</span><span class="hljs-symbol">:nginx/</span><span class="hljs-number">1.10</span>.<span class="hljs-number">2</span></code></pre>
    <p>
     从Date与Last-Modified字段就可以看出，js文件被浏览器缓存了，缓存的时间还将近一天，于是就想到为js文件添加头信息，偷了一次懒，直接在根路径添加缓存头信息，如下：
    </p>
    <pre class="prettyprint"><code class="hljs ruby">location / {
    root   <span class="hljs-constant">E</span><span class="hljs-symbol">:/Workspace/yii-es6-amd</span>;
    index  index.html index.htm;
    add_header <span class="hljs-constant">Cache</span>-<span class="hljs-constant">Control</span> no-cache;
    add_header <span class="hljs-constant">Cache</span>-<span class="hljs-constant">Control</span> private;
    expires 0s;
}</code></pre>
    <p>
     结果，所有的静态文件依旧那么牢牢地保持缓存状态，继续添加过滤规则，如下：
    </p>
    <pre class="prettyprint"><code class="hljs ruby"><span class="hljs-comment">#   利用正则表达式匹配静态资源目录</span>
location ~ <span class="hljs-regexp">/dest/</span>(.*) {
    root   <span class="hljs-constant">E</span><span class="hljs-symbol">:/Workspace/yii-es6-amd</span>;
    add_header <span class="hljs-constant">Cache</span>-<span class="hljs-constant">Control</span> no-cache;
    add_header <span class="hljs-constant">Cache</span>-<span class="hljs-constant">Control</span> private;
    expires 0s;
}</code></pre>
    <p>
     然后请求服务器，返回的头信息如下：
    </p>
    <pre class="prettyprint"><code class="hljs ruby"><span class="hljs-constant">Accept</span>-<span class="hljs-constant">Ranges</span><span class="hljs-symbol">:bytes</span>
<span class="hljs-constant">Cache</span>-<span class="hljs-constant">Control</span><span class="hljs-symbol">:no-cache</span>
<span class="hljs-constant">Cache</span>-<span class="hljs-constant">Control</span><span class="hljs-symbol">:max-age=</span><span class="hljs-number">0</span>
<span class="hljs-constant">Cache</span>-<span class="hljs-constant">Control</span><span class="hljs-symbol">:private</span>
<span class="hljs-constant">Connection</span><span class="hljs-symbol">:keep-alive</span>
<span class="hljs-constant">Content</span>-<span class="hljs-constant">Length</span><span class="hljs-symbol">:</span><span class="hljs-number">514</span>
<span class="hljs-constant">Content</span>-<span class="hljs-constant">Type</span><span class="hljs-symbol">:text/html</span>
<span class="hljs-constant">Date</span><span class="hljs-symbol">:Tue</span>, <span class="hljs-number">29</span> <span class="hljs-constant">Nov</span> <span class="hljs-number">2016</span> <span class="hljs-number">07</span><span class="hljs-symbol">:</span><span class="hljs-number">03</span><span class="hljs-symbol">:</span><span class="hljs-number">25</span> <span class="hljs-constant">GMT</span>
<span class="hljs-constant">ETag</span><span class="hljs-symbol">:<span class="hljs-string">"583d283b-202"</span></span>
<span class="hljs-constant">Expires</span><span class="hljs-symbol">:Tue</span>, <span class="hljs-number">29</span> <span class="hljs-constant">Nov</span> <span class="hljs-number">2016</span> <span class="hljs-number">07</span><span class="hljs-symbol">:</span><span class="hljs-number">03</span><span class="hljs-symbol">:</span><span class="hljs-number">25</span> <span class="hljs-constant">GMT</span>
<span class="hljs-constant">Last</span>-<span class="hljs-constant">Modified</span><span class="hljs-symbol">:Tue</span>, <span class="hljs-number">29</span> <span class="hljs-constant">Nov</span> <span class="hljs-number">2016</span> <span class="hljs-number">07</span><span class="hljs-symbol">:</span><span class="hljs-number">03</span><span class="hljs-symbol">:</span><span class="hljs-number">23</span> <span class="hljs-constant">GMT</span></code></pre>
    <p>
     可以看出，Date与Expires字段完全相等，这下浏览器再也不缓存页面了。
    </p>
    <p>
     需要特别指出的是，浏览器页面缓存与nginx的页面缓存完全是两个不同的概念，一个缓存在客户端，一个缓存在服务器端，上面的方法只是告诉浏览器，文件不需要缓存，与服务器端的页面缓存完全不相关。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="687474:70733a2f2f626c6f672e6373646e2e6e65742f796969666161:2f61727469636c652f64657461696c732f3533333933353137" class_="artid" style="display:none">
 </p>
</div>


