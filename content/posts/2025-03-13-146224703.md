---
layout: post
title: "Apache-Pol-excel"
date: 2025-03-13 11:14:16 +0800
description: "row.createCell(1).setCellValue(“姓名”);row.createCell(2).setCellValue(“城市”);row.createCell(1).setCellValue(“张三”);//在sheet中创建行对象，rownum编号从0开始。//通过输出流将内存中的Excel文件写入磁盘中。//在Excel文件中创建一个sheet页。//读取磁盘上以及存在的excel文件。//获取sheet页中最后一行的行号。//在内存中创建一个excel文件。* 导出运营数据报表。"
keywords: "Apache Pol （excel）"
categories: ['未分类']
tags: ['Excel', 'Apache']
artid: "146224703"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146224703
    alt: "Apache-Pol-excel"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146224703
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146224703
cover: https://bing.ee123.net/img/rand?artid=146224703
image: https://bing.ee123.net/img/rand?artid=146224703
img: https://bing.ee123.net/img/rand?artid=146224703
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Apache Pol （excel）
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/e4b6071416c64c1b8b53094f187fa56a.png">
      <br/>
      是一个处理微软各种文件格式的开源项目，一般情况下，POI都是用来操作EXCEL文件的 读和写操作
      <br/>
      test测试
      <br/>
      /*
     </img>
    </p>
    <ul>
     <li>
      <p>
       使用POI操作Excel文件
      </p>
     </li>
     <li>
      <p>
       */
       <br/>
       public class POITest {
       <!-- -->
      </p>
      <p>
       /*
      </p>
      <ul>
       <li>
        <p>
         通过POI创建Excel文件并写入文件内容
        </p>
       </li>
       <li>
        <p>
         */
         <br/>
         public static void write() throws Exception{
         <!-- -->
         <br/>
         //在内存中创建一个excel文件
         <br/>
         XSSFWorkbook excel=new XSSFWorkbook();
         <br/>
         //在Excel文件中创建一个sheet页
         <br/>
         XSSFSheet sheet = excel.createSheet(“info”);
         <br/>
         //在sheet中创建行对象，rownum编号从0开始
         <br/>
         XSSFRow row = sheet.createRow(1);
         <br/>
         //创建单元格并写入文件内容
         <br/>
         row.createCell(1).setCellValue(“姓名”);
         <br/>
         row.createCell(2).setCellValue(“城市”);
        </p>
        <p>
         //创建一个新行
         <br/>
         row = sheet.createRow(2);
         <br/>
         row.createCell(1).setCellValue(“张三”);
         <br/>
         row.createCell(2).setCellValue(“北京”);
        </p>
        <p>
         row = sheet.createRow(3);
         <br/>
         row.createCell(1).setCellValue(“李四”);
         <br/>
         row.createCell(2).setCellValue(“南京”);
        </p>
        <p>
         //通过输出流将内存中的Excel文件写入磁盘中
         <br/>
         FileOutputStream out=new FileOutputStream(new File(“/Users/renliaoliao/Desktop/info.xlsx”));
         <br/>
         excel.write(out);
        </p>
        <p>
         //关闭资源
         <br/>
         out.close();
         <br/>
         excel.close();
         <br/>
         }
        </p>
       </li>
      </ul>
      <p>
       /*
      </p>
      <ul>
       <li>
        <p>
         通过POI读取Excel文件中的内容
        </p>
       </li>
       <li>
       </li>
       <li>
        <p>
         */
         <br/>
         public static void read() throws Exception{
         <!-- -->
         <br/>
         //读取磁盘上以及存在的excel文件
         <br/>
         FileInputStream in = new FileInputStream(new File(“/Users/renliaoliao/Desktop/info.xlsx”));
         <br/>
         XSSFWorkbook excel = new XSSFWorkbook(in);
         <br/>
         //将文本文件读取出来 读取第一个sheet页
         <br/>
         XSSFSheet sheet = excel.getSheetAt(0);
        </p>
        <p>
         //获取sheet页中最后一行的行号
         <br/>
         int lastRowNum = sheet.getLastRowNum();
        </p>
        <p>
         for (int i=1;i&lt;=lastRowNum;i++){
         <!-- -->
         <br/>
         //获取某一行
         <br/>
         XSSFRow row = sheet.getRow(i);
         <br/>
         //获取单元格对象
         <br/>
         String cellValue1 = row.getCell(1).getStringCellValue();
         <br/>
         String cellValue2 = row.getCell(2).getStringCellValue();
         <br/>
         System.out.println(cellValue1+" "+cellValue2);
         <br/>
         }
        </p>
        <p>
         //关闭资源
         <br/>
         in.close();
         <br/>
         excel.close();
         <br/>
         }
         <br/>
         public static void main(String[] args) throws Exception {
         <!-- -->
         <br/>
         //write();
         <br/>
         read();
         <br/>
         }
         <br/>
         }
        </p>
       </li>
      </ul>
     </li>
    </ul>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/dbb35153a9c14c958cc7352d5e085f61.png"/>
    </p>
    <p>
     导出运营数据表数据
     <br/>
     /*
     <br/>
     * 导出运营数据报表
     <br/>
     * */
     <br/>
     @Override
     <br/>
     public void expo rtBusinessData(HttpServletResponse response) {
     <!-- -->
     <br/>
     //1.查询数据库 获取运营数据
     <br/>
     LocalDate dateBegin = LocalDate.now().minusDays(30);
     <br/>
     LocalDate dateEnd = LocalDate.now().minusDays(1);
     <br/>
     //查询概览数据
     <br/>
     BusinessDataVO businessDataVO = workspaceService.getBusinessData(LocalDateTime.of(dateBegin, LocalTime.MIN), LocalDateTime.of(dateEnd, LocalTime.MAX));
    </p>
    <pre><code>    //2.通过POI将数据写入到Excel文件中
    InputStream in = this.getClass().getClassLoader().getResourceAsStream("template/运营数据报表模板.xlsx");

    try {
        //基于模板文件创建一个新的excel文件
        XSSFWorkbook excel = new XSSFWorkbook(in);

        //获取表格标签的sheet页
        XSSFSheet sheet = excel.getSheet("Sheet1");

        //填充数据--时间
        sheet.getRow(1).getCell(1).setCellValue("时间："+dateBegin+"至"+dateEnd);

        //获取第四行
        XSSFRow row = sheet.getRow(3);
        row.getCell(2).setCellValue(businessDataVO.getTurnover());
        row.getCell(4).setCellValue(businessDataVO.getOrderCompletionRate());
        row.getCell(6).setCellValue(businessDataVO.getNewUsers());

        //获得第五行
        row = sheet.getRow(4);
        row.getCell(2).setCellValue(businessDataVO.getValidOrderCount());
        row.getCell(4).setCellValue(businessDataVO.getUnitPrice());

        //填充明细数据
        for (int i = 0; i &lt; 30; i++) {
            LocalDate date = dateBegin.plusDays(i);
            //查询某一天的营业数据
            BusinessDataVO businessData = workspaceService.getBusinessData(LocalDateTime.of(date, LocalTime.MIN), LocalDateTime.of(date, LocalTime.MAX));

            //获得某一行
            row=sheet.getRow(7+i);
            row.getCell(1).setCellValue(date.toString());
            row.getCell(2).setCellValue(businessData.getTurnover());
            row.getCell(3).setCellValue(businessData.getValidOrderCount());
            row.getCell(4).setCellValue(businessData.getOrderCompletionRate());
            row.getCell(5).setCellValue(businessData.getUnitPrice());
            row.getCell(6).setCellValue(businessData.getNewUsers());

        }


        //3.通过输出流将excel文件下载到客户端浏览器
        ServletOutputStream out = response.getOutputStream();
        excel.write(out);

        //关闭资源
        out.close();
        excel.close();


    } catch (IOException e) {
        throw new RuntimeException(e);
    }


}
</code></pre>
    <p>
     }
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34353933343635392f:61727469636c652f64657461696c732f313436323234373033" class_="artid" style="display:none">
 </p>
</div>


