---
layout: post
title: "什么是-SRE一文详解-SRE-运维体系"
date: 2024-11-26 09:30:00 +0800
description: "目录可观测性系统故障响应故障复盘测试与发布容量规划自动化工具开发用户体验在任何有一定规模的企业内部，"
keywords: "sre"
categories: ['闲安自在']
tags: ['数据库', '大数据', '人工智能']
artid: "133689459"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=133689459
    alt: "什么是-SRE一文详解-SRE-运维体系"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=133689459
featuredImagePreview: https://bing.ee123.net/img/rand?artid=133689459
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     什么是 SRE？一文详解 SRE 运维体系
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p id="main-toc">
     <strong>
      目录
     </strong>
    </p>
    <p id="%E5%8F%AF%E8%A7%82%E6%B5%8B%E6%80%A7%E7%B3%BB%E7%BB%9F-toc" style="margin-left:80px;">
     <a href="#%E5%8F%AF%E8%A7%82%E6%B5%8B%E6%80%A7%E7%B3%BB%E7%BB%9F" rel="nofollow">
      可观测性系统
     </a>
    </p>
    <p id="%E6%95%85%E9%9A%9C%E5%93%8D%E5%BA%94-toc" style="margin-left:80px;">
     <a href="#%E6%95%85%E9%9A%9C%E5%93%8D%E5%BA%94" rel="nofollow">
      故障响应
     </a>
    </p>
    <p id="%E6%95%85%E9%9A%9C%E5%A4%8D%E7%9B%98-toc" style="margin-left:80px;">
     <a href="#%E6%95%85%E9%9A%9C%E5%A4%8D%E7%9B%98" rel="nofollow">
      故障复盘
     </a>
    </p>
    <p id="%E6%B5%8B%E8%AF%95%E4%B8%8E%E5%8F%91%E5%B8%83-toc" style="margin-left:80px;">
     <a href="#%E6%B5%8B%E8%AF%95%E4%B8%8E%E5%8F%91%E5%B8%83" rel="nofollow">
      测试与发布
     </a>
    </p>
    <p id="%E5%AE%B9%E9%87%8F%E8%A7%84%E5%88%92-toc" style="margin-left:80px;">
     <a href="#%E5%AE%B9%E9%87%8F%E8%A7%84%E5%88%92" rel="nofollow">
      容量规划
     </a>
    </p>
    <p id="%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7%E5%BC%80%E5%8F%91-toc" style="margin-left:80px;">
     <a href="#%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7%E5%BC%80%E5%8F%91" rel="nofollow">
      自动化工具开发
     </a>
    </p>
    <p id="%E7%94%A8%E6%88%B7%E4%BD%93%E9%AA%8C-toc" style="margin-left:80px;">
     <a href="#%E7%94%A8%E6%88%B7%E4%BD%93%E9%AA%8C" rel="nofollow">
      用户体验
     </a>
    </p>
    <hr id="hr-toc"/>
    <p>
    </p>
    <h4 id="%E5%8F%AF%E8%A7%82%E6%B5%8B%E6%80%A7%E7%B3%BB%E7%BB%9F">
     <strong>
      可观测性系统
     </strong>
    </h4>
    <p>
     在任何有一定规模的企业内部，一旦推行起来整个SRE的运维模式，那么对于可观测性系统的建设将变得尤为重要，而在整个可观测性系统中，通常我们会分为如下三个方面：
    </p>
    <ul>
     <li>
      指标监控：即各种指标监控，比如基础资源指标，服务性能指标，业务的调用指标。
     </li>
     <li>
      日志：各种设备以及服务的运行日志监控。
     </li>
     <li>
      调用链：业务层面的调用链分析，通常在分布式系统中帮助运营、开发以及运维人员快速识别整体调用的瓶颈点
     </li>
    </ul>
    <p>
     一整套的可观测系统，它能确保你洞察系统，跟踪系统的健康状态、可用性以及系统内部发生的事情。对于整个可观测系统的建设，需要注意如下两点：
    </p>
    <ul>
     <li>
      确定质量标准是什么，并确保系统持续逼近或保持在质量标准极限范围内
     </li>
     <li>
      系统地关注这项工作—而不应该只是随机地查看一下系统
     </li>
    </ul>
    <p>
     在整个企业级可观测系统中，我认为至少应该包括如下几个特征：
    </p>
    <ul>
     <li>
      完备指标采集：可以对接企业内大部分的设备与技术栈相应的监控指标；同时，支持常见设备的监控指标体系，可以快速接入监控设备和指标，避免所有设备监控都是从头构建；对于日志数据的采集支持
     </li>
     <li>
      海量设备支持：企业IT系统数量和规模越来越大，因此监控系统比以前需要监控海量设备监控。
     </li>
     <li>
      监控数据存储和分析：监控数据是运维分析、运维自动化和智能化的基础，因此海量监控数据存储以及基于监控数据的可视化分析是一个监控系统的基本能力。
     </li>
     <li>
      可观测系统是整个运维体系的基础，它需要提供整个运维体系的数据化支持。
     </li>
    </ul>
    <p>
     因此，一个企业级的可观测性系统应该是平台化的。一方面可以通过配置或者开发实现更多 运维指标的接入；另一方面，亦可对接更多的专业运维工具，整合并打通多元的运维数据，为更多运维场景提供数据服务。从整体上，可观测性系统为企业运维提供了一个数据基础，让我们对事故响应以及容量预测等方面更多使用数据而非凭借以往经验和拍脑袋做出决策。
    </p>
    <h4 id="%E6%95%85%E9%9A%9C%E5%93%8D%E5%BA%94">
     <strong>
      故障响应
     </strong>
    </h4>
    <p>
     如果有什么东西出了故障，该如何提醒大家并做出回应？工具可以帮助解决这个问题，国为它可以定义提醒人类的规则。故障响应是建立在使用可观测性系统构建的数据之上，并借助反馈循环，来帮助我们加强对服务的监控。故障响应通常包含如下几个动作:
    </p>
    <ul>
     <li>
      关注: 不论是主动发现瓶颈点或异常点，还是通过可观测性系统被动暴露瓶颈点，我们都应该进行主动关注
     </li>
     <li>
      交流: 及时将观察到风险点通知到相关方，并告知影响面以及相关的补救措施
     </li>
     <li>
      恢复: 三方达成一致后，根据补救措施进行修复相关风险点和异常点
     </li>
    </ul>
    <p>
     需要注意的是，如果在前期整个可观测性系统能够做好，通常故障应当始于一个简单的告警信息或一个报障电话，因此，通常情况下，可观测系统做的足够好仅能起到追溯和排查的作用，但是无法起到及时发现的作用，此时就需要依赖于各个观测数据进行计算和评估告警，以及时将相关的告警通知到相关人，以暴露风险点。告警只是整个故障响应的第一个环节，解决的是故障如何发现的问题，而大多数的故障响应工作都是关于定义处理策略和提供培训的，以便人们在收到警报时知道该怎么做，通常这部分更多的是过去历史经验和运维经历的总结和沉淀，包括经验的一些抽象和工具化沉淀，以保证故障响应的效率和普遍化(即不依赖人为经验)。
    </p>
    <p>
     而对于整个告警系统来说，需要确保的是告警的有效性，否则，整个报警系统很有可能沦落为垃圾数据制造机，告警有效性意味着需要满足如下两个需求：
    </p>
    <ul>
     <li>
      告警及时性: 系统有问题需要及时通过告警信息告知运维处理人员及时处理告警;
     </li>
     <li>
      告警准确性: 只要有告警信息系统必然出现问题(对于很多企业可能存在大量的无用告警，比如磁盘问题，mem等相关问题，当然这里涉及到了自动化、业务形态、告警阈值的问题);
     </li>
    </ul>
    <p>
     在整个运维过程中，我们经常会发现有大量的无关紧要的告警信息，让运维人员的注意力迷失在告警海洋当中，而通常非运维领域的领导会关注整个告警的响应程度，因此，抑制和消除无效的告警，让运维人员不被告警风暴所吞没，也是告警管理中重点建设的内容。通常情况，在我们的各个可观测系统构建完成后，可以通过整合到监控平台中的各种监控数据，应用趋势预测、短周期检测、间歇性恢复、基线判断、重复压缩等算法和手段实现告警压缩收敛，强化告警的有效性。
    </p>
    <p>
    </p>
    <p>
    </p>
    <p class="img-center">
     <img alt="" height="323" src="https://i-blog.csdnimg.cn/blog_migrate/6bf851d13c56644f4787957aaf4d8688.png" width="720"/>
    </p>
    <p>
    </p>
    <p>
     同时，面向一线的运维人员，我们需要根据同一个系统或设备的多个监控指标进行综合性建模和分析，汇总成一个健康度的分值，给予一线运维人员系统的基于健康度的系统分层评价体系，真实、直观反映系统运行状态，实现问题快速定界。比如，通过基础资源的多个指标进行综合加权计算来整体评估该资源的利用率；通过一个应用关联的全部资源的资源利用率以及应用的运维架构整体建模分析来计算一个分值来整体评估该应用的健康程度。这个过程如果做得成熟一些，可以根据内部已有的解决方案和告警进行闭环打通，一个简单的场景就是，当磁盘满时，告警会首先触发一次标准化的磁盘巡检，并进行相关的可丢弃数据的删除，如果依然无法解决该报警，下次可直接关联到一线运维进行人工干预，之后进行标准化经验总结。
    </p>
    <h4 id="%E6%95%85%E9%9A%9C%E5%A4%8D%E7%9B%98">
     <strong>
      故障复盘
     </strong>
    </h4>
    <p>
     故障复盘就是对于过去的一些服务异常和服务中断情况进行回顾和总结，以确保相同问题下次不会再出现。为了让大家团结协作，我们希望建立一种无指责、透明的事后文化。个人不应该害怕事故，而是确信如果事故发生，团队将会响应和改进系统。备注: 其实在国内的SRE文化中，一般只有对大型，对业务有重大影响的事故才会进行复盘，但实际上如果在时间和经历允许的情况下，对于一般的普通事故也应该在小范围进行复盘，正所谓大的故障都是从不断的小问题一点一点积累的。另外，其实对于运维相关的个人而言，我们也应当及时的进行小故障复盘，以不断加强个人的故障处理和修复能力。我认为SRE的一个关键共识正是承认了系统的不完美性，追求永不停机的系统是不现实的。基于不完美系统，我们无可避免要面对和经历系统故障与失败。所以我们重要的并非找到为这个故障责任的这个人或者那个人，而是更应该创根问底地复盘这个故障和失败的根本原因是什么，以及如何避免再次出现相同的故障。系统可靠性是整个团队共同奋斗的方向，从失败中快速恢复并吸取教训，每个人放心地提出问题，应对停机，并努力改进系统。备注: 通常很多企业内部在故障复盘过程中，相关人员可能将故障和失败的根因追溯 不经意间 当做了故障定责和一系列的惩罚措施，通过一些惩戒措施来强行约定故障的发生，这种方式往往是非常不可取的，试想每个人都不想出现事故，要么是认知之外，要么是规则缺陷，永远没有一个人明知会有故障而偏偏去制造故障的。需要牢记的是: 故障是我们可以从中学习的东西，而不是让人害怕和羞耻的事情！
    </p>
    <p>
     在日常运维过程中，出现故障等事故对于我们而言其实是一个很好的复盘学习机会。通过历史监控数据，分析事故其中的根本原因，制定后续应对策略，并且通过运维平台将这些应对策略编辑成标准化、可重用、自动化的运维应用场景，为后续相同问题的处理提供标准且快捷的解决方案。这正是事后回顾这个过程最真实的价值体现。
    </p>
    <h4 id="%E6%B5%8B%E8%AF%95%E4%B8%8E%E5%8F%91%E5%B8%83">
     <strong>
      测试与发布
     </strong>
    </h4>
    <p>
     测试与发布对于整个稳定性和可靠性的主要出于一个预防的作用，预防是指尝试限制发生的事故数量，并确保在发布新代码时基础架构和服务能够保持稳定。作为一个长期从事运维工作的人，可能内心中最为恐惧的莫过于新应用版本发布。因为除了硬件和网络设备损坏这个属于天灾级别的概率事件外，新应用版本发布的第二天通常是停机与事故的高危期。所以，对于一些量级较大的产品通常会在节假日以及重要活动前夕进行封网操作，以避免新版本上线而导致的业务bug出现。而测试是在成本和风险之间找到适当的平衡活动。如果过于冒险，你们可能就会疲于应付系统失败；反过来说，如果你太保守，你就不能足够快地发布新东西，让企业在市场上生存下来。在错误预算比较多（即在一段时间内故障导致系统停机时长较少）的情况下，可以适当减少测试资源并放宽系统上线的测试和条件，让业务可以有更多的功能上线，以保持业务的敏态；在错误预算比较少（即在一段时间内故障导致系统停机时长较多）的情况下，则要增加测试资源并收紧系统上线的测试，让系统的潜在风险得到更多有效的释放，避免系统停机保持系统的稳态。这种敏态与稳态之间的平衡，需要整个运维与开发团队来共同承担。除了测试外，应用发布也是一项运维团队通常要承担的责任。SRE的一个原则是将一切可以重复性劳动代码化和工具化；此外，应用发布的复杂程度往往与系统的复杂程度成正比。因此在应用系统上规模企业，往往已经着手基于自动化框架构建自动化的应用发布过程。
    </p>
    <p>
    </p>
    <p>
    </p>
    <p class="img-center">
     <img alt="" height="293" src="https://i-blog.csdnimg.cn/blog_migrate/e4a9de0479547aea1fac7ceb6c4bbea8.png" width="720"/>
    </p>
    <p>
    </p>
    <p>
     通过自动化发布工具，我们可以构建流水线实现部署的过程中所有的操作（如编译打包、测试发布、生产准备、告警屏蔽、服务停止、数据库执行、应用部署、服务重启等）全部自动化。
    </p>
    <h4 id="%E5%AE%B9%E9%87%8F%E8%A7%84%E5%88%92">
     <strong>
      容量规划
     </strong>
    </h4>
    <p>
     容量规划是关于预测未来和发现系统极限的，容量规划也是为了确保系统可以随着时间的推移得到完善和增强。规划的主要目标是管理风险和期望，对于容量规划，涉及到将容量扩展到整个业务；所关注的期望是人们在看到业务增长时期望服务如何响应。风险是在额外的基础设施上花费时间和金钱来处理这个问题。容量规划首先是对未来预测性的分析与判断，其预测的基础正是海量的运维数据。因此，容量规划除了有相应的架构和规划团队外，一个全面的运维数据中心是实现系统容量规划的必须设施。容量趋势预警和分析将综合地从各种运维监控、流程管理等数据源中收集、整理、清洗并结构化地存储各种运维数据，将这些来自于各种工具的运维数据打通融合并且构建各种数据主题。应用这些数据主题的数据用于帮助运维人员对问题进行评估，包括：
    </p>
    <ul>
     <li>
      当前的容量是多少
     </li>
     <li>
      何时达到容量极限
     </li>
     <li>
      应该如何更改容量
     </li>
     <li>
      执行容量规划
     </li>
    </ul>
    <p>
     运维平台除了可以提供必要的数据支持外，还需要提供必要的数据可视化支持能力。运维数据可视化提供了一些必要的能力保障运维人员可以更好地利用其中的运维数据评估容量。首先，运维平台需要有极强的数据检索能力。运维平台存储着海量的运维数据，运维人员为了尝试建立和验证一个探索性场景的时候，往往多次反复检索和查询特定数据。如果运维数据分析平台的数据查询很慢或者查询角度很少的情况下，运维人员建立场景的时间就会拖得很长甚至进行不下去。因此，运维人员可通过平台可以实现关键字、统计函数、单条件、多条件、模糊多维度查找功能，以及实现海量数据秒级查询，才能更有效帮助运维人员更便捷分析数据。其二，平台需要强大的数据可视化能力。人们常说“千言万语不及一图”，运维人员经常会通过各系统的运维数据进行统计分析并生成各类实时报表，对各类运维数据（如应用日志、交易日志、系统日志）进行多维度、多角度深入分析、预测及可视化展现，将他们分析的预测结果和经验向他人表达和推广。
    </p>
    <h4 id="%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7%E5%BC%80%E5%8F%91">
     <strong>
      自动化工具开发
     </strong>
    </h4>
    <p>
     SRE不仅涉及运营，还涉及软件开发，当然这部分指的是和运维以及SRE领域相关的工具和平台开发。在Google的SRE体系中，SRE工程师将花费大约一半的时间来开发新的工具和服务，这些工具的一部分用于自动化一些手动任务，而其他部分用于来不断填补和修复整个SRE体系内部的其他系统。通过编写代码把自己和其他人从重复的工作中解放出来，如果我们不需要人类来完成任务，那么就编写代码，这样人类就不需要参与其中了。SRE从内心上鄙视重复性的工作，将从原有的人工加被动响应，转变为更高效、更为自动化的运维体系。
    </p>
    <p>
     自动化运维框架：
    </p>
    <p>
    </p>
    <p>
    </p>
    <p class="img-center">
     <img alt="" height="304" src="https://i-blog.csdnimg.cn/blog_migrate/5d7ae926b9c02c6d03e1c7adb374adb3.png" width="720"/>
    </p>
    <p>
    </p>
    <p>
     自动化运维工具的优势和必要性:
    </p>
    <ul>
     <li>
      提高效率: 由程序自动化操作，有效地降低运维人力资源的投入，也让运维人员的精力得以释放并投向更为重要的领域。
     </li>
     <li>
      操作的标准化: 将原来许多复杂、易错的手工操作实现统一运维操作入口，实现运维操作白屏化，提升运维操作的可管理性；同时，减少由于运维人员情绪带来手工误操作，避免“从删库到跑路”这样的悲剧的发生。
     </li>
     <li>
      运维经验能力的传承: 运维自动化工具将原来许多运维团队积累的经验以代码方式总结为各种运维工具，实现自动化和白屏化的运维操作。运维团队的后来者，可以有效地继承、重复使用并优化它们。这种代码化的工作传承，将个人能力转变为团队能力，并减少人员流动带来对工作的影响。
     </li>
    </ul>
    <p>
     构建自动化运维体系就必须以运维场景为基础，这些运维场景是在本企业内反复迭代和打造，是企业中最常用的运维场景。比如常见的运维场景：软件安装部署、应用发布交付、资产管理、告警自动处理、故障分析、资源申请、自动化巡检等等。因此，整个自动化运维体系建设时也应支持多种不同类型的自动化作业配置能力，通过简单的脚本开发、场景配置和可视化定制流程实现更多运维场景的实现。
    </p>
    <h4 id="%E7%94%A8%E6%88%B7%E4%BD%93%E9%AA%8C">
     <strong>
      用户体验
     </strong>
    </h4>
    <p>
     用户体验这一层要说的是，作为SRE来讲，从用户的角度来保证业务的稳定性和可用性才是最终目标。这个才传统意义上的运维人员是不会关注这一点的，因为大家通常只会考虑到我底层运维的系统或底层资源是否稳定，但实际上整个业务的稳定才是SRE需要关心的问题，而业务的稳定性和可用性通常需要站在用户的角度来模拟和衡量整体的可用性和可靠性。
    </p>
    <p>
     在前面提到的所有SRE相关的工作范畴，无论是监控、事故响应、回顾、测试与发布、容量规划以及构建自动化工具，无非都是为了提供更好的系统用户业务体验而服务的。因此，我们在运维的过程中无不需要注意关注系统的用户体验。
    </p>
    <p>
     而在实际运维工作中，我们往往可以通过应用日志、监控数据、业务拔测等业务相关的用户体验信息。在运维数据平台中，通过这些用户体验监测数据之间的关联和串联，重现用户的最终业务调用链路以及各应用环节对性能数据的关系。最终形成从业务用户体验数据入手，逐步实现系统运行状态数据、设备运行状态数据链路的打通，让运维体系实现以最终用户体验为中心的目标。
    </p>
    <p>
     这些用户体验的信息，对于运维团队掌握客户整体的用户体验情况、系统可用性的监测以及系统针对性的优化提供着无可替代的作用。
    </p>
    <p>
     其实，SRE运维体系更为强调以用户的体验为核心，以自动化和运维数据为手段，实现应用业务连续性保障，从这个点出发，我们会发现和以往的传统运维还是有很大的区别的，我们不再仅仅是单纯的安装和部署工程师，我们需要通过一系列的技术手段来不断保障上层业务的稳定性和可靠性。
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f35333637383930342f:61727469636c652f64657461696c732f313333363839343539" class_="artid" style="display:none">
 </p>
</div>


