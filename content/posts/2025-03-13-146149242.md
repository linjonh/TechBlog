---
layout: post
title: "2025.3.2机器学习笔记PINN文献阅读"
date: 2025-03-13 17:42:58 +0800
description: "本周读了一篇PINN在水文应用上的论文，虽然与本人目前的研究方向有所偏差，但是里面的研究方法还是值得借鉴。圣维南方程（SVE）和平流-扩散方程（ADE）常用于解决地表水溶质输运问题。但求解SVE - ADE耦合方程存在很多挑战。传统数值方法存在不连续性、数值误差、计算成本高等问题，且对噪声数据适应性差。在水文学领域，PINN已广泛应用于水文领域，但目前缺乏将其应用于求解SVE-ADE耦合方程的研究。本论文目的是评估PINN在不同条件下求解SVE、ADE及其耦合方程的性能和解决如何构建PINN模型、优化模型参"
keywords: "2025.3.2机器学习笔记：PINN文献阅读"
categories: ['读研周报', '机器学习']
tags: ['笔记', '机器学习', '人工智能']
artid: "146149242"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146149242
    alt: "2025.3.2机器学习笔记PINN文献阅读"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146149242
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146149242
cover: https://bing.ee123.net/img/rand?artid=146149242
image: https://bing.ee123.net/img/rand?artid=146149242
img: https://bing.ee123.net/img/rand?artid=146149242
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     2025.3.2机器学习笔记：PINN文献阅读
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <h2>
     <a id="_1">
     </a>
     一、文献阅读
    </h2>
    <h3>
     <a id="_2">
     </a>
     题目信息
    </h3>
    <ul>
     <li>
      <strong>
       题目：
      </strong>
      1-D coupled surface flow and transport equations revisited via the physics-informed neural network approach
     </li>
     <li>
      <strong>
       期刊：
      </strong>
      Journal of Hydrology
     </li>
     <li>
      <strong>
       作者：
      </strong>
      Jie Niu, Wei Xu, Han Qiu, Shan Li, Feifei Dong
     </li>
     <li>
      <strong>
       发表时间：
      </strong>
      2023
     </li>
     <li>
      <strong>
       文章链接：
      </strong>
      <a href="https://www.sciencedirect.com/science/article/pii/S0022169423009903" rel="nofollow">
       https://www.sciencedirect.com/science/article/pii/S0022169423009903
      </a>
     </li>
    </ul>
    <h3>
     <a id="_8">
     </a>
     摘要
    </h3>
    <p>
     本周读了一篇PINN在水文应用上的论文，虽然与本人目前的研究方向有所不同，但是里面的研究方法还是值得借鉴。圣维南方程（SVE）和平流-扩散方程（ADE）常用于解决地表水溶质输运问题。但求解SVE - ADE耦合方程存在很多挑战。传统数值方法存在不连续性、数值误差、计算成本高等问题，且对噪声数据适应性差。在水文学领域，PINN已广泛应用于水文领域，但目前缺乏将其应用于求解SVE-ADE耦合方程的研究。本论文目的是评估PINN在不同条件下求解SVE、ADE及其耦合方程的性能和解决如何构建PINN模型、优化模型参数和结构，以及PINN是否适用于含噪声数据的反问题求解等问题。论文中作者构建了PINN模型，在不同初始和边界条件下求解相关方程，对比PINN结果与解析或数值解以评估其准确性和效率。实验结果表明，PINN能在处理少量数据、无网格离散化等方面优于传统数值方法，且适用于含噪声数据的反问题求解。
    </p>
    <h3>
     <a id="Abstract_10">
     </a>
     Abstract
    </h3>
    <p>
     This week, I reviewed a paper on the use of Physics-Informed Neural Networks (PINNs) in hydrology, which, though slightly off my current research path, offers useful methods worth considering. The Saint-Venant Equations (SVE) and Advection-Diffusion Equation (ADE) are standard tools for modeling solute transport in surface water. However, solving the coupled SVE-ADE system is challenging due to issues like discontinuities, numerical errors, high computational costs, and poor handling of noisy data in traditional methods. While PINNs are widely used in hydrology, their application to the coupled SVE-ADE equations remains underexplored. This paper assesses PINNs’ performance in solving SVE, ADE, and their coupling under various conditions, focusing on model construction, parameter optimization, and suitability for noisy data inverse problems. The authors built a PINN model, tested it with different initial and boundary conditions, and compared results with analytical or numerical solutions to evaluate accuracy and efficiency. Results show that PINNs outperform traditional methods in handling limited data and mesh-free approaches, and they are effective for inverse problems with noisy data.
    </p>
    <h3>
     <a id="_12">
     </a>
     创新点
    </h3>
    <p>
     作者运用PINN方法求解耦合的SVE - ADE方程，能在单个模型中同时模拟流场和浓度场，节省时间并减少误差。且PINN无需时间步迭代，利用散点配点，更灵活且能降低计算成本，还能处理复杂几何和边界条件，在解决含噪声反问题上表现还算可以。
    </p>
    <h3>
     <a id="_14">
     </a>
     网络架构
    </h3>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/b5798c223a10494387c211d60da36b62.jpeg">
      <br/>
      ADE的数学表达式为:
      <br/>
      <span class="katex--display">
       <span class="katex-display">
        <span class="katex">
         <span class="katex-mathml">
          ∂ 
           
          
            C 
           
          
          
          
            ∂ 
           
          
            t 
           
          
         
        
          = 
         
        
          D 
         
         
          
           
           
             ∂ 
            
           
             2 
            
           
          
            C 
           
          
          
          
            ∂ 
           
           
           
             x 
            
           
             2 
            
           
          
         
        
          − 
         
        
          v 
         
         
          
          
            ∂ 
           
          
            C 
           
          
          
          
            ∂ 
           
          
            x 
           
          
         
        
          − 
         
        
          k 
         
        
          C 
         
        
       
         \frac{\partial C}{\partial t} = D \frac{\partial^2 C}{\partial x^2} - v \frac{\partial C}{\partial x} - k C
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 2.0574em; vertical-align: -0.686em;">
           </span>
           <span class="mord">
            <span class="mopen nulldelimiter">
            </span>
            <span class="mfrac">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 1.3714em;">
                <span class="" style="top: -2.314em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="mord">
                  <span class="mord" style="margin-right: 0.0556em;">
                   ∂
                  </span>
                  <span class="mord mathnormal">
                   t
                  </span>
                 </span>
                </span>
                <span class="" style="top: -3.23em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="frac-line" style="border-bottom-width: 0.04em;">
                 </span>
                </span>
                <span class="" style="top: -3.677em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="mord">
                  <span class="mord" style="margin-right: 0.0556em;">
                   ∂
                  </span>
                  <span class="mord mathnormal" style="margin-right: 0.0715em;">
                   C
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                ​
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 0.686em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="mclose nulldelimiter">
            </span>
           </span>
           <span class="mspace" style="margin-right: 0.2778em;">
           </span>
           <span class="mrel">
            =
           </span>
           <span class="mspace" style="margin-right: 0.2778em;">
           </span>
          </span>
          <span class="base">
           <span class="strut" style="height: 2.1771em; vertical-align: -0.686em;">
           </span>
           <span class="mord mathnormal" style="margin-right: 0.0278em;">
            D
           </span>
           <span class="mord">
            <span class="mopen nulldelimiter">
            </span>
            <span class="mfrac">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 1.4911em;">
                <span class="" style="top: -2.314em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="mord">
                  <span class="mord" style="margin-right: 0.0556em;">
                   ∂
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal">
                    x
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.7401em;">
                       <span class="" style="top: -2.989em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          2
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="" style="top: -3.23em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="frac-line" style="border-bottom-width: 0.04em;">
                 </span>
                </span>
                <span class="" style="top: -3.677em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                   <span class="mord" style="margin-right: 0.0556em;">
                    ∂
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.8141em;">
                       <span class="" style="top: -3.063em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          2
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mord mathnormal" style="margin-right: 0.0715em;">
                   C
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                ​
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 0.686em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="mclose nulldelimiter">
            </span>
           </span>
           <span class="mspace" style="margin-right: 0.2222em;">
           </span>
           <span class="mbin">
            −
           </span>
           <span class="mspace" style="margin-right: 0.2222em;">
           </span>
          </span>
          <span class="base">
           <span class="strut" style="height: 2.0574em; vertical-align: -0.686em;">
           </span>
           <span class="mord mathnormal" style="margin-right: 0.0359em;">
            v
           </span>
           <span class="mord">
            <span class="mopen nulldelimiter">
            </span>
            <span class="mfrac">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 1.3714em;">
                <span class="" style="top: -2.314em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="mord">
                  <span class="mord" style="margin-right: 0.0556em;">
                   ∂
                  </span>
                  <span class="mord mathnormal">
                   x
                  </span>
                 </span>
                </span>
                <span class="" style="top: -3.23em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="frac-line" style="border-bottom-width: 0.04em;">
                 </span>
                </span>
                <span class="" style="top: -3.677em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="mord">
                  <span class="mord" style="margin-right: 0.0556em;">
                   ∂
                  </span>
                  <span class="mord mathnormal" style="margin-right: 0.0715em;">
                   C
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                ​
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 0.686em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="mclose nulldelimiter">
            </span>
           </span>
           <span class="mspace" style="margin-right: 0.2222em;">
           </span>
           <span class="mbin">
            −
           </span>
           <span class="mspace" style="margin-right: 0.2222em;">
           </span>
          </span>
          <span class="base">
           <span class="strut" style="height: 0.6944em;">
           </span>
           <span class="mord mathnormal" style="margin-right: 0.0315em;">
            k
           </span>
           <span class="mord mathnormal" style="margin-right: 0.0715em;">
            C
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      其中：C为溶质浓度； t为时间；
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         x 
        
       
      
        x
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.4306em;">
          </span>
          <span class="mord mathnormal">
           x
          </span>
         </span>
        </span>
       </span>
      </span>
      :为空间维度；
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         D 
        
       
      
        D
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           D
          </span>
         </span>
        </span>
       </span>
      </span>
      为扩散系数；
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         v 
        
       
      
        v
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.4306em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           v
          </span>
         </span>
        </span>
       </span>
      </span>
      为流速；
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         k 
        
       
      
        k
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6944em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0315em;">
           k
          </span>
         </span>
        </span>
       </span>
      </span>
      为一阶衰减率。
      <br/>
      此外，论文描述了 SVE-ADE 的联合形式来拟合方程基于质量平衡，考虑了时间变化的流量，表达如下：
      <br/>
      <span class="katex--display">
       <span class="katex-display">
        <span class="katex">
         <span class="katex-mathml">
          ∂ 
           
          
            ( 
           
           
           
             A 
            
           
             c 
            
           
          
            C 
           
          
            ) 
           
          
          
          
            ∂ 
           
          
            t 
           
          
         
        
          = 
         
        
          − 
         
         
          
          
            ∂ 
           
          
            ( 
           
          
            Q 
           
          
            C 
           
          
            ) 
           
          
          
          
            ∂ 
           
          
            x 
           
          
         
        
       
         \frac{\partial (A_c C)}{\partial t} = -\frac{\partial (Q C)}{\partial x}
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 2.113em; vertical-align: -0.686em;">
           </span>
           <span class="mord">
            <span class="mopen nulldelimiter">
            </span>
            <span class="mfrac">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 1.427em;">
                <span class="" style="top: -2.314em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="mord">
                  <span class="mord" style="margin-right: 0.0556em;">
                   ∂
                  </span>
                  <span class="mord mathnormal">
                   t
                  </span>
                 </span>
                </span>
                <span class="" style="top: -3.23em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="frac-line" style="border-bottom-width: 0.04em;">
                 </span>
                </span>
                <span class="" style="top: -3.677em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="mord">
                  <span class="mord" style="margin-right: 0.0556em;">
                   ∂
                  </span>
                  <span class="mopen">
                   (
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal">
                    A
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.1514em;">
                       <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mathnormal mtight">
                          c
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.15em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mord mathnormal" style="margin-right: 0.0715em;">
                   C
                  </span>
                  <span class="mclose">
                   )
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                ​
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 0.686em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="mclose nulldelimiter">
            </span>
           </span>
           <span class="mspace" style="margin-right: 0.2778em;">
           </span>
           <span class="mrel">
            =
           </span>
           <span class="mspace" style="margin-right: 0.2778em;">
           </span>
          </span>
          <span class="base">
           <span class="strut" style="height: 2.113em; vertical-align: -0.686em;">
           </span>
           <span class="mord">
            −
           </span>
           <span class="mord">
            <span class="mopen nulldelimiter">
            </span>
            <span class="mfrac">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 1.427em;">
                <span class="" style="top: -2.314em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="mord">
                  <span class="mord" style="margin-right: 0.0556em;">
                   ∂
                  </span>
                  <span class="mord mathnormal">
                   x
                  </span>
                 </span>
                </span>
                <span class="" style="top: -3.23em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="frac-line" style="border-bottom-width: 0.04em;">
                 </span>
                </span>
                <span class="" style="top: -3.677em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="mord">
                  <span class="mord" style="margin-right: 0.0556em;">
                   ∂
                  </span>
                  <span class="mopen">
                   (
                  </span>
                  <span class="mord mathnormal" style="margin-right: 0.0715em;">
                   QC
                  </span>
                  <span class="mclose">
                   )
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                ​
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 0.686em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="mclose nulldelimiter">
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </img>
    </p>
    <p>
     图1展示了论文的PINN架构，如下图所示：
     <br/>
     <strong>
      输入层
     </strong>
     ：接受空间变量 x 和时间变量 t，表示为 (x,t)。
     <br/>
     <strong>
      神经网络
     </strong>
     ：一个多层全连接前馈神经网络（NN），参数为 (w,b)
     <br/>
     <strong>
      输出层
     </strong>
     ：神经网络输出逼近解 U，包括流量 Q(x,t) 和浓度 C(x,t)。
     <br/>
     物理约束的残差如下：
     <br/>
     SVE残差为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
       
         = 
        
        
         
         
           ∂ 
          
         
           Q 
          
         
         
         
           ∂ 
          
         
           x 
          
         
        
       
         + 
        
        
         
         
           ∂ 
          
          
          
            A 
           
          
            c 
           
          
         
         
         
           ∂ 
          
         
           t 
          
         
        
       
      
        d=\frac{\partial Q}{\partial x}+\frac{\partial A_{c}}{\partial t}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.2772em; vertical-align: -0.345em;">
         </span>
         <span class="mord">
          <span class="mopen nulldelimiter">
          </span>
          <span class="mfrac">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.9322em;">
              <span class="" style="top: -2.655em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight" style="margin-right: 0.0556em;">
                  ∂
                 </span>
                 <span class="mord mathnormal mtight">
                  x
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.23em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="frac-line" style="border-bottom-width: 0.04em;">
               </span>
              </span>
              <span class="" style="top: -3.4461em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight" style="margin-right: 0.0556em;">
                  ∂
                 </span>
                 <span class="mord mathnormal mtight">
                  Q
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.345em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose nulldelimiter">
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.2412em; vertical-align: -0.345em;">
         </span>
         <span class="mord">
          <span class="mopen nulldelimiter">
          </span>
          <span class="mfrac">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8962em;">
              <span class="" style="top: -2.655em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight" style="margin-right: 0.0556em;">
                  ∂
                 </span>
                 <span class="mord mathnormal mtight">
                  t
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.23em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="frac-line" style="border-bottom-width: 0.04em;">
               </span>
              </span>
              <span class="" style="top: -3.4101em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight" style="margin-right: 0.0556em;">
                  ∂
                 </span>
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   A
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.1645em;">
                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         <span class="mord mathnormal mtight">
                          c
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      ​
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.143em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.345em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose nulldelimiter">
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     ADE残差为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        g 
        
       
         = 
        
        
         
         
           ∂ 
          
         
           C 
          
         
         
         
           ∂ 
          
         
           t 
          
         
        
       
         + 
        
       
         v 
        
        
         
         
           ∂ 
          
         
           C 
          
         
         
         
           ∂ 
          
         
           x 
          
         
        
       
         − 
        
       
         D 
        
        
         
          
          
            ∂ 
           
          
            2 
           
          
         
           C 
          
         
         
         
           ∂ 
          
          
          
            x 
           
          
            2 
           
          
         
        
       
      
        g=\frac{\partial C}{\partial t}+v \frac{\partial C}{\partial x}-D \frac{\partial^{2} C}{\partial x^{2}}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          g
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.2251em; vertical-align: -0.345em;">
         </span>
         <span class="mord">
          <span class="mopen nulldelimiter">
          </span>
          <span class="mfrac">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8801em;">
              <span class="" style="top: -2.655em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight" style="margin-right: 0.0556em;">
                  ∂
                 </span>
                 <span class="mord mathnormal mtight">
                  t
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.23em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="frac-line" style="border-bottom-width: 0.04em;">
               </span>
              </span>
              <span class="" style="top: -3.394em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight" style="margin-right: 0.0556em;">
                  ∂
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0715em;">
                  C
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.345em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose nulldelimiter">
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.2251em; vertical-align: -0.345em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          v
         </span>
         <span class="mord">
          <span class="mopen nulldelimiter">
          </span>
          <span class="mfrac">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8801em;">
              <span class="" style="top: -2.655em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight" style="margin-right: 0.0556em;">
                  ∂
                 </span>
                 <span class="mord mathnormal mtight">
                  x
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.23em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="frac-line" style="border-bottom-width: 0.04em;">
               </span>
              </span>
              <span class="" style="top: -3.394em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight" style="margin-right: 0.0556em;">
                  ∂
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0715em;">
                  C
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.345em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose nulldelimiter">
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          −
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.3629em; vertical-align: -0.345em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          D
         </span>
         <span class="mord">
          <span class="mopen nulldelimiter">
          </span>
          <span class="mfrac">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 1.0179em;">
              <span class="" style="top: -2.655em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight" style="margin-right: 0.0556em;">
                  ∂
                 </span>
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   x
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.7463em;">
                      <span class="" style="top: -2.786em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         <span class="mord mtight">
                          2
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.23em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="frac-line" style="border-bottom-width: 0.04em;">
               </span>
              </span>
              <span class="" style="top: -3.394em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  <span class="mord mtight" style="margin-right: 0.0556em;">
                   ∂
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.8913em;">
                      <span class="" style="top: -2.931em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         <span class="mord mtight">
                          2
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0715em;">
                  C
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.345em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose nulldelimiter">
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     SVE-ADE残差为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        h 
        
       
         = 
        
        
        
          { 
         
         
          
           
            
             
              
               
               
                 ∂ 
                
               
                 Q 
                
               
               
               
                 ∂ 
                
               
                 x 
                
               
              
             
               + 
              
              
               
               
                 ∂ 
                
                
                
                  A 
                 
                
                  c 
                 
                
               
               
               
                 ∂ 
                
               
                 x 
                
               
              
             
            
           
          
          
           
            
             
              
               
               
                 ∂ 
                
                
                
                  ( 
                 
                 
                 
                   A 
                  
                 
                   c 
                  
                 
                
                  C 
                 
                
                  ) 
                 
                
               
               
               
                 ∂ 
                
               
                 t 
                
               
              
             
               + 
              
              
               
               
                 ∂ 
                
               
                 ( 
                
               
                 Q 
                
               
                 C 
                
               
                 ) 
                
               
               
               
                 ∂ 
                
               
                 x 
                
               
              
             
            
           
          
         
        
       
      
        h=\left\{\begin{array}{l}\frac{\partial Q}{\partial x}+\frac{\partial A_{c}}{\partial x} \\ \frac{\partial\left(A_{c} C\right)}{\partial t}+\frac{\partial(Q C)}{\partial x}\end{array}\right.
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal">
          h
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 2.6622em; vertical-align: -1.0811em;">
         </span>
         <span class="minner">
          <span class="mopen delimcenter" style="top: 0em;">
           <span class="delimsizing size3">
            {
            <!-- -->
           </span>
          </span>
          <span class="mord">
           <span class="mtable">
            <span class="arraycolsep" style="width: 0.5em;">
            </span>
            <span class="col-align-l">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 1.5811em;">
                <span class="" style="top: -3.6589em;">
                 <span class="pstrut" style="height: 3.01em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                   <span class="mopen nulldelimiter">
                   </span>
                   <span class="mfrac">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.9322em;">
                       <span class="" style="top: -2.655em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mtight" style="margin-right: 0.0556em;">
                           ∂
                          </span>
                          <span class="mord mathnormal mtight">
                           x
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -3.23em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="frac-line" style="border-bottom-width: 0.04em;">
                        </span>
                       </span>
                       <span class="" style="top: -3.4461em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mtight" style="margin-right: 0.0556em;">
                           ∂
                          </span>
                          <span class="mord mathnormal mtight">
                           Q
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.345em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mclose nulldelimiter">
                   </span>
                  </span>
                  <span class="mspace" style="margin-right: 0.2222em;">
                  </span>
                  <span class="mbin">
                   +
                  </span>
                  <span class="mspace" style="margin-right: 0.2222em;">
                  </span>
                  <span class="mord">
                   <span class="mopen nulldelimiter">
                   </span>
                   <span class="mfrac">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.8962em;">
                       <span class="" style="top: -2.655em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mtight" style="margin-right: 0.0556em;">
                           ∂
                          </span>
                          <span class="mord mathnormal mtight">
                           x
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -3.23em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="frac-line" style="border-bottom-width: 0.04em;">
                        </span>
                       </span>
                       <span class="" style="top: -3.4101em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mtight" style="margin-right: 0.0556em;">
                           ∂
                          </span>
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight">
                            A
                           </span>
                           <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.1645em;">
                               <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                <span class="pstrut" style="height: 2.5em;">
                                </span>
                                <span class="sizing reset-size3 size1 mtight">
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   c
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               ​
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.143em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.345em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mclose nulldelimiter">
                   </span>
                  </span>
                 </span>
                </span>
                <span class="" style="top: -2.2889em;">
                 <span class="pstrut" style="height: 3.01em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                   <span class="mopen nulldelimiter">
                   </span>
                   <span class="mfrac">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 1.01em;">
                       <span class="" style="top: -2.655em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mtight" style="margin-right: 0.0556em;">
                           ∂
                          </span>
                          <span class="mord mathnormal mtight">
                           t
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -3.23em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="frac-line" style="border-bottom-width: 0.04em;">
                        </span>
                       </span>
                       <span class="" style="top: -3.485em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mtight" style="margin-right: 0.0556em;">
                           ∂
                          </span>
                          <span class="minner mtight">
                           <span class="mopen mtight delimcenter" style="top: 0em;">
                            <span class="mtight">
                             (
                            </span>
                           </span>
                           <span class="mord mtight">
                            <span class="mord mathnormal mtight">
                             A
                            </span>
                            <span class="msupsub">
                             <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                               <span class="vlist" style="height: 0.1645em;">
                                <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                 <span class="pstrut" style="height: 2.5em;">
                                 </span>
                                 <span class="sizing reset-size3 size1 mtight">
                                  <span class="mord mtight">
                                   <span class="mord mathnormal mtight">
                                    c
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                               <span class="vlist-s">
                                ​
                               </span>
                              </span>
                              <span class="vlist-r">
                               <span class="vlist" style="height: 0.143em;">
                                <span class="">
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                           <span class="mord mathnormal mtight" style="margin-right: 0.0715em;">
                            C
                           </span>
                           <span class="mclose mtight delimcenter" style="top: 0em;">
                            <span class="mtight">
                             )
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.345em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mclose nulldelimiter">
                   </span>
                  </span>
                  <span class="mspace" style="margin-right: 0.2222em;">
                  </span>
                  <span class="mbin">
                   +
                  </span>
                  <span class="mspace" style="margin-right: 0.2222em;">
                  </span>
                  <span class="mord">
                   <span class="mopen nulldelimiter">
                   </span>
                   <span class="mfrac">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 1.01em;">
                       <span class="" style="top: -2.655em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mtight" style="margin-right: 0.0556em;">
                           ∂
                          </span>
                          <span class="mord mathnormal mtight">
                           x
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -3.23em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="frac-line" style="border-bottom-width: 0.04em;">
                        </span>
                       </span>
                       <span class="" style="top: -3.485em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mtight" style="margin-right: 0.0556em;">
                           ∂
                          </span>
                          <span class="mopen mtight">
                           (
                          </span>
                          <span class="mord mathnormal mtight" style="margin-right: 0.0715em;">
                           QC
                          </span>
                          <span class="mclose mtight">
                           )
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.345em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mclose nulldelimiter">
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                ​
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 1.0811em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="arraycolsep" style="width: 0.5em;">
            </span>
           </span>
          </span>
          <span class="mclose nulldelimiter">
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     所以其损失函数为：
     <br/>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         M 
         
        
          S 
         
         
         
           E 
          
          
          
            Q 
           
          
            , 
           
          
            u 
           
          
         
        
          + 
         
        
          M 
         
        
          S 
         
         
         
           E 
          
          
          
            Q 
           
          
            , 
           
          
            f 
           
          
         
        
          + 
         
        
          M 
         
        
          S 
         
         
         
           E 
          
          
          
            C 
           
          
            , 
           
          
            u 
           
          
         
        
          + 
         
        
          M 
         
        
          S 
         
         
         
           E 
          
          
          
            C 
           
          
            , 
           
          
            f 
           
          
         
        
       
         M S E_{Q, u}+M S E_{Q, f}+M S E_{C, u}+M S E_{C, f}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0576em;">
           MS
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0576em;">
            E
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3283em;">
               <span class="" style="top: -2.55em; margin-left: -0.0576em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   Q
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mathnormal mtight">
                   u
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           +
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0576em;">
           MS
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0576em;">
            E
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3361em;">
               <span class="" style="top: -2.55em; margin-left: -0.0576em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   Q
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mathnormal mtight" style="margin-right: 0.1076em;">
                   f
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           +
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0576em;">
           MS
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0576em;">
            E
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3283em;">
               <span class="" style="top: -2.55em; margin-left: -0.0576em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0715em;">
                   C
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mathnormal mtight">
                   u
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           +
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0576em;">
           MS
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0576em;">
            E
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3361em;">
               <span class="" style="top: -2.55em; margin-left: -0.0576em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0715em;">
                   C
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mathnormal mtight" style="margin-right: 0.1076em;">
                   f
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     其中：
    </p>
    <ol>
     <li>
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         M 
         
        
          S 
         
         
         
           E 
          
          
          
            Q 
           
          
            , 
           
          
            u 
           
          
         
        
       
         M S E_{Q, u}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0576em;">
           MS
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0576em;">
            E
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3283em;">
               <span class="" style="top: -2.55em; margin-left: -0.0576em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   Q
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mathnormal mtight">
                   u
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ，是流量Q关于初始条件和边界条件
      <br/>
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         M 
         
        
          S 
         
         
         
           E 
          
          
          
            Q 
           
          
            , 
           
          
            u 
           
          
         
        
          = 
         
         
         
           1 
          
          
          
            N 
           
          
            u 
           
          
         
         
         
           ∑ 
          
          
          
            i 
           
          
            = 
           
          
            1 
           
          
          
          
            N 
           
          
            u 
           
          
         
         
          
          
            [ 
           
          
            Q 
           
           
           
             ( 
            
            
            
              x 
             
            
              i 
             
            
           
             , 
            
            
            
              t 
             
            
              i 
             
            
           
             ; 
            
           
             w 
            
           
             , 
            
           
             b 
            
           
             ) 
            
           
          
            − 
           
           
           
             Q 
            
           
             i 
            
           
             ∗ 
            
           
          
            ] 
           
          
         
           2 
          
         
        
       
         M S E_{Q, u}=\frac{1}{N_u} \sum_{i=1}^{N_u}\left[Q\left(x_i, t_i ; w, b\right)-Q_i^*\right]^2
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0576em;">
           MS
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0576em;">
            E
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3283em;">
               <span class="" style="top: -2.55em; margin-left: -0.0576em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   Q
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mathnormal mtight">
                   u
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1.4263em; vertical-align: -0.4451em;">
          </span>
          <span class="mord">
           <span class="mopen nulldelimiter">
           </span>
           <span class="mfrac">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.8451em;">
               <span class="" style="top: -2.655em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                    N
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.1645em;">
                       <span class="" style="top: -2.357em; margin-left: -0.109em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mathnormal mtight">
                          u
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.23em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="frac-line" style="border-bottom-width: 0.04em;">
                </span>
               </span>
               <span class="" style="top: -3.394em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   1
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.4451em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mclose nulldelimiter">
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mop">
           <span class="mop op-symbol small-op" style="position: relative; top: 0em;">
            ∑
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.9812em;">
               <span class="" style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   i
                  </span>
                  <span class="mrel mtight">
                   =
                  </span>
                  <span class="mord mtight">
                   1
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.2029em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                    N
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.1645em;">
                       <span class="" style="top: -2.357em; margin-left: -0.109em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mathnormal mtight">
                          u
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2997em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="minner">
           <span class="minner">
            <span class="mopen delimcenter" style="top: 0em;">
             [
            </span>
            <span class="mord mathnormal">
             Q
            </span>
            <span class="mspace" style="margin-right: 0.1667em;">
            </span>
            <span class="minner">
             <span class="mopen delimcenter" style="top: 0em;">
              (
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               x
              </span>
              <span class="msupsub">
               <span class="vlist-t vlist-t2">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.3117em;">
                  <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mathnormal mtight">
                     i
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="vlist-s">
                  ​
                 </span>
                </span>
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.15em;">
                  <span class="">
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="mpunct">
              ,
             </span>
             <span class="mspace" style="margin-right: 0.1667em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               t
              </span>
              <span class="msupsub">
               <span class="vlist-t vlist-t2">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.3117em;">
                  <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mathnormal mtight">
                     i
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="vlist-s">
                  ​
                 </span>
                </span>
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.15em;">
                  <span class="">
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="mpunct">
              ;
             </span>
             <span class="mspace" style="margin-right: 0.1667em;">
             </span>
             <span class="mord mathnormal" style="margin-right: 0.0269em;">
              w
             </span>
             <span class="mpunct">
              ,
             </span>
             <span class="mspace" style="margin-right: 0.1667em;">
             </span>
             <span class="mord mathnormal">
              b
             </span>
             <span class="mclose delimcenter" style="top: 0em;">
              )
             </span>
            </span>
            <span class="mspace" style="margin-right: 0.2222em;">
            </span>
            <span class="mbin">
             −
            </span>
            <span class="mspace" style="margin-right: 0.2222em;">
            </span>
            <span class="mord">
             <span class="mord mathnormal">
              Q
             </span>
             <span class="msupsub">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 0.6887em;">
                 <span class="" style="top: -2.4413em; margin-left: 0em; margin-right: 0.05em;">
                  <span class="pstrut" style="height: 2.7em;">
                  </span>
                  <span class="sizing reset-size6 size3 mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -3.063em; margin-right: 0.05em;">
                  <span class="pstrut" style="height: 2.7em;">
                  </span>
                  <span class="sizing reset-size6 size3 mtight">
                   <span class="mbin mtight">
                    ∗
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 ​
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 0.2587em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="mclose delimcenter" style="top: 0em;">
             ]
            </span>
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.954em;">
               <span class="" style="top: -3.2029em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  2
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         N 
          
         
           u 
          
         
        
       
         N_u
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.8333em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.109em;">
            N
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.1514em;">
               <span class="" style="top: -2.55em; margin-left: -0.109em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  u
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      个初始/边界条件点 ；
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         Q 
          
         
           i 
          
         
           ∗ 
          
         
        
       
         Q_i^*
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.9474em; vertical-align: -0.2587em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            Q
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.6887em;">
               <span class="" style="top: -2.4413em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mbin mtight">
                  ∗
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2587em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      为真实值；
     </li>
     <li>
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         M 
         
        
          S 
         
         
         
           E 
          
          
          
            Q 
           
          
            , 
           
          
            f 
           
          
         
        
       
         M S E_{Q, f}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0576em;">
           MS
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0576em;">
            E
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3361em;">
               <span class="" style="top: -2.55em; margin-left: -0.0576em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   Q
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mathnormal mtight" style="margin-right: 0.1076em;">
                   f
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      是流量Q关于 SVE 方程残差的均方误差。
      <br/>
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         MSE 
          
          
          
            Q 
           
          
            , 
           
          
            f 
           
          
         
        
          = 
         
         
         
           1 
          
          
          
            N 
           
          
            f 
           
          
         
         
         
           ∑ 
          
          
          
            j 
           
          
            = 
           
          
            1 
           
          
          
          
            N 
           
          
            f 
           
          
         
         
          
          
            [ 
           
           
           
             f 
            
           
             Q 
            
           
          
            ( 
           
           
           
             x 
            
           
             j 
            
           
          
            , 
           
           
           
             t 
            
           
             j 
            
           
          
            ; 
           
          
            w 
           
          
            , 
           
          
            b 
           
          
            ) 
           
          
            ] 
           
          
         
           2 
          
         
        
       
         \text{MSE}_{Q,f} = \frac{1}{N_f} \sum_{j=1}^{N_f} \left[ f_Q(x_j, t_j; w, b) \right]^2
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord text">
            <span class="mord">
             MSE
            </span>
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3361em;">
               <span class="" style="top: -2.55em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   Q
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mathnormal mtight" style="margin-right: 0.1076em;">
                   f
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1.5743em; vertical-align: -0.5481em;">
          </span>
          <span class="mord">
           <span class="mopen nulldelimiter">
           </span>
           <span class="mfrac">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.8451em;">
               <span class="" style="top: -2.655em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                    N
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3448em;">
                       <span class="" style="top: -2.3488em; margin-left: -0.109em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mathnormal mtight" style="margin-right: 0.1076em;">
                          f
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.2901em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.23em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="frac-line" style="border-bottom-width: 0.04em;">
                </span>
               </span>
               <span class="" style="top: -3.394em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   1
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.5481em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mclose nulldelimiter">
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mop">
           <span class="mop op-symbol small-op" style="position: relative; top: 0em;">
            ∑
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.0262em;">
               <span class="" style="top: -2.4231em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                   j
                  </span>
                  <span class="mrel mtight">
                   =
                  </span>
                  <span class="mord mtight">
                   1
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.2479em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                    N
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3448em;">
                       <span class="" style="top: -2.3488em; margin-left: -0.109em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mathnormal mtight" style="margin-right: 0.1076em;">
                          f
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.2901em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.413em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="minner">
           <span class="minner">
            <span class="mopen delimcenter" style="top: 0em;">
             [
            </span>
            <span class="mord">
             <span class="mord mathnormal" style="margin-right: 0.1076em;">
              f
             </span>
             <span class="msupsub">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 0.3283em;">
                 <span class="" style="top: -2.55em; margin-left: -0.1076em; margin-right: 0.05em;">
                  <span class="pstrut" style="height: 2.7em;">
                  </span>
                  <span class="sizing reset-size6 size3 mtight">
                   <span class="mord mathnormal mtight">
                    Q
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 ​
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 0.2861em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="mopen">
             (
            </span>
            <span class="mord">
             <span class="mord mathnormal">
              x
             </span>
             <span class="msupsub">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 0.3117em;">
                 <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                  <span class="pstrut" style="height: 2.7em;">
                  </span>
                  <span class="sizing reset-size6 size3 mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                    j
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 ​
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 0.2861em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="mpunct">
             ,
            </span>
            <span class="mspace" style="margin-right: 0.1667em;">
            </span>
            <span class="mord">
             <span class="mord mathnormal">
              t
             </span>
             <span class="msupsub">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 0.3117em;">
                 <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                  <span class="pstrut" style="height: 2.7em;">
                  </span>
                  <span class="sizing reset-size6 size3 mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                    j
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 ​
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 0.2861em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="mpunct">
             ;
            </span>
            <span class="mspace" style="margin-right: 0.1667em;">
            </span>
            <span class="mord mathnormal" style="margin-right: 0.0269em;">
             w
            </span>
            <span class="mpunct">
             ,
            </span>
            <span class="mspace" style="margin-right: 0.1667em;">
            </span>
            <span class="mord mathnormal">
             b
            </span>
            <span class="mclose">
             )
            </span>
            <span class="mclose delimcenter" style="top: 0em;">
             ]
            </span>
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.954em;">
               <span class="" style="top: -3.2029em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  2
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      <br/>
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         N 
          
         
           f 
          
         
        
       
         N_f
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.109em;">
            N
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3361em;">
               <span class="" style="top: -2.55em; margin-left: -0.109em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.1076em;">
                  f
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      为配置点；f是残差，通过自动微分计算物理方程的残差。
     </li>
     <li>
      同理
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         M 
         
        
          S 
         
         
         
           E 
          
          
          
            C 
           
          
            , 
           
          
            u 
           
          
         
        
       
         M S E_{C, u}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0576em;">
           MS
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0576em;">
            E
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3283em;">
               <span class="" style="top: -2.55em; margin-left: -0.0576em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0715em;">
                   C
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mathnormal mtight">
                   u
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      与
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         M 
         
        
          S 
         
         
         
           E 
          
          
          
            C 
           
          
            , 
           
          
            f 
           
          
         
        
       
         M S E_{C, f}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0576em;">
           MS
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0576em;">
            E
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3361em;">
               <span class="" style="top: -2.55em; margin-left: -0.0576em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0715em;">
                   C
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mathnormal mtight" style="margin-right: 0.1076em;">
                   f
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      分别表示浓度C关于 ADE方程残差的均方误差，这里就不再赘述了。
     </li>
    </ol>
    <p>
     最后设置一个阈值ϵ。若MSE&gt;ϵ，继续回到神经网络中进行对Q和C数值模拟；若MSE&lt;ϵ，输出结果。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/07ab588b8e5a4d16af90c6cdff0ff5f3.png"/>
    </p>
    <h3>
     <a id="_41">
     </a>
     实验
    </h3>
    <p>
     本文围绕物理信息神经网络求解ADE、SVE及其耦合方程SVE - ADE展开研究，具体实验结果与数据分析结果如下：
    </p>
    <ol>
     <li>
      ADE
      <br/>
      在不同初始与边界条件下的求解精度下，PINN 模型在四种不同初始和边界条件下求解 ADE 均表现良好。 4个不同场景下，如瞬时释放、持续释放等让PINN 预测解与解析解高度吻合，相对 L2 误差分别为 3.6×10 - 3、1.7×10 - 4、9.1×10 - 3 和 1.67×10 - 3。通过调整损失函数中对应惩罚项的权重，PINN 方法能显著降低初始或边界条件下的解误差。
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/58e30cfb19a54abdaf81aaeda54c570d.png"/>
     </li>
     <li>
      求解SVE及SVE - ADE
      <br/>
      SVE求解结果如下图所示：
      <br/>
      PINN 方法求解 SVE 的相对 L2 误差为 7.3×10
      <sup>
       -3
      </sup>
      ，能够模拟流场。SVE - ADE耦合方程求解结果中，PINN 方法能准确捕捉冲击波行为，而数值解因数值色散在最大流量和浓度附近出现扁平化。流量 Q和浓度C的相对 L2 误差分别为 1.00×10
      <sup>
       -3
      </sup>
      和 1.36×10
      <sup>
       -3
      </sup>
      ，进一步证实了 PINN方法的有效性。与传统迭代耦合算法相比，PINN 方法无需时间步迭代，能同时输出流场和浓度场结果，并在训练阶段不断更新网络参数以优化输出，节省时间并减少误差。
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/64277eedef1b4cf4b064efb1da3b2447.png"/>
     </li>
     <li>
      PINN求解ADE参数
      <br/>
      噪声水平的影响如下图所示：
      <br/>
      误差随初始和边界条件点数量的增加而减小，随噪声水平的增加而增大。流速 v 的误差受噪声和 N
      <sub>
       u
      </sub>
      的影响小于一阶衰减率 k 和扩散系数 D。 在 1%噪声和 N
      <sub>
       u
      </sub>
      = 2000 的条件下，v 和 D 的误差分别为 0.003%和 0.105%，为不同 Nu 值下的最小误差。
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/d850207bb000428c8ce71994f1eabd19.png">
       <br/>
       模型结构的影响如下，6 层全连接的 PINN 模型在估计 v、k 和 D 方面表现最佳，2 层 10 个神经元的模型表现最差。8 层 20 个神经元的模型在估计 v、k 和 D 时也表现出色，误差分别为 0.004%、0.038%和 0.010%。
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/67e4bcac57ee4c49af22343a4de17af3.png"/>
      </img>
     </li>
     <li>
      PINN参数设置
      <br/>
      在样本数量的中，在相似的初始和边界条件下，误差随配置点数量的增加而逐渐减小；在相同的配置点条件下，误差随 N
      <sub>
       u
      </sub>
      的增加而减小。PINN 模型在 N
      <sub>
       u
      </sub>
      = 200 和 N
      <sub>
       f
      </sub>
      = 10000 时误差最小，且当 N
      <sub>
       u
      </sub>
      为 200 时，2000 和 8000 个配置点的误差差异较小，表明 PINN 模型能用较少的 N
      <sub>
       f
      </sub>
      准确模拟结果。
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/f6c47f14e4be4fb4bdb853880dc7a4aa.png">
       <br/>
       经过 10 次以上不同初始化训练后，四个 ADE 实验结果的平均误差均小于 1.09×10
       <sup>
        -2
       </sup>
       。每个实验结果的相对 L2 误差浮动范围较小，说明随机种子的设置对模型结果影响不大。优化算法采用 Adam 优化器迭代一定次数确保梯度下降方向正确，再切换到 L - BFGS - B 优化器加速优化直至收敛的两步优化策略。
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/aa588d1f606c4194b7be3138fac20f24.png">
        <br/>
        <strong>
         代码如下：
        </strong>
       </img>
      </img>
     </li>
    </ol>
    <pre><code class="prism language-python"><span class="token comment"># 导入必要的库</span>
<span class="token keyword">import</span> torch  <span class="token comment"># 导入 PyTorch，用于构建神经网络和自动微分</span>
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn  <span class="token comment"># 导入 PyTorch 的神经网络模块</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np  <span class="token comment"># 导入 NumPy，用于数值计算和数据处理</span>
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt  <span class="token comment"># 导入 Matplotlib，用于绘图</span>
<span class="token keyword">from</span> scipy<span class="token punctuation">.</span>special <span class="token keyword">import</span> erfc  <span class="token comment"># 导入 SciPy 的误差函数，用于解析解计算</span>

<span class="token comment"># 设置随机种子，确保结果可重复</span>
torch<span class="token punctuation">.</span>manual_seed<span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">)</span>  <span class="token comment"># 设置 PyTorch 随机种子为 1234</span>
np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">)</span>  <span class="token comment"># 设置 NumPy 随机种子为 1234</span>

<span class="token comment"># 定义 PINN 模型类，继承自 nn.Module</span>
<span class="token keyword">class</span> <span class="token class-name">PINN</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> num_hidden_layers<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> num_neurons<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>PINN<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 调用父类的构造函数</span>
        <span class="token comment"># 定义网络结构：输入层 (x, t)，多个隐藏层，输出层 (C)</span>
        self<span class="token punctuation">.</span>layers <span class="token operator">=</span> nn<span class="token punctuation">.</span>ModuleList<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 创建一个模块列表，用于存储网络层</span>
        <span class="token comment"># 输入层：2 个输入 (x, t)</span>
        self<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>append<span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> num_neurons<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 第一个线性层，输入维度 2，输出维度 num_neurons</span>
        <span class="token comment"># 隐藏层</span>
        <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_hidden_layers <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>append<span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>num_neurons<span class="token punctuation">,</span> num_neurons<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 中间隐藏层</span>
        <span class="token comment"># 输出层：输出 1 个变量 (C)</span>
        self<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>append<span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>num_neurons<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 最后一层，输出 C</span>
        self<span class="token punctuation">.</span>tanh <span class="token operator">=</span> nn<span class="token punctuation">.</span>Tanh<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 定义激活函数为 tanh</span>

    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 前向传播：输入 (x, t)，输出 C</span>
        inputs <span class="token operator">=</span> torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span> t<span class="token punctuation">]</span><span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 将 x 和 t 拼接为一个输入张量，维度为 [batch_size, 2]</span>
        h <span class="token operator">=</span> inputs  <span class="token comment"># 初始化隐藏层输入</span>
        <span class="token comment"># 通过每一层进行前向传播</span>
        <span class="token keyword">for</span> layer <span class="token keyword">in</span> self<span class="token punctuation">.</span>layers<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            h <span class="token operator">=</span> self<span class="token punctuation">.</span>tanh<span class="token punctuation">(</span>layer<span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 线性变换后应用 tanh 激活函数</span>
        C <span class="token operator">=</span> self<span class="token punctuation">.</span>layers<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span>  <span class="token comment"># 最后一层不加激活函数，直接输出 C</span>
        <span class="token keyword">return</span> C

    <span class="token keyword">def</span> <span class="token function">compute_derivatives</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 计算导数：使用自动微分计算 C 关于 x 和 t 的偏导数</span>
        x <span class="token operator">=</span> x<span class="token punctuation">.</span>requires_grad_<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># 确保 x 需要计算梯度</span>
        t <span class="token operator">=</span> t<span class="token punctuation">.</span>requires_grad_<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># 确保 t 需要计算梯度</span>
        C <span class="token operator">=</span> self<span class="token punctuation">.</span>forward<span class="token punctuation">(</span>x<span class="token punctuation">,</span> t<span class="token punctuation">)</span>  <span class="token comment"># 前向传播，计算 C</span>

        <span class="token comment"># 计算 C 的导数</span>
        C_x <span class="token operator">=</span> torch<span class="token punctuation">.</span>autograd<span class="token punctuation">.</span>grad<span class="token punctuation">(</span>C<span class="token punctuation">,</span> x<span class="token punctuation">,</span> grad_outputs<span class="token operator">=</span>torch<span class="token punctuation">.</span>ones_like<span class="token punctuation">(</span>C<span class="token punctuation">)</span><span class="token punctuation">,</span> create_graph<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># C 对 x 的一阶导数</span>
        C_xx <span class="token operator">=</span> torch<span class="token punctuation">.</span>autograd<span class="token punctuation">.</span>grad<span class="token punctuation">(</span>C_x<span class="token punctuation">,</span> x<span class="token punctuation">,</span> grad_outputs<span class="token operator">=</span>torch<span class="token punctuation">.</span>ones_like<span class="token punctuation">(</span>C_x<span class="token punctuation">)</span><span class="token punctuation">,</span> create_graph<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># C 对 x 的二阶导数</span>
        C_t <span class="token operator">=</span> torch<span class="token punctuation">.</span>autograd<span class="token punctuation">.</span>grad<span class="token punctuation">(</span>C<span class="token punctuation">,</span> t<span class="token punctuation">,</span> grad_outputs<span class="token operator">=</span>torch<span class="token punctuation">.</span>ones_like<span class="token punctuation">(</span>C<span class="token punctuation">)</span><span class="token punctuation">,</span> create_graph<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># C 对 t 的一阶导数</span>

        <span class="token keyword">return</span> C<span class="token punctuation">,</span> C_x<span class="token punctuation">,</span> C_xx<span class="token punctuation">,</span> C_t

<span class="token comment"># 定义解析解函数（Case 1：瞬时释放）</span>
<span class="token keyword">def</span> <span class="token function">analytical_solution_case1</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> t<span class="token punctuation">,</span> mp<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">,</span> v<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">,</span> D<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 计算 Case 1 的解析解：瞬时释放的浓度分布</span>
    <span class="token comment"># 公式：C(x, t) = (mp / (2 * sqrt(pi * D * t))) * exp(-((x - v * t)^2) / (4 * D * t))</span>
    t <span class="token operator">=</span> np<span class="token punctuation">.</span>maximum<span class="token punctuation">(</span>t<span class="token punctuation">,</span> <span class="token number">1e-6</span><span class="token punctuation">)</span>  <span class="token comment"># 避免 t = 0 导致除零，使用 1e-6 作为最小值</span>
    C <span class="token operator">=</span> <span class="token punctuation">(</span>mp <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>np<span class="token punctuation">.</span>pi <span class="token operator">*</span> D <span class="token operator">*</span> t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">-</span> v <span class="token operator">*</span> t<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">*</span> D <span class="token operator">*</span> t<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> C


<span class="token keyword">def</span> <span class="token function">generate_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># Case 1：瞬时释放</span>
    x_domain <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment"># 空间域：x ∈ [0, 1]</span>
    t_domain <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment"># 时间域：t ∈ [0, 1]</span>
    v <span class="token operator">=</span> <span class="token number">1.0</span>  <span class="token comment"># 流速，单位 L T^-1</span>
    D <span class="token operator">=</span> <span class="token number">0.01</span>  <span class="token comment"># 扩散系数，单位 L^2 T^-1</span>
    mp <span class="token operator">=</span> <span class="token number">5000</span>  <span class="token comment"># 瞬时释放质量，单位 M</span>

    <span class="token comment"># 采样点数量</span>
    N_u <span class="token operator">=</span> <span class="token number">200</span>  <span class="token comment"># 初始和边界条件点数量</span>
    N_f <span class="token operator">=</span> <span class="token number">5000</span>  <span class="token comment"># 内部配点数量</span>

    <span class="token comment"># 初始条件点 (t = 0)</span>
    x_ic <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span>x_domain<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x_domain<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> N_u<span class="token punctuation">)</span>  <span class="token comment"># 在 x 域 [0, 1] 内均匀随机采样 N_u 个点</span>
    t_ic <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>x_ic<span class="token punctuation">)</span>  <span class="token comment"># t = 0，所有初始条件点的 t 值设为 0</span>
    C_ic <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>x_ic<span class="token punctuation">)</span>  <span class="token comment"># 初始条件：C(x, t=0) = 0，生成 N_u 个零值</span>

    <span class="token comment"># 边界条件点</span>
    <span class="token comment"># 左边界 (x = 0)</span>
    t_bc_left <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span>t_domain<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_domain<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> N_u<span class="token punctuation">)</span>  <span class="token comment"># 在 t 域 [0, 1] 内均匀随机采样 N_u 个点</span>
    x_bc_left <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>t_bc_left<span class="token punctuation">)</span>  <span class="token comment"># x = 0，所有左边界点的 x 值设为 0</span>
    C_bc_left <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>t_bc_left<span class="token punctuation">)</span>  <span class="token comment"># 边界条件：C(x=0, t) = 0，生成 N_u 个零值</span>

    <span class="token comment"># 右边界 (x = 1)</span>
    t_bc_right <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span>t_domain<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_domain<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> N_u<span class="token punctuation">)</span>  <span class="token comment"># 在 t 域 [0, 1] 内均匀随机采样 N_u 个点</span>
    x_bc_right <span class="token operator">=</span> np<span class="token punctuation">.</span>ones_like<span class="token punctuation">(</span>t_bc_right<span class="token punctuation">)</span>  <span class="token comment"># x = 1，所有右边界点的 x 值设为 1</span>
    C_bc_right <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>t_bc_right<span class="token punctuation">)</span>  <span class="token comment"># 边界条件：C(x=1, t) = 0，生成 N_u 个零值</span>

    <span class="token comment"># 内部配点</span>
    x_f <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span>x_domain<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x_domain<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> N_f<span class="token punctuation">)</span>  <span class="token comment"># 在 x 域 [0, 1] 内均匀随机采样 N_f 个点</span>
    t_f <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span>t_domain<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t_domain<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> N_f<span class="token punctuation">)</span>  <span class="token comment"># 在 t 域 [0, 1] 内均匀随机采样 N_f 个点</span>

    <span class="token comment"># 转换为 PyTorch 张量</span>
    x_ic <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>x_ic<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 将 x_ic 转换为张量，形状 [N_u, 1]</span>
    t_ic <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>t_ic<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 将 t_ic 转换为张量，形状 [N_u, 1]</span>
    C_ic <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>C_ic<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 将 C_ic 转换为张量，形状 [N_u, 1]</span>

    x_bc_left <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>x_bc_left<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 将 x_bc_left 转换为张量，形状 [N_u, 1]</span>
    t_bc_left <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>t_bc_left<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 将 t_bc_left 转换为张量，形状 [N_u, 1]</span>
    C_bc_left <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>C_bc_left<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 将 C_bc_left 转换为张量，形状 [N_u, 1]</span>

    x_bc_right <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>x_bc_right<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 将 x_bc_right 转换为张量，形状 [N_u, 1]</span>
    t_bc_right <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>t_bc_right<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 将 t_bc_right 转换为张量，形状 [N_u, 1]</span>
    C_bc_right <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>C_bc_right<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 将 C_bc_right 转换为张量，形状 [N_u, 1]</span>

    x_f <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>x_f<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 将 x_f 转换为张量，形状 [N_f, 1]</span>
    t_f <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>t_f<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 将 t_f 转换为张量，形状 [N_f, 1]</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>x_ic<span class="token punctuation">,</span> t_ic<span class="token punctuation">,</span> C_ic<span class="token punctuation">,</span> x_bc_left<span class="token punctuation">,</span> t_bc_left<span class="token punctuation">,</span> C_bc_left<span class="token punctuation">,</span> x_bc_right<span class="token punctuation">,</span> t_bc_right<span class="token punctuation">,</span> C_bc_right<span class="token punctuation">,</span> x_f<span class="token punctuation">,</span> t_f<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>v<span class="token punctuation">,</span> D<span class="token punctuation">,</span> mp<span class="token punctuation">)</span>

<span class="token comment"># 训练 PINN 模型</span>
<span class="token keyword">def</span> <span class="token function">train_pinn</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> data<span class="token punctuation">,</span> params<span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 解包数据和参数</span>
    x_ic<span class="token punctuation">,</span> t_ic<span class="token punctuation">,</span> C_ic<span class="token punctuation">,</span> x_bc_left<span class="token punctuation">,</span> t_bc_left<span class="token punctuation">,</span> C_bc_left<span class="token punctuation">,</span> x_bc_right<span class="token punctuation">,</span> t_bc_right<span class="token punctuation">,</span> C_bc_right<span class="token punctuation">,</span> x_f<span class="token punctuation">,</span> t_f <span class="token operator">=</span> data
    v<span class="token punctuation">,</span> D<span class="token punctuation">,</span> mp <span class="token operator">=</span> params  <span class="token comment"># 解包流速 v、扩散系数 D 和瞬时释放质量 mp</span>

    <span class="token comment"># 定义优化器</span>
    optimizer <span class="token operator">=</span> torch<span class="token punctuation">.</span>optim<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span>model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">)</span>  <span class="token comment"># 使用 Adam 优化器，学习率为 0.001</span>

    <span class="token comment"># 训练循环</span>
    <span class="token keyword">for</span> epoch <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 清空梯度</span>

        <span class="token comment"># 计算初始条件损失 (MSE_C,u for IC)</span>
        C_ic_pred <span class="token operator">=</span> model<span class="token punctuation">(</span>x_ic<span class="token punctuation">,</span> t_ic<span class="token punctuation">)</span>  <span class="token comment"># 预测初始条件下的 C</span>
        mse_C_ic <span class="token operator">=</span> torch<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">(</span>C_ic_pred <span class="token operator">-</span> C_ic<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment"># 计算初始条件均方误差</span>

        <span class="token comment"># 计算左边界条件损失 (MSE_C,u for BC)</span>
        C_bc_left_pred <span class="token operator">=</span> model<span class="token punctuation">(</span>x_bc_left<span class="token punctuation">,</span> t_bc_left<span class="token punctuation">)</span>  <span class="token comment"># 预测左边界条件下的 C</span>
        mse_C_bc_left <span class="token operator">=</span> torch<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">(</span>C_bc_left_pred <span class="token operator">-</span> C_bc_left<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment"># 计算左边界均方误差</span>

        <span class="token comment"># 计算右边界条件损失 (MSE_C,u for BC)</span>
        C_bc_right_pred <span class="token operator">=</span> model<span class="token punctuation">(</span>x_bc_right<span class="token punctuation">,</span> t_bc_right<span class="token punctuation">)</span>  <span class="token comment"># 预测右边界条件下的 C</span>
        mse_C_bc_right <span class="token operator">=</span> torch<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">(</span>C_bc_right_pred <span class="token operator">-</span> C_bc_right<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment"># 计算右边界均方误差</span>

        <span class="token comment"># 计算内部配点的物理损失 (MSE_C,f for ADE)</span>
        C_f<span class="token punctuation">,</span> C_x_f<span class="token punctuation">,</span> C_xx_f<span class="token punctuation">,</span> C_t_f <span class="token operator">=</span> model<span class="token punctuation">.</span>compute_derivatives<span class="token punctuation">(</span>x_f<span class="token punctuation">,</span> t_f<span class="token punctuation">)</span>  <span class="token comment"># 计算内部配点导数</span>
        <span class="token comment"># ADE 方程：∂C/∂t = D * ∂²C/∂x² - v * ∂C/∂x (k = 0)</span>
        f_C <span class="token operator">=</span> C_t_f <span class="token operator">-</span> D <span class="token operator">*</span> C_xx_f <span class="token operator">+</span> v <span class="token operator">*</span> C_x_f  <span class="token comment"># 计算 ADE 残差</span>
        mse_C_f <span class="token operator">=</span> torch<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>f_C <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment"># 计算 ADE 残差均方误差</span>

        <span class="token comment"># 总损失</span>
        loss <span class="token operator">=</span> mse_C_ic <span class="token operator">+</span> mse_C_bc_left <span class="token operator">+</span> mse_C_bc_right <span class="token operator">+</span> mse_C_f  <span class="token comment"># 总损失：MSE_C,u + MSE_C,f</span>

        <span class="token comment"># 反向传播和优化</span>
        loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 反向传播，计算梯度</span>
        optimizer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 更新模型参数</span>

        <span class="token comment"># 每 1000 次迭代打印损失</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>epoch <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">1000</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'Epoch [</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>epoch<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>epochs<span class="token punctuation">}</span></span><span class="token string">], Loss: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">.6f</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>

<span class="token comment"># 可视化结果</span>
<span class="token keyword">def</span> <span class="token function">visualize_results</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> v<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">,</span> D<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">,</span> mp<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 生成测试点</span>
    x_test <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>  <span class="token comment"># 在 x ∈ [0, 1] 内生成 100 个均匀点</span>
    t_test <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>  <span class="token comment"># 在 t ∈ [0, 1] 内生成 100 个均匀点</span>
    X<span class="token punctuation">,</span> T <span class="token operator">=</span> np<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> t_test<span class="token punctuation">)</span>  <span class="token comment"># 创建网格点，形状 [100, 100]</span>
    x_flat <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>X<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 展平 x，形状 [10000, 1]</span>
    t_flat <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>T<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 展平 t，形状 [10000, 1]</span>

    <span class="token comment"># 预测浓度 C</span>
    C_pred <span class="token operator">=</span> model<span class="token punctuation">(</span>x_flat<span class="token punctuation">,</span> t_flat<span class="token punctuation">)</span>  <span class="token comment"># 使用模型预测 C</span>
    C_pred <span class="token operator">=</span> C_pred<span class="token punctuation">.</span>detach<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>  <span class="token comment"># 转换为 NumPy 数组并重塑为 [100, 100]</span>

    <span class="token comment"># 计算解析解</span>
    C_analytical <span class="token operator">=</span> analytical_solution_case1<span class="token punctuation">(</span>X<span class="token punctuation">,</span> T<span class="token punctuation">,</span> mp<span class="token punctuation">,</span> v<span class="token punctuation">,</span> D<span class="token punctuation">)</span>  <span class="token comment"># 计算解析解</span>

    <span class="token comment"># 绘制对比图</span>
    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>contourf<span class="token punctuation">(</span>X<span class="token punctuation">,</span> T<span class="token punctuation">,</span> C_pred<span class="token punctuation">,</span> levels<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'jet'</span><span class="token punctuation">)</span>  <span class="token comment"># 绘制 PINN 预测结果的等高线图</span>
    plt<span class="token punctuation">.</span>colorbar<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">'C (PINN)'</span><span class="token punctuation">)</span>  <span class="token comment"># 添加颜色条，标注为 PINN 预测的 C</span>
    plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>  <span class="token comment"># x 轴标签</span>
    plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'t'</span><span class="token punctuation">)</span>  <span class="token comment"># t 轴标签</span>
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'PINN Prediction (Case 1)'</span><span class="token punctuation">)</span>  <span class="token comment"># 标题：PINN 预测结果</span>
    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>contourf<span class="token punctuation">(</span>X<span class="token punctuation">,</span> T<span class="token punctuation">,</span> C_analytical<span class="token punctuation">,</span> levels<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'jet'</span><span class="token punctuation">)</span>  <span class="token comment"># 绘制解析解的等高线图</span>
    plt<span class="token punctuation">.</span>colorbar<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">'C (Analytical)'</span><span class="token punctuation">)</span>  <span class="token comment"># 添加颜色条，标注为解析解的 C</span>
    plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span>  <span class="token comment"># x 轴标签</span>
    plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'t'</span><span class="token punctuation">)</span>  <span class="token comment"># t 轴标签</span>
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Analytical Solution (Case 1)'</span><span class="token punctuation">)</span>  
    plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 调整布局，防止重叠</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 显示图像</span>

<span class="token comment"># 主函数：运行代码</span>
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token comment"># 初始化模型</span>
    model <span class="token operator">=</span> PINN<span class="token punctuation">(</span>num_hidden_layers<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> num_neurons<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>  <span class="token comment"># 创建 PINN 模型，4 个隐藏层，每层 20 个神经元</span>

    <span class="token comment"># Case 1：瞬时释放</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Training Case 1: Instantaneous Release"</span><span class="token punctuation">)</span>
    data<span class="token punctuation">,</span> params <span class="token operator">=</span> generate_data<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 生成 Case 1 数据</span>
    train_pinn<span class="token punctuation">(</span>model<span class="token punctuation">,</span> data<span class="token punctuation">,</span> params<span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">10000</span><span class="token punctuation">)</span>  <span class="token comment"># 训练模型</span>
    visualize_results<span class="token punctuation">(</span>model<span class="token punctuation">,</span> v<span class="token operator">=</span>params<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> D<span class="token operator">=</span>params<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> mp<span class="token operator">=</span>params<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 可视化结果</span>
</code></pre>
    <h3>
     <a id="_256">
     </a>
     结论
    </h3>
    <p>
     本文采用PINN方法求解一维ADE、SVE及其耦合方程。结果表明，PINN能有效结合物理定律，从有限数据中学习PDE解。其精度与初始和边界条件数量、配点数量、网络层数和神经元数量正相关，且噪声数据的影响不大，增加初始和边界条件数量可提高含噪声反问题的模拟精度。
    </p>
    <h3>
     <a id="_258">
     </a>
     不足以及展望
    </h3>
    <p>
     作者认为当前工作聚焦于规则边界几何的一维问题，对于复杂几何形状和边界条件、非线性和非均质性等方面的处理能力有限。作者希望未来可探索PINN解决二维或三维多物理问题的能力，尤其是处理更复杂几何形状的情况。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f5a63796d61746963732f:61727469636c652f64657461696c732f313436313439323432" class_="artid" style="display:none">
 </p>
</div>


