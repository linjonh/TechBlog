---
layout: post
title: "Spring-Boot拦截器Interceptor与过滤器Filter深度解析区别实现与实战指南"
date: 2025-03-16 00:45:28 +0800
description: "优先使用拦截器处理Web层通用逻辑保留过滤器用于底层请求处理复杂场景可以组合使用两者生产环境务必进行性能压测通过合理运用过滤器和拦截器，开发者可以构建出高可维护性的Web应用架构。建议结合APM工具（如SkyWalking）监控两者的执行效率，持续优化系统性能。"
keywords: "Spring Boot拦截器（Interceptor）与过滤器（Filter）深度解析：区别、实现与实战指南"
categories: ['未分类']
tags: ['后端', 'Spring', 'Java', 'Boot']
artid: "146288560"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146288560
    alt: "Spring-Boot拦截器Interceptor与过滤器Filter深度解析区别实现与实战指南"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146288560
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146288560
cover: https://bing.ee123.net/img/rand?artid=146288560
image: https://bing.ee123.net/img/rand?artid=146288560
img: https://bing.ee123.net/img/rand?artid=146288560
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Spring Boot拦截器（Interceptor）与过滤器（Filter）深度解析：区别、实现与实战指南
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="Spring_BootInterceptorFilter_0">
     </a>
     Spring Boot拦截器（Interceptor）与过滤器（Filter）深度解析：区别、实现与实战指南
    </h2>
    <h3>
     <a id="_1">
     </a>
     一、核心概念对比
    </h3>
    <h4>
     <a id="1__3">
     </a>
     1. 本质区别
    </h4>
    <table>
     <thead>
      <tr>
       <th>
        维度
       </th>
       <th>
        过滤器（Filter）
       </th>
       <th>
        拦截器（Interceptor）
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <strong>
         规范层级
        </strong>
       </td>
       <td>
        Servlet规范（J2EE标准）
       </td>
       <td>
        Spring MVC框架机制
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         作用范围
        </strong>
       </td>
       <td>
        所有请求（包括静态资源）
       </td>
       <td>
        只处理Controller请求
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         依赖关系
        </strong>
       </td>
       <td>
        不依赖Spring容器
       </td>
       <td>
        完全集成Spring IOC容器
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         执行顺序
        </strong>
       </td>
       <td>
        最先执行（在DispatcherServlet之前）
       </td>
       <td>
        在DispatcherServlet之后执行
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         异常处理
        </strong>
       </td>
       <td>
        无法直接使用Spring的异常处理机制
       </td>
       <td>
        可以通过@ControllerAdvice统一处理
       </td>
      </tr>
     </tbody>
    </table>
    <h4>
     <a id="2__12">
     </a>
     2. 执行流程示意图
    </h4>
    <pre><code>HTTP Request
  ↓
Filter Chain（doFilter）
  ↓
DispatcherServlet
  ↓
Interceptor.preHandle
  ↓
Controller Method
  ↓
Interceptor.postHandle
  ↓
View Rendering（如有）
  ↓
Interceptor.afterCompletion
  ↓
Filter Chain（返回响应）
</code></pre>
    <hr/>
    <h3>
     <a id="Filter_35">
     </a>
     二、过滤器（Filter）开发指南
    </h3>
    <h4>
     <a id="1__37">
     </a>
     1. 基础实现方式
    </h4>
    <pre><code class="prism language-java"><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LogFilter</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{<!-- --></span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token class-name">ServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">ServletResponse</span> response<span class="token punctuation">,</span> 
                         <span class="token class-name">FilterChain</span> chain<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">long</span> startTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HttpServletRequest</span> req <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">)</span> request<span class="token punctuation">;</span>
        
        <span class="token comment">// 前置处理</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Request URI: "</span> <span class="token operator">+</span> req<span class="token punctuation">.</span><span class="token function">getRequestURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        chain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 放行请求</span>
        
        <span class="token comment">// 后置处理</span>
        <span class="token keyword">long</span> duration <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> startTime<span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Request completed in "</span> <span class="token operator">+</span> duration <span class="token operator">+</span> <span class="token string">"ms"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="2__60">
     </a>
     2. 高级配置技巧
    </h4>
    <pre><code class="prism language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FilterConfig</span> <span class="token punctuation">{<!-- --></span>
    
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">FilterRegistrationBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">LogFilter</span><span class="token punctuation">&gt;</span></span> <span class="token function">loggingFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">FilterRegistrationBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">LogFilter</span><span class="token punctuation">&gt;</span></span> registration <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FilterRegistrationBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        registration<span class="token punctuation">.</span><span class="token function">setFilter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LogFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        registration<span class="token punctuation">.</span><span class="token function">addUrlPatterns</span><span class="token punctuation">(</span><span class="token string">"/api/*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        registration<span class="token punctuation">.</span><span class="token function">setOrder</span><span class="token punctuation">(</span><span class="token class-name">Ordered</span><span class="token punctuation">.</span><span class="token constant">HIGHEST_PRECEDENCE</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置优先级</span>
        <span class="token keyword">return</span> registration<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      典型应用场景
     </strong>
     ：
    </p>
    <ul>
     <li>
      请求日志记录
     </li>
     <li>
      全局字符编码设置
     </li>
     <li>
      跨域处理（CORS）
     </li>
     <li>
      XSS防御过滤
     </li>
     <li>
      请求内容压缩/解压
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="Interceptor_85">
     </a>
     三、拦截器（Interceptor）开发指南
    </h3>
    <h4>
     <a id="1__87">
     </a>
     1. 标准实现模板
    </h4>
    <pre><code class="prism language-java"><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AuthInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">HandlerInterceptor</span> <span class="token punctuation">{<!-- --></span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">preHandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> 
                           <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> 
                           <span class="token class-name">Object</span> handler<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span> token <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">"Authorization"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">validateToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            response<span class="token punctuation">.</span><span class="token function">sendError</span><span class="token punctuation">(</span><span class="token number">401</span><span class="token punctuation">,</span> <span class="token string">"Invalid token"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// 中断请求</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">postHandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> 
                          <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> 
                          <span class="token class-name">Object</span> handler<span class="token punctuation">,</span>
                          <span class="token class-name">ModelAndView</span> modelAndView<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// Controller方法执行后，视图渲染前</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterCompletion</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> 
                               <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> 
                               <span class="token class-name">Object</span> handler<span class="token punctuation">,</span> 
                               <span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 请求完全结束后（包括视图渲染）</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="2__122">
     </a>
     2. 注册拦截器配置
    </h4>
    <pre><code class="prism language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{<!-- --></span>
    
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">AuthInterceptor</span> authInterceptor<span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addInterceptors</span><span class="token punctuation">(</span><span class="token class-name">InterceptorRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        registry<span class="token punctuation">.</span><span class="token function">addInterceptor</span><span class="token punctuation">(</span>authInterceptor<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">addPathPatterns</span><span class="token punctuation">(</span><span class="token string">"/**"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">excludePathPatterns</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">,</span> <span class="token string">"/public/**"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      典型应用场景
     </strong>
     ：
    </p>
    <ul>
     <li>
      接口权限验证
     </li>
     <li>
      请求参数预处理
     </li>
     <li>
      接口耗时监控
     </li>
     <li>
      敏感操作日志
     </li>
     <li>
      数据绑定前校验
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="_148">
     </a>
     四、核心差异深度解析
    </h3>
    <h4>
     <a id="1__150">
     </a>
     1. 执行顺序对比实验
    </h4>
    <p>
     配置多个过滤器和拦截器时的执行顺序：
    </p>
    <pre><code>Filter1 → Filter2 → Interceptor.preHandle 
→ Controller 
→ Interceptor.postHandle 
→ Interceptor.afterCompletion 
→ Filter2 → Filter1
</code></pre>
    <h4>
     <a id="2__160">
     </a>
     2. 异常处理差异
    </h4>
    <pre><code class="prism language-java"><span class="token comment">// 在过滤器中处理异常</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        chain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        response<span class="token punctuation">.</span><span class="token function">sendError</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token string">"Server Error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 在拦截器中处理异常</span>
<span class="token annotation punctuation">@ControllerAdvice</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GlobalExceptionHandler</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">handleException</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">internalServerError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token string">"Error occurred"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="3__181">
     </a>
     3. 异步请求处理
    </h4>
    <pre><code class="prism language-java"><span class="token comment">// 拦截器需实现AsyncHandlerInterceptor</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterConcurrentHandlingStarted</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> 
                                          <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> 
                                          <span class="token class-name">Object</span> handler<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 异步请求的特殊处理</span>
<span class="token punctuation">}</span>
</code></pre>
    <hr/>
    <h3>
     <a id="_194">
     </a>
     五、最佳实践与选型策略
    </h3>
    <h4>
     <a id="1__196">
     </a>
     1. 技术选型决策树
    </h4>
    <pre><code>是否需要处理静态资源？
├─ 是 → 必须使用Filter
└─ 否 → 
   是否需要访问Spring Bean？
   ├─ 是 → 选择Interceptor
   └─ 否 → 
      是否需要最早处理请求？
      ├─ 是 → 选择Filter
      └─ 否 → 根据业务复杂度选择
</code></pre>
    <h4>
     <a id="2__209">
     </a>
     2. 性能优化建议
    </h4>
    <ul>
     <li>
      <strong>
       过滤器
      </strong>
      ：避免在过滤器中做复杂业务逻辑
     </li>
     <li>
      <strong>
       拦截器
      </strong>
      ：preHandle方法尽量轻量化
     </li>
     <li>
      两者都应避免：
      <ul>
       <li>
        同步阻塞操作
       </li>
       <li>
        频繁的IO操作
       </li>
       <li>
        大对象的内存操作
       </li>
      </ul>
     </li>
    </ul>
    <h4>
     <a id="3__217">
     </a>
     3. 常见陷阱规避
    </h4>
    <ul>
     <li>
      <strong>
       过滤器
      </strong>
      ：
      <ul>
       <li>
        忘记调用chain.doFilter()导致请求阻塞
       </li>
       <li>
        修改请求参数未使用Wrapper类
       </li>
      </ul>
     </li>
     <li>
      <strong>
       拦截器
      </strong>
      ：
      <ul>
       <li>
        在postHandle中修改ModelAndView导致NPE
       </li>
       <li>
        异步请求中误用afterCompletion
       </li>
      </ul>
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="_227">
     </a>
     六、实战案例演示
    </h3>
    <h4>
     <a id="1_229">
     </a>
     案例1：接口耗时监控系统
    </h4>
    <pre><code class="prism language-java"><span class="token comment">// 拦截器实现</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MetricsInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">HandlerInterceptor</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">ThreadLocal</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> startTime <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadLocal</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">preHandle</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        startTime<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterCompletion</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">long</span> duration <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> startTime<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        metricsService<span class="token punctuation">.</span><span class="token function">recordRequestTime</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getRequestURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> duration<span class="token punctuation">)</span><span class="token punctuation">;</span>
        startTime<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="2_250">
     </a>
     案例2：全局防重放攻击过滤器
    </h4>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ReplayAttackFilter</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">Cache</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Boolean</span><span class="token punctuation">&gt;</span></span> requestCache <span class="token operator">=</span> 
        <span class="token class-name">Caffeine</span><span class="token punctuation">.</span><span class="token function">newBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">expireAfterWrite</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MINUTES</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span> nonce <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">"X-Nonce"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>requestCache<span class="token punctuation">.</span><span class="token function">getIfPresent</span><span class="token punctuation">(</span>nonce<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            response<span class="token punctuation">.</span><span class="token function">sendError</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token string">"Duplicate request"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        requestCache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>nonce<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        chain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <hr/>
    <h3>
     <a id="_271">
     </a>
     七、扩展知识
    </h3>
    <h4>
     <a id="1_AOP_273">
     </a>
     1. 与AOP的区别
    </h4>
    <ul>
     <li>
      <strong>
       AOP
      </strong>
      ：
      <ul>
       <li>
        基于代理模式实现
       </li>
       <li>
        可以精确控制到具体方法
       </li>
       <li>
        更适合业务层面的切面处理
       </li>
      </ul>
     </li>
     <li>
      <strong>
       拦截器
      </strong>
      ：
      <ul>
       <li>
        基于HandlerMapping实现
       </li>
       <li>
        主要针对HTTP请求生命周期
       </li>
       <li>
        更适合Web层通用处理
       </li>
      </ul>
     </li>
    </ul>
    <h4>
     <a id="2__283">
     </a>
     2. 高级应用场景
    </h4>
    <ul>
     <li>
      <strong>
       过滤器链
      </strong>
      ：实现责任链模式
     </li>
     <li>
      <strong>
       拦截器栈
      </strong>
      ：组合多个拦截逻辑
     </li>
     <li>
      <strong>
       动态启用/禁用
      </strong>
      ：结合配置中心实现
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="_290">
     </a>
     总结建议
    </h3>
    <ol>
     <li>
      <strong>
       优先使用拦截器
      </strong>
      处理Web层通用逻辑
     </li>
     <li>
      <strong>
       保留过滤器
      </strong>
      用于底层请求处理
     </li>
     <li>
      复杂场景可以
      <strong>
       组合使用
      </strong>
      两者
     </li>
     <li>
      生产环境务必进行
      <strong>
       性能压测
      </strong>
     </li>
    </ol>
    <p>
     通过合理运用过滤器和拦截器，开发者可以构建出高可维护性的Web应用架构。建议结合APM工具（如SkyWalking）监控两者的执行效率，持续优化系统性能。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f6368656e4f6e6c794f6e652f:61727469636c652f64657461696c732f313436323838353630" class_="artid" style="display:none">
 </p>
</div>


