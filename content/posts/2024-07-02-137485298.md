---
arturl_encode: "68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f37353231353933372f:61727469636c652f64657461696c732f313337343835323938"
layout: post
title: "BoostCompass-http_server-æ¨¡å—-é¡¹ç›®å‰ç«¯ä»£ç -"
date: 2024-07-02 22:04:46 +08:00
description: "æœ¬æ–‡ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨C++ç¼–å†™ä¸€ä¸ªç»“åˆHTTPæœåŠ¡å™¨å’Œæœç´¢åŠŸèƒ½çš„æ¨¡å—ï¼Œåˆ©ç”¨cpp-httplibåº“å¤„ç†"
keywords: "BoostCompass( http_server æ¨¡å— | é¡¹ç›®å‰ç«¯ä»£ç  )"
categories: ['Boostcompass']
tags: ['ç½‘ç»œåè®®', 'å‰ç«¯', 'Http']
artid: "137485298"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=137485298
    alt: "BoostCompass-http_server-æ¨¡å—-é¡¹ç›®å‰ç«¯ä»£ç -"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=137485298
featuredImagePreview: https://bing.ee123.net/img/rand?artid=137485298
---

# BoostCompass( http_server æ¨¡å— | é¡¹ç›®å‰ç«¯ä»£ç  )

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/a6c3324ce20e2d9d859a7d2aa0b80e40.png)

#### é˜…è¯»å¯¼èˆª

* [ä¸€ã€æ¨¡å—æ¦‚è¿°](#_2)
* [äºŒã€ç¼–å†™http_server æ¨¡å—](#http_server__6)
* + [âœ…cpp-httplibåº“çš„å®‰è£…](#cpphttplib_7)
  + [1. è¯¦ç»†ä»£ç ](#1__11)
  + [2. ç¼–å†™æ€è·¯](#2__61)
* [ä¸‰ã€é¡¹ç›®å‰ç«¯ä»£ç ](#_90)
* + [âœ…index.html](#indexhtml_91)
  + [â­•åº”ç”¨æ•ˆæœ](#_266)

## ä¸€ã€æ¨¡å—æ¦‚è¿°

è¿™ä¸ªæ¨¡å—æ˜¯ä¸€ä¸ªåŸºäºC++çš„ç®€å•æœç´¢å¼•æ“æœåŠ¡ç¨‹åºï¼Œæˆ‘ä»¬æ•´åˆäº†HTTPæœåŠ¡å™¨å’Œæœç´¢åŠŸèƒ½ã€‚æˆ‘ä»¬é¦–å…ˆåˆå§‹åŒ–ä¸€ä¸ªæœç´¢å™¨å¯¹è±¡ï¼Œä½¿ç”¨é¢„å…ˆå¤„ç†å¥½çš„æ–‡æ¡£æ•°æ®ï¼ˆæ¥è‡ªç¬¬ä¸€ä¸ªæ¨¡å—ï¼‰æ¥å»ºç«‹ç´¢å¼•ã€‚ç„¶åï¼Œæˆ‘ä»¬è®¾ç½®äº†ä¸€ä¸ªHTTPæœåŠ¡å™¨ï¼Œå¹¶ä¸ºæœåŠ¡å™¨å®šä¹‰äº†ä¸€ä¸ªGETè¯·æ±‚çš„å¤„ç†å‡½æ•°ï¼Œè¯¥å‡½æ•°å“åº”å®¢æˆ·ç«¯å¯¹"/s"è·¯å¾„çš„è®¿é—®ã€‚

å½“å®¢æˆ·ç«¯å‘é€åŒ…å«æœç´¢å…³é”®å­—çš„è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ä¼šéªŒè¯è¯·æ±‚ä¸­æ˜¯å¦åŒ…å«å…³é”®å­—å‚æ•°ã€‚å¦‚æœæ²¡æœ‰å…³é”®å­—ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›é”™è¯¯ä¿¡æ¯ã€‚å¦‚æœæœ‰å…³é”®å­—ï¼ŒæœåŠ¡å™¨å°†è°ƒç”¨æœç´¢å™¨çš„æœç´¢æ–¹æ³•ï¼Œä¼ å…¥å…³é”®å­—ï¼Œå¹¶è·å–æœç´¢ç»“æœï¼Œè¿™äº›ç»“æœè¢«å°è£…ä¸ºJSONå­—ç¬¦ä¸²è¿”å›ç»™å®¢æˆ·ç«¯ã€‚

## äºŒã€ç¼–å†™http_server æ¨¡å—

### âœ…cpp-httplibåº“çš„å®‰è£…

**æˆ‘ä»¬è¦å…ˆåœ¨Linuxæœºå™¨ä¸Šå®‰è£…cpp-httplibåº“ç›¸å…³ä»‹ç»æ–‡ç« é“¾æ¥**
ï¼šğŸ”´
[C++ HTTP åº“ cpp-httplib ä½¿ç”¨](https://www.twle.cn/t/19375)

ğŸš¨
**æ³¨æ„**
ï¼š
**`cpp-httplib`
åº“åœ¨ä½¿ç”¨çš„æ—¶å€™éœ€è¦ä½¿ç”¨è¾ƒæ–°ç‰ˆæœ¬çš„
`gcc`**

### 1. è¯¦ç»†ä»£ç 

```cpp
// å¼•å…¥æ‰€éœ€çš„å¤´æ–‡ä»¶
#include "httplib.hpp"
#include "searcher.hpp" 

// å®šä¹‰è¾“å…¥æ–‡ä»¶çš„è·¯å¾„å’ŒWebæœåŠ¡å™¨çš„æ ¹ç›®å½•
const std::string input = "data/raw_html/raw.txt";
const std::string root_path = "./wwwroot";

// ä¸»å‡½æ•°ï¼Œç¨‹åºçš„å…¥å£ç‚¹
int main() {
    // åˆ›å»ºSearcherç±»çš„å®ä¾‹å¹¶åˆå§‹åŒ–
    ns_searcher::Searcher search;
    search.InitSearcher(input);

    // åˆ›å»ºhttplib::Serverç±»çš„å®ä¾‹ï¼Œç”¨äºå¤„ç†HTTPè¯·æ±‚
    httplib::Server svr;
    // è®¾ç½®æœåŠ¡å™¨çš„æ ¹ç›®å½•ä¸ºroot_path
    svr.set_base_dir(root_path.c_str());
    // ä¸ºæœåŠ¡å™¨æ·»åŠ ä¸€ä¸ªGETè¯·æ±‚çš„å¤„ç†å‡½æ•°
    svr.Get("/s", [&search](const httplib::Request &req, httplib::Response &rsp) {
        // æ£€æŸ¥è¯·æ±‚ä¸­æ˜¯å¦åŒ…å«æœç´¢å…³é”®å­—å‚æ•°"word"
        if (!req.has_param("word")) {
            // å¦‚æœæ²¡æœ‰æœç´¢å…³é”®å­—ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯
            rsp.set_content("å¿…é¡»è¦æœ‰æœç´¢å…³é”®å­—!", "text/plain; charset=utf-8");
            return;
        }
        // ä»è¯·æ±‚ä¸­è·å–æœç´¢å…³é”®å­—
        std::string word = req.get_param_value("word");
        // è®°å½•æ—¥å¿—ï¼Œè¾“å‡ºç”¨æˆ·æœç´¢çš„å…³é”®å­—
        LOG(NORMAL, "ç”¨æˆ·æœç´¢çš„: " + word);
        // å®šä¹‰ç”¨äºå­˜å‚¨æœç´¢ç»“æœçš„å­—ç¬¦ä¸²
        std::string json_string;
        // è°ƒç”¨searchå®ä¾‹çš„Searchæ–¹æ³•è¿›è¡Œæœç´¢ï¼Œå¹¶å°†ç»“æœå­˜å‚¨åœ¨json_stringä¸­
        search.Search(word, &json_string);

        // è®¾ç½®å“åº”å†…å®¹ä¸ºæœç´¢ç»“æœï¼Œå¹¶æŒ‡å®šå†…å®¹ç±»å‹ä¸ºJSON
        rsp.set_content(json_string, "application/json");
    });

    // è®°å½•æ—¥å¿—ï¼Œè¡¨ç¤ºæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ
    LOG(NORMAL, "æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ...");
    // æœåŠ¡å™¨å¼€å§‹ç›‘å¬æ‰€æœ‰IPçš„8081ç«¯å£
    svr.listen("0.0.0.0", 8081);
    // è¿”å›0ï¼Œè¡¨ç¤ºç¨‹åºæ­£å¸¸ç»“æŸ
    return 0;
}

```

### 2. ç¼–å†™æ€è·¯

1. **é…ç½®æ–‡ä»¶è·¯å¾„å’ŒæœåŠ¡å™¨æ ¹ç›®å½•**
   ï¼š

   * å®šä¹‰äº†ä¸¤ä¸ªå¸¸é‡ï¼Œ
     `input`
     ç”¨äºæŒ‡å®šæœç´¢å¼•æ“çš„æ•°æ®è¾“å…¥æ–‡ä»¶è·¯å¾„ï¼Œ
     `root_path`
     ç”¨äºæŒ‡å®šWebæœåŠ¡å™¨çš„æ ¹ç›®å½•ã€‚
2. **åˆå§‹åŒ–æœç´¢ç»„ä»¶**
   ï¼š

   * åœ¨
     `main`
     å‡½æ•°ä¸­ï¼Œåˆ›å»ºäº†ä¸€ä¸ª
     `ns_searcher::Searcher`
     ç±»çš„å®ä¾‹ï¼Œå¹¶è°ƒç”¨å…¶
     `InitSearcher`
     æ–¹æ³•æ¥åˆå§‹åŒ–æœç´¢ç´¢å¼•ã€‚è¿™é€šå¸¸æ¶‰åŠåŠ è½½æ•°æ®æ–‡ä»¶å’Œæ„å»ºæœç´¢æ‰€éœ€çš„æ•°æ®ç»“æ„ã€‚
3. **è®¾ç½®HTTPæœåŠ¡å™¨**
   ï¼š

   * ä½¿ç”¨
     `httplib::Server`
     åˆ›å»ºä¸€ä¸ªHTTPæœåŠ¡å™¨å®ä¾‹ã€‚
   * é€šè¿‡
     `set_base_dir`
     æ–¹æ³•è®¾ç½®æœåŠ¡å™¨çš„æ ¹ç›®å½•ï¼Œè¿™æ ·æœåŠ¡å™¨å°±å¯ä»¥æä¾›é™æ€æ–‡ä»¶æœåŠ¡ã€‚
   * ä¸ºæœåŠ¡å™¨æ·»åŠ ä¸€ä¸ªGETè¯·æ±‚çš„å¤„ç†å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å¯¹åº”äºURLè·¯å¾„
     `/s`
     ã€‚
4. **å¤„ç†æœç´¢è¯·æ±‚**
   ï¼š

   * åœ¨GETè¯·æ±‚å¤„ç†å‡½æ•°ä¸­ï¼Œé¦–å…ˆæ£€æŸ¥è¯·æ±‚æ˜¯å¦åŒ…å«åä¸º
     `word`
     çš„æŸ¥è¯¢å‚æ•°ï¼Œè¿™æ˜¯ç”¨æˆ·è¾“å…¥çš„æœç´¢å…³é”®å­—ã€‚
   * å¦‚æœæ²¡æœ‰æœç´¢å…³é”®å­—ï¼ŒæœåŠ¡å™¨è¿”å›ä¸€ä¸ªé”™è¯¯ä¿¡æ¯ã€‚
   * å¦‚æœæœ‰æœç´¢å…³é”®å­—ï¼ŒæœåŠ¡å™¨è®°å½•æ—¥å¿—å¹¶æå–å…³é”®å­—ã€‚
   * è°ƒç”¨
     `Searcher`
     å®ä¾‹çš„
     `Search`
     æ–¹æ³•ï¼Œä¼ å…¥å…³é”®å­—ï¼Œå¹¶è·å–æœç´¢ç»“æœã€‚
   * å°†æœç´¢ç»“æœå­˜å‚¨åœ¨ä¸€ä¸ªJSONæ ¼å¼çš„å­—ç¬¦ä¸²ä¸­ï¼Œå‡†å¤‡å‘é€ç»™å®¢æˆ·ç«¯ã€‚
5. **å‘é€æœç´¢ç»“æœ**
   ï¼š

   * è®¾ç½®HTTPå“åº”çš„å†…å®¹å’Œç±»å‹ä¸ºJSONæ ¼å¼ï¼Œç„¶åå°†æœç´¢ç»“æœå­—ç¬¦ä¸²å‘é€ç»™å®¢æˆ·ç«¯ã€‚
6. **å¯åŠ¨æœåŠ¡å™¨**
   ï¼š

   * è®°å½•æ—¥å¿—è¡¨ç¤ºæœåŠ¡å™¨å·²æˆåŠŸå¯åŠ¨ã€‚
   * è°ƒç”¨
     `listen`
     æ–¹æ³•ä½¿æœåŠ¡å™¨å¼€å§‹ç›‘å¬æŒ‡å®šç«¯å£ï¼ˆ8081ï¼‰ä¸Šçš„æ‰€æœ‰IPåœ°å€ï¼Œå‡†å¤‡æ¥æ”¶å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚

æ•´ä½“æ¥è¯´ï¼Œ
`http_server`
å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨C++å’Œç°ä»£åº“æ¥åˆ›å»ºä¸€ä¸ªç®€å•çš„Webæœç´¢å¼•æ“ã€‚å®ƒå¤„ç†HTTPè¯·æ±‚ï¼Œæ‰§è¡Œæœç´¢æŸ¥è¯¢ï¼Œå¹¶å°†ç»“æœä»¥JSONæ ¼å¼è¿”å›ç»™ç”¨æˆ·ã€‚è¿™ç§è®¾è®¡æ¨¡å¼é€‚ç”¨äºåˆ›å»ºè½»é‡çº§çš„æœç´¢å¼•æ“æˆ–å…¶ä»–WebæœåŠ¡åº”ç”¨ç¨‹åºã€‚

## ä¸‰ã€é¡¹ç›®å‰ç«¯ä»£ç 

### âœ…index.html

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>

    <title>boost æœç´¢å¼•æ“</title>
    <style>
        /* å»æ‰ç½‘é¡µä¸­çš„æ‰€æœ‰çš„é»˜è®¤å†…å¤–è¾¹è·ï¼Œhtmlçš„ç›’å­æ¨¡å‹ */
        * {
            /* è®¾ç½®å¤–è¾¹è· */
            margin: 0;
            /* è®¾ç½®å†…è¾¹è· */
            padding: 0;
        }
        /* å°†æˆ‘ä»¬çš„bodyå†…çš„å†…å®¹100%å’Œhtmlçš„å‘ˆç°å»åˆ */
        html,
        body {
            height: 100%;
        }
        /* ç±»é€‰æ‹©å™¨.container */
        .container {
            /* è®¾ç½®divçš„å®½åº¦ */
            width: 800px;
            /* é€šè¿‡è®¾ç½®å¤–è¾¹è·è¾¾åˆ°å±…ä¸­å¯¹é½çš„ç›®çš„ */
            margin: 0px auto;
            /* è®¾ç½®å¤–è¾¹è·çš„ä¸Šè¾¹è·ï¼Œä¿æŒå…ƒç´ å’Œç½‘é¡µçš„ä¸Šéƒ¨è·ç¦» */
            margin-top: 20px;
        }
        /* å¤åˆé€‰æ‹©å™¨ï¼Œé€‰ä¸­container ä¸‹çš„ search */
        .container .search {
            /* å®½åº¦ä¸çˆ¶æ ‡ç­¾ä¿æŒä¸€è‡´ */
            width: 100%;
            /* é«˜åº¦è®¾ç½®ä¸º52px */
            height: 52px;
        }
        /* å…ˆé€‰ä¸­inputæ ‡ç­¾ï¼Œ ç›´æ¥è®¾ç½®æ ‡ç­¾çš„å±æ€§ï¼Œå…ˆè¦é€‰ä¸­ï¼Œ inputï¼šæ ‡ç­¾é€‰æ‹©å™¨*/
        /* inputåœ¨è¿›è¡Œé«˜åº¦è®¾ç½®çš„æ—¶å€™ï¼Œæ²¡æœ‰è€ƒè™‘è¾¹æ¡†çš„é—®é¢˜ */
        .container .search input {
            /* è®¾ç½®leftæµ®åŠ¨ */
            float: left;
            width: 600px;
            height: 50px;
            /* è®¾ç½®è¾¹æ¡†å±æ€§ï¼šè¾¹æ¡†çš„å®½åº¦ï¼Œæ ·å¼ï¼Œé¢œè‰² */
            border: 1px solid black;
            /* å»æ‰inputè¾“å…¥æ¡†çš„æœ‰è¾¹æ¡† */
            border-right: none;
            /* è®¾ç½®å†…è¾¹è·ï¼Œé»˜è®¤æ–‡å­—ä¸è¦å’Œå·¦ä¾§è¾¹æ¡†ç´§æŒ¨ç€ */
            padding-left: 10px;
            /* è®¾ç½®inputå†…éƒ¨çš„å­—ä½“çš„é¢œè‰²å’Œæ ·å¼ */
            color: #CCC;
            font-size: 14px;
        }
        /* å…ˆé€‰ä¸­buttonæ ‡ç­¾ï¼Œ ç›´æ¥è®¾ç½®æ ‡ç­¾çš„å±æ€§ï¼Œå…ˆè¦é€‰ä¸­ï¼Œ buttonï¼šæ ‡ç­¾é€‰æ‹©å™¨*/
        .container .search button {
            /* è®¾ç½®leftæµ®åŠ¨ */
            float: left;
            width: 150px;
            height: 52px;
            /* è®¾ç½®buttonçš„èƒŒæ™¯é¢œè‰²ï¼Œ#4e6ef2 */
            background-color: #4e6ef2;
            /* è®¾ç½®buttonä¸­çš„å­—ä½“é¢œè‰² */
            color: #FFF;
            /* è®¾ç½®å­—ä½“çš„å¤§å° */
            font-size: 19px;
            font-family:Georgia, 'Times New Roman', Times, serif;
        }
        .container .result {
            width: 100%;
        }
        .container .result .item {
            margin-top: 20px;
        }

        .container .result .item a {
            /* è®¾ç½®ä¸ºå—çº§å…ƒç´ ï¼Œå•ç‹¬ç«™ä¸€è¡Œ */
            display: block;
            /* aæ ‡ç­¾çš„ä¸‹åˆ’çº¿å»æ‰ */
            text-decoration: none;
            /* è®¾ç½®aæ ‡ç­¾ä¸­çš„æ–‡å­—çš„å­—ä½“å¤§å° */
            font-size: 20px;
            /* è®¾ç½®å­—ä½“çš„é¢œè‰² */
            color: #4e6ef2;
        }
        .container .result .item a:hover {
            text-decoration: underline;
        }
        .container .result .item p {
            margin-top: 5px;
            font-size: 16px;
            font-family:'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
        }

        .container .result .item i{
            /* è®¾ç½®ä¸ºå—çº§å…ƒç´ ï¼Œå•ç‹¬ç«™ä¸€è¡Œ */
            display: block;
            /* å–æ¶ˆæ–œä½“é£æ ¼ */
            font-style: normal;
            color: green;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="search">
            <input type="text" value="è¯·è¾“å…¥æœç´¢å…³é”®å­—">
            <button onclick="Search()">æœç´¢ä¸€ä¸‹</button>
        </div>
        <div class="result">
        </div>
    </div>
    <script>
        function Search(){
            // æ˜¯æµè§ˆå™¨çš„ä¸€ä¸ªå¼¹å‡ºæ¡†
            // alert("hello js!");
            // 1. æå–æ•°æ®, $å¯ä»¥ç†è§£æˆå°±æ˜¯JQueryçš„åˆ«ç§°
            let query = $(".container .search input").val();
            console.log("query = " + query); //consoleæ˜¯æµè§ˆå™¨çš„å¯¹è¯æ¡†ï¼Œå¯ä»¥ç”¨æ¥è¿›è¡ŒæŸ¥çœ‹jsæ•°æ®

            //2. å‘èµ·httpè¯·æ±‚,ajax: å±äºä¸€ä¸ªå’Œåç«¯è¿›è¡Œæ•°æ®äº¤äº’çš„å‡½æ•°ï¼ŒJQueryä¸­çš„
            $.ajax({
                type: "GET",
                url: "/s?word=" + query,
                success: function(data){
                    console.log(data);
                    BuildHtml(data);
                }
            });
        }

        function BuildHtml(data){
            if(data == '' || data == null){
                document.write("å¯¹ä¸èµ·ï¼Œæ‚¨æœç´¢çš„å†…å®¹ä¸å­˜åœ¨ï¼Œ404, åˆ·æ–°é¡µé¢å³å¯é‡æ–°æœç´¢")
            }
            // è·å–htmlä¸­çš„resultæ ‡ç­¾
            let result_lable = $(".container .result");
            // æ¸…ç©ºå†å²æœç´¢ç»“æœ
            result_lable.empty();

            for( let elem of data){
                // console.log(elem.title);
                // console.log(elem.url);
                let a_lable = $("<a>", {
                    text: elem.title,
                    href: elem.url,
                    // è·³è½¬åˆ°æ–°çš„é¡µé¢
                    target: "_blank"
                });
                let p_lable = $("<p>", {
                    text: elem.desc
                });
                let i_lable = $("<i>", {
                    text: elem.url
                });
                let div_lable = $("<div>", {
                    class: "item"
                });
                a_lable.appendTo(div_lable);
                p_lable.appendTo(div_lable);
                i_lable.appendTo(div_lable);
                div_lable.appendTo(result_lable);
            }
        }
    </script>
</body>
</html>



```

### â­•åº”ç”¨æ•ˆæœ

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/76b3da2496214cce156c9f5299b4760d.png)

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/df868d2ae7841530eda711c86fb7a730.png)