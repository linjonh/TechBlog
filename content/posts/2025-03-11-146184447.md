---
layout: post
title: "Java直通车系列28Spring-Boot数据访问Spring-Data-JPA"
date: 2025-03-11 17:22:30 +0800
description: "Java直通车系列正在连载更新中，更新的内容包括JSP、Spring MVC、Spring Boot、Spring Cloud完整学习资料以及详细解释代码示例，关注我，持续学习。"
keywords: "Java直通车系列28【Spring Boot】（数据访问Spring Data JPA）"
categories: ['Java']
tags: ['开发语言', '后端', 'Spring', 'Spring', 'Java', 'Boot']
artid: "146184447"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146184447
    alt: "Java直通车系列28Spring-Boot数据访问Spring-Data-JPA"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146184447
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146184447
cover: https://bing.ee123.net/img/rand?artid=146184447
image: https://bing.ee123.net/img/rand?artid=146184447
img: https://bing.ee123.net/img/rand?artid=146184447
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Java直通车系列28【Spring Boot】（数据访问Spring Data JPA）
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <hr id="hr-toc" name="tableOfContents"/>
    <h4>
     Spring Data JPA 概述
    </h4>
    <p>
     Spring Data JPA 是 Spring 提供的一个用于简化 JPA（Java Persistence API）数据访问的框架。JPA 是 Java 官方提供的用于对象关系映射（ORM）的标准规范，Spring Data JPA 在 JPA 的基础上进行了封装和扩展，使得开发者可以更加方便地进行数据库操作，减少了大量的样板代码。
    </p>
    <h4 id="%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5" name="%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5">
     核心概念
    </h4>
    <h5 id="1.%20%E4%BB%93%E5%BA%93%E6%8E%A5%E5%8F%A3%EF%BC%88Repository%EF%BC%89" name="1.%20%E4%BB%93%E5%BA%93%E6%8E%A5%E5%8F%A3%EF%BC%88Repository%EF%BC%89">
     1. 仓库接口（Repository）
    </h5>
    <p>
     Spring Data JPA 定义了一系列的仓库接口，这些接口是进行数据访问的核心。最基础的是
     <code>
      Repository
     </code>
     接口，它是所有仓库接口的父接口。常见的扩展接口有：
    </p>
    <ul>
     <li>
      <code>
       CrudRepository
      </code>
      ：提供了基本的增删改查（CRUD）操作方法。
     </li>
     <li>
      <code>
       PagingAndSortingRepository
      </code>
      ：在
      <code>
       CrudRepository
      </code>
      的基础上，增加了分页和排序的功能。
     </li>
     <li>
      <code>
       JpaRepository
      </code>
      ：继承自
      <code>
       PagingAndSortingRepository
      </code>
      ，并提供了一些 JPA 特有的方法。
     </li>
    </ul>
    <h5 id="2.%20%E5%AE%9E%E4%BD%93%E7%B1%BB%EF%BC%88Entity%EF%BC%89" name="2.%20%E5%AE%9E%E4%BD%93%E7%B1%BB%EF%BC%88Entity%EF%BC%89">
     2. 实体类（Entity）
    </h5>
    <p>
     实体类是与数据库表对应的 Java 类，使用
     <code>
      @Entity
     </code>
     注解标记。实体类中的属性通过
     <code>
      @Column
     </code>
     等注解与数据库表的字段进行映射。
    </p>
    <h5 id="3.%20%E6%96%B9%E6%B3%95%E5%91%BD%E5%90%8D%E6%9F%A5%E8%AF%A2" name="3.%20%E6%96%B9%E6%B3%95%E5%91%BD%E5%90%8D%E6%9F%A5%E8%AF%A2">
     3. 方法命名查询
    </h5>
    <p>
     Spring Data JPA 支持根据方法名自动生成查询语句。只需要按照特定的命名规则定义方法名，Spring Data JPA 会根据方法名解析出对应的查询逻辑。
    </p>
    <h5 id="4.%20%40Query%20%E6%B3%A8%E8%A7%A3" name="4.%20%40Query%20%E6%B3%A8%E8%A7%A3">
     4. @Query 注解
    </h5>
    <p>
     当方法命名查询无法满足需求时，可以使用
     <code>
      @Query
     </code>
     注解在仓库接口的方法上直接定义 JPQL（Java Persistence Query Language）或 SQL 查询语句。
    </p>
    <h4 id="%E5%9C%BA%E6%99%AF%E7%A4%BA%E4%BE%8B" name="%E5%9C%BA%E6%99%AF%E7%A4%BA%E4%BE%8B">
     场景示例
    </h4>
    <h5 id="%E6%AD%A5%E9%AA%A4%201%EF%BC%9A%E6%B7%BB%E5%8A%A0%E4%BE%9D%E8%B5%96" name="%E6%AD%A5%E9%AA%A4%201%EF%BC%9A%E6%B7%BB%E5%8A%A0%E4%BE%9D%E8%B5%96">
     步骤 1：添加依赖
    </h5>
    <p>
     在
     <code>
      pom.xml
     </code>
     中添加 Spring Data JPA 和 MySQL 驱动的依赖：
    </p>
    <pre><code class="language-XML">&lt;dependencies&gt;
    &lt;!-- Spring Data JPA --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;!-- MySQL 驱动 --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;mysql&lt;/groupId&gt;
        &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre>
    <h5 id="%E6%AD%A5%E9%AA%A4%202%EF%BC%9A%E9%85%8D%E7%BD%AE%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5" name="%E6%AD%A5%E9%AA%A4%202%EF%BC%9A%E9%85%8D%E7%BD%AE%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5">
     步骤 2：配置数据库连接
    </h5>
    <p>
     在
     <code>
      application.properties
     </code>
     或
     <code>
      application.yml
     </code>
     中配置数据库连接信息：
    </p>
    <pre><code class="language-bash">spring.datasource.url=jdbc:mysql://localhost:3306/your_database
spring.datasource.username=your_username
spring.datasource.password=your_password
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
</code></pre>
    <h5 id="%E6%AD%A5%E9%AA%A4%203%EF%BC%9A%E5%88%9B%E5%BB%BA%E5%AE%9E%E4%BD%93%E7%B1%BB" name="%E6%AD%A5%E9%AA%A4%203%EF%BC%9A%E5%88%9B%E5%BB%BA%E5%AE%9E%E4%BD%93%E7%B1%BB">
     步骤 3：创建实体类
    </h5>
    <p>
     创建一个
     <code>
      User
     </code>
     实体类，对应数据库中的
     <code>
      users
     </code>
     表：
    </p>
    <pre><code class="language-java">import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;

@Entity
public class User {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    private String name;
    private int age;

    // 构造方法、Getter 和 Setter 方法
    public User() {
    }

    public User(String name, int age) {
        this.name = name;
        this.age = age;
    }

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public int getAge() {
        return age;
    }

    public void setAge(int age) {
        this.age = age;
    }
}
</code></pre>
    <h5 id="%E6%AD%A5%E9%AA%A4%204%EF%BC%9A%E5%88%9B%E5%BB%BA%E4%BB%93%E5%BA%93%E6%8E%A5%E5%8F%A3" name="%E6%AD%A5%E9%AA%A4%204%EF%BC%9A%E5%88%9B%E5%BB%BA%E4%BB%93%E5%BA%93%E6%8E%A5%E5%8F%A3">
     步骤 4：创建仓库接口
    </h5>
    <p>
     创建一个
     <code>
      UserRepository
     </code>
     接口，继承自
     <code>
      JpaRepository
     </code>
     ：
    </p>
    <pre><code class="language-java">import org.springframework.data.jpa.repository.JpaRepository;

public interface UserRepository extends JpaRepository&lt;User, Long&gt; {
    // 方法命名查询：根据姓名查找用户
    User findByName(String name);

    // 使用 @Query 注解定义查询
    @Query("SELECT u FROM User u WHERE u.age &gt; :age")
    java.util.List&lt;User&gt; findUsersByAgeGreaterThan(int age);
}
</code></pre>
    <h5 id="%E6%AD%A5%E9%AA%A4%205%EF%BC%9A%E5%88%9B%E5%BB%BA%E6%9C%8D%E5%8A%A1%E7%B1%BB" name="%E6%AD%A5%E9%AA%A4%205%EF%BC%9A%E5%88%9B%E5%BB%BA%E6%9C%8D%E5%8A%A1%E7%B1%BB">
     步骤 5：创建服务类
    </h5>
    <p>
     创建一个
     <code>
      UserService
     </code>
     类，调用
     <code>
      UserRepository
     </code>
     的方法进行数据操作：
    </p>
    <pre><code class="language-java">import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import java.util.List;

@Service
public class UserService {
    @Autowired
    private UserRepository userRepository;

    public User saveUser(User user) {
        return userRepository.save(user);
    }

    public User findUserByName(String name) {
        return userRepository.findByName(name);
    }

    public List&lt;User&gt; findUsersByAgeGreaterThan(int age) {
        return userRepository.findUsersByAgeGreaterThan(age);
    }
}
</code></pre>
    <h5 id="%E6%AD%A5%E9%AA%A4%206%EF%BC%9A%E5%88%9B%E5%BB%BA%E6%8E%A7%E5%88%B6%E5%99%A8%E7%B1%BB" name="%E6%AD%A5%E9%AA%A4%206%EF%BC%9A%E5%88%9B%E5%BB%BA%E6%8E%A7%E5%88%B6%E5%99%A8%E7%B1%BB">
     步骤 6：创建控制器类
    </h5>
    <p>
     创建一个
     <code>
      UserController
     </code>
     类，处理 HTTP 请求并调用
     <code>
      UserService
     </code>
     的方法：
    </p>
    <pre><code class="language-java">import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/users")
public class UserController {
    @Autowired
    private UserService userService;

    @PostMapping
    public User createUser(@RequestBody User user) {
        return userService.saveUser(user);
    }

    @GetMapping("/{name}")
    public User getUserByName(@PathVariable String name) {
        return userService.findUserByName(name);
    }

    @GetMapping("/age/{age}")
    public List&lt;User&gt; getUsersByAgeGreaterThan(@PathVariable int age) {
        return userService.findUsersByAgeGreaterThan(age);
    }
}
</code></pre>
    <h4 id="%E6%B5%8B%E8%AF%95%E7%A4%BA%E4%BE%8B" name="%E6%B5%8B%E8%AF%95%E7%A4%BA%E4%BE%8B">
     测试示例
    </h4>
    <p>
     启动 Spring Boot 应用程序后，可以使用工具（如 Postman）进行测试：
    </p>
    <ul>
     <li>
      <strong>
       创建用户
      </strong>
      ：发送 POST 请求到
      <code>
       http://localhost:8080/users
      </code>
      ，请求体为 JSON 格式的用户信息：
     </li>
    </ul>
    <pre><code class="language-bash">{
    "name": "John",
    "age": 25
}
</code></pre>
    <ul>
     <li>
      <strong>
       根据姓名查找用户
      </strong>
      ：发送 GET 请求到
      <code>
       http://localhost:8080/users/John
      </code>
      。
     </li>
     <li>
      <strong>
       查找年龄大于指定值的用户
      </strong>
      ：发送 GET 请求到
      <code>
       http://localhost:8080/users/age/20
      </code>
      。
     </li>
    </ul>
    <p>
     通过以上步骤，我们可以看到 Spring Data JPA 大大简化了数据库操作，开发者只需要定义实体类和仓库接口，就可以轻松实现常见的数据访问功能。
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470:733a2f2f626c6f672e6373646e2e6e65742f5445555445552f:61727469636c652f64657461696c732f313436313834343437" class_="artid" style="display:none">
 </p>
</div>


