---
layout: post
title: "MyBatis一对多查询方式"
date: 2025-03-13 13:46:32 +0800
description: "resultMap在 MyBatis 的 Mapper XML 文件中，定义一个resultMap，使用标签来表示一对多关系。"
keywords: "MyBatis一对多查询方式"
categories: ['Spring']
tags: ['Tomcat', 'Mybatis', 'Java']
artid: "146228974"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146228974
    alt: "MyBatis一对多查询方式"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146228974
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146228974
cover: https://bing.ee123.net/img/rand?artid=146228974
image: https://bing.ee123.net/img/rand?artid=146228974
img: https://bing.ee123.net/img/rand?artid=146228974
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     MyBatis一对多查询方式
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     在 MyBatis 中，
     <strong>
      一对多查询
     </strong>
     是指一个实体对象（如
     <code>
      Order
     </code>
     ）关联多个子对象（如
     <code>
      OrderItem
     </code>
     ）。这种关系在数据库中通常通过外键实现，而在 MyBatis 中可以通过
     <code>
      resultMap
     </code>
     的嵌套集合（
     <code>
      &lt;collection&gt;
     </code>
     ）来处理。
    </p>
    <p>
     以下是对 MyBatis 中一对多查询的详细介绍，包括实现步骤和示例代码。
    </p>
    <hr/>
    <h3>
     <a id="1__6">
     </a>
     1. 一对多关系的数据表设计
    </h3>
    <p>
     假设我们有两个表：
    </p>
    <ul>
     <li>
      <strong>
       <code>
        Orders
       </code>
       表
      </strong>
      ：存储订单信息。
     </li>
     <li>
      <strong>
       <code>
        OrderItems
       </code>
       表
      </strong>
      ：存储订单项信息，每个订单项属于一个订单。
     </li>
    </ul>
    <p>
     表结构如下：
    </p>
    <pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Orders <span class="token punctuation">(</span>
    order_id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
    order_number <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    customer_id <span class="token keyword">INT</span><span class="token punctuation">,</span>
    order_date <span class="token keyword">DATE</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> OrderItems <span class="token punctuation">(</span>
    item_id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
    order_id <span class="token keyword">INT</span><span class="token punctuation">,</span>
    product_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    quantity <span class="token keyword">INT</span><span class="token punctuation">,</span>
    price <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>order_id<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> Orders<span class="token punctuation">(</span>order_id<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <ul>
     <li>
      一个订单（
      <code>
       Orders
      </code>
      ）可以包含多个订单项（
      <code>
       OrderItems
      </code>
      ）。
     </li>
     <li>
      <code>
       OrderItems
      </code>
      表中的
      <code>
       order_id
      </code>
      是外键，指向
      <code>
       Orders
      </code>
      表的
      <code>
       order_id
      </code>
      。
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="2__38">
     </a>
     2. 实体类设计
    </h3>
    <p>
     在 Java 中，我们需要定义两个实体类来表示这种一对多关系。
    </p>
    <h4>
     <a id="Order__42">
     </a>
     <code>
      Order
     </code>
     类
    </h4>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Order</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> orderId<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> orderNumber<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> customerId<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Date</span> orderDate<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">OrderItem</span><span class="token punctuation">&gt;</span></span> orderItems<span class="token punctuation">;</span> <span class="token comment">// 一对多关系</span>

    <span class="token comment">// Getters and Setters</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="OrderItem__56">
     </a>
     <code>
      OrderItem
     </code>
     类
    </h4>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderItem</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> itemId<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> orderId<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> productName<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> quantity<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> price<span class="token punctuation">;</span>

    <span class="token comment">// Getters and Setters</span>
<span class="token punctuation">}</span>
</code></pre>
    <hr/>
    <h3>
     <a id="3_MyBatis__72">
     </a>
     3. MyBatis 实现一对多查询
    </h3>
    <p>
     在 MyBatis 中，一对多查询通常通过
     <code>
      resultMap
     </code>
     的
     <code>
      &lt;collection&gt;
     </code>
     标签来实现。以下是具体步骤。
    </p>
    <h4>
     <a id="31__resultMap_76">
     </a>
     3.1 定义
     <code>
      resultMap
     </code>
    </h4>
    <p>
     在 MyBatis 的 Mapper XML 文件中，定义一个
     <code>
      resultMap
     </code>
     ，使用
     <code>
      &lt;collection&gt;
     </code>
     标签来表示一对多关系。
    </p>
    <pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>OrderResultMap<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Order<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 映射 Order 表的基本字段 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>orderId<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>order_id<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>orderNumber<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>order_number<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>customerId<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>customer_id<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>orderDate<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>order_date<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>

    <span class="token comment">&lt;!-- 一对多关系：Order 包含多个 OrderItem --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>collection</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>orderItems<span class="token punctuation">"</span></span> <span class="token attr-name">ofType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>OrderItem<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>itemId<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item_id<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>orderId<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>order_id<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>productName<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>product_name<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>quantity<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>quantity<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>price<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>price<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>collection</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <ul>
     <li>
      <code>
       property="orderItems"
      </code>
      ：对应
      <code>
       Order
      </code>
      类中的
      <code>
       orderItems
      </code>
      属性。
     </li>
     <li>
      <code>
       ofType="OrderItem"
      </code>
      ：表示集合中的元素类型是
      <code>
       OrderItem
      </code>
      。
     </li>
    </ul>
    <h4>
     <a id="32__SQL__102">
     </a>
     3.2 编写 SQL 查询
    </h4>
    <p>
     使用
     <code>
      LEFT JOIN
     </code>
     将
     <code>
      Orders
     </code>
     表和
     <code>
      OrderItems
     </code>
     表连接起来，确保即使某个订单没有订单项，也能查询到订单信息。
    </p>
    <pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>getOrderWithItems<span class="token punctuation">"</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>OrderResultMap<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    SELECT 
        o.order_id, o.order_number, o.customer_id, o.order_date,
        i.item_id, i.product_name, i.quantity, i.price
    FROM Orders o
    LEFT JOIN OrderItems i ON o.order_id = i.order_id
    WHERE o.order_id = #{orderId}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <ul>
     <li>
      使用
      <code>
       LEFT JOIN
      </code>
      是为了确保即使某个订单没有订单项，也能返回订单信息。
     </li>
     <li>
      <code>
       #{orderId}
      </code>
      是传入的参数。
     </li>
    </ul>
    <h4>
     <a id="33_Java__120">
     </a>
     3.3 Java 接口
    </h4>
    <p>
     在 Java 接口中定义方法：
    </p>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">OrderMapper</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Order</span> <span class="token function">getOrderWithItems</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"orderId"</span><span class="token punctuation">)</span> <span class="token keyword">int</span> orderId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <hr/>
    <h3>
     <a id="4__132">
     </a>
     4. 查询结果
    </h3>
    <p>
     假设数据库中有以下数据：
    </p>
    <p>
     <strong>
      <code>
       Orders
      </code>
      表
     </strong>
     ：
    </p>
    <table>
     <thead>
      <tr>
       <th>
        order_id
       </th>
       <th>
        order_number
       </th>
       <th>
        customer_id
       </th>
       <th>
        order_date
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        1
       </td>
       <td>
        ORDER001
       </td>
       <td>
        101
       </td>
       <td>
        2023-10-01
       </td>
      </tr>
      <tr>
       <td>
        2
       </td>
       <td>
        ORDER002
       </td>
       <td>
        102
       </td>
       <td>
        2023-10-02
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     <strong>
      <code>
       OrderItems
      </code>
      表
     </strong>
     ：
    </p>
    <table>
     <thead>
      <tr>
       <th>
        item_id
       </th>
       <th>
        order_id
       </th>
       <th>
        product_name
       </th>
       <th>
        quantity
       </th>
       <th>
        price
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        1
       </td>
       <td>
        1
       </td>
       <td>
        Product A
       </td>
       <td>
        2
       </td>
       <td>
        100.00
       </td>
      </tr>
      <tr>
       <td>
        2
       </td>
       <td>
        1
       </td>
       <td>
        Product B
       </td>
       <td>
        1
       </td>
       <td>
        50.00
       </td>
      </tr>
      <tr>
       <td>
        3
       </td>
       <td>
        2
       </td>
       <td>
        Product C
       </td>
       <td>
        3
       </td>
       <td>
        200.00
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     调用
     <code>
      getOrderWithItems(1)
     </code>
     后，返回的
     <code>
      Order
     </code>
     对象如下：
    </p>
    <pre><code class="prism language-java"><span class="token class-name">Order</span> <span class="token punctuation">{<!-- --></span>
    orderId<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    orderNumber<span class="token operator">:</span> <span class="token string">"ORDER001"</span><span class="token punctuation">,</span>
    customerId<span class="token operator">:</span> <span class="token number">101</span><span class="token punctuation">,</span>
    orderDate<span class="token operator">:</span> <span class="token string">"2023-10-01"</span><span class="token punctuation">,</span>
    orderItems<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token class-name">OrderItem</span> <span class="token punctuation">{<!-- --></span>
            itemId<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            orderId<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            productName<span class="token operator">:</span> <span class="token string">"Product A"</span><span class="token punctuation">,</span>
            quantity<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            price<span class="token operator">:</span> <span class="token number">100.00</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token class-name">OrderItem</span> <span class="token punctuation">{<!-- --></span>
            itemId<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            orderId<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            productName<span class="token operator">:</span> <span class="token string">"Product B"</span><span class="token punctuation">,</span>
            quantity<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            price<span class="token operator">:</span> <span class="token number">50.00</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
    <hr/>
    <h3>
     <a id="5__180">
     </a>
     5. 一对多查询的优化
    </h3>
    <p>
     如果查询结果较大，可能会产生性能问题（如 N+1 查询问题）。可以通过以下方式优化：
    </p>
    <h4>
     <a id="51__LEFT_JOIN__184">
     </a>
     5.1 使用
     <code>
      LEFT JOIN
     </code>
     一次性加载
    </h4>
    <p>
     如上面的示例，使用
     <code>
      LEFT JOIN
     </code>
     一次性加载所有数据，避免多次查询。
    </p>
    <h4>
     <a id="52__188">
     </a>
     5.2 分步查询
    </h4>
    <p>
     如果数据量较大，可以使用分步查询（嵌套查询）：
    </p>
    <pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>OrderResultMap<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Order<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>orderId<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>order_id<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>orderNumber<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>order_number<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>customerId<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>customer_id<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>orderDate<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>order_date<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>

    <span class="token comment">&lt;!-- 分步查询：通过 order_id 查询 OrderItems --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>collection</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>orderItems<span class="token punctuation">"</span></span> <span class="token attr-name">ofType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>OrderItem<span class="token punctuation">"</span></span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectOrderItemsByOrderId<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>order_id<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectOrderItemsByOrderId<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>OrderItem<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    SELECT item_id, order_id, product_name, quantity, price
    FROM OrderItems
    WHERE order_id = #{orderId}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>getOrderWithItems<span class="token punctuation">"</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>OrderResultMap<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    SELECT order_id, order_number, customer_id, order_date
    FROM Orders
    WHERE order_id = #{orderId}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <ul>
     <li>
      <code>
       select="selectOrderItemsByOrderId"
      </code>
      ：指定嵌套查询的方法。
     </li>
     <li>
      <code>
       column="order_id"
      </code>
      ：将当前查询的
      <code>
       order_id
      </code>
      作为参数传递给嵌套查询。
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="6__221">
     </a>
     6. 总结
    </h3>
    <ul>
     <li>
      一对多查询在 MyBatis 中通过
      <code>
       &lt;collection&gt;
      </code>
      标签实现。
     </li>
     <li>
      可以使用
      <code>
       LEFT JOIN
      </code>
      一次性加载数据，也可以使用分步查询优化性能。
     </li>
     <li>
      确保实体类和数据库表的结构正确映射。
     </li>
     <li>
      通过
      <code>
       resultMap
      </code>
      可以灵活地处理复杂的对象关系。
     </li>
    </ul>
    <p>
     通过以上方法，你可以在 MyBatis 中轻松实现一对多查询，并灵活应对不同的业务需求。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34383736333530322f:61727469636c652f64657461696c732f313436323238393734" class_="artid" style="display:none">
 </p>
</div>


