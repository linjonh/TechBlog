---
layout: post
title: "TCP和UDP"
date: 2025-03-09 12:30:48 +0800
description: "TCP和UDP，以及TCP的三次握手和四次挥手"
keywords: "TCP和UDP"
categories: ['未分类']
tags: ['网络', 'Udp', 'Tcp']
artid: "146130440"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146130440
    alt: "TCP和UDP"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146130440
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146130440
cover: https://bing.ee123.net/img/rand?artid=146130440
image: https://bing.ee123.net/img/rand?artid=146130440
img: https://bing.ee123.net/img/rand?artid=146130440
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     TCP和UDP
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <hr/>
    <h3>
     <a id="TCP_3">
     </a>
     TCP（传输控制协议）
    </h3>
    <h4>
     <a id="1__5">
     </a>
     1. 特点
    </h4>
    <p>
     •
     <strong>
      面向连接
     </strong>
     ：通信前需要建立连接，通信后需要释放连接。
     <br/>
     •
     <strong>
      可靠传输
     </strong>
     ：通过确认机制、重传机制、流量控制和拥塞控制确保数据可靠传输。
     <br/>
     •
     <strong>
      有序传输
     </strong>
     ：数据按发送顺序到达接收方。
     <br/>
     •
     <strong>
      面向字节流
     </strong>
     ：将数据视为无结构的字节流，不保留消息边界。
     <br/>
     •
     <strong>
      适用场景
     </strong>
     ：对可靠性要求高的应用，如 HTTP、FTP、SMTP 等。
    </p>
    <hr/>
    <h4>
     <a id="2_TCP__14">
     </a>
     2. TCP 三次握手（建立连接）
    </h4>
    <p>
     三次握手用于确保客户端和服务器双方都准备好通信。
    </p>
    <h5>
     <a id="_17">
     </a>
     过程：
    </h5>
    <ol>
     <li>
      <p>
       <strong>
        第一次握手
       </strong>
       （SYN=1, seq=x）
       <br/>
       • 客户端向服务器发送 SYN 报文，请求建立连接，并随机生成一个初始序列号
       <code>
        x
       </code>
       。
       <br/>
       • 客户端进入
       <code>
        SYN_SENT
       </code>
       状态。
      </p>
     </li>
     <li>
      <p>
       <strong>
        第二次握手
       </strong>
       （SYN=1, ACK=1, seq=y, ack=x+1）
       <br/>
       • 服务器收到 SYN 报文后，向客户端发送 SYN+ACK 报文，确认客户端的请求，并随机生成一个初始序列号
       <code>
        y
       </code>
       。
       <br/>
       • 服务器进入
       <code>
        SYN_RCVD
       </code>
       状态。
      </p>
     </li>
     <li>
      <p>
       <strong>
        第三次握手
       </strong>
       （ACK=1, seq=x+1, ack=y+1）
       <br/>
       • 客户端收到 SYN+ACK 报文后，向服务器发送 ACK 报文，确认服务器的响应。
       <br/>
       • 双方进入
       <code>
        ESTABLISHED
       </code>
       状态，连接建立完成。
      </p>
     </li>
    </ol>
    <h5>
     <a id="_30">
     </a>
     图示：
    </h5>
    <pre><code>Client                            Server
  |                                 |
  |        SYN, seq=x               |
  | -----------------------------&gt;  |
  |                                 |
  |      SYN+ACK, seq=y, ack=x+1    |
  | &lt;-----------------------------  |
  |                                 |
  |        ACK, seq=x+1, ack=y+1    |
  | -----------------------------&gt;  |
  |                                 |
</code></pre>
    <hr/>
    <h4>
     <a id="3_TCP__47">
     </a>
     3. TCP 四次挥手（释放连接）
    </h4>
    <p>
     四次挥手用于确保双方都同意关闭连接。
    </p>
    <h5>
     <a id="_50">
     </a>
     过程：
    </h5>
    <ol>
     <li>
      <p>
       <strong>
        第一次挥手
       </strong>
       （FIN=1, seq=u）
       <br/>
       • 客户端向服务器发送 FIN 报文，请求关闭连接。
       <br/>
       • 客户端进入
       <code>
        FIN_WAIT_1
       </code>
       状态。
      </p>
     </li>
     <li>
      <p>
       <strong>
        第二次挥手
       </strong>
       （ACK=1, seq=v, ack=u+1）
       <br/>
       • 服务器收到 FIN 报文后，向客户端发送 ACK 报文，确认客户端的关闭请求。
       <br/>
       • 服务器进入
       <code>
        CLOSE_WAIT
       </code>
       状态，客户端进入
       <code>
        FIN_WAIT_2
       </code>
       状态。
      </p>
     </li>
     <li>
      <p>
       <strong>
        第三次挥手
       </strong>
       （FIN=1, seq=w, ack=u+1）
       <br/>
       • 服务器向客户端发送 FIN 报文，请求关闭连接。
       <br/>
       • 服务器进入
       <code>
        LAST_ACK
       </code>
       状态。
      </p>
     </li>
     <li>
      <p>
       <strong>
        第四次挥手
       </strong>
       （ACK=1, seq=u+1, ack=w+1）
       <br/>
       • 客户端收到 FIN 报文后，向服务器发送 ACK 报文，确认服务器的关闭请求。
       <br/>
       • 客户端进入
       <code>
        TIME_WAIT
       </code>
       状态，等待 2MSL（最大报文段生存时间）后关闭连接。
       <br/>
       • 服务器收到 ACK 报文后，立即关闭连接。
      </p>
     </li>
    </ol>
    <h5>
     <a id="_68">
     </a>
     图示：
    </h5>
    <pre><code>Client                            Server
  |                                 |
  |        FIN, seq=u               |
  | -----------------------------&gt;  |
  |                                 |
  |        ACK, seq=v, ack=u+1      |
  | &lt;-----------------------------  |
  |                                 |
  |        FIN, seq=w, ack=u+1      |
  | &lt;-----------------------------  |
  |                                 |
  |        ACK, seq=u+1, ack=w+1    |
  | -----------------------------&gt;  |
  |                                 |
</code></pre>
    <hr/>
    <h4>
     <a id="4_TCP__88">
     </a>
     4. TCP 的优缺点
    </h4>
    <p>
     •
     <strong>
      优点
     </strong>
     ：可靠、有序、支持流量控制和拥塞控制。
     <br/>
     •
     <strong>
      缺点
     </strong>
     ：建立和释放连接开销大，传输效率较低。
    </p>
    <hr/>
    <h3>
     <a id="UDP_94">
     </a>
     UDP（用户数据报协议）
    </h3>
    <h4>
     <a id="1__96">
     </a>
     1. 特点
    </h4>
    <p>
     •
     <strong>
      无连接
     </strong>
     ：通信前无需建立连接，直接发送数据。
     <br/>
     •
     <strong>
      不可靠传输
     </strong>
     ：不保证数据可靠到达，不提供确认、重传、排序机制。
     <br/>
     •
     <strong>
      面向报文
     </strong>
     ：保留消息边界，每次发送一个完整的报文。
     <br/>
     •
     <strong>
      高效传输
     </strong>
     ：开销小，传输速度快。
     <br/>
     •
     <strong>
      适用场景
     </strong>
     ：对实时性要求高、允许少量数据丢失的应用，如视频流、语音通话、DNS 等。
    </p>
    <hr/>
    <h4>
     <a id="2_UDP__105">
     </a>
     2. UDP 的优缺点
    </h4>
    <p>
     •
     <strong>
      优点
     </strong>
     ：传输效率高，延迟低，适合实时应用。
     <br/>
     •
     <strong>
      缺点
     </strong>
     ：不可靠，不保证数据顺序和完整性。
    </p>
    <hr/>
    <h3>
     <a id="TCP__UDP__111">
     </a>
     TCP 和 UDP 的对比
    </h3>
    <table>
     <thead>
      <tr>
       <th>
        特性
       </th>
       <th>
        TCP
       </th>
       <th>
        UDP
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <strong>
         连接方式
        </strong>
       </td>
       <td>
        面向连接
       </td>
       <td>
        无连接
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         可靠性
        </strong>
       </td>
       <td>
        可靠传输
       </td>
       <td>
        不可靠传输
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         传输效率
        </strong>
       </td>
       <td>
        较低
       </td>
       <td>
        较高
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         数据顺序
        </strong>
       </td>
       <td>
        保证顺序
       </td>
       <td>
        不保证顺序
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         报文边界
        </strong>
       </td>
       <td>
        面向字节流
       </td>
       <td>
        面向报文
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         适用场景
        </strong>
       </td>
       <td>
        HTTP、FTP、SMTP 等
       </td>
       <td>
        视频流、语音通话、DNS 等
       </td>
      </tr>
     </tbody>
    </table>
    <hr/>
    <h3>
     <a id="_124">
     </a>
     总结
    </h3>
    <p>
     •
     <strong>
      TCP
     </strong>
     ：适合对可靠性要求高的应用，如文件传输、网页浏览等。
     <br/>
     •
     <strong>
      UDP
     </strong>
     ：适合对实时性要求高的应用，如视频流、在线游戏等。
    </p>
   </div>
   <link href="./../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="./../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f37333138303730382f:61727469636c652f64657461696c732f313436313330343430" class_="artid" style="display:none">
 </p>
</div>


