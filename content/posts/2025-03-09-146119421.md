---
layout: post
title: "docker私有仓库配置"
date: 2025-03-09 15:31:45 +0800
description: "yml 配置文件出错，yml 对格式要求非常严格。以 key - value 的形式存在。key和value 之间必须有空格。"
keywords: "docker私有仓库配置"
categories: ['未分类']
tags: ['运维', '容器', 'Docker']
artid: "146119421"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146119421
    alt: "docker私有仓库配置"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146119421
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146119421
cover: https://bing.ee123.net/img/rand?artid=146119421
image: https://bing.ee123.net/img/rand?artid=146119421
img: https://bing.ee123.net/img/rand?artid=146119421
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     docker私有仓库配置
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h2>
     <br/>
     <strong>
      基于 harbor 构建docker私有仓库
     </strong>
    </h2>
    <p>
     <strong>
      1、机器准备
      <br/>
      os：openEuler 、rockylinux
      <br/>
      mem：4G
      <br/>
      disk：100G
     </strong>
    </p>
    <p>
     <strong>
      2、关闭防火墙、禁用SELinux
     </strong>
     <br/>
     <img alt="" height="270" src="https://i-blog.csdnimg.cn/direct/be275db1866f4a0aa33de84c3da8587d.png" width="526"/>
    </p>
    <p>
     <strong>
      3、安装docker和docker-compose
     </strong>
     <br/>
     <img alt="" height="85" src="https://i-blog.csdnimg.cn/direct/bd80339ae8b346e199509fae49591689.png" width="1613"/>
    </p>
    <pre><code> yum install docker-ce -y
</code></pre>
    <p>
     <img alt="" height="509" src="https://i-blog.csdnimg.cn/direct/556921a9ee0349d6b66d5e3fe59e1db1.png" width="1661">
      <br/>
      <strong>
       配置加速
      </strong>
     </img>
    </p>
    <pre><code>vim /etc/docker/daemon.json
</code></pre>
    <pre><code>{
    "registry-mirrors": [
        "https://docker.m.daocloud.io",
        "https://hub-mirror.c.163.com",
        "https://mirror.baidubce.com",
        "https://docker.nju.edu.cn"
    ]
}
</code></pre>
    <p>
     <strong>
      启动
     </strong>
    </p>
    <pre><code> systemctl enable --now docker.service
</code></pre>
    <p>
     <strong>
      部署docker-compose
     </strong>
    </p>
    <pre><code> curl -L https://mirrors.aliyun.com/docker-toolbox/linux/compose/1.21.2/docker-compose-Linux-x86_64 -o /usr/local/bin/docker-compose
</code></pre>
    <p>
     <strong>
      查看执行权限
     </strong>
    </p>
    <pre><code> ll /usr/local/bin/docker-compose
</code></pre>
    <p>
     <img alt="" height="41" src="https://i-blog.csdnimg.cn/direct/3b4d5862fc294f85abc460c7d3fd1856.png" width="815">
      <br/>
      <strong>
       增加执行权限
      </strong>
     </img>
    </p>
    <pre><code> chmod +x  /usr/local/bin/docker-compose
</code></pre>
    <p>
     <strong>
      查看docker-compose版本
     </strong>
    </p>
    <pre><code>docker-compose -v
</code></pre>
    <p>
     <img alt="" height="44" src="https://i-blog.csdnimg.cn/direct/bce57ccef0d44fbba62fc276195d519f.png" width="633"/>
    </p>
    <h5>
     <strong>
      部署Harbor服务
     </strong>
    </h5>
    <pre><code>wget -c https://github.com/goharbor/harbor/releases/download/v2.12.2/harbor-offline-installer-v2.12.2.tgz
</code></pre>
    <p>
     <strong>
      解压，提供配置文件
     </strong>
    </p>
    <pre><code>tar xf harbor-offline-installer-v2.8.4.tgz -C /usr/local/
</code></pre>
    <p>
     <strong>
      进入到此目录中
     </strong>
    </p>
    <pre><code> cd /usr/local/harbor/
</code></pre>
    <p>
     <img alt="" height="40" src="https://i-blog.csdnimg.cn/direct/85b8c9e90f75490d92a0497ee574cf59.png" width="1064"/>
    </p>
    <p>
     <strong>
      复制此文件
     </strong>
    </p>
    <pre><code> cp harbor.yml.tmpl harbor.yml
</code></pre>
    <p>
     <strong>
      编辑此文件
     </strong>
    </p>
    <p>
     <strong>
      注意：
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       <span style="color:#fe2c24">
        yml 配置文件出错，yml 对格式要求非常严格
       </span>
      </strong>
     </li>
     <li>
      <strong>
       <span style="color:#fe2c24">
        以 key - value 的形式存在
       </span>
      </strong>
     </li>
     <li>
      <strong>
       <u>
        <span style="color:#fe2c24">
         key和value 之间必须有空格
        </span>
       </u>
      </strong>
     </li>
    </ul>
    <pre><code class="hljs">vim harbor.yml
</code></pre>
    <p>
     <img alt="" height="526" src="https://i-blog.csdnimg.cn/direct/75ffaa80c5c34963a97aef7d4083ca44.png" width="826"/>
    </p>
    <pre><code class="hljs">./prepare
</code></pre>
    <p>
     <img alt="" height="408" src="https://i-blog.csdnimg.cn/direct/7531ec2299bf454299c4ff7886114b01.png" width="1401"/>
    </p>
    <pre><code class="hljs">./install.sh
</code></pre>
    <p>
     <img alt="" height="515" src="https://i-blog.csdnimg.cn/direct/b09efbf5fcf2441c82e058177ede51b5.png" width="705"/>
    </p>
    <pre><code class="hljs">docker-compose ps
</code></pre>
    <p>
     <img alt="" height="263" src="https://i-blog.csdnimg.cn/direct/9218ecfc69954702aaa5f8c239be0cea.png" width="1040"/>
    </p>
    <p>
     <strong>
      在浏览器总输入IP地址 ：192.168.1.52
     </strong>
    </p>
    <p>
     <strong>
      用户名admin
     </strong>
    </p>
    <p>
     <strong>
      密码Harbor12345
     </strong>
    </p>
    <p>
     <img alt="" height="925" src="https://i-blog.csdnimg.cn/direct/177ba7883da7496b9d0e5fd1bfae1199.png" width="1875"/>
    </p>
    <p>
    </p>
    <p>
     <strong>
      点击library
     </strong>
    </p>
    <p>
     <img alt="" height="658" src="https://i-blog.csdnimg.cn/direct/24674f67323c4d54bd3b39a61b8ad373.png" width="1859"/>
     <strong>
      点击推送命令
     </strong>
    </p>
    <p>
     <img alt="" height="483" src="https://i-blog.csdnimg.cn/direct/4e624f0f85f64ffdb1d727177fe8a1ec.png" width="1481"/>
    </p>
    <p>
     <img alt="" height="641" src="https://i-blog.csdnimg.cn/direct/14d86376fbc342bc82bb57ba0bf7c162.png" width="720"/>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323330315f37373935303337362f:61727469636c652f64657461696c732f313436313139343231" class_="artid" style="display:none">
 </p>
</div>


