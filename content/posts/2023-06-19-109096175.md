---
layout: post
title: "微信小程序getSystemInfo的屏幕宽度不一致问题"
date: 2023-06-19 16:43:45 +0800
description: "解决微信小程序getSystemInfo的屏幕宽度px和手机实际px不一致问题_wx.getsyst"
keywords: "wx.getsysteminfosync().pixelratio"
categories: ['前端']
tags: ['Html', 'Css']
artid: "109096175"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=109096175
    alt: "微信小程序getSystemInfo的屏幕宽度不一致问题"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=109096175
featuredImagePreview: https://bing.ee123.net/img/rand?artid=109096175
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     微信小程序getSystemInfo的屏幕宽度不一致问题
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h4>
     <a id="getSystemInfo_0">
     </a>
     微信小程序getSystemInfo的屏幕宽度不一致问题
    </h4>
    <p>
     在开发微信小程序时，有时候需要获取设备的一些信息，微信基础库提供了wx.getSystemInfo()方法提供给开发者使用。但是在前端进行机型适配时，获取的屏幕宽度(screenWidth)和屏幕高度(screenHeight)与手机实际的分辨率不一致。
     <br/>
     比如我的手机分辨率为2340*1080，也就是所谓的2K分辨率。然后调用getSystemInfo()方法获取的屏幕宽度为360，高度为780，单位是px。这是怎么回事呢？
     <br/>
     这里就需要了解以下几个概念了。
    </p>
    <pre><code>逻辑分辨率(Point,pt): 页面上抽象的像素点的多少，与设备屏幕尺寸有关
物理分辨率(Pixel,px):影像显示的基本单位，与屏幕尺寸无关
像素密度(ppi):表示每英寸所拥有的像素数量。1 inch=2.54 cm
像素比(Device Pixel Ratio,dpr): dpr = 物理像素 / 逻辑像素
</code></pre>
    <p>
     上面的逻辑分辨率又叫逻辑像素，物理分辨率又叫物理像素。而getSystemInfo()获取的屏幕宽度为逻辑像素大小，而手机设置里的系统信息中显示的是物理像素。拿我的手机举个例子：
    </p>
    <pre><code>手机屏幕尺寸：6.26英寸
物理分辨率：2340*1080
逻辑分辨率：780*360
计算得出：
dpr= 2340/780=3 或者 1080/360=3
</code></pre>
    <p>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        p 
        
       
         p 
        
       
         i 
        
       
         = 
        
        
         
          
          
            w 
           
          
            i 
           
          
            d 
           
          
            t 
           
           
           
             h 
            
           
             2 
            
           
          
            + 
           
          
            h 
           
          
            e 
           
          
            i 
           
          
            g 
           
          
            h 
           
           
           
             t 
            
           
             2 
            
           
          
         
         
         
           屏 
          
         
           幕 
          
         
           尺 
          
         
           寸 
          
         
        
       
      
        ppi = \frac{\sqrt{width^2+height^2}}{屏幕尺寸}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;">
         </span>
         <span class="mord mathdefault">
          p
         </span>
         <span class="mord mathdefault">
          p
         </span>
         <span class="mord mathdefault">
          i
         </span>
         <span class="mspace" style="margin-right: 0.277778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.277778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.6746em; vertical-align: -0.345em;">
         </span>
         <span class="mord">
          <span class="mopen nulldelimiter">
          </span>
          <span class="mfrac">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 1.3296em;">
              <span class="" style="top: -2.655em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord cjk_fallback mtight">
                  屏
                 </span>
                 <span class="mord cjk_fallback mtight">
                  幕
                 </span>
                 <span class="mord cjk_fallback mtight">
                  尺
                 </span>
                 <span class="mord cjk_fallback mtight">
                  寸
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.23em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="frac-line" style="border-bottom-width: 0.04em;">
               </span>
              </span>
              <span class="" style="top: -3.58561em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord sqrt mtight">
                  <span class="vlist-t vlist-t2">
                   <span class="vlist-r">
                    <span class="vlist" style="height: 1.06285em;">
                     <span class="svg-align" style="top: -3.42857em;">
                      <span class="pstrut" style="height: 3.42857em;">
                      </span>
                      <span class="mord mtight" style="padding-left: 1.19em;">
                       <span class="mord mathdefault mtight" style="margin-right: 0.02691em;">
                        w
                       </span>
                       <span class="mord mathdefault mtight">
                        i
                       </span>
                       <span class="mord mathdefault mtight">
                        d
                       </span>
                       <span class="mord mathdefault mtight">
                        t
                       </span>
                       <span class="mord mtight">
                        <span class="mord mathdefault mtight">
                         h
                        </span>
                        <span class="msupsub">
                         <span class="vlist-t">
                          <span class="vlist-r">
                           <span class="vlist" style="height: 0.746314em;">
                            <span class="" style="top: -2.786em; margin-right: 0.0714286em;">
                             <span class="pstrut" style="height: 2.5em;">
                             </span>
                             <span class="sizing reset-size3 size1 mtight">
                              <span class="mord mtight">
                               2
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="mbin mtight">
                        +
                       </span>
                       <span class="mord mathdefault mtight">
                        h
                       </span>
                       <span class="mord mathdefault mtight">
                        e
                       </span>
                       <span class="mord mathdefault mtight">
                        i
                       </span>
                       <span class="mord mathdefault mtight" style="margin-right: 0.03588em;">
                        g
                       </span>
                       <span class="mord mathdefault mtight">
                        h
                       </span>
                       <span class="mord mtight">
                        <span class="mord mathdefault mtight">
                         t
                        </span>
                        <span class="msupsub">
                         <span class="vlist-t">
                          <span class="vlist-r">
                           <span class="vlist" style="height: 0.746314em;">
                            <span class="" style="top: -2.786em; margin-right: 0.0714286em;">
                             <span class="pstrut" style="height: 2.5em;">
                             </span>
                             <span class="sizing reset-size3 size1 mtight">
                              <span class="mord mtight">
                               2
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="" style="top: -3.03485em;">
                      <span class="pstrut" style="height: 3.42857em;">
                      </span>
                      <span class="hide-tail mtight" style="min-width: 0.853em; height: 1.54286em;">
                       <svg height="1.5428571428571431em" preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 1080" width="400em">
                        <path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,
-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,
-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,
35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,
-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467
s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422
s-65,47,-65,47z M834 80H400000v40H845z">
                        </path>
                       </svg>
                      </span>
                     </span>
                    </span>
                    <span class="vlist-s">
                     ​
                    </span>
                   </span>
                   <span class="vlist-r">
                    <span class="vlist" style="height: 0.393724em;">
                     <span class="">
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.345em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose nulldelimiter">
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     代入公式：
     <br/>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        p 
        
       
         p 
        
       
         i 
        
       
         = 
        
        
         
          
          
            108 
           
           
           
             0 
            
           
             2 
            
           
          
            + 
           
          
            234 
           
           
           
             0 
            
           
             2 
            
           
          
         
        
          6.26 
         
        
       
         = 
        
       
         411 
        
       
      
        ppi = \frac{\sqrt{1080^2+2340^2}}{6.26}=411
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;">
         </span>
         <span class="mord mathdefault">
          p
         </span>
         <span class="mord mathdefault">
          p
         </span>
         <span class="mord mathdefault">
          i
         </span>
         <span class="mspace" style="margin-right: 0.277778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.277778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.38448em; vertical-align: -0.345em;">
         </span>
         <span class="mord">
          <span class="mopen nulldelimiter">
          </span>
          <span class="mfrac">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 1.03948em;">
              <span class="" style="top: -2.655em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  6
                 </span>
                 <span class="mord mtight">
                  .
                 </span>
                 <span class="mord mtight">
                  2
                 </span>
                 <span class="mord mtight">
                  6
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.23em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="frac-line" style="border-bottom-width: 0.04em;">
               </span>
              </span>
              <span class="" style="top: -3.394em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord sqrt mtight">
                  <span class="vlist-t vlist-t2">
                   <span class="vlist-r">
                    <span class="vlist" style="height: 0.922117em;">
                     <span class="svg-align" style="top: -3em;">
                      <span class="pstrut" style="height: 3em;">
                      </span>
                      <span class="mord mtight" style="padding-left: 0.833em;">
                       <span class="mord mtight">
                        1
                       </span>
                       <span class="mord mtight">
                        0
                       </span>
                       <span class="mord mtight">
                        8
                       </span>
                       <span class="mord mtight">
                        <span class="mord mtight">
                         0
                        </span>
                        <span class="msupsub">
                         <span class="vlist-t">
                          <span class="vlist-r">
                           <span class="vlist" style="height: 0.746314em;">
                            <span class="" style="top: -2.786em; margin-right: 0.0714286em;">
                             <span class="pstrut" style="height: 2.5em;">
                             </span>
                             <span class="sizing reset-size3 size1 mtight">
                              <span class="mord mtight">
                               2
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="mbin mtight">
                        +
                       </span>
                       <span class="mord mtight">
                        2
                       </span>
                       <span class="mord mtight">
                        3
                       </span>
                       <span class="mord mtight">
                        4
                       </span>
                       <span class="mord mtight">
                        <span class="mord mtight">
                         0
                        </span>
                        <span class="msupsub">
                         <span class="vlist-t">
                          <span class="vlist-r">
                           <span class="vlist" style="height: 0.746314em;">
                            <span class="" style="top: -2.786em; margin-right: 0.0714286em;">
                             <span class="pstrut" style="height: 2.5em;">
                             </span>
                             <span class="sizing reset-size3 size1 mtight">
                              <span class="mord mtight">
                               2
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="" style="top: -2.88212em;">
                      <span class="pstrut" style="height: 3em;">
                      </span>
                      <span class="hide-tail mtight" style="min-width: 0.853em; height: 1.08em;">
                       <svg height="1.08em" preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 1080" width="400em">
                        <path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,
-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,
-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,
35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,
-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467
s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422
s-65,47,-65,47z M834 80H400000v40H845z">
                        </path>
                       </svg>
                      </span>
                     </span>
                    </span>
                    <span class="vlist-s">
                     ​
                    </span>
                   </span>
                   <span class="vlist-r">
                    <span class="vlist" style="height: 0.117883em;">
                     <span class="">
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.345em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose nulldelimiter">
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.277778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.277778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.64444em; vertical-align: 0em;">
         </span>
         <span class="mord">
          4
         </span>
         <span class="mord">
          1
         </span>
         <span class="mord">
          1
         </span>
        </span>
       </span>
      </span>
     </span>
     单位是pixcel/inch
     <br/>
     在实际应用时，虽然不可以直接获取到物理像素，但是可以通过计算间接得出。先调用getSystemInfo()方法可以获取逻辑像素和像素比，进而可以计算出物理像素。代码如下：
    </p>
    <pre><code>wx.getSystemInfo({
  success (res) {
  let pr = res.pixelRatio   //获取像素比
  let width_px = res.screenWidth * pr  //计算物理分辨率宽度
  let height_px = res.screenHeight * pr //计算物理分辨率高度
  }
})
</code></pre>
    <p>
     这里再补充一点，手机购买信息里面的6.26英寸，指的是屏幕对角线的长度。怎么知道手机的长和宽各是多少呢。根据前面计算出来的ppi就可以知道了
     <br/>
     手机宽度
    </p>
    <pre><code>phone_width = 物理分辨率/ppi = 1080/411 = 2.63 inch
phone_height = 物理分辨率/ppi = 2340/411 = 5.69 inch
</code></pre>
    <p>
     高是宽的2倍还多，感觉手机太长了。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f6162726168616d37362f:61727469636c652f64657461696c732f313039303936313735" class_="artid" style="display:none">
 </p>
</div>


