---
layout: post
title: "Excel函数篇Vlookup函数-详细用法"
date: 2025-03-14 16:32:52 +0800
description: "Vlookup函数的详细用法，注意事项"
keywords: "Excel（函数篇）：Vlookup函数 详细用法"
categories: ['数据透视表', 'Vba', 'Excel']
tags: ['学习方法', '创业创新', 'Excel']
artid: "146239143"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146239143
    alt: "Excel函数篇Vlookup函数-详细用法"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146239143
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146239143
cover: https://bing.ee123.net/img/rand?artid=146239143
image: https://bing.ee123.net/img/rand?artid=146239143
img: https://bing.ee123.net/img/rand?artid=146239143
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Excel（函数篇）：Vlookup函数 详细用法
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-kimbie-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <h2>
     <a id="font_colorgreenVlookupfont_1">
     </a>
     <font color="green">
      Vlookup函数
     </font>
    </h2>
    <h3>
     <a id="font_colorgreenfont_2">
     </a>
     <font color="green">
      基础用法
     </font>
    </h3>
    <h4>
     <a id="font_colorgreenfont_3">
     </a>
     <font color="green">
      精确查找
     </font>
    </h4>
    <ul>
     <li>
      <p>
       参数：VLOOKUP(lookup_value, table_array, col_index_num, [range_lookup])
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/ade7573977974ad594658c663444a311.png"/>
      </p>
     </li>
     <li>
      <p>
       填充时，注意选择“不带格式填充”
      </p>
     </li>
    </ul>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/f0192dd54a0f4f6288686ed5356a2637.png"/>
    </p>
    <ul>
     <li>
      重点解释一下第三个参数：索引值，它应该以第二个参数所限定的范围来看！
     </li>
    </ul>
    <p>
     如例子中“4”，是第二个参数，所选范围内，要返回值所在的列索引！
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/29b6ac2460f44e55a193057c6a664ad4.png">
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/e4e14b83b0ce4fd7bb029c7bc3ec70bf.png"/>
     </img>
    </p>
    <ul>
     <li>
      <p>
       <strong>
        注意！！！查找值必须在首列
       </strong>
      </p>
     </li>
     <li>
      <p>
       使用场景：
      </p>
     </li>
    </ul>
    <p>
     当需要在表格中精确查找某个值对应的信息时使用（如根据工号查姓名）
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/5f0f66f8310b458a85dd1240e5959c13.png"/>
    </p>
    <ul>
     <li>
      输入公式：
     </li>
    </ul>
    <p>
     =VLOOKUP(1002, A2:D4, 2, FALSE) → 返回"李四"
    </p>
    <p>
     =VLOOKUP(“王五”, B2:D4, 3, FALSE) →
     <strong>
      错误！查找值必须在首列
     </strong>
    </p>
    <p>
     正确做法：必须首列必须包含查找值，然后第三个参数索引
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/ad4d30d18f04425f877ca812a7fcd66b.png">
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/922ba6345f7743879057e9f3df45dfa6.png">
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/72057e453c614254a4b56d31c0cd2822.png">
        <br/>
        <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/629239cf3eff44409b8ea3afb0959b30.png"/>
       </img>
      </img>
     </img>
    </p>
    <h4>
     <a id="font_colorgreenfont_36">
     </a>
     <font color="green">
      易错问题
     </font>
    </h4>
    <ul>
     <li>
      查找数据和表中数据不一致：注意要查找的值，是否带空格导致不一致
     </li>
    </ul>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/defeede58fcd4b5ab637a5df6450b993.png"/>
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/272170d8e48943158b9f7c9a79376d8d.png"/>
    </p>
    <p>
     如何替换掉行列所有的空格：ALT + H，将空格替换为空！
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/5ff2c55c5e9e481eb9a2cc2783cf59c5.png"/>
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/454a882932f3430f9f7e4107c1b35d43.png"/>
    </p>
    <ul>
     <li>
      数字格式问题：数字格式无法直接找文本格式
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/8610fe87e556455b996ec3cdf06df479.png"/>
     </li>
    </ul>
    <p>
     （1）在不修改源数表的数据格式的基础上如何实现查询呢？！解决办法是，将要查询的数字格式，转成文本格式，具体方式是用：&amp;“” 数字格式&amp;“” 就会转成文本格式！！！
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/ca0c199f2787448296015ad2ac1c107e.png"/>
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/daa2cf462b4f43568ebe065b00de5987.png"/>
    </p>
    <ul>
     <li>
      用“文本找数字”：同样需要转化要查询值的格式，具体做法是 *1 或 +0
     </li>
    </ul>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/79c1b13657de4284b7f2e90cfa60b674.png"/>
    </p>
    <h4>
     <a id="font_colorgreenfont_57">
     </a>
     <font color="green">
      员工信息查询表
     </font>
    </h4>
    <ul>
     <li>
      制作一张根据姓名查询员工所有数据的动态表
     </li>
    </ul>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/fde0ed2a5f9342deb2a6e91ef370ff44.png"/>
    </p>
    <ul>
     <li>
      结合数据验证，制作可供选择的序列
     </li>
    </ul>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/8bc74c0a65c246838c3e9c1834e825de.png"/>
    </p>
    <p>
     <strong>
      快捷键：ALT A V V
     </strong>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/ee46aee3260e4c3aa992057e3b13fa2f.png"/>
    </p>
    <ul>
     <li>
      动态变化的好处：便于利用Excel各种工具，比如数据透视表，可以来统计下每个部门多少人？
     </li>
    </ul>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/a377e7d97b1c430e9750be06aaba81b0.png"/>
    </p>
    <h3>
     <a id="font_colorgreenfont_73">
     </a>
     <font color="green">
      进阶用法
     </font>
    </h3>
    <h4>
     <a id="font_colorgreenfont_74">
     </a>
     <font color="green">
      近似匹配（模糊查找）
     </font>
    </h4>
    <ul>
     <li>
      参数：=VLOOKUP(查找值, 数据范围, 列序号, TRUE)
     </li>
     <li>
      适用场景：
      <br/>
      查找成绩等级（90分以上A，80-89B…）
      <br/>
      税率计算
      <br/>
      区间数值对应
     </li>
    </ul>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/79d583754f934ee18261dd8c21b018ed.png"/>
    </p>
    <p>
     =VLOOKUP(85, A2:B6, 2, TRUE) → 返回"B"
    </p>
    <h4>
     <a id="font_colorgreenfont_86">
     </a>
     <font color="green">
      结合通配符查找
     </font>
    </h4>
    <p>
     =VLOOKUP(“
     <em>
      “&amp;A1&amp;”
     </em>
     ”, 数据范围, 列号, FALSE)
    </p>
    <ul>
     <li>
      适用场景：
      <br/>
      查找包含特定关键词的记录；
      <br/>
      模糊匹配文本内容
     </li>
    </ul>
    <p>
     =VLOOKUP(“
     <em>
      北京
     </em>
     ”, A2:D10, 3, FALSE) → 查找地址包含"北京"的记录
    </p>
    <h4>
     <a id="font_colorgreenfont_97">
     </a>
     <font color="green">
      反向查找
     </font>
    </h4>
    <p>
     =VLOOKUP(查找值, IF({1,0}, 返回列, 查找列), 2, 0)
    </p>
    <ul>
     <li>
      适用场景：
      <br/>
      当查找值不在数据表第一列时
     </li>
    </ul>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/4471a3536287419f8de576d02a182381.png"/>
    </p>
    <p>
     =VLOOKUP(1002, IF({1,0}, B2:B3, A2:A3), 2, 0) → 返回"李四"
    </p>
    <h3>
     <a id="font_colorgreenfont_107">
     </a>
     <font color="green">
      高级技巧
     </font>
    </h3>
    <h4>
     <a id="font_colorgreenfont_108">
     </a>
     <font color="green">
      多条件查找
     </font>
    </h4>
    <p>
     =VLOOKUP(条件1&amp;条件2, 数据范围, 列号, FALSE)
    </p>
    <ul>
     <li>
      实现步骤：
      <br/>
      添加辅助列合并条件
      <br/>
      使用连接符组合条件
     </li>
    </ul>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/25ed9448eee9421782a83bbd6995d8c7.png"/>
     <br/>
     =VLOOKUP(“技术部架构师”, A2:C3, 3, FALSE) → 返回15000
    </p>
    <h4>
     <a id="font_colorgreenfont_118">
     </a>
     <font color="green">
      动态列查询
     </font>
    </h4>
    <p>
     =VLOOKUP(查找值, 数据范围, MATCH(列标题, 标题行, 0), FALSE)
    </p>
    <ul>
     <li>
      使用：
     </li>
    </ul>
    <p>
     =VLOOKUP(1001, A2:D4, MATCH(“工资”, A1:D1, 0), FALSE)
    </p>
    <h3>
     <a id="font_colorgreenfont_126">
     </a>
     <font color="green">
      错误处理
     </font>
    </h3>
    <h4>
     <a id="font_colorgreenfont_127">
     </a>
     <font color="green">
      屏蔽错误值
     </font>
    </h4>
    <p>
     =IFERROR(VLOOKUP(…), “未找到”)
    </p>
    <ul>
     <li>
      使用：
     </li>
    </ul>
    <p>
     =IFERROR(VLOOKUP(1004, A2:D4, 2, FALSE), “无此员工”)
    </p>
    <h4>
     <a id="font_colorgreenfont_134">
     </a>
     <font color="green">
      处理数字/文本格式问题
     </font>
    </h4>
    <p>
     =VLOOKUP(TEXT(数值,“0”), 文本范围, 列号, FALSE)
    </p>
    <p>
     或
    </p>
    <p>
     =VLOOKUP(VALUE(文本数字), 数值范围, 列号, FALSE)
    </p>
    <h4>
     <a id="font_colorgreenfont_142">
     </a>
     <font color="green">
      注意事项
     </font>
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/a2bcbee492004bfb9504aba4dccef068.png"/>
    </p>
    <h4>
     <a id="font_colorgreenfont_146">
     </a>
     <font color="green">
      常见错误解决方案
     </font>
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/ad9239736b404906b594c28bba7cec6a.png"/>
    </p>
    <h3>
     <a id="font_colorgreenfont_150">
     </a>
     <font color="green">
      拓展用法
     </font>
    </h3>
    <h4>
     <a id="font_colorgreenfont_152">
     </a>
     <font color="green">
      跨表与跨工作簿查找
     </font>
    </h4>
    <ul>
     <li>
      <p>
       在Sheet1中查找Sheet2的数据时，直接使用工作表名!范围格式引用
      </p>
     </li>
     <li>
      <p>
       跨工作簿查找：
      </p>
     </li>
    </ul>
    <p>
     =VLOOKUP(A2, ‘[工资表.xlsx]Sheet1’!$A
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        2 
        
       
         : 
        
       
      
        2:
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          2
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          :
         </span>
        </span>
       </span>
      </span>
     </span>
     D$100, 4, FALSE)
    </p>
    <p>
     注意：需要保持被引用的工作簿处于打开状态
    </p>
    <h4>
     <a id="font_colorgreenfont_162">
     </a>
     <font color="green">
      查找返回多列数据
     </font>
    </h4>
    <ul>
     <li>
      <p>
       =HLOOKUP(VLOOKUP(…), 返回标题行, MATCH(…))
      </p>
     </li>
     <li>
      <p>
       组合技巧：
      </p>
     </li>
    </ul>
    <p>
     结合COLUMN函数实现公式横向拖动自动匹配列
    </p>
    <p>
     =VLOOKUP($A2, 数据范围, COLUMN(B1), FALSE)
    </p>
    <h4>
     <a id="font_colorgreenfont_172">
     </a>
     <font color="green">
      查找最新记录
     </font>
    </h4>
    <ul>
     <li>
      <p>
       =VLOOKUP(MAX(IF(条件范围=条件, 时间列)), 数据范围, 列号, FALSE)
      </p>
     </li>
     <li>
      <p>
       使用：查找某个客户最后一次交易记录时，需要数组公式配合（按Ctrl+Shift+Enter输入）
      </p>
     </li>
    </ul>
    <h4>
     <a id="font_colorgreenfont_177">
     </a>
     <font color="green">
      性能优化技巧
     </font>
    </h4>
    <ul>
     <li>
      限制查找范围：
     </li>
    </ul>
    <p>
     =VLOOKUP(A2, $A
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        2 
        
       
         : 
        
       
      
        2:
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          2
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          :
         </span>
        </span>
       </span>
      </span>
     </span>
     D$1000, 3, FALSE) # 明确指定数据终点
    </p>
    <p>
     优势：相比A:D的全列引用，可提升计算速度
    </p>
    <ul>
     <li>
      排序优化
     </li>
    </ul>
    <p>
     =VLOOKUP(A2, 排序后的数据范围, 3, TRUE) # 近似匹配时速度更快
    </p>
    <h4>
     <a id="font_colorgreenfont_189">
     </a>
     <font color="green">
      经典组合公式
     </font>
    </h4>
    <ul>
     <li>
      多级条件判断：
     </li>
    </ul>
    <p>
     =VLOOKUP(A2&amp;B2, IF({1,0}, 条件1列&amp;条件2列, 结果列), 2, FALSE)
    </p>
    <ul>
     <li>
      动态范围扩展
     </li>
    </ul>
    <p>
     =VLOOKUP(A2, OFFSET($A
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        1 
        
       
         , 
        
       
         0 
        
       
         , 
        
       
         0 
        
       
         , 
        
       
         C 
        
       
         O 
        
       
         U 
        
       
         N 
        
       
         T 
        
       
         A 
        
       
         ( 
        
       
      
        1,0,0,COUNTA(
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          0
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          0
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          CO
         </span>
         <span class="mord mathnormal" style="margin-right: 0.109em;">
          U
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1389em;">
          NT
         </span>
         <span class="mord mathnormal">
          A
         </span>
         <span class="mopen">
          (
         </span>
        </span>
       </span>
      </span>
     </span>
     A:$A),4), 3, FALSE)
    </p>
    <h4>
     <a id="font_colorgreenfont_198">
     </a>
     <font color="green">
      实操案例库
     </font>
    </h4>
    <ul>
     <li>
      员工信息卡
     </li>
    </ul>
    <p>
     =VLOOKUP(输入工号, 员工数据!$A
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        2 
        
       
         : 
        
       
      
        2:
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          2
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          :
         </span>
        </span>
       </span>
      </span>
     </span>
     F$100, MATCH(B
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        1 
        
       
         , 
        
       
         员工数据 
        
       
         ! 
        
       
      
        1, 员工数据!
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord cjk_fallback">
          员工数据
         </span>
         <span class="mclose">
          !
         </span>
        </span>
       </span>
      </span>
     </span>
     A
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        1 
        
       
         : 
        
       
      
        1:
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          :
         </span>
        </span>
       </span>
      </span>
     </span>
     F$1,0), FALSE)
    </p>
    <ul>
     <li>
      <p>
       功能说明：
       <br/>
       B1单元格显示"姓名"时返回姓名
       <br/>
       C1单元格显示"部门"时返回部门
      </p>
     </li>
     <li>
      <p>
       智能报价系统：
      </p>
     </li>
    </ul>
    <p>
     =VLOOKUP(客户等级, 折扣表, 2, TRUE)*VLOOKUP(产品编号, 价格表, 2, FALSE)
    </p>
    <ul>
     <li>
      考勤异常检测：
     </li>
    </ul>
    <p>
     =IF(ISNA(VLOOKUP(员工ID, 打卡记录!A:B, 2, FALSE)), “缺勤”, “正常”)
    </p>
    <h4>
     <a id="font_colorgreenfont_216">
     </a>
     <font color="green">
      函数组合使用
     </font>
    </h4>
    <ul>
     <li>
      INDEX+MATCH组合：
     </li>
    </ul>
    <p>
     =INDEX(返回列, MATCH(查找值, 查找列, 0))
    </p>
    <ul>
     <li>
      <p>
       优势：
       <br/>
       支持向左查找
       <br/>
       不受列位置限制
       <br/>
       计算效率更高
      </p>
     </li>
     <li>
      <p>
       XLOOKUP：
      </p>
     </li>
    </ul>
    <p>
     =XLOOKUP(查找值, 查找范围, 返回范围, “未找到”, 0, 1)
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f73746f727966756c6c2f:61727469636c652f64657461696c732f313436323339313433" class_="artid" style="display:none">
 </p>
</div>


