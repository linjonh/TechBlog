---
layout: post
title: "ApoorvCTF-Rust语言逆向实战"
date: 2025-03-07 10:22:59 +0800
description: "上周参加了国外的ApoorvCTF比赛，看一下老外的比赛跟我们有什么不同，然后我根据国内比赛对比发现，他们考点还是很有意思的，反正都是逆向。"
keywords: "ApoorvCTF Rust语言逆向实战"
categories: ['逆向学习', '经验分享', 'Ctf']
tags: ['Ctf', 'Ctf', 'Apoorvctf']
artid: "146088701"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146088701
    alt: "ApoorvCTF-Rust语言逆向实战"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146088701
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146088701
cover: https://bing.ee123.net/img/rand?artid=146088701
image: https://bing.ee123.net/img/rand?artid=146088701
img: https://bing.ee123.net/img/rand?artid=146088701
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     ApoorvCTF Rust语言逆向实战
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     上周参加了国外的比赛，名称叫：ApoorvCTF
    </p>
    <p>
     看一下老外的比赛跟我们有什么不同，然后我根据国内比赛对比发现，他们考点还是很有意思的，反正都是逆向，哈哈哈
    </p>
    <h3>
     <a id="Rusty_Vault_4">
     </a>
     Rusty Vault
    </h3>
    <p>
     题目描述：
    </p>
    <p>
     In the heart of an abandoned shrine, there’s an old, rusted vault said
     <br/>
     to guard an unspeakable secret. Many have tried to unlock it, but the
     <br/>
     door’s demands are strange and no key seems to fit.
    </p>
    <p>
     <img alt="image" src="https://i-blog.csdnimg.cn/img_convert/c9780dda2944dffecbdb85c75214adfa.png"/>
    </p>
    <p>
     进入main函数，开始分析
    </p>
    <p>
     <img alt="image" src="https://i-blog.csdnimg.cn/img_convert/9412e34a134d5d0d812a8d8491858fda.png"/>
    </p>
    <p>
     这个命名方式，大概率是Rust语言
    </p>
    <p>
     对于rust语言逆向，一般采用动态调试分析的方法
    </p>
    <p>
     主要还是看汇编，因为F5根本看不出来啥东西。。。
    </p>
    <p>
     <img alt="image" src="https://i-blog.csdnimg.cn/img_convert/c84c8809eb5d772749f265474c803d9b.png"/>
    </p>
    <p>
     从if比较处，可以看到成功和失败两个结果
    </p>
    <p>
     那么这个比较绝对很关键
    </p>
    <p>
     <img alt="image" src="https://i-blog.csdnimg.cn/img_convert/99f2246d7ab0a82a6b06c9d225a83226.png"/>
    </p>
    <p>
     进入后发现，啥也没啊？
    </p>
    <p>
     坏了，得看汇编，为代码估计又出问题了
    </p>
    <p>
     <img alt="image" src="https://i-blog.csdnimg.cn/img_convert/edf893caf8b77e5df98247f428f707ee.png"/>
    </p>
    <p>
     发现了check2，果然为代码啥也看不到
    </p>
    <p>
     <img alt="image" src="https://i-blog.csdnimg.cn/img_convert/f8da8dd42d80406487fa124cc50c784b.png"/>
    </p>
    <p>
     对比check1-2
    </p>
    <p>
     发现是在检测输入的字符串的字符类型，还是冲突的，不管了继续分析
    </p>
    <p>
     <img alt="image" src="https://i-blog.csdnimg.cn/img_convert/795fb86c2960534e42193fca58937fe3.png"/>
    </p>
    <p>
     下面可以看到失败
    </p>
    <p>
     往下滑动可以看到成功
    </p>
    <p>
     <img alt="image" src="https://i-blog.csdnimg.cn/img_convert/7506384eac5b46c1d84cc5889a85372f.png"/>
    </p>
    <p>
     什么意思？
    </p>
    <p>
     我猜测这题是改条件，然后动态输出flag？还有这好事
    </p>
    <p>
     <img alt="image" src="https://i-blog.csdnimg.cn/img_convert/aa76e93385a44c1d30df2e716b7f0166.png"/>
    </p>
    <p>
     后面都是正常输出flag了
    </p>
    <p>
     那么我们现在去解密的地方回溯，估计我要改一些判断，改变流程，让程序正常走到解密的地方，然后输出flag
    </p>
    <p>
     帮助网安学习，全套资料S信免费领取：
     <br/>
     ① 网安学习成长路径思维导图
     <br/>
     ② 60+网安经典常用工具包
     <br/>
     ③ 100+SRC分析报告
     <br/>
     ④ 150+网安攻防实战技术电子书
     <br/>
     ⑤ 最权威CISSP 认证考试指南+题库
     <br/>
     ⑥ 超1800页CTF实战技巧手册
     <br/>
     ⑦ 最新网安大厂面试题合集（含答案）
     <br/>
     ⑧ APP客户端安全检测指南（安卓+IOS）
    </p>
    <p>
     教大家一个回溯方法
    </p>
    <p>
     <img alt="image" src="https://i-blog.csdnimg.cn/img_convert/d2a9ebfeda1a78060a7c039f0769eec5.png"/>
    </p>
    <p>
     对标签疯狂X键，交叉引用定位回溯
    </p>
    <p>
     <img alt="image" src="https://i-blog.csdnimg.cn/img_convert/1ec311aa09e2f2869d8560c2da73e822.png"/>
    </p>
    <p>
     最终定位到密文，发现是aes_128_cbc模式
    </p>
    <p>
     需要：key+IV+密文=明文
    </p>
    <p>
     这是一种思路，大家可以尝试
    </p>
    <p>
     本文修改流程，让他自动输出明文
    </p>
    <p>
     <img alt="image" src="https://i-blog.csdnimg.cn/img_convert/6db1d299e4312f7cc572e36e69b7c603.png"/>
    </p>
    <p>
     现在的思路就是：
    </p>
    <p>
     x键回溯定位关键标签，修改关键判断
    </p>
    <p>
     让程序自动走向解密
    </p>
    <p>
     <img alt="image" src="https://i-blog.csdnimg.cn/img_convert/e8b16d6bf6dbb906b7699b9b030cc8be.png"/>
    </p>
    <p>
     nop掉check1 和 check2
    </p>
    <p>
     让他们走向自动解密的方向
    </p>
    <p>
     <img alt="image" src="https://i-blog.csdnimg.cn/img_convert/74cac652c6fec21e9bc8c5e7e4bb5f88.png"/>
    </p>
    <p>
     最终运行程序得到flag，静态patch流程，绕过check1-chekc2
    </p>
    <pre><code>apoorvctf{P4tch_1t_L1k3_1t's_HOt}
</code></pre>
    <p>
     这在我们国内比赛还是很少见到的，国内大概率要写脚本解密，或许国内认为加密才是CTF的重点。国外侧重逆向本身，如果可以patch修改流程得到flag，为什么要去写解密脚本呢？
    </p>
    <p>
     锻炼了我们通过汇编分析程序流程的能力，而不是为代码一键分析。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f33383135343832302f:61727469636c652f64657461696c732f313436303838373031" class_="artid" style="display:none">
 </p>
</div>


