---
layout: post
title: "MySQL和Hive-SQL-时间处理常用函数汇总"
date: 2025-03-07 16:52:51 +0800
description: "中常用的时间处理函数汇总，涵盖。"
keywords: "MySQL和Hive SQL 时间处理常用函数汇总"
categories: ['Sql', 'Sql', 'Server', 'Mysql']
tags: ['机器学习', '数据库', '人工智能', 'Sql', 'Sklearn', 'Mysql', 'Hive']
artid: "146099323"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146099323
    alt: "MySQL和Hive-SQL-时间处理常用函数汇总"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146099323
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146099323
cover: https://bing.ee123.net/img/rand?artid=146099323
image: https://bing.ee123.net/img/rand?artid=146099323
img: https://bing.ee123.net/img/rand?artid=146099323
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     MySQL和Hive SQL 时间处理常用函数汇总
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <p>
     以下是
     <code>
      SQL
     </code>
     中常用的时间处理函数汇总，涵盖
     <code>
      MySQL
     </code>
     和
     <code>
      Hive
     </code>
     的差异：
    </p>
    <h5>
     <a id="_3">
     </a>
     一、基础时间函数
    </h5>
    <table>
     <thead>
      <tr>
       <th>
        功能
       </th>
       <th>
        MySQL
       </th>
       <th>
        Hive
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        当前时间（日期 + 时间）
       </td>
       <td>
        NOW() / CURRENT_TIMESTAMP()
       </td>
       <td>
        current_timestamp()
       </td>
      </tr>
      <tr>
       <td>
        当前日期
       </td>
       <td>
        CURDATE() / CURRENT_DATE()
       </td>
       <td>
        current_date()
       </td>
      </tr>
      <tr>
       <td>
        当前时间
       </td>
       <td>
        CURTIME()
       </td>
       <td>
        current_time()
       </td>
      </tr>
     </tbody>
    </table>
    <h5>
     <a id="_9">
     </a>
     二、日期加减操作
    </h5>
    <table>
     <thead>
      <tr>
       <th>
        功能
       </th>
       <th>
        MySQL
       </th>
       <th>
        Hive
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        日期增加 / 减少
       </td>
       <td>
        DATE_SUB(date, INTERVAL n DAY)
       </td>
       <td>
        date_sub(date, n)
       </td>
      </tr>
      <tr>
       <td>
        月份增加 / 减少
       </td>
       <td>
        DATE_SUB(date, INTERVAL n MONTH)
       </td>
       <td>
        add_months(date, n)
       </td>
      </tr>
      <tr>
       <td>
        年份增加 / 减少
       </td>
       <td>
        DATE_SUB(date, INTERVAL n YEAR)
       </td>
       <td>
        date_sub(date, n * 365)（近似）
       </td>
      </tr>
      <tr>
       <td>
        时间增加秒数
       </td>
       <td>
        DATE_ADD(time, INTERVAL n SECOND)
       </td>
       <td>
        date_add(time, n)
       </td>
      </tr>
     </tbody>
    </table>
    <h5>
     <a id="_17">
     </a>
     三、日期格式化与解析
    </h5>
    <table>
     <thead>
      <tr>
       <th>
        功能
       </th>
       <th>
        MySQL
       </th>
       <th>
        Hive
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        格式化日期
       </td>
       <td>
        DATE_FORMAT(date, format)
       </td>
       <td>
        date_format(date, format)
       </td>
      </tr>
      <tr>
       <td>
        解析字符串为日期
       </td>
       <td>
        STR_TO_DATE(str, format)
       </td>
       <td>
        from_utc_timestamp(unix_timestamp(str), ‘Asia/Shanghai’)
       </td>
      </tr>
      <tr>
       <td>
        提取年份
       </td>
       <td>
        YEAR(date)
       </td>
       <td>
        year(date)
       </td>
      </tr>
      <tr>
       <td>
        提取月份
       </td>
       <td>
        MONTH(date)
       </td>
       <td>
        month(date)
       </td>
      </tr>
      <tr>
       <td>
        提取日期
       </td>
       <td>
        DAY(date)
       </td>
       <td>
        day(date)
       </td>
      </tr>
      <tr>
       <td>
        提取季度
       </td>
       <td>
        QUARTER(date)
       </td>
       <td>
        quarter(date)
       </td>
      </tr>
     </tbody>
    </table>
    <h5>
     <a id="_27">
     </a>
     四、时间差计算
    </h5>
    <table>
     <thead>
      <tr>
       <th>
        功能
       </th>
       <th>
        MySQL
       </th>
       <th>
        Hive
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        日期差（天数）
       </td>
       <td>
        DATEDIFF(end_date, start_date)
       </td>
       <td>
        datediff(end_date, start_date)
       </td>
      </tr>
      <tr>
       <td>
        时间差（秒数）
       </td>
       <td>
        TIMESTAMPDIFF(SECOND, start, end)
       </td>
       <td>
        unix_timestamp(end) - unix_timestamp(start)
       </td>
      </tr>
     </tbody>
    </table>
    <h5>
     <a id="_32">
     </a>
     五、时间类型转换
    </h5>
    <table>
     <thead>
      <tr>
       <th>
        功能
       </th>
       <th>
        MySQL
       </th>
       <th>
        Hive
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        时间戳转日期
       </td>
       <td>
        FROM_UNIXTIME(timestamp)
       </td>
       <td>
        from_utc_timestamp(timestamp, ‘Asia/Shanghai’)
       </td>
      </tr>
      <tr>
       <td>
        日期转时间戳
       </td>
       <td>
        UNIX_TIMESTAMP(date)
       </td>
       <td>
        unix_timestamp(date)
       </td>
      </tr>
      <tr>
       <td>
        字符串转时间戳
       </td>
       <td>
        UNIX_TIMESTAMP(str, format)
       </td>
       <td>
        unix_timestamp(str, format)
       </td>
      </tr>
     </tbody>
    </table>
    <h5>
     <a id="_38">
     </a>
     六、时区处理
    </h5>
    <table>
     <thead>
      <tr>
       <th>
        功能
       </th>
       <th>
        MySQL
       </th>
       <th>
        Hive
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        转换时区
       </td>
       <td>
        CONVERT_TZ(time, from_tz, to_tz)
       </td>
       <td>
        from_utc_timestamp(time, ‘Asia/Shanghai’)
       </td>
      </tr>
     </tbody>
    </table>
    <h5>
     <a id="_43">
     </a>
     示例
    </h5>
    <h6>
     <a id="_44">
     </a>
     获取当前时间并格式化
    </h6>
    <pre><code class="prism language-sql">MySQL: <span class="token keyword">SELECT</span> DATE_FORMAT<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'%Y-%m-%d %H:%i:%s'</span><span class="token punctuation">)</span>
Hive: <span class="token keyword">SELECT</span> date_format<span class="token punctuation">(</span><span class="token keyword">current_timestamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'yyyy-MM-dd HH:mm:ss'</span><span class="token punctuation">)</span>
</code></pre>
    <h6>
     <a id="_3__51">
     </a>
     日期增加 3 天
    </h6>
    <pre><code class="prism language-sql">MySQL: <span class="token keyword">SELECT</span> DATE_SUB<span class="token punctuation">(</span><span class="token string">'2025-03-07'</span><span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token number">3</span> <span class="token keyword">DAY</span><span class="token punctuation">)</span>
Hive: <span class="token keyword">SELECT</span> date_sub<span class="token punctuation">(</span><span class="token string">'2025-03-07'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
</code></pre>
    <h6>
     <a id="_58">
     </a>
     计算两个日期的天数差
    </h6>
    <pre><code class="prism language-sql">MySQL: <span class="token keyword">SELECT</span> DATEDIFF<span class="token punctuation">(</span><span class="token string">'2025-03-10'</span><span class="token punctuation">,</span> <span class="token string">'2025-03-07'</span><span class="token punctuation">)</span>
Hive: <span class="token keyword">SELECT</span> datediff<span class="token punctuation">(</span><span class="token string">'2025-03-10'</span><span class="token punctuation">,</span> <span class="token string">'2025-03-07'</span><span class="token punctuation">)</span>
</code></pre>
    <h6>
     <a id="_65">
     </a>
     注意事项：
    </h6>
    <ul>
     <li>
      <code>
       MySQL
      </code>
      和
      <code>
       Hive
      </code>
      的函数名称和参数顺序可能存在差异（如
      <code>
       Hive
      </code>
      的
      <code>
       date_sub
      </code>
      直接使用数值而非
      <code>
       INTERVAL
      </code>
      ）。
     </li>
     <li>
      <code>
       Hive
      </code>
      通常需要显式处理时区（如
      <code>
       from_utc_timestamp
      </code>
      ），而
      <code>
       MySQL
      </code>
      可通过会话时区设置简化操作。
     </li>
    </ul>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34363533303439322f:61727469636c652f64657461696c732f313436303939333233" class_="artid" style="display:none">
 </p>
</div>


