---
arturl_encode: "68747470733a2f2f626c:6f672e6373646e2e6e65742f5072696e63653134303637382f:61727469636c652f64657461696c732f313436313332373835"
layout: post
title: "SpringBootæ·±å…¥å‰–æ-Spring-Boot-å¯åŠ¨è¿‡ç¨‹é™„æºç ä¸å®æˆ˜"
date: 2025-03-09 15:16:55 +0800
description: "æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰æ¥ç›‘å¬ Spring Boot å¯åŠ¨è¿‡ç¨‹ï¼Œå¹¶è®°å½•æ—¥å¿—ã€‚Spring Boot å¯åŠ¨çš„æ ¸å¿ƒå…¥å£æ˜¯ï¼Œå®ƒå®Œæˆç¯å¢ƒå‡†å¤‡ã€å®¹å™¨åˆ›å»ºã€äº‹ä»¶å‘å¸ƒç­‰æ­¥éª¤ã€‚æ ¸å¿ƒç»„ä»¶åŒ…æ‹¬ï¼Œå®ƒä»¬ååŒå®Œæˆåº”ç”¨åˆå§‹åŒ–ã€‚æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ï¼Œç›‘å¬ Spring Boot å¯åŠ¨äº‹ä»¶ï¼Œå®ç°æ—¥å¿—è®°å½•æˆ–å…¶ä»–å¢å¼ºåŠŸèƒ½ã€‚Spring Boot çš„å¯åŠ¨è¿‡ç¨‹æ˜¯ä¸€ä¸ªæ ‡å‡†åŒ–çš„â€œæ¨¡æ¿æ–¹æ³•æ¨¡å¼â€å®ç°ï¼Œæ¯ä¸€æ­¥éƒ½å¯ä»¥é€šè¿‡æ‰©å±•ç‚¹è¿›è¡Œè‡ªå®šä¹‰ï¼Œæå¤§å¢å¼ºäº†æ¡†æ¶çš„å¯æ‰©å±•æ€§ã€‚å¸Œæœ›æœ¬ç¯‡æ–‡ç« èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ Spring Boot çš„å¯åŠ¨åŸç†ï¼ğŸ“Œä½ å­¦ä¼šäº†å—ï¼Ÿ"
keywords: "ã€SpringBootã€‘æ·±å…¥å‰–æ Spring Boot å¯åŠ¨è¿‡ç¨‹ï¼ˆé™„æºç ä¸å®æˆ˜ï¼‰"
categories: ['åŸç†åˆ†æ', 'Springboot']
tags: ['åŸç†åˆ†æ', 'Spring', 'Boot']
artid: "146132785"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146132785
    alt: "SpringBootæ·±å…¥å‰–æ-Spring-Boot-å¯åŠ¨è¿‡ç¨‹é™„æºç ä¸å®æˆ˜"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146132785
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146132785
cover: https://bing.ee123.net/img/rand?artid=146132785
image: https://bing.ee123.net/img/rand?artid=146132785
img: https://bing.ee123.net/img/rand?artid=146132785
---

# ã€SpringBootã€‘æ·±å…¥å‰–æ Spring Boot å¯åŠ¨è¿‡ç¨‹ï¼ˆé™„æºç ä¸å®æˆ˜ï¼‰

## æ·±å…¥å‰–æ Spring Boot å¯åŠ¨è¿‡ç¨‹ï¼ˆé™„æºç ä¸å®æˆ˜ï¼‰

Spring Boot ä»¥å…¶â€œå¼€ç®±å³ç”¨â€çš„ç‰¹æ€§æ·±å—å¼€å‘è€…å–œçˆ±ï¼Œç„¶è€Œï¼ŒSpring Boot æ˜¯å¦‚ä½•å¯åŠ¨çš„ï¼Ÿå®ƒå¦‚ä½•åšåˆ°è‡ªåŠ¨åŒ–é…ç½®ï¼Ÿè¿™èƒŒåçš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿæœ¬ç¯‡æ–‡ç« å°†ä»æºç å‡ºå‘ï¼Œå‰–æ Spring Boot å¯åŠ¨çš„æ ¸å¿ƒæµç¨‹ï¼Œå¹¶é€šè¿‡ä»£ç å®æˆ˜åŠ æ·±ç†è§£ã€‚

---

### 1. Spring Boot å¯åŠ¨çš„æ ¸å¿ƒæµç¨‹

Spring Boot åº”ç”¨çš„å¯åŠ¨é€šå¸¸ä»
`main`
æ–¹æ³•å¼€å§‹ï¼Œä¾‹å¦‚ï¼š

```java
@SpringBootApplication
public class DemoApplication {
    public static void main(String[] args) {
        SpringApplication.run(DemoApplication.class, args);
    }
}

```

å…¶ä¸­
`SpringApplication.run()`
æ˜¯å¯åŠ¨çš„å…³é”®å…¥å£ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥æ·±å…¥åˆ†æå…¶æ ¸å¿ƒæµç¨‹ã€‚

#### 1.1 `SpringApplication.run()` è¿‡ç¨‹

æºç å…¥å£ä½äº
`SpringApplication`
ç±»çš„
`run()`
æ–¹æ³•ï¼š

```java
public static ConfigurableApplicationContext run(Class<?> primarySource, String... args) {
    return new SpringApplication(primarySource).run(args);
}

```

å®ƒä¸»è¦åšäº†å¦‚ä¸‹å‡ ä»¶äº‹ï¼š

1. **åˆ›å»º
   `SpringApplication`
   å®ä¾‹**
2. **è°ƒç”¨
   `run()`
   æ–¹æ³•ï¼Œæ‰§è¡Œæ ¸å¿ƒå¯åŠ¨é€»è¾‘**
3. **è¿”å›
   `ConfigurableApplicationContext`
   ä½œä¸º Spring å®¹å™¨**

è¿›ä¸€æ­¥åˆ†æ
`run()`
æ–¹æ³•å†…éƒ¨é€»è¾‘ï¼š

```java
public ConfigurableApplicationContext run(String... args) {
    long startTime = System.nanoTime();

    // 1. åˆ›å»ºå¹¶å¯åŠ¨ `SpringApplicationRunListeners`
    SpringApplicationRunListeners listeners = getRunListeners(args);
    listeners.starting();

    // 2. æ„é€  `ApplicationArguments`
    ApplicationArguments applicationArguments = new DefaultApplicationArguments(args);

    // 3. å‡†å¤‡ `Environment`
    ConfigurableEnvironment environment = prepareEnvironment(listeners, applicationArguments);

    // 4. æ‰“å° Banner
    printBanner(environment);

    // 5. åˆ›å»º `ApplicationContext`
    ConfigurableApplicationContext context = createApplicationContext();

    // 6. å‡†å¤‡ `ApplicationContext`
    prepareContext(context, environment, listeners, applicationArguments);

    // 7. åˆ·æ–° `ApplicationContext`
    refreshContext(context);

    // 8. æ‰§è¡Œ `ApplicationRunner` å’Œ `CommandLineRunner`
    afterRefresh(context, applicationArguments);

    // 9. é€šçŸ¥æ‰€æœ‰ç›‘å¬å™¨ï¼Œå¯åŠ¨å®Œæˆ
    listeners.started(context);
    listeners.running(context);

    return context;
}

```

#### 1.2 å…³é”®æ­¥éª¤è¯¦è§£

##### 1ï¸âƒ£ SpringApplicationRunListeners

åœ¨
`getRunListeners(args)`
æ–¹æ³•ä¸­ï¼Œä¼šåŠ è½½
`META-INF/spring.factories`
ä¸­çš„
`SpringApplicationRunListener`
ï¼Œå¦‚
`EventPublishingRunListener`
ï¼Œç”¨äºå‘å¸ƒ Spring Boot å¯åŠ¨ç›¸å…³çš„äº‹ä»¶ï¼Œå¦‚
`ApplicationStartedEvent`
ã€‚

##### 2ï¸âƒ£ Environment å‡†å¤‡

`prepareEnvironment()`
æ–¹æ³•ç”¨äºåŠ è½½
`application.properties`
æˆ–
`application.yml`
ç­‰é…ç½®ä¿¡æ¯ï¼Œå¹¶å†³å®šæ˜¯å¦å¯ç”¨
`DevTools`
ã€‚

##### 3ï¸âƒ£ åˆ›å»º Spring å®¹å™¨

`createApplicationContext()`
é€šè¿‡
`SpringFactoriesLoader`
åŠ è½½
`SpringApplication`
é…ç½®çš„
`ApplicationContext`
å®ç°ç±»ï¼ˆå¦‚
`AnnotationConfigServletWebServerApplicationContext`
ï¼‰ï¼Œç„¶å
`prepareContext()`
è¿›è¡Œé…ç½®ã€‚

##### 4ï¸âƒ£ åˆ·æ–°å®¹å™¨

`refreshContext()`
æœ€ç»ˆè°ƒç”¨
`context.refresh()`
ï¼Œå®Œæˆ Spring æ ¸å¿ƒçš„
`refresh()`
è¿‡ç¨‹ï¼Œåˆå§‹åŒ– BeanFactoryï¼Œæ³¨å†Œ Bean åå¤„ç†å™¨ï¼Œå®Œæˆ AOPã€äº‹åŠ¡ç­‰åŠŸèƒ½çš„åˆå§‹åŒ–ã€‚

##### 5ï¸âƒ£ è¿è¡Œ `ApplicationRunner` å’Œ `CommandLineRunner`

Spring Boot æä¾›
`ApplicationRunner`
å’Œ
`CommandLineRunner`
æ¥å£ï¼Œåœ¨
`afterRefresh()`
æ–¹æ³•ä¸­æ‰§è¡Œï¼Œå¯ä»¥åœ¨åº”ç”¨å¯åŠ¨åè¿è¡Œç‰¹å®šä»£ç ï¼š

```java
@Component
public class MyRunner implements ApplicationRunner {
    @Override
    public void run(ApplicationArguments args) throws Exception {
        System.out.println("ApplicationRunner æ‰§è¡Œï¼Œå‚æ•°ï¼š" + Arrays.toString(args.getSourceArgs()));
    }
}

```

---

### 2. ä»£ç å®æˆ˜ï¼šè‡ªå®šä¹‰ `SpringApplicationRunListener`

æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰
`SpringApplicationRunListener`
æ¥ç›‘å¬ Spring Boot å¯åŠ¨è¿‡ç¨‹ï¼Œå¹¶è®°å½•æ—¥å¿—ã€‚

#### 2.1 åˆ›å»º `MyApplicationRunListener`

```java
public class MyApplicationRunListener implements SpringApplicationRunListener {

    public MyApplicationRunListener(SpringApplication application, String[] args) {}

    @Override
    public void starting() {
        System.out.println(">>> Spring Boot æ­£åœ¨å¯åŠ¨...");
    }

    @Override
    public void environmentPrepared(ConfigurableEnvironment environment) {
        System.out.println(">>> Environment å·²å‡†å¤‡ï¼š" + environment.getActiveProfiles());
    }

    @Override
    public void contextPrepared(ConfigurableApplicationContext context) {
        System.out.println(">>> ApplicationContext å·²åˆ›å»º...");
    }

    @Override
    public void started(ConfigurableApplicationContext context) {
        System.out.println(">>> Spring Boot å·²å¯åŠ¨ï¼");
    }

    @Override
    public void running(ConfigurableApplicationContext context) {
        System.out.println(">>> Spring Boot è¿è¡Œä¸­...");
    }

    @Override
    public void failed(ConfigurableApplicationContext context, Throwable exception) {
        System.out.println(">>> å¯åŠ¨å¤±è´¥ï¼š" + exception.getMessage());
    }
}

```

#### 2.2 é…ç½® `META-INF/spring.factories`

åœ¨
`resources/META-INF/spring.factories`
æ–‡ä»¶ä¸­ï¼Œæ·»åŠ ï¼š

```
org.springframework.boot.SpringApplicationRunListener=com.example.listener.MyApplicationRunListener

```

è¿™æ ·ï¼ŒSpring Boot å¯åŠ¨æ—¶ï¼Œå°±ä¼šè‡ªåŠ¨åŠ è½½
`MyApplicationRunListener`
ï¼Œè¾“å‡ºæ—¥å¿—ã€‚

---

### 3. æ€»ç»“

1. **Spring Boot å¯åŠ¨çš„æ ¸å¿ƒå…¥å£æ˜¯
   `SpringApplication.run()`**
   ï¼Œå®ƒå®Œæˆç¯å¢ƒå‡†å¤‡ã€å®¹å™¨åˆ›å»ºã€äº‹ä»¶å‘å¸ƒç­‰æ­¥éª¤ã€‚
2. **æ ¸å¿ƒç»„ä»¶åŒ…æ‹¬
   `SpringApplicationRunListeners`
   ã€
   `Environment`
   ã€
   `ApplicationContext`**
   ï¼Œå®ƒä»¬ååŒå®Œæˆåº”ç”¨åˆå§‹åŒ–ã€‚
3. **æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰
   `SpringApplicationRunListener`
   ï¼Œç›‘å¬ Spring Boot å¯åŠ¨äº‹ä»¶**
   ï¼Œå®ç°æ—¥å¿—è®°å½•æˆ–å…¶ä»–å¢å¼ºåŠŸèƒ½ã€‚

Spring Boot çš„å¯åŠ¨è¿‡ç¨‹æ˜¯ä¸€ä¸ªæ ‡å‡†åŒ–çš„â€œæ¨¡æ¿æ–¹æ³•æ¨¡å¼â€å®ç°ï¼Œæ¯ä¸€æ­¥éƒ½å¯ä»¥é€šè¿‡æ‰©å±•ç‚¹è¿›è¡Œè‡ªå®šä¹‰ï¼Œæå¤§å¢å¼ºäº†æ¡†æ¶çš„å¯æ‰©å±•æ€§ã€‚å¸Œæœ›æœ¬ç¯‡æ–‡ç« èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ Spring Boot çš„å¯åŠ¨åŸç†ï¼

---

ğŸ“Œ
**ä½ å­¦ä¼šäº†å—ï¼Ÿ**
æ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€äº¤æµï¼ğŸš€