---
arturl_encode: "68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f37303837313134302f:61727469636c652f64657461696c732f313436323639373630"
layout: post
title: "ä»€ä¹ˆæ˜¯-MyBatis"
date: 2025-03-14 23:57:43 +08:00
description: "MyBatis æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æŒä¹…å±‚æ¡†æ¶ï¼Œç”¨äºç®€åŒ– Java åº”ç”¨ç¨‹åºä¸æ•°æ®åº“çš„äº¤äº’ã€‚å®ƒæä¾›äº†ä¸€ç§åŸºäº SQL æ˜ å°„çš„æŒä¹…åŒ–æ–¹æ¡ˆï¼Œé¿å…äº† JDBC ç¹ççš„ä»£ç ï¼ŒåŒæ—¶æ¯”å…¨è‡ªåŠ¨çš„ ORM æ¡†æ¶ï¼ˆå¦‚ Hibernateï¼‰æ›´çµæ´»ã€‚âœ…éœ€è¦æ‰‹å†™ SQLï¼Œä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½çš„é¡¹ç›®å¤æ‚æ•°æ®åº“ç»“æ„ï¼ŒORM æ¡†æ¶éš¾ä»¥æ»¡è¶³éœ€æ±‚çš„åœºæ™¯éœ€è¦è½»é‡çº§æŒä¹…å±‚æ¡†æ¶çš„åº”ç”¨âŒéœ€è¦å…¨è‡ªåŠ¨ ORMï¼Œé¿å…å†™ SQL çš„é¡¹ç›®ï¼ˆå¯ä»¥è€ƒè™‘ Hibernateï¼‰ğŸ¯æ€»ç»“ï¼šMyBatis ç»“åˆäº† SQL çš„çµæ´»æ€§å’Œ ORM çš„ä¾¿åˆ©æ€§ï¼Œé€‚ç”¨äºå¤§å¤šæ•°ä¼ä¸šçº§åº”ç”¨ã€‚"
keywords: "ä»€ä¹ˆæ˜¯ MyBatisï¼Ÿ"
categories: ['Mybatis']
tags: ['å¼€å‘', 'åç«¯', 'Mybatis', 'Java']
artid: "146269760"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146269760
    alt: "ä»€ä¹ˆæ˜¯-MyBatis"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146269760
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146269760
cover: https://bing.ee123.net/img/rand?artid=146269760
image: https://bing.ee123.net/img/rand?artid=146269760
img: https://bing.ee123.net/img/rand?artid=146269760
---

# ä»€ä¹ˆæ˜¯ MyBatisï¼Ÿ

### 1ï¸âƒ£ MyBatis ç®€ä»‹

MyBatis æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„
**æŒä¹…å±‚æ¡†æ¶**
ï¼Œç”¨äºç®€åŒ– Java åº”ç”¨ç¨‹åºä¸æ•°æ®åº“çš„äº¤äº’ã€‚å®ƒæä¾›äº†ä¸€ç§
**åŸºäº SQL æ˜ å°„**
çš„æŒä¹…åŒ–æ–¹æ¡ˆï¼Œé¿å…äº† JDBC ç¹ççš„ä»£ç ï¼ŒåŒæ—¶æ¯”å…¨è‡ªåŠ¨çš„ ORM æ¡†æ¶ï¼ˆå¦‚ Hibernateï¼‰æ›´çµæ´»ã€‚

#### ğŸ“Œ MyBatis ä¸»è¦ç‰¹ç‚¹

* **SQL æ˜ å°„**
  ï¼šå¼€å‘è€…å¯ä»¥æ‰‹å†™ SQLï¼Œæ›´åŠ çµæ´»ï¼Œé€‚ç”¨äºå¤æ‚æŸ¥è¯¢ã€‚
* **ç®€åŒ– JDBC**
  ï¼šå°è£…äº†æ•°æ®åº“è¿æ¥ã€å‚æ•°è®¾ç½®ã€ç»“æœæ˜ å°„ç­‰æ­¥éª¤ã€‚
* **åŠ¨æ€ SQL**
  ï¼šæ”¯æŒ
  `if`
  ã€
  `choose`
  ã€
  `foreach`
  ç­‰æ ‡ç­¾ï¼Œä½¿ SQL æ›´å…·é€‚åº”æ€§ã€‚
* **ç¼“å­˜æœºåˆ¶**
  ï¼šå†…ç½®ä¸€çº§ç¼“å­˜å’Œå¯é€‰çš„äºŒçº§ç¼“å­˜ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚
* **æ’ä»¶æ‰©å±•**
  ï¼šå¯è‡ªå®šä¹‰æ‹¦æˆªå™¨ï¼Œå¢å¼º SQL æ‰§è¡Œé€»è¾‘ã€‚

---

### 2ï¸âƒ£ MyBatis vs ä¼ ç»Ÿ JDBC vs Hibernate ğŸ“Š

| ç‰¹æ€§ | JDBC | MyBatis | Hibernate |
| --- | --- | --- | --- |
| **å¼€å‘å¤æ‚åº¦** | éœ€æ‰‹å†™ SQLï¼Œè¾ƒå¤æ‚ | éœ€æ‰‹å†™ SQLï¼Œè¾ƒçµæ´» | æ— éœ€æ‰‹å†™ SQLï¼Œè‡ªåŠ¨æ˜ å°„ |
| **SQL æ§åˆ¶** | å®Œå…¨æ‰‹åŠ¨æ§åˆ¶ | æ‰‹å†™ SQLï¼Œå¯åŠ¨æ€ SQL | ç”±æ¡†æ¶ç”Ÿæˆï¼Œéš¾ä»¥ä¼˜åŒ– |
| **æ€§èƒ½** | å¯ä¼˜åŒ–ï¼Œä½†ä»£ç å†—é•¿ | é€‚ä¸­ï¼ŒSQL ç›´æ¥æ‰§è¡Œ | å¯èƒ½å­˜åœ¨ N+1 æŸ¥è¯¢é—®é¢˜ |
| **ç¼“å­˜æœºåˆ¶** | æ— å†…ç½®ç¼“å­˜ | ä¸€çº§ã€äºŒçº§ç¼“å­˜æ”¯æŒ | ä¸€çº§ã€äºŒçº§ç¼“å­˜ + JPA çº§è”ç¼“å­˜ |
| **å­¦ä¹ æˆæœ¬** | ä½ï¼Œä½†éœ€å¤„ç†å¤§é‡é‡å¤ä»£ç  | é€‚ä¸­ï¼Œéœ€è¦ç†è§£ XML æˆ–æ³¨è§£æ˜ å°„ | é«˜ï¼Œéœ€è¦å­¦ä¹  HQLã€æ˜ å°„é…ç½® |

âœ…
**æ€»ç»“**
ï¼šå¦‚æœé¡¹ç›®å¯¹ SQL æœ‰é«˜åº¦æ§åˆ¶éœ€æ±‚ï¼Œä¸”æŸ¥è¯¢è¾ƒå¤æ‚ï¼ŒMyBatis æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚

---

### 3ï¸âƒ£ MyBatis æ ¸å¿ƒç»„ä»¶ ğŸ—ï¸

#### 1. SqlSessionFactory

* **ä½œç”¨**
  ï¼šåˆ›å»º
  `SqlSession`
  ï¼Œç®¡ç†æ•°æ®åº“è¿æ¥ã€‚
* ç¤ºä¾‹ä»£ç ï¼š

  ```java
  InputStream inputStream = Resources.getResourceAsStream("mybatis-config.xml");
  SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);

  ```

#### 2. SqlSession

* **ä½œç”¨**
  ï¼šæ‰§è¡Œ SQL è¯­å¥ï¼Œç®¡ç†äº‹åŠ¡ã€‚
* ç¤ºä¾‹ä»£ç ï¼š

  ```java
  try (SqlSession session = sqlSessionFactory.openSession()) {
      User user = session.selectOne("com.example.mapper.UserMapper.selectUser", 1);
  }

  ```

#### 3. Mapperï¼ˆæ˜ å°„å™¨ï¼‰

* **ä½œç”¨**
  ï¼šå®šä¹‰ SQL è¯­å¥çš„æ¥å£ï¼ŒMyBatis ä¼šåŠ¨æ€ç”Ÿæˆå®ç°ç±»ã€‚
* ç¤ºä¾‹ä»£ç ï¼š

  ```java
  public interface UserMapper {
      @Select("SELECT * FROM users WHERE id = #{id}")
      User selectUser(int id);
  }

  ```

---

### 4ï¸âƒ£ MyBatis é…ç½®æ–‡ä»¶ç»“æ„ ğŸ“‚

MyBatis ä½¿ç”¨ XML æˆ– Java ä»£ç è¿›è¡Œé…ç½®ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š

* `mybatis-config.xml`
  ï¼ˆæ ¸å¿ƒé…ç½®ï¼‰
* `mapper.xml`
  ï¼ˆSQL æ˜ å°„æ–‡ä»¶ï¼‰

#### ğŸ“Œ `mybatis-config.xml` ç¤ºä¾‹

```xml
<configuration>
    <environments default="development">
        <environment id="development">
            <transactionManager type="JDBC"/>
            <dataSource type="POOLED">
                <property name="driver" value="com.mysql.cj.jdbc.Driver"/>
                <property name="url" value="jdbc:mysql://localhost:3306/test"/>
                <property name="username" value="root"/>
                <property name="password" value="123456"/>
            </dataSource>
        </environment>
    </environments>
</configuration>

```

#### ğŸ“Œ `UserMapper.xml` ç¤ºä¾‹

```xml
<mapper namespace="com.example.mapper.UserMapper">
    <select id="selectUser" resultType="com.example.model.User">
        SELECT * FROM users WHERE id = #{id}
    </select>
</mapper>

```

---

### 5ï¸âƒ£ MyBatis çš„å…¸å‹ä½¿ç”¨æµç¨‹ ğŸ”„

1ï¸âƒ£
**åŠ è½½ MyBatis é…ç½®æ–‡ä»¶ï¼Œåˆ›å»º
`SqlSessionFactory`**

2ï¸âƒ£
**è·å–
`SqlSession`
ï¼Œæ‰§è¡Œ SQL è¯­å¥**

3ï¸âƒ£
**ä½¿ç”¨
`Mapper`
è¿›è¡Œæ•°æ®åº“æ“ä½œ**

4ï¸âƒ£
**æäº¤äº‹åŠ¡ï¼ˆ
`openSession(true)`
è‡ªåŠ¨æäº¤ï¼‰**

5ï¸âƒ£
**å…³é—­
`SqlSession`
ï¼Œé‡Šæ”¾èµ„æº**

---

### 6ï¸âƒ£ é€‚ç”¨åœºæ™¯ä¸æ€»ç»“ ğŸ¯

âœ…
**Mybatisé€‚ç”¨äºï¼š**

* éœ€è¦
  **æ‰‹å†™ SQL**
  ï¼Œä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½çš„é¡¹ç›®
* å¤æ‚æ•°æ®åº“ç»“æ„ï¼ŒORM æ¡†æ¶éš¾ä»¥æ»¡è¶³éœ€æ±‚çš„åœºæ™¯
* éœ€è¦
  **è½»é‡çº§æŒä¹…å±‚æ¡†æ¶**
  çš„åº”ç”¨

âŒ
**ä¸é€‚ç”¨äºï¼š**

* éœ€è¦å…¨è‡ªåŠ¨ ORMï¼Œé¿å…å†™ SQL çš„é¡¹ç›®ï¼ˆå¯ä»¥è€ƒè™‘ Hibernateï¼‰

ğŸ¯
**æ€»ç»“**
ï¼šMyBatis ç»“åˆäº† SQL çš„çµæ´»æ€§å’Œ ORM çš„ä¾¿åˆ©æ€§ï¼Œé€‚ç”¨äºå¤§å¤šæ•°
**ä¼ä¸šçº§åº”ç”¨**
ã€‚