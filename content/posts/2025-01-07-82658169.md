---
layout: post
title: "Cvs2017调用python"
date: 2025-01-07 15:17:51 +0800
description: "VS2017添加python本环境添加vc++项目：在VS2017中创建一个空的Windows控制台"
keywords: "vs2017 c++ 调用python"
categories: ['C']
tags: ['Vs', 'Python', 'C']
artid: "82658169"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=82658169
    alt: "Cvs2017调用python"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=82658169
featuredImagePreview: https://bing.ee123.net/img/rand?artid=82658169
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     C++（vs2017）调用python
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h2 style="margin-left:0cm;">
     <strong>
      <a name="_Toc515280970">
       VS2017
      </a>
      添加python
     </strong>
    </h2>
    <h3 style="margin-left:0cm;">
     <strong>
      <a name="_Toc515280971">
       本环境添加vc++项目：
      </a>
     </strong>
    </h3>
    <p style="margin-left:0cm;">
     <strong>
      <span style="color:#353630;">
       在
      </span>
     </strong>
     <strong>
      <span style="color:#353630;">
       VS2017
      </span>
     </strong>
     <strong>
      <span style="color:#353630;">
       中创建一个空的
      </span>
     </strong>
     <strong>
      <span style="color:#353630;">
       Windows
      </span>
     </strong>
     <strong>
      <span style="color:#353630;">
       控制台应用程序
      </span>
     </strong>
    </p>
    <p style="margin-left:0cm;">
     <img alt="" class="has" height="383" src="https://i-blog.csdnimg.cn/blog_migrate/38902a1aac365e7d2c65000f1cc8b8e1.png" width="554"/>
    </p>
    <p style="margin-left:0cm;">
     <strong>
      <span style="color:#353630;">
       在项目中右键弹出的对话框中选择属性
      </span>
     </strong>
    </p>
    <p style="margin-left:0cm;">
     <strong>
      <span style="color:#353630;">
       1
      </span>
     </strong>
     <strong>
      <span style="color:#353630;">
       ）修改
      </span>
     </strong>
     <strong>
      <span style="color:#353630;">
       C/C++
      </span>
     </strong>
     <strong>
      <span style="color:#353630;">
       下的常规
      </span>
     </strong>
    </p>
    <p style="margin-left:0cm;">
     <img alt="" class="has" height="373" src="https://i-blog.csdnimg.cn/blog_migrate/2d50597ba7b9079668539137e4649da1.png" width="554"/>
    </p>
    <p style="margin-left:0cm;">
     <strong>
      <span style="color:#353630;">
       2
      </span>
     </strong>
     <strong>
      <span style="color:#353630;">
       ）修改链接器下的常规
      </span>
     </strong>
    </p>
    <p style="margin-left:0cm;">
     <img alt="" class="has" height="373" src="https://i-blog.csdnimg.cn/blog_migrate/a9073450ae554a38bc9b58945b0abefb.png" width="554"/>
    </p>
    <p style="margin-left:0cm;">
     <strong>
      <span style="color:#353630;">
       3
      </span>
     </strong>
     <strong>
      <span style="color:#353630;">
       ）修改链接器下的输入添加
      </span>
     </strong>
     <strong>
      <span style="color:#353630;">
       python36.lib;
      </span>
     </strong>
     <strong>
      <span style="color:#353630;">
       （这个没有，是手动写的）
      </span>
     </strong>
     <span style="color:#353630;">
      Debug
     </span>
     <span style="color:#353630;">
      版本用的是
     </span>
     <span style="color:#353630;">
      pythonxx_d.lib
     </span>
    </p>
    <p style="margin-left:0cm;">
     <img alt="" class="has" height="373" src="https://i-blog.csdnimg.cn/blog_migrate/a1cacaa1c049ef16e1f8b76da1e91d61.png" width="554"/>
    </p>
    <h3 style="margin-left:0cm;">
     <strong>
      <a name="_Toc515280972">
       代码实例：
      </a>
     </strong>
    </h3>
    <pre class="has"><code class="language-cpp">#include "stdafx.h"
#include &lt;Python.h&gt;
int main()
{
    Py_Initialize();
    PyRun_SimpleString("print('Hello Python!')\n");
    Py_Finalize();
    return 0;
}</code></pre>
    <p style="margin-left:0cm;">
    </p>
    <h3 style="margin-left:0cm;">
     <strong>
      <a name="_Toc515280973">
       Python
      </a>
      解释器发布
     </strong>
    </h3>
    <ol>
     <li>
      <strong>
       <span style="color:#353630;">
        python36.dll
       </span>
      </strong>
      <br/>
      <span style="color:#353630;">
       放在
      </span>
      <span style="color:#353630;">
       exe
      </span>
      <span style="color:#353630;">
       同级目录
      </span>
     </li>
     <li>
      <strong>
       <span style="color:#353630;">
        dlls/pyd
       </span>
      </strong>
      <br/>
      <span style="color:#353630;">
       1)
      </span>
      <span style="color:#353630;">
       Python36\DLLs
      </span>
      <span style="color:#353630;">
       里的
      </span>
      <span style="color:#353630;">
       pyd
      </span>
      <span style="color:#353630;">
       拷贝到
      </span>
      <span style="color:#353630;">
       exe
      </span>
      <span style="color:#353630;">
       同级目录
      </span>
     </li>
    </ol>
    <p style="margin-left:20.25pt;">
     <span style="color:#353630;">
      2) pyd
     </span>
     <span style="color:#353630;">
      放入
     </span>
     <span style="color:#353630;">
      exe
     </span>
     <span style="color:#353630;">
      同级目录下的
     </span>
     <span style="color:#353630;">
      dlls
     </span>
     <span style="color:#353630;">
      下，并在
     </span>
     <span style="color:#353630;">
      cpp
     </span>
     <span style="color:#353630;">
      中添加如下语句：
     </span>
    </p>
    <pre class="has"><code class="language-cpp">PyRun_SimpleString("import sys");
PyRun_SimpleString("sys.path.append('dlls/')");</code></pre>
    <ol>
     <li>
      <strong>
       <span style="color:#353630;">
        python36.zip
       </span>
      </strong>
      <strong>
      </strong>
     </li>
    </ol>
    <ul>
     <li>
      <span style="color:#353630;">
       针对默认库将需要的
      </span>
      <span style="color:#353630;">
       Python36\Lib
      </span>
      <span style="color:#353630;">
       里的
      </span>
      <span style="color:#353630;">
       py/pyc
      </span>
      <span style="color:#353630;">
       和文件夹拷贝进去即可
      </span>
     </li>
    </ul>
    <p style="margin-left:0cm;">
     <img alt="" class="has" height="322" src="https://i-blog.csdnimg.cn/blog_migrate/75d67ac0666f8fd3e4aeddb1934ce372.png" width="553"/>
    </p>
    <ul>
     <li>
      <span style="color:#353630;">
       针对第三方库，将
      </span>
      <span style="color:#353630;">
       Python36-32\Lib\site-packages
      </span>
      <span style="color:#353630;">
       下的内容复制到
      </span>
      <span style="color:#353630;">
       zip
      </span>
      <span style="color:#353630;">
       里
      </span>
     </li>
    </ul>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f73696e61745f3431313936303839:2f61727469636c652f64657461696c732f3832363538313639" class_="artid" style="display:none">
 </p>
</div>


