---
layout: post
title: "springcloud-gateway搭建及动态获取nacos注册的服务信息信息"
date: 2025-03-12 01:34:29 +0800
description: "这里只是个简单的调用，主要目的是走通微服务调用的流程，后续会不断完善权限配置等。"
keywords: "springcloud gateway搭建及动态获取nacos注册的服务信息信息"
categories: ['Springcloud']
tags: ['Spring', 'Java', 'Gateway', 'Cloud']
artid: "146193638"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146193638
    alt: "springcloud-gateway搭建及动态获取nacos注册的服务信息信息"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146193638
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146193638
cover: https://bing.ee123.net/img/rand?artid=146193638
image: https://bing.ee123.net/img/rand?artid=146193638
img: https://bing.ee123.net/img/rand?artid=146193638
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     springcloud gateway搭建及动态获取nacos注册的服务信息信息
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h2>
     前言
    </h2>
    <p>
     <strong>
      Spring Cloud Gateway
     </strong>
     通过集成
     <strong>
      Nacos 服务发现
     </strong>
     ，可以动态获取注册到 Nacos 的微服务实例信息，并根据服务名（Service Name）自动生成路由规则或手动配置路由规则，实现请求的动态路由和负载均衡。
    </p>
    <p>
     一个最简单的网关就是实现所有微服务的代理即可，但是生产环境通常需要服务鉴权限制访问等，这里先简单示例一个没有鉴权，可以访问所有微服务接口的网关
    </p>
    <h2>
     创建项目
    </h2>
    <p>
     创建一个springboot项目
    </p>
    <p>
     <strong>
      注意
     </strong>
     ：避免引入
     <code>
      spring-boot-starter-web
     </code>
     ，因 Gateway 基于 WebFlux 非阻塞模型
    </p>
    <h2>
     添加依赖
    </h2>
    <pre><code>    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;3.0.13&lt;/version&gt;
        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;
    &lt;/parent&gt;





        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-gateway&lt;/artifactId&gt;
            &lt;version&gt;4.0.0&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt;
            &lt;version&gt;2022.0.0.0-RC2&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt;
            &lt;version&gt;2022.0.0.0-RC2&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-loadbalancer&lt;/artifactId&gt;
            &lt;version&gt;4.0.5&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-bootstrap&lt;/artifactId&gt;
            &lt;version&gt;4.0.5&lt;/version&gt;
        &lt;/dependency&gt;</code></pre>
    <h2>
     修改配置
    </h2>
    <pre>application.yml</pre>
    <pre><code>server:
  port: 8080

spring:
  application:
    name: api-gateway
  cloud:
    nacos:
      discovery:
        server-addr: 127.0.0.1:8848  # 服务注册地址
        namespace: local            # 命名空间（默认 public，我这里改为了local）
        group: DEFAULT_GROUP         # 分组
    gateway:
      discovery:
        locator:
          enabled: true              # 自动根据服务名生成路由（重要！）
          lower-case-service-id: true</code></pre>
    <h2>
     启动和调用
    </h2>
    <p>
     <img alt="" height="404" src="https://i-blog.csdnimg.cn/direct/18bbcc4cb9f6429f9f77a3de5f07a27d.png" width="1959"/>
    </p>
    <p>
     <img alt="" height="163" src="https://i-blog.csdnimg.cn/direct/4acaacd8677842a3a0857bb61c3cd869.png" width="540"/>
    </p>
    <p>
     成功访问到微服务的接口调用成功
    </p>
    <h2>
     手工配置路由
    </h2>
    <pre><code class="hljs">
spring:
  application:
    name: api-gateway

  cloud:
    nacos:
      discovery:
        server-addr: 127.0.0.1:8848  # ??????
        namespace: local            # ??????? public?
        group: DEFAULT_GROUP         # ??
    gateway:
      discovery:
        locator:
          enabled: true              # ????????????????
          lower-case-service-id: true
      routes:
        - id: hello_route  # 路由唯一标识
          uri: http://localhost:8081  # 目标服务地址
          predicates:
            - Path=/hello/**  # 路径匹配规则</code></pre>
    <h2>
     访问配置的路由
    </h2>
    <p>
     <img alt="" height="387" src="https://i-blog.csdnimg.cn/direct/6f47e7b5d3c74e2cb86e75b189e9f398.png" width="712"/>
    </p>
    <h2>
     总结
    </h2>
    <p>
     这里只是个简单的调用，主要目的是走通微服务调用的流程，后续会不断完善权限配置等
    </p>
   </div>
  </div>
 </article>
 <p alt="6874747073:3a2f2f626c6f672e6373646e2e6e65742f627870313332312f:61727469636c652f64657461696c732f313436313933363338" class_="artid" style="display:none">
 </p>
</div>


