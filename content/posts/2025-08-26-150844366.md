---
layout: post
title: "如何用Wireshark捕获当前房间路由器和主机的数据包"
date: 2025-08-26T10:35:27+0800
description: "如何用Wireshark捕获当前房间路由器和主机的数据包"
keywords: "通过路由器获取经过的数据包"
categories: ['Wlan', 'Wireshark']
tags: ['网络', 'Wlan', 'Wireshark', 'Tcp', 'Mac', '.XX']
artid: "150844366"
arturl: "https://blog.csdn.net/qq_48873240/article/details/150844366"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=150844366
    alt: "如何用Wireshark捕获当前房间路由器和主机的数据包"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=150844366
featuredImagePreview: https://bing.ee123.net/img/rand?artid=150844366
cover: https://bing.ee123.net/img/rand?artid=150844366
image: https://bing.ee123.net/img/rand?artid=150844366
img: https://bing.ee123.net/img/rand?artid=150844366
---



# 如何用Wireshark捕获当前房间路由器和主机的数据包



## 一、前期工作

在我的这篇文章中：

[Wireshark USRP联合波形捕获（上）-CSDN博客](https://blog.csdn.net/qq_48873240/article/details/150574162?spm=1001.2014.3001.5501 "Wireshark USRP联合波形捕获（上）-CSDN博客")

通过192.168.1.103这个主机ip筛选Wireshark捕获的数据包，认为Source和Direction中至少一个包含192.168.1.103才能代表路由器和主机之间的WiFi信号。

![](https://i-blog.csdnimg.cn/direct/28d89175ee4946d38d1fda7a2101371a.png)

在我的另一篇文章中：

[USRP B210在采集WiFi信号时的有效最大增益（隔壁/同一房间）-CSDN博客](https://blog.csdn.net/qq_48873240/article/details/150643326?spm=1001.2014.3001.5501 "USRP B210在采集WiFi信号时的有效最大增益（隔壁/同一房间）-CSDN博客")

捕获同一房间的WiFi信号（仅有一台路由器和一台笔记本电脑使用WiFi，捕获信号用的USRP接收天线、电脑和路由器三者紧挨着）

![](https://i-blog.csdnimg.cn/direct/003d5a512b11418cbafbceaee67391ce.png)

有没有可能，哪个数据包Source和Direction都不含192.168.1.103，但是也是路由器和主机发射的信号呢？

## 二、问题分析

如果筛选出路由器给目标主机发送的数据包，再筛选目标主机给路由器发送的数据包，这两种数据包之间会有很强的因果性。但是，引入了很多先验信息，就是我们知道哪个数据包是路由器发给目标主机的，也知道哪个数据包是目标主机发给路由器的。

无论是从任务场景出发，还是捕获的高强度信号出发，都应该仅筛选路由器、目标主机发送的数据包，不分Direction。

![](https://i-blog.csdnimg.cn/direct/205b68db13504ace9ce4a51309fc2532.png)

## 三、Source对应的物理存在

### 3.1 笔记本电脑ip

当前我的电脑ip是192.168.1.105：

![](https://i-blog.csdnimg.cn/direct/24fd193f9aa74509ae80f1c999b00542.png)

 主机是没有自己的APR项的：

![](https://i-blog.csdnimg.cn/direct/207554b57eb748158d8185e429c03418.png)

![](https://i-blog.csdnimg.cn/direct/2f0729b506fa4674b5302b243f9fc1e5.png)

### 3.2 路由器ip

![](https://i-blog.csdnimg.cn/direct/acb43eb0b7b64eeb84468d5c681ccd33.png)

我的路由器是中继模型，Wireshark捕获的数据包可能来自放在其他房间的上游路由器：

![](https://i-blog.csdnimg.cn/direct/2fdb54a3c83d469fabd79f100c4f6e90.png)

![](https://i-blog.csdnimg.cn/direct/94f71fd7393844e6bd7e51f6e07f0c40.png)

本来想直接从tplogin.cn查上级路由器的ip，但是密码忘了：

![](https://i-blog.csdnimg.cn/direct/b7894f282ffe4c1ab4094b000b106a1d.png)

好在可以通过ARP（Address Resolution Protocol）命令来查找MAC地址对应的IP地址：

![](https://i-blog.csdnimg.cn/direct/c2d4b63cc6294fa8a19bc03ee448df17.png)

### 3.3 上级路由器ip

是192.168.1.1：

![](https://i-blog.csdnimg.cn/direct/376509a2d7f44e3285dc32c57f3b163e.png)

抓取当下热乎的数据包：

![](https://i-blog.csdnimg.cn/direct/0bce710d7a4d4acfa63ec7cc82c84564.png)

TpLinkTechno_89:dd:46这个Source是上游路由器，和USRP不在一个房间。

### 3.4 国际ip

192.168.X.X是私有ip，除此之外，私有ip还包括：10.0.0.0，172.16.0.0

私有ip是查不到定位的：

![](https://i-blog.csdnimg.cn/direct/676401d92dc544aeb3bf800abc81f623.png)

153.121.64.153查ip查到日本了：

![](https://i-blog.csdnimg.cn/direct/34cbecf730c1441c90769739c404f3f1.png)

这才想起还在科学上网。

### 3.5 192.168.1.106/192.168.1.255

![](https://i-blog.csdnimg.cn/direct/d1c2e7e0b4cc4d9b908ccabcfc0c9663.png)

![](https://i-blog.csdnimg.cn/direct/fa992df4af434d81b5bcd6bb1e2d2577.png)

![](https://i-blog.csdnimg.cn/direct/20fed6b97ba54a7f98f17291ff5f2e8c.png)

![](https://i-blog.csdnimg.cn/direct/cf7ad73ad3b24615a718e230dcb7b196.png)

最后发现，这个192.168.1.106是路由器连接另一台电脑的ip：

![](https://i-blog.csdnimg.cn/direct/f30b9f90a6cf4c8bb29880a82ca7ee24.png)

![](https://i-blog.csdnimg.cn/direct/8006e770564341cf88f8464baa6827b1.png)

192.168.1.255则是局域网的一个广播ip：

### 

### 3.6 其他ip

153.3.238.127

![](https://i-blog.csdnimg.cn/direct/0428d42e69ef4425a1d4e41f96c494dc.png)

## 四、Source筛选

Source为192.168.1.105（笔记本电脑ip）的一定是我房间的信号源

Source为192.168.1.1的一定不是我房间的信号源

如果开了VPN，Source为153.121.64.153代表路由器正在发射信号。

经过上述分析，我能确定的是Source=192.168.105，Direction=192.168.105，Source=192.168.103的，信号源一定在我房间（不用关闭混杂模式，不然路由器发射的信号，但不是我笔记本电脑主机接收的那部分是捕获不到的）。如果USRP同时接收信号，一定能和Wireshark捕获的数据包匹配。



