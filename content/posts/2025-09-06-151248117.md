---
layout: post
title: "轻量级XML读写库Mini-XML的编译和使用"
date: 2025-09-06T09:36:53+0800
description: "本文介绍了使用mxml库处理XML文件的经历。作者尝试最新master分支代码时遇到兼容性问题，示例程序无法编译通过。研究发现mxml 4.0版本API变更导致不兼容，需降级至3.3.1版本才能成功编译运行示例代码。测试显示该版本能正确读取XML节点属性及内容，验证了基本XML解析功能。文中提供了编译命令和运行结果示例，并指出版本兼容性问题。"
keywords: "轻量级XML读写库Mini-XML的编译和使用"
categories: ['未分类']
tags: ['解析器', 'Xml', 'C']
artid: "151248117"
arturl: "https://blog.csdn.net/l1t/article/details/151248117"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=151248117
    alt: "轻量级XML读写库Mini-XML的编译和使用"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=151248117
featuredImagePreview: https://bing.ee123.net/img/rand?artid=151248117
cover: https://bing.ee123.net/img/rand?artid=151248117
image: https://bing.ee123.net/img/rand?artid=151248117
img: https://bing.ee123.net/img/rand?artid=151248117
---



# 轻量级XML读写库Mini-XML的编译和使用


[![](https://csdnimg.cn/release/blogv2/dist/pc/img/activeVector.png)
VibeCoding·九月创作之星挑战赛
10w+人浏览
336人参与

![](https://csdnimg.cn/release/blogv2/dist/pc/img/arrowright-line-White.png)](https://activity.csdn.net/writing?id=10954)

[github主页](https://github.com/michaelrsweet/mxml/), 作者还有一个[个人网站](https://www.msweet.org/mxml)，上面列举了各种他编的开源软件，像PDFIO之类。  
 安装很简单：  
 和Linux通常的开源软件编译方法一致，./configure和make就完事了。  
 我一开始下载的是master的最新代码，执行它自带的示例程序testmxml

```bash
./testmxml test.xml

```

好像就输出了test.xml的内容  
 用另一个我自己的xml来测试, 输出的是添加换行符的内容，  
 而必应智能总结给出的如下示例代码:

```bash
#include <mxml.h>
#include <stdio.h>

int write_xml() {
// 创建 XML 文件头
mxml_node_t *root = mxmlNewXML("1.0");

// 创建根节点
mxml_node_t *china = mxmlNewElement(root, "china");

// 添加子节点
mxml_node_t *city = mxmlNewElement(china, "city");
mxmlElementSetAttr(city, "capital", "Yes");
mxmlNewText(mxmlNewElement(city, "name"), 0, "北京");
mxmlNewText(mxmlNewElement(city, "area"), 0, "16410平方公里");
mxmlNewText(mxmlNewElement(city, "population"), 0, "2171万");
mxmlNewText(mxmlNewElement(city, "GDP"), 0, "24541亿");

// 保存到文件
FILE *fp = fopen("china.xml", "w");
mxmlSaveFile(root, fp, MXML_NO_CALLBACK);
fclose(fp);

// 释放内存
mxmlDelete(root);
return 0;
}

int read_xml() {
FILE *fp = fopen("china.xml", "r");
mxml_node_t *root = mxmlLoadFile(NULL, fp, MXML_NO_CALLBACK);

// 查找根节点
mxml_node_t *china = mxmlFindElement(root, root, "china", NULL, NULL, MXML_DESCEND);
mxml_node_t *city = mxmlFindElement(china, root, "city", NULL, NULL, MXML_DESCEND);

while (city) {
printf("是否首都: %s\n", mxmlElementGetAttr(city, "capital"));
mxml_node_t *node = mxmlWalkNext(city, root, MXML_DESCEND_FIRST);
printf("name: %s\n", mxmlGetText(node, NULL));
city = mxmlFindElement(city, root, "city", NULL, NULL, MXML_NO_DESCEND);
}

mxmlDelete(root);
fclose(fp);
return 0;
}

int main() {
	write_xml();
	read_xml();
}

```

编译都通不过。函数参数类型都变了，真是无语。

```bash
root@6ae32a5ffcde:/par# gcc testmxml.c -I /par/mxml-master libmxml4.a -o testmxml
testmxml.c: In function 'write_xml':
testmxml.c:21:24: error: 'MXML_NO_CALLBACK' undeclared (first use in this function)
   21 | mxmlSaveFile(root, fp, MXML_NO_CALLBACK);
      |                        ^~~~~~~~~~~~~~~~
testmxml.c:21:24: note: each undeclared identifier is reported only once for each function it appears in
testmxml.c:21:20: error: passing argument 2 of 'mxmlSaveFile' from incompatible pointer type [-Wincompatible-pointer-types]
   21 | mxmlSaveFile(root, fp, MXML_NO_CALLBACK);
      |                    ^~
      |                    |
      |                    FILE *
In file included from testmxml.c:1:
/par/mxml-master/mxml.h:219:73: note: expected 'mxml_options_t *' {aka 'struct _mxml_options_s *'} but argument is of type 'FILE *'
  219 | extern bool             mxmlSaveFile(mxml_node_t *node, mxml_options_t *options, FILE *fp);
      |                                                         ~~~~~~~~~~~~~~~~^~~~~~~

```

后来看发版说明：

> 版本4.0.0  
>  Mini-XML v4.0 添加了一些新功能，更新了回调 API 以包含数据指针，并且通常清理和规范化先前版本中的接口。虽然基本相似，但此版本与 Mini-XML v3.x 的源代码或二进制文件不兼容 - 迁移详细信息包含在文档中。

只好回去下载了3.3.1版，make后，这个示例就编译成功能执行了

编译和输出

```bash
gcc testmxml.c -I /par/mxml-3.3.1 /par/mxml-3.3.1/libmxml.a -o testmxml
./testmxml
是否首都: Yes
name: 北京

```



