---
arturl_encode: "68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f36303733353739362f:61727469636c652f64657461696c732f313238383433303935"
layout: post
title: "Java-WebJDBC-Javaæ“ä½œMySQLæ•°æ®åº“"
date: 2023-02-02 03:30:07 +08:00
description: "JDBC->è¶…ä¸€ä¸‡å­—æ–‡ç« å¸¦ä½ è¯¦ç»†äº†è§£Javaæ“ä½œMySQLæ•°æ®åº“çš„"
keywords: "javawebè¿æ¥æ•°æ®åº“mysqlè¿‡ç¨‹"
categories: ['Web', 'Mysql', 'Java']
tags: ['æ•°æ®åº“', 'Web', 'Mysql', 'Java']
artid: "128843095"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=128843095
    alt: "Java-WebJDBC-Javaæ“ä½œMySQLæ•°æ®åº“"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=128843095
featuredImagePreview: https://bing.ee123.net/img/rand?artid=128843095
---

# [Java Web]JDBC-ï¼Javaæ“ä½œMySQLæ•°æ®åº“

**ç›®å½•**

[1ã€ç®€ä»‹](#foOMd)

[1.1ã€èƒŒæ™¯](#zZclP)

[1.2ã€æ¦‚å¿µ](#pn5Vd)

[1.3ã€é©±åŠ¨ç¨‹åº](#pTMwS)

[2ã€JDBCçš„ä¼˜ç‚¹](#bwEiB)

[3ã€ä½¿ç”¨æ­¥éª¤](#j1NPn)

[3.1ã€æ“ä½œæµç¨‹](#NXVew)

[3.2ã€ä»£ç æ­¥éª¤](#ybidp)

[3.3ã€å®ä¾‹æ¼”ç¤º](#dMWgC)

[3.3.1ã€åˆ›å»ºç©ºå·¥ç¨‹](#Gd8Cd)

[3.3.2ã€æŒ‡å®šé¡¹ç›®çš„åç§°ä»¥åŠå­˜æ”¾è·¯å¾„](#ZLepJ)

[3.3.3ã€è®¾ç½®é¡¹ç›®çš„JDKç‰ˆæœ¬å’Œç¼–è¯‘ç‰ˆæœ¬](#HhAV1)

[3.3.4ã€åˆ›å»ºæ¨¡å—](#qqUj9)

[3.3.5ã€â­å¯¼å…¥MySQLé©±åŠ¨åŒ…](#CO47U)

[3.3.6ã€â­åˆ›å»ºJavaç±»](#L6WIu)

[4ã€APIè¯¦è§£](#vcVLp)

[4.1ã€DriverManager](#ZCwCi)

[4.1.1ã€æ³¨å†Œæ–¹å¼](#hW3RU)

[4.1.2ã€æºç åˆ†æ](#vlwhv)

[4.1.3ã€ğŸ”ºğŸ”ºMySQL5](#DJIMX)

[4.2ã€Connection](#kNh6M)

[4.2.1ã€DriverManager.getConnection](#Wuauh)

[4.2.2ã€connection.createStaterment()](#hFSYG)

[4.2.3ã€äº‹åŠ¡ç®¡ç†](#UJr10)

[4.3ã€â­Statement](#j38Ov)

[4.4ã€ResultSet](#lByRx)

[4.4.1ã€â­â­å†…éƒ¨æ–¹æ³•](#yMHxQ)

[5ã€æ•°æ®åº“è¿æ¥æ± ](#OsaK3)

[5.1ã€ç®€ä»‹](#OlwWn)

[5.2ã€è¿æ¥æ± çš„å®ç°](#qABGy)

[5.2.1ã€â­å¸¸è§çš„æ•°æ®åº“è¿æ¥æ± ](#sVN3x)

[5.3ã€ğŸ”ºDruidçš„ä½¿ç”¨->IDEA](#euAXN)

[5.3.1ã€å¯¼jaråŒ…](#L340x)

[5.3.2ã€å®šä¹‰é…ç½®æ–‡ä»¶](#Emzuu)

[5.3.3ã€ä½¿ç”¨Druid](#C9w8e)

---

## 

## 1ã€ç®€ä»‹

### 1.1ã€èƒŒæ™¯

å¼€å‘ä¸­ï¼ŒåŒä¸€å¥—Javaä»£ç æ˜¯æ— æ³•æ“ä½œä¸åŒçš„å…³ç³»å‹æ•°æ®åº“ï¼Œå› ä¸ºæ¯ä¸€ä¸ªå…³ç³»å‹æ•°æ®åº“çš„åº•å±‚å®ç°ç»†èŠ‚éƒ½ä¸ä¸€æ ·ã€‚å¦‚æœè¿™æ ·ï¼Œå‡å¦‚åœ¨ä¸šåŠ¡å¼€å‘é˜¶æ®µä½¿ç”¨çš„æ˜¯MySQLæ•°æ®åº“ï¼Œè€Œä¸Šçº¿æ—¶å…¬å¸æœ€ç»ˆé€‰ç”¨oracleæ•°æ®åº“ï¼Œåˆ™éœ€è¦å¯¹ä»£ç è¿›è¡Œå¤§æ‰¹é‡ä¿®æ”¹ï¼Œè¿™æ˜¾ç„¶è¡Œä¸é€šã€‚

å› æ­¤Javaå¼€å‘äººå‘˜æ›´å¸Œæœ›åšåˆ°çš„æ˜¯åŒä¸€å¥—Javaä»£ç æ“ä½œä¸åŒçš„å…³ç³»å‹æ•°æ®åº“ã€‚sunå…¬å¸å°±æŒ‡å®šäº†ä¸€å¥—æ ‡å‡†æ¥å£ï¼ˆJDBCï¼‰ï¼ŒJDBCä¸­å®šä¹‰äº†æ‰€æœ‰æ“ä½œå…³ç³»å‹æ•°æ®åº“çš„è§„åˆ™ã€‚

**æ¥å£æ˜¯æ— æ³•ç›´æ¥ä½¿ç”¨çš„ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨æ¥å£çš„å®ç°ç±»ï¼Œè€Œè¿™å¥—å®ç°ç±»ï¼ˆç§°ä¹‹ä¸ºï¼šé©±åŠ¨ï¼‰å°±ç”±å„è‡ªçš„æ•°æ®åº“å‚å•†ç»™å‡ºã€‚**

**ç®€å•æ¥è¯´ï¼šåœ¨å¼€å‘ä¸­æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯javaè¯­è¨€ï¼Œé‚£ä¹ˆåŠ¿å¿…è¦é€šè¿‡javaè¯­è¨€æ“ä½œæ•°æ®åº“ä¸­çš„æ•°æ®ï¼ŒåŠ¿å¿…è¦ç”¨Javaæ“ä½œä¸åŒçš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œæ‰€ä»¥éœ€è¦JDBCï¼**

### 1.2ã€æ¦‚å¿µ

JDBCï¼ˆJava Database Connectivityï¼‰æ˜¯Javaç¨‹åºç”¨äºè®¿é—®å…³ç³»æ•°æ®åº“çš„APIã€‚é€šè¿‡æ ‡å‡†çš„æ¥å£å’Œç±»æ¥ç®¡ç†æ•°æ®åº“è¿æ¥å’Œæ‰§è¡ŒSQLè¯­å¥ï¼Œå¯ä»¥ç”¨äºè¿æ¥ä¸åŒç±»å‹çš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆDBMSï¼‰ï¼Œå¦‚MySQLã€Oracleã€SQL Serverç­‰ã€‚è¿™ä½¿å¾—Javaç¨‹åºå‘˜å¯ä»¥å¿«é€Ÿã€æ–¹ä¾¿åœ°ä¸å„ç§å…³ç³»æ•°æ®åº“è¿›è¡Œäº¤äº’ã€‚

![](https://i-blog.csdnimg.cn/blog_migrate/75eeead60915c6cab4814a01e2b95cea.png)

### 1.3ã€é©±åŠ¨ç¨‹åº

JDBCé©±åŠ¨ç¨‹åºåˆ†ä¸ºå››ç§ç±»å‹ï¼š

1. JDBC-ODBCæ¡¥é©±åŠ¨
2. Native-APIé©±åŠ¨ï¼ˆéƒ¨åˆ†ï¼‰
3. Network-Protocolé©±åŠ¨ï¼ˆä¸‰å±‚é©±åŠ¨ï¼‰
4. Thiné©±åŠ¨ï¼ˆçº¯Javaé©±åŠ¨ï¼‰

é€šè¿‡ä½¿ç”¨JDBCé©±åŠ¨ç¨‹åºï¼ŒJavaç¨‹åºå‘˜å¯ä»¥æ–¹ä¾¿åœ°è®¿é—®å…³ç³»å‹æ•°æ®åº“ï¼Œè€Œä¸å¿…å…³å¿ƒæ•°æ®åº“çš„å…·ä½“å®ç°æ–¹å¼ã€‚

## 2ã€JDBCçš„ä¼˜ç‚¹

å„æ•°æ®åº“å‚å•†ä½¿ç”¨ç›¸åŒçš„æ¥å£ï¼ŒJavaä»£ç ä¸éœ€è¦é’ˆå¯¹ä¸åŒæ•°æ®åº“åˆ†åˆ«å¼€å‘ï¼Œå¯éšæ—¶æ›¿æ¢åº•å±‚æ•°æ®åº“ï¼Œè®¿é—®æ•°æ®åº“çš„Javaä»£ç åŸºæœ¬ä¸å˜ ã€‚

ä»¥åç¼–å†™æ“ä½œæ•°æ®åº“çš„ä»£ç åªéœ€è¦é¢å‘JDBCï¼ˆæ¥å£ï¼‰ï¼Œæ“ä½œå“ªä¸ªå…³ç³»å‹æ•°æ®åº“å°±éœ€è¦å¯¼å…¥è¯¥æ•°æ®åº“çš„é©±åŠ¨åŒ…ï¼Œå¦‚éœ€è¦æ“ä½œMySQLæ•°æ®åº“ï¼Œå°±éœ€è¦åœ¨é¡¹ç›®ä¸­å¯¼å…¥MySQLæ•°æ®åº“çš„é©±åŠ¨åŒ…ã€‚

## 3ã€ä½¿ç”¨æ­¥éª¤

### 3.1ã€æ“ä½œæµç¨‹

â‘ ç¼–å†™Javaä»£ç 

â‘¡Javaä»£ç å°†SQLå‘é€åˆ°MySQLæœåŠ¡ç«¯

â‘¢MySQLæœåŠ¡ç«¯æ¥æ”¶åˆ°SQLè¯­å¥å¹¶æ‰§è¡Œè¯¥SQLè¯­å¥

â‘£å°†SQLè¯­å¥æ‰§è¡Œçš„ç»“æœè¿”å›ç»™Javaä»£ç 

![](https://i-blog.csdnimg.cn/blog_migrate/31c6b577368ded6f5409fd4bcef66876.png)

### 3.2ã€ä»£ç æ­¥éª¤

â‘ åˆ›å»ºå·¥ç¨‹ï¼Œå¯¼å…¥é©±åŠ¨jaråŒ…

â‘¡æ³¨å†Œé©±åŠ¨->Class.forName("com.mysql.jdbc.Driver");

â‘¢è·å–è¿æ¥->Connection connection = DriverManager.getConnection(url, username, password);

Javaä»£ç éœ€è¦å‘é€SQLç»™MySQLæœåŠ¡ç«¯ï¼Œå°±éœ€è¦å…ˆå»ºç«‹è¿æ¥

(å¦‚æœæ˜¯è¿æ¥æœ¬åœ°rootæ•°æ®åº“ï¼Œè¦è®°å¾—å¼€å¯æœ¬åœ°çš„MySQLæœåŠ¡)

(åœ¨åé¢çš„æŠ€æœ¯ä¸­ï¼Œä¸»è¦ä½¿ç”¨çš„æ˜¯
*è¿æ¥æ± *
çš„æ–¹å¼è·å–Connectionè¿æ¥)

â‘£å®šä¹‰SQLè¯­å¥->String sql = "updateâ€¦" ;

â‘¤è·å–æ‰§è¡ŒSQLå¯¹è±¡(æ‰§è¡ŒSQLè¯­å¥éœ€è¦SQLæ‰§è¡Œå¯¹è±¡ï¼Œè€Œè¿™ä¸ªæ‰§è¡Œå¯¹è±¡å°±æ˜¯Statementå¯¹è±¡) ->

->Statement statement = connection.createStatement();

â‘¥æ‰§è¡ŒSQL->statement.executeUpdate(sql);

ResultSet resultSet = statement.executeQuery(sql);

â‘¦å¤„ç†è¿”å›ç»“æœ while (resultSet.next()) {...}

â‘§é‡Šæ”¾èµ„æºconnection.close();

### 3.3ã€å®ä¾‹æ¼”ç¤º

#### 3.3.1ã€åˆ›å»ºç©ºå·¥ç¨‹

![](https://i-blog.csdnimg.cn/blog_migrate/8c8245b0535a8f5f678c33869109d149.png)

#### 3.3.2ã€æŒ‡å®šé¡¹ç›®çš„åç§°ä»¥åŠå­˜æ”¾è·¯å¾„

![](https://i-blog.csdnimg.cn/blog_migrate/4fedc5b3cf663f3d0af021d444668542.png)

#### 3.3.3ã€è®¾ç½®é¡¹ç›®çš„JDKç‰ˆæœ¬å’Œç¼–è¯‘ç‰ˆæœ¬

![](https://i-blog.csdnimg.cn/blog_migrate/786fd89f12c59a191146c4ba7042fda0.png)

ç¼–è¯‘ç‰ˆæœ¬ä¸€èˆ¬é»˜è®¤å³å¯

#### 3.3.4ã€åˆ›å»ºæ¨¡å—

![](https://i-blog.csdnimg.cn/blog_migrate/1ce8bf8dc95c64656e7403b12720b4b7.png)

#### 3.3.5ã€â­å¯¼å…¥MySQLé©±åŠ¨åŒ…

å°†mysqlçš„é©±åŠ¨åŒ…æ”¾åœ¨æ¨¡å—ä¸‹çš„libç›®å½•(éšæ„å‘½åï¼Œä½†æ˜¯ä¸€èˆ¬å‘½åä¸ºlibæˆ–library)ä¸‹ï¼Œ

å¹¶å°†è¯¥jaråŒ…æ·»åŠ ä¸ºåº“æ–‡ä»¶

![](https://i-blog.csdnimg.cn/blog_migrate/17ae0ff2010af2e183c464754fed332d.png)

![](https://i-blog.csdnimg.cn/blog_migrate/5a5665e9899490c15f39e1e7363ca1e1.png)

æ·»åŠ åˆ°é¡¹ç›®ä¾èµ–ä¸­ï¼ŒMySQLé©±åŠ¨jaråŒ…æ‰èƒ½ä½¿ç”¨ã€‚

3.3.5.1ã€åˆ¤æ–­

å¦‚ä½•åˆ¤æ–­æ·»åŠ æ˜¯å¦æˆåŠŸï¼š

â‘ æœªæ·»åŠ ï¼š

![](https://i-blog.csdnimg.cn/blog_migrate/8a6852e936e22ba8abc401cb78f44b7b.png)

â‘¡å·²æ·»åŠ æˆåŠŸ

![](https://i-blog.csdnimg.cn/blog_migrate/19ee567b1f94ea5a7443c771c84573d6.png)

***æ·»åŠ ä¾èµ–æˆåŠŸåï¼ŒjaråŒ…å¯ä»¥ä¸‹æ‹‰çœ‹è§å…¶ä¸­çš„å„ç§ä»£ç ***

#### 3.3.6ã€â­åˆ›å»ºJavaç±»

url ï¼š è¿æ¥è·¯å¾„

è¯­æ³•ï¼šjdbc:mysql://ipåœ°å€(åŸŸå):ç«¯å£å·/æ•°æ®åº“åç§°?å‚æ•°é”®å€¼å¯¹1&å‚æ•°é”®å€¼å¯¹2â€¦

ç¤ºä¾‹ï¼šjdbc:mysql://127.0.0.1:3306/db1

å¦‚æœè¿æ¥çš„æ˜¯æœ¬æœºmysqlæœåŠ¡å™¨ï¼Œå¹¶ä¸”mysqlæœåŠ¡é»˜è®¤ç«¯å£æ˜¯3306ï¼Œåˆ™urlå¯ä»¥ç®€å†™ä¸ºï¼šjdbc:mysql:///æ•°æ®åº“åç§°?å‚æ•°é”®å€¼å¯¹

```java
package com.xzl;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.Statement;

public class jdbc {
    public static void main(String[] args) throws Exception {
        //1ã€æ³¨å†Œé©±åŠ¨
        Class.forName("com.mysql.jdbc.Driver");
        //2ã€è·å–è¿æ¥
        String url = "jdbc:mysql://127.0.0.1:3306/student";
        String username = "root";
        String password_P = "";
        Connection connection = DriverManager.getConnection(url,username,password);
        //3ã€å®šä¹‰sql
        String sql = "insert into stu(name,math,gender) values('å¼ ä¸‰',85,'ç”·')";
        //4. è·å–æ‰§è¡Œsqlçš„å¯¹è±¡Statement
        Statement statement = connection.createStatement();
        //5ã€æ‰§è¡ŒSQL
        int count = statement.executeUpdate(sql);
        //6ã€å¤„ç†ç»“æœï¼ˆæ­¤å¤„demoå±•ç°å—å½±å“çš„å‡½æ•°ï¼‰
        System.out.println(count);
        //7ã€é‡Šæ”¾èµ„æº
        statement.close();
        connection.close();
    }
}
```

ç»“æœï¼š

åœ¨æ‰§è¡ŒJavaä»£ç å‰ï¼š

![](https://i-blog.csdnimg.cn/blog_migrate/2137c282647bc0ac5a55f896c45bc6a9.png)

æ‰§è¡ŒJavaä»£ç åï¼š

![](https://i-blog.csdnimg.cn/blog_migrate/216634f6feb2176c81a54ecd02c21084.png)

![](https://i-blog.csdnimg.cn/blog_migrate/cc056870d098dd89fd82580557a7a4a3.png)

## 4ã€APIè¯¦è§£

### 4.1ã€DriverManager

JDBCæ­¥éª¤äºŒï¼šæ³¨å†Œé©±åŠ¨->DriverManager

#### 4.1.1ã€æ³¨å†Œæ–¹å¼

æ³¨å†Œé©±åŠ¨çš„ä¸¤ç§æ–¹å¼ï¼š

â‘ é™æ€æ³¨å†Œï¼šClass.forName("com.mysql.jdbc.Driver");

â‘¡åŠ¨æ€æ³¨å†Œï¼šDriverManager.registerDriver(new Driver());

å®é™…æ³¨å†Œæ–¹å¼ä¸ºæ–¹å¼äºŒï¼Œä½†å®é™…ä»£ç ç¼–å†™ä¸ºæ–¹å¼ä¸€ã€‚

ç†ç”±ï¼š

ä¸¤ç§æ³¨å†Œæ–¹å¼éƒ½å¯ä»¥ï¼Œä½†æ˜¯é™æ€æ³¨å†Œæ–¹å¼æ›´ç¨³å®šï¼Œå› ä¸ºå®ƒåœ¨ç¨‹åºå¯åŠ¨å‰å°±æ³¨å†Œäº†é©±åŠ¨ï¼Œæ²¡æœ‰å› ä¸ºç½‘ç»œé—®é¢˜ç­‰å¯¼è‡´æ— æ³•åŠ è½½é©±åŠ¨çš„é£é™©ï¼Œæ‰€ä»¥æ¨èä½¿ç”¨é™æ€æ³¨å†Œæ–¹æ³•ã€‚

#### 4.1.2ã€æºç åˆ†æ

DriverManager.registerDriver(new Driver());

--->

![](https://i-blog.csdnimg.cn/blog_migrate/2190aecb2ef1fe8d054dc369c4128764.png)

Class.forName("com.mysql.jdbc.Driver");

--->

![](https://i-blog.csdnimg.cn/blog_migrate/eda5c4864f464474cc2aca0d24a3fc67.png)

å¯ä»¥çœ‹å‡ºï¼Œé™æ€æ³¨å†Œæ–¹å¼é‡‡ç”¨çš„æ˜¯åå°„æœºåˆ¶ï¼Œè·å–äº†MySQLé©±åŠ¨åŒ…ä¸­çš„Driverå¯¹è±¡

é‡æ¸©åå°„çŸ¥è¯†ï¼š

![](https://i-blog.csdnimg.cn/blog_migrate/4ae4ac3c82713381b22e334f6a7a2e13.png)

æŸ¥çœ‹com.mysql.jdbc.Driveræºç ï¼Œå¯ä»¥çœ‹åˆ°åœ¨Driverä¸­é™æ€åŠ è½½äº†DriverManager.registerDriver(new Driver());ï¼Œæ‰€ä»¥ä¸¤ç§æ³¨å†Œæ–¹å¼åœ¨æºç ä¸Šæœ¬è´¨å¹¶æ— åŒºåˆ«ã€‚åªæ˜¯é™æ€æ³¨å†Œæ›´å®‰å…¨æ›´ç¨³å›ºï¼Œä¸”åªä¼šéšç€ç±»åŠ è½½ä¸€æ¬¡ï¼Œä¸ä¼šå‡ºç°é‡å¤æ³¨å†Œæˆ–è€…å› ç½‘ç»œé—®é¢˜è¿›è€Œå‡ºç°æ³¨å†Œé—®é¢˜çš„æƒ…å†µå‡ºç°ã€‚

![](https://i-blog.csdnimg.cn/blog_migrate/cf7fd44ebcbbf49d36abdb9a057e800c.png)

#### 4.1.3ã€ğŸ”ºğŸ”ºMySQL5

MySQL 5ä¹‹åçš„é©±åŠ¨åŒ…ï¼Œå¯ä»¥çœç•¥æ³¨å†Œé©±åŠ¨çš„æ­¥éª¤ï¼Œ

è‡ªåŠ¨åŠ è½½jaråŒ…ä¸­META-INF/services/java.sql.Driveræ–‡ä»¶ä¸­çš„é©±åŠ¨ç±»

### 4.2ã€Connection

Connectionï¼ˆæ•°æ®åº“è¿æ¥å¯¹è±¡ï¼‰ä½œç”¨ï¼š

è·å–æ‰§è¡Œ SQL çš„å¯¹è±¡

ç®¡ç†äº‹åŠ¡

#### 4.2.1ã€DriverManager.getConnection

JDBCæ­¥éª¤ä¸‰ï¼šè·å–è¿æ¥->Connection connection = DriverManager.getConnection(url, username, password);

å‚æ•°è¯´æ˜ï¼š

â‘ url ï¼š è¿æ¥è·¯å¾„

è¯­æ³•ï¼šjdbc:mysql://ipåœ°å€(åŸŸå):ç«¯å£å·/æ•°æ®åº“åç§°[?å‚æ•°é”®å€¼å¯¹1&å‚æ•°é”®å€¼å¯¹2â€¦ ]

ç¤ºä¾‹ï¼šjdbc:mysql://127.0.0.1:3306/student

â‘¡user ï¼šç”¨æˆ·å

â‘¢poassword ï¼šå¯†ç 

4.2.2.1ã€â­æ³¨æ„äº‹é¡¹ï¼šuseSSL

å¦‚æœè¿æ¥çš„æ˜¯æœ¬æœºmysqlæœåŠ¡å™¨ï¼Œå¹¶ä¸”mysqlæœåŠ¡é»˜è®¤ç«¯å£æ˜¯3306ï¼Œ

åˆ™urlå¯ä»¥ç®€å†™ä¸ºï¼šjdbc:mysql:///æ•°æ®åº“åç§°?å‚æ•°é”®å€¼å¯¹

é…ç½® useSSL=false å‚æ•°ï¼Œç¦ç”¨å®‰å…¨è¿æ¥æ–¹å¼ï¼Œè§£å†³è­¦å‘Šæç¤º

Exï¼š jdbc:mysql://127.0.0.1:3306/student?useSSL=false

falseå‰ï¼š

![](https://i-blog.csdnimg.cn/blog_migrate/263aa4717889a49bb887fe9dade2287e.png)

falseåï¼š

![](https://i-blog.csdnimg.cn/blog_migrate/4aba721da8bf6ed7d50dace2c21afcc7.png)

è­¦å‘Šå†…å®¹ä¸ºï¼š

Tue Jan 31 20:57:02 CST 2023 WARN: Establishing SSL connection without server's identity verification is not recommended. According to MySQL 5.5.45+, 5.6.26+ and 5.7.6+ requirements SSL connection must be established by default if explicit option isn't set. For compliance with existing applications not using SSL the verifyServerCertificate property is set to 'false'. You need either to explicitly disable SSL by setting useSSL=false, or set useSSL=true and provide truststore for server certificate verification.

ç®€å•æ¥è¯´å°±æ˜¯ï¼š

ä¸å»ºè®®åœ¨æ²¡æœ‰æœåŠ¡å™¨èº«ä»½éªŒè¯çš„æƒ…å†µä¸‹å»ºç«‹ SSL è¿æ¥ã€‚

éœ€è¦è®¾ç½® useSSL=false æ¥æ˜¾å¼ç¦ç”¨ SSLï¼Œæˆ–è®¾ç½® useSSL=true å¹¶ä¸ºæœåŠ¡å™¨è¯ä¹¦éªŒè¯æä¾›ä¿¡ä»»åº“ã€‚

#### 4.2.2ã€connection.createStaterment()

JDBCæ­¥éª¤äº”ï¼šè·å–æ‰§è¡ŒSQLå¯¹è±¡->Statement statement = connection.createStatement();

ä¸‰ç§è·å–æ–¹å¼ï¼š

â‘ æ™®é€šæ‰§è¡ŒSQLå¯¹è±¡ï¼šStatement createStatement()

**â‘¡é¢„ç¼–è¯‘SQLçš„æ‰§è¡ŒSQLå¯¹è±¡ï¼šPreparedStatement prepareStatement(sql)->é˜²æ­¢SQLæ³¨å…¥**

â‘¢æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹çš„å¯¹è±¡ï¼šCallableStatement prepareCall(sql)

é€šè¿‡æ–¹å¼â‘¢è·å–çš„ CallableStatement æ‰§è¡Œå¯¹è±¡æ˜¯ç”¨æ¥æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹çš„ï¼Œè€Œå­˜å‚¨è¿‡ç¨‹åœ¨MySQLä¸­ä¸å¸¸ç”¨

4.2.2.1ã€ ğŸ”ºğŸ”ºPreparedStatement

PreparedStatementä½œç”¨ï¼š é¢„ç¼–è¯‘SQLè¯­å¥å¹¶æ‰§è¡Œï¼šé¢„é˜²SQLæ³¨å…¥é—®é¢˜

sqlè¯­å¥ä¸­å‚æ•°ä½¿ç”¨"?"è¿›è¡Œå ä½ï¼Œåœ¨æ‰§è¡ŒSQLä¹‹å‰è¦è®¾ç½®è¿™äº›"?"çš„å€¼ã€‚

PreparedStatementå¯¹è±¡æ–¹æ³•ï¼šsetXxx(å‚æ•°1ï¼Œå‚æ•°2)->ç»™SQLä¸­çš„"?"èµ‹å€¼

Xxxï¼šæ•°æ®ç±»å‹ ï¼› å¦‚ setInt (å‚æ•°1ï¼Œå‚æ•°2)

å‚æ•°ï¼š

å‚æ•°1ï¼š ï¼Ÿçš„ä½ç½®ç¼–å·ï¼Œä»1 å¼€å§‹

å‚æ•°2ï¼š ï¼Ÿçš„å€¼

æ³¨æ„ï¼š

è°ƒç”¨æ‰§è¡ŒSQLè¯­å¥çš„æ–¹æ³•æ—¶ä¸éœ€è¦ä¼ é€’SQLè¯­å¥ï¼Œ

å› ä¸ºè·å–SQLè¯­å¥æ‰§è¡Œå¯¹è±¡æ—¶å·²ç»å¯¹SQLè¯­å¥è¿›è¡Œé¢„ç¼–è¯‘äº†ã€‚

ä»£ç æ”¹è¿›å¦‚ä¸‹ï¼š

æ”¹å‰ï¼š

```java
package com.xzl;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.Statement;

public class jdbc {
    public static void main(String[] args) throws Exception {
        //1ã€æ³¨å†Œé©±åŠ¨
        Class.forName("com.mysql.jdbc.Driver");
        //2ã€è·å–è¿æ¥
        String url = "jdbc:mysql://127.0.0.1:3306/student?useSSL=false";
        String username = "root";
        String password_P = "xzlXZGK680";
        Connection connection = DriverManager.getConnection(url,username,password);

        String sql = "update stu set gender='å¥³' where name='æå››' and gender='ç”·'";
        //4. è·å–æ‰§è¡Œsqlçš„å¯¹è±¡Statement
        Statement statement = connection.createStatement();
        //æ­¤æ—¶éœ€è¦å¼€å¯äº‹åŠ¡ä¹‹åå†æ‰§è¡Œ
        try {
            //ç¦ç”¨è‡ªåŠ¨æäº¤æ¨¡å¼ï¼šfalse
            connection.setAutoCommit(false);
            //5ã€æ‰§è¡ŒSQL->æ­¤å¤„éœ€è¦å¼€å¯äº‹åŠ¡ä¹‹åå†æ‰§è¡Œ
            int count = statement.executeUpdate(sql);
            System.out.println(count);

            //6ã€å¤„ç†ç»“æœ
            // ============æäº¤äº‹åŠ¡==========
            //ç¨‹åºè¿è¡Œåˆ°æ­¤å¤„ï¼Œè¯´æ˜æ²¡æœ‰å‡ºç°ä»»ä½•é—®é¢˜ï¼Œåˆ™éœ€æäº¤äº‹åŠ¡
            connection.commit();
        }catch (Exception e){
            //äº‹åŠ¡ç¨‹åºå‡ºé”™ï¼Œå›æ»šäº‹åŠ¡
            connection.rollback();
            e.printStackTrace();
        }finally {
            //7ã€é‡Šæ”¾èµ„æº
            statement.close();
            connection.close();
        }
    }
}
```

æ”¹åï¼š

```java
package com.xzl;

import java.sql.*;

public class jdbc {
    public static void main(String[] args) throws Exception {
        //1ã€æ³¨å†Œé©±åŠ¨
        Class.forName("com.mysql.jdbc.Driver");
        //2ã€è·å–è¿æ¥
        String url = "jdbc:mysql://127.0.0.1:3306/student?useSSL=false";
        String username = "root";
        String password_P = "xzlXZGK680";
        Connection connection = DriverManager.getConnection(url,username,password);
        //3ã€å®šä¹‰sql
        String sql = "update stu set gender='å¥³' where name=? and gender=?";
        //4ã€è·å–é¢„ç¼–è¯‘SQLçš„æ‰§è¡ŒSQLå¯¹è±¡ï¼šPreparedStatement
        PreparedStatement preparedStatement = connection.prepareStatement(sql);
        //è®¾ç½®å‚æ•°å€¼
        preparedStatement.setString(1,"æå››");
        preparedStatement.setString(2,"ç”·");
        //æ­¤æ—¶éœ€è¦å¼€å¯äº‹åŠ¡ä¹‹åå†æ‰§è¡Œ
        try {
            //ç¦ç”¨è‡ªåŠ¨æäº¤æ¨¡å¼ï¼šfalse
            connection.setAutoCommit(false);
            //5ã€æ‰§è¡ŒSQL->æ­¤å¤„éœ€è¦å¼€å¯äº‹åŠ¡ä¹‹åå†æ‰§è¡Œ
            int count = preparedStatement.executeUpdate();
            System.out.println(count);

            //6ã€å¤„ç†ç»“æœ
            // ============æäº¤äº‹åŠ¡==========
             //ç¨‹åºè¿è¡Œåˆ°æ­¤å¤„ï¼Œè¯´æ˜æ²¡æœ‰å‡ºç°ä»»ä½•é—®é¢˜ï¼Œåˆ™éœ€æäº¤äº‹åŠ¡
            connection.commit();
        }catch (Exception e){
            //äº‹åŠ¡ç¨‹åºå‡ºé”™ï¼Œå›æ»šäº‹åŠ¡
            connection.rollback();
            e.printStackTrace();
        }finally {
            //7ã€é‡Šæ”¾èµ„æº
            preparedStatement.close();
            connection.close();
        }
    }
}
```

#### 4.2.3ã€äº‹åŠ¡ç®¡ç†

4.2.3.1ã€MySQLäº‹åŠ¡ç®¡ç†

å›é¡¾MySQLäº‹åŠ¡ç®¡ç†çš„æ“ä½œï¼š

â‘ å¼€å¯äº‹åŠ¡ ï¼š BEGIN; æˆ–è€… START TRANSACTION;

â‘¡æäº¤äº‹åŠ¡ ï¼š COMMIT;

â‘¢å›æ»šäº‹åŠ¡ ï¼š ROLLBACK;

***MySQLé»˜è®¤æ˜¯è‡ªåŠ¨æäº¤äº‹åŠ¡***

4.2.3.2ã€â­JDBCäº‹åŠ¡ç®¡ç†ä¿¡æ¯

JDBCäº‹åŠ¡ç®¡ç†çš„æ–¹æ³•ï¼šConnectionæ¥å£ä¸­å®šä¹‰äº†3ä¸ªå¯¹åº”çš„æ–¹æ³•ï¼š

|  |  |  |
| --- | --- | --- |
|  | æ–¹æ³• | è¯´æ˜ |
| å¼€å¯äº‹åŠ¡ | void setAutoCommit (boolean autoCommit) | å°†æ¬¡è¿æ¥çš„è‡ªåŠ¨æäº¤æ¨¡å¼è®¾ç½®ä¸ºç»™å®šçŠ¶æ€ |
| æäº¤äº‹åŠ¡ | void commit() | ä½¿è‡ªä¸Šæ¬¡æäº¤/å›æ»šä»¥æ¥æ‰€åšçš„æ‰€æœ‰æ›´æ”¹æˆä¸ºæ°¸ä¹…æ›´æ”¹ï¼Œå¹¶é‡Šæ”¾æ­¤Connectionå¯¹è±¡å½“å‰ç‰¹æœ‰çš„æ‰€æœ‰æ•°æ®åº“é” |
| å›æ»šäº‹åŠ¡ | void rollback() | æ’¤é”€å½“å‰äº‹åŠ¡ä¸­æ‰€åšçš„æ‰€æœ‰æ›´æ”¹ï¼Œå¹¶é‡Šæ”¾æ­¤Connectionå¯¹è±¡å½“å‰ç‰¹æœ‰çš„æ‰€æœ‰æ•°æ®åº“é” |

ä»£ç å¦‚ä¸‹ï¼š

![](https://i-blog.csdnimg.cn/blog_migrate/98ce15997744fcdfafd7fabb87df4182.png)

### 4.3ã€â­Statement

Statementå¯¹è±¡çš„ä½œç”¨å°±æ˜¯ç”¨æ¥æ‰§è¡ŒSQLè¯­å¥ã€‚è€Œé’ˆå¯¹ä¸åŒç±»å‹çš„SQLè¯­å¥ä½¿ç”¨çš„æ–¹æ³•ä¹Ÿä¸ä¸€æ ·ã€‚

(excuteæ‰§è¡Œ quaryæŸ¥è¯¢)

|  |  |  |
| --- | --- | --- |
|  | æ–¹æ³• | è¯´æ˜ |
| æ‰§è¡ŒDDLã€DMLè¯­å¥ | int executeUpdate(String sql) | æ‰§è¡Œç»™å®šçš„SQLè¯­å¥ï¼Œè¿™å¯èƒ½æ˜¯INSERTï¼Œ UPDATEï¼Œæˆ– DELETEè¯­å¥ï¼Œæˆ–è€…ä¸è¿”å›ä»»ä½•å†…å®¹ï¼Œå¦‚SQLä¸­çš„DDLè¯­å¥ |
| æ‰§è¡ŒDQLè¯­å¥ | ResultSet excuteQuery(String sql) | æ‰§è¡Œç»™å®šçš„SQLè¯­å¥ï¼Œè¯¥è¯­å¥è¿”å›å•ä¸ª Resultsetå¯¹è±¡ã€‚ |

åœ¨å¼€å‘ä¸­å¾ˆå°‘ä½¿ç”¨javaä»£ç æ“ä½œDDLè¯­å¥ï¼ŒåŸå› å¦‚ä¸‹ï¼š

1. æ•°æ®åº“ç»“æ„å®šä¹‰é€šå¸¸ç”±æ•°æ®åº“ç®¡ç†å‘˜è´Ÿè´£ï¼Œè€Œä¸æ˜¯å¼€å‘äººå‘˜ã€‚
2. Javaä»£ç ä¸æ˜¯æ“ä½œDDLè¯­å¥æœ€æ–¹ä¾¿çš„æ–¹å¼ï¼Œä½¿ç”¨æ•°æ®åº“ç®¡ç†å·¥å…·(å¦‚MySQL Workbench)é€šå¸¸æ›´æ–¹ä¾¿ã€‚
3. DDLè¯­å¥å¾ˆå°‘éœ€è¦åœ¨è¿è¡Œæ—¶è¿›è¡Œæ›´æ”¹ï¼Œå› æ­¤ä¸å¤ªéœ€è¦é€šè¿‡Javaä»£ç æ¥æ“ä½œã€‚
4. Javaä»£ç ä¸»è¦ç”¨äºæŸ¥è¯¢å’Œæ›´æ–°æ•°æ®ï¼Œè€Œä¸æ˜¯å®šä¹‰æ•°æ®ç»“æ„ã€‚

### 4.4ã€ResultSet

JDBCæ­¥éª¤å…­ï¼šæ‰§è¡ŒSQLï¼š

æ–¹å¼ä¸€ï¼š->int executeUpdate(String sql)

**æ–¹å¼äºŒï¼š->ResultSet excuteQuery(String sql)**

ResultSetï¼ˆç»“æœé›†å¯¹è±¡ï¼‰ä½œç”¨ï¼š å°è£…äº†SQLæŸ¥è¯¢è¯­å¥çš„ç»“æœï¼Œæ‰§è¡Œäº†DQLè¯­å¥åå°±ä¼šè¿”å›è¯¥å¯¹è±¡

#### 4.4.1ã€â­â­å†…éƒ¨æ–¹æ³•

ResultSet å¯¹è±¡æä¾›äº†æ“ä½œæŸ¥è¯¢ç»“æœæ•°æ®çš„æ–¹æ³•ï¼š

â‘ boolean next()

â‘¡xxx getXxx(å‚æ•°)ï¼šè·å–æ•°æ®

4.4.1.1ã€boolean next()

ä½œç”¨ï¼šå°†å…‰æ ‡ä»å½“å‰ä½ç½®å‘å‰ç§»åŠ¨ä¸€è¡Œï¼Œåˆ¤æ–­å½“å‰è¡Œæ˜¯å¦ä¸ºæœ‰æ•ˆè¡Œ

æ–¹æ³•è¿”å›å€¼è¯´æ˜ï¼š

true ï¼š æœ‰æ•ˆè¡Œï¼Œå½“å‰è¡Œæœ‰æ•°æ®

false ï¼š æ— æ•ˆè¡Œï¼Œå½“å‰è¡Œæ²¡æœ‰æ•°æ®

**ä¸€å¼€å§‹å…‰æ ‡æŒ‡å®šäºç¬¬ä¸€è¡Œå‰ï¼ŒæŒ‡å‘äºè¡¨å¤´è¡Œã€‚**

**å½“æˆ‘ä»¬è°ƒç”¨äº† next() æ–¹æ³•åï¼Œå…‰æ ‡å°±ä¸‹ç§»åˆ°ç¬¬ä¸€è¡Œæ•°æ®ï¼Œå¹¶ä¸”æ–¹æ³•è¿”å›true**

4.4.1.2ã€xxx getXxx(å‚æ•°)ï¼šè·å–æ•°æ®

xxx : æ•°æ®ç±»å‹ï¼›å¦‚ï¼š int getInt(å‚æ•°) ï¼›String getString(å‚æ•°)

ä¸¤ç§å‚æ•° ï¼š

â‘ intç±»å‹çš„å‚æ•°ï¼šåˆ—çš„ç¼–å·ï¼Œä»1å¼€å§‹ï¼Œç¬¬ä¸€åˆ—ä¸º1ï¼Œç¬¬äºŒåˆ—ä¸º2â€¦

String name = resultSet.getString("1");

â‘¡Stringç±»å‹çš„å‚æ•°ï¼š åˆ—çš„åç§°

String name = resultSet.getString("name");

4.4.1.3ã€â­ä»£ç å®ç°

éœ€æ±‚ï¼šéå†å¾—åˆ°æ•°æ®åº“è¡¨å•stuä¸­çš„æ•°æ®

![](https://i-blog.csdnimg.cn/blog_migrate/2ce1326270aaca9f07a096bea58eb8c1.png)

stuï¼š

```java
package com.xzl;

public class stu {
    private String name;
    private Integer math;
    private String gender;

    public stu() { }

    public stu(String name, Integer math, String gender) {
        this.name = name;
        this.math = math;
        this.gender = gender;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Integer getMath() {
        return math;
    }

    public void setMath(Integer math) {
        this.math = math;
    }

    public String getGender() {
        return gender;
    }

    public void setGender(String gender) {
        this.gender = gender;
    }

    @Override
    public String toString() {
        return "stu{" +
            "name='" + name + '\'' +
            ", math=" + math +
            ", gender='" + gender + '\'' +
            '}';
    }
}
```

jbdcï¼š

```java
package com.xzl;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

public class jdbc {
    public static void main(String[] args) throws Exception {
        //1ã€æ³¨å†Œé©±åŠ¨
        Class.forName("com.mysql.jdbc.Driver");
        //2ã€è·å–è¿æ¥
        String url = "jdbc:mysql://127.0.0.1:3306/student?useSSL=false";
        String username = "root";
        String password_P = "xzlXZGK680";
        Connection connection = DriverManager.getConnection(url,username,password);
        //3ã€å®šä¹‰sql
        //        String sql1 = "insert into stu(name,math,gender) values('å¼ ä¸‰',85,'ç”·')";
        //        String sql2 = "insert into stu(name,math,gender) values('æå››',75,'ç”·')";
        //        String sql3 = "insert into stu(name,math,gender) values('ç‹äº”',90,'ç”·')";
        String sql_dql = "select * from stu";
        //4. è·å–æ‰§è¡Œsqlçš„å¯¹è±¡Statement
        Statement statement = connection.createStatement();
        //åˆ›å»ºé›†åˆå­˜æ”¾æ¥ä¸‹æ¥å¾—åˆ°çš„è¡¨å•æ•°æ®
        List<stu> list = new ArrayList<>();
        //æ­¤æ—¶éœ€è¦å¼€å¯äº‹åŠ¡ä¹‹åå†æ‰§è¡Œ
        try {
            //ç¦ç”¨è‡ªåŠ¨æäº¤æ¨¡å¼ï¼šfalse
            connection.setAutoCommit(false);
            //5ã€æ‰§è¡ŒSQL->æ­¤å¤„éœ€è¦å¼€å¯äº‹åŠ¡ä¹‹åå†æ‰§è¡Œ
            //            int count1 = statement.executeUpdate(sql1);
            //            int count2 = statement.executeUpdate(sql2);
            //            int count3 = statement.executeUpdate(sql3);
            ResultSet resultSet = statement.executeQuery(sql_dql);

            //6ã€å¤„ç†ç»“æœï¼ˆæ­¤å¤„demoéå†å¾—åˆ°stuä¸­çš„æ‰€æœ‰æ•°æ®å¹¶å­˜æ”¾äºé›†åˆï¼‰
            while (resultSet.next()){
                //åˆ›å»ºstuå¯¹è±¡
                stu student = new stu();
                String name = resultSet.getString("1");
                Integer math = resultSet.getInt(2);
                String gender = resultSet.getString(3);
                student.setName(name);
                student.setMath(math);
                student.setGender(gender);
                //å­˜å…¥listé›†åˆ
                list.add(student);

            }
            // ============æäº¤äº‹åŠ¡==========
            //ç¨‹åºè¿è¡Œåˆ°æ­¤å¤„ï¼Œè¯´æ˜æ²¡æœ‰å‡ºç°ä»»ä½•é—®é¢˜ï¼Œåˆ™éœ€æäº¤äº‹åŠ¡
            connection.commit();
        }catch (Exception e){
            //äº‹åŠ¡ç¨‹åºå‡ºé”™ï¼Œå›æ»šäº‹åŠ¡
            connection.rollback();
            e.printStackTrace();
        }finally {
            //7ã€é‡Šæ”¾èµ„æº
            statement.close();
            connection.close();
        }
        System.out.println(Arrays.toString(list.toArray()));
    }
}
```

## 5ã€æ•°æ®åº“è¿æ¥æ± 

### 5.1ã€ç®€ä»‹

æ•°æ®åº“è¿æ¥æ± æ˜¯ä¸ªå®¹å™¨ï¼Œè´Ÿè´£åˆ†é…ã€ç®¡ç†æ•°æ®åº“è¿æ¥(Connection)ã€‚

å®ƒå…è®¸åº”ç”¨ç¨‹åºé‡å¤ä½¿ç”¨ä¸€ä¸ªç°æœ‰çš„æ•°æ®åº“è¿æ¥ï¼Œè€Œä¸æ˜¯å†é‡æ–°å»ºç«‹ä¸€ä¸ªï¼›

é‡Šæ”¾ç©ºé—²æ—¶é—´è¶…è¿‡æœ€å¤§ç©ºé—²æ—¶é—´çš„æ•°æ®åº“è¿æ¥æ¥é¿å…å› ä¸ºæ²¡æœ‰é‡Šæ”¾æ•°æ®åº“è¿æ¥è€Œå¼•èµ·çš„æ•°æ®åº“è¿æ¥é—æ¼

ä¼˜ç‚¹ï¼š

â‘ èµ„æºé‡ç”¨

â‘¡æå‡ç³»ç»Ÿå“åº”é€Ÿåº¦

â‘¢é¿å…æ•°æ®åº“è¿æ¥é—æ¼

ä¹‹å‰çš„ä»£ç ä¸­ä½¿ç”¨è¿æ¥æ˜¯ä¸ç®¡æœ‰æ²¡æœ‰ä½¿ç”¨éƒ½åˆ›å»ºä¸€ä¸ªConnectionå¯¹è±¡ï¼Œä½¿ç”¨å®Œæ¯•å°±ä¼šå°†å…¶é”€æ¯ã€‚

è¿™æ ·é‡å¤åˆ›å»ºé”€æ¯çš„è¿‡ç¨‹æ˜¯ç‰¹åˆ«è€—è´¹è®¡ç®—æœºçš„æ€§èƒ½çš„åŠæ¶ˆè€—æ—¶é—´ã€‚

è€Œæ•°æ®åº“ä½¿ç”¨äº†æ•°æ®åº“è¿æ¥æ± åï¼Œå°±èƒ½è¾¾åˆ°Connectionå¯¹è±¡çš„å¤ç”¨ï¼

![](https://i-blog.csdnimg.cn/blog_migrate/bbc38fbe69570534ccedcd0526478583.png)

è¿æ¥æ± æ˜¯åœ¨ä¸€å¼€å§‹å°±åˆ›å»ºå¥½äº†ä¸€äº›è¿æ¥ï¼ˆConnectionï¼‰å¯¹è±¡å­˜å‚¨èµ·æ¥ã€‚

ç”¨æˆ·éœ€è¦è¿æ¥æ•°æ®åº“æ—¶ï¼Œä¸éœ€è¦è‡ªå·±åˆ›å»ºè¿æ¥ï¼Œè€Œåªéœ€è¦ä»è¿æ¥æ± ä¸­è·å–ä¸€ä¸ªè¿æ¥è¿›è¡Œä½¿ç”¨ï¼Œä½¿ç”¨å®Œæ¯•åå†å°†è¿æ¥å¯¹è±¡å½’è¿˜ç»™è¿æ¥æ± ï¼›è¿™æ ·å°±å¯ä»¥èµ·åˆ°èµ„æºé‡ç”¨ï¼Œä¹ŸèŠ‚çœäº†é¢‘ç¹åˆ›å»ºè¿æ¥é”€æ¯è¿æ¥æ‰€èŠ±è´¹çš„æ—¶é—´ï¼Œä»è€Œæå‡äº†ç³»ç»Ÿå“åº”çš„é€Ÿåº¦

### 5.2ã€è¿æ¥æ± çš„å®ç°

***æ ‡å‡†æ¥å£ï¼šDataSource-> å®˜æ–¹(SUN) æä¾›çš„æ•°æ®åº“è¿æ¥æ± æ ‡å‡†æ¥å£ï¼Œç”±ç¬¬ä¸‰æ–¹ç»„ç»‡å®ç°æ­¤æ¥å£ã€‚***

è¯¥æ¥å£æä¾›äº†è·å–è¿æ¥çš„åŠŸèƒ½ï¼Œä»¥åå°±ä¸éœ€è¦é€šè¿‡ DriverManager å¯¹è±¡è·å–Connectionå¯¹è±¡ï¼Œè€Œæ˜¯é€šè¿‡è¿æ¥æ± (DataSource)è·å–Connectionå¯¹è±¡ã€‚

#### 5.2.1ã€â­å¸¸è§çš„æ•°æ®åº“è¿æ¥æ± 

1. DBCP:ApacheåŸºé‡‘ä¼šæä¾›çš„æ•°æ®åº“è¿æ¥æ± å®ç°ï¼Œå…·æœ‰ç®€å•æ˜“ç”¨ã€æ€§èƒ½ç¨³å®šç­‰ä¼˜ç‚¹ã€‚
2. C3P0:å¼€æºçš„æ•°æ®åº“è¿æ¥æ± å®ç°ï¼Œæ”¯æŒè‡ªåŠ¨å›æ”¶ç©ºé—²è¿æ¥ã€è‡ªåŠ¨é‡æ–°è·å–å¤±æ•ˆè¿æ¥ç­‰åŠŸèƒ½ã€‚
3. ***Druid***
4. HikariCPï¼šä¸€æ¬¾é«˜æ€§èƒ½çš„æ•°æ®åº“è¿æ¥æ± å®ç°ï¼Œæ”¯æŒå¤šç§æ•°æ®åº“ï¼Œå…·æœ‰è½»é‡çº§ã€é«˜æ•ˆç‡ã€å¯é ç¨³å®šç­‰ç‰¹ç‚¹ã€‚
5. BoneCPï¼šä¸€æ¬¾é«˜æ€§èƒ½çš„æ•°æ®åº“è¿æ¥æ± å®ç°ï¼Œæ”¯æŒå¤šç§æ•°æ®åº“ï¼Œå…·æœ‰é«˜å¹¶å‘èƒ½åŠ›ã€å¯é ç¨³å®šç­‰ç‰¹ç‚¹ã€‚

ç°åœ¨ä½¿ç”¨æ›´å¤šçš„æ˜¯Druid.

***Druidæ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„ä¸€æ¬¾é«˜æ€§èƒ½ã€ç¨³å®šã€å®‰å…¨çš„æ•°æ®åº“è¿æ¥æ± å®ç°ã€‚***

å®ƒæ”¯æŒå¤šç§æ•°æ®åº“ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

1. é«˜æ€§èƒ½ï¼šé‡‡ç”¨é«˜æ•ˆçš„ç¼“å­˜æœºåˆ¶ï¼Œæé«˜æ•°æ®åº“è¿æ¥çš„åˆ©ç”¨ç‡ï¼Œæå‡æ•°æ®åº“æ€§èƒ½ã€‚
2. ç¨³å®šå¯é ï¼šæ”¯æŒè¿æ¥æ± ã€é˜²æ­¢æ”»å‡»ã€SQLç›‘æ§ç­‰åŠŸèƒ½ï¼Œä¿è¯æ•°æ®åº“çš„å®‰å…¨æ€§å’Œç¨³å®šæ€§ã€‚
3. å®æ—¶ç›‘æ§ï¼šæä¾›å®æ—¶çš„æ•°æ®ç›‘æ§ã€æ€§èƒ½åˆ†æå’Œæ•°æ®ç»Ÿè®¡åŠŸèƒ½ï¼Œæ–¹ä¾¿ç”¨æˆ·å¯¹æ•°æ®åº“æ€§èƒ½è¿›è¡Œè¯Šæ–­å’Œä¼˜åŒ–ã€‚
4. æ˜“ç”¨æ˜“æ‰©å±•ï¼šæä¾›ä¸°å¯Œçš„APIå’Œæ‰©å±•æ¥å£ï¼Œæ–¹ä¾¿ç”¨æˆ·å®šåˆ¶å’Œæ‰©å±•åŠŸèƒ½ï¼ŒåŒæ—¶æ˜“äºé›†æˆåˆ°å„ç§åº”ç”¨ç³»ç»Ÿä¸­ã€‚

Druidæ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æ•°æ®åº“è¿æ¥æ± å®ç°ï¼Œé€‚ç”¨äºå„ç§æ•°æ®åº“åº”ç”¨åœºæ™¯ï¼Œæ¨èä½¿ç”¨ã€‚

### 5.3ã€ğŸ”ºDruidçš„ä½¿ç”¨->IDEA

æ­¥éª¤ï¼š

â‘ å¯¼å…¥jaråŒ… druid-1.1.12.jar

â‘¡å®šä¹‰é…ç½®æ–‡ä»¶

â‘¢åŠ è½½é…ç½®æ–‡ä»¶

â‘£è·å–æ•°æ®åº“è¿æ¥æ± å¯¹è±¡

â‘¤è·å–è¿æ¥

#### 5.3.1ã€å¯¼jaråŒ…

æ”¾åœ¨libç›®å½•ä¸‹ï¼Œå¹¶æ·»åŠ åˆ°é¡¹ç›®ä¾èµ–ï¼š

![](https://i-blog.csdnimg.cn/blog_migrate/4aabb13fbb6517e04feca36380242753.png)

#### 5.3.2ã€å®šä¹‰é…ç½®æ–‡ä»¶

é…ç½®æ–‡ä»¶å¯ä»¥ä»å¤–éƒ¨å¯¼å…¥ï¼Œä¹Ÿå¯ä»¥è‡ªå·±æ–°å»ºç¼–å†™ï¼Œæ­¤å¤„æ˜¯è‡ªå·±ç¼–å†™ã€‚

é…ç½®æ–‡ä»¶è¦æ”¾åœ¨srcç›®å½•ä¸‹

![](https://i-blog.csdnimg.cn/blog_migrate/402cdacfaa7e90d8acf3413735e8209c.png)

5.3.2.1ã€ ğŸ”ºâ­druid.properties

Druidçš„é…ç½®æ–‡ä»¶druid.propertiesæ˜¯Druidæ•°æ®åº“è¿æ¥æ± çš„ä¸»è¦é…ç½®æ–‡ä»¶ï¼Œå®ƒåŒ…å«äº†Druidæ•°æ®åº“è¿æ¥æ± çš„å„é¡¹é…ç½®å‚æ•°ï¼Œ
***æ§åˆ¶Druidè¿è¡Œçš„è¡Œä¸º***
ã€‚

ä¸‹é¢æ˜¯druid.propertiesæ–‡ä»¶çš„å¸¸è§é…ç½®é¡¹ï¼š

1. é©±åŠ¨ç›¸å…³é…ç½®ï¼š

* driverClassNameï¼šæŒ‡å®šæ•°æ®åº“é©±åŠ¨ç±»åï¼›
* urlï¼šæŒ‡å®šæ•°æ®åº“è¿æ¥åœ°å€ï¼›
* usernameï¼šæŒ‡å®šæ•°æ®åº“ç”¨æˆ·åï¼›
* passwordï¼šæŒ‡å®šæ•°æ®åº“å¯†ç ã€‚

1. è¿æ¥æ± ç›¸å…³é…ç½®ï¼š

* initialSizeï¼šåˆå§‹è¿æ¥æ•°ï¼›
* maxActiveï¼šæœ€å¤§è¿æ¥æ•°ï¼›
* minIdleï¼šæœ€å°ç©ºé—²è¿æ¥æ•°ï¼›
* maxWaitï¼šè·å–è¿æ¥çš„æœ€å¤§ç­‰å¾…æ—¶é—´ã€‚

1. ç›‘æ§ç›¸å…³é…ç½®(åé¢å†è¯¦ç»†å­¦ä¹ )ï¼š

* filtersï¼šæŒ‡å®šDruidç›‘æ§çš„æ‹¦æˆªå™¨ï¼›
* connectionPropertiesï¼šæŒ‡å®šè¿æ¥çš„å…¶ä»–å±æ€§ï¼›
* statï¼šæ˜¯å¦å¼€å¯Druidç›‘æ§ã€‚

ç¤ºä¾‹ï¼š

```java
#é©±åŠ¨ç›¸å…³é…ç½®
driverClassName=com.mysql.jdbc.Driver
url=jdbc:mysql://localhost:3306/test?useUnicode=true&characterEncoding=utf-8
username=root
password=root

#è¿æ¥æ± ç›¸å…³é…ç½®
initialSize=10
maxActive=20
minIdle=5
maxWait=60000

#ç›‘æ§ç›¸å…³é…ç½®
filters=stat,wall
connectionProperties=druid.stat.mergeSql=true;druid.stat.slowSqlMillis=5000
stat=true
```

5.3.2.1.1ã€ç›‘æ§ç›¸å…³é…ç½®

druidçš„ç›‘æ§ç›¸å…³é…ç½®ä¸€èˆ¬æ˜¯å†™åœ¨propertiesæ–‡ä»¶ä¸­ï¼Œä¹Ÿå°±æ˜¯druid.propertiesæ–‡ä»¶ä¸­ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯å¯ä»¥éšæ—¶ä¿®æ”¹é…ç½®æ–‡ä»¶æ¥æ›´æ”¹druidçš„é…ç½®ï¼Œè€Œä¸éœ€è¦é‡æ–°ç¼–è¯‘å®¢æˆ·ç«¯ä»£ç ã€‚

å½“ç„¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å®¢æˆ·ç«¯ä»£ç çš„æ–¹å¼æ¥é…ç½®druidçš„ç›‘æ§ç›¸å…³é…ç½®ã€‚å…·ä½“çš„æ–¹æ³•æ˜¯ä½¿ç”¨DruidDataSourceç±»æ¥é…ç½®ç›‘æ§ç›¸å…³é…ç½®ã€‚

ä»¥ä¸‹æ˜¯å¸¸ç”¨çš„ç›‘æ§é…ç½®çš„Javaä»£ç ç¤ºä¾‹ï¼š

```java
DruidDataSource dataSource = new DruidDataSource();

// è®¾ç½®æ˜¯å¦åˆå¹¶SQL
dataSource.setConnectionProperties("druid.stat.mergeSql=true");

// è®¾ç½®ç»Ÿè®¡æ…¢SQLçš„æ—¶é—´
dataSource.setConnectionProperties("druid.stat.slowSqlMillis=5000");

// è®¾ç½®æ˜¯å¦æ‰“å°æ…¢SQLæ—¥å¿—
dataSource.setConnectionProperties("druid.stat.logSlowSql=true");

// è®¾ç½®æ˜¯å¦å¼€å¯Webç»Ÿè®¡é¡µé¢
dataSource.setConnectionProperties("druid.web.stat.enabled=true");

// è®¾ç½®è®¿é—®ç›‘æ§é¡µé¢çš„ç”¨æˆ·å
dataSource.setConnectionProperties("druid.web.stat.loginUsername=druid");

// è®¾ç½®è®¿é—®ç›‘æ§é¡µé¢çš„å¯†ç 
dataSource.setConnectionProperties("druid.web.stat.loginPassword=druid");
```

ä¸‹é¢æ˜¯druid.propertiesä¸­å¸¸è§çš„ç›‘æ§ç›¸å…³é…ç½®é¡¹ï¼š

1. é…ç½®ç›‘æ§æ§åˆ¶å°ï¼š

```
druid.stat.mergeSql=true
druid.stat.logSlowSql=true
druid.web.stat.enabled=true
druid.web.stat.urlPattern=/*
druid.web.stat.resetEnable=false
druid.web.stat.sessionStatEnable=false
druid.web.stat.sessionStatMaxCount=1000
druid.web.stat.principalSessionName=user
druid.web.stat.principalCookieName=user
druid.web.stat.profileEnable=false
```

1. é…ç½®ç›‘æ§æ•°æ®æºï¼š

```
druid.monitor.log.enabled=false
druid.monitor.log.intervalSeconds=30
```

æ³¨æ„ï¼šä¸Šé¢çš„é…ç½®ä»…ä»…æ˜¯druid.propertiesç›‘æ§ç›¸å…³é…ç½®çš„å¸¸è§é…ç½®é¡¹ï¼Œè¯¦ç»†é…ç½®è¯·å‚è€ƒdruidå®˜æ–¹æ–‡æ¡£ã€‚

5.3.2.2ã€ç®€å•demoä»£ç 

```java
driverClassName=com.mysql.jdbc.Driver
url=jdbc:mysql://127.0.0.1:3306/student?useSSL=false&useServePrepStmts=true
username=root
password=xzlXZGK680
initialSize=5
maxActive=15
minIdle=5
maxWait=3000
```

#### 5.3.3ã€ä½¿ç”¨Druid

```java
import com.alibaba.druid.pool.DruidDataSourceFactory;

import javax.sql.DataSource;
import java.io.FileInputStream;
import java.sql.Connection;
import java.util.Properties;

public class DruidDemo {
    public static void main(String[] args) throws Exception {
        //1.å¯¼å…¥jaråŒ…
        //2.å®šä¹‰é…ç½®æ–‡ä»¶
        //3. åŠ è½½é…ç½®æ–‡ä»¶
        Properties properties = new Properties();
        properties.load(new FileInputStream("src/druid.properties"));
        //4ã€è·å–è¿æ¥æ± å¯¹è±¡
        DataSource dataSource = DruidDataSourceFactory.createDataSource(properties);
        //5ã€è·å–æ•°æ®åº“è¿æ¥Connection
        Connection connection = dataSource.getConnection();
        System.out.println(connection);
        //è·å–åˆ°æ•°æ®åº“è¿æ¥ä¹‹åå°±å¯ä»¥ç»§ç»­è¿›è¡Œå…¶ä»–æ“ä½œäº†
    }
}
```