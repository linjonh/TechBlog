---
layout: post
title: "STL中的哈希表unordered_map和unordered_set内部使用的数据结构"
date: 2025-03-14 14:35:20 +0800
description: "在unordered_map和unordered_set中，数据的存储与管理主要依赖于哈希表这种数据结构。"
keywords: "STL中的哈希表(unordered_map和unordered_set内部使用的数据结构)"
categories: ['C']
tags: ['数据结构', '散列表', 'C']
artid: "146256917"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146256917
    alt: "STL中的哈希表unordered_map和unordered_set内部使用的数据结构"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146256917
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146256917
cover: https://bing.ee123.net/img/rand?artid=146256917
image: https://bing.ee123.net/img/rand?artid=146256917
img: https://bing.ee123.net/img/rand?artid=146256917
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     STL中的哈希表(unordered_map和unordered_set内部使用的数据结构)
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     在
     <code>
      std::unordered_map
     </code>
     和
     <code>
      std::unordered_set
     </code>
     中，数据的存储与管理主要依赖于哈希表这种数据结构。
    </p>
    <h4>
     <a id="_2">
     </a>
     哈希表的工作流程
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        初始化桶数组
       </strong>
       ：当创建一个
       <code>
        std::unordered_map
       </code>
       或
       <code>
        std::unordered_set
       </code>
       时，会初始化一定数量的桶（buckets）。这些桶实际上是用于存放键值对或者仅键（对于
       <code>
        unordered_set
       </code>
       ）的数据结构。
      </p>
     </li>
     <li>
      <p>
       <strong>
        计算哈希值
       </strong>
       ：每当插入一个新的元素（键值对或键），首先通过该元素的键运行哈希函数来计算出一个哈希值。这个哈希值决定了该元素应该被放置在哪个桶中。
      </p>
     </li>
     <li>
      <p>
       <strong>
        定位桶并处理冲突
       </strong>
       ：
      </p>
      <ul>
       <li>
        根据哈希值确定对应的桶。
       </li>
       <li>
        如果目标桶当前为空，则直接将新元素插入到该桶中。
       </li>
       <li>
        如果目标桶中已经存在其他元素，则说明发生了哈希冲突。此时，C++标准库通常使用**链地址法（Separate Chaining）**来解决冲突。这意味着每个桶实际上是一个链表，所有哈希到同一个桶的元素都会被添加到这个链表中。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        负载因子监控与自动扩容
       </strong>
       ：随着越来越多的元素被插入，哈希表的负载因子（即元素数量除以桶的数量）会逐渐增加。一旦负载因子超过某个阈值，哈希表会自动进行rehash操作，也就是增加桶的数量，并重新分配所有元素以保持较低的负载因子，从而确保查找、插入和删除操作的平均时间复杂度接近O(1)。
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/2ca337d1ed7541f3afe17053353359cc.png"/>
      </p>
     </li>
    </ol>
    <h4>
     <a id="_16">
     </a>
     示例
    </h4>
    <p>
     假设我们有一个
     <code>
      std::unordered_map&lt;int, std::string&gt;
     </code>
     ，并且插入了以下键值对：
    </p>
    <ul>
     <li>
      <p>
       插入
       <code>
        (1, "Apple")
       </code>
      </p>
      <ul>
       <li>
        假设哈希函数为
        <code>
         h(k) = k % 8
        </code>
        （这里只是举例），则键
        <code>
         1
        </code>
        的哈希值为
        <code>
         1 % 8 = 1
        </code>
        。所以它会被放入第1号桶中。
       </li>
      </ul>
     </li>
     <li>
      <p>
       接着插入
       <code>
        (9, "Banana")
       </code>
      </p>
      <ul>
       <li>
        键
        <code>
         9
        </code>
        的哈希值同样为
        <code>
         9 % 8 = 1
        </code>
        。这导致了一个冲突，因为第1号桶已经有了一个元素。
       </li>
       <li>
        在这种情况下，
        <code>
         "Banana"
        </code>
        会被添加到第1号桶的链表中。
       </li>
      </ul>
     </li>
    </ul>
    <p>
     这样，当需要查找键
     <code>
      9
     </code>
     对应的值
     <code>
      "Banana"
     </code>
     时，系统会先通过哈希函数找到第1号桶，然后遍历该桶中的链表找到对应的键值对。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="687474:70733a2f2f626c6f672e6373646e2e6e65742f617879775f2f:61727469636c652f64657461696c732f313436323536393137" class_="artid" style="display:none">
 </p>
</div>


