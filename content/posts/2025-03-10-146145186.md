---
layout: post
title: "react使用拖拽,缩放组件,采用react-rnd解决-完整版"
date: 2025-03-10 10:12:52 +0800
description: "react使用拖拽，缩放组件，采用react-rnd解决"
keywords: "react使用拖拽，缩放组件，采用react-rnd解决 -完整版"
categories: ['未分类']
tags: ['前端', 'React', 'Javascript']
artid: "146145186"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146145186
    alt: "react使用拖拽,缩放组件,采用react-rnd解决-完整版"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146145186
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146145186
cover: https://bing.ee123.net/img/rand?artid=146145186
image: https://bing.ee123.net/img/rand?artid=146145186
img: https://bing.ee123.net/img/rand?artid=146145186
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     react使用拖拽，缩放组件，采用react-rnd解决 -完整版
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <div class="video">
     <iframe allowfullscreen="true" data-mediaembed="csdn" frameborder="0" id="mjzS1uar-1741585618213" src="https://live.csdn.net/v/embed/467994" style="width:100%;height:100%;">
     </iframe>
     <p>
      屏幕录制2025-03-10 10.16.06
     </p>
    </div>
    <p>
    </p>
    <p>
     以下代码仅提供左侧可视化区域
     <br/>
     右侧数据根据你们的存储数据来
     <br/>
     大家直接看Rnd标签设置的属性即可！！！！！
    </p>
    <pre><code class="prism language-bash">/**
 * 用户拖拽水印的最终位置信息
 */
<span class="token builtin class-name">export</span> interface ProductWatermarkValue <span class="token punctuation">{<!-- --></span>
    watermark?: ProductWatermarkManagerValue<span class="token punctuation">;</span>
    position: <span class="token punctuation">{<!-- --></span>
        x: number<span class="token punctuation">;</span> // 水印在图片上的水平位置
        y: number<span class="token punctuation">;</span> // 水印在图片上的垂直位置
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    size: <span class="token punctuation">{<!-- --></span>
        width: number<span class="token punctuation">;</span> // 水印的宽度（相对于商品图片的宽度）
        height: number<span class="token punctuation">;</span> // 水印的高度（相对于商品图片的高度）
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
/**
 * 用户上传的水印详细信息，比如路径，宽高
 */
<span class="token builtin class-name">export</span> interface ProductWatermarkManagerValue <span class="token punctuation">{<!-- --></span>
    id: string<span class="token punctuation">;</span>
    name: string<span class="token punctuation">;</span>
    fileUrl: string<span class="token punctuation">;</span>
    width: number<span class="token punctuation">;</span>
    height: number<span class="token punctuation">;</span>
    type: ProductWatermarkManagerValueType<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <pre><code class="prism language-bash"><span class="token function">import</span> React, <span class="token punctuation">{<!-- --></span> Component <span class="token punctuation">}</span> from <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token function">import</span> <span class="token punctuation">{<!-- --></span> connect <span class="token punctuation">}</span> from <span class="token string">'react-redux'</span><span class="token punctuation">;</span>
<span class="token function">import</span> <span class="token punctuation">{<!-- --></span> Rnd <span class="token punctuation">}</span> from <span class="token string">'react-rnd'</span><span class="token punctuation">;</span>
<span class="token function">import</span> <span class="token punctuation">{<!-- --></span> Dispatch <span class="token punctuation">}</span> from <span class="token string">'redux'</span><span class="token punctuation">;</span>
<span class="token function">import</span> <span class="token punctuation">{<!-- --></span> actions <span class="token punctuation">}</span> from <span class="token string">'@comall-backend-builder/core'</span><span class="token punctuation">;</span>
<span class="token function">import</span> <span class="token punctuation">{<!-- --></span> Entity <span class="token punctuation">}</span> from <span class="token string">'@comall-backend-builder/core/lib/parser'</span><span class="token punctuation">;</span>
<span class="token function">import</span> <span class="token string">'./index.less'</span><span class="token punctuation">;</span>

const prefix <span class="token operator">=</span> <span class="token string">'product-main-image-watermark-preview'</span><span class="token punctuation">;</span>
interface Props <span class="token punctuation">{<!-- --></span>
    dispatch: Dispatch<span class="token punctuation">;</span>
    entity: Entity<span class="token punctuation">;</span>
    componentId: any<span class="token punctuation">;</span>
    preview: any<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
interface State <span class="token punctuation">{<!-- --></span>
    /**
     * 正在操作中
     */
    isDragging: boolean<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token builtin class-name">export</span> class productMainImageWatermarkRulePreview extends Component<span class="token operator">&lt;</span>Props, State<span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
    constructor<span class="token punctuation">(</span>props: Props<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        super<span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
        this.state <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            isDragging: false,
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    getWatermarkRule <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
        const <span class="token punctuation">{<!-- --></span> preview <span class="token punctuation">}</span> <span class="token operator">=</span> this.props<span class="token punctuation">;</span>
        <span class="token builtin class-name">return</span> preview?.baseInfo?.watermarkRule<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    getPreviewProduct <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
        const <span class="token punctuation">{<!-- --></span> preview <span class="token punctuation">}</span> <span class="token operator">=</span> this.props<span class="token punctuation">;</span>
        const goods <span class="token operator">=</span> preview?.baseInfo?.goods <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        const isPreviewGoods <span class="token operator">=</span> goods.find<span class="token variable"><span class="token punctuation">((</span>item<span class="token operator">:</span> any<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> {
            return item.isPreview<span class="token punctuation">;</span>
        }<span class="token punctuation">)</span><span class="token punctuation">;</span>
        return isPreviewGoods<span class="token punctuation">;</span>
    }<span class="token punctuation">;</span>
    onChangeWatermarkRule <span class="token operator">=</span> <span class="token punctuation">(</span>ruleWatermark<span class="token operator">:</span> any<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> {
        const { dispatch<span class="token punctuation">,</span> componentId } <span class="token operator">=</span> this.props<span class="token punctuation">;</span>
        dispatch<span class="token punctuation">(</span>actions.formChangeAction<span class="token punctuation">(</span>componentId<span class="token punctuation">,</span> 'baseInfo.watermarkRule'<span class="token punctuation">,</span> ruleWatermark<span class="token punctuation">))</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    handleDragStart <span class="token operator">=</span> <span class="token punctuation">(</span>e: any<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
        e.preventDefault<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        e.stopPropagation<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        this.setState<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            isDragging: true,
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    handleDragStop <span class="token operator">=</span> <span class="token punctuation">(</span>e: any, d: any<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
        e.preventDefault<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        e.stopPropagation<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        this.setState<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            isDragging: false,
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        const watermarkRule <span class="token operator">=</span> this.getWatermarkRule<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        watermarkRule.position <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            x: d.x <span class="token operator">&gt;</span> <span class="token number">0</span> ? d.x * <span class="token number">2</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
            y: d.y <span class="token operator">&gt;</span> <span class="token number">0</span> ? d.y * <span class="token number">2</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        this.onChangeWatermarkRule<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token punctuation">..</span>.watermarkRule <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    handleResizeStart <span class="token operator">=</span> <span class="token punctuation">(</span>e: any<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
        e.preventDefault<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        e.stopPropagation<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        this.setState<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            isDragging: true,
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    handleResizeStop <span class="token operator">=</span> <span class="token punctuation">(</span>e: any, direction: any, ref: any, delta: any, position: any<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
        e.preventDefault<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        e.stopPropagation<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        this.setState<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            isDragging: false,
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        const watermarkRule <span class="token operator">=</span> this.getWatermarkRule<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        const sizeWidth <span class="token operator">=</span> ref.style.width.replace<span class="token punctuation">(</span><span class="token string">'px'</span>, <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        const sizeHeight <span class="token operator">=</span> ref.style.height.replace<span class="token punctuation">(</span><span class="token string">'px'</span>, <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        //因为左侧模拟器是375px，后端存储的是750px的，所以Rnd数据需要乘以2
        watermarkRule.size <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            width: <span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{<!-- --></span>sizeWidth * <span class="token number">2</span><span class="token punctuation">}</span>px<span class="token variable">`</span></span>,
            height: <span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{<!-- --></span>sizeHeight * <span class="token number">2</span><span class="token punctuation">}</span>px<span class="token variable">`</span></span>,
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        watermarkRule.position <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            x: position.x <span class="token operator">&gt;</span> <span class="token number">0</span> ? position.x * <span class="token number">2</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
            y: position.y <span class="token operator">&gt;</span> <span class="token number">0</span> ? position.y * <span class="token number">2</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        this.onChangeWatermarkRule<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token punctuation">..</span>.watermarkRule <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function-name function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        const watermarkRule <span class="token operator">=</span> this.getWatermarkRule<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>watermarkRule<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token builtin class-name">return</span> null<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        const <span class="token punctuation">{<!-- --></span> position, size, watermark <span class="token punctuation">}</span> <span class="token operator">=</span> watermarkRule<span class="token punctuation">;</span>
        const previewGoods <span class="token operator">=</span> this.getPreviewProduct<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        const pic <span class="token operator">=</span> previewGoods?.productPic <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">;</span>
        const <span class="token punctuation">{<!-- --></span> isDragging <span class="token punctuation">}</span> <span class="token operator">=</span> this.state<span class="token punctuation">;</span>
        const style <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            backgroundImage: pic ? <span class="token variable"><span class="token variable">`</span>url<span class="token punctuation">(</span>$<span class="token punctuation">{<!-- --></span>pic<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token variable">`</span></span> <span class="token builtin class-name">:</span> undefined,
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        const sizeWidth <span class="token operator">=</span> size <span class="token operator">&amp;&amp;</span> size.width ? size.width.replace<span class="token punctuation">(</span><span class="token string">'px'</span>, <span class="token string">''</span><span class="token punctuation">)</span> <span class="token builtin class-name">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
        const sizeHeight <span class="token operator">=</span> size <span class="token operator">&amp;&amp;</span> size.height ? size.height.replace<span class="token punctuation">(</span><span class="token string">'px'</span>, <span class="token string">''</span><span class="token punctuation">)</span> <span class="token builtin class-name">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
        //因为后端存储的是750px的，左侧模拟器是375px，所以页面渲染数据需要除2
        const rndSize <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            width: <span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{<!-- --></span>sizeWidth / <span class="token number">2</span><span class="token punctuation">}</span>px<span class="token variable">`</span></span>,
            height: <span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{<!-- --></span>sizeHeight / <span class="token number">2</span><span class="token punctuation">}</span>px<span class="token variable">`</span></span>,
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        const rndPosition <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            x: position.x / <span class="token number">2</span>,
            y: position.y / <span class="token number">2</span>,
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        console.log<span class="token punctuation">(</span><span class="token string">'存储大小size,position'</span>, size, position<span class="token punctuation">)</span><span class="token punctuation">;</span>
        console.log<span class="token punctuation">(</span><span class="token string">'展示大小rndSize,rndPosition'</span>, rndSize, rndPosition<span class="token punctuation">)</span><span class="token punctuation">;</span>
        const isDraggingStyle <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            opacity: isDragging ? <span class="token number">0.8</span> <span class="token builtin class-name">:</span> <span class="token number">1</span>,
            border: isDragging ? <span class="token string">'2px solid #1890ff'</span> <span class="token builtin class-name">:</span> undefined,
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token builtin class-name">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>div <span class="token assign-left variable">className</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span>prefix<span class="token punctuation">}</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div <span class="token assign-left variable">className</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token variable"><span class="token variable">`</span>$<span class="token punctuation">{<!-- --></span>prefix<span class="token punctuation">}</span>__bg<span class="token variable">`</span></span><span class="token punctuation">}</span> <span class="token assign-left variable">style</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span>style<span class="token punctuation">}</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>Rnd
                        <span class="token assign-left variable">maxHeight</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token number">375</span><span class="token punctuation">}</span>
                        <span class="token assign-left variable">maxWidth</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token number">375</span><span class="token punctuation">}</span>
                        <span class="token assign-left variable">size</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span>rndSize<span class="token punctuation">}</span>
                        <span class="token assign-left variable">position</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span>rndPosition<span class="token punctuation">}</span>
                        <span class="token assign-left variable">bounds</span><span class="token operator">=</span><span class="token string">"parent"</span>
                        <span class="token assign-left variable">onDragStart</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span>this.handleDragStart<span class="token punctuation">}</span>
                        <span class="token assign-left variable">onDragStop</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span>this.handleDragStop<span class="token punctuation">}</span>
                        <span class="token assign-left variable">onResizeStart</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span>this.handleResizeStart<span class="token punctuation">}</span>
                        <span class="token assign-left variable">onResizeStop</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span>this.handleResizeStop<span class="token punctuation">}</span>
                        <span class="token assign-left variable">resizeParentMore</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span>true<span class="token punctuation">}</span> // 如果需要阻止父容器跟随大小变化，可以设置为false
                        <span class="token assign-left variable">enableResizing</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>
                            top: true,
                            right: true,
                            bottom: true,
                            left: true,
                            topRight: true,
                            bottomRight: true,
                            bottomLeft: true,
                            topLeft: true,
                        <span class="token punctuation">}</span><span class="token punctuation">}</span>
                        <span class="token assign-left variable">resizeHandles</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">[</span><span class="token string">'se'</span>, <span class="token string">'sw'</span>, <span class="token string">'ne'</span>, <span class="token string">'nw'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
                        <span class="token assign-left variable">style</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span>isDraggingStyle<span class="token punctuation">}</span>
                        <span class="token assign-left variable">onClick</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">(</span>e: any<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> e.stopPropagation<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
                        <span class="token assign-left variable">lockAspectRatio</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span>true<span class="token punctuation">}</span>
                    <span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>img
                            <span class="token assign-left variable">src</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span>watermark?.fileUrl<span class="token punctuation">}</span>
                            <span class="token assign-left variable">alt</span><span class="token operator">=</span><span class="token string">""</span>
                            <span class="token assign-left variable">style</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> width: <span class="token string">'100%'</span>, height: <span class="token string">'100%'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
                        /<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>/Rnd<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

const mapStateToProps <span class="token operator">=</span> <span class="token punctuation">(</span>_state: any, props: any<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token builtin class-name">let</span> preview <span class="token operator">=</span> null<span class="token punctuation">;</span>
    <span class="token builtin class-name">let</span> componentId <span class="token operator">=</span> null<span class="token punctuation">;</span>
    const entityId <span class="token operator">=</span> props.entity.id<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>var compId <span class="token keyword">in</span> _state.components<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        const comp <span class="token operator">=</span> _state.components<span class="token punctuation">[</span>compId<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>
            <span class="token punctuation">(</span>comp.type <span class="token operator">==</span><span class="token operator">=</span> <span class="token string">'CreateForm'</span> <span class="token operator">||</span> comp.type <span class="token operator">==</span><span class="token operator">=</span> <span class="token string">'EditForm'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
            comp.entityId <span class="token operator">==</span><span class="token operator">=</span> entityId
        <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            preview <span class="token operator">=</span> comp.fields<span class="token punctuation">;</span>
            componentId <span class="token operator">=</span> compId<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token builtin class-name">return</span> <span class="token punctuation">{<!-- --></span> preview: preview, componentId: componentId <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token builtin class-name">export</span> const ProductMainImageWatermarkRulePreview <span class="token operator">=</span> connect<span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">)</span><span class="token punctuation">(</span>
    productMainImageWatermarkRulePreview
<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre>
    <pre><code class="prism language-bash">.product-main-image-watermark-preview<span class="token punctuation">{<!-- --></span>
  <span class="token operator">&amp;</span>__bg<span class="token punctuation">{<!-- --></span>
    margin-right: 10px<span class="token punctuation">;</span>
    overflow: hidden<span class="token punctuation">;</span>
    width: 375px <span class="token punctuation">;</span>
    min-width: 375px<span class="token punctuation">;</span>
    height: 375px<span class="token punctuation">;</span>
    position: relative<span class="token punctuation">;</span>
    border: 1px solid <span class="token comment">#ccc;</span>
    background-position: center<span class="token punctuation">;</span>
    background-repeat: no-repeat<span class="token punctuation">;</span>
    background-size: cover<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
    <p>
     开发过程中遇到的问题
     <br/>
     1.在使用过程中，火狐浏览器出现一拖拽，就打开了浏览器新标签页
     <br/>
     解决方案：在方法调用处理中新增以下两个代码
    </p>
    <pre><code class="prism language-bash">e.preventDefault<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
e.stopPropagation<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     2.在使用过程中，用户需要自己上传的水印在左侧渲染中，拉伸时，是等比例放大或缩小的，而不是用户自己控制拉伸大小
     <br/>
     解决方案：Rnd标签设置属性
    </p>
    <pre><code class="prism language-bash">  <span class="token assign-left variable">lockAspectRatio</span><span class="token operator">=</span><span class="token punctuation">{<!-- --></span>true<span class="token punctuation">}</span>
</code></pre>
    <p>
     希望以上代码对大家有帮助❤️
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34333531373139302f:61727469636c652f64657461696c732f313436313435313836" class_="artid" style="display:none">
 </p>
</div>


