---
layout: post
title: "Ai-WB2-32S-对接阿里云物联网平台实时监控二氧化碳数值JW01-CO2-V2.2"
date: 2024-03-01 18:30:19 +0800
description: "最近博主尝试将mqtt的tcp demo和uart的demo放在一起，将数据上传到阿里云物联网平台进"
keywords: "ai-wb2 连接阿里云"
categories: ['Wifi']
tags: ['阿里云', '网络协议', '物联网', '人工智能', 'Tcp']
artid: "136397866"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=136397866
    alt: "Ai-WB2-32S-对接阿里云物联网平台实时监控二氧化碳数值JW01-CO2-V2.2"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=136397866
featuredImagePreview: https://bing.ee123.net/img/rand?artid=136397866
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Ai-WB2-32S 对接阿里云物联网平台实时监控二氧化碳数值（JW01-CO2-V2.2）
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <div class="toc">
     <h4>
      文章目录
     </h4>
     <ul>
      <li>
       <a href="#_6" rel="nofollow">
        前言
       </a>
      </li>
      <li>
       <a href="#_9" rel="nofollow">
        一、在阿里云物联网平台上创建产品和设备
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#__10" rel="nofollow">
          第一步 大家先注册一个阿里云平台的账号
         </a>
        </li>
        <li>
         <a href="#__11" rel="nofollow">
          第二步 使用免费产品
         </a>
        </li>
        <li>
         <a href="#_51" rel="nofollow">
          好嘞！产品和设备的创建，以及后续需要的数据都准备好了，下面开始写代码了！
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a href="#_57" rel="nofollow">
        二、编写代码
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#__58" rel="nofollow">
          第一步 直接点击下面的链接进行下载
         </a>
        </li>
        <li>
         <a href="#__60" rel="nofollow">
          第二步 将压缩包解压到下图所示的目录
         </a>
        </li>
        <li>
         <a href="#_vscodemsys_62" rel="nofollow">
          第三步 打开vscode并进入msys终端进入此目录
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a href="#_114" rel="nofollow">
        三、编译
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#_co2_115" rel="nofollow">
          第一步 进入co2目录
         </a>
        </li>
        <li>
         <a href="#__119" rel="nofollow">
          第二步 进行编译
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a href="#_123" rel="nofollow">
        四、烧录
       </a>
      </li>
      <li>
       <a href="#_130" rel="nofollow">
        五、演示
       </a>
      </li>
      <li>
       <a href="#__131" rel="nofollow">
        第一步 打开串口调试助手并开始打开串口
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#__134" rel="nofollow">
          第二步 将传感器与模组相连
         </a>
        </li>
        <li>
         <a href="#__142" rel="nofollow">
          第三步 按下模组的复位键开始执行
         </a>
        </li>
        <li>
         <a href="#__144" rel="nofollow">
          第四步 成果
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a href="#_160" rel="nofollow">
        总结
       </a>
      </li>
     </ul>
    </div>
    <p>
    </p>
    <hr/>
    <h2>
     <a id="_6">
     </a>
     前言
    </h2>
    <p>
     最近博主尝试将mqtt的tcp demo和uart的demo放在一起，将数据上传到阿里云物联网平台进行实时监控，下面介绍一下步骤！
    </p>
    <h2>
     <a id="_9">
     </a>
     一、在阿里云物联网平台上创建产品和设备
    </h2>
    <h3>
     <a id="__10">
     </a>
     第一步 大家先注册一个阿里云平台的账号
    </h3>
    <h3>
     <a id="__11">
     </a>
     第二步 使用免费产品
    </h3>
    <p>
     <img alt="图一" src="https://i-blog.csdnimg.cn/blog_migrate/dc2493c3dddb86f58b4ca0314a221ea4.png">
      <br/>
      <img alt="图二" src="https://i-blog.csdnimg.cn/blog_migrate/02a1f3c4c713849dfa493c38894c2cea.png">
       <br/>
       <img alt="图三" src="https://i-blog.csdnimg.cn/blog_migrate/6b87f042a5df3ed04622fcc3b7844d13.png">
        <br/>
        <img alt="图四" src="https://i-blog.csdnimg.cn/blog_migrate/74ac73e0b9419b4916e87a738c03502e.png">
         <img alt="图五" src="https://i-blog.csdnimg.cn/blog_migrate/10b022dc03d1e883eb375c02f7ef5bc7.png">
          <img alt="图六" src="https://i-blog.csdnimg.cn/blog_migrate/1395847a6630b3f4097f4180202eeb28.png">
           <br/>
           <img alt="图七" src="https://i-blog.csdnimg.cn/blog_migrate/5ef5fb0f09ccd8d28244ea0e78bec610.png">
            <br/>
            <img alt="图八" src="https://i-blog.csdnimg.cn/blog_migrate/5e93b821a05579a80e5d525ef3f0cef9.png">
             <br/>
             <img alt="图九" src="https://i-blog.csdnimg.cn/blog_migrate/98eecdc0f7e9f2f0ae36c9d2c8c95e76.png"/>
             <br/>
             <img alt="图十" src="https://i-blog.csdnimg.cn/blog_migrate/8d95488e513255047d65d631e9e87edf.png"/>
             <br/>
             <img alt="图十一" src="https://i-blog.csdnimg.cn/blog_migrate/8c95ef8ae5ef9814a65c8f855c152036.png"/>
             <br/>
             <img alt="图十二" src="https://i-blog.csdnimg.cn/blog_migrate/c29670b6009815e86bf496b419d0fd31.png"/>
             <br/>
             <img alt="图十三" src="https://i-blog.csdnimg.cn/blog_migrate/2219929c349df449ecde101a3c80c1a9.png"/>
             <br/>
             <img alt="图十四" src="https://i-blog.csdnimg.cn/blog_migrate/634d1f973e0718cec00a04f2aec570f2.png"/>
             <br/>
             <img alt="图十五" src="https://i-blog.csdnimg.cn/blog_migrate/a304b96a8e1670c25f6f704d62382480.png"/>
             <br/>
             <code>
              点击完成即可
             </code>
             <br/>
             <img alt="图十六" src="https://i-blog.csdnimg.cn/blog_migrate/ce48b32901e0c803b497c17fdc9b9b16.png"/>
             <br/>
             <img alt="图十七" src="https://i-blog.csdnimg.cn/blog_migrate/a0a6ef59bacc9d4c7b14764161894a1b.png"/>
             <br/>
             <img alt="图十八" src="https://i-blog.csdnimg.cn/blog_migrate/e1a8305d328124cce41e049fd9647d0a.png"/>
             <br/>
             <img alt="图十九" src="https://i-blog.csdnimg.cn/blog_migrate/8391361a2368c14928bc9616eeedaba2.png"/>
             <br/>
             <img alt="图二十" src="https://i-blog.csdnimg.cn/blog_migrate/4a0c44b0e3b9b71e43e72fd5c777388f.png"/>
             <br/>
             <img alt="图二十一" src="https://i-blog.csdnimg.cn/blog_migrate/c88e127cad56fa1f0908e7c0dc9ff626.png"/>
             <br/>
             <code>
              复制设备到云平台消息中topic后的内容
             </code>
             <br/>
             例如博主这里是：/sys/k0ataNPqWKb/co2_data/thing/event/property/post
             <br/>
             <code>
              复制payload后面加上大括号的内容
             </code>
             <br/>
             例如博主这里是：{“id”:1709282051065,“params”:{“CO2”:22},“version”:“1.0”,“method”:“thing.event.property.post”}
            </img>
           </img>
          </img>
         </img>
        </img>
       </img>
      </img>
     </img>
    </p>
    <p>
     <img alt="图二十二" src="https://i-blog.csdnimg.cn/blog_migrate/bb5106a72ffd198796fe6b5e22d5566a.png"/>
     <br/>
     <img alt="图二十三" src="https://i-blog.csdnimg.cn/blog_migrate/966815a35b415476d232d4f6a68e55f1.png"/>
    </p>
    <p>
     <img alt="图二十四" src="https://i-blog.csdnimg.cn/blog_migrate/ac6f3303128f1d7f8d9b826e6460e1e5.png"/>
     <br/>
     <img alt="图二十五" src="https://i-blog.csdnimg.cn/blog_migrate/a306d506060fbb810df9bb1ed6a83fe2.png"/>
     <br/>
     <img alt="图二十六" src="https://i-blog.csdnimg.cn/blog_migrate/65b7eeb22ba54859c99b656a95409fbe.png"/>
     <br/>
     <img alt="图二十七" src="https://i-blog.csdnimg.cn/blog_migrate/a24e133cd7e4ff1f508a9747fd52300a.png"/>
     <br/>
     <img alt="图二十八" src="https://i-blog.csdnimg.cn/blog_migrate/4077952660b94117ffa32d262a12aa36.png"/>
     <br/>
     <code>
      别忘点击保存哦
     </code>
    </p>
    <h3>
     <a id="_51">
     </a>
     好嘞！产品和设备的创建，以及后续需要的数据都准备好了，下面开始写代码了！
    </h3>
    <h2>
     <a id="_57">
     </a>
     二、编写代码
    </h2>
    <h3>
     <a id="__58">
     </a>
     第一步 直接点击下面的链接进行下载
    </h3>
    <p>
     <a href="https://pan.baidu.com/s/1Z6R6CSn-GPS0uV6I_gBCpA?pwd=std1" rel="nofollow">
      https://pan.baidu.com/s/1Z6R6CSn-GPS0uV6I_gBCpA?pwd=std1
     </a>
    </p>
    <h3>
     <a id="__60">
     </a>
     第二步 将压缩包解压到下图所示的目录
    </h3>
    <p>
     <img alt="图一" src="https://i-blog.csdnimg.cn/blog_migrate/baa8a5d97d0da57a28fe63ed4fdd20c8.png"/>
    </p>
    <h3>
     <a id="_vscodemsys_62">
     </a>
     第三步 打开vscode并进入msys终端进入此目录
    </h3>
    <p>
     在终端输入下面的指令：
     <br/>
     D:\mys64\msys2_shell.cmd -defterm -no-start（这里的指令只需要输入自己的msys2安装的地址后加上msys2_shell.cmd -defterm -no-start，应为大家安装位置可能都不一样，所以提示一下）
    </p>
    <p>
     <img alt="图二" src="https://i-blog.csdnimg.cn/blog_migrate/b6513e4a00557e9ea1496105440a0608.png"/>
     <br/>
     修改fuction.c
     <br/>
     <img alt="图三" src="https://i-blog.csdnimg.cn/blog_migrate/8f4ea2b65f81e118109a7ee4294b21c5.png"/>
     <br/>
     修改main.h文件
     <br/>
     <img alt="图四" src="https://i-blog.csdnimg.cn/blog_migrate/3f51f3e9a81a9a58085c10c785c79e41.png"/>
    </p>
    <p>
     打开前面创建的文本文档
     <br/>
     这里用博主的数据举个例子
    </p>
    <pre><code class="prism language-c"><span class="token operator">/</span>sys<span class="token operator">/</span>k0ataNPqWKb<span class="token operator">/</span>co2_data<span class="token operator">/</span>thing<span class="token operator">/</span>event<span class="token operator">/</span>property<span class="token operator">/</span>post
<span class="token punctuation">{<!-- --></span><span class="token string">"id"</span><span class="token operator">:</span><span class="token number">1709282051065</span><span class="token punctuation">,</span><span class="token string">"params"</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token string">"CO2"</span><span class="token operator">:</span><span class="token number">22</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">"version"</span><span class="token operator">:</span><span class="token string">"1.0"</span><span class="token punctuation">,</span><span class="token string">"method"</span><span class="token operator">:</span><span class="token string">"thing.event.property.post"</span><span class="token punctuation">}</span>



<span class="token punctuation">{<!-- --></span><span class="token string">"clientId"</span><span class="token operator">:</span><span class="token string">"k0ataNPqWKb.co2_data|securemode=2,signmethod=hmacsha256,timestamp=1709282577069|"</span><span class="token punctuation">,</span><span class="token string">"username"</span><span class="token operator">:</span><span class="token string">"co2_data&amp;k0ataNPqWKb"</span><span class="token punctuation">,</span><span class="token string">"mqttHostUrl"</span><span class="token operator">:</span><span class="token string">"iot-06z00ap0vwcjswq.mqtt.iothub.aliyuncs.com"</span><span class="token punctuation">,</span><span class="token string">"passwd"</span><span class="token operator">:</span><span class="token string">"40aeb4ae2a9a8d191a94bbabfbae0d2975ce0f056e263f22bee0148849f415b7"</span><span class="token punctuation">,</span><span class="token string">"port"</span><span class="token operator">:</span><span class="token number">1883</span><span class="token punctuation">}</span>

URL：<span class="token string">"iot-06z00ap0vwcjswq.mqtt.iothub.aliyuncs.com"</span>
CLENT_ID：<span class="token string">"k0ataNPqWKb.co2_data|securemode=2,signmethod=hmacsha256,timestamp=1709282577069|"</span>
USERNAME：<span class="token string">"co2_data&amp;k0ataNPqWKb"</span>
PASSWD：<span class="token string">"40aeb4ae2a9a8d191a94bbabfbae0d2975ce0f056e263f22bee0148849f415b7"</span>
PORT：<span class="token number">1883</span>
DATA_TOPIC：<span class="token string">"/sys/k0ataNPqWKb/co2_data/thing/event/property/post"</span>
CO2_DATA：<span class="token punctuation">{<!-- --></span><span class="token string">"id"</span><span class="token operator">:</span><span class="token number">1709282051065</span><span class="token punctuation">,</span><span class="token string">"params"</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token string">"CO2"</span><span class="token operator">:</span><span class="token operator">%</span>d<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">"version"</span><span class="token operator">:</span><span class="token string">"1.0"</span><span class="token punctuation">,</span><span class="token string">"method"</span><span class="token operator">:</span><span class="token string">"thing.event.property.post"</span><span class="token punctuation">}</span><span class="token comment">/*注意"CO2"后面的要填%d*/</span>

</code></pre>
    <p>
     好嘞，填好之后就修改下一个文件吧（但是使用完，下面的文件一定要再修改回去，要不然其它的demo就能用了）
    </p>
    <p>
     修改bl_uart.c文件
     <br/>
     <img alt="图五" src="https://i-blog.csdnimg.cn/blog_migrate/3263b9d3f50186fe6e6db1652a66c3d5.png"/>
     <br/>
     代码如下：
    </p>
    <pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">BL602_USE_HAL_DRIVER</span></span>
<span class="token keyword">void</span> <span class="token function">UART0_IRQHandler</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">uart_generic_notify_handler</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token number">0</span></span></span>
<span class="token keyword">void</span> <span class="token function">UART1_IRQHandler</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">uart_generic_notify_handler</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
</code></pre>
    <p>
     然后就要开始编译了
    </p>
    <h2>
     <a id="_114">
     </a>
     三、编译
    </h2>
    <h3>
     <a id="_co2_115">
     </a>
     第一步 进入co2目录
    </h3>
    <p>
     cd ~/Ai-Thinker-WB2/applications/peripherals/co2/
     <br/>
     <img alt="图一" src="https://i-blog.csdnimg.cn/blog_migrate/c3abdce0b58d9e4a27303f315a52bee3.png"/>
    </p>
    <h3>
     <a id="__119">
     </a>
     第二步 进行编译
    </h3>
    <p>
     make -j8
     <br/>
     <img alt="图二" src="https://i-blog.csdnimg.cn/blog_migrate/68e80710ea6fa8b2ed5fc5318b4a6772.png"/>
     <br/>
     <img alt="图三" src="https://i-blog.csdnimg.cn/blog_migrate/c92cc3338b3bc5ee9211ca7b677ad7a0.png"/>
    </p>
    <h2>
     <a id="_123">
     </a>
     四、烧录
    </h2>
    <p>
     可以参考下面的链接的烧录过程：
     <br/>
     <a href="https://blog.csdn.net/qq_54193285/article/details/136372810?spm=1001.2014.3001.5501">
      https://blog.csdn.net/qq_54193285/article/details/136372810?spm=1001.2014.3001.5501
     </a>
     <br/>
     <code>
      注意：只不过选择的firmware文件不一样，需要选择co2文件的路径
     </code>
     <br/>
     <img alt="图一" src="https://i-blog.csdnimg.cn/blog_migrate/208f57ce7c2c4656ed9e1599a733aac0.png"/>
     <br/>
     <img alt="图二" src="https://i-blog.csdnimg.cn/blog_migrate/15ffc9c58a3369a367c76006735d29cc.png"/>
     <br/>
     <code>
      其它过程皆一样
     </code>
    </p>
    <h2>
     <a id="_130">
     </a>
     五、演示
    </h2>
    <h2>
     <a id="__131">
     </a>
     第一步 打开串口调试助手并开始打开串口
    </h2>
    <p>
     <img alt="图一" src="https://i-blog.csdnimg.cn/blog_migrate/f75c1d689be72de0c128e02ebd39ed00.png"/>
     <br/>
     <img alt="图二" src="https://i-blog.csdnimg.cn/blog_migrate/847c31fed4b20af34359f3820b0bc42f.png"/>
    </p>
    <h3>
     <a id="__134">
     </a>
     第二步 将传感器与模组相连
    </h3>
    <p>
     传感器 模组
     <br/>
     A IO4
     <br/>
     B IO3
     <br/>
     +5V +5V
     <br/>
     GND GND
    </p>
    <p>
     <img alt="图三" src="https://i-blog.csdnimg.cn/blog_migrate/939d26fba09132dab1b4c8d165e3d559.png"/>
    </p>
    <h3>
     <a id="__142">
     </a>
     第三步 按下模组的复位键开始执行
    </h3>
    <p>
     <img alt="图四" src="https://i-blog.csdnimg.cn/blog_migrate/325f874cb1840c739cf128a9a0886319.png"/>
    </p>
    <h3>
     <a id="__144">
     </a>
     第四步 成果
    </h3>
    <p>
     <code>
      注意：模组需要预热一段时间才有数据
     </code>
     <br/>
     <img alt="图五" src="https://i-blog.csdnimg.cn/blog_migrate/559094026ef83a32de40bfac64ac87ed.png"/>
     <br/>
     <img alt="图六" src="https://i-blog.csdnimg.cn/blog_migrate/e1d35c6fa427dccf35b3e32af754f5fe.png"/>
     <br/>
     <img alt="图七" src="https://i-blog.csdnimg.cn/blog_migrate/8e6010952d39fcd04a9a39df65d0f854.png"/>
     <br/>
     <img alt="图八" src="https://i-blog.csdnimg.cn/blog_migrate/605f8cb23323cfc2fef022fed689ad67.png"/>
    </p>
    <h2>
     <a id="_160">
     </a>
     总结
    </h2>
    <p>
     千万不要忘了把bl_uart.c文件修改回去哦！！！
     <br/>
     有什么问题可以私信博主！
     <br/>
     以上就是本期分享的内容，这里使用的传感器为JW-CO2-V2.2（模拟二氧化碳检测模块），云平台是阿里云物联网平台，更多资料可从安信可官网上获取。
    </p>
    <p>
     官方官网：
     <a href="https://www.ai-thinker.com" rel="nofollow">
      https://www.ai-thinker.com
     </a>
     <br/>
     开发资料：
     <a href="https://docs.ai-thinker.com/" rel="nofollow">
      https://docs.ai-thinker.com/
     </a>
     <br/>
     官方论坛：
     <a href="http://bbs.ai-thinker.com" rel="nofollow">
      http://bbs.ai-thinker.com
     </a>
     <br/>
     技术支持：support@aithinker.com
    </p>
   </div>
   <link href="./../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="./../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f35343139333238352f:61727469636c652f64657461696c732f313336333937383636" class_="artid" style="display:none">
 </p>
</div>


