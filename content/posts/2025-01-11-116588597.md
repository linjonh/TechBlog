---
layout: post
title: "ExcelVBA编程入门一"
date: 2025-01-11 17:27:23 +0800
description: "Excel:VBA编程入门打开Excel中的VBA编程界面写一个简单的VBA程序打开Excel中的V"
keywords: "excel编程"
categories: ['Vba']
tags: ['Excel']
artid: "116588597"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=116588597
    alt: "ExcelVBA编程入门一"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=116588597
featuredImagePreview: https://bing.ee123.net/img/rand?artid=116588597
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Excel：VBA编程入门（一）
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <div class="toc">
     <h4>
      Excel:VBA编程入门
     </h4>
     <ul>
      <li>
       <a href="#ExcelVBA_1" rel="nofollow">
        打开Excel中的VBA编程界面
       </a>
      </li>
      <li>
       <a href="#VBA_11" rel="nofollow">
        写一个简单的VBA程序
       </a>
      </li>
     </ul>
    </div>
    <p>
    </p>
    <h2>
     <a id="ExcelVBA_1">
     </a>
     打开Excel中的VBA编程界面
    </h2>
    <p>
     首先打开Excel，在菜单栏的开发工具中打开Visual Basic，如下图：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/8899fb56d2f91ba467a791f13690db48.png">
      <br/>
      如果在菜单栏上没有找到开发工具，那就应该先从文件处显示隐藏的开发工具。如下图所示：
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/f575c272f3c6cc32a3a4a4dfbd421f4d.png">
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/d63f89441d19c90dc80a451271da4fde.png">
        <br/>
        <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/50d8301e3eec0b2bb65c879bd39517b0.png">
         <br/>
         这样就可以打开了。
         <br/>
         打开的VBA界面是这样的：
         <br/>
         <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/d61b206ef52e7610eb9ec6915e66d80b.png"/>
        </img>
       </img>
      </img>
     </img>
    </p>
    <h2>
     <a id="VBA_11">
     </a>
     写一个简单的VBA程序
    </h2>
    <p>
     首先打开了Visual Basic 的页面，在页面左侧的代码编辑处上方有两个下拉选框，如下图，左侧的下拉框代表工作对象，右边的下拉框代表函数方法。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/2aae225f79b8d9fb0c6c004f281011b6.png">
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/e23fc650366224cda663bf1a4b159fd4.png">
       <br/>
       来解释一下这边的下拉选择都代表什么含义
      </img>
     </img>
    </p>
    <table>
     <thead>
      <tr>
       <th>
        函数
       </th>
       <th>
        说明
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <strong>
         Activate
        </strong>
       </td>
       <td>
        激活
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         BeforeDelete
        </strong>
       </td>
       <td>
        在工作表被删除之前，发生此事件。
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         BeforeDoubleClick
        </strong>
       </td>
       <td>
        当双击工作表时，发生此事件
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         BeforeRightClick
        </strong>
       </td>
       <td>
        右键单击工作表时发生此事件
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         Calculate
        </strong>
       </td>
       <td>
        在对工作表对象重新计算后，发生此事件
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         Change
        </strong>
       </td>
       <td>
        当用户更改工作表中的单元格，或外部链接引起单元格的更改时，发生此事件
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         Deactivate
        </strong>
       </td>
       <td>
        图表、工作表或工作簿被停用时发生此事件
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         FollowHyperLink
        </strong>
       </td>
       <td>
        当选择工作表上的任何超链接时发生此事件
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         LensGalleryRenderComplete
        </strong>
       </td>
       <td>
        在标注库中的图标（动态和静态）已完成呈现时发生。
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         PivotTableAfterValueChange
        </strong>
       </td>
       <td>
        在编辑或重新计算（对与包含公式的单元格）数据透视表中的单元格或单元格区域后发生。
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         PivotTableBeforeAllocateChanges
        </strong>
       </td>
       <td>
        在将更改应用到数据透视表前发生。
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         PivotTableBeforeCommitChanges
        </strong>
       </td>
       <td>
        在向数据透视表的OLAP数据源提交更改之前发生
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         PivotTableBrforeDiscardChanges
        </strong>
       </td>
       <td>
        在放弃对数据透视表所做的更改之前发生
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         PivotTableChangeSync
        </strong>
       </td>
       <td>
        在更改了数据透视表之后发生
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         PivotTableUpdate
        </strong>
       </td>
       <td>
        工作簿中的数据透视表更新后发生此事件
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         selectionChange
        </strong>
       </td>
       <td>
        当工作表上的选定区域发生改变时发生此事件。
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         TableUpdate
        </strong>
       </td>
       <td>
        在工作表上更新了连接到数据模型的查询表之后，发生此事件。
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     上述函数可以根据自己的现实场景需求去使用。
    </p>
    <p>
     更具体函数信息可以去官网看，贴地址：
     <a href="https://docs.microsoft.com/zh-cn/office/vba/api/excel.worksheet.activate%28even%29" rel="nofollow">
      https://docs.microsoft.com/zh-cn/office/vba/api/excel.worksheet.activate(even)
     </a>
    </p>
    <p>
     那接着来写第一个简单的VBA程序
     <br/>
     首先本文新建了一个表，填了一些数据，如下：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/5734095b2cece3092652a968171c50e1.png">
      <br/>
      然后再Visual Basia里用代码操作这个表。
      <br/>
      打开
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/f71bd7215a55aafc30aa8abaf1428923.png"/>
      <br/>
      选择双击触发的函数，在里面敲入代码，即下图中黄色圈中的部分。
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/d5b442adf029740a88d23fea32638667.png"/>
     </img>
    </p>
    <pre><code class="prism language-sql">Private Sub Worksheet_BeforeDoubleClick<span class="token punctuation">(</span>ByVal Target <span class="token keyword">As</span> Range<span class="token punctuation">,</span> Cancel <span class="token keyword">As</span> <span class="token keyword">Boolean</span><span class="token punctuation">)</span><span class="token operator">/</span>
    Sheet1<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">=</span> Sheet1<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span>
    Sheet1<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">=</span> Sheet1<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span>
    Sheet1<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">=</span> Sheet1<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span>
    Sheet1<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">=</span> Sheet1<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span>
    Sheet1<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">=</span> Sheet1<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">50</span>
<span class="token keyword">End</span> Sub
</code></pre>
    <blockquote>
     <p>
      End Sub代表函数结束
     </p>
    </blockquote>
    <p>
     编辑完后
     <strong>
      ctrl+s
     </strong>
     保存。
    </p>
    <p>
     在单元格内双击即可看到代码执行结果。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/d065ee8dd5ae362091093483abebd42a.gif#pic_center"/>
    </p>
    <p>
     以上。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f6c69616e677a6978782f:61727469636c652f64657461696c732f313136353838353937" class_="artid" style="display:none">
 </p>
</div>


