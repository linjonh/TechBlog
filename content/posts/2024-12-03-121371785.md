---
layout: post
title: "python-如何实现数据库的连接"
date: 2024-12-03 10:56:57 +0800
description: "python 如何实现数据库的连接记录一次phthon连接数据库的实例文章目录python 如何实现"
keywords: "python项目链接数据库的实现"
categories: ['原力计划']
tags: ['原力计划', 'Python', 'Mysql']
artid: "121371785"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=121371785
    alt: "python-如何实现数据库的连接"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=121371785
featuredImagePreview: https://bing.ee123.net/img/rand?artid=121371785
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     python 如何实现数据库的连接
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-tomorrow-night" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="python__0">
     </a>
     python 如何实现数据库的连接
    </h2>
    <p>
     <font color="#999AAA">
      记录一次phthon连接数据库的实例
     </font>
    </p>
    <hr color="#000000" size='1"'/>
    <font color="#999AAA">
    </font>
    <p>
    </p>
    <div class="toc">
     <h4>
      文章目录
     </h4>
     <ul>
      <li>
       <a href="#python__0" rel="nofollow">
        python 如何实现数据库的连接
       </a>
      </li>
      <li>
       <a href="#_15" rel="nofollow">
        一、源码
       </a>
      </li>
      <li>
       <a href="#_101" rel="nofollow">
        总结
       </a>
      </li>
     </ul>
    </div>
    <p>
    </p>
    <hr color="#000000" size='1"'/>
    <h2>
     <a id="_15">
     </a>
     一、源码
    </h2>
    <pre><code class="prism language-python"><span class="token keyword">import</span> pymysql
<span class="token keyword">import</span> re
<span class="token keyword">def</span> <span class="token function">connectdb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'连接到mysql服务器...'</span><span class="token punctuation">)</span>
    <span class="token comment"># 打开数据库连接</span>
    <span class="token comment"># 用户名:hp, 密码:Hp12345.,用户名和密码需要改成你自己的mysql用户名和密码，并且要创建数据库TESTDB，并在TESTDB数据库中创建好表Student</span>
    db <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">"****"</span><span class="token punctuation">,</span> user<span class="token operator">=</span><span class="token string">"*******"</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">"******r"</span><span class="token punctuation">,</span> database<span class="token operator">=</span><span class="token string">"*****"</span><span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'连接上了!'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> db
<span class="token comment"># 关闭数据连接</span>
<span class="token keyword">def</span> <span class="token function">closedb</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">:</span>
    db<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">getNumber</span><span class="token punctuation">(</span>db<span class="token punctuation">,</span>table<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 使用cursor()方法获取操作游标</span>
    cursor <span class="token operator">=</span> db<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sql <span class="token operator">=</span> <span class="token string">"SELECT count(*) FROM "</span><span class="token operator">+</span>table
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token comment"># 执行SQL语句</span>
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
        <span class="token comment"># 获取所有记录数量</span>
        num1 <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> row <span class="token keyword">in</span> num1<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>table<span class="token operator">+</span><span class="token string">"表数据量:"</span><span class="token punctuation">,</span>row<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"获取失败！"</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span>  row<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">getfjdcar_idtofoundvin</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 使用cursor()方法获取操作游标</span>
    cursor <span class="token operator">=</span> db<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sql <span class="token operator">=</span> <span class="token string">"SELECT jdcar_id FROM car_mt_wiper limit 0,10000 "</span>


    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token comment"># 执行SQL语句</span>
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
        <span class="token comment"># 获取所有记录列表</span>
        results <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token builtin">list</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> row <span class="token keyword">in</span> results<span class="token punctuation">:</span>
           jdcar_id  <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
           <span class="token builtin">list</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>foundvin<span class="token punctuation">(</span>db<span class="token punctuation">,</span>jdcar_id<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"数据获取失败！"</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token builtin">list</span>
<span class="token comment"># 得到vin</span>
<span class="token keyword">def</span> <span class="token function">foundvin</span><span class="token punctuation">(</span>db<span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 使用cursor()方法获取操作游标</span>
    cursor <span class="token operator">=</span> db<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sql <span class="token operator">=</span> <span class="token string">"SELECT vin FROM jd_car_vin where jdcar_id="</span><span class="token operator">+</span><span class="token builtin">str</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token comment"># 执行SQL语句</span>
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
        <span class="token comment"># 获取所有记录列表</span>
        results <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> row <span class="token keyword">in</span> results<span class="token punctuation">:</span>
           <span class="token keyword">return</span> row<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"vin获取失败!"</span><span class="token punctuation">)</span>



<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    db <span class="token operator">=</span> connectdb<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># 连接MySQL数据库</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>getNumber<span class="token punctuation">(</span>db<span class="token punctuation">,</span><span class="token string">"jd_car_vin"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> getfjdcar_idtofoundvin<span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    closedb<span class="token punctuation">(</span>db<span class="token punctuation">)</span>         <span class="token comment"># 关闭数据库</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre>
    <pre><code>
</code></pre>
    <h2>
     <a id="_101">
     </a>
     总结
    </h2>
    <font color="#999AAA">
     拿来即用，拿走不谢！
    </font>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f494c4f56454d59444541522f:61727469636c652f64657461696c732f313231333731373835" class_="artid" style="display:none">
 </p>
</div>


