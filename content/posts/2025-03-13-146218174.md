---
layout: post
title: "办公常用自动化工具"
date: 2025-03-13 00:01:44 +0800
description: "是一个用于批量重命名文件的工具，可以根据自定义规则为文件重命名，支持按日期、序号、原文件名等格式进行命名。提供Excel文件的自动化处理功能，包括数据分析、格式化和报表生成。实现了邮件的自动发送功能，支持HTML模板、动态数据和文件附件。实现了企业微信消息的监控和自动回复功能，可用于工作流程自动化。"
keywords: "办公常用自动化工具"
categories: ['未分类']
tags: ['自动化', '网络', 'Python']
artid: "146218174"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146218174
    alt: "办公常用自动化工具"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146218174
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146218174
cover: https://bing.ee123.net/img/rand?artid=146218174
image: https://bing.ee123.net/img/rand?artid=146218174
img: https://bing.ee123.net/img/rand?artid=146218174
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     办公常用自动化工具
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="_0">
     </a>
     自动化办公工具说明文档
    </h2>
    <p>
     <strong>
      代码全部在底部。
     </strong>
    </p>
    <h3>
     <a id="_file_renamerpy_3">
     </a>
     文件批量重命名工具 (file_renamer.py)
    </h3>
    <h4>
     <a id="_5">
     </a>
     功能概述
    </h4>
    <p>
     <code>
      file_renamer.py
     </code>
     是一个用于批量重命名文件的工具，可以根据自定义规则为文件重命名，支持按日期、序号、原文件名等格式进行命名。
    </p>
    <h4>
     <a id="_8">
     </a>
     主要功能
    </h4>
    <ul>
     <li>
      支持按文件类型过滤（只处理特定扩展名文件）
     </li>
     <li>
      支持添加日期前缀
     </li>
     <li>
      防止文件名重复（自动添加序号后缀）
     </li>
     <li>
      自定义命名模式，支持多种变量替换
     </li>
    </ul>
    <h4>
     <a id="_14">
     </a>
     使用流程图
    </h4>
    <div class="mermaid">
     <svg class="mermaid-svg" height="1965.5" id="mermaid-svg-uDFfSE26i6QEpXdY" viewbox="0 0 410.40625 1965.5" width="410.40625" xmlns="http://www.w3.org/2000/svg">
      <style>
       #mermaid-svg-uDFfSE26i6QEpXdY {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-svg-uDFfSE26i6QEpXdY .error-icon{fill:#552222;}#mermaid-svg-uDFfSE26i6QEpXdY .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-uDFfSE26i6QEpXdY .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-uDFfSE26i6QEpXdY .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-uDFfSE26i6QEpXdY .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-uDFfSE26i6QEpXdY .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-uDFfSE26i6QEpXdY .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-uDFfSE26i6QEpXdY .marker{fill:#333333;stroke:#333333;}#mermaid-svg-uDFfSE26i6QEpXdY .marker.cross{stroke:#333333;}#mermaid-svg-uDFfSE26i6QEpXdY svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-uDFfSE26i6QEpXdY .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-svg-uDFfSE26i6QEpXdY .cluster-label text{fill:#333;}#mermaid-svg-uDFfSE26i6QEpXdY .cluster-label span{color:#333;}#mermaid-svg-uDFfSE26i6QEpXdY .label text,#mermaid-svg-uDFfSE26i6QEpXdY span{fill:#333;color:#333;}#mermaid-svg-uDFfSE26i6QEpXdY .node rect,#mermaid-svg-uDFfSE26i6QEpXdY .node circle,#mermaid-svg-uDFfSE26i6QEpXdY .node ellipse,#mermaid-svg-uDFfSE26i6QEpXdY .node polygon,#mermaid-svg-uDFfSE26i6QEpXdY .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg-uDFfSE26i6QEpXdY .node .label{text-align:center;}#mermaid-svg-uDFfSE26i6QEpXdY .node.clickable{cursor:pointer;}#mermaid-svg-uDFfSE26i6QEpXdY .arrowheadPath{fill:#333333;}#mermaid-svg-uDFfSE26i6QEpXdY .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-svg-uDFfSE26i6QEpXdY .flowchart-link{stroke:#333333;fill:none;}#mermaid-svg-uDFfSE26i6QEpXdY .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-svg-uDFfSE26i6QEpXdY .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-svg-uDFfSE26i6QEpXdY .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-svg-uDFfSE26i6QEpXdY .cluster text{fill:#333;}#mermaid-svg-uDFfSE26i6QEpXdY .cluster span{color:#333;}#mermaid-svg-uDFfSE26i6QEpXdY div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-uDFfSE26i6QEpXdY :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}
      </style>
      <g transform="translate(0, 0)">
       <marker class="marker flowchart" id="flowchart-pointEnd" markerheight="12" markerunits="userSpaceOnUse" markerwidth="12" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
        <path class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
        </path>
       </marker>
       <marker class="marker flowchart" id="flowchart-pointStart" markerheight="12" markerunits="userSpaceOnUse" markerwidth="12" orient="auto" refx="0" refy="5" viewbox="0 0 10 10">
        <path class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
        </path>
       </marker>
       <marker class="marker flowchart" id="flowchart-circleEnd" markerheight="11" markerunits="userSpaceOnUse" markerwidth="11" orient="auto" refx="11" refy="5" viewbox="0 0 10 10">
        <circle class="arrowMarkerPath" cx="5" cy="5" r="5" style="stroke-width: 1; stroke-dasharray: 1, 0;">
        </circle>
       </marker>
       <marker class="marker flowchart" id="flowchart-circleStart" markerheight="11" markerunits="userSpaceOnUse" markerwidth="11" orient="auto" refx="-1" refy="5" viewbox="0 0 10 10">
        <circle class="arrowMarkerPath" cx="5" cy="5" r="5" style="stroke-width: 1; stroke-dasharray: 1, 0;">
        </circle>
       </marker>
       <marker class="marker cross flowchart" id="flowchart-crossEnd" markerheight="11" markerunits="userSpaceOnUse" markerwidth="11" orient="auto" refx="12" refy="5.2" viewbox="0 0 11 11">
        <path class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9" style="stroke-width: 2; stroke-dasharray: 1, 0;">
        </path>
       </marker>
       <marker class="marker cross flowchart" id="flowchart-crossStart" markerheight="11" markerunits="userSpaceOnUse" markerwidth="11" orient="auto" refx="-1" refy="5.2" viewbox="0 0 11 11">
        <path class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9" style="stroke-width: 2; stroke-dasharray: 1, 0;">
        </path>
       </marker>
       <g class="root">
        <g class="clusters">
        </g>
        <g class="edgePaths">
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-B" d="M230.96875,49L230.96875,53.166666666666664C230.96875,57.333333333333336,230.96875,65.66666666666667,230.96875,74C230.96875,82.33333333333333,230.96875,90.66666666666667,230.96875,94.83333333333333L230.96875,99" id="L-A-B-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-C" d="M230.96875,140L230.96875,144.16666666666666C230.96875,148.33333333333334,230.96875,156.66666666666666,231.05208333333334,165.08333333333334C231.13541666666666,173.5,231.30208333333334,182,231.38541666666666,186.25L231.46875,190.5" id="L-B-C-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-D" d="M190.679593373494,355.58584337349396L181.97778614457832,368.63403614457826C173.27597891566265,381.6822289156626,155.8723644578313,407.7786144578313,147.17055722891567,427.16014056224896C138.46875,446.5416666666667,138.46875,459.2083333333333,138.46875,465.5416666666667L138.46875,471.875" id="L-C-D-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-E" d="M272.25790662650604,355.58584337349396L280.79304718875505,368.63403614457826C289.328187751004,381.6822289156626,306.39846887550203,407.7786144578313,314.93360943775104,427.16014056224896C323.46875,446.5416666666667,323.46875,459.2083333333333,323.46875,465.5416666666667L323.46875,471.875" id="L-C-E-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-D LE-F" d="M138.46875,512.875L138.46875,517.0416666666666C138.46875,521.2083333333334,138.46875,529.5416666666666,147.30208333333334,538.0533783783784C156.13541666666666,546.56509009009,173.80208333333334,555.2551801801802,182.63541666666666,559.6002252252252L191.46875,563.9452702702703" id="L-D-F-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-E LE-F" d="M323.46875,512.875L323.46875,517.0416666666666C323.46875,521.2083333333334,323.46875,529.5416666666666,314.6354166666667,538.0533783783784C305.8020833333333,546.56509009009,288.1354166666667,555.2551801801802,279.3020833333333,559.6002252252252L270.46875,563.9452702702703" id="L-E-F-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-F LE-G" d="M230.96875,603.875L230.96875,608.0416666666666C230.96875,612.2083333333334,230.96875,620.5416666666666,230.96875,628.875C230.96875,637.2083333333334,230.96875,645.5416666666666,230.96875,649.7083333333334L230.96875,653.875" id="L-F-G-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-G LE-H" d="M177.9165521978022,694.875L167.13358516483515,699.0416666666666C156.35061813186812,703.2083333333334,134.78468406593404,711.5416666666666,124.00171703296702,719.875C113.21875,728.2083333333334,113.21875,736.5416666666666,113.21875,740.7083333333334L113.21875,744.875" id="L-G-H-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-H LE-I" d="M113.21875,785.875L113.21875,790.0416666666666C113.21875,794.2083333333334,113.21875,802.5416666666666,113.30208333333333,810.9583333333334C113.38541666666667,819.375,113.55208333333333,827.875,113.63541666666667,832.125L113.71875,836.375" id="L-H-I-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-I LE-J" d="M87.87690868263473,1000.4081586826347L83.81409056886228,1010.9651322355289C79.75127245508982,1021.5221057884231,71.62563622754492,1042.6360528942116,67.56281811377245,1059.5263597804392C63.5,1076.4166666666667,63.5,1089.0833333333333,63.5,1095.4166666666667L63.5,1101.75" id="L-I-J-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-I LE-K" d="M158.61732979184737,981.3514202081526L170.9311081598728,995.0845168401271C183.24488652789827,1008.8176134721017,207.87244326394912,1036.2838067360508,220.18622163197458,1056.3502367013587C232.5,1076.4166666666667,232.5,1089.0833333333333,232.5,1095.4166666666667L232.5,1101.75" id="L-I-K-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-J LE-L" d="M63.5,1142.75L63.5,1149.0833333333333C63.5,1155.4166666666667,63.5,1168.0833333333333,68.8826566951567,1180.75C74.2653133903134,1193.4166666666667,85.03062678062678,1206.0833333333333,90.41328347578347,1212.4166666666667L95.79594017094017,1218.75" id="L-J-L-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-K LE-L" d="M232.5,1142.75L232.5,1149.0833333333333C232.5,1155.4166666666667,232.5,1168.0833333333333,219.5863603988604,1180.75C206.67272079772079,1193.4166666666667,180.84544159544157,1206.0833333333333,167.931801994302,1212.4166666666667L155.01816239316238,1218.75" id="L-K-L-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-L LE-M" d="M113.21875,1259.75L113.21875,1263.9166666666667C113.21875,1268.0833333333333,113.21875,1276.4166666666667,113.30208333333333,1284.8333333333333C113.38541666666667,1293.25,113.55208333333333,1301.75,113.63541666666667,1306L113.71875,1310.25" id="L-L-M-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-M LE-N" d="M95.65293647166362,1498.0591864716637L93.5805720597197,1507.320155393053C91.50820764777575,1516.5811243144424,87.36347882388787,1535.103062157221,85.29111441194394,1550.6973644119437C83.21875,1566.2916666666667,83.21875,1578.9583333333333,83.21875,1585.2916666666667L83.21875,1591.625" id="L-M-N-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-M LE-O" d="M167.6332167370644,1462.2105332629355L184.397472280887,1477.446277719113C201.1617278247096,1492.6820221752903,234.69023891235483,1523.153511087645,251.4544944561774,1544.722588877156C268.21875,1566.2916666666667,268.21875,1578.9583333333333,268.21875,1585.2916666666667L268.21875,1591.625" id="L-M-O-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-N LE-M" d="M93.73157051282051,1591.625L96.97943376068376,1585.2916666666667C100.227297008547,1578.9583333333333,106.7230235042735,1566.2916666666667,110.05422008547009,1553.7083333333333C113.38541666666667,1541.125,113.55208333333333,1528.625,113.63541666666667,1522.375L113.71875,1516.125" id="L-N-M-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-O LE-P" d="M268.21875,1632.625L268.21875,1636.7916666666667C268.21875,1640.9583333333333,268.21875,1649.2916666666667,272.9442113270514,1662.2745386729484C277.66967265410284,1675.2574106792306,287.12059530820574,1692.889821358461,291.8460566352571,1701.7060266980761L296.5715179623086,1710.5222320376913" id="L-O-P-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-P LE-G" d="M340.3654865412101,1699.5217365412102L342.0910304510084,1692.5389471176752C343.8165743608067,1685.55615769414,347.2676621804033,1671.59057884707,348.9932060902017,1657.0244560902017C350.71875,1642.4583333333333,350.71875,1627.2916666666667,350.71875,1609.9583333333333C350.71875,1592.625,350.71875,1573.125,350.71875,1539.8854166666667C350.71875,1506.6458333333333,350.71875,1459.6666666666667,350.71875,1414.8541666666667C350.71875,1370.0416666666667,350.71875,1327.3958333333333,350.71875,1298.4895833333333C350.71875,1269.5833333333333,350.71875,1254.4166666666667,350.71875,1237.0833333333333C350.71875,1219.75,350.71875,1200.25,350.71875,1180.75C350.71875,1161.25,350.71875,1141.75,350.71875,1122.25C350.71875,1102.75,350.71875,1083.25,350.71875,1051.34375C350.71875,1019.4375,350.71875,975.125,350.71875,932.9791666666666C350.71875,890.8333333333334,350.71875,850.8541666666666,350.71875,823.28125C350.71875,795.7083333333334,350.71875,780.5416666666666,350.71875,765.375C350.71875,750.2083333333334,350.71875,735.0416666666666,339.7526327838828,723.2916666666666C328.78651556776555,711.5416666666666,306.85428113553115,703.2083333333334,295.8881639194139,699.0416666666666L284.9220467032967,694.875" id="L-P-G-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-P LE-Q" d="M323.96875,1841L323.8854166666667,1847.25C323.8020833333333,1853.5,323.6354166666667,1866,323.5520833333333,1878.5833333333333C323.46875,1891.1666666666667,323.46875,1903.8333333333333,323.46875,1910.1666666666667L323.46875,1916.5" id="L-P-Q-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
        </g>
        <g class="edgeLabels">
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" transform="translate(138.46875, 433.875)">
          <g class="label" transform="translate(-8, -13)">
           <foreignobject height="26" width="16">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
              是
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" transform="translate(323.46875, 433.875)">
          <g class="label" transform="translate(-8, -13)">
           <foreignobject height="26" width="16">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
              否
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" transform="translate(63.5, 1063.75)">
          <g class="label" transform="translate(-8, -13)">
           <foreignobject height="26" width="16">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
              是
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" transform="translate(232.5, 1063.75)">
          <g class="label" transform="translate(-8, -13)">
           <foreignobject height="26" width="16">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
              否
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" transform="translate(83.21875, 1553.625)">
          <g class="label" transform="translate(-8, -13)">
           <foreignobject height="26" width="16">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
              是
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" transform="translate(268.21875, 1553.625)">
          <g class="label" transform="translate(-8, -13)">
           <foreignobject height="26" width="16">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
              否
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" transform="translate(350.71875, 1180.75)">
          <g class="label" transform="translate(-8, -13)">
           <foreignobject height="26" width="16">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
              是
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" transform="translate(323.46875, 1878.5)">
          <g class="label" transform="translate(-8, -13)">
           <foreignobject height="26" width="16">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
              否
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
        </g>
        <g class="nodes">
         <g class="node default default" id="flowchart-A-2556" transform="translate(230.96875, 28.5)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="47" x="-23.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-16, -13)">
           <foreignobject height="26" width="32">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              开始
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-B-2557" transform="translate(230.96875, 119.5)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="175" x="-87.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-80, -13)">
           <foreignobject height="26" width="160">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              获取文件夹中所有文件
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-C-2559" transform="translate(230.96875, 292.9375)">
          <polygon class="label-container" points="102.9375,0 205.875,-102.9375 102.9375,-205.875 0,-102.9375" style="" transform="translate(-102.9375,102.9375)">
          </polygon>
          <g class="label" style="" transform="translate(-74.9375, -13)">
           <foreignobject height="26" width="149.875">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              是否有文件类型过滤?
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-D-2561" transform="translate(138.46875, 492.375)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="159" x="-79.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-72, -13)">
           <foreignobject height="26" width="144">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              只保留指定类型文件
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-E-2563" transform="translate(323.46875, 492.375)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="111" x="-55.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-48, -13)">
           <foreignobject height="26" width="96">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              保留所有文件
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-F-2565" transform="translate(230.96875, 583.375)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="79" x="-39.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-32, -13)">
           <foreignobject height="26" width="64">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              文件排序
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-G-2569" transform="translate(230.96875, 674.375)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="111" x="-55.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-48, -13)">
           <foreignobject height="26" width="96">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              遍历每个文件
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-H-2571" transform="translate(113.21875, 765.375)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="111" x="-55.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-48, -13)">
           <foreignobject height="26" width="96">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              构建新文件名
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-I-2573" transform="translate(113.21875, 930.8125)">
          <polygon class="label-container" points="94.9375,0 189.875,-94.9375 94.9375,-189.875 0,-94.9375" style="" transform="translate(-94.9375,94.9375)">
          </polygon>
          <g class="label" style="" transform="translate(-66.9375, -13)">
           <foreignobject height="26" width="133.875">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              是否添加日期前缀?
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-J-2575" transform="translate(63.5, 1122.25)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="111" x="-55.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-48, -13)">
           <foreignobject height="26" width="96">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              添加日期前缀
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-K-2577" transform="translate(232.5, 1122.25)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="127" x="-63.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-56, -13)">
           <foreignobject height="26" width="112">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              保持原新文件名
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-L-2579" transform="translate(113.21875, 1239.25)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="159" x="-79.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-72, -13)">
           <foreignobject height="26" width="144">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              确保文件名有扩展名
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-M-2583" transform="translate(113.21875, 1412.6875)">
          <polygon class="label-container" points="102.9375,0 205.875,-102.9375 102.9375,-205.875 0,-102.9375" style="" transform="translate(-102.9375,102.9375)">
          </polygon>
          <g class="label" style="" transform="translate(-74.9375, -13)">
           <foreignobject height="26" width="149.875">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              新文件名是否已存在?
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-N-2585" transform="translate(83.21875, 1612.125)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="111" x="-55.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-48, -13)">
           <foreignobject height="26" width="96">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              添加序号后缀
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-O-2587" transform="translate(268.21875, 1612.125)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="95" x="-47.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-40, -13)">
           <foreignobject height="26" width="80">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              执行重命名
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-P-2591" transform="translate(323.46875, 1761.5625)">
          <polygon class="label-container" points="78.9375,0 157.875,-78.9375 78.9375,-157.875 0,-78.9375" style="" transform="translate(-78.9375,78.9375)">
          </polygon>
          <g class="label" style="" transform="translate(-50.9375, -13)">
           <foreignobject height="26" width="101.875">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              是否还有文件?
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-Q-2595" transform="translate(323.46875, 1937)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="47" x="-23.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-16, -13)">
           <foreignobject height="26" width="32">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              结束
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
        </g>
       </g>
      </g>
     </svg>
    </div>
    <h4>
     <a id="_40">
     </a>
     使用示例
    </h4>
    <pre><code class="prism language-python"><span class="token comment"># 将图片文件重命名为"照片_20230601_001.jpg"格式</span>
batch_rename<span class="token punctuation">(</span>
    folder_path<span class="token operator">=</span><span class="token string">"D:/文档/图片"</span><span class="token punctuation">,</span>
    pattern<span class="token operator">=</span><span class="token string">"照片_{date}_{index}"</span><span class="token punctuation">,</span>
    file_types<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'.jpg'</span><span class="token punctuation">,</span> <span class="token string">'.png'</span><span class="token punctuation">,</span> <span class="token string">'.jpeg'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    add_date<span class="token operator">=</span><span class="token boolean">True</span>
<span class="token punctuation">)</span>
</code></pre>
    <h4>
     <a id="_51">
     </a>
     依赖项
    </h4>
    <ul>
     <li>
      os
     </li>
     <li>
      re
     </li>
     <li>
      datetime
     </li>
     <li>
      pathlib
     </li>
    </ul>
    <h3>
     <a id="Excel_excel_processorpy_57">
     </a>
     Excel自动处理工具 (excel_processor.py)
    </h3>
    <h4>
     <a id="_59">
     </a>
     功能概述
    </h4>
    <p>
     <code>
      excel_processor.py
     </code>
     提供Excel文件的自动化处理功能，包括数据分析、格式化和报表生成。
    </p>
    <h4>
     <a id="_62">
     </a>
     主要功能
    </h4>
    <ul>
     <li>
      读取Excel源文件数据
     </li>
     <li>
      执行数据计算和汇总
     </li>
     <li>
      生成新的Excel工作表
     </li>
     <li>
      应用专业的格式设置（字体、颜色、对齐方式）
     </li>
     <li>
      自动调整列宽
     </li>
    </ul>
    <h4>
     <a id="_69">
     </a>
     使用流程图
    </h4>
    <div class="mermaid">
     <svg class="mermaid-svg" height="1058" id="mermaid-svg-SO8Bh0Mc52Yv4CbJ" viewbox="0 0 191 1058" width="191" xmlns="http://www.w3.org/2000/svg">
      <style>
       #mermaid-svg-SO8Bh0Mc52Yv4CbJ {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ .error-icon{fill:#552222;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ .marker{fill:#333333;stroke:#333333;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ .marker.cross{stroke:#333333;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ .cluster-label text{fill:#333;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ .cluster-label span{color:#333;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ .label text,#mermaid-svg-SO8Bh0Mc52Yv4CbJ span{fill:#333;color:#333;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ .node rect,#mermaid-svg-SO8Bh0Mc52Yv4CbJ .node circle,#mermaid-svg-SO8Bh0Mc52Yv4CbJ .node ellipse,#mermaid-svg-SO8Bh0Mc52Yv4CbJ .node polygon,#mermaid-svg-SO8Bh0Mc52Yv4CbJ .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ .node .label{text-align:center;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ .node.clickable{cursor:pointer;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ .arrowheadPath{fill:#333333;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ .flowchart-link{stroke:#333333;fill:none;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ .cluster text{fill:#333;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ .cluster span{color:#333;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-SO8Bh0Mc52Yv4CbJ :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}
      </style>
      <g transform="translate(0, 0)">
       <marker class="marker flowchart" id="flowchart-pointEnd" markerheight="12" markerunits="userSpaceOnUse" markerwidth="12" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
        <path class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
        </path>
       </marker>
       <marker class="marker flowchart" id="flowchart-pointStart" markerheight="12" markerunits="userSpaceOnUse" markerwidth="12" orient="auto" refx="0" refy="5" viewbox="0 0 10 10">
        <path class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
        </path>
       </marker>
       <marker class="marker flowchart" id="flowchart-circleEnd" markerheight="11" markerunits="userSpaceOnUse" markerwidth="11" orient="auto" refx="11" refy="5" viewbox="0 0 10 10">
        <circle class="arrowMarkerPath" cx="5" cy="5" r="5" style="stroke-width: 1; stroke-dasharray: 1, 0;">
        </circle>
       </marker>
       <marker class="marker flowchart" id="flowchart-circleStart" markerheight="11" markerunits="userSpaceOnUse" markerwidth="11" orient="auto" refx="-1" refy="5" viewbox="0 0 10 10">
        <circle class="arrowMarkerPath" cx="5" cy="5" r="5" style="stroke-width: 1; stroke-dasharray: 1, 0;">
        </circle>
       </marker>
       <marker class="marker cross flowchart" id="flowchart-crossEnd" markerheight="11" markerunits="userSpaceOnUse" markerwidth="11" orient="auto" refx="12" refy="5.2" viewbox="0 0 11 11">
        <path class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9" style="stroke-width: 2; stroke-dasharray: 1, 0;">
        </path>
       </marker>
       <marker class="marker cross flowchart" id="flowchart-crossStart" markerheight="11" markerunits="userSpaceOnUse" markerwidth="11" orient="auto" refx="-1" refy="5.2" viewbox="0 0 11 11">
        <path class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9" style="stroke-width: 2; stroke-dasharray: 1, 0;">
        </path>
       </marker>
       <g class="root">
        <g class="clusters">
        </g>
        <g class="edgePaths">
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-B" d="M95.5,49L95.5,53.166666666666664C95.5,57.333333333333336,95.5,65.66666666666667,95.5,74C95.5,82.33333333333333,95.5,90.66666666666667,95.5,94.83333333333333L95.5,99" id="L-A-B-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-C" d="M95.5,140L95.5,144.16666666666666C95.5,148.33333333333334,95.5,156.66666666666666,95.5,165C95.5,173.33333333333334,95.5,181.66666666666666,95.5,185.83333333333334L95.5,190" id="L-B-C-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-D" d="M95.5,231L95.5,235.16666666666666C95.5,239.33333333333334,95.5,247.66666666666666,95.5,256C95.5,264.3333333333333,95.5,272.6666666666667,95.5,276.8333333333333L95.5,281" id="L-C-D-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-D LE-E" d="M95.5,322L95.5,326.1666666666667C95.5,330.3333333333333,95.5,338.6666666666667,95.5,347C95.5,355.3333333333333,95.5,363.6666666666667,95.5,367.8333333333333L95.5,372" id="L-D-E-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-E LE-F" d="M95.5,413L95.5,417.1666666666667C95.5,421.3333333333333,95.5,429.6666666666667,95.5,438C95.5,446.3333333333333,95.5,454.6666666666667,95.5,458.8333333333333L95.5,463" id="L-E-F-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-F LE-G" d="M95.5,504L95.5,508.1666666666667C95.5,512.3333333333334,95.5,520.6666666666666,95.5,529C95.5,537.3333333333334,95.5,545.6666666666666,95.5,549.8333333333334L95.5,554" id="L-F-G-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-G LE-H" d="M95.5,595L95.5,599.1666666666666C95.5,603.3333333333334,95.5,611.6666666666666,95.5,620C95.5,628.3333333333334,95.5,636.6666666666666,95.5,640.8333333333334L95.5,645" id="L-G-H-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-H LE-I" d="M95.5,686L95.5,690.1666666666666C95.5,694.3333333333334,95.5,702.6666666666666,95.5,711C95.5,719.3333333333334,95.5,727.6666666666666,95.5,731.8333333333334L95.5,736" id="L-H-I-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-I LE-J" d="M95.5,777L95.5,781.1666666666666C95.5,785.3333333333334,95.5,793.6666666666666,95.5,802C95.5,810.3333333333334,95.5,818.6666666666666,95.5,822.8333333333334L95.5,827" id="L-I-J-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-J LE-K" d="M95.5,868L95.5,872.1666666666666C95.5,876.3333333333334,95.5,884.6666666666666,95.5,893C95.5,901.3333333333334,95.5,909.6666666666666,95.5,913.8333333333334L95.5,918" id="L-J-K-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-K LE-L" d="M95.5,959L95.5,963.1666666666666C95.5,967.3333333333334,95.5,975.6666666666666,95.5,984C95.5,992.3333333333334,95.5,1000.6666666666666,95.5,1004.8333333333334L95.5,1009" id="L-K-L-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
        </g>
        <g class="edgeLabels">
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
        </g>
        <g class="nodes">
         <g class="node default default" id="flowchart-A-2618" transform="translate(95.5, 28.5)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="47" x="-23.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-16, -13)">
           <foreignobject height="26" width="32">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              开始
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-B-2619" transform="translate(95.5, 119.5)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="132.95833587646484" x="-66.47916793823242" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-58.97916793823242, -13)">
           <foreignobject height="26" width="117.95833587646484">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              读取源Excel数据
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-C-2621" transform="translate(95.5, 210.5)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="159" x="-79.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-72, -13)">
           <foreignobject height="26" width="144">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              执行数据处理和计算
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-D-2623" transform="translate(95.5, 301.5)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="148.95834350585938" x="-74.47917175292969" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-66.97917175292969, -13)">
           <foreignobject height="26" width="133.95834350585938">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              创建新Excel工作簿
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-E-2625" transform="translate(95.5, 392.5)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="127" x="-63.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-56, -13)">
           <foreignobject height="26" width="112">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              写入详细数据表
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-F-2627" transform="translate(95.5, 483.5)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="95" x="-47.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-40, -13)">
           <foreignobject height="26" width="80">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              写入汇总表
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-G-2629" transform="translate(95.5, 574.5)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="95" x="-47.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-40, -13)">
           <foreignobject height="26" width="80">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              格式化表格
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-H-2631" transform="translate(95.5, 665.5)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="175" x="-87.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-80, -13)">
           <foreignobject height="26" width="160">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              添加标题和合并单元格
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-I-2633" transform="translate(95.5, 756.5)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="111" x="-55.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-48, -13)">
           <foreignobject height="26" width="96">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              设置表头样式
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-J-2635" transform="translate(95.5, 847.5)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="79" x="-39.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-32, -13)">
           <foreignobject height="26" width="64">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              调整列宽
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-K-2637" transform="translate(95.5, 938.5)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="95" x="-47.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-40, -13)">
           <foreignobject height="26" width="80">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              保存工作簿
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-L-2639" transform="translate(95.5, 1029.5)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="47" x="-23.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-16, -13)">
           <foreignobject height="26" width="32">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              结束
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
        </g>
       </g>
      </g>
     </svg>
    </div>
    <h4>
     <a id="_86">
     </a>
     使用示例
    </h4>
    <pre><code class="prism language-python">generate_report<span class="token punctuation">(</span>
    source_file<span class="token operator">=</span><span class="token string">"销售数据.xlsx"</span><span class="token punctuation">,</span>
    output_file<span class="token operator">=</span><span class="token string">"销售报表.xlsx"</span><span class="token punctuation">,</span>
    report_title<span class="token operator">=</span><span class="token string">"2023年第一季度销售报表"</span>
<span class="token punctuation">)</span>
</code></pre>
    <h4>
     <a id="_95">
     </a>
     依赖项
    </h4>
    <ul>
     <li>
      pandas
     </li>
     <li>
      openpyxl
     </li>
     <li>
      datetime
     </li>
    </ul>
    <h3>
     <a id="_email_senderpy_100">
     </a>
     邮件自动发送工具 (email_sender.py)
    </h3>
    <h4>
     <a id="_102">
     </a>
     功能概述
    </h4>
    <p>
     <code>
      email_sender.py
     </code>
     实现了邮件的自动发送功能，支持HTML模板、动态数据和文件附件。
    </p>
    <h4>
     <a id="_105">
     </a>
     主要功能
    </h4>
    <ul>
     <li>
      使用HTML模板生成邮件内容
     </li>
     <li>
      支持动态数据渲染（使用Jinja2模板引擎）
     </li>
     <li>
      发送带附件的邮件
     </li>
     <li>
      支持多收件人
     </li>
     <li>
      使用环境变量存储敏感信息
     </li>
    </ul>
    <h4>
     <a id="_112">
     </a>
     使用流程图
    </h4>
    <div class="mermaid">
     <svg class="mermaid-svg" height="1366.875" id="mermaid-svg-cTSkCe4MMxrTXJv5" viewbox="0 0 223.859375 1366.875" width="223.859375" xmlns="http://www.w3.org/2000/svg">
      <style>
       #mermaid-svg-cTSkCe4MMxrTXJv5 {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-svg-cTSkCe4MMxrTXJv5 .error-icon{fill:#552222;}#mermaid-svg-cTSkCe4MMxrTXJv5 .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-cTSkCe4MMxrTXJv5 .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-cTSkCe4MMxrTXJv5 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-cTSkCe4MMxrTXJv5 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-cTSkCe4MMxrTXJv5 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-cTSkCe4MMxrTXJv5 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-cTSkCe4MMxrTXJv5 .marker{fill:#333333;stroke:#333333;}#mermaid-svg-cTSkCe4MMxrTXJv5 .marker.cross{stroke:#333333;}#mermaid-svg-cTSkCe4MMxrTXJv5 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-cTSkCe4MMxrTXJv5 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-svg-cTSkCe4MMxrTXJv5 .cluster-label text{fill:#333;}#mermaid-svg-cTSkCe4MMxrTXJv5 .cluster-label span{color:#333;}#mermaid-svg-cTSkCe4MMxrTXJv5 .label text,#mermaid-svg-cTSkCe4MMxrTXJv5 span{fill:#333;color:#333;}#mermaid-svg-cTSkCe4MMxrTXJv5 .node rect,#mermaid-svg-cTSkCe4MMxrTXJv5 .node circle,#mermaid-svg-cTSkCe4MMxrTXJv5 .node ellipse,#mermaid-svg-cTSkCe4MMxrTXJv5 .node polygon,#mermaid-svg-cTSkCe4MMxrTXJv5 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg-cTSkCe4MMxrTXJv5 .node .label{text-align:center;}#mermaid-svg-cTSkCe4MMxrTXJv5 .node.clickable{cursor:pointer;}#mermaid-svg-cTSkCe4MMxrTXJv5 .arrowheadPath{fill:#333333;}#mermaid-svg-cTSkCe4MMxrTXJv5 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-svg-cTSkCe4MMxrTXJv5 .flowchart-link{stroke:#333333;fill:none;}#mermaid-svg-cTSkCe4MMxrTXJv5 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-svg-cTSkCe4MMxrTXJv5 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-svg-cTSkCe4MMxrTXJv5 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-svg-cTSkCe4MMxrTXJv5 .cluster text{fill:#333;}#mermaid-svg-cTSkCe4MMxrTXJv5 .cluster span{color:#333;}#mermaid-svg-cTSkCe4MMxrTXJv5 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-cTSkCe4MMxrTXJv5 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}
      </style>
      <g transform="translate(0, 0)">
       <marker class="marker flowchart" id="flowchart-pointEnd" markerheight="12" markerunits="userSpaceOnUse" markerwidth="12" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
        <path class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
        </path>
       </marker>
       <marker class="marker flowchart" id="flowchart-pointStart" markerheight="12" markerunits="userSpaceOnUse" markerwidth="12" orient="auto" refx="0" refy="5" viewbox="0 0 10 10">
        <path class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
        </path>
       </marker>
       <marker class="marker flowchart" id="flowchart-circleEnd" markerheight="11" markerunits="userSpaceOnUse" markerwidth="11" orient="auto" refx="11" refy="5" viewbox="0 0 10 10">
        <circle class="arrowMarkerPath" cx="5" cy="5" r="5" style="stroke-width: 1; stroke-dasharray: 1, 0;">
        </circle>
       </marker>
       <marker class="marker flowchart" id="flowchart-circleStart" markerheight="11" markerunits="userSpaceOnUse" markerwidth="11" orient="auto" refx="-1" refy="5" viewbox="0 0 10 10">
        <circle class="arrowMarkerPath" cx="5" cy="5" r="5" style="stroke-width: 1; stroke-dasharray: 1, 0;">
        </circle>
       </marker>
       <marker class="marker cross flowchart" id="flowchart-crossEnd" markerheight="11" markerunits="userSpaceOnUse" markerwidth="11" orient="auto" refx="12" refy="5.2" viewbox="0 0 11 11">
        <path class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9" style="stroke-width: 2; stroke-dasharray: 1, 0;">
        </path>
       </marker>
       <marker class="marker cross flowchart" id="flowchart-crossStart" markerheight="11" markerunits="userSpaceOnUse" markerwidth="11" orient="auto" refx="-1" refy="5.2" viewbox="0 0 11 11">
        <path class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9" style="stroke-width: 2; stroke-dasharray: 1, 0;">
        </path>
       </marker>
       <g class="root">
        <g class="clusters">
        </g>
        <g class="edgePaths">
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-B" d="M99.109375,49L99.109375,53.166666666666664C99.109375,57.333333333333336,99.109375,65.66666666666667,99.109375,74C99.109375,82.33333333333333,99.109375,90.66666666666667,99.109375,94.83333333333333L99.109375,99" id="L-A-B-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-C" d="M99.109375,140L99.109375,144.16666666666666C99.109375,148.33333333333334,99.109375,156.66666666666666,99.109375,165C99.109375,173.33333333333334,99.109375,181.66666666666666,99.109375,185.83333333333334L99.109375,190" id="L-B-C-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-D" d="M99.109375,231L99.109375,235.16666666666666C99.109375,239.33333333333334,99.109375,247.66666666666666,99.109375,256C99.109375,264.3333333333333,99.109375,272.6666666666667,99.109375,276.8333333333333L99.109375,281" id="L-C-D-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-D LE-E" d="M99.109375,322L99.109375,326.1666666666667C99.109375,330.3333333333333,99.109375,338.6666666666667,99.109375,347C99.109375,355.3333333333333,99.109375,363.6666666666667,99.109375,367.8333333333333L99.109375,372" id="L-D-E-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-E LE-F" d="M99.109375,413L99.109375,417.1666666666667C99.109375,421.3333333333333,99.109375,429.6666666666667,99.109375,438C99.109375,446.3333333333333,99.109375,454.6666666666667,99.109375,458.8333333333333L99.109375,463" id="L-E-F-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-F LE-G" d="M99.109375,504L99.109375,508.1666666666667C99.109375,512.3333333333334,99.109375,520.6666666666666,99.109375,529C99.109375,537.3333333333334,99.109375,545.6666666666666,99.109375,549.8333333333334L99.109375,554" id="L-F-G-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-G LE-H" d="M99.109375,595L99.109375,599.1666666666666C99.109375,603.3333333333334,99.109375,611.6666666666666,99.109375,620C99.109375,628.3333333333334,99.109375,636.6666666666666,99.109375,640.8333333333334L99.109375,645" id="L-G-H-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-H LE-I" d="M99.109375,686L99.109375,690.1666666666666C99.109375,694.3333333333334,99.109375,702.6666666666666,99.19270833333333,711.0833333333334C99.27604166666667,719.5,99.44270833333333,728,99.52604166666667,732.25L99.609375,736.5" id="L-H-I-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-I LE-J" d="M122.89983742774567,855.0845375722544L127.80976035645472,865.2162813102119C132.71968328516377,875.3480250481695,142.53952914258187,895.6115125240848,147.44945207129095,912.0765895953758C152.359375,928.5416666666666,152.359375,941.2083333333334,152.359375,947.5416666666666L152.359375,953.875" id="L-I-J-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-I LE-K" d="M76.31891257225433,855.0845375722544L71.24232297687861,865.2162813102119C66.16573338150289,875.3480250481695,56.012554190751445,895.6115125240848,50.93596459537573,915.4932562620425C45.859375,935.375,45.859375,954.875,45.859375,972.2083333333334C45.859375,989.5416666666666,45.859375,1004.7083333333334,50.73574862637363,1016.4583333333334C55.61212225274725,1028.2083333333333,65.3648695054945,1036.5416666666667,70.24124313186813,1040.7083333333333L75.11761675824175,1044.875" id="L-I-K-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-J LE-K" d="M152.359375,994.875L152.359375,999.0416666666666C152.359375,1003.2083333333334,152.359375,1011.5416666666666,147.48300137362637,1019.875C142.60662774725276,1028.2083333333333,132.8538804945055,1036.5416666666667,127.97750686813187,1040.7083333333333L123.10113324175825,1044.875" id="L-J-K-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-K LE-L" d="M99.109375,1085.875L99.109375,1090.0416666666667C99.109375,1094.2083333333333,99.109375,1102.5416666666667,99.109375,1110.875C99.109375,1119.2083333333333,99.109375,1127.5416666666667,99.109375,1131.7083333333333L99.109375,1135.875" id="L-K-L-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-L LE-M" d="M99.109375,1176.875L99.109375,1181.0416666666667C99.109375,1185.2083333333333,99.109375,1193.5416666666667,99.109375,1201.875C99.109375,1210.2083333333333,99.109375,1218.5416666666667,99.109375,1222.7083333333333L99.109375,1226.875" id="L-L-M-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-M LE-N" d="M99.109375,1267.875L99.109375,1272.0416666666667C99.109375,1276.2083333333333,99.109375,1284.5416666666667,99.109375,1292.875C99.109375,1301.2083333333333,99.109375,1309.5416666666667,99.109375,1313.7083333333333L99.109375,1317.875" id="L-M-N-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
        </g>
        <g class="edgeLabels">
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" transform="translate(152.359375, 915.875)">
          <g class="label" transform="translate(-8, -13)">
           <foreignobject height="26" width="16">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
              是
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" transform="translate(45.859375, 974.375)">
          <g class="label" transform="translate(-8, -13)">
           <foreignobject height="26" width="16">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
              否
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel">
          <g class="label" transform="translate(0, 0)">
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
        </g>
        <g class="nodes">
         <g class="node default default" id="flowchart-A-2668" transform="translate(99.109375, 28.5)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="47" x="-23.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-16, -13)">
           <foreignobject height="26" width="32">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              开始
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-B-2669" transform="translate(99.109375, 119.5)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="111" x="-55.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-48, -13)">
           <foreignobject height="26" width="96">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              加载环境变量
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-C-2671" transform="translate(99.109375, 210.5)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="111" x="-55.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-48, -13)">
           <foreignobject height="26" width="96">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              创建邮件对象
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-D-2673" transform="translate(99.109375, 301.5)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="159" x="-79.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-72, -13)">
           <foreignobject height="26" width="144">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              设置发件人和收件人
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-E-2675" transform="translate(99.109375, 392.5)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="111" x="-55.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-48, -13)">
           <foreignobject height="26" width="96">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              设置邮件主题
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-F-2677" transform="translate(99.109375, 483.5)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="118.21875" x="-59.109375" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-51.609375, -13)">
           <foreignobject height="26" width="103.21875">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              加载HTML模板
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-G-2679" transform="translate(99.109375, 574.5)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="182.21875" x="-91.109375" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-83.609375, -13)">
           <foreignobject height="26" width="167.21875">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              使用模板数据渲染HTML
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-H-2681" transform="translate(99.109375, 665.5)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="166.21875" x="-83.109375" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-75.609375, -13)">
           <foreignobject height="26" width="151.21875">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              添加HTML内容到邮件
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-I-2683" transform="translate(99.109375, 806.9375)">
          <polygon class="label-container" points="70.9375,0 141.875,-70.9375 70.9375,-141.875 0,-70.9375" style="" transform="translate(-70.9375,70.9375)">
          </polygon>
          <g class="label" style="" transform="translate(-42.9375, -13)">
           <foreignobject height="26" width="85.875">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              是否有附件?
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-J-2685" transform="translate(152.359375, 974.375)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="127" x="-63.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-56, -13)">
           <foreignobject height="26" width="112">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              添加附件到邮件
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-K-2687" transform="translate(99.109375, 1065.375)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="132.2604217529297" x="-66.13021087646484" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-58.630210876464844, -13)">
           <foreignobject height="26" width="117.26042175292969">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              连接SMTP服务器
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-L-2691" transform="translate(99.109375, 1156.375)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="79" x="-39.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-32, -13)">
           <foreignobject height="26" width="64">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              发送邮件
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-M-2693" transform="translate(99.109375, 1247.375)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="79" x="-39.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-32, -13)">
           <foreignobject height="26" width="64">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              关闭连接
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-N-2695" transform="translate(99.109375, 1338.375)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="47" x="-23.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-16, -13)">
           <foreignobject height="26" width="32">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              结束
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
        </g>
       </g>
      </g>
     </svg>
    </div>
    <h4>
     <a id="_132">
     </a>
     使用示例
    </h4>
    <pre><code class="prism language-python">send_email_with_template<span class="token punctuation">(</span>
    to_addresses<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"收件人@example.com"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    subject<span class="token operator">=</span><span class="token string">"月度销售报告"</span><span class="token punctuation">,</span>
    template_file<span class="token operator">=</span><span class="token string">"templates/monthly_report.html"</span><span class="token punctuation">,</span>
    template_data<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
        <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"张经理"</span><span class="token punctuation">,</span>
        <span class="token string">"department"</span><span class="token punctuation">:</span> <span class="token string">"销售部"</span><span class="token punctuation">,</span>
        <span class="token string">"month"</span><span class="token punctuation">:</span> <span class="token string">"五月"</span><span class="token punctuation">,</span>
        <span class="token string">"sales"</span><span class="token punctuation">:</span> <span class="token number">125000</span><span class="token punctuation">,</span>
        <span class="token string">"target"</span><span class="token punctuation">:</span> <span class="token number">100000</span><span class="token punctuation">,</span>
        <span class="token string">"products"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"产品A"</span><span class="token punctuation">,</span> <span class="token string">"sales"</span><span class="token punctuation">:</span> <span class="token number">45000</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"产品B"</span><span class="token punctuation">,</span> <span class="token string">"sales"</span><span class="token punctuation">:</span> <span class="token number">30000</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"产品C"</span><span class="token punctuation">,</span> <span class="token string">"sales"</span><span class="token punctuation">:</span> <span class="token number">50000</span><span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    attachments<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"reports/sales_may.xlsx"</span><span class="token punctuation">,</span> <span class="token string">"reports/chart.pdf"</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span>
</code></pre>
    <h4>
     <a id="_154">
     </a>
     依赖项
    </h4>
    <ul>
     <li>
      smtplib
     </li>
     <li>
      email.mime
     </li>
     <li>
      jinja2
     </li>
     <li>
      python-dotenv
     </li>
    </ul>
    <h3>
     <a id="_wechat_monitorpy_160">
     </a>
     企业微信消息监控工具 (wechat_monitor.py)
    </h3>
    <h4>
     <a id="_162">
     </a>
     功能概述
    </h4>
    <p>
     <code>
      wechat_monitor.py
     </code>
     实现了企业微信消息的监控和自动回复功能，可用于工作流程自动化。
    </p>
    <h4>
     <a id="_165">
     </a>
     主要功能
    </h4>
    <ul>
     <li>
      接收企业微信消息回调
     </li>
     <li>
      根据关键词自动回复和处理消息
     </li>
     <li>
      转发特定消息给管理员
     </li>
     <li>
      调用外部功能（如报表生成）
     </li>
    </ul>
    <h4>
     <a id="_171">
     </a>
     使用流程图
    </h4>
    <div class="mermaid">
     <svg class="mermaid-svg" height="1621.2689208984375" id="mermaid-svg-rFcFWepdrJQ2JT6S" viewbox="0 0 674.2664184570312 1621.2689208984375" width="674.2664184570312" xmlns="http://www.w3.org/2000/svg">
      <style>
       #mermaid-svg-rFcFWepdrJQ2JT6S {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-svg-rFcFWepdrJQ2JT6S .error-icon{fill:#552222;}#mermaid-svg-rFcFWepdrJQ2JT6S .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-rFcFWepdrJQ2JT6S .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-rFcFWepdrJQ2JT6S .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-rFcFWepdrJQ2JT6S .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-rFcFWepdrJQ2JT6S .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-rFcFWepdrJQ2JT6S .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-rFcFWepdrJQ2JT6S .marker{fill:#333333;stroke:#333333;}#mermaid-svg-rFcFWepdrJQ2JT6S .marker.cross{stroke:#333333;}#mermaid-svg-rFcFWepdrJQ2JT6S svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-rFcFWepdrJQ2JT6S .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-svg-rFcFWepdrJQ2JT6S .cluster-label text{fill:#333;}#mermaid-svg-rFcFWepdrJQ2JT6S .cluster-label span{color:#333;}#mermaid-svg-rFcFWepdrJQ2JT6S .label text,#mermaid-svg-rFcFWepdrJQ2JT6S span{fill:#333;color:#333;}#mermaid-svg-rFcFWepdrJQ2JT6S .node rect,#mermaid-svg-rFcFWepdrJQ2JT6S .node circle,#mermaid-svg-rFcFWepdrJQ2JT6S .node ellipse,#mermaid-svg-rFcFWepdrJQ2JT6S .node polygon,#mermaid-svg-rFcFWepdrJQ2JT6S .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg-rFcFWepdrJQ2JT6S .node .label{text-align:center;}#mermaid-svg-rFcFWepdrJQ2JT6S .node.clickable{cursor:pointer;}#mermaid-svg-rFcFWepdrJQ2JT6S .arrowheadPath{fill:#333333;}#mermaid-svg-rFcFWepdrJQ2JT6S .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-svg-rFcFWepdrJQ2JT6S .flowchart-link{stroke:#333333;fill:none;}#mermaid-svg-rFcFWepdrJQ2JT6S .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-svg-rFcFWepdrJQ2JT6S .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-svg-rFcFWepdrJQ2JT6S .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-svg-rFcFWepdrJQ2JT6S .cluster text{fill:#333;}#mermaid-svg-rFcFWepdrJQ2JT6S .cluster span{color:#333;}#mermaid-svg-rFcFWepdrJQ2JT6S div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-rFcFWepdrJQ2JT6S :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}
      </style>
      <g>
       <g class="output">
        <g class="clusters">
        </g>
        <g class="edgePaths">
         <g class="edgePath LS-A LE-B" id="L-A-B" style="opacity: 1;">
          <path class="path" d="M248.6437530517578,54L248.6437530517578,58.166666666666664C248.6437530517578,62.333333333333336,248.6437530517578,70.66666666666667,248.6437530517578,79C248.6437530517578,87.33333333333333,248.6437530517578,95.66666666666667,248.6437530517578,99.83333333333333L248.6437530517578,104" marker-end="url(#arrowhead3562)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead3562" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-B LE-C" id="L-B-C" style="opacity: 1;">
          <path class="path" d="M248.6437530517578,150L248.6437530517578,154.16666666666666C248.6437530517578,158.33333333333334,248.6437530517578,166.66666666666666,248.6437530517578,175C248.6437530517578,183.33333333333334,248.6437530517578,191.66666666666666,248.6437530517578,195.83333333333334L248.6437530517578,200" marker-end="url(#arrowhead3563)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead3563" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-C LE-D" id="L-C-D" style="opacity: 1;">
          <path class="path" d="M248.6437530517578,246L248.6437530517578,250.16666666666666C248.6437530517578,254.33333333333334,248.6437530517578,262.6666666666667,248.6437530517578,271C248.6437530517578,279.3333333333333,248.6437530517578,287.6666666666667,248.6437530517578,291.8333333333333L248.6437530517578,296" marker-end="url(#arrowhead3564)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead3564" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-D LE-E" id="L-D-E" style="opacity: 1;">
          <path class="path" d="M248.6437530517578,342L248.6437530517578,346.1666666666667C248.6437530517578,350.3333333333333,248.6437530517578,358.6666666666667,248.6437530517578,367C248.6437530517578,375.3333333333333,248.6437530517578,383.6666666666667,248.6437530517578,387.8333333333333L248.6437530517578,392" marker-end="url(#arrowhead3565)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead3565" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-E LE-F" id="L-E-F" style="opacity: 1;">
          <path class="path" d="M190.6437530517578,430.24278796007366L169.8697942097982,435.7023233000614C149.09583536783853,441.1618586400491,107.54791768391927,452.08092932002455,86.77395884195964,461.70713132667896C66,471.3333333333333,66,479.6666666666667,66,483.8333333333333L66,488" marker-end="url(#arrowhead3566)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead3566" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-F LE-G" id="L-F-G" style="opacity: 1;">
          <path class="path" d="M66,534L66,538.1666666666666C66,542.3333333333334,66,550.6666666666666,69.76408225366755,563.8192505710394C73.5281645073351,576.9718344754123,81.05632901467021,594.9436689508246,84.82041126833776,603.9295861885307L88.58449352200532,612.9155034262369" marker-end="url(#arrowhead3567)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead3567" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-G LE-E" id="L-G-E" style="opacity: 1;">
          <path class="path" d="M146.03561160112002,613.5356146528778L149.79165575524652,604.4463455440649C153.547699909373,595.3570764352519,161.05978821762594,577.1785382176259,164.81583237175244,560.089269108813C168.5718765258789,543,168.5718765258789,527,168.5718765258789,511C168.5718765258789,495,168.5718765258789,479,175.52256025208365,466.8333333333333C182.47324397828845,454.6666666666667,196.374611430698,446.3333333333333,203.32529515690274,442.1666666666667L210.2759788831075,438" marker-end="url(#arrowhead3568)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead3568" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-G LE-H" id="L-G-H" style="opacity: 1;">
          <path class="path" d="M117,778.7874969482423L116.91666666666667,785.0374984741211C116.83333333333333,791.2875,116.66666666666667,803.7875030517579,116.58333333333333,816.37083791097C116.5,828.9541727701823,116.5,841.620839436849,116.5,847.9541727701823L116.5,854.2875061035156" marker-end="url(#arrowhead3569)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead3569" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-H LE-I" id="L-H-I" style="opacity: 1;">
          <path class="path" d="M116.5,900.2875061035156L116.5,904.4541727701823C116.5,908.620839436849,116.5,916.9541727701823,116.58333333333333,925.3708396911621C116.66666666666667,933.7875066121419,116.83333333333333,942.2875071207682,116.91666666666667,946.5375073750814L117,950.7875076293944" marker-end="url(#arrowhead3570)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead3570" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-I LE-J" id="L-I-J" style="opacity: 1;">
          <path class="path" d="M117,1135.27813873291L116.91666666666667,1141.528138478597C116.83333333333333,1147.7781382242838,116.66666666666667,1160.2781377156575,116.58333333333333,1184.4023567199708C116.5,1208.526575724284,116.5,1244.2750142415364,116.5,1262.1492335001628L116.5,1280.023452758789" marker-end="url(#arrowhead3571)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead3571" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-J LE-K" id="L-J-K" style="opacity: 1;">
          <path class="path" d="M116.5,1326.023452758789L116.5,1343.8976720174153C116.5,1361.7718912760417,116.5,1397.5203297932942,123.35992160651203,1421.727882385254C130.21984321302403,1445.9354349772136,143.93968642604807,1458.6021016438801,150.7996080325601,1464.9354349772136L157.6595296390721,1471.2687683105469" marker-end="url(#arrowhead3572)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead3572" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-K LE-E" id="L-K-E" style="opacity: 1;">
          <path class="path" d="M207.4842234126857,1471.2687683105469L214.34414501919773,1464.9354349772136C221.20406662570974,1458.6021016438801,234.92390983873375,1445.9354349772136,241.7838314452458,1417.8945490519206C248.6437530517578,1389.8536631266277,248.6437530517578,1346.4385579427083,248.6437530517578,1303.023452758789C248.6437530517578,1259.6083475748699,248.6437530517578,1216.1932423909504,248.6437530517578,1172.7781372070312C248.6437530517578,1129.363032023112,248.6437530517578,1085.9479268391926,248.6437530517578,1044.6994883219402C248.6437530517578,1003.4510498046875,248.6437530517578,964.3692779541016,248.6437530517578,936.8283920288086C248.6437530517578,909.2875061035156,248.6437530517578,893.2875061035156,248.6437530517578,875.120839436849C248.6437530517578,856.9541727701823,248.6437530517578,836.620839436849,248.6437530517578,803.9302139282227C248.6437530517578,771.2395884195963,248.6437530517578,726.1916707356771,248.6437530517578,683.3104197184244C248.6437530517578,640.4291687011719,248.6437530517578,599.7145843505859,248.6437530517578,571.357292175293C248.6437530517578,543,248.6437530517578,527,248.6437530517578,511C248.6437530517578,495,248.6437530517578,479,248.6437530517578,466.8333333333333C248.6437530517578,454.6666666666667,248.6437530517578,446.3333333333333,248.6437530517578,442.1666666666667L248.6437530517578,438" marker-end="url(#arrowhead3573)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead3573" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-I LE-L" id="L-I-L" style="opacity: 1;">
          <path class="path" d="M181.37016014395553,1070.9079816407127L220.68620192456908,1087.8863409017658C260.0022437051826,1104.864700162819,338.6343272664097,1138.8214186849252,378.0337023803565,1162.216444866958C417.4330774943034,1185.6114710489908,417.59974416097003,1198.4448048909505,417.6830774943034,1204.8614718119304L417.7664108276367,1211.27813873291" marker-end="url(#arrowhead3574)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead3574" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-L LE-M" id="L-L-M" style="opacity: 1;">
          <path class="path" d="M406.56595096003474,1384.568309968824L405.3493609379684,1392.685053025778C404.1327709159021,1400.8017960827317,401.69959087176943,1417.0352821966392,400.48300084970305,1431.4853585869266C399.2664108276367,1445.9354349772136,399.2664108276367,1458.6021016438801,399.2664108276367,1464.9354349772136L399.2664108276367,1471.2687683105469" marker-end="url(#arrowhead3575)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead3575" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-M LE-N" id="L-M-N" style="opacity: 1;">
          <path class="path" d="M399.2664108276367,1517.2687683105469L399.2664108276367,1521.4354349772136C399.2664108276367,1525.6021016438801,399.2664108276367,1533.9354349772136,410.8549524943034,1542.2687683105469C422.44349416097003,1550.6021016438801,445.6205774943034,1558.9354349772136,457.20911916097003,1563.1021016438801L468.7976608276367,1567.2687683105469" marker-end="url(#arrowhead3576)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead3576" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-N LE-E" id="L-N-E" style="opacity: 1;">
          <path class="path" d="M596.7351608276367,1567.2687683105469L608.3237024943033,1563.1021016438801C619.9122441609701,1558.9354349772136,643.0893274943033,1550.6021016438801,654.6778691609701,1538.4354349772136C666.2664108276367,1526.2687683105469,666.2664108276367,1510.2687683105469,666.2664108276367,1492.1021016438801C666.2664108276367,1473.9354349772136,666.2664108276367,1453.6021016438801,666.2664108276367,1421.727882385254C666.2664108276367,1389.8536631266277,666.2664108276367,1346.4385579427083,666.2664108276367,1303.023452758789C666.2664108276367,1259.6083475748699,666.2664108276367,1216.1932423909504,666.2664108276367,1172.7781372070312C666.2664108276367,1129.363032023112,666.2664108276367,1085.9479268391926,666.2664108276367,1044.6994883219402C666.2664108276367,1003.4510498046875,666.2664108276367,964.3692779541016,666.2664108276367,936.8283920288086C666.2664108276367,909.2875061035156,666.2664108276367,893.2875061035156,666.2664108276367,875.120839436849C666.2664108276367,856.9541727701823,666.2664108276367,836.620839436849,666.2664108276367,803.9302139282227C666.2664108276367,771.2395884195963,666.2664108276367,726.1916707356771,666.2664108276367,683.3104197184244C666.2664108276367,640.4291687011719,666.2664108276367,599.7145843505859,666.2664108276367,571.357292175293C666.2664108276367,543,666.2664108276367,527,666.2664108276367,511C666.2664108276367,495,666.2664108276367,479,606.3293011983236,464.11105082868613C546.3921915690104,449.2221016573723,426.5179723103841,435.4442033147446,366.580862681071,428.5552541434308L306.6437530517578,421.66630497211685" marker-end="url(#arrowhead3577)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead3577" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-L LE-O" id="L-L-O" style="opacity: 1;">
          <path class="path" d="M454.70779587372937,1358.8273878420916L462.96756503271394,1371.234284586834C471.22733419169845,1383.6411813315765,487.7468725096676,1408.4549748210618,503.17057609488165,1427.1952048991377C518.5942796800957,1445.9354349772136,532.9221485325547,1458.6021016438801,540.0860829587842,1464.9354349772136L547.2500173850137,1471.2687683105469" marker-end="url(#arrowhead3578)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead3578" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-O LE-E" id="L-O-E" style="opacity: 1;">
          <path class="path" d="M587.0287059096039,1471.2687683105469L590.8183233959427,1464.9354349772136C594.6079408822815,1458.6021016438801,602.1871758549592,1445.9354349772136,605.9767933412979,1417.8945490519206C609.7664108276367,1389.8536631266277,609.7664108276367,1346.4385579427083,609.7664108276367,1303.023452758789C609.7664108276367,1259.6083475748699,609.7664108276367,1216.1932423909504,609.7664108276367,1172.7781372070312C609.7664108276367,1129.363032023112,609.7664108276367,1085.9479268391926,609.7664108276367,1044.6994883219402C609.7664108276367,1003.4510498046875,609.7664108276367,964.3692779541016,609.7664108276367,936.8283920288086C609.7664108276367,909.2875061035156,609.7664108276367,893.2875061035156,609.7664108276367,875.120839436849C609.7664108276367,856.9541727701823,609.7664108276367,836.620839436849,609.7664108276367,803.9302139282227C609.7664108276367,771.2395884195963,609.7664108276367,726.1916707356771,609.7664108276367,683.3104197184244C609.7664108276367,640.4291687011719,609.7664108276367,599.7145843505859,609.7664108276367,571.357292175293C609.7664108276367,543,609.7664108276367,527,609.7664108276367,511C609.7664108276367,495,609.7664108276367,479,559.2459678649902,464.28488199233396C508.72552490234375,449.5697639846679,407.6846389770508,436.1395279693358,357.1641960144043,429.4244099616697L306.6437530517578,422.7092919540037" marker-end="url(#arrowhead3579)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead3579" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
        </g>
        <g class="edgeLabels">
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-A' L-LE-B" id="L-L-A-B">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-B' L-LE-C" id="L-L-B-C">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-C' L-LE-D" id="L-L-C-D">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-D' L-LE-E" id="L-L-D-E">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-E' L-LE-F" id="L-L-E-F">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-F' L-LE-G" id="L-L-F-G">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="translate(168.5718765258789,511)">
          <g class="label" transform="translate(-8,-13)">
           <rect height="26" rx="0" ry="0" width="16">
           </rect>
           <foreignobject height="26" width="16">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-G' L-LE-E" id="L-L-G-E">
              否
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="translate(116.5,816.2875061035156)">
          <g class="label" transform="translate(-8,-13)">
           <rect height="26" rx="0" ry="0" width="16">
           </rect>
           <foreignobject height="26" width="16">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-G' L-LE-H" id="L-L-G-H">
              是
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-H' L-LE-I" id="L-L-H-I">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="translate(116.5,1172.7781372070312)">
          <g class="label" transform="translate(-8,-13)">
           <rect height="26" rx="0" ry="0" width="16">
           </rect>
           <foreignobject height="26" width="16">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-I' L-LE-J" id="L-L-I-J">
              是
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-J' L-LE-K" id="L-L-J-K">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-K' L-LE-E" id="L-L-K-E">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="translate(417.2664108276367,1172.7781372070312)">
          <g class="label" transform="translate(-8,-13)">
           <rect height="26" rx="0" ry="0" width="16">
           </rect>
           <foreignobject height="26" width="16">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-I' L-LE-L" id="L-L-I-L">
              否
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="translate(399.2664108276367,1433.2687683105469)">
          <g class="label" transform="translate(-8,-13)">
           <rect height="26" rx="0" ry="0" width="16">
           </rect>
           <foreignobject height="26" width="16">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-L' L-LE-M" id="L-L-L-M">
              是
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-M' L-LE-N" id="L-L-M-N">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-N' L-LE-E" id="L-L-N-E">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="translate(504.2664108276367,1433.2687683105469)">
          <g class="label" transform="translate(-8,-13)">
           <rect height="26" rx="0" ry="0" width="16">
           </rect>
           <foreignobject height="26" width="16">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-L' L-LE-O" id="L-L-L-O">
              否
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-O' L-LE-E" id="L-L-O-E">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
        </g>
        <g class="nodes">
         <g class="node default" id="flowchart-A-2732" style="opacity: 1;" transform="translate(248.6437530517578,31)">
          <rect class="label-container" height="46" rx="0" ry="0" width="52" x="-26" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-16,-13)">
            <foreignobject height="26" width="32">
             <div style="display: inline-block; white-space: nowrap;">
              开始
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-B-2733" style="opacity: 1;" transform="translate(248.6437530517578,127)">
          <rect class="label-container" height="46" rx="0" ry="0" width="148" x="-74" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-64,-13)">
            <foreignobject height="26" width="128">
             <div style="display: inline-block; white-space: nowrap;">
              配置企业微信参数
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-C-2735" style="opacity: 1;" transform="translate(248.6437530517578,223)">
          <rect class="label-container" height="46" rx="0" ry="0" width="120.07292175292969" x="-60.036460876464844" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-50.036460876464844,-13)">
            <foreignobject height="26" width="100.07292175292969">
             <div style="display: inline-block; white-space: nowrap;">
              创建Flask应用
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-D-2737" style="opacity: 1;" transform="translate(248.6437530517578,319)">
          <rect class="label-container" height="46" rx="0" ry="0" width="114.54167175292969" x="-57.270835876464844" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-47.270835876464844,-13)">
            <foreignobject height="26" width="94.54167175292969">
             <div style="display: inline-block; white-space: nowrap;">
              启动Web服务
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-E-2739" style="opacity: 1;" transform="translate(248.6437530517578,415)">
          <rect class="label-container" height="46" rx="0" ry="0" width="116" x="-58" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-48,-13)">
            <foreignobject height="26" width="96">
             <div style="display: inline-block; white-space: nowrap;">
              等待接收消息
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-F-2741" style="opacity: 1;" transform="translate(66,511)">
          <rect class="label-container" height="46" rx="0" ry="0" width="116" x="-58" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-48,-13)">
            <foreignobject height="26" width="96">
             <div style="display: inline-block; white-space: nowrap;">
              收到消息回调
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-G-2743" style="opacity: 1;" transform="translate(116.5,681.1437530517578)">
          <polygon class="label-container" points="97.14375,0 194.2875,-97.14375 97.14375,-194.2875 0,-97.14375" transform="translate(-97.14375,97.14375)">
          </polygon>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-74.9375,-13)">
            <foreignobject height="26" width="149.875">
             <div style="display: inline-block; white-space: nowrap;">
              消息类型是否为文本?
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-H-2747" style="opacity: 1;" transform="translate(116.5,877.2875061035156)">
          <rect class="label-container" height="46" rx="0" ry="0" width="116" x="-58" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-48,-13)">
            <foreignobject height="26" width="96">
             <div style="display: inline-block; white-space: nowrap;">
              解析消息内容
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-I-2749" style="opacity: 1;" transform="translate(116.5,1042.5328216552734)">
          <polygon class="label-container" points="92.24531707763673,0 184.49063415527345,-92.24531707763673 92.24531707763673,-184.49063415527345 0,-92.24531707763673" transform="translate(-92.24531707763673,92.24531707763673)">
          </polygon>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-69.49479675292969,-13)">
            <foreignobject height="26" width="138.98959350585938">
             <div style="display: inline-block; white-space: nowrap;">
              消息是否包含'请假'?
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-J-2751" style="opacity: 1;" transform="translate(116.5,1303.023452758789)">
          <rect class="label-container" height="46" rx="0" ry="0" width="116" x="-58" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-48,-13)">
            <foreignobject height="26" width="96">
             <div style="display: inline-block; white-space: nowrap;">
              回复请假确认
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-K-2753" style="opacity: 1;" transform="translate(182.5718765258789,1494.2687683105469)">
          <rect class="label-container" height="46" rx="0" ry="0" width="116" x="-58" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-48,-13)">
            <foreignobject height="26" width="96">
             <div style="display: inline-block; white-space: nowrap;">
              转发给管理员
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-L-2757" style="opacity: 1;" transform="translate(417.2664108276367,1303.023452758789)">
          <polygon class="label-container" points="92.24531707763673,0 184.49063415527345,-92.24531707763673 92.24531707763673,-184.49063415527345 0,-92.24531707763673" transform="translate(-92.24531707763673,92.24531707763673)">
          </polygon>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-69.49479675292969,-13)">
            <foreignobject height="26" width="138.98959350585938">
             <div style="display: inline-block; white-space: nowrap;">
              消息是否包含'报表'?
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-M-2759" style="opacity: 1;" transform="translate(399.2664108276367,1494.2687683105469)">
          <rect class="label-container" height="46" rx="0" ry="0" width="132" x="-66" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-56,-13)">
            <foreignobject height="26" width="112">
             <div style="display: inline-block; white-space: nowrap;">
              回复报表生成中
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-N-2761" style="opacity: 1;" transform="translate(532.7664108276367,1590.2687683105469)">
          <rect class="label-container" height="46" rx="0" ry="0" width="148" x="-74" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-64,-13)">
            <foreignobject height="26" width="128">
             <div style="display: inline-block; white-space: nowrap;">
              调用报表生成函数
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-O-2765" style="opacity: 1;" transform="translate(573.2664108276367,1494.2687683105469)">
          <rect class="label-container" height="46" rx="0" ry="0" width="116" x="-58" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-48,-13)">
            <foreignobject height="26" width="96">
             <div style="display: inline-block; white-space: nowrap;">
              发送默认回复
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
        </g>
       </g>
      </g>
     </svg>
    </div>
    <h4>
     <a id="_195">
     </a>
     使用示例
    </h4>
    <pre><code class="prism language-python"><span class="token comment"># 配置企业微信参数</span>
CORP_ID <span class="token operator">=</span> <span class="token string">"your_corp_id"</span>
CORP_SECRET <span class="token operator">=</span> <span class="token string">"your_corp_secret"</span>
AGENT_ID <span class="token operator">=</span> <span class="token string">"your_agent_id"</span>

<span class="token comment"># 启动应用</span>
app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre>
    <h4>
     <a id="_206">
     </a>
     依赖项
    </h4>
    <ul>
     <li>
      flask
     </li>
     <li>
      requests
     </li>
     <li>
      logging
     </li>
     <li>
      json
     </li>
    </ul>
    <h3>
     <a id="_212">
     </a>
     系统集成建议
    </h3>
    <p>
     以上四个模块可以组合使用，实现完整的办公自动化流程：
    </p>
    <div class="mermaid">
     <svg class="mermaid-svg" height="408" id="mermaid-svg-vz7S0LWs07tksdc2" viewbox="0 0 210 408" width="210" xmlns="http://www.w3.org/2000/svg">
      <style>
       #mermaid-svg-vz7S0LWs07tksdc2 {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-svg-vz7S0LWs07tksdc2 .error-icon{fill:#552222;}#mermaid-svg-vz7S0LWs07tksdc2 .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-vz7S0LWs07tksdc2 .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-vz7S0LWs07tksdc2 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-vz7S0LWs07tksdc2 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-vz7S0LWs07tksdc2 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-vz7S0LWs07tksdc2 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-vz7S0LWs07tksdc2 .marker{fill:#333333;stroke:#333333;}#mermaid-svg-vz7S0LWs07tksdc2 .marker.cross{stroke:#333333;}#mermaid-svg-vz7S0LWs07tksdc2 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-vz7S0LWs07tksdc2 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-svg-vz7S0LWs07tksdc2 .cluster-label text{fill:#333;}#mermaid-svg-vz7S0LWs07tksdc2 .cluster-label span{color:#333;}#mermaid-svg-vz7S0LWs07tksdc2 .label text,#mermaid-svg-vz7S0LWs07tksdc2 span{fill:#333;color:#333;}#mermaid-svg-vz7S0LWs07tksdc2 .node rect,#mermaid-svg-vz7S0LWs07tksdc2 .node circle,#mermaid-svg-vz7S0LWs07tksdc2 .node ellipse,#mermaid-svg-vz7S0LWs07tksdc2 .node polygon,#mermaid-svg-vz7S0LWs07tksdc2 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg-vz7S0LWs07tksdc2 .node .label{text-align:center;}#mermaid-svg-vz7S0LWs07tksdc2 .node.clickable{cursor:pointer;}#mermaid-svg-vz7S0LWs07tksdc2 .arrowheadPath{fill:#333333;}#mermaid-svg-vz7S0LWs07tksdc2 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-svg-vz7S0LWs07tksdc2 .flowchart-link{stroke:#333333;fill:none;}#mermaid-svg-vz7S0LWs07tksdc2 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-svg-vz7S0LWs07tksdc2 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-svg-vz7S0LWs07tksdc2 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-svg-vz7S0LWs07tksdc2 .cluster text{fill:#333;}#mermaid-svg-vz7S0LWs07tksdc2 .cluster span{color:#333;}#mermaid-svg-vz7S0LWs07tksdc2 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-vz7S0LWs07tksdc2 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}
      </style>
      <g transform="translate(0, 0)">
       <marker class="marker flowchart" id="flowchart-pointEnd" markerheight="12" markerunits="userSpaceOnUse" markerwidth="12" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
        <path class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
        </path>
       </marker>
       <marker class="marker flowchart" id="flowchart-pointStart" markerheight="12" markerunits="userSpaceOnUse" markerwidth="12" orient="auto" refx="0" refy="5" viewbox="0 0 10 10">
        <path class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
        </path>
       </marker>
       <marker class="marker flowchart" id="flowchart-circleEnd" markerheight="11" markerunits="userSpaceOnUse" markerwidth="11" orient="auto" refx="11" refy="5" viewbox="0 0 10 10">
        <circle class="arrowMarkerPath" cx="5" cy="5" r="5" style="stroke-width: 1; stroke-dasharray: 1, 0;">
        </circle>
       </marker>
       <marker class="marker flowchart" id="flowchart-circleStart" markerheight="11" markerunits="userSpaceOnUse" markerwidth="11" orient="auto" refx="-1" refy="5" viewbox="0 0 10 10">
        <circle class="arrowMarkerPath" cx="5" cy="5" r="5" style="stroke-width: 1; stroke-dasharray: 1, 0;">
        </circle>
       </marker>
       <marker class="marker cross flowchart" id="flowchart-crossEnd" markerheight="11" markerunits="userSpaceOnUse" markerwidth="11" orient="auto" refx="12" refy="5.2" viewbox="0 0 11 11">
        <path class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9" style="stroke-width: 2; stroke-dasharray: 1, 0;">
        </path>
       </marker>
       <marker class="marker cross flowchart" id="flowchart-crossStart" markerheight="11" markerunits="userSpaceOnUse" markerwidth="11" orient="auto" refx="-1" refy="5.2" viewbox="0 0 11 11">
        <path class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9" style="stroke-width: 2; stroke-dasharray: 1, 0;">
        </path>
       </marker>
       <g class="root">
        <g class="clusters">
        </g>
        <g class="edgePaths">
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-B" d="M103.49145299145299,49L98.15954415954415,55.333333333333336C92.82763532763533,61.666666666666664,82.16381766381767,74.33333333333333,76.83190883190883,87C71.5,99.66666666666667,71.5,112.33333333333333,71.5,118.66666666666667L71.5,125" id="L-A-B-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-C" d="M71.5,166L71.5,172.33333333333334C71.5,178.66666666666666,71.5,191.33333333333334,71.5,204C71.5,216.66666666666666,71.5,229.33333333333334,71.5,235.66666666666666L71.5,242" id="L-B-C-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-D" d="M71.5,283L71.5,289.3333333333333C71.5,295.6666666666667,71.5,308.3333333333333,76.83190883190883,321C82.16381766381767,333.6666666666667,92.82763532763533,346.3333333333333,98.15954415954415,352.6666666666667L103.49145299145299,359" id="L-C-D-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
         <path class="edge-thickness-normal edge-pattern-solid flowchart-link LS-D LE-A" d="M138.008547008547,359L143.34045584045583,352.6666666666667C148.67236467236467,346.3333333333333,159.33618233618233,333.6666666666667,164.66809116809117,317.5833333333333C170,301.5,170,282,170,262.5C170,243,170,223.5,170,204C170,184.5,170,165,170,145.5C170,126,170,106.5,164.66809116809117,90.41666666666667C159.33618233618233,74.33333333333333,148.67236467236467,61.666666666666664,143.34045584045583,55.333333333333336L138.008547008547,49" id="L-D-A-0" marker-end="url(#flowchart-pointEnd)" style="fill:none;">
         </path>
        </g>
        <g class="edgeLabels">
         <g class="edgeLabel" transform="translate(71.5, 87)">
          <g class="label" transform="translate(-48, -13)">
           <foreignobject height="26" width="96">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
              收到报表请求
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" transform="translate(71.5, 204)">
          <g class="label" transform="translate(-32, -13)">
           <foreignobject height="26" width="64">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
              生成报表
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" transform="translate(71.5, 321)">
          <g class="label" transform="translate(-32, -13)">
           <foreignobject height="26" width="64">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
              整理命名
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" transform="translate(170, 204)">
          <g class="label" transform="translate(-32, -13)">
           <foreignobject height="26" width="64">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel">
              发送结果
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
        </g>
        <g class="nodes">
         <g class="node default default" id="flowchart-A-2776" transform="translate(120.75, 28.5)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="143" x="-71.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-64, -13)">
           <foreignobject height="26" width="128">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              企业微信消息监控
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-B-2777" transform="translate(71.5, 145.5)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="116.95833587646484" x="-58.47916793823242" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-50.97916793823242, -13)">
           <foreignobject height="26" width="101.95833587646484">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              Excel处理工具
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-C-2779" transform="translate(71.5, 262.5)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="127" x="-63.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-56, -13)">
           <foreignobject height="26" width="112">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              文件批量重命名
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="node default default" id="flowchart-D-2781" transform="translate(120.75, 379.5)">
          <rect class="basic label-container" height="41" rx="0" ry="0" style="" width="111" x="-55.5" y="-20.5">
          </rect>
          <g class="label" style="" transform="translate(-48, -13)">
           <foreignobject height="26" width="96">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="nodeLabel">
              邮件自动发送
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
        </g>
       </g>
      </g>
     </svg>
    </div>
    <h4>
     <a id="_224">
     </a>
     综合应用场景
    </h4>
    <ol>
     <li>
      员工通过企业微信发送"报表请求"
     </li>
     <li>
      系统自动生成Excel报表
     </li>
     <li>
      批量处理相关文件并规范命名
     </li>
     <li>
      通过邮件将处理结果发送给请求者
     </li>
     <li>
      通知管理员处理完成
     </li>
    </ol>
    <p>
     人工操作通常需要数小时的工作，通过此自动化系统可以在几分钟内完成！
     <br/>
     <strong>
      文件重命名
     </strong>
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> os
<span class="token keyword">import</span> re
<span class="token keyword">import</span> datetime
<span class="token keyword">from</span> pathlib <span class="token keyword">import</span> Path

<span class="token keyword">def</span> <span class="token function">batch_rename</span><span class="token punctuation">(</span>folder_path<span class="token punctuation">,</span> pattern<span class="token punctuation">,</span> file_types<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> add_date<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    批量重命名文件
    
    参数:
        folder_path: 文件夹路径
        pattern: 命名模式，如"doc_{index}_{original}"
        file_types: 需处理的文件类型列表，如['.jpg', '.png']
        add_date: 是否添加日期前缀
    """</span>
    files <span class="token operator">=</span> <span class="token punctuation">[</span>f <span class="token keyword">for</span> f <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>folder_path<span class="token punctuation">)</span> <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>folder_path<span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    
    <span class="token comment"># 文件类型过滤</span>
    <span class="token keyword">if</span> file_types<span class="token punctuation">:</span>
        files <span class="token operator">=</span> <span class="token punctuation">[</span>f <span class="token keyword">for</span> f <span class="token keyword">in</span> files <span class="token keyword">if</span> <span class="token builtin">any</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>endswith<span class="token punctuation">(</span>ext<span class="token punctuation">)</span> <span class="token keyword">for</span> ext <span class="token keyword">in</span> file_types<span class="token punctuation">)</span><span class="token punctuation">]</span>
    
    <span class="token comment"># 按文件名排序</span>
    files<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    today <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y%m%d'</span><span class="token punctuation">)</span>
    
    <span class="token keyword">for</span> idx<span class="token punctuation">,</span> filename <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>files<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 获取文件扩展名</span>
        file_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>folder_path<span class="token punctuation">,</span> filename<span class="token punctuation">)</span>
        name<span class="token punctuation">,</span> ext <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>splitext<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
        
        <span class="token comment"># 构建新文件名</span>
        new_name <span class="token operator">=</span> pattern<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>
            index<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>idx<span class="token punctuation">:</span><span class="token format-spec">03d</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> 
            original<span class="token operator">=</span>name<span class="token punctuation">,</span>
            ext<span class="token operator">=</span>ext<span class="token punctuation">,</span>
            date<span class="token operator">=</span>today
        <span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> add_date<span class="token punctuation">:</span>
            new_name <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>today<span class="token punctuation">}</span></span><span class="token string">_</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>new_name<span class="token punctuation">}</span></span><span class="token string">"</span></span>
            
        <span class="token comment"># 确保新文件名有扩展名</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> new_name<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span>ext<span class="token punctuation">)</span><span class="token punctuation">:</span>
            new_name <span class="token operator">+=</span> ext
            
        new_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>folder_path<span class="token punctuation">,</span> new_name<span class="token punctuation">)</span>
        
        <span class="token comment"># 防止文件名重复</span>
        counter <span class="token operator">=</span> <span class="token number">1</span>
        <span class="token keyword">while</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>new_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
            new_name <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>new_name<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>ext<span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">_</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>counter<span class="token punctuation">}</span></span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>ext<span class="token punctuation">}</span></span><span class="token string">"</span></span>
            new_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>folder_path<span class="token punctuation">,</span> new_name<span class="token punctuation">)</span>
            counter <span class="token operator">+=</span> <span class="token number">1</span>
            
        os<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> new_path<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"已重命名: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>filename<span class="token punctuation">}</span></span><span class="token string"> -&gt; </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>new_name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># 使用示例</span>
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    batch_rename<span class="token punctuation">(</span>
        folder_path<span class="token operator">=</span><span class="token string">"D:/文档/图片"</span><span class="token punctuation">,</span>
        pattern<span class="token operator">=</span><span class="token string">"照片_{date}_{index}"</span><span class="token punctuation">,</span>
        file_types<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'.jpg'</span><span class="token punctuation">,</span> <span class="token string">'.png'</span><span class="token punctuation">,</span> <span class="token string">'.jpeg'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        add_date<span class="token operator">=</span><span class="token boolean">True</span>
    <span class="token punctuation">)</span> 
</code></pre>
    <p>
     <strong>
      Excel自动处理工具
     </strong>
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> openpyxl
<span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>styles <span class="token keyword">import</span> Font<span class="token punctuation">,</span> PatternFill<span class="token punctuation">,</span> Alignment
<span class="token keyword">import</span> datetime

<span class="token keyword">def</span> <span class="token function">generate_report</span><span class="token punctuation">(</span>source_file<span class="token punctuation">,</span> output_file<span class="token punctuation">,</span> report_title<span class="token operator">=</span><span class="token string">"月度报表"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""生成格式化的Excel报表"""</span>
    <span class="token comment"># 读取源数据</span>
    df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>source_file<span class="token punctuation">)</span>
    
    <span class="token comment"># 数据处理</span>
    df<span class="token punctuation">[</span><span class="token string">'总价'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'单价'</span><span class="token punctuation">]</span> <span class="token operator">*</span> df<span class="token punctuation">[</span><span class="token string">'数量'</span><span class="token punctuation">]</span>
    summary <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'类别'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'总价'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 创建一个新的Excel工作簿</span>
    writer <span class="token operator">=</span> pd<span class="token punctuation">.</span>ExcelWriter<span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> engine<span class="token operator">=</span><span class="token string">'openpyxl'</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 写入主数据</span>
    df<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>writer<span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">'详细数据'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    summary<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>writer<span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">'汇总'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 获取工作簿对象</span>
    workbook <span class="token operator">=</span> writer<span class="token punctuation">.</span>book
    
    <span class="token comment"># 格式化详细数据表</span>
    ws <span class="token operator">=</span> workbook<span class="token punctuation">[</span><span class="token string">'详细数据'</span><span class="token punctuation">]</span>
    
    <span class="token comment"># 添加标题</span>
    ws<span class="token punctuation">.</span>insert_rows<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    ws<span class="token punctuation">.</span>merge_cells<span class="token punctuation">(</span><span class="token string">'A1:E1'</span><span class="token punctuation">)</span>
    ws<span class="token punctuation">[</span><span class="token string">'A1'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>report_title<span class="token punctuation">}</span></span><span class="token string"> - </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span>
    ws<span class="token punctuation">[</span><span class="token string">'A1'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>font <span class="token operator">=</span> Font<span class="token punctuation">(</span>size<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span> bold<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    ws<span class="token punctuation">[</span><span class="token string">'A1'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>alignment <span class="token operator">=</span> Alignment<span class="token punctuation">(</span>horizontal<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 设置表头样式</span>
    header_row <span class="token operator">=</span> <span class="token number">2</span>
    <span class="token keyword">for</span> cell <span class="token keyword">in</span> ws<span class="token punctuation">[</span>header_row<span class="token punctuation">]</span><span class="token punctuation">:</span>
        cell<span class="token punctuation">.</span>font <span class="token operator">=</span> Font<span class="token punctuation">(</span>bold<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        cell<span class="token punctuation">.</span>fill <span class="token operator">=</span> PatternFill<span class="token punctuation">(</span>start_color<span class="token operator">=</span><span class="token string">"DDEBF7"</span><span class="token punctuation">,</span> end_color<span class="token operator">=</span><span class="token string">"DDEBF7"</span><span class="token punctuation">,</span> fill_type<span class="token operator">=</span><span class="token string">"solid"</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 调整列宽</span>
    <span class="token keyword">for</span> column <span class="token keyword">in</span> ws<span class="token punctuation">.</span>columns<span class="token punctuation">:</span>
        max_length <span class="token operator">=</span> <span class="token number">0</span>
        column_letter <span class="token operator">=</span> column<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>column_letter
        <span class="token keyword">for</span> cell <span class="token keyword">in</span> column<span class="token punctuation">:</span>
            <span class="token keyword">if</span> cell<span class="token punctuation">.</span>value<span class="token punctuation">:</span>
                max_length <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>max_length<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        adjusted_width <span class="token operator">=</span> <span class="token punctuation">(</span>max_length <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span>
        ws<span class="token punctuation">.</span>column_dimensions<span class="token punctuation">[</span>column_letter<span class="token punctuation">]</span><span class="token punctuation">.</span>width <span class="token operator">=</span> adjusted_width
    
    <span class="token comment"># 保存工作簿</span>
    writer<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"报表已生成: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>output_file<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># 使用示例</span>
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    generate_report<span class="token punctuation">(</span>
        source_file<span class="token operator">=</span><span class="token string">"销售数据.xlsx"</span><span class="token punctuation">,</span>
        output_file<span class="token operator">=</span><span class="token string">"销售报表.xlsx"</span><span class="token punctuation">,</span>
        report_title<span class="token operator">=</span><span class="token string">"2023年第一季度销售报表"</span>
    <span class="token punctuation">)</span> 
</code></pre>
    <p>
     <strong>
      自动发送邮件工具
     </strong>
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> smtplib
<span class="token keyword">import</span> os
<span class="token keyword">from</span> email<span class="token punctuation">.</span>mime<span class="token punctuation">.</span>multipart <span class="token keyword">import</span> MIMEMultipart
<span class="token keyword">from</span> email<span class="token punctuation">.</span>mime<span class="token punctuation">.</span>text <span class="token keyword">import</span> MIMEText
<span class="token keyword">from</span> email<span class="token punctuation">.</span>mime<span class="token punctuation">.</span>application <span class="token keyword">import</span> MIMEApplication
<span class="token keyword">from</span> jinja2 <span class="token keyword">import</span> Template
<span class="token keyword">from</span> dotenv <span class="token keyword">import</span> load_dotenv

<span class="token comment"># 加载环境变量</span>
load_dotenv<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">send_email_with_template</span><span class="token punctuation">(</span>to_addresses<span class="token punctuation">,</span> subject<span class="token punctuation">,</span> template_file<span class="token punctuation">,</span> template_data<span class="token punctuation">,</span> attachments<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    发送带有模板和附件的邮件
    
    参数:
        to_addresses: 收件人列表
        subject: 邮件主题
        template_file: HTML模板文件路径
        template_data: 模板数据字典
        attachments: 附件文件路径列表
    """</span>
    <span class="token comment"># 获取邮箱配置</span>
    smtp_server <span class="token operator">=</span> os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">"SMTP_SERVER"</span><span class="token punctuation">)</span>
    smtp_port <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">"SMTP_PORT"</span><span class="token punctuation">,</span> <span class="token number">587</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    email_address <span class="token operator">=</span> os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">"EMAIL_ADDRESS"</span><span class="token punctuation">)</span>
    email_password <span class="token operator">=</span> os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">"EMAIL_PASSWORD"</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 创建邮件对象</span>
    msg <span class="token operator">=</span> MIMEMultipart<span class="token punctuation">(</span><span class="token punctuation">)</span>
    msg<span class="token punctuation">[</span><span class="token string">'From'</span><span class="token punctuation">]</span> <span class="token operator">=</span> email_address
    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>to_addresses<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        msg<span class="token punctuation">[</span><span class="token string">'To'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">', '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>to_addresses<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        msg<span class="token punctuation">[</span><span class="token string">'To'</span><span class="token punctuation">]</span> <span class="token operator">=</span> to_addresses
    msg<span class="token punctuation">[</span><span class="token string">'Subject'</span><span class="token punctuation">]</span> <span class="token operator">=</span> subject
    
    <span class="token comment"># 渲染HTML模板</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>template_file<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        template_content <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    template <span class="token operator">=</span> Template<span class="token punctuation">(</span>template_content<span class="token punctuation">)</span>
    html <span class="token operator">=</span> template<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token operator">**</span>template_data<span class="token punctuation">)</span>
    
    <span class="token comment"># 添加HTML内容</span>
    msg<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>MIMEText<span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 添加附件</span>
    <span class="token keyword">if</span> attachments<span class="token punctuation">:</span>
        <span class="token keyword">for</span> file_path <span class="token keyword">in</span> attachments<span class="token punctuation">:</span>
            <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                    file_name <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>basename<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
                    part <span class="token operator">=</span> MIMEApplication<span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Name<span class="token operator">=</span>file_name<span class="token punctuation">)</span>
                    part<span class="token punctuation">[</span><span class="token string">'Content-Disposition'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'attachment; filename="</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>file_name<span class="token punctuation">}</span></span><span class="token string">"'</span></span>
                    msg<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>part<span class="token punctuation">)</span>
    
    <span class="token comment"># 发送邮件</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        server <span class="token operator">=</span> smtplib<span class="token punctuation">.</span>SMTP<span class="token punctuation">(</span>smtp_server<span class="token punctuation">,</span> smtp_port<span class="token punctuation">)</span>
        server<span class="token punctuation">.</span>starttls<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 加密连接</span>
        server<span class="token punctuation">.</span>login<span class="token punctuation">(</span>email_address<span class="token punctuation">,</span> email_password<span class="token punctuation">)</span>
        server<span class="token punctuation">.</span>sendmail<span class="token punctuation">(</span>email_address<span class="token punctuation">,</span> to_addresses<span class="token punctuation">,</span> msg<span class="token punctuation">.</span>as_string<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        server<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"邮件已成功发送给 </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>to_addresses<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"发送邮件失败: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>

<span class="token comment"># 使用示例</span>
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token comment"># 准备邮件数据</span>
    recipients <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"收件人@example.com"</span><span class="token punctuation">]</span>
    email_subject <span class="token operator">=</span> <span class="token string">"月度销售报告"</span>
    
    <span class="token comment"># 模板数据</span>
    data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"张经理"</span><span class="token punctuation">,</span>
        <span class="token string">"department"</span><span class="token punctuation">:</span> <span class="token string">"销售部"</span><span class="token punctuation">,</span>
        <span class="token string">"month"</span><span class="token punctuation">:</span> <span class="token string">"五月"</span><span class="token punctuation">,</span>
        <span class="token string">"sales"</span><span class="token punctuation">:</span> <span class="token number">125000</span><span class="token punctuation">,</span>
        <span class="token string">"target"</span><span class="token punctuation">:</span> <span class="token number">100000</span><span class="token punctuation">,</span>
        <span class="token string">"products"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"产品A"</span><span class="token punctuation">,</span> <span class="token string">"sales"</span><span class="token punctuation">:</span> <span class="token number">45000</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"产品B"</span><span class="token punctuation">,</span> <span class="token string">"sales"</span><span class="token punctuation">:</span> <span class="token number">30000</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"产品C"</span><span class="token punctuation">,</span> <span class="token string">"sales"</span><span class="token punctuation">:</span> <span class="token number">50000</span><span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment"># 发送邮件</span>
    send_email_with_template<span class="token punctuation">(</span>
        recipients<span class="token punctuation">,</span>
        email_subject<span class="token punctuation">,</span>
        <span class="token string">"templates/monthly_report.html"</span><span class="token punctuation">,</span>
        data<span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">"reports/sales_may.xlsx"</span><span class="token punctuation">,</span> <span class="token string">"reports/chart.pdf"</span><span class="token punctuation">]</span>
    <span class="token punctuation">)</span> 
</code></pre>
    <p>
     <strong>
      企业微信消息监控
     </strong>
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> json
<span class="token keyword">import</span> time
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> logging
<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token punctuation">,</span> jsonify

<span class="token comment"># 配置日志</span>
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span>level<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">'%(asctime)s - %(name)s - %(levelname)s - %(message)s'</span><span class="token punctuation">)</span>
logger <span class="token operator">=</span> logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token comment"># 企业微信配置</span>
CORP_ID <span class="token operator">=</span> <span class="token string">"your_corp_id"</span>
CORP_SECRET <span class="token operator">=</span> <span class="token string">"your_corp_secret"</span>
AGENT_ID <span class="token operator">=</span> <span class="token string">"your_agent_id"</span>
TOKEN <span class="token operator">=</span> <span class="token string">"your_token"</span>
ENCODING_AES_KEY <span class="token operator">=</span> <span class="token string">"your_encoding_aes_key"</span>

<span class="token comment"># 创建Flask应用</span>
app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">get_access_token</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""获取企业微信API访问令牌"""</span>
    url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"https://qyapi.weixin.qq.com/cgi-bin/gettoken?corpid=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>CORP_ID<span class="token punctuation">}</span></span><span class="token string">&amp;corpsecret=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>CORP_SECRET<span class="token punctuation">}</span></span><span class="token string">"</span></span>
    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    data <span class="token operator">=</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> data<span class="token punctuation">[</span><span class="token string">"errcode"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> data<span class="token punctuation">[</span><span class="token string">"access_token"</span><span class="token punctuation">]</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"获取access_token失败: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>data<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token keyword">def</span> <span class="token function">send_message</span><span class="token punctuation">(</span>user_id<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""发送企业微信消息"""</span>
    access_token <span class="token operator">=</span> get_access_token<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> access_token<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>
    
    url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>access_token<span class="token punctuation">}</span></span><span class="token string">"</span></span>
    data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">"touser"</span><span class="token punctuation">:</span> user_id<span class="token punctuation">,</span>
        <span class="token string">"msgtype"</span><span class="token punctuation">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>
        <span class="token string">"agentid"</span><span class="token punctuation">:</span> AGENT_ID<span class="token punctuation">,</span>
        <span class="token string">"text"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">"content"</span><span class="token punctuation">:</span> content
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"safe"</span><span class="token punctuation">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span>
    
    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> json<span class="token operator">=</span>data<span class="token punctuation">)</span>
    result <span class="token operator">=</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">if</span> result<span class="token punctuation">[</span><span class="token string">"errcode"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"消息发送成功: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>user_id<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        logger<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"消息发送失败: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>result<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>

<span class="token comment"># 接收企业微信消息回调</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/wechat'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">wechat_callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    data <span class="token operator">=</span> request<span class="token punctuation">.</span>json
    logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"收到企业微信消息: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>data<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    
    <span class="token comment"># 处理文本消息</span>
    <span class="token keyword">if</span> data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"MsgType"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"text"</span><span class="token punctuation">:</span>
        from_user <span class="token operator">=</span> data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"FromUserName"</span><span class="token punctuation">)</span>
        content <span class="token operator">=</span> data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"Content"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 根据关键词处理消息</span>
        <span class="token keyword">if</span> <span class="token string">"请假"</span> <span class="token keyword">in</span> content<span class="token punctuation">:</span>
            <span class="token comment"># 处理请假申请</span>
            reply <span class="token operator">=</span> <span class="token string">"已收到您的请假申请，正在处理中..."</span>
            send_message<span class="token punctuation">(</span>from_user<span class="token punctuation">,</span> reply<span class="token punctuation">)</span>
            
            <span class="token comment"># 转发给管理员</span>
            send_message<span class="token punctuation">(</span><span class="token string">"manager_user_id"</span><span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f"收到</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>from_user<span class="token punctuation">}</span></span><span class="token string">的请假申请：</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>content<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> <span class="token string">"报表"</span> <span class="token keyword">in</span> content<span class="token punctuation">:</span>
            <span class="token comment"># 处理报表请求</span>
            reply <span class="token operator">=</span> <span class="token string">"报表生成中，稍后将发送给您..."</span>
            send_message<span class="token punctuation">(</span>from_user<span class="token punctuation">,</span> reply<span class="token punctuation">)</span>
            
            <span class="token comment"># 这里可以调用报表生成函数</span>
            <span class="token comment"># generate_report(...)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># 默认回复</span>
            send_message<span class="token punctuation">(</span>from_user<span class="token punctuation">,</span> <span class="token string">"您的消息已收到，将尽快处理。"</span><span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"errcode"</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> 
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f33353230393330352f:61727469636c652f64657461696c732f313436323138313734" class_="artid" style="display:none">
 </p>
</div>


