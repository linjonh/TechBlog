---
layout: post
title: "Jetson-nano配置Docker和torch运行环境"
date: 2025-03-06 21:19:48 +0800
description: "这里将介绍Jeston安装docker并部署walk-these-way的jeston镜像。注意，该方法有版本问题，Jepack4.6.1的python3.6 torch无法与unitree官方提供的python3.8库兼容。"
keywords: "Jetson nano配置Docker和torch运行环境"
categories: ['未分类']
tags: ['运维', '容器', 'Docker']
artid: "146075933"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146075933
    alt: "Jetson-nano配置Docker和torch运行环境"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146075933
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146075933
cover: https://bing.ee123.net/img/rand?artid=146075933
image: https://bing.ee123.net/img/rand?artid=146075933
img: https://bing.ee123.net/img/rand?artid=146075933
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Jetson nano配置Docker和torch运行环境
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     这里将介绍Jeston安装docker并部署walk-these-way的jeston镜像。
    </p>
    <p>
     注意，该方法有版本问题，Jepack4.6.1的python3.6 torch无法与unitree官方提供的python3.8库兼容
    </p>
    <p>
    </p>
    <h2>
     1. Docker安装
    </h2>
    <p>
     这里安装的是docker engine，如果已经有了docker desktop也同样可以使用。
    </p>
    <p>
     <a href="https://docs.docker.com/engine/install/ubuntu/" rel="nofollow" title="Ubuntu | Docker Docs">
      Ubuntu | Docker Docs
     </a>
    </p>
    <p>
     Run the following command to uninstall all conflicting packages:
    </p>
    <pre><code class="language-bash">for pkg in docker.io docker-doc docker-compose docker-compose-v2 podman-docker containerd runc; do sudo apt-get remove $pkg; done</code></pre>
    <p>
     设置仓库：
    </p>
    <pre><code class="language-bash"># Add Docker's official GPG key:
sudo apt-get update
sudo apt-get install ca-certificates curl
sudo install -m 0755 -d /etc/apt/keyrings
sudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc
sudo chmod a+r /etc/apt/keyrings/docker.asc

# Add the repository to Apt sources:
echo \
  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \
  $(. /etc/os-release &amp;&amp; echo "${UBUNTU_CODENAME:-$VERSION_CODENAME}") stable" | \
  sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null
sudo apt-get update</code></pre>
    <p>
     安装：
    </p>
    <pre><code class="language-bash">sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin</code></pre>
    <p>
     测试：
    </p>
    <pre><code class="language-bash">sudo docker run hello-world</code></pre>
    <p>
     <img alt="" height="972" src="https://i-blog.csdnimg.cn/direct/1a8b183355524443b521550ea6c38224.png" width="1424"/>
    </p>
    <p>
    </p>
    <h2>
     2. 准备镜像
    </h2>
    <p>
     下载image：
    </p>
    <pre><a href="https://drive.usercontent.google.com/download?id=1XkVpyYyYqQQ4FcgLIDUxg-GR1WI89-XC&amp;export=download&amp;authuser=0" rel="nofollow" title="https://drive.usercontent.google.com/download?id=1XkVpyYyYqQQ4FcgLIDUxg-GR1WI89-XC&amp;export=download&amp;authuser=0">https://drive.usercontent.google.com/download?id=1XkVpyYyYqQQ4FcgLIDUxg-GR1WI89-XC&amp;export=download&amp;authuser=0</a></pre>
    <p>
     使用docker加载image：
    </p>
    <pre><code class="language-bash">docker load -i ~/Downloads/deployment_image.tar</code></pre>
    <p>
     <img alt="" height="557" src="https://i-blog.csdnimg.cn/direct/f0c93069be5c4d71ab56222483a5b4b1.png" width="1412"/>
    </p>
    <h2>
    </h2>
    <h2>
     3. 运行容器
    </h2>
    <p>
     walktheseway使用了makefile运行docker, 类似的，稍作修改以适应我的程序。
    </p>
    <p>
     将主机的/home/go1/lowlevel挂载到/home/isaac/lowlevel目录
    </p>
    <pre><code class="language-bash">run:
	docker stop foxy_controller || true
	docker rm foxy_controller || true
	docker run -it \
		--env="DISPLAY" \
		--env="QT_X11_NO_MITSHM=1" \
		--volume="/tmp/.X11-unix:/tmp/.X11-unix:rw" \
		--env="XAUTHORITY=${XAUTH}" \
		--volume="${XAUTH}:${XAUTH}" \
		--volume="/home/go1/lowlevel:/home/isaac/lowlevel" \
		--privileged \
		--runtime=nvidia \
		--net=host \
		--workdir="/home/isaac/lowlevel" \
		--name="foxy_controller" \
		jetson-model-deployment bash</code></pre>
    <p>
    </p>
    <p>
     将Makefile发送到nano后运行：
    </p>
    <pre><code class="language-bash">scp -r Makefile go1@192.168.0.154:/home/go1/lowlevel/</code></pre>
    <pre><code class="language-bash">sudo make run</code></pre>
    <p>
     <img alt="" height="958" src="https://i-blog.csdnimg.cn/direct/a80ebe5390ba45b9ac738cab4cb25438.png" width="1811"/>
    </p>
    <p>
    </p>
    <h2>
     4. 测试容器
    </h2>
    <pre>进入容器后运行python检查cuda：

<img alt="" height="930" src="https://i-blog.csdnimg.cn/direct/b052e385cedf45e28602871db0ae64c9.png" width="1476">
<img alt="" height="246" src="https://i-blog.csdnimg.cn/direct/11565779c36f4609a5c548cb595e4de0.png" width="1546">

发送测试文件
</img></img></pre>
    <pre><code class="language-bash">​​​​​​​scp -r lowlevel go1@192.168.0.154:/home/go1/</code></pre>
    <p>
     运行：
    </p>
    <pre><code class="language-bash">python3 play_policy_isolated.py</code></pre>
    <p>
    </p>
    <p>
     再次发现报错，原因是目前的image使用了python3.6，这与unitree提供的3.8版本库不兼容。
    </p>
    <p>
     walktheseway使用的软件包是cp36
    </p>
    <pre>FROM nvcr.io/nvidia/l4t-pytorch:r32.6.1-pth1.9-py3</pre>
    <p>
     查看jeson pytorch相关兼容性：
    </p>
    <p>
     <a href="https://forums.developer.nvidia.com/t/pytorch-for-jetson/72048" rel="nofollow" title="PyTorch for Jetson - Announcements - NVIDIA Developer Forums">
      PyTorch for Jetson - Announcements - NVIDIA Developer Forums
     </a>
    </p>
    <p>
     发现在JetPack 5才更新至python3.8。
    </p>
    <p>
     <a href="https://docs.nvidia.com/deeplearning/frameworks/install-pytorch-jetson-platform-release-notes/pytorch-jetson-rel.html#pytorch-jetson-rel" rel="nofollow" title="PyTorch for Jetson Platform - NVIDIA Docs">
      PyTorch for Jetson Platform - NVIDIA Docs
     </a>
    </p>
    <p>
     <a href="https://catalog.ngc.nvidia.com/orgs/nvidia/containers/l4t-pytorch" rel="nofollow" title="NVIDIA L4T PyTorch | NVIDIA NGC">
      NVIDIA L4T PyTorch | NVIDIA NGC
     </a>
    </p>
    <p>
     <a href="https://github.com/dusty-nv/jetson-containers" title="GitHub - dusty-nv/jetson-containers: Machine Learning Containers for NVIDIA Jetson and JetPack-L4T">
      GitHub - dusty-nv/jetson-containers: Machine Learning Containers for NVIDIA Jetson and JetPack-L4T
     </a>
    </p>
    <pre><code class="language-bash">run_31:
	docker stop py31_controller || true
	docker rm py31_controller || true
	docker run -it \
		--env="DISPLAY" \
		--env="QT_X11_NO_MITSHM=1" \
		--volume="/tmp/.X11-unix:/tmp/.X11-unix:rw" \
		--env="XAUTHORITY=${XAUTH}" \
		--volume="${XAUTH}:${XAUTH}" \
		--volume="/home/go1/lowlevel:/home/isaac/lowlevel" \
		--privileged \
		--runtime=nvidia \
		--net=host \
		--workdir="/home/isaac/lowlevel" \
		--name="foxy_controller" \
		dustynv/l4t-pytorch:r36.2.0 bash</code></pre>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f626c61636b306d6f6f6e6c696768742f:61727469636c652f64657461696c732f313436303735393333" class_="artid" style="display:none">
 </p>
</div>


