---
layout: post
title: "UI自动化框架第五张AndroidUiAutomation-类功能简介"
date: 2025-03-07 17:04:35 +0800
description: "类封装了设备交互的基本操作（如连接、截图、点击、滑动），基于 uiautomator2 实现。类负责根据系统和语言初始化环境，并提供操作步骤的执行接口。支持通过文本识别和图片识别定位 UI 元素，并执行点击等操作。simulation_operation_step 方法设计为可扩展，支持更多操作类型（如输入、滑动）。AndroidUiAutomation 类中包含了连接错误处理和资源清理功能，确保操作的稳定性和资源释放。"
keywords: "【UI自动化框架第五张】AndroidUiAutomation 类功能简介"
categories: ['未分类']
tags: ['运维', '自动化', 'Ui']
artid: "146100229"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146100229
    alt: "UI自动化框架第五张AndroidUiAutomation-类功能简介"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146100229
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146100229
cover: https://bing.ee123.net/img/rand?artid=146100229
image: https://bing.ee123.net/img/rand?artid=146100229
img: https://bing.ee123.net/img/rand?artid=146100229
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     【UI自动化框架第五张】AndroidUiAutomation 类功能简介
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="AndroidUiAutomation___0">
     </a>
     一、AndroidUiAutomation 类 功能简介
    </h2>
    <ul>
     <li>
      <p>
       <strong>
        功能：
       </strong>
       为 Android 设备提供 UI 自动化操作的工具类，支持连接设备、获取截图、点击、滑动、获取屏幕分辨率和清理资源等功能。
      </p>
     </li>
     <li>
      <p>
       <strong>
        参数：
       </strong>
      </p>
      <ul>
       <li>
        <code>
         device_id（可选）：
        </code>
        设备 ID（如 “emulator-5554”），如果未指定则自动检测。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        异常：
       </strong>
      </p>
      <ul>
       <li>
        <code>
         ConnectionError：
        </code>
        如果无法连接设备。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        说明：
       </strong>
       <br/>
       AndroidUiAutomation 类基于 uiautomator2 库与 Android 设备交互，提供了一系列方法来执行常见的 UI 操作，适用于 UI 测试和自动化任务。
      </p>
     </li>
    </ul>
    <hr/>
    <h2>
     <a id="_19">
     </a>
     二、代码功能解析
    </h2>
    <h3>
     <a id="1___init____21">
     </a>
     1.
     <code>
      __init__
     </code>
     方法
    </h3>
    <ul>
     <li>
      <p>
       **功能：**初始化
       <code>
        AndroidUiAutomation
       </code>
       类并连接设备。
      </p>
     </li>
     <li>
      <p>
       <strong>
        参数：
       </strong>
      </p>
      <ul>
       <li>
        <code>
         device_id（可选）
        </code>
        ：设备 ID（字符串类型）。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        代码片段：
       </strong>
      </p>
      <pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> device_id<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>device <span class="token operator">=</span> u2<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>device_id<span class="token punctuation">)</span> <span class="token keyword">if</span> device_id <span class="token keyword">else</span> u2<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"成功连接设备: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>self<span class="token punctuation">.</span>device<span class="token punctuation">.</span>device_info<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ConnectionError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"无法连接设备: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
</code></pre>
     </li>
     <li>
      <p>
       <strong>
        说明：
       </strong>
      </p>
      <ul>
       <li>
        <p>
         如果提供了
         <code>
          device_id
         </code>
         ，则连接指定设备；否则，自动检测并连接设备。
        </p>
       </li>
       <li>
        <p>
         连接失败时抛出
         <code>
          ConnectionError 异常
         </code>
         。
        </p>
       </li>
      </ul>
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="2_get_screenshot__48">
     </a>
     2.
     <code>
      get_screenshot
     </code>
     方法
    </h3>
    <ul>
     <li>
      <p>
       **功能：**获取设备屏幕的实时截图，并可选择保存到文件。
      </p>
     </li>
     <li>
      <p>
       <strong>
        参数：
       </strong>
      </p>
      <ul>
       <li>
        <code>
         save_path
        </code>
        （可选）：保存截图的路径（字符串类型），如果为 None 则不保存。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        返回值：
       </strong>
      </p>
      <ul>
       <li>
        <code>
         numpy.ndarray：
        </code>
        OpenCV 格式的截图（BGR 格式）。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        异常：
       </strong>
      </p>
      <ul>
       <li>
        <code>
         Exception：
        </code>
        如果截图失败。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        代码片段：
       </strong>
      </p>
      <pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">get_screenshot</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> save_path<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        screenshot <span class="token operator">=</span> self<span class="token punctuation">.</span>device<span class="token punctuation">.</span>screenshot<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token operator">=</span><span class="token string">'opencv'</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> save_path<span class="token punctuation">:</span>
            cv2<span class="token punctuation">.</span>imwrite<span class="token punctuation">(</span>save_path<span class="token punctuation">,</span> screenshot<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"截图已保存到: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>save_path<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> screenshot
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"获取截图失败: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
</code></pre>
     </li>
     <li>
      <p>
       <strong>
        说明：
       </strong>
      </p>
      <ul>
       <li>
        <p>
         返回设备的实时截图（OpenCV 格式）。
        </p>
       </li>
       <li>
        <p>
         如果指定了
         <code>
          save_path
         </code>
         ，则保存截图到该路径。
        </p>
       </li>
      </ul>
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="3_click__86">
     </a>
     3.
     <code>
      click
     </code>
     方法
    </h3>
    <ul>
     <li>
      <p>
       **功能：**点击设备屏幕上的指定坐标。
      </p>
     </li>
     <li>
      <p>
       <strong>
        参数：
       </strong>
      </p>
      <ul>
       <li>
        <p>
         <code>
          x：X 坐标（整数类型）。
         </code>
        </p>
       </li>
       <li>
        <p>
         <code>
          y：Y 坐标（整数类型）。
         </code>
        </p>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        返回值：
       </strong>
      </p>
      <ul>
       <li>
        <code>
         bool：
        </code>
        操作是否成功。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        异常：
       </strong>
      </p>
      <ul>
       <li>
        <code>
         ValueError：
        </code>
        如果坐标无效或超出屏幕范围。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        代码片段：
       </strong>
      </p>
      <pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">click</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        width<span class="token punctuation">,</span> height <span class="token operator">=</span> self<span class="token punctuation">.</span>device<span class="token punctuation">.</span>window_size<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">&lt;=</span> x <span class="token operator">&lt;</span> width <span class="token keyword">and</span> <span class="token number">0</span> <span class="token operator">&lt;=</span> y <span class="token operator">&lt;</span> height<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"坐标 (</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>x<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>y<span class="token punctuation">}</span></span><span class="token string">) 超出屏幕范围 </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>width<span class="token punctuation">}</span></span><span class="token string">x</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>height<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>device<span class="token punctuation">.</span>click<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"成功点击坐标 (</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>x<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>y<span class="token punctuation">}</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"点击失败: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>
</code></pre>
     </li>
     <li>
      <p>
       <strong>
        说明：
       </strong>
      </p>
      <ul>
       <li>
        检查坐标是否在屏幕范围内，若有效则执行点击操作并返回 True，否则返回 False。
       </li>
      </ul>
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="4_swipe_coordinates__126">
     </a>
     4.
     <code>
      swipe_coordinates
     </code>
     方法
    </h3>
    <ul>
     <li>
      <p>
       **功能：**在设备屏幕上从起始坐标滑动到结束坐标。
      </p>
     </li>
     <li>
      <p>
       <strong>
        参数：
       </strong>
      </p>
      <ul>
       <li>
        <p>
         <code>
          start_x：
         </code>
         起始点 X 坐标（整数类型）。
        </p>
       </li>
       <li>
        <p>
         <code>
          start_y：
         </code>
         起始点 Y 坐标（整数类型）。
        </p>
       </li>
       <li>
        <p>
         <code>
          end_x：
         </code>
         结束点 X 坐标（整数类型）。
        </p>
       </li>
       <li>
        <p>
         <code>
          end_y：
         </code>
         结束点 Y 坐标（整数类型）。
        </p>
       </li>
       <li>
        <p>
         <code>
          duration（可选）：
         </code>
         滑动时长（毫秒，默认为 500ms）。
        </p>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        返回值：
       </strong>
      </p>
      <ul>
       <li>
        <code>
         bool：
        </code>
        操作是否成功。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        异常：
       </strong>
      </p>
      <ul>
       <li>
        <code>
         ValueError：
        </code>
        如果坐标无效或超出屏幕范围。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        代码片段：
       </strong>
      </p>
      <pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">swipe_coordinates</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> start_x<span class="token punctuation">,</span> start_y<span class="token punctuation">,</span> end_x<span class="token punctuation">,</span> end_y<span class="token punctuation">,</span> duration<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        width<span class="token punctuation">,</span> height <span class="token operator">=</span> self<span class="token punctuation">.</span>device<span class="token punctuation">.</span>window_size<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">&lt;=</span> start_x <span class="token operator">&lt;</span> width <span class="token keyword">and</span> <span class="token number">0</span> <span class="token operator">&lt;=</span> start_y <span class="token operator">&lt;</span> height <span class="token keyword">and</span> 
                <span class="token number">0</span> <span class="token operator">&lt;=</span> end_x <span class="token operator">&lt;</span> width <span class="token keyword">and</span> <span class="token number">0</span> <span class="token operator">&lt;=</span> end_y <span class="token operator">&lt;</span> height<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"坐标超出屏幕范围 </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>width<span class="token punctuation">}</span></span><span class="token string">x</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>height<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>device<span class="token punctuation">.</span>swipe<span class="token punctuation">(</span>start_x<span class="token punctuation">,</span> start_y<span class="token punctuation">,</span> end_x<span class="token punctuation">,</span> end_y<span class="token punctuation">,</span> duration<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"成功从 (</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>start_x<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>start_y<span class="token punctuation">}</span></span><span class="token string">) 滑动到 (</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>end_x<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>end_y<span class="token punctuation">}</span></span><span class="token string">)，时长 </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>duration<span class="token punctuation">}</span></span><span class="token string">ms"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"滑动失败: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>
</code></pre>
     </li>
     <li>
      <p>
       <strong>
        说明：
       </strong>
      </p>
      <ul>
       <li>
        检查坐标有效性后执行滑动操作，返回操作结果。
       </li>
      </ul>
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="5_get_screen_resolution__173">
     </a>
     5.
     <code>
      get_screen_resolution
     </code>
     方法
    </h3>
    <ul>
     <li>
      <p>
       **功能：**获取设备屏幕的分辨率。
      </p>
     </li>
     <li>
      <p>
       <strong>
        返回值：
       </strong>
      </p>
      <ul>
       <li>
        <code>
         tuple：
        </code>
        屏幕分辨率（width, height）。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        代码片段：
       </strong>
      </p>
      <pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">get_screen_resolution</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        width<span class="token punctuation">,</span> height <span class="token operator">=</span> self<span class="token punctuation">.</span>device<span class="token punctuation">.</span>window_size<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"屏幕分辨率: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>width<span class="token punctuation">}</span></span><span class="token string">x</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>height<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> width<span class="token punctuation">,</span> height
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"获取分辨率失败: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span>
</code></pre>
     </li>
     <li>
      <p>
       <strong>
        说明：
       </strong>
      </p>
      <ul>
       <li>
        返回屏幕的宽度和高度，失败时返回 (None, None)。
       </li>
      </ul>
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="6_cleanup__200">
     </a>
     6. cleanup 方法
    </h3>
    <ul>
     <li>
      <p>
       **功能：**清理资源，断开设备连接。
      </p>
     </li>
     <li>
      <p>
       <strong>
        返回值：
       </strong>
      </p>
      <ul>
       <li>
        <code>
         bool：
        </code>
        操作是否成功。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        代码片段：
       </strong>
      </p>
      <pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">cleanup</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>device<span class="token punctuation">.</span>disconnect<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"设备连接已断开"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"清理失败: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>
</code></pre>
     </li>
     <li>
      <p>
       清理资源，断开设备连接
      </p>
      <ul>
       <li>
        断开设备连接并释放资源，返回操作结果。
       </li>
      </ul>
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="UiAutomation__227">
     </a>
     <code>
      UiAutomation
     </code>
     类
    </h3>
    <ul>
     <li>
      <p>
       **功能：**根据系统和语言初始化 UI 自动化操作，并提供模拟操作步骤的方法。
      </p>
     </li>
     <li>
      <p>
       <strong>
        参数：
       </strong>
      </p>
      <ul>
       <li>
        <p>
         **system：**操作系统类型（字符串类型，如 “android”）。
        </p>
       </li>
       <li>
        <p>
         **language：**语言类型（字符串类型，如 “en”）。
        </p>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        说明：
       </strong>
       <br/>
       <code>
        UiAutomation
       </code>
       类设计为根据系统和语言配置初始化 UI 操作环境，并通过
       <code>
        simulation_operation_step
       </code>
       方法执行具体操作步骤。
      </p>
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="1___init____242">
     </a>
     1
     <code>
      . __init__
     </code>
     方法
    </h3>
    <ul>
     <li>
      <p>
       **功能：**初始化
       <code>
        UiAutomation
       </code>
       类。
      </p>
     </li>
     <li>
      <p>
       <strong>
        参数：
       </strong>
      </p>
      <ul>
       <li>
        <p>
         <code>
          system：
         </code>
         操作系统类型（字符串类型）。
        </p>
       </li>
       <li>
        <p>
         <code>
          language：
         </code>
         语言类型（字符串类型）。
        </p>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        代码片段：
       </strong>
      </p>
      <pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> system<span class="token punctuation">,</span> language<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> system <span class="token operator">==</span> <span class="token string">"android"</span><span class="token punctuation">:</span>
        <span class="token comment"># self.drive = AndroidUiAutomation()</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"system: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>system<span class="token punctuation">}</span></span><span class="token string">, language: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>language<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token comment"># self.action = UITools(self.drive, language)</span>
</code></pre>
     </li>
     <li>
      <p>
       <strong>
        说明：
       </strong>
      </p>
      <ul>
       <li>
        <p>
         根据
         <code>
          system
         </code>
         判断操作系统类型，当前仅支持 “android”。
        </p>
       </li>
       <li>
        <p>
         <code>
          self.drive
         </code>
         和
         <code>
          self.action
         </code>
         被注释掉，仅打印系统和语言信息。
        </p>
       </li>
       <li>
        <p>
         注意：初始化逻辑不完整，建议启用并完善相关代码。
        </p>
       </li>
      </ul>
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="2_simulation_operation_step__272">
     </a>
     2.
     <code>
      simulation_operation_step
     </code>
     方法
    </h3>
    <ul>
     <li>
      <p>
       **功能：**根据步骤执行 UI 操作。
      </p>
     </li>
     <li>
      <p>
       <strong>
        参数：
       </strong>
      </p>
      <ul>
       <li>
        <p>
         <code>
          step：
         </code>
         操作步骤（字典类型，包含 “type”、“action” 和 “value” 键）。
        </p>
       </li>
       <li>
        <p>
         <code>
          keywords（可选）：
         </code>
         操作关键词列表（默认为 [“type”, “action”, “value”]）。
        </p>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        代码片段：
       </strong>
      </p>
      <pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">simulation_operation_step</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> step<span class="token punctuation">,</span> keywords<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> keywords <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        keywords <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"type"</span><span class="token punctuation">,</span> <span class="token string">"action"</span><span class="token punctuation">,</span> <span class="token string">"value"</span><span class="token punctuation">]</span>
    <span class="token builtin">type</span> <span class="token operator">=</span> step<span class="token punctuation">[</span>keywords<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span>        <span class="token comment"># 识别方法：文字识别/图片识别</span>
    action <span class="token operator">=</span> step<span class="token punctuation">[</span>keywords<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>      <span class="token comment"># 操作方法：点击/输入/滑动</span>
    value <span class="token operator">=</span> step<span class="token punctuation">[</span>keywords<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span>       <span class="token comment"># 数据</span>
    <span class="token keyword">if</span> <span class="token builtin">type</span> <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">"text"</span><span class="token punctuation">,</span> <span class="token string">"ocr"</span><span class="token punctuation">,</span> <span class="token string">"文本"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> action <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token string">"点击"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token comment"># self.action.click_text(value)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"text: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>value<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token builtin">type</span> <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">"image"</span><span class="token punctuation">,</span> <span class="token string">"图片"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> action <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token string">"点击"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token comment"># self.action.click_image(value)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"image: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>value<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"不支持的操作类型"</span><span class="token punctuation">)</span>
</code></pre>
     </li>
     <li>
      <p>
       <strong>
        说明：
       </strong>
      </p>
      <ul>
       <li>
        <p>
         根据 step 中的 type 和 action 执行操作，支持文本识别（“text”、“ocr”、“文本”）和图片识别（“image”、“图片”）。
        </p>
       </li>
       <li>
        <p>
         当前仅支持点击操作，实际操作被注释掉，仅打印信息。
        </p>
       </li>
       <li>
        <p>
         注意：需实现 self.action 的相关方法以完成功能。
        </p>
       </li>
      </ul>
     </li>
    </ul>
    <hr/>
    <h2>
     <a id="_313">
     </a>
     三、思路总结
    </h2>
    <h4>
     <a id="_315">
     </a>
     核心思路：
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        模块化设计：
       </strong>
      </p>
      <ul>
       <li>
        <p>
         <code>
          AndroidUiAutomation
         </code>
         类封装了设备交互的基本操作（如连接、截图、点击、滑动），基于 uiautomator2 实现。
        </p>
       </li>
       <li>
        <p>
         <code>
          UiAutomation
         </code>
         类负责根据系统和语言初始化环境，并提供操作步骤的执行接口。
        </p>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        灵活的操作支持：
       </strong>
      </p>
      <ul>
       <li>
        <p>
         支持通过文本识别和图片识别定位 UI 元素，并执行点击等操作。
        </p>
       </li>
       <li>
        <p>
         simulation_operation_step 方法设计为可扩展，支持更多操作类型（如输入、滑动）。
        </p>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        异常处理和资源管理：
       </strong>
      </p>
      <ul>
       <li>
        AndroidUiAutomation 类中包含了连接错误处理和资源清理功能，确保操作的稳定性和资源释放。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        当前实现状态：
       </strong>
      </p>
      <ul>
       <li>
        <p>
         UiAutomation 类的核心功能（self.drive 和 self.action）被注释掉，仅打印信息，未实现实际操作。
        </p>
       </li>
       <li>
        <p>
         代码注释表明作者计划集成 AndroidUiAutomation 和 UITools 来完成完整功能，但尚未实现。
        </p>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        改进建议：
       </strong>
      </p>
      <ul>
       <li>
        <p>
         完善 UiAutomation 类的初始化逻辑，启用 self.drive 和 self.action。
        </p>
       </li>
       <li>
        <p>
         实现 UITools 中的 click_text 和 click_image 方法，以支持文本和图片识别的点击操作。
        </p>
       </li>
       <li>
        <p>
         💢
         <strong>
          扩展 simulation_operation_step 方法，支持更多操作类型（如输入、滑动）
         </strong>
         。
        </p>
       </li>
      </ul>
     </li>
    </ol>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f33393935303537322f:61727469636c652f64657461696c732f313436313030323239" class_="artid" style="display:none">
 </p>
</div>


