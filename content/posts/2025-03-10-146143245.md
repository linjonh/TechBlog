---
layout: post
title: "Sparkscp命令,rsync命令,ssh命令"
date: 2025-03-10 13:38:23 +0800
description: "eg命令：scp -r /opt/module/jdk1.8.0_212/ root@hadoop102:/opt/module/jdk1.8.0_212/命令：rsync -av /opt/conf/1.txt root@roothadoop102:/opt/conf/eg：目标：hadoop100通过ssh访问hadoop101,hadoop102时不需要密码，其他两台设备也类似。此时，我们去查看文件，可以看到它的颜色是灰色的，不具备执行权限（如下图）。这个部分的代码不需要会写，能看懂，了解即可。"
keywords: "Spark；scp命令，rsync命令，ssh命令"
categories: ['未分类']
tags: ['大数据', '分布式', 'Spark']
artid: "146143245"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146143245
    alt: "Sparkscp命令,rsync命令,ssh命令"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146143245
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146143245
cover: https://bing.ee123.net/img/rand?artid=146143245
image: https://bing.ee123.net/img/rand?artid=146143245
img: https://bing.ee123.net/img/rand?artid=146143245
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Spark；scp命令，rsync命令，ssh命令
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h3>
     <span style="color:#fe2c24">
      hadoop的运行模式
     </span>
    </h3>
    <p>
     <strong>
      本地运行：
     </strong>
     在一台单机上运行，没有分布式文件系统，直接读写本地操作系统的文件系统。
     <strong>
      特点
     </strong>
     ：不对配置文件进行修改，Hadoop 不会启动
    </p>
    <p>
     <strong>
      伪分布式
     </strong>
     ：也是在一台单机上运行，但用不同的 Java 进程模仿分布式运行中的各类节点，
     <strong>
      特点
     </strong>
     ：Hadoop 启动的这些守护进程都在同一台机器上运行，是相互独立的 Java 进程。
    </p>
    <p>
     <strong>
      完全分布式：
     </strong>
     数据存储在HDFS，多台服务器工作，企业中大量使用
    </p>
    <h3>
     <span style="color:#fe2c24">
      scp命令
     </span>
    </h3>
    <p>
     scp命令 ：可实现服务器与服务器之间的数据拷贝
    </p>
    <p>
     -r 表示递归拷贝
    </p>
    <p>
     $pdir/$fname ：要拷贝的文件路径 / 名称
    </p>
    <p>
     $user@host:$pdir/$fname ：目的地用户@主机:目的地路径 / 名称
    </p>
    <p>
     <span style="color:#1c7892">
      <span style="background-color:#ffd900">
       eg命令：scp -r /opt/module/jdk1.8.0_212/ root@hadoop102:/opt/module/jdk1.8.0_212/
      </span>
     </span>
    </p>
    <h3>
     <span style="color:#fe2c24">
      rsync命令
     </span>
    </h3>
    <p>
     rsync 主要用于备份和镜像
    </p>
    <p>
     rsync和scp的区别是rsync只对差异文件做更新，而scp是把所有文件都复制过去。故rsync效率更高
    </p>
    <p>
     -a ：归档拷贝，尽可能让拷贝的
    </p>
    <p>
     -v ：显示拷贝过程
    </p>
    <p>
     $pdir/$fname ：要拷贝的文件路径 / 名称
    </p>
    <p>
     <span style="color:#1c7892">
      <span style="background-color:#ffd900">
       命令：rsync -av /opt/conf/1.txt root@roothadoop102:/opt/conf/
      </span>
     </span>
     <br/>
    </p>
    <div>
     <h4>
      <strong>
       <span style="color:#000000">
        <strong>
         xsync
        </strong>
       </span>
      </strong>
      <strong>
       <span style="color:#000000">
        <strong>
         脚本
        </strong>
       </span>
      </strong>
      <strong>
       <span style="color:#000000">
        <strong>
         集群
        </strong>
       </span>
      </strong>
      <strong>
       <span style="color:#000000">
        <strong>
         之间的同步
        </strong>
       </span>
      </strong>
     </h4>
    </div>
    <div>
     <p style="margin-left:0pt">
      <span style="color:#494949">
       （1）在/root/bin目录下创建xsync文件。
      </span>
     </p>
     <p style="margin-left:0pt">
      <span style="color:#494949">
       （2）在该文件中编写如下代码。这个部分的代码不需要会写，能看懂，了解即可。
      </span>
     </p>
     <pre><code>#!/bin/bash
#1. 判断参数个数
if [ $# -lt 1 ]
then
    echo Not Enough Arguement!
    exit;
fi
#2. 遍历集群所有机器
for host in hadoop100 hadoop101 hadoop102
do
    echo ====================  $host  ====================
    #3. 遍历所有目录，挨个发送
    for file in $@
    do
        #4. 判断文件是否存在
        if [ -e $file ]
            then
                #5. 获取父目录
                pdir=$(cd -P $(dirname $file); pwd)
                #6. 获取当前文件的名称
                fname=$(basename $file)
                ssh $host "mkdir -p $pdir"
                rsync -av $pdir/$fname $host:$pdir
            else
                echo $file does not exists!
        fi
    done
done</code></pre>
     <p style="margin-left:0pt">
      <span style="color:#494949">
       （3）修改执行权限。此时，我们去查看文件，可以看到它的颜色是灰色的，不具备执行权限（如下图）。
      </span>
     </p>
     <p style="text-align:center">
      <img alt="" src="https://i-blog.csdnimg.cn/direct/e650fdd76b6948c59f0ee956537bf80a.png"/>
     </p>
     <p style="margin-left:0pt; text-align:justify">
      <span style="color:#494949">
       接下来要通过命令： chmod +x xsync（或者是chmod 777 xsync）
      </span>
     </p>
     <p style="margin-left:0pt; text-align:justify">
      <span style="color:#494949">
       重新查看它的颜色，绿色即可执行，它现在已经变成执行的脚本了（如上右图）。
      </span>
     </p>
     <p style="margin-left:0.0000pt; text-align:justify">
      <img alt="" src="https://i-blog.csdnimg.cn/direct/2703bd5487b24b3a967dcb308ad66ea7.png"/>
     </p>
     <p style="margin-left:0pt; text-align:justify">
      <span style="color:#494949">
       （4）测试使用。把这个脚本同步到其他的机器中。
      </span>
     </p>
     <p>
      <span style="background-color:#f2f2f2">
       <a name="_Hlk44780859">
        <span style="color:#494949">
         [
        </span>
       </a>
       <span style="color:#494949">
        root@hadoop100 ~]$ xsync /root/bin/
       </span>
      </span>
     </p>
    </div>
    <h3>
     <span style="color:#fe2c24">
      ssh命令
     </span>
    </h3>
    <p>
     ssh命令无需密码也可登录
    </p>
    <div>
     <p style="text-align:justify">
      <span style="color:#494949">
       eg：目标：hadoop100通过ssh访问hadoop101,hadoop102时不需要密码，其他两台设备也类似。
      </span>
     </p>
     <p style="text-align:justify">
      <span style="color:#494949">
       具体操作如下：
      </span>
     </p>
     <p style="text-align:justify">
      <span style="color:#494949">
       1.在hadoop100中生成公钥和密码。ssh-keygen -t rsa 三次回车
      </span>
     </p>
    </div>
    <p>
     <span style="color:#494949">
      2.在hadoop100中，把自己的公钥传递给hadoop101,hadoop102。命令如下
     </span>
    </p>
    <p>
     <span style="color:#494949">
      ssh-copy-id hadoop101
     </span>
    </p>
    <p>
     <span style="color:#494949">
      ssh-copy-id hadoop102
     </span>
    </p>
    <p>
     <span style="color:#494949">
      hadoop101 无密登录 hadoop100,hadoop102 与(1)类似
     </span>
    </p>
    <p>
     <span style="color:#494949">
      hadoop102 无密登录 hadoop100,hadoop101 与(1)类似
     </span>
    </p>
    <p>
     eg：从hadoop100进入hadoop101的命令就是
    </p>
    <p>
     ssh root@hadoop102
    </p>
    <p>
     退出命令就是：
     <span style="color:#fe2c24">
      exit
     </span>
    </p>
    <p>
     <img alt="" class="left" height="142" src="https://i-blog.csdnimg.cn/direct/8301477567f94e169a4c1cfc9e3c7c90.png" width="392"/>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323430325f38373037363337362f:61727469636c652f64657461696c732f313436313433323435" class_="artid" style="display:none">
 </p>
</div>


