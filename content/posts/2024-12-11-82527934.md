---
layout: post
title: "阿里云centos7服务器关于80端口和443端口"
date: 2024-12-11 15:21:16 +0800
description: "昨天登录阿里云平台被告知我的服务器被别人在美国等地使用git登录过，我怀疑是我的密码泄露了，所以修改"
keywords: "443端口不通"
categories: ['服务器']
tags: ['无标签']
artid: "82527934"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=82527934
    alt: "阿里云centos7服务器关于80端口和443端口"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=82527934
featuredImagePreview: https://bing.ee123.net/img/rand?artid=82527934
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     阿里云centos7服务器关于80端口和443端口
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     昨天登录阿里云平台被告知我的服务器被别人在美国等地使用git登录过，我怀疑是我的密码泄露了，所以修改密码后重启服务器，随后写的小程序发现不能用了(小程序要求https方式访问)，排查了老半天，发现443端口不通，随后自己折腾了一下午，解决了，自己记录一下。
    </p>
    <p>
     打开端口的步骤：
    </p>
    <ol>
     <li>
      <p>
       查看防火墙状态
      </p>
      <pre><code>firewall-cmd --state
</code></pre>
     </li>
    </ol>
    <p>
     2.打开防火墙
     <br/>
     重启服务则会断开tcp会话。
    </p>
    <pre><code>systemctl restart firewalld

firewall-cmd --reload           
</code></pre>
    <p>
     建议使用后一种“重载配置文件”。重载配置文件之后不会断掉正在连接的tcp会话，而
    </p>
    <p>
     3.查看已经打开的端口
    </p>
    <pre><code>firewall-cmd --list-ports
</code></pre>
    <p>
     4.打开443或80端口
    </p>
    <pre><code>firewall-cmd --add-port=443/tcp    开放通过tcp访问443
firewall-cmd --add-port=80/tcp    开放通过tcp访问80
</code></pre>
    <p>
     5.80端口转发到8080（tomcat的默认端口为8080）,443转发到8443（https配置的端口为8443）
    </p>
    <pre><code>firewall-cmd --add-forward-port=port=80:proto=tcp:toport=8080
firewall-cmd --add-forward-port=port=443:proto=tcp:toport=8443
</code></pre>
    <p>
     <strong>
      ps：这里其实没必要转发，但是我修改tomcat中的文件将8080修改为80,8443修改为443，直接访问80或者443端口时就是不通。所以我只能通过转发。如果有知道的朋友留言告知一下，感激不尽！
     </strong>
    </p>
    <p>
     6.开放阿里云平台上的配置安全组规则开放相应的端口
     <br/>
     <img alt="这里写图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/3cefa7a2ce5b2b9d679141666c860d39.png"/>
    </p>
    <p>
     到这里应该就可以了。
    </p>
    <p>
     <strong>
      下面是记录一下常用的防火墙命令
     </strong>
     <br/>
     打开某端口
    </p>
    <pre><code>firewall-cmd --zone=public(作用域) --add-port=80/tcp(端口和访问类型) --permanent(永久生效)
</code></pre>
    <p>
     查看防火墙状态
    </p>
    <pre><code>firewall-cmd    --state
</code></pre>
    <p>
     开启防火墙
    </p>
    <pre><code>systemctl  start   firewalld.service
</code></pre>
    <p>
     关闭防火墙
    </p>
    <pre><code>systemctl  stop   firewalld.service
</code></pre>
    <p>
     禁止开机启动启动防火墙
    </p>
    <pre><code>systemctl   disable   firewalld.service
</code></pre>
    <p>
     检查是否允许伪装IP
    </p>
    <pre><code>firewall-cmd --query-masquerade 
</code></pre>
    <p>
     允许防火墙伪装IP
    </p>
    <pre><code>firewall-cmd --add-masquerade 
</code></pre>
    <p>
     禁止防火墙伪装IP
    </p>
    <pre><code>firewall-cmd --remove-masquerade
</code></pre>
    <p>
     开放mysql端口
    </p>
    <pre><code>firewall-cmd --add-service=mysql  
</code></pre>
    <p>
     阻止http端口
    </p>
    <pre><code>firewall-cmd --remove-service=http
</code></pre>
    <p>
     查看开放的服务
    </p>
    <pre><code>firewall-cmd --list-services   
</code></pre>
    <p>
     开放通过tcp访问3306
    </p>
    <pre><code>firewall-cmd --add-port=3306/tcp  
</code></pre>
    <p>
     阻止通过tcp访问3306
    </p>
    <pre><code>firewall-cmd --remove-port=80tcp  
</code></pre>
    <p>
     开放通过udp访问233
    </p>
    <pre><code>firewall-cmd --add-port=233/udp  
</code></pre>
    <p>
     查看开放的端口
    </p>
    <pre><code>firewall-cmd --list-ports  
</code></pre>
    <p>
     将80端口的流量转发至8080
    </p>
    <pre><code>firewall-cmd --add-forward-port=port=80:proto=tcp:toport=8080
</code></pre>
    <p>
     将80端口的流量转发至
    </p>
    <pre><code>firewall-cmd --add-forward-port=port=80:proto=tcp:toaddr=192.168.1.0.1192.168.0.1
</code></pre>
    <p>
     将80端口的流量转发至192.168.0.1的8080端口
    </p>
    <pre><code>firewall-cmd --add-forward-port=port=80:proto=tcp:toaddr=192.168.0.1:toport=8080
</code></pre>
    <p>
     监听端口
    </p>
    <pre><code>	netstat -an |grep  443
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="687474:70733a2f2f626c6f672e6373646e2e6e65742f716468313836:2f61727469636c652f64657461696c732f3832353237393334" class_="artid" style="display:none">
 </p>
</div>


