---
layout: post
title: "shell学习-第四天"
date: 2025-03-08 16:54:48 +0800
description: "语法命令[return 返回值]调用函数：funname 传递参数1 传递参数2...return 如果不加，将以最后一条命令运行结果作为返回值，（范围为0~255）有参函数shell程序与函数区别shell程序在子shell中运行，会开启独立的进程运行shell函数在当前shell的进程中运行。"
keywords: "shell学习-第四天"
categories: ['未分类']
tags: ['学习', 'Shell', 'Linux']
artid: "146081339"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146081339
    alt: "shell学习-第四天"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146081339
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146081339
cover: https://bing.ee123.net/img/rand?artid=146081339
image: https://bing.ee123.net/img/rand?artid=146081339
img: https://bing.ee123.net/img/rand?artid=146081339
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     shell学习-第四天
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h4>
     特殊变量
    </h4>
    <p>
     读取输入参数 $0~9
    </p>
    <p>
     0为获取文件名称
    </p>
    <p>
     如果获取第十个参数需要使用${10}
    </p>
    <p>
     ${#} 读取所有输入参数个数
    </p>
    <p>
     $*
    </p>
    <p>
     $@
    </p>
    <p>
     上述都是获取所有输入参数
    </p>
    <p>
     不使用双引号：功能一致
    </p>
    <p>
     使用双引号括起来，上面为获取的所有参数拼接为一个字符串，格式为“$1,$2...”
    </p>
    <p>
     下面的获取一组参数列表对象 "$1" "$2" ...
    </p>
    <p>
     $? 用于获取上一个shell命令的退出状态码，或者函数返回值
    </p>
    <p>
     每个shell命令的执行都有一个返回值，这个返回值用于说明命令执行是否成功
    </p>
    <p>
     一般来说，返回0代表命令执行成功。
    </p>
    <p>
     $$ 查看当前shell环境进程编号
    </p>
    <h4>
     shell环境分类
    </h4>
    <p>
     <strong>
      交互式与非交互式shell
     </strong>
    </p>
    <p>
     交互式shell
    </p>
    <p>
     与用户进行交互互动，效果是用户输入一个命令，shell立即反馈
    </p>
    <p>
     非交互式shell
    </p>
    <p>
     无需用户参与
    </p>
    <p>
     <strong>
      登录shell与非登录
     </strong>
    </p>
    <p>
     需要用户名密码的shell环境为登录环境
    </p>
    <p>
     不同的工作环境加载环境变量流程不一样
    </p>
    <h4>
     字符串三种格式区别
    </h4>
    <p>
     双引号包含变量
    </p>
    <p>
     单引号原样输出
    </p>
    <p>
     不被引号包围和双引号一致，但是不能包含空格
    </p>
    <p>
     <strong>
      字符串拼接
     </strong>
     ：推荐使用双引号拼接
    </p>
    <p>
     字符串截取
    </p>
    <p>
     <img alt="" height="772" src="https://i-blog.csdnimg.cn/direct/60c2e4783d01417297907190da6e0104.png" width="1183"/>
    </p>
    <p>
     数组：在shell中，使用括号来表示数组，数组元素之间用空格来分隔
    </p>
    <p>
     两种方式：
    </p>
    <p>
     array_name=(item1 item2 ...)
    </p>
    <p>
     array_name=([下标]=item1 ...)
    </p>
    <p>
     note：等号之间不能由空格
    </p>
    <p>
     数组内容可以是字符串
    </p>
    <p>
     语法
    </p>
    <p>
     获取下标元素值：${arr[index]}
    </p>
    <p>
     获取所有元素：${arr[*]} 或者为${arr[@]}
    </p>
    <p>
     获取数组长度：${#arr[*]}或者${#arr[@]}
    </p>
    <p>
     获取数组指定元素字符长度：${#arr[索引]}
    </p>
    <p>
     unset arr[index]删除数组指定元素
    </p>
    <p>
     unset arr 删除整个数组
    </p>
    <h4>
     内置命令
    </h4>
    <p>
     shell内置命令，就是由Bash Shell 自身提供的命令，而不是文件系统可执行脚本文件
    </p>
    <p>
     可以使用type确定一个命令是否为内置命令
    </p>
    <p>
     type 命令
    </p>
    <p>
     通常来说：内置命令会比外部命令执行更快，执行外部命令时会触发磁盘I/O,还需要fork出一个单独的进程
    </p>
    <h5 style="background-color:transparent">
     常见内置命令
    </h5>
    <p>
     alisa设置命令别名
    </p>
    <p>
     不带参数显示当前所有shell进程中的别名列表
    </p>
    <p>
     alias 别名=”命令“ 设置别名
    </p>
    <p>
     unalias 别名 删除别名
    </p>
    <p>
     unalias -a 删除所有别名
    </p>
    <p>
     以上为临时删除，如果向永久删除必须去配置文件中删除
    </p>
    <h5 style="background-color:transparent">
     echo 输出字符串
    </h5>
    <p>
     默认换行输出 echo 字符串
    </p>
    <p>
     不换行输出 echo -n 字符串
    </p>
    <p>
     默认不解析转义字符
    </p>
    <p>
     解析转义字符 echo -e 字符串
    </p>
    <h5 style="background-color:transparent">
     read读取控制台输入
    </h5>
    <p>
     从标准输入中读取数据并赋值给变量，如果没有重定向，默认从终端中读取，进行重定向可以从文件中读取
    </p>
    <p>
     语法 read [-options] [var1 var2 var...]
    </p>
    <p>
     var表示用来存储数据的变量
    </p>
    <p>
     如果没有提供变量名，那么读取的数据放到‘REPLY’中
    </p>
    <p>
     选项：
    </p>
    <p>
     -n num 读取num个字符，而不是整行字符
    </p>
    <p>
     -p prompt 显示提示信息，提示内容为prompt
    </p>
    <p>
     -s 静默模式，不会再屏幕上显示输入字符
    </p>
    <p>
     -t seconds 设置超时时间，单位为秒，如果没有在指定时间输入完成，那么read将会返回非零的退出状态，表示读取失败
    </p>
    <h5>
     exit 用于退出当前shell环境
    </h5>
    <p>
     返回一个状态码
    </p>
    <p>
     用$?获取
    </p>
    <p>
     应用场景，当文件执行出错的时候，可以返回不同的状态值来代表不同的错误
    </p>
    <h5>
     declare 设置变量
    </h5>
    <p>
     设置变量属性
    </p>
    <p>
     declare [+/-] [aArxif] [变量名称=设置值]
    </p>
    <p class="img-center">
     <img alt="" height="319" src="https://i-blog.csdnimg.cn/direct/0063ebb9651c4270994f8889b3f5db78.png" width="584"/>
    </p>
    <p>
     declare -A 关联数组变量名=([字符串]=值 [字符串]=值)
    </p>
    <p>
    </p>
    <p>
     查看全部shell变量和函数
    </p>
    <p>
     实现关联数组变量
    </p>
    <h4>
     shell计算命令
    </h4>
    <h5>
     expr命令详解：表达式求值
    </h5>
    <p>
     1.expr length 字符串 输出字符串长度
    </p>
    <p>
     2.expr substr 字符串 start end 截取字符串
    </p>
    <p>
     3.expr index 被查找字符串 需要查找的字符
    </p>
    <p>
     正则表达式匹配
    </p>
    <p>
     expr match 字符串 正则表达式
    </p>
    <p>
     <img alt="" height="336" src="https://i-blog.csdnimg.cn/direct/50ff0c17feb442fdaa6f1a5dd5cc91d1.png" width="822"/>
    </p>
    <h5 style="background-color:transparent">
     (())命令详解
    </h5>
    <p>
     进行整数的数学运算，使用$获取表达式命令的结果，这和使用$获取变量值是一样的
    </p>
    <p>
     语法$((表达式))
    </p>
    <p>
     (())内部自动解析变量，不使用$
    </p>
    <h5>
     let命令详解
    </h5>
    <p>
     let只能用于赋值计算，但没有(())功能强大，let只能用于赋值计算，不能直接输出，不可以条件判断
    </p>
    <p>
     let 赋值表达式
    </p>
    <p>
     let c=a+b
    </p>
    <h5>
     $[] 表示整数运算
    </h5>
    <h5>
     bc命令
    </h5>
    <p>
     bc [options] [参数]
    </p>
    <p>
     由于Bash shell内置了整数运算，Linux bc可以进行浮点运算
    </p>
    <p>
     而且还可以进行进制的转换
    </p>
    <p>
     -l 选项使用标准数学库
    </p>
    <p>
     -q 不显示欢迎信息
    </p>
    <p>
     参数为包含执行计算任务的文件
    </p>
    <p>
     <img alt="" height="387" src="https://i-blog.csdnimg.cn/direct/9418a08bc55c44df97a83b60cb23855f.png" width="1230"/>
    </p>
    <p>
     <img alt="" height="525" src="https://i-blog.csdnimg.cn/direct/d5a55999a6904e9f8e6884738fa40890.png" width="919"/>
    </p>
    <p>
     <strong>
      在shell内部，也是可以借助管道使用bc计算器的
     </strong>
    </p>
    <p>
     语法：echo "expression" | bc [options]
    </p>
    <p>
     expression必须符合bc命令的格式
    </p>
    <p>
     里面可以引用shell里面的命令
    </p>
    <p>
     将bc计算结果赋值给shell变量
    </p>
    <p>
     第一种方式使用 ` 命令 `
    </p>
    <p>
     第二种方式 $() 兼容性较差
    </p>
    <h5>
     shell中非互动式的输入重定向
    </h5>
    <p>
     将计算表达式输出给bc去执行，特点类似于文件中的输入
    </p>
    <p>
     将EOF多行表达式输入给bc执行，然后将执行结果赋值给var_name
    </p>
    <p>
     方式1：
    </p>
    <p>
     var_name=`bc [-options] &lt;&lt; EOF
    </p>
    <p>
     第一行表达式
    </p>
    <p>
     第二行表达式
    </p>
    <p>
     EOF
    </p>
    <p>
     `
    </p>
    <p>
     方式2：
    </p>
    <p>
     var_name=$(bc [-options] &lt;&lt; EOF
    </p>
    <p>
     第一行表达式
    </p>
    <p>
     第二行表达式
    </p>
    <p>
     EOF
    </p>
    <p>
     )
    </p>
    <h4 style="background-color:transparent">
     流程控制语句
    </h4>
    <pre><code class="language-cpp">if语法

一行 if 条件; then 命令; fi

多行写法
if 条件
then
        命令
else
        命令
fi

if elif else语法
if 条件
then
        命令
elif
        命令
else
        命令
fi</code></pre>
    <p>
     Linux任何命令的执行都会有一个退出状态，当它退出的时候，都会返回一个比较小的整数值给调用他的程序
    </p>
    <h4>
     test
    </h4>
    <p>
     功能
    </p>
    <p>
     对整数比较测试
    </p>
    <p>
     对字符串
    </p>
    <p>
     对文件测试
    </p>
    <p>
     test 数字1 options 数字2
    </p>
    <p>
     整数比较
    </p>
    <p>
     <img alt="" height="532" src="https://i-blog.csdnimg.cn/direct/f84aca28f47349599307de2753eecb23.png" width="1090"/>
    </p>
    <p>
     字符串比较
     <img alt="" height="535" src="https://i-blog.csdnimg.cn/direct/820558c7879344c1a8c3d899808ca995.png" width="1040"/>
    </p>
    <p>
     文件测试
     <img alt="" height="529" src="https://i-blog.csdnimg.cn/direct/e9139d13bf1f47c7a62eb3343b9b5be3.png" width="1244"/>
    </p>
    <h4>
     case
    </h4>
    <pre><code class="language-cpp">case 值 in
匹配模式1)
    命令
    ;;
匹配模式2)
    命令
    ;;
esac</code></pre>
    <p>
     <img alt="" height="372" src="https://i-blog.csdnimg.cn/direct/9620f8e4bb934108a0bae7f49d6710d1.png" width="1603"/>
    </p>
    <h4>
     while循环
    </h4>
    <pre><code class="language-cpp">while 条件
do
    命令
    continue; #表示结束本次循环
    break; 表示结束当前循环
done</code></pre>
    <h4>
     until语句
    </h4>
    <p>
     循环条件同while相反，循环为false才会一直循环
    </p>
    <pre><code class="language-cpp">until 条件
do
    命令
    continue; #表示结束本次循环
    break; 表示结束当前循环
done</code></pre>
    <h4>
     for语句
    </h4>
    <pre><code class="language-cpp">for var in test1 test2 test3
do
    命令
done


for var in {start..end}
do
    命令
done</code></pre>
    <h4>
     select语句
    </h4>
    <p>
     使用select进行菜单选择操作
    </p>
    <pre><code class="language-cpp">select var in menu1 menu2 ...
do
    命令
done

note：select式无限循环，输入空值，或者输入的值无效都不会结束循环，只有遇到break才会结束循环
</code></pre>
    <h4>
     shell函数
    </h4>
    <h5>
     系统函数
    </h5>
    <p>
     函数是有若干shell命令组成的语句块
    </p>
    <p>
     basename函数
    </p>
    <p>
     用于获取文件名
    </p>
    <p>
     basename [string / pathname] [suffix]
    </p>
    <p>
     dirname
    </p>
    <p>
     从指定文件绝对路径，去除文件名，返回剩下的目录
    </p>
    <h5 style="background-color:transparent">
     自定义函数
    </h5>
    <p>
     语法
    </p>
    <p>
     [ function ] funname()
    </p>
    <p>
     {
     <!-- -->
     <br/>
     命令
     <br/>
     [return 返回值]
     <br/>
     }
    </p>
    <p>
     调用函数：funname 传递参数1 传递参数2...
    </p>
    <p>
     return 如果不加，将以最后一条命令运行结果作为返回值，（范围为0~255）
    </p>
    <p>
     有参函数
    </p>
    <p>
     <img alt="" height="523" src="https://i-blog.csdnimg.cn/direct/9bd7924836a344d1aa28f457f3549a40.png" width="1596"/>
    </p>
    <p>
     shell程序与函数区别
    </p>
    <p>
     shell程序在子shell中运行，会开启独立的进程运行
    </p>
    <p>
     shell函数在当前shell的进程中运行
    </p>
    <h4>
     shell重定向
    </h4>
    <p>
     每个Linux系统在运行的时候都会打开三个文件
    </p>
    <p>
     1.stdin 获取键盘输入数据，文件描述符 0
    </p>
    <p>
     2.stdout 将正确数据输出到显示器上 1
    </p>
    <p>
     3.stderr 将错误信息输入到显示器上 2
    </p>
    <p>
     改变输入方向，数据从非键盘位置流入，这就是输入重定向
    </p>
    <p>
     改变输出方向，数据从非显示器位置流出，这就是输出重定向
    </p>
    <p>
     语法如下
    </p>
    <p>
     <img alt="" height="800" src="https://i-blog.csdnimg.cn/direct/296a8b65b07b47809c8cf2839c46f660.png" width="1599"/>
    </p>
    <h4>
     shell好用的工具
    </h4>
    <h5>
     cut
    </h5>
    <p>
     使用cut可以切割提取指定列，字符，字节的数据，可以将文本按列进行划分，cut命令逐行读入文本，然后按列划分
    </p>
    <p>
     cut [options] filename
    </p>
    <p>
     <img alt="" height="535" src="https://i-blog.csdnimg.cn/direct/4cb5e13f9e0e4400824c4c5a08b47c6a.png" width="1613"/>
    </p>
    <p>
     <img alt="" height="375" src="https://i-blog.csdnimg.cn/direct/6cc6408de79046e7bf28f5e678945e6b.png" width="1475"/>
    </p>
    <h5>
     sed
    </h5>
    <p>
     流编辑器，非交互流式文本编辑器 vim是交互式文本编辑器
    </p>
    <p>
     <img alt="" height="768" src="https://i-blog.csdnimg.cn/direct/c2e5ced76441443384c620c8279363ec.png" width="1515"/>
    </p>
    <p>
     语法：sed [选项参数] [模式匹配/sed程序命令] [文件名]
    </p>
    <p>
     <img alt="" height="563" src="https://i-blog.csdnimg.cn/direct/abbbf7f58965432eb9c70a26f28d886b.png" width="1550"/>
    </p>
    <p>
     <img alt="" height="688" src="https://i-blog.csdnimg.cn/direct/20ba96d7775343b2bd3680b14cefb40d.png" width="1442"/>
     $代表最后一行
    </p>
    <p>
     案例：
    </p>
    <p>
     删除奇数行
    </p>
    <p>
     sed ‘1~2d’ sed.txt
    </p>
    <p>
     删除1到3行
    </p>
    <p>
     sed '1,3d' sed.txt
    </p>
    <p>
     删除最后一行
    </p>
    <p>
     sed '$d' sed.txt
    </p>
    <p>
     删除匹配ww的行
    </p>
    <p>
     sed ‘/ww/d’ sed.txt
    </p>
    <p>
     查询匹配的内容
    </p>
    <p>
     sed -n '/ww/p' sed,txt
    </p>
    <p>
     替换ww为jj
    </p>
    <p>
     sed ‘s/ww/jj/g’ sed,txt
    </p>
    <p>
     这里的g表示全局替换
    </p>
    <p>
     sed -e 第一个命令 -e 第二个命令 sed.txt
    </p>
    <p>
     或者在命令中以分号隔开
    </p>
    <h5>
     sed缓存区数据交换
    </h5>
    <p>
     sed处理文件是逐行处理的
    </p>
    <p>
     sed没读取一行，就存放进入模式空间，sed还有一个空间叫做暂存空间，开始时只有一个空行
    </p>
    <p>
     使用sed命令可以实现这两个空间数据的交互
    </p>
    <p>
     <img alt="" height="457" src="https://i-blog.csdnimg.cn/direct/baea044b57804cd38b84ad23a493f981.png" width="1160"/>
    </p>
    <h5>
     awk
    </h5>
    <p>
     强大的文本分析工具
    </p>
    <p>
     语法 awk [options] 'pattern{action}' {filename}
    </p>
    <p>
     <img alt="" height="218" src="https://i-blog.csdnimg.cn/direct/1515eaaa0e1d4977bae772d952c9b22e.png" width="1497"/>
     <img alt="" height="1072" src="https://i-blog.csdnimg.cn/direct/8725c732d4a44957bbaf4c9e762af49c.png" width="1546"/>
    </p>
    <p>
     打印文件第二行
    </p>
    <p>
     awk -F ":" 'NR==2{printf("filename:%s\n","FILENAME")}' passwd
    </p>
    <h5>
     sort
    </h5>
    <p>
     排序
    </p>
    <p>
     sort （options）参数
     <img alt="" height="823" src="https://i-blog.csdnimg.cn/direct/2531e2cbdc7d44ca9b387cc4a1f86616.png" width="1417"/>
    </p>
    <p>
     根据第二列内容进行排序
    </p>
    <p>
     sort -t " " -k2n,2 -uk1,2 sort.txt
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f776a6d3034313030362f:61727469636c652f64657461696c732f313436303831333339" class_="artid" style="display:none">
 </p>
</div>


