---
layout: post
title: "CæŸ¥çœ‹åŠ¨æ€åº“å¯¼å‡ºå“ªäº›å‡½æ•°ä»¥åŠåŠ¨æ€åº“å¯¼å‡ºå½¢å¼"
date: 2025-03-05 20:49:46 +0800
description: "æŸ¥çœ‹åŠ¨æ€åº“å¯¼å‡ºå“ªäº›å‡½æ•°ä»¥åŠåŠ¨æ€åº“å¯¼å‡ºå½¢å¼"
keywords: "C++æŸ¥çœ‹åŠ¨æ€åº“å¯¼å‡ºå“ªäº›å‡½æ•°ä»¥åŠåŠ¨æ€åº“å¯¼å‡ºå½¢å¼"
categories: ['Windows', 'C']
tags: ['å¼€å‘è¯­è¨€', 'C']
artid: "146051242"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146051242
    alt: "CæŸ¥çœ‹åŠ¨æ€åº“å¯¼å‡ºå“ªäº›å‡½æ•°ä»¥åŠåŠ¨æ€åº“å¯¼å‡ºå½¢å¼"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146051242
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146051242
cover: https://bing.ee123.net/img/rand?artid=146051242
image: https://bing.ee123.net/img/rand?artid=146051242
img: https://bing.ee123.net/img/rand?artid=146051242
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     C++æŸ¥çœ‹åŠ¨æ€åº“å¯¼å‡ºå“ªäº›å‡½æ•°ä»¥åŠåŠ¨æ€åº“å¯¼å‡ºå½¢å¼
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="1_1">
     </a>
     1ã€æŸ¥çœ‹åŠ¨æ€åº“å¯¼å‡ºå“ªäº›å‡½æ•°
    </h2>
    <h4>
     <a id="11_Windows__Linux_dll__so_3">
     </a>
     1.1ã€åœ¨ Windows å’Œ Linux ä¸Šï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„æ–¹æ³•æ¥æŸ¥çœ‹åŠ¨æ€åº“ï¼ˆ.dll æˆ– .soï¼‰å¯¼å‡ºçš„å‡½æ•°
    </h4>
    <p>
     <strong>
      Windowsï¼šä½¿ç”¨ dumpbinï¼šWindows æä¾›äº† dumpbin å·¥å…·ï¼ˆVisual Studio è‡ªå¸¦ï¼‰ï¼Œå¯ä»¥ç”¨äºæŸ¥çœ‹ .dll å¯¼å‡ºçš„ç¬¦å·ã€‚
     </strong>
    </p>
    <p>
     <strong>
      æ–¹æ³• 1ï¼šä½¿ç”¨ dumpbin
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       æ‰“å¼€ x64/x86 Native Tools Command Promptï¼ˆVS å‘½ä»¤è¡Œå·¥å…·ï¼‰ã€‚
      </strong>
     </li>
     <li>
      <strong>
       è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
      </strong>
     </li>
    </ul>
    <pre><code>dumpbin /EXPORTS your_library.dll

</code></pre>
    <ul>
     <li>
      <strong>
       ä¼šçœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„è¾“å‡ºï¼š
      </strong>
     </li>
    </ul>
    <pre><code>Dump of file your_library.dll

Section contains the following exports:

  00000000 characteristics
  12345678 time date stamp
      0.00 version
        1 ordinal base
       10 number of functions
       10 number of names

  ordinal hint RVA      name
        1    0 1234ABCD FunctionA
        2    1 5678DCBA FunctionB

</code></pre>
    <ul>
     <li>
      <strong>
       å…¶ä¸­FunctionA å’Œ FunctionB å°±æ˜¯å¯¼å‡ºçš„å‡½æ•°ã€‚
      </strong>
     </li>
     <li>
      <strong>
       å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ä¾‹å­:
      </strong>
     </li>
    </ul>
    <pre><code>E:\SteamTest\SteamSDK - å‰¯æœ¬\SteamLogon\bin\Release&gt;dumpbin /exports sdologinsdk.dll
</code></pre>
    <ul>
     <li>
      <strong>
       è¾“å‡º:
      </strong>
     </li>
    </ul>
    <pre><code>E:\SteamTest\SteamSDK - å‰¯æœ¬\SteamLogon\bin\Release&gt;dumpbin /exports sdologinsdk.dll
Microsoft (R) COFF/PE Dumper Version 14.29.30151.0
Copyright (C) Microsoft Corporation.  All rights reserved.


Dump of file sdologinsdk.dll

File Type: DLL

  Section contains the following exports for sdologinsdk.dll

    00000000 characteristics
    67C7E536 time date stamp Wed Mar  5 13:46:30 2025
        0.00 version
           7 ordinal base
          20 number of functions
           5 number of names

    ordinal hint RVA      name

         21    0 0000C320 DoLogin = _DoLogin
         23    1 0000C630 GetAgreementStatus = _GetAgreementStatus
         24    2 0000C4B0 GetLoginedCompanyId = _GetLoginedCompanyId
         25    3 0000C5A0 OpenActivityWindow = _OpenActivityWindow
         26    4 0000C4F0 SetGameClientType = _SetGameClientType
          7      0000C240 [NONAME] _GhomeInitialize
          8      0000C280 [NONAME] _GhomeShowLoginDialog
          9      0000C2B0 [NONAME] _GhomeCloseLoginDialog
         10      0000C5D0 [NONAME] _GhomeDoPrivacyAgreement
         11      0000C680 [NONAME] _GhomeDoInit
         12      0000C260 [NONAME] _GhomeSetOwnerWindow
         13      0000C4C0 [NONAME] _GhomeSetLoginDialogState
         14      0000C480 [NONAME] _GhomeOpenWindow
         15      0000C300 [NONAME] _GhomeLogout
         16      0000C370 [NONAME] _GhomeGetTicket
         17      0000C6E0 [NONAME] _GhomeSetLoginArea
         18      0000C700 [NONAME] _GhomeGetLoinAreaList
         19      0000C350 [NONAME] _GhomeSetLoginMode
         20      0000C2D0 [NONAME] _GhomeMoveLoginDialog
         22      0000C340 [NONAME] _GHomeTerminal

  Summary

        8000 .data
       2F000 .rdata
       14000 .reloc
        1000 .rsrc
       F4000 .text
        1000 .tls

E:\SteamTest\SteamSDK - å‰¯æœ¬\SteamLogon\bin\Release&gt;dumpbin /exports sdologinsdk.dll
Microsoft (R) COFF/PE Dumper Version 14.29.30151.0
Copyright (C) Microsoft Corporation.  All rights reserved.


Dump of file sdologinsdk.dll

File Type: DLL

  Section contains the following exports for sdologinsdk64.dll

    00000000 characteristics
    67C7E588 time date stamp Wed Mar  5 13:47:52 2025
        0.00 version
           1 ordinal base
          20 number of functions
          20 number of names

    ordinal hint RVA      name

          1    0 0000C320 DoLogin = _DoLogin
          2    1 0000C340 GHomeTerminal = _GHomeTerminal
          3    2 0000C630 GetAgreementStatus = _GetAgreementStatus
          4    3 0000C4B0 GetLoginedCompanyId = _GetLoginedCompanyId
          5    4 0000C2B0 GhomeCloseLoginDialog = _GhomeCloseLoginDialog
          6    5 0000C680 GhomeDoInit = _GhomeDoInit
          7    6 0000C5D0 GhomeDoPrivacyAgreement = _GhomeDoPrivacyAgreement
          8    7 0000C700 GhomeGetLoinAreaList = _GhomeGetLoinAreaList
          9    8 0000C370 GhomeGetTicket = _GhomeGetTicket
         10    9 0000C240 GhomeInitialize = _GhomeInitialize
         11    A 0000C300 GhomeLogout = _GhomeLogout
         12    B 0000C2D0 GhomeMoveLoginDialog = _GhomeMoveLoginDialog
         13    C 0000C480 GhomeOpenWindow = _GhomeOpenWindow
         14    D 0000C6E0 GhomeSetLoginArea = _GhomeSetLoginArea
         15    E 0000C4C0 GhomeSetLoginDialogState = _GhomeSetLoginDialogState
         16    F 0000C350 GhomeSetLoginMode = _GhomeSetLoginMode
         17   10 0000C260 GhomeSetOwnerWindow = _GhomeSetOwnerWindow
         18   11 0000C280 GhomeShowLoginDialog = _GhomeShowLoginDialog
         19   12 0000C5A0 OpenActivityWindow = _OpenActivityWindow
         20   13 0000C4F0 SetGameClientType = _SetGameClientType

  Summary

        8000 .data
       2F000 .rdata
       14000 .reloc
        1000 .rsrc
       F4000 .text
        1000 .tls

E:\SteamTest\SteamSDK - å‰¯æœ¬\SteamLogon\bin\Release&gt;dumpbin /exports sdologinsdk.dll
Microsoft (R) COFF/PE Dumper Version 14.29.30151.0
Copyright (C) Microsoft Corporation.  All rights reserved.


Dump of file sdologinsdk.dll

File Type: DLL

  Section contains the following exports for sdologinsdk64.dll

    00000000 characteristics
    67C7EA7E time date stamp Wed Mar  5 14:09:02 2025
        0.00 version
           1 ordinal base
          20 number of functions
          20 number of names

    ordinal hint RVA      name

          1    0 0000C1F0 DoLogin = _DoLogin
          2    1 0000C210 GHomeTerminal = _GHomeTerminal
          3    2 0000C500 GetAgreementStatus = _GetAgreementStatus
          4    3 0000C380 GetLoginedCompanyId = _GetLoginedCompanyId
          5    4 0000C180 GhomeCloseLoginDialog = _GhomeCloseLoginDialog
          6    5 0000C550 GhomeDoInit = _GhomeDoInit
          7    6 0000C4A0 GhomeDoPrivacyAgreement = _GhomeDoPrivacyAgreement
          8    7 0000C5D0 GhomeGetLoinAreaList = _GhomeGetLoinAreaList
          9    8 0000C240 GhomeGetTicket = _GhomeGetTicket
         10    9 0000C110 GhomeInitialize = _GhomeInitialize
         11    A 0000C1D0 GhomeLogout = _GhomeLogout
         12    B 0000C1A0 GhomeMoveLoginDialog = _GhomeMoveLoginDialog
         13    C 0000C350 GhomeOpenWindow = _GhomeOpenWindow
         14    D 0000C5B0 GhomeSetLoginArea = _GhomeSetLoginArea
         15    E 0000C390 GhomeSetLoginDialogState = _GhomeSetLoginDialogState
         16    F 0000C220 GhomeSetLoginMode = _GhomeSetLoginMode
         17   10 0000C130 GhomeSetOwnerWindow = _GhomeSetOwnerWindow
         18   11 0000C150 GhomeShowLoginDialog = _GhomeShowLoginDialog
         19   12 0000C470 OpenActivityWindow = _OpenActivityWindow
         20   13 0000C3C0 SetGameClientType = _SetGameClientType
</code></pre>
    <ul>
     <li>
      <strong>
       Ghome.hï¼š
      </strong>
     </li>
    </ul>
    <pre><code>#ifndef GHOME_H
#define GHOME_H

#include &lt;windows.h&gt;
#include &lt;ObjBase.h&gt;

#ifdef GHOME_EXPORTS
#define GHOME_API __declspec(dllexport)
#else
#define GHOME_API __declspec(dllimport)
#endif

#ifdef __cplusplus
extern "C" {
#endif

#pragma pack(push,1)

	// ========================  é”™è¯¯ç å®šä¹‰  ========================
#define SDOL_ERRORCODE_OK					0      
#define SDOL_ERRORCODE_FAILED				-1     
#define SDOL_ERRORCODE_UNEXCEPT				-100   
#define SDOL_ERRORCODE_LOGINCANCEL			-101   
#define SDOL_ERRORCODE_INVALIDPARAM			-102   
#define SDOL_ERRORCODE_INVALIDBUFFER		-103   
#define SDOL_ERRORCODE_GETTICKET_TIMEOUT	-104   
#define SDOL_ERRORCODE_NOT_SUPPORT          -105   

	// ========================  ç™»å½•æ¨¡å¼  ========================
#define NormalLoginMode              0
#define LauncherLoginMode            1
#define AttachToLoginMode            2

	// ========================  æ›´æ–°åŠ¨ä½œ  ========================
#define UPDATE_ACTION_DOWNLOAD       1
#define UPDATE_ACTION_SETUP          2

	// ========================  ç»“æ„ä½“å®šä¹‰  ========================
	typedef struct GhomeLAppInfo {
		DWORD Size;			// = sizeof(GhomeLAppInfo)
		int AppID;			// ç››è¶£ç»Ÿä¸€æ¸¸æˆID
		LPCWSTR AppName;	// æ¸¸æˆåç§°
		LPCWSTR AppVer;		// æ¸¸æˆç‰ˆæœ¬
		int AreaId;			// æ¸¸æˆåŒºID	(æ³¨æ„ï¼šä¸å¯ç”¨æ—¶ä¼ -1)
		int GroupId;		// æ¸¸æˆç»„ID	(æ³¨æ„ï¼šä¸å¯ç”¨æ—¶ä¼ -1)
	} GhomeLAppInfo;

	typedef struct SDOLLoginResult
	{
		DWORD       Size;			// sizeof(SDOLLoginResult)ï¼Œä¸ºä»¥åæ‰©å……æä¾›å¯èƒ½
		LPCWSTR     SessionId;		// ç”¨äºåå°éªŒè¯çš„tokenä¸²
		LPCWSTR     Sndaid;		    // ç”¨æˆ·ID
		LPCWSTR     IdentityState;	// æ˜¯å¦æˆå¹´æ ‡è¯†ï¼Œ0æœªæˆå¹´ï¼Œ1æˆå¹´
		LPCWSTR     Appendix;		// é™„åŠ å­—æ®µï¼Œä¿ç•™
	}GhomeSDOLLoginResult;

	typedef struct GhomeLoginAreaMsg {
		LPCWSTR Userid;
		LPCWSTR Area;
		LPCWSTR Group;
	} GhomeLoginAreaMsg;

	// ======================== å›è°ƒå‡½æ•°ç±»å‹  ========================
	typedef int (__cdecl *LPSDOLLOGINCALLBACKPROC)(int nErrorCode, const SDOLLoginResult* pLoginResult, int nUserData, int nReserved);
	typedef BOOL (__cdecl *LPPRIVATEAGREEMENTCALLBACKPROC)(int nErrorCode, const char* call_condition);
	typedef BOOL (__cdecl *LPGINITCALLBACKPROC)(int nErrorCode);
	typedef BOOL (__cdecl *LPGGETLOGINAREALISTCALLBACKPROC)(int nErrorCode, const char* json_msg);

	// ======================== DLL å¯¼å‡ºå‡½æ•°  ========================
	GHOME_API int __cdecl GhomeSetOwnerWindow(HWND hWnd);
	GHOME_API int __cdecl GhomeShowLoginDialog(LPSDOLLOGINCALLBACKPROC fnCallback, int nUserData, int nReserved);
	GHOME_API int __cdecl GhomeCloseLoginDialog(void);
	GHOME_API int __cdecl GhomeMoveLoginDialog(int x, int y);
	GHOME_API int __cdecl GhomeLogout(void);
	GHOME_API int __cdecl GhomeSetLoginMode(int nLoginMode);
	GHOME_API int __cdecl GhomeGetTicket(BSTR* bstrTicket);
	GHOME_API int __cdecl GhomeOpenWindow(LPCWSTR pwcsWinType, LPCWSTR pwcsWinName, LPCWSTR pwcsSrc, int nLeft, int nTop, int nWidth, int nHeight, LPCWSTR pwcsMode);
	GHOME_API int __cdecl GetLoginedCompanyId(void);
	GHOME_API int __cdecl GhomeSetLoginDialogState(int nState);
	GHOME_API int __cdecl SetGameClientType(LPCWSTR szGameClientType);
	GHOME_API int __cdecl OpenActivityWindow(LPCWSTR pwcsWinType, LPCWSTR pwcsWinName, LPCWSTR pwcsSrc, int nLeft, int nTop, int nWidth, int nHeight, LPCWSTR pwcsMode);
	GHOME_API int __cdecl GhomeDoPrivacyAgreement(const char* appId, LPPRIVATEAGREEMENTCALLBACKPROC fnCallback);
	GHOME_API int __cdecl GhomeInitialize(const GhomeLAppInfo* pAppInfo);
	GHOME_API int __cdecl GhomeDoInit(const char* appId, LPGINITCALLBACKPROC fnCallback);
	GHOME_API int __cdecl GHomeTerminal();
	GHOME_API int __cdecl GhomeSetLoginArea(const GhomeLoginAreaMsg* loginArea);
	GHOME_API int __cdecl GhomeGetLoinAreaList(LPGGETLOGINAREALISTCALLBACKPROC fnCallback);

#pragma pack(pop)

#ifdef __cplusplus
}
#endif

#endif // GHOME_H



</code></pre>
    <ul>
     <li>
      <strong>
       Ghome.cpp
      </strong>
     </li>
    </ul>
    <pre><code>#define GHOME_EXPORTS
#include "Ghome.h"
#include "stdafx.h"
#include &lt;comutil.h&gt;

#include "SDOLInfo.h"
#include "GPlusManager.h"
#include "ModuleLoginSDK.h"
#include "IGMessageFilter.h"

// ========================  ä¸»è¦å¯¼å‡ºå‡½æ•°  ========================

// åˆå§‹åŒ–
extern "C" GHOME_API int __cdecl GhomeInitialize(const GhomeLAppInfo* pAppInfo)
{
	return ModuleLoginSDK::GetInstance()-&gt;SdoInitialize(*pAppInfo) ? SDOL_ERRORCODE_OK : SDOL_ERRORCODE_FAILED;
}

// è®¾ç½®ä¸»çª—å£
extern "C" GHOME_API int __cdecl GhomeSetOwnerWindow(HWND hWnd)
{
	return ModuleLoginSDK::GetInstance()-&gt;SetOwnerWindow(hWnd) ? SDOL_ERRORCODE_OK : SDOL_ERRORCODE_FAILED;
}

// æ˜¾ç¤ºç™»å½•çª—å£
extern "C" GHOME_API int __cdecl GhomeShowLoginDialog(LPSDOLLOGINCALLBACKPROC fnCallback, int nUserData, int nReserved)
{
	return ModuleLoginSDK::GetInstance()-&gt;ShowLoginDialog(fnCallback, nUserData, nReserved) ? SDOL_ERRORCODE_OK : SDOL_ERRORCODE_FAILED;
}

// å…³é—­ç™»å½•çª—å£
extern "C" GHOME_API int __cdecl GhomeCloseLoginDialog(void)
{
	return ModuleLoginSDK::GetInstance()-&gt;CloseLoginDialog() ? SDOL_ERRORCODE_OK : SDOL_ERRORCODE_FAILED;
}

// ç§»åŠ¨ç™»å½•çª—å£
extern "C" GHOME_API int __cdecl GhomeMoveLoginDialog(int x, int y)
{
	return ModuleLoginSDK::GetInstance()-&gt;MoveLoginDialog(x, y) ? SDOL_ERRORCODE_OK : SDOL_ERRORCODE_FAILED;
}

// ç”¨æˆ·æ³¨é”€
extern "C" GHOME_API int __cdecl GhomeLogout(void)
{
	return ModuleLoginSDK::GetInstance()-&gt;Logout() ? SDOL_ERRORCODE_OK : SDOL_ERRORCODE_FAILED;
}


// ç»ˆæ­¢é”€æ¯æ¥å£
extern "C" GHOME_API int __cdecl GHomeTerminal()
{
	return ModuleLoginSDK::Destroy() == ShutdownSuccess ? SDOL_ERRORCODE_OK : SDOL_ERRORCODE_FAILED;
}

// è®¾ç½®ç™»å½•æ¨¡å¼
extern "C" GHOME_API int __cdecl GhomeSetLoginMode(int nLoginMode)
{
	return ModuleLoginSDK::GetInstance()-&gt;SetLoginMode(nLoginMode) ? SDOL_ERRORCODE_OK : SDOL_ERRORCODE_FAILED;
}

// è·å–ç™»å½•ç¥¨æ®
extern "C" GHOME_API int __cdecl GhomeGetTicket(BSTR* bstrTicket)
{
	std::string strTicket;
	std::string strSndaId;
	if (!ModuleLoginSDK::GetInstance()-&gt;GetTicket(strTicket, strSndaId))
	{
		return SDOL_ERRORCODE_FAILED;
	}

	*bstrTicket = _com_util::ConvertStringToBSTR(strTicket.c_str());
	return SDOL_ERRORCODE_OK;
}

// æ‰“å¼€çª—å£
extern "C" GHOME_API int __cdecl GhomeOpenWindow(LPCWSTR pwcsWinType, LPCWSTR pwcsWinName, LPCWSTR pwcsSrc, int nLeft, int nTop, int nWidth, int nHeight, LPCWSTR pwcsMode)
{
	return ModuleLoginSDK::GetInstance()-&gt;OpenWindow(pwcsWinType, pwcsWinName, pwcsSrc, nLeft, nTop, nWidth, nHeight, pwcsMode) == 0 ? SDOL_ERRORCODE_OK : SDOL_ERRORCODE_FAILED;
}

// è·å–å·²ç™»å½•å…¬å¸ID
extern "C" GHOME_API int __cdecl GetLoginedCompanyId(void)
{
	return ModuleLoginSDK::GetInstance()-&gt;GetLoginedCompanyId();
}

// è®¾ç½®ç™»å½•çª—å£çŠ¶æ€
extern "C" GHOME_API int __cdecl GhomeSetLoginDialogState(int nState)
{
	if (nState != 1 &amp;&amp; nState != 2)
	{
		return SDOL_ERRORCODE_FAILED;
	}
	return ModuleLoginSDK::GetInstance()-&gt;SetLoginDialogState(nState) ? SDOL_ERRORCODE_OK : SDOL_ERRORCODE_FAILED;
}

// è®¾ç½®æ¸¸æˆå®¢æˆ·ç«¯ç±»å‹
extern "C" GHOME_API int __cdecl SetGameClientType(LPCWSTR szGameClientType)
{
	if (szGameClientType == NULL)
	{
		return SDOL_ERRORCODE_FAILED;
	}
	ModuleLoginSDK::GetInstance()-&gt;SetGameClientType(StringHelper::UnicodeToANSI(szGameClientType));
	return SDOL_ERRORCODE_OK;
}

// æ¸¸æˆå†…æ‰“å¼€æ´»åŠ¨çª—å£
extern "C" GHOME_API int __cdecl OpenActivityWindow(LPCWSTR pwcsWinType, LPCWSTR pwcsWinName, LPCWSTR pwcsSrc, int nLeft, int nTop, int nWidth, int nHeight, LPCWSTR pwcsMode)
{
	return ModuleLoginSDK::GetInstance()-&gt;OpenActivityWindow(pwcsWinType, pwcsWinName, pwcsSrc, nLeft, nTop, nWidth, nHeight, pwcsMode) == 0 ? SDOL_ERRORCODE_OK : SDOL_ERRORCODE_FAILED;
}

// å¤„ç†éšç§åè®®
extern "C" GHOME_API int __cdecl GhomeDoPrivacyAgreement(const char* appId, LPPRIVATEAGREEMENTCALLBACKPROC fnCallback)
{
	return ModuleLoginSDK::GetInstance()-&gt;doPrivacyAgreement(appId, fnCallback) ? SDOL_ERRORCODE_OK : SDOL_ERRORCODE_FAILED;
}

// è·å–éšç§åè®®çŠ¶æ€
extern "C" GHOME_API int __cdecl GetAgreementStatus(const char* appId)
{
	return ModuleLoginSDK::GetInstance()-&gt;getAgreementStatus(appId) ? SDOL_ERRORCODE_OK : SDOL_ERRORCODE_FAILED;
}

// æ‰§è¡Œåˆå§‹åŒ–
extern "C" GHOME_API int __cdecl GhomeDoInit(const char* appId, LPGINITCALLBACKPROC fnCallback)
{
	return ModuleLoginSDK::GetInstance()-&gt;initialize(appId, fnCallback) ? SDOL_ERRORCODE_OK : SDOL_ERRORCODE_FAILED;
}

// è®¾ç½®ç™»å½•åŒºæœ
extern "C" GHOME_API int __cdecl GhomeSetLoginArea(const GhomeLoginAreaMsg* loginArea)
{
	return ModuleLoginSDK::GetInstance()-&gt;SetLoginArea(loginArea) ? SDOL_ERRORCODE_OK : SDOL_ERRORCODE_FAILED;
}

// è·å–åŒºæœåˆ—è¡¨
extern "C" GHOME_API int __cdecl GhomeGetLoinAreaList(LPGGETLOGINAREALISTCALLBACKPROC fnCallback)
{
	return ModuleLoginSDK::GetInstance()-&gt;GetLoginArea(fnCallback) ? SDOL_ERRORCODE_OK : SDOL_ERRORCODE_FAILED;
}

</code></pre>
    <ul>
     <li>
      <strong>
       sdk.def
      </strong>
     </li>
    </ul>
    <pre><code>LIBRARY sdologinsdk
EXPORTS
    GhomeInitialize
    GhomeSetOwnerWindow
    GhomeShowLoginDialog
    GhomeCloseLoginDialog
    GhomeMoveLoginDialog
    GhomeLogout
    GHomeTerminal
    GhomeSetLoginMode
    GhomeGetTicket
    GhomeOpenWindow
    GetLoginedCompanyId
    GhomeSetLoginDialogState
    SetGameClientType
    OpenActivityWindow
    GhomeDoPrivacyAgreement
    GetAgreementStatus
    GhomeDoInit
    GhomeSetLoginArea
    GhomeGetLoinAreaList
</code></pre>
    <ul>
     <li>
      <strong>
       æ˜¯çš„ï¼Œç›´æ¥ä½¿ç”¨ .def æ–‡ä»¶æŒ‡å®šå¯¼å‡ºå‡½æ•°åç§° æ˜¯æœ€å¹²å‡€ã€æœ€æ¨èçš„æ–¹æ³•ä¹‹ä¸€ï¼ğŸ¯
      </strong>
     </li>
     <li>
      ğŸ“Œ
      <strong>
       è¿™æ ·åšçš„å¥½å¤„:
      </strong>
      <ul>
       <li>
        <p>
         <strong>
          é¿å…äº†è°ƒç”¨çº¦å®š (__cdecl vs __stdcall) å½±å“å¯¼å‡ºåç§°:
         </strong>
        </p>
        <ul>
         <li>
          <strong>
           __stdcall é»˜è®¤ä¼šåœ¨å¯¼å‡ºåç§°ååŠ  @å‚æ•°å­—èŠ‚æ•°ï¼Œ__cdecl ä¼šå‰é¢åŠ  _ã€‚
          </strong>
         </li>
         <li>
          .
          <strong>
           def æ–‡ä»¶ç›´æ¥æŒ‡å®š ä½ æƒ³è¦çš„å¯¼å‡ºåç§°ï¼Œä¸ç®¡ç¼–è¯‘å™¨æ€ä¹ˆä¿®é¥°ç¬¦å·ï¼Œå®ƒéƒ½ä¼šæŒ‰ç…§ .def é‡Œçš„å¯¼å‡ºåç§°ä½¿ç”¨ã€‚
          </strong>
         </li>
        </ul>
       </li>
       <li>
        <p>
         <strong>
          å¯¼å‡ºåç§°æ›´æ¸…æ™°ï¼Œè°ƒç”¨æ–¹å®¹æ˜“åŒ¹é…:
         </strong>
        </p>
        <ul>
         <li>
          <strong>
           ä½ ç”¨ dumpbin /exports sdologinsdk.dll çœ‹åˆ°çš„å¯¼å‡ºåç§°å°±æ˜¯ .def é‡ŒæŒ‡å®šçš„ï¼Œä¿è¯ä¸ä¼šæœ‰ _ æˆ– @ è¿™ç§é¢å¤–ä¿®é¥°ã€‚
          </strong>
         </li>
        </ul>
       </li>
       <li>
        <p>
         <strong>
          å…¼å®¹ä¸åŒçš„è°ƒç”¨çº¦å®š:
         </strong>
        </p>
        <ul>
         <li>
          <strong>
           å³ä½¿æŸäº›å‡½æ•°æ˜¯ __stdcallï¼ŒæŸäº›æ˜¯ __cdeclï¼Œéƒ½ä¸ä¼šå½±å“å¯¼å‡ºåç§°ï¼Œè°ƒç”¨è€…æ— éœ€å…³å¿ƒå‡½æ•°çš„è°ƒç”¨çº¦å®šã€‚
          </strong>
         </li>
        </ul>
       </li>
      </ul>
     </li>
    </ul>
    <p>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/ce7605dfedeb4676981e9c7a7faf6e3b.png">
      <br/>
      <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/6bb16ace77384c85b65cf5373ab5d4bb.png">
       <br/>
       <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/c6f4180c4f8f4e838e0103b2fbd1495a.png"/>
      </img>
     </img>
    </p>
    <ul>
     <li>
      <strong>
       Linux/macOSï¼šä½¿ç”¨ nm å’Œ objdump:Linux å’Œ macOS ä½¿ç”¨ nm æˆ– objdump æ¥æŸ¥çœ‹ .so å…±äº«åº“çš„å¯¼å‡ºç¬¦å·ã€‚
      </strong>
      <ul>
       <li>
        <strong>
         æ–¹æ³• 1ï¼šä½¿ç”¨ nm
        </strong>
        ï¼š
       </li>
      </ul>
     </li>
    </ul>
    <pre><code>nm -D your_library.so

</code></pre>
    <ul>
     <li>
      <strong>
       è¾“å‡ºç¤ºä¾‹:
      </strong>
     </li>
    </ul>
    <pre><code>0000000000001234 T exported_function
0000000000005678 T another_exported_function

</code></pre>
    <ul>
     <li>
      <strong>
       å¸¦ T æ ‡è®°çš„ç¬¦å·å°±æ˜¯å¯¼å‡ºçš„å‡½æ•°ã€‚
      </strong>
     </li>
     <li>
      <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/7066ddacf6874c3ca85bde38f45f6d8a.png"/>
     </li>
    </ul>
    <h2>
     <a id="2Windows_Calling_ConventionName_Mangling_489">
     </a>
     2ã€Windows è°ƒç”¨çº¦å®šï¼ˆCalling Conventionï¼‰å¯¼è‡´çš„ç¬¦å·ä¿®é¥°ï¼ˆName Manglingï¼‰
    </h2>
    <ul>
     <li>
      <strong>
       åœ¨ Windows å¹³å°ï¼Œè°ƒç”¨çº¦å®šï¼ˆCalling Conventionï¼‰å†³å®šäº†ï¼š
      </strong>
      <ul>
       <li>
        <strong>
         å‡½æ•°å‚æ•°å¦‚ä½•ä¼ é€’ï¼ˆå¯„å­˜å™¨è¿˜æ˜¯æ ˆï¼‰ã€‚
        </strong>
       </li>
       <li>
        <strong>
         æ ˆç”±è°æ¥æ¸…ç†ï¼ˆè°ƒç”¨è€…è¿˜æ˜¯è¢«è°ƒç”¨è€…ï¼‰ã€‚
        </strong>
       </li>
       <li>
        <strong>
         ç¼–è¯‘å™¨å¦‚ä½•ä¿®é¥°ï¼ˆMangleï¼‰å‡½æ•°åç§°ã€‚
        </strong>
       </li>
      </ul>
     </li>
    </ul>
    <h4>
     <a id="21__496">
     </a>
     2.1ã€ å¸¸è§è°ƒç”¨çº¦å®šåŠå…¶ç¬¦å·ä¿®é¥°
    </h4>
    <ul>
     <li>
      <strong>
       Windows ä¸‹å¸¸è§çš„è°ƒç”¨çº¦å®šæœ‰ï¼š
      </strong>
      <br/>
      <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/e8e75c1480414f7580364cfd5eefbd6b.png"/>
     </li>
    </ul>
    <h4>
     <a id="22_500">
     </a>
     2.2ã€è°ƒç”¨çº¦å®šå¯¼è‡´çš„ç¬¦å·ä¿®é¥°
    </h4>
    <p>
     <strong>
      åœ¨ Windows ä¸‹ï¼Œå¯¼å‡ºçš„ C è¯­è¨€å‡½æ•°åç§°ä¼šç»è¿‡ ç¬¦å·ä¿®é¥°ï¼ˆName Manglingï¼‰ï¼Œä¸åŒè°ƒç”¨çº¦å®šä¼šå¯¼è‡´ä¸åŒçš„ç¬¦å·æ ¼å¼ã€‚
     </strong>
    </p>
    <ul>
     <li>
      <p>
       <strong>
        1ï¸âƒ£ __cdeclï¼ˆé»˜è®¤ C/C++ çº¦å®šï¼‰ï¼š
       </strong>
      </p>
     </li>
     <li>
      <p>
       <strong>
        è§„åˆ™ï¼š
       </strong>
      </p>
      <ul>
       <li>
        <strong>
         å‚æ•°ä»å³åˆ°å·¦å‹å…¥æ ˆã€‚
        </strong>
       </li>
       <li>
        <strong>
         è°ƒç”¨è€…æ¸…ç†å †æ ˆã€‚
        </strong>
       </li>
       <li>
        <strong>
         ç¬¦å·ä¿®é¥°ï¼šå‰é¢åŠ  _ ã€‚
        </strong>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        ç¤ºä¾‹ï¼š
       </strong>
      </p>
     </li>
    </ul>
    <pre><code>extern "C" __cdecl int MyFunction(int a, int b);

</code></pre>
    <p>
     <strong>
      ç¼–è¯‘åï¼ˆdumpbin /exportsï¼‰ï¼š
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       _MyFunction
      </strong>
     </li>
    </ul>
    <p>
     <strong>
      æ³¨æ„: __cdecl æ²¡æœ‰å‚æ•°å­—èŠ‚æ•°ï¼Œå› ä¸ºå®ƒç”±è°ƒç”¨è€…æ¸…ç†å †æ ˆï¼Œç¼–è¯‘å™¨ä¸éœ€è¦è®°å½•å‚æ•°å¤§å°ã€‚
     </strong>
    </p>
    <ul>
     <li>
      <p>
       <strong>
        2ï¸âƒ£ __stdcallï¼ˆWindows API é»˜è®¤ï¼ŒCALLBACKï¼‰ï¼š
       </strong>
      </p>
      <ul>
       <li>
        <strong>
         è§„åˆ™ï¼š
        </strong>
        <ul>
         <li>
          <strong>
           å‚æ•°ä»å³åˆ°å·¦å‹å…¥æ ˆã€‚
          </strong>
         </li>
         <li>
          <strong>
           è¢«è°ƒç”¨è€…æ¸…ç†å †æ ˆã€‚
          </strong>
         </li>
         <li>
          <strong>
           ç¬¦å·ä¿®é¥°ï¼šå‰é¢åŠ  _ï¼Œåé¢åŠ  @å‚æ•°å­—èŠ‚æ•°ã€‚
          </strong>
         </li>
        </ul>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        ç¤ºä¾‹ï¼š
       </strong>
      </p>
     </li>
    </ul>
    <pre><code>extern "C" __stdcall int MyFunction(int a, int b);

</code></pre>
    <ul>
     <li>
      <strong>
       ç¼–è¯‘åï¼ˆdumpbin /exportsï¼‰ï¼š
      </strong>
     </li>
    </ul>
    <pre><code>? _MyFunction@8

</code></pre>
    <ul>
     <li>
      <p>
       <strong>
        å› ä¸º int ç±»å‹å‚æ•°å„å  4 å­—èŠ‚ï¼Œæ‰€ä»¥ @8 ä»£è¡¨ 2 * 4 = 8 å­—èŠ‚ã€‚
       </strong>
      </p>
     </li>
     <li>
      <p>
       <strong>
        3ï¸âƒ£ __fastcallï¼ˆå¯„å­˜å™¨ä¼˜åŒ–ï¼‰ï¼š
       </strong>
      </p>
     </li>
     <li>
      <p>
       <strong>
        è§„åˆ™ï¼š
       </strong>
      </p>
      <ul>
       <li>
        å‰ä¸¤ä¸ªå‚æ•°æ”¾ ECX å’Œ EDXï¼Œå…¶ä½™ä»å³åˆ°å·¦å…¥æ ˆã€‚
       </li>
       <li>
        è¢«è°ƒç”¨è€…æ¸…ç†å †æ ˆã€‚
       </li>
       <li>
        ç¬¦å·ä¿®é¥°ï¼šå‰é¢åŠ  @ï¼Œåé¢åŠ  @å‚æ•°å­—èŠ‚æ•°ã€‚
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        ç¤ºä¾‹ï¼š
       </strong>
      </p>
     </li>
    </ul>
    <pre><code>extern "C" __fastcall int MyFunction(int a, int b);
</code></pre>
    <ul>
     <li>
      <strong>
       ç¼–è¯‘åï¼ˆdumpbin /exportsï¼‰ï¼š
      </strong>
     </li>
    </ul>
    <pre><code>@MyFunction@8
</code></pre>
    <ul>
     <li>
      <strong>
       4ï¸âƒ£ __vectorcallï¼ˆç”¨äº SIMD å¯„å­˜å™¨ä¼˜åŒ–ï¼‰ï¼š
      </strong>
     </li>
     <li>
      <strong>
       è§„åˆ™:
      </strong>
      <ul>
       <li>
        ä¼˜å…ˆä½¿ç”¨ SIMD/å¯„å­˜å™¨
       </li>
       <li>
        è¢«è°ƒç”¨è€…æ¸…ç†å †æ ˆ
       </li>
       <li>
        ç¬¦å·ä¿®é¥°ï¼šå‰é¢åŠ  ?ï¼Œåé¢åŠ  @å‚æ•°å­—èŠ‚æ•°
       </li>
      </ul>
     </li>
     <li>
      <strong>
       ç¤ºä¾‹:
      </strong>
     </li>
    </ul>
    <pre><code>extern "C" __vectorcall int MyFunction(int a, int b);
</code></pre>
    <ul>
     <li>
      ç¼–è¯‘åï¼ˆdumpbin /exportsï¼‰ï¼š
     </li>
    </ul>
    <pre><code>MyFunction@@16
</code></pre>
    <ul>
     <li>
      <strong>
       5ï¸âƒ£ __thiscallï¼ˆC++ ç±»æˆå‘˜å‡½æ•°é»˜è®¤è°ƒç”¨çº¦å®šï¼‰ï¼š
      </strong>
     </li>
     <li>
      <strong>
       è§„åˆ™
      </strong>
      <ul>
       <li>
        this æŒ‡é’ˆé€šè¿‡ ECX ä¼ é€’
       </li>
       <li>
        å…¶ä»–å‚æ•°ä»å³åˆ°å·¦å…¥æ ˆ
       </li>
       <li>
        è¢«è°ƒç”¨è€…æ¸…ç†å †æ ˆ
       </li>
       <li>
        ç¬¦å·ä¿®é¥°ï¼šC++ æ–¹å¼ï¼ˆå¦‚ _MethodName@8ï¼‰
       </li>
      </ul>
     </li>
     <li>
      <strong>
       ç¤ºä¾‹:
      </strong>
     </li>
    </ul>
    <pre><code>class MyClass {
public:
    int __thiscall MyMethod(int a, int b);
};
</code></pre>
    <ul>
     <li>
      <strong>
       ç¼–è¯‘åï¼ˆdumpbin /exportsï¼‰ï¼š
      </strong>
     </li>
    </ul>
    <pre><code>MyMethod@MyClass@8
</code></pre>
    <ul>
     <li>
      <strong>
       å¦‚æœ ä¸æ˜¯ extern â€œCâ€ï¼ŒC++ è¿˜ä¼šåŠ ä¸Šç±»åã€‚
      </strong>
     </li>
    </ul>
    <h4>
     <a id="23___GHomeTerminal_____16_596">
     </a>
     2.3. ä¸ºä»€ä¹ˆ _GHomeTerminal ä¼šå¤š _ æˆ– @16
    </h4>
    <ul>
     <li>
      <strong>
       å¦‚æœ GHomeTerminal ä½¿ç”¨ __cdeclï¼Œåº”è¯¥å¯¼å‡ºï¼š
      </strong>
     </li>
    </ul>
    <pre><code>_GHomeTerminal
</code></pre>
    <ul>
     <li>
      <strong>
       å¦‚æœ GHomeTerminal ä½¿ç”¨ __stdcallï¼Œä¼šå˜æˆï¼š
      </strong>
     </li>
    </ul>
    <pre><code>_GHomeTerminal@0
</code></pre>
    <ul>
     <li>
      <p>
       <strong>
        ï¼ˆå› ä¸ºæ²¡æœ‰å‚æ•°ï¼Œæ‰€ä»¥ @0ï¼‰ã€‚
       </strong>
      </p>
     </li>
     <li>
      <p>
       <strong>
        å¦‚æœä½ çš„ dumpbin /exports çœ‹åˆ° _GHomeTerminalï¼Œä½†æœŸæœ› GHomeTerminalï¼š
       </strong>
      </p>
     </li>
     <li>
      <p>
       <strong>
        ä½ ä½¿ç”¨äº† __cdeclï¼Œä½† dllimport/dllexport æœŸæœ› __stdcallã€‚
       </strong>
      </p>
     </li>
     <li>
      <p>
       <strong>
        ä½ åº”è¯¥ æ˜ç¡®ä½¿ç”¨ __stdcall æˆ–è€… .def æ–‡ä»¶æ§åˆ¶å¯¼å‡ºåç§°ã€‚
       </strong>
      </p>
     </li>
    </ul>
    <h4>
     <a id="24_617">
     </a>
     2.4ã€è§£å†³å¯¼å‡ºåç§°é—®é¢˜
    </h4>
    <ul>
     <li>
      âœ…
      <strong>
       æ–¹æ³• 1ï¼šåœ¨ .def æ–‡ä»¶é‡ŒæŒ‡å®šåç§°ï¼š
      </strong>
      <ul>
       <li>
        <strong>
         åœ¨ sdologinsdk.def é‡ŒæŒ‡å®šï¼š
        </strong>
       </li>
      </ul>
     </li>
    </ul>
    <pre><code>LIBRARY sdologinsdk
EXPORTS
    GHomeTerminal

</code></pre>
    <ul>
     <li>
      <p>
       <strong>
        è¿™æ ·ä¸ç®¡è°ƒç”¨çº¦å®šæ˜¯ä»€ä¹ˆï¼Œå¯¼å‡ºçš„å‡½æ•°éƒ½ä¼šæ˜¯ GHomeTerminalã€‚
       </strong>
      </p>
     </li>
     <li>
      <p>
       <strong>
        æ–¹æ³• 2ï¼šç¡®ä¿ __cdecl å’Œ __stdcall ä¸€è‡´ï¼š
       </strong>
      </p>
     </li>
    </ul>
    <pre><code>extern "C" __stdcall int GHomeTerminal();

</code></pre>
    <ul>
     <li>
      <p>
       <strong>
        å¦‚æœä½ çš„ä»£ç ç”¨çš„æ˜¯ __stdcallï¼Œä½† dumpbin é‡Œæ˜¯ _GHomeTerminalï¼Œè¯´æ˜ dllimport/dllexport æœŸæœ›çš„æ˜¯ __stdcallã€‚
       </strong>
      </p>
     </li>
     <li>
      <p>
       âœ…
       <strong>
        æ–¹æ³• 3ï¼šå¦‚æœå¿…é¡»ç”¨ __cdeclï¼Œåœ¨ .def é‡Œå¼ºåˆ¶å»æ‰ _ï¼š
       </strong>
      </p>
      <ul>
       <li>
        <strong>
         å¦‚æœ dumpbin /exports é‡Œçœ‹åˆ° _GHomeTerminalï¼Œä½†ä½ æƒ³è®©å¯¼å‡ºçš„åç§°æ˜¯ GHomeTerminalï¼Œå¯ä»¥åœ¨ .def é‡Œè¿™æ ·å†™ï¼š
        </strong>
       </li>
      </ul>
     </li>
    </ul>
    <pre><code>EXPORTS
    GHomeTerminal=_GHomeTerminal

</code></pre>
    <ul>
     <li>
      <strong>
       è¿™æ · dll é‡Œå­˜çš„æ˜¯ _GHomeTerminalï¼Œä½†å¤–éƒ¨è°ƒç”¨è€…åªçœ‹åˆ° GHomeTerminalã€‚
      </strong>
     </li>
    </ul>
    <h2>
     <a id="3_647">
     </a>
     3ã€æ€»ç»“
    </h2>
    <p>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/fd2326b555e4438caf7063e80fde8207.png"/>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34343931383039302f:61727469636c652f64657461696c732f313436303531323432" class_="artid" style="display:none">
 </p>
</div>


