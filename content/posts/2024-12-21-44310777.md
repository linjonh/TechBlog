---
layout: post
title: "银行家算法的C语言实现"
date: 2024-12-21 00:28:38 +0800
description: "近日在学习操作系统，发现国外的教材远比国内的教材更加容易理解，有时感觉操作系统是一个不折不扣的坑，书"
keywords: "银行家算法避免死锁代码c语言"
categories: ['C']
tags: ['无标签']
artid: "44310777"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=44310777
    alt: "银行家算法的C语言实现"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=44310777
featuredImagePreview: https://bing.ee123.net/img/rand?artid=44310777
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     银行家算法的C语言实现
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     近日在学习操作系统，发现国外的教材远比国内的教材更加容易理解，有时感觉操作系统是一个不折不扣的坑，书中的每一句话，其实都需要足够长的代码来描述它。
    </p>
    <p>
     尤其是在拜读了川合秀实的三十天自制操作系统后，感觉自己对操作系统的理解不再那么抽象化了，而开始变得有血有肉起来了。
    </p>
    <p>
     银行家算法是在系统资源有限的情况下，避免进程出现死锁的一种解决办法。
    </p>
    <p>
     示例代码如下：
    </p>
    <p>
     #include&lt;stdio.h&gt;
     <br/>
     #include&lt;stdlib.h&gt;
    </p>
    <p>
     #define TRUE 1
     <br/>
     #define FALSE 0
    </p>
    <p>
     int i,j,g,k;
     <br/>
     int allocation[100][100],max[100][100],available[100];
     <br/>
     int need[100][100];
     <br/>
     int n_process,request[100][100],work[100],total[100];
     <br/>
     int finish[100],temp=0;
     <br/>
     int flag,finish_flag,safe_flag,complete_flag;
     <br/>
     int response;
    </p>
    <p>
     void initialize_process_resource_type();
     <br/>
     void initialize_max();
     <br/>
     void initialize_allocation();
     <br/>
     void calculate_need();
     <br/>
     void calculate_available();
     <br/>
     void resource_request();
     <br/>
     void safe_state_check();
     <br/>
     void print_all();
     <br/>
     void check_complete();
     <br/>
     void run_time_allocation();
     <br/>
     void release_resources();
    </p>
    <p>
     void main()
     <br/>
     {
     <!-- -->
     <br/>
     initialize_process_resource_type();
     <br/>
     initialize_max();
     <br/>
     initialize_allocation();
     <br/>
     calculate_need();
     <br/>
     calculate_available();
     <br/>
     print_all();
    </p>
    <p>
     flag=FALSE;
     <br/>
     while(flag==FALSE)
     <br/>
     {
     <!-- -->
     <br/>
     if(complete_flag==TRUE)
     <br/>
     {
     <!-- -->
     <br/>
     printf("\n\n All Processes has Completed");
     <br/>
     printf("Simulated Execution \n");
     <br/>
     flag=TRUE;
     <br/>
     }
     <br/>
     release_resources();
     <br/>
     // system("tput clear");
     <br/>
     // system("tput clear");
     <br/>
     print_all();
     <br/>
     printf("\n Enter the Run-Time Allocation.....");
     <br/>
     run_time_allocation();
     <br/>
     safe_state_check();
     <br/>
     if(safe_flag==TRUE)
     <br/>
     {
     <!-- -->
     <br/>
     printf("\n Granting Request.....");
     <br/>
     resource_request();
     <br/>
     print_all();
     <br/>
     }
    </p>
    <p>
     else
     <br/>
     {
     <!-- -->
     <br/>
     printf("\n Request is not Granted !!");
     <br/>
     printf("This request leads to the");
     <br/>
     printf("Unsafe State........");
     <br/>
     }
     <br/>
     printf("\nTry another Allocation?[y=1/n=0]:");
     <br/>
     scanf("%d",&amp;response);
     <br/>
     flag=FALSE;
     <br/>
     if(response==0) flag=TRUE;
     <br/>
     }
     <br/>
     printf("\n\n......Simulation of Banker's");
     <br/>
     printf("Algorithm is Completed Successfully.\n");
     <br/>
     }
    </p>
    <p>
     void initialize_process_resource_type()
     <br/>
     {
     <!-- -->
     <br/>
     printf("\nEnter the number of Processer:");
     <br/>
     scanf("%d",&amp;i);
     <br/>
     printf("\nEnter the number of Types of Resources:");
     <br/>
     scanf("%d",&amp;j);
     <br/>
     for(k=1;k&lt;=j;k++)
     <br/>
     {
     <!-- -->
     <br/>
     printf("\nEnter the Total Resources of type %d:",k);
     <br/>
     scanf("%d",&amp;total[k]);
     <br/>
     }
     <br/>
     }
    </p>
    <p>
     void initialize_max()
     <br/>
     {
     <!-- -->
     <br/>
     for(g=1;g&lt;=i;g++)
     <br/>
     {
     <!-- -->
     <br/>
     for(k=1;k&lt;=j;k++)
     <br/>
     {
     <!-- -->
     <br/>
     printf("\nEnter Max-Need of resource of");
     <br/>
     printf("type %d for Process %d:",k,g);
     <br/>
     scanf("%d",&amp;max[g][k]);
     <br/>
     }
     <br/>
     }
     <br/>
     }
    </p>
    <p>
     void initialize_allocation()
     <br/>
     {
     <!-- -->
     <br/>
     for(g=1;g&lt;=i;g++)
     <br/>
     {
     <!-- -->
     <br/>
     for(k=1;k&lt;=j;k++)
     <br/>
     {
     <!-- -->
     <br/>
     printf("\nEnter Allocation of resource of");
     <br/>
     printf("type %d for Process %d:",k,g);
     <br/>
     flag=FALSE;
     <br/>
     while(flag==FALSE)
     <br/>
     {
     <!-- -->
     <br/>
     scanf("%d",&amp;allocation[g][k]);
     <br/>
     flag=TRUE;
     <br/>
     if(allocation[g][k]&gt;max[g][k])
     <br/>
     {
     <!-- -->
     <br/>
     flag=FALSE;
     <br/>
     printf("\nInvalid Allocation !!");
     <br/>
     printf("\nReEnter Allocation of Resource");
     <br/>
     printf("of type %d for Process %d:",k,g);
     <br/>
     }
     <br/>
     }
     <br/>
     }
     <br/>
     }
     <br/>
     }
    </p>
    <p>
     void calculate_need()
     <br/>
     {
     <!-- -->
     <br/>
     for(g=1;g&lt;=i;g++)
     <br/>
     {
     <!-- -->
     <br/>
     for(k=1;k&lt;=j;k++)
     <br/>
     {
     <!-- -->
     <br/>
     need[g][k]=max[g][k]-allocation[g][k];
     <br/>
     }
     <br/>
     }
     <br/>
     }
    </p>
    <p>
     void calculate_available()
     <br/>
     {
     <!-- -->
     <br/>
     for(k=1;k&lt;=j;k++)
     <br/>
     {
     <!-- -->
     <br/>
     temp=0;
     <br/>
     for(g=1;g&lt;=i;g++)
     <br/>
     temp+=allocation[g][k];
    </p>
    <p>
     available[k]=total[k]-temp;
     <br/>
     }
     <br/>
     }
    </p>
    <p>
     void resource_request()
     <br/>
     {
     <!-- -->
     <br/>
     for(k=1;k&lt;=j;k++)
     <br/>
     {
     <!-- -->
     <br/>
     if(request[n_process][k]&lt;=need[n_process][k])
     <br/>
     {
     <!-- -->
     <br/>
     if(request[n_process][k]&lt;=available[k])
     <br/>
     {
     <!-- -->
     <br/>
     available[k]-=request[n_process][k];
     <br/>
     allocation[n_process][k]+=request[n_process][k];
     <br/>
     need[n_process][k]-=request[n_process][k];
     <br/>
     }
     <br/>
     else
     <br/>
     printf("\n ERROR!Availability is greater than request..");
     <br/>
     }
     <br/>
     printf("\nError!! Request is greater than need...");
     <br/>
     }
     <br/>
     }
    </p>
    <p>
     void safe_state_check()
     <br/>
     {
     <!-- -->
     <br/>
     for(k=1;k&lt;=i;k++)
     <br/>
     work[k]=available[k];
    </p>
    <p>
     for(g=1;g&lt;=i;g++)
     <br/>
     finish[g]=FALSE;
    </p>
    <p>
     for(g=1;g&lt;=i;g++)
     <br/>
     for(k=1;k&lt;=j;k++)
     <br/>
     {
     <!-- -->
     <br/>
     if(finish[g]==FALSE&amp;&amp;need[g][k]&lt;=work[k])
     <br/>
     {
     <!-- -->
     <br/>
     work[k]+=allocation[g][k];
     <br/>
     finish[g]=TRUE;
     <br/>
     }
     <br/>
     }
    </p>
    <p>
     complete_flag=TRUE;
     <br/>
     for(g=1;g&lt;=i;g++)
     <br/>
     if(finish[g]==FALSE)
     <br/>
     complete_flag=FALSE;
    </p>
    <p>
     safe_flag=FALSE;
     <br/>
     if(finish[n_process]==TRUE)
     <br/>
     safe_flag=TRUE;
     <br/>
     }
    </p>
    <p>
     void print_all()
     <br/>
     {
     <!-- -->
     <br/>
     printf("\nProcess and Resource State..........");
     <br/>
     printf("\nProcess   Allocation    Max    Need ");
     <br/>
     for(g=1;g&lt;=i;g++)
     <br/>
     {
     <!-- -->
     <br/>
     printf("\n%d  ",g);
     <br/>
     for(k=1;k&lt;=j;k++)
     <br/>
     printf("%d",allocation[g][k]);
     <br/>
     printf("       ");
     <br/>
     for(k=1;k&lt;=j;k++)
     <br/>
     printf("%d",max[g][k]);
     <br/>
     printf("       ");
     <br/>
     for(k=1;k&lt;=j;k++)
     <br/>
     printf("%d",need[g][k]);
     <br/>
     }
     <br/>
     printf("\nTotal Resources:");
     <br/>
     for(k=1;k&lt;=j;k++)
     <br/>
     printf("%d",total[k]);
    </p>
    <p>
     printf("\nAvailable:");
     <br/>
     for(k=1;k&lt;=j;k++)
     <br/>
     printf("%d",available[k]);
    </p>
    <p>
     printf("\n");
     <br/>
     }
    </p>
    <p>
     void check_complete()
     <br/>
     {
     <!-- -->
     <br/>
     complete_flag=FALSE;
     <br/>
     }
    </p>
    <p>
     void run_time_allocation()
     <br/>
     {
     <!-- -->
     <br/>
     printf("\nEnter the Process Number(1 to %d):",i);
     <br/>
     flag=FALSE;
     <br/>
     while(flag==FALSE)
     <br/>
     {
     <!-- -->
     <br/>
     flag=TRUE;
     <br/>
     scanf("%d",&amp;n_process);
     <br/>
     if(n_process&lt;1||n_process&gt;i)
     <br/>
     {
     <!-- -->
     <br/>
     printf("\nReEnter the Process Number(1 to %d):",i);
     <br/>
     flag=FALSE;
     <br/>
     }
     <br/>
     }
     <br/>
     g=n_process;
     <br/>
     for(k=1;k&lt;=j;k++)
     <br/>
     {
     <!-- -->
     <br/>
     printf("\nEnter Resource of type");
     <br/>
     printf("%d allocation for process %d:",k,g);
     <br/>
     scanf("%d",&amp;request[g][k]);
     <br/>
     }
     <br/>
     }
    </p>
    <p>
     void release_resources()
     <br/>
     {
     <!-- -->
     <br/>
     for(g=1;g&lt;=i;g++)
     <br/>
     {
     <!-- -->
     <br/>
     for(k=1;k&lt;=j;k++)
     <br/>
     {
     <!-- -->
     <br/>
     if((allocation[g][k]==max[g][k])&amp;&amp;(allocation[g][k]!=0))
     <br/>
     {
     <!-- -->
     <br/>
     printf("\nThe Process %d is ready to deallocate",g);
     <br/>
     printf("Resource type %d by %dnumbers",k,max[g][k]);
     <br/>
     printf("Release[y=1/n=0]:");
     <br/>
     scanf("%d",&amp;response);
     <br/>
     if(response==1)
     <br/>
     {
     <!-- -->
     <br/>
     available[k]+=allocation[g][k];
     <br/>
     allocation[g][k]=0;
     <br/>
     max[g][k]=0;
     <br/>
     }
     <br/>
     }
     <br/>
     }
     <br/>
     }
     <br/>
     }
    </p>
    <p>
     <br/>
    </p>
    <p>
     <br/>
    </p>
    <div style="top:0px">
     ﻿﻿
    </div>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f75303131353837363636:2f61727469636c652f64657461696c732f3434333130373737" class_="artid" style="display:none">
 </p>
</div>


