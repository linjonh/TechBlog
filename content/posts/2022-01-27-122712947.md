---
layout: post
title: Java迭代器详解,看这一篇就够了
date: 2022-01-27 18:00:11 +0800
categories: ['Java']
tags: ['开发语言', '后端', 'Java']
image:
    path: https://img-blog.csdnimg.cn/197950636cfe4918bf91772d803dd7fe.png?x-oss-process=image/resize,m_fixed,h_150
    alt: Java迭代器详解,看这一篇就够了
artid: 122712947
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=122712947
featuredImagePreview: https://bing.ee123.net/img/rand?artid=122712947
---
<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Java迭代器详解，看这一篇就够了
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <blockquote>
     <p>
     </p>
     <div class="toc">
      <h4>
       文章目录
      </h4>
      <ul>
       <li>
        <a href="#Java__4" rel="nofollow">
         🚩Java 迭代器详解
        </a>
       </li>
       <li>
        <ul>
         <li>
          <a href="#_5" rel="nofollow">
           📚迭代器的定义
          </a>
         </li>
         <li>
          <a href="#Iterator_12" rel="nofollow">
           📒认识Iterator
          </a>
         </li>
         <li>
          <ul>
           <li>
            <a href="#_13" rel="nofollow">
             ✏️类结构图
            </a>
           </li>
           <li>
            <a href="#Iterable_17" rel="nofollow">
             ✒️Iterable接口
            </a>
           </li>
           <li>
            <a href="#Iterator_31" rel="nofollow">
             🖍️Iterator接口
            </a>
           </li>
           <li>
            <ul>
             <li>
              <a href="#Iterator_44" rel="nofollow">
               📃Iterator接口的方法
              </a>
             </li>
            </ul>
           </li>
          </ul>
         </li>
         <li>
          <a href="#_54" rel="nofollow">
           📙迭代器的使用
          </a>
         </li>
         <li>
          <ul>
           <li>
            <a href="#_55" rel="nofollow">
             🏷️使用迭代器遍历集合
            </a>
           </li>
           <li>
            <a href="#Itertor_81" rel="nofollow">
             🔖Itertor的执行原理
            </a>
           </li>
           <li>
            <ul>
             <li>
              <a href="#_83" rel="nofollow">
               ⏳图示执行过程
              </a>
             </li>
             <li>
              <a href="#_86" rel="nofollow">
               ⌛执行过程详解
              </a>
             </li>
            </ul>
           </li>
           <li>
            <a href="#_97" rel="nofollow">
             🃏生成迭代器的快捷键
            </a>
           </li>
          </ul>
         </li>
         <li>
          <a href="#remove_100" rel="nofollow">
           📕迭代器中的remove()
          </a>
         </li>
         <li>
          <ul>
           <li>
            <a href="#remove_101" rel="nofollow">
             ⛄迭代器的remove()方法使用
            </a>
           </li>
           <li>
            <a href="#revome_130" rel="nofollow">
             ☃️迭代器遍历中调用集合revome()方法触发异常
            </a>
           </li>
          </ul>
         </li>
         <li>
          <a href="#for_244" rel="nofollow">
           📗增强for循环
          </a>
         </li>
         <li>
          <ul>
           <li>
            <a href="#for_245" rel="nofollow">
             📫认识增强for循环
            </a>
           </li>
           <li>
            <a href="#_249" rel="nofollow">
             📪基本语法
            </a>
           </li>
           <li>
            <a href="#for_251" rel="nofollow">
             📬增强for循环的使用
            </a>
           </li>
           <li>
            <a href="#for_281" rel="nofollow">
             📭增强for循环的快捷键
            </a>
           </li>
          </ul>
         </li>
        </ul>
       </li>
      </ul>
     </div>
     <p>
     </p>
    </blockquote>
    <h2>
     <a id="Java__4">
     </a>
     🚩Java 迭代器详解
    </h2>
    <h3>
     <a id="_5">
     </a>
     📚迭代器的定义
    </h3>
    <p>
     <code>
      迭代器
     </code>
     是属于
     <strong>
      设计模式
     </strong>
     之一，
     <mark>
      迭代器模式
     </mark>
     提供了一种方法来顺序访问一个聚合对象中各个元素，而不保留该对象的内部表示。
    </p>
    <blockquote>
     <p>
      1）
      <code>
       Iterator对象
      </code>
      称为
      <strong>
       迭代器
      </strong>
      ，主要用于遍历
      <code>
       Collection集合
      </code>
      中的元素。
      <br/>
      2）所有实现了
      <code>
       Collection接口
      </code>
      的集合类都有一个
      <code>
       iterator()
      </code>
      方法，用以返回一个实现了
      <code>
       Iterator接口的对象
      </code>
      ，即可以返回一个
      <code>
       迭代器
      </code>
      。
      <br/>
      3）
      <code>
       Iterator
      </code>
      仅用于遍历集合，
      <code>
       Iterator
      </code>
      本身并不存放对象。
     </p>
    </blockquote>
    <h3>
     <a id="Iterator_12">
     </a>
     📒认识Iterator
    </h3>
    <h4>
     <a id="_13">
     </a>
     ✏️类结构图
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/5160b869b02d7f435016d90aca9958a2.png">
      <br/>
      通过观察类结构图的继承关系我们发现，集合的顶层接口
      <code>
       Collection
      </code>
      继承
      <code>
       Iterable
      </code>
      接口。
     </img>
    </p>
    <h4>
     <a id="Iterable_17">
     </a>
     ✒️Iterable接口
    </h4>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Iterable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">/**
     * Returns an iterator over elements of type {@code T}.
     *
     * @return an Iterator.
     */</span>
    <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     在
     <code>
      Iterable接口
     </code>
     中有一个
     <code>
      Iterator方法
     </code>
     ，它返回一个
     <code>
      Itertator对象
     </code>
     。
    </p>
    <h4>
     <a id="Iterator_31">
     </a>
     🖍️Iterator接口
    </h4>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">boolean</span> <span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token class-name">E</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UnsupportedOperationException</span><span class="token punctuation">(</span><span class="token string">"remove"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h5>
     <a id="Iterator_44">
     </a>
     📃Iterator接口的方法
    </h5>
    <table>
     <thead>
      <tr>
       <th>
        返回值类型
       </th>
       <th>
        方法名
       </th>
       <th>
        功能
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        boolean
       </td>
       <td>
        hasNext()
       </td>
       <td>
        判断集合是否还有元素，如果返回
        <strong>
         true
        </strong>
        表示集合还有元素，返回
        <strong>
         false
        </strong>
        表示集合中没有元素；一般对集合的访问通过
        <strong>
         while(hasNext())
        </strong>
        判断是否还需要遍历。
       </td>
      </tr>
      <tr>
       <td>
        <font color="blue">
         E
        </font>
       </td>
       <td>
        next()
       </td>
       <td>
        获取集合中遍历的当前元素 ；一般先调用
        <strong>
         hasNext()
        </strong>
        方法判断是否存在元素，再调用
        <strong>
         next()
        </strong>
        获取元素，需要进行循环交替遍历集合中的元素。
       </td>
      </tr>
      <tr>
       <td>
        void
       </td>
       <td>
        remove
       </td>
       <td>
        删除集合中的元素。
       </td>
      </tr>
     </tbody>
    </table>
    <h3>
     <a id="_54">
     </a>
     📙迭代器的使用
    </h3>
    <h4>
     <a id="_55">
     </a>
     🏷️使用迭代器遍历集合
    </h4>
    <p>
     我们用
     <code>
      ArrayList集合
     </code>
     存放一些整型数据做示例，然后将其集合中的元素一一遍历打印输出。
    </p>
    <pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Iterator</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestDemo</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">222</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">333</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> iterator <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">int</span> value <span class="token operator">=</span> iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>value <span class="token operator">+</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      运行结果：
     </strong>
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/3e7c4a681b2d3ac79efb5f2d91c638c5.png">
      <br/>
      观察运行结果我们发现，通过
      <code>
       迭代器
      </code>
      我们将
      <code>
       ArrayList集合
      </code>
      中的元素一一打印了出来。
     </img>
    </p>
    <h4>
     <a id="Itertor_81">
     </a>
     🔖Itertor的执行原理
    </h4>
    <p>
     在上述的示例中，
     <mark>
      迭代器
     </mark>
     是如何实现对集合的遍历呢？
    </p>
    <h5>
     <a id="_83">
     </a>
     ⏳图示执行过程
    </h5>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/25c06405128bdd89361a8995762dc65f.gif"/>
    </p>
    <h5>
     <a id="_86">
     </a>
     ⌛执行过程详解
    </h5>
    <p>
     ①首先得到一个集合的迭代器
     <code>
      Iterator iterator = list.iterator();
     </code>
     <br/>
     ②进入
     <code>
      while循环
     </code>
     ，调用
     <code>
      hasNext()
     </code>
     判断是否有下一个元素，返回true，
     <code>
      Iterator.next()
     </code>
     移动一个位置，将该位置的元素
     <strong>
      111
     </strong>
     返回。
     <br/>
     ③再次进入
     <code>
      while循环
     </code>
     ，调用
     <code>
      hasNext()
     </code>
     判断是否有下一个元素，返回true，
     <code>
      Iterator.next()
     </code>
     移动一个位置，将该位置
     <strong>
      222
     </strong>
     的元素返回。
     <br/>
     ④再次进入
     <code>
      while循环
     </code>
     ，调用
     <code>
      hasNext()
     </code>
     判断是否有下一个元素，返回true，
     <code>
      Iterator.next()
     </code>
     移动一个位置，将该位置
     <strong>
      333
     </strong>
     的元素返回。
     <br/>
     ⑤再次进入
     <code>
      while循环
     </code>
     ，调用
     <code>
      hasNext()
     </code>
     判断是否有下一个元素，返回false，循环结束。
    </p>
    <hr/>
    <p>
     在
     <mark>
      迭代器
     </mark>
     的遍历过程中先通过
     <code>
      hastNext()
     </code>
     方法判断是否有下一个元素，如果存在下一个元素再调用
     <code>
      next()
     </code>
     方法获取元素，在这里
     <code>
      next()
     </code>
     方法先往后移动一个元素位置，再返回该位置的元素。因此，在调用
     <code>
      next()
     </code>
     方法之前必须要调用
     <code>
      hastNext()
     </code>
     方法进行检测；如果没有调用并且没有下一个元素，直接调用
     <code>
      next()
     </code>
     方法会抛出
     <code>
      NoSuchElementException异常
     </code>
     。
    </p>
    <h4>
     <a id="_97">
     </a>
     🃏生成迭代器的快捷键
    </h4>
    <p>
     一开始使用
     <mark>
      迭代器
     </mark>
     可能会觉得麻烦，但是如果用的
     <code>
      Idea编译器
     </code>
     是有快捷键的，输入
     <code>
      itit
     </code>
     再回车就会直接生成。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/9ad3a7183b6d8569868983a4e00e412b.gif"/>
    </p>
    <h3>
     <a id="remove_100">
     </a>
     📕迭代器中的remove()
    </h3>
    <h4>
     <a id="remove_101">
     </a>
     ⛄迭代器的remove()方法使用
    </h4>
    <p>
     在
     <mark>
      Iterator接口
     </mark>
     中除了
     <code>
      hasNext()
     </code>
     和
     <code>
      next()
     </code>
     方法外，还有一个
     <code>
      remove()
     </code>
     方法，即
     <strong>
      删除集合中的元素
     </strong>
     。
    </p>
    <p>
     <em>
      如删除上述示例集合中的元素111
     </em>
    </p>
    <pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Iterator</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>
<span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"all"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestDemo</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">222</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">333</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"删除前:"</span> <span class="token operator">+</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> iterator <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Integer</span> value <span class="token operator">=</span>  iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>value <span class="token operator">==</span> <span class="token number">111</span><span class="token punctuation">)</span> iterator<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"删除后"</span> <span class="token operator">+</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      运行结果：
     </strong>
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/89bf1d9da8a590d47989f4a9e3993fe0.png"/>
    </p>
    <h4>
     <a id="revome_130">
     </a>
     ☃️迭代器遍历中调用集合revome()方法触发异常
    </h4>
    <p>
     在Java集合中，以集合
     <code>
      ArrayList
     </code>
     为例，在使用中可能会遇到删除的需求场景，此时如果代码书写不当，极有可能会抛出
     <code>
      java.util.ConcurrentModificationException
     </code>
     异常信息。
     <br/>
     在上述示例中用
     <code>
      Iterator
     </code>
     调用了迭代器
     <code>
      remove()
     </code>
     方法，如果在使用中不小心调用了集合中的
     <code>
      remove()
     </code>
     方法会发生什么？
    </p>
    <pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Iterator</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>
<span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"all"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestDemo</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">222</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">333</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"删除前:"</span> <span class="token operator">+</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> iterator <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Integer</span> value <span class="token operator">=</span>  iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>value <span class="token operator">==</span> <span class="token number">111</span><span class="token punctuation">)</span> list<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"删除后"</span> <span class="token operator">+</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
    <p>
     <strong>
      运行结果：
     </strong>
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/836ed7e76786f0621313f3768e5225af.png">
      <br/>
      运行结果中抛出
      <code>
       java.util.ConcurrentModificationException
      </code>
      异常信息。这是因为触发了
      <mark>
       集合中并发修改的异常
      </mark>
      接下来我们通过源码对抛出异常的原因进行剖析。
     </img>
    </p>
    <pre><code class="prism language-java">    <span class="token keyword">public</span> <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> <span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Itr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
    <p>
     在
     <code>
      ArrayList
     </code>
     集合的
     <code>
      Iterator
     </code>
     方法中，是通过返回
     <code>
      Itr
     </code>
     对象来获得迭代器的。
     <code>
      Itr
     </code>
     是
     <code>
      ArrayList
     </code>
     的一个
     <mark>
      内部类
     </mark>
     ，它实现了
     <code>
      Iterator
     </code>
     接口，
     <em>
      代码如下：
     </em>
    </p>
    <pre><code class="prism language-java">   <span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">Itr</span> <span class="token keyword">implements</span> <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> cursor<span class="token punctuation">;</span>       <span class="token comment">// index of next element to return</span>
        <span class="token keyword">int</span> lastRet <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// index of last element returned; -1 if no such</span>
        <span class="token keyword">int</span> expectedModCount <span class="token operator">=</span> modCount<span class="token punctuation">;</span>

        <span class="token class-name">Itr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> cursor <span class="token operator">!=</span> size<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">"unchecked"</span><span class="token punctuation">)</span>
        <span class="token keyword">public</span> <span class="token class-name">E</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">checkForComodification</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> i <span class="token operator">=</span> cursor<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;=</span> size<span class="token punctuation">)</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NoSuchElementException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> elementData <span class="token operator">=</span> <span class="token class-name">ArrayList</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span>elementData<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;=</span> elementData<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentModificationException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            cursor <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">E</span><span class="token punctuation">)</span> elementData<span class="token punctuation">[</span>lastRet <span class="token operator">=</span> i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>lastRet <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">checkForComodification</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">ArrayList</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>lastRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
                cursor <span class="token operator">=</span> lastRet<span class="token punctuation">;</span>
                lastRet <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
                expectedModCount <span class="token operator">=</span> modCount<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IndexOutOfBoundsException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentModificationException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      Itr类属性
     </strong>
    </p>
    <table>
     <thead>
      <tr>
       <th>
        属性
       </th>
       <th>
        含义
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        cursor
       </td>
       <td>
        索引下标，表示下一个可以访问的元素的索引，默认值为
        <strong>
         0
        </strong>
       </td>
      </tr>
      <tr>
       <td>
        lastRet
       </td>
       <td>
        索引下标，表示上一个元素的索引，默认值为
        <strong>
         -1
        </strong>
       </td>
      </tr>
      <tr>
       <td>
        expectedModCount
       </td>
       <td>
        对集合修改的版本号，初始值为
        <strong>
         ModCount
        </strong>
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     ModCount定义在AbstractList接口中，初始值为
     <strong>
      0
     </strong>
     ，定义如下：
    </p>
    <pre><code class="prism language-java"> <span class="token keyword">protected</span> <span class="token keyword">transient</span> <span class="token keyword">int</span> modCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     ModCount是版本号，在对集合进行变更操作（增加、删除、修改等）的时候会对版本号进行
     <strong>
      +1
     </strong>
     操作。
    </p>
    <hr/>
    <p>
     结合上述代码进行抛出
     <code>
      java.util.ConcurrentModificationException
     </code>
     异常的解释。
     <br/>
     ①初始化ArrayList，添加三次元素，即三次调用
     <code>
      add()
     </code>
     方法，进行三次
     <code>
      modCount++;
     </code>
     此时，
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        m 
          
         
           o 
          
         
           d 
          
         
           C 
          
         
           o 
          
         
           u 
          
         
           n 
          
         
           t 
          
         
           = 
          
         
           3 
          
         
           ， 
          
         
           s 
          
         
           i 
          
         
           z 
          
         
           e 
          
         
           = 
          
         
           3 
          
         
           ； 
          
         
        
       
      
        \color{red}{modCount = 3，size = 3；}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.69444em; vertical-align: 0em;">
         </span>
         <span class="mord" style="color: red;">
          <span class="mord mathdefault" style="color: red;">
           m
          </span>
          <span class="mord mathdefault" style="color: red;">
           o
          </span>
          <span class="mord mathdefault" style="color: red;">
           d
          </span>
          <span class="mord mathdefault" style="margin-right: 0.07153em; color: red;">
           C
          </span>
          <span class="mord mathdefault" style="color: red;">
           o
          </span>
          <span class="mord mathdefault" style="color: red;">
           u
          </span>
          <span class="mord mathdefault" style="color: red;">
           n
          </span>
          <span class="mord mathdefault" style="color: red;">
           t
          </span>
          <span class="mspace" style="color: red; margin-right: 0.277778em;">
          </span>
          <span class="mrel" style="color: red;">
           =
          </span>
          <span class="mspace" style="color: red; margin-right: 0.277778em;">
          </span>
          <span class="mord" style="color: red;">
           3
          </span>
          <span class="mord cjk_fallback" style="color: red;">
           ，
          </span>
          <span class="mord mathdefault" style="color: red;">
           s
          </span>
          <span class="mord mathdefault" style="color: red;">
           i
          </span>
          <span class="mord mathdefault" style="margin-right: 0.04398em; color: red;">
           z
          </span>
          <span class="mord mathdefault" style="color: red;">
           e
          </span>
          <span class="mspace" style="color: red; margin-right: 0.277778em;">
          </span>
          <span class="mrel" style="color: red;">
           =
          </span>
          <span class="mspace" style="color: red; margin-right: 0.277778em;">
          </span>
          <span class="mord" style="color: red;">
           3
          </span>
          <span class="mord cjk_fallback" style="color: red;">
           ；
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     ②初始化Iterator迭代器进行循环，此时，
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        e 
          
         
           x 
          
         
           p 
          
         
           e 
          
         
           c 
          
         
           t 
          
         
           e 
          
         
           d 
          
         
           M 
          
         
           o 
          
         
           d 
          
         
           C 
          
         
           o 
          
         
           u 
          
         
           n 
          
         
           t 
          
         
           = 
          
         
           m 
          
         
           o 
          
         
           d 
          
         
           C 
          
         
           o 
          
         
           u 
          
         
           n 
          
         
           t 
          
         
           = 
          
         
           3 
          
         
           ， 
          
         
        
       
      
        \color{red}{expectedModCount = modCount=3，}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;">
         </span>
         <span class="mord" style="color: red;">
          <span class="mord mathdefault" style="color: red;">
           e
          </span>
          <span class="mord mathdefault" style="color: red;">
           x
          </span>
          <span class="mord mathdefault" style="color: red;">
           p
          </span>
          <span class="mord mathdefault" style="color: red;">
           e
          </span>
          <span class="mord mathdefault" style="color: red;">
           c
          </span>
          <span class="mord mathdefault" style="color: red;">
           t
          </span>
          <span class="mord mathdefault" style="color: red;">
           e
          </span>
          <span class="mord mathdefault" style="color: red;">
           d
          </span>
          <span class="mord mathdefault" style="margin-right: 0.10903em; color: red;">
           M
          </span>
          <span class="mord mathdefault" style="color: red;">
           o
          </span>
          <span class="mord mathdefault" style="color: red;">
           d
          </span>
          <span class="mord mathdefault" style="margin-right: 0.07153em; color: red;">
           C
          </span>
          <span class="mord mathdefault" style="color: red;">
           o
          </span>
          <span class="mord mathdefault" style="color: red;">
           u
          </span>
          <span class="mord mathdefault" style="color: red;">
           n
          </span>
          <span class="mord mathdefault" style="color: red;">
           t
          </span>
          <span class="mspace" style="color: red; margin-right: 0.277778em;">
          </span>
          <span class="mrel" style="color: red;">
           =
          </span>
          <span class="mspace" style="color: red; margin-right: 0.277778em;">
          </span>
          <span class="mord mathdefault" style="color: red;">
           m
          </span>
          <span class="mord mathdefault" style="color: red;">
           o
          </span>
          <span class="mord mathdefault" style="color: red;">
           d
          </span>
          <span class="mord mathdefault" style="margin-right: 0.07153em; color: red;">
           C
          </span>
          <span class="mord mathdefault" style="color: red;">
           o
          </span>
          <span class="mord mathdefault" style="color: red;">
           u
          </span>
          <span class="mord mathdefault" style="color: red;">
           n
          </span>
          <span class="mord mathdefault" style="color: red;">
           t
          </span>
          <span class="mspace" style="color: red; margin-right: 0.277778em;">
          </span>
          <span class="mrel" style="color: red;">
           =
          </span>
          <span class="mspace" style="color: red; margin-right: 0.277778em;">
          </span>
          <span class="mord" style="color: red;">
           3
          </span>
          <span class="mord cjk_fallback" style="color: red;">
           ，
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        c 
          
         
           u 
          
         
           r 
          
         
           s 
          
         
           o 
          
         
           r 
          
         
           = 
          
         
           0 
          
         
           ， 
          
         
           l 
          
         
           a 
          
         
           s 
          
         
           t 
          
         
           R 
          
         
           e 
          
         
           t 
          
         
           = 
          
         
           − 
          
         
           1 
          
         
        
       
      
        \color{red}{cursor=0，lastRet = -1}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;">
         </span>
         <span class="mord" style="color: red;">
          <span class="mord mathdefault" style="color: red;">
           c
          </span>
          <span class="mord mathdefault" style="color: red;">
           u
          </span>
          <span class="mord mathdefault" style="margin-right: 0.02778em; color: red;">
           r
          </span>
          <span class="mord mathdefault" style="color: red;">
           s
          </span>
          <span class="mord mathdefault" style="color: red;">
           o
          </span>
          <span class="mord mathdefault" style="margin-right: 0.02778em; color: red;">
           r
          </span>
          <span class="mspace" style="color: red; margin-right: 0.277778em;">
          </span>
          <span class="mrel" style="color: red;">
           =
          </span>
          <span class="mspace" style="color: red; margin-right: 0.277778em;">
          </span>
          <span class="mord" style="color: red;">
           0
          </span>
          <span class="mord cjk_fallback" style="color: red;">
           ，
          </span>
          <span class="mord mathdefault" style="margin-right: 0.01968em; color: red;">
           l
          </span>
          <span class="mord mathdefault" style="color: red;">
           a
          </span>
          <span class="mord mathdefault" style="color: red;">
           s
          </span>
          <span class="mord mathdefault" style="color: red;">
           t
          </span>
          <span class="mord mathdefault" style="margin-right: 0.00773em; color: red;">
           R
          </span>
          <span class="mord mathdefault" style="color: red;">
           e
          </span>
          <span class="mord mathdefault" style="color: red;">
           t
          </span>
          <span class="mspace" style="color: red; margin-right: 0.277778em;">
          </span>
          <span class="mrel" style="color: red;">
           =
          </span>
          <span class="mspace" style="color: red; margin-right: 0.277778em;">
          </span>
          <span class="mord" style="color: red;">
           −
          </span>
          <span class="mord" style="color: red;">
           1
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     ③进行hasNext判断，
     <code>
      cursor != size;
     </code>
     成立，进入循环
     <br/>
     ④调用
     <code>
      next()
     </code>
     方法，首先进行
     <code>
      checkForComodification()
     </code>
     校验，
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        m 
          
         
           o 
          
         
           d 
          
         
           C 
          
         
           o 
          
         
           u 
          
         
           n 
          
         
           t 
          
         
           = 
          
         
           = 
          
         
           e 
          
         
           x 
          
         
           p 
          
         
           e 
          
         
           c 
          
         
           t 
          
         
           e 
          
         
           d 
          
         
           M 
          
         
           o 
          
         
           d 
          
         
           C 
          
         
           o 
          
         
           u 
          
         
           n 
          
         
           t 
          
         
        
       
      
        \color{red}{modCount == expectedModCount}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;">
         </span>
         <span class="mord" style="color: red;">
          <span class="mord mathdefault" style="color: red;">
           m
          </span>
          <span class="mord mathdefault" style="color: red;">
           o
          </span>
          <span class="mord mathdefault" style="color: red;">
           d
          </span>
          <span class="mord mathdefault" style="margin-right: 0.07153em; color: red;">
           C
          </span>
          <span class="mord mathdefault" style="color: red;">
           o
          </span>
          <span class="mord mathdefault" style="color: red;">
           u
          </span>
          <span class="mord mathdefault" style="color: red;">
           n
          </span>
          <span class="mord mathdefault" style="color: red;">
           t
          </span>
          <span class="mspace" style="color: red; margin-right: 0.277778em;">
          </span>
          <span class="mrel" style="color: red;">
           =
          </span>
          <span class="mrel" style="color: red;">
           =
          </span>
          <span class="mspace" style="color: red; margin-right: 0.277778em;">
          </span>
          <span class="mord mathdefault" style="color: red;">
           e
          </span>
          <span class="mord mathdefault" style="color: red;">
           x
          </span>
          <span class="mord mathdefault" style="color: red;">
           p
          </span>
          <span class="mord mathdefault" style="color: red;">
           e
          </span>
          <span class="mord mathdefault" style="color: red;">
           c
          </span>
          <span class="mord mathdefault" style="color: red;">
           t
          </span>
          <span class="mord mathdefault" style="color: red;">
           e
          </span>
          <span class="mord mathdefault" style="color: red;">
           d
          </span>
          <span class="mord mathdefault" style="margin-right: 0.10903em; color: red;">
           M
          </span>
          <span class="mord mathdefault" style="color: red;">
           o
          </span>
          <span class="mord mathdefault" style="color: red;">
           d
          </span>
          <span class="mord mathdefault" style="margin-right: 0.07153em; color: red;">
           C
          </span>
          <span class="mord mathdefault" style="color: red;">
           o
          </span>
          <span class="mord mathdefault" style="color: red;">
           u
          </span>
          <span class="mord mathdefault" style="color: red;">
           n
          </span>
          <span class="mord mathdefault" style="color: red;">
           t
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ，校验通过，返回值，此时
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        l 
          
         
           a 
          
         
           s 
          
         
           t 
          
         
           R 
          
         
           e 
          
         
           t 
          
         
           = 
          
         
           0 
          
         
           ; 
          
         
           c 
          
         
           u 
          
         
           r 
          
         
           s 
          
         
           o 
          
         
           r 
          
         
           = 
          
         
           1 
          
         
        
       
      
        \color{red}{lastRet = 0;cursor = 1}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;">
         </span>
         <span class="mord" style="color: red;">
          <span class="mord mathdefault" style="margin-right: 0.01968em; color: red;">
           l
          </span>
          <span class="mord mathdefault" style="color: red;">
           a
          </span>
          <span class="mord mathdefault" style="color: red;">
           s
          </span>
          <span class="mord mathdefault" style="color: red;">
           t
          </span>
          <span class="mord mathdefault" style="margin-right: 0.00773em; color: red;">
           R
          </span>
          <span class="mord mathdefault" style="color: red;">
           e
          </span>
          <span class="mord mathdefault" style="color: red;">
           t
          </span>
          <span class="mspace" style="color: red; margin-right: 0.277778em;">
          </span>
          <span class="mrel" style="color: red;">
           =
          </span>
          <span class="mspace" style="color: red; margin-right: 0.277778em;">
          </span>
          <span class="mord" style="color: red;">
           0
          </span>
          <span class="mpunct" style="color: red;">
           ;
          </span>
          <span class="mspace" style="color: red; margin-right: 0.166667em;">
          </span>
          <span class="mord mathdefault" style="color: red;">
           c
          </span>
          <span class="mord mathdefault" style="color: red;">
           u
          </span>
          <span class="mord mathdefault" style="margin-right: 0.02778em; color: red;">
           r
          </span>
          <span class="mord mathdefault" style="color: red;">
           s
          </span>
          <span class="mord mathdefault" style="color: red;">
           o
          </span>
          <span class="mord mathdefault" style="margin-right: 0.02778em; color: red;">
           r
          </span>
          <span class="mspace" style="color: red; margin-right: 0.277778em;">
          </span>
          <span class="mrel" style="color: red;">
           =
          </span>
          <span class="mspace" style="color: red; margin-right: 0.277778em;">
          </span>
          <span class="mord" style="color: red;">
           1
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <pre><code class="prism language-java"> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">checkForComodification</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>modCount <span class="token operator">!=</span> expectedModCount<span class="token punctuation">)</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentModificationException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre>
    <p>
     ⑤调用集合
     <code>
      remove()
     </code>
     方法，
     <code>
      modCount++；
     </code>
     ，此时
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        m 
          
         
           o 
          
         
           d 
          
         
           C 
          
         
           o 
          
         
           u 
          
         
           n 
          
         
           t 
          
         
           = 
          
         
           4 
          
         
           ; 
          
         
           s 
          
         
           i 
          
         
           z 
          
         
           e 
          
         
           = 
          
         
           2 
          
         
        
       
      
        \color{red}{modCount = 4;size = 2}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;">
         </span>
         <span class="mord" style="color: red;">
          <span class="mord mathdefault" style="color: red;">
           m
          </span>
          <span class="mord mathdefault" style="color: red;">
           o
          </span>
          <span class="mord mathdefault" style="color: red;">
           d
          </span>
          <span class="mord mathdefault" style="margin-right: 0.07153em; color: red;">
           C
          </span>
          <span class="mord mathdefault" style="color: red;">
           o
          </span>
          <span class="mord mathdefault" style="color: red;">
           u
          </span>
          <span class="mord mathdefault" style="color: red;">
           n
          </span>
          <span class="mord mathdefault" style="color: red;">
           t
          </span>
          <span class="mspace" style="color: red; margin-right: 0.277778em;">
          </span>
          <span class="mrel" style="color: red;">
           =
          </span>
          <span class="mspace" style="color: red; margin-right: 0.277778em;">
          </span>
          <span class="mord" style="color: red;">
           4
          </span>
          <span class="mpunct" style="color: red;">
           ;
          </span>
          <span class="mspace" style="color: red; margin-right: 0.166667em;">
          </span>
          <span class="mord mathdefault" style="color: red;">
           s
          </span>
          <span class="mord mathdefault" style="color: red;">
           i
          </span>
          <span class="mord mathdefault" style="margin-right: 0.04398em; color: red;">
           z
          </span>
          <span class="mord mathdefault" style="color: red;">
           e
          </span>
          <span class="mspace" style="color: red; margin-right: 0.277778em;">
          </span>
          <span class="mrel" style="color: red;">
           =
          </span>
          <span class="mspace" style="color: red; margin-right: 0.277778em;">
          </span>
          <span class="mord" style="color: red;">
           2
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     ⑥再次调用hasNext()方法判断，
     <code>
      cursor != size;
     </code>
     成立，进入循环
     <br/>
     ⑦调用
     <code>
      next()
     </code>
     方法进行校验，
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        m 
          
         
           o 
          
         
           d 
          
         
           C 
          
         
           o 
          
         
           u 
          
         
           n 
          
         
           t 
          
         
           ! 
          
         
           = 
          
         
           e 
          
         
           x 
          
         
           p 
          
         
           e 
          
         
           c 
          
         
           t 
          
         
           e 
          
         
           d 
          
         
           M 
          
         
           o 
          
         
           d 
          
         
           C 
          
         
           o 
          
         
           u 
          
         
           n 
          
         
           t 
          
         
        
       
      
        \color{red}{modCount != expectedModCount}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;">
         </span>
         <span class="mord" style="color: red;">
          <span class="mord mathdefault" style="color: red;">
           m
          </span>
          <span class="mord mathdefault" style="color: red;">
           o
          </span>
          <span class="mord mathdefault" style="color: red;">
           d
          </span>
          <span class="mord mathdefault" style="margin-right: 0.07153em; color: red;">
           C
          </span>
          <span class="mord mathdefault" style="color: red;">
           o
          </span>
          <span class="mord mathdefault" style="color: red;">
           u
          </span>
          <span class="mord mathdefault" style="color: red;">
           n
          </span>
          <span class="mord mathdefault" style="color: red;">
           t
          </span>
          <span class="mclose" style="color: red;">
           !
          </span>
          <span class="mspace" style="color: red; margin-right: 0.277778em;">
          </span>
          <span class="mrel" style="color: red;">
           =
          </span>
          <span class="mspace" style="color: red; margin-right: 0.277778em;">
          </span>
          <span class="mord mathdefault" style="color: red;">
           e
          </span>
          <span class="mord mathdefault" style="color: red;">
           x
          </span>
          <span class="mord mathdefault" style="color: red;">
           p
          </span>
          <span class="mord mathdefault" style="color: red;">
           e
          </span>
          <span class="mord mathdefault" style="color: red;">
           c
          </span>
          <span class="mord mathdefault" style="color: red;">
           t
          </span>
          <span class="mord mathdefault" style="color: red;">
           e
          </span>
          <span class="mord mathdefault" style="color: red;">
           d
          </span>
          <span class="mord mathdefault" style="margin-right: 0.10903em; color: red;">
           M
          </span>
          <span class="mord mathdefault" style="color: red;">
           o
          </span>
          <span class="mord mathdefault" style="color: red;">
           d
          </span>
          <span class="mord mathdefault" style="margin-right: 0.07153em; color: red;">
           C
          </span>
          <span class="mord mathdefault" style="color: red;">
           o
          </span>
          <span class="mord mathdefault" style="color: red;">
           u
          </span>
          <span class="mord mathdefault" style="color: red;">
           n
          </span>
          <span class="mord mathdefault" style="color: red;">
           t
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ，校验未通过，抛出
     <code>
      java.util.ConcurrentModificationException
     </code>
     异常
    </p>
    <p>
     <strong>
      总结：
     </strong>
    </p>
    <blockquote>
     <p>
      ①在使用
      <mark>
       迭代器
      </mark>
      的
      <code>
       remove()
      </code>
      操作时，会将更新后的
      <code>
       modCount
      </code>
      给
      <code>
       expectedModCount
      </code>
      ，两者会得到同步，但是在调用集合的
      <code>
       remove()
      </code>
      方法后，两个不会进行同步，进而导致在
      <code>
       checkForComodification()
      </code>
      校验时不通过，抛出
      <code>
       java.util.ConcurrentModificationException
      </code>
      异常。
      <br/>
      ②所以，在单线程下使用迭代器是没有问题的，但是在多线程下同时操作集合就不允许了，可以通过
      <strong>
       fail-fast
      </strong>
      快速失败机制，快速判断是否存在同时操作问题。因此，
      <mark>
       集合在多线程下使用是不安全的
      </mark>
      。
     </p>
    </blockquote>
    <h3>
     <a id="for_244">
     </a>
     📗增强for循环
    </h3>
    <h4>
     <a id="for_245">
     </a>
     📫认识增强for循环
    </h4>
    <blockquote>
     <p>
      <code>
       增强for循环
      </code>
      可以代替
      <mark>
       Iterator迭代器
      </mark>
      ，可以把它看做简化版的Iterator，和迭代器本质一样，其实它的底层实现就是Iterator迭代器，只能用于
      <mark>
       遍历集合或数组
      </mark>
      。
     </p>
    </blockquote>
    <h4>
     <a id="_249">
     </a>
     📪基本语法
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/80e05a43aa84c98b2ec8f29aa76b5e64.png"/>
    </p>
    <h4>
     <a id="for_251">
     </a>
     📬增强for循环的使用
    </h4>
    <pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestDemo03</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">222</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">333</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"====增强for循环遍历集合===="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> i <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"====增强for循环遍历数组===="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">:</span> arr<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
    <p>
     <strong>
      运行结果：
     </strong>
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/0415173fee40886edff894660d9cb6f8.png"/>
    </p>
    <h4>
     <a id="for_281">
     </a>
     📭增强for循环的快捷键
    </h4>
    <p>
     与迭代器一样，增强for循环也有快捷键，输入
     <code>
      I
     </code>
     回车即可快速生成。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/7bdf6867108dd8856e7ae2c1f6c60982.gif"/>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
</div>


