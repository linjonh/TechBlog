---
arturl_encode: "68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f36343936383136312f:61727469636c652f64657461696c732f313436303830333537"
layout: post
title: "数据库复习第五版-第十章-数据库恢复技术"
date: 2025-03-06 21:58:28 +08:00
description: "是一组操作序列，要么不做，要么全部完成，是一个不可分割的工作序列。事务开始：begin transaction事务提交：commit事务回滚：rollbackACID特性：原子性：事务要么不做，要么全部完成。一致性：事务执行的结果必须是从数据库的一个一致性状态到另一个一致性状态。隔离性：一个事务内部对数据对象的操作对其他并发事务是隔离的。持久性：事务一旦提交，对数据库中的改变就应该是永久的。为什么需要数据库恢复子系统？作用是什么。"
keywords: "数据库复习（第五版）- 第十章 数据库恢复技术"
categories: ['复试']
tags: ['数据库', '学习']
artid: "146080357"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146080357
    alt: "数据库复习第五版-第十章-数据库恢复技术"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146080357
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146080357
cover: https://bing.ee123.net/img/rand?artid=146080357
image: https://bing.ee123.net/img/rand?artid=146080357
img: https://bing.ee123.net/img/rand?artid=146080357
---

# 数据库复习（第五版）- 第十章 数据库恢复技术

### 事务定义：

是一组操作序列，要么不做，要么全部完成，是一个不可分割的工作序列。

**事务开始：begin transaction**

**事务提交：commit**

**事务回滚：rollback**

### **ACID特性：**

**原子性：事务要么不做，要么全部完成。**

**一致性：事务执行的结果必须是从数据库的一个一致性状态到另一个一致性状态。**

**隔离性：一个事务内部对数据对象的操作对其他并发事务是隔离的。**

**持久性：事务一旦提交，对数据库中的改变就应该是永久的。**

### **为什么需要数据库恢复子系统？作用是什么**

因为在数据库中，硬件或软件的故障、操作员的失误以及恶意的破坏是不可避免的，这些故障轻则影响事务的不正确执行，导致数据库中数据的不正确性，重则破坏整个数据库，使数据库中的数据全部丢失。恢复子系统能够使被破坏的数据库恢复到某一正确状态，从而保护数据库的安全性。

### 故障的种类

事务故障

系统故障

介质故障

计算机病毒

### 恢复技术

数据转储和登录日志文件。

#### 数据转储的类别

**静态转储：**

在进行转储时，数据库首先保持无事务运行且处于一致性状态，然后进行转储，在转储期间不允许事务执行，直到转储完成，很显然在转储期间其他事务什么也不能做，降低了事务的并发性，但这保证的转储数据的正确性。

**动态转储：**

在进行转储时，其他事务可以对数据进行存取或修改，能够提高数据库的可用性和事务的并发性，但这样会导致转储后的后备数据可能不正确有效。只有加上日志文件才能保证数据的正确性。

还有海量转储（全部数据）和增量转储（部分增量数据）

#### 登录日志文件

**作用：**

1）事务故障和系统故障必须使用日志文件

2）动态转储时需要日志文件保证后备数据的正确性。

**规则：**

1）必须按照事务的执行时间登记。

2）必须先写日志，后写数据库。

### 恢复策略

#### 事务故障的恢复

**反向扫描**
日志文件，找到事务的更新操作，对更新操作执行
**逆操作**
，如果是插入操作，逆操作就为删除操作，如果是删除操作，逆操作就为插入操作，如果是更新操作，就将更新前的值写入数据库，直到读到事务的开始标志。

#### 系统故障的恢复

**正向扫描
日志文件**
，将
**未提交的事务加入UNDO队列**
，将
**已提交的事务加入REDO队列**
，对
**UNDO队列的事务执行撤销**
操作，对
**REDO队列的事务执行重做**
操作。撤销就是反向扫描日志文件并执行逆操作，重做就是正向扫描日志文件并重做事务。

#### 介质故障的恢复

利用
**后备数据**
将数据库
**恢复到之前**
的某一执行性状态，然后利用此时的
**日志文件**
，对日志文件中已提交的
**事务进行重做**
，从而
**恢复到现在**
的一致性状态。

#### 检查点技术

![](https://i-blog.csdnimg.cn/direct/ef17a7a03c8d44ffbd5b39dc6e105ad7.png)

首先将ACTIVE-LIST放入UNDO队列，从检查点开始，遇到一个新开始的事务先将它放到UNDO队列，若遇到已提交事务的则转入REDO队列，最后对UNDO队列执行撤销操作，对REDO队列执行重做操作。

#### 数据库镜像

用于解决介质故障。

自动将整个数据库或者部分关键数据
**复制到另一个磁盘**
，每当主数据库更新时，数据库管理系统自动将更新后的数据复制过去，并由数据库管理系统自动保持数据的一致性。

还可以用于并发操作，当某事务对主数据库中的某数据对象加上排他锁时，其他用户可以读镜像数据库中的数据，而不必等待释放锁。