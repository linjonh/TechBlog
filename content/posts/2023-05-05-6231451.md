---
layout: post
title: "正试图在-os-加载程序锁内执行托管代码不要尝试在-DllMain-或映像初始化函数内运行托管代码,这样做会导致应用程序挂起"
date: 2023-05-05 09:23:42 +0800
description: " 正试图在 os 加载程序锁内执行托管代码。不要尝试在 DllMain 或映像初始化函数内运行托管代"
keywords: "正尝试在 os 加载程序锁内执行托管代码。不要尝试在 dllmain 或映像初始化函数内"
categories: ['Net', 'Dot', 'C', 'And']
tags: ['Video', 'String', 'Os', 'Exception', 'Dll', '.Net']
artid: "6231451"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=6231451
    alt: "正试图在-os-加载程序锁内执行托管代码不要尝试在-DllMain-或映像初始化函数内运行托管代码,这样做会导致应用程序挂起"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=6231451
featuredImagePreview: https://bing.ee123.net/img/rand?artid=6231451
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     正试图在 os 加载程序锁内执行托管代码。不要尝试在 DllMain 或映像初始化函数内运行托管代码，这样做会导致应用程序挂起。
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
    </p>
    <p class="MsoNormal">
     <span style="font-family: mceinline;">
      正试图在
      <span lang="EN-US">
       os
      </span>
      加载程序锁内执行托管代码。不要尝试在
      <span lang="EN-US">
       DllMain
      </span>
      或映像初始化函数内运行托管代码，这样做会导致应用程序挂起。
     </span>
    </p>
    <p class="MsoNormal">
     <span style="font-family: mceinline;">
      <br/>
     </span>
    </p>
    <p class="MsoNormal">
     <span lang="EN-US">
      <span style="font-family: mceinline;">
       <img alt="" src="http://hi.csdn.net/attachment/201103/8/0_1299564235xMAz.gif"/>
      </span>
     </span>
    </p>
    <p class="MsoNormal">
     <span lang="EN-US">
      <span style="font-family: mceinline;">
       <br/>
      </span>
     </span>
    </p>
    <p class="MsoNormal">
     <span style="font-family: mceinline;">
      <span lang="EN-US">
       .NET2.0
      </span>
      中增加了
      <span lang="EN-US">
       42
      </span>
      种非常强大的调试助手
      <span lang="EN-US">
       (MDA
      </span>
      ，
      <span lang="EN-US">
       Loaderlock
      </span>
      是其中之一。
      <span lang="EN-US">
       Loaderlock
      </span>
      检测在一个拥有操作系统
      <span lang="EN-US">
       loader lock
      </span>
      的线程上
      <span lang="EN-US">
       (
      </span>
      如上例的
      <span lang="EN-US">
       video
      </span>
      的运行线程
      <span lang="EN-US">
       )
      </span>
      运行托管代码的情况。这样做有可能会引起死锁，并且有可能在操作系统加载器初始化
      <span lang="EN-US">
       DLL
      </span>
      前被使用。虽然这样做很有必要，但在进行开发调试的时候
      <span lang="EN-US">
       ,
      </span>
      实在太麻烦
      <span lang="EN-US">
      </span>
     </span>
    </p>
    <p class="MsoNormal">
     <span lang="EN-US">
      <span style="font-family: mceinline;">
      </span>
     </span>
    </p>
    <p class="MsoNormal">
     <span style="font-family: mceinline;">
      这是由于正在加载特定资源：例如换肤控件时
      <span lang="EN-US">
      </span>
     </span>
    </p>
    <p class="MsoNormal">
     <span lang="EN-US">
      <span style="font-family: mceinline;">
      </span>
     </span>
    </p>
    <p class="MsoNormal">
     <span lang="EN-US">
      <span style="font-family: mceinline;">
      </span>
     </span>
    </p>
    <p class="MsoNormal">
     <span style="font-family: mceinline;">
      •办法一
      <span lang="EN-US">
      </span>
     </span>
    </p>
    <p class="MsoNormal">
     <span style="font-family: mceinline;">
      <span lang="EN-US">
       1.
      </span>
      把
      <span lang="EN-US">
       vs2005
      </span>
      菜单的 调试
      <span lang="EN-US">
       -&gt;
      </span>
      异常
      <span lang="EN-US">
       -&gt;Managed Debuggin Assistants-&gt;LoaderLock
      </span>
      的选中状态去掉
      <span lang="EN-US">
      </span>
     </span>
    </p>
    <p class="MsoNormal">
     <span style="font-family: mceinline;">
      <span lang="EN-US">
       2.
      </span>
      如果异常（
      <span lang="EN-US">
       exception
      </span>
      ）这一项没有的话，在工具
      <span lang="EN-US">
       ---
      </span>
      自定义
      <span lang="EN-US">
       ---
      </span>
      命令选项卡
      <span lang="EN-US">
       ---
      </span>
      左边选择调试
      <span lang="EN-US">
       --
      </span>
      右边把异常托到菜单里
      <span lang="EN-US">
      </span>
     </span>
    </p>
    <p class="MsoNormal">
     <span style="font-family: mceinline;">
      <span lang="EN-US">
       3.
      </span>
      快捷键
      <span lang="EN-US">
       Ctrl+Alt+E
      </span>
      ，修改
      <span lang="EN-US">
       Managed Debuggin Assistants-&gt;LoaderLock
      </span>
      的选中状态去掉
      <span lang="EN-US">
      </span>
     </span>
    </p>
    <p class="MsoNormal">
     <span style="font-family: mceinline;">
      •方法二
      <span lang="EN-US">
      </span>
     </span>
    </p>
    <p class="MsoNormal">
     <span style="font-family: mceinline;">
      <span lang="EN-US">
       1.
      </span>
      在
      <span lang="EN-US">
       HKEY_LOCAL_MACHINE/SOFTWARE/Microsoft/.NETFramework
      </span>
      下面增加一个
      <span lang="EN-US">
       String,
      </span>
      值为
      <span lang="EN-US">
       "0"
      </span>
     </span>
    </p>
    <p class="MsoNormal">
     <span lang="EN-US">
      <span style="font-family: mceinline;">
      </span>
     </span>
    </p>
    <p class="MsoNormal">
     <span style="font-family: mceinline;">
      <span lang="EN-US">
      </span>
      不过这样做
      <span lang="EN-US">
       ,
      </span>
      在该计算机上所有基于
      <span lang="EN-US">
       .NET2.0
      </span>
      开发都得不到
      <span lang="EN-US">
       MDA
      </span>
      的好处.
     </span>
    </p>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a:2f2f626c6f672e6373646e2e6e65742f6a69616e7969373635:392f61727469636c652f64657461696c732f36323331343531" class_="artid" style="display:none">
 </p>
</div>


