---
layout: post
title: "Python数据分析之机器学习基础"
date: 2025-03-11 13:18:42 +0800
description: "机器学习- 了解机器学习概念、分类及常见算法    - 监督学习：使用标注数据，训练模型预测输出，如分类、回归任务。以下应用都是监督学习    - 无监督学习：处理未标注数据，寻找数据模式，如聚类、降维等。- 模型评估与选择    - 掌握模型评估指标，使用交叉验证选最优模型。- 实践应用    - 用 scikit-learn 等库构建简单机器学习模型解决实际问题。应用1：使用KNN对鸢尾花数据集进行分类应用2：使用KNN方法来实现手写数字识别应用3：使用支持向量机SVM算法分类"
keywords: "Python数据分析之机器学习基础"
categories: ['Python']
tags: ['机器学习', '数据分析', 'Python']
artid: "146131838"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146131838
    alt: "Python数据分析之机器学习基础"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146131838
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146131838
cover: https://bing.ee123.net/img/rand?artid=146131838
image: https://bing.ee123.net/img/rand?artid=146131838
img: https://bing.ee123.net/img/rand?artid=146131838
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Python数据分析之机器学习基础
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h4>
     <a id="Python__0">
     </a>
     Python 数据分析重点知识点
    </h4>
    <p>
     <em>
      <strong>
       本系列不同其他的知识点讲解，力求通过例子让新同学学习用法，帮助老同学快速回忆知识点
      </strong>
     </em>
    </p>
    <p>
     可视化系列：
    </p>
    <ol>
     <li>
      <a href="https://blog.csdn.net/weixin_52593633/article/details/146131777">
       Python基础
      </a>
     </li>
     <li>
      <a href="https://blog.csdn.net/weixin_52593633/article/details/146131820?spm=1001.2014.3001.5501">
       数据分析工具
      </a>
     </li>
     <li>
      <a href="https://blog.csdn.net/weixin_52593633/article/details/146131811?spm=1001.2014.3001.5501">
       数据处理与分析
      </a>
     </li>
     <li>
      <a href="https://blog.csdn.net/weixin_52593633/article/details/146131829">
       数据可视化
      </a>
     </li>
     <li>
      <a href="https://blog.csdn.net/weixin_52593633/article/details/146131838">
       机器学习基础
      </a>
     </li>
    </ol>
    <h5>
     <a id="_9">
     </a>
     五、机器学习基础
    </h5>
    <ul>
     <li>
      <strong>
       了解机器学习概念、分类及常见算法
      </strong>
      <ul>
       <li>
        监督学习：使用标注数据，训练模型预测输出，如分类、回归任务。以下应用都是监督学习
       </li>
       <li>
        无监督学习：处理未标注数据，寻找数据模式，如聚类、降维等。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       模型评估与选择
      </strong>
      <ul>
       <li>
        掌握模型评估指标，使用交叉验证选最优模型。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       实践应用
      </strong>
      <ul>
       <li>
        用 scikit-learn 等库构建简单机器学习模型解决实际问题。
       </li>
      </ul>
     </li>
    </ul>
    <p>
     应用1
    </p>
    <pre><code class="prism language-python"><span class="token comment"># 使用KNN对鸢尾花数据集进行分类</span>
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> datasets
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>neighbors <span class="token keyword">import</span> KNeighborsClassifier
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split

<span class="token comment">#导入鸢尾花数据集并查看数据特征</span>

iris<span class="token operator">=</span>datasets<span class="token punctuation">.</span>load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'数据集结构：'</span><span class="token punctuation">,</span>iris<span class="token punctuation">.</span>data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>

<span class="token comment"># 获取属性</span>
iris_x<span class="token operator">=</span>iris<span class="token punctuation">.</span>data
<span class="token keyword">print</span><span class="token punctuation">(</span>iris_x<span class="token punctuation">)</span> <span class="token comment">#对应萼片长度、萼片宽度、花瓣长度和花瓣宽度</span>
<span class="token comment"># 获取类别</span>
iris_y<span class="token operator">=</span>iris<span class="token punctuation">.</span>target 
<span class="token keyword">print</span><span class="token punctuation">(</span>iris_y<span class="token punctuation">)</span> <span class="token comment">#相应的类型，山鸢尾（Setosa），杂色鸢尾（Versicolor）和维吉尼亚鸢尾（Virginica）</span>
<span class="token comment"># 划分成测试集合训练集</span>
iris_train_x<span class="token punctuation">,</span>iris_test_x<span class="token punctuation">,</span>iris_train_y<span class="token punctuation">,</span>iris_test_y<span class="token operator">=</span>train_test_split<span class="token punctuation">(</span>iris_x<span class="token punctuation">,</span>iris_y<span class="token punctuation">,</span>test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token comment">#分类器初始化</span>
knn<span class="token operator">=</span>KNeighborsClassifier<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 对数据集进行训练</span>
knn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>iris_train_x<span class="token punctuation">,</span>iris_train_y<span class="token punctuation">)</span>
<span class="token comment"># 对测试集数据的鸢尾花类型进行预测</span>
predict_result<span class="token operator">=</span>knn<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>iris_test_x<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'测试集大小：'</span><span class="token punctuation">,</span>iris_test_x<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'真实结果:'</span><span class="token punctuation">,</span>iris_test_y<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'预测结果：'</span><span class="token punctuation">,</span>predict_result<span class="token punctuation">)</span>
<span class="token comment">#显示预测精确率</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'预测精确率：'</span><span class="token punctuation">,</span>knn<span class="token punctuation">.</span>score<span class="token punctuation">(</span>iris_test_x<span class="token punctuation">,</span>iris_test_y<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/74a5069ae32f4b548fa8e575017207c0.png#pic_center" width="500">
      <br/>
      应用2
     </img>
    </p>
    <pre><code class="prism language-python"><span class="token comment"># 使用KNN方法来实现手写数字识别</span>
<span class="token comment"># coding=utf-8</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> os <span class="token keyword">import</span> listdir

<span class="token keyword">def</span> <span class="token function">loadDataSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 获取训练数据集</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"1.Loading trainSet..."</span><span class="token punctuation">)</span>
    trainFileList<span class="token operator">=</span>listdir<span class="token punctuation">(</span><span class="token string">"source/HWdigits/trainSet"</span><span class="token punctuation">)</span>
    trainNum<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>trainFileList<span class="token punctuation">)</span>

    trainX<span class="token operator">=</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>trainNum<span class="token punctuation">,</span><span class="token number">32</span><span class="token operator">*</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    trainY<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>trainNum<span class="token punctuation">)</span><span class="token punctuation">:</span>
        trainFile<span class="token operator">=</span>trainFileList<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        <span class="token comment"># 将训练数据集向量化</span>
        trainX<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token operator">=</span>img2vector<span class="token punctuation">(</span><span class="token string">'source/HWdigits/trainSet/%s'</span><span class="token operator">%</span> trainFile<span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">)</span>
        label<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>trainFile<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'_'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 读取文件名的第一位作为标记</span>
        trainY<span class="token punctuation">.</span>append<span class="token punctuation">(</span>label<span class="token punctuation">)</span>

    <span class="token comment">#获取测试数据集</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"2.Loading testSet..."</span><span class="token punctuation">)</span>
    testFileList<span class="token operator">=</span>listdir<span class="token punctuation">(</span><span class="token string">"source/HWdigits/testSet"</span><span class="token punctuation">)</span>
    testNum<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>testFileList<span class="token punctuation">)</span>
    testX<span class="token operator">=</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>testNum<span class="token punctuation">,</span><span class="token number">32</span><span class="token operator">*</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    testY<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>testNum<span class="token punctuation">)</span><span class="token punctuation">:</span>
        testFile<span class="token operator">=</span>testFileList<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        <span class="token comment"># 将测试数据集向量化</span>
        testX<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token operator">=</span>img2vector<span class="token punctuation">(</span><span class="token string">'source/HWdigits/testSet/%s'</span><span class="token operator">%</span> testFile<span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">)</span>
        label<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>testFile<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'_'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 读取文件名的第一位作为标记</span>
        testY<span class="token punctuation">.</span>append<span class="token punctuation">(</span>label<span class="token punctuation">)</span>
    <span class="token keyword">return</span> trainX<span class="token punctuation">,</span>trainY<span class="token punctuation">,</span>testX<span class="token punctuation">,</span>testY
<span class="token keyword">def</span> <span class="token function">img2vector</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span>h<span class="token punctuation">,</span>w<span class="token punctuation">)</span><span class="token punctuation">:</span>
    imgVector<span class="token operator">=</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>h<span class="token operator">*</span>w<span class="token punctuation">)</span><span class="token punctuation">)</span>
    fileIn<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
    <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">:</span>
        lineStr<span class="token operator">=</span>fileIn<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> col <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span><span class="token punctuation">:</span>
            imgVector<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span>row<span class="token operator">*</span><span class="token number">32</span><span class="token operator">+</span>col<span class="token punctuation">]</span><span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>lineStr<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> imgVector
<span class="token keyword">def</span> <span class="token function">myKNN</span><span class="token punctuation">(</span>testDigit<span class="token punctuation">,</span>trainX<span class="token punctuation">,</span>trainY<span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>
    numSamples<span class="token operator">=</span>trainX<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>   <span class="token comment"># shape[0] 代表行，每一行一个图片，得到样本个数</span>
    <span class="token comment">#计算欧式距离</span>
    diff<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> n <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>numSamples<span class="token punctuation">)</span><span class="token punctuation">:</span>
        diff<span class="token punctuation">.</span>append<span class="token punctuation">(</span>testDigit<span class="token operator">-</span>trainX<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 每个个体差</span>
    diff<span class="token operator">=</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>diff<span class="token punctuation">)</span>             <span class="token comment"># 转变为ndarray</span>
    <span class="token comment"># 对差求平方和，然后取和的平方根</span>

    squaredDiff<span class="token operator">=</span>diff <span class="token operator">**</span> <span class="token number">2</span>
    squaredDist<span class="token operator">=</span>np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>squaredDiff<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    distance<span class="token operator">=</span>squaredDist<span class="token operator">**</span><span class="token number">0.5</span>
    <span class="token comment"># 2.按距离进行排序</span>
    sortedDistIndices<span class="token operator">=</span>np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>distance<span class="token punctuation">)</span>
    classCount<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>        <span class="token comment"># 存放各类的个体数量</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment">#3.按顺序读取标签</span>
        voteLabel<span class="token operator">=</span>trainY<span class="token punctuation">[</span>sortedDistIndices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span>
        <span class="token comment">#4.计算该标签次数</span>
        classCount<span class="token punctuation">[</span>voteLabel<span class="token punctuation">]</span><span class="token operator">=</span>classCount<span class="token punctuation">.</span>get<span class="token punctuation">(</span>voteLabel<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span>

    <span class="token comment"># 5.查找出现次数最多的类别，作为分类结果</span>
    maxCount<span class="token operator">=</span><span class="token number">0</span>
    <span class="token keyword">for</span> key<span class="token punctuation">,</span>value <span class="token keyword">in</span> classCount<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> value<span class="token operator">&gt;</span>maxCount<span class="token punctuation">:</span>
            maxCount<span class="token operator">=</span>value
            maxIndex<span class="token operator">=</span>key
    <span class="token keyword">return</span> maxIndex

train_x<span class="token punctuation">,</span>train_y<span class="token punctuation">,</span>test_x<span class="token punctuation">,</span>test_y<span class="token operator">=</span>loadDataSet<span class="token punctuation">(</span><span class="token punctuation">)</span>
numTestSamples<span class="token operator">=</span>test_x<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
matchCount<span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"3.Find the most frequent label int k-nearest..."</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"4.show the result..."</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>numTestSamples<span class="token punctuation">)</span><span class="token punctuation">:</span>
    predict<span class="token operator">=</span>myKNN<span class="token punctuation">(</span>test_x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>train_x<span class="token punctuation">,</span>train_y<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"result is: %d, real answer is: %d"</span><span class="token operator">%</span><span class="token punctuation">(</span>predict<span class="token punctuation">,</span>test_y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> predict <span class="token operator">==</span> test_y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>
        matchCount<span class="token operator">+=</span><span class="token number">1</span>
accuracy<span class="token operator">=</span><span class="token builtin">float</span><span class="token punctuation">(</span>matchCount<span class="token punctuation">)</span><span class="token operator">/</span>numTestSamples
<span class="token comment"># 5.输出结果</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"5. Show the accuracy..."</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"   The total number of errors is: %d"</span><span class="token operator">%</span><span class="token punctuation">(</span>numTestSamples<span class="token operator">-</span>matchCount<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"   The classsify accuracy is: %.2f%%"</span><span class="token operator">%</span><span class="token punctuation">(</span>accuracy<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre>
    <blockquote>
     <p>
      <a href="https://pan.baidu.com/s/1NnzgSg1vMQy-ZOKsrTShHw?pwd=dyck" rel="nofollow">
       数据集链接
      </a>
     </p>
    </blockquote>
    <p>
     应用3
    </p>
    <pre><code class="prism language-python"><span class="token comment"># 使用支持向量机SVM算法对随机数进行训练分类</span>
<span class="token keyword">from</span> sklearn <span class="token keyword">import</span> svm
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token comment">#随机生成两组数据，并通过（-2,2）距离调整为明显的0/1两类</span>
data <span class="token operator">=</span> np<span class="token punctuation">.</span>concatenate<span class="token punctuation">(</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
target<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">30</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">30</span>

<span class="token comment">#建立SVC模型</span>
clf<span class="token operator">=</span>svm<span class="token punctuation">.</span>SVC<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">'linear'</span><span class="token punctuation">)</span>
clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>data<span class="token punctuation">,</span>target<span class="token punctuation">)</span>

<span class="token comment">#显示结果</span>
w<span class="token operator">=</span>clf<span class="token punctuation">.</span>coef_<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
a<span class="token operator">=</span><span class="token operator">-</span>w<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">/</span>w<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'参数 w:'</span><span class="token punctuation">,</span>w<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"参数 a:"</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"支持向量机："</span><span class="token punctuation">,</span>clf<span class="token punctuation">.</span>support_vectors_<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"参数 coef_"</span><span class="token punctuation">,</span>clf<span class="token punctuation">.</span>coef_<span class="token punctuation">)</span>

<span class="token comment">#使用结果参数生成分类线</span>
xx<span class="token operator">=</span>np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
yy<span class="token operator">=</span>a<span class="token operator">*</span>xx<span class="token operator">-</span><span class="token punctuation">(</span>clf<span class="token punctuation">.</span>intercept_<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">/</span>w<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">#绘制穿过正支持向量的虚线</span>
b<span class="token operator">=</span>clf<span class="token punctuation">.</span>support_vectors_<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
yy_Neg<span class="token operator">=</span>a<span class="token operator">*</span>xx<span class="token operator">+</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">-</span>a<span class="token operator">*</span>b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">#绘制穿过负支持向量的虚线</span>
b<span class="token operator">=</span>clf<span class="token punctuation">.</span>support_vectors_<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
yy_Pos<span class="token operator">=</span>a<span class="token operator">*</span>xx<span class="token operator">+</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">-</span>a<span class="token operator">*</span>b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">#绘制黑色实线</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>xx<span class="token punctuation">,</span>yy<span class="token punctuation">,</span><span class="token string">'r-'</span><span class="token punctuation">)</span>
<span class="token comment">#黑色虚线</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>xx<span class="token punctuation">,</span>yy_Neg<span class="token punctuation">,</span><span class="token string">'k--'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>xx<span class="token punctuation">,</span>yy_Pos<span class="token punctuation">,</span><span class="token string">'k--'</span><span class="token punctuation">)</span>

<span class="token comment">#绘制样本散点图</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>clf<span class="token punctuation">.</span>support_vectors_<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>clf<span class="token punctuation">.</span>support_vectors_<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>c<span class="token operator">=</span>target<span class="token punctuation">,</span>cmap<span class="token operator">=</span>plt<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>coolwarm<span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"x"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"y"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Support Vector Classification"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/57247256589443919bf845b7c41d0892.png#pic_center" width="400"/>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f35323539333633332f:61727469636c652f64657461696c732f313436313331383338" class_="artid" style="display:none">
 </p>
</div>


