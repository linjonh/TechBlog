---
layout: post
title: "ä»Online-Softmaxåˆ°FlashAttention"
date: 2025-03-16 22:14:51 +0800
description: "ä»Online Softmaxåˆ°FlashAttention"
keywords: "ä»Online Softmaxåˆ°FlashAttention"
categories: ['Llm']
tags: ['Softmax', 'Softmax', 'Softmax', 'Safe', 'Online', 'Flashattention', 'Attention']
artid: "146215880"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146215880
    alt: "ä»Online-Softmaxåˆ°FlashAttention"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146215880
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146215880
cover: https://bing.ee123.net/img/rand?artid=146215880
image: https://bing.ee123.net/img/rand?artid=146215880
img: https://bing.ee123.net/img/rand?artid=146215880
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     ä»Online Softmaxåˆ°FlashAttention
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <h3>
     <a id="_2">
     </a>
     å‰è¨€
    </h3>
    <blockquote>
     <p>
      æœ€è¿‘åœ¨å­¦ä¹  FlashAttentionï¼Œçœ‹åˆ°ä¸€ä»½ä¸é”™çš„æ‰‹ç¨¿åˆ†äº«ä¸‹ğŸ¤—
     </p>
     <p>
      manuscriptï¼š
      <a href="https://courses.cs.washington.edu/courses/cse599m/23sp/notes/flashattn.pdf" rel="nofollow">
       From Online Softmax to FlashAttention
      </a>
     </p>
    </blockquote>
    <h3>
     <a id="0_Abstract_8">
     </a>
     0. Abstract
    </h3>
    <p>
     <a rel="nofollow">
      FlashAttention
     </a>
     çš„å…³é”®åˆ›æ–°æ˜¯ä½¿ç”¨ç±»ä¼¼äº
     <a rel="nofollow">
      Online Softmax
     </a>
     çš„æ€æƒ³æ¥ tile åˆ†å— self-attention çš„è®¡ç®—ï¼Œè¿™æ ·å¯ä»¥èåˆæ•´ä¸ªå¤šå¤´æ³¨æ„åŠ›å±‚ï¼Œè€Œæ— éœ€å¤šæ¬¡é‡å¤è®¿é—® GPU çš„å…¨å±€å†…å­˜æ¥è·å–ä¸´æ—¶å˜é‡å’Œæ³¨æ„åŠ›åˆ†æ•°çŸ©é˜µ
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        A 
        
       
      
        A
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal">
          A
         </span>
        </span>
       </span>
      </span>
     </span>
     ã€‚æœ¬æ–‡å°†ç®€è¦è§£é‡Šå¦‚ä½• tiling åˆ†å— self-attention çš„è®¡ç®—ï¼Œä»¥åŠå¦‚ä½•ä» online softmax ä¸­æ¨å¯¼å‡º FlashAttention è®¡ç®—
    </p>
    <h3>
     <a id="1_The_SelfAttention_12">
     </a>
     1. The Self-Attention
    </h3>
    <p>
     Self-Attention çš„è®¡ç®—å¯ä»¥æè¿°ä¸ºï¼š
    </p>
    <p>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         O 
             
            
              = 
             
             
             
               s 
              
             
               o 
              
             
               f 
              
             
               t 
              
             
               m 
              
             
               a 
              
             
               x 
              
             
             
             
               ( 
              
             
               Q 
              
              
              
                K 
               
              
                T 
               
              
             
               ) 
              
             
            
              V 
             
            
           
          
          
          
         
        
       
         \begin{equation} O = \mathrm{softmax}\left(QK^T\right)V \end{equation}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1.2513em; vertical-align: -0.3757em;">
          </span>
          <span class="mtable">
           <span class="col-align-c">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.8757em;">
               <span class="" style="top: -2.9843em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord mathnormal" style="margin-right: 0.0278em;">
                  O
                 </span>
                 <span class="mspace" style="margin-right: 0.2778em;">
                 </span>
                 <span class="mrel">
                  =
                 </span>
                 <span class="mspace" style="margin-right: 0.2778em;">
                 </span>
                 <span class="mord">
                  <span class="mord mathrm">
                   softmax
                  </span>
                 </span>
                 <span class="mspace" style="margin-right: 0.1667em;">
                 </span>
                 <span class="minner">
                  <span class="mopen delimcenter" style="top: 0em;">
                   <span class="delimsizing size1">
                    (
                   </span>
                  </span>
                  <span class="mord mathnormal">
                   Q
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal" style="margin-right: 0.0715em;">
                    K
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.8913em;">
                       <span class="" style="top: -3.113em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                          T
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mclose delimcenter" style="top: 0em;">
                   <span class="delimsizing size1">
                    )
                   </span>
                  </span>
                 </span>
                 <span class="mspace" style="margin-right: 0.1667em;">
                 </span>
                 <span class="mord mathnormal" style="margin-right: 0.2222em;">
                  V
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3757em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="tag">
          <span class="vlist-t vlist-t2">
           <span class="vlist-r">
            <span class="vlist" style="height: 0.8757em;">
             <span class="" style="top: -2.8757em;">
              <span class="pstrut" style="height: 2.8913em;">
              </span>
              <span class="eqn-num">
              </span>
             </span>
            </span>
            <span class="vlist-s">
             â€‹
            </span>
           </span>
           <span class="vlist-r">
            <span class="vlist" style="height: 0.3757em;">
             <span class="">
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     å…¶ä¸­
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        Q 
        
       
         , 
        
       
         K 
        
       
         , 
        
       
         V 
        
       
         , 
        
       
         O 
        
       
         âˆˆ 
        
        
        
          R 
         
         
         
           L 
          
         
           Ã— 
          
         
           D 
          
         
        
       
      
        Q,K,V,O \in \mathbb{R}^{L\times D}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          Q
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0715em;">
          K
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.2222em;">
          V
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          âˆˆ
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8413em;">
         </span>
         <span class="mord">
          <span class="mord mathbb">
           R
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8413em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  L
                 </span>
                 <span class="mbin mtight">
                  Ã—
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                  D
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ï¼Œ
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        L 
        
       
      
        L
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal">
          L
         </span>
        </span>
       </span>
      </span>
     </span>
     æ˜¯åºåˆ—é•¿åº¦ï¼Œ
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        D 
        
       
      
        D
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          D
         </span>
        </span>
       </span>
      </span>
     </span>
     æ˜¯æ¯ä¸ªå¤´çš„ç»´åº¦ï¼Œsoftmax å°†æŒ‰åˆ—åº”ç”¨äº
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        Q 
        
        
        
          K 
         
        
          T 
         
        
       
      
        QK^T
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.0358em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          Q
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0715em;">
           K
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8413em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                 T
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     <strong>
      Note
     </strong>
     ï¼šè¿™é‡Œæˆ‘ä»¬å¿½ç•¥äº†å¤šå¤´ã€å¤š batchï¼Œå› ä¸ºåœ¨è¿™äº›ç»´åº¦ä¸Šçš„è®¡ç®—æ˜¯å®Œå…¨å¹¶è¡Œçš„ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªå…³æ³¨å•å¤´ã€å• batch çš„è®¡ç®—å°±è¡Œã€‚å¦å¤–ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬ä¹Ÿå¿½ç•¥äº†æ³¨æ„åŠ›æ©ç ä»¥åŠç¼©æ”¾å› å­
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        1 
         
         
         
           D 
          
         
        
       
      
        \frac{1}{\sqrt{D}}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.3831em; vertical-align: -0.538em;">
         </span>
         <span class="mord">
          <span class="mopen nulldelimiter">
          </span>
          <span class="mfrac">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8451em;">
              <span class="" style="top: -2.5374em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord sqrt mtight">
                  <span class="vlist-t vlist-t2">
                   <span class="vlist-r">
                    <span class="vlist" style="height: 0.9323em;">
                     <span class="svg-align" style="top: -3em;">
                      <span class="pstrut" style="height: 3em;">
                      </span>
                      <span class="mord mtight" style="padding-left: 0.833em;">
                       <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                        D
                       </span>
                      </span>
                     </span>
                     <span class="" style="top: -2.8923em;">
                      <span class="pstrut" style="height: 3em;">
                      </span>
                      <span class="hide-tail mtight" style="min-width: 0.853em; height: 1.08em;">
                       <svg height="1.08em" preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 1080" width="400em">
                        <path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z">
                        </path>
                       </svg>
                      </span>
                     </span>
                    </span>
                    <span class="vlist-s">
                     â€‹
                    </span>
                   </span>
                   <span class="vlist-r">
                    <span class="vlist" style="height: 0.1077em;">
                     <span class="">
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.23em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="frac-line" style="border-bottom-width: 0.04em;">
               </span>
              </span>
              <span class="" style="top: -3.394em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.538em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose nulldelimiter">
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     è®¡ç®— self-attention çš„æ ‡å‡†æ–¹æ³•æ˜¯å°†å…¶åˆ†è§£ä¸ºä»¥ä¸‹å‡ ä¸ªé˜¶æ®µï¼š
    </p>
    <p>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         X 
            
           
          
          
           
            
             
            
              = 
             
            
              Q 
             
             
             
               K 
              
             
               T 
              
             
            
           
          
          
          
         
         
          
          
           
           
             A 
            
           
          
          
           
            
             
            
              = 
             
             
             
               s 
              
             
               o 
              
             
               f 
              
             
               t 
              
             
               m 
              
             
               a 
              
             
               x 
              
             
            
              ( 
             
            
              X 
             
            
              ) 
             
            
           
          
          
          
         
         
          
          
           
           
             O 
            
           
          
          
           
            
             
            
              = 
             
            
              A 
             
            
              V 
             
            
           
          
          
          
         
        
       
         \begin{align} X &amp; = QK^T \\ A &amp; = \mathrm{softmax}(X) \\ O &amp; = AV \end{align}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 4.5513em; vertical-align: -2.0257em;">
          </span>
          <span class="mtable">
           <span class="col-align-r">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 2.5257em;">
               <span class="" style="top: -4.6343em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord mathnormal" style="margin-right: 0.0785em;">
                  X
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.1343em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord mathnormal">
                  A
                 </span>
                </span>
               </span>
               <span class="" style="top: -1.6343em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord mathnormal" style="margin-right: 0.0278em;">
                  O
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 2.0257em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="col-align-l">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 2.5257em;">
               <span class="" style="top: -4.6343em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord">
                 </span>
                 <span class="mspace" style="margin-right: 0.2778em;">
                 </span>
                 <span class="mrel">
                  =
                 </span>
                 <span class="mspace" style="margin-right: 0.2778em;">
                 </span>
                 <span class="mord mathnormal">
                  Q
                 </span>
                 <span class="mord">
                  <span class="mord mathnormal" style="margin-right: 0.0715em;">
                   K
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.8913em;">
                      <span class="" style="top: -3.113em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                         T
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.1343em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord">
                 </span>
                 <span class="mspace" style="margin-right: 0.2778em;">
                 </span>
                 <span class="mrel">
                  =
                 </span>
                 <span class="mspace" style="margin-right: 0.2778em;">
                 </span>
                 <span class="mord">
                  <span class="mord mathrm">
                   softmax
                  </span>
                 </span>
                 <span class="mopen">
                  (
                 </span>
                 <span class="mord mathnormal" style="margin-right: 0.0785em;">
                  X
                 </span>
                 <span class="mclose">
                  )
                 </span>
                </span>
               </span>
               <span class="" style="top: -1.6343em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord">
                 </span>
                 <span class="mspace" style="margin-right: 0.2778em;">
                 </span>
                 <span class="mrel">
                  =
                 </span>
                 <span class="mspace" style="margin-right: 0.2778em;">
                 </span>
                 <span class="mord mathnormal">
                  A
                 </span>
                 <span class="mord mathnormal" style="margin-right: 0.2222em;">
                  V
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 2.0257em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="tag">
          <span class="vlist-t vlist-t2">
           <span class="vlist-r">
            <span class="vlist" style="height: 2.5257em;">
             <span class="" style="top: -4.5257em;">
              <span class="pstrut" style="height: 2.8913em;">
              </span>
              <span class="eqn-num">
              </span>
             </span>
             <span class="" style="top: -3.0257em;">
              <span class="pstrut" style="height: 2.8913em;">
              </span>
              <span class="eqn-num">
              </span>
             </span>
             <span class="" style="top: -1.5257em;">
              <span class="pstrut" style="height: 2.8913em;">
              </span>
              <span class="eqn-num">
              </span>
             </span>
            </span>
            <span class="vlist-s">
             â€‹
            </span>
           </span>
           <span class="vlist-r">
            <span class="vlist" style="height: 2.0257em;">
             <span class="">
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     æˆ‘ä»¬ç§°
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        X 
        
       
      
        X
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0785em;">
          X
         </span>
        </span>
       </span>
      </span>
     </span>
     çŸ©é˜µä¸º pre-softmax logitsï¼Œ
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        A 
        
       
      
        A
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal">
          A
         </span>
        </span>
       </span>
      </span>
     </span>
     çŸ©é˜µä¸ºæ³¨æ„åŠ›åˆ†æ•°ï¼ˆattention scoreï¼‰ï¼Œ
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
      
        O
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
        </span>
       </span>
      </span>
     </span>
     çŸ©é˜µä¸ºè¾“å‡º
    </p>
    <p>
     FlashAttention çš„ä¸€ä¸ªæƒŠäººä¹‹å¤„åœ¨äºï¼Œæˆ‘ä»¬ä¸éœ€è¦åœ¨å…¨å±€å†…å­˜ï¼ˆglobal memoryï¼‰ä¸Šå®ç°
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        X 
        
       
      
        X
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0785em;">
          X
         </span>
        </span>
       </span>
      </span>
     </span>
     å’Œ
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        A 
        
       
      
        A
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal">
          A
         </span>
        </span>
       </span>
      </span>
     </span>
     çŸ©é˜µï¼Œè€Œæ˜¯å°†å…¬å¼ (1) ä¸­çš„æ•´ä¸ªè®¡ç®—èåˆåˆ°å•ä¸ª CUDA kernel ä¸­ã€‚è¿™è¦æ±‚æˆ‘ä»¬è®¾è®¡ä¸€ç§èƒ½å¤Ÿç²¾å¿ƒç®¡ç†ç‰‡ä¸Šå†…å­˜ï¼ˆon-chip memoryï¼‰çš„ç®—æ³•ï¼Œå› ä¸º NVIDIA GPU çš„å…±äº«å†…å­˜ï¼ˆshared memoryï¼‰éå¸¸å°
    </p>
    <p>
     å¯¹äºçŸ©é˜µä¹˜æ³•ç­‰ç»å…¸ç®—æ³•ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šä½¿ç”¨ tiling æŠ€æœ¯æ¥ç¡®ä¿ç‰‡ä¸Šå†…å­˜ä¸è¶…è¿‡ç¡¬ä»¶é™åˆ¶ã€‚ä¸‹å›¾æä¾›äº†ä¸€ä¸ªä¾‹å­ï¼Œåœ¨ kernel æ‰§è¡ŒæœŸé—´ï¼Œæ— è®ºçŸ©é˜µå½¢çŠ¶å¦‚ä½•ï¼Œåªæœ‰
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        3 
        
        
        
          T 
         
        
          2 
         
        
       
      
        3T^2
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8141em;">
         </span>
         <span class="mord">
          3
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.1389em;">
           T
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8141em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 2
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ä¸ªå…ƒç´ å­˜å‚¨åœ¨ç‰‡ä¸Šã€‚è¿™ç§ tiling æ–¹æ³•ä¹‹æ‰€ä»¥æœ‰æ•ˆï¼Œæ˜¯å› ä¸ºåŠ æ³•æ˜¯å…³è”çš„ï¼Œå…è®¸å°†æ•´ä¸ªçŸ©é˜µä¹˜æ³•åˆ†è§£ä¸ºè®¸å¤š tile-wise çŸ©é˜µä¹˜æ³•çš„æ€»å’Œ
    </p>
    <p>
     ç„¶è€Œï¼ŒSelf-Attention åŒ…å«ä¸€ä¸ªä¸ç›´æ¥å…³è”çš„ softmax è¿ç®—ç¬¦ï¼Œå› æ­¤å¾ˆéš¾åƒä¸‹å›¾é‚£æ ·ç®€å•åœ°å¯¹ Self-Attention è¿›è¡Œ tileï¼Œé‚£æœ‰æ²¡æœ‰åŠæ³•è®© softmax å…·æœ‰å…³è”æ€§å‘¢ï¼ŸğŸ¤”
    </p>
    <p>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/158826e34d414323b046e9a21c2c339f.png#pic_center"/>
    </p>
    <p>
     ä¸Šå›¾ç®€è¦è¯´æ˜äº†å¦‚ä½•å¯¹çŸ©é˜µä¹˜æ³•
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        C 
        
       
         = 
        
       
         A 
        
       
         Ã— 
        
       
         B 
        
       
      
        C=A\times B
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0715em;">
          C
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;">
         </span>
         <span class="mord mathnormal">
          A
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          Ã—
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0502em;">
          B
         </span>
        </span>
       </span>
      </span>
     </span>
     çš„è¾“å…¥å’Œè¾“å‡ºçŸ©é˜µè¿›è¡Œ tileï¼ˆåˆ†å—ï¼‰ï¼ŒçŸ©é˜µè¢«åˆ’åˆ†ä¸º
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        T 
        
       
         Ã— 
        
       
         T 
        
       
      
        T\times T
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1389em;">
          T
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          Ã—
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1389em;">
          T
         </span>
        </span>
       </span>
      </span>
     </span>
     ä¸ªå°å—ã€‚å¯¹äºæ¯ä¸ªè¾“å‡ºå—ï¼Œæˆ‘ä»¬ä»å·¦åˆ°å³éå†
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        A 
        
       
      
        A
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal">
          A
         </span>
        </span>
       </span>
      </span>
     </span>
     ä¸­çš„ç›¸å…³å—ï¼Œä»ä¸Šåˆ°ä¸‹éå†
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        B 
        
       
      
        B
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0502em;">
          B
         </span>
        </span>
       </span>
      </span>
     </span>
     ä¸­çš„ç›¸å…³å—ï¼Œå¹¶å°†å®ƒä»¬çš„å€¼ä»å…¨å±€å†…å­˜ï¼ˆglobal memoryï¼‰åŠ è½½åˆ°ç‰‡ä¸Šå†…å­˜ï¼ˆon-chip memoryï¼‰ï¼ˆä»¥è“è‰²è¡¨ç¤ºï¼Œæ•´ä½“ç‰‡ä¸Šå†…å­˜å ç”¨ä¸º
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         ( 
        
        
        
          T 
         
        
          2 
         
        
       
         ) 
        
       
      
        O(T^2)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.0641em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.1389em;">
           T
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8141em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 2
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     ï¼‰
    </p>
    <p>
     æ¥ç€é€å—è¿›è¡ŒçŸ©é˜µä¹˜æ³•ï¼Œå¯¹äºä½ç½®
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        ( 
        
       
         i 
        
       
         , 
        
       
         j 
        
       
         ) 
        
       
      
        (i,j)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          i
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0572em;">
          j
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     ï¼Œæˆ‘ä»¬å…ˆä»ç‰‡ä¸Šå†…å­˜ä¸­åŠ è½½å—å†…æ‰€æœ‰
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        i 
        
       
      
        i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6595em;">
         </span>
         <span class="mord mathnormal">
          i
         </span>
        </span>
       </span>
      </span>
     </span>
     è¡Œçš„å…ƒç´ å³
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        A 
        
       
         [ 
        
       
         i 
        
       
         , 
        
       
         k 
        
       
         ] 
        
       
      
        A[i,k]
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal">
          A
         </span>
         <span class="mopen">
          [
         </span>
         <span class="mord mathnormal">
          i
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mclose">
          ]
         </span>
        </span>
       </span>
      </span>
     </span>
     ä»¥åŠæ‰€æœ‰
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        j 
        
       
      
        j
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.854em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0572em;">
          j
         </span>
        </span>
       </span>
      </span>
     </span>
     åˆ—çš„å…ƒç´ å³
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        B 
        
       
         [ 
        
       
         k 
        
       
         , 
        
       
         j 
        
       
         ] 
        
       
      
        B[k,j]
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0502em;">
          B
         </span>
         <span class="mopen">
          [
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0572em;">
          j
         </span>
         <span class="mclose">
          ]
         </span>
        </span>
       </span>
      </span>
     </span>
     ï¼ˆä»¥çº¢è‰²è¡¨ç¤ºï¼‰ï¼Œç„¶ååˆ©ç”¨
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        A 
        
       
         [ 
        
       
         i 
        
       
         , 
        
       
         k 
        
       
         ] 
        
       
      
        A[i,k]
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal">
          A
         </span>
         <span class="mopen">
          [
         </span>
         <span class="mord mathnormal">
          i
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mclose">
          ]
         </span>
        </span>
       </span>
      </span>
     </span>
     å’Œ
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        B 
        
       
         [ 
        
       
         k 
        
       
         , 
        
       
         j 
        
       
         ] 
        
       
      
        B[k,j]
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0502em;">
          B
         </span>
         <span class="mopen">
          [
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0572em;">
          j
         </span>
         <span class="mclose">
          ]
         </span>
        </span>
       </span>
      </span>
     </span>
     è®¡ç®—å¾—åˆ°ç‰‡ä¸Šå†…å­˜ä¸­çš„
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        C 
        
       
         [ 
        
       
         i 
        
       
         , 
        
       
         j 
        
       
         ] 
        
       
      
        C[i,j]
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0715em;">
          C
         </span>
         <span class="mopen">
          [
         </span>
         <span class="mord mathnormal">
          i
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0572em;">
          j
         </span>
         <span class="mclose">
          ]
         </span>
        </span>
       </span>
      </span>
     </span>
     ã€‚ä»¥æ­¤å¾ªç¯ï¼Œç›´åˆ°å®Œæˆä¸€ä¸ªå—çš„è®¡ç®—åï¼Œæˆ‘ä»¬å†å°†ç‰‡ä¸Š
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        C 
        
       
      
        C
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0715em;">
          C
         </span>
        </span>
       </span>
      </span>
     </span>
     å—çš„ç»“æœå†™å›ä¸»å†…å­˜å¹¶ç»§ç»­å¤„ç†ä¸‹ä¸€ä¸ªå—
    </p>
    <p>
     å®é™… tiling çš„åº”ç”¨è¦å¤æ‚å¾—å¤šï¼Œå¤§å®¶å¯ä»¥å‚è€ƒï¼š
     <a href="https://developer.download.nvidia.com/video/gputechconf/gtc/2020/presentations/s21745-developing-cuda-kernels-to-push-tensor-cores-to-the-absolute-limit-on-nvidia-a100.pdf" rel="nofollow">
      cutlass åœ¨ A100 ä¸Šå®ç°çŸ©é˜µä¹˜æ³•
     </a>
    </p>
    <h3>
     <a id="2_Safe_Softmax_53">
     </a>
     2. (Safe) Softmax
    </h3>
    <p>
     æˆ‘ä»¬å…ˆå›é¡¾ä¸€ä¸‹ softmax ç®—å­ï¼Œä¸‹é¢æ˜¯ softmax è®¡ç®—çš„é€šç”¨å…¬å¼ï¼š
    </p>
    <p>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         s 
              
             
               o 
              
             
               f 
              
             
               t 
              
             
               m 
              
             
               a 
              
             
               x 
              
             
            
              ( 
             
            
              { 
             
             
             
               x 
              
             
               1 
              
             
            
              , 
             
            
              â€¦ 
             
            
              , 
             
             
             
               x 
              
             
               N 
              
             
            
              } 
             
            
              ) 
             
            
              = 
             
             
              
              
                { 
               
               
                
                
                  e 
                 
                 
                 
                   x 
                  
                 
                   i 
                  
                 
                
                
                 
                 
                   âˆ‘ 
                  
                  
                  
                    j 
                   
                  
                    = 
                   
                  
                    1 
                   
                  
                 
                   N 
                  
                 
                 
                 
                   e 
                  
                  
                  
                    x 
                   
                  
                    j 
                   
                  
                 
                
               
              
                } 
               
              
              
              
                i 
               
              
                = 
               
              
                1 
               
              
             
               N 
              
             
            
           
          
          
          
         
        
       
         \begin{equation} \mathrm{softmax}(\{x_1,\ldots,x_N\})=\left\{\frac{e^{x_i}}{\sum_{j=1}^Ne^{x_j}}\right\}_{i=1}^N \end{equation}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 3.338em; vertical-align: -1.419em;">
          </span>
          <span class="mtable">
           <span class="col-align-c">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.919em;">
               <span class="" style="top: -3.919em;">
                <span class="pstrut" style="height: 3.9812em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  <span class="mord mathrm">
                   softmax
                  </span>
                 </span>
                 <span class="mopen">
                  ({
                  <!-- -->
                 </span>
                 <span class="mord">
                  <span class="mord mathnormal">
                   x
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3011em;">
                      <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mtight">
                         1
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.15em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mpunct">
                  ,
                 </span>
                 <span class="mspace" style="margin-right: 0.1667em;">
                 </span>
                 <span class="minner">
                  â€¦
                 </span>
                 <span class="mspace" style="margin-right: 0.1667em;">
                 </span>
                 <span class="mpunct">
                  ,
                 </span>
                 <span class="mspace" style="margin-right: 0.1667em;">
                 </span>
                 <span class="mord">
                  <span class="mord mathnormal">
                   x
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3283em;">
                      <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                         N
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.15em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mclose">
                  })
                 </span>
                 <span class="mspace" style="margin-right: 0.2778em;">
                 </span>
                 <span class="mrel">
                  =
                 </span>
                 <span class="mspace" style="margin-right: 0.2778em;">
                 </span>
                 <span class="minner">
                  <span class="minner">
                   <span class="mopen delimcenter" style="top: 0em;">
                    <span class="delimsizing size4">
                     {
                     <!-- -->
                    </span>
                   </span>
                   <span class="mord">
                    <span class="mopen nulldelimiter">
                    </span>
                    <span class="mfrac">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 1.3414em;">
                        <span class="" style="top: -2.1288em;">
                         <span class="pstrut" style="height: 3em;">
                         </span>
                         <span class="mord">
                          <span class="mop">
                           <span class="mop op-symbol small-op" style="position: relative; top: 0em;">
                            âˆ‘
                           </span>
                           <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.9812em;">
                               <span class="" style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;">
                                <span class="pstrut" style="height: 2.7em;">
                                </span>
                                <span class="sizing reset-size6 size3 mtight">
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                                   j
                                  </span>
                                  <span class="mrel mtight">
                                   =
                                  </span>
                                  <span class="mord mtight">
                                   1
                                  </span>
                                 </span>
                                </span>
                               </span>
                               <span class="" style="top: -3.2029em; margin-right: 0.05em;">
                                <span class="pstrut" style="height: 2.7em;">
                                </span>
                                <span class="sizing reset-size6 size3 mtight">
                                 <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                                  N
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               â€‹
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.4358em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="mspace" style="margin-right: 0.1667em;">
                          </span>
                          <span class="mord">
                           <span class="mord mathnormal">
                            e
                           </span>
                           <span class="msupsub">
                            <span class="vlist-t">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.6065em;">
                               <span class="" style="top: -3.0051em; margin-right: 0.05em;">
                                <span class="pstrut" style="height: 2.7em;">
                                </span>
                                <span class="sizing reset-size6 size3 mtight">
                                 <span class="mord mtight">
                                  <span class="mord mtight">
                                   <span class="mord mathnormal mtight">
                                    x
                                   </span>
                                   <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                     <span class="vlist-r">
                                      <span class="vlist" style="height: 0.3281em;">
                                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                        <span class="pstrut" style="height: 2.5em;">
                                        </span>
                                        <span class="sizing reset-size3 size1 mtight">
                                         <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                                          j
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                      <span class="vlist-s">
                                       â€‹
                                      </span>
                                     </span>
                                     <span class="vlist-r">
                                      <span class="vlist" style="height: 0.2819em;">
                                       <span class="">
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                        <span class="" style="top: -3.23em;">
                         <span class="pstrut" style="height: 3em;">
                         </span>
                         <span class="frac-line" style="border-bottom-width: 0.04em;">
                         </span>
                        </span>
                        <span class="" style="top: -3.677em;">
                         <span class="pstrut" style="height: 3em;">
                         </span>
                         <span class="mord">
                          <span class="mord">
                           <span class="mord mathnormal">
                            e
                           </span>
                           <span class="msupsub">
                            <span class="vlist-t">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.6644em;">
                               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                                <span class="pstrut" style="height: 2.7em;">
                                </span>
                                <span class="sizing reset-size6 size3 mtight">
                                 <span class="mord mtight">
                                  <span class="mord mtight">
                                   <span class="mord mathnormal mtight">
                                    x
                                   </span>
                                   <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                     <span class="vlist-r">
                                      <span class="vlist" style="height: 0.3281em;">
                                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                        <span class="pstrut" style="height: 2.5em;">
                                        </span>
                                        <span class="sizing reset-size3 size1 mtight">
                                         <span class="mord mathnormal mtight">
                                          i
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                      <span class="vlist-s">
                                       â€‹
                                      </span>
                                     </span>
                                     <span class="vlist-r">
                                      <span class="vlist" style="height: 0.143em;">
                                       <span class="">
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        â€‹
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 1.307em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                    <span class="mclose nulldelimiter">
                    </span>
                   </span>
                   <span class="mclose delimcenter" style="top: 0em;">
                    <span class="delimsizing size4">
                     }
                    </span>
                   </span>
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 1.9812em;">
                      <span class="" style="top: -1.3433em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mtight">
                         <span class="mord mathnormal mtight">
                          i
                         </span>
                         <span class="mrel mtight">
                          =
                         </span>
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="" style="top: -4.2029em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                         N
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 1.3567em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 1.419em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="tag">
          <span class="vlist-t vlist-t2">
           <span class="vlist-r">
            <span class="vlist" style="height: 1.919em;">
             <span class="" style="top: -3.919em;">
              <span class="pstrut" style="height: 3.9812em;">
              </span>
              <span class="eqn-num">
              </span>
             </span>
            </span>
            <span class="vlist-s">
             â€‹
            </span>
           </span>
           <span class="vlist-r">
            <span class="vlist" style="height: 1.419em;">
             <span class="">
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå½“
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        x 
         
        
          i 
         
        
       
      
        x_i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           x
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     æ¯”è¾ƒå¤§æ—¶
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        e 
         
         
         
           x 
          
         
           i 
          
         
        
       
      
        e^{x_i}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6644em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           e
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.6644em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   x
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3281em;">
                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mathnormal mtight">
                         i
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.143em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     å¾ˆå®¹æ˜“æº¢å‡ºï¼Œä¾‹å¦‚ float16 å¯ä»¥æ”¯æŒçš„æœ€å¤§å€¼æ˜¯ 65536ï¼Œè¿™æ„å‘³ç€å½“
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        x 
        
       
         â©¾ 
        
       
         11 
        
       
      
        x \geqslant 11
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7733em; vertical-align: -0.1367em;">
         </span>
         <span class="mord mathnormal">
          x
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel amsrm">
          â©¾
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          11
         </span>
        </span>
       </span>
      </span>
     </span>
     æ—¶ï¼Œ
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        e 
         
        
          x 
         
        
       
      
        e^x
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6644em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           e
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.6644em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 x
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     å°†è¶…è¿‡ float16 çš„æœ‰æ•ˆèŒƒå›´
    </p>
    <p>
     ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåƒ pytorchã€tensorflow ç­‰æ¡†æ¶é€šå¸¸ä¼šä½¿ç”¨ä¸€ç§è¢«ç§°ä¸º â€œsafeâ€ çš„ softmax è®¡ç®—æ–¹æ³•ï¼š
    </p>
    <p>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         e 
               
               
               
                 x 
                
               
                 i 
                
               
              
              
               
               
                 âˆ‘ 
                
                
                
                  j 
                 
                
                  = 
                 
                
                  1 
                 
                
               
                 N 
                
               
               
               
                 e 
                
                
                
                  x 
                 
                
                  j 
                 
                
               
              
             
            
              = 
             
             
              
              
                e 
               
               
                
                
                  x 
                 
                
                  i 
                 
                
               
                 âˆ’ 
                
               
                 m 
                
               
              
              
               
               
                 âˆ‘ 
                
                
                
                  j 
                 
                
                  = 
                 
                
                  1 
                 
                
               
                 N 
                
               
               
               
                 e 
                
                
                 
                 
                   x 
                  
                 
                   j 
                  
                 
                
                  âˆ’ 
                 
                
                  m 
                 
                
               
              
             
            
           
          
          
          
         
        
       
         \begin{equation} \frac{e^{x_{i}}}{\sum_{j=1}^{N}e^{x_{j}}}=\frac{e^{x_{i}-m}}{\sum_{j=1}^{N}e^{x_{j}-m}} \end{equation}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 2.7554em; vertical-align: -1.1277em;">
          </span>
          <span class="mtable">
           <span class="col-align-c">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.6277em;">
               <span class="" style="top: -3.6277em;">
                <span class="pstrut" style="height: 3.4483em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  <span class="mopen nulldelimiter">
                  </span>
                  <span class="mfrac">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 1.3414em;">
                      <span class="" style="top: -2.1288em;">
                       <span class="pstrut" style="height: 3em;">
                       </span>
                       <span class="mord">
                        <span class="mop">
                         <span class="mop op-symbol small-op" style="position: relative; top: 0em;">
                          âˆ‘
                         </span>
                         <span class="msupsub">
                          <span class="vlist-t vlist-t2">
                           <span class="vlist-r">
                            <span class="vlist" style="height: 0.9812em;">
                             <span class="" style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;">
                              <span class="pstrut" style="height: 2.7em;">
                              </span>
                              <span class="sizing reset-size6 size3 mtight">
                               <span class="mord mtight">
                                <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                                 j
                                </span>
                                <span class="mrel mtight">
                                 =
                                </span>
                                <span class="mord mtight">
                                 1
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="" style="top: -3.2029em; margin-right: 0.05em;">
                              <span class="pstrut" style="height: 2.7em;">
                              </span>
                              <span class="sizing reset-size6 size3 mtight">
                               <span class="mord mtight">
                                <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                                 N
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                            <span class="vlist-s">
                             â€‹
                            </span>
                           </span>
                           <span class="vlist-r">
                            <span class="vlist" style="height: 0.4358em;">
                             <span class="">
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                        <span class="mspace" style="margin-right: 0.1667em;">
                        </span>
                        <span class="mord">
                         <span class="mord mathnormal">
                          e
                         </span>
                         <span class="msupsub">
                          <span class="vlist-t">
                           <span class="vlist-r">
                            <span class="vlist" style="height: 0.6065em;">
                             <span class="" style="top: -3.0051em; margin-right: 0.05em;">
                              <span class="pstrut" style="height: 2.7em;">
                              </span>
                              <span class="sizing reset-size6 size3 mtight">
                               <span class="mord mtight">
                                <span class="mord mtight">
                                 <span class="mord mathnormal mtight">
                                  x
                                 </span>
                                 <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.3281em;">
                                     <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                      <span class="pstrut" style="height: 2.5em;">
                                      </span>
                                      <span class="sizing reset-size3 size1 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                                         j
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                    <span class="vlist-s">
                                     â€‹
                                    </span>
                                   </span>
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.2819em;">
                                     <span class="">
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="" style="top: -3.23em;">
                       <span class="pstrut" style="height: 3em;">
                       </span>
                       <span class="frac-line" style="border-bottom-width: 0.04em;">
                       </span>
                      </span>
                      <span class="" style="top: -3.677em;">
                       <span class="pstrut" style="height: 3em;">
                       </span>
                       <span class="mord">
                        <span class="mord">
                         <span class="mord mathnormal">
                          e
                         </span>
                         <span class="msupsub">
                          <span class="vlist-t">
                           <span class="vlist-r">
                            <span class="vlist" style="height: 0.6644em;">
                             <span class="" style="top: -3.063em; margin-right: 0.05em;">
                              <span class="pstrut" style="height: 2.7em;">
                              </span>
                              <span class="sizing reset-size6 size3 mtight">
                               <span class="mord mtight">
                                <span class="mord mtight">
                                 <span class="mord mathnormal mtight">
                                  x
                                 </span>
                                 <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.3281em;">
                                     <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                      <span class="pstrut" style="height: 2.5em;">
                                      </span>
                                      <span class="sizing reset-size3 size1 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mathnormal mtight">
                                         i
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                    <span class="vlist-s">
                                     â€‹
                                    </span>
                                   </span>
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.143em;">
                                     <span class="">
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 1.307em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mclose nulldelimiter">
                  </span>
                 </span>
                 <span class="mspace" style="margin-right: 0.2778em;">
                 </span>
                 <span class="mrel">
                  =
                 </span>
                 <span class="mspace" style="margin-right: 0.2778em;">
                 </span>
                 <span class="mord">
                  <span class="mopen nulldelimiter">
                  </span>
                  <span class="mfrac">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 1.4483em;">
                      <span class="" style="top: -2.1288em;">
                       <span class="pstrut" style="height: 3em;">
                       </span>
                       <span class="mord">
                        <span class="mop">
                         <span class="mop op-symbol small-op" style="position: relative; top: 0em;">
                          âˆ‘
                         </span>
                         <span class="msupsub">
                          <span class="vlist-t vlist-t2">
                           <span class="vlist-r">
                            <span class="vlist" style="height: 0.9812em;">
                             <span class="" style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;">
                              <span class="pstrut" style="height: 2.7em;">
                              </span>
                              <span class="sizing reset-size6 size3 mtight">
                               <span class="mord mtight">
                                <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                                 j
                                </span>
                                <span class="mrel mtight">
                                 =
                                </span>
                                <span class="mord mtight">
                                 1
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="" style="top: -3.2029em; margin-right: 0.05em;">
                              <span class="pstrut" style="height: 2.7em;">
                              </span>
                              <span class="sizing reset-size6 size3 mtight">
                               <span class="mord mtight">
                                <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                                 N
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                            <span class="vlist-s">
                             â€‹
                            </span>
                           </span>
                           <span class="vlist-r">
                            <span class="vlist" style="height: 0.4358em;">
                             <span class="">
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                        <span class="mspace" style="margin-right: 0.1667em;">
                        </span>
                        <span class="mord">
                         <span class="mord mathnormal">
                          e
                         </span>
                         <span class="msupsub">
                          <span class="vlist-t">
                           <span class="vlist-r">
                            <span class="vlist" style="height: 0.7134em;">
                             <span class="" style="top: -3.0051em; margin-right: 0.05em;">
                              <span class="pstrut" style="height: 2.7em;">
                              </span>
                              <span class="sizing reset-size6 size3 mtight">
                               <span class="mord mtight">
                                <span class="mord mtight">
                                 <span class="mord mathnormal mtight">
                                  x
                                 </span>
                                 <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.3281em;">
                                     <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                      <span class="pstrut" style="height: 2.5em;">
                                      </span>
                                      <span class="sizing reset-size3 size1 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                                         j
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                    <span class="vlist-s">
                                     â€‹
                                    </span>
                                   </span>
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.2819em;">
                                     <span class="">
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                                <span class="mbin mtight">
                                 âˆ’
                                </span>
                                <span class="mord mathnormal mtight">
                                 m
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="" style="top: -3.23em;">
                       <span class="pstrut" style="height: 3em;">
                       </span>
                       <span class="frac-line" style="border-bottom-width: 0.04em;">
                       </span>
                      </span>
                      <span class="" style="top: -3.677em;">
                       <span class="pstrut" style="height: 3em;">
                       </span>
                       <span class="mord">
                        <span class="mord">
                         <span class="mord mathnormal">
                          e
                         </span>
                         <span class="msupsub">
                          <span class="vlist-t">
                           <span class="vlist-r">
                            <span class="vlist" style="height: 0.7713em;">
                             <span class="" style="top: -3.063em; margin-right: 0.05em;">
                              <span class="pstrut" style="height: 2.7em;">
                              </span>
                              <span class="sizing reset-size6 size3 mtight">
                               <span class="mord mtight">
                                <span class="mord mtight">
                                 <span class="mord mathnormal mtight">
                                  x
                                 </span>
                                 <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.3281em;">
                                     <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                      <span class="pstrut" style="height: 2.5em;">
                                      </span>
                                      <span class="sizing reset-size3 size1 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mathnormal mtight">
                                         i
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                    <span class="vlist-s">
                                     â€‹
                                    </span>
                                   </span>
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.143em;">
                                     <span class="">
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                                <span class="mbin mtight">
                                 âˆ’
                                </span>
                                <span class="mord mathnormal mtight">
                                 m
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 1.307em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mclose nulldelimiter">
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 1.1277em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="tag">
          <span class="vlist-t vlist-t2">
           <span class="vlist-r">
            <span class="vlist" style="height: 1.6277em;">
             <span class="" style="top: -3.6277em;">
              <span class="pstrut" style="height: 3.4483em;">
              </span>
              <span class="eqn-num">
              </span>
             </span>
            </span>
            <span class="vlist-s">
             â€‹
            </span>
           </span>
           <span class="vlist-r">
            <span class="vlist" style="height: 1.1277em;">
             <span class="">
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     å…¶ä¸­
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        m 
        
       
         = 
        
        
         
         
           max 
          
         
           â¡ 
          
         
         
         
           j 
          
         
           = 
          
         
           1 
          
         
        
          N 
         
        
       
         ( 
        
        
        
          x 
         
        
          j 
         
        
       
         ) 
        
       
      
        m=\max_{j=1}^{N}(x_j)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          m
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.2361em; vertical-align: -0.3948em;">
         </span>
         <span class="mop">
          <span class="mop">
           max
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8413em;">
              <span class="" style="top: -2.4413em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                 <span class="mrel mtight">
                  =
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                  N
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3948em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           x
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                 j
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     æˆ‘ä»¬å°†
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        x 
         
        
          i 
         
        
       
      
        x_i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           x
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     å‡å»å®ƒä»¬ä¸­çš„æœ€å¤§å€¼ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿æ¯ä¸ªå…ƒç´ 
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        x 
         
        
          i 
         
        
       
         âˆ’ 
        
       
         m 
        
       
         â©½ 
        
       
         0 
        
       
      
        x_i-m \leqslant 0
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7333em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           x
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          âˆ’
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7733em; vertical-align: -0.1367em;">
         </span>
         <span class="mord mathnormal">
          m
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel amsrm">
          â©½
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          0
         </span>
        </span>
       </span>
      </span>
     </span>
     ï¼Œä»è€Œå†åšæŒ‡æ•°è¿ç®—æ—¶å¯ä»¥ç¡®ä¿å…¶å€¼ä¸ä¼šæº¢å‡º
    </p>
    <p>
     æˆ‘ä»¬å¯ä»¥å°† safe softmax çš„è®¡ç®—æ€»ç»“ä¸ºä¸‹é¢çš„ 3-pass ç®—æ³•ï¼š
    </p>
    <p>
     <strong>
      Algorithm 3-pass safe softmax
     </strong>
    </p>
    <p>
     NOTATIONS
    </p>
    <ul>
     <li>
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         { 
         
         
         
           m 
          
         
           i 
          
         
        
          } 
         
        
       
         \{m_i\}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mopen">
           {
           <!-- -->
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            m
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose">
           }
          </span>
         </span>
        </span>
       </span>
      </span>
      ï¼š
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         max 
           
          
            â¡ 
           
          
          
          
            j 
           
          
            = 
           
          
            1 
           
          
         
           i 
          
         
        
          { 
         
         
         
           x 
          
         
           j 
          
         
        
          } 
         
        
       
         \max_{j=1}^i\{x_j\}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1.2194em; vertical-align: -0.3948em;">
          </span>
          <span class="mop">
           <span class="mop">
            max
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.8247em;">
               <span class="" style="top: -2.4413em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                   j
                  </span>
                  <span class="mrel mtight">
                   =
                  </span>
                  <span class="mord mtight">
                   1
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3948em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mopen">
           {
           <!-- -->
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            x
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose">
           }
          </span>
         </span>
        </span>
       </span>
      </span>
      ï¼Œåˆå§‹å€¼
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         m 
          
         
           0 
          
         
        
          = 
         
        
          âˆ’ 
         
        
          âˆ 
         
        
       
         m_0=-\infty
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            m
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3011em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  0
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;">
          </span>
          <span class="mord">
           âˆ’
          </span>
          <span class="mord">
           âˆ
          </span>
         </span>
        </span>
       </span>
      </span>
     </li>
     <li>
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         { 
         
         
         
           d 
          
         
           i 
          
         
        
          } 
         
        
       
         \{d_i\}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mopen">
           {
           <!-- -->
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            d
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose">
           }
          </span>
         </span>
        </span>
       </span>
      </span>
      ï¼š
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         âˆ‘ 
          
          
          
            j 
           
          
            = 
           
          
            1 
           
          
         
           i 
          
         
         
         
           e 
          
          
           
           
             x 
            
           
             j 
            
           
          
            âˆ’ 
           
           
           
             m 
            
           
             N 
            
           
          
         
        
       
         \sum_{j=1}^{i}e^{x_{j}-m_{N}}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1.4004em; vertical-align: -0.4358em;">
          </span>
          <span class="mop">
           <span class="mop op-symbol small-op" style="position: relative; top: 0em;">
            âˆ‘
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.9646em;">
               <span class="" style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                   j
                  </span>
                  <span class="mrel mtight">
                   =
                  </span>
                  <span class="mord mtight">
                   1
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.2029em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   i
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.4358em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            e
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.7713em;">
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    x
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3281em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                           j
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.2819em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mbin mtight">
                   âˆ’
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    m
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3448em;">
                       <span class="" style="top: -2.3567em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                           N
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.1433em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ï¼Œåˆå§‹å€¼
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         d 
          
         
           0 
          
         
        
          = 
         
        
          0 
         
        
       
         d_0=0
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.8444em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            d
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3011em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  0
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.6444em;">
          </span>
          <span class="mord">
           0
          </span>
         </span>
        </span>
       </span>
      </span>
      ï¼Œ
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         d 
          
         
           N 
          
         
        
       
         d_N
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.8444em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            d
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3283em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                  N
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      æ˜¯ safe softmax çš„åˆ†æ¯
     </li>
     <li>
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         { 
         
         
         
           a 
          
         
           i 
          
         
        
          } 
         
        
       
         \{a_i\}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mopen">
           {
           <!-- -->
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            a
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose">
           }
          </span>
         </span>
        </span>
       </span>
      </span>
      ï¼šæœ€ç»ˆçš„ softmax å€¼
     </li>
    </ul>
    <p>
     BODY
    </p>
    <p>
     <strong>
      for
     </strong>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        i 
        
       
         â† 
        
       
         1 
        
       
         , 
        
       
         N 
        
       
      
        i\leftarrow1,N
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6595em;">
         </span>
         <span class="mord mathnormal">
          i
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          â†
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.109em;">
          N
         </span>
        </span>
       </span>
      </span>
     </span>
     <strong>
      do
     </strong>
    </p>
    <p>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         m 
              
             
               i 
              
             
            
              â† 
             
            
              max 
             
            
              â¡ 
             
            
              ( 
             
             
             
               m 
              
              
              
                i 
               
              
                âˆ’ 
               
              
                1 
               
              
             
            
              , 
             
             
             
               x 
              
             
               i 
              
             
            
              ) 
             
            
           
          
          
          
         
        
       
         \begin{equation} m_i \leftarrow \max (m_{i-1},x_i) \end{equation}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1.2em; vertical-align: -0.35em;">
          </span>
          <span class="mtable">
           <span class="col-align-c">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.85em;">
               <span class="" style="top: -3.01em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  <span class="mord mathnormal">
                   m
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3117em;">
                      <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mathnormal mtight">
                         i
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.15em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mspace" style="margin-right: 0.2778em;">
                 </span>
                 <span class="mrel">
                  â†
                 </span>
                 <span class="mspace" style="margin-right: 0.2778em;">
                 </span>
                 <span class="mop">
                  max
                 </span>
                 <span class="mopen">
                  (
                 </span>
                 <span class="mord">
                  <span class="mord mathnormal">
                   m
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3117em;">
                      <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mtight">
                         <span class="mord mathnormal mtight">
                          i
                         </span>
                         <span class="mbin mtight">
                          âˆ’
                         </span>
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.2083em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mpunct">
                  ,
                 </span>
                 <span class="mspace" style="margin-right: 0.1667em;">
                 </span>
                 <span class="mord">
                  <span class="mord mathnormal">
                   x
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3117em;">
                      <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mathnormal mtight">
                         i
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.15em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mclose">
                  )
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.35em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="tag">
          <span class="vlist-t vlist-t2">
           <span class="vlist-r">
            <span class="vlist" style="height: 0.85em;">
             <span class="" style="top: -2.85em;">
              <span class="pstrut" style="height: 2.84em;">
              </span>
              <span class="eqn-num">
              </span>
             </span>
            </span>
            <span class="vlist-s">
             â€‹
            </span>
           </span>
           <span class="vlist-r">
            <span class="vlist" style="height: 0.35em;">
             <span class="">
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     <strong>
      end
     </strong>
    </p>
    <p>
     <strong>
      for
     </strong>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        i 
        
       
         â† 
        
       
         1 
        
       
         , 
        
       
         N 
        
       
      
        i\leftarrow1,N
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6595em;">
         </span>
         <span class="mord mathnormal">
          i
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          â†
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.109em;">
          N
         </span>
        </span>
       </span>
      </span>
     </span>
     <strong>
      do
     </strong>
    </p>
    <p>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         d 
              
             
               i 
              
             
            
              â† 
             
             
             
               d 
              
              
              
                i 
               
              
                âˆ’ 
               
              
                1 
               
              
             
            
              + 
             
             
             
               e 
              
              
               
               
                 x 
                
               
                 i 
                
               
              
                âˆ’ 
               
               
               
                 m 
                
               
                 N 
                
               
              
             
            
           
          
          
          
         
        
       
         \begin{equation} d_i \leftarrow d_{i-1} + e^{x_i-m_N} \end{equation}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1.2em; vertical-align: -0.35em;">
          </span>
          <span class="mtable">
           <span class="col-align-c">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.85em;">
               <span class="" style="top: -3.01em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  <span class="mord mathnormal">
                   d
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3117em;">
                      <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mathnormal mtight">
                         i
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.15em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mspace" style="margin-right: 0.2778em;">
                 </span>
                 <span class="mrel">
                  â†
                 </span>
                 <span class="mspace" style="margin-right: 0.2778em;">
                 </span>
                 <span class="mord">
                  <span class="mord mathnormal">
                   d
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3117em;">
                      <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mtight">
                         <span class="mord mathnormal mtight">
                          i
                         </span>
                         <span class="mbin mtight">
                          âˆ’
                         </span>
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.2083em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mspace" style="margin-right: 0.2222em;">
                 </span>
                 <span class="mbin">
                  +
                 </span>
                 <span class="mspace" style="margin-right: 0.2222em;">
                 </span>
                 <span class="mord">
                  <span class="mord mathnormal">
                   e
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.8213em;">
                      <span class="" style="top: -3.113em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight">
                           x
                          </span>
                          <span class="msupsub">
                           <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.3281em;">
                              <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                               <span class="pstrut" style="height: 2.5em;">
                               </span>
                               <span class="sizing reset-size3 size1 mtight">
                                <span class="mord mathnormal mtight">
                                 i
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="vlist-s">
                              â€‹
                             </span>
                            </span>
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.143em;">
                              <span class="">
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                         <span class="mbin mtight">
                          âˆ’
                         </span>
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight">
                           m
                          </span>
                          <span class="msupsub">
                           <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.3448em;">
                              <span class="" style="top: -2.3567em; margin-left: 0em; margin-right: 0.0714em;">
                               <span class="pstrut" style="height: 2.5em;">
                               </span>
                               <span class="sizing reset-size3 size1 mtight">
                                <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                                 N
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="vlist-s">
                              â€‹
                             </span>
                            </span>
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.1433em;">
                              <span class="">
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.35em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="tag">
          <span class="vlist-t vlist-t2">
           <span class="vlist-r">
            <span class="vlist" style="height: 0.85em;">
             <span class="" style="top: -2.85em;">
              <span class="pstrut" style="height: 2.84em;">
              </span>
              <span class="eqn-num">
              </span>
             </span>
            </span>
            <span class="vlist-s">
             â€‹
            </span>
           </span>
           <span class="vlist-r">
            <span class="vlist" style="height: 0.35em;">
             <span class="">
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     <strong>
      end
     </strong>
    </p>
    <p>
     <strong>
      for
     </strong>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        i 
        
       
         â† 
        
       
         1 
        
       
         , 
        
       
         N 
        
       
      
        i\leftarrow1,N
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6595em;">
         </span>
         <span class="mord mathnormal">
          i
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          â†
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.109em;">
          N
         </span>
        </span>
       </span>
      </span>
     </span>
     <strong>
      do
     </strong>
    </p>
    <p>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         a 
              
             
               i 
              
             
            
              â† 
             
             
              
              
                e 
               
               
                
                
                  x 
                 
                
                  i 
                 
                
               
                 âˆ’ 
                
                
                
                  m 
                 
                
                  N 
                 
                
               
              
              
              
                d 
               
              
                N 
               
              
             
            
           
          
          
          
         
        
       
         \begin{equation} a_i \leftarrow \frac{e^{x_i-m_N}}{d_N} \end{equation}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 2.2843em; vertical-align: -0.8922em;">
          </span>
          <span class="mtable">
           <span class="col-align-c">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.3922em;">
               <span class="" style="top: -3.3922em;">
                <span class="pstrut" style="height: 3.4483em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  <span class="mord mathnormal">
                   a
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3117em;">
                      <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mathnormal mtight">
                         i
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.15em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mspace" style="margin-right: 0.2778em;">
                 </span>
                 <span class="mrel">
                  â†
                 </span>
                 <span class="mspace" style="margin-right: 0.2778em;">
                 </span>
                 <span class="mord">
                  <span class="mopen nulldelimiter">
                  </span>
                  <span class="mfrac">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 1.4483em;">
                      <span class="" style="top: -2.314em;">
                       <span class="pstrut" style="height: 3em;">
                       </span>
                       <span class="mord">
                        <span class="mord">
                         <span class="mord mathnormal">
                          d
                         </span>
                         <span class="msupsub">
                          <span class="vlist-t vlist-t2">
                           <span class="vlist-r">
                            <span class="vlist" style="height: 0.3283em;">
                             <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                              <span class="pstrut" style="height: 2.7em;">
                              </span>
                              <span class="sizing reset-size6 size3 mtight">
                               <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                                N
                               </span>
                              </span>
                             </span>
                            </span>
                            <span class="vlist-s">
                             â€‹
                            </span>
                           </span>
                           <span class="vlist-r">
                            <span class="vlist" style="height: 0.15em;">
                             <span class="">
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="" style="top: -3.23em;">
                       <span class="pstrut" style="height: 3em;">
                       </span>
                       <span class="frac-line" style="border-bottom-width: 0.04em;">
                       </span>
                      </span>
                      <span class="" style="top: -3.677em;">
                       <span class="pstrut" style="height: 3em;">
                       </span>
                       <span class="mord">
                        <span class="mord">
                         <span class="mord mathnormal">
                          e
                         </span>
                         <span class="msupsub">
                          <span class="vlist-t">
                           <span class="vlist-r">
                            <span class="vlist" style="height: 0.7713em;">
                             <span class="" style="top: -3.063em; margin-right: 0.05em;">
                              <span class="pstrut" style="height: 2.7em;">
                              </span>
                              <span class="sizing reset-size6 size3 mtight">
                               <span class="mord mtight">
                                <span class="mord mtight">
                                 <span class="mord mathnormal mtight">
                                  x
                                 </span>
                                 <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.3281em;">
                                     <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                      <span class="pstrut" style="height: 2.5em;">
                                      </span>
                                      <span class="sizing reset-size3 size1 mtight">
                                       <span class="mord mathnormal mtight">
                                        i
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                    <span class="vlist-s">
                                     â€‹
                                    </span>
                                   </span>
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.143em;">
                                     <span class="">
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                                <span class="mbin mtight">
                                 âˆ’
                                </span>
                                <span class="mord mtight">
                                 <span class="mord mathnormal mtight">
                                  m
                                 </span>
                                 <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.3448em;">
                                     <span class="" style="top: -2.3567em; margin-left: 0em; margin-right: 0.0714em;">
                                      <span class="pstrut" style="height: 2.5em;">
                                      </span>
                                      <span class="sizing reset-size3 size1 mtight">
                                       <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                                        N
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                    <span class="vlist-s">
                                     â€‹
                                    </span>
                                   </span>
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.1433em;">
                                     <span class="">
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.836em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mclose nulldelimiter">
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.8922em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="tag">
          <span class="vlist-t vlist-t2">
           <span class="vlist-r">
            <span class="vlist" style="height: 1.3922em;">
             <span class="" style="top: -3.3922em;">
              <span class="pstrut" style="height: 3.4483em;">
              </span>
              <span class="eqn-num">
              </span>
             </span>
            </span>
            <span class="vlist-s">
             â€‹
            </span>
           </span>
           <span class="vlist-r">
            <span class="vlist" style="height: 0.8922em;">
             <span class="">
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     <strong>
      end
     </strong>
    </p>
    <p>
     è¯¥ç®—æ³•è¦æ±‚æˆ‘ä»¬å¯¹
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        [ 
        
       
         1 
        
       
         , 
        
       
         N 
        
       
         ] 
        
       
      
        [1,N]
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mopen">
          [
         </span>
         <span class="mord">
          1
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.109em;">
          N
         </span>
         <span class="mclose">
          ]
         </span>
        </span>
       </span>
      </span>
     </span>
     è¿›è¡Œ 3 æ¬¡è¿­ä»£ï¼Œåœ¨ Transformer çš„ self-attention ä¸­ï¼Œæ¯ä¸ª
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        x 
         
        
          i 
         
        
       
      
        x_i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           x
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     æ˜¯é€šè¿‡
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        Q 
        
        
        
          K 
         
        
          T 
         
        
       
      
        QK^T
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.0358em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          Q
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0715em;">
           K
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8413em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                 T
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     è®¡ç®—å¾—åˆ°çš„ã€‚å¦‚æœæˆ‘ä»¬æ— æ³•å°†æ‰€æœ‰çš„
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        x 
         
        
          i 
         
        
       
      
        x_i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           x
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     éƒ½ç¼“å­˜åˆ°ç‰‡ä¸Šå†…å­˜ï¼ˆSRAMï¼‰ä¸­ï¼ˆå®é™…ä¸Šæˆ‘ä»¬ä¹Ÿæ²¡æœ‰è¶³å¤Ÿå¤§çš„ç‰‡ä¸Šå†…å­˜ SRAM æ¥å®¹çº³æ‰€æœ‰çš„
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        x 
         
        
          i 
         
        
       
      
        x_i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           x
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ï¼‰ï¼Œé‚£ä¹ˆåœ¨æ¯æ¬¡è¿­ä»£æ—¶ä¸å¾—ä¸è®¿é—®
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        Q 
        
       
         , 
        
       
         K 
        
       
      
        Q,K
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          Q
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0715em;">
          K
         </span>
        </span>
       </span>
      </span>
     </span>
     ä»¥åŠ¨æ€é‡æ–°è®¡ç®—
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        x 
         
        
          i 
         
        
       
      
        x_i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           x
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ï¼Œè¿™ç§é¢‘ç¹çš„è®¿é—®ä¼šå¯¼è‡´å¤§é‡çš„ I/O æ“ä½œï¼Œä»è€Œé™ä½æ•´ä½“æ•ˆç‡
    </p>
    <h3>
     <a id="3_Online_Softmax_120">
     </a>
     3. Online Softmax
    </h3>
    <p>
     å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿåœ¨ä¸€ä¸ªå¾ªç¯ä¸­èåˆå…¬å¼ (7)ã€(8)ã€(9)ï¼Œé‚£ä¹ˆå°±å¯ä»¥å°† global memory çš„è®¿é—®æ—¶é—´é™ä½ 3 å€ï¼Œä¸å¹¸çš„æ˜¯ï¼Œæˆ‘ä»¬ä¸èƒ½åœ¨åŒä¸€ä¸ªå¾ªç¯ä¸­èåˆå…¬å¼ (7)ã€(8)ï¼Œå› ä¸ºå…¬å¼ (8) çš„è®¡ç®—éœ€è¦ä¾èµ–
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        m 
         
        
          N 
         
        
       
      
        m_N
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           m
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3283em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                 N
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ï¼Œè€Œ
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        m 
         
        
          N 
         
        
       
      
        m_N
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           m
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3283em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                 N
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     åªæœ‰åœ¨ç¬¬ä¸€ä¸ªå¾ªç¯å®Œæˆä¹‹åæ‰èƒ½å¤Ÿç¡®å®š
    </p>
    <p>
     æ—¢ç„¶æ•°æ®ä¹‹é—´å­˜åœ¨ç€ä¾èµ–å…³ç³»ï¼Œé‚£æˆ‘ä»¬å¯ä»¥åˆ›å»ºå¦å¤–ä¸€ä¸ªåºåˆ—
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
         
        
          i 
         
        
          â€² 
         
        
       
         : 
        
       
         = 
        
        
        
          âˆ‘ 
         
         
         
           j 
          
         
           = 
          
         
           1 
          
         
        
          i 
         
        
        
        
          e 
         
         
          
          
            x 
           
          
            j 
           
          
         
           âˆ’ 
          
          
          
            m 
           
          
            i 
           
          
         
        
       
      
        d_{i}^{ \prime} := \sum_{j=1}^{i}e^{x_{j}-m_{i}}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.0106em; vertical-align: -0.2587em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           d
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7519em;">
              <span class="" style="top: -2.4413em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  â€²
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2587em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          :=
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.4004em; vertical-align: -0.4358em;">
         </span>
         <span class="mop">
          <span class="mop op-symbol small-op" style="position: relative; top: 0em;">
           âˆ‘
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.9646em;">
              <span class="" style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                 <span class="mrel mtight">
                  =
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.2029em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.4358em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           e
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7713em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   x
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3281em;">
                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                          j
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.2819em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mbin mtight">
                  âˆ’
                 </span>
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   m
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3281em;">
                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         <span class="mord mathnormal mtight">
                          i
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.143em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ä½œä¸ºåŸå§‹åºåˆ—
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
         
        
          i 
         
        
          â€² 
         
        
       
         : 
        
       
         = 
        
        
        
          âˆ‘ 
         
         
         
           j 
          
         
           = 
          
         
           1 
          
         
        
          i 
         
        
        
        
          e 
         
         
          
          
            x 
           
          
            j 
           
          
         
           âˆ’ 
          
          
          
            m 
           
          
            N 
           
          
         
        
       
      
        d_{i}^{ \prime} := \sum_{j=1}^{i}e^{x_{j}-m_{N}}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.0106em; vertical-align: -0.2587em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           d
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7519em;">
              <span class="" style="top: -2.4413em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  â€²
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2587em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          :=
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.4004em; vertical-align: -0.4358em;">
         </span>
         <span class="mop">
          <span class="mop op-symbol small-op" style="position: relative; top: 0em;">
           âˆ‘
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.9646em;">
              <span class="" style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                 <span class="mrel mtight">
                  =
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.2029em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.4358em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           e
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7713em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   x
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3281em;">
                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                          j
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.2819em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mbin mtight">
                  âˆ’
                 </span>
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   m
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3448em;">
                      <span class="" style="top: -2.3567em; margin-left: 0em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                          N
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.1433em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     çš„æ›¿ä»£ï¼Œä»¥æ¶ˆé™¤å¯¹
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        N 
        
       
      
        N
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.109em;">
          N
         </span>
        </span>
       </span>
      </span>
     </span>
     çš„ä¾èµ–ï¼Œå¹¶ä¸”è¿™ä¸¤ä¸ªåºåˆ—çš„ç¬¬
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        N 
        
       
      
        N
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.109em;">
          N
         </span>
        </span>
       </span>
      </span>
     </span>
     é¡¹æ˜¯ç›¸åŒçš„å³
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
         
        
          N 
         
        
       
         = 
        
        
        
          d 
         
        
          N 
         
        
          â€² 
         
        
       
      
        d_N=d^{\prime}_N
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8444em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           d
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3283em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                 N
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.0272em; vertical-align: -0.2753em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           d
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7519em;">
              <span class="" style="top: -2.4247em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                 N
                </span>
               </span>
              </span>
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  â€²
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2753em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å®‰å…¨åœ°ç”¨
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
         
        
          N 
         
        
          â€² 
         
        
       
      
        d^{\prime}_N
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.0272em; vertical-align: -0.2753em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           d
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7519em;">
              <span class="" style="top: -2.4247em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                 N
                </span>
               </span>
              </span>
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  â€²
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2753em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     æ›¿æ¢å…¬å¼ (9) ä¸­çš„
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
         
        
          N 
         
        
       
      
        d_N
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8444em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           d
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3283em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                 N
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     <strong>
      Note
     </strong>
     ï¼šåœ¨æ•°å­¦å’Œè®¡ç®—æœºç§‘å­¦ä¸­ï¼Œç¬¦å·
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        : 
        
       
         = 
        
       
      
        :=
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mrel">
          :=
         </span>
        </span>
       </span>
      </span>
     </span>
     ç”¨äºè¡¨ç¤º â€œå®šä¹‰ä¸ºâ€ æˆ– â€œè¢«å®šä¹‰ä¸ºâ€ï¼Œä¾‹å¦‚å½“æˆ‘ä»¬å†™ä¸‹
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        x 
        
       
         : 
        
       
         = 
        
       
         y 
        
       
      
        x:=y
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          x
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          :=
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          y
         </span>
        </span>
       </span>
      </span>
     </span>
     æ—¶ï¼Œæˆ‘ä»¬æ˜¯åœ¨è¯´æ˜ â€œæˆ‘ä»¬å°†
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        x 
        
       
      
        x
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          x
         </span>
        </span>
       </span>
      </span>
     </span>
     å®šä¹‰ä¸º
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        y 
        
       
      
        y
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          y
         </span>
        </span>
       </span>
      </span>
     </span>
     â€ æˆ– â€œ
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        x 
        
       
      
        x
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          x
         </span>
        </span>
       </span>
      </span>
     </span>
     ç­‰äº
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        y 
        
       
      
        y
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          y
         </span>
        </span>
       </span>
      </span>
     </span>
     ï¼ˆè¿™æ˜¯å®ƒçš„å®šä¹‰ï¼‰â€
    </p>
    <p>
     æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ‰¾åˆ°
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
         
        
          i 
         
        
          â€² 
         
        
       
      
        d^{\prime}_i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.0106em; vertical-align: -0.2587em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           d
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7519em;">
              <span class="" style="top: -2.4413em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  â€²
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2587em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     å’Œ
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
         
         
         
           i 
          
         
           âˆ’ 
          
         
           1 
          
         
        
          â€² 
         
        
       
      
        d^{\prime}_{i-1}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.0689em; vertical-align: -0.317em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           d
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7519em;">
              <span class="" style="top: -2.4413em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mbin mtight">
                  âˆ’
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  â€²
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.317em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ä¹‹é—´çš„é€’å½’å…³ç³»ï¼š
    </p>
    <p>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         d 
                 
                
                  i 
                 
                
                  â€² 
                 
                
               
              
              
               
                
                 
                
                  = 
                 
                 
                 
                   âˆ‘ 
                  
                  
                  
                    j 
                   
                  
                    = 
                   
                  
                    1 
                   
                  
                 
                   i 
                  
                 
                 
                 
                   e 
                  
                  
                   
                   
                     x 
                    
                   
                     j 
                    
                   
                  
                    âˆ’ 
                   
                   
                   
                     m 
                    
                   
                     i 
                    
                   
                  
                 
                
               
              
             
             
              
               
                
               
              
              
               
                
                 
                
                  = 
                 
                 
                 
                   ( 
                  
                  
                  
                    âˆ‘ 
                   
                   
                   
                     j 
                    
                   
                     = 
                    
                   
                     1 
                    
                   
                   
                   
                     i 
                    
                   
                     âˆ’ 
                    
                   
                     1 
                    
                   
                  
                  
                  
                    e 
                   
                   
                    
                    
                      x 
                     
                    
                      j 
                     
                    
                   
                     âˆ’ 
                    
                    
                    
                      m 
                     
                    
                      i 
                     
                    
                   
                  
                 
                   ) 
                  
                 
                
                  + 
                 
                 
                 
                   e 
                  
                  
                   
                   
                     x 
                    
                   
                     i 
                    
                   
                  
                    âˆ’ 
                   
                   
                   
                     m 
                    
                   
                     i 
                    
                   
                  
                 
                
               
              
             
             
              
               
                
               
              
              
               
                
                 
                
                  = 
                 
                 
                 
                   ( 
                  
                  
                  
                    âˆ‘ 
                   
                   
                   
                     j 
                    
                   
                     = 
                    
                   
                     1 
                    
                   
                   
                   
                     i 
                    
                   
                     âˆ’ 
                    
                   
                     1 
                    
                   
                  
                  
                  
                    e 
                   
                   
                    
                    
                      x 
                     
                    
                      j 
                     
                    
                   
                     âˆ’ 
                    
                    
                    
                      m 
                     
                     
                     
                       i 
                      
                     
                       âˆ’ 
                      
                     
                       1 
                      
                     
                    
                   
                  
                 
                   ) 
                  
                 
                 
                 
                   e 
                  
                  
                   
                   
                     m 
                    
                    
                    
                      i 
                     
                    
                      âˆ’ 
                     
                    
                      1 
                     
                    
                   
                  
                    âˆ’ 
                   
                   
                   
                     m 
                    
                   
                     i 
                    
                   
                  
                 
                
                  + 
                 
                 
                 
                   e 
                  
                  
                   
                   
                     x 
                    
                   
                     i 
                    
                   
                  
                    âˆ’ 
                   
                   
                   
                     m 
                    
                   
                     i 
                    
                   
                  
                 
                
               
              
             
             
              
               
                
               
              
              
               
                
                 
                
                  = 
                 
                 
                 
                   d 
                  
                  
                  
                    i 
                   
                  
                    âˆ’ 
                   
                  
                    1 
                   
                  
                 
                   â€² 
                  
                 
                 
                 
                   e 
                  
                  
                   
                   
                     m 
                    
                    
                    
                      i 
                     
                    
                      âˆ’ 
                     
                    
                      1 
                     
                    
                   
                  
                    âˆ’ 
                   
                   
                   
                     m 
                    
                   
                     i 
                    
                   
                  
                 
                
                  + 
                 
                 
                 
                   e 
                  
                  
                   
                   
                     x 
                    
                   
                     i 
                    
                   
                  
                    âˆ’ 
                   
                   
                   
                     m 
                    
                   
                     i 
                    
                   
                  
                 
                
               
              
             
            
           
          
          
          
         
        
       
         \begin{equation} \begin{aligned} d_{i}^{\prime} &amp; =\sum_{j=1}^ie^{x_j-m_i} \\ &amp; =\left(\sum_{j=1}^{i-1}e^{x_j-m_i}\right)+e^{x_i-m_i} \\ &amp; =\left(\sum_{j=1}^{i-1}e^{x_j-m_{i-1}}\right)e^{m_{i-1}-m_i}+e^{x_i-m_i} \\ &amp; =d_{i-1}^{\prime}e^{m_{i-1}-m_i}+e^{x_i-m_i} \end{aligned} \end{equation}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 12.0763em; vertical-align: -5.7882em;">
          </span>
          <span class="mtable">
           <span class="col-align-c">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 6.2882em;">
               <span class="" style="top: -8.2882em;">
                <span class="pstrut" style="height: 8.2882em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  <span class="mtable">
                   <span class="col-align-r">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 6.2882em;">
                       <span class="" style="top: -8.2882em;">
                        <span class="pstrut" style="height: 3.8117em;">
                        </span>
                        <span class="mord">
                         <span class="mord">
                          <span class="mord mathnormal">
                           d
                          </span>
                          <span class="msupsub">
                           <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.8019em;">
                              <span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mathnormal mtight">
                                  i
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="" style="top: -3.113em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mtight">
                                  â€²
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="vlist-s">
                              â€‹
                             </span>
                            </span>
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.247em;">
                              <span class="">
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -4.7627em;">
                        <span class="pstrut" style="height: 3.8117em;">
                        </span>
                        <span class="mord">
                        </span>
                       </span>
                       <span class="" style="top: -1.2373em;">
                        <span class="pstrut" style="height: 3.8117em;">
                        </span>
                        <span class="mord">
                        </span>
                       </span>
                       <span class="" style="top: 1.3165em;">
                        <span class="pstrut" style="height: 3.8117em;">
                        </span>
                        <span class="mord">
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 5.7882em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="col-align-l">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 6.2882em;">
                       <span class="" style="top: -8.2882em;">
                        <span class="pstrut" style="height: 3.8117em;">
                        </span>
                        <span class="mord">
                         <span class="mord">
                         </span>
                         <span class="mspace" style="margin-right: 0.2778em;">
                         </span>
                         <span class="mrel">
                          =
                         </span>
                         <span class="mspace" style="margin-right: 0.2778em;">
                         </span>
                         <span class="mop op-limits">
                          <span class="vlist-t vlist-t2">
                           <span class="vlist-r">
                            <span class="vlist" style="height: 1.8117em;">
                             <span class="" style="top: -1.8723em; margin-left: 0em;">
                              <span class="pstrut" style="height: 3.05em;">
                              </span>
                              <span class="sizing reset-size6 size3 mtight">
                               <span class="mord mtight">
                                <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                                 j
                                </span>
                                <span class="mrel mtight">
                                 =
                                </span>
                                <span class="mord mtight">
                                 1
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="" style="top: -3.05em;">
                              <span class="pstrut" style="height: 3.05em;">
                              </span>
                              <span class="">
                               <span class="mop op-symbol large-op">
                                âˆ‘
                               </span>
                              </span>
                             </span>
                             <span class="" style="top: -4.3em; margin-left: 0em;">
                              <span class="pstrut" style="height: 3.05em;">
                              </span>
                              <span class="sizing reset-size6 size3 mtight">
                               <span class="mord mathnormal mtight">
                                i
                               </span>
                              </span>
                             </span>
                            </span>
                            <span class="vlist-s">
                             â€‹
                            </span>
                           </span>
                           <span class="vlist-r">
                            <span class="vlist" style="height: 1.4138em;">
                             <span class="">
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                         <span class="mspace" style="margin-right: 0.1667em;">
                         </span>
                         <span class="mord">
                          <span class="mord mathnormal">
                           e
                          </span>
                          <span class="msupsub">
                           <span class="vlist-t">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.8213em;">
                              <span class="" style="top: -3.113em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   x
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.3281em;">
                                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                       <span class="pstrut" style="height: 2.5em;">
                                       </span>
                                       <span class="sizing reset-size3 size1 mtight">
                                        <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                                         j
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="vlist-s">
                                      â€‹
                                     </span>
                                    </span>
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.2819em;">
                                      <span class="">
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                 <span class="mbin mtight">
                                  âˆ’
                                 </span>
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   m
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.3281em;">
                                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                       <span class="pstrut" style="height: 2.5em;">
                                       </span>
                                       <span class="sizing reset-size3 size1 mtight">
                                        <span class="mord mathnormal mtight">
                                         i
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="vlist-s">
                                      â€‹
                                     </span>
                                    </span>
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.143em;">
                                      <span class="">
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -4.7627em;">
                        <span class="pstrut" style="height: 3.8117em;">
                        </span>
                        <span class="mord">
                         <span class="mord">
                         </span>
                         <span class="mspace" style="margin-right: 0.2778em;">
                         </span>
                         <span class="mrel">
                          =
                         </span>
                         <span class="mspace" style="margin-right: 0.2778em;">
                         </span>
                         <span class="minner">
                          <span class="mopen delimcenter" style="top: 0em;">
                           <span class="delimsizing size4">
                            (
                           </span>
                          </span>
                          <span class="mop op-limits">
                           <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 1.8117em;">
                              <span class="" style="top: -1.8723em; margin-left: 0em;">
                               <span class="pstrut" style="height: 3.05em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                                  j
                                 </span>
                                 <span class="mrel mtight">
                                  =
                                 </span>
                                 <span class="mord mtight">
                                  1
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="" style="top: -3.05em;">
                               <span class="pstrut" style="height: 3.05em;">
                               </span>
                               <span class="">
                                <span class="mop op-symbol large-op">
                                 âˆ‘
                                </span>
                               </span>
                              </span>
                              <span class="" style="top: -4.3em; margin-left: 0em;">
                               <span class="pstrut" style="height: 3.05em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mathnormal mtight">
                                  i
                                 </span>
                                 <span class="mbin mtight">
                                  âˆ’
                                 </span>
                                 <span class="mord mtight">
                                  1
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="vlist-s">
                              â€‹
                             </span>
                            </span>
                            <span class="vlist-r">
                             <span class="vlist" style="height: 1.4138em;">
                              <span class="">
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="mspace" style="margin-right: 0.1667em;">
                          </span>
                          <span class="mord">
                           <span class="mord mathnormal">
                            e
                           </span>
                           <span class="msupsub">
                            <span class="vlist-t">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.8213em;">
                               <span class="" style="top: -3.113em; margin-right: 0.05em;">
                                <span class="pstrut" style="height: 2.7em;">
                                </span>
                                <span class="sizing reset-size6 size3 mtight">
                                 <span class="mord mtight">
                                  <span class="mord mtight">
                                   <span class="mord mathnormal mtight">
                                    x
                                   </span>
                                   <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                     <span class="vlist-r">
                                      <span class="vlist" style="height: 0.3281em;">
                                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                        <span class="pstrut" style="height: 2.5em;">
                                        </span>
                                        <span class="sizing reset-size3 size1 mtight">
                                         <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                                          j
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                      <span class="vlist-s">
                                       â€‹
                                      </span>
                                     </span>
                                     <span class="vlist-r">
                                      <span class="vlist" style="height: 0.2819em;">
                                       <span class="">
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                  <span class="mbin mtight">
                                   âˆ’
                                  </span>
                                  <span class="mord mtight">
                                   <span class="mord mathnormal mtight">
                                    m
                                   </span>
                                   <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                     <span class="vlist-r">
                                      <span class="vlist" style="height: 0.3281em;">
                                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                        <span class="pstrut" style="height: 2.5em;">
                                        </span>
                                        <span class="sizing reset-size3 size1 mtight">
                                         <span class="mord mathnormal mtight">
                                          i
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                      <span class="vlist-s">
                                       â€‹
                                      </span>
                                     </span>
                                     <span class="vlist-r">
                                      <span class="vlist" style="height: 0.143em;">
                                       <span class="">
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="mclose delimcenter" style="top: 0em;">
                           <span class="delimsizing size4">
                            )
                           </span>
                          </span>
                         </span>
                         <span class="mspace" style="margin-right: 0.2222em;">
                         </span>
                         <span class="mbin">
                          +
                         </span>
                         <span class="mspace" style="margin-right: 0.2222em;">
                         </span>
                         <span class="mord">
                          <span class="mord mathnormal">
                           e
                          </span>
                          <span class="msupsub">
                           <span class="vlist-t">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.8213em;">
                              <span class="" style="top: -3.113em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   x
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.3281em;">
                                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                       <span class="pstrut" style="height: 2.5em;">
                                       </span>
                                       <span class="sizing reset-size3 size1 mtight">
                                        <span class="mord mathnormal mtight">
                                         i
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="vlist-s">
                                      â€‹
                                     </span>
                                    </span>
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.143em;">
                                      <span class="">
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                 <span class="mbin mtight">
                                  âˆ’
                                 </span>
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   m
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.3281em;">
                                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                       <span class="pstrut" style="height: 2.5em;">
                                       </span>
                                       <span class="sizing reset-size3 size1 mtight">
                                        <span class="mord mathnormal mtight">
                                         i
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="vlist-s">
                                      â€‹
                                     </span>
                                    </span>
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.143em;">
                                      <span class="">
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -1.2373em;">
                        <span class="pstrut" style="height: 3.8117em;">
                        </span>
                        <span class="mord">
                         <span class="mord">
                         </span>
                         <span class="mspace" style="margin-right: 0.2778em;">
                         </span>
                         <span class="mrel">
                          =
                         </span>
                         <span class="mspace" style="margin-right: 0.2778em;">
                         </span>
                         <span class="minner">
                          <span class="mopen delimcenter" style="top: 0em;">
                           <span class="delimsizing size4">
                            (
                           </span>
                          </span>
                          <span class="mop op-limits">
                           <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 1.8117em;">
                              <span class="" style="top: -1.8723em; margin-left: 0em;">
                               <span class="pstrut" style="height: 3.05em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                                  j
                                 </span>
                                 <span class="mrel mtight">
                                  =
                                 </span>
                                 <span class="mord mtight">
                                  1
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="" style="top: -3.05em;">
                               <span class="pstrut" style="height: 3.05em;">
                               </span>
                               <span class="">
                                <span class="mop op-symbol large-op">
                                 âˆ‘
                                </span>
                               </span>
                              </span>
                              <span class="" style="top: -4.3em; margin-left: 0em;">
                               <span class="pstrut" style="height: 3.05em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mathnormal mtight">
                                  i
                                 </span>
                                 <span class="mbin mtight">
                                  âˆ’
                                 </span>
                                 <span class="mord mtight">
                                  1
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="vlist-s">
                              â€‹
                             </span>
                            </span>
                            <span class="vlist-r">
                             <span class="vlist" style="height: 1.4138em;">
                              <span class="">
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="mspace" style="margin-right: 0.1667em;">
                          </span>
                          <span class="mord">
                           <span class="mord mathnormal">
                            e
                           </span>
                           <span class="msupsub">
                            <span class="vlist-t">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.8213em;">
                               <span class="" style="top: -3.113em; margin-right: 0.05em;">
                                <span class="pstrut" style="height: 2.7em;">
                                </span>
                                <span class="sizing reset-size6 size3 mtight">
                                 <span class="mord mtight">
                                  <span class="mord mtight">
                                   <span class="mord mathnormal mtight">
                                    x
                                   </span>
                                   <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                     <span class="vlist-r">
                                      <span class="vlist" style="height: 0.3281em;">
                                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                        <span class="pstrut" style="height: 2.5em;">
                                        </span>
                                        <span class="sizing reset-size3 size1 mtight">
                                         <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                                          j
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                      <span class="vlist-s">
                                       â€‹
                                      </span>
                                     </span>
                                     <span class="vlist-r">
                                      <span class="vlist" style="height: 0.2819em;">
                                       <span class="">
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                  <span class="mbin mtight">
                                   âˆ’
                                  </span>
                                  <span class="mord mtight">
                                   <span class="mord mathnormal mtight">
                                    m
                                   </span>
                                   <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                     <span class="vlist-r">
                                      <span class="vlist" style="height: 0.3281em;">
                                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                        <span class="pstrut" style="height: 2.5em;">
                                        </span>
                                        <span class="sizing reset-size3 size1 mtight">
                                         <span class="mord mtight">
                                          <span class="mord mathnormal mtight">
                                           i
                                          </span>
                                          <span class="mbin mtight">
                                           âˆ’
                                          </span>
                                          <span class="mord mtight">
                                           1
                                          </span>
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                      <span class="vlist-s">
                                       â€‹
                                      </span>
                                     </span>
                                     <span class="vlist-r">
                                      <span class="vlist" style="height: 0.2025em;">
                                       <span class="">
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="mclose delimcenter" style="top: 0em;">
                           <span class="delimsizing size4">
                            )
                           </span>
                          </span>
                         </span>
                         <span class="mspace" style="margin-right: 0.1667em;">
                         </span>
                         <span class="mord">
                          <span class="mord mathnormal">
                           e
                          </span>
                          <span class="msupsub">
                           <span class="vlist-t">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.8213em;">
                              <span class="" style="top: -3.113em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   m
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.3281em;">
                                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                       <span class="pstrut" style="height: 2.5em;">
                                       </span>
                                       <span class="sizing reset-size3 size1 mtight">
                                        <span class="mord mtight">
                                         <span class="mord mathnormal mtight">
                                          i
                                         </span>
                                         <span class="mbin mtight">
                                          âˆ’
                                         </span>
                                         <span class="mord mtight">
                                          1
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="vlist-s">
                                      â€‹
                                     </span>
                                    </span>
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.2025em;">
                                      <span class="">
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                 <span class="mbin mtight">
                                  âˆ’
                                 </span>
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   m
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.3281em;">
                                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                       <span class="pstrut" style="height: 2.5em;">
                                       </span>
                                       <span class="sizing reset-size3 size1 mtight">
                                        <span class="mord mathnormal mtight">
                                         i
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="vlist-s">
                                      â€‹
                                     </span>
                                    </span>
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.143em;">
                                      <span class="">
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                         <span class="mspace" style="margin-right: 0.2222em;">
                         </span>
                         <span class="mbin">
                          +
                         </span>
                         <span class="mspace" style="margin-right: 0.2222em;">
                         </span>
                         <span class="mord">
                          <span class="mord mathnormal">
                           e
                          </span>
                          <span class="msupsub">
                           <span class="vlist-t">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.8213em;">
                              <span class="" style="top: -3.113em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   x
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.3281em;">
                                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                       <span class="pstrut" style="height: 2.5em;">
                                       </span>
                                       <span class="sizing reset-size3 size1 mtight">
                                        <span class="mord mathnormal mtight">
                                         i
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="vlist-s">
                                      â€‹
                                     </span>
                                    </span>
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.143em;">
                                      <span class="">
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                 <span class="mbin mtight">
                                  âˆ’
                                 </span>
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   m
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.3281em;">
                                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                       <span class="pstrut" style="height: 2.5em;">
                                       </span>
                                       <span class="sizing reset-size3 size1 mtight">
                                        <span class="mord mathnormal mtight">
                                         i
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="vlist-s">
                                      â€‹
                                     </span>
                                    </span>
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.143em;">
                                      <span class="">
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: 1.3165em;">
                        <span class="pstrut" style="height: 3.8117em;">
                        </span>
                        <span class="mord">
                         <span class="mord">
                         </span>
                         <span class="mspace" style="margin-right: 0.2778em;">
                         </span>
                         <span class="mrel">
                          =
                         </span>
                         <span class="mspace" style="margin-right: 0.2778em;">
                         </span>
                         <span class="mord">
                          <span class="mord mathnormal">
                           d
                          </span>
                          <span class="msupsub">
                           <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.8019em;">
                              <span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mathnormal mtight">
                                  i
                                 </span>
                                 <span class="mbin mtight">
                                  âˆ’
                                 </span>
                                 <span class="mord mtight">
                                  1
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="" style="top: -3.113em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mtight">
                                  â€²
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="vlist-s">
                              â€‹
                             </span>
                            </span>
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.3053em;">
                              <span class="">
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                         <span class="mord">
                          <span class="mord mathnormal">
                           e
                          </span>
                          <span class="msupsub">
                           <span class="vlist-t">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.8213em;">
                              <span class="" style="top: -3.113em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   m
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.3281em;">
                                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                       <span class="pstrut" style="height: 2.5em;">
                                       </span>
                                       <span class="sizing reset-size3 size1 mtight">
                                        <span class="mord mtight">
                                         <span class="mord mathnormal mtight">
                                          i
                                         </span>
                                         <span class="mbin mtight">
                                          âˆ’
                                         </span>
                                         <span class="mord mtight">
                                          1
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="vlist-s">
                                      â€‹
                                     </span>
                                    </span>
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.2025em;">
                                      <span class="">
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                 <span class="mbin mtight">
                                  âˆ’
                                 </span>
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   m
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.3281em;">
                                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                       <span class="pstrut" style="height: 2.5em;">
                                       </span>
                                       <span class="sizing reset-size3 size1 mtight">
                                        <span class="mord mathnormal mtight">
                                         i
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="vlist-s">
                                      â€‹
                                     </span>
                                    </span>
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.143em;">
                                      <span class="">
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                         <span class="mspace" style="margin-right: 0.2222em;">
                         </span>
                         <span class="mbin">
                          +
                         </span>
                         <span class="mspace" style="margin-right: 0.2222em;">
                         </span>
                         <span class="mord">
                          <span class="mord mathnormal">
                           e
                          </span>
                          <span class="msupsub">
                           <span class="vlist-t">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.8213em;">
                              <span class="" style="top: -3.113em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   x
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.3281em;">
                                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                       <span class="pstrut" style="height: 2.5em;">
                                       </span>
                                       <span class="sizing reset-size3 size1 mtight">
                                        <span class="mord mathnormal mtight">
                                         i
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="vlist-s">
                                      â€‹
                                     </span>
                                    </span>
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.143em;">
                                      <span class="">
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                 <span class="mbin mtight">
                                  âˆ’
                                 </span>
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   m
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.3281em;">
                                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                       <span class="pstrut" style="height: 2.5em;">
                                       </span>
                                       <span class="sizing reset-size3 size1 mtight">
                                        <span class="mord mathnormal mtight">
                                         i
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="vlist-s">
                                      â€‹
                                     </span>
                                    </span>
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.143em;">
                                      <span class="">
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 5.7882em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 5.7882em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="tag">
          <span class="vlist-t vlist-t2">
           <span class="vlist-r">
            <span class="vlist" style="height: 6.2882em;">
             <span class="" style="top: -8.2882em;">
              <span class="pstrut" style="height: 8.2882em;">
              </span>
              <span class="eqn-num">
              </span>
             </span>
            </span>
            <span class="vlist-s">
             â€‹
            </span>
           </span>
           <span class="vlist-r">
            <span class="vlist" style="height: 5.7882em;">
             <span class="">
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     è¿™ä¸ªé€’å½’å…¬å¼åªä¾èµ–äº
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        m 
         
        
          i 
         
        
       
      
        m_i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           m
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     å’Œ
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        m 
         
         
         
           i 
          
         
           âˆ’ 
          
         
           1 
          
         
        
       
      
        m_{i-1}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6389em; vertical-align: -0.2083em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           m
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mbin mtight">
                  âˆ’
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2083em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ï¼Œæ­¤å¤–æˆ‘ä»¬è¿˜å¯ä»¥åœ¨ä¸€ä¸ªå¾ªç¯ä¸­åŒæ—¶è®¡ç®—
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        m 
         
        
          j 
         
        
       
      
        m_j
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           m
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                 j
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     å’Œ
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
         
        
          j 
         
        
          â€² 
         
        
       
      
        d^{\prime}_j
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.1467em; vertical-align: -0.3948em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           d
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7519em;">
              <span class="" style="top: -2.4413em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                 j
                </span>
               </span>
              </span>
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  â€²
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3948em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     <strong>
      Algorithm 2-pass online softmax
     </strong>
    </p>
    <p>
     <strong>
      for
     </strong>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        i 
        
       
         â† 
        
       
         1 
        
       
         , 
        
       
         N 
        
       
      
        i\leftarrow 1,N
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6595em;">
         </span>
         <span class="mord mathnormal">
          i
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          â†
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.109em;">
          N
         </span>
        </span>
       </span>
      </span>
     </span>
     <strong>
      do
     </strong>
    </p>
    <p>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         m 
             
            
              i 
             
            
           
          
          
           
            
             
            
              â† 
             
            
              max 
             
            
              â¡ 
             
            
              ( 
             
             
             
               m 
              
              
              
                i 
               
              
                âˆ’ 
               
              
                1 
               
              
             
            
              , 
             
             
             
               x 
              
             
               i 
              
             
            
              ) 
             
            
           
          
         
         
          
           
            
            
              d 
             
            
              i 
             
            
              â€² 
             
            
           
          
          
           
            
             
            
              â† 
             
             
             
               d 
              
              
              
                i 
               
              
                âˆ’ 
               
              
                1 
               
              
             
               â€² 
              
             
             
             
               e 
              
              
               
               
                 m 
                
                
                
                  i 
                 
                
                  âˆ’ 
                 
                
                  1 
                 
                
               
              
                âˆ’ 
               
               
               
                 m 
                
               
                 i 
                
               
              
             
            
              + 
             
             
             
               e 
              
              
               
               
                 x 
                
               
                 i 
                
               
              
                âˆ’ 
               
               
               
                 m 
                
               
                 i 
                
               
              
             
            
           
          
         
        
       
         \begin{aligned} m_i &amp; \leftarrow \max (m_{i-1}, x_i) \\ d^{\prime}_i &amp; \leftarrow d^{\prime}_{i-1}e^{m_{i-1}-m_i}+e^{x_i-m_i} \end{aligned}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 3em; vertical-align: -1.25em;">
          </span>
          <span class="mord">
           <span class="mtable">
            <span class="col-align-r">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 1.75em;">
                <span class="" style="top: -3.91em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                   <span class="mord mathnormal">
                    m
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3117em;">
                       <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mathnormal mtight">
                          i
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.15em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="" style="top: -2.41em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                   <span class="mord mathnormal">
                    d
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.8019em;">
                       <span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mathnormal mtight">
                          i
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -3.113em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mtight">
                           â€²
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.247em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                â€‹
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 1.25em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="col-align-l">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 1.75em;">
                <span class="" style="top: -3.91em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mrel">
                   â†
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mop">
                   max
                  </span>
                  <span class="mopen">
                   (
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal">
                    m
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3117em;">
                       <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight">
                           i
                          </span>
                          <span class="mbin mtight">
                           âˆ’
                          </span>
                          <span class="mord mtight">
                           1
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.2083em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mpunct">
                   ,
                  </span>
                  <span class="mspace" style="margin-right: 0.1667em;">
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal">
                    x
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3117em;">
                       <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mathnormal mtight">
                          i
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.15em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mclose">
                   )
                  </span>
                 </span>
                </span>
                <span class="" style="top: -2.41em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mrel">
                   â†
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal">
                    d
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.8019em;">
                       <span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight">
                           i
                          </span>
                          <span class="mbin mtight">
                           âˆ’
                          </span>
                          <span class="mord mtight">
                           1
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -3.113em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mtight">
                           â€²
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3053em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal">
                    e
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.8213em;">
                       <span class="" style="top: -3.113em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight">
                            m
                           </span>
                           <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.3281em;">
                               <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                <span class="pstrut" style="height: 2.5em;">
                                </span>
                                <span class="sizing reset-size3 size1 mtight">
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   i
                                  </span>
                                  <span class="mbin mtight">
                                   âˆ’
                                  </span>
                                  <span class="mord mtight">
                                   1
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               â€‹
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.2025em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="mbin mtight">
                           âˆ’
                          </span>
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight">
                            m
                           </span>
                           <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.3281em;">
                               <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                <span class="pstrut" style="height: 2.5em;">
                                </span>
                                <span class="sizing reset-size3 size1 mtight">
                                 <span class="mord mathnormal mtight">
                                  i
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               â€‹
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.143em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mspace" style="margin-right: 0.2222em;">
                  </span>
                  <span class="mbin">
                   +
                  </span>
                  <span class="mspace" style="margin-right: 0.2222em;">
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal">
                    e
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.8213em;">
                       <span class="" style="top: -3.113em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight">
                            x
                           </span>
                           <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.3281em;">
                               <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                <span class="pstrut" style="height: 2.5em;">
                                </span>
                                <span class="sizing reset-size3 size1 mtight">
                                 <span class="mord mathnormal mtight">
                                  i
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               â€‹
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.143em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="mbin mtight">
                           âˆ’
                          </span>
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight">
                            m
                           </span>
                           <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.3281em;">
                               <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                <span class="pstrut" style="height: 2.5em;">
                                </span>
                                <span class="sizing reset-size3 size1 mtight">
                                 <span class="mord mathnormal mtight">
                                  i
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               â€‹
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.143em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                â€‹
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 1.25em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     <strong>
      end
     </strong>
    </p>
    <p>
     <strong>
      for
     </strong>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        i 
        
       
         â† 
        
       
         1 
        
       
         , 
        
       
         N 
        
       
      
        i\leftarrow 1,N
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6595em;">
         </span>
         <span class="mord mathnormal">
          i
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          â†
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.109em;">
          N
         </span>
        </span>
       </span>
      </span>
     </span>
     <strong>
      do
     </strong>
    </p>
    <p>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         a 
          
         
           i 
          
         
        
          â† 
         
         
          
          
            e 
           
           
            
            
              x 
             
            
              i 
             
            
           
             âˆ’ 
            
            
            
              m 
             
            
              N 
             
            
           
          
          
          
            d 
           
          
            N 
           
          
            â€² 
           
          
         
        
       
         a_i \leftarrow \frac{e^{x_i - m_N}}{d^{\prime}_N}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            a
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           â†
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 2.4279em; vertical-align: -0.9795em;">
          </span>
          <span class="mord">
           <span class="mopen nulldelimiter">
           </span>
           <span class="mfrac">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.4483em;">
               <span class="" style="top: -2.314em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  <span class="mord mathnormal">
                   d
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.7337em;">
                      <span class="" style="top: -2.4065em; margin-left: 0em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                         N
                        </span>
                       </span>
                      </span>
                      <span class="" style="top: -3.0448em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mtight">
                         <span class="mord mtight">
                          â€²
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.2935em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.23em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="frac-line" style="border-bottom-width: 0.04em;">
                </span>
               </span>
               <span class="" style="top: -3.677em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  <span class="mord mathnormal">
                   e
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.7713em;">
                      <span class="" style="top: -3.063em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight">
                           x
                          </span>
                          <span class="msupsub">
                           <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.3281em;">
                              <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                               <span class="pstrut" style="height: 2.5em;">
                               </span>
                               <span class="sizing reset-size3 size1 mtight">
                                <span class="mord mathnormal mtight">
                                 i
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="vlist-s">
                              â€‹
                             </span>
                            </span>
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.143em;">
                              <span class="">
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                         <span class="mbin mtight">
                          âˆ’
                         </span>
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight">
                           m
                          </span>
                          <span class="msupsub">
                           <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.3448em;">
                              <span class="" style="top: -2.3567em; margin-left: 0em; margin-right: 0.0714em;">
                               <span class="pstrut" style="height: 2.5em;">
                               </span>
                               <span class="sizing reset-size3 size1 mtight">
                                <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                                 N
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="vlist-s">
                              â€‹
                             </span>
                            </span>
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.1433em;">
                              <span class="">
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.9795em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mclose nulldelimiter">
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     <strong>
      end
     </strong>
    </p>
    <p>
     è¿™æ˜¯
     <a rel="nofollow">
      Online Softmax
     </a>
     è®ºæ–‡ä¸­æå‡ºçš„ç®—æ³•ï¼Œä½†å®ƒä»ç„¶éœ€è¦ä¸¤æ¬¡å¾ªç¯æ‰èƒ½å®Œæˆ softmax çš„è®¡ç®—ï¼Œæˆ‘ä»¬èƒ½å¦å°†å¾ªç¯æ¬¡æ•°å‡å°‘åˆ° 1 æ¬¡æ¥æœ€å°åŒ–å…¨å±€çš„ I/O å‘¢ï¼ŸğŸ¤”
    </p>
    <h3>
     <a id="4_FlashAttention_166">
     </a>
     4. FlashAttention
    </h3>
    <p>
     ä¸å¹¸çš„æ˜¯ï¼Œå¯¹äº softmax æ¥è¯´ï¼Œç­”æ¡ˆæ˜¯å¦å®šçš„ï¼Œä½†åœ¨ Self-Attention ä¸­ï¼Œæˆ‘ä»¬æœ€ç»ˆçš„ç›®æ ‡å¹¶ä¸æ˜¯æ³¨æ„åŠ›åˆ†æ•°çŸ©é˜µ
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        A 
        
       
         = 
        
        
        
          s 
         
        
          o 
         
        
          f 
         
        
          t 
         
        
          m 
         
        
          a 
         
        
          x 
         
        
       
         ( 
        
       
         Q 
        
        
        
          K 
         
        
          T 
         
        
       
         ) 
        
       
      
        A=\mathrm{softmax}(QK^T)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal">
          A
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.0913em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          <span class="mord mathrm">
           softmax
          </span>
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          Q
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0715em;">
           K
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8413em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                 T
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     ï¼Œè€Œæ˜¯è¾“å‡ºçŸ©é˜µ
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         = 
        
       
         A 
        
       
         Ã— 
        
       
         V 
        
       
      
        O=A \times V
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;">
         </span>
         <span class="mord mathnormal">
          A
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          Ã—
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.2222em;">
          V
         </span>
        </span>
       </span>
      </span>
     </span>
     ï¼Œæ—¢ç„¶æ— æ³•æ‰¾åˆ° softmax çš„ä¸€æ¬¡é€’å½’å½¢å¼ï¼Œé‚£æˆ‘ä»¬æ¢ä¸ªæ€è·¯æ€è€ƒä¸‹èƒ½å¦æ‰¾åˆ°çŸ©é˜µ
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
      
        O
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
        </span>
       </span>
      </span>
     </span>
     çš„ä¸€æ¬¡é€’å½’å½¢å¼å‘¢ï¼Ÿ
    </p>
    <p>
     ä¸‹é¢æˆ‘ä»¬å°è¯•ä¸‹å…ˆå°† Self-Attention è®¡ç®—çš„ç¬¬
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     è¡Œå…¬å¼è½¬åŒ–ä¸ºé€’å½’ç®—æ³•ï¼š
    </p>
    <p>
     <strong>
      Note
     </strong>
     ï¼šç”±äºæ‰€æœ‰è¡Œçš„è®¡ç®—éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œä¸ºäº†ç®€å•èµ·è§ï¼Œè¿™é‡Œæˆ‘ä»¬åªè§£é‡Šä¸€è¡Œçš„è®¡ç®—
    </p>
    <p>
     <strong>
      Algorithm Multi-pass Self-Attention
     </strong>
    </p>
    <p>
     NOTATIONS
    </p>
    <ul>
     <li>
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         Q 
         
        
          [ 
         
        
          k 
         
        
          , 
         
        
          : 
         
        
          ] 
         
        
       
         Q[k,:]
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord mathnormal">
           Q
          </span>
          <span class="mopen">
           [
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0315em;">
           k
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           :
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mclose">
           ]
          </span>
         </span>
        </span>
       </span>
      </span>
      ï¼šæŸ¥è¯¢çŸ©é˜µ
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         Q 
         
        
       
         Q
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;">
          </span>
          <span class="mord mathnormal">
           Q
          </span>
         </span>
        </span>
       </span>
      </span>
      çš„ç¬¬
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         k 
         
        
       
         k
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6944em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0315em;">
           k
          </span>
         </span>
        </span>
       </span>
      </span>
      è¡Œå‘é‡
     </li>
     <li>
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         K 
          
         
           T 
          
         
        
          [ 
         
        
          : 
         
        
          , 
         
        
          i 
         
        
          ] 
         
        
       
         K^T[:,i]
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1.0913em; vertical-align: -0.25em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0715em;">
            K
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.8413em;">
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                  T
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mopen">
           [
          </span>
          <span class="mrel">
           :
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mord mathnormal">
           i
          </span>
          <span class="mclose">
           ]
          </span>
         </span>
        </span>
       </span>
      </span>
      ï¼šé”®çŸ©é˜µ
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         K 
          
         
           T 
          
         
        
       
         K^T
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.8413em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0715em;">
            K
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.8413em;">
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                  T
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      çš„ç¬¬
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         i 
         
        
       
         i
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6595em;">
          </span>
          <span class="mord mathnormal">
           i
          </span>
         </span>
        </span>
       </span>
      </span>
      åˆ—å‘é‡
     </li>
     <li>
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         O 
         
        
          [ 
         
        
          k 
         
        
          , 
         
        
          : 
         
        
          ] 
         
        
       
         O[k,:]
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           O
          </span>
          <span class="mopen">
           [
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0315em;">
           k
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           :
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mclose">
           ]
          </span>
         </span>
        </span>
       </span>
      </span>
      ï¼šè¾“å‡ºçŸ©é˜µ
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         O 
         
        
       
         O
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           O
          </span>
         </span>
        </span>
       </span>
      </span>
      çš„ç¬¬
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         k 
         
        
       
         k
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6944em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0315em;">
           k
          </span>
         </span>
        </span>
       </span>
      </span>
      è¡Œ
     </li>
     <li>
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         V 
         
        
          [ 
         
        
          i 
         
        
          , 
         
        
          : 
         
        
          ] 
         
        
       
         V[i,:]
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.2222em;">
           V
          </span>
          <span class="mopen">
           [
          </span>
          <span class="mord mathnormal">
           i
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           :
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mclose">
           ]
          </span>
         </span>
        </span>
       </span>
      </span>
      ï¼šå€¼çŸ©é˜µ
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         V 
         
        
       
         V
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.2222em;">
           V
          </span>
         </span>
        </span>
       </span>
      </span>
      çš„ç¬¬
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         i 
         
        
       
         i
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6595em;">
          </span>
          <span class="mord mathnormal">
           i
          </span>
         </span>
        </span>
       </span>
      </span>
      è¡Œ
     </li>
     <li>
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         o 
          
         
           i 
          
         
        
       
         \bm{o}_i
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.5944em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord">
            <span class="mord">
             <span class="mord boldsymbol">
              o
             </span>
            </span>
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ï¼š
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         âˆ‘ 
          
          
          
            j 
           
          
            = 
           
          
            1 
           
          
         
           i 
          
         
         
         
           a 
          
         
           j 
          
         
        
          V 
         
        
          [ 
         
        
          j 
         
        
          , 
         
        
          : 
         
        
          ] 
         
        
       
         \sum_{j=1}^ia_jV[j,:]
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1.4004em; vertical-align: -0.4358em;">
          </span>
          <span class="mop">
           <span class="mop op-symbol small-op" style="position: relative; top: 0em;">
            âˆ‘
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.9646em;">
               <span class="" style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                   j
                  </span>
                  <span class="mrel mtight">
                   =
                  </span>
                  <span class="mord mtight">
                   1
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.2029em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.4358em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            a
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mord mathnormal" style="margin-right: 0.2222em;">
           V
          </span>
          <span class="mopen">
           [
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0572em;">
           j
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           :
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mclose">
           ]
          </span>
         </span>
        </span>
       </span>
      </span>
      ï¼Œå­˜å‚¨
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         A 
         
        
          [ 
         
        
          k 
         
        
          , 
         
        
          : 
         
        
          i 
         
        
          ] 
         
        
          Ã— 
         
        
          V 
         
        
          [ 
         
        
          : 
         
        
          i 
         
        
          , 
         
        
          : 
         
        
          ] 
         
        
       
         A[k,:i]\times V[:i,:]
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord mathnormal">
           A
          </span>
          <span class="mopen">
           [
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0315em;">
           k
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           :
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord mathnormal">
           i
          </span>
          <span class="mclose">
           ]
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           Ã—
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.2222em;">
           V
          </span>
          <span class="mopen">
           [
          </span>
          <span class="mrel">
           :
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.854em; vertical-align: -0.1944em;">
          </span>
          <span class="mord mathnormal">
           i
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           :
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mclose">
           ]
          </span>
         </span>
        </span>
       </span>
      </span>
      ç»“æœçš„è¡Œå‘é‡
     </li>
    </ul>
    <p>
     BODY
    </p>
    <p>
     <strong>
      for
     </strong>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        i 
        
       
         â† 
        
       
         1 
        
       
         , 
        
       
         N 
        
       
      
        i\leftarrow 1,N
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6595em;">
         </span>
         <span class="mord mathnormal">
          i
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          â†
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.109em;">
          N
         </span>
        </span>
       </span>
      </span>
     </span>
     <strong>
      do
     </strong>
    </p>
    <p>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         x 
             
            
              i 
             
            
           
          
          
           
            
             
            
              â† 
             
            
              Q 
             
            
              [ 
             
            
              k 
             
            
              , 
             
            
              : 
             
            
              ] 
             
             
             
               K 
              
             
               T 
              
             
            
              [ 
             
            
              : 
             
            
              , 
             
            
              i 
             
            
              ] 
             
            
           
          
         
         
          
           
            
            
              m 
             
            
              i 
             
            
           
          
          
           
            
             
            
              â† 
             
            
              max 
             
            
              â¡ 
             
            
              ( 
             
             
             
               m 
              
              
              
                i 
               
              
                âˆ’ 
               
              
                1 
               
              
             
            
              , 
             
             
             
               x 
              
             
               i 
              
             
            
              ) 
             
            
           
          
         
         
          
           
            
            
              d 
             
            
              i 
             
            
              â€² 
             
            
           
          
          
           
            
             
            
              â† 
             
             
             
               d 
              
              
              
                i 
               
              
                âˆ’ 
               
              
                1 
               
              
             
               â€² 
              
             
             
             
               e 
              
              
               
               
                 m 
                
                
                
                  i 
                 
                
                  âˆ’ 
                 
                
                  1 
                 
                
               
              
                âˆ’ 
               
               
               
                 m 
                
               
                 i 
                
               
              
             
            
              + 
             
             
             
               e 
              
              
               
               
                 x 
                
               
                 i 
                
               
              
                âˆ’ 
               
               
               
                 m 
                
               
                 i 
                
               
              
             
            
           
          
         
        
       
         \begin{aligned} x_i &amp; \leftarrow Q[k,:]K^T[:,i] \\ m_i &amp; \leftarrow \max (m_{i-1},x_i) \\ d^{\prime}_i &amp; \leftarrow d^{\prime}_{i-1} e^{m_{i-1}-m_i} + e^{x_i-m_i} \end{aligned}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 4.5513em; vertical-align: -2.0257em;">
          </span>
          <span class="mord">
           <span class="mtable">
            <span class="col-align-r">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 2.5257em;">
                <span class="" style="top: -4.6343em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                   <span class="mord mathnormal">
                    x
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3117em;">
                       <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mathnormal mtight">
                          i
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.15em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="" style="top: -3.1343em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                   <span class="mord mathnormal">
                    m
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3117em;">
                       <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mathnormal mtight">
                          i
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.15em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="" style="top: -1.6343em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                   <span class="mord mathnormal">
                    d
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.8019em;">
                       <span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mathnormal mtight">
                          i
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -3.113em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mtight">
                           â€²
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.247em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                â€‹
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 2.0257em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="col-align-l">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 2.5257em;">
                <span class="" style="top: -4.6343em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mrel">
                   â†
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mord mathnormal">
                   Q
                  </span>
                  <span class="mopen">
                   [
                  </span>
                  <span class="mord mathnormal" style="margin-right: 0.0315em;">
                   k
                  </span>
                  <span class="mpunct">
                   ,
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mrel">
                   :
                  </span>
                  <span class="mclose">
                   ]
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal" style="margin-right: 0.0715em;">
                    K
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.8913em;">
                       <span class="" style="top: -3.113em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                          T
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mopen">
                   [
                  </span>
                  <span class="mrel">
                   :
                  </span>
                  <span class="mpunct">
                   ,
                  </span>
                  <span class="mspace" style="margin-right: 0.1667em;">
                  </span>
                  <span class="mord mathnormal">
                   i
                  </span>
                  <span class="mclose">
                   ]
                  </span>
                 </span>
                </span>
                <span class="" style="top: -3.1343em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mrel">
                   â†
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mop">
                   max
                  </span>
                  <span class="mopen">
                   (
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal">
                    m
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3117em;">
                       <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight">
                           i
                          </span>
                          <span class="mbin mtight">
                           âˆ’
                          </span>
                          <span class="mord mtight">
                           1
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.2083em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mpunct">
                   ,
                  </span>
                  <span class="mspace" style="margin-right: 0.1667em;">
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal">
                    x
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3117em;">
                       <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mathnormal mtight">
                          i
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.15em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mclose">
                   )
                  </span>
                 </span>
                </span>
                <span class="" style="top: -1.6343em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mrel">
                   â†
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal">
                    d
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.8019em;">
                       <span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight">
                           i
                          </span>
                          <span class="mbin mtight">
                           âˆ’
                          </span>
                          <span class="mord mtight">
                           1
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -3.113em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mtight">
                           â€²
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3053em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal">
                    e
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.8213em;">
                       <span class="" style="top: -3.113em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight">
                            m
                           </span>
                           <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.3281em;">
                               <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                <span class="pstrut" style="height: 2.5em;">
                                </span>
                                <span class="sizing reset-size3 size1 mtight">
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   i
                                  </span>
                                  <span class="mbin mtight">
                                   âˆ’
                                  </span>
                                  <span class="mord mtight">
                                   1
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               â€‹
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.2025em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="mbin mtight">
                           âˆ’
                          </span>
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight">
                            m
                           </span>
                           <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.3281em;">
                               <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                <span class="pstrut" style="height: 2.5em;">
                                </span>
                                <span class="sizing reset-size3 size1 mtight">
                                 <span class="mord mathnormal mtight">
                                  i
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               â€‹
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.143em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mspace" style="margin-right: 0.2222em;">
                  </span>
                  <span class="mbin">
                   +
                  </span>
                  <span class="mspace" style="margin-right: 0.2222em;">
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal">
                    e
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.8213em;">
                       <span class="" style="top: -3.113em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight">
                            x
                           </span>
                           <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.3281em;">
                               <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                <span class="pstrut" style="height: 2.5em;">
                                </span>
                                <span class="sizing reset-size3 size1 mtight">
                                 <span class="mord mathnormal mtight">
                                  i
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               â€‹
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.143em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="mbin mtight">
                           âˆ’
                          </span>
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight">
                            m
                           </span>
                           <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.3281em;">
                               <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                <span class="pstrut" style="height: 2.5em;">
                                </span>
                                <span class="sizing reset-size3 size1 mtight">
                                 <span class="mord mathnormal mtight">
                                  i
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               â€‹
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.143em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                â€‹
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 2.0257em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     <strong>
      end
     </strong>
    </p>
    <p>
     <strong>
      for
     </strong>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        i 
        
       
         â† 
        
       
         1 
        
       
         , 
        
       
         N 
        
       
      
        i\leftarrow 1,N
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6595em;">
         </span>
         <span class="mord mathnormal">
          i
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          â†
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.109em;">
          N
         </span>
        </span>
       </span>
      </span>
     </span>
     <strong>
      do
     </strong>
    </p>
    <p>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         a 
             
            
              i 
             
            
           
          
          
           
            
             
            
              â† 
             
             
              
              
                e 
               
               
                
                
                  x 
                 
                
                  i 
                 
                
               
                 âˆ’ 
                
                
                
                  m 
                 
                
                  N 
                 
                
               
              
              
              
                d 
               
              
                N 
               
              
                â€² 
               
              
             
            
           
          
          
          
         
         
          
          
           
            
            
              o 
             
            
              i 
             
            
           
          
          
           
            
             
            
              â† 
             
             
             
               o 
              
              
              
                i 
               
              
                âˆ’ 
               
              
                1 
               
              
             
            
              + 
             
             
             
               a 
              
             
               i 
              
             
            
              V 
             
            
              [ 
             
            
              i 
             
            
              , 
             
            
              : 
             
            
              ] 
             
            
           
          
          
          
         
        
       
         \begin{align} a_i &amp; \leftarrow \frac{e^{x_i-m_N}}{d^{\prime}_N} \\ \bm{o}_i &amp; \leftarrow \bm{o}_{i-1} + a_iV[i,:] \end{align}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 4.2279em; vertical-align: -1.8639em;">
          </span>
          <span class="mtable">
           <span class="col-align-r">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 2.3639em;">
               <span class="" style="top: -4.3639em;">
                <span class="pstrut" style="height: 3.4483em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  <span class="mord mathnormal">
                   a
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3117em;">
                      <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mathnormal mtight">
                         i
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.15em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -2.2444em;">
                <span class="pstrut" style="height: 3.4483em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  <span class="mord">
                   <span class="mord">
                    <span class="mord boldsymbol">
                     o
                    </span>
                   </span>
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3117em;">
                      <span class="" style="top: -2.55em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mathnormal mtight">
                         i
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.15em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 1.8639em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="col-align-l">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 2.3639em;">
               <span class="" style="top: -4.3639em;">
                <span class="pstrut" style="height: 3.4483em;">
                </span>
                <span class="mord">
                 <span class="mord">
                 </span>
                 <span class="mspace" style="margin-right: 0.2778em;">
                 </span>
                 <span class="mrel">
                  â†
                 </span>
                 <span class="mspace" style="margin-right: 0.2778em;">
                 </span>
                 <span class="mord">
                  <span class="mopen nulldelimiter">
                  </span>
                  <span class="mfrac">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 1.4483em;">
                      <span class="" style="top: -2.314em;">
                       <span class="pstrut" style="height: 3em;">
                       </span>
                       <span class="mord">
                        <span class="mord">
                         <span class="mord mathnormal">
                          d
                         </span>
                         <span class="msupsub">
                          <span class="vlist-t vlist-t2">
                           <span class="vlist-r">
                            <span class="vlist" style="height: 0.7337em;">
                             <span class="" style="top: -2.4065em; margin-left: 0em; margin-right: 0.05em;">
                              <span class="pstrut" style="height: 2.7em;">
                              </span>
                              <span class="sizing reset-size6 size3 mtight">
                               <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                                N
                               </span>
                              </span>
                             </span>
                             <span class="" style="top: -3.0448em; margin-right: 0.05em;">
                              <span class="pstrut" style="height: 2.7em;">
                              </span>
                              <span class="sizing reset-size6 size3 mtight">
                               <span class="mord mtight">
                                <span class="mord mtight">
                                 â€²
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                            <span class="vlist-s">
                             â€‹
                            </span>
                           </span>
                           <span class="vlist-r">
                            <span class="vlist" style="height: 0.2935em;">
                             <span class="">
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="" style="top: -3.23em;">
                       <span class="pstrut" style="height: 3em;">
                       </span>
                       <span class="frac-line" style="border-bottom-width: 0.04em;">
                       </span>
                      </span>
                      <span class="" style="top: -3.677em;">
                       <span class="pstrut" style="height: 3em;">
                       </span>
                       <span class="mord">
                        <span class="mord">
                         <span class="mord mathnormal">
                          e
                         </span>
                         <span class="msupsub">
                          <span class="vlist-t">
                           <span class="vlist-r">
                            <span class="vlist" style="height: 0.7713em;">
                             <span class="" style="top: -3.063em; margin-right: 0.05em;">
                              <span class="pstrut" style="height: 2.7em;">
                              </span>
                              <span class="sizing reset-size6 size3 mtight">
                               <span class="mord mtight">
                                <span class="mord mtight">
                                 <span class="mord mathnormal mtight">
                                  x
                                 </span>
                                 <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.3281em;">
                                     <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                      <span class="pstrut" style="height: 2.5em;">
                                      </span>
                                      <span class="sizing reset-size3 size1 mtight">
                                       <span class="mord mathnormal mtight">
                                        i
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                    <span class="vlist-s">
                                     â€‹
                                    </span>
                                   </span>
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.143em;">
                                     <span class="">
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                                <span class="mbin mtight">
                                 âˆ’
                                </span>
                                <span class="mord mtight">
                                 <span class="mord mathnormal mtight">
                                  m
                                 </span>
                                 <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.3448em;">
                                     <span class="" style="top: -2.3567em; margin-left: 0em; margin-right: 0.0714em;">
                                      <span class="pstrut" style="height: 2.5em;">
                                      </span>
                                      <span class="sizing reset-size3 size1 mtight">
                                       <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                                        N
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                    <span class="vlist-s">
                                     â€‹
                                    </span>
                                   </span>
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.1433em;">
                                     <span class="">
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.9795em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mclose nulldelimiter">
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -2.2444em;">
                <span class="pstrut" style="height: 3.4483em;">
                </span>
                <span class="mord">
                 <span class="mord">
                 </span>
                 <span class="mspace" style="margin-right: 0.2778em;">
                 </span>
                 <span class="mrel">
                  â†
                 </span>
                 <span class="mspace" style="margin-right: 0.2778em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                   <span class="mord">
                    <span class="mord boldsymbol">
                     o
                    </span>
                   </span>
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3117em;">
                      <span class="" style="top: -2.55em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mtight">
                         <span class="mord mathnormal mtight">
                          i
                         </span>
                         <span class="mbin mtight">
                          âˆ’
                         </span>
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.2083em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mspace" style="margin-right: 0.2222em;">
                 </span>
                 <span class="mbin">
                  +
                 </span>
                 <span class="mspace" style="margin-right: 0.2222em;">
                 </span>
                 <span class="mord">
                  <span class="mord mathnormal">
                   a
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3117em;">
                      <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mathnormal mtight">
                         i
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.15em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mord mathnormal" style="margin-right: 0.2222em;">
                  V
                 </span>
                 <span class="mopen">
                  [
                 </span>
                 <span class="mord mathnormal">
                  i
                 </span>
                 <span class="mpunct">
                  ,
                 </span>
                 <span class="mspace" style="margin-right: 0.2778em;">
                 </span>
                 <span class="mrel">
                  :
                 </span>
                 <span class="mclose">
                  ]
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 1.8639em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="tag">
          <span class="vlist-t vlist-t2">
           <span class="vlist-r">
            <span class="vlist" style="height: 2.3639em;">
             <span class="" style="top: -4.3639em;">
              <span class="pstrut" style="height: 3.4483em;">
              </span>
              <span class="eqn-num">
              </span>
             </span>
             <span class="" style="top: -2.2444em;">
              <span class="pstrut" style="height: 3.4483em;">
              </span>
              <span class="eqn-num">
              </span>
             </span>
            </span>
            <span class="vlist-s">
             â€‹
            </span>
           </span>
           <span class="vlist-r">
            <span class="vlist" style="height: 1.8639em;">
             <span class="">
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     <strong>
      end
     </strong>
    </p>
    <p>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         O 
         
        
          [ 
         
        
          k 
         
        
          , 
         
        
          : 
         
        
          ] 
         
        
          â† 
         
         
         
           o 
          
         
           N 
          
         
        
       
         O[k,:] \leftarrow \bm{o}_N
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           O
          </span>
          <span class="mopen">
           [
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0315em;">
           k
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           :
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mclose">
           ]
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           â†
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.5944em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord">
            <span class="mord">
             <span class="mord boldsymbol">
              o
             </span>
            </span>
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3283em;">
               <span class="" style="top: -2.55em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                  N
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     æˆ‘ä»¬å°†å…¬å¼ (12) ä¸­çš„
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        a 
         
        
          i 
         
        
       
      
        a_i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           a
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     æ›¿æ¢å…¬å¼ (11) ä¸­çš„å®šä¹‰ï¼Œæœ‰ï¼š
    </p>
    <p>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         o 
              
             
               i 
              
             
            
              : 
             
            
              = 
             
             
             
               âˆ‘ 
              
              
              
                j 
               
              
                = 
               
              
                1 
               
              
             
               i 
              
             
             
             
               ( 
              
              
               
               
                 e 
                
                
                 
                 
                   x 
                  
                 
                   j 
                  
                 
                
                  âˆ’ 
                 
                 
                 
                   m 
                  
                 
                   N 
                  
                 
                
               
               
               
                 d 
                
               
                 N 
                
               
                 â€² 
                
               
              
             
               V 
              
             
               [ 
              
             
               j 
              
             
               , 
              
             
               : 
              
             
               ] 
              
             
               ) 
              
             
            
           
          
          
          
         
        
       
         \begin{align} \bm{o}_i := \sum_{j=1}^i\left(\frac{e^{x_j-m_N}}{d_N^{\prime}}V[j,:]\right) \end{align}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 3.5254em; vertical-align: -1.5127em;">
          </span>
          <span class="mtable">
           <span class="col-align-r">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 2.0127em;">
               <span class="" style="top: -4.0127em;">
                <span class="pstrut" style="height: 3.8117em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  <span class="mord">
                   <span class="mord">
                    <span class="mord boldsymbol">
                     o
                    </span>
                   </span>
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3117em;">
                      <span class="" style="top: -2.55em; margin-right: 0.05em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mathnormal mtight">
                         i
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.15em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mspace" style="margin-right: 0.2778em;">
                 </span>
                 <span class="mrel">
                  :=
                 </span>
                 <span class="mspace" style="margin-right: 0.2778em;">
                 </span>
                 <span class="mop op-limits">
                  <span class="vlist-t vlist-t2">
                   <span class="vlist-r">
                    <span class="vlist" style="height: 1.8117em;">
                     <span class="" style="top: -1.8723em; margin-left: 0em;">
                      <span class="pstrut" style="height: 3.05em;">
                      </span>
                      <span class="sizing reset-size6 size3 mtight">
                       <span class="mord mtight">
                        <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                         j
                        </span>
                        <span class="mrel mtight">
                         =
                        </span>
                        <span class="mord mtight">
                         1
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="" style="top: -3.05em;">
                      <span class="pstrut" style="height: 3.05em;">
                      </span>
                      <span class="">
                       <span class="mop op-symbol large-op">
                        âˆ‘
                       </span>
                      </span>
                     </span>
                     <span class="" style="top: -4.3em; margin-left: 0em;">
                      <span class="pstrut" style="height: 3.05em;">
                      </span>
                      <span class="sizing reset-size6 size3 mtight">
                       <span class="mord mathnormal mtight">
                        i
                       </span>
                      </span>
                     </span>
                    </span>
                    <span class="vlist-s">
                     â€‹
                    </span>
                   </span>
                   <span class="vlist-r">
                    <span class="vlist" style="height: 1.4138em;">
                     <span class="">
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mspace" style="margin-right: 0.1667em;">
                 </span>
                 <span class="minner">
                  <span class="mopen delimcenter" style="top: 0em;">
                   <span class="delimsizing size3">
                    (
                   </span>
                  </span>
                  <span class="mord">
                   <span class="mopen nulldelimiter">
                   </span>
                   <span class="mfrac">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 1.4483em;">
                       <span class="" style="top: -2.314em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="mord">
                         <span class="mord">
                          <span class="mord mathnormal">
                           d
                          </span>
                          <span class="msupsub">
                           <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.7337em;">
                              <span class="" style="top: -2.4065em; margin-left: 0em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                                 N
                                </span>
                               </span>
                              </span>
                              <span class="" style="top: -3.0448em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mtight">
                                  â€²
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="vlist-s">
                              â€‹
                             </span>
                            </span>
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.2935em;">
                              <span class="">
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -3.23em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="frac-line" style="border-bottom-width: 0.04em;">
                        </span>
                       </span>
                       <span class="" style="top: -3.677em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="mord">
                         <span class="mord">
                          <span class="mord mathnormal">
                           e
                          </span>
                          <span class="msupsub">
                           <span class="vlist-t">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.7713em;">
                              <span class="" style="top: -3.063em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   x
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.3281em;">
                                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                       <span class="pstrut" style="height: 2.5em;">
                                       </span>
                                       <span class="sizing reset-size3 size1 mtight">
                                        <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                                         j
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="vlist-s">
                                      â€‹
                                     </span>
                                    </span>
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.2819em;">
                                      <span class="">
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                 <span class="mbin mtight">
                                  âˆ’
                                 </span>
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   m
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.3448em;">
                                      <span class="" style="top: -2.3567em; margin-left: 0em; margin-right: 0.0714em;">
                                       <span class="pstrut" style="height: 2.5em;">
                                       </span>
                                       <span class="sizing reset-size3 size1 mtight">
                                        <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                                         N
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="vlist-s">
                                      â€‹
                                     </span>
                                    </span>
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.1433em;">
                                      <span class="">
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.9795em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mclose nulldelimiter">
                   </span>
                  </span>
                  <span class="mord mathnormal" style="margin-right: 0.2222em;">
                   V
                  </span>
                  <span class="mopen">
                   [
                  </span>
                  <span class="mord mathnormal" style="margin-right: 0.0572em;">
                   j
                  </span>
                  <span class="mpunct">
                   ,
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mrel">
                   :
                  </span>
                  <span class="mclose">
                   ]
                  </span>
                  <span class="mclose delimcenter" style="top: 0em;">
                   <span class="delimsizing size3">
                    )
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 1.5127em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="tag">
          <span class="vlist-t vlist-t2">
           <span class="vlist-r">
            <span class="vlist" style="height: 2.0127em;">
             <span class="" style="top: -4.0127em;">
              <span class="pstrut" style="height: 3.8117em;">
              </span>
              <span class="eqn-num">
              </span>
             </span>
            </span>
            <span class="vlist-s">
             â€‹
            </span>
           </span>
           <span class="vlist-r">
            <span class="vlist" style="height: 1.5127em;">
             <span class="">
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     è¯¥å…¬å¼ä»ç„¶ä¾èµ–
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        m 
         
        
          N 
         
        
       
      
        m_N
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           m
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3283em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                 N
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     å’Œ
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
         
        
          N 
         
        
       
      
        d_N
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8444em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           d
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3283em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                 N
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     å˜é‡ï¼Œè¿™ä¸¤ä¸ªå€¼åœ¨å‰ä¸€ä¸ªå¾ªç¯å®Œæˆä¹‹å‰æ— æ³•ç¡®å®šã€‚ä½†æˆ‘ä»¬å¯ä»¥å†æ¬¡ä½¿ç”¨ç¬¬ 3 èŠ‚ä¸­çš„æ›¿ä»£æŠ€å·§ï¼Œå³åˆ›å»ºæ›¿ä»£åºåˆ—
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        o 
         
        
          â€² 
         
        
       
      
        \bm{o}^{\prime}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7519em;">
         </span>
         <span class="mord">
          <span class="mord">
           <span class="mord">
            <span class="mord boldsymbol">
             o
            </span>
           </span>
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7519em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  â€²
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ï¼š
    </p>
    <p>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         o 
          
         
           i 
          
         
           â€² 
          
         
        
          : 
         
        
          = 
         
         
         
           ( 
          
          
          
            âˆ‘ 
           
           
           
             j 
            
           
             = 
            
           
             1 
            
           
          
            i 
           
          
          
           
           
             e 
            
            
             
             
               x 
              
             
               j 
              
             
            
              âˆ’ 
             
             
             
               m 
              
             
               i 
              
             
            
           
           
           
             d 
            
           
             i 
            
           
             â€² 
            
           
          
         
           V 
          
         
           [ 
          
         
           j 
          
         
           , 
          
         
           : 
          
         
           ] 
          
         
           ) 
          
         
        
       
         \bm{o}_i^{\prime}:=\left(\sum_{j=1}^i\frac{e^{x_j-m_i}}{d_i^{\prime}}V[j,:]\right)
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1.0489em; vertical-align: -0.247em;">
          </span>
          <span class="mord">
           <span class="mord">
            <span class="mord">
             <span class="mord boldsymbol">
              o
             </span>
            </span>
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.8019em;">
               <span class="" style="top: -2.453em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.113em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   â€²
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.247em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           :=
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 3.2254em; vertical-align: -1.4138em;">
          </span>
          <span class="minner">
           <span class="mopen delimcenter" style="top: 0em;">
            <span class="delimsizing size4">
             (
            </span>
           </span>
           <span class="mop op-limits">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.8117em;">
               <span class="" style="top: -1.8723em; margin-left: 0em;">
                <span class="pstrut" style="height: 3.05em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                   j
                  </span>
                  <span class="mrel mtight">
                   =
                  </span>
                  <span class="mord mtight">
                   1
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.05em;">
                <span class="pstrut" style="height: 3.05em;">
                </span>
                <span class="">
                 <span class="mop op-symbol large-op">
                  âˆ‘
                 </span>
                </span>
               </span>
               <span class="" style="top: -4.3em; margin-left: 0em;">
                <span class="pstrut" style="height: 3.05em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 1.4138em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mspace" style="margin-right: 0.1667em;">
           </span>
           <span class="mord">
            <span class="mopen nulldelimiter">
            </span>
            <span class="mfrac">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 1.4483em;">
                <span class="" style="top: -2.314em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                   <span class="mord mathnormal">
                    d
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.7337em;">
                       <span class="" style="top: -2.4231em; margin-left: 0em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mathnormal mtight">
                          i
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -3.0448em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mtight">
                           â€²
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.2769em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="" style="top: -3.23em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="frac-line" style="border-bottom-width: 0.04em;">
                 </span>
                </span>
                <span class="" style="top: -3.677em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                   <span class="mord mathnormal">
                    e
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.7713em;">
                       <span class="" style="top: -3.063em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight">
                            x
                           </span>
                           <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.3281em;">
                               <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                <span class="pstrut" style="height: 2.5em;">
                                </span>
                                <span class="sizing reset-size3 size1 mtight">
                                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                                  j
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               â€‹
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.2819em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="mbin mtight">
                           âˆ’
                          </span>
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight">
                            m
                           </span>
                           <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.3281em;">
                               <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                <span class="pstrut" style="height: 2.5em;">
                                </span>
                                <span class="sizing reset-size3 size1 mtight">
                                 <span class="mord mathnormal mtight">
                                  i
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               â€‹
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.143em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                â€‹
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 0.9629em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="mclose nulldelimiter">
            </span>
           </span>
           <span class="mord mathnormal" style="margin-right: 0.2222em;">
            V
           </span>
           <span class="mopen">
            [
           </span>
           <span class="mord mathnormal" style="margin-right: 0.0572em;">
            j
           </span>
           <span class="mpunct">
            ,
           </span>
           <span class="mspace" style="margin-right: 0.2778em;">
           </span>
           <span class="mrel">
            :
           </span>
           <span class="mclose">
            ]
           </span>
           <span class="mclose delimcenter" style="top: 0em;">
            <span class="delimsizing size4">
             )
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        o 
        
       
      
        \bm{o}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4444em;">
         </span>
         <span class="mord">
          <span class="mord">
           <span class="mord boldsymbol">
            o
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     å’Œ
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        o 
         
        
          â€² 
         
        
       
      
        \bm{o}^{\prime}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7519em;">
         </span>
         <span class="mord">
          <span class="mord">
           <span class="mord">
            <span class="mord boldsymbol">
             o
            </span>
           </span>
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7519em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  â€²
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     çš„ç¬¬
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        N 
        
       
      
        N
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.109em;">
          N
         </span>
        </span>
       </span>
      </span>
     </span>
     ä¸ªå…ƒç´ ç›¸åŒå³
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        o 
         
        
          N 
         
        
          â€² 
         
        
       
         = 
        
        
        
          o 
         
        
          N 
         
        
       
      
        \bm{o}^{\prime}_N=\bm{o}_N
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.0272em; vertical-align: -0.2753em;">
         </span>
         <span class="mord">
          <span class="mord">
           <span class="mord">
            <span class="mord boldsymbol">
             o
            </span>
           </span>
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7519em;">
              <span class="" style="top: -2.4247em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                 N
                </span>
               </span>
              </span>
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  â€²
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2753em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.5944em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord">
           <span class="mord">
            <span class="mord boldsymbol">
             o
            </span>
           </span>
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3283em;">
              <span class="" style="top: -2.55em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                 N
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥å‘ç°
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        o 
         
        
          i 
         
        
          â€² 
         
        
       
      
        \bm{o}^{\prime}_i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.0106em; vertical-align: -0.2587em;">
         </span>
         <span class="mord">
          <span class="mord">
           <span class="mord">
            <span class="mord boldsymbol">
             o
            </span>
           </span>
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7519em;">
              <span class="" style="top: -2.4413em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  â€²
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2587em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     å’Œ
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        o 
         
         
         
           i 
          
         
           âˆ’ 
          
         
           1 
          
         
        
          â€² 
         
        
       
      
        \bm{o}^{\prime}_{i-1}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.0689em; vertical-align: -0.317em;">
         </span>
         <span class="mord">
          <span class="mord">
           <span class="mord">
            <span class="mord boldsymbol">
             o
            </span>
           </span>
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7519em;">
              <span class="" style="top: -2.4413em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mbin mtight">
                  âˆ’
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  â€²
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.317em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ä¹‹é—´å­˜åœ¨å¦‚ä¸‹çš„é€’å½’å…³ç³»ï¼š
    </p>
    <p>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         o 
                 
                
                  i 
                 
                
                  â€² 
                 
                
               
              
              
               
                
                 
                
                  = 
                 
                 
                 
                   âˆ‘ 
                  
                  
                  
                    j 
                   
                  
                    = 
                   
                  
                    1 
                   
                  
                 
                   i 
                  
                 
                 
                  
                  
                    e 
                   
                   
                    
                    
                      x 
                     
                    
                      j 
                     
                    
                   
                     âˆ’ 
                    
                    
                    
                      m 
                     
                    
                      i 
                     
                    
                   
                  
                  
                  
                    d 
                   
                  
                    i 
                   
                  
                    â€² 
                   
                  
                 
                
                  V 
                 
                
                  [ 
                 
                
                  j 
                 
                
                  , 
                 
                
                  : 
                 
                
                  ] 
                 
                
               
              
             
             
              
               
                
               
              
              
               
                
                 
                
                  = 
                 
                 
                 
                   ( 
                  
                  
                  
                    âˆ‘ 
                   
                   
                   
                     j 
                    
                   
                     = 
                    
                   
                     1 
                    
                   
                   
                   
                     i 
                    
                   
                     âˆ’ 
                    
                   
                     1 
                    
                   
                  
                  
                   
                   
                     e 
                    
                    
                     
                     
                       x 
                      
                     
                       j 
                      
                     
                    
                      âˆ’ 
                     
                     
                     
                       m 
                      
                     
                       i 
                      
                     
                    
                   
                   
                   
                     d 
                    
                   
                     i 
                    
                   
                     â€² 
                    
                   
                  
                 
                   V 
                  
                 
                   [ 
                  
                 
                   j 
                  
                 
                   , 
                  
                 
                   : 
                  
                 
                   ] 
                  
                 
                   ) 
                  
                 
                
                  + 
                 
                 
                  
                  
                    e 
                   
                   
                    
                    
                      x 
                     
                    
                      i 
                     
                    
                   
                     âˆ’ 
                    
                    
                    
                      m 
                     
                    
                      i 
                     
                    
                   
                  
                  
                  
                    d 
                   
                  
                    i 
                   
                  
                    â€² 
                   
                  
                 
                
                  V 
                 
                
                  [ 
                 
                
                  i 
                 
                
                  , 
                 
                
                  : 
                 
                
                  ] 
                 
                
               
              
             
             
              
               
                
               
              
              
               
                
                 
                
                  = 
                 
                 
                 
                   ( 
                  
                  
                  
                    âˆ‘ 
                   
                   
                   
                     j 
                    
                   
                     = 
                    
                   
                     1 
                    
                   
                   
                   
                     i 
                    
                   
                     âˆ’ 
                    
                   
                     1 
                    
                   
                  
                  
                   
                   
                     e 
                    
                    
                     
                     
                       x 
                      
                     
                       j 
                      
                     
                    
                      âˆ’ 
                     
                     
                     
                       m 
                      
                      
                      
                        i 
                       
                      
                        âˆ’ 
                       
                      
                        1 
                       
                      
                     
                    
                   
                   
                   
                     d 
                    
                    
                    
                      i 
                     
                    
                      âˆ’ 
                     
                    
                      1 
                     
                    
                   
                     â€² 
                    
                   
                  
                  
                   
                   
                     e 
                    
                    
                     
                     
                       x 
                      
                     
                       j 
                      
                     
                    
                      âˆ’ 
                     
                     
                     
                       m 
                      
                     
                       i 
                      
                     
                    
                   
                   
                   
                     e 
                    
                    
                     
                     
                       x 
                      
                     
                       j 
                      
                     
                    
                      âˆ’ 
                     
                     
                     
                       m 
                      
                      
                      
                        i 
                       
                      
                        âˆ’ 
                       
                      
                        1 
                       
                      
                     
                    
                   
                  
                  
                   
                   
                     d 
                    
                    
                    
                      i 
                     
                    
                      âˆ’ 
                     
                    
                      1 
                     
                    
                   
                     â€² 
                    
                   
                   
                   
                     d 
                    
                   
                     i 
                    
                   
                     â€² 
                    
                   
                  
                 
                   V 
                  
                 
                   [ 
                  
                 
                   j 
                  
                 
                   , 
                  
                 
                   : 
                  
                 
                   ] 
                  
                 
                   ) 
                  
                 
                
                  + 
                 
                 
                  
                  
                    e 
                   
                   
                    
                    
                      x 
                     
                    
                      i 
                     
                    
                   
                     âˆ’ 
                    
                    
                    
                      m 
                     
                    
                      i 
                     
                    
                   
                  
                  
                  
                    d 
                   
                  
                    i 
                   
                  
                    â€² 
                   
                  
                 
                
                  V 
                 
                
                  [ 
                 
                
                  i 
                 
                
                  , 
                 
                
                  : 
                 
                
                  ] 
                 
                
               
              
             
             
              
               
                
               
              
              
               
                
                 
                
                  = 
                 
                 
                 
                   ( 
                  
                  
                  
                    âˆ‘ 
                   
                   
                   
                     j 
                    
                   
                     = 
                    
                   
                     1 
                    
                   
                   
                   
                     i 
                    
                   
                     âˆ’ 
                    
                   
                     1 
                    
                   
                  
                  
                   
                   
                     e 
                    
                    
                     
                     
                       x 
                      
                     
                       j 
                      
                     
                    
                      âˆ’ 
                     
                     
                     
                       m 
                      
                      
                      
                        i 
                       
                      
                        âˆ’ 
                       
                      
                        1 
                       
                      
                     
                    
                   
                   
                   
                     d 
                    
                    
                    
                      i 
                     
                    
                      âˆ’ 
                     
                    
                      1 
                     
                    
                   
                     â€² 
                    
                   
                  
                 
                   V 
                  
                 
                   [ 
                  
                 
                   j 
                  
                 
                   , 
                  
                 
                   : 
                  
                 
                   ] 
                  
                 
                   ) 
                  
                 
                 
                  
                  
                    d 
                   
                   
                   
                     i 
                    
                   
                     âˆ’ 
                    
                   
                     1 
                    
                   
                  
                    â€² 
                   
                  
                  
                  
                    d 
                   
                  
                    i 
                   
                  
                    â€² 
                   
                  
                 
                 
                 
                   e 
                  
                  
                   
                   
                     m 
                    
                    
                    
                      i 
                     
                    
                      âˆ’ 
                     
                    
                      1 
                     
                    
                   
                  
                    âˆ’ 
                   
                   
                   
                     m 
                    
                   
                     i 
                    
                   
                  
                 
                
                  + 
                 
                 
                  
                  
                    e 
                   
                   
                    
                    
                      x 
                     
                    
                      i 
                     
                    
                   
                     âˆ’ 
                    
                    
                    
                      m 
                     
                    
                      i 
                     
                    
                   
                  
                  
                  
                    d 
                   
                  
                    i 
                   
                  
                    â€² 
                   
                  
                 
                
                  V 
                 
                
                  [ 
                 
                
                  i 
                 
                
                  , 
                 
                
                  : 
                 
                
                  ] 
                 
                
               
              
             
             
              
               
                
               
              
              
               
                
                 
                
                  = 
                 
                 
                 
                   o 
                  
                  
                  
                    i 
                   
                  
                    âˆ’ 
                   
                  
                    1 
                   
                  
                 
                   â€² 
                  
                 
                 
                  
                   
                   
                     d 
                    
                    
                    
                      i 
                     
                    
                      âˆ’ 
                     
                    
                      1 
                     
                    
                   
                     â€² 
                    
                   
                   
                   
                     e 
                    
                    
                     
                     
                       m 
                      
                      
                      
                        i 
                       
                      
                        âˆ’ 
                       
                      
                        1 
                       
                      
                     
                    
                      âˆ’ 
                     
                     
                     
                       m 
                      
                     
                       i 
                      
                     
                    
                   
                  
                  
                  
                    d 
                   
                  
                    i 
                   
                  
                    â€² 
                   
                  
                 
                
                  + 
                 
                 
                  
                  
                    e 
                   
                   
                    
                    
                      x 
                     
                    
                      i 
                     
                    
                   
                     âˆ’ 
                    
                    
                    
                      m 
                     
                    
                      i 
                     
                    
                   
                  
                  
                  
                    d 
                   
                  
                    i 
                   
                  
                    â€² 
                   
                  
                 
                
                  V 
                 
                
                  [ 
                 
                
                  i 
                 
                
                  , 
                 
                
                  : 
                 
                
                  ] 
                 
                
               
              
             
            
           
          
          
          
         
        
       
         \begin{equation} \begin{aligned} \bm{o}^{\prime}_{i}&amp; = \sum_{j=1}^{i} \frac{e^{x_{j}-m_{i}}}{d^{\prime}_{i}}V[j, : ]\\ &amp; = \left(\sum_{j=1}^{i-1}\frac{e^{x_{j}-m_{i}}}{d^{\prime}_{i} }V[j, : ]\right) + \frac{e^{x_{i}-m_{i}}}{d^{\prime}_{i}}V[i, : ]\\ &amp; = \left(\sum_{j=1}^{i-1}\frac{e^{x_{j}-m_{i-1}}}{d^{\prime}_{ i-1}}\frac{e^{x_{j}-m_{i}}}{e^{x_{j}-m_{i-1}}}\frac{d^{\prime}_{i-1}}{d^{ \prime}_{i}}V[j, : ]\right) + \frac{e^{x_{i}-m_{i}}}{d^{\prime}_{i}}V[i, : ]\\ &amp; = \left(\sum_{j=1}^{i-1}\frac{e^{x_{j}-m_{i-1}}}{d^{\prime}_{ i-1}}V[j, : ]\right) \frac{d^{\prime}_{i-1}}{d^{\prime}_{i}}e^{m_{i-1}-m_{i}} + \frac{e^{x_{i}-m_{i}}}{d^{\prime}_{i}}V[i, : ]\\ &amp; = \bm{o}^{\prime}_{i-1}\frac{d^{\prime}_{i-1} e^{m_{i-1}-m_{ i}}}{d^{\prime}_{i}} + \frac{e^{x_{i}-m_{i}}}{d^{\prime}_{i}}V[i, : ] \end{aligned} \end{equation}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 16.843em; vertical-align: -8.1715em;">
          </span>
          <span class="mtable">
           <span class="col-align-c">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 8.6715em;">
               <span class="" style="top: -10.6715em;">
                <span class="pstrut" style="height: 10.6715em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  <span class="mtable">
                   <span class="col-align-r">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 8.6715em;">
                       <span class="" style="top: -10.6715em;">
                        <span class="pstrut" style="height: 3.8117em;">
                        </span>
                        <span class="mord">
                         <span class="mord">
                          <span class="mord">
                           <span class="mord">
                            <span class="mord boldsymbol">
                             o
                            </span>
                           </span>
                          </span>
                          <span class="msupsub">
                           <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.8019em;">
                              <span class="" style="top: -2.453em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mathnormal mtight">
                                  i
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="" style="top: -3.113em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mtight">
                                  â€²
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="vlist-s">
                              â€‹
                             </span>
                            </span>
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.247em;">
                              <span class="">
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -7.146em;">
                        <span class="pstrut" style="height: 3.8117em;">
                        </span>
                        <span class="mord">
                        </span>
                       </span>
                       <span class="" style="top: -3.6206em;">
                        <span class="pstrut" style="height: 3.8117em;">
                        </span>
                        <span class="mord">
                        </span>
                       </span>
                       <span class="" style="top: -0.0951em;">
                        <span class="pstrut" style="height: 3.8117em;">
                        </span>
                        <span class="mord">
                        </span>
                       </span>
                       <span class="" style="top: 3.097em;">
                        <span class="pstrut" style="height: 3.8117em;">
                        </span>
                        <span class="mord">
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 8.1715em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="col-align-l">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 8.6715em;">
                       <span class="" style="top: -10.6715em;">
                        <span class="pstrut" style="height: 3.8117em;">
                        </span>
                        <span class="mord">
                         <span class="mord">
                         </span>
                         <span class="mspace" style="margin-right: 0.2778em;">
                         </span>
                         <span class="mrel">
                          =
                         </span>
                         <span class="mspace" style="margin-right: 0.2778em;">
                         </span>
                         <span class="mop op-limits">
                          <span class="vlist-t vlist-t2">
                           <span class="vlist-r">
                            <span class="vlist" style="height: 1.8117em;">
                             <span class="" style="top: -1.8723em; margin-left: 0em;">
                              <span class="pstrut" style="height: 3.05em;">
                              </span>
                              <span class="sizing reset-size6 size3 mtight">
                               <span class="mord mtight">
                                <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                                 j
                                </span>
                                <span class="mrel mtight">
                                 =
                                </span>
                                <span class="mord mtight">
                                 1
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="" style="top: -3.05em;">
                              <span class="pstrut" style="height: 3.05em;">
                              </span>
                              <span class="">
                               <span class="mop op-symbol large-op">
                                âˆ‘
                               </span>
                              </span>
                             </span>
                             <span class="" style="top: -4.3em; margin-left: 0em;">
                              <span class="pstrut" style="height: 3.05em;">
                              </span>
                              <span class="sizing reset-size6 size3 mtight">
                               <span class="mord mtight">
                                <span class="mord mathnormal mtight">
                                 i
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                            <span class="vlist-s">
                             â€‹
                            </span>
                           </span>
                           <span class="vlist-r">
                            <span class="vlist" style="height: 1.4138em;">
                             <span class="">
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                         <span class="mspace" style="margin-right: 0.1667em;">
                         </span>
                         <span class="mord">
                          <span class="mopen nulldelimiter">
                          </span>
                          <span class="mfrac">
                           <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 1.4483em;">
                              <span class="" style="top: -2.314em;">
                               <span class="pstrut" style="height: 3em;">
                               </span>
                               <span class="mord">
                                <span class="mord">
                                 <span class="mord mathnormal">
                                  d
                                 </span>
                                 <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.7337em;">
                                     <span class="" style="top: -2.4231em; margin-left: 0em; margin-right: 0.05em;">
                                      <span class="pstrut" style="height: 2.7em;">
                                      </span>
                                      <span class="sizing reset-size6 size3 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mathnormal mtight">
                                         i
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="" style="top: -3.0448em; margin-right: 0.05em;">
                                      <span class="pstrut" style="height: 2.7em;">
                                      </span>
                                      <span class="sizing reset-size6 size3 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mtight">
                                         â€²
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                    <span class="vlist-s">
                                     â€‹
                                    </span>
                                   </span>
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.2769em;">
                                     <span class="">
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="" style="top: -3.23em;">
                               <span class="pstrut" style="height: 3em;">
                               </span>
                               <span class="frac-line" style="border-bottom-width: 0.04em;">
                               </span>
                              </span>
                              <span class="" style="top: -3.677em;">
                               <span class="pstrut" style="height: 3em;">
                               </span>
                               <span class="mord">
                                <span class="mord">
                                 <span class="mord mathnormal">
                                  e
                                 </span>
                                 <span class="msupsub">
                                  <span class="vlist-t">
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.7713em;">
                                     <span class="" style="top: -3.063em; margin-right: 0.05em;">
                                      <span class="pstrut" style="height: 2.7em;">
                                      </span>
                                      <span class="sizing reset-size6 size3 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mtight">
                                         <span class="mord mathnormal mtight">
                                          x
                                         </span>
                                         <span class="msupsub">
                                          <span class="vlist-t vlist-t2">
                                           <span class="vlist-r">
                                            <span class="vlist" style="height: 0.3281em;">
                                             <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                              <span class="pstrut" style="height: 2.5em;">
                                              </span>
                                              <span class="sizing reset-size3 size1 mtight">
                                               <span class="mord mtight">
                                                <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                                                 j
                                                </span>
                                               </span>
                                              </span>
                                             </span>
                                            </span>
                                            <span class="vlist-s">
                                             â€‹
                                            </span>
                                           </span>
                                           <span class="vlist-r">
                                            <span class="vlist" style="height: 0.2819em;">
                                             <span class="">
                                             </span>
                                            </span>
                                           </span>
                                          </span>
                                         </span>
                                        </span>
                                        <span class="mbin mtight">
                                         âˆ’
                                        </span>
                                        <span class="mord mtight">
                                         <span class="mord mathnormal mtight">
                                          m
                                         </span>
                                         <span class="msupsub">
                                          <span class="vlist-t vlist-t2">
                                           <span class="vlist-r">
                                            <span class="vlist" style="height: 0.3281em;">
                                             <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                              <span class="pstrut" style="height: 2.5em;">
                                              </span>
                                              <span class="sizing reset-size3 size1 mtight">
                                               <span class="mord mtight">
                                                <span class="mord mathnormal mtight">
                                                 i
                                                </span>
                                               </span>
                                              </span>
                                             </span>
                                            </span>
                                            <span class="vlist-s">
                                             â€‹
                                            </span>
                                           </span>
                                           <span class="vlist-r">
                                            <span class="vlist" style="height: 0.143em;">
                                             <span class="">
                                             </span>
                                            </span>
                                           </span>
                                          </span>
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="vlist-s">
                              â€‹
                             </span>
                            </span>
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.9629em;">
                              <span class="">
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="mclose nulldelimiter">
                          </span>
                         </span>
                         <span class="mord mathnormal" style="margin-right: 0.2222em;">
                          V
                         </span>
                         <span class="mopen">
                          [
                         </span>
                         <span class="mord mathnormal" style="margin-right: 0.0572em;">
                          j
                         </span>
                         <span class="mpunct">
                          ,
                         </span>
                         <span class="mspace" style="margin-right: 0.2778em;">
                         </span>
                         <span class="mrel">
                          :
                         </span>
                         <span class="mclose">
                          ]
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -7.146em;">
                        <span class="pstrut" style="height: 3.8117em;">
                        </span>
                        <span class="mord">
                         <span class="mord">
                         </span>
                         <span class="mspace" style="margin-right: 0.2778em;">
                         </span>
                         <span class="mrel">
                          =
                         </span>
                         <span class="mspace" style="margin-right: 0.2778em;">
                         </span>
                         <span class="minner">
                          <span class="mopen delimcenter" style="top: 0em;">
                           <span class="delimsizing size4">
                            (
                           </span>
                          </span>
                          <span class="mop op-limits">
                           <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 1.8117em;">
                              <span class="" style="top: -1.8723em; margin-left: 0em;">
                               <span class="pstrut" style="height: 3.05em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                                  j
                                 </span>
                                 <span class="mrel mtight">
                                  =
                                 </span>
                                 <span class="mord mtight">
                                  1
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="" style="top: -3.05em;">
                               <span class="pstrut" style="height: 3.05em;">
                               </span>
                               <span class="">
                                <span class="mop op-symbol large-op">
                                 âˆ‘
                                </span>
                               </span>
                              </span>
                              <span class="" style="top: -4.3em; margin-left: 0em;">
                               <span class="pstrut" style="height: 3.05em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mathnormal mtight">
                                  i
                                 </span>
                                 <span class="mbin mtight">
                                  âˆ’
                                 </span>
                                 <span class="mord mtight">
                                  1
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="vlist-s">
                              â€‹
                             </span>
                            </span>
                            <span class="vlist-r">
                             <span class="vlist" style="height: 1.4138em;">
                              <span class="">
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="mspace" style="margin-right: 0.1667em;">
                          </span>
                          <span class="mord">
                           <span class="mopen nulldelimiter">
                           </span>
                           <span class="mfrac">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 1.4483em;">
                               <span class="" style="top: -2.314em;">
                                <span class="pstrut" style="height: 3em;">
                                </span>
                                <span class="mord">
                                 <span class="mord">
                                  <span class="mord mathnormal">
                                   d
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.7337em;">
                                      <span class="" style="top: -2.4231em; margin-left: 0em; margin-right: 0.05em;">
                                       <span class="pstrut" style="height: 2.7em;">
                                       </span>
                                       <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                         <span class="mord mathnormal mtight">
                                          i
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                      <span class="" style="top: -3.0448em; margin-right: 0.05em;">
                                       <span class="pstrut" style="height: 2.7em;">
                                       </span>
                                       <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                         <span class="mord mtight">
                                          â€²
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="vlist-s">
                                      â€‹
                                     </span>
                                    </span>
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.2769em;">
                                      <span class="">
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                               <span class="" style="top: -3.23em;">
                                <span class="pstrut" style="height: 3em;">
                                </span>
                                <span class="frac-line" style="border-bottom-width: 0.04em;">
                                </span>
                               </span>
                               <span class="" style="top: -3.677em;">
                                <span class="pstrut" style="height: 3em;">
                                </span>
                                <span class="mord">
                                 <span class="mord">
                                  <span class="mord mathnormal">
                                   e
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.7713em;">
                                      <span class="" style="top: -3.063em; margin-right: 0.05em;">
                                       <span class="pstrut" style="height: 2.7em;">
                                       </span>
                                       <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                         <span class="mord mtight">
                                          <span class="mord mathnormal mtight">
                                           x
                                          </span>
                                          <span class="msupsub">
                                           <span class="vlist-t vlist-t2">
                                            <span class="vlist-r">
                                             <span class="vlist" style="height: 0.3281em;">
                                              <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                               <span class="pstrut" style="height: 2.5em;">
                                               </span>
                                               <span class="sizing reset-size3 size1 mtight">
                                                <span class="mord mtight">
                                                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                                                  j
                                                 </span>
                                                </span>
                                               </span>
                                              </span>
                                             </span>
                                             <span class="vlist-s">
                                              â€‹
                                             </span>
                                            </span>
                                            <span class="vlist-r">
                                             <span class="vlist" style="height: 0.2819em;">
                                              <span class="">
                                              </span>
                                             </span>
                                            </span>
                                           </span>
                                          </span>
                                         </span>
                                         <span class="mbin mtight">
                                          âˆ’
                                         </span>
                                         <span class="mord mtight">
                                          <span class="mord mathnormal mtight">
                                           m
                                          </span>
                                          <span class="msupsub">
                                           <span class="vlist-t vlist-t2">
                                            <span class="vlist-r">
                                             <span class="vlist" style="height: 0.3281em;">
                                              <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                               <span class="pstrut" style="height: 2.5em;">
                                               </span>
                                               <span class="sizing reset-size3 size1 mtight">
                                                <span class="mord mtight">
                                                 <span class="mord mathnormal mtight">
                                                  i
                                                 </span>
                                                </span>
                                               </span>
                                              </span>
                                             </span>
                                             <span class="vlist-s">
                                              â€‹
                                             </span>
                                            </span>
                                            <span class="vlist-r">
                                             <span class="vlist" style="height: 0.143em;">
                                              <span class="">
                                              </span>
                                             </span>
                                            </span>
                                           </span>
                                          </span>
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               â€‹
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.9629em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                           <span class="mclose nulldelimiter">
                           </span>
                          </span>
                          <span class="mord mathnormal" style="margin-right: 0.2222em;">
                           V
                          </span>
                          <span class="mopen">
                           [
                          </span>
                          <span class="mord mathnormal" style="margin-right: 0.0572em;">
                           j
                          </span>
                          <span class="mpunct">
                           ,
                          </span>
                          <span class="mspace" style="margin-right: 0.2778em;">
                          </span>
                          <span class="mrel">
                           :
                          </span>
                          <span class="mclose">
                           ]
                          </span>
                          <span class="mclose delimcenter" style="top: 0em;">
                           <span class="delimsizing size4">
                            )
                           </span>
                          </span>
                         </span>
                         <span class="mspace" style="margin-right: 0.2222em;">
                         </span>
                         <span class="mbin">
                          +
                         </span>
                         <span class="mspace" style="margin-right: 0.2222em;">
                         </span>
                         <span class="mord">
                          <span class="mopen nulldelimiter">
                          </span>
                          <span class="mfrac">
                           <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 1.4483em;">
                              <span class="" style="top: -2.314em;">
                               <span class="pstrut" style="height: 3em;">
                               </span>
                               <span class="mord">
                                <span class="mord">
                                 <span class="mord mathnormal">
                                  d
                                 </span>
                                 <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.7337em;">
                                     <span class="" style="top: -2.4231em; margin-left: 0em; margin-right: 0.05em;">
                                      <span class="pstrut" style="height: 2.7em;">
                                      </span>
                                      <span class="sizing reset-size6 size3 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mathnormal mtight">
                                         i
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="" style="top: -3.0448em; margin-right: 0.05em;">
                                      <span class="pstrut" style="height: 2.7em;">
                                      </span>
                                      <span class="sizing reset-size6 size3 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mtight">
                                         â€²
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                    <span class="vlist-s">
                                     â€‹
                                    </span>
                                   </span>
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.2769em;">
                                     <span class="">
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="" style="top: -3.23em;">
                               <span class="pstrut" style="height: 3em;">
                               </span>
                               <span class="frac-line" style="border-bottom-width: 0.04em;">
                               </span>
                              </span>
                              <span class="" style="top: -3.677em;">
                               <span class="pstrut" style="height: 3em;">
                               </span>
                               <span class="mord">
                                <span class="mord">
                                 <span class="mord mathnormal">
                                  e
                                 </span>
                                 <span class="msupsub">
                                  <span class="vlist-t">
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.7713em;">
                                     <span class="" style="top: -3.063em; margin-right: 0.05em;">
                                      <span class="pstrut" style="height: 2.7em;">
                                      </span>
                                      <span class="sizing reset-size6 size3 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mtight">
                                         <span class="mord mathnormal mtight">
                                          x
                                         </span>
                                         <span class="msupsub">
                                          <span class="vlist-t vlist-t2">
                                           <span class="vlist-r">
                                            <span class="vlist" style="height: 0.3281em;">
                                             <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                              <span class="pstrut" style="height: 2.5em;">
                                              </span>
                                              <span class="sizing reset-size3 size1 mtight">
                                               <span class="mord mtight">
                                                <span class="mord mathnormal mtight">
                                                 i
                                                </span>
                                               </span>
                                              </span>
                                             </span>
                                            </span>
                                            <span class="vlist-s">
                                             â€‹
                                            </span>
                                           </span>
                                           <span class="vlist-r">
                                            <span class="vlist" style="height: 0.143em;">
                                             <span class="">
                                             </span>
                                            </span>
                                           </span>
                                          </span>
                                         </span>
                                        </span>
                                        <span class="mbin mtight">
                                         âˆ’
                                        </span>
                                        <span class="mord mtight">
                                         <span class="mord mathnormal mtight">
                                          m
                                         </span>
                                         <span class="msupsub">
                                          <span class="vlist-t vlist-t2">
                                           <span class="vlist-r">
                                            <span class="vlist" style="height: 0.3281em;">
                                             <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                              <span class="pstrut" style="height: 2.5em;">
                                              </span>
                                              <span class="sizing reset-size3 size1 mtight">
                                               <span class="mord mtight">
                                                <span class="mord mathnormal mtight">
                                                 i
                                                </span>
                                               </span>
                                              </span>
                                             </span>
                                            </span>
                                            <span class="vlist-s">
                                             â€‹
                                            </span>
                                           </span>
                                           <span class="vlist-r">
                                            <span class="vlist" style="height: 0.143em;">
                                             <span class="">
                                             </span>
                                            </span>
                                           </span>
                                          </span>
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="vlist-s">
                              â€‹
                             </span>
                            </span>
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.9629em;">
                              <span class="">
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="mclose nulldelimiter">
                          </span>
                         </span>
                         <span class="mord mathnormal" style="margin-right: 0.2222em;">
                          V
                         </span>
                         <span class="mopen">
                          [
                         </span>
                         <span class="mord mathnormal">
                          i
                         </span>
                         <span class="mpunct">
                          ,
                         </span>
                         <span class="mspace" style="margin-right: 0.2778em;">
                         </span>
                         <span class="mrel">
                          :
                         </span>
                         <span class="mclose">
                          ]
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -3.6206em;">
                        <span class="pstrut" style="height: 3.8117em;">
                        </span>
                        <span class="mord">
                         <span class="mord">
                         </span>
                         <span class="mspace" style="margin-right: 0.2778em;">
                         </span>
                         <span class="mrel">
                          =
                         </span>
                         <span class="mspace" style="margin-right: 0.2778em;">
                         </span>
                         <span class="minner">
                          <span class="mopen delimcenter" style="top: 0em;">
                           <span class="delimsizing size4">
                            (
                           </span>
                          </span>
                          <span class="mop op-limits">
                           <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 1.8117em;">
                              <span class="" style="top: -1.8723em; margin-left: 0em;">
                               <span class="pstrut" style="height: 3.05em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                                  j
                                 </span>
                                 <span class="mrel mtight">
                                  =
                                 </span>
                                 <span class="mord mtight">
                                  1
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="" style="top: -3.05em;">
                               <span class="pstrut" style="height: 3.05em;">
                               </span>
                               <span class="">
                                <span class="mop op-symbol large-op">
                                 âˆ‘
                                </span>
                               </span>
                              </span>
                              <span class="" style="top: -4.3em; margin-left: 0em;">
                               <span class="pstrut" style="height: 3.05em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mathnormal mtight">
                                  i
                                 </span>
                                 <span class="mbin mtight">
                                  âˆ’
                                 </span>
                                 <span class="mord mtight">
                                  1
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="vlist-s">
                              â€‹
                             </span>
                            </span>
                            <span class="vlist-r">
                             <span class="vlist" style="height: 1.4138em;">
                              <span class="">
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="mspace" style="margin-right: 0.1667em;">
                          </span>
                          <span class="mord">
                           <span class="mopen nulldelimiter">
                           </span>
                           <span class="mfrac">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 1.4483em;">
                               <span class="" style="top: -2.314em;">
                                <span class="pstrut" style="height: 3em;">
                                </span>
                                <span class="mord">
                                 <span class="mord">
                                  <span class="mord mathnormal">
                                   d
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.7337em;">
                                      <span class="" style="top: -2.4231em; margin-left: 0em; margin-right: 0.05em;">
                                       <span class="pstrut" style="height: 2.7em;">
                                       </span>
                                       <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                         <span class="mord mathnormal mtight">
                                          i
                                         </span>
                                         <span class="mbin mtight">
                                          âˆ’
                                         </span>
                                         <span class="mord mtight">
                                          1
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                      <span class="" style="top: -3.0448em; margin-right: 0.05em;">
                                       <span class="pstrut" style="height: 2.7em;">
                                       </span>
                                       <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                         <span class="mord mtight">
                                          â€²
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="vlist-s">
                                      â€‹
                                     </span>
                                    </span>
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.3352em;">
                                      <span class="">
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                               <span class="" style="top: -3.23em;">
                                <span class="pstrut" style="height: 3em;">
                                </span>
                                <span class="frac-line" style="border-bottom-width: 0.04em;">
                                </span>
                               </span>
                               <span class="" style="top: -3.677em;">
                                <span class="pstrut" style="height: 3em;">
                                </span>
                                <span class="mord">
                                 <span class="mord">
                                  <span class="mord mathnormal">
                                   e
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.7713em;">
                                      <span class="" style="top: -3.063em; margin-right: 0.05em;">
                                       <span class="pstrut" style="height: 2.7em;">
                                       </span>
                                       <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                         <span class="mord mtight">
                                          <span class="mord mathnormal mtight">
                                           x
                                          </span>
                                          <span class="msupsub">
                                           <span class="vlist-t vlist-t2">
                                            <span class="vlist-r">
                                             <span class="vlist" style="height: 0.3281em;">
                                              <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                               <span class="pstrut" style="height: 2.5em;">
                                               </span>
                                               <span class="sizing reset-size3 size1 mtight">
                                                <span class="mord mtight">
                                                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                                                  j
                                                 </span>
                                                </span>
                                               </span>
                                              </span>
                                             </span>
                                             <span class="vlist-s">
                                              â€‹
                                             </span>
                                            </span>
                                            <span class="vlist-r">
                                             <span class="vlist" style="height: 0.2819em;">
                                              <span class="">
                                              </span>
                                             </span>
                                            </span>
                                           </span>
                                          </span>
                                         </span>
                                         <span class="mbin mtight">
                                          âˆ’
                                         </span>
                                         <span class="mord mtight">
                                          <span class="mord mathnormal mtight">
                                           m
                                          </span>
                                          <span class="msupsub">
                                           <span class="vlist-t vlist-t2">
                                            <span class="vlist-r">
                                             <span class="vlist" style="height: 0.3281em;">
                                              <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                               <span class="pstrut" style="height: 2.5em;">
                                               </span>
                                               <span class="sizing reset-size3 size1 mtight">
                                                <span class="mord mtight">
                                                 <span class="mord mathnormal mtight">
                                                  i
                                                 </span>
                                                 <span class="mbin mtight">
                                                  âˆ’
                                                 </span>
                                                 <span class="mord mtight">
                                                  1
                                                 </span>
                                                </span>
                                               </span>
                                              </span>
                                             </span>
                                             <span class="vlist-s">
                                              â€‹
                                             </span>
                                            </span>
                                            <span class="vlist-r">
                                             <span class="vlist" style="height: 0.2025em;">
                                              <span class="">
                                              </span>
                                             </span>
                                            </span>
                                           </span>
                                          </span>
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               â€‹
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 1.0212em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                           <span class="mclose nulldelimiter">
                           </span>
                          </span>
                          <span class="mord">
                           <span class="mopen nulldelimiter">
                           </span>
                           <span class="mfrac">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 1.4483em;">
                               <span class="" style="top: -2.314em;">
                                <span class="pstrut" style="height: 3em;">
                                </span>
                                <span class="mord">
                                 <span class="mord">
                                  <span class="mord mathnormal">
                                   e
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.7134em;">
                                      <span class="" style="top: -3.0051em; margin-right: 0.05em;">
                                       <span class="pstrut" style="height: 2.7em;">
                                       </span>
                                       <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                         <span class="mord mtight">
                                          <span class="mord mathnormal mtight">
                                           x
                                          </span>
                                          <span class="msupsub">
                                           <span class="vlist-t vlist-t2">
                                            <span class="vlist-r">
                                             <span class="vlist" style="height: 0.3281em;">
                                              <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                               <span class="pstrut" style="height: 2.5em;">
                                               </span>
                                               <span class="sizing reset-size3 size1 mtight">
                                                <span class="mord mtight">
                                                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                                                  j
                                                 </span>
                                                </span>
                                               </span>
                                              </span>
                                             </span>
                                             <span class="vlist-s">
                                              â€‹
                                             </span>
                                            </span>
                                            <span class="vlist-r">
                                             <span class="vlist" style="height: 0.2819em;">
                                              <span class="">
                                              </span>
                                             </span>
                                            </span>
                                           </span>
                                          </span>
                                         </span>
                                         <span class="mbin mtight">
                                          âˆ’
                                         </span>
                                         <span class="mord mtight">
                                          <span class="mord mathnormal mtight">
                                           m
                                          </span>
                                          <span class="msupsub">
                                           <span class="vlist-t vlist-t2">
                                            <span class="vlist-r">
                                             <span class="vlist" style="height: 0.3281em;">
                                              <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                               <span class="pstrut" style="height: 2.5em;">
                                               </span>
                                               <span class="sizing reset-size3 size1 mtight">
                                                <span class="mord mtight">
                                                 <span class="mord mathnormal mtight">
                                                  i
                                                 </span>
                                                 <span class="mbin mtight">
                                                  âˆ’
                                                 </span>
                                                 <span class="mord mtight">
                                                  1
                                                 </span>
                                                </span>
                                               </span>
                                              </span>
                                             </span>
                                             <span class="vlist-s">
                                              â€‹
                                             </span>
                                            </span>
                                            <span class="vlist-r">
                                             <span class="vlist" style="height: 0.2025em;">
                                              <span class="">
                                              </span>
                                             </span>
                                            </span>
                                           </span>
                                          </span>
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                               <span class="" style="top: -3.23em;">
                                <span class="pstrut" style="height: 3em;">
                                </span>
                                <span class="frac-line" style="border-bottom-width: 0.04em;">
                                </span>
                               </span>
                               <span class="" style="top: -3.677em;">
                                <span class="pstrut" style="height: 3em;">
                                </span>
                                <span class="mord">
                                 <span class="mord">
                                  <span class="mord mathnormal">
                                   e
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.7713em;">
                                      <span class="" style="top: -3.063em; margin-right: 0.05em;">
                                       <span class="pstrut" style="height: 2.7em;">
                                       </span>
                                       <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                         <span class="mord mtight">
                                          <span class="mord mathnormal mtight">
                                           x
                                          </span>
                                          <span class="msupsub">
                                           <span class="vlist-t vlist-t2">
                                            <span class="vlist-r">
                                             <span class="vlist" style="height: 0.3281em;">
                                              <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                               <span class="pstrut" style="height: 2.5em;">
                                               </span>
                                               <span class="sizing reset-size3 size1 mtight">
                                                <span class="mord mtight">
                                                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                                                  j
                                                 </span>
                                                </span>
                                               </span>
                                              </span>
                                             </span>
                                             <span class="vlist-s">
                                              â€‹
                                             </span>
                                            </span>
                                            <span class="vlist-r">
                                             <span class="vlist" style="height: 0.2819em;">
                                              <span class="">
                                              </span>
                                             </span>
                                            </span>
                                           </span>
                                          </span>
                                         </span>
                                         <span class="mbin mtight">
                                          âˆ’
                                         </span>
                                         <span class="mord mtight">
                                          <span class="mord mathnormal mtight">
                                           m
                                          </span>
                                          <span class="msupsub">
                                           <span class="vlist-t vlist-t2">
                                            <span class="vlist-r">
                                             <span class="vlist" style="height: 0.3281em;">
                                              <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                               <span class="pstrut" style="height: 2.5em;">
                                               </span>
                                               <span class="sizing reset-size3 size1 mtight">
                                                <span class="mord mtight">
                                                 <span class="mord mathnormal mtight">
                                                  i
                                                 </span>
                                                </span>
                                               </span>
                                              </span>
                                             </span>
                                             <span class="vlist-s">
                                              â€‹
                                             </span>
                                            </span>
                                            <span class="vlist-r">
                                             <span class="vlist" style="height: 0.143em;">
                                              <span class="">
                                              </span>
                                             </span>
                                            </span>
                                           </span>
                                          </span>
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               â€‹
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.686em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                           <span class="mclose nulldelimiter">
                           </span>
                          </span>
                          <span class="mord">
                           <span class="mopen nulldelimiter">
                           </span>
                           <span class="mfrac">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 1.4589em;">
                               <span class="" style="top: -2.314em;">
                                <span class="pstrut" style="height: 3em;">
                                </span>
                                <span class="mord">
                                 <span class="mord">
                                  <span class="mord mathnormal">
                                   d
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.7337em;">
                                      <span class="" style="top: -2.4231em; margin-left: 0em; margin-right: 0.05em;">
                                       <span class="pstrut" style="height: 2.7em;">
                                       </span>
                                       <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                         <span class="mord mathnormal mtight">
                                          i
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                      <span class="" style="top: -3.0448em; margin-right: 0.05em;">
                                       <span class="pstrut" style="height: 2.7em;">
                                       </span>
                                       <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                         <span class="mord mtight">
                                          â€²
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="vlist-s">
                                      â€‹
                                     </span>
                                    </span>
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.2769em;">
                                      <span class="">
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                               <span class="" style="top: -3.23em;">
                                <span class="pstrut" style="height: 3em;">
                                </span>
                                <span class="frac-line" style="border-bottom-width: 0.04em;">
                                </span>
                               </span>
                               <span class="" style="top: -3.707em;">
                                <span class="pstrut" style="height: 3em;">
                                </span>
                                <span class="mord">
                                 <span class="mord">
                                  <span class="mord mathnormal">
                                   d
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.7519em;">
                                      <span class="" style="top: -2.4413em; margin-left: 0em; margin-right: 0.05em;">
                                       <span class="pstrut" style="height: 2.7em;">
                                       </span>
                                       <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                         <span class="mord mathnormal mtight">
                                          i
                                         </span>
                                         <span class="mbin mtight">
                                          âˆ’
                                         </span>
                                         <span class="mord mtight">
                                          1
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                      <span class="" style="top: -3.063em; margin-right: 0.05em;">
                                       <span class="pstrut" style="height: 2.7em;">
                                       </span>
                                       <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                         <span class="mord mtight">
                                          â€²
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="vlist-s">
                                      â€‹
                                     </span>
                                    </span>
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.317em;">
                                      <span class="">
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               â€‹
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.9629em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                           <span class="mclose nulldelimiter">
                           </span>
                          </span>
                          <span class="mord mathnormal" style="margin-right: 0.2222em;">
                           V
                          </span>
                          <span class="mopen">
                           [
                          </span>
                          <span class="mord mathnormal" style="margin-right: 0.0572em;">
                           j
                          </span>
                          <span class="mpunct">
                           ,
                          </span>
                          <span class="mspace" style="margin-right: 0.2778em;">
                          </span>
                          <span class="mrel">
                           :
                          </span>
                          <span class="mclose">
                           ]
                          </span>
                          <span class="mclose delimcenter" style="top: 0em;">
                           <span class="delimsizing size4">
                            )
                           </span>
                          </span>
                         </span>
                         <span class="mspace" style="margin-right: 0.2222em;">
                         </span>
                         <span class="mbin">
                          +
                         </span>
                         <span class="mspace" style="margin-right: 0.2222em;">
                         </span>
                         <span class="mord">
                          <span class="mopen nulldelimiter">
                          </span>
                          <span class="mfrac">
                           <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 1.4483em;">
                              <span class="" style="top: -2.314em;">
                               <span class="pstrut" style="height: 3em;">
                               </span>
                               <span class="mord">
                                <span class="mord">
                                 <span class="mord mathnormal">
                                  d
                                 </span>
                                 <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.7337em;">
                                     <span class="" style="top: -2.4231em; margin-left: 0em; margin-right: 0.05em;">
                                      <span class="pstrut" style="height: 2.7em;">
                                      </span>
                                      <span class="sizing reset-size6 size3 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mathnormal mtight">
                                         i
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="" style="top: -3.0448em; margin-right: 0.05em;">
                                      <span class="pstrut" style="height: 2.7em;">
                                      </span>
                                      <span class="sizing reset-size6 size3 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mtight">
                                         â€²
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                    <span class="vlist-s">
                                     â€‹
                                    </span>
                                   </span>
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.2769em;">
                                     <span class="">
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="" style="top: -3.23em;">
                               <span class="pstrut" style="height: 3em;">
                               </span>
                               <span class="frac-line" style="border-bottom-width: 0.04em;">
                               </span>
                              </span>
                              <span class="" style="top: -3.677em;">
                               <span class="pstrut" style="height: 3em;">
                               </span>
                               <span class="mord">
                                <span class="mord">
                                 <span class="mord mathnormal">
                                  e
                                 </span>
                                 <span class="msupsub">
                                  <span class="vlist-t">
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.7713em;">
                                     <span class="" style="top: -3.063em; margin-right: 0.05em;">
                                      <span class="pstrut" style="height: 2.7em;">
                                      </span>
                                      <span class="sizing reset-size6 size3 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mtight">
                                         <span class="mord mathnormal mtight">
                                          x
                                         </span>
                                         <span class="msupsub">
                                          <span class="vlist-t vlist-t2">
                                           <span class="vlist-r">
                                            <span class="vlist" style="height: 0.3281em;">
                                             <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                              <span class="pstrut" style="height: 2.5em;">
                                              </span>
                                              <span class="sizing reset-size3 size1 mtight">
                                               <span class="mord mtight">
                                                <span class="mord mathnormal mtight">
                                                 i
                                                </span>
                                               </span>
                                              </span>
                                             </span>
                                            </span>
                                            <span class="vlist-s">
                                             â€‹
                                            </span>
                                           </span>
                                           <span class="vlist-r">
                                            <span class="vlist" style="height: 0.143em;">
                                             <span class="">
                                             </span>
                                            </span>
                                           </span>
                                          </span>
                                         </span>
                                        </span>
                                        <span class="mbin mtight">
                                         âˆ’
                                        </span>
                                        <span class="mord mtight">
                                         <span class="mord mathnormal mtight">
                                          m
                                         </span>
                                         <span class="msupsub">
                                          <span class="vlist-t vlist-t2">
                                           <span class="vlist-r">
                                            <span class="vlist" style="height: 0.3281em;">
                                             <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                              <span class="pstrut" style="height: 2.5em;">
                                              </span>
                                              <span class="sizing reset-size3 size1 mtight">
                                               <span class="mord mtight">
                                                <span class="mord mathnormal mtight">
                                                 i
                                                </span>
                                               </span>
                                              </span>
                                             </span>
                                            </span>
                                            <span class="vlist-s">
                                             â€‹
                                            </span>
                                           </span>
                                           <span class="vlist-r">
                                            <span class="vlist" style="height: 0.143em;">
                                             <span class="">
                                             </span>
                                            </span>
                                           </span>
                                          </span>
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="vlist-s">
                              â€‹
                             </span>
                            </span>
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.9629em;">
                              <span class="">
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="mclose nulldelimiter">
                          </span>
                         </span>
                         <span class="mord mathnormal" style="margin-right: 0.2222em;">
                          V
                         </span>
                         <span class="mopen">
                          [
                         </span>
                         <span class="mord mathnormal">
                          i
                         </span>
                         <span class="mpunct">
                          ,
                         </span>
                         <span class="mspace" style="margin-right: 0.2778em;">
                         </span>
                         <span class="mrel">
                          :
                         </span>
                         <span class="mclose">
                          ]
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -0.0951em;">
                        <span class="pstrut" style="height: 3.8117em;">
                        </span>
                        <span class="mord">
                         <span class="mord">
                         </span>
                         <span class="mspace" style="margin-right: 0.2778em;">
                         </span>
                         <span class="mrel">
                          =
                         </span>
                         <span class="mspace" style="margin-right: 0.2778em;">
                         </span>
                         <span class="minner">
                          <span class="mopen delimcenter" style="top: 0em;">
                           <span class="delimsizing size4">
                            (
                           </span>
                          </span>
                          <span class="mop op-limits">
                           <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 1.8117em;">
                              <span class="" style="top: -1.8723em; margin-left: 0em;">
                               <span class="pstrut" style="height: 3.05em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                                  j
                                 </span>
                                 <span class="mrel mtight">
                                  =
                                 </span>
                                 <span class="mord mtight">
                                  1
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="" style="top: -3.05em;">
                               <span class="pstrut" style="height: 3.05em;">
                               </span>
                               <span class="">
                                <span class="mop op-symbol large-op">
                                 âˆ‘
                                </span>
                               </span>
                              </span>
                              <span class="" style="top: -4.3em; margin-left: 0em;">
                               <span class="pstrut" style="height: 3.05em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mathnormal mtight">
                                  i
                                 </span>
                                 <span class="mbin mtight">
                                  âˆ’
                                 </span>
                                 <span class="mord mtight">
                                  1
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="vlist-s">
                              â€‹
                             </span>
                            </span>
                            <span class="vlist-r">
                             <span class="vlist" style="height: 1.4138em;">
                              <span class="">
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="mspace" style="margin-right: 0.1667em;">
                          </span>
                          <span class="mord">
                           <span class="mopen nulldelimiter">
                           </span>
                           <span class="mfrac">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 1.4483em;">
                               <span class="" style="top: -2.314em;">
                                <span class="pstrut" style="height: 3em;">
                                </span>
                                <span class="mord">
                                 <span class="mord">
                                  <span class="mord mathnormal">
                                   d
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.7337em;">
                                      <span class="" style="top: -2.4231em; margin-left: 0em; margin-right: 0.05em;">
                                       <span class="pstrut" style="height: 2.7em;">
                                       </span>
                                       <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                         <span class="mord mathnormal mtight">
                                          i
                                         </span>
                                         <span class="mbin mtight">
                                          âˆ’
                                         </span>
                                         <span class="mord mtight">
                                          1
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                      <span class="" style="top: -3.0448em; margin-right: 0.05em;">
                                       <span class="pstrut" style="height: 2.7em;">
                                       </span>
                                       <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                         <span class="mord mtight">
                                          â€²
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="vlist-s">
                                      â€‹
                                     </span>
                                    </span>
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.3352em;">
                                      <span class="">
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                               <span class="" style="top: -3.23em;">
                                <span class="pstrut" style="height: 3em;">
                                </span>
                                <span class="frac-line" style="border-bottom-width: 0.04em;">
                                </span>
                               </span>
                               <span class="" style="top: -3.677em;">
                                <span class="pstrut" style="height: 3em;">
                                </span>
                                <span class="mord">
                                 <span class="mord">
                                  <span class="mord mathnormal">
                                   e
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.7713em;">
                                      <span class="" style="top: -3.063em; margin-right: 0.05em;">
                                       <span class="pstrut" style="height: 2.7em;">
                                       </span>
                                       <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                         <span class="mord mtight">
                                          <span class="mord mathnormal mtight">
                                           x
                                          </span>
                                          <span class="msupsub">
                                           <span class="vlist-t vlist-t2">
                                            <span class="vlist-r">
                                             <span class="vlist" style="height: 0.3281em;">
                                              <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                               <span class="pstrut" style="height: 2.5em;">
                                               </span>
                                               <span class="sizing reset-size3 size1 mtight">
                                                <span class="mord mtight">
                                                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                                                  j
                                                 </span>
                                                </span>
                                               </span>
                                              </span>
                                             </span>
                                             <span class="vlist-s">
                                              â€‹
                                             </span>
                                            </span>
                                            <span class="vlist-r">
                                             <span class="vlist" style="height: 0.2819em;">
                                              <span class="">
                                              </span>
                                             </span>
                                            </span>
                                           </span>
                                          </span>
                                         </span>
                                         <span class="mbin mtight">
                                          âˆ’
                                         </span>
                                         <span class="mord mtight">
                                          <span class="mord mathnormal mtight">
                                           m
                                          </span>
                                          <span class="msupsub">
                                           <span class="vlist-t vlist-t2">
                                            <span class="vlist-r">
                                             <span class="vlist" style="height: 0.3281em;">
                                              <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                               <span class="pstrut" style="height: 2.5em;">
                                               </span>
                                               <span class="sizing reset-size3 size1 mtight">
                                                <span class="mord mtight">
                                                 <span class="mord mathnormal mtight">
                                                  i
                                                 </span>
                                                 <span class="mbin mtight">
                                                  âˆ’
                                                 </span>
                                                 <span class="mord mtight">
                                                  1
                                                 </span>
                                                </span>
                                               </span>
                                              </span>
                                             </span>
                                             <span class="vlist-s">
                                              â€‹
                                             </span>
                                            </span>
                                            <span class="vlist-r">
                                             <span class="vlist" style="height: 0.2025em;">
                                              <span class="">
                                              </span>
                                             </span>
                                            </span>
                                           </span>
                                          </span>
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               â€‹
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 1.0212em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                           <span class="mclose nulldelimiter">
                           </span>
                          </span>
                          <span class="mord mathnormal" style="margin-right: 0.2222em;">
                           V
                          </span>
                          <span class="mopen">
                           [
                          </span>
                          <span class="mord mathnormal" style="margin-right: 0.0572em;">
                           j
                          </span>
                          <span class="mpunct">
                           ,
                          </span>
                          <span class="mspace" style="margin-right: 0.2778em;">
                          </span>
                          <span class="mrel">
                           :
                          </span>
                          <span class="mclose">
                           ]
                          </span>
                          <span class="mclose delimcenter" style="top: 0em;">
                           <span class="delimsizing size4">
                            )
                           </span>
                          </span>
                         </span>
                         <span class="mspace" style="margin-right: 0.1667em;">
                         </span>
                         <span class="mord">
                          <span class="mopen nulldelimiter">
                          </span>
                          <span class="mfrac">
                           <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 1.4589em;">
                              <span class="" style="top: -2.314em;">
                               <span class="pstrut" style="height: 3em;">
                               </span>
                               <span class="mord">
                                <span class="mord">
                                 <span class="mord mathnormal">
                                  d
                                 </span>
                                 <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.7337em;">
                                     <span class="" style="top: -2.4231em; margin-left: 0em; margin-right: 0.05em;">
                                      <span class="pstrut" style="height: 2.7em;">
                                      </span>
                                      <span class="sizing reset-size6 size3 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mathnormal mtight">
                                         i
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="" style="top: -3.0448em; margin-right: 0.05em;">
                                      <span class="pstrut" style="height: 2.7em;">
                                      </span>
                                      <span class="sizing reset-size6 size3 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mtight">
                                         â€²
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                    <span class="vlist-s">
                                     â€‹
                                    </span>
                                   </span>
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.2769em;">
                                     <span class="">
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="" style="top: -3.23em;">
                               <span class="pstrut" style="height: 3em;">
                               </span>
                               <span class="frac-line" style="border-bottom-width: 0.04em;">
                               </span>
                              </span>
                              <span class="" style="top: -3.707em;">
                               <span class="pstrut" style="height: 3em;">
                               </span>
                               <span class="mord">
                                <span class="mord">
                                 <span class="mord mathnormal">
                                  d
                                 </span>
                                 <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.7519em;">
                                     <span class="" style="top: -2.4413em; margin-left: 0em; margin-right: 0.05em;">
                                      <span class="pstrut" style="height: 2.7em;">
                                      </span>
                                      <span class="sizing reset-size6 size3 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mathnormal mtight">
                                         i
                                        </span>
                                        <span class="mbin mtight">
                                         âˆ’
                                        </span>
                                        <span class="mord mtight">
                                         1
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="" style="top: -3.063em; margin-right: 0.05em;">
                                      <span class="pstrut" style="height: 2.7em;">
                                      </span>
                                      <span class="sizing reset-size6 size3 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mtight">
                                         â€²
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                    <span class="vlist-s">
                                     â€‹
                                    </span>
                                   </span>
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.317em;">
                                     <span class="">
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="vlist-s">
                              â€‹
                             </span>
                            </span>
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.9629em;">
                              <span class="">
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="mclose nulldelimiter">
                          </span>
                         </span>
                         <span class="mord">
                          <span class="mord mathnormal">
                           e
                          </span>
                          <span class="msupsub">
                           <span class="vlist-t">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.8213em;">
                              <span class="" style="top: -3.113em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   m
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.3281em;">
                                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                       <span class="pstrut" style="height: 2.5em;">
                                       </span>
                                       <span class="sizing reset-size3 size1 mtight">
                                        <span class="mord mtight">
                                         <span class="mord mathnormal mtight">
                                          i
                                         </span>
                                         <span class="mbin mtight">
                                          âˆ’
                                         </span>
                                         <span class="mord mtight">
                                          1
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="vlist-s">
                                      â€‹
                                     </span>
                                    </span>
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.2025em;">
                                      <span class="">
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                 <span class="mbin mtight">
                                  âˆ’
                                 </span>
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   m
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.3281em;">
                                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                       <span class="pstrut" style="height: 2.5em;">
                                       </span>
                                       <span class="sizing reset-size3 size1 mtight">
                                        <span class="mord mtight">
                                         <span class="mord mathnormal mtight">
                                          i
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="vlist-s">
                                      â€‹
                                     </span>
                                    </span>
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.143em;">
                                      <span class="">
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                         <span class="mspace" style="margin-right: 0.2222em;">
                         </span>
                         <span class="mbin">
                          +
                         </span>
                         <span class="mspace" style="margin-right: 0.2222em;">
                         </span>
                         <span class="mord">
                          <span class="mopen nulldelimiter">
                          </span>
                          <span class="mfrac">
                           <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 1.4483em;">
                              <span class="" style="top: -2.314em;">
                               <span class="pstrut" style="height: 3em;">
                               </span>
                               <span class="mord">
                                <span class="mord">
                                 <span class="mord mathnormal">
                                  d
                                 </span>
                                 <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.7337em;">
                                     <span class="" style="top: -2.4231em; margin-left: 0em; margin-right: 0.05em;">
                                      <span class="pstrut" style="height: 2.7em;">
                                      </span>
                                      <span class="sizing reset-size6 size3 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mathnormal mtight">
                                         i
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="" style="top: -3.0448em; margin-right: 0.05em;">
                                      <span class="pstrut" style="height: 2.7em;">
                                      </span>
                                      <span class="sizing reset-size6 size3 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mtight">
                                         â€²
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                    <span class="vlist-s">
                                     â€‹
                                    </span>
                                   </span>
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.2769em;">
                                     <span class="">
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="" style="top: -3.23em;">
                               <span class="pstrut" style="height: 3em;">
                               </span>
                               <span class="frac-line" style="border-bottom-width: 0.04em;">
                               </span>
                              </span>
                              <span class="" style="top: -3.677em;">
                               <span class="pstrut" style="height: 3em;">
                               </span>
                               <span class="mord">
                                <span class="mord">
                                 <span class="mord mathnormal">
                                  e
                                 </span>
                                 <span class="msupsub">
                                  <span class="vlist-t">
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.7713em;">
                                     <span class="" style="top: -3.063em; margin-right: 0.05em;">
                                      <span class="pstrut" style="height: 2.7em;">
                                      </span>
                                      <span class="sizing reset-size6 size3 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mtight">
                                         <span class="mord mathnormal mtight">
                                          x
                                         </span>
                                         <span class="msupsub">
                                          <span class="vlist-t vlist-t2">
                                           <span class="vlist-r">
                                            <span class="vlist" style="height: 0.3281em;">
                                             <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                              <span class="pstrut" style="height: 2.5em;">
                                              </span>
                                              <span class="sizing reset-size3 size1 mtight">
                                               <span class="mord mtight">
                                                <span class="mord mathnormal mtight">
                                                 i
                                                </span>
                                               </span>
                                              </span>
                                             </span>
                                            </span>
                                            <span class="vlist-s">
                                             â€‹
                                            </span>
                                           </span>
                                           <span class="vlist-r">
                                            <span class="vlist" style="height: 0.143em;">
                                             <span class="">
                                             </span>
                                            </span>
                                           </span>
                                          </span>
                                         </span>
                                        </span>
                                        <span class="mbin mtight">
                                         âˆ’
                                        </span>
                                        <span class="mord mtight">
                                         <span class="mord mathnormal mtight">
                                          m
                                         </span>
                                         <span class="msupsub">
                                          <span class="vlist-t vlist-t2">
                                           <span class="vlist-r">
                                            <span class="vlist" style="height: 0.3281em;">
                                             <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                              <span class="pstrut" style="height: 2.5em;">
                                              </span>
                                              <span class="sizing reset-size3 size1 mtight">
                                               <span class="mord mtight">
                                                <span class="mord mathnormal mtight">
                                                 i
                                                </span>
                                               </span>
                                              </span>
                                             </span>
                                            </span>
                                            <span class="vlist-s">
                                             â€‹
                                            </span>
                                           </span>
                                           <span class="vlist-r">
                                            <span class="vlist" style="height: 0.143em;">
                                             <span class="">
                                             </span>
                                            </span>
                                           </span>
                                          </span>
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="vlist-s">
                              â€‹
                             </span>
                            </span>
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.9629em;">
                              <span class="">
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="mclose nulldelimiter">
                          </span>
                         </span>
                         <span class="mord mathnormal" style="margin-right: 0.2222em;">
                          V
                         </span>
                         <span class="mopen">
                          [
                         </span>
                         <span class="mord mathnormal">
                          i
                         </span>
                         <span class="mpunct">
                          ,
                         </span>
                         <span class="mspace" style="margin-right: 0.2778em;">
                         </span>
                         <span class="mrel">
                          :
                         </span>
                         <span class="mclose">
                          ]
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: 3.097em;">
                        <span class="pstrut" style="height: 3.8117em;">
                        </span>
                        <span class="mord">
                         <span class="mord">
                         </span>
                         <span class="mspace" style="margin-right: 0.2778em;">
                         </span>
                         <span class="mrel">
                          =
                         </span>
                         <span class="mspace" style="margin-right: 0.2778em;">
                         </span>
                         <span class="mord">
                          <span class="mord">
                           <span class="mord">
                            <span class="mord boldsymbol">
                             o
                            </span>
                           </span>
                          </span>
                          <span class="msupsub">
                           <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.8019em;">
                              <span class="" style="top: -2.453em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mathnormal mtight">
                                  i
                                 </span>
                                 <span class="mbin mtight">
                                  âˆ’
                                 </span>
                                 <span class="mord mtight">
                                  1
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="" style="top: -3.113em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mtight">
                                  â€²
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="vlist-s">
                              â€‹
                             </span>
                            </span>
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.3053em;">
                              <span class="">
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                         <span class="mord">
                          <span class="mopen nulldelimiter">
                          </span>
                          <span class="mfrac">
                           <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 1.4783em;">
                              <span class="" style="top: -2.314em;">
                               <span class="pstrut" style="height: 3em;">
                               </span>
                               <span class="mord">
                                <span class="mord">
                                 <span class="mord mathnormal">
                                  d
                                 </span>
                                 <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.7337em;">
                                     <span class="" style="top: -2.4231em; margin-left: 0em; margin-right: 0.05em;">
                                      <span class="pstrut" style="height: 2.7em;">
                                      </span>
                                      <span class="sizing reset-size6 size3 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mathnormal mtight">
                                         i
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="" style="top: -3.0448em; margin-right: 0.05em;">
                                      <span class="pstrut" style="height: 2.7em;">
                                      </span>
                                      <span class="sizing reset-size6 size3 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mtight">
                                         â€²
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                    <span class="vlist-s">
                                     â€‹
                                    </span>
                                   </span>
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.2769em;">
                                     <span class="">
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="" style="top: -3.23em;">
                               <span class="pstrut" style="height: 3em;">
                               </span>
                               <span class="frac-line" style="border-bottom-width: 0.04em;">
                               </span>
                              </span>
                              <span class="" style="top: -3.707em;">
                               <span class="pstrut" style="height: 3em;">
                               </span>
                               <span class="mord">
                                <span class="mord">
                                 <span class="mord mathnormal">
                                  d
                                 </span>
                                 <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.7519em;">
                                     <span class="" style="top: -2.4413em; margin-left: 0em; margin-right: 0.05em;">
                                      <span class="pstrut" style="height: 2.7em;">
                                      </span>
                                      <span class="sizing reset-size6 size3 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mathnormal mtight">
                                         i
                                        </span>
                                        <span class="mbin mtight">
                                         âˆ’
                                        </span>
                                        <span class="mord mtight">
                                         1
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="" style="top: -3.063em; margin-right: 0.05em;">
                                      <span class="pstrut" style="height: 2.7em;">
                                      </span>
                                      <span class="sizing reset-size6 size3 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mtight">
                                         â€²
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                    <span class="vlist-s">
                                     â€‹
                                    </span>
                                   </span>
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.317em;">
                                     <span class="">
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                                <span class="mord">
                                 <span class="mord mathnormal">
                                  e
                                 </span>
                                 <span class="msupsub">
                                  <span class="vlist-t">
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.7713em;">
                                     <span class="" style="top: -3.063em; margin-right: 0.05em;">
                                      <span class="pstrut" style="height: 2.7em;">
                                      </span>
                                      <span class="sizing reset-size6 size3 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mtight">
                                         <span class="mord mathnormal mtight">
                                          m
                                         </span>
                                         <span class="msupsub">
                                          <span class="vlist-t vlist-t2">
                                           <span class="vlist-r">
                                            <span class="vlist" style="height: 0.3281em;">
                                             <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                              <span class="pstrut" style="height: 2.5em;">
                                              </span>
                                              <span class="sizing reset-size3 size1 mtight">
                                               <span class="mord mtight">
                                                <span class="mord mathnormal mtight">
                                                 i
                                                </span>
                                                <span class="mbin mtight">
                                                 âˆ’
                                                </span>
                                                <span class="mord mtight">
                                                 1
                                                </span>
                                               </span>
                                              </span>
                                             </span>
                                            </span>
                                            <span class="vlist-s">
                                             â€‹
                                            </span>
                                           </span>
                                           <span class="vlist-r">
                                            <span class="vlist" style="height: 0.2025em;">
                                             <span class="">
                                             </span>
                                            </span>
                                           </span>
                                          </span>
                                         </span>
                                        </span>
                                        <span class="mbin mtight">
                                         âˆ’
                                        </span>
                                        <span class="mord mtight">
                                         <span class="mord mathnormal mtight">
                                          m
                                         </span>
                                         <span class="msupsub">
                                          <span class="vlist-t vlist-t2">
                                           <span class="vlist-r">
                                            <span class="vlist" style="height: 0.3281em;">
                                             <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                              <span class="pstrut" style="height: 2.5em;">
                                              </span>
                                              <span class="sizing reset-size3 size1 mtight">
                                               <span class="mord mtight">
                                                <span class="mord mathnormal mtight">
                                                 i
                                                </span>
                                               </span>
                                              </span>
                                             </span>
                                            </span>
                                            <span class="vlist-s">
                                             â€‹
                                            </span>
                                           </span>
                                           <span class="vlist-r">
                                            <span class="vlist" style="height: 0.143em;">
                                             <span class="">
                                             </span>
                                            </span>
                                           </span>
                                          </span>
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="vlist-s">
                              â€‹
                             </span>
                            </span>
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.9629em;">
                              <span class="">
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="mclose nulldelimiter">
                          </span>
                         </span>
                         <span class="mspace" style="margin-right: 0.2222em;">
                         </span>
                         <span class="mbin">
                          +
                         </span>
                         <span class="mspace" style="margin-right: 0.2222em;">
                         </span>
                         <span class="mord">
                          <span class="mopen nulldelimiter">
                          </span>
                          <span class="mfrac">
                           <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 1.4483em;">
                              <span class="" style="top: -2.314em;">
                               <span class="pstrut" style="height: 3em;">
                               </span>
                               <span class="mord">
                                <span class="mord">
                                 <span class="mord mathnormal">
                                  d
                                 </span>
                                 <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.7337em;">
                                     <span class="" style="top: -2.4231em; margin-left: 0em; margin-right: 0.05em;">
                                      <span class="pstrut" style="height: 2.7em;">
                                      </span>
                                      <span class="sizing reset-size6 size3 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mathnormal mtight">
                                         i
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="" style="top: -3.0448em; margin-right: 0.05em;">
                                      <span class="pstrut" style="height: 2.7em;">
                                      </span>
                                      <span class="sizing reset-size6 size3 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mtight">
                                         â€²
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                    <span class="vlist-s">
                                     â€‹
                                    </span>
                                   </span>
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.2769em;">
                                     <span class="">
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="" style="top: -3.23em;">
                               <span class="pstrut" style="height: 3em;">
                               </span>
                               <span class="frac-line" style="border-bottom-width: 0.04em;">
                               </span>
                              </span>
                              <span class="" style="top: -3.677em;">
                               <span class="pstrut" style="height: 3em;">
                               </span>
                               <span class="mord">
                                <span class="mord">
                                 <span class="mord mathnormal">
                                  e
                                 </span>
                                 <span class="msupsub">
                                  <span class="vlist-t">
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.7713em;">
                                     <span class="" style="top: -3.063em; margin-right: 0.05em;">
                                      <span class="pstrut" style="height: 2.7em;">
                                      </span>
                                      <span class="sizing reset-size6 size3 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mtight">
                                         <span class="mord mathnormal mtight">
                                          x
                                         </span>
                                         <span class="msupsub">
                                          <span class="vlist-t vlist-t2">
                                           <span class="vlist-r">
                                            <span class="vlist" style="height: 0.3281em;">
                                             <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                              <span class="pstrut" style="height: 2.5em;">
                                              </span>
                                              <span class="sizing reset-size3 size1 mtight">
                                               <span class="mord mtight">
                                                <span class="mord mathnormal mtight">
                                                 i
                                                </span>
                                               </span>
                                              </span>
                                             </span>
                                            </span>
                                            <span class="vlist-s">
                                             â€‹
                                            </span>
                                           </span>
                                           <span class="vlist-r">
                                            <span class="vlist" style="height: 0.143em;">
                                             <span class="">
                                             </span>
                                            </span>
                                           </span>
                                          </span>
                                         </span>
                                        </span>
                                        <span class="mbin mtight">
                                         âˆ’
                                        </span>
                                        <span class="mord mtight">
                                         <span class="mord mathnormal mtight">
                                          m
                                         </span>
                                         <span class="msupsub">
                                          <span class="vlist-t vlist-t2">
                                           <span class="vlist-r">
                                            <span class="vlist" style="height: 0.3281em;">
                                             <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                              <span class="pstrut" style="height: 2.5em;">
                                              </span>
                                              <span class="sizing reset-size3 size1 mtight">
                                               <span class="mord mtight">
                                                <span class="mord mathnormal mtight">
                                                 i
                                                </span>
                                               </span>
                                              </span>
                                             </span>
                                            </span>
                                            <span class="vlist-s">
                                             â€‹
                                            </span>
                                           </span>
                                           <span class="vlist-r">
                                            <span class="vlist" style="height: 0.143em;">
                                             <span class="">
                                             </span>
                                            </span>
                                           </span>
                                          </span>
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="vlist-s">
                              â€‹
                             </span>
                            </span>
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.9629em;">
                              <span class="">
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="mclose nulldelimiter">
                          </span>
                         </span>
                         <span class="mord mathnormal" style="margin-right: 0.2222em;">
                          V
                         </span>
                         <span class="mopen">
                          [
                         </span>
                         <span class="mord mathnormal">
                          i
                         </span>
                         <span class="mpunct">
                          ,
                         </span>
                         <span class="mspace" style="margin-right: 0.2778em;">
                         </span>
                         <span class="mrel">
                          :
                         </span>
                         <span class="mclose">
                          ]
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 8.1715em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 8.1715em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="tag">
          <span class="vlist-t vlist-t2">
           <span class="vlist-r">
            <span class="vlist" style="height: 8.6715em;">
             <span class="" style="top: -10.6715em;">
              <span class="pstrut" style="height: 10.6715em;">
              </span>
              <span class="eqn-num">
              </span>
             </span>
            </span>
            <span class="vlist-s">
             â€‹
            </span>
           </span>
           <span class="vlist-r">
            <span class="vlist" style="height: 8.1715em;">
             <span class="">
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     å®ƒä»…ä¾èµ–äº
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
         
        
          i 
         
        
          â€² 
         
        
       
         , 
        
       
         Â  
        
        
        
          d 
         
         
         
           i 
          
         
           âˆ’ 
          
         
           1 
          
         
        
          â€² 
         
        
       
         , 
        
       
         Â  
        
        
        
          m 
         
        
          i 
         
        
       
         , 
        
       
         Â  
        
        
        
          m 
         
         
         
           i 
          
         
           âˆ’ 
          
         
           1 
          
         
        
       
         , 
        
       
         Â  
        
        
        
          x 
         
        
          i 
         
        
       
      
        d^{\prime}_i,\ d^{\prime}_{i-1}, \ m_i, \ m_{i-1}, \ x_i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.0689em; vertical-align: -0.317em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           d
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7519em;">
              <span class="" style="top: -2.4413em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  â€²
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2587em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace">
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           d
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7519em;">
              <span class="" style="top: -2.4413em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mbin mtight">
                  âˆ’
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  â€²
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.317em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace">
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           m
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace">
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           m
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mbin mtight">
                  âˆ’
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2083em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace">
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           x
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨å•ä¸ªå¾ªç¯ä¸­èåˆ Self-Attention ä¸­çš„æ‰€æœ‰è®¡ç®—
    </p>
    <p>
     <strong>
      Algorithm FlashAttention
     </strong>
    </p>
    <p>
     <strong>
      for
     </strong>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        i 
        
       
         â† 
        
       
         1 
        
       
         , 
        
       
         N 
        
       
      
        i \leftarrow 1,N
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6595em;">
         </span>
         <span class="mord mathnormal">
          i
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          â†
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.109em;">
          N
         </span>
        </span>
       </span>
      </span>
     </span>
     <strong>
      do
     </strong>
    </p>
    <p>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         x 
             
            
              i 
             
            
           
          
          
           
            
             
            
              â† 
             
             
             
               Q 
              
             
               [ 
              
             
               k 
              
             
               , 
              
             
               : 
              
             
               ] 
              
             
             
              
              
                K 
               
              
                T 
               
              
             
               [ 
              
             
               : 
              
             
               , 
              
             
               i 
              
             
               ] 
              
             
            
           
          
         
         
          
           
            
            
              m 
             
            
              i 
             
            
           
          
          
           
            
             
            
              â† 
             
            
              max 
             
            
              â¡ 
             
             
             
               ( 
              
              
               
               
                 m 
                
                
                
                  i 
                 
                
                  âˆ’ 
                 
                
                  1 
                 
                
               
              
                , 
               
               
               
                 x 
                
               
                 i 
                
               
              
             
               ) 
              
             
            
           
          
         
         
          
           
            
            
              d 
             
            
              i 
             
            
              â€² 
             
            
           
          
          
           
            
             
            
              â† 
             
             
              
              
                d 
               
               
               
                 i 
                
               
                 âˆ’ 
                
               
                 1 
                
               
              
                â€² 
               
              
              
              
                e 
               
               
                
                
                  m 
                 
                 
                 
                   i 
                  
                 
                   âˆ’ 
                  
                 
                   1 
                  
                 
                
               
                 âˆ’ 
                
                
                
                  m 
                 
                
                  i 
                 
                
               
              
             
            
              + 
             
             
             
               e 
              
              
               
               
                 x 
                
               
                 i 
                
               
              
                âˆ’ 
               
               
               
                 m 
                
               
                 i 
                
               
              
             
            
           
          
         
         
          
           
            
            
              o 
             
            
              i 
             
            
              â€² 
             
            
           
          
          
           
            
             
            
              â† 
             
             
             
               o 
              
              
              
                i 
               
              
                âˆ’ 
               
              
                1 
               
              
             
               â€² 
              
             
             
              
               
               
                 d 
                
                
                
                  i 
                 
                
                  âˆ’ 
                 
                
                  1 
                 
                
               
                 â€² 
                
               
               
               
                 e 
                
                
                 
                 
                   m 
                  
                  
                  
                    i 
                   
                  
                    âˆ’ 
                   
                  
                    1 
                   
                  
                 
                
                  âˆ’ 
                 
                 
                 
                   m 
                  
                 
                   i 
                  
                 
                
               
              
              
              
                d 
               
              
                i 
               
              
                â€² 
               
              
             
            
              + 
             
             
              
              
                e 
               
               
                
                
                  x 
                 
                
                  i 
                 
                
               
                 âˆ’ 
                
                
                
                  m 
                 
                
                  i 
                 
                
               
              
              
              
                d 
               
              
                i 
               
              
                â€² 
               
              
             
             
             
               V 
              
             
               [ 
              
             
               i 
              
             
               , 
              
             
               : 
              
             
               ] 
              
             
            
           
          
         
        
       
         \begin{aligned} {x_{i}} &amp; \leftarrow {Q[k,:]} {K^{T}[:,i]}\\ {m_{i}} &amp; \leftarrow \max\left( {m_{i-1},x_{i}} \right)\\ {d^{\prime}_{i}} &amp; \leftarrow {d^{\prime}_{i-1}e^{m_{i-1}-m_{i}}}+ {e^{x_{i}-m_{i}}}\\ {o^{\prime}_{i}} &amp; \leftarrow {o^{\prime}_{i-1}}\frac{ {d^{\prime}_{i-1}e^{m_{i-1}-m_{i}}}}{ { d^{\prime}_{i}}}+\frac{ {e^{x_{i}-m_{i}}}}{ {d^{\prime}_{i}}} {V[i,:]}\end{aligned}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 7.2925em; vertical-align: -3.3963em;">
          </span>
          <span class="mord">
           <span class="mtable">
            <span class="col-align-r">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 3.8963em;">
                <span class="" style="top: -6.4833em;">
                 <span class="pstrut" style="height: 3.4783em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                   <span class="mord">
                    <span class="mord mathnormal">
                     x
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.3117em;">
                        <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight">
                            i
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        â€‹
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.15em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="" style="top: -4.9833em;">
                 <span class="pstrut" style="height: 3.4783em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                   <span class="mord">
                    <span class="mord mathnormal">
                     m
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.3117em;">
                        <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight">
                            i
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        â€‹
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.15em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="" style="top: -3.4833em;">
                 <span class="pstrut" style="height: 3.4783em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                   <span class="mord">
                    <span class="mord mathnormal">
                     d
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.8019em;">
                        <span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight">
                            i
                           </span>
                          </span>
                         </span>
                        </span>
                        <span class="" style="top: -3.113em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mtight">
                            â€²
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        â€‹
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.247em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="" style="top: -1.3449em;">
                 <span class="pstrut" style="height: 3.4783em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                   <span class="mord">
                    <span class="mord mathnormal">
                     o
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.8019em;">
                        <span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight">
                            i
                           </span>
                          </span>
                         </span>
                        </span>
                        <span class="" style="top: -3.113em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mtight">
                            â€²
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        â€‹
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.247em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                â€‹
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 3.3963em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="col-align-l">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 3.8963em;">
                <span class="" style="top: -6.4833em;">
                 <span class="pstrut" style="height: 3.4783em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mrel">
                   â†
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal">
                    Q
                   </span>
                   <span class="mopen">
                    [
                   </span>
                   <span class="mord mathnormal" style="margin-right: 0.0315em;">
                    k
                   </span>
                   <span class="mpunct">
                    ,
                   </span>
                   <span class="mspace" style="margin-right: 0.2778em;">
                   </span>
                   <span class="mrel">
                    :
                   </span>
                   <span class="mclose">
                    ]
                   </span>
                  </span>
                  <span class="mord">
                   <span class="mord">
                    <span class="mord mathnormal" style="margin-right: 0.0715em;">
                     K
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.8913em;">
                        <span class="" style="top: -3.113em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                            T
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mopen">
                    [
                   </span>
                   <span class="mrel">
                    :
                   </span>
                   <span class="mpunct">
                    ,
                   </span>
                   <span class="mspace" style="margin-right: 0.1667em;">
                   </span>
                   <span class="mord mathnormal">
                    i
                   </span>
                   <span class="mclose">
                    ]
                   </span>
                  </span>
                 </span>
                </span>
                <span class="" style="top: -4.9833em;">
                 <span class="pstrut" style="height: 3.4783em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mrel">
                   â†
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mop">
                   max
                  </span>
                  <span class="mspace" style="margin-right: 0.1667em;">
                  </span>
                  <span class="minner">
                   <span class="mopen delimcenter" style="top: 0em;">
                    (
                   </span>
                   <span class="mord">
                    <span class="mord">
                     <span class="mord mathnormal">
                      m
                     </span>
                     <span class="msupsub">
                      <span class="vlist-t vlist-t2">
                       <span class="vlist-r">
                        <span class="vlist" style="height: 0.3117em;">
                         <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                          <span class="pstrut" style="height: 2.7em;">
                          </span>
                          <span class="sizing reset-size6 size3 mtight">
                           <span class="mord mtight">
                            <span class="mord mathnormal mtight">
                             i
                            </span>
                            <span class="mbin mtight">
                             âˆ’
                            </span>
                            <span class="mord mtight">
                             1
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                        <span class="vlist-s">
                         â€‹
                        </span>
                       </span>
                       <span class="vlist-r">
                        <span class="vlist" style="height: 0.2083em;">
                         <span class="">
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                    <span class="mpunct">
                     ,
                    </span>
                    <span class="mspace" style="margin-right: 0.1667em;">
                    </span>
                    <span class="mord">
                     <span class="mord mathnormal">
                      x
                     </span>
                     <span class="msupsub">
                      <span class="vlist-t vlist-t2">
                       <span class="vlist-r">
                        <span class="vlist" style="height: 0.3117em;">
                         <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                          <span class="pstrut" style="height: 2.7em;">
                          </span>
                          <span class="sizing reset-size6 size3 mtight">
                           <span class="mord mtight">
                            <span class="mord mathnormal mtight">
                             i
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                        <span class="vlist-s">
                         â€‹
                        </span>
                       </span>
                       <span class="vlist-r">
                        <span class="vlist" style="height: 0.15em;">
                         <span class="">
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mclose delimcenter" style="top: 0em;">
                    )
                   </span>
                  </span>
                 </span>
                </span>
                <span class="" style="top: -3.4833em;">
                 <span class="pstrut" style="height: 3.4783em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mrel">
                   â†
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    <span class="mord mathnormal">
                     d
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.8019em;">
                        <span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight">
                            i
                           </span>
                           <span class="mbin mtight">
                            âˆ’
                           </span>
                           <span class="mord mtight">
                            1
                           </span>
                          </span>
                         </span>
                        </span>
                        <span class="" style="top: -3.113em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mtight">
                            â€²
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        â€‹
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.3053em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mord">
                    <span class="mord mathnormal">
                     e
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.8213em;">
                        <span class="" style="top: -3.113em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mtight">
                            <span class="mord mathnormal mtight">
                             m
                            </span>
                            <span class="msupsub">
                             <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                               <span class="vlist" style="height: 0.3281em;">
                                <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                 <span class="pstrut" style="height: 2.5em;">
                                 </span>
                                 <span class="sizing reset-size3 size1 mtight">
                                  <span class="mord mtight">
                                   <span class="mord mathnormal mtight">
                                    i
                                   </span>
                                   <span class="mbin mtight">
                                    âˆ’
                                   </span>
                                   <span class="mord mtight">
                                    1
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                               <span class="vlist-s">
                                â€‹
                               </span>
                              </span>
                              <span class="vlist-r">
                               <span class="vlist" style="height: 0.2025em;">
                                <span class="">
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                           <span class="mbin mtight">
                            âˆ’
                           </span>
                           <span class="mord mtight">
                            <span class="mord mathnormal mtight">
                             m
                            </span>
                            <span class="msupsub">
                             <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                               <span class="vlist" style="height: 0.3281em;">
                                <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                 <span class="pstrut" style="height: 2.5em;">
                                 </span>
                                 <span class="sizing reset-size3 size1 mtight">
                                  <span class="mord mtight">
                                   <span class="mord mathnormal mtight">
                                    i
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                               <span class="vlist-s">
                                â€‹
                               </span>
                              </span>
                              <span class="vlist-r">
                               <span class="vlist" style="height: 0.143em;">
                                <span class="">
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mspace" style="margin-right: 0.2222em;">
                  </span>
                  <span class="mbin">
                   +
                  </span>
                  <span class="mspace" style="margin-right: 0.2222em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    <span class="mord mathnormal">
                     e
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.8213em;">
                        <span class="" style="top: -3.113em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mtight">
                            <span class="mord mathnormal mtight">
                             x
                            </span>
                            <span class="msupsub">
                             <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                               <span class="vlist" style="height: 0.3281em;">
                                <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                 <span class="pstrut" style="height: 2.5em;">
                                 </span>
                                 <span class="sizing reset-size3 size1 mtight">
                                  <span class="mord mtight">
                                   <span class="mord mathnormal mtight">
                                    i
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                               <span class="vlist-s">
                                â€‹
                               </span>
                              </span>
                              <span class="vlist-r">
                               <span class="vlist" style="height: 0.143em;">
                                <span class="">
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                           <span class="mbin mtight">
                            âˆ’
                           </span>
                           <span class="mord mtight">
                            <span class="mord mathnormal mtight">
                             m
                            </span>
                            <span class="msupsub">
                             <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                               <span class="vlist" style="height: 0.3281em;">
                                <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                 <span class="pstrut" style="height: 2.5em;">
                                 </span>
                                 <span class="sizing reset-size3 size1 mtight">
                                  <span class="mord mtight">
                                   <span class="mord mathnormal mtight">
                                    i
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                               <span class="vlist-s">
                                â€‹
                               </span>
                              </span>
                              <span class="vlist-r">
                               <span class="vlist" style="height: 0.143em;">
                                <span class="">
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="" style="top: -1.3449em;">
                 <span class="pstrut" style="height: 3.4783em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mrel">
                   â†
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    <span class="mord mathnormal">
                     o
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.8019em;">
                        <span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight">
                            i
                           </span>
                           <span class="mbin mtight">
                            âˆ’
                           </span>
                           <span class="mord mtight">
                            1
                           </span>
                          </span>
                         </span>
                        </span>
                        <span class="" style="top: -3.113em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mtight">
                            â€²
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        â€‹
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.3053em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mord">
                   <span class="mopen nulldelimiter">
                   </span>
                   <span class="mfrac">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 1.4783em;">
                       <span class="" style="top: -2.314em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="mord">
                         <span class="mord">
                          <span class="mord">
                           <span class="mord mathnormal">
                            d
                           </span>
                           <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.7337em;">
                               <span class="" style="top: -2.4231em; margin-left: 0em; margin-right: 0.05em;">
                                <span class="pstrut" style="height: 2.7em;">
                                </span>
                                <span class="sizing reset-size6 size3 mtight">
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   i
                                  </span>
                                 </span>
                                </span>
                               </span>
                               <span class="" style="top: -3.0448em; margin-right: 0.05em;">
                                <span class="pstrut" style="height: 2.7em;">
                                </span>
                                <span class="sizing reset-size6 size3 mtight">
                                 <span class="mord mtight">
                                  <span class="mord mtight">
                                   â€²
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               â€‹
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.2769em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -3.23em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="frac-line" style="border-bottom-width: 0.04em;">
                        </span>
                       </span>
                       <span class="" style="top: -3.707em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="mord">
                         <span class="mord">
                          <span class="mord">
                           <span class="mord mathnormal">
                            d
                           </span>
                           <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.7519em;">
                               <span class="" style="top: -2.4413em; margin-left: 0em; margin-right: 0.05em;">
                                <span class="pstrut" style="height: 2.7em;">
                                </span>
                                <span class="sizing reset-size6 size3 mtight">
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   i
                                  </span>
                                  <span class="mbin mtight">
                                   âˆ’
                                  </span>
                                  <span class="mord mtight">
                                   1
                                  </span>
                                 </span>
                                </span>
                               </span>
                               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                                <span class="pstrut" style="height: 2.7em;">
                                </span>
                                <span class="sizing reset-size6 size3 mtight">
                                 <span class="mord mtight">
                                  <span class="mord mtight">
                                   â€²
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               â€‹
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.317em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="mord">
                           <span class="mord mathnormal">
                            e
                           </span>
                           <span class="msupsub">
                            <span class="vlist-t">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.7713em;">
                               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                                <span class="pstrut" style="height: 2.7em;">
                                </span>
                                <span class="sizing reset-size6 size3 mtight">
                                 <span class="mord mtight">
                                  <span class="mord mtight">
                                   <span class="mord mathnormal mtight">
                                    m
                                   </span>
                                   <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                     <span class="vlist-r">
                                      <span class="vlist" style="height: 0.3281em;">
                                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                        <span class="pstrut" style="height: 2.5em;">
                                        </span>
                                        <span class="sizing reset-size3 size1 mtight">
                                         <span class="mord mtight">
                                          <span class="mord mathnormal mtight">
                                           i
                                          </span>
                                          <span class="mbin mtight">
                                           âˆ’
                                          </span>
                                          <span class="mord mtight">
                                           1
                                          </span>
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                      <span class="vlist-s">
                                       â€‹
                                      </span>
                                     </span>
                                     <span class="vlist-r">
                                      <span class="vlist" style="height: 0.2025em;">
                                       <span class="">
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                  <span class="mbin mtight">
                                   âˆ’
                                  </span>
                                  <span class="mord mtight">
                                   <span class="mord mathnormal mtight">
                                    m
                                   </span>
                                   <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                     <span class="vlist-r">
                                      <span class="vlist" style="height: 0.3281em;">
                                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                        <span class="pstrut" style="height: 2.5em;">
                                        </span>
                                        <span class="sizing reset-size3 size1 mtight">
                                         <span class="mord mtight">
                                          <span class="mord mathnormal mtight">
                                           i
                                          </span>
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                      <span class="vlist-s">
                                       â€‹
                                      </span>
                                     </span>
                                     <span class="vlist-r">
                                      <span class="vlist" style="height: 0.143em;">
                                       <span class="">
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.9629em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mclose nulldelimiter">
                   </span>
                  </span>
                  <span class="mspace" style="margin-right: 0.2222em;">
                  </span>
                  <span class="mbin">
                   +
                  </span>
                  <span class="mspace" style="margin-right: 0.2222em;">
                  </span>
                  <span class="mord">
                   <span class="mopen nulldelimiter">
                   </span>
                   <span class="mfrac">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 1.4483em;">
                       <span class="" style="top: -2.314em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="mord">
                         <span class="mord">
                          <span class="mord">
                           <span class="mord mathnormal">
                            d
                           </span>
                           <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.7337em;">
                               <span class="" style="top: -2.4231em; margin-left: 0em; margin-right: 0.05em;">
                                <span class="pstrut" style="height: 2.7em;">
                                </span>
                                <span class="sizing reset-size6 size3 mtight">
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   i
                                  </span>
                                 </span>
                                </span>
                               </span>
                               <span class="" style="top: -3.0448em; margin-right: 0.05em;">
                                <span class="pstrut" style="height: 2.7em;">
                                </span>
                                <span class="sizing reset-size6 size3 mtight">
                                 <span class="mord mtight">
                                  <span class="mord mtight">
                                   â€²
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               â€‹
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.2769em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -3.23em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="frac-line" style="border-bottom-width: 0.04em;">
                        </span>
                       </span>
                       <span class="" style="top: -3.677em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="mord">
                         <span class="mord">
                          <span class="mord">
                           <span class="mord mathnormal">
                            e
                           </span>
                           <span class="msupsub">
                            <span class="vlist-t">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.7713em;">
                               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                                <span class="pstrut" style="height: 2.7em;">
                                </span>
                                <span class="sizing reset-size6 size3 mtight">
                                 <span class="mord mtight">
                                  <span class="mord mtight">
                                   <span class="mord mathnormal mtight">
                                    x
                                   </span>
                                   <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                     <span class="vlist-r">
                                      <span class="vlist" style="height: 0.3281em;">
                                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                        <span class="pstrut" style="height: 2.5em;">
                                        </span>
                                        <span class="sizing reset-size3 size1 mtight">
                                         <span class="mord mtight">
                                          <span class="mord mathnormal mtight">
                                           i
                                          </span>
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                      <span class="vlist-s">
                                       â€‹
                                      </span>
                                     </span>
                                     <span class="vlist-r">
                                      <span class="vlist" style="height: 0.143em;">
                                       <span class="">
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                  <span class="mbin mtight">
                                   âˆ’
                                  </span>
                                  <span class="mord mtight">
                                   <span class="mord mathnormal mtight">
                                    m
                                   </span>
                                   <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                     <span class="vlist-r">
                                      <span class="vlist" style="height: 0.3281em;">
                                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                        <span class="pstrut" style="height: 2.5em;">
                                        </span>
                                        <span class="sizing reset-size3 size1 mtight">
                                         <span class="mord mtight">
                                          <span class="mord mathnormal mtight">
                                           i
                                          </span>
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                      <span class="vlist-s">
                                       â€‹
                                      </span>
                                     </span>
                                     <span class="vlist-r">
                                      <span class="vlist" style="height: 0.143em;">
                                       <span class="">
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.9629em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mclose nulldelimiter">
                   </span>
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal" style="margin-right: 0.2222em;">
                    V
                   </span>
                   <span class="mopen">
                    [
                   </span>
                   <span class="mord mathnormal">
                    i
                   </span>
                   <span class="mpunct">
                    ,
                   </span>
                   <span class="mspace" style="margin-right: 0.2778em;">
                   </span>
                   <span class="mrel">
                    :
                   </span>
                   <span class="mclose">
                    ]
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                â€‹
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 3.3963em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     <strong>
      end
     </strong>
    </p>
    <p>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         O 
         
        
          [ 
         
        
          k 
         
        
          , 
         
        
          : 
         
        
          ] 
         
        
          â† 
         
         
         
           o 
          
         
           N 
          
         
           â€² 
          
         
        
       
         O[k,:] \leftarrow \bm{o}^{\prime}_N
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           O
          </span>
          <span class="mopen">
           [
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0315em;">
           k
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           :
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mclose">
           ]
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           â†
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1.0489em; vertical-align: -0.247em;">
          </span>
          <span class="mord">
           <span class="mord">
            <span class="mord">
             <span class="mord boldsymbol">
              o
             </span>
            </span>
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.8019em;">
               <span class="" style="top: -2.453em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                  N
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.113em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   â€²
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.247em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     çŠ¶æ€é‡
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        x 
         
        
          i 
         
        
       
         , 
        
       
         Â  
        
        
        
          m 
         
        
          i 
         
        
       
         , 
        
       
         Â  
        
        
        
          d 
         
        
          i 
         
        
          â€² 
         
        
       
         , 
        
        
        
          o 
         
        
          i 
         
        
          â€² 
         
        
       
      
        x_i, \ m_i, \ d^{\prime}_i, \bm{o}^{\prime}_i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.0106em; vertical-align: -0.2587em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           x
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace">
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           m
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace">
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           d
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7519em;">
              <span class="" style="top: -2.4413em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  â€²
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2587em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          <span class="mord">
           <span class="mord">
            <span class="mord boldsymbol">
             o
            </span>
           </span>
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7519em;">
              <span class="" style="top: -2.4413em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  â€²
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2587em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     å ç”¨çš„å†…å­˜éƒ½å¾ˆå°ï¼Œå¯ä»¥éå¸¸è½»æ¾çš„æ”¾å…¥ GPU çš„ shared memory ä¸­ã€‚å¦å¤–ç”±äºæ­¤ç®—æ³•ä¸­çš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯å…³è”çš„ï¼Œå› æ­¤å®ƒä¸ tiling å…¼å®¹ï¼Œå¦‚æœæˆ‘ä»¬é€ä¸ª tiling è®¡ç®—ï¼Œåˆ™è¯¥ç®—æ³•å¯ä»¥è¡¨ç¤ºä¸ºï¼š
    </p>
    <p>
     <strong>
      Algorithm FlashAttentionï¼ˆTilingï¼‰
     </strong>
    </p>
    <p>
     NEW NOTATIONS
    </p>
    <ul>
     <li>
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         b 
         
        
       
         b
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6944em;">
          </span>
          <span class="mord mathnormal">
           b
          </span>
         </span>
        </span>
       </span>
      </span>
      ï¼štile çš„ block size å¤§å°
     </li>
     <li>
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         #tiles 
         
        
       
         \text{\#tiles}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
          </span>
          <span class="mord text">
           <span class="mord">
            #tiles
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ï¼šæ¯è¡Œ tile çš„æ•°é‡ï¼Œ
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         N 
         
        
          = 
         
        
          b 
         
        
          Ã— 
         
        
          #tiles 
         
        
       
         N= b \times \text{\#tiles}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.109em;">
           N
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.7778em; vertical-align: -0.0833em;">
          </span>
          <span class="mord mathnormal">
           b
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           Ã—
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
          </span>
          <span class="mord text">
           <span class="mord">
            #tiles
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </li>
     <li>
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         x 
          
         
           i 
          
         
        
       
         \bm{x}_i
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.5944em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord">
            <span class="mord">
             <span class="mord boldsymbol">
              x
             </span>
            </span>
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ï¼šå­˜å‚¨ç¬¬
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         i 
         
        
       
         i
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6595em;">
          </span>
          <span class="mord mathnormal">
           i
          </span>
         </span>
        </span>
       </span>
      </span>
      ä¸ª tile çš„
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         Q 
         
        
          [ 
         
        
          k 
         
        
          ] 
         
         
         
           K 
          
         
           T 
          
         
        
       
         Q[k]K^T
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1.0913em; vertical-align: -0.25em;">
          </span>
          <span class="mord mathnormal">
           Q
          </span>
          <span class="mopen">
           [
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0315em;">
           k
          </span>
          <span class="mclose">
           ]
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0715em;">
            K
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.8413em;">
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                  T
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      å€¼çš„å‘é‡
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         [ 
         
        
          ( 
         
        
          i 
         
        
          âˆ’ 
         
        
          1 
         
        
          ) 
         
        
          b 
         
        
          : 
         
        
          i 
         
        
          b 
         
        
          ] 
         
        
       
         [(i-1)b:ib]
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mopen">
           [(
          </span>
          <span class="mord mathnormal">
           i
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           âˆ’
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord">
           1
          </span>
          <span class="mclose">
           )
          </span>
          <span class="mord mathnormal">
           b
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           :
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord mathnormal">
           ib
          </span>
          <span class="mclose">
           ]
          </span>
         </span>
        </span>
       </span>
      </span>
     </li>
     <li>
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         m 
          
         
           i 
          
          
          
            ( 
           
          
            l 
           
          
            o 
           
          
            c 
           
          
            a 
           
          
            l 
           
          
            ) 
           
          
         
        
       
         m_i^{\mathrm{(local)}}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1.3217em; vertical-align: -0.2769em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            m
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.0448em;">
               <span class="" style="top: -2.4231em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mopen mtight">
                    (
                   </span>
                   <span class="mord mathrm mtight">
                    local
                   </span>
                   <span class="mclose mtight">
                    )
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2769em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ï¼š
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         x 
          
         
           i 
          
         
        
       
         \bm{x}_i
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.5944em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord">
            <span class="mord">
             <span class="mord boldsymbol">
              x
             </span>
            </span>
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      å†…éƒ¨çš„å±€éƒ¨æœ€å¤§å€¼
     </li>
    </ul>
    <p>
     BODY
    </p>
    <p>
     <strong>
      for
     </strong>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        i 
        
       
         â† 
        
       
         1 
        
       
         , 
        
       
         #tile 
        
       
      
        i \leftarrow 1,\text{\#tile}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6595em;">
         </span>
         <span class="mord mathnormal">
          i
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          â†
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord text">
          <span class="mord">
           #tile
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <strong>
      do
     </strong>
    </p>
    <p>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         x 
             
            
              i 
             
            
           
          
          
           
            
             
            
              Â  
             
            
              â† 
             
            
              Â  
             
            
              Q 
             
            
              [ 
             
            
              k 
             
            
              , 
             
            
              : 
             
            
              ] 
             
             
             
               K 
              
             
               T 
              
             
            
              [ 
             
            
              : 
             
            
              , 
             
            
              ( 
             
            
              i 
             
            
              âˆ’ 
             
            
              1 
             
            
              ) 
             
            
              b 
             
            
              : 
             
            
              i 
             
            
              b 
             
            
              ] 
             
            
           
          
         
         
          
           
            
            
              m 
             
            
              i 
             
            
              (local) 
             
            
           
          
          
           
            
             
            
              Â  
             
            
              = 
             
            
              Â  
             
             
              
              
                max 
               
              
                â¡ 
               
              
              
              
                j 
               
              
                = 
               
              
                1 
               
              
             
               b 
              
             
            
              ( 
             
             
             
               x 
              
             
               i 
              
             
            
              [ 
             
            
              j 
             
            
              ] 
             
            
              ) 
             
            
           
          
         
         
          
           
            
            
              m 
             
            
              i 
             
            
           
          
          
           
            
             
            
              Â  
             
            
              â† 
             
            
              Â  
             
            
              max 
             
            
              â¡ 
             
            
              ( 
             
             
             
               m 
              
              
              
                i 
               
              
                âˆ’ 
               
              
                1 
               
              
             
            
              , 
             
             
             
               m 
              
             
               i 
              
             
               (local) 
              
             
            
              ) 
             
            
           
          
         
         
          
           
            
            
              d 
             
            
              i 
             
            
              â€² 
             
            
           
          
          
           
            
             
            
              Â  
             
            
              â† 
             
            
              Â  
             
             
             
               d 
              
              
              
                i 
               
              
                âˆ’ 
               
              
                1 
               
              
             
               â€² 
              
             
             
             
               e 
              
              
               
               
                 m 
                
                
                
                  i 
                 
                
                  âˆ’ 
                 
                
                  1 
                 
                
               
              
                âˆ’ 
               
               
               
                 m 
                
               
                 i 
                
               
              
             
            
              + 
             
             
             
               âˆ‘ 
              
              
              
                j 
               
              
                = 
               
              
                1 
               
              
             
               b 
              
             
             
             
               e 
              
              
               
               
                 x 
                
               
                 i 
                
               
              
                [ 
               
              
                j 
               
              
                ] 
               
              
                âˆ’ 
               
               
               
                 m 
                
               
                 i 
                
               
              
             
            
           
          
         
         
          
           
            
            
              o 
             
            
              i 
             
            
              â€² 
             
            
           
          
          
           
            
             
            
              Â  
             
            
              â† 
             
            
              Â  
             
             
             
               o 
              
              
              
                i 
               
              
                âˆ’ 
               
              
                1 
               
              
             
               â€² 
              
             
             
              
               
               
                 d 
                
                
                
                  i 
                 
                
                  âˆ’ 
                 
                
                  1 
                 
                
               
                 â€² 
                
               
               
               
                 e 
                
                
                 
                 
                   m 
                  
                  
                  
                    i 
                   
                  
                    âˆ’ 
                   
                  
                    1 
                   
                  
                 
                
                  âˆ’ 
                 
                 
                 
                   m 
                  
                 
                   i 
                  
                 
                
               
              
              
              
                d 
               
              
                i 
               
              
                â€² 
               
              
             
            
              + 
             
             
             
               âˆ‘ 
              
              
              
                j 
               
              
                = 
               
              
                1 
               
              
             
               b 
              
             
             
              
              
                e 
               
               
                
                
                  x 
                 
                
                  i 
                 
                
               
                 [ 
                
               
                 j 
                
               
                 ] 
                
               
                 âˆ’ 
                
                
                
                  m 
                 
                
                  i 
                 
                
               
              
              
              
                d 
               
              
                i 
               
              
                â€² 
               
              
             
            
              V 
             
            
              [ 
             
            
              j 
             
            
              + 
             
            
              ( 
             
            
              i 
             
            
              âˆ’ 
             
            
              1 
             
            
              ) 
             
            
              b 
             
            
              , 
             
            
              : 
             
            
              ] 
             
            
           
          
         
        
       
         \begin{split}\bm{x}_{i}&amp;\ \leftarrow\ Q[k, : ] K^{T}[:,(i-1) b : i b]\\ m_{i}^{\text{(local)}}&amp;\ =\ \max_{j=1}^{b} (\bm{x}_{i} [j]) \\ m_{i}&amp;\ \leftarrow\ \max\big(m_{i-1},m_{i}^{\text{(local)}} \big)\\ d_{i}^{\prime}&amp;\ \leftarrow\ d_{i-1}^{\prime} e^{m_{i-1}-m_{i}} + \sum_{j=1}^{b} e^{\bm{x}_{i}[j]-m_{i}}\\ \bm{o}_{i}^{\prime}&amp;\ \leftarrow\ \bm{o}_{i-1}^{\prime} \frac{d_{i-1}^{\prime} e^{m_{i-1}-m_{i}}}{d_{i}^{\prime}} + \sum_{j=1}^{b} \frac{e^{\bm{x}_{i}[j]-m_{i}}}{d_{i}^{\prime}}V[j+(i-1) b, : ]\end{split}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 12.7364em; vertical-align: -6.1182em;">
          </span>
          <span class="mord">
           <span class="mtable">
            <span class="col-align-r">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 6.6182em;">
                <span class="" style="top: -9.563em;">
                 <span class="pstrut" style="height: 3.8361em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                   <span class="mord">
                    <span class="mord">
                     <span class="mord boldsymbol">
                      x
                     </span>
                    </span>
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3117em;">
                       <span class="" style="top: -2.55em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight">
                           i
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.15em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="" style="top: -7.6863em;">
                 <span class="pstrut" style="height: 3.8361em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                   <span class="mord mathnormal">
                    m
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 1.0448em;">
                       <span class="" style="top: -2.4231em; margin-left: 0em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight">
                           i
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord text mtight">
                           <span class="mord mtight">
                            (local)
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.2769em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="" style="top: -5.4777em;">
                 <span class="pstrut" style="height: 3.8361em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                   <span class="mord mathnormal">
                    m
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3117em;">
                       <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight">
                           i
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.15em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="" style="top: -2.9816em;">
                 <span class="pstrut" style="height: 3.8361em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                   <span class="mord mathnormal">
                    d
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.8019em;">
                       <span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight">
                           i
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -3.113em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mtight">
                           â€²
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.247em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="" style="top: 0.5683em;">
                 <span class="pstrut" style="height: 3.8361em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                   <span class="mord">
                    <span class="mord">
                     <span class="mord boldsymbol">
                      o
                     </span>
                    </span>
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.8019em;">
                       <span class="" style="top: -2.453em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight">
                           i
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -3.113em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mtight">
                           â€²
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.247em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                â€‹
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 6.1182em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="col-align-l">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 6.6182em;">
                <span class="" style="top: -9.563em;">
                 <span class="pstrut" style="height: 3.8361em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                  </span>
                  <span class="mspace">
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mrel">
                   â†
                  </span>
                  <span class="mspace">
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mord mathnormal">
                   Q
                  </span>
                  <span class="mopen">
                   [
                  </span>
                  <span class="mord mathnormal" style="margin-right: 0.0315em;">
                   k
                  </span>
                  <span class="mpunct">
                   ,
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mrel">
                   :
                  </span>
                  <span class="mclose">
                   ]
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal" style="margin-right: 0.0715em;">
                    K
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.8913em;">
                       <span class="" style="top: -3.113em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                           T
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mopen">
                   [
                  </span>
                  <span class="mrel">
                   :
                  </span>
                  <span class="mpunct">
                   ,
                  </span>
                  <span class="mspace" style="margin-right: 0.1667em;">
                  </span>
                  <span class="mopen">
                   (
                  </span>
                  <span class="mord mathnormal">
                   i
                  </span>
                  <span class="mspace" style="margin-right: 0.2222em;">
                  </span>
                  <span class="mbin">
                   âˆ’
                  </span>
                  <span class="mspace" style="margin-right: 0.2222em;">
                  </span>
                  <span class="mord">
                   1
                  </span>
                  <span class="mclose">
                   )
                  </span>
                  <span class="mord mathnormal">
                   b
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mrel">
                   :
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mord mathnormal">
                   ib
                  </span>
                  <span class="mclose">
                   ]
                  </span>
                 </span>
                </span>
                <span class="" style="top: -7.6863em;">
                 <span class="pstrut" style="height: 3.8361em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                  </span>
                  <span class="mspace">
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mrel">
                   =
                  </span>
                  <span class="mspace">
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mop op-limits">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 1.2167em;">
                      <span class="" style="top: -2.3723em; margin-left: 0em;">
                       <span class="pstrut" style="height: 3em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mtight">
                         <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                          j
                         </span>
                         <span class="mrel mtight">
                          =
                         </span>
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="" style="top: -3em;">
                       <span class="pstrut" style="height: 3em;">
                       </span>
                       <span class="">
                        <span class="mop">
                         max
                        </span>
                       </span>
                      </span>
                      <span class="" style="top: -3.6306em; margin-left: 0em;">
                       <span class="pstrut" style="height: 3em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mtight">
                         <span class="mord mathnormal mtight">
                          b
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.8638em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mopen">
                   (
                  </span>
                  <span class="mord">
                   <span class="mord">
                    <span class="mord">
                     <span class="mord boldsymbol">
                      x
                     </span>
                    </span>
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3117em;">
                       <span class="" style="top: -2.55em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight">
                           i
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.15em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mopen">
                   [
                  </span>
                  <span class="mord mathnormal" style="margin-right: 0.0572em;">
                   j
                  </span>
                  <span class="mclose">
                   ])
                  </span>
                 </span>
                </span>
                <span class="" style="top: -5.4777em;">
                 <span class="pstrut" style="height: 3.8361em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                  </span>
                  <span class="mspace">
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mrel">
                   â†
                  </span>
                  <span class="mspace">
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mop">
                   max
                  </span>
                  <span class="mspace" style="margin-right: 0.1667em;">
                  </span>
                  <span class="mord">
                   <span class="delimsizing size1">
                    (
                   </span>
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal">
                    m
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3117em;">
                       <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight">
                           i
                          </span>
                          <span class="mbin mtight">
                           âˆ’
                          </span>
                          <span class="mord mtight">
                           1
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.2083em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mpunct">
                   ,
                  </span>
                  <span class="mspace" style="margin-right: 0.1667em;">
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal">
                    m
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 1.0448em;">
                       <span class="" style="top: -2.4231em; margin-left: 0em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight">
                           i
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord text mtight">
                           <span class="mord mtight">
                            (local)
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.2769em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mord">
                   <span class="delimsizing size1">
                    )
                   </span>
                  </span>
                 </span>
                </span>
                <span class="" style="top: -2.9816em;">
                 <span class="pstrut" style="height: 3.8361em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                  </span>
                  <span class="mspace">
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mrel">
                   â†
                  </span>
                  <span class="mspace">
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal">
                    d
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.8019em;">
                       <span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight">
                           i
                          </span>
                          <span class="mbin mtight">
                           âˆ’
                          </span>
                          <span class="mord mtight">
                           1
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -3.113em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mtight">
                           â€²
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3053em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal">
                    e
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.8213em;">
                       <span class="" style="top: -3.113em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight">
                            m
                           </span>
                           <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.3281em;">
                               <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                <span class="pstrut" style="height: 2.5em;">
                                </span>
                                <span class="sizing reset-size3 size1 mtight">
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   i
                                  </span>
                                  <span class="mbin mtight">
                                   âˆ’
                                  </span>
                                  <span class="mord mtight">
                                   1
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               â€‹
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.2025em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="mbin mtight">
                           âˆ’
                          </span>
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight">
                            m
                           </span>
                           <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.3281em;">
                               <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                <span class="pstrut" style="height: 2.5em;">
                                </span>
                                <span class="sizing reset-size3 size1 mtight">
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   i
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               â€‹
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.143em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mspace" style="margin-right: 0.2222em;">
                  </span>
                  <span class="mbin">
                   +
                  </span>
                  <span class="mspace" style="margin-right: 0.2222em;">
                  </span>
                  <span class="mop op-limits">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 1.8361em;">
                      <span class="" style="top: -1.8723em; margin-left: 0em;">
                       <span class="pstrut" style="height: 3.05em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mtight">
                         <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                          j
                         </span>
                         <span class="mrel mtight">
                          =
                         </span>
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="" style="top: -3.05em;">
                       <span class="pstrut" style="height: 3.05em;">
                       </span>
                       <span class="">
                        <span class="mop op-symbol large-op">
                         âˆ‘
                        </span>
                       </span>
                      </span>
                      <span class="" style="top: -4.3em; margin-left: 0em;">
                       <span class="pstrut" style="height: 3.05em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mtight">
                         <span class="mord mathnormal mtight">
                          b
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 1.4138em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mspace" style="margin-right: 0.1667em;">
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal">
                    e
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.938em;">
                       <span class="" style="top: -3.113em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mtight">
                           <span class="mord mtight">
                            <span class="mord mtight">
                             <span class="mord boldsymbol mtight">
                              x
                             </span>
                            </span>
                           </span>
                           <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.3281em;">
                               <span class="" style="top: -2.357em; margin-right: 0.0714em;">
                                <span class="pstrut" style="height: 2.5em;">
                                </span>
                                <span class="sizing reset-size3 size1 mtight">
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   i
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               â€‹
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.143em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="mopen mtight">
                           [
                          </span>
                          <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                           j
                          </span>
                          <span class="mclose mtight">
                           ]
                          </span>
                          <span class="mbin mtight">
                           âˆ’
                          </span>
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight">
                            m
                           </span>
                           <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.3281em;">
                               <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                <span class="pstrut" style="height: 2.5em;">
                                </span>
                                <span class="sizing reset-size3 size1 mtight">
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   i
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               â€‹
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.143em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="" style="top: 0.5683em;">
                 <span class="pstrut" style="height: 3.8361em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                  </span>
                  <span class="mspace">
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mrel">
                   â†
                  </span>
                  <span class="mspace">
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    <span class="mord">
                     <span class="mord boldsymbol">
                      o
                     </span>
                    </span>
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.8019em;">
                       <span class="" style="top: -2.453em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight">
                           i
                          </span>
                          <span class="mbin mtight">
                           âˆ’
                          </span>
                          <span class="mord mtight">
                           1
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -3.113em; margin-right: 0.05em;">
                        <span class="pstrut" style="height: 2.7em;">
                        </span>
                        <span class="sizing reset-size6 size3 mtight">
                         <span class="mord mtight">
                          <span class="mord mtight">
                           â€²
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3053em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mord">
                   <span class="mopen nulldelimiter">
                   </span>
                   <span class="mfrac">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 1.4783em;">
                       <span class="" style="top: -2.314em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="mord">
                         <span class="mord">
                          <span class="mord mathnormal">
                           d
                          </span>
                          <span class="msupsub">
                           <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.7337em;">
                              <span class="" style="top: -2.4231em; margin-left: 0em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mathnormal mtight">
                                  i
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="" style="top: -3.0448em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mtight">
                                  â€²
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="vlist-s">
                              â€‹
                             </span>
                            </span>
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.2769em;">
                              <span class="">
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -3.23em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="frac-line" style="border-bottom-width: 0.04em;">
                        </span>
                       </span>
                       <span class="" style="top: -3.707em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="mord">
                         <span class="mord">
                          <span class="mord mathnormal">
                           d
                          </span>
                          <span class="msupsub">
                           <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.7519em;">
                              <span class="" style="top: -2.4413em; margin-left: 0em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mathnormal mtight">
                                  i
                                 </span>
                                 <span class="mbin mtight">
                                  âˆ’
                                 </span>
                                 <span class="mord mtight">
                                  1
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="" style="top: -3.063em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mtight">
                                  â€²
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="vlist-s">
                              â€‹
                             </span>
                            </span>
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.317em;">
                              <span class="">
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                         <span class="mord">
                          <span class="mord mathnormal">
                           e
                          </span>
                          <span class="msupsub">
                           <span class="vlist-t">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.7713em;">
                              <span class="" style="top: -3.063em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   m
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.3281em;">
                                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                       <span class="pstrut" style="height: 2.5em;">
                                       </span>
                                       <span class="sizing reset-size3 size1 mtight">
                                        <span class="mord mtight">
                                         <span class="mord mathnormal mtight">
                                          i
                                         </span>
                                         <span class="mbin mtight">
                                          âˆ’
                                         </span>
                                         <span class="mord mtight">
                                          1
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="vlist-s">
                                      â€‹
                                     </span>
                                    </span>
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.2025em;">
                                      <span class="">
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                 <span class="mbin mtight">
                                  âˆ’
                                 </span>
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   m
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.3281em;">
                                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                       <span class="pstrut" style="height: 2.5em;">
                                       </span>
                                       <span class="sizing reset-size3 size1 mtight">
                                        <span class="mord mtight">
                                         <span class="mord mathnormal mtight">
                                          i
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="vlist-s">
                                      â€‹
                                     </span>
                                    </span>
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.143em;">
                                      <span class="">
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.9629em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mclose nulldelimiter">
                   </span>
                  </span>
                  <span class="mspace" style="margin-right: 0.2222em;">
                  </span>
                  <span class="mbin">
                   +
                  </span>
                  <span class="mspace" style="margin-right: 0.2222em;">
                  </span>
                  <span class="mop op-limits">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 1.8361em;">
                      <span class="" style="top: -1.8723em; margin-left: 0em;">
                       <span class="pstrut" style="height: 3.05em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mtight">
                         <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                          j
                         </span>
                         <span class="mrel mtight">
                          =
                         </span>
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="" style="top: -3.05em;">
                       <span class="pstrut" style="height: 3.05em;">
                       </span>
                       <span class="">
                        <span class="mop op-symbol large-op">
                         âˆ‘
                        </span>
                       </span>
                      </span>
                      <span class="" style="top: -4.3em; margin-left: 0em;">
                       <span class="pstrut" style="height: 3.05em;">
                       </span>
                       <span class="sizing reset-size6 size3 mtight">
                        <span class="mord mtight">
                         <span class="mord mathnormal mtight">
                          b
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 1.4138em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mspace" style="margin-right: 0.1667em;">
                  </span>
                  <span class="mord">
                   <span class="mopen nulldelimiter">
                   </span>
                   <span class="mfrac">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 1.565em;">
                       <span class="" style="top: -2.314em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="mord">
                         <span class="mord">
                          <span class="mord mathnormal">
                           d
                          </span>
                          <span class="msupsub">
                           <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.7337em;">
                              <span class="" style="top: -2.4231em; margin-left: 0em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mathnormal mtight">
                                  i
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="" style="top: -3.0448em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mtight">
                                  â€²
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="vlist-s">
                              â€‹
                             </span>
                            </span>
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.2769em;">
                              <span class="">
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -3.23em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="frac-line" style="border-bottom-width: 0.04em;">
                        </span>
                       </span>
                       <span class="" style="top: -3.677em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="mord">
                         <span class="mord">
                          <span class="mord mathnormal">
                           e
                          </span>
                          <span class="msupsub">
                           <span class="vlist-t">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.888em;">
                              <span class="" style="top: -3.063em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mord mtight">
                                  <span class="mord mtight">
                                   <span class="mord mtight">
                                    <span class="mord boldsymbol mtight">
                                     x
                                    </span>
                                   </span>
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.3281em;">
                                      <span class="" style="top: -2.357em; margin-right: 0.0714em;">
                                       <span class="pstrut" style="height: 2.5em;">
                                       </span>
                                       <span class="sizing reset-size3 size1 mtight">
                                        <span class="mord mtight">
                                         <span class="mord mathnormal mtight">
                                          i
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="vlist-s">
                                      â€‹
                                     </span>
                                    </span>
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.143em;">
                                      <span class="">
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                 <span class="mopen mtight">
                                  [
                                 </span>
                                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                                  j
                                 </span>
                                 <span class="mclose mtight">
                                  ]
                                 </span>
                                 <span class="mbin mtight">
                                  âˆ’
                                 </span>
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight">
                                   m
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.3281em;">
                                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                                       <span class="pstrut" style="height: 2.5em;">
                                       </span>
                                       <span class="sizing reset-size3 size1 mtight">
                                        <span class="mord mtight">
                                         <span class="mord mathnormal mtight">
                                          i
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="vlist-s">
                                      â€‹
                                     </span>
                                    </span>
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.143em;">
                                      <span class="">
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.9629em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mclose nulldelimiter">
                   </span>
                  </span>
                  <span class="mord mathnormal" style="margin-right: 0.2222em;">
                   V
                  </span>
                  <span class="mopen">
                   [
                  </span>
                  <span class="mord mathnormal" style="margin-right: 0.0572em;">
                   j
                  </span>
                  <span class="mspace" style="margin-right: 0.2222em;">
                  </span>
                  <span class="mbin">
                   +
                  </span>
                  <span class="mspace" style="margin-right: 0.2222em;">
                  </span>
                  <span class="mopen">
                   (
                  </span>
                  <span class="mord mathnormal">
                   i
                  </span>
                  <span class="mspace" style="margin-right: 0.2222em;">
                  </span>
                  <span class="mbin">
                   âˆ’
                  </span>
                  <span class="mspace" style="margin-right: 0.2222em;">
                  </span>
                  <span class="mord">
                   1
                  </span>
                  <span class="mclose">
                   )
                  </span>
                  <span class="mord mathnormal">
                   b
                  </span>
                  <span class="mpunct">
                   ,
                  </span>
                  <span class="mspace" style="margin-right: 0.2778em;">
                  </span>
                  <span class="mrel">
                   :
                  </span>
                  <span class="mclose">
                   ]
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                â€‹
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 6.1182em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     <strong>
      end
     </strong>
    </p>
    <p>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         O 
         
        
          [ 
         
        
          k 
         
        
          , 
         
        
          : 
         
        
          ] 
         
        
          â† 
         
         
         
           o 
          
          
          
            N 
           
          
            / 
           
          
            b 
           
          
         
           â€² 
          
         
        
       
         O[k,:] \leftarrow \bm{o}^{\prime}_{N/b}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           O
          </span>
          <span class="mopen">
           [
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0315em;">
           k
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           :
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mclose">
           ]
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           â†
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1.2489em; vertical-align: -0.447em;">
          </span>
          <span class="mord">
           <span class="mord">
            <span class="mord">
             <span class="mord boldsymbol">
              o
             </span>
            </span>
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.8019em;">
               <span class="" style="top: -2.428em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                   N
                  </span>
                  <span class="mord mtight">
                   /
                  </span>
                  <span class="mord mathnormal mtight">
                   b
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.113em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   â€²
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.447em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     ä¸‹å›¾è¯´æ˜äº†å¦‚ä½•å°†è¯¥ç®—æ³•åº”ç”¨åˆ°ç¡¬ä»¶ä¸Šï¼š
    </p>
    <p>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/011cab53bdb4407ea1db49aee3982c94.png#pic_center"/>
    </p>
    <p>
     ä¸Šå›¾è¯´æ˜äº† FlashAttention åœ¨ç¡¬ä»¶ä¸Šçš„è®¡ç®—æ–¹å¼ï¼Œå…¶ä¸­è“è‰²å—è¡¨ç¤ºåœ¨ SRAM ä¸­çš„ tileï¼Œè€Œçº¢è‰²å—å¯¹åº”äº tile ä¸­çš„ç¬¬
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        i 
        
       
      
        i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6595em;">
         </span>
         <span class="mord mathnormal">
          i
         </span>
        </span>
       </span>
      </span>
     </span>
     è¡Œï¼Œ
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        L 
        
       
      
        L
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal">
          L
         </span>
        </span>
       </span>
      </span>
     </span>
     è¡¨ç¤ºåºåˆ—é•¿åº¦ï¼Œ
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        D 
        
       
      
        D
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          D
         </span>
        </span>
       </span>
      </span>
     </span>
     è¡¨ç¤ºæ¯ä¸ªå¤´çš„ç»´åº¦ï¼Œ
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        B 
        
       
      
        B
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0502em;">
          B
         </span>
        </span>
       </span>
      </span>
     </span>
     è¡¨ç¤º block size çš„å¤§å°
    </p>
    <p>
     å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ•´ä½“ SRAM çš„å†…å­˜å ç”¨ä»…ä»…å–å†³äº
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        B 
        
       
      
        B
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0502em;">
          B
         </span>
        </span>
       </span>
      </span>
     </span>
     å’Œ
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        D 
        
       
      
        D
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          D
         </span>
        </span>
       </span>
      </span>
     </span>
     ï¼Œä¸
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        L 
        
       
      
        L
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal">
          L
         </span>
        </span>
       </span>
      </span>
     </span>
     æ— å…³ï¼Œå› æ­¤ï¼Œè¯¥ç®—æ³•å¯ä»¥æ‰©å±•åˆ°é•¿ä¸Šä¸‹æ–‡è€Œä¸ä¼šé‡åˆ°å†…å­˜é—®é¢˜ï¼ˆGPU çš„å…±äº«å†…å­˜å¾ˆå°ï¼Œä¾‹å¦‚ H100 æ¶æ„ä¸­ä¸º 228kb/SMï¼‰ã€‚åœ¨è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä»å·¦åˆ°å³éå†
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        K 
         
        
          T 
         
        
       
      
        K^T
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8413em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0715em;">
           K
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8413em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                 T
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     å’Œ
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        A 
        
       
      
        A
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal">
          A
         </span>
        </span>
       </span>
      </span>
     </span>
     ï¼Œä»ä¸Šåˆ°ä¸‹éå†
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        V 
        
       
      
        V
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.2222em;">
          V
         </span>
        </span>
       </span>
      </span>
     </span>
     ï¼Œå¹¶ç›¸åº”åœ°æ›´æ–°
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        m 
        
       
         , 
        
       
         Â  
        
       
         d 
        
       
         , 
        
       
         Â  
        
       
         O 
        
       
      
        m,\ d, \ O
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          m
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace">
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace">
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
        </span>
       </span>
      </span>
     </span>
     çš„çŠ¶æ€
    </p>
    <h3>
     <a id="_285">
     </a>
     ç»“è¯­
    </h3>
    <blockquote>
     <p>
      è¿™ç¯‡æ–‡ç« ä¸»è¦åˆ†äº«äº† FlashAttention çš„æ€æƒ³ï¼ŒFlashAttention æƒ³è¦åšçš„å°±æ˜¯åœ¨å•ä¸ªå¾ªç¯ä¸­å®Œæˆ self-attention çš„æ•´ä¸ªè®¡ç®—
     </p>
     <p>
      æˆ‘ä»¬å…ˆä» safe softmax å‡ºå‘åˆ†æäº† safe softmax ç®—æ³•éœ€è¦å¾ªç¯è¿­ä»£ 3 æ¬¡ï¼Œç¬¬ä¸€æ¬¡å¾ªç¯æ±‚å–åºåˆ—ä¸­çš„æœ€å¤§å€¼
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         m 
          
         
           N 
          
         
        
       
         m_N
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            m
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3283em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                  N
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ï¼Œç¬¬äºŒæ¬¡å¾ªç¯æ±‚å– safe softmax çš„åˆ†æ¯
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         d 
          
         
           N 
          
         
        
       
         d_N
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.8444em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            d
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3283em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                  N
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ï¼Œç¬¬ä¸‰æ¬¡å¾ªç¯æ±‚å–æœ€ç»ˆçš„ softmax å€¼
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         a 
          
         
           i 
          
         
        
       
         a_i
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            a
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ã€‚ç”±äº SRAM ç‰‡ä¸Šå†…å­˜ç©ºé—´æœ‰é™ï¼Œæˆ‘ä»¬æ— æ³•å°†æ‰€æœ‰çš„
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         x 
          
         
           i 
          
         
        
       
         x_i
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            x
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ç¼“å­˜ï¼Œå¯¼è‡´æˆ‘ä»¬åœ¨æ¯æ¬¡è¿­ä»£æ—¶éœ€è¦é‡æ–°è®¿é—®
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         Q 
         
        
          , 
         
        
          K 
         
        
       
         Q,K
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;">
          </span>
          <span class="mord mathnormal">
           Q
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0715em;">
           K
          </span>
         </span>
        </span>
       </span>
      </span>
      ä»¥åŠ¨æ€é‡æ–°è®¡ç®—
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         x 
          
         
           i 
          
         
        
       
         x_i
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            x
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ï¼Œè¿™é€ æˆäº†å¤§é‡çš„ I/O æ“ä½œï¼Œæˆ‘ä»¬å¹¶ä¸å¸Œæœ›çœ‹åˆ°
     </p>
     <p>
      åœ¨ online softmax ä¸­æå‡ºäº†ä¸€ä¸ªæœ‰æ„æ€çš„æƒ³æ³•ï¼Œé‚£å°±æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„åºåˆ—
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         d 
          
         
           i 
          
         
           â€² 
          
         
        
       
         d_i^{\prime}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1.0106em; vertical-align: -0.2587em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            d
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.7519em;">
               <span class="" style="top: -2.4413em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   â€²
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2587em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      æ¥æ›¿æ¢åŸå§‹çš„
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         d 
          
         
           i 
          
         
        
       
         d_i
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.8444em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            d
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ï¼Œä¸»è¦åŒºåˆ«åœ¨äºå°†åŸæ¥
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         d 
          
         
           i 
          
         
        
       
         d_i
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.8444em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            d
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      å®šä¹‰ä¸­çš„
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         m 
          
         
           N 
          
         
        
       
         m_N
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            m
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3283em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                  N
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      æ›¿æ¢ä¸ºäº†
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         m 
          
         
           i 
          
         
        
       
         m_i
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            m
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ï¼Œä»¥æ¶ˆé™¤å¯¹
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         N 
         
        
       
         N
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.109em;">
           N
          </span>
         </span>
        </span>
       </span>
      </span>
      çš„ä¾èµ–ï¼Œå¹¶ä¸”æˆ‘ä»¬å‘ç°
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         d 
          
         
           N 
          
         
        
          = 
         
         
         
           d 
          
         
           N 
          
         
           â€² 
          
         
        
       
         d_N=d_N^{\prime}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.8444em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            d
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3283em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                  N
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1.0272em; vertical-align: -0.2753em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            d
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.7519em;">
               <span class="" style="top: -2.4247em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                  N
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   â€²
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2753em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ï¼Œé‚£ä¹ˆæ•´ä¸ª safe softmax çš„è®¡ç®—å°±åªéœ€è¦è¿­ä»£ 2 æ¬¡å³å¯ï¼Œç¬¬ä¸€æ¬¡å¾ªç¯è¿­ä»£å¯ä»¥åŒæ—¶è®¡ç®—
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         m 
          
         
           i 
          
         
        
       
         m_i
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            m
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      å’Œ
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         d 
          
         
           i 
          
         
           â€² 
          
         
        
       
         d_i^{\prime}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1.0106em; vertical-align: -0.2587em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            d
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.7519em;">
               <span class="" style="top: -2.4413em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   â€²
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2587em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </p>
     <p>
      FlashAttention æƒ³è¦æŠŠ self-attention ä¸­çš„å¾ªç¯æ¬¡æ•°é™ä½åˆ°ä¸€æ¬¡ï¼Œä½†æ˜¯å‘ç°å¯¹äºå…¶ä¸­çš„ softmax è€Œè¨€æ— æ³•å®ç°ï¼Œå› æ­¤å®ƒå¦è¾Ÿè¹Šå¾„è¯•å›¾å¯»æ‰¾è¾“å‡ºçŸ©é˜µ
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         O 
         
        
       
         O
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           O
          </span>
         </span>
        </span>
       </span>
      </span>
      çš„ä¸€æ¬¡è¿­ä»£å½¢å¼ã€‚ç»è¿‡æ¨å¯¼æˆ‘ä»¬å‘ç°è¾“å‡ºè¡Œå‘é‡
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         o 
          
         
           i 
          
         
        
       
         \bm{o}_i
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.5944em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord">
            <span class="mord">
             <span class="mord boldsymbol">
              o
             </span>
            </span>
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ä»ç„¶ä¾èµ–äº
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         m 
          
         
           N 
          
         
        
       
         m_N
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            m
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3283em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                  N
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      å’Œ
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         d 
          
         
           N 
          
         
        
       
         d_N
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.8444em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            d
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3283em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                  N
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      å˜é‡ï¼Œè¿™ä¸¤ä¸ªå€¼åœ¨å‰ä¸€ä¸ªå¾ªç¯å®Œæˆä¹‹å‰æ— æ³•ç¡®å®šï¼Œå› æ­¤ä»éœ€è¦ä¸¤æ¬¡å¾ªç¯
     </p>
     <p>
      FlashAttention å€ŸåŠ© online softmax çš„æ›¿ä»£æ€æƒ³ï¼Œå°†åºåˆ—
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         o 
         
        
       
         \bm{o}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.4444em;">
          </span>
          <span class="mord">
           <span class="mord">
            <span class="mord boldsymbol">
             o
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      æ›¿æ¢ä¸º
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         o 
          
         
           â€² 
          
         
        
       
         \bm{o}^{\prime}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.7519em;">
          </span>
          <span class="mord">
           <span class="mord">
            <span class="mord">
             <span class="mord boldsymbol">
              o
             </span>
            </span>
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.7519em;">
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   â€²
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ï¼Œæ›¿æ¢ä¹‹åå‘ç°
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         o 
          
         
           i 
          
         
           â€² 
          
         
        
       
         \bm{o}_i^{\prime}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1.0106em; vertical-align: -0.2587em;">
          </span>
          <span class="mord">
           <span class="mord">
            <span class="mord">
             <span class="mord boldsymbol">
              o
             </span>
            </span>
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.7519em;">
               <span class="" style="top: -2.4413em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   â€²
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2587em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ä¸å†ä¾èµ–äº
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         m 
          
         
           N 
          
         
        
       
         m_N
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            m
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3283em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                  N
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      å’Œ
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         d 
          
         
           N 
          
         
        
       
         d_N
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.8444em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            d
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3283em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.109em;">
                  N
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ç­‰å˜é‡ï¼Œè€Œä»…ä¾èµ–äº
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         d 
          
         
           i 
          
         
           â€² 
          
         
        
          , 
         
        
          Â  
         
         
         
           d 
          
          
          
            i 
           
          
            âˆ’ 
           
          
            1 
           
          
         
           â€² 
          
         
        
          , 
         
        
          Â  
         
         
         
           m 
          
         
           i 
          
         
        
          , 
         
        
          Â  
         
         
         
           m 
          
          
          
            i 
           
          
            âˆ’ 
           
          
            1 
           
          
         
        
          , 
         
        
          Â  
         
         
         
           x 
          
         
           i 
          
         
        
       
         d^{\prime}_i,\ d^{\prime}_{i-1}, \ m_i, \ m_{i-1}, \ x_i
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1.0689em; vertical-align: -0.317em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            d
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.7519em;">
               <span class="" style="top: -2.4413em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   â€²
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2587em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace">
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            d
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.7519em;">
               <span class="" style="top: -2.4413em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   i
                  </span>
                  <span class="mbin mtight">
                   âˆ’
                  </span>
                  <span class="mord mtight">
                   1
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   â€²
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.317em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace">
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            m
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace">
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            m
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   i
                  </span>
                  <span class="mbin mtight">
                   âˆ’
                  </span>
                  <span class="mord mtight">
                   1
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2083em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace">
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            x
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ï¼Œä»è€Œå¯ä»¥åœ¨å•ä¸ªå¾ªç¯ä¸­èåˆ self-attention ä¸­çš„æ‰€æœ‰è®¡ç®—
     </p>
     <p>
      æœ€åï¼Œç”±äº flashattention ç®—æ³•ä¸­çš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯å…³è”çš„ï¼Œå› æ­¤å¯ä»¥é€ä¸ª tiling åˆ†å—è®¡ç®—ï¼Œå¹¶ä¸”æ•´ä½“ SRAM çš„å†…å­˜å ç”¨ä¸åºåˆ—é•¿åº¦æ— å…³ï¼Œå› æ­¤å¯ä»¥æ‰©å±•åˆ°é•¿ä¸Šä¸‹æ–‡è€Œä¸ç”¨æ‹…å¿ƒé‡åˆ°å†…å­˜é—®é¢˜
     </p>
     <p>
      OKï¼Œä»¥ä¸Šå°±æ˜¯å…³äºè¿™ç¯‡æ‰‹ç¨¿çš„å…¨éƒ¨å†…å®¹äº†ï¼Œå¤§å®¶æ„Ÿå…´è¶£çš„å¯ä»¥çœ‹çœ‹ï¼Œä½œä¸º FlashAttention çš„å…¥é—¨è¿˜æ˜¯æ²¡æœ‰é—®é¢˜çš„ğŸ˜„
     </p>
    </blockquote>
    <h3>
     <a id="_301">
     </a>
     å‚è€ƒ
    </h3>
    <ul>
     <li>
      <a href="https://arxiv.org/abs/2205.14135" rel="nofollow">
       FlashAttention: Fast and Memory-Efficient Exact Attention with IO-Awareness
      </a>
     </li>
     <li>
      <a href="https://developer.download.nvidia.com/video/gputechconf/gtc/2020/presentations/s21745-developing-cuda-kernels-to-push-tensor-cores-to-the-absolute-limit-on-nvidia-a100.pdf" rel="nofollow">
       Gtc 2020: developing cuda kernels to push tensor cores to the absolute limit on nvidia a100
      </a>
     </li>
     <li>
      <a href="https://arxiv.org/abs/1805.02867" rel="nofollow">
       Online normalizer calculation for softmax
      </a>
     </li>
    </ul>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34303637323131352f:61727469636c652f64657461696c732f313436323135383830" class_="artid" style="display:none">
 </p>
</div>


