---
layout: post
title: "docker"
date: 2025-03-16 21:20:19 +0800
description: "Docker 是一个开源容器化平台，主要作用是通过将应用程序及其依赖环境打包成轻量级、可移植的容器，实现跨环境的一致性部署与运行。"
keywords: "docker"
categories: ['Docker']
tags: ['运维', '容器', 'Docker']
artid: "146134137"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146134137
    alt: "docker"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146134137
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146134137
cover: https://bing.ee123.net/img/rand?artid=146134137
image: https://bing.ee123.net/img/rand?artid=146134137
img: https://bing.ee123.net/img/rand?artid=146134137
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     docker
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h4>
     <a id="Docker_0">
     </a>
     Docker介绍
    </h4>
    <p>
     Docker 是一个开源容器化平台，主要作用是通过将应用程序及其依赖环境打包成轻量级、可移植的容器，实现跨环境的一致性部署与运行。其核心价值包括：
    </p>
    <ol>
     <li>
      <strong>
       环境隔离
      </strong>
      ：容器内的应用与宿主机及其他容器相互隔离，确保运行环境的独立性。
     </li>
     <li>
      <strong>
       标准化交付
      </strong>
      ：通过镜像（Image）封装代码、库和配置，消除“在我机器上能运行”的问题。
     </li>
     <li>
      <strong>
       资源高效
      </strong>
      ：共享宿主机内核，相比虚拟机（VM）更节省内存和计算资源，启动速度更快。
     </li>
     <li>
      <strong>
       跨平台部署
      </strong>
      ：一次构建的容器可在 Linux、Windows、云服务器等多种环境中运行。
     </li>
     <li>
      <strong>
       简化运维
      </strong>
      ：支持快速创建、复制、销毁容器，便于弹性扩展和持续集成/持续部署（CI/CD）。
     </li>
    </ol>
    <p>
     Docker 已成为现代云原生应用开发和微服务架构的基础设施，显著提升了软件交付效率和系统可靠性。
    </p>
    <h4>
     <a id="Docker_10">
     </a>
     一、Docker架构解析
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        核心组件
       </strong>
      </p>
      <div class="mermaid">
       <svg class="mermaid-svg" height="280.0000305175781" id="mermaid-svg-e6ymCv3hnC8Lh6wu" viewbox="0.000003814697265625 0.0000019073486328125 503.9107666015625 280.0000305175781" width="503.9107666015625" xmlns="http://www.w3.org/2000/svg">
        <style>
         #mermaid-svg-e6ymCv3hnC8Lh6wu {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-svg-e6ymCv3hnC8Lh6wu .error-icon{fill:#552222;}#mermaid-svg-e6ymCv3hnC8Lh6wu .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-e6ymCv3hnC8Lh6wu .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-e6ymCv3hnC8Lh6wu .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-e6ymCv3hnC8Lh6wu .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-e6ymCv3hnC8Lh6wu .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-e6ymCv3hnC8Lh6wu .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-e6ymCv3hnC8Lh6wu .marker{fill:#333333;stroke:#333333;}#mermaid-svg-e6ymCv3hnC8Lh6wu .marker.cross{stroke:#333333;}#mermaid-svg-e6ymCv3hnC8Lh6wu svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-e6ymCv3hnC8Lh6wu .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-svg-e6ymCv3hnC8Lh6wu .cluster-label text{fill:#333;}#mermaid-svg-e6ymCv3hnC8Lh6wu .cluster-label span{color:#333;}#mermaid-svg-e6ymCv3hnC8Lh6wu .label text,#mermaid-svg-e6ymCv3hnC8Lh6wu span{fill:#333;color:#333;}#mermaid-svg-e6ymCv3hnC8Lh6wu .node rect,#mermaid-svg-e6ymCv3hnC8Lh6wu .node circle,#mermaid-svg-e6ymCv3hnC8Lh6wu .node ellipse,#mermaid-svg-e6ymCv3hnC8Lh6wu .node polygon,#mermaid-svg-e6ymCv3hnC8Lh6wu .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg-e6ymCv3hnC8Lh6wu .node .label{text-align:center;}#mermaid-svg-e6ymCv3hnC8Lh6wu .node.clickable{cursor:pointer;}#mermaid-svg-e6ymCv3hnC8Lh6wu .arrowheadPath{fill:#333333;}#mermaid-svg-e6ymCv3hnC8Lh6wu .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-svg-e6ymCv3hnC8Lh6wu .flowchart-link{stroke:#333333;fill:none;}#mermaid-svg-e6ymCv3hnC8Lh6wu .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-svg-e6ymCv3hnC8Lh6wu .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-svg-e6ymCv3hnC8Lh6wu .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-svg-e6ymCv3hnC8Lh6wu .cluster text{fill:#333;}#mermaid-svg-e6ymCv3hnC8Lh6wu .cluster span{color:#333;}#mermaid-svg-e6ymCv3hnC8Lh6wu div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-e6ymCv3hnC8Lh6wu :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}
        </style>
        <g>
         <g class="output">
          <g class="clusters">
          </g>
          <g class="edgePaths">
           <g class="edgePath LS-A LE-B" id="L-A-B" style="opacity: 1;">
            <path class="path" d="M256.4017906188965,54.000003814697266L256.4017906188965,60.33333762486776C256.4017906188965,66.66667143503825,256.4017906188965,79.33333905537923,256.4017906188965,92.00000667572021C256.4017906188965,104.6666742960612,256.4017906188965,117.33334191640218,256.4017906188965,123.66667572657268L256.4017906188965,130.00000953674316" marker-end="url(#arrowhead156)" style="fill:none">
            </path>
            <defs>
             <marker id="arrowhead156" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
              <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
              </path>
             </marker>
            </defs>
           </g>
           <g class="edgePath LS-B LE-C" id="L-B-C" style="opacity: 1;">
            <path class="path" d="M188.59821701049805,169.29614955440206L166.61309750874838,174.58012685390847C144.6279780069987,179.86410415341484,100.65773900349934,190.43205875242765,78.67261950174968,199.8827027186007C56.6875,209.33334668477377,56.6875,217.6666800181071,56.6875,221.83334668477377L56.6875,226.00001335144043" marker-end="url(#arrowhead157)" style="fill:none">
            </path>
            <defs>
             <marker id="arrowhead157" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
              <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
              </path>
             </marker>
            </defs>
           </g>
           <g class="edgePath LS-B LE-D" id="L-B-D" style="opacity: 1;">
            <path class="path" d="M225.3564945958104,176.00001335144043L219.73234723194162,180.1666800181071C214.10819986807283,184.33334668477377,202.85990514033526,192.6666800181071,197.23575777646647,201.00001335144043C191.61161041259766,209.33334668477377,191.61161041259766,217.6666800181071,191.61161041259766,221.83334668477377L191.61161041259766,226.00001335144043" marker-end="url(#arrowhead158)" style="fill:none">
            </path>
            <defs>
             <marker id="arrowhead158" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
              <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
              </path>
             </marker>
            </defs>
           </g>
           <g class="edgePath LS-B LE-E" id="L-B-E" style="opacity: 1;">
            <path class="path" d="M287.44708664198254,176.00001335144043L293.0712340058513,180.1666800181071C298.6953813697201,184.33334668477377,309.94367609745774,192.6666800181071,315.5678234613265,201.00001335144043C321.1919708251953,209.33334668477377,321.1919708251953,217.6666800181071,321.1919708251953,221.83334668477377L321.1919708251953,226.00001335144043" marker-end="url(#arrowhead159)" style="fill:none">
            </path>
            <defs>
             <marker id="arrowhead159" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
              <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
              </path>
             </marker>
            </defs>
           </g>
           <g class="edgePath LS-B LE-F" id="L-B-F" style="opacity: 1;">
            <path class="path" d="M324.2053642272949,169.3693313745802L346.0416742960612,174.64111170405693C367.87798436482746,179.9128920335336,411.55060450236004,190.45645269248703,433.3869145711263,199.8948996886304C455.2232246398926,209.33334668477377,455.2232246398926,217.6666800181071,455.2232246398926,221.83334668477377L455.2232246398926,226.00001335144043" marker-end="url(#arrowhead160)" style="fill:none">
            </path>
            <defs>
             <marker id="arrowhead160" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
              <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
              </path>
             </marker>
            </defs>
           </g>
          </g>
          <g class="edgeLabels">
           <g class="edgeLabel" style="opacity: 1;" transform="translate(256.4017906188965,92.00000667572021)">
            <g class="label" transform="translate(-35.868309020996094,-13.00000286102295)">
             <rect height="26.0000057220459" rx="0" ry="0" width="71.73661804199219">
             </rect>
             <foreignobject height="26.000003814697266" width="71.73661041259766">
              <div style="display: inline-block; white-space: nowrap;">
               <span class="edgeLabel L-LS-A' L-LE-B" id="L-L-A-B">
                REST API
               </span>
              </div>
             </foreignobject>
            </g>
           </g>
           <g class="edgeLabel" style="opacity: 1;" transform="">
            <g class="label" transform="translate(0,0)">
             <rect height="0" rx="0" ry="0" width="0">
             </rect>
             <foreignobject height="0" width="0">
              <div style="display: inline-block; white-space: nowrap;">
               <span class="edgeLabel L-LS-B' L-LE-C" id="L-L-B-C">
               </span>
              </div>
             </foreignobject>
            </g>
           </g>
           <g class="edgeLabel" style="opacity: 1;" transform="">
            <g class="label" transform="translate(0,0)">
             <rect height="0" rx="0" ry="0" width="0">
             </rect>
             <foreignobject height="0" width="0">
              <div style="display: inline-block; white-space: nowrap;">
               <span class="edgeLabel L-LS-B' L-LE-D" id="L-L-B-D">
               </span>
              </div>
             </foreignobject>
            </g>
           </g>
           <g class="edgeLabel" style="opacity: 1;" transform="">
            <g class="label" transform="translate(0,0)">
             <rect height="0" rx="0" ry="0" width="0">
             </rect>
             <foreignobject height="0" width="0">
              <div style="display: inline-block; white-space: nowrap;">
               <span class="edgeLabel L-LS-B' L-LE-E" id="L-L-B-E">
               </span>
              </div>
             </foreignobject>
            </g>
           </g>
           <g class="edgeLabel" style="opacity: 1;" transform="">
            <g class="label" transform="translate(0,0)">
             <rect height="0" rx="0" ry="0" width="0">
             </rect>
             <foreignobject height="0" width="0">
              <div style="display: inline-block; white-space: nowrap;">
               <span class="edgeLabel L-LS-B' L-LE-F" id="L-L-B-F">
               </span>
              </div>
             </foreignobject>
            </g>
           </g>
          </g>
          <g class="nodes">
           <g class="node default" id="flowchart-A-150" style="opacity: 1;" transform="translate(256.4017906188965,31.000001907348633)">
            <rect class="label-container" height="46.0000057220459" rx="0" ry="0" width="60.91072082519531" x="-30.455360412597656" y="-23.00000286102295">
            </rect>
            <g class="label" transform="translate(0,0)">
             <g transform="translate(-20.455360412597656,-13.00000286102295)">
              <foreignobject height="26.000003814697266" width="40.91071701049805">
               <div style="display: inline-block; white-space: nowrap;">
                Client
               </div>
              </foreignobject>
             </g>
            </g>
           </g>
           <g class="node default" id="flowchart-B-151" style="opacity: 1;" transform="translate(256.4017906188965,153.0000114440918)">
            <rect class="label-container" height="46.0000057220459" rx="0" ry="0" width="135.60714721679688" x="-67.80357360839844" y="-23.00000286102295">
            </rect>
            <g class="label" transform="translate(0,0)">
             <g transform="translate(-57.80357360839844,-13.00000286102295)">
              <foreignobject height="26.000003814697266" width="115.60714721679688">
               <div style="display: inline-block; white-space: nowrap;">
                Docker Daemon
               </div>
              </foreignobject>
             </g>
            </g>
           </g>
           <g class="node default" id="flowchart-C-153" style="opacity: 1;" transform="translate(56.6875,249.00001525878906)">
            <rect class="label-container" height="46.0000057220459" rx="0" ry="0" width="97.375" x="-48.6875" y="-23.00000286102295">
            </rect>
            <g class="label" transform="translate(0,0)">
             <g transform="translate(-38.6875,-13.00000286102295)">
              <foreignobject height="26.000003814697266" width="77.375">
               <div style="display: inline-block; white-space: nowrap;">
                Containers
               </div>
              </foreignobject>
             </g>
            </g>
           </g>
           <g class="node default" id="flowchart-D-155" style="opacity: 1;" transform="translate(191.61161041259766,249.00001525878906)">
            <rect class="label-container" height="46.0000057220459" rx="0" ry="0" width="72.47322082519531" x="-36.236610412597656" y="-23.00000286102295">
            </rect>
            <g class="label" transform="translate(0,0)">
             <g transform="translate(-26.236610412597656,-13.00000286102295)">
              <foreignobject height="26.000003814697266" width="52.47321701049805">
               <div style="display: inline-block; white-space: nowrap;">
                Images
               </div>
              </foreignobject>
             </g>
            </g>
           </g>
           <g class="node default" id="flowchart-E-157" style="opacity: 1;" transform="translate(321.1919708251953,249.00001525878906)">
            <rect class="label-container" height="46.0000057220459" rx="0" ry="0" width="86.6875" x="-43.34375" y="-23.00000286102295">
            </rect>
            <g class="label" transform="translate(0,0)">
             <g transform="translate(-33.34375,-13.00000286102295)">
              <foreignobject height="26.000003814697266" width="66.6875">
               <div style="display: inline-block; white-space: nowrap;">
                Networks
               </div>
              </foreignobject>
             </g>
            </g>
           </g>
           <g class="node default" id="flowchart-F-159" style="opacity: 1;" transform="translate(455.2232246398926,249.00001525878906)">
            <rect class="label-container" height="46.0000057220459" rx="0" ry="0" width="81.37500762939453" x="-40.687503814697266" y="-23.00000286102295">
            </rect>
            <g class="label" transform="translate(0,0)">
             <g transform="translate(-30.687503814697266,-13.00000286102295)">
              <foreignobject height="26.000003814697266" width="61.375003814697266">
               <div style="display: inline-block; white-space: nowrap;">
                Volumes
               </div>
              </foreignobject>
             </g>
            </g>
           </g>
          </g>
         </g>
        </g>
       </svg>
      </div>
     </li>
     <li>
      <p>
       <strong>
        核心概念对比
       </strong>
      </p>
      <table>
       <thead>
        <tr>
         <th>
          概念
         </th>
         <th>
          说明
         </th>
         <th>
          类比
         </th>
        </tr>
       </thead>
       <tbody>
        <tr>
         <td>
          Image
         </td>
         <td>
          只读模板，包含应用及其运行环境
         </td>
         <td>
          虚拟机ISO镜像
         </td>
        </tr>
        <tr>
         <td>
          Container
         </td>
         <td>
          镜像的运行实例，具有可写层
         </td>
         <td>
          运行中的虚拟机
         </td>
        </tr>
        <tr>
         <td>
          Registry
         </td>
         <td>
          镜像仓库（默认Docker Hub）
         </td>
         <td>
          应用商店
         </td>
        </tr>
        <tr>
         <td>
          Volume
         </td>
         <td>
          持久化数据存储方案
         </td>
         <td>
          外接硬盘
         </td>
        </tr>
       </tbody>
      </table>
     </li>
    </ol>
    <hr/>
    <h4>
     <a id="_31">
     </a>
     二、容器生命周期管理
    </h4>
    <h5>
     <a id="1__32">
     </a>
     1. 基础操作命令
    </h5>
    <pre><code class="prism language-bash"><span class="token comment"># 运行容器（示例运行Nginx）</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">8080</span>:80 <span class="token parameter variable">--name</span> my_nginx nginx:1.23 

<span class="token comment"># 查看运行中的容器</span>
<span class="token function">docker</span> <span class="token function">ps</span>
<span class="token comment"># 查看所有容器（含已停止）</span>
<span class="token function">docker</span> <span class="token function">ps</span> <span class="token parameter variable">-a</span>

<span class="token comment"># 停止/启动容器</span>
<span class="token function">docker</span> stop my_nginx
<span class="token function">docker</span> start my_nginx

<span class="token comment"># 删除容器</span>
<span class="token function">docker</span> <span class="token function">rm</span> my_nginx
</code></pre>
    <h5>
     <a id="2__50">
     </a>
     2. 容器交互模式
    </h5>
    <pre><code class="prism language-bash"><span class="token comment"># 进入容器bash终端</span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> my_nginx /bin/bash

<span class="token comment"># 查看容器日志</span>
<span class="token function">docker</span> logs <span class="token parameter variable">-f</span> my_nginx

<span class="token comment"># 拷贝文件</span>
<span class="token function">docker</span> <span class="token function">cp</span> local.txt my_nginx:/app/config.txt
</code></pre>
    <hr/>
    <h4>
     <a id="_64">
     </a>
     三、镜像深度管理
    </h4>
    <h5>
     <a id="1__65">
     </a>
     1. 镜像操作全流程
    </h5>
    <pre><code class="prism language-bash"><span class="token comment"># 拉取镜像（指定版本）</span>
<span class="token function">docker</span> pull ubuntu:22.04

<span class="token comment"># 查看本地镜像</span>
<span class="token function">docker</span> images

<span class="token comment"># 标记镜像</span>
<span class="token function">docker</span> tag nginx:1.23 myrepo/nginx:v1

<span class="token comment"># 推送镜像到私有仓库</span>
<span class="token function">docker</span> push myrepo/nginx:v1

<span class="token comment"># 删除镜像</span>
<span class="token function">docker</span> rmi nginx:1.23
</code></pre>
    <h5>
     <a id="2_Dockerfile_83">
     </a>
     2. 镜像构建（Dockerfile）
    </h5>
    <pre><code class="prism language-dockerfile"># 多阶段构建示例
FROM golang:1.20 AS builder
WORKDIR /app
COPY . .
RUN go build -o myapp .

FROM alpine:3.18
WORKDIR /app
COPY --from=builder /app/myapp .
CMD ["./myapp"]
</code></pre>
    <p>
     构建命令：
     <code>
      docker build -t myapp:v1 .
     </code>
    </p>
    <hr/>
    <h4>
     <a id="_100">
     </a>
     四、存储与网络配置
    </h4>
    <h5>
     <a id="1__101">
     </a>
     1. 数据持久化方案
    </h5>
    <table>
     <thead>
      <tr>
       <th>
        类型
       </th>
       <th>
        特点
       </th>
       <th>
        适用场景
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        Volume
       </td>
       <td>
        Docker管理，存储在/var/lib/docker
       </td>
       <td>
        数据库数据
       </td>
      </tr>
      <tr>
       <td>
        Bind Mount
       </td>
       <td>
        映射宿主机目录
       </td>
       <td>
        配置文件同步
       </td>
      </tr>
      <tr>
       <td>
        tmpfs mount
       </td>
       <td>
        内存临时存储
       </td>
       <td>
        敏感临时数据
       </td>
      </tr>
     </tbody>
    </table>
    <pre><code class="prism language-bash"><span class="token comment"># 创建数据卷</span>
<span class="token function">docker</span> volume create db_vol

<span class="token comment"># 使用数据卷</span>
<span class="token function">docker</span> run <span class="token parameter variable">-v</span> db_vol:/var/lib/mysql mysql:8.0
</code></pre>
    <h5>
     <a id="2__116">
     </a>
     2. 网络模式详解
    </h5>
    <table>
     <thead>
      <tr>
       <th>
        模式
       </th>
       <th>
        特点
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        bridge
       </td>
       <td>
        默认模式，NAT网络（172.17.0.0/16）
       </td>
      </tr>
      <tr>
       <td>
        host
       </td>
       <td>
        共享宿主机网络栈
       </td>
      </tr>
      <tr>
       <td>
        none
       </td>
       <td>
        无网络连接
       </td>
      </tr>
      <tr>
       <td>
        overlay
       </td>
       <td>
        跨主机容器通信（Swarm集群）
       </td>
      </tr>
     </tbody>
    </table>
    <pre><code class="prism language-bash"><span class="token comment"># 创建自定义网络</span>
<span class="token function">docker</span> network create my_net

<span class="token comment"># 容器加入指定网络</span>
<span class="token function">docker</span> run <span class="token parameter variable">--net</span><span class="token operator">=</span>my_net redis:7.0
</code></pre>
    <hr/>
    <h4>
     <a id="Docker_Compose_134">
     </a>
     五、多容器编排（Docker Compose）
    </h4>
    <h5>
     <a id="1_dockercomposeyml_135">
     </a>
     1. 典型docker-compose.yml
    </h5>
    <pre><code class="prism language-yaml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3.8'</span>

<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">web</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx<span class="token punctuation">:</span><span class="token number">1.23</span>
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">"8080:80"</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./html<span class="token punctuation">:</span>/usr/share/nginx/html
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> db

  <span class="token key atrule">db</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> postgres<span class="token punctuation">:</span><span class="token number">15</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">POSTGRES_PASSWORD</span><span class="token punctuation">:</span> example
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> pgdata<span class="token punctuation">:</span>/var/lib/postgresql/data

<span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  <span class="token key atrule">pgdata</span><span class="token punctuation">:</span>
</code></pre>
    <h5>
     <a id="2__160">
     </a>
     2. 常用命令
    </h5>
    <pre><code class="prism language-bash"><span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span>    <span class="token comment"># 启动服务</span>
<span class="token function">docker-compose</span> down     <span class="token comment"># 停止并删除</span>
<span class="token function">docker-compose</span> logs <span class="token parameter variable">-f</span>  <span class="token comment"># 查看日志</span>
</code></pre>
    <hr/>
    <h4>
     <a id="_169">
     </a>
     六、安全最佳实践
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        容器安全准则
       </strong>
      </p>
      <ul>
       <li>
        禁止使用
        <code>
         --privileged
        </code>
        特权模式
       </li>
       <li>
        设置用户权限：
        <code>
         docker run -u 1001:1001 ...
        </code>
       </li>
       <li>
        定期扫描镜像漏洞：
        <code>
         docker scan nginx:1.23
        </code>
       </li>
       <li>
        配置资源限制：
        <pre><code class="prism language-bash"><span class="token function">docker</span> run <span class="token parameter variable">-m</span> 512m <span class="token parameter variable">--cpus</span><span class="token operator">=</span><span class="token number">1.5</span> <span class="token punctuation">..</span>.
</code></pre>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        生产环境建议
       </strong>
      </p>
      <ul>
       <li>
        使用只读文件系统：
        <code>
         --read-only
        </code>
       </li>
       <li>
        配置健康检查：
        <pre><code class="prism language-dockerfile">HEALTHCHECK --interval=30s --timeout=3s \
  CMD curl -f http://localhost/ || exit 1
</code></pre>
       </li>
      </ul>
     </li>
    </ol>
    <hr/>
    <h4>
     <a id="_189">
     </a>
     七、高级应用场景
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        集群管理
       </strong>
      </p>
      <pre><code class="prism language-bash"><span class="token comment"># 初始化Swarm集群</span>
<span class="token function">docker</span> swarm init

<span class="token comment"># 部署服务</span>
<span class="token function">docker</span> <span class="token function">service</span> create <span class="token parameter variable">--replicas</span> <span class="token number">3</span> nginx:1.23
</code></pre>
     </li>
     <li>
      <p>
       <strong>
        CI/CD集成示例
       </strong>
      </p>
      <pre><code class="prism language-bash"><span class="token comment"># Jenkins Pipeline片段</span>
stage<span class="token punctuation">(</span><span class="token string">'Build Image'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  docker.build<span class="token punctuation">(</span><span class="token string">"myapp:<span class="token variable">${env.BUILD_ID}</span>"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
stage<span class="token punctuation">(</span><span class="token string">'Deploy'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  docker.withRegistry<span class="token punctuation">(</span><span class="token string">'https://registry.example.com'</span>, <span class="token string">'docker-creds'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    image.push<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
     </li>
    </ol>
    <hr/>
    <p>
     <strong>
      知识拓展建议
     </strong>
     ：
    </p>
    <ol>
     <li>
      容器运行时比较（containerd vs cri-o）
     </li>
     <li>
      云原生技术栈（Kubernetes + Docker）
     </li>
     <li>
      服务网格（Istio）与容器监控（Prometheus）
     </li>
    </ol>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323330315f38303037393634322f:61727469636c652f64657461696c732f313436313334313337" class_="artid" style="display:none">
 </p>
</div>


