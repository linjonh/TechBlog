---
layout: post
title: "Redis7系列设置开机自启"
date: 2025-03-10 18:50:51 +0800
description: "开启自启"
keywords: "Redis7系列：设置开机自启"
categories: ['朝花夕拾篇']
tags: ['前端', 'Html', 'Bootstrap']
artid: "146161278"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146161278
    alt: "Redis7系列设置开机自启"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146161278
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146161278
cover: https://bing.ee123.net/img/rand?artid=146161278
image: https://bing.ee123.net/img/rand?artid=146161278
img: https://bing.ee123.net/img/rand?artid=146161278
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Redis7系列：设置开机自启
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     前面的文章讲了Redis和Redis Stack的安装，随着服务器的重启，导致Redis 客户端无法连接。原来的是Redis没有配置开机自启。此文记录一下如何配置开机自启。
    </p>
    <h4>
     <a id="1_2">
     </a>
     1、修改配置文件
    </h4>
    <p>
     前面的Redis和Redis Stack的安装的文章中已经讲了
     <code>
      redis.config
     </code>
     的配置，这里在说明一下开启自启必须得配置。
    </p>
    <blockquote>
     <p>
      daemonize 默认为
      <code>
       no
      </code>
      ，表示不以守护进程的方式运行（不会后台启动，关闭窗口服务自动关闭）
     </p>
     <p>
      所以这里我们一般都会改成
      <code>
       yes
      </code>
      ,这样的话不管事开启自启还是测试都是比较方便的
     </p>
    </blockquote>
    <pre><code class="prism language-properties">################################# GENERAL #####################################

# By default Redis does not run as a daemon. Use 'yes' if you need it.
# Note that Redis will write a pid file in /var/run/redis.pid when daemonized.
# When Redis is supervised by upstart or systemd, this parameter has no impact.
daemonize yes

# Creating a pid file is best effort: if Redis is not able to create it
# nothing bad happens, the server will start and run normally.
#
# Note that on modern Linux systems "/run/redis.pid" is more conforming
# and should be used instead.
pidfile /var/run/redis_6379.pid
</code></pre>
    <h4>
     <a id="2_26">
     </a>
     2、修改启动脚本
    </h4>
    <p>
     Redis安装包下已经包含了启动的脚本。
    </p>
    <blockquote>
     <p>
      由于
      <code>
       redis-7.4.2
      </code>
      是笔者自己的解压的数据包，使用者可以按照自己的位置去找。
     </p>
    </blockquote>
    <pre><code class="prism language-shell">/opt/redis-7.4.2/utils/redis_init_script
</code></pre>
    <p>
     将文件拷贝到
     <code>
      /etc/init.d
     </code>
     下。这里存放的都是自启服务的命令。
    </p>
    <pre><code class="prism language-shell"><span class="token comment"># 文件拷贝到/etc/init.d/并命名为redisd，名字可以随便取</span>
<span class="token function">cp</span> opt/redis-7.4.2/utils/redis_init_script /etc/init.d/并命名为redisd，名字可以随便取redisd
</code></pre>
    <p>
     然后修改redisd文件，主要修改以下这5处：
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/bdfab6480bff033cac34d643441fc0c3.png"/>
    </p>
    <pre><code class="prism language-shell"><span class="token comment"># 指定自己的端口</span>
<span class="token assign-left variable">REDISPORT</span><span class="token operator">=</span><span class="token number">6379</span>
<span class="token comment"># 指定服务启动的路径，笔者安装在 /usr/loca/redis/bin/redis-server,替换成自己的安装目录即可</span>
<span class="token comment"># EXEC=/usr/local/bin/redis-server</span>
<span class="token comment"># CLIEXEC=/usr/local/bin/redis-cli</span>
<span class="token assign-left variable">EXEC</span><span class="token operator">=</span>/usr/local/redis/bin/redis-server
<span class="token assign-left variable">CLIEXEC</span><span class="token operator">=</span>/usr/local/redis/bin/redis-cli

<span class="token comment"># redis.conf中配置的pidfile</span>
<span class="token assign-left variable">PIDFILE</span><span class="token operator">=</span>/var/run/redis_<span class="token variable">${REDISPORT}</span>.pid
<span class="token comment"># 指定启动的配置文件</span>
<span class="token comment"># CONF="/etc/redis/${REDISPORT}.conf"</span>
<span class="token assign-left variable">CONF</span><span class="token operator">=</span><span class="token string">"/usr/local/redis/conf/redis.conf"</span>
</code></pre>
    <h4>
     <a id="3_63">
     </a>
     3、设置可执行脚本
    </h4>
    <pre><code class="prism language-shell"><span class="token function">chmod</span> <span class="token number">755</span> /etc/init.d/redisd
</code></pre>
    <h4>
     <a id="4redis_69">
     </a>
     4、启动redis
    </h4>
    <pre><code class="prism language-shell">/etc/init.d/redisd start
</code></pre>
    <h4>
     <a id="5_75">
     </a>
     5、设置开机自启
    </h4>
    <pre><code class="prism language-shell"><span class="token builtin class-name">cd</span> /etc/init.d/redisd

<span class="token comment"># 设置开启自启</span>
<span class="token function">chkconfig</span> redisd on
</code></pre>
    <h4>
     <a id="6_84">
     </a>
     6、启动测试
    </h4>
    <pre><code class="prism language-shell"><span class="token comment"># 重启服务器，然后看看客户端会不会连上</span>
<span class="token function">reboot</span> 
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c:6f672e6373646e2e6e65742f7374617469635f636f6465722f:61727469636c652f64657461696c732f313436313631323738" class_="artid" style="display:none">
 </p>
</div>


