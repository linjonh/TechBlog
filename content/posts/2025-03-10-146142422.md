---
layout: post
title: "preact组件案例的使用"
date: 2025-03-10 01:58:17 +0800
description: "组件是一个可复用的下拉选择框组件，它接收选项列表、当前选中的值以及一个用于更新值的函数作为 props。当用户选择不同的选项时，组件会调用。的函数组件，用于创建一个下拉选择框。的值是整数（如果选项值是整数）。该组件还支持禁用状态。这段 Preact 组件代码定义了一个名为。希望这个解释能够帮助你理解如何使用。函数来更新父组件中的值。"
keywords: "preact组件案例的使用"
categories: ['未分类']
tags: ['开发语言', '前端', 'Javascript']
artid: "146142422"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146142422
    alt: "preact组件案例的使用"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146142422
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146142422
cover: https://bing.ee123.net/img/rand?artid=146142422
image: https://bing.ee123.net/img/rand?artid=146142422
img: https://bing.ee123.net/img/rand?artid=146142422
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     preact组件案例的使用
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     制作一个下拉框
    </p>
    <pre><code class="hljs">export function SelectValue({value, setfn, options, disabled}) {
  const toInt = x =&gt; x == parseInt(x) ? parseInt(x) : x;
  const onchange = ev =&gt; setfn(toInt(ev.target.value));
  return html`
&lt;select onchange=${onchange} class="w-full rounded font-normal border py-0.5 px-1 text-gray-600 focus:outline-none text-sm disabled:cursor-not-allowed" disabled=${disabled}&gt;
  ${options.map(v =&gt; html`&lt;option value=${v[0]} selected=${v[0] == value}&gt;${v[1]}&lt;//&gt;`) }
&lt;//&gt;`;
};
</code></pre>
    <blockquote>
     <p>
      这段 Preact 组件代码定义了一个名为
      <code>
       SelectValue
      </code>
      的函数组件，用于创建一个下拉选择框。 让我们分解一下它的功能：
     </p>
     <p>
      <strong>
       组件功能：
      </strong>
     </p>
     <p>
      <code>
       SelectValue
      </code>
      组件接收以下 props (属性)：
     </p>
     <ul>
      <li>
       <code>
        value
       </code>
       : 当前选中的值。
      </li>
      <li>
       <code>
        setfn
       </code>
       : 一个函数，用于更新父组件中的
       <code>
        value
       </code>
       。当下拉选择框的值发生改变时，会调用这个函数。
      </li>
      <li>
       <code>
        options
       </code>
       : 一个数组，包含了下拉选择框的选项。每个选项都是一个包含两个元素的数组：
       <code>
        [value, label]
       </code>
       ，其中
       <code>
        value
       </code>
       是选项的值，
       <code>
        label
       </code>
       是选项显示的文本。
      </li>
      <li>
       <code>
        disabled
       </code>
       : 一个布尔值，指示下拉选择框是否禁用。
      </li>
     </ul>
     <p>
      <strong>
       代码分解：
      </strong>
     </p>
     <ol>
      <li>
       <p>
        <strong>
         <code>
          export function SelectValue({value, setfn, options, disabled}) { ... }
         </code>
        </strong>
        :
       </p>
       <ul>
        <li>
         定义了一个名为
         <code>
          SelectValue
         </code>
         的函数组件，并使用了解构赋值来获取传入的 props。
        </li>
        <li>
         <code>
          export
         </code>
         关键字表示该组件可以被其他模块导入和使用。
        </li>
       </ul>
      </li>
      <li>
       <p>
        <strong>
         <code>
          const toInt = x =&gt; x == parseInt(x) ? parseInt(x) : x;
         </code>
        </strong>
        :
       </p>
       <ul>
        <li>
         定义了一个名为
         <code>
          toInt
         </code>
         的箭头函数。
        </li>
        <li>
         这个函数的作用是将传入的值
         <code>
          x
         </code>
         转换为整数，如果
         <code>
          x
         </code>
         本身就是一个整数。如果
         <code>
          x
         </code>
         不是整数，则保持原样。
        </li>
        <li>
         <code>
          x == parseInt(x)
         </code>
         用于判断
         <code>
          x
         </code>
         是否可以安全地转换为整数而不丢失信息。 例如，
         <code>
          "1"
         </code>
         ==
         <code>
          parseInt("1")
         </code>
         为真，而
         <code>
          "1.5"
         </code>
         ==
         <code>
          parseInt("1.5")
         </code>
         为假。
        </li>
        <li>
         这个函数用于确保
         <code>
          setfn
         </code>
         接收到的值是整数，如果选项的值是整数的话。
        </li>
       </ul>
      </li>
      <li>
       <p>
        <strong>
         <code>
          const onchange = ev =&gt; setfn(toInt(ev.target.value));
         </code>
        </strong>
        :
       </p>
       <ul>
        <li>
         定义了一个名为
         <code>
          onchange
         </code>
         的箭头函数，它将作为
         <code>
          &lt;select&gt;
         </code>
         元素的
         <code>
          onchange
         </code>
         事件处理函数。
        </li>
        <li>
         当下拉选择框的值发生改变时，这个函数会被调用。
        </li>
        <li>
         <code>
          ev.target.value
         </code>
         获取到当前选中的选项的值（字符串类型）。
        </li>
        <li>
         <code>
          toInt(ev.target.value)
         </code>
         将获取到的值传递给
         <code>
          toInt
         </code>
         函数，尝试将其转换为整数。
        </li>
        <li>
         <code>
          setfn(...)
         </code>
         调用传入的
         <code>
          setfn
         </code>
         函数，并将转换后的值传递给它，从而更新父组件中的
         <code>
          value
         </code>
         。
        </li>
       </ul>
      </li>
      <li>
       <p>
        <strong>
         <code>
          return html\\
         </code>
         ...\
         <code>
          ;
         </code>
        </strong>
        :
       </p>
       <ul>
        <li>
         使用 Preact 的
         <code>
          html
         </code>
         模板字符串来定义组件的 JSX 结构。
        </li>
        <li>
         <code>
          html\\
         </code>
         ...\`` 是 Preact 的一个标签模板字面量，用于创建虚拟 DOM 节点。
        </li>
       </ul>
      </li>
      <li>
       <p>
        <strong>
         <code>
          &lt;select onchange=${onchange} class="w-full rounded font-normal border py-0.5 px-1 text-gray-600 focus:outline-none text-sm disabled:cursor-not-allowed" disabled=${disabled}&gt;
         </code>
        </strong>
        :
       </p>
       <ul>
        <li>
         创建一个
         <code>
          &lt;select&gt;
         </code>
         元素（下拉选择框）。
        </li>
        <li>
         <code>
          onchange=${onchange}
         </code>
         将
         <code>
          onchange
         </code>
         函数设置为
         <code>
          &lt;select&gt;
         </code>
         元素的
         <code>
          onchange
         </code>
         事件处理函数。
        </li>
        <li>
         <code>
          class="..."
         </code>
         设置
         <code>
          &lt;select&gt;
         </code>
         元素的 CSS 类名，用于控制其样式。 这些类名看起来像是来自 Tailwind CSS。
        </li>
        <li>
         <code>
          disabled=${disabled}
         </code>
         根据
         <code>
          disabled
         </code>
         prop 的值来禁用或启用下拉选择框。
        </li>
       </ul>
      </li>
      <li>
       <p>
        <strong>
         <code>
          ${options.map(v =&gt; html\\
         </code>
         &lt;option value=${v[0]} selected=${v[0] == value}&gt;${v[1]}&lt;//&gt;\
         <code>
          )}
         </code>
        </strong>
        :
       </p>
       <ul>
        <li>
         使用
         <code>
          options.map()
         </code>
         方法遍历
         <code>
          options
         </code>
         数组，为每个选项创建一个
         <code>
          &lt;option&gt;
         </code>
         元素。
        </li>
        <li>
         <code>
          v
         </code>
         是
         <code>
          options
         </code>
         数组中的每个元素，它是一个包含两个元素的数组：
         <code>
          [value, label]
         </code>
         。
        </li>
        <li>
         <code>
          &lt;option value=${v[0]} selected=${v[0] == value}&gt;${v[1]}&lt;//&gt;
         </code>
         创建一个
         <code>
          &lt;option&gt;
         </code>
         元素。
         <ul>
          <li>
           <code>
            value=${v[0]}
           </code>
           设置
           <code>
            &lt;option&gt;
           </code>
           元素的
           <code>
            value
           </code>
           属性为选项的值。
          </li>
          <li>
           <code>
            selected=${v[0] == value}
           </code>
           设置
           <code>
            &lt;option&gt;
           </code>
           元素的
           <code>
            selected
           </code>
           属性。如果当前选项的值
           <code>
            v[0]
           </code>
           等于组件的
           <code>
            value
           </code>
           prop，则该选项会被选中。
          </li>
          <li>
           <code>
            ${v[1]}
           </code>
           设置
           <code>
            &lt;option&gt;
           </code>
           元素的显示文本为选项的标签。
          </li>
         </ul>
        </li>
        <li>
         <code>
          &lt;//&gt;
         </code>
         是 Preact 中闭合标签的简写形式，相当于
         <code>
          &lt;/option&gt;
         </code>
         。
        </li>
       </ul>
      </li>
      <li>
       <p>
        <strong>
         <code>
          &lt;//&gt;
         </code>
        </strong>
        :
       </p>
       <ul>
        <li>
         闭合
         <code>
          &lt;select&gt;
         </code>
         标签，相当于
         <code>
          &lt;/select&gt;
         </code>
         。
        </li>
       </ul>
      </li>
     </ol>
     <p>
      <strong>
       总结：
      </strong>
     </p>
     <p>
      <code>
       SelectValue
      </code>
      组件是一个可复用的下拉选择框组件，它接收选项列表、当前选中的值以及一个用于更新值的函数作为 props。当用户选择不同的选项时，组件会调用
      <code>
       setfn
      </code>
      函数来更新父组件中的值。
      <code>
       toInt
      </code>
      函数用于确保传递给
      <code>
       setfn
      </code>
      的值是整数（如果选项值是整数）。 该组件还支持禁用状态。
     </p>
    </blockquote>
    <pre><code class="hljs">export function SelectValue({value, setfn, options, disabled}) {
  const toInt = x =&gt; x == parseInt(x) ? parseInt(x) : x;
  const onchange = ev =&gt; setfn(toInt(ev.target.value));
  return html`
&lt;select onchange=${onchange} class="w-full rounded font-normal border py-0.5 px-1 text-gray-600 focus:outline-none text-sm disabled:cursor-not-allowed" disabled=${disabled}&gt;
  ${options.map(v =&gt; html`&lt;option value=${v[0]} selected=${v[0] == value}&gt;${v[1]}&lt;//&gt;`) }
&lt;//&gt;`;
};


function DHCP({}) {
  const [selectedValue, setSelectedValue] = useState(1);

  const options = [
    [1, 'Option 1'],
    [2, 'Option 2'],
    [3, 'Option 3'],
  ];

  return html`
    &lt;div&gt;
      &lt;${SelectValue}
        value=${selectedValue}
        setfn=${setSelectedValue}
        options=${options}
        disabled=${false}
      /&gt;
      &lt;p&gt;Selected value: ${selectedValue}&lt;/p&gt;
    &lt;/div&gt;
  `;
};</code></pre>
    <blockquote>
     <p>
      <strong>
       代码解释：
      </strong>
     </p>
     <ul>
      <li>
       <code>
        useState(1)
       </code>
       ：初始化
       <code>
        selectedValue
       </code>
       状态为
       <code>
        1
       </code>
       。 这意味着下拉列表的初始选中值为
       <code>
        1
       </code>
       。
      </li>
      <li>
       <code>
        setSelectedValue
       </code>
       ：是更新
       <code>
        selectedValue
       </code>
       状态的函数。 当下拉列表的值发生改变时，
       <code>
        SelectValue
       </code>
       组件会调用这个函数，并将选中的值传递给它。
      </li>
      <li>
       <code>
        options
       </code>
       ：定义了下拉列表的选项。
      </li>
      <li>
       <code>
        &lt;SelectValue ... /&gt;
       </code>
       ：渲染
       <code>
        SelectValue
       </code>
       组件，并将
       <code>
        value
       </code>
       、
       <code>
        setfn
       </code>
       、
       <code>
        options
       </code>
       和
       <code>
        disabled
       </code>
       props 传递给它。
      </li>
      <li>
       <code>
        &lt;p&gt;Selected value: ${selectedValue}&lt;/p&gt;
       </code>
       ：显示当前选中的值。
      </li>
     </ul>
     <p>
      <strong>
       总结：
      </strong>
     </p>
     <p>
      使用
      <code>
       SelectValue
      </code>
      组件的步骤如下：
     </p>
     <ol>
      <li>
       导入组件。
      </li>
      <li>
       定义状态（可选）。
      </li>
      <li>
       定义选项。
      </li>
      <li>
       渲染组件，并将必要的 props 传递给它。
      </li>
     </ol>
     <p>
      希望这个解释能够帮助你理解如何使用
      <code>
       SelectValue
      </code>
      组件。
     </p>
    </blockquote>
    <p>
     <img alt="" height="182" src="https://i-blog.csdnimg.cn/direct/5a8e504a5e1f40ab9fcfafa15f3f8faf.png" width="1805"/>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f6275687569646167652f:61727469636c652f64657461696c732f313436313432343232" class_="artid" style="display:none">
 </p>
</div>


