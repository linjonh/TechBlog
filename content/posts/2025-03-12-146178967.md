---
layout: post
title: "每天一篇目标检测文献三"
date: 2025-03-12 10:54:53 +0800
description: "为了获取柑橘果实的准确特征信息,实现被遮挡柑橘的准确识别和定位,达到精确采  摘的目的,提出了一种改进的被遮挡柑橘果实识别模型构建。该模型在 YOLOv8 目标检测模  型中引入了 BAM 注意力机制,解决了被遮挡柑橘识别效果较差的问题,并采用支持向量机  (SVM)实例分割模型提取被遮挡柑橘的精确轮廓,实现被遮挡柑橘果实的精确识别。仿真  试验结果表明,与 YOLOv8 目标检测模型相比,该改进定位模型在被遮挡柑橘果实的平均定  位误差和果径误差率分别降低了16.29mm和8.03%。"
keywords: "每天一篇《目标检测》文献（三）"
categories: ['目标检测']
tags: ['计算机视觉', '目标跟踪', '目标检测', '深度学习', '机器学习', 'Yolo']
artid: "146178967"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146178967
    alt: "每天一篇目标检测文献三"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146178967
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146178967
cover: https://bing.ee123.net/img/rand?artid=146178967
image: https://bing.ee123.net/img/rand?artid=146178967
img: https://bing.ee123.net/img/rand?artid=146178967
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     每天一篇《目标检测》文献（三）
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     今天看的是《基于改进 YOLOv8 的被遮挡柑橘果实检测算法研究》。
    </p>
    <hr/>
    <hr id="hr-toc" name="tableOfContents"/>
    <h2>
     一、摘要
    </h2>
    <p>
     为了获取柑橘果实的准确特征信息,实现被遮挡柑橘的准确识别和定位,达到精确采  摘的目的,提出了一种改进的被遮挡柑橘果实识别模型构建。该模型在 YOLOv8 目标检测模  型中引入了 BAM 注意力机制,解决了被遮挡柑橘识别效果较差的问题,并采用支持向量机  (SVM)实例分割模型提取被遮挡柑橘的精确轮廓,实现被遮挡柑橘果实的精确识别。仿真  试验结果表明,与 YOLOv8 目标检测模型相比,该改进定位模型在被遮挡柑橘果实的平均定  位误差和果径误差率分别降低了16.29mm和8.03%。
    </p>
    <h2 id="%E4%BA%8C%E3%80%81%E8%83%8C%E6%99%AF%E4%BB%8B%E7%BB%8D" name="%E4%BA%8C%E3%80%81%E8%83%8C%E6%99%AF%E4%BB%8B%E7%BB%8D">
     二、背景介绍
    </h2>
    <p>
     我国是柑橘原产地之一，传统检测通过采集果实纹理、形状及颜色等特征信息，提取过程相对繁琐，基于机器学习的目标检测仅在单一场景下果实识别率较高，基于深度卷积神经网络的果实检测依靠其强大的特征提取能力，在单一和遮挡的环境下检测率均较高。
    </p>
    <p>
     目前，柑橘智能化采摘面临的主要问题就是柑橘果实被遮挡严重，难以实现精确识别，针对上述问题，本文提出在传统yolov8模型中引入BAM注意力机制。通过将输入图像进行数据增强，图像预处理、特征提取、回归预测和非极大值抑制，得到图像中柑橘的置信度和坐标信息，之后使用BAM对被遮挡柑橘果实特征信息进行重构，有效抑制背景特征，提高遮挡柑橘果实的识别效率和准确率。
    </p>
    <p>
     YOLOv8的网络结构如下：
    </p>
    <p>
     <img alt="" height="684" src="https://i-blog.csdnimg.cn/direct/edb0324f7e684b51b8a4c4ae647b5c0a.png" width="757"/>
    </p>
    <p>
     单阶段yolov8的检测模块主要包括：输入模块、主干网络、颈部检测头模块和输出模块。
    </p>
    <p>
     Yolov8的工作原理如下：
    </p>
    <ol>
     <li>
      输入图像首先通过图像增强、自适应处理进行预处理
     </li>
     <li>
      主干网络特征提取时融合大部分背景信息，目标信息较少。C2f模块用以解决特征提取位置信息多、、目标特征弱的问题
     </li>
     <li>
      颈部模块将分类和检测头分离，采用自底向上和自顶向下的双塔结构传递特征信息，将提取的信息对坐标和类别进行回归预测
     </li>
     <li>
      输出模块将特征信息进行非极大值抑制，得到果实的置信度和坐标信息
     </li>
    </ol>
    <p>
     C2f的结构如下：
    </p>
    <p>
     <img alt="" height="239" src="https://i-blog.csdnimg.cn/direct/735ff35bdd1643f2aa0a0cc8d79a3035.png" width="933"/>
    </p>
    <h2 id="%E4%B8%89%E3%80%81%E6%94%B9%E8%BF%9B%E7%BB%93%E6%9E%84" name="%E4%B8%89%E3%80%81%E6%94%B9%E8%BF%9B%E7%BB%93%E6%9E%84">
     三、改进结构
    </h2>
    <p>
     本文引入BAM注意力机制，注意力重构被忽略的信息，抑制被遮挡的背景信息，聚焦柑橘果实特征。BAM模块如下所示：
    </p>
    <p>
     <img alt="" height="333" src="https://i-blog.csdnimg.cn/direct/3b98bf0970f74214814e8cc65a542919.png" width="1052"/>
    </p>
    <p>
     在yolov8的C2f模块后引入BAM模块，通过channel和spatial两个分离路径得到新的Attention Map，获得更加精确的柑橘果实特征。
    </p>
    <p>
     结合通道和空间注意力模块，可以获得更好的重叠和被遮挡果实的轮廓锡信息，计算公式如下：
    </p>
    <p style="text-align:center">
     <img alt="M(F)=\sigma (M_c(F)+M_s(F))" class="mathcode" src="https://latex.csdn.net/eq?M%28F%29%3D%5Csigma%20%28M_c%28F%29&amp;plus;M_s%28F%29%29"/>
    </p>
    <p>
     <img alt="M_{c}(F)\epsilon R^{C}" class="mathcode" src="https://latex.csdn.net/eq?M_%7Bc%7D%28F%29%5Cepsilon%20R%5E%7BC%7D">
      为通道注意力，
      <img alt="M_{s}(F)\epsilon R^{R\times W}" class="mathcode" src="https://latex.csdn.net/eq?M_%7Bs%7D%28F%29%5Cepsilon%20R%5E%7BR%5Ctimes%20W%7D">
       为空间注意力，F为输入特征图，R为激活函数，C为输入特征图通道数，H×W为高度×宽度。
      </img>
     </img>
    </p>
    <p style="text-align:center">
     <img alt="M_{c}(F)=BN(W_{1}(W_{0}Avgpool(F)+b_{0})+b_{1})" class="mathcode" src="https://latex.csdn.net/eq?M_%7Bc%7D%28F%29%3DBN%28W_%7B1%7D%28W_%7B0%7DAvgpool%28F%29&amp;plus;b_%7B0%7D%29&amp;plus;b_%7B1%7D%29"/>
    </p>
    <p>
     BN为批量归一化，
     <img alt="W_{0}\epsilon R^{\frac{C}{r\times C}}" class="mathcode" src="https://latex.csdn.net/eq?W_%7B0%7D%5Cepsilon%20R%5E%7B%5Cfrac%7BC%7D%7Br%5Ctimes%20C%7D%7D">
      为对输入特征图进行线性变换的权重矩阵，
      <img alt="W _{1}\epsilon R^{\frac{C\times C}{r}}" class="mathcode" src="https://latex.csdn.net/eq?W%20_%7B1%7D%5Cepsilon%20R%5E%7B%5Cfrac%7BC%5Ctimes%20C%7D%7Br%7D%7D"/>
      为1×1卷积核的权重矩阵，C/r为多层感知机第一层的神经元个数，C为多层感知机第二层神经元的个数，AVGPool为平均池化，b1、b0为偏置项，
      <img alt="b_{1}\epsilon R^{C},b_{0}\epsilon R^{\frac{C}{r}}" class="mathcode" src="https://latex.csdn.net/eq?b_%7B1%7D%5Cepsilon%20R%5E%7BC%7D%2Cb_%7B0%7D%5Cepsilon%20R%5E%7B%5Cfrac%7BC%7D%7Br%7D%7D"/>
     </img>
    </p>
    <p style="text-align:center">
     <img alt="M_{s}(F)=BN(f^{1\times 1}_{3}(f^{2\times 2}_{2}(f^{3\times 3}_{1}(f^{1\times 1}_{0}(F)))))" class="mathcode" src="https://latex.csdn.net/eq?M_%7Bs%7D%28F%29%3DBN%28f%5E%7B1%5Ctimes%201%7D_%7B3%7D%28f%5E%7B2%5Ctimes%202%7D_%7B2%7D%28f%5E%7B3%5Ctimes%203%7D_%7B1%7D%28f%5E%7B1%5Ctimes%201%7D_%7B0%7D%28F%29%29%29%29%29"/>
    </p>
    <p>
     f为卷积操作，上标为卷积核大小，1×1为filter size为1，3×3是空洞卷积。
    </p>
    <p>
     改进的模块结构如下图所示：
    </p>
    <p>
     <img alt="" height="696" src="https://i-blog.csdnimg.cn/direct/07e72fe763e9417f85ef9d7539fdf1c6.png" width="857"/>
    </p>
    <h2 id="%E5%9B%9B%E3%80%81%E7%A9%BA%E9%97%B4%E5%AE%9A%E4%BD%8D%E7%AE%97%E6%B3%95" name="%E5%9B%9B%E3%80%81%E7%A9%BA%E9%97%B4%E5%AE%9A%E4%BD%8D%E7%AE%97%E6%B3%95">
     四、空间定位算法
    </h2>
    <p>
     果实与背景类间方差较大，通常采用最大类间方差法（Otsu’s Method，Ostu法），该方法按被遮挡果实灰度特性，将果实和背景区分，方法简单，噪声干扰较大，难以区分果实的精准轮廓。本文应用SVM分割模型对柑橘果实进行轮廓提取。
    </p>
    <p>
     SVM主要包括提示编码器，图像编码器、掩码编码器，结构如下所示：
    </p>
    <p>
     <img alt="" height="176" src="https://i-blog.csdnimg.cn/direct/0a483433f70b44d79c5141aa3ed78dc8.png" width="796"/>
    </p>
    <p>
     工作原理如下：
    </p>
    <p>
     图像编码器首先通过卷积层和池化层，提取被遮挡柑橘果实的抽象特征，提示编码器将预测图像信息与图像编码器信息融合，掩码编码器将图像、提示两个编码器输出转换成像素的分割掩码。改进yolo检测模型后获得的目标区域内，应用SVM分割后，采用Canny算子对其轮廓提取。
    </p>
    <p>
     柑橘近似椭圆，采用最小二乘法进行椭圆拟合，设果实中心坐标(x0,y0)，半长轴、半短轴、长轴偏角分别为a、b、θ,其一般方程为：
    </p>
    <p style="text-align:center">
     <img alt="x^{2}+Axy+By^{2}+Cx+Dy+E=0" class="mathcode" src="https://latex.csdn.net/eq?x%5E%7B2%7D&amp;plus;Axy&amp;plus;By%5E%7B2%7D&amp;plus;Cx&amp;plus;Dy&amp;plus;E%3D0"/>
    </p>
    <p style="text-align:center">
     <img alt="\left\{\begin{matrix} x_{0}=\frac{2BC-AD}{A^{2}-4B}\\ y_{0}=\frac{2D-AD}{A^{2}-4B}\\ a=\sqrt{\frac{2(ACD-BC^{2}-D^{2})}{(A^{2}-4B)(B+\sqrt{A^{2}+(1-B)^{2}+1})}}\\ \theta =acrtan(\sqrt{\frac{a^{2}-b^{2}B}{a^{2}B-b})}\\ \end{matrix}\right." class="mathcode" src="https://latex.csdn.net/eq?%5Cleft%5C%7B%5Cbegin%7Bmatrix%7D%20x_%7B0%7D%3D%5Cfrac%7B2BC-AD%7D%7BA%5E%7B2%7D-4B%7D%5C%5C%20y_%7B0%7D%3D%5Cfrac%7B2D-AD%7D%7BA%5E%7B2%7D-4B%7D%5C%5C%20a%3D%5Csqrt%7B%5Cfrac%7B2%28ACD-BC%5E%7B2%7D-D%5E%7B2%7D%29%7D%7B%28A%5E%7B2%7D-4B%29%28B&amp;plus;%5Csqrt%7BA%5E%7B2%7D&amp;plus;%281-B%29%5E%7B2%7D&amp;plus;1%7D%29%7D%7D%5C%5C%20%5Ctheta%20%3Dacrtan%28%5Csqrt%7B%5Cfrac%7Ba%5E%7B2%7D-b%5E%7B2%7DB%7D%7Ba%5E%7B2%7DB-b%7D%29%7D%5C%5C%20%5Cend%7Bmatrix%7D%5Cright."/>
    </p>
    <p>
     ABCDE均为常数，多个采集点坐标，所得目标函数为：
    </p>
    <p style="text-align:center">
     <img alt="F(A,B,C,D,E)=\sum_{i=1}^{n}(x^{2}_{i}A+Bx_{i}y_{i}+Cx_{i}+Dy_{i}+E)^{2}" class="mathcode" src="https://latex.csdn.net/eq?F%28A%2CB%2CC%2CD%2CE%29%3D%5Csum_%7Bi%3D1%7D%5E%7Bn%7D%28x%5E%7B2%7D_%7Bi%7DA&amp;plus;Bx_%7Bi%7Dy_%7Bi%7D&amp;plus;Cx_%7Bi%7D&amp;plus;Dy_%7Bi%7D&amp;plus;E%29%5E%7B2%7D"/>
    </p>
    <p>
     对上式求偏导F对每一个变量的偏导都应该等于零。
    </p>
    <h2 id="%E4%BA%94%E3%80%81%E5%AE%9A%E4%BD%8D%E5%AE%9E%E9%AA%8C" name="%E4%BA%94%E3%80%81%E5%AE%9A%E4%BD%8D%E5%AE%9E%E9%AA%8C">
     五、定位实验
    </h2>
    <p>
     柑橘果实拟合轮廓内部像素为Qi，人工标被遮挡柑橘果实轮廓区域内部像素Q，两者重合度为C，评价指标为
    </p>
    <p style="text-align:center">
     <img alt="C=\frac{\left | Q\cap Q_{i} \right |}{Q}\times 100" class="mathcode" src="https://latex.csdn.net/eq?C%3D%5Cfrac%7B%5Cleft%20%7C%20Q%5Ccap%20Q_%7Bi%7D%20%5Cright%20%7C%7D%7BQ%7D%5Ctimes%20100"/>
     %
    </p>
    <p>
     由于果实形心难以精确定位，不适合用空间位置误差评价算法定位精度，故定位误差为：
    </p>
    <p style="text-align:center">
     <img alt="\Delta =\sqrt{(x_{i}-x_{j})^{2}+(y_{i}-y_{j})^{2}+(z_{i}-z_{j})^{2}}" class="mathcode" src="https://latex.csdn.net/eq?%5CDelta%20%3D%5Csqrt%7B%28x_%7Bi%7D-x_%7Bj%7D%29%5E%7B2%7D&amp;plus;%28y_%7Bi%7D-y_%7Bj%7D%29%5E%7B2%7D&amp;plus;%28z_%7Bi%7D-z_%7Bj%7D%29%5E%7B2%7D%7D"/>
    </p>
    <p>
     下标i和j分别代表未遮挡和被遮挡的果实推断空间坐标。
    </p>
    <p>
     采用改进yolov8识别图像，得到的定位结果如下：
    </p>
    <p>
     <img alt="" height="211" src="https://i-blog.csdnimg.cn/direct/575bc3dfaca04202867cab44b1d0962a.png" width="1036"/>
    </p>
    <p>
     从左至右分别是原图像、改进后识别图像、特征提取后图像、补充后图像和人工拟合图像。
    </p>
    <p>
     和原yolov8算法计算被遮挡的形心坐标和果实直径，定位和果经误差对比如下：
    </p>
    <p>
     <img alt="" height="301" src="https://i-blog.csdnimg.cn/direct/6371da936aaa4d1ab4b1df27ea56b92c.png" width="923"/>
    </p>
    <p>
     被遮挡和果实重叠情况下，平均定位误差减少16.29mm，平均果经误差降低了8.03%。
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f35323838393331372f:61727469636c652f64657461696c732f313436313738393637" class_="artid" style="display:none">
 </p>
</div>


