---
layout: post
title: "c学习系列-002.写文件"
date: 2025-03-14 11:00:55 +0800
description: "c++  写文件"
keywords: "c++学习系列----002.写文件"
categories: ['C']
tags: ['开发语言', '学习', 'C']
artid: "146252165"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146252165
    alt: "c学习系列-002.写文件"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146252165
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146252165
cover: https://bing.ee123.net/img/rand?artid=146252165
image: https://bing.ee123.net/img/rand?artid=146252165
img: https://bing.ee123.net/img/rand?artid=146252165
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     c++学习系列----002.写文件
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="c__0">
     </a>
     c++ 写文件
    </h2>
    <p>
    </p>
    <br/>
    C++ 写文件的几种方式主要有以下几种：
    <p>
    </p>
    <table>
     <thead>
      <tr>
       <th>
        方式
       </th>
       <th>
        适用场景
       </th>
       <th>
        示例
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <code>
         std::ofstream
        </code>
       </td>
       <td>
        文本写入
       </td>
       <td>
        <code>
         file &lt;&lt; "text"
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <code>
         std::ofstream (std::ios::app)
        </code>
       </td>
       <td>
        追加文本
       </td>
       <td>
        <code>
         file &lt;&lt; "text"
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <code>
         std::ofstream (std::ios::binary)
        </code>
       </td>
       <td>
        二进制写入
       </td>
       <td>
        <code>
         file.write(data, size)
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <code>
         std::fstream
        </code>
       </td>
       <td>
        读写模式
       </td>
       <td>
        <code>
         file &lt;&lt; "text"
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <code>
         fprintf()
        </code>
        (C方式)
       </td>
       <td>
        C风格写入
       </td>
       <td>
        <code>
         fprintf(file, "text")
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <code>
         write()
        </code>
        (低级I/O)
       </td>
       <td>
        高效文件操作
       </td>
       <td>
        <code>
         write(fd, data, size)
        </code>
       </td>
      </tr>
     </tbody>
    </table>
    <hr/>
    <h3>
     <a id="1__ofstream__16">
     </a>
     1️⃣ 使用
     <code>
      ofstream
     </code>
     写入文本文件
    </h3>
    <p>
     最常见的方法，适用于写入纯文本数据。
    </p>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    std<span class="token double-colon punctuation">::</span>ofstream <span class="token function">file</span><span class="token punctuation">(</span><span class="token string">"output.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 打开文件进行写入（默认会覆盖原文件）</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>file<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        std<span class="token double-colon punctuation">::</span>cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"无法打开文件!"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    file <span class="token operator">&lt;&lt;</span> <span class="token string">"Hello, World!"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>  <span class="token comment">// 写入文本</span>
    file<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 关闭文件</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      🔹 说明
     </strong>
    </p>
    <ul>
     <li>
      <code>
       std::ofstream file("output.txt");
      </code>
      打开文件，
      <strong>
       默认覆盖
      </strong>
      原文件内容。
     </li>
     <li>
      <code>
       file &lt;&lt; "Hello, World!" &lt;&lt; std::endl;
      </code>
      以
      <strong>
       流式
      </strong>
      方式写入数据。
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="2__42">
     </a>
     2️⃣ 追加模式写入
    </h3>
    <p>
     在文件末尾追加内容，不覆盖原有内容，使用
     <code>
      std::ios::app
     </code>
     。
    </p>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    std<span class="token double-colon punctuation">::</span>ofstream <span class="token function">file</span><span class="token punctuation">(</span><span class="token string">"output.txt"</span><span class="token punctuation">,</span> std<span class="token double-colon punctuation">::</span>ios<span class="token double-colon punctuation">::</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 追加模式</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>file<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        file <span class="token operator">&lt;&lt;</span> <span class="token string">"追加内容..."</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    file<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      🔹 说明
     </strong>
    </p>
    <ul>
     <li>
      <code>
       std::ios::app
      </code>
      <strong>
       追加模式
      </strong>
      ，不会清空原文件，写入内容会添加到末尾。
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="3__62">
     </a>
     3️⃣ 写入二进制文件
    </h3>
    <p>
     使用
     <code>
      std::ios::binary
     </code>
     以二进制模式写入文件（适用于写入结构体、图片、音频等）。
    </p>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    std<span class="token double-colon punctuation">::</span>ofstream <span class="token function">file</span><span class="token punctuation">(</span><span class="token string">"data.bin"</span><span class="token punctuation">,</span> std<span class="token double-colon punctuation">::</span>ios<span class="token double-colon punctuation">::</span>binary<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 以二进制模式打开</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>file<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        std<span class="token double-colon punctuation">::</span>cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"无法打开文件!"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">int</span> number <span class="token operator">=</span> <span class="token number">12345</span><span class="token punctuation">;</span>
    file<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token generic-function"><span class="token function">reinterpret_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token operator">&amp;</span>number<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 写入二进制数据</span>
    file<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      🔹 说明
     </strong>
    </p>
    <ul>
     <li>
      <code>
       std::ios::binary
      </code>
      以
      <strong>
       二进制
      </strong>
      方式打开文件，适用于非文本数据。
     </li>
     <li>
      <code>
       file.write(reinterpret_cast&lt;char*&gt;(&amp;number), sizeof(number));
      </code>
      直接写入数据的
      <strong>
       二进制表示
      </strong>
      。
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="4__fstream__88">
     </a>
     4️⃣ 使用
     <code>
      fstream
     </code>
     进行读写
    </h3>
    <p>
     <code>
      std::fstream
     </code>
     既可以读也可以写，适用于需要修改文件的情况。
    </p>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    std<span class="token double-colon punctuation">::</span>fstream <span class="token function">file</span><span class="token punctuation">(</span><span class="token string">"output.txt"</span><span class="token punctuation">,</span> std<span class="token double-colon punctuation">::</span>ios<span class="token double-colon punctuation">::</span>in <span class="token operator">|</span> std<span class="token double-colon punctuation">::</span>ios<span class="token double-colon punctuation">::</span>out <span class="token operator">|</span> std<span class="token double-colon punctuation">::</span>ios<span class="token double-colon punctuation">::</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>file<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        std<span class="token double-colon punctuation">::</span>cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"无法打开文件!"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    file <span class="token operator">&lt;&lt;</span> <span class="token string">"这是一个可以读写的文件!"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    file<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      🔹 说明
     </strong>
    </p>
    <ul>
     <li>
      <code>
       std::ios::in | std::ios::out | std::ios::app
      </code>
      ：
      <strong>
       可读可写
      </strong>
      ，并且
      <strong>
       追加模式
      </strong>
      。
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="5__fprintfC__112">
     </a>
     5️⃣ 使用
     <code>
      fprintf()
     </code>
     （C 方式）
    </h3>
    <p>
     C 语言的
     <code>
      FILE*
     </code>
     ，可以使用
     <code>
      fprintf()
     </code>
     ：
    </p>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cstdio&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    FILE<span class="token operator">*</span> file <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"output.txt"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// "w" 代表写模式，覆盖原文件</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>file<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"无法打开文件"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">fprintf</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token string">"Hello, World!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 格式化写入</span>
    <span class="token function">fclose</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 关闭文件</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      🔹 说明
     </strong>
    </p>
    <ul>
     <li>
      <code>
       fopen("output.txt", "w")
      </code>
      以写模式打开文件（
      <strong>
       覆盖原内容
      </strong>
      ）。
     </li>
     <li>
      <code>
       fprintf(file, "Hello, World!\n")
      </code>
      格式化写入，类似
      <code>
       printf()
      </code>
      。
     </li>
     <li>
      <code>
       fclose(file);
      </code>
      关闭文件，避免资源泄漏。
     </li>
    </ul>
    <p>
     <strong>
      追加写入
     </strong>
     ，可以改为：
    </p>
    <pre><code class="prism language-cpp">FILE<span class="token operator">*</span> file <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"output.txt"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// "a" 追加模式</span>
</code></pre>
    <hr/>
    <h3>
     <a id="6__write__IO__143">
     </a>
     6️⃣ 使用
     <code>
      write()
     </code>
     低级 I/O 方式
    </h3>
    <p>
     <code>
      write()
     </code>
     是 POSIX 系统（如 Linux）中的低级 I/O 操作，可以提高效率。
    </p>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">int</span> fd <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"output.txt"</span><span class="token punctuation">,</span> O_WRONLY <span class="token operator">|</span> O_CREAT <span class="token operator">|</span> O_TRUNC<span class="token punctuation">,</span> <span class="token number">0644</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>fd <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"无法打开文件"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> text <span class="token operator">=</span> <span class="token string">"Hello, World!\n"</span><span class="token punctuation">;</span>
    <span class="token function">write</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> text<span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 低级写入</span>
    <span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 关闭文件</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      🔹 说明
     </strong>
    </p>
    <ul>
     <li>
      <code>
       open("output.txt", O_WRONLY | O_CREAT | O_TRUNC, 0644)
      </code>
      以
      <strong>
       写模式
      </strong>
      打开或创建文件。
     </li>
     <li>
      <code>
       write(fd, text, 14);
      </code>
      直接写入
      <strong>
       字节流
      </strong>
      。
     </li>
     <li>
      <code>
       close(fd);
      </code>
      关闭文件。
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="_171">
     </a>
     推荐方式
    </h3>
    <ul>
     <li>
      <strong>
       一般文本写入
      </strong>
      →
      <code>
       std::ofstream
      </code>
     </li>
     <li>
      <strong>
       追加模式
      </strong>
      →
      <code>
       std::ofstream + std::ios::app
      </code>
     </li>
     <li>
      <strong>
       二进制文件
      </strong>
      →
      <code>
       std::ofstream + std::ios::binary
      </code>
     </li>
     <li>
      <strong>
       需要读写
      </strong>
      →
      <code>
       std::fstream
      </code>
     </li>
     <li>
      <strong>
       低级 I/O
      </strong>
      →
      <code>
       write()
      </code>
      （适用于大文件或性能关键场景）
     </li>
    </ul>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f61613836373733343339382f:61727469636c652f64657461696c732f313436323532313635" class_="artid" style="display:none">
 </p>
</div>


