---
layout: post
title: "rediszset-类型基本命令上"
date: 2025-03-14 21:13:01 +0800
description: "集合：排序的规则是什么？ 中的  仍然要求是唯一的， 可以重复 主要还是用来存  的， 只是辅助，进行排序使用  往有序集合中，添加元素语法：时间复杂度：O(logN)O(logN)O(logN)，NNN 为有序集合中的元素个数添加的时候，既要添加元素，又要添加分数。 和  称为是一个“”不要把  和  理解成“键值对”（ ）。键值对中，是有明确的“角色区分”，谁是键，谁是值，是明确的，一定是根据键找到值：只会更新已经存在的元素，不会添加新元素：只能添加新元素，不会更新已经存在的元"
keywords: "【redis】zset 类型：基本命令（上）"
categories: ['Redis']
tags: ['缓存', '数据库', 'Redis']
artid: "146267452"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146267452
    alt: "rediszset-类型基本命令上"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146267452
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146267452
cover: https://bing.ee123.net/img/rand?artid=146267452
image: https://bing.ee123.net/img/rand?artid=146267452
img: https://bing.ee123.net/img/rand?artid=146267452
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     【redis】zset 类型：基本命令（上）
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     <code>
      set
     </code>
     集合：
    </p>
    <ol>
     <li>
      唯一
     </li>
     <li>
      无序。（顺序不重要）孙行者、行者孙==&gt;同一只猴
     </li>
    </ol>
    <p>
     <code>
      list
     </code>
    </p>
    <ol>
     <li>
      有序。（顺序很重要）孙行者、行者孙==&gt;不同的猴
     </li>
    </ol>
    <p>
     <code>
      zset
     </code>
    </p>
    <ol>
     <li>
      有序。升序/降序
     </li>
    </ol>
    <hr/>
    <h2>
     <a id="_15">
     </a>
     有序集合
    </h2>
    <p>
     排序的规则是什么？
    </p>
    <ul>
     <li>
      给
      <code>
       zset
      </code>
      中的
      <code>
       member
      </code>
      引入了一个属性——分数（
      <code>
       score
      </code>
      ），浮点类型
     </li>
     <li>
      每个
      <code>
       member
      </code>
      都会安排一个分数
      <br/>
      进行排序的时候，就是依照此处的
      <strong>
       分数
      </strong>
      大小，来进行升序/降序排序
     </li>
    </ul>
    <p>
     <img alt="image.png" src="https://i-blog.csdnimg.cn/img_convert/7822fdc52bddcdc624f7ce86e57568f6.png"/>
    </p>
    <ul>
     <li>
      分数就是：“
      <strong>
       武力值
      </strong>
      “
     </li>
    </ul>
    <p>
     <code>
      zset
     </code>
     中的
     <code>
      member
     </code>
     仍然要求是唯一的，
     <code>
      score
     </code>
     可以重复
     <br/>
     <code>
      zset
     </code>
     主要还是用来存
     <code>
      member
     </code>
     的，
     <code>
      score
     </code>
     只是辅助，进行排序
    </p>
    <p>
     <img alt="image.png" src="https://i-blog.csdnimg.cn/img_convert/d1112d94acdd0e249463d2eaecbf172a.png"/>
    </p>
    <h2>
     <a id="ZADD_34">
     </a>
     ZADD
    </h2>
    <p>
     使用
     <code>
      zadd
     </code>
     往有序集合中，添加元素
    </p>
    <hr/>
    <p>
     <strong>
      语法：
     </strong>
    </p>
    <pre><code class="prism language-redis">ZADD key [NX | XX] [GT | CH] [INCR] score member [score member ...]

ZRANGE key start end [withscores]
</code></pre>
    <ul>
     <li>
      时间复杂度：
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         O 
         
        
          ( 
         
        
          l 
         
        
          o 
         
        
          g 
         
        
          N 
         
        
          ) 
         
        
       
         O(logN)
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           O
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0197em;">
           l
          </span>
          <span class="mord mathnormal">
           o
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           g
          </span>
          <span class="mord mathnormal" style="margin-right: 0.109em;">
           N
          </span>
          <span class="mclose">
           )
          </span>
         </span>
        </span>
       </span>
      </span>
      ，
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         N 
         
        
       
         N
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.109em;">
           N
          </span>
         </span>
        </span>
       </span>
      </span>
      为有序集合中的元素个数
     </li>
     <li>
      添加的时候，既要添加元素，又要添加分数。
      <code>
       member
      </code>
      和
      <code>
       score
      </code>
      称为是一个“
      <code>
       pair
      </code>
      ”
      <ul>
       <li>
        不要把
        <code>
         member
        </code>
        和
        <code>
         score
        </code>
        理解成“键值对”（
        <code>
         key-value
        </code>
        <code>
         pair
        </code>
        ）。键值对中，是有明确的“角色区分”，谁是键，谁是值，是明确的，
        <strong>
         一定是根据键找到值
        </strong>
       </li>
      </ul>
     </li>
    </ul>
    <hr/>
    <ul>
     <li>
      <code>
       XX
      </code>
      ：只会更新已经存在的元素，不会添加新元素
     </li>
     <li>
      <code>
       NX
      </code>
      ：只能添加新元素，不会更新已经存在的元素
     </li>
     <li>
      都不加
      <ul>
       <li>
        如果当前的
        <code>
         member
        </code>
        不存在，此时就会达到“添加新
        <code>
         member
        </code>
        ”的效果
       </li>
       <li>
        如果当前
        <code>
         member
        </code>
        已经存在，此时就会更新分数
       </li>
      </ul>
     </li>
    </ul>
    <hr/>
    <ul>
     <li>
      <code>
       LT
      </code>
      （
      <code>
       less than
      </code>
      ）：更新分数的时候，要是添加的分数比之前的分数小，此时就更新，否则就不更新
     </li>
     <li>
      <code>
       GT
      </code>
      （
      <code>
       greater than
      </code>
      ）：和
      <code>
       LG
      </code>
      相反
     </li>
    </ul>
    <hr/>
    <ul>
     <li>
      <code>
       CH
      </code>
      （
      <code>
       changed
      </code>
      ）：针对返回值进行描述，影响到
      <code>
       zadd
      </code>
      的返回值
      <ul>
       <li>
        本来
        <code>
         zadd
        </code>
        返回的是新增的元素个数
       </li>
       <li>
        加了
        <code>
         CH
        </code>
        之后，还会告诉我们修改后的元素个数
       </li>
      </ul>
     </li>
    </ul>
    <hr/>
    <ul>
     <li>
      <code>
       INCR
      </code>
      ：能够针对现有元素的分数进行运算
     </li>
    </ul>
    <hr/>
    <blockquote>
     <p>
      <code>
       zset
      </code>
      内部实际上就是按照升序方式来排列的
     </p>
    </blockquote>
    <h3>
     <a id="_66">
     </a>
     新增
    </h3>
    <p>
     <img alt="image.png" src="https://i-blog.csdnimg.cn/img_convert/d96913603a9ce76e976925e8d7aab03a.png"/>
    </p>
    <ul>
     <li>
      查询结果降序
      <img alt="image.png" src="https://i-blog.csdnimg.cn/img_convert/c5359d1372c151c8aebf34034750e670.png"/>
     </li>
    </ul>
    <h3>
     <a id="_71">
     </a>
     修改
    </h3>
    <p>
     <img alt="image.png|325" src="https://i-blog.csdnimg.cn/img_convert/38557da38f79d6f566f47bc7a363d6ae.png"/>
    </p>
    <p>
     如果
     <strong>
      修改的分数，影响到了之前的顺序
     </strong>
     ，救护级自动移动之前的位置，保证是降序排序
    </p>
    <h2>
     <a id="ZCARD_82">
     </a>
     ZCARD
    </h2>
    <p>
     获取一个
     <code>
      zset
     </code>
     的计数，即元素个数
    </p>
    <hr/>
    <p>
     <strong>
      语法：
     </strong>
    </p>
    <pre><code class="prism language-redis">ZCARD key
</code></pre>
    <ul>
     <li>
      返回值：
      <code>
       zset
      </code>
      内的元素个数
      <img alt="|262" src="https://i-blog.csdnimg.cn/img_convert/7d4f1fe59d78891dea78673cb551d180.png"/>
     </li>
    </ul>
    <h2>
     <a id="ZCOUNT_93">
     </a>
     ZCOUNT
    </h2>
    <p>
     返回分数在
     <code>
      min
     </code>
     和
     <code>
      max
     </code>
     之间元素的个数，默认情况下
     <code>
      min
     </code>
     和
     <code>
      max
     </code>
     都是包含的，可以通过
     <code>
      ()
     </code>
     排除
    </p>
    <hr/>
    <p>
     <strong>
      语法：
     </strong>
    </p>
    <pre><code class="prism language-redis">ZCOUNT key min max
</code></pre>
    <ul>
     <li>
      <p>
       时间复杂度：
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          O 
          
         
           ( 
          
         
           l 
          
         
           o 
          
         
           g 
          
         
           N 
          
         
           ) 
          
         
        
          O(logN)
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 1em; vertical-align: -0.25em;">
           </span>
           <span class="mord mathnormal" style="margin-right: 0.0278em;">
            O
           </span>
           <span class="mopen">
            (
           </span>
           <span class="mord mathnormal" style="margin-right: 0.0197em;">
            l
           </span>
           <span class="mord mathnormal">
            o
           </span>
           <span class="mord mathnormal" style="margin-right: 0.0359em;">
            g
           </span>
           <span class="mord mathnormal" style="margin-right: 0.109em;">
            N
           </span>
           <span class="mclose">
            )
           </span>
          </span>
         </span>
        </span>
       </span>
      </p>
      <ul>
       <li>
        先根据
        <code>
         min
        </code>
        找到对应的元素，
        <span class="katex--inline">
         <span class="katex">
          <span class="katex-mathml">
           l 
           
          
            o 
           
          
            g 
           
          
            ( 
           
          
            N 
           
          
            ) 
           
          
         
           log(N)
          </span>
          <span class="katex-html">
           <span class="base">
            <span class="strut" style="height: 1em; vertical-align: -0.25em;">
            </span>
            <span class="mord mathnormal" style="margin-right: 0.0197em;">
             l
            </span>
            <span class="mord mathnormal">
             o
            </span>
            <span class="mord mathnormal" style="margin-right: 0.0359em;">
             g
            </span>
            <span class="mopen">
             (
            </span>
            <span class="mord mathnormal" style="margin-right: 0.109em;">
             N
            </span>
            <span class="mclose">
             )
            </span>
           </span>
          </span>
         </span>
        </span>
       </li>
       <li>
        再根据
        <code>
         max
        </code>
        找到对应的元素，
        <span class="katex--inline">
         <span class="katex">
          <span class="katex-mathml">
           l 
           
          
            o 
           
          
            g 
           
          
            ( 
           
          
            N 
           
          
            ) 
           
          
         
           log(N)
          </span>
          <span class="katex-html">
           <span class="base">
            <span class="strut" style="height: 1em; vertical-align: -0.25em;">
            </span>
            <span class="mord mathnormal" style="margin-right: 0.0197em;">
             l
            </span>
            <span class="mord mathnormal">
             o
            </span>
            <span class="mord mathnormal" style="margin-right: 0.0359em;">
             g
            </span>
            <span class="mopen">
             (
            </span>
            <span class="mord mathnormal" style="margin-right: 0.109em;">
             N
            </span>
            <span class="mclose">
             )
            </span>
           </span>
          </span>
         </span>
        </span>
       </li>
       <li>
        <code>
         zset
        </code>
        内部，会记录每个元素当前的“
        <strong>
         排行
        </strong>
        ”/“
        <strong>
         次序
        </strong>
        ”，查询到元素，就直接知道了元素所在的“次序”，就可以直接把
        <code>
         max
        </code>
        对应的元素次序和
        <code>
         min
        </code>
        对应的元素次序，减法即可
       </li>
      </ul>
     </li>
     <li>
      <p>
       返回值：在区间的元素个数
       <img alt="image.png|310" src="https://i-blog.csdnimg.cn/img_convert/6c753046464e6fc9bc02f74cdd699909.png"/>
      </p>
     </li>
     <li>
      <p>
       <code>
        min
       </code>
       和
       <code>
        max
       </code>
       都可以写成浮点数（
       <code>
        zset
       </code>
       分数本身就是浮点数）
      </p>
      <ul>
       <li>
        在浮点数中，存在两个特殊的数值
        <ul>
         <li>
          <code>
           inf
          </code>
          ：无穷大
         </li>
         <li>
          <code>
           -inf
          </code>
          ：负无穷大
         </li>
        </ul>
       </li>
      </ul>
     </li>
    </ul>
    <h2>
     <a id="ZRANGEZREVRANGE_113">
     </a>
     ZRANGE/ZREVRANGE
    </h2>
    <p>
     返回指定区间⾥的元素，分数按照
     <strong>
      升序/降序
     </strong>
     。带上
     <code>
      WITHSCORES
     </code>
     可以把分数也返回。
    </p>
    <hr/>
    <p>
     语法：
    </p>
    <pre><code class="prism language-reids">ZRANGE key start stop [withscores]

ZREVRANGE key start stop [withscores]
</code></pre>
    <ul>
     <li>
      返回区间元素列表
      <img alt="image.png|402" src="https://i-blog.csdnimg.cn/img_convert/1ebd35dba9b70af159892c5091865014.png"/>
     </li>
    </ul>
    <h2>
     <a id="ZPOPMAXZPOPMIN_126">
     </a>
     ZPOPMAX/ZPOPMIN
    </h2>
    <p>
     删除并返回分数
     <strong>
      最高/最低
     </strong>
     的
     <code>
      count
     </code>
     个元素
    </p>
    <hr/>
    <p>
     <strong>
      语法：
     </strong>
    </p>
    <pre><code class="prism language-redis">ZPOPMAX key [count]
</code></pre>
    <ul>
     <li>
      返回值：分数和元素列表
      <img alt="image.png|346" src="https://i-blog.csdnimg.cn/img_convert/dce044227fc9efb09eec452502567cf9.png"/>
     </li>
    </ul>
    <blockquote>
     <p>
      如果存在多个元素，分数相同，同时为最大值，
      <code>
       zpopmax
      </code>
      删的时候，仍然只删除其中一个
     </p>
    </blockquote>
    <h2>
     <a id="BZPOPMAXBZPOPMIN_140">
     </a>
     BZPOPMAX/BZPOPMIN
    </h2>
    <p>
     这里的有序集合，也可以视为一个“
     <strong>
      优先级队列
     </strong>
     ”，所以有的时候，也需要一个带有“
     <strong>
      阻塞功能
     </strong>
     ”的优先级队列
    </p>
    <p>
     每个
     <code>
      key
     </code>
     都是一个有序集合。阻塞也是在有序集合为空的时候触发阻塞，阻塞到有其他客户端插入元素
    </p>
    <ul>
     <li>
      <code>
       timeout
      </code>
      表示
      <strong>
       超时时间
      </strong>
      ，单位是秒
      <code>
       s
      </code>
     </li>
    </ul>
    <hr/>
    <p>
     <strong>
      语法：
     </strong>
    </p>
    <pre><code class="prism language-redis">BZPOPMAX key [key ...] timeout
</code></pre>
    <p>
     <img alt="image.png" src="https://i-blog.csdnimg.cn/img_convert/fe61d5004210703e149b54b5c17315cd.png"/>
    </p>
    <h2>
     <a id="ZRANKZREVRANK_159">
     </a>
     ZRANK/ZREVRANK
    </h2>
    <p>
     返回指定元素的排名，
     <strong>
      升序/降序
     </strong>
    </p>
    <hr/>
    <p>
     <strong>
      语法：
     </strong>
    </p>
    <pre><code class="prism language-redis">ZRANK key member

ZREVRANKE key member
</code></pre>
    <ul>
     <li>
      时间复杂度：
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         O 
         
        
          ( 
         
        
          N 
         
        
          ) 
         
        
       
         O(N)
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           O
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord mathnormal" style="margin-right: 0.109em;">
           N
          </span>
          <span class="mclose">
           )
          </span>
         </span>
        </span>
       </span>
      </span>
     </li>
     <li>
      排名从
      <code>
       0
      </code>
      开始
      <img alt="image.png" src="https://i-blog.csdnimg.cn/img_convert/d5468957ea153ded9f4e69933487a473.png"/>
     </li>
    </ul>
    <h2>
     <a id="ZSCORE_177">
     </a>
     ZSCORE
    </h2>
    <p>
     返回指定元素的分数
    </p>
    <hr/>
    <p>
     <strong>
      语法：
     </strong>
    </p>
    <pre><code class="prism language-redis">ZSCORE key member 
</code></pre>
    <ul>
     <li>
      返回值：分数
      <img alt="image.png" src="https://i-blog.csdnimg.cn/img_convert/8cf5cbab58be2d94978918a8e7419f35.png"/>
     </li>
    </ul>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
  <div class="blog-extension-box" id="blogExtensionBox" style="width:400px;margin:auto;margin-top:12px">
  </div>
 </article>
 <p alt="68747470:733a2f2f626c6f672e6373646e2e6e65742f5965656561722f:61727469636c652f64657461696c732f313436323637343532" class_="artid" style="display:none">
 </p>
</div>


