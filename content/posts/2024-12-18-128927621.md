---
layout: post
title: "uni-app开发微信小程序遇到的部分坑"
date: 2024-12-18 10:25:54 +0800
description: "记录一些官方文档没有的踩坑点。_uniapp 微信小程序 onload不执行"
keywords: "uniapp 微信小程序 onload不执行"
categories: ['App']
tags: ['微信小程序', '小程序', 'App']
artid: "128927621"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=128927621
    alt: "uni-app开发微信小程序遇到的部分坑"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=128927621
featuredImagePreview: https://bing.ee123.net/img/rand?artid=128927621
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     uni-app开发微信小程序遇到的部分坑
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <div class="kdocs-document">
     <p style="">
      记录一些官方文档没有的踩坑点。
     </p>
     <h5 style="text-align:left;">
      一、组件设置全屏覆盖
     </h5>
     <p style="">
      设置宽度和高度100%是没用的需要在里面加设置一层view，并且设置对应宽高分别为vw和vh
     </p>
     <pre class="kdocs-plaintext"><code class="language-plaintext">&lt;uni-popup&gt;
  &lt;viewclass="wrap_test"&gt;&lt;/view&gt;
&lt;/uni-popup&gt;

&lt;stylelang="scss"&gt;.wrap_test{
  width:100vw;
  height:100vh;
}
&lt;/style&gt;复制代码</code></pre>
     <h5 style="text-align:left;">
      二、wx.onNetworkStatusChange、uni.onNetworkStatusChange网络状态监听不生效问题
     </h5>
     <p style="">
      1、该方法只能在手机上进行验证才能生效，小程序开发工具上面不生效2、该方法只能写在onLoad方法里面，写在mounted方法不生效
     </p>
     <p style="">
      错误写法❌
     </p>
     <pre class="kdocs-plaintext"><code class="language-plaintext">mounted() {
     uni.onNetworkStatusChange(function (res) {
       console.log('onNetworkStatusChange', res);
     });
  },
复制代码</code></pre>
     <p style="">
      正确写法✔，手机上打开关闭数据、切换wifi连接都可以看得到效果
     </p>
     <pre class="kdocs-plaintext"><code class="language-plaintext">onLoad(data) {
    wx.onNetworkStatusChange((res) =&gt; {
      console.log('res' , res);
    });
  },
复制代码</code></pre>
     <h5 style="text-align:left;">
      三、接口请求写在哪里好？（即返回页面不刷新问题）
     </h5>
     <p style="">
      1、可以写在onShow、onLoad、created、mounted
     </p>
     <p style="">
      <span class="kdocs-bold" style="font-weight:bold;">
       但是：写在onShow里面最好
      </span>
      ✔
     </p>
     <p style="">
      原因：在很多情况下跳转后都需要刷新页面数据。因为onshow是在页面展示时候触发，通过uni.navigateTo不会销毁页面，返回时候页面的onLoad不会触发。
     </p>
     <p style="">
      例如：通过导航栏返回按钮图标或者uni.navigateTo跳转到指定页面需要刷新页面数据时候，onShow只要页面展示了就会请求。
     </p>
     <p style="">
      2、需要通过onLoad的参数来发起请求怎么办？
     </p>
     <pre class="kdocs-plaintext"><code class="language-plaintext">onLoad(data) {
    this.prePageParams = data;  // 先把参数存起来
  },
  onShow() {
    this.fetch(this.prePageParams);  // 再拿到参数发起请求
  },
复制代码</code></pre>
     <h5 style="text-align:left;">
      四、uni-app微信小程序margin-bottom失效（有且只有ios系统上是失效的）
     </h5>
     <p style="">
      蓝色的区域是position:fixed。（因为写了这个，会导致ios上设置margin-bottom失效无效）图中图片需要距离底部，不能被蓝色部分遮住，我写了margin-bottom，在模拟器上以及安卓手机是可以的，但是ios系统会不行。
     </p>
     <p style="">
      安卓机型没问题：
     </p>
     <div class="kdocs-line-container" style="display:flex;">
      <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:384px;justify-content:center;align-items:center;height:auto;">
       <div class="kdocs-img" style="padding-top:53.645832%;height:0;">
        <img src="https://i-blog.csdnimg.cn/blog_migrate/d694f875625cfef21ffabaaa4b83a85d.png" style="margin-left:;display:block;width:384px;margin-top:-53.645832%;height:auto;">
        </img>
       </div>
      </div>
     </div>
     <p style="">
      如果是真机上，ios手机就会出现这种问题，导致图片被遮住（这张图演示ios上失效的示例）：
     </p>
     <div class="kdocs-line-container" style="display:flex;">
      <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:377px;justify-content:center;align-items:center;height:auto;">
       <div class="kdocs-img" style="padding-top:66.578255%;height:0;">
        <img src="https://i-blog.csdnimg.cn/blog_migrate/d365c750bd2063896fe7f4311e5e6ef6.png" style="margin-left:;display:block;width:377px;margin-top:-66.578255%;height:auto;">
        </img>
       </div>
      </div>
     </div>
     <p style="">
      <span class="kdocs-bold" style="font-weight:bold;">
       解决办法
      </span>
      ✔
      <span class="kdocs-bold" style="font-weight:bold;">
       ：在底部增加一个空白的view设置高度即可
      </span>
     </p>
     <div class="kdocs-line-container" style="display:flex;">
      <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:740px;justify-content:center;align-items:center;height:auto;">
       <div class="kdocs-img" style="padding-top:29.594595%;height:0;">
        <img src="https://i-blog.csdnimg.cn/blog_migrate/31c2d6d0c8fbcc69372900a27c49fb24.png" style="margin-left:;display:block;width:740px;margin-top:-29.594595%;height:auto;">
        </img>
       </div>
      </div>
     </div>
     <h5 style="text-align:left;">
      五、微信小程序button通过数组的length判断disabled无效（数组length === 0写法无效）
     </h5>
     <p style="">
      错误写法❌
     </p>
     <pre class="kdocs-plaintext"><code class="language-plaintext"> &lt;button type="default" @click="handleTag" :disabled="selectedKeys.length === 0"&gt;
    标记
 &lt;/button&gt;
复制代码</code></pre>
     <p style="">
      给selectedKeys.push()进数据的时候按钮还是禁用的。失效截图：
     </p>
     <div class="kdocs-line-container" style="display:flex;">
      <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:384px;justify-content:center;align-items:center;height:auto;">
       <div class="kdocs-img" style="padding-top:36.197918%;height:0;">
        <img src="https://i-blog.csdnimg.cn/blog_migrate/24ede044874c48f5444034e747826b29.png" style="margin-left:;display:block;width:384px;margin-top:-36.197918%;height:auto;">
        </img>
       </div>
      </div>
     </div>
     <p style="">
      这种写法是无效的，是微信小程序的一个bug虽然button的组件是由uni-app提供的，在由小程序运行时候，会转为小程序的button。
     </p>
     <p style="">
      微信开放社区，有个相同的提问，官方回复：
     </p>
     <div class="kdocs-line-container" style="display:flex;">
      <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:740px;justify-content:center;align-items:center;height:auto;">
       <div class="kdocs-img" style="padding-top:25.81081%;height:0;">
        <img src="https://i-blog.csdnimg.cn/blog_migrate/4822baea9f9a6c83ae95d6dcbd4112d6.png" style="margin-left:;display:block;width:740px;margin-top:-25.81081%;height:auto;">
        </img>
       </div>
      </div>
     </div>
     <p style="">
      <span class="kdocs-bold" style="font-weight:bold;">
       解决办法，正确写法
      </span>
      ✔
      <span class="kdocs-bold" style="font-weight:bold;">
       ：
      </span>
     </p>
     <p style="">
      1、直接使用length即可（推荐）
     </p>
     <pre class="kdocs-plaintext"><code class="language-plaintext">&lt;button   type="default"  @click="handleTag"  :disabled="selectedKeys.length"&gt;
    标记
&lt;/button&gt;
复制代码</code></pre>
     <p style="">
      2、通过computed计算属性
     </p>
     <pre class="kdocs-plaintext"><code class="language-plaintext">&lt;button type="default" @click="handleTag" :disabled="test"&gt;
    标记
&lt;/button&gt;

// vue中的computedcomputed: {
    test() {
      returnthis.selectedKeys.length === 0;
    },
  },
复制代码</code></pre>
     <h5 style="text-align:left;">
      六、无法动态引入javascript脚本
     </h5>
     <p style="">
      不能像web端一样写script标签引入，因为不支持动态加载这种方式 引入，无法解决，你只需要知道即可。
     </p>
     <h5 style="text-align:left;">
      七、swiper无法动态设置circular怎么办？
     </h5>
     <p style="">
      和问题5有点类似，解决办法一样使用computed
     </p>
     <pre class="kdocs-plaintext"><code class="language-plaintext">&lt;template&gt;
  &lt;swiper:circular="!canCircular" &gt;&lt;/swiper&gt;
&lt;/template&gt;

exportdefault {
  data() {
    return {
      photoListData:[]
    }  
  },
  computed: {
    canCircular() {
      returnthis.photoListData.length &gt; 0;
    }
  }
}
复制代码</code></pre>
     <h5 style="text-align:left;">
      八、IOS苹果手机上时间格式化错误显示Invalid Date
     </h5>
     <p style="">
      只在真机IOS上面才会出现，小程序模拟器上的ios是不会出现的，原因是因为时间格式只要带有-符号就会（但有个ios机型却不会出错，我用苹果11测试会出现Invalid Date）。有几种情况，例如：
     </p>
     <p style="">
      1、new Date('2022-01-05')这样写，会出错，变成Invalid Date
     </p>
     <p style="">
      2、后端返回这种时间格式：2022-01-05T11:24:04.000+0800，如果使用
      <a class="kdocs-link" href="https://link.juejin.cn?target=https%3A%2F%2Fdayjs.fenxianglu.cn%2Fcategory%2Fparse.html%23utc" rel="nofollow noopener noreferrer" style="color:#0A6CFF;" target="_blank">
       dayjs
      </a>
      格式化dayjs(2022-01-05T11:24:04.000+0800).format( 'MM/DD HH:mm')会同样显示错误。
     </p>
     <p style="">
      <span class="kdocs-bold" style="font-weight:bold;">
       解决办法
      </span>
      ✔
      <span class="kdocs-bold" style="font-weight:bold;">
       (三种)：
      </span>
     </p>
     <p style="">
      1、正常的时间格式直接replace掉
     </p>
     <pre class="kdocs-plaintext"><code class="language-plaintext">let time = "2020-03-30 14:39"letTF = newDate(time.replace(/-/g,'/'))
复制代码</code></pre>
     <p style="">
      2、使用
      <a class="kdocs-link" href="https://link.juejin.cn?target=http%3A%2F%2Fmomentjs.cn%2F" rel="nofollow noopener noreferrer" style="color:#0A6CFF;" target="_blank">
       moment
      </a>
      时间格式化（缺点是它比较大这个包）
     </p>
     <pre class="kdocs-plaintext"><code class="language-plaintext">moment(2022-01-05T11:24:04.000+0800).format( 'MM/DD HH:mm')
复制代码</code></pre>
     <p style="">
      3、如果针对后端返回的那个格式：2022-01-05T11:24:04.000+0800，还想使用
      <a class="kdocs-link" href="https://link.juejin.cn?target=https%3A%2F%2Fdayjs.fenxianglu.cn%2Fcategory%2Fparse.html%23utc" rel="nofollow noopener noreferrer" style="color:#0A6CFF;" target="_blank">
       dayjs
      </a>
      （它包非常小，小程序上面很实用），需要自己转换替换下符号'-'
     </p>
     <pre class="kdocs-plaintext"><code class="language-plaintext">// 先转换格式constresolveTimeOnIos = (time) =&gt; {
  let data = '0/0/0 00:00';
  if (time &amp;&amp; time.indexOf('-') !== -1 &amp;&amp; time.indexOf('+') !== -1) {
    const translate = time
      .replace(/T/g, ' ')
      .replace(/\.[\d]{3}Z/, '')
      .replace(/(-)/g, '/');
    data = translate.substring(0, translate.indexOf('.'));
  }
  return data;
}

const  time = '2022-01-05T11:24:04.000+0800'// 这种格式时间转换const translateTime = resolveTimeOnIos (time)  // 先转换dayjs(translateTime ).format( 'MM/DD HH:mm')  // 使用dayjs格式换格式复制代码</code></pre>
     <h5 style="text-align:left;">
      九、px和rpx相加计算不准确问题（吸顶效果的实现在不同机型存在间隙误差问题）
     </h5>
     <p style="">
      什么时候会碰到这个问题？当需要吸顶效果，并且，头部是自定义的头部。我用的是在uniapp组件库下载的一个叫做
      <a class="kdocs-link" href="https://link.juejin.cn?target=https%3A%2F%2Fext.dcloud.net.cn%2Fplugin%3Fid%3D5001" rel="nofollow noopener noreferrer" style="color:#0A6CFF;" target="_blank">
       zhouWei-naeBar
      </a>
      的组件，用于自定义头部（这个组件在源码里面写了 92rpx 的高度，记住这是前提）。
     </p>
     <p style="">
      <span class="kdocs-bold" style="font-weight:bold;">
       吸顶的top高度 = 自定义头部的高度 + 不同机型的刘海高度。
      </span>
     </p>
     <div class="kdocs-line-container" style="display:flex;">
      <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:377px;justify-content:center;align-items:center;height:auto;">
       <div class="kdocs-img" style="padding-top:88.59417%;height:0;">
        <img src="https://i-blog.csdnimg.cn/blog_migrate/7a5f6235ba7cb676f391ddd759209a30.png" style="margin-left:;display:block;width:377px;margin-top:-88.59417%;height:auto;">
        </img>
       </div>
      </div>
     </div>
     <p style="">
      所以上图吸顶（圈起来的红色）top值就为：
     </p>
     <pre class="kdocs-plaintext"><code class="language-plaintext">top = 92rpx + uni.getSystemInfoSync()['statusBarHeight']
复制代码</code></pre>
     <p style="">
      但是由于小程序获取到的刘海高度是以px像素为单位的，这就很操蛋！会变成
     </p>
     <pre class="kdocs-plaintext"><code class="language-plaintext">top = 92rpx + 43px   // (假设获取到是43px)复制代码</code></pre>
     <p style="">
      这样计算出来的单位是不一致的，通过不同的dpr计算也不行，不同机型会有吸顶间隙的问题。
     </p>
     <p style="">
      <span class="kdocs-bold" style="font-weight:bold;">
       解决办法
      </span>
      ✔
      <span class="kdocs-bold" style="font-weight:bold;">
       ：使用calc动态计算
      </span>
     </p>
     <pre class="kdocs-plaintext"><code class="language-plaintext">// statusBarHeight 是刘海高度
 &lt;view :style="{ top: `calc(${statusBarHeight}px + 92rpx)` }" &gt;
    这是一个吸顶盒子
 &lt;/view&gt;
复制代码</code></pre>
     <h5 style="text-align:left;">
      十、遇到checkbox、radio组件样式设置问题
     </h5>
     <p style="">
      这个很坑，它们是原生的组件，修改样式只能在app.vue里面修改，目前只知道这一种解决办法。如果你的UI给的图比较特殊，用css写比较困难，推荐使用图片代替，请看下面示例+效果图。
     </p>
     <p style="">
      <span class="kdocs-bold" style="font-weight:bold;">
       正确设置
      </span>
      ✔
      <span class="kdocs-bold" style="font-weight:bold;">
       ：在App.vue文件里设置
      </span>
     </p>
     <p style="">
      test.vue文件（这里假设你使用checkbox或者radio的组件）：
     </p>
     <pre class="kdocs-plaintext"><code class="language-plaintext">&lt;template&gt;
    &lt;viewclass="custom-checkbox"&gt;
      	&lt;checkbox-group&gt;
	  &lt;checkbox&gt;
	    checkbox
	  &lt;/checkbox&gt;
	&lt;/checkbox-group&gt;&lt;/view&gt;
&lt;/template&gt;
复制代码</code></pre>
     <p style="">
      <span class="kdocs-bold" style="font-weight:bold;">
       App.vue文件（这里设置）：
      </span>
     </p>
     <p style="">
      提示：不用引入样式，全局设置刷新直接生效.custom-checkbox用于包裹你的组件，只要哪里使用直接包裹就可以生效样式全局通用。
     </p>
     <pre class="kdocs-plaintext"><code class="language-plaintext">&lt;style lang="scss"&gt;
.custom-checkbox {  // 使用一层类名包裹避免全局污染，下面开始设置选中前的你要样式//设置通用样式 
	.universal_sty {
		border: none;
		width: 42rpx;
		height: 39rpx;
		background-color: transparent;
		background-repeat: no-repeat;
		background-size: 100%;
	}

	//选中前的样式----------------------------------
	checkbox .wx-checkbox-input {
		background-image: url('./static/choice_no.png'); //替换为你要的图片样式
		@extend .universal_sty;
	}

	//选中前原本的图标样式-需要把它置空
	checkbox .wx-checkbox-input::before {
		font-size: 0rpx;
		background: transparent;
	}

	//选中后的样式---------------------------------
	checkbox .wx-checkbox-input.wx-checkbox-input-checked {
		background-image: url('./static/choice_much.png'); //替换为你要的图片样式
		@extend .universal_sty;
	}

	//选中后的图标样式，需要把它置空
	checkbox .wx-checkbox-input.wx-checkbox-input-checked::before {
		font-size: 0rpx;
		background: transparent;
	}
}

&lt;/style&gt;
复制代码</code></pre>
     <p style="">
      效果：
     </p>
     <div class="kdocs-line-container" style="display:flex;">
      <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:362px;justify-content:center;align-items:center;height:auto;">
       <div class="kdocs-img" style="padding-top:27.071823%;height:0;">
        <img src="https://img-blog.csdnimg.cn/img_convert/8e83de561007e3cab219a041b485b7ce.webp?x-oss-process=image/format,png" style="margin-left:;display:block;width:362px;margin-top:-27.071823%;height:auto;">
        </img>
       </div>
      </div>
     </div>
     <h5 style="text-align:left;">
      十一、uni-popup遮罩层组件下页面会滚动问题
     </h5>
     <p style="">
      当打开遮罩层时候，去滑动底层页面，底层页面会滚动。但是我们不想要这种效果，需要优化它。滚动问题示例：
     </p>
     <div class="kdocs-line-container" style="display:flex;">
      <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:288px;justify-content:center;align-items:center;height:auto;">
       <div class="kdocs-img" style="padding-top:206.59723%;height:0;">
        <img src="https://i-blog.csdnimg.cn/blog_migrate/ba900b5e50536d45b7960ddbc1ef8e69.gif" style="margin-left:;display:block;width:288px;margin-top:-206.59723%;height:auto;">
        </img>
       </div>
      </div>
     </div>
     <p style="">
      <span class="kdocs-bold" style="font-weight:bold;">
       解决办法
      </span>
      ✔
      <span class="kdocs-bold" style="font-weight:bold;">
       ：
      </span>
     </p>
     <p style="">
      需要给uni-popup加一层view，给他设置高度，
      <span class="kdocs-bold" style="font-weight:bold;">
       注意需要在弹窗打开时候设置高度（否则会导致底层的页面高度有问题）
      </span>
      ，并且再给它增加阻止冒泡事件：
     </p>
     <pre class="kdocs-plaintext"><code class="language-plaintext">&lt;view :style="{ height: showModal ? '100vh' : '' }"&gt;
     &lt;uni-popupref="popupRef"type="bottom"
      @touchmove.stop.prevent="moveHandle"
    &gt;&lt;viewclass="wrap_popup"&gt; 遮罩内容 &lt;/view&gt;&lt;/uni-popup&gt;
&lt;/view&gt;
      
&lt;script&gt;exportdefault {
  data() {
    return {
      showModal: false,
    };
  },
  methods: {
    openModal() {
      this.showModal = true; //弹窗打开前设置高度this.$refs.popupRef.open();
    },
    moveHandle() {
    
    }
  },
};
&lt;/script&gt;复制代码</code></pre>
     <p style="">
      <span class="kdocs-bold" style="font-weight:bold;">
       注意：需要在手机上查看验证效果，因为改完后小程序模拟器上验证一样会有问题。
      </span>
     </p>
     <h5 style="text-align:left;">
      十二、text-align:end 在真机上失效问题
     </h5>
     <p style="">
      想要输入框的文字靠右对齐，如果写text-align:end模拟器上是没有问题，但是真机上输入文字时候会跳到左边，见示例：
     </p>
     <div class="kdocs-line-container" style="display:flex;">
      <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:370px;justify-content:center;align-items:center;height:auto;">
       <div class="kdocs-img" style="padding-top:135.13513%;height:0;">
        <img src="https://img-blog.csdnimg.cn/img_convert/bcbbba1f7acebb69bca0aa40e2a8e3e0.webp?x-oss-process=image/format,png" style="margin-left:;display:block;width:370px;margin-top:-135.13513%;height:auto;"/>
       </div>
      </div>
     </div>
     <p style="">
      ❌错误写法，例如：
     </p>
     <pre class="kdocs-css"><code class="language-css">input {
    text-align:end 
}
复制代码</code></pre>
     <p style="">
      ✔正确写法：
     </p>
     <pre class="kdocs-css"><code class="language-css">input {
    text-align:right 
}
复制代码</code></pre>
     <p style="">
      这样就能一靠右显示，并且输入时候位置也在右边
     </p>
     <h5 style="text-align:left;">
      十二、输入框光标在真机无效（input输入框, type="text"类型）
     </h5>
     <p style="">
      场景：使用uni-easyinput组件，例如模拟器上设置光标颜色为蓝色可以生效：
     </p>
     <div class="kdocs-line-container" style="display:flex;">
      <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:510px;justify-content:center;align-items:center;height:auto;">
       <div class="kdocs-img" style="padding-top:11.764706%;height:0;">
        <img src="https://i-blog.csdnimg.cn/blog_migrate/7eb37273b7bcea77803a7fb4f789355b.png" style="margin-left:;display:block;width:510px;margin-top:-11.764706%;height:auto;"/>
       </div>
      </div>
     </div>
     <p style="">
      但在真机上type为text类型设置光标颜色会失效（目前还是无解）
     </p>
     <pre class="kdocs-plaintext"><code class="language-plaintext">    &lt;uni-easyinput type="text"/&gt;
    
    &lt;style&gt;
       // type类型为text最终解析出来的类型是inputinput {
        caret-color: #51b3ff; // 设置光标颜色
      }
    &lt;/style&gt;复制代码</code></pre>
     <p style="">
      如果类型为
      <span class="kdocs-bold" style="font-weight:bold;">
       textarea
      </span>
      真机和模拟器是都可以的。
     </p>
     <h5 style="text-align:left;">
      十三、Promise.allSettled()方法在部分IOS机型上无效
     </h5>
     <p style="">
      场景：使用Promise.allSettled并发请求接口，出现报错：Promise.allSettled is not a function
     </p>
     <pre class="kdocs-plaintext"><code class="language-plaintext">&lt;script&gt;
exportdefault {
  methods: {
    fetchTest() {
        Promise.allSettled([test1,test2,test3])
  },
};
&lt;/script&gt;

复制代码</code></pre>
     <p style="">
      出现兼容性问题机型：
     </p>
     <div class="kdocs-line-container" style="display:flex;">
      <div class="kdocs-img" style="flex-direction:column;max-width:100%;display:flex;width:229px;justify-content:center;align-items:center;height:auto;">
       <div class="kdocs-img" style="padding-top:91.70306%;height:0;">
        <img src="https://i-blog.csdnimg.cn/blog_migrate/6de689a2ec2fa73ea5d2ffb100affed5.png" style="margin-left:;display:block;width:229px;margin-top:-91.70306%;height:auto;"/>
       </div>
      </div>
     </div>
     <p style="">
      <span class="kdocs-bold" style="font-weight:bold;">
       解决办法
      </span>
      ✔
      <span class="kdocs-bold" style="font-weight:bold;">
       ：
      </span>
      使用Promise.all替代最快
     </p>
     <h5 style="text-align:left;">
      十四、uni.uploadFile上传文件接口报错fail方法不触发问题
     </h5>
     <p style="">
      <span class="kdocs-bold" style="font-weight:bold;">
       注意：
      </span>
      这个错误方法触发的时机是网络层出错才触发，而不是接口层面的出错触发
     </p>
     <pre class="kdocs-plaintext"><code class="language-plaintext">uni.uploadFile({
    url:'http://www.test.com',
    //...success(res) {
        // 接口报错404、500、502、503等都会走到这里（只要能访问到）
    },
    fail(err) {
      // 只有网络断开或者上传的url服务器挂了，也是就访问不到了才会走到这里
    }
})
复制代码</code></pre>
     <blockquote class="kdocs-blockquote" style="text-align:left;">
     </blockquote>
     <p style="">
     </p>
    </div>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34313232393538382f:61727469636c652f64657461696c732f313238393237363231" class_="artid" style="display:none">
 </p>
</div>


