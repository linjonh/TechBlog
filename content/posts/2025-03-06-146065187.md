---
arturl_encode: "68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34353531313638322f:61727469636c652f64657461696c732f313436303635313837"
layout: post
title: "å¦‚ä½•ç”¨HTML5-Canvaså®ç°ç”µå­ç­¾ååŠŸèƒ½"
date: 2025-03-06 14:50:37 +0800
description: "æœ¬æ–‡è¯¦ç»†è®²è§£åŸºäºHTML5 Canvaså®ç°ç”µå­ç­¾ååŠŸèƒ½ã€‚é€šè¿‡JavaScriptç›‘å¬é¼ æ ‡/è§¦æ‘¸äº‹ä»¶ï¼Œç»“åˆCanvasè·¯å¾„ç»˜åˆ¶èƒ½åŠ›ï¼Œå®Œæˆç­¾åè½¨è¿¹çš„å®æ—¶æ¸²æŸ“ã€‚ä»£ç å…¼å®¹PCä¸ç§»åŠ¨ç«¯ï¼Œæ— ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œæä¾›ç¬”è§¦æ ·å¼é…ç½®ã€é«˜æ¸…å±é€‚é… ç­‰åœºæ™¯æä¾›è½»é‡çº§å‰ç«¯è§£å†³æ–¹æ¡ˆã€‚"
keywords: "htmlæ•°å­—ç­¾å"
categories: ['å‰ç«¯', 'Javascript', '2025']
tags: ['å‰ç«¯', 'Javascript', 'Html', 'Html', 'Canva']
artid: "146065187"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146065187
    alt: "å¦‚ä½•ç”¨HTML5-Canvaså®ç°ç”µå­ç­¾ååŠŸèƒ½"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146065187
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146065187
cover: https://bing.ee123.net/img/rand?artid=146065187
image: https://bing.ee123.net/img/rand?artid=146065187
img: https://bing.ee123.net/img/rand?artid=146065187
---

# å¦‚ä½•ç”¨HTML5 Canvaså®ç°ç”µå­ç­¾ååŠŸèƒ½âœï¸

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/0d39c3a024a643c2a5bbef84b47b8b23.gif#pic_center)

> ğŸ¤– ä½œè€…ç®€ä»‹ï¼šæ°´ç…®ç™½èœç‹ï¼Œä¸€ä½å‰ç«¯åŠé€€å¸ˆ ğŸ‘»
>   
> ğŸ‘€ æ–‡ç« ä¸“æ ï¼š
> [å‰ç«¯ä¸“æ ](https://blog.csdn.net/weixin_45511682/category_12694415.html)
> ï¼Œè®°å½•ä¸€ä¸‹å¹³æ—¶åœ¨åšå®¢å†™ä½œä¸­ï¼Œæ€»ç»“å‡ºçš„ä¸€äº›å¼€å‘æŠ€å·§å’ŒçŸ¥è¯†å½’çº³æ€»ç»“âœã€‚
>   
> æ„Ÿè°¢æ”¯æŒğŸ’•ğŸ’•ğŸ’•

ğŸ–Œï¸ç”µå­ç­¾åä½œä¸ºæ•°å­—åŒ–è½¬å‹çš„é‡è¦ç¯èŠ‚ï¼Œåœ¨å‰ç«¯å¯é€šè¿‡HTML5 Canvasè½»æ¾å®ç°ã€‚æœ¬æ–‡å°†ä»¥HTML Deç¤ºä¾‹ğŸ¨ï¼Œæ‰‹æŠŠæ‰‹å¸¦æ‚¨å®Œæˆä¸€ä¸ªç”µå­ç­¾ååŠŸèƒ½ã€‚

## ä¸€ã€å®ç°åŸç†ä¸æ ¸å¿ƒæŠ€æœ¯

é€šè¿‡HTML5 Canvasçš„2Dç»˜å›¾ä¸Šä¸‹æ–‡å®ç°è½¨è¿¹æ•æ‰ï¼Œç»“åˆäº‹ä»¶ç›‘å¬å¤„ç†å®Œæˆæ ¸å¿ƒç»˜åˆ¶åŠŸèƒ½ã€‚å…³é”®æŠ€æœ¯ç‚¹åŒ…æ‹¬ï¼š

1. Canvasç»˜å›¾APIï¼šPathè·¯å¾„æ“ä½œ
2. äº‹ä»¶ç³»ç»Ÿï¼šé¼ æ ‡/è§¦æ‘¸äº‹ä»¶ç»Ÿä¸€å¤„ç†
3. æ–‡ä»¶å¯¼å‡ºï¼šCanvasè½¬Blobå¯¹è±¡

## äºŒã€æ ¸å¿ƒä»£ç å®ç°è§£æ

### 2.1 ç”»å¸ƒåˆå§‹åŒ–

è®¾ç½®600x300ç”»å¸ƒå¹¶è·å–2Dä¸Šä¸‹æ–‡ï¼Œå»ºè®®æ ¹æ®å±å¹•å°ºå¯¸åŠ¨æ€è°ƒæ•´ç”»å¸ƒå¤§å°ã€‚

```javascript
const canvas = document.querySelector('canvas');
canvas.width = 500;
canvas.height = 300;
const ctx = canvas.getContext('2d');

```

### 2.2 ç”»ç¬”æ ·å¼é…ç½®

é€šè¿‡lineCapå’ŒlineJoinå®ç°è‡ªç„¶çš„æ‰‹å†™æ•ˆæœã€‚

```javascript
ctx.lineWidth = 3;
ctx.strokeStyle = 'red';
ctx.lineCap = 'round'; // åœ†è§’çº¿å¤´
ctx.lineJoin = 'round'; // åœ†è§’è¿æ¥

```

### 2.3 è®¾å¤‡å…¼å®¹å¤„ç†

é€šè¿‡UAæ£€æµ‹è‡ªåŠ¨åˆ‡æ¢è§¦æ‘¸/é¼ æ ‡äº‹ä»¶ï¼Œå®é™…é¡¹ç›®ä¸­å»ºè®®ä½¿ç”¨pointer eventså®ç°æ›´ä¼˜é›…çš„å…¼å®¹ã€‚

```javascript
const mobileStatus = /Mobile|Android|iPhone/i.test(navigator.userAgent);

```

### 2.4 ç»˜åˆ¶é€»è¾‘å®ç°

#### èµ·ç¬”ç›‘å¬ï¼š

```javascript
function start(event) {
  const pos = mobileStatus ? event.changedTouches[0] : event;
  ctx.beginPath();
  ctx.moveTo(pos.pageX, pos.pageY);
  window.addEventListener(mobileStatus ? 'touchmove' : 'mousemove', draw);
}

```

#### ç§»åŠ¨ç»˜åˆ¶ï¼š

```javascript
function draw(event) {
  const pos = mobileStatus ? event.changedTouches[0] : event;
  ctx.lineTo(pos.pageX, pos.pageY);
  ctx.stroke(); // å®æ—¶æ¸²æŸ“è·¯å¾„
}

```

#### æ”¶ç¬”å¤„ç†ï¼š

```javascript
function closeDraw() {
  window.removeEventListener('mousemove', draw);
}

```

### 2.5 åŠŸèƒ½æŒ‰é’®å®ç°

#### æ¸…ç©ºç”»å¸ƒï¼š

```javascript
function cancel() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
}

```

#### ä¿å­˜ç­¾åï¼š

```javascript
function save() {
  canvas.toBlob(blob => {
    const a = document.createElement('a');
    a.download = `${Date.now()}.png`;
    a.href = URL.createObjectURL(blob);
    a.click();
  });
}

```

#### å¯åŠ æ’¤é”€åŠŸèƒ½ï¼š

```javascript
let history = [];
// ç»˜åˆ¶æ—¶ä¿å­˜çŠ¶æ€
history.push(ctx.getImageData(0,0,canvas.width,canvas.height));

function undo() {
  if(history.length > 1) {
    history.pop();
    ctx.putImageData(history[history.length-1], 0,0);
  }
}



```

## ä¸‰ã€æ³¨æ„äº‹é¡¹

1. æ€§èƒ½ä¼˜åŒ–ï¼šå¤§æ•°æ®é‡ç»˜åˆ¶å»ºè®®ä½¿ç”¨requestAnimationFrame
2. è·¨åŸŸé—®é¢˜ï¼šè‹¥æ¶‰åŠå›¾ç‰‡åˆæˆéœ€è®¾ç½®crossOrigin=â€œanonymousâ€
3. ç§»åŠ¨ç«¯é€‚é…ï¼šæ·»åŠ CSSæ ·å¼é˜²æ­¢è§¦æ‘¸æ»šåŠ¨

```html
canvas {
  touch-action: none;
  background: #f8f8f8;
}

```

## å››ã€å®Œæ•´ä»£ç ç¤ºä¾‹

```html
<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
        <style>
            * {
                margin: 0 auto;
                padding: 0;
            }
            button { 
                padding: 3px 5px;
                margin: 5px; 
            }
        </style>
    </head>
    <body>
        <canvas id="sign"></canvas>
        <div>
            <button onclick="cancel()">å–æ¶ˆ</button>
            <button onclick="save()">ä¿å­˜</button>
        </div>
    </body>
    <script>
        const canvas = document.querySelector('canvas');
        canvas.width = 600;
        canvas.height = 300;
        canvas.style.borderRadius = '5px';
        canvas.style.border = '1px solid #a6a9ad';
        const ctx = canvas.getContext('2d');

        // é«˜æ¸…å±é€‚é…
        const scale = window.devicePixelRatio;
        canvas.width = 600 * scale;
        canvas.height = 300 * scale;
        ctx.scale(scale, scale);

        ctx.lineWidth = 3; //çº¿å®½
        ctx.strokeStyle = 'black'; //çº¿é¢œè‰²
        ctx.lineCap = 'round'; //çº¿æ¡çš„ç»“æŸç«¯ç‚¹æ ·å¼
        ctx.lineJoin = 'round'; //ä¸¤æ¡çº¿ç›¸äº¤æ—¶ï¼Œæ‰€åˆ›å»ºçš„æ‹è§’ç±»å‹

		// æ£€æµ‹ç§»åŠ¨è®¾å¤‡
        const mobileStatus = /Mobile|Android|iPhone/i.test(navigator.userAgent);

        const start = (event) => {
            const { offsetX, offsetY, pageX, pageY } = mobileStatus
                ? event.changedTouches[0]
                : event;
            ctx.beginPath(); //èµ·å§‹ä¸€æ¡è·¯å¾„ï¼Œæˆ–é‡ç½®å½“å‰è·¯å¾„
            ctx.moveTo(pageX, pageY); //æŠŠè·¯å¾„ç§»åŠ¨åˆ°ç”»å¸ƒä¸­çš„æŒ‡å®šç‚¹ï¼Œä¸åˆ›å»ºçº¿æ¡
            window.addEventListener(mobileStatus ? 'touchmove' : 'mousemove', draw);
        };

        const draw = (event) => {
            const { pageX, pageY } = mobileStatus ? event.changedTouches[0] : event;
            ctx.lineTo(pageX, pageY); //æ·»åŠ ä¸€ä¸ªæ–°ç‚¹ï¼Œç„¶ååœ¨ç”»å¸ƒä¸­åˆ›å»ºä»è¯¥ç‚¹åˆ°æœ€åæŒ‡å®šç‚¹çš„çº¿æ¡
            ctx.stroke(); //ç»˜åˆ¶å·²å®šä¹‰çš„è·¯å¾„
        };
        const cloaseDraw = () => {
            window.removeEventListener('mousemove', draw);
        };

        window.addEventListener(mobileStatus ? 'touchstart' : 'mousedown', start);
        window.addEventListener(mobileStatus ? 'touchend' : 'mouseup', cloaseDraw);

        const cancel = () => {
            ctx.clearRect(0, 0, 600, 300); //åœ¨ç»™å®šçš„çŸ©å½¢å†…æ¸…é™¤æŒ‡å®šçš„åƒç´ 
        };

        const save = () => {
            canvas.toBlob((blob) => {
                const date = Date.now().toString();
                const a = document.createElement('a');
                a.download = `${date}.png`;
                a.href = URL.createObjectURL(blob);
                a.click();
                a.remove();
            });
        };
    </script>
</html>



```

å®é™…é¡¹ç›®ä¸­éœ€ç»“åˆåç«¯å®ç°ç­¾åéªŒè¯ã€æ·»åŠ æ—¶é—´æˆ³ç­‰æ‰©å±•åŠŸèƒ½ã€‚å¯ç»§ç»­ä¸°å¯Œä»£ç é€»è¾‘ï¼š

5. æ·»åŠ Base64å¯¼å‡ºåŠŸèƒ½
6. å®ç°ç¬”é”‹æ•ˆæœï¼ˆé€šè¿‡é€Ÿåº¦è®¡ç®—çº¿å®½ï¼‰
7. æ·»åŠ æœ¬åœ°å­˜å‚¨è‡ªåŠ¨ä¿å­˜

Canvasçš„ç»˜å›¾èƒ½åŠ›è¿˜èƒ½å»¶ä¼¸åº”ç”¨äºæ‰‹å†™ç¬”è®°ã€ç”µå­æ‰¹æ³¨ç­‰åœºæ™¯ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/dd89a0e5fb7e4127bfc8f5845cd5b1a8.gif#pic_center)
  
å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹èµ ğŸ‘ã€æ”¶è— ğŸ‘ å¹¶å…³æ³¨æˆ‘ï¼ğŸ‘€
  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/8c3262cc0cbb4faa8d255526766834ae.gif#pic_center)