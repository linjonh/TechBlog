---
layout: post
title: "python学习笔记三数据库篇"
date: 2024-12-07 17:23:19 +0800
description: "本文详细介绍了Python中的数据库编程，包括关系数据库的概念、连接数据库、同时深入"
keywords: "python 数据库"
categories: ['学习笔记', 'Python']
tags: ['笔记', '学习', 'Python']
artid: "131245252"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=131245252
    alt: "python学习笔记三数据库篇"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=131245252
featuredImagePreview: https://bing.ee123.net/img/rand?artid=131245252
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     python学习笔记(三)—数据库篇
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="_1">
     </a>
     一、数据库编程
    </h2>
    <p>
     数据库编程是指在应用程序中使用数据库管理系统（DBMS）进行数据存储、检索和处理的过程。数据库提供了一种结构化的方式来组织和存储数据，使得数据的管理更加高效和可靠。
    </p>
    <h3>
     <a id="11__5">
     </a>
     1.1 关系数据库
    </h3>
    <p>
     关系数据库是一种基于关系模型的数据库系统，使用表（表格）来存储和组织数据。每个表由多个行（记录）和列（字段）组成。关系数据库使用结构化查询语言（SQL）进行数据操作和查询。
    </p>
    <p>
     常见的关系数据库管理系统包括MySQL、PostgreSQL、Oracle和Microsoft SQL Server等。
    </p>
    <h3>
     <a id="12__11">
     </a>
     1.2 连接数据库
    </h3>
    <p>
     在进行数据库编程之前，首先需要建立与数据库的连接。连接数据库的过程包括指定数据库的位置、认证身份和建立连接对象。
    </p>
    <p>
     Python中可以使用第三方库（如
     <code>
      pymysql
     </code>
     、
     <code>
      psycopg2
     </code>
     等）提供的API来连接不同的数据库。
    </p>
    <p>
     下面是一个连接MySQL数据库的示例：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> pymysql

<span class="token comment"># 建立数据库连接</span>
connection <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>
    host<span class="token operator">=</span><span class="token string">'localhost'</span><span class="token punctuation">,</span>
    user<span class="token operator">=</span><span class="token string">'username'</span><span class="token punctuation">,</span>
    password<span class="token operator">=</span><span class="token string">'password'</span><span class="token punctuation">,</span>
    database<span class="token operator">=</span><span class="token string">'database_name'</span>
<span class="token punctuation">)</span>

<span class="token comment"># 使用连接对象进行数据库操作</span>
<span class="token comment"># ...</span>

<span class="token comment"># 关闭数据库连接</span>
connection<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre>
    <h3>
     <a id="13_SQL_38">
     </a>
     1.3 执行SQL语句
    </h3>
    <p>
     连接数据库后，可以使用SQL语句执行各种数据库操作，包括创建表、插入数据、查询数据、更新数据和删除数据等。
    </p>
    <p>
     执行SQL语句的过程包括创建游标对象、执行SQL语句并获取结果。
    </p>
    <p>
     下面是一个执行SQL查询语句的示例：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> pymysql

<span class="token comment"># 建立数据库连接</span>
connection <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>
    host<span class="token operator">=</span><span class="token string">'localhost'</span><span class="token punctuation">,</span>
    user<span class="token operator">=</span><span class="token string">'username'</span><span class="token punctuation">,</span>
    password<span class="token operator">=</span><span class="token string">'password'</span><span class="token punctuation">,</span>
    database<span class="token operator">=</span><span class="token string">'database_name'</span>
<span class="token punctuation">)</span>

<span class="token comment"># 创建游标对象</span>
cursor <span class="token operator">=</span> connection<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 执行SQL查询语句</span>
sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM users"</span>
cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>

<span class="token comment"># 获取查询结果</span>
results <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 处理查询结果</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> results<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>

<span class="token comment"># 关闭游标对象和数据库连接</span>
cursor<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
connection<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre>
    <h3>
     <a id="14__77">
     </a>
     1.4 数据库操作示例
    </h3>
    <p>
     下面是一些数据库操作的示例，包括插入数据、查询数据、更新数据和删除数据等常见操作：
    </p>
    <h4>
     <a id="_81">
     </a>
     插入数据
    </h4>
    <pre><code class="prism language-python"><span class="token keyword">import</span> pymysql

<span class="token comment"># 建立数据库连接</span>
connection <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>
    host<span class="token operator">=</span><span class="token string">'localhost'</span><span class="token punctuation">,</span>
    user<span class="token operator">=</span><span class="token string">'username'</span><span class="token punctuation">,</span>
    password<span class="token operator">=</span><span class="token string">'password'</span><span class="token punctuation">,</span>
    database<span class="token operator">=</span><span class="token string">'database_name'</span>
<span class="token punctuation">)</span>

<span class="token comment"># 创建游标对象</span>
cursor <span class="token operator">=</span> connection<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 插入数据</span>
sql <span class="token operator">=</span> <span class="token string">"INSERT INTO users (name, email) VALUES ('John Doe', 'john@example.com')"</span>
cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>

<span class="token comment"># 提交事务</span>
connection<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 关闭游标对象和数据库连接</span>
cursor<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
connection<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre>
    <h4>
     <a id="_110">
     </a>
     查询数据
    </h4>
    <pre><code class="prism language-python"><span class="token keyword">import</span> pymysql

<span class="token comment"># 建立数据库连接</span>
connection <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>
    host<span class="token operator">=</span><span class="token string">'localhost'</span><span class="token punctuation">,</span>
    user<span class="token operator">=</span><span class="token string">'username'</span><span class="token punctuation">,</span>
    password<span class="token operator">=</span><span class="token string">'password'</span><span class="token punctuation">,</span>
    database<span class="token operator">=</span><span class="token string">'database_name'</span>
<span class="token punctuation">)</span>

<span class="token comment"># 创建游标对象</span>
cursor <span class="token operator">=</span>

 connection<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 执行查询语句</span>
sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM users"</span>
cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>

<span class="token comment"># 获取查询结果</span>
results <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 处理查询结果</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> results<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>

<span class="token comment"># 关闭游标对象和数据库连接</span>
cursor<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
connection<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre>
    <p>
     当进行多表联查时，可以使用SQL的JOIN操作来连接多个表并检索相关数据。下面是一个多表联查的示例：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> pymysql

<span class="token comment"># 建立数据库连接</span>
connection <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>
    host<span class="token operator">=</span><span class="token string">'localhost'</span><span class="token punctuation">,</span>
    user<span class="token operator">=</span><span class="token string">'username'</span><span class="token punctuation">,</span>
    password<span class="token operator">=</span><span class="token string">'password'</span><span class="token punctuation">,</span>
    database<span class="token operator">=</span><span class="token string">'database_name'</span>
<span class="token punctuation">)</span>

<span class="token comment"># 创建游标对象</span>
cursor <span class="token operator">=</span> connection<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 执行多表联查查询语句</span>
sql <span class="token operator">=</span> <span class="token triple-quoted-string string">"""
SELECT orders.order_id, customers.customer_name, products.product_name
FROM orders
JOIN customers ON orders.customer_id = customers.customer_id
JOIN products ON orders.product_id = products.product_id
"""</span>
cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>

<span class="token comment"># 获取查询结果</span>
results <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 处理查询结果</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> results<span class="token punctuation">:</span>
    order_id<span class="token punctuation">,</span> customer_name<span class="token punctuation">,</span> product_name <span class="token operator">=</span> row
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Order ID: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>order_id<span class="token punctuation">}</span></span><span class="token string">, Customer: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>customer_name<span class="token punctuation">}</span></span><span class="token string">, Product: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>product_name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># 关闭游标对象和数据库连接</span>
cursor<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
connection<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre>
    <p>
     在上述示例中，通过使用JOIN操作，将
     <code>
      orders
     </code>
     表与
     <code>
      customers
     </code>
     表和
     <code>
      products
     </code>
     表联结，检索订单的相关信息，包括订单ID、顾客名称和产品名称。
    </p>
    <p>
     对于根据条件筛选数据的情况，可以使用SQL的WHERE子句来指定筛选条件。下面是一个根据条件筛选数据的示例：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> pymysql

<span class="token comment"># 建立数据库连接</span>
connection <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>
    host<span class="token operator">=</span><span class="token string">'localhost'</span><span class="token punctuation">,</span>
    user<span class="token operator">=</span><span class="token string">'username'</span><span class="token punctuation">,</span>
    password<span class="token operator">=</span><span class="token string">'password'</span><span class="token punctuation">,</span>
    database<span class="token operator">=</span><span class="token string">'database_name'</span>
<span class="token punctuation">)</span>

<span class="token comment"># 创建游标对象</span>
cursor <span class="token operator">=</span> connection<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 执行带有条件的查询语句</span>
product_name <span class="token operator">=</span> <span class="token string">'Apple'</span>
min_price <span class="token operator">=</span> <span class="token number">10</span>
sql <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"""
SELECT product_id, product_name, price
FROM products
WHERE product_name = '</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>product_name<span class="token punctuation">}</span></span><span class="token string">' AND price &gt;= </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>min_price<span class="token punctuation">}</span></span><span class="token string">
"""</span></span>
cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>

<span class="token comment"># 获取查询结果</span>
results <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 处理查询结果</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> results<span class="token punctuation">:</span>
    product_id<span class="token punctuation">,</span> product_name<span class="token punctuation">,</span> price <span class="token operator">=</span> row
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Product ID: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>product_id<span class="token punctuation">}</span></span><span class="token string">, Product Name: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>product_name<span class="token punctuation">}</span></span><span class="token string">, Price: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>price<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># 关闭游标对象和数据库连接</span>
cursor<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
connection<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre>
    <p>
     在上述示例中，通过在SQL查询语句中使用WHERE子句，根据产品名称和最低价格进行筛选，检索符合条件的产品信息。
    </p>
    <p>
     希望以上示例能帮助你理解多表联查和条件筛选的数据库操作。如有需要，请根据你的实际情况修改示例中的数据库连接信息和表名、字段名以适应你的数据库结构。
    </p>
    <h4>
     <a id="_230">
     </a>
     更新数据
    </h4>
    <pre><code class="prism language-python"><span class="token keyword">import</span> pymysql

<span class="token comment"># 建立数据库连接</span>
connection <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>
    host<span class="token operator">=</span><span class="token string">'localhost'</span><span class="token punctuation">,</span>
    user<span class="token operator">=</span><span class="token string">'username'</span><span class="token punctuation">,</span>
    password<span class="token operator">=</span><span class="token string">'password'</span><span class="token punctuation">,</span>
    database<span class="token operator">=</span><span class="token string">'database_name'</span>
<span class="token punctuation">)</span>

<span class="token comment"># 创建游标对象</span>
cursor <span class="token operator">=</span> connection<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 更新数据</span>
sql <span class="token operator">=</span> <span class="token string">"UPDATE users SET email = 'new_email@example.com' WHERE id = 1"</span>
cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>

<span class="token comment"># 提交事务</span>
connection<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 关闭游标对象和数据库连接</span>
cursor<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
connection<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre>
    <h4>
     <a id="_259">
     </a>
     删除数据
    </h4>
    <pre><code class="prism language-python"><span class="token keyword">import</span> pymysql

<span class="token comment"># 建立数据库连接</span>
connection <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>
    host<span class="token operator">=</span><span class="token string">'localhost'</span><span class="token punctuation">,</span>
    user<span class="token operator">=</span><span class="token string">'username'</span><span class="token punctuation">,</span>
    password<span class="token operator">=</span><span class="token string">'password'</span><span class="token punctuation">,</span>
    database<span class="token operator">=</span><span class="token string">'database_name'</span>
<span class="token punctuation">)</span>

<span class="token comment"># 创建游标对象</span>
cursor <span class="token operator">=</span> connection<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 删除数据</span>
sql <span class="token operator">=</span> <span class="token string">"DELETE FROM users WHERE id = 1"</span>
cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>

<span class="token comment"># 提交事务</span>
connection<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 关闭游标对象和数据库连接</span>
cursor<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
connection<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre>
    <p>
     以上是关于数据库编程的基本概念和示例。通过掌握数据库编程，您可以使用数据库进行数据管理和操作，实现灵活的数据存储和检索功能。
    </p>
    <h2>
     <a id="ORM_290">
     </a>
     二、ORM框架
    </h2>
    <p>
     ORM（对象关系映射）框架是一种将数据库表和对象模型映射起来的技术，使得开发者可以通过操作对象来实现对数据库的操作，而不需要直接编写SQL语句。ORM框架提供了一种更加面向对象的方式来进行数据库编程。
    </p>
    <p>
     在Python中，常见的ORM框架包括SQLAlchemy、Django ORM和Peewee等。
    </p>
    <h3>
     <a id="21_ORM_296">
     </a>
     2.1 使用ORM框架
    </h3>
    <p>
     使用ORM框架进行数据库编程的步骤通常包括以下几个方面：
    </p>
    <ol>
     <li>
      定义模型：通过定义模型类来映射数据库表结构，每个模型类对应数据库中的一张表。
     </li>
     <li>
      建立连接：连接数据库，配置数据库连接参数。
     </li>
     <li>
      执行操作：通过调用模型类的方法来执行数据库操作，如插入数据、查询数据、更新数据和删除数据等。
     </li>
    </ol>
    <p>
     下面是一个使用SQLAlchemy进行数据库操作的示例：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">from</span> sqlalchemy <span class="token keyword">import</span> create_engine<span class="token punctuation">,</span> Column<span class="token punctuation">,</span> Integer<span class="token punctuation">,</span> String
<span class="token keyword">from</span> sqlalchemy<span class="token punctuation">.</span>orm <span class="token keyword">import</span> sessionmaker
<span class="token keyword">from</span> sqlalchemy<span class="token punctuation">.</span>ext<span class="token punctuation">.</span>declarative <span class="token keyword">import</span> declarative_base

<span class="token comment"># 创建引擎和会话</span>
engine <span class="token operator">=</span> create_engine<span class="token punctuation">(</span><span class="token string">'mysql+pymysql://username:password@localhost/database_name'</span><span class="token punctuation">)</span>
Session <span class="token operator">=</span> sessionmaker<span class="token punctuation">(</span>bind<span class="token operator">=</span>engine<span class="token punctuation">)</span>
session <span class="token operator">=</span> Session<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 声明基类</span>
Base <span class="token operator">=</span> declarative_base<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 定义模型</span>
<span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">(</span>Base<span class="token punctuation">)</span><span class="token punctuation">:</span>
    __tablename__ <span class="token operator">=</span> <span class="token string">'users'</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> Column<span class="token punctuation">(</span>Integer<span class="token punctuation">,</span> primary_key<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    name <span class="token operator">=</span> Column<span class="token punctuation">(</span>String<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    email <span class="token operator">=</span> Column<span class="token punctuation">(</span>String<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 插入数据</span>
user <span class="token operator">=</span> User<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'John Doe'</span><span class="token punctuation">,</span> email<span class="token operator">=</span><span class="token string">'john@example.com'</span><span class="token punctuation">)</span>
session<span class="token punctuation">.</span>add<span class="token punctuation">(</span>user<span class="token punctuation">)</span>
session<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 查询数据</span>
users <span class="token operator">=</span> session<span class="token punctuation">.</span>query<span class="token punctuation">(</span>User<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> user <span class="token keyword">in</span> users<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>name<span class="token punctuation">,</span> user<span class="token punctuation">.</span>email<span class="token punctuation">)</span>

<span class="token comment"># 更新数据</span>
user <span class="token operator">=</span> session<span class="token punctuation">.</span>query<span class="token punctuation">(</span>User<span class="token punctuation">)</span><span class="token punctuation">.</span>filter_by<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>
user<span class="token punctuation">.</span>email <span class="token operator">=</span> <span class="token string">'new_email@example.com'</span>
session<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 删除数据</span>
user <span class="token operator">=</span> session<span class="token punctuation">.</span>query<span class="token punctuation">(</span>User<span class="token punctuation">)</span><span class="token punctuation">.</span>filter_by<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>
session<span class="token punctuation">.</span>delete<span class="token punctuation">(</span>user<span class="token punctuation">)</span>
session<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 关闭会话</span>
session<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre>
    <h3>
     <a id="22__351">
     </a>
     2.2 批量查询
    </h3>
    <p>
     使用ORM框架进行多表联查和条件筛选时，可以利用框架提供的查询接口和方法来构建复杂的查询语句。下面以SQLAlchemy为例，展示如何使用ORM框架进行多表联查和条件筛选的示例：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">from</span> sqlalchemy <span class="token keyword">import</span> create_engine<span class="token punctuation">,</span> Column<span class="token punctuation">,</span> Integer<span class="token punctuation">,</span> String<span class="token punctuation">,</span> ForeignKey
<span class="token keyword">from</span> sqlalchemy<span class="token punctuation">.</span>orm <span class="token keyword">import</span> sessionmaker<span class="token punctuation">,</span> relationship
<span class="token keyword">from</span> sqlalchemy<span class="token punctuation">.</span>ext<span class="token punctuation">.</span>declarative <span class="token keyword">import</span> declarative_base

<span class="token comment"># 创建引擎和会话</span>
engine <span class="token operator">=</span> create_engine<span class="token punctuation">(</span><span class="token string">'mysql+pymysql://username:password@localhost/database_name'</span><span class="token punctuation">)</span>
Session <span class="token operator">=</span> sessionmaker<span class="token punctuation">(</span>bind<span class="token operator">=</span>engine<span class="token punctuation">)</span>
session <span class="token operator">=</span> Session<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 声明基类</span>
Base <span class="token operator">=</span> declarative_base<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 定义模型</span>
<span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">(</span>Base<span class="token punctuation">)</span><span class="token punctuation">:</span>
    __tablename__ <span class="token operator">=</span> <span class="token string">'users'</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> Column<span class="token punctuation">(</span>Integer<span class="token punctuation">,</span> primary_key<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>                          <span class="token comment"># 用户ID字段，主键</span>
    name <span class="token operator">=</span> Column<span class="token punctuation">(</span>String<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                                       <span class="token comment"># 用户名字段</span>
    email <span class="token operator">=</span> Column<span class="token punctuation">(</span>String<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                                      <span class="token comment"># 邮箱字段</span>

<span class="token keyword">class</span> <span class="token class-name">Order</span><span class="token punctuation">(</span>Base<span class="token punctuation">)</span><span class="token punctuation">:</span>
    __tablename__ <span class="token operator">=</span> <span class="token string">'orders'</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> Column<span class="token punctuation">(</span>Integer<span class="token punctuation">,</span> primary_key<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>                          <span class="token comment"># 订单ID字段，主键</span>
    user_id <span class="token operator">=</span> Column<span class="token punctuation">(</span>Integer<span class="token punctuation">,</span> ForeignKey<span class="token punctuation">(</span><span class="token string">'users.id'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>               <span class="token comment"># 外键，关联到users表的id字段</span>
    product_id <span class="token operator">=</span> Column<span class="token punctuation">(</span>Integer<span class="token punctuation">,</span> ForeignKey<span class="token punctuation">(</span><span class="token string">'products.id'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>         <span class="token comment"># 外键，关联到products表的id字段</span>
    user <span class="token operator">=</span> relationship<span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> backref<span class="token operator">=</span><span class="token string">'orders'</span><span class="token punctuation">)</span>                   <span class="token comment"># 定义与User模型的关联关系，backref定义反向引用，可以通过User模型的orders属性获取关联的订单</span>
    product <span class="token operator">=</span> relationship<span class="token punctuation">(</span><span class="token string">'Product'</span><span class="token punctuation">,</span> backref<span class="token operator">=</span><span class="token string">'orders'</span><span class="token punctuation">)</span>             <span class="token comment"># 定义与Product模型的关联关系，backref定义反向引用，可以通过Product模型的orders属性获取关联的订单</span>

<span class="token keyword">class</span> <span class="token class-name">Product</span><span class="token punctuation">(</span>Base<span class="token punctuation">)</span><span class="token punctuation">:</span>
    __tablename__ <span class="token operator">=</span> <span class="token string">'products'</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> Column<span class="token punctuation">(</span>Integer<span class="token punctuation">,</span> primary_key<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>                          <span class="token comment"># 产品ID字段，主键</span>
    name <span class="token operator">=</span> Column<span class="token punctuation">(</span>String<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                                       <span class="token comment"># 产品名称字段</span>
    price <span class="token operator">=</span> Column<span class="token punctuation">(</span>Integer<span class="token punctuation">)</span>                                         <span class="token comment"># 产品价格字段</span>

<span class="token comment"># 多表联查示例</span>
orders <span class="token operator">=</span> session<span class="token punctuation">.</span>query<span class="token punctuation">(</span>Order<span class="token punctuation">)</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>User<span class="token punctuation">)</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>Product<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> order <span class="token keyword">in</span> orders<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Order ID: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>order<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">, Customer: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>order<span class="token punctuation">.</span>user<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string">, Product: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>order<span class="token punctuation">.</span>product<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># 条件筛选示例</span>
product_name <span class="token operator">=</span> <span class="token string">'Apple'</span>
min_price <span class="token operator">=</span> <span class="token number">10</span>
products <span class="token operator">=</span> session<span class="token punctuation">.</span>query<span class="token punctuation">(</span>Product<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>Product<span class="token punctuation">.</span>name <span class="token operator">==</span> product_name<span class="token punctuation">,</span> Product<span class="token punctuation">.</span>price <span class="token operator">&gt;=</span> min_price<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> product <span class="token keyword">in</span> products<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Product ID: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>product<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">}</span></span><span class="token string">, Product Name: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>product<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string">, Price: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>product<span class="token punctuation">.</span>price<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># 关闭会话</span>
session<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     在上述示例中，首先定义了三个模型类：
     <code>
      User
     </code>
     、
     <code>
      Order
     </code>
     和
     <code>
      Product
     </code>
     ，分别对应数据库中的三个表。
     <code>
      Order
     </code>
     表与
     <code>
      User
     </code>
     表和
     <code>
      Product
     </code>
     表通过外键关联，定义了对应的关系。
    </p>
    <p>
     对于多表联查，可以通过使用
     <code>
      join
     </code>
     方法来连接多个表，并通过点操作符访问关联的字段，例如
     <code>
      order.user.name
     </code>
     和
     <code>
      order.product.name
     </code>
     。
    </p>
    <p>
     对于条件筛选，可以使用
     <code>
      filter
     </code>
     方法来指定筛选条件，例如
     <code>
      Product.name == product_name
     </code>
     表示产品名称等于指定的值，
     <code>
      Product.price &gt;= min_price
     </code>
     表示产品价格大于等于指定的最低价格。
    </p>
    <p>
     通过使用ORM框架，可以更加方便地进行多表联查和条件筛选操作，而无需直接编写复杂的SQL语句。
    </p>
    <p>
     请根据你的实际情况修改示例中的数据库连接信息和表名、字段名以适应你的数据库结构。另外，使用其他ORM框架如Django ORM和Peewee也可以类似地进行多表联查和条件筛选操作，只是具体的语法和方法会有所不同。
    </p>
    <p>
     以下是对添加的注释的解释：
    </p>
    <ul>
     <li>
      <strong>
       <code>
        ForeignKey
       </code>
      </strong>
      : 用于定义外键关联，指定关联到其他表的字段。在示例中，**
      <code>
       user_id
      </code>
      <strong>
       字段和
      </strong>
      <code>
       product_id
      </code>
      <strong>
       字段分别是对
      </strong>
      <code>
       users
      </code>
      <strong>
       表和
      </strong>
      <code>
       products
      </code>
      **表的外键关联。
     </li>
     <li>
      <strong>
       <code>
        backref
       </code>
      </strong>
      : 在关系的另一侧创建反向引用。在示例中，**
      <code>
       user
      </code>
      <strong>
       和
      </strong>
      <code>
       product
      </code>
      <strong>
       分别是
      </strong>
      <code>
       Order
      </code>
      <strong>
       模型与
      </strong>
      <code>
       User
      </code>
      <strong>
       模型和
      </strong>
      <code>
       Product
      </code>
      <strong>
       模型之间的关系。通过
      </strong>
      <code>
       backref
      </code>
      <strong>
       参数定义反向引用，可以通过
      </strong>
      <code>
       User
      </code>
      <strong>
       模型的
      </strong>
      <code>
       orders
      </code>
      <strong>
       属性获取关联的订单，同样地，通过
      </strong>
      <code>
       Product
      </code>
      <strong>
       模型的
      </strong>
      <code>
       orders
      </code>
      **属性也可以获取关联的订单。
     </li>
     <li>
      <strong>
       <code>
        relationship
       </code>
      </strong>
      : 用于定义模型之间的关系。在示例中，**
      <code>
       Order
      </code>
      <strong>
       模型与
      </strong>
      <code>
       User
      </code>
      <strong>
       模型和
      </strong>
      <code>
       Product
      </code>
      <strong>
       模型之间的关系通过
      </strong>
      <code>
       relationship
      </code>
      <strong>
       定义。
      </strong>
      <code>
       relationship
      </code>
      **指定了两个模型之间的关联关系，可以通过该关系进行联查操作。
     </li>
     <li>
      <strong>
       <code>
        Column
       </code>
      </strong>
      : 用于定义模型类中的字段。在示例中，
      <strong>
       <code>
        id
       </code>
      </strong>
      、
      <strong>
       <code>
        name
       </code>
      </strong>
      、
      <strong>
       <code>
        email
       </code>
      </strong>
      、
      <strong>
       <code>
        user_id
       </code>
      </strong>
      、
      <strong>
       <code>
        product_id
       </code>
      </strong>
      、**
      <code>
       price
      </code>
      <strong>
       等字段都是通过
      </strong>
      <code>
       Column
      </code>
      <strong>
       定义的。
      </strong>
      <code>
       Column
      </code>
      **指定了字段的数据类型和约束条件。
     </li>
    </ul>
    <p>
     除了单条记录的插入、修改和删除操作，ORM框架通常也提供了批量处理多条记录的功能，以提高效率和性能。在某些场景下，批量操作比逐条操作更有效，特别是当需要处理大量数据时。
    </p>
    <p>
     下面是使用ORM框架进行批量插入、修改和删除的示例代码（以SQLAlchemy为例）：
    </p>
    <h3>
     <a id="23__426">
     </a>
     2.3 批量插入
    </h3>
    <pre><code class="prism language-python"><span class="token keyword">from</span> sqlalchemy<span class="token punctuation">.</span>orm <span class="token keyword">import</span> sessionmaker
<span class="token keyword">from</span> models <span class="token keyword">import</span> User  <span class="token comment"># 导入数据模型类</span>

<span class="token comment"># 创建Session</span>
Session <span class="token operator">=</span> sessionmaker<span class="token punctuation">(</span>bind<span class="token operator">=</span>engine<span class="token punctuation">)</span>
session <span class="token operator">=</span> Session<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 创建多个User对象</span>
users <span class="token operator">=</span> <span class="token punctuation">[</span>
    User<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'Alice'</span><span class="token punctuation">,</span> age<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    User<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'Bob'</span><span class="token punctuation">,</span> age<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    User<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'Charlie'</span><span class="token punctuation">,</span> age<span class="token operator">=</span><span class="token number">35</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>

<span class="token comment"># 批量插入</span>
session<span class="token punctuation">.</span>bulk_save_objects<span class="token punctuation">(</span>users<span class="token punctuation">)</span>

<span class="token comment"># 提交事务</span>
session<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 关闭Session</span>
session<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre>
    <h3>
     <a id="24__454">
     </a>
     2.4 批量修改
    </h3>
    <pre><code class="prism language-python"><span class="token keyword">from</span> sqlalchemy<span class="token punctuation">.</span>orm <span class="token keyword">import</span> sessionmaker
<span class="token keyword">from</span> models <span class="token keyword">import</span> User  <span class="token comment"># 导入数据模型类</span>

<span class="token comment"># 创建Session</span>
Session <span class="token operator">=</span> sessionmaker<span class="token punctuation">(</span>bind<span class="token operator">=</span>engine<span class="token punctuation">)</span>
session <span class="token operator">=</span> Session<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 查询需要修改的记录</span>
users <span class="token operator">=</span> session<span class="token punctuation">.</span>query<span class="token punctuation">(</span>User<span class="token punctuation">)</span><span class="token punctuation">.</span>filter_by<span class="token punctuation">(</span>age<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 批量修改</span>
<span class="token keyword">for</span> user <span class="token keyword">in</span> users<span class="token punctuation">:</span>
    user<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">31</span>

<span class="token comment"># 提交事务</span>
session<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 关闭Session</span>
session<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre>
    <h3>
     <a id="25__479">
     </a>
     2.5 批量删除
    </h3>
    <pre><code class="prism language-python"><span class="token keyword">from</span> sqlalchemy<span class="token punctuation">.</span>orm <span class="token keyword">import</span> sessionmaker
<span class="token keyword">from</span> models <span class="token keyword">import</span> User  <span class="token comment"># 导入数据模型类</span>

<span class="token comment"># 创建Session</span>
Session <span class="token operator">=</span> sessionmaker<span class="token punctuation">(</span>bind<span class="token operator">=</span>engine<span class="token punctuation">)</span>
session <span class="token operator">=</span> Session<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 查询需要删除的记录</span>
users <span class="token operator">=</span> session<span class="token punctuation">.</span>query<span class="token punctuation">(</span>User<span class="token punctuation">)</span><span class="token punctuation">.</span>filter_by<span class="token punctuation">(</span>age<span class="token operator">=</span><span class="token number">35</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 批量删除</span>
session<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token operator">*</span>users<span class="token punctuation">)</span>

<span class="token comment"># 提交事务</span>
session<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 关闭Session</span>
session<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre>
    <p>
     以上示例代码展示了使用ORM框架进行批量插入、修改和删除的操作。通过批量处理多条记录，可以显著提高数据库操作的效率和性能。
    </p>
    <h4>
     <a id="_505">
     </a>
     注意事项
    </h4>
    <p>
     在进行批量操作时，需要注意以下几点：
    </p>
    <ol>
     <li>
      批量插入和修改需要使用
      <code>
       session.bulk_save_objects()
      </code>
      或
      <code>
       session.bulk_update_mappings()
      </code>
      方法，而不是逐条操作或使用
      <code>
       session.add()
      </code>
      方法。
     </li>
     <li>
      批量删除需要使用
      <code>
       session.delete()
      </code>
      方法，并传入要删除的记录列表。
     </li>
     <li>
      批量操作完成后，记得提交事务并关闭Session，以确保操作的完成和数据库的一致性。
     </li>
    </ol>
    <p>
     请根据具体需求和场景，合理选择批量操作，以提高数据库编程的效率和性能。
    </p>
    <p>
     希望以上内容能帮助你更好地理解和应用ORM框架的批量操作功能！
    </p>
    <h3>
     <a id="26__517">
     </a>
     2.6 异常处理
    </h3>
    <p>
     在ORM框架中，异常处理是保证程序稳定性和可靠性的关键。ORM框架通常会提供特定的异常类来处理数据库操作可能抛出的异常，如连接异常、查询异常、保存异常等。通过捕获和处理这些异常，我们可以实现对错误情况的有效处理和错误信息的反馈。
    </p>
    <p>
     下面是使用ORM框架进行异常处理的示例代码（以SQLAlchemy为例）：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">from</span> sqlalchemy<span class="token punctuation">.</span>exc <span class="token keyword">import</span> SQLAlchemyError

<span class="token keyword">try</span><span class="token punctuation">:</span>
    <span class="token comment"># 执行数据库操作</span>
<span class="token keyword">except</span> SQLAlchemyError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
    <span class="token comment"># 处理数据库操作异常</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"数据库操作发生异常:"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>

</code></pre>
    <h3>
     <a id="27__534">
     </a>
     2.7 连接池管理
    </h3>
    <p>
     ORM框架通常会提供连接池管理的功能，用于管理数据库连接的创建和回收。通过连接池，可以有效地重复使用连接，减少连接的开销，提高程序性能。ORM框架会负责维护连接池，并在需要时分配连接给数据库操作。
    </p>
    <p>
     下面是使用ORM框架连接池的示例代码（以SQLAlchemy为例）：
    </p>
    <pre><code>from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker

# 创建数据库连接引擎
engine = create_engine('mysql://user:password@localhost/mydatabase')

# 创建Session工厂
Session = sessionmaker(bind=engine)

# 从工厂获取Session对象
session = Session()

# 使用Session对象进行数据库操作
# ...

# 关闭Session
session.close()

</code></pre>
    <h3>
     <a id="28_SQL_561">
     </a>
     2.8 SQL注入防范
    </h3>
    <p>
     ORM框架通常会提供参数化查询（Prepared Statements）或绑定参数的功能来防范SQL注入攻击。通过将参数绑定到SQL语句中，ORM框架会自动处理参数值的转义和引号的添加，确保输入数据的安全性。
    </p>
    <p>
     下面是使用ORM框架进行参数化查询的示例代码（以SQLAlchemy为例）：
    </p>
    <pre><code>from sqlalchemy import text

# 定义带参数的SQL语句
sql = text("SELECT * FROM users WHERE username = :username AND password = :password")

# 执行查询操作，并传入参数值
result = session.execute(sql, {"username": username, "password": password})

</code></pre>
    <h3>
     <a id="29__578">
     </a>
     2.9 数据库事务处理
    </h3>
    <p>
     ORM框架通常会提供事务管理的功能，用于确保数据库操作的原子性和一致性。通过开启事务、提交事务或回滚事务，可以保证多个操作的操作结果要么全部生效，要么全部取消。
    </p>
    <p>
     下面是使用ORM框架进行事务处理的示例代码（以SQLAlchemy为例）：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">from</span> sqlalchemy<span class="token punctuation">.</span>exc <span class="token keyword">import</span> SQLAlchemyError

<span class="token keyword">try</span><span class="token punctuation">:</span>
    <span class="token comment"># 开启事务</span>
    session<span class="token punctuation">.</span>begin<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 执行数据库操作</span>
    <span class="token comment"># ...</span>

    <span class="token comment"># 提交事务</span>
    session<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">except</span> SQLAlchemyError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
    <span class="token comment"># 回滚事务</span>
    session<span class="token punctuation">.</span>rollback<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"数据库操作发生异常:"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>
<span class="token keyword">finally</span><span class="token punctuation">:</span>
    <span class="token comment"># 关闭Session</span>
    session<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre>
    <p>
     以上是关于异常处理、连接池管理、SQL注入防范和数据库事务处理的示例代码，这些技术可以在实际应用中提高数据库编程的稳定性、性能和安全性。
    </p>
    <h4>
     <a id="_608">
     </a>
    </h4>
    <p>
     通过使用ORM框架，可以简化数据库操作的过程，提高开发效率，并且使得代码更加可读和易于
    </p>
    <p>
     维护。
    </p>
   </div>
   <link href="./../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="./../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a:2f2f626c6f672e6373646e2e6e65742f6d616a69653633392f:61727469636c652f64657461696c732f313331323435323532" class_="artid" style="display:none">
 </p>
</div>


