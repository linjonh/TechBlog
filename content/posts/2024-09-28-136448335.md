---
layout: post
title: ffmpegéŸ³è§†é¢‘å·¥å…·éŸ³è§†é¢‘åˆå¹¶
date: 2024-09-28 08:00:42 +08:00
categories: ['éŸ³è§†é¢‘']
tags: ['éŸ³è§†é¢‘', 'Ffmpeg']
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=136448335
    alt: ffmpegéŸ³è§†é¢‘å·¥å…·éŸ³è§†é¢‘åˆå¹¶
artid: 136448335
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=136448335
featuredImagePreview: https://bing.ee123.net/img/rand?artid=136448335
---

# ffmpeg@éŸ³è§†é¢‘å·¥å…·@éŸ³è§†é¢‘åˆå¹¶

#### æ–‡ç« ç›®å½•

* + [ffmpeg](#ffmpeg_2)
  + - [ç‰¹ç‚¹](#_18)
    - [ä¸‹è½½](#_23)
  + [ä½¿ç”¨](#_48)
  + - [å°†è§†é¢‘å’ŒéŸ³é¢‘åˆå¹¶](#_55)

### ffmpeg

* [FFmpegä¸­æ–‡ç½‘ (github.net.cn)](https://ffmpeg.github.net.cn/)
* [FFmpeg](https://ffmpeg.org/documentation.html)
  æ˜¯ä¸€æ¬¾å¼ºå¤§çš„å¼€æºè·¨å¹³å°éŸ³è§†é¢‘å¤„ç†å·¥å…·é›†ï¼Œå®ƒåŒ…å«äº†ä¸€ç³»åˆ—å‘½ä»¤è¡Œå·¥å…·ä»¥åŠç”¨äºŽéŸ³é¢‘å’Œè§†é¢‘ç¼–ç è§£ç ã€æ ¼å¼è½¬æ¢ã€æŠ“å–ã€æµåŒ–ç­‰åŠŸèƒ½çš„åº“ã€‚FFmpeg æ”¯æŒå¤šç§è§†é¢‘ã€éŸ³é¢‘æ ¼å¼å’Œç¼–è§£ç å™¨ï¼Œèƒ½å¤Ÿè¿›è¡ŒéŸ³è§†é¢‘çš„åŽ‹ç¼©ã€å°è£…ã€è½¬ç ã€åˆ†å‰²ã€åˆå¹¶ã€è¿‡æ»¤ã€æŠ“å–å±å¹•ã€æŽ¨æµåˆ°æœåŠ¡å™¨ç­‰å¤šç§æ“ä½œã€‚

  å®ƒçš„ä¸»è¦ç»„æˆéƒ¨åˆ†åŒ…æ‹¬ï¼š

  1. **ffmpeg**
     ï¼šå‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºŽè½¬æ¢éŸ³é¢‘ã€è§†é¢‘æ–‡ä»¶æ ¼å¼ï¼Œæˆ–è€…å¯¹å®ƒä»¬è¿›è¡Œå„ç§å¤æ‚çš„å¤„ç†æ“ä½œï¼Œä¾‹å¦‚æ··æµã€æŠ½å–éŸ³è½¨ã€æ·»åŠ å­—å¹•ç­‰ã€‚
  2. **ffprobe**
     ï¼šç”¨äºŽèŽ·å–åª’ä½“æ–‡ä»¶çš„å…ƒæ•°æ®ä¿¡æ¯ï¼ŒåŒ…æ‹¬å®¹å™¨æ ¼å¼ã€éŸ³è§†é¢‘æµçš„å…·ä½“å‚æ•°ç­‰ã€‚
  3. **ffplay**
     ï¼šè½»é‡çº§çš„åª’ä½“æ’­æ”¾å™¨ï¼Œä¸»è¦ç”¨äºŽå¿«é€Ÿæµ‹è¯•FFmpegç¼–ç æˆ–è§£ç çš„æ•ˆæžœã€‚
* FFmpeg é¡¹ç›®æ‹¥æœ‰é«˜åº¦å¯ç§»æ¤æ€§ï¼Œå¯ä»¥åœ¨ Linuxã€Windowsã€Mac OS X åŠå…¶ä»–å¤šç§æ“ä½œç³»ç»ŸçŽ¯å¢ƒä¸‹ç¼–è¯‘è¿è¡Œã€‚å…¶å†…éƒ¨çš„ libavcodec åº“åŒ…å«äº†å¤§é‡çš„éŸ³é¢‘è§†é¢‘ç¼–è§£ç å™¨å®žçŽ°ï¼Œå…¶ä¸­è®¸å¤šæ˜¯ä»Žé›¶å¼€å§‹å¼€å‘çš„ï¼Œæ—¨åœ¨æä¾›é«˜æ•ˆã€é«˜è´¨é‡çš„ç¼–è§£ç èƒ½åŠ›ã€‚
* FFmpeg ä½¿ç”¨ LGPL æˆ– GPL è®¸å¯è¯ï¼Œè¿™æ„å‘³ç€å®ƒæ˜¯è‡ªç”±è½¯ä»¶ï¼Œå…è®¸ç”¨æˆ·è‡ªç”±ä¸‹è½½ã€ä½¿ç”¨ã€ä¿®æ”¹å’Œåˆ†å‘ä»£ç ã€‚ç”±äºŽå…¶å¹¿æ³›çš„åŠŸèƒ½å’Œçµæ´»æ€§ï¼ŒFFmpeg åœ¨å¤šåª’ä½“å¼€å‘é¢†åŸŸè¢«å¹¿æ³›åº”ç”¨ï¼Œæ˜¯è®¸å¤šè§†é¢‘ç¼–è¾‘è½¯ä»¶ã€æµåª’ä½“æœåŠ¡ã€ç½‘ç»œä¼ è¾“å·¥å…·èƒŒåŽçš„åŸºçŸ³æŠ€æœ¯ä¹‹ä¸€ã€‚

#### ç‰¹ç‚¹

* å¼ºå¤§,å…è´¹,çµæ´»,æ— å¹¿å‘Š
* å‘½ä»¤è¡Œæ“ä½œ

#### ä¸‹è½½

* [Download FFmpeg](https://ffmpeg.org/download.html#build-windows)
* windowsç‰ˆæœ¬:
  [Builds - CODEX FFMPEG @ gyan.dev](https://www.gyan.dev/ffmpeg/builds/)
  ,æä¾›äº†å¤šä¸ªç‰ˆæœ¬,ç‚¹å‡»æ–‡ä»¶åç›´æŽ¥ä¸‹è½½å³å¯(å¯èƒ½æ²¡æœ‰æä¾›å•ç‹¬çš„ä¸‹è½½æŒ‰é’®)

  + å¯æ‰§è¡Œæ–‡ä»¶

    ```
    PS>ls

            Directory: C:\exes\ffmpeg\bin


    Mode                LastWriteTime         Length Name
    ----                -------------         ------ ----
    -a---         2/29/2024   6:06 PM       84847616 ó°£†  ffmpeg.exe
    -a---         2/29/2024   6:06 PM       84639744 ó°£†  ffplay.exe
    -a---         2/29/2024   6:06 PM       84680704 ó°£†  ffprobe.exe

    ```
* å…¶ä»–ç‰ˆæœ¬ä¸‹è½½æ¯”è¾ƒç›´æŽ¥

### ä½¿ç”¨

* å¦‚æžœåªæ˜¯å¶å°”ç”¨ç”¨ç®€å•çš„åŠŸèƒ½,å¯ä»¥å€ŸåŠ©\*\*
  [å¤§æ¨¡åž‹](https://tongyi.aliyun.com/qianwen/)
  \*\*æ¥ä½¿ç”¨,æ¯”å¦‚æˆ‘ä»¬è¦åˆå¹¶ä¸€ä¸ªè§†é¢‘å’ŒéŸ³é¢‘,å¦‚æžœä¸æƒ³æŸ¥çœ‹æ–‡æ¡£,å¯ä»¥ç”¨å¤§æ¨¡åž‹æœä¸€ä¸‹,çœ‹çœ‹ä¾‹å­å°±è¡Œ,æ€»ä½“æ¥è¯´è¿˜ç®—æ–¹ä¾¿,ä¸éœ€è¦ä¸‹è½½ä¸€ä¸ªè½¯ä»¶,ä¹Ÿä¸éœ€è¦å®‰è£…å°±èƒ½å¤Ÿè¿è¡Œ(é¡¶å¤šé…ç½®ä»¥ä¸‹è·¯å¾„,æˆ–è€…æŠŠéœ€è¦å¤„ç†çš„æ–‡ä»¶æ‹–åˆ°ffmpegæ‰€åœ¨ç›®å½•ä¸‹è¿›è¡Œæ“ä½œ)
* äº‹å®žä¸Š,å‘½ä»¤è¡Œå·¥å…·çš„ä½¿ç”¨,çŽ°é˜¶æ®µå¤§æ¨¡åž‹å¯ä»¥ç›´æŽ¥ç»™å‡ºæ•™ç¨‹,å¤åˆ¶ç²˜è´´,ç¨å¾®ä¿®æ”¹ä¸€ä¸‹å°±èƒ½ç”¨,ä½†æ˜¯å›¾å½¢ç•Œé¢çš„è½¯ä»¶ä½¿ç”¨,å¤§æ¨¡åž‹ç»™å‡ºçš„ç»“æžœå¾€å¾€æœ‰åå·®,å¹¶ä¸”éš¾ä»¥ç»™å‡ºå›¾æ–‡æ•™ç¨‹
* ffmpegä¸»è¦æ˜¯å‘½ä»¤è¡Œçš„å½¢å¼çš„,è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ç¼–åˆ¶è„šæœ¬åšæ‰¹å¤„ç†,æˆ–è€…åµŒå…¥åˆ°å…¶ä»–åº”ç”¨ä¸­,æ˜¯æ¯”å›¾å½¢ç•Œé¢çµæ´»çš„
* å…¶ä»–çš„è½¯ä»¶æœ‰çš„æ’å…¥å¹¿å‘Šå•Š,æ•™ç¨‹é‡Œä¹Ÿæœ‰å¹¿å‘Šçƒ¦å¾—å¾ˆ,æ‰¾åˆ°ä¸€ä¸ªå¥½ç”¨çš„è¿˜ä¸å®¹æ˜“

#### å°†è§†é¢‘å’ŒéŸ³é¢‘åˆå¹¶

* ç›¸å…³è½¯ä»¶å¾ˆå¤š,æ¯”å¦‚VLCç­‰,è¿™é‡Œç”¨ffmpeg
* å‡è®¾æˆ‘ä»ŽæŸå¤„ä¸‹è½½äº†éŸ³è§†é¢‘åˆ†ç¦»çš„èµ„æº,å¯ä»¥ä½¿ç”¨ffmpegåˆå¹¶å®ƒä»¬
* ä½¿ç”¨FFmpegåˆå¹¶éŸ³é¢‘å’Œè§†é¢‘ï¼Œä½ å¯ä»¥æ ¹æ®ä¸åŒçš„éœ€æ±‚å’Œåœºæ™¯é‡‡ç”¨ä¸åŒæ–¹æ³•ã€‚è¿™é‡Œæä¾›ä¸€ç§åŸºæœ¬çš„æ— æŸåˆå¹¶æ–¹æ³•ï¼Œå‰ææ¡ä»¶æ˜¯éŸ³é¢‘å’Œè§†é¢‘æµå·²ç»åŒæ­¥å¹¶ä¸”å…·æœ‰å…¼å®¹çš„å‚æ•°ï¼ˆå¦‚å¸§çŽ‡ã€åˆ†è¾¨çŽ‡ã€é‡‡æ ·çŽ‡ç­‰ï¼‰ã€‚
* å‡è®¾ä½ æœ‰ä¸€ä¸ªè§†é¢‘æ–‡ä»¶
  `input_video.mp4`
  å’Œä¸€ä¸ªéŸ³é¢‘æ–‡ä»¶
  `input_audio.mp3`
  ï¼Œä½ æƒ³å°†éŸ³é¢‘æ›¿æ¢åˆ°è§†é¢‘æ–‡ä»¶ä¸­ï¼ŒåŒæ—¶ä¿æŒè§†é¢‘éƒ¨åˆ†ä¸å˜ï¼Œå¯ä»¥è¿™æ ·åšï¼š

  ```bash
  ffmpeg -i input_video.mp4 -i input_audio.mp3 -c:v copy -c:a aac -map 0:v:0 -map 1:a:0 output.mp4

  ```

  è¿™ä¸ªå‘½ä»¤çš„æ„æ€æ˜¯ï¼š

  + `-i input_video.mp4`
    å’Œ
    `-i input_audio.mp3`
    åˆ†åˆ«æŒ‡å®šè¾“å…¥çš„è§†é¢‘å’ŒéŸ³é¢‘æ–‡ä»¶ã€‚
  + `-c:v copy`
    è¡¨ç¤ºè§†é¢‘æµç›´æŽ¥å¤åˆ¶ï¼ˆæ— æŸï¼‰ï¼Œä¸è¿›è¡Œè½¬ç ã€‚
  + `-c:a aac`
    æŒ‡å®šè¾“å‡ºéŸ³é¢‘æµç¼–ç ä¸ºAACï¼ˆå¦‚æžœç›®æ ‡å®¹å™¨æ”¯æŒaacï¼Œä¸”åŽŸmp3éŸ³é¢‘éœ€è¦è¢«è½¬ç ä»¥é€‚åº”å®¹å™¨è¦æ±‚ï¼‰ã€‚
  + `-map 0:v:0`
    é€‰å–ç¬¬ä¸€ä¸ªè¾“å…¥æ–‡ä»¶çš„ç¬¬ä¸€ä¸ªè§†é¢‘æµã€‚
  + `-map 1:a:0`
    é€‰å–ç¬¬äºŒä¸ªè¾“å…¥æ–‡ä»¶çš„ç¬¬ä¸€ä¸ªéŸ³é¢‘æµã€‚
  + `output.mp4`
    æ˜¯åˆå¹¶åŽè¾“å‡ºçš„æ–‡ä»¶åã€‚
* ```bash
  PS BAT [11:37:09 AM] [C:\Users\cxxu\Downloads]
  [ðŸ”‹ 102%] MEM:71.01% [5.57/7.85] GB |îŠ…ls

          Directory: C:\Users\cxxu\Downloads


  Mode                LastWriteTime         Length Name
  ----                -------------         ------ ----
  d----         2/28/2024   8:58 PM                ï  Documents
  d----          3/4/2024  11:20 AM                ï“  ffmpeg-2024-02-29-git-4a134eb14a-essentials_build
  -a---          3/4/2024  11:06 AM       32204639 ï  DownKyi-1.6.1.zip
  -a---          3/4/2024  11:19 AM       27260421 ï  ffmpeg-2024-02-29-git-4a134eb14a-essentials_build.7z
  -a---          3/4/2024  11:16 AM        1379060 ï‡‡  kk.mp3
  -a---          3/4/2024  10:56 AM        4960232 ï‡ˆ  kk.mp4
  -a---          3/4/2024  11:25 AM        7739933 ï‡ˆ  output.mp4

  PS BAT [11:37:21 AM] [C:\Users\cxxu\Downloads]
  [ðŸ”‹ 102%] MEM:72.27% [5.67/7.85] GB |îŠ…ffmpeg -i kk.mp4 -i kk.mp3 -c:v copy -c:a aac -map 0:v:0 -map 1:a:0 output2.mp4
  ffmpeg version 2024-02-29-git-4a134eb14a-essentials_build-www.gyan.dev Copyright (c) 2000-2024 the FFmpeg developers
    built with gcc 13.2.0 (Rev5, Built by MSYS2 project)
    configuration: --enable-gpl --enable-version3 --enable-static --pkg-config=pkgconf --disable-
    
    ..........
    
    libavfilter     9. 17.100 /  9. 17.100
    libswscale      7.  6.100 /  7.  6.100
    libswresample   4. 13.100 /  4. 13.100
    libpostproc    57.  4.100 / 57.  4.100
  Input #0, mov,mp4,m4a,3gp,3g2,mj2, from 'kk.mp4':
    Metadata:
      major_brand     : iso5
      minor_version   : 1
      compatible_brands: iso5dsmsmsixdash
      encoder         : Lavf58.29.100
      description     : Packed by Bilibili XCoder v2.0.2
    Duration: 00:02:44.03, start: 0.000000, bitrate: 241 kb/s
    Stream #0:0[0x1](und): Video: hevc (Main) (hev1 / 0x31766568), yuv420p(tv, bt709), 640x360 [SAR 1:1 DAR 16:9], 6 kb/s, 29.97 fps, 29.97 tbr, 16k tbn (default)
        Metadata:
          handler_name    : VideoHandler
          vendor_id       : [0][0][0][0]
  Input #1, mov,mp4,m4a,3gp,3g2,mj2, from 'kk.mp3':
    Metadata:
      major_brand     : iso5
      minor_version   : 1
      compatible_brands: avc1iso5dsmsmsixdash
      encoder         : Lavf57.71.100
      description     : Packed by Bilibili XCoder v2.0.2
    Duration: 00:02:44.05, start: 0.000000, bitrate: 67 kb/s
    Stream #1:0[0x2](und): Audio: aac (LC) (mp4a / 0x6134706D), 44100 Hz, stereo, fltp, 2 kb/s (default)
        Metadata:
          handler_name    : SoundHandler
          vendor_id       : [0][0][0][0]
  Stream mapping:
    Stream #0:0 -> #0:0 (copy)
    Stream #1:0 -> #0:1 (aac (native) -> aac (native))
  Press [q] to stop, [?] for help
  Output #0, mp4, to 'output2.mp4':
    Metadata:
      major_brand     : iso5
      minor_version   : 1
      compatible_brands: iso5dsmsmsixdash
      description     : Packed by Bilibili XCoder v2.0.2
      encoder         : Lavf60.22.101
    Stream #0:0(und): Video: hevc (Main) (hev1 / 0x31766568), yuv420p(tv, bt709), 640x360 [SAR 1:1 DAR 16:9], q=2-31, 6 kb/s, 29.97 fps, 29.97 tbr, 16k tbn (default)
        Metadata:
          handler_name    : VideoHandler
          vendor_id       : [0][0][0][0]
    Stream #0:1(und): Audio: aac (LC) (mp4a / 0x6134706D), 44100 Hz, stereo, fltp, 128 kb/s (default)
        Metadata:
          handler_name    : SoundHandler
          vendor_id       : [0][0][0][0]
          encoder         : Lavc60.40.100 aac
  [out#0/mp4 @ 0000024831eaa980] video:4782KiB audio:2573KiB subtitle:0KiB other streams:0KiB global headers:0KiB muxing overhead: 2.767128%
  size=    7559KiB time=00:02:43.89 bitrate= 377.8kbits/s speed=58.8x
  [aac @ 0000024831f7d540] Qavg: 621.202

  ```