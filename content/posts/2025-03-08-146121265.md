---
layout: post
title: "android-viewmodel如何使用"
date: 2025-03-08 19:43:15 +0800
description: "•生命周期感知：ViewModel自动关联Activity/Fragment生命周期，避免数据丢失。•数据观察：通过LiveData或StateFlow观察数据变化，确保UI更新仅在活跃状态进行。•作用域控制• Activity作用域：同一Activity的多个Fragment共享同一ViewModel实例（使用获取）。• Fragment作用域：每个Fragment拥有独立实例。•避免内存泄漏：ViewModel内不持有Activity/View引用，需Context时使用。"
keywords: "android viewmodel如何使用"
categories: ['未分类']
tags: ['Android']
artid: "146121265"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146121265
    alt: "android-viewmodel如何使用"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146121265
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146121265
cover: https://bing.ee123.net/img/rand?artid=146121265
image: https://bing.ee123.net/img/rand?artid=146121265
img: https://bing.ee123.net/img/rand?artid=146121265
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     android viewmodel如何使用
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     嗯，我现在要学习如何在Android中使用ViewModel。我之前听说过ViewModel是用来管理UI相关数据的，这样在配置变化比如屏幕旋转时数据不会丢失。但具体怎么用呢？我需要先回忆一下相关的知识。
    </p>
    <p>
     首先，ViewModel应该是Android Architecture Components的一部分，对吧？所以可能需要添加相关的依赖库。我记得是在build.gradle文件里添加依赖，比如使用androidx.lifecycle:lifecycle-viewmodel-ktx这样的库。不过具体版本号可能要看当前的项目配置，可能需要查一下最新的版本。
    </p>
    <p>
     然后，创建ViewModel的步骤是怎样的呢？应该需要新建一个类继承自ViewModel或者AndroidViewModel（如果有需要上下文的话）。比如，假设我要管理一个计数器，可以创建一个CounterViewModel类，里面有一个LiveData或者MutableLiveData来保存计数值。然后在Activity或Fragment中获取这个ViewModel的实例。
    </p>
    <p>
     不过获取ViewModel实例的方式可能有几种，比如使用ViewModelProvider，或者通过by viewModels()这个委托属性，如果是用Kotlin的话。那在Activity中应该怎么获取呢？可能是在onCreate方法里初始化，通过ViewModelProvider(this).get(CounterViewModel::class.java)这样的方式。或者更简洁的方式是用Kotlin的委托，需要导入相应的库，比如activity-ktx或fragment-ktx，这样可以直接用by viewModels()来延迟初始化ViewModel。
    </p>
    <p>
     然后，在ViewModel里暴露的数据应该通过LiveData或者StateFlow这样的可观察数据对象，这样UI组件可以观察这些数据的变化并更新界面。比如，在Activity里观察LiveData，当数据变化时更新TextView显示的值。
    </p>
    <p>
     另外，ViewModel的生命周期是怎样的？它应该和Activity或Fragment的生命周期相关联，当Activity销毁时（比如配置变化导致的销毁），ViewModel不会被销毁，而是会保留，直到对应的Activity真正finish。如果是Fragment的话，可能作用域是Fragment或者Activity，这取决于怎么获取ViewModel实例。
    </p>
    <p>
     还有，ViewModel里不应该持有Activity或View的引用，避免内存泄漏。如果确实需要Context，可以考虑使用AndroidViewModel，它内部会持有Application的Context。但一般情况下，最好避免使用AndroidViewModel，除非必须需要Application的Context。
    </p>
    <p>
     那具体的例子，比如实现一个计数器，ViewModel里有一个MutableLiveData的整数，初始化为0。然后在Activity中有一个按钮，点击后增加计数，并在TextView显示当前值。这时候，ViewModel中的方法应该如何处理？比如有一个increment方法，修改MutableLiveData的值。在Activity中，点击按钮时调用ViewModel的increment方法，然后观察LiveData的变化来更新UI。
    </p>
    <p>
     可能需要注意的地方是，LiveData的观察应该在生命周期处于活跃状态时才会触发，比如在onCreate中开始观察，使用observe方法，并传入LifecycleOwner（通常是Activity或Fragment本身）。这样当界面不可见时，不会接收到不必要的更新。
    </p>
    <p>
     那在Fragment之间共享数据的话，可能需要使用Activity作用域的ViewModel，这样多个Fragment可以获取同一个ViewModel实例。这时候在Fragment中获取ViewModel时，需要使用activity的ViewModelStoreOwner，比如ViewModelProvider(requireActivity()).get(SharedViewModel::class.java)。
    </p>
    <p>
     还有关于ViewModel的初始化，如果有参数需要传递的话，可能需要使用ViewModelFactory。比如ViewModel的构造函数有参数，这时候不能直接通过ViewModelProvider获取，而是需要创建一个Factory类，实现ViewModelProvider.Factory接口，然后在创建ViewModel实例时使用这个Factory。
    </p>
    <p>
     例如，假设CounterViewModel需要一个初始计数值作为构造参数，这时候需要创建一个Factory，在create方法中实例化ViewModel，并传递参数。然后在Activity中使用ViewModelProvider的时候，传入这个Factory的实例。
    </p>
    <p>
     不过现在可能更方便的方式是使用ViewModel的by viewModels()委托，并且如果有参数的话，可能需要自定义工厂。或者，使用Hilt这样的依赖注入库来简化ViewModel的创建，自动处理Factory的生成。
    </p>
    <p>
     如果项目中使用Hilt的话，可以通过@HiltViewModel注解来标记ViewModel，并在构造函数中使用@Inject注解，然后在Activity或Fragment中通过@AndroidEntryPoint和by viewModels()来获取实例，这样不需要手动处理Factory。
    </p>
    <p>
     不过这部分可能涉及到依赖注入的知识，对于刚学习ViewModel的人来说，可能暂时不需要深入。先掌握基础的手动创建ViewModel的方法，再学习其他更简便的方式。
    </p>
    <p>
     总结一下步骤：
    </p>
    <ol>
     <li>
      添加依赖库。
     </li>
     <li>
      创建继承自ViewModel的类，管理数据。
     </li>
     <li>
      在Activity/Fragment中获取ViewModel实例。
     </li>
     <li>
      观察ViewModel中的数据变化，更新UI。
     </li>
     <li>
      处理用户交互，调用ViewModel的方法修改数据。
     </li>
     <li>
      处理ViewModel的初始化参数（如果有的话）使用Factory。
     </li>
    </ol>
    <p>
     可能遇到的问题：
     <br/>
     • 忘记添加依赖导致类找不到。
     <br/>
     • 在ViewModel中持有View或Activity导致内存泄漏。
     <br/>
     • 没有正确观察LiveData，导致UI不更新。
     <br/>
     • 在Fragment中获取ViewModel的作用域不正确，导致不同实例。
     <br/>
     • 需要传递构造参数时没有使用Factory，导致崩溃。
    </p>
    <p>
     现在我需要写一个简单的示例代码，来验证这些步骤是否正确。例如，一个计数器应用，ViewModel保存计数值，点击按钮增加数值，并在TextView显示。屏幕旋转后数值保持。
    </p>
    <p>
     比如，CounterViewModel类：
    </p>
    <pre><code>class CounterViewModel : ViewModel() {
    private val _count = MutableLiveData&lt;Int&gt;(0)
    val count: LiveData&lt;Int&gt; get() = _count

    fun increment() {
        _count.value = (_count.value ?: 0) + 1
    }
}
</code></pre>
    <p>
     然后在Activity中：
    </p>
    <pre><code>class MainActivity : AppCompatActivity() {
    private lateinit var viewModel: CounterViewModel

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        viewModel = ViewModelProvider(this).get(CounterViewModel::class.java)

        viewModel.count.observe(this) { count -&gt;
            findViewById&lt;TextView&gt;(R.id.textView).text = count.toString()
        }

        findViewById&lt;Button&gt;(R.id.button).setOnClickListener {
            viewModel.increment()
        }
    }
}
</code></pre>
    <p>
     这样应该可以正常工作。当屏幕旋转时，ViewModel不会被销毁，计数值保留。
    </p>
    <p>
     如果使用Kotlin的委托属性，可以更简洁：
    </p>
    <pre><code>import androidx.activity.viewModels

class MainActivity : AppCompatActivity() {
    private val viewModel: CounterViewModel by viewModels()

    override fun onCreate(savedInstanceState: Bundle?) {
        // ...同上，直接使用viewModel
    }
}
</code></pre>
    <p>
     这样就不用显式调用ViewModelProvider了。
    </p>
    <p>
     如果ViewModel需要参数，比如初始值，就需要Factory：
    </p>
    <pre><code>class CounterViewModel(startingCount: Int) : ViewModel() { ... }

class CounterViewModelFactory(private val startingCount: Int) : ViewModelProvider.Factory {
    override fun &lt;T : ViewModel&gt; create(modelClass: Class&lt;T&gt;): T {
        if (modelClass.isAssignableFrom(CounterViewModel::class.java)) {
            return CounterViewModel(startingCount) as T
        }
        throw IllegalArgumentException("Unknown ViewModel class")
    }
}
</code></pre>
    <p>
     然后在Activity中：
    </p>
    <pre><code>val factory = CounterViewModelFactory(10)
viewModel = ViewModelProvider(this, factory).get(CounterViewModel::class.java)
</code></pre>
    <p>
     或者在委托中使用：
    </p>
    <pre><code>private val viewModel: CounterViewModel by viewModels { CounterViewModelFactory(10) }
</code></pre>
    <p>
     这样初始计数值就是10。
    </p>
    <p>
     不过现在在Hilt中，可以使用@AssistedInject和SavedStateHandle来处理这种情况，但这是更高级的内容了。
    </p>
    <p>
     可能需要注意的还有，ViewModel中的LiveData应该使用postValue如果在后台线程更新的话，但如果是通过按钮点击触发，点击事件在主线程，所以直接设置value即可。
    </p>
    <p>
     总结来说，ViewModel的使用步骤包括正确创建类，获取实例，观察数据，处理交互，以及可能的参数传递。需要避免常见的错误，如内存泄漏和作用域错误。
    </p>
    <p>
     在Android中使用ViewModel可以有效管理UI相关数据，并在配置更改（如屏幕旋转）时保持数据状态。以下是详细步骤和示例代码：
    </p>
    <h4>
     <a id="1_141">
     </a>
     步骤1：添加依赖
    </h4>
    <p>
     在
     <code>
      build.gradle
     </code>
     中添加Lifecycle组件依赖：
    </p>
    <pre><code class="prism language-gradle">dependencies {
    implementation "androidx.lifecycle:lifecycle-viewmodel-ktx:2.6.1"
    implementation "androidx.activity:activity-ktx:1.7.0"
}
</code></pre>
    <h4>
     <a id="2ViewModel_150">
     </a>
     步骤2：创建ViewModel类
    </h4>
    <p>
     继承
     <code>
      ViewModel
     </code>
     ，管理数据（如计数器）：
    </p>
    <pre><code class="prism language-kotlin"><span class="token keyword">class</span> CounterViewModel <span class="token operator">:</span> <span class="token function">ViewModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> _count <span class="token operator">=</span> <span class="token function">MutableLiveData</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> count<span class="token operator">:</span> LiveData<span class="token operator">&lt;</span>Int<span class="token operator">&gt;</span> <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> _count

    <span class="token keyword">fun</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        _count<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">(</span>_count<span class="token punctuation">.</span>value <span class="token operator">?:</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="3ActivityFragmentViewModel_163">
     </a>
     步骤3：在Activity/Fragment中获取ViewModel
    </h4>
    <p>
     使用
     <code>
      by viewModels()
     </code>
     委托简化初始化：
    </p>
    <pre><code class="prism language-kotlin"><span class="token keyword">import</span> androidx<span class="token punctuation">.</span>activity<span class="token punctuation">.</span>viewModels

<span class="token keyword">class</span> MainActivity <span class="token operator">:</span> <span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> viewModel<span class="token operator">:</span> CounterViewModel <span class="token keyword">by</span> <span class="token function">viewModels</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>
        <span class="token function">setContentView</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_main<span class="token punctuation">)</span>

        <span class="token comment">// 观察LiveData并更新UI</span>
        viewModel<span class="token punctuation">.</span>count<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> currentCount <span class="token operator">-&gt;</span>
            findViewById<span class="token operator">&lt;</span>TextView<span class="token operator">&gt;</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>tv_count<span class="token punctuation">)</span><span class="token punctuation">.</span>text <span class="token operator">=</span> currentCount<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 按钮点击增加计数</span>
        findViewById<span class="token operator">&lt;</span>Button<span class="token operator">&gt;</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>btn_increment<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setOnClickListener</span> <span class="token punctuation">{<!-- --></span>
            viewModel<span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="4Factory_188">
     </a>
     步骤4：处理构造参数（使用Factory）
    </h4>
    <p>
     若ViewModel需要参数，创建自定义
     <code>
      ViewModelProvider.Factory
     </code>
     ：
    </p>
    <pre><code class="prism language-kotlin"><span class="token keyword">class</span> <span class="token function">CustomViewModel</span><span class="token punctuation">(</span>startingCount<span class="token operator">:</span> Int<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ViewModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> _count <span class="token operator">=</span> <span class="token function">MutableLiveData</span><span class="token punctuation">(</span>startingCount<span class="token punctuation">)</span>
    <span class="token comment">// ...其他代码同CounterViewModel</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token function">CustomViewModelFactory</span><span class="token punctuation">(</span><span class="token keyword">private</span> <span class="token keyword">val</span> startingCount<span class="token operator">:</span> Int<span class="token punctuation">)</span> <span class="token operator">:</span> ViewModelProvider<span class="token punctuation">.</span><span class="token function">Factory</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token operator">&lt;</span>T <span class="token operator">:</span> ViewModel<span class="token operator">&gt;</span> <span class="token function">create</span><span class="token punctuation">(</span>modelClass<span class="token operator">:</span> Class<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> T <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>modelClass<span class="token punctuation">.</span><span class="token function">isAssignableFrom</span><span class="token punctuation">(</span>CustomViewModel<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token function">CustomViewModel</span><span class="token punctuation">(</span>startingCount<span class="token punctuation">)</span> <span class="token keyword">as</span> T
        <span class="token punctuation">}</span>
        <span class="token keyword">throw</span> <span class="token function">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"Unknown ViewModel class"</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     在Activity中使用Factory：
    </p>
    <pre><code class="prism language-kotlin"><span class="token keyword">class</span> MainActivity <span class="token operator">:</span> <span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> viewModel<span class="token operator">:</span> CustomViewModel <span class="token keyword">by</span> viewModels <span class="token punctuation">{<!-- --></span> <span class="token function">CustomViewModelFactory</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
    <span class="token comment">// 其余代码同上</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="_214">
     </a>
     关键点总结
    </h4>
    <p>
     •
     <strong>
      生命周期感知
     </strong>
     ：ViewModel自动关联Activity/Fragment生命周期，避免数据丢失。
     <br/>
     •
     <strong>
      数据观察
     </strong>
     ：通过
     <code>
      LiveData
     </code>
     或
     <code>
      StateFlow
     </code>
     观察数据变化，确保UI更新仅在活跃状态进行。
     <br/>
     •
     <strong>
      作用域控制
     </strong>
     ：
     <br/>
     • Activity作用域：同一Activity的多个Fragment共享同一ViewModel实例（使用
     <code>
      requireActivity()
     </code>
     获取）。
     <br/>
     • Fragment作用域：每个Fragment拥有独立实例。
     <br/>
     •
     <strong>
      避免内存泄漏
     </strong>
     ：ViewModel内不持有Activity/View引用，需Context时使用
     <code>
      AndroidViewModel
     </code>
     （提供Application Context）。
    </p>
    <h4>
     <a id="Fragment_222">
     </a>
     示例代码（Fragment间共享数据）
    </h4>
    <p>
     <strong>
      SharedViewModel
     </strong>
     ：
    </p>
    <pre><code class="prism language-kotlin"><span class="token keyword">class</span> SharedViewModel <span class="token operator">:</span> <span class="token function">ViewModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">val</span> sharedData <span class="token operator">=</span> MutableLiveData<span class="token operator">&lt;</span>String<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      FragmentA
     </strong>
     ：
    </p>
    <pre><code class="prism language-kotlin"><span class="token keyword">class</span> FragmentA <span class="token operator">:</span> <span class="token function">Fragment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> sharedViewModel<span class="token operator">:</span> SharedViewModel <span class="token keyword">by</span> <span class="token function">activityViewModels</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onViewCreated</span><span class="token punctuation">(</span>view<span class="token operator">:</span> View<span class="token punctuation">,</span> savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        sharedViewModel<span class="token punctuation">.</span>sharedData<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"Hello from FragmentA"</span></span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      FragmentB
     </strong>
     ：
    </p>
    <pre><code class="prism language-kotlin"><span class="token keyword">class</span> FragmentB <span class="token operator">:</span> <span class="token function">Fragment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> sharedViewModel<span class="token operator">:</span> SharedViewModel <span class="token keyword">by</span> <span class="token function">activityViewModels</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onViewCreated</span><span class="token punctuation">(</span>view<span class="token operator">:</span> View<span class="token punctuation">,</span> savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        sharedViewModel<span class="token punctuation">.</span>sharedData<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>viewLifecycleOwner<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">data</span> <span class="token operator">-&gt;</span>
            <span class="token comment">// 更新UI显示共享数据</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="_254">
     </a>
     注意事项
    </h4>
    <p>
     •
     <strong>
      线程安全
     </strong>
     ：在后台线程更新
     <code>
      LiveData
     </code>
     需用
     <code>
      postValue()
     </code>
     ，主线程直接用
     <code>
      setValue()
     </code>
     。
     <br/>
     •
     <strong>
      依赖注入
     </strong>
     ：考虑使用Hilt简化ViewModel创建（需添加
     <code>
      hilt-android
     </code>
     和
     <code>
      hilt-compiler
     </code>
     依赖）。
    </p>
    <p>
     通过以上步骤，可有效利用ViewModel管理UI数据，提升应用健壮性和用户体验。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f32363239363139372f:61727469636c652f64657461696c732f313436313231323635" class_="artid" style="display:none">
 </p>
</div>


