---
layout: post
title: "PyTorch系列教程Tensor.view-方法详解"
date: 2025-03-08 17:47:44 +0800
description: "这篇简明扼要的文章是关于PyTorch中的tensor.view()方法的介绍与应用，与reshape()方法的区别，同时给出示例进行详细解释。"
keywords: "pytorch tensor.view"
categories: ['人工智能', 'Python']
tags: ['人工智能', 'Pytorch', 'Python']
artid: "146119688"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146119688
    alt: "PyTorch系列教程Tensor.view-方法详解"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146119688
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146119688
cover: https://bing.ee123.net/img/rand?artid=146119688
image: https://bing.ee123.net/img/rand?artid=146119688
img: https://bing.ee123.net/img/rand?artid=146119688
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     PyTorch系列教程：Tensor.view() 方法详解
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <blockquote>
     <p>
      这篇简明扼要的文章是关于PyTorch中的tensor.view()方法的介绍与应用，与reshape()方法的区别，同时给出示例进行详细解释。
     </p>
    </blockquote>
    <h3>
     <a id="Tensor_4">
     </a>
     Tensor基础
    </h3>
    <p>
     Tensor(张量)的视图是一个新的Tensor，它与原始Tensor共享相同的底层数据，但具有不同的形状或大小。view()方法用于在不改变其数据的情况下将张量重塑为新的形状。它返回原始张量的新视图。这意味着修改新的张量会影响原来的张量，反之亦然。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/a3aa45e442e74b2b944f8a37f9d620a7.png"/>
    </p>
    <p>
     语法:
    </p>
    <pre><code class="prism language-python">Tensor<span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token operator">*</span>shape<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Tensor
</code></pre>
    <ul>
     <li>
      self：想要重塑的输入Tensor。
     </li>
     <li>
      *shape：一个
      <code>
       torch.Size
      </code>
      对象或指定输出张量所需形状的整数序列。还可以使用-1从其他维度推断一个维度的大小。
     </li>
    </ul>
    <p>
     然而，Tensor.view()仅适用于连续张量，即存储在连续内存中的张量。如果输入张量不是连续的，则需要在调用tensor .view()之前调用tensor.consecuous()。你可以通过调用tensor.is_consecuous()来检查张量是否是连续的。
    </p>
    <h3>
     <a id="_20">
     </a>
     代码示例
    </h3>
    <p>
     下面演示如何在实践中使用tensor.view()方法：
    </p>
    <pre><code class="prism language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">import</span> torch
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> torch<span class="token punctuation">.</span>manual_seed<span class="token punctuation">(</span><span class="token number">2023</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token comment"># Create a tensor with the shape of 4x4</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> x <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.4305</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.3499</span><span class="token punctuation">,</span>  <span class="token number">0.4749</span><span class="token punctuation">,</span>  <span class="token number">0.9041</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.7021</span><span class="token punctuation">,</span>  <span class="token number">1.5963</span><span class="token punctuation">,</span>  <span class="token number">0.4228</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.6940</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">0.9672</span><span class="token punctuation">,</span>  <span class="token number">1.5569</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.3860</span><span class="token punctuation">,</span>  <span class="token number">0.6994</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1.0325</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.6043</span><span class="token punctuation">,</span>  <span class="token number">0.9337</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1050</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> y <span class="token operator">=</span> x<span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span>
tensor<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token number">0.4305</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.3499</span><span class="token punctuation">,</span>  <span class="token number">0.4749</span><span class="token punctuation">,</span>  <span class="token number">0.9041</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.7021</span><span class="token punctuation">,</span>  <span class="token number">1.5963</span><span class="token punctuation">,</span>  <span class="token number">0.4228</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.6940</span><span class="token punctuation">,</span>
         <span class="token number">0.9672</span><span class="token punctuation">,</span>  <span class="token number">1.5569</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.3860</span><span class="token punctuation">,</span>  <span class="token number">0.6994</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0325</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.6043</span><span class="token punctuation">,</span>  <span class="token number">0.9337</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1050</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> z<span class="token operator">=</span>x<span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span>
tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.4305</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.3499</span><span class="token punctuation">,</span>  <span class="token number">0.4749</span><span class="token punctuation">,</span>  <span class="token number">0.9041</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.7021</span><span class="token punctuation">,</span>  <span class="token number">1.5963</span><span class="token punctuation">,</span>  <span class="token number">0.4228</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.6940</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">0.9672</span><span class="token punctuation">,</span>  <span class="token number">1.5569</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.3860</span><span class="token punctuation">,</span>  <span class="token number">0.6994</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0325</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.6043</span><span class="token punctuation">,</span>  <span class="token number">0.9337</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1050</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> w<span class="token operator">=</span>x<span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span>
tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.4305</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.3499</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">0.4749</span><span class="token punctuation">,</span>  <span class="token number">0.9041</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.7021</span><span class="token punctuation">,</span>  <span class="token number">1.5963</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">0.4228</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.6940</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">0.9672</span><span class="token punctuation">,</span>  <span class="token number">1.5569</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2.3860</span><span class="token punctuation">,</span>  <span class="token number">0.6994</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1.0325</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.6043</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token number">0.9337</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.1050</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> 
</code></pre>
    <p>
     你可以看到y和x有相同的数据，但形状不同，是16x1。Z和x有相同的数据，但形状不同，是2x8。W和x有相同的数据，但形状不同，是8x2。w的最后一个维度是从其他维度和x中的元素数量推断出来的。
    </p>
    <h3>
     <a id="Torchviewtorchreshape_57">
     </a>
     Torch.view()和torch.reshape()的区别
    </h3>
    <p>
     torch.reshape()函数和tensor .view()方法之间的区别在于torch.reshape()可以返回原始张量的视图或副本，具体取决于新形状是否与原始形状和步幅兼容，而tensor .view()总是返回原始张量的视图，但仅适用于连续张量。
    </p>
    <p>
     当你想重塑一个张量而不担心它的连续性或复制行为时，你应该使用torch.reshape()，当你想重塑一个连续张量并确保它与原始张量共享相同的数据时，你应该使用tensor. view()。
    </p>
    <h4>
     <a id="_63">
     </a>
     <strong>
      示例对比
     </strong>
    </h4>
    <h5>
     <a id="_1_65">
     </a>
     <strong>
      场景 1：数据连续时，两者行为一致
     </strong>
    </h5>
    <pre><code class="prism language-python"><span class="token keyword">import</span> torch

<span class="token comment"># 创建一个连续存储的张量 (2x3)</span>
x <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"原始形状:"</span><span class="token punctuation">,</span> x<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>      <span class="token comment"># (2, 3)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"是否连续:"</span><span class="token punctuation">,</span> x<span class="token punctuation">.</span>is_contiguous<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>

<span class="token comment"># 使用 view 改变形状 (3x2)</span>
y <span class="token operator">=</span> x<span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"view 结果:"</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span>           <span class="token comment"># [[1, 2], [3, 4], [5, 6]]</span>

<span class="token comment"># 使用 reshape 改变形状 (3x2)</span>
z <span class="token operator">=</span> x<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"reshape 结果:"</span><span class="token punctuation">,</span> z<span class="token punctuation">)</span>        <span class="token comment"># [[1, 2], [3, 4], [5, 6]]</span>
</code></pre>
    <p>
     <strong>
      结果一致
     </strong>
     ，且未复制数据（
     <code>
      is_contiguous()
     </code>
     返回
     <code>
      True
     </code>
     ）。
    </p>
    <h5>
     <a id="_2view_reshape__87">
     </a>
     <strong>
      场景 2：数据不连续时，
      <code>
       view
      </code>
      失败，
      <code>
       reshape
      </code>
      成功
     </strong>
    </h5>
    <pre><code class="prism language-python"><span class="token comment"># 转置后数据不再连续（原按行存储，转置后按列逻辑访问）</span>
x_transposed <span class="token operator">=</span> x<span class="token punctuation">.</span>t<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"转置后形状:"</span><span class="token punctuation">,</span> x_transposed<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>      <span class="token comment"># (3, 2)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"是否连续:"</span><span class="token punctuation">,</span> x_transposed<span class="token punctuation">.</span>is_contiguous<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># False</span>

<span class="token comment"># 尝试用 view 改变形状 → 报错！</span>
<span class="token keyword">try</span><span class="token punctuation">:</span>
    y <span class="token operator">=</span> x_transposed<span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">except</span> RuntimeError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"view 错误:"</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># "invalid argument: cannot view a non-contiguous tensor as ..."</span>

<span class="token comment"># 使用 reshape 成功（自动复制数据）</span>
z <span class="token operator">=</span> x_transposed<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"reshape 结果:"</span><span class="token punctuation">,</span> z<span class="token punctuation">)</span>         <span class="token comment"># [[1, 4], [2, 5], [3, 6]]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"是否连续:"</span><span class="token punctuation">,</span> z<span class="token punctuation">.</span>is_contiguous<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
</code></pre>
    <h5>
     <a id="_3reshape__1_108">
     </a>
     <strong>
      场景 3：
      <code>
       reshape
      </code>
      的灵活性（使用
      <code>
       -1
      </code>
      ）
     </strong>
    </h5>
    <pre><code class="prism language-python"><span class="token comment"># 不确定某一维度的大小时，仅用 reshape</span>
x_2d <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>  <span class="token comment"># 形状 (4, 6)</span>
<span class="token comment"># 将最后一维压缩为总和，剩余维度自动推断</span>
y <span class="token operator">=</span> x_2d<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>   <span class="token comment"># 结果形状: (8, 3)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>y<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>              <span class="token comment"># torch.Size([8, 3])</span>
</code></pre>
    <p>
     因此，我们应
     <strong>
      优先用
      <code>
       view
      </code>
     </strong>
     ：当数据连续且形状明确时，
     <code>
      view
     </code>
     更高效（零复制）；
     <strong>
      优先用
      <code>
       reshape
      </code>
     </strong>
     ：需处理非连续数据、动态推断维度或不确定形状时。
    </p>
   </div>
   <link href="./../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="./../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f6e65776561737473756e2f:61727469636c652f64657461696c732f313436313139363838" class_="artid" style="display:none">
 </p>
</div>


