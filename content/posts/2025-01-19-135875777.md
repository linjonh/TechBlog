---
layout: post
title: "docker容器运维命令"
date: 2025-01-19 21:41:10 +0800
description: "本文主要介绍docker容器运维相关的命令_docker运维命令"
keywords: "docker运维命令"
categories: ['Docker']
tags: ['运维', 'Docker']
artid: "135875777"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=135875777
    alt: "docker容器运维命令"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=135875777
featuredImagePreview: https://bing.ee123.net/img/rand?artid=135875777
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     docker容器运维命令
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <div class="toc">
     <h4>
      文章目录
     </h4>
     <ul>
      <li>
       <a href="#docker_ps_1" rel="nofollow">
        docker ps
       </a>
      </li>
      <li>
       <a href="#docker_exec_16" rel="nofollow">
        docker exec
       </a>
      </li>
      <li>
       <a href="#docker_inspect_60" rel="nofollow">
        docker inspect
       </a>
      </li>
      <li>
       <a href="#docker_top_70" rel="nofollow">
        docker top
       </a>
      </li>
      <li>
       <a href="#docker_attach_89" rel="nofollow">
        docker attach
       </a>
      </li>
      <li>
       <a href="#docker_wait_111" rel="nofollow">
        docker wait
       </a>
      </li>
      <li>
       <a href="#docker_export_113" rel="nofollow">
        docker export
       </a>
      </li>
      <li>
       <a href="#docker_import_128" rel="nofollow">
        docker import
       </a>
      </li>
      <li>
       <a href="#docker_port_134" rel="nofollow">
        docker port
       </a>
      </li>
      <li>
       <a href="#docker_cp_140" rel="nofollow">
        docker cp
       </a>
      </li>
      <li>
       <a href="#docker_diff_152" rel="nofollow">
        docker diff
       </a>
      </li>
      <li>
       <a href="#docker_rename_158" rel="nofollow">
        docker rename
       </a>
      </li>
      <li>
       <a href="#docker_stats_165" rel="nofollow">
        docker stats
       </a>
      </li>
      <li>
       <a href="#docker_update_168" rel="nofollow">
        docker update
       </a>
      </li>
      <li>
       <a href="#_170" rel="nofollow">
        总结
       </a>
      </li>
     </ul>
    </div>
    <p>
    </p>
    <h2>
     <a id="docker_ps_1">
     </a>
     docker ps
    </h2>
    <p>
     列出容器。
    </p>
    <pre><code class="prism language-bash">docker <span class="token function">ps</span> <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span>
</code></pre>
    <p>
     OPTIONS说明：
     <br/>
     -a :显示所有的容器，包括未运行的。
     <br/>
     -f :根据条件过滤显示的内容。
     <br/>
     –format :指定返回值的模板文件。
     <br/>
     -l :显示最近创建的容器。
     <br/>
     -n :列出最近创建的n个容器。
     <br/>
     –no-trunc :不截断输出。
     <br/>
     -q :静默模式，只显示容器编号。
     <br/>
     -s :显示总的文件大小。
    </p>
    <h2>
     <a id="docker_exec_16">
     </a>
     docker exec
    </h2>
    <p>
     在运行的容器中执行命令。
    </p>
    <pre><code class="prism language-bash">docker <span class="token builtin class-name">exec</span> <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> CONTAINER COMMAND <span class="token punctuation">[</span>ARG<span class="token punctuation">..</span>.<span class="token punctuation">]</span>
</code></pre>
    <p>
     OPTIONS说明：
     <br/>
     -d :分离模式: 在后台运行
     <br/>
     -i :即使没有附加也保持STDIN 打开
     <br/>
     -t :分配一个伪终端
    </p>
    <pre><code class="prism language-bash">docker <span class="token builtin class-name">exec</span> mynginx <span class="token function">ls</span>
bin
boot
dev
docker-entrypoint.d
docker-entrypoint.sh
etc
home
lib
lib64
media
mnt
opt
proc
root
run
sbin
srv
sys
tmp
usr
var
</code></pre>
    <pre><code class="prism language-bash">king@king-server:~$ docker <span class="token builtin class-name">exec</span> -it mynginx2 <span class="token function">bash</span>
root@7229dc20b6df:/<span class="token comment"># ls</span>
bin   dev                  docker-entrypoint.sh  home  lib32  libx32  mnt  proc  run   srv  tmp  var
boot  docker-entrypoint.d  etc                   lib   lib64  media   opt  root  sbin  sys  usr
root@7229dc20b6df:/<span class="token comment"># exit</span>
<span class="token builtin class-name">exit</span>
</code></pre>
    <h2>
     <a id="docker_inspect_60">
     </a>
     docker inspect
    </h2>
    <p>
     获取容器/镜像的元数据。
    </p>
    <pre><code class="prism language-bash">docker inspect <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> NAME<span class="token operator">|</span>ID <span class="token punctuation">[</span>NAME<span class="token operator">|</span>ID<span class="token punctuation">..</span>.<span class="token punctuation">]</span>
</code></pre>
    <p>
     OPTIONS说明：
     <br/>
     -f :指定返回值的模板文件。
     <br/>
     -s :显示总的文件大小。
     <br/>
     –type :为指定类型返回JSON
    </p>
    <h2>
     <a id="docker_top_70">
     </a>
     docker top
    </h2>
    <p>
     查看容器中运行的进程信息，支持 ps 命令参数。
    </p>
    <pre><code class="prism language-bash">docker <span class="token function">top</span> <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> CONTAINER <span class="token punctuation">[</span>ps OPTIONS<span class="token punctuation">]</span>
</code></pre>
    <p>
     示例：
    </p>
    <pre><code class="prism language-bash"><span class="token comment"># 查看所有运行容器的进程信息。</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">`</span>docker <span class="token function">ps</span> <span class="token operator">|</span><span class="token function">grep</span> Up<span class="token operator">|</span><span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$1</span>}'</span><span class="token variable">`</span></span><span class="token punctuation">;</span><span class="token keyword">do</span> <span class="token builtin class-name">echo</span> <span class="token punctuation">\</span> <span class="token operator">&amp;&amp;</span>docker <span class="token function">top</span> <span class="token variable">$i</span><span class="token punctuation">;</span> <span class="token keyword">done</span>
</code></pre>
    <pre><code class="prism language-bash"><span class="token environment constant">UID</span>                 PID                 <span class="token environment constant">PPID</span>                C                   STIME               TTY                 TIME                CMD
<span class="token number">165536</span>              <span class="token number">1835</span>                <span class="token number">1811</span>                <span class="token number">0</span>                   05:35               ?                   00:00:00            nginx: master process nginx -g daemon off<span class="token punctuation">;</span>
<span class="token number">165637</span>              <span class="token number">1898</span>                <span class="token number">1835</span>                <span class="token number">0</span>                   05:35               ?                   00:00:00            nginx: worker process
<span class="token number">165637</span>              <span class="token number">1899</span>                <span class="token number">1835</span>                <span class="token number">0</span>                   05:35               ?                   00:00:00            nginx: worker process
</code></pre>
    <h2>
     <a id="docker_attach_89">
     </a>
     docker attach
    </h2>
    <p>
     连接到正在运行中的容器。
    </p>
    <pre><code class="prism language-bash">docker attach <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> CONTAINER
</code></pre>
    <p>
     <strong>
      docker exec 与 docker attach 的区别：
     </strong>
    </p>
    <ul>
     <li>
      exec 在容器中执行命令，并且可以通过-i -t 创建虚拟终端的方式与容器交互。
     </li>
     <li>
      attach 进入容器某个正在执行的命令终端，不能交互操作。但是如果该容器的命令终端是一个可以 交互的终端，那么也可以交互。
     </li>
    </ul>
    <p>
     <strong>
      退出attach模式：
     </strong>
    </p>
    <ol>
     <li>
      运行容器时指定 -i -t 参数，那么attach容器后可通过Ctrl + P + Ctrl + Q 退出attach状态。
     </li>
    </ol>
    <pre><code class="prism language-bash">docker run -d -it -P nginx
docker attach <span class="token operator">&lt;</span>containerID<span class="token operator">&gt;</span>
</code></pre>
    <ol start="2">
     <li>
      仅指定-t参数，可以通过Ctrl + C 退出attach状态。
     </li>
     <li>
      不指定-t参数，在attach的时候指定 --sig-proxy=false ，可以通过 Ctrl + C 退出attach状态。–sig-proxy 仅在没有指定-t参数的情况下生效。于–sig-proxy 默认值为true，默认将所有接收信号代理给了容器中的进程，所以Ctrl + C 的时候会将sigint (signal interrupt)终止信号发送到attach进程，从而转发到被attach的进程，导致容器中进程中断，从而退出容器。
     </li>
    </ol>
    <h2>
     <a id="docker_wait_111">
     </a>
     docker wait
    </h2>
    <p>
     阻塞运行直到容器停止，然后打印出它的退出代码。
    </p>
    <h2>
     <a id="docker_export_113">
     </a>
     docker export
    </h2>
    <p>
     将文件系统作为一个tar归档文件导出到STDOUT。
    </p>
    <pre><code class="prism language-bash">docker <span class="token builtin class-name">export</span> <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> CONTAINER
</code></pre>
    <p>
     OPTIONS说明：
     <br/>
     -o :将输入内容写到文件。
    </p>
    <pre><code class="prism language-bash">docker <span class="token builtin class-name">export</span> mynginx -o mynginx.tar
<span class="token comment"># 解压归档文件，查看内容</span>
<span class="token function">tar</span> vxf mynginx.tar -c mynginx
</code></pre>
    <p>
     当容器出现问题时，可以将文件导出，保留现场。
    </p>
    <h2>
     <a id="docker_import_128">
     </a>
     docker import
    </h2>
    <p>
     将文件系统导入指定容器。
    </p>
    <pre><code class="prism language-bash">docker <span class="token function">import</span> <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> <span class="token function">file</span><span class="token operator">|</span>URL<span class="token operator">|</span>- <span class="token punctuation">[</span>REPOSITORY<span class="token punctuation">[</span>:TAG<span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre>
    <h2>
     <a id="docker_port_134">
     </a>
     docker port
    </h2>
    <p>
     列出指定的容器的端口映射，或者查找将PRIVATE_PORT NAT到面向公众的端口。
    </p>
    <pre><code class="prism language-bash">docker port <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> CONTAINER <span class="token punctuation">[</span>PRIVATE_PORT<span class="token punctuation">[</span>/PROTO<span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre>
    <h2>
     <a id="docker_cp_140">
     </a>
     docker cp
    </h2>
    <p>
     用于容器与主机之间的数据拷贝。
    </p>
    <pre><code class="prism language-bash">docker <span class="token function">cp</span> <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> CONTAINER:SRC_PATH DEST_PATH<span class="token operator">|</span>-
docker <span class="token function">cp</span> <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> SRC_PATH<span class="token operator">|</span>- CONTAINER:DEST_PATH
</code></pre>
    <p>
     OPTIONS说明：
     <br/>
     -L :保持源目标中的链接
    </p>
    <p>
     示例，将容器的文件拷贝到主机：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/1c7408100ab498ddc8ad616a6d767497.png"/>
    </p>
    <h2>
     <a id="docker_diff_152">
     </a>
     docker diff
    </h2>
    <p>
     检查容器里文件结构的更改。docker diff命令会列出 3 种容器内文件状态变化（A - Add, D - Delete, C - Change ）的列表清单。
    </p>
    <pre><code class="prism language-bash">docker <span class="token function">diff</span> <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> CONTAINER
</code></pre>
    <h2>
     <a id="docker_rename_158">
     </a>
     docker rename
    </h2>
    <p>
     重命名容器名。
    </p>
    <pre><code class="prism language-bash">docker <span class="token function">rename</span> CONTAINER NEW_NAME
</code></pre>
    <h2>
     <a id="docker_stats_165">
     </a>
     docker stats
    </h2>
    <p>
     容器监控。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/ae867c287463b925e775750b94140ac7.png"/>
    </p>
    <h2>
     <a id="docker_update_168">
     </a>
     docker update
    </h2>
    <p>
     用来修改docker run 指定的运行参数。
    </p>
    <h2>
     <a id="_170">
     </a>
     总结
    </h2>
    <ol>
     <li>
      容器遵循最小原则，会尽可能不打包 非必须的程序进去。
     </li>
     <li>
      docker attach如果没有指定-i -t或者–sig-proxy=false，那么使用CTL+C的方式会把容器也退出。
     </li>
    </ol>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f32393735303535392f:61727469636c652f64657461696c732f313335383735373737" class_="artid" style="display:none">
 </p>
</div>


