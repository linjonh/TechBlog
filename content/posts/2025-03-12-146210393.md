---
layout: post
title: "使用-matchMedia-API-实现响应式-JavaScript-开发教程"
date: 2025-03-12 17:28:41 +0800
description: "matchMedia 是浏览器提供的 JavaScript API，用于检测当前文档是否匹配指定的 CSS 媒体查询条件。与 CSS 媒体查询不同，它允许开发者在 JavaScript 中动态响应视口变化，实现更精细的控制。"
keywords: "使用 matchMedia API 实现响应式 JavaScript 开发教程"
categories: ['Javascript']
tags: ['Javascript']
artid: "146210393"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146210393
    alt: "使用-matchMedia-API-实现响应式-JavaScript-开发教程"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146210393
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146210393
cover: https://bing.ee123.net/img/rand?artid=146210393
image: https://bing.ee123.net/img/rand?artid=146210393
img: https://bing.ee123.net/img/rand?artid=146210393
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     使用 matchMedia API 实现响应式 JavaScript 开发教程
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-tomorrow-night" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="_matchMedia_API__JavaScript__0">
     </a>
     使用 matchMedia API 实现响应式 JavaScript 开发教程
    </h2>
    <h3>
     <a id="1__matchMedia_2">
     </a>
     1. 什么是 matchMedia？
    </h3>
    <p>
     <code>
      matchMedia
     </code>
     是浏览器提供的 JavaScript API，用于检测当前文档是否匹配指定的 CSS 媒体查询条件。与 CSS 媒体查询不同，它允许开发者在 JavaScript 中动态响应视口变化，实现更精细的控制。
    </p>
    <h4>
     <a id="_6">
     </a>
     核心特点
    </h4>
    <ul>
     <li>
      实时检测视口状态
     </li>
     <li>
      支持 CSS3 媒体查询语法
     </li>
     <li>
      可绑定事件监听器
     </li>
     <li>
      返回
      <code>
       MediaQueryList
      </code>
      对象
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="2__15">
     </a>
     2. 基本语法
    </h3>
    <h4>
     <a id="21__17">
     </a>
     2.1 创建媒体查询对象
    </h4>
    <pre><code class="prism language-javascript"><span class="token keyword">const</span> mediaQuery <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">matchMedia</span><span class="token punctuation">(</span><span class="token string">'(max-width: 768px)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <h4>
     <a id="22__23">
     </a>
     2.2 检查当前状态
    </h4>
    <pre><code class="prism language-javascript"><span class="token keyword">if</span> <span class="token punctuation">(</span>mediaQuery<span class="token punctuation">.</span>matches<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'当前视口宽度 ≤ 768px'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'当前视口宽度 &gt; 768px'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="_33">
     </a>
     返回对象结构
    </h4>
    <pre><code class="prism language-javascript"><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">matches</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>       <span class="token comment">// 是否匹配</span>
  <span class="token literal-property property">media</span><span class="token operator">:</span> <span class="token string">'(max-width: 768px)'</span><span class="token punctuation">,</span>  <span class="token comment">// 查询字符串</span>
  <span class="token literal-property property">onchange</span><span class="token operator">:</span> <span class="token keyword">null</span>       <span class="token comment">// 事件处理器</span>
<span class="token punctuation">}</span>
</code></pre>
    <hr/>
    <h3>
     <a id="3__45">
     </a>
     3. 监听媒体查询变化
    </h3>
    <h4>
     <a id="31__47">
     </a>
     3.1 添加事件监听
    </h4>
    <pre><code class="prism language-javascript"><span class="token keyword">function</span> <span class="token function">handleTabletChange</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>matches<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'进入移动端模式'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'退出移动端模式'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> mediaQuery <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">matchMedia</span><span class="token punctuation">(</span><span class="token string">'(max-width: 768px)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mediaQuery<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> handleTabletChange<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <h4>
     <a id="32__62">
     </a>
     3.2 移除监听器
    </h4>
    <pre><code class="prism language-javascript"><span class="token comment">// 使用 addEventListener 添加的</span>
mediaQuery<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> handleTabletChange<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 或使用传统方式</span>
mediaQuery<span class="token punctuation">.</span>onchange <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</code></pre>
    <hr/>
    <h3>
     <a id="4__74">
     </a>
     4. 实际应用场景
    </h3>
    <h4>
     <a id="41__76">
     </a>
     4.1 暗色模式检测
    </h4>
    <pre><code class="prism language-javascript"><span class="token keyword">const</span> darkModeQuery <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">matchMedia</span><span class="token punctuation">(</span><span class="token string">'(prefers-color-scheme: dark)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

darkModeQuery<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">toggle</span><span class="token punctuation">(</span><span class="token string">'dark-theme'</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>matches<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <h4>
     <a id="42__86">
     </a>
     4.2 响应式图片加载
    </h4>
    <pre><code class="prism language-javascript"><span class="token keyword">function</span> <span class="token function">loadResponsiveImage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> mediaQuery <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">matchMedia</span><span class="token punctuation">(</span><span class="token string">'(min-resolution: 2dppx)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token keyword">if</span> <span class="token punctuation">(</span>mediaQuery<span class="token punctuation">.</span>matches<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    img<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'image@2x.jpg'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
    img<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'image.jpg'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="43__100">
     </a>
     4.3 方向检测
    </h4>
    <pre><code class="prism language-javascript"><span class="token keyword">const</span> orientationQuery <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">matchMedia</span><span class="token punctuation">(</span><span class="token string">'(orientation: portrait)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

orientationQuery<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">mq</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>mq<span class="token punctuation">.</span>matches<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'竖屏模式'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'横屏模式'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <hr/>
    <h3>
     <a id="5__116">
     </a>
     5. 兼容性与注意事项
    </h3>
    <h4>
     <a id="_118">
     </a>
     浏览器支持
    </h4>
    <ul>
     <li>
      Chrome 9+
     </li>
     <li>
      Firefox 6+
     </li>
     <li>
      Safari 5.1+
     </li>
     <li>
      Edge 12+
     </li>
     <li>
      iOS Safari 5.1+
     </li>
    </ul>
    <h4>
     <a id="_126">
     </a>
     常见问题处理
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        内存泄漏
       </strong>
       ：始终移除不需要的监听器
      </p>
     </li>
     <li>
      <p>
       <strong>
        性能优化
       </strong>
       ：避免在滚动事件中频繁创建查询对象
      </p>
     </li>
     <li>
      <p>
       <strong>
        语法校验
       </strong>
       ：
      </p>
      <pre><code class="prism language-javascript"><span class="token comment">// 错误写法</span>
window<span class="token punctuation">.</span><span class="token function">matchMedia</span><span class="token punctuation">(</span><span class="token string">'max-width: 768px'</span><span class="token punctuation">)</span>

<span class="token comment">// 正确写法</span>
window<span class="token punctuation">.</span><span class="token function">matchMedia</span><span class="token punctuation">(</span><span class="token string">'(max-width: 768px)'</span><span class="token punctuation">)</span>
</code></pre>
     </li>
    </ol>
    <h4>
     <a id="_142">
     </a>
     移动端特殊处理
    </h4>
    <pre><code class="prism language-javascript"><span class="token comment">// 检测触摸设备</span>
<span class="token keyword">const</span> isTouch <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">matchMedia</span><span class="token punctuation">(</span><span class="token string">'(pointer: coarse)'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>matches<span class="token punctuation">;</span>

<span class="token comment">// 防止安卓误判</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> mediaQuery <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">matchMedia</span><span class="token punctuation">(</span><span class="token string">'(max-width: 768px)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mediaQuery<span class="token punctuation">.</span>matches<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">passive</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <hr/>
    <h3>
     <a id="6__157">
     </a>
     6. 总结
    </h3>
    <h4>
     <a id="_159">
     </a>
     优势对比
    </h4>
    <table>
     <thead>
      <tr>
       <th>
        特性
       </th>
       <th>
        CSS 媒体查询
       </th>
       <th>
        matchMedia
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        动态检测
       </td>
       <td>
        ❌ 页面加载时
       </td>
       <td>
        ✅ 实时
       </td>
      </tr>
      <tr>
       <td>
        JavaScript 控制
       </td>
       <td>
        有限
       </td>
       <td>
        完全控制
       </td>
      </tr>
      <tr>
       <td>
        事件驱动
       </td>
       <td>
        需配合 ResizeObserver
       </td>
       <td>
        原生支持
       </td>
      </tr>
     </tbody>
    </table>
    <h4>
     <a id="_167">
     </a>
     最佳实践
    </h4>
    <ol>
     <li>
      优先使用
      <code>
       addEventListener
      </code>
      而非
      <code>
       onchange
      </code>
     </li>
     <li>
      复用 MediaQueryList 对象
     </li>
     <li>
      配合
      <code>
       ResizeObserver
      </code>
      处理复杂布局
     </li>
    </ol>
    <p>
     通过掌握
     <code>
      matchMedia
     </code>
     ，您可以在现代 Web 开发中实现真正动态、响应式的用户体验。建议在实际项目中结合具体需求灵活应用这些技术。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470:733a2f2f626c6f672e6373646e2e6e65742f77736366616e2f:61727469636c652f64657461696c732f313436323130333933" class_="artid" style="display:none">
 </p>
</div>


