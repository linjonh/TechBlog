---
layout: post
title: "Java集合框架全解析从数据结构到高并发简单解析"
date: 2025-03-09 14:04:37 +0800
description: "多线程扩容时链表形成环状结构，导致CPU 100%"
keywords: "Java集合框架全解析：从数据结构到高并发简单解析"
categories: ['Java']
tags: ['数据结构', 'Java', 'Java', 'Java']
artid: "146131758"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146131758
    alt: "Java集合框架全解析从数据结构到高并发简单解析"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146131758
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146131758
cover: https://bing.ee123.net/img/rand?artid=146131758
image: https://bing.ee123.net/img/rand?artid=146131758
img: https://bing.ee123.net/img/rand?artid=146131758
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Java集合框架全解析：从数据结构到高并发简单解析
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="Java_17_0">
     </a>
     一、集合框架全景图（含Java 17新特性）
    </h3>
    <h4>
     <a id="1__1">
     </a>
     1. 集合框架层级关系
    </h4>
    <div class="mermaid">
     <svg class="mermaid-svg" height="254" id="mermaid-svg-LlczMwnXbqARTW22" viewbox="0 0 1452.0234375 254" width="1452.0234375" xmlns="http://www.w3.org/2000/svg">
      <style>
       #mermaid-svg-LlczMwnXbqARTW22 {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-svg-LlczMwnXbqARTW22 .error-icon{fill:#552222;}#mermaid-svg-LlczMwnXbqARTW22 .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-LlczMwnXbqARTW22 .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-LlczMwnXbqARTW22 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-LlczMwnXbqARTW22 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-LlczMwnXbqARTW22 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-LlczMwnXbqARTW22 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-LlczMwnXbqARTW22 .marker{fill:#333333;stroke:#333333;}#mermaid-svg-LlczMwnXbqARTW22 .marker.cross{stroke:#333333;}#mermaid-svg-LlczMwnXbqARTW22 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-LlczMwnXbqARTW22 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-svg-LlczMwnXbqARTW22 .cluster-label text{fill:#333;}#mermaid-svg-LlczMwnXbqARTW22 .cluster-label span{color:#333;}#mermaid-svg-LlczMwnXbqARTW22 .label text,#mermaid-svg-LlczMwnXbqARTW22 span{fill:#333;color:#333;}#mermaid-svg-LlczMwnXbqARTW22 .node rect,#mermaid-svg-LlczMwnXbqARTW22 .node circle,#mermaid-svg-LlczMwnXbqARTW22 .node ellipse,#mermaid-svg-LlczMwnXbqARTW22 .node polygon,#mermaid-svg-LlczMwnXbqARTW22 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg-LlczMwnXbqARTW22 .node .label{text-align:center;}#mermaid-svg-LlczMwnXbqARTW22 .node.clickable{cursor:pointer;}#mermaid-svg-LlczMwnXbqARTW22 .arrowheadPath{fill:#333333;}#mermaid-svg-LlczMwnXbqARTW22 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-svg-LlczMwnXbqARTW22 .flowchart-link{stroke:#333333;fill:none;}#mermaid-svg-LlczMwnXbqARTW22 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-svg-LlczMwnXbqARTW22 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-svg-LlczMwnXbqARTW22 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-svg-LlczMwnXbqARTW22 .cluster text{fill:#333;}#mermaid-svg-LlczMwnXbqARTW22 .cluster span{color:#333;}#mermaid-svg-LlczMwnXbqARTW22 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-LlczMwnXbqARTW22 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}
      </style>
      <g>
       <g class="output">
        <g class="clusters">
        </g>
        <g class="edgePaths">
         <g class="edgePath LS-A LE-B" id="L-A-B" style="opacity: 1;">
          <path class="path" d="M455.33203125,37.980295808559774L410.0416666666667,44.81691317379981C364.7513020833333,51.65353053903985,274.1705729166667,65.32676526951992,228.88020833333334,76.33004930142663C183.58984375,87.33333333333333,183.58984375,95.66666666666667,183.58984375,99.83333333333333L183.58984375,104" marker-end="url(#arrowhead209)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead209" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-A LE-C" id="L-A-C" style="opacity: 1;">
          <path class="path" d="M501.57421875,54L501.57421875,58.166666666666664C501.57421875,62.333333333333336,501.57421875,70.66666666666667,501.57421875,79C501.57421875,87.33333333333333,501.57421875,95.66666666666667,501.57421875,99.83333333333333L501.57421875,104" marker-end="url(#arrowhead210)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead210" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-A LE-D" id="L-A-D" style="opacity: 1;">
          <path class="path" d="M547.81640625,38.67507260079692L588.3092447916666,45.395893833997434C628.8020833333334,52.11671506719795,709.7877604166666,65.55835753359897,750.2805989583334,76.44584543346615C790.7734375,87.33333333333333,790.7734375,95.66666666666667,790.7734375,99.83333333333333L790.7734375,104" marker-end="url(#arrowhead211)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead211" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-E LE-F" id="L-E-F" style="opacity: 1;">
          <path class="path" d="M1101.51171875,36.70872229540118L1071.4641927083333,43.75726857950099C1041.4166666666667,50.80581486360078,981.3216145833334,64.90290743180039,951.2740885416666,76.11812038256686C921.2265625,87.33333333333333,921.2265625,95.66666666666667,921.2265625,99.83333333333333L921.2265625,104" marker-end="url(#arrowhead212)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead212" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-B LE-G" id="L-B-G" style="opacity: 1;">
          <path class="path" d="M160.84765625,135.1609672049762L142.34440104166666,141.80080600414684C123.84114583333333,148.44064480331747,86.83463541666667,161.72032240165873,68.33138020833333,172.52682786749605C49.828125,183.33333333333334,49.828125,191.66666666666666,49.828125,195.83333333333334L49.828125,200" marker-end="url(#arrowhead213)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead213" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-B LE-H" id="L-B-H" style="opacity: 1;">
          <path class="path" d="M185.684326171875,150L186.06376139322916,154.16666666666666C186.44319661458334,158.33333333333334,187.20206705729166,166.66666666666666,187.58150227864584,175C187.9609375,183.33333333333334,187.9609375,191.66666666666666,187.9609375,195.83333333333334L187.9609375,200" marker-end="url(#arrowhead214)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead214" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-B LE-I" id="L-B-I" style="opacity: 1;">
          <path class="path" d="M206.33203125,135.1609672049762L224.83528645833334,141.80080600414684C243.33854166666666,148.44064480331747,280.3450520833333,161.72032240165873,298.8483072916667,172.52682786749605C317.3515625,183.33333333333334,317.3515625,191.66666666666666,317.3515625,195.83333333333334L317.3515625,200" marker-end="url(#arrowhead215)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead215" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-C LE-J" id="L-C-J" style="opacity: 1;">
          <path class="path" d="M480.19140625,143.3677817230424L473.3040364583333,148.63981810253534C466.4166666666667,153.91185448202828,452.6419270833333,164.45592724101414,445.7545572916667,173.89463028717373C438.8671875,183.33333333333334,438.8671875,191.66666666666666,438.8671875,195.83333333333334L438.8671875,200" marker-end="url(#arrowhead216)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead216" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-C LE-K" id="L-C-K" style="opacity: 1;">
          <path class="path" d="M522.95703125,143.3677817230424L529.8444010416666,148.63981810253534C536.7317708333334,153.91185448202828,550.5065104166666,164.45592724101414,557.3938802083334,173.89463028717373C564.28125,183.33333333333334,564.28125,191.66666666666666,564.28125,195.83333333333334L564.28125,200" marker-end="url(#arrowhead217)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead217" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-D LE-L" id="L-D-L" style="opacity: 1;">
          <path class="path" d="M757.8984375,146.63869713174526L749.9856770833334,151.36558094312105C742.0729166666666,156.09246475449683,726.2473958333334,165.54623237724843,718.3346354166666,174.43978285529087C710.421875,183.33333333333334,710.421875,191.66666666666666,710.421875,195.83333333333334L710.421875,200" marker-end="url(#arrowhead218)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead218" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-D LE-M" id="L-D-M" style="opacity: 1;">
          <path class="path" d="M823.6484375,146.63869713174526L831.5611979166666,151.36558094312105C839.4739583333334,156.09246475449683,855.2994791666666,165.54623237724843,863.2122395833334,174.43978285529087C871.125,183.33333333333334,871.125,191.66666666666666,871.125,195.83333333333334L871.125,200" marker-end="url(#arrowhead219)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead219" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-E LE-N" id="L-E-N" style="opacity: 1;">
          <path class="path" d="M1101.51171875,48.790469391397465L1094.6243489583333,53.82539115949788C1087.7369791666667,58.86031292759831,1073.9622395833333,68.93015646379915,1067.0748697916667,78.13174489856624C1060.1875,87.33333333333333,1060.1875,95.66666666666667,1060.1875,99.83333333333333L1060.1875,104" marker-end="url(#arrowhead220)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead220" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-E LE-O" id="L-E-O" style="opacity: 1;">
          <path class="path" d="M1150.18359375,48.790469391397465L1157.0709635416667,53.82539115949788C1163.9583333333333,58.86031292759831,1177.7330729166667,68.93015646379915,1184.6204427083333,78.13174489856624C1191.5078125,87.33333333333333,1191.5078125,95.66666666666667,1191.5078125,99.83333333333333L1191.5078125,104" marker-end="url(#arrowhead221)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead221" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-E LE-P" id="L-E-P" style="opacity: 1;">
          <path class="path" d="M1150.18359375,35.9311544613558L1185.6087239583333,43.10929538446317C1221.0338541666667,50.28743630757054,1291.8841145833333,64.64371815378526,1327.3092447916667,75.9885257435593C1362.734375,87.33333333333333,1362.734375,95.66666666666667,1362.734375,99.83333333333333L1362.734375,104" marker-end="url(#arrowhead222)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead222" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
        </g>
        <g class="edgeLabels">
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-A' L-LE-B" id="L-L-A-B">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-A' L-LE-C" id="L-L-A-C">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-A' L-LE-D" id="L-L-A-D">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-E' L-LE-F" id="L-L-E-F">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-B' L-LE-G" id="L-L-B-G">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-B' L-LE-H" id="L-L-B-H">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-B' L-LE-I" id="L-L-B-I">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-C' L-LE-J" id="L-L-C-J">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-C' L-LE-K" id="L-L-C-K">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-D' L-LE-L" id="L-L-D-L">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-D' L-LE-M" id="L-L-D-M">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-E' L-LE-N" id="L-L-E-N">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-E' L-LE-O" id="L-L-E-O">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-E' L-LE-P" id="L-L-E-P">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
        </g>
        <g class="nodes">
         <g class="node default" id="flowchart-A-308" style="opacity: 1;" transform="translate(501.57421875,31)">
          <rect class="label-container" height="46" rx="0" ry="0" width="92.484375" x="-46.2421875" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-36.2421875,-13)">
            <foreignobject height="26" width="72.484375">
             <div style="display: inline-block; white-space: nowrap;">
              Collection
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-B-309" style="opacity: 1;" transform="translate(183.58984375,127)">
          <rect class="label-container" height="46" rx="0" ry="0" width="45.484375" x="-22.7421875" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-12.7421875,-13)">
            <foreignobject height="26" width="25.484375">
             <div style="display: inline-block; white-space: nowrap;">
              List
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-C-311" style="opacity: 1;" transform="translate(501.57421875,127)">
          <rect class="label-container" height="46" rx="0" ry="0" width="42.765625" x="-21.3828125" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-11.3828125,-13)">
            <foreignobject height="26" width="22.765625">
             <div style="display: inline-block; white-space: nowrap;">
              Set
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-D-313" style="opacity: 1;" transform="translate(790.7734375,127)">
          <rect class="label-container" height="46" rx="0" ry="0" width="65.75" x="-32.875" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-22.875,-13)">
            <foreignobject height="26" width="45.75">
             <div style="display: inline-block; white-space: nowrap;">
              Queue
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-E-314" style="opacity: 1;" transform="translate(1125.84765625,31)">
          <rect class="label-container" height="46" rx="0" ry="0" width="48.671875" x="-24.3359375" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-14.3359375,-13)">
            <foreignobject height="26" width="28.671875">
             <div style="display: inline-block; white-space: nowrap;">
              Map
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-F-315" style="opacity: 1;" transform="translate(921.2265625,127)">
          <rect class="label-container" height="46" rx="0" ry="0" width="95.15625" x="-47.578125" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-37.578125,-13)">
            <foreignobject height="26" width="75.15625">
             <div style="display: inline-block; white-space: nowrap;">
              SortedMap
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-G-317" style="opacity: 1;" transform="translate(49.828125,223)">
          <rect class="label-container" height="46" rx="0" ry="0" width="83.65625" x="-41.828125" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-31.828125,-13)">
            <foreignobject height="26" width="63.65625">
             <div style="display: inline-block; white-space: nowrap;">
              ArrayList
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-H-319" style="opacity: 1;" transform="translate(187.9609375,223)">
          <rect class="label-container" height="46" rx="0" ry="0" width="92.609375" x="-46.3046875" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-36.3046875,-13)">
            <foreignobject height="26" width="72.609375">
             <div style="display: inline-block; white-space: nowrap;">
              LinkedList
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-I-321" style="opacity: 1;" transform="translate(317.3515625,223)">
          <rect class="label-container" height="46" rx="0" ry="0" width="66.171875" x="-33.0859375" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-23.0859375,-13)">
            <foreignobject height="26" width="46.171875">
             <div style="display: inline-block; white-space: nowrap;">
              Vector
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-J-323" style="opacity: 1;" transform="translate(438.8671875,223)">
          <rect class="label-container" height="46" rx="0" ry="0" width="76.859375" x="-38.4296875" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-28.4296875,-13)">
            <foreignobject height="26" width="56.859375">
             <div style="display: inline-block; white-space: nowrap;">
              HashSet
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-K-325" style="opacity: 1;" transform="translate(564.28125,223)">
          <rect class="label-container" height="46" rx="0" ry="0" width="73.96875" x="-36.984375" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-26.984375,-13)">
            <foreignobject height="26" width="53.96875">
             <div style="display: inline-block; white-space: nowrap;">
              TreeSet
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-L-327" style="opacity: 1;" transform="translate(710.421875,223)">
          <rect class="label-container" height="46" rx="0" ry="0" width="118.3125" x="-59.15625" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-49.15625,-13)">
            <foreignobject height="26" width="98.3125">
             <div style="display: inline-block; white-space: nowrap;">
              PriorityQueue
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-M-329" style="opacity: 1;" transform="translate(871.125,223)">
          <rect class="label-container" height="46" rx="0" ry="0" width="103.09375" x="-51.546875" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-41.546875,-13)">
            <foreignobject height="26" width="83.09375">
             <div style="display: inline-block; white-space: nowrap;">
              ArrayDeque
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-N-331" style="opacity: 1;" transform="translate(1060.1875,127)">
          <rect class="label-container" height="46" rx="0" ry="0" width="82.765625" x="-41.3828125" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-31.3828125,-13)">
            <foreignobject height="26" width="62.765625">
             <div style="display: inline-block; white-space: nowrap;">
              HashMap
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-O-333" style="opacity: 1;" transform="translate(1191.5078125,127)">
          <rect class="label-container" height="46" rx="0" ry="0" width="79.875" x="-39.9375" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-29.9375,-13)">
            <foreignobject height="26" width="59.875">
             <div style="display: inline-block; white-space: nowrap;">
              TreeMap
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-P-335" style="opacity: 1;" transform="translate(1362.734375,127)">
          <rect class="label-container" height="46" rx="0" ry="0" width="162.578125" x="-81.2890625" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-71.2890625,-13)">
            <foreignobject height="26" width="142.578125">
             <div style="display: inline-block; white-space: nowrap;">
              ConcurrentHashMap
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
        </g>
       </g>
      </g>
     </svg>
    </div>
    <h4>
     <a id="2__20">
     </a>
     2. 核心接口对比
    </h4>
    <table>
     <thead>
      <tr>
       <th>
        接口
       </th>
       <th>
        有序性
       </th>
       <th>
        唯一性
       </th>
       <th>
        线程安全
       </th>
       <th>
        典型实现类
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        List
       </td>
       <td>
        是
       </td>
       <td>
        允许重复
       </td>
       <td>
        否
       </td>
       <td>
        ArrayList, CopyOnWriteArrayList
       </td>
      </tr>
      <tr>
       <td>
        Set
       </td>
       <td>
        否
       </td>
       <td>
        元素唯一
       </td>
       <td>
        否
       </td>
       <td>
        HashSet, ConcurrentSkipListSet
       </td>
      </tr>
      <tr>
       <td>
        Queue
       </td>
       <td>
        是
       </td>
       <td>
        允许重复
       </td>
       <td>
        部分
       </td>
       <td>
        ArrayBlockingQueue, LinkedTransferQueue
       </td>
      </tr>
      <tr>
       <td>
        Map
       </td>
       <td>
        否
       </td>
       <td>
        Key唯一
       </td>
       <td>
        否
       </td>
       <td>
        HashMap, ConcurrentHashMap
       </td>
      </tr>
     </tbody>
    </table>
    <hr/>
    <h3>
     <a id="List_30">
     </a>
     二、List集合深度解剖
    </h3>
    <h4>
     <a id="1_ArrayList_vs_LinkedList__31">
     </a>
     1. ArrayList vs LinkedList 实现原理
    </h4>
    <p>
     <strong>
      ArrayList
     </strong>
     ：
    </p>
    <ul>
     <li>
      底层：动态数组
     </li>
     <li>
      扩容机制：
      <code>
       int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1);
      </code>
     </li>
     <li>
      随机访问时间复杂度：O(1)
     </li>
    </ul>
    <p>
     <strong>
      LinkedList
     </strong>
     ：
    </p>
    <ul>
     <li>
      底层：双向链表
     </li>
     <li>
      节点结构：
      <pre><code class="prism language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{<!-- --></span>  
    <span class="token class-name">E</span> item<span class="token punctuation">;</span>  
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> next<span class="token punctuation">;</span>  
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> prev<span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
</code></pre>
     </li>
     <li>
      插入/删除时间复杂度：O(1)（已知位置）
     </li>
    </ul>
    <h4>
     <a id="2_List_49">
     </a>
     2. 线程安全List解决方案对比
    </h4>
    <table>
     <thead>
      <tr>
       <th>
        实现方式
       </th>
       <th>
        锁粒度
       </th>
       <th>
        适用场景
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        Vector
       </td>
       <td>
        方法级synchronized
       </td>
       <td>
        已过时，不推荐使用
       </td>
      </tr>
      <tr>
       <td>
        Collections.synchronizedList
       </td>
       <td>
        对象锁
       </td>
       <td>
        低并发场景
       </td>
      </tr>
      <tr>
       <td>
        CopyOnWriteArrayList
       </td>
       <td>
        无锁（写时复制）
       </td>
       <td>
        读多写少（如黑白名单）
       </td>
      </tr>
     </tbody>
    </table>
    <hr/>
    <h3>
     <a id="Map_58">
     </a>
     三、Map集合核心实现原理
    </h3>
    <h4>
     <a id="1_HashMap_JDK_8_59">
     </a>
     1. HashMap JDK 8优化升级
    </h4>
    <ul>
     <li>
      <strong>
       数据结构
      </strong>
      ：数组 + 链表/红黑树（链表长度≥8转红黑树）
     </li>
     <li>
      <strong>
       哈希扰动函数
      </strong>
      ：
      <pre><code class="prism language-java"><span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">hash</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  
    <span class="token keyword">int</span> h<span class="token punctuation">;</span>  
    <span class="token keyword">return</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token punctuation">(</span>h <span class="token operator">=</span> key<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>h <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
</code></pre>
     </li>
     <li>
      <strong>
       扩容机制
      </strong>
      ：当size &gt; capacity * loadFactor（默认0.75）时扩容2倍
     </li>
    </ul>
    <h4>
     <a id="2_ConcurrentHashMap_70">
     </a>
     2. ConcurrentHashMap分段锁进化史
    </h4>
    <ul>
     <li>
      <strong>
       JDK 7
      </strong>
      ：Segment分段锁（16段）
     </li>
     <li>
      <strong>
       JDK 8
      </strong>
      ：CAS + synchronized锁单个Node
      <pre><code class="prism language-java"><span class="token keyword">synchronized</span> <span class="token punctuation">(</span>node<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  
    <span class="token comment">// 操作链表/红黑树  </span>
<span class="token punctuation">}</span>  
</code></pre>
     </li>
    </ul>
    <h4>
     <a id="3_Map_79">
     </a>
     3. 特殊场景Map选择指南
    </h4>
    <table>
     <thead>
      <tr>
       <th>
        场景
       </th>
       <th>
        推荐实现
       </th>
       <th>
        理由
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        高并发缓存
       </td>
       <td>
        ConcurrentHashMap
       </td>
       <td>
        分段锁降低冲突
       </td>
      </tr>
      <tr>
       <td>
        需要排序的Key-Value存储
       </td>
       <td>
        TreeMap
       </td>
       <td>
        红黑树保证有序
       </td>
      </tr>
      <tr>
       <td>
        缓存淘汰策略（LRU）
       </td>
       <td>
        LinkedHashMap
       </td>
       <td>
        重写removeEldestEntry方法
       </td>
      </tr>
     </tbody>
    </table>
    <hr/>
    <h3>
     <a id="_88">
     </a>
     四、高并发队列实战应用
    </h3>
    <h4>
     <a id="1_BlockingQueue_89">
     </a>
     1. BlockingQueue实现对比
    </h4>
    <table>
     <thead>
      <tr>
       <th>
        队列类型
       </th>
       <th>
        数据结构
       </th>
       <th>
        锁类型
       </th>
       <th>
        适用场景
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        ArrayBlockingQueue
       </td>
       <td>
        数组
       </td>
       <td>
        ReentrantLock
       </td>
       <td>
        固定容量生产消费模型
       </td>
      </tr>
      <tr>
       <td>
        LinkedBlockingQueue
       </td>
       <td>
        链表
       </td>
       <td>
        双锁分离
       </td>
       <td>
        高吞吐任务队列
       </td>
      </tr>
      <tr>
       <td>
        PriorityBlockingQueue
       </td>
       <td>
        堆
       </td>
       <td>
        ReentrantLock
       </td>
       <td>
        优先级任务调度
       </td>
      </tr>
      <tr>
       <td>
        SynchronousQueue
       </td>
       <td>
        无缓冲
       </td>
       <td>
        CAS
       </td>
       <td>
        直接传递任务
       </td>
      </tr>
     </tbody>
    </table>
    <h4>
     <a id="2_Disruptor_97">
     </a>
     2. Disruptor高性能队列对比（第三方库）
    </h4>
    <pre><code class="prism language-java"><span class="token comment">// 初始化Disruptor  </span>
<span class="token class-name">Disruptor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Event</span><span class="token punctuation">&gt;</span></span> disruptor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Disruptor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>  
    <span class="token class-name">Event</span><span class="token operator">::</span><span class="token keyword">new</span><span class="token punctuation">,</span>  
    <span class="token number">1024</span><span class="token punctuation">,</span>  
    <span class="token class-name">DaemonThreadFactory</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">,</span>  
    <span class="token class-name">ProducerType</span><span class="token punctuation">.</span><span class="token constant">MULTI</span><span class="token punctuation">,</span>  <span class="token comment">// 多生产者模式  </span>
    <span class="token keyword">new</span> <span class="token class-name">BlockingWaitStrategy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
<span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre>
    <ul>
     <li>
      <strong>
       优势
      </strong>
      ：无锁设计、环形缓冲区、缓存行填充避免伪共享
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="Java_8_112">
     </a>
     五、Java 8+新特性与集合融合
    </h3>
    <h4>
     <a id="1_Stream_API_113">
     </a>
     1. Stream API性能陷阱与正确用法
    </h4>
    <p>
     <strong>
      错误示例
     </strong>
     ：
    </p>
    <pre><code class="prism language-java">list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
   <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>s <span class="token operator">-&gt;</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">3</span><span class="token punctuation">)</span>  
   <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
   <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 多次遍历集合  </span>
</code></pre>
    <p>
     <strong>
      正确优化
     </strong>
     ：
    </p>
    <pre><code class="prism language-java">list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
   <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>s <span class="token operator">-&gt;</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">3</span><span class="token punctuation">)</span>  
   <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 单次遍历  </span>
</code></pre>
    <h4>
     <a id="2__129">
     </a>
     2. 不可变集合工厂方法
    </h4>
    <pre><code class="prism language-java"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> set <span class="token operator">=</span> <span class="token class-name">Set</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token class-name">Map</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">"Key1"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"Key2"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre>
    <ul>
     <li>
      <strong>
       特点
      </strong>
      ：线程安全、拒绝null元素、空间优化
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="_139">
     </a>
     六、集合性能调优十大原则
    </h3>
    <ol>
     <li>
      <strong>
       预估容量
      </strong>
      ：
      <code>
       new ArrayList&lt;&gt;(initialCapacity)
      </code>
     </li>
     <li>
      <strong>
       慎用自动装箱
      </strong>
      ：优先使用Primitive集合库（如FastUtil）
     </li>
     <li>
      <strong>
       遍历方式选择
      </strong>
      ：
      <pre><code class="prism language-java"><span class="token comment">// 随机访问列表  </span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>  
<span class="token comment">// 顺序访问链表  </span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Iterator</span> it <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>  
</code></pre>
     </li>
     <li>
      <strong>
       避免在循环中调用size()
      </strong>
      ：
      <code>
       int size = list.size();
      </code>
     </li>
     <li>
      <strong>
       并发场景使用Concurrent集合
      </strong>
      而非手动同步
     </li>
     <li>
      <strong>
       缓存hashCode
      </strong>
      ：重写hashCode()避免重复计算
     </li>
     <li>
      <strong>
       合理选择负载因子
      </strong>
      ：高查询场景可降低loadFactor
     </li>
     <li>
      <strong>
       监控集合扩容开销
      </strong>
      ：使用JFR(Java Flight Recorder)
     </li>
     <li>
      <strong>
       并行流谨慎使用
      </strong>
      ：数据量&gt;1万时考虑parallelStream
     </li>
     <li>
      <strong>
       第三方高性能库
      </strong>
      ：考虑Koloboke、Eclipse Collections
     </li>
    </ol>
    <hr/>
    <h3>
     <a id="_159">
     </a>
     七、企业级实战案例
    </h3>
    <h4>
     <a id="1_ConcurrentHashMap_160">
     </a>
     1. 电商库存扣减场景（ConcurrentHashMap）
    </h4>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InventoryManager</span> <span class="token punctuation">{<!-- --></span>  
    <span class="token keyword">private</span> <span class="token class-name">ConcurrentHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">AtomicInteger</span><span class="token punctuation">&gt;</span></span> inventory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">deduct</span><span class="token punctuation">(</span><span class="token class-name">String</span> itemId<span class="token punctuation">,</span> <span class="token keyword">int</span> quantity<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  
        <span class="token keyword">return</span> inventory<span class="token punctuation">.</span><span class="token function">computeIfPresent</span><span class="token punctuation">(</span>itemId<span class="token punctuation">,</span> <span class="token punctuation">(</span>k<span class="token punctuation">,</span> v<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{<!-- --></span>  
            <span class="token keyword">int</span> remaining <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> quantity<span class="token punctuation">;</span>  
            <span class="token keyword">return</span> remaining <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name">AtomicInteger</span><span class="token punctuation">(</span>remaining<span class="token punctuation">)</span> <span class="token operator">:</span> v<span class="token punctuation">;</span>  
        <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  
</code></pre>
    <h4>
     <a id="2_DelayQueue_174">
     </a>
     2. 定时任务调度（DelayQueue）
    </h4>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DelayedTask</span> <span class="token keyword">implements</span> <span class="token class-name">Delayed</span> <span class="token punctuation">{<!-- --></span>  
    <span class="token keyword">private</span> <span class="token keyword">long</span> executeTime<span class="token punctuation">;</span>  

    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getDelay</span><span class="token punctuation">(</span><span class="token class-name">TimeUnit</span> unit<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  
        <span class="token keyword">return</span> unit<span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span>executeTime <span class="token operator">-</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">NANOSECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name">Delayed</span> o<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  
        <span class="token keyword">return</span> <span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span>executeTime<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">DelayedTask</span><span class="token punctuation">)</span> o<span class="token punctuation">)</span><span class="token punctuation">.</span>executeTime<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  

<span class="token class-name">DelayQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DelayedTask</span><span class="token punctuation">&gt;</span></span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DelayQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre>
    <hr/>
    <h3>
     <a id="_193">
     </a>
     八、常见坑点与高频面试题
    </h3>
    <h4>
     <a id="1_ConcurrentModificationException_194">
     </a>
     1. ConcurrentModificationException触发场景
    </h4>
    <pre><code class="prism language-java"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> s <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  
    list<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 抛出异常  </span>
<span class="token punctuation">}</span>  
</code></pre>
    <p>
     <strong>
      解决方案
     </strong>
     ：
    </p>
    <ul>
     <li>
      使用Iterator的remove()方法
     </li>
     <li>
      改用CopyOnWriteArrayList
     </li>
    </ul>
    <h4>
     <a id="2_HashMapJDK_7_206">
     </a>
     2. HashMap死循环问题（JDK 7多线程扩容）
    </h4>
    <p>
     <strong>
      原理
     </strong>
     ：多线程扩容时链表形成环状结构，导致CPU 100%
    </p>
    <h4>
     <a id="3_HashMapAVL_209">
     </a>
     3. 面试题：HashMap为什么选择红黑树而非AVL树？
    </h4>
    <p>
     <strong>
      答案
     </strong>
     ：
    </p>
    <ul>
     <li>
      红黑树牺牲严格平衡性换取更低的旋转开销
     </li>
     <li>
      统计显示链表长度超过8的概率极低（0.00000006）
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="Java_vs_Python_vs_Go_216">
     </a>
     九、跨语言集合框架对比（Java vs Python vs Go）
    </h3>
    <table>
     <thead>
      <tr>
       <th>
        功能
       </th>
       <th>
        Java
       </th>
       <th>
        Python
       </th>
       <th>
        Go
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        线程安全Map
       </td>
       <td>
        ConcurrentHashMap
       </td>
       <td>
        dict + 全局锁
       </td>
       <td>
        sync.Map
       </td>
      </tr>
      <tr>
       <td>
        链表实现
       </td>
       <td>
        LinkedList
       </td>
       <td>
        list（动态数组）
       </td>
       <td>
        list（切片）
       </td>
      </tr>
      <tr>
       <td>
        内存优化集合
       </td>
       <td>
        Trove/FastUtil
       </td>
       <td>
        <strong>
         slots
        </strong>
       </td>
       <td>
        值类型切片
       </td>
      </tr>
      <tr>
       <td>
        持久化集合
       </td>
       <td>
        无原生支持
       </td>
       <td>
        无原生支持
       </td>
       <td>
        无原生支持
       </td>
      </tr>
     </tbody>
    </table>
    <hr/>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f613835343531373930302f:61727469636c652f64657461696c732f313436313331373538" class_="artid" style="display:none">
 </p>
</div>


