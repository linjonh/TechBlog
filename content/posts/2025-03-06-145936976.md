---
layout: post
title: "Linux系统之augenrules详解"
date: 2025-03-06 07:00:00 +0800
description: "augenrules 是 Linux 审计系统中的一个命令行工具，用于管理审计规则。它的主要作用是处理位于 /etc/audit/rules.d/ 目录下的所有规则文件，并将这些分散的规则合并到主审计规则文件中（通常是 /etc/audit/audit.rules）。这样做的目的是简化审计规则的管理和维护过程，允许管理员通过多个较小、更易管理的文件来定义审计策略，而不是直接编辑单一的大文件。"
keywords: "linux放完rules文件之后要执行什么命令"
categories: ['未分类']
tags: ['运维', '服务器', 'Linux', 'Augenrules']
artid: "145936976"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=145936976
    alt: "Linux系统之augenrules详解"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=145936976
featuredImagePreview: https://bing.ee123.net/img/rand?artid=145936976
cover: https://bing.ee123.net/img/rand?artid=145936976
image: https://bing.ee123.net/img/rand?artid=145936976
img: https://bing.ee123.net/img/rand?artid=145936976
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Linux系统之augenrules详解
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     <code>
      augenrules
     </code>
     是 Linux 审计系统中的一个命令行工具，用于管理审计规则。它的主要作用是处理位于
     <code>
      /etc/audit/rules.d/
     </code>
     目录下的所有规则文件，并将这些分散的规则合并到主审计规则文件中（通常是
     <code>
      /etc/audit/audit.rules
     </code>
     ）。这样做的目的是简化审计规则的管理和维护过程，允许管理员通过多个较小、更易管理的文件来定义审计策略，而不是直接编辑单一的大文件。
    </p>
    <h4>
     <a id="_2">
     </a>
     主要功能
    </h4>
    <ul>
     <li>
      <strong>
       规则合并
      </strong>
      ：从
      <code>
       /etc/audit/rules.d/
      </code>
      目录下读取所有
      <code>
       .rules
      </code>
      文件，并将它们的内容整合到主审计规则文件中。
     </li>
     <li>
      <strong>
       自动化规则更新
      </strong>
      ：提供一种简便的方法来确保所有配置的审计规则都被加载到审计守护进程
      <code>
       auditd
      </code>
      中。
     </li>
     <li>
      <strong>
       增强可维护性
      </strong>
      ：通过允许将审计规则分割成多个文件，使得管理和维护变得更为简单和模块化。
     </li>
    </ul>
    <h4>
     <a id="_9">
     </a>
     工作流程
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        创建规则文件
       </strong>
       ：在
       <code>
        /etc/audit/rules.d/
       </code>
       目录下创建一个或多个以
       <code>
        .rules
       </code>
       结尾的文件。每个文件包含一组相关的审计规则。
      </p>
     </li>
     <li>
      <p>
       <strong>
        运行
        <code>
         augenrules
        </code>
       </strong>
       ：执行
       <code>
        augenrules
       </code>
       命令后，它会扫描
       <code>
        /etc/audit/rules.d/
       </code>
       目录下的所有
       <code>
        .rules
       </code>
       文件，并按照字母顺序将其内容合并到主审计规则文件中（通常是
       <code>
        /etc/audit/audit.rules
       </code>
       ）。
      </p>
     </li>
     <li>
      <p>
       <strong>
        重启
        <code>
         auditd
        </code>
       </strong>
       ：为了使新的规则生效，通常需要重启
       <code>
        auditd
       </code>
       服务：
      </p>
      <pre><code class="prism language-bash"><span class="token function">sudo</span> systemctl restart auditd
</code></pre>
     </li>
    </ol>
    <h4>
     <a id="_20">
     </a>
     示例
    </h4>
    <p>
     假设有以下两个规则文件：
    </p>
    <ul>
     <li>
      <p>
       <code>
        /etc/audit/rules.d/network.rules
       </code>
      </p>
      <pre><code class="prism language-plaintext"># Monitor network configuration changes
-w /etc/network/interfaces -p wa -k network_config
</code></pre>
     </li>
     <li>
      <p>
       <code>
        /etc/audit/rules.d/file_access.rules
       </code>
      </p>
      <pre><code class="prism language-plaintext"># Monitor access to sensitive files
-w /etc/shadow -p wa -k shadow_access
-w /etc/sudoers -p wa -k sudoers_access
</code></pre>
     </li>
    </ul>
    <p>
     当运行
     <code>
      augenrules
     </code>
     后，这两个文件的内容将会被合并到
     <code>
      /etc/audit/audit.rules
     </code>
     文件中。最终生成的
     <code>
      /etc/audit/audit.rules
     </code>
     文件可能看起来像这样：
    </p>
    <pre><code class="prism language-plaintext"># Monitor network configuration changes
-w /etc/network/interfaces -p wa -k network_config

# Monitor access to sensitive files
-w /etc/shadow -p wa -k shadow_access
-w /etc/sudoers -p wa -k sudoers_access
</code></pre>
    <h4>
     <a id="_49">
     </a>
     基本语法
    </h4>
    <pre><code class="prism language-bash">augenrules <span class="token punctuation">[</span>选项<span class="token punctuation">]</span>
</code></pre>
    <h4>
     <a id="_54">
     </a>
     常用选项
    </h4>
    <ul>
     <li>
      <code>
       --load
      </code>
      ：合并并加载规则（默认行为）。
     </li>
     <li>
      <code>
       --check
      </code>
      ：检查规则文件的语法是否正确，但不加载规则。
     </li>
     <li>
      <code>
       --backup
      </code>
      ：在加载新规则之前备份当前规则。
     </li>
     <li>
      <code>
       --restore
      </code>
      ：从备份中恢复规则。
     </li>
     <li>
      <code>
       --verbose
      </code>
      ：显示详细的操作信息。
     </li>
     <li>
      <code>
       --help
      </code>
      ：显示帮助信息。
     </li>
    </ul>
    <h4>
     <a id="_62">
     </a>
     示例
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        合并并加载规则
       </strong>
      </p>
      <pre><code class="prism language-bash">augenrules <span class="token parameter variable">--load</span>
</code></pre>
      <ul>
       <li>
        合并
        <code>
         /etc/audit/rules.d/
        </code>
        目录下的所有规则文件，并将其加载到内核中。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        检查规则文件语法
       </strong>
      </p>
      <pre><code class="prism language-bash">augenrules <span class="token parameter variable">--check</span>
</code></pre>
      <ul>
       <li>
        检查
        <code>
         /etc/audit/rules.d/
        </code>
        目录下的规则文件语法是否正确。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        备份当前规则
       </strong>
      </p>
      <pre><code class="prism language-bash">augenrules <span class="token parameter variable">--backup</span>
</code></pre>
      <ul>
       <li>
        在加载新规则之前备份当前规则。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        从备份中恢复规则
       </strong>
      </p>
      <pre><code class="prism language-bash">augenrules <span class="token parameter variable">--restore</span>
</code></pre>
      <ul>
       <li>
        从备份中恢复规则。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        显示详细操作信息
       </strong>
      </p>
      <pre><code class="prism language-bash">augenrules <span class="token parameter variable">--verbose</span> <span class="token parameter variable">--load</span>
</code></pre>
      <ul>
       <li>
        合并并加载规则，同时显示详细的操作信息。
       </li>
      </ul>
     </li>
    </ol>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f35363330333232392f:61727469636c652f64657461696c732f313435393336393736" class_="artid" style="display:none">
 </p>
</div>


