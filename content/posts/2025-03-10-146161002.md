---
layout: post
title: "算法精讲-树二BFS层序遍历魔法像水波纹一样扫描整棵树"
date: 2025-03-10 18:43:11 +0800
description: "小明用DFS解二叉树的右视图总超时，直到他发现BFS层序遍历就像超市结账时排队——：找最短路径时（如迷宫问题），BFS像警犬搜救，DFS像游客瞎逛！：最差情况是完美二叉树，最后一层有⌈n/2⌉个节点，所以是。：队列空且所有节点处理完毕，就像快递站所有包裹都派送完！：每个节点进出队列各一次，时间复杂度是妥妥的。：遍历子节点时从固定左右子节点变成遍历。：层序遍历序列化，空节点用特殊符号标记。：BFS层序遍历的时间复杂度怎么计算？：多源BFS，所有0同时作为起点扩散。集合，像贴封条一样标记已访问节点！"
keywords: "算法精讲 | 树（二）：BFS层序遍历の魔法——像水波纹一样扫描整棵树"
categories: ['算法精讲', '树图']
tags: ['算法', '宽度优先']
artid: "146161002"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146161002
    alt: "算法精讲-树二BFS层序遍历魔法像水波纹一样扫描整棵树"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146161002
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146161002
cover: https://bing.ee123.net/img/rand?artid=146161002
image: https://bing.ee123.net/img/rand?artid=146161002
img: https://bing.ee123.net/img/rand?artid=146161002
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     算法精讲 | 树（二）：BFS层序遍历の魔法——像水波纹一样扫描整棵树
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="___BFS_1">
     </a>
     🎯
     <strong>
      算法精讲 | 树（二）：BFS层序遍历の魔法——像水波纹一样扫描整棵树
     </strong>
    </h2>
    <blockquote>
     <p>
      📅 2025/03/11 || 推荐阅读时间 12分钟
     </p>
    </blockquote>
    <hr/>
    <h3>
     <a id="__8">
     </a>
     🌟 开篇故事
    </h3>
    <p>
     小明用DFS解二叉树的右视图总超时，直到他发现BFS层序遍历就像超市结账时排队——
     <strong>
      先来的顾客先结账，每批结账的顾客正好组成一个层级
     </strong>
     ！今天我们就来揭秘这个波纹扫描术的奥义！
    </p>
    <h4>
     <a id="__12">
     </a>
     🌟 导航图
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/d5f3b0da956d4ec2b699ca8f9e736299.png"/>
    </p>
    <hr/>
    <h3>
     <a id="BFS__19">
     </a>
     一、BFS 核心原理（图解版）
    </h3>
    <h4>
     <a id="11___21">
     </a>
     1.1 队列工作原理 🧩
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/8f8ccb25b9f542e28579432682a53c51.png"/>
    </p>
    <h4>
     <a id="12_DFS_26">
     </a>
     1.2 与DFS的核心差异表
    </h4>
    <table>
     <thead>
      <tr>
       <th>
        特性
       </th>
       <th>
        BFS
       </th>
       <th>
        DFS
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        数据结构
       </td>
       <td>
        队列（Queue）
       </td>
       <td>
        栈（Stack）
       </td>
      </tr>
      <tr>
       <td>
        遍历顺序
       </td>
       <td>
        层级扩散
       </td>
       <td>
        深度优先
       </td>
      </tr>
      <tr>
       <td>
        空间复杂度
       </td>
       <td>
        O(最宽层节点数)
       </td>
       <td>
        O(树的高度)
       </td>
      </tr>
      <tr>
       <td>
        经典应用场景
       </td>
       <td>
        最短路径、层序操作
       </td>
       <td>
        路径遍历、回溯问题
       </td>
      </tr>
      <tr>
       <td>
        力扣经典题
       </td>
       <td>
        <a href="https://leetcode.cn/problems/binary-tree-level-order-traversal/" rel="nofollow">
         102.层序遍历
        </a>
       </td>
       <td>
        <a href="https://leetcode.cn/problems/path-sum-ii/" rel="nofollow">
         113.路径总和II
        </a>
       </td>
      </tr>
     </tbody>
    </table>
    <hr/>
    <h3>
     <a id="3_38">
     </a>
     二、3大变形题型库
    </h3>
    <h4>
     <a id="21__102httpsleetcodecnproblemsbinarytreelevelordertraversal_40">
     </a>
     2.1 基础层序遍历
     <a href="https://leetcode.cn/problems/binary-tree-level-order-traversal/" rel="nofollow">
      🔗力扣102
     </a>
    </h4>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">levelOrder</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> root<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> res<span class="token punctuation">;</span>
  
    <span class="token class-name">Queue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TreeNode</span><span class="token punctuation">&gt;</span></span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 🚀 启动引擎！</span>
  
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>queue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> levelSize <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 📌 重点！必须在此处获取size</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> level <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> levelSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">TreeNode</span> node <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            level<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 🌈 像播种机一样播撒下一层</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>left <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>right <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>level<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 🎁 打包当前层结果</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="22__103httpsleetcodecnproblemsbinarytreezigzaglevelordertraversal_67">
     </a>
     2.2 锯齿形遍历
     <a href="https://leetcode.cn/problems/binary-tree-zigzag-level-order-traversal/" rel="nofollow">
      🔗力扣103
     </a>
    </h4>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">zigzagLevelOrder</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> root<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> res<span class="token punctuation">;</span>
  
    <span class="token keyword">boolean</span> isEvenLevel <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// 🎭 奇偶层标记</span>
    <span class="token class-name">Queue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TreeNode</span><span class="token punctuation">&gt;</span></span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>queue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> size <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> level <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 🪄 魔法发生地！</span>
  
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">TreeNode</span> node <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>isEvenLevel<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                level<span class="token punctuation">.</span><span class="token function">addFirst</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 🔙 偶数层反向插入</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                level<span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ➡️ 奇数层正向插入</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>left <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>right <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>level<span class="token punctuation">)</span><span class="token punctuation">;</span>
        isEvenLevel <span class="token operator">=</span> <span class="token operator">!</span>isEvenLevel<span class="token punctuation">;</span> <span class="token comment">// 🔄 切换标记</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="23__515httpsleetcodecnproblemsfindlargestvalueineachtreerow_99">
     </a>
     2.3 层最大值
     <a href="https://leetcode.cn/problems/find-largest-value-in-each-tree-row/" rel="nofollow">
      🔗力扣515
     </a>
    </h4>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token function">largestValues</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> root<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> res<span class="token punctuation">;</span>
  
    <span class="token class-name">Queue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TreeNode</span><span class="token punctuation">&gt;</span></span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>queue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> size <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> max <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token constant">MIN_VALUE</span><span class="token punctuation">;</span> <span class="token comment">// 🌋 初始化火山口</span>
  
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">TreeNode</span> node <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            max <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>max<span class="token punctuation">,</span> node<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 🏆 实时更新最大值</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>left <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>right <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>max<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 📌 记录本层巅峰值</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <hr/>
    <h3>
     <a id="_127">
     </a>
     三、高频场景避坑指南
    </h3>
    <h4>
     <a id="31__129">
     </a>
     3.1 特殊场景处理表
    </h4>
    <table>
     <thead>
      <tr>
       <th>
        特殊场景
       </th>
       <th>
        易错点
       </th>
       <th>
        解决方案
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        N叉树层序遍历
       </td>
       <td>
        子节点是List结构
       </td>
       <td>
        遍历
        <code>
         children
        </code>
        列表
       </td>
      </tr>
      <tr>
       <td>
        最小深度计算
       </td>
       <td>
        过早返回导致错误
       </td>
       <td>
        遇到
        <strong>
         叶子节点
        </strong>
        才更新结果
       </td>
      </tr>
      <tr>
       <td>
        图结构中的BFS
       </td>
       <td>
        循环引用导致死循环
       </td>
       <td>
        使用
        <code>
         visited
        </code>
        集合标记已访问
       </td>
      </tr>
      <tr>
       <td>
        双向BFS优化
       </td>
       <td>
        两端扩散的终止条件
       </td>
       <td>
        检测到相交元素立即返回
       </td>
      </tr>
     </tbody>
    </table>
    <h4>
     <a id="32__111httpsleetcodecnproblemsminimumdepthofbinarytree_138">
     </a>
     3.2 最小深度问题
     <a href="https://leetcode.cn/problems/minimum-depth-of-binary-tree/" rel="nofollow">
      🔗力扣111
     </a>
    </h4>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">minDepth</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> root<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
  
    <span class="token class-name">Queue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TreeNode</span><span class="token punctuation">&gt;</span></span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> depth <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 🌊 波纹扩散计数器</span>
  
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>queue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        depth<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">// 📈 层级+1</span>
        <span class="token keyword">int</span> size <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">TreeNode</span> node <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 🎯 遇到第一个叶子节点立即返回</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>left <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> node<span class="token punctuation">.</span>right <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> depth<span class="token punctuation">;</span>
  
            <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>left <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>right <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> depth<span class="token punctuation">;</span> <span class="token comment">// 实际不会执行到这里</span>
<span class="token punctuation">}</span>
</code></pre>
    <hr/>
    <h3>
     <a id="BFS_167">
     </a>
     四、可视化进阶：双向BFS动图
    </h3>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/f12faf71e83c486abea6222a43bdc7cb.png">
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/1b15fc154d71432c815ce12339998c69.png"/>
     </img>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/466efb332a6d482f8fd9adfcb69df24f.png"/>
    </p>
    <p>
     <strong>
      适用场景
     </strong>
     ：当起点和终点都明确时（如
     <a href="https://leetcode.cn/problems/word-ladder/" rel="nofollow">
      127.单词接龙
     </a>
     ），时间复杂度从O(b
     <sup>
      d)降到O(b
     </sup>
     (d/2))！
    </p>
    <hr/>
    <h3>
     <a id="__179">
     </a>
     五、知识宇宙扩展站 🚀
    </h3>
    <h4>
     <a id="51_BFS_181">
     </a>
     5.1 BFS变种应用表
    </h4>
    <table>
     <thead>
      <tr>
       <th>
        变种类型
       </th>
       <th>
        核心思想
       </th>
       <th>
        经典题目
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        多源BFS
       </td>
       <td>
        多个起点同时扩散
       </td>
       <td>
        <a href="https://leetcode.cn/problems/rotting-oranges/" rel="nofollow">
         994.腐烂的橘子
        </a>
       </td>
      </tr>
      <tr>
       <td>
        优先队列BFS
       </td>
       <td>
        带权重的最短路径
       </td>
       <td>
        <a href="https://leetcode.cn/problems/cheapest-flights-within-k-stops/" rel="nofollow">
         787.K站中转内最便宜的航班
        </a>
       </td>
      </tr>
      <tr>
       <td>
        跳跃式BFS
       </td>
       <td>
        允许跨层访问
       </td>
       <td>
        <a href="https://leetcode.cn/problems/jump-game-iv/" rel="nofollow">
         1345.跳跃游戏IV
        </a>
       </td>
      </tr>
     </tbody>
    </table>
    <h4>
     <a id="52_BFS__994httpsleetcodecnproblemsrottingoranges_189">
     </a>
     5.2 多源BFS实战 🔥
     <a href="https://leetcode.cn/problems/rotting-oranges/" rel="nofollow">
      🔗力扣994
     </a>
    </h4>
    <pre><code class="prism language-java"><span class="token comment">// 🍊 腐烂橘子同时扩散的魔法！</span>
<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">orangesRotting</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> grid<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Queue</span><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> fresh <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  
    <span class="token comment">// 🌋 初始化：所有腐烂橘子入队</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> grid<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> grid<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>grid<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span>i<span class="token punctuation">,</span> j<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>grid<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> fresh<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  
    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> dirs <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>queue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> fresh <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> size <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> pos <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> d <span class="token operator">:</span> dirs<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">int</span> x <span class="token operator">=</span> pos<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">int</span> y <span class="token operator">=</span> pos<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> d<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> x <span class="token operator">&lt;</span> grid<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> y <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> y <span class="token operator">&lt;</span> grid<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length 
                    <span class="token operator">&amp;&amp;</span> grid<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    grid<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
                    queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span>x<span class="token punctuation">,</span> y<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    fresh<span class="token operator">--</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        time<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">// ⏳ 时间流逝</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> fresh <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> time <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="53_BFS__227">
     </a>
     5.3 带权BFS专题 ⚖️
    </h4>
    <h5>
     <a id="531_BFS__787httpsleetcodecnproblemscheapestflightswithinkstops_229">
     </a>
     5.3.1 优先队列BFS模板 ⚖️
     <a href="https://leetcode.cn/problems/cheapest-flights-within-k-stops/" rel="nofollow">
      🔗力扣787
     </a>
    </h5>
    <pre><code class="prism language-java"><span class="token comment">// ✈️ 像订机票一样找最便宜路径</span>
<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">findCheapestPrice</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> flights<span class="token punctuation">,</span> <span class="token keyword">int</span> src<span class="token punctuation">,</span> <span class="token keyword">int</span> dst<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Map</span><span class="token operator">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span> graph <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> f <span class="token operator">:</span> flights<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        graph<span class="token punctuation">.</span><span class="token function">computeIfAbsent</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> key <span class="token operator">-&gt;</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span>f<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> f<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  
    <span class="token comment">// 优先队列：按价格排序（三元组：当前节点，剩余次数，累计价格）</span>
    <span class="token class-name">PriorityQueue</span><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> pq <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PriorityQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">-</span>b<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pq<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span>src<span class="token punctuation">,</span> k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>pq<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> curr <span class="token operator">=</span> pq<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> node <span class="token operator">=</span> curr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stops <span class="token operator">=</span> curr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> price <span class="token operator">=</span> curr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  
        <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token operator">==</span> dst<span class="token punctuation">)</span> <span class="token keyword">return</span> price<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>stops <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
  
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> neighbor <span class="token operator">:</span> graph<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            pq<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span>neighbor<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stops<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> price <span class="token operator">+</span> neighbor<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h5>
     <a id="532__258">
     </a>
     5.3.2 复杂度对比表
    </h5>
    <table>
     <thead>
      <tr>
       <th>
        算法类型
       </th>
       <th>
        时间复杂度
       </th>
       <th>
        空间复杂度
       </th>
       <th>
        适用场景
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        传统BFS
       </td>
       <td>
        O(n)
       </td>
       <td>
        O(n)
       </td>
       <td>
        无权图最短路径
       </td>
      </tr>
      <tr>
       <td>
        优先队列BFS
       </td>
       <td>
        O(m + n log n)
       </td>
       <td>
        O(n)
       </td>
       <td>
        带权图最优路径
       </td>
      </tr>
      <tr>
       <td>
        双向BFS
       </td>
       <td>
        O(b^(d/2))
       </td>
       <td>
        O(b^(d/2))
       </td>
       <td>
        起点终点明确的场景
       </td>
      </tr>
     </tbody>
    </table>
    <h4>
     <a id="54_BFS__266">
     </a>
     5.4 跳跃式BFS黑科技 🦘
    </h4>
    <h5>
     <a id="541_IV_1345httpsleetcodecnproblemsjumpgameiv_268">
     </a>
     5.4.1 跳跃游戏IV
     <a href="https://leetcode.cn/problems/jump-game-iv/" rel="nofollow">
      🔗力扣1345
     </a>
    </h5>
    <pre><code class="prism language-java"><span class="token comment">// 🎮 像超级玛丽一样跳跃通关！</span>
<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">minJumps</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> valueMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        valueMap<span class="token punctuation">.</span><span class="token function">computeIfAbsent</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> k <span class="token operator">-&gt;</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  
    <span class="token class-name">Queue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">boolean</span><span class="token punctuation">[</span><span class="token punctuation">]</span> visited <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">boolean</span><span class="token punctuation">[</span>arr<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>
    queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    visited<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> steps <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>queue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> size <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">int</span> curr <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>curr <span class="token operator">==</span> arr<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> steps<span class="token punctuation">;</span>
    
            <span class="token comment">// 三种跳法：左跳、右跳、等值跳</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>curr <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>visited<span class="token punctuation">[</span>curr<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                visited<span class="token punctuation">[</span>curr<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>curr<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>curr <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>visited<span class="token punctuation">[</span>curr<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                visited<span class="token punctuation">[</span>curr<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>curr<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>valueMap<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>curr<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> same <span class="token operator">:</span> valueMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>curr<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>visited<span class="token punctuation">[</span>same<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        visited<span class="token punctuation">[</span>same<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                        queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>same<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                valueMap<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>curr<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 🗝️ 关键优化！</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        steps<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h5>
     <a id="542__315">
     </a>
     5.4.2 优化技巧对比
    </h5>
    <table>
     <thead>
      <tr>
       <th>
        优化方法
       </th>
       <th>
        效果提升
       </th>
       <th>
        实现难度
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        哈希预存等值节点
       </td>
       <td>
        减少重复搜索
       </td>
       <td>
        ⭐⭐
       </td>
      </tr>
      <tr>
       <td>
        访问后立即删除键
       </td>
       <td>
        避免重复处理同类节点
       </td>
       <td>
        ⭐⭐⭐
       </td>
      </tr>
      <tr>
       <td>
        方向剪枝
       </td>
       <td>
        优先处理更接近终点的方向
       </td>
       <td>
        ⭐⭐
       </td>
      </tr>
     </tbody>
    </table>
    <hr/>
    <h3>
     <a id="BFS___325">
     </a>
     六、BFS 灵魂十问 💬
    </h3>
    <blockquote>
     <h4>
      <a id="Q1_327">
      </a>
      Q1：如何处理图遍历中的循环引用？
     </h4>
     <p>
      <strong>
       答
      </strong>
      ：使用
      <code>
       visited
      </code>
      集合，像贴封条一样标记已访问节点！
     </p>
    </blockquote>
    <blockquote>
     <h4>
      <a id="Q2BFSDFS_330">
      </a>
      Q2：什么时候必须用BFS不能用DFS？
     </h4>
     <p>
      <strong>
       答
      </strong>
      ：找最短路径时（如迷宫问题），BFS像警犬搜救，DFS像游客瞎逛！
     </p>
    </blockquote>
    <blockquote>
     <h4>
      <a id="Q3LinkedListArrayDeque_333">
      </a>
      Q3：队列实现选LinkedList还是ArrayDeque？
     </h4>
     <p>
      <strong>
       答
      </strong>
      ：99%场景用
      <code>
       ArrayDeque
      </code>
      更高效，但需要头尾操作时用
      <code>
       LinkedList
      </code>
      ！
     </p>
    </blockquote>
    <blockquote>
     <h4>
      <a id="Q4N_336">
      </a>
      Q4：N叉树层序遍历和二叉树有什么区别？
     </h4>
     <p>
      <strong>
       答
      </strong>
      ：遍历子节点时从固定左右子节点变成遍历
      <code>
       children
      </code>
      列表！
     </p>
    </blockquote>
    <blockquote>
     <h4>
      <a id="Q5BFS_339">
      </a>
      Q5：如何判断BFS遍历是否完成？
     </h4>
     <p>
      <strong>
       答
      </strong>
      ：队列空且所有节点处理完毕，就像快递站所有包裹都派送完！
     </p>
    </blockquote>
    <hr/>
    <h3>
     <a id="__344">
     </a>
     六、课后作业大闯关 🏁
    </h3>
    <h4>
     <a id="61__346">
     </a>
     6.1 必做题
    </h4>
    <ul>
     <li>
      <p>
       <a href="https://leetcode.cn/problems/binary-tree-level-order-traversal-ii/" rel="nofollow">
        🔗 107.自底向上层序遍历
       </a>
      </p>
      <p>
       <strong>
        技巧提示
       </strong>
       ：用
       <code>
        LinkedList
       </code>
       的
       <code>
        addFirst
       </code>
       方法或最后反转结果列表
      </p>
     </li>
    </ul>
    <h4>
     <a id="62__352">
     </a>
     6.2 挑战题
    </h4>
    <ul>
     <li>
      <p>
       <a href="https://leetcode.cn/problems/serialize-and-deserialize-binary-tree/" rel="nofollow">
        🔗 297.二叉树的序列化与反序列化
       </a>
      </p>
      <p>
       <strong>
        高阶技巧
       </strong>
       ：层序遍历序列化，空节点用特殊符号标记
      </p>
     </li>
    </ul>
    <h4>
     <a id="63__358">
     </a>
     6.3 基础关：层序遍历变种
    </h4>
    <ul>
     <li>
      <p>
       <a href="https://leetcode.cn/problems/n-ary-tree-level-order-traversal/" rel="nofollow">
        🔗 429.N叉树层序遍历
       </a>
      </p>
      <p>
       <strong>
        通关技巧
       </strong>
       ：把二叉树左右子节点判断改为遍历
       <code>
        children
       </code>
       列表
      </p>
     </li>
    </ul>
    <h4>
     <a id="64_BFS_364">
     </a>
     6.4 进阶关：多维BFS
    </h4>
    <ul>
     <li>
      <p>
       <a href="https://leetcode.cn/problems/01-matrix/" rel="nofollow">
        🔗 542.01矩阵
       </a>
      </p>
      <p>
       <strong>
        破关秘籍
       </strong>
       ：多源BFS，所有0同时作为起点扩散
      </p>
     </li>
    </ul>
    <h4>
     <a id="65_BFS_370">
     </a>
     6.5 终极关：BFS+状态压缩
    </h4>
    <ul>
     <li>
      <p>
       <a href="https://leetcode.cn/problems/shortest-path-visiting-all-nodes/" rel="nofollow">
        🔗 847.访问所有节点的最短路径
       </a>
      </p>
      <p>
       <strong>
        黑科技
       </strong>
       ：用位运算记录已访问节点（如
       <code>
        visited = 1 &lt;&lt; n
       </code>
       ）
      </p>
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="__378">
     </a>
     七、灵魂拷问小剧场 🎭
    </h3>
    <blockquote>
     <p>
      <strong>
       小白
      </strong>
      ：BFS层序遍历的时间复杂度怎么计算？
     </p>
    </blockquote>
    <blockquote>
     <p>
      <strong>
       大佬
      </strong>
      ：每个节点进出队列各一次，时间复杂度是妥妥的
      <strong>
       O(n)
      </strong>
      ！
     </p>
    </blockquote>
    <blockquote>
     <p>
      <strong>
       小白
      </strong>
      ：那空间复杂度呢？
     </p>
    </blockquote>
    <blockquote>
     <p>
      <strong>
       大佬
      </strong>
      ：最差情况是完美二叉树，最后一层有⌈n/2⌉个节点，所以是
      <strong>
       O(n)
      </strong>
      ！
     </p>
    </blockquote>
    <hr/>
    <h3>
     <a id="_390">
     </a>
     八、下期预告
    </h3>
    <p>
     <strong>
      《树的删除操作——像外科手术一样精准移除节点》
     </strong>
     🔥 亮点抢先看：
    </p>
    <ul>
     <li>
      🪓 目标节点的精准定位术
     </li>
     <li>
      🔧 子树重组缝合技巧
     </li>
     <li>
      🩺 AVL树平衡性维护
     </li>
    </ul>
    <hr/>
    <blockquote>
     <p>
      🌟
      <strong>
       算法留言墙
      </strong>
      ：欢迎在评论区留下你的BFS实战故事
     </p>
    </blockquote>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
  <div class="blog-extension-box" id="blogExtensionBox" style="width:400px;margin:auto;margin-top:12px">
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f7778647a756973686175692f:61727469636c652f64657461696c732f313436313631303032" class_="artid" style="display:none">
 </p>
</div>


