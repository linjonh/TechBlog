---
layout: post
title: "PyTorch中的线性变换nn.Parameter-VS-nn.Linear"
date: 2025-03-07 17:15:56 +0800
description: "初始化权重# 初始化偏置# 线性变换：Y = XW + b# 创建自定义线性层# 打印权重和偏置# 输入数据input_data = torch.randn(4, 3) # 4个样本，每个样本有3个特征# 前向传播在这个示例中，我们手动创建了一个自定义的线性层，它使用来定义权重和偏置。在forwardY = XW + b。这个实现与nn.Linear提供的功能类似，但更多地体现了手动管理权重和偏置的方式。nn.Linear另一方面，nn.Linear。"
keywords: "PyTorch中的线性变换：nn.Parameter VS nn.Linear"
categories: ['未分类']
tags: ['线性层', '线性变换', '深度学习', 'Pytorch', 'Python']
artid: "146100109"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146100109
    alt: "PyTorch中的线性变换nn.Parameter-VS-nn.Linear"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146100109
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146100109
cover: https://bing.ee123.net/img/rand?artid=146100109
image: https://bing.ee123.net/img/rand?artid=146100109
img: https://bing.ee123.net/img/rand?artid=146100109
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     PyTorch中的线性变换：nn.Parameter VS nn.Linear
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     <code>
      self.weight = nn.Parameter(torch.randn(in_channels, out_channels))
     </code>
     和
     <code>
      self.linear = nn.Linear(in_channels, out_channels)
     </code>
     并不完全一致，尽管它们都可以用于实现线性变换（即全连接层），但它们的使用方式和内部实现有所不同。
    </p>
    <h4>
     <a id="nnParameter_2">
     </a>
     <code>
      nn.Parameter
     </code>
    </h4>
    <p>
     当手动创建一个
     <code>
      nn.Parameter
     </code>
     时，是在显式地定义权重矩阵，并且需要自己管理这个参数以及它如何参与到计算中。例如：
    </p>
    <pre><code class="prism language-python">self<span class="token punctuation">.</span>weight <span class="token operator">=</span> nn<span class="token punctuation">.</span>Parameter<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>in_channels<span class="token punctuation">,</span> out_channels<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     这里，
     <code>
      self.weight
     </code>
     是一个可学习的参数，可以将其视为模型的一部分，并在前向传播过程中手动与输入进行矩阵乘法运算。假设输入是
     <code>
      x
     </code>
     ，则输出可以这样计算：
    </p>
    <pre><code class="prism language-python">output <span class="token operator">=</span> torch<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>weight<span class="token punctuation">)</span>
</code></pre>
    <p>
     注意这里的数学公式是
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        Y 
        
       
         = 
        
       
         X 
        
       
         W 
        
       
      
        Y = XW
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.2222em;">
          Y
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0785em;">
          X
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1389em;">
          W
         </span>
        </span>
       </span>
      </span>
     </span>
     ，其中
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        X 
        
       
      
        X
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0785em;">
          X
         </span>
        </span>
       </span>
      </span>
     </span>
     是输入矩阵，
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        W 
        
       
      
        W
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1389em;">
          W
         </span>
        </span>
       </span>
      </span>
     </span>
     是权重矩阵。如果还需要加上偏置项
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        b 
        
       
      
        b
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal">
          b
         </span>
        </span>
       </span>
      </span>
     </span>
     ，则变为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        Y 
        
       
         = 
        
       
         X 
        
       
         W 
        
       
         + 
        
       
         b 
        
       
      
        Y = XW + b
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.2222em;">
          Y
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0785em;">
          X
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1389em;">
          W
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal">
          b
         </span>
        </span>
       </span>
      </span>
     </span>
     。在这个例子中，需要另外定义并初始化偏置项
     <code>
      self.bias
     </code>
     。
    </p>
    <h4>
     <a id="_1_17">
     </a>
     示例 1：自定义实现线性层
    </h4>
    <pre><code class="prism language-python"><span class="token keyword">import</span> torch
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn

<span class="token keyword">class</span> <span class="token class-name">CustomLinear</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> in_channels<span class="token punctuation">,</span> out_channels<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>CustomLinear<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 初始化权重</span>
        self<span class="token punctuation">.</span>weight <span class="token operator">=</span> nn<span class="token punctuation">.</span>Parameter<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>in_channels<span class="token punctuation">,</span> out_channels<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment"># 初始化偏置</span>
        self<span class="token punctuation">.</span>bias <span class="token operator">=</span> nn<span class="token punctuation">.</span>Parameter<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>out_channels<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 线性变换：Y = XW + b</span>
        <span class="token keyword">return</span> torch<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>weight<span class="token punctuation">)</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>bias

<span class="token comment"># 创建自定义线性层</span>
custom_linear <span class="token operator">=</span> CustomLinear<span class="token punctuation">(</span>in_channels<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> out_channels<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># 打印权重和偏置</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Weights:"</span><span class="token punctuation">,</span> custom_linear<span class="token punctuation">.</span>weight<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Bias:"</span><span class="token punctuation">,</span> custom_linear<span class="token punctuation">.</span>bias<span class="token punctuation">)</span>

<span class="token comment"># 输入数据</span>
input_data <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment"># 4个样本，每个样本有3个特征</span>

<span class="token comment"># 前向传播</span>
output <span class="token operator">=</span> custom_linear<span class="token punctuation">(</span>input_data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Output:"</span><span class="token punctuation">,</span> output<span class="token punctuation">)</span>
</code></pre>
    <p>
     在这个示例中，我们手动创建了一个自定义的线性层
     <code>
      CustomLinear
     </code>
     ，它使用
     <code>
      nn.Parameter
     </code>
     来定义权重和偏置。在
     <code>
      forward
     </code>
     方法中，我们手动计算线性变换：
     <code>
      Y = XW + b
     </code>
     。这个实现与
     <code>
      nn.Linear
     </code>
     提供的功能类似，但更多地体现了手动管理权重和偏置的方式。
    </p>
    <h4>
     <a id="nnLinear_51">
     </a>
     <code>
      nn.Linear
     </code>
    </h4>
    <p>
     另一方面，
     <code>
      nn.Linear
     </code>
     是 PyTorch 提供的一个封装好的模块，用于执行线性变换。它不仅包含了权重矩阵，还自动处理了偏置项（除非明确设置
     <code>
      bias=False
     </code>
     ）。例如：
    </p>
    <pre><code class="prism language-python">self<span class="token punctuation">.</span>linear <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>in_channels<span class="token punctuation">,</span> out_channels<span class="token punctuation">)</span>
</code></pre>
    <p>
     当调用
     <code>
      self.linear(x)
     </code>
     时，它实际上是在执行以下操作：
    </p>
    <pre><code class="prism language-python">output <span class="token operator">=</span> torch<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>linear<span class="token punctuation">.</span>weight<span class="token punctuation">.</span>t<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>linear<span class="token punctuation">.</span>bias
</code></pre>
    <p>
     这里，
     <code>
      self.linear.weight
     </code>
     的形状是
     <code>
      (out_channels, in_channels)
     </code>
     ，而不是直接
     <code>
      (in_channels, out_channels)
     </code>
     ，因此在进行矩阵乘法之前需要对其转置 (
     <code>
      t()
     </code>
     方法)。这意味着数学公式实际上是
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        Y 
        
       
         = 
        
       
         X 
        
        
        
          W 
         
        
          T 
         
        
       
         + 
        
       
         b 
        
       
      
        Y = XW^T + b
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.2222em;">
          Y
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.9247em; vertical-align: -0.0833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0785em;">
          X
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.1389em;">
           W
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8413em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                 T
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal">
          b
         </span>
        </span>
       </span>
      </span>
     </span>
     ，其中
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        W 
         
        
          T 
         
        
       
      
        W^T
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8413em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.1389em;">
           W
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8413em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                 T
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     表示权重矩阵的转置。
    </p>
    <h4>
     <a id="_2_nnLinear_67">
     </a>
     示例 2：使用
     <code>
      nn.Linear
     </code>
    </h4>
    <pre><code class="prism language-python"><span class="token keyword">import</span> torch
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn

<span class="token comment"># 定义一个线性层</span>
linear_layer <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>in_features<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> out_features<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># 打印权重和偏置</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Weights:"</span><span class="token punctuation">,</span> linear_layer<span class="token punctuation">.</span>weight<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Bias:"</span><span class="token punctuation">,</span> linear_layer<span class="token punctuation">.</span>bias<span class="token punctuation">)</span>

<span class="token comment"># 输入数据</span>
input_data <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment"># 4个样本，每个样本有3个特征</span>

<span class="token comment"># 前向传播</span>
output <span class="token operator">=</span> linear_layer<span class="token punctuation">(</span>input_data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Output:"</span><span class="token punctuation">,</span> output<span class="token punctuation">)</span>
</code></pre>
    <p>
     在这个示例中，我们创建了一个线性层，它接受一个形状为
     <code>
      [4, 3]
     </code>
     的输入数据，并将其映射到一个形状为
     <code>
      [4, 2]
     </code>
     的输出数据。
     <code>
      linear_layer.weight
     </code>
     和
     <code>
      linear_layer.bias
     </code>
     是自动初始化的。
    </p>
    <h4>
     <a id="_90">
     </a>
     数学公式的对比
    </h4>
    <ul>
     <li>
      <p>
       对于手动定义的
       <code>
        nn.Parameter
       </code>
       ，如果输入是
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          X 
          
         
        
          X
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 0.6833em;">
           </span>
           <span class="mord mathnormal" style="margin-right: 0.0785em;">
            X
           </span>
          </span>
         </span>
        </span>
       </span>
       (形状为
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          [ 
          
         
           N 
          
         
           , 
          
         
           i 
          
         
           n 
          
         
           _ 
          
         
           c 
          
         
           h 
          
         
           a 
          
         
           n 
          
         
           n 
          
         
           e 
          
         
           l 
          
         
           s 
          
         
           ] 
          
         
        
          [N, in\_channels]
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 1.06em; vertical-align: -0.31em;">
           </span>
           <span class="mopen">
            [
           </span>
           <span class="mord mathnormal" style="margin-right: 0.109em;">
            N
           </span>
           <span class="mpunct">
            ,
           </span>
           <span class="mspace" style="margin-right: 0.1667em;">
           </span>
           <span class="mord mathnormal">
            in
           </span>
           <span class="mord" style="margin-right: 0.0278em;">
            _
           </span>
           <span class="mord mathnormal">
            c
           </span>
           <span class="mord mathnormal">
            hann
           </span>
           <span class="mord mathnormal">
            e
           </span>
           <span class="mord mathnormal" style="margin-right: 0.0197em;">
            l
           </span>
           <span class="mord mathnormal">
            s
           </span>
           <span class="mclose">
            ]
           </span>
          </span>
         </span>
        </span>
       </span>
       )，权重是
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          W 
          
         
        
          W
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 0.6833em;">
           </span>
           <span class="mord mathnormal" style="margin-right: 0.1389em;">
            W
           </span>
          </span>
         </span>
        </span>
       </span>
       (形状为
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          [ 
          
         
           i 
          
         
           n 
          
         
           _ 
          
         
           c 
          
         
           h 
          
         
           a 
          
         
           n 
          
         
           n 
          
         
           e 
          
         
           l 
          
         
           s 
          
         
           , 
          
         
           o 
          
         
           u 
          
         
           t 
          
         
           _ 
          
         
           c 
          
         
           h 
          
         
           a 
          
         
           n 
          
         
           n 
          
         
           e 
          
         
           l 
          
         
           s 
          
         
           ] 
          
         
        
          [in\_channels, out\_channels]
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 1.06em; vertical-align: -0.31em;">
           </span>
           <span class="mopen">
            [
           </span>
           <span class="mord mathnormal">
            in
           </span>
           <span class="mord" style="margin-right: 0.0278em;">
            _
           </span>
           <span class="mord mathnormal">
            c
           </span>
           <span class="mord mathnormal">
            hann
           </span>
           <span class="mord mathnormal">
            e
           </span>
           <span class="mord mathnormal" style="margin-right: 0.0197em;">
            l
           </span>
           <span class="mord mathnormal">
            s
           </span>
           <span class="mpunct">
            ,
           </span>
           <span class="mspace" style="margin-right: 0.1667em;">
           </span>
           <span class="mord mathnormal">
            o
           </span>
           <span class="mord mathnormal">
            u
           </span>
           <span class="mord mathnormal">
            t
           </span>
           <span class="mord" style="margin-right: 0.0278em;">
            _
           </span>
           <span class="mord mathnormal">
            c
           </span>
           <span class="mord mathnormal">
            hann
           </span>
           <span class="mord mathnormal">
            e
           </span>
           <span class="mord mathnormal" style="margin-right: 0.0197em;">
            l
           </span>
           <span class="mord mathnormal">
            s
           </span>
           <span class="mclose">
            ]
           </span>
          </span>
         </span>
        </span>
       </span>
       )，那么输出
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          Y 
          
         
        
          Y
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 0.6833em;">
           </span>
           <span class="mord mathnormal" style="margin-right: 0.2222em;">
            Y
           </span>
          </span>
         </span>
        </span>
       </span>
       将通过
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          Y 
          
         
           = 
          
         
           X 
          
         
           W 
          
         
        
          Y = XW
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 0.6833em;">
           </span>
           <span class="mord mathnormal" style="margin-right: 0.2222em;">
            Y
           </span>
           <span class="mspace" style="margin-right: 0.2778em;">
           </span>
           <span class="mrel">
            =
           </span>
           <span class="mspace" style="margin-right: 0.2778em;">
           </span>
          </span>
          <span class="base">
           <span class="strut" style="height: 0.6833em;">
           </span>
           <span class="mord mathnormal" style="margin-right: 0.0785em;">
            X
           </span>
           <span class="mord mathnormal" style="margin-right: 0.1389em;">
            W
           </span>
          </span>
         </span>
        </span>
       </span>
       计算。
      </p>
     </li>
     <li>
      <p>
       对于
       <code>
        nn.Linear
       </code>
       ，同样的输入
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          X 
          
         
        
          X
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 0.6833em;">
           </span>
           <span class="mord mathnormal" style="margin-right: 0.0785em;">
            X
           </span>
          </span>
         </span>
        </span>
       </span>
       (形状为
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          [ 
          
         
           N 
          
         
           , 
          
         
           i 
          
         
           n 
          
         
           _ 
          
         
           c 
          
         
           h 
          
         
           a 
          
         
           n 
          
         
           n 
          
         
           e 
          
         
           l 
          
         
           s 
          
         
           ] 
          
         
        
          [N, in\_channels]
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 1.06em; vertical-align: -0.31em;">
           </span>
           <span class="mopen">
            [
           </span>
           <span class="mord mathnormal" style="margin-right: 0.109em;">
            N
           </span>
           <span class="mpunct">
            ,
           </span>
           <span class="mspace" style="margin-right: 0.1667em;">
           </span>
           <span class="mord mathnormal">
            in
           </span>
           <span class="mord" style="margin-right: 0.0278em;">
            _
           </span>
           <span class="mord mathnormal">
            c
           </span>
           <span class="mord mathnormal">
            hann
           </span>
           <span class="mord mathnormal">
            e
           </span>
           <span class="mord mathnormal" style="margin-right: 0.0197em;">
            l
           </span>
           <span class="mord mathnormal">
            s
           </span>
           <span class="mclose">
            ]
           </span>
          </span>
         </span>
        </span>
       </span>
       )，但是权重
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          W 
           
          
            ′ 
           
          
         
        
          W'
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 0.7519em;">
           </span>
           <span class="mord">
            <span class="mord mathnormal" style="margin-right: 0.1389em;">
             W
            </span>
            <span class="msupsub">
             <span class="vlist-t">
              <span class="vlist-r">
               <span class="vlist" style="height: 0.7519em;">
                <span class="" style="top: -3.063em; margin-right: 0.05em;">
                 <span class="pstrut" style="height: 2.7em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mtight">
                   <span class="mord mtight">
                    ′
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
       (形状为
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          [ 
          
         
           o 
          
         
           u 
          
         
           t 
          
         
           _ 
          
         
           c 
          
         
           h 
          
         
           a 
          
         
           n 
          
         
           n 
          
         
           e 
          
         
           l 
          
         
           s 
          
         
           , 
          
         
           i 
          
         
           n 
          
         
           _ 
          
         
           c 
          
         
           h 
          
         
           a 
          
         
           n 
          
         
           n 
          
         
           e 
          
         
           l 
          
         
           s 
          
         
           ] 
          
         
        
          [out\_channels, in\_channels]
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 1.06em; vertical-align: -0.31em;">
           </span>
           <span class="mopen">
            [
           </span>
           <span class="mord mathnormal">
            o
           </span>
           <span class="mord mathnormal">
            u
           </span>
           <span class="mord mathnormal">
            t
           </span>
           <span class="mord" style="margin-right: 0.0278em;">
            _
           </span>
           <span class="mord mathnormal">
            c
           </span>
           <span class="mord mathnormal">
            hann
           </span>
           <span class="mord mathnormal">
            e
           </span>
           <span class="mord mathnormal" style="margin-right: 0.0197em;">
            l
           </span>
           <span class="mord mathnormal">
            s
           </span>
           <span class="mpunct">
            ,
           </span>
           <span class="mspace" style="margin-right: 0.1667em;">
           </span>
           <span class="mord mathnormal">
            in
           </span>
           <span class="mord" style="margin-right: 0.0278em;">
            _
           </span>
           <span class="mord mathnormal">
            c
           </span>
           <span class="mord mathnormal">
            hann
           </span>
           <span class="mord mathnormal">
            e
           </span>
           <span class="mord mathnormal" style="margin-right: 0.0197em;">
            l
           </span>
           <span class="mord mathnormal">
            s
           </span>
           <span class="mclose">
            ]
           </span>
          </span>
         </span>
        </span>
       </span>
       )，输出
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          Y 
          
         
        
          Y
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 0.6833em;">
           </span>
           <span class="mord mathnormal" style="margin-right: 0.2222em;">
            Y
           </span>
          </span>
         </span>
        </span>
       </span>
       将通过
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          Y 
          
         
           = 
          
         
           X 
          
         
           ( 
          
          
          
            W 
           
          
            ′ 
           
          
          
          
            ) 
           
          
            T 
           
          
         
           + 
          
         
           b 
          
         
        
          Y = X(W')^T + b
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 0.6833em;">
           </span>
           <span class="mord mathnormal" style="margin-right: 0.2222em;">
            Y
           </span>
           <span class="mspace" style="margin-right: 0.2778em;">
           </span>
           <span class="mrel">
            =
           </span>
           <span class="mspace" style="margin-right: 0.2778em;">
           </span>
          </span>
          <span class="base">
           <span class="strut" style="height: 1.0913em; vertical-align: -0.25em;">
           </span>
           <span class="mord mathnormal" style="margin-right: 0.0785em;">
            X
           </span>
           <span class="mopen">
            (
           </span>
           <span class="mord">
            <span class="mord mathnormal" style="margin-right: 0.1389em;">
             W
            </span>
            <span class="msupsub">
             <span class="vlist-t">
              <span class="vlist-r">
               <span class="vlist" style="height: 0.7519em;">
                <span class="" style="top: -3.063em; margin-right: 0.05em;">
                 <span class="pstrut" style="height: 2.7em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mtight">
                   <span class="mord mtight">
                    ′
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mclose">
            <span class="mclose">
             )
            </span>
            <span class="msupsub">
             <span class="vlist-t">
              <span class="vlist-r">
               <span class="vlist" style="height: 0.8413em;">
                <span class="" style="top: -3.063em; margin-right: 0.05em;">
                 <span class="pstrut" style="height: 2.7em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                   T
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mspace" style="margin-right: 0.2222em;">
           </span>
           <span class="mbin">
            +
           </span>
           <span class="mspace" style="margin-right: 0.2222em;">
           </span>
          </span>
          <span class="base">
           <span class="strut" style="height: 0.6944em;">
           </span>
           <span class="mord mathnormal">
            b
           </span>
          </span>
         </span>
        </span>
       </span>
       计算。
      </p>
     </li>
    </ul>
    <p>
     从上面可以看出，虽然两者都实现了线性变换，但在
     <code>
      nn.Linear
     </code>
     中，权重矩阵的形状是倒置的，以适应其内部的实现细节。此外，
     <code>
      nn.Linear
     </code>
     还自动处理了偏置项的添加，这使得它比手动定义参数更加方便和简洁。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f35313532343530342f:61727469636c652f64657461696c732f313436313030313039" class_="artid" style="display:none">
 </p>
</div>


