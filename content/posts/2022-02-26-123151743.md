---
layout: post
title: "vlantrunk基础知识三层交换机实现不同vlan通信实验"
date: 2022-02-26 17:32:33 +0800
description: "vlan是什么-为什么要用vlan-vlan的作用-vlan的基本知识-如何实现交换机之间的vlan"
keywords: "三层交换机trunk"
categories: ['计算机网络']
tags: ['运维', '计算机网络', '交换机', 'Tcp', 'Cisco']
artid: "123151743"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=123151743
    alt: "vlantrunk基础知识三层交换机实现不同vlan通信实验"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=123151743
featuredImagePreview: https://bing.ee123.net/img/rand?artid=123151743
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     vlan、trunk基础知识—三层交换机实现不同vlan通信实验
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p id="main-toc">
     <strong>
      目录
     </strong>
    </p>
    <p id="vlan%E6%98%AF%E4%BB%80%E4%B9%88-toc" style="margin-left:0px;">
     <a href="#vlan%E6%98%AF%E4%BB%80%E4%B9%88" rel="nofollow">
      vlan是什么
     </a>
    </p>
    <p id="%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E7%94%A8vlan-toc" style="margin-left:40px;">
     <a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E7%94%A8vlan" rel="nofollow">
      为什么要用vlan
     </a>
    </p>
    <p id="vlan%E7%9A%84%E4%BD%9C%E7%94%A8-toc" style="margin-left:40px;">
     <a href="#vlan%E7%9A%84%E4%BD%9C%E7%94%A8" rel="nofollow">
      vlan的作用
     </a>
    </p>
    <p id="vlan%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86-toc" style="margin-left:40px;">
     <a href="#vlan%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86" rel="nofollow">
      vlan的基本知识
     </a>
    </p>
    <p id="%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E4%BA%A4%E6%8D%A2%E6%9C%BA%E4%B9%8B%E9%97%B4%E7%9A%84vlan%E9%80%9A%E4%BF%A1-toc" style="margin-left:40px;">
     <a href="#%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E4%BA%A4%E6%8D%A2%E6%9C%BA%E4%B9%8B%E9%97%B4%E7%9A%84vlan%E9%80%9A%E4%BF%A1" rel="nofollow">
      如何实现交换机之间的vlan通信
     </a>
    </p>
    <p id="vlan%E5%B8%A7%E6%A0%BC%E5%BC%8F%E7%9A%84%E5%AD%97%E6%AE%B5%E8%A7%A3%E9%87%8A-toc" style="margin-left:80px;">
     <a href="#vlan%E5%B8%A7%E6%A0%BC%E5%BC%8F%E7%9A%84%E5%AD%97%E6%AE%B5%E8%A7%A3%E9%87%8A" rel="nofollow">
      vlan帧格式的字段解释
     </a>
    </p>
    <p id="vlan%20ID%E7%9A%84%E7%B1%BB%E5%9E%8B%E5%92%8C%E8%8C%83%E5%9B%B4-toc" style="margin-left:80px;">
     <a href="#vlan%20ID%E7%9A%84%E7%B1%BB%E5%9E%8B%E5%92%8C%E8%8C%83%E5%9B%B4" rel="nofollow">
      vlan ID的类型和范围
     </a>
    </p>
    <p id="Trunk%E7%9A%84%E6%A8%A1%E5%BC%8F-toc" style="margin-left:40px;">
     <a href="#Trunk%E7%9A%84%E6%A8%A1%E5%BC%8F" rel="nofollow">
      Trunk的模式
     </a>
    </p>
    <p id="Trunk%E7%9A%84%E6%A8%A1%E5%BC%8F%E5%8D%8F%E5%95%86%E7%BB%93%E6%9E%9C-toc" style="margin-left:80px;">
     <a href="#Trunk%E7%9A%84%E6%A8%A1%E5%BC%8F%E5%8D%8F%E5%95%86%E7%BB%93%E6%9E%9C" rel="nofollow">
      Trunk的模式协商结果
     </a>
    </p>
    <p id="%E4%B8%89%E5%B1%82%E4%BA%A4%E6%8D%A2%E6%9C%BA-toc" style="margin-left:40px;">
     <a href="#%E4%B8%89%E5%B1%82%E4%BA%A4%E6%8D%A2%E6%9C%BA" rel="nofollow">
      三层交换机
     </a>
    </p>
    <p id="%E4%B8%89%E5%B1%82%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%92%8C%E8%B7%AF%E7%94%B1%E5%99%A8%E7%9A%84%E5%8C%BA%E5%88%AB-toc" style="margin-left:80px;">
     <a href="#%E4%B8%89%E5%B1%82%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%92%8C%E8%B7%AF%E7%94%B1%E5%99%A8%E7%9A%84%E5%8C%BA%E5%88%AB" rel="nofollow">
      三层交换机和路由器的区别
     </a>
    </p>
    <hr id="hr-toc"/>
    <p>
    </p>
    <h2 id="vlan%E6%98%AF%E4%BB%80%E4%B9%88">
     <span style="color:#2e75b5;">
      vlan是什么
     </span>
    </h2>
    <p>
     VLAN（Virtual Local Area Network）即虚拟局域网，是将一个物理的LAN在逻辑上划分成多个广播域的通信技术。一组VLAN是一组逻辑上的设备和用户，这些设备和用户并不受物理位置的限制，可以根据功能、部门及应用等因素将它们组织起来，相互之间的通信就好像它们在同一个网段中一样，由此得名虚拟局域网。
    </p>
    <h3 id="%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E7%94%A8vlan">
     <span style="color:#2e75b5;">
      为什么要用vlan
     </span>
    </h3>
    <p>
     如下图所示，PC18想要和PC16通信，这但交换机不知道PC16的目的mac，必须先广播arp请求来获取PC16的mac地址，因为仅有一个广播域，交换机发送的arp请求会传给网络中的
     <strong>
      每一台主机
     </strong>
     ，不仅在广播信息的时候消耗了网络整体的带宽，收到广播信息的计算机还要消耗一部分CPU时间来对它进行处理。造成了网络带宽和CPU运算能力的大量
     <strong>
      无谓消耗
     </strong>
     。
    </p>
    <p>
     <img alt="" height="327" src="https://i-blog.csdnimg.cn/blog_migrate/438673bb8a47007260b27c52f9909932.png" width="687"/>
    </p>
    <p>
     上图只是一个小型网络，如果我们将其联想为一整个公司，公司会有许多不同的部门，部门下有很多员工，如果它们是在一个广播域中，两个机器想要建立通信，如果广播帧传播到网络中的每一台主机，将会对每一台计算机造成极大的网络资源消耗。
    </p>
    <h3 id="vlan%E7%9A%84%E4%BD%9C%E7%94%A8">
     <span style="color:#2e75b5;">
      vlan的作用
     </span>
    </h3>
    <ul>
     <li>
      限制广播域，
      <span style="color:#0d0016;">
       一个vlan就是一个广播域，广播不能扩散到其他的vlan里，只能在自己的vlan里传播
      </span>
      ，减少网络资源消耗
     </li>
     <li>
      <span style="color:#0d0016;">
       一个vlan就是一个网段，这样跨网段通信就必须要经过路由器，就可以阻止连在一个交换机(二层)上的机器传播病毒，能起到一定的安全性
      </span>
     </li>
    </ul>
    <h3 id="vlan%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86">
     <span style="color:#2e75b5;">
      vlan的基本知识
     </span>
    </h3>
    <ul>
     <li>
      <span style="color:#0d0016;">
       相同网段但是不是同一个vlan也是不能通信的 --&gt; 不同vlan之间不能通信，
      </span>
     </li>
     <li>
      <span style="color:#0d0016;">
       同一个vlan不同网段也不能通信，因为跨网端通信必须要经过路由器
      </span>
     </li>
    </ul>
    <h3 id="%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E4%BA%A4%E6%8D%A2%E6%9C%BA%E4%B9%8B%E9%97%B4%E7%9A%84vlan%E9%80%9A%E4%BF%A1">
     <span style="color:#2e75b5;">
      如何实现交换机之间的vlan通信
     </span>
    </h3>
    <p>
     <span style="color:#0d0016;">
      交换机给往其他交换机的数据帧打上vlan标识
     </span>
    </p>
    <p>
     <img alt="" height="522" src="https://i-blog.csdnimg.cn/blog_migrate/299833085fc14ceba434426df08fcdf7.png" width="1200"/>
    </p>
    <p>
     在以太网上实现中继，有
     <strong>
      两种封装类型
     </strong>
    </p>
    <ul>
     <li>
      ISL（Cisco私有标准）
      <ul>
       <li>
        ISL帧格式
       </li>
      </ul>
     </li>
    </ul>
    <p>
     <img alt="" height="246" src="https://i-blog.csdnimg.cn/blog_migrate/8291983ac6a6eef09bb111baeb15ae26.png" width="1200"/>
    </p>
    <ul>
     <li>
      IEEE 802.1q
      <ul>
       <li>
        工作原理 --&gt; 插入四字节带有Vlan标识的Vlan标签，设备利用标签中的VID来识别帧所属于的VLAN。
       </li>
      </ul>
     </li>
    </ul>
    <p>
     <img alt="" height="344" src="https://i-blog.csdnimg.cn/blog_migrate/34d71a30bed55929d38c68c8ce440bc5.png" width="1200"/>
    </p>
    <ul>
     <li>
      帧的格式
      <img alt="" height="281" src="https://i-blog.csdnimg.cn/blog_migrate/a8a5190f7a6ba58c6ce306f129229c59.png" width="698"/>
     </li>
    </ul>
    <h4 id="vlan%E5%B8%A7%E6%A0%BC%E5%BC%8F%E7%9A%84%E5%AD%97%E6%AE%B5%E8%A7%A3%E9%87%8A">
     <span style="color:#2e75b5;">
      vlan帧格式的字段解释
     </span>
    </h4>
    <div>
     <table cellspacing="0">
      <tbody>
       <tr>
        <td style="background-color:#4bacc6;border-color:#a3a3a3;vertical-align:top;width:1.9527in;">
         <p style="margin-left:0;text-align:center;">
          <span style="color:#ffffff;">
           字段
          </span>
         </p>
        </td>
        <td style="background-color:#4bacc6;border-color:#a3a3a3;vertical-align:top;width:66px;">
         <p style="margin-left:0;text-align:center;">
          <span style="color:#ffffff;">
           长度
          </span>
         </p>
        </td>
        <td style="background-color:#4bacc6;border-color:#a3a3a3;vertical-align:top;width:450px;">
         <p style="margin-left:0;text-align:center;">
          <span style="color:#ffffff;">
           含义
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td style="border-color:#a3a3a3;vertical-align:top;width:1.9722in;">
         <p style="margin-left:0;">
          <span style="color:#000000;">
           Destination address  DA
          </span>
         </p>
        </td>
        <td style="border-color:#a3a3a3;vertical-align:top;width:66px;">
         <p style="margin-left:0;">
          <span style="color:#000000;">
           6字节
          </span>
         </p>
        </td>
        <td style="border-color:#a3a3a3;vertical-align:top;width:450px;">
         <p style="margin-left:0;">
          <span style="color:#000000;">
           目的MAC地址。
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td style="border-color:#a3a3a3;vertical-align:top;width:1.9527in;">
         <p style="margin-left:0;">
          <span style="color:#000000;">
           Source address SA
          </span>
         </p>
        </td>
        <td style="border-color:#a3a3a3;vertical-align:top;width:66px;">
         <p style="margin-left:0;">
          <span style="color:#000000;">
           6字节
          </span>
         </p>
        </td>
        <td style="border-color:#a3a3a3;vertical-align:top;width:450px;">
         <p style="margin-left:0;">
          <span style="color:#000000;">
           源MAC地址。
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td style="border-color:#a3a3a3;vertical-align:top;width:1.9527in;">
         <p style="margin-left:0;">
          <span style="color:#000000;">
           Type
          </span>
         </p>
        </td>
        <td style="border-color:#a3a3a3;vertical-align:top;width:66px;">
         <p style="margin-left:0;">
          <span style="color:#000000;">
           2字节
          </span>
         </p>
        </td>
        <td style="border-color:#a3a3a3;vertical-align:top;width:450px;">
         <p style="margin-left:0;">
          <span style="color:#000000;">
           长度为2字节，表示帧类型。取值为0x8100时表示802.1Q Tag帧。
          </span>
         </p>
         <p style="margin-left:0;">
          <span style="color:#000000;">
           如果不支持802.1Q的设备收到这样的帧，会将其丢弃。
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td style="border-color:#a3a3a3;vertical-align:top;width:1.9527in;">
         <p style="margin-left:0;">
          <span style="color:#000000;">
           Priority
          </span>
         </p>
        </td>
        <td style="border-color:#a3a3a3;vertical-align:top;width:66px;">
         <p style="margin-left:0;">
          <span style="color:#000000;">
           3比特
          </span>
         </p>
        </td>
        <td style="border-color:#a3a3a3;vertical-align:top;width:450px;">
         <p style="margin-left:0;">
          <span style="color:#000000;">
           长度为3比特，表示帧的优先级，取值范围为0～7，值越大优先级越高。用于当阻塞时，优先发送优先级高的数据包。
          </span>
         </p>
         <p style="margin-left:0;">
          <span style="color:#000000;">
           如果设置用户优先级，但是没有VLAN ID，则VLAN ID必须设置为0x000。
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td style="border-color:#a3a3a3;vertical-align:top;width:1.9527in;">
         <p style="margin-left:0;">
          <span style="color:#000000;">
           Canonical Format Indicator，CFI
          </span>
         </p>
        </td>
        <td style="border-color:#a3a3a3;vertical-align:top;width:66px;">
         <p style="margin-left:0;">
          <span style="color:#000000;">
           1比特
          </span>
         </p>
        </td>
        <td style="border-color:#a3a3a3;vertical-align:top;width:450px;">
         <p style="margin-left:0;">
          <span style="color:#000000;">
           长度为1比特，表示MAC地址是否是经典格式。CFI为0说明是标准格式，CFI为1表示为非标准格式。用于区分以太网帧、FDDI（Fiber Distributed Digital Interface）帧和令牌环网帧。在以太网中，CFI的值为0。
          </span>
         </p>
        </td>
       </tr>
       <tr>
        <td style="border-color:#a3a3a3;vertical-align:top;width:1.9527in;">
         VLAN ID
        </td>
        <td style="border-color:#a3a3a3;vertical-align:top;width:66px;">
         12比特
        </td>
        <td style="border-color:#a3a3a3;vertical-align:top;width:450px;">
         表示改帧所属的VLAN。在VRP中，可配置的VLAN ID取值范围为1～4094。0和4095协议中规定为保留的VLAN ID。
        </td>
       </tr>
      </tbody>
     </table>
    </div>
    <h4 id="vlan%20ID%E7%9A%84%E7%B1%BB%E5%9E%8B%E5%92%8C%E8%8C%83%E5%9B%B4">
     <span style="color:#2e75b5;">
      vlan ID的类型和范围
     </span>
    </h4>
    <p>
     三种类型：
    </p>
    <ul>
     <li>
      Untagged帧：无四字节VLAN标签的帧
     </li>
     <li>
      Priority-tagged帧：VID为 0x000
     </li>
     <li>
      VLAN-tagged帧：有VLAN标签的帧，VID范围0～4095
     </li>
    </ul>
    <p>
     三个特殊的VID：
    </p>
    <ul>
     <li>
      0x000：设置优先级但无VID
     </li>
     <li>
      0x001：缺省VID
     </li>
     <li>
      0xFFF：预留VID
     </li>
    </ul>
    <ul>
     <li>
      <div>
       <table cellspacing="0">
        <tbody>
         <tr>
          <td style="background-color:#4bacc6;border-color:#a3a3a3;vertical-align:top;width:1.1576in;">
           <p style="margin-left:0;text-align:center;">
            <span style="color:#ffffff;">
             VLAN ID范围
            </span>
           </p>
          </td>
          <td style="background-color:#4bacc6;border-color:#a3a3a3;vertical-align:top;width:.6673in;">
           <p style="margin-left:0;text-align:center;">
            <span style="color:#ffffff;">
             范围
            </span>
           </p>
          </td>
          <td style="background-color:#4bacc6;border-color:#a3a3a3;vertical-align:top;width:4.059in;">
           <p style="margin-left:0;text-align:center;">
            <span style="color:#ffffff;">
             用途
            </span>
           </p>
          </td>
         </tr>
         <tr>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.1381in;">
           <p style="margin-left:0;text-align:center;">
            <span style="color:#000000;">
             0，4095
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:.6673in;">
           <p style="margin-left:0;text-align:center;">
            <span style="color:#000000;">
             保留
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:4.059in;">
           <p style="margin-left:0;text-align:center;">
            <span style="color:#000000;">
             仅限系统使用
            </span>
           </p>
           <p style="margin-left:0;text-align:center;">
            <span style="color:#000000;">
             用户不能查看和使用这些VLAN
            </span>
           </p>
          </td>
         </tr>
         <tr>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.1381in;">
           <p style="margin-left:0;text-align:center;">
            <span style="color:#000000;">
             1
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:.6673in;">
           <p style="margin-left:0;text-align:center;">
            <span style="color:#000000;">
             正常
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:4.059in;">
           <p style="margin-left:0;text-align:center;">
            <span style="color:#000000;">
             Cisco默认VLAN
            </span>
           </p>
           <p style="margin-left:0;text-align:center;">
            <span style="color:#000000;">
             用户能够使用该VLAN，但不能删除它
            </span>
           </p>
          </td>
         </tr>
         <tr>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.1381in;">
           <p style="margin-left:0;text-align:center;">
            <span style="color:#000000;">
             2-1001
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:.6673in;">
           <p style="margin-left:0;text-align:center;">
            <span style="color:#000000;">
             正常
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:4.059in;">
           <p style="margin-left:0;text-align:center;">
            <span style="color:#000000;">
             用于以太网的VLAN
            </span>
           </p>
           <p style="margin-left:0;text-align:center;">
            <span style="color:#000000;">
             用户可以创建、使用和删除这些VLAN
            </span>
           </p>
          </td>
         </tr>
         <tr>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.1381in;">
           <p style="margin-left:0;text-align:center;">
            <span style="color:#000000;">
             1002-1005
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:.6673in;">
           <p style="margin-left:0;text-align:center;">
            <span style="color:#000000;">
             正常
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:4.059in;">
           <p style="margin-left:0;text-align:center;">
            <span style="color:#000000;">
             用于FDDI和令牌环的Cisco默认VLAN
            </span>
           </p>
           <p style="margin-left:0;text-align:center;">
            <span style="color:#000000;">
             用户不能删除这些VLAN
            </span>
           </p>
          </td>
         </tr>
         <tr>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.1381in;">
           <p style="margin-left:0;text-align:center;">
            <span style="color:#000000;">
             1006-1024
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:.6673in;">
           <p style="margin-left:0;text-align:center;">
            <span style="color:#000000;">
             保留
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:4.059in;">
           <p style="margin-left:0;text-align:center;">
            <span style="color:#000000;">
             仅限系统使用
            </span>
           </p>
           <p style="margin-left:0;text-align:center;">
            <span style="color:#000000;">
             用户不能查看和使用这些VLAN
            </span>
           </p>
          </td>
         </tr>
         <tr>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.1381in;">
           <p style="margin-left:0;text-align:center;">
            <span style="color:#000000;">
             1025-4094
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:.6673in;">
           <p style="margin-left:0;text-align:center;">
            <span style="color:#000000;">
             扩展
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:4.059in;">
           <p style="margin-left:0;text-align:center;">
            <span style="color:#000000;">
             仅用于以太网VLAN
            </span>
           </p>
          </td>
         </tr>
        </tbody>
       </table>
      </div>
     </li>
    </ul>
    <p>
     上图的中继链路又称
     <strong>
      Trunk链路
     </strong>
     ：允许
     <strong>
      所有的vlan数据在
     </strong>
     这条链路上传播
    </p>
    <h3 id="Trunk%E7%9A%84%E6%A8%A1%E5%BC%8F" style="margin-left:0px;">
     <span style="color:#2e75b5;">
      Trunk的模式
     </span>
    </h3>
    <ul>
     <li>
      接入（Access）
     </li>
     <li>
      干道（Trunk）
     </li>
     <li>
      动态企望（Dynamic desirable）
     </li>
     <li>
      动态自动（Dynamic auto）
     </li>
     <li>
      非协商（Nonegotiate）
     </li>
    </ul>
    <p>
     如果要实现不同vlan之间的通信，两个交换机相连的端口要设置为Trunk模式。
    </p>
    <p>
     可以做如下实验，让PC17和PC18能互相ping通；PC16和PC19能互相ping通即可
    </p>
    <p>
     <img alt="" height="346" src="https://i-blog.csdnimg.cn/blog_migrate/d6589890dc9fea2310c246ec98045194.png" width="787"/>
    </p>
    <h4 id="Trunk%E7%9A%84%E6%A8%A1%E5%BC%8F%E5%8D%8F%E5%95%86%E7%BB%93%E6%9E%9C" style="margin-left:0px;">
     <span style="color:#2e75b5;">
      Trunk的模式协商结果
     </span>
    </h4>
    <ul>
     <li>
      <div>
       <table cellspacing="0">
        <tbody>
         <tr>
          <td style="background-color:#48afc6;border-color:#a3a3a3;vertical-align:top;width:1.634in;">
           <p style="margin-left:0;">
            <span style="color:#ffffff;">
             SW1端口模式
            </span>
           </p>
          </td>
          <td style="background-color:#48afc6;border-color:#a3a3a3;vertical-align:top;width:1.5284in;">
           <p style="margin-left:0;">
            <span style="color:#ffffff;">
             SW2端口模式
            </span>
           </p>
          </td>
          <td style="background-color:#48afc6;border-color:#a3a3a3;vertical-align:top;width:1.0666in;">
           <p style="margin-left:0;">
            <span style="color:#ffffff;">
             SW1结果
            </span>
           </p>
          </td>
          <td style="background-color:#48afc6;border-color:#a3a3a3;vertical-align:top;width:1.1972in;">
           <p style="margin-left:0;">
            <span style="color:#ffffff;">
             SW2结果
            </span>
           </p>
          </td>
         </tr>
         <tr>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.634in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             trunk
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.5284in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             dynamic auto
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.0666in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             trunk
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.1972in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             trunk
            </span>
           </p>
          </td>
         </tr>
         <tr>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.634in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             trunk
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.5479in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             dynamic desirable
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.0666in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             trunk
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.1777in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             trunk
            </span>
           </p>
          </td>
         </tr>
         <tr>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.634in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             dynamic auto
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.5284in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             dynamic auto
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.0666in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             access
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.1972in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             access
            </span>
           </p>
          </td>
         </tr>
         <tr>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.634in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             dynamic auto
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.5479in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             dynamic desirable
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.0666in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             trunk
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.1777in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             trunk
            </span>
           </p>
          </td>
         </tr>
         <tr>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.634in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             dynamic desirable
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.5479in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             dynamic desirable
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.0666in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             trunk
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.1777in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             trunk
            </span>
           </p>
          </td>
         </tr>
         <tr>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.6534in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             trunk、nonegotiate
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.5284in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             trunk
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.0666in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             trunk
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.1777in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             trunk
            </span>
           </p>
          </td>
         </tr>
         <tr>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.6534in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             trunk、nonegotiate
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.5284in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             dynamic auto
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.0666in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             trunk
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.1777in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             access
            </span>
           </p>
          </td>
         </tr>
         <tr>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.6534in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             trunk、nonegotiate
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.5479in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             dynamic desirable
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.0666in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             trunk
            </span>
           </p>
          </td>
          <td style="border-color:#a3a3a3;vertical-align:top;width:1.1583in;">
           <p style="margin-left:0;">
            <span style="color:#000000;">
             access
            </span>
           </p>
          </td>
         </tr>
        </tbody>
       </table>
      </div>
     </li>
    </ul>
    <h3 id="%E4%B8%89%E5%B1%82%E4%BA%A4%E6%8D%A2%E6%9C%BA">
     <span style="color:#2e75b5;">
      三层交换机
     </span>
    </h3>
    <ul>
     <li>
      具有路由功能的交换机
     </li>
     <li>
      可以让
      <strong>
       不同vlan不同网段之间进行通信，实现多个vlan之间的通信
      </strong>
     </li>
     <li>
      三层交换机vlan间通信的转发过程
      <img alt="" height="745" src="https://i-blog.csdnimg.cn/blog_migrate/1c53404ef74760bea03865fcae6f90fc.png" width="951"/>
     </li>
    </ul>
    <p>
     用Cisco Packet Tracer做实验，实验配置如下
    </p>
    <p>
     <img alt="" height="491" src="https://i-blog.csdnimg.cn/blog_migrate/7a6bc78d6b4fe5c686192cc953627155.png" width="1001">
      1.pc机上配置ip地址
      <br/>
      2.在交换机上创建vlan，接口加入vlan
      <br/>
      3.配置trunk链路；二层和三层交换机都要配置
      <br/>
      4.在三层交换机上创建vlan，然后给vlan配置ip，启动路由功能
      <br/>
      5.测试网络是否通畅
     </img>
    </p>
    <p>
     下面具体讲解三层交换机中命令行的配置
    </p>
    <div>
     <table cellspacing="0">
      <tbody>
       <tr>
        <td style="background-color:#000000;border-color:#a3a3a3;vertical-align:top;width:6.5104in;">
         <p>
          <span style="color:#ffffff;">
           在三层交换机中：从CIL命令行中进入 config 配置模式
          </span>
         </p>
         <p>
          <img alt="" height="165" src="https://i-blog.csdnimg.cn/blog_migrate/3d2e9b7c9fd80e417846fd7721b6d712.png" width="691"/>
         </p>
         <p>
          <span style="color:#ffffff;">
           Switch&gt;enable  en --&gt; 特权模式
          </span>
         </p>
         <p>
          <span style="color:#ffffff;">
           Switch#conf t    配置模式
          </span>
         </p>
         <p>
          <span style="color:#ffffff;">
           Enter configuration commands，one per line.        End with CMTL/Z.
          </span>
         </p>
         <p>
          <span style="color:#ffffff;">
           Switch(config)#ip routing
          </span>
          <span style="color:#fe2c24;">
           在配置模式中开启路由功能
          </span>
         </p>
         <p style="margin-left:0;">
          <span style="color:#ffffff;">
           Switch(config)#interface vlan 10  进入vlan10的接口模式
          </span>
         </p>
         <p style="margin-left:0;">
          <span style="color:#ffffff;">
          </span>
         </p>
         <p style="margin-left:0;">
          <span style="color:#ffffff;">
           %LINK-5-CHANGED: Interface Vlan10, changed state to up
          </span>
         </p>
         <p style="margin-left:0;">
          <span style="color:#ffffff;">
          </span>
         </p>
         <p style="margin-left:0;">
          <span style="color:#ffffff;">
           %LINEPROTO-5-UPDOWN: Line protocol on Interface Vlan10, changed state to up
          </span>
         </p>
         <p style="margin-left:0;">
          <span style="color:#ffffff;">
           # 给接口配置IP地址和子网掩码
          </span>
         </p>
         <p style="margin-left:0;">
          <span style="color:#ffffff;">
           Switch(config-if)#ip address  192.168.10.254 255.255.255.0
          </span>
         </p>
         <p style="margin-left:0;">
          <span style="color:#ffffff;">
           Switch(config-if)#no shutdown  激活接口
          </span>
         </p>
         <p style="margin-left:0;">
          <span style="color:#ffffff;">
           Switch(config-if)#exit  退出
          </span>
         </p>
         <p style="margin-left:0;">
          <span style="color:#ffffff;">
           Switch(config)#interface vlan 20  进入vlan20的接口模式
          </span>
         </p>
         <p style="margin-left:0;">
          <span style="color:#ffffff;">
          </span>
         </p>
         <p style="margin-left:0;">
          <span style="color:#ffffff;">
           %LINK-5-CHANGED: Interface Vlan20, changed state to up
          </span>
         </p>
         <p style="margin-left:0;">
          <span style="color:#ffffff;">
          </span>
         </p>
         <p style="margin-left:0;">
          <span style="color:#ffffff;">
           %LINEPROTO-5-UPDOWN: Line protocol on Interface Vlan20, changed state to up
          </span>
         </p>
         <p style="margin-left:0;">
          <span style="color:#ffffff;">
           # 给vlan20接口配置IP地址和子网掩码
          </span>
         </p>
         <p style="margin-left:0;">
          <span style="color:#ffffff;">
           Switch(config-if)#
          </span>
          <span style="color:#fe2c24;">
           ip address  192.168.20.254 255.255.255.0
          </span>
         </p>
         <p style="margin-left:0;">
          <span style="color:#ffffff;">
           Switch(config-if)#no shut
          </span>
         </p>
         <p style="margin-left:0;">
          <span style="color:#ffffff;">
           Switch#
          </span>
          <span style="color:#fe2c24;">
           show ip route
          </span>
          <span style="color:#ffffff;">
           进入特权模式 查看路由表
          </span>
         </p>
         <p style="margin-left:0;">
          <span style="color:#ffffff;">
          </span>
         </p>
         <p style="margin-left:0;">
          <span style="color:#ffffff;">
           C    192.168.10.0/24 is directly connected, Vlan10
          </span>
         </p>
         <p style="margin-left:0;">
          <span style="color:#ffffff;">
           C    192.168.20.0/24 is directly connected, Vlan20
          </span>
         </p>
         <p>
         </p>
         <p>
          <span style="color:#ffffff;">
           Switch&gt;show run  查看整个交换机的配置
          </span>
         </p>
         <p>
          <img alt="" height="247" src="https://i-blog.csdnimg.cn/blog_migrate/b2726722af9e198675595526283a3047.png" width="463"/>
         </p>
         <p>
          <span style="color:#ffffff;">
           Switch&gt;en
          </span>
         </p>
         <p>
          <span style="color:#ffffff;">
           Switch#show vlan brief  查看vlan划分
          </span>
         </p>
         <p>
          <img alt="" height="362" src="https://i-blog.csdnimg.cn/blog_migrate/13936ddb445ab69854e9fec785b979df.png" width="868"/>
         </p>
        </td>
       </tr>
      </tbody>
     </table>
    </div>
    <p>
     最后，使用PC20能ping通PC21的话，不同vlan且不同网段通过三层交换机就通信成功了。
    </p>
    <h4 id="%E4%B8%89%E5%B1%82%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%92%8C%E8%B7%AF%E7%94%B1%E5%99%A8%E7%9A%84%E5%8C%BA%E5%88%AB">
     <span style="color:#2e75b5;">
      三层交换机和路由器的区别
     </span>
    </h4>
    <ul>
     <li>
      三层交换机的接口多 --&gt; 公司的内部有很多的网段需要互相之间联通
      <ul>
       <li>
        一个网段接一个路由器的接口
       </li>
      </ul>
     </li>
     <li>
      路由器的接口可以配置IP地址；交换机的接口不配置IP地址的
     </li>
     <li>
      三层交换机可以给vlan配置IP，也可以给接口配置IP；路由器只可以给接口配置IP
     </li>
     <li>
      在不同网段之间通信的时候，速度更加快  --&gt; 用到了二层硬件上的转发，专门的硬件和芯片
     </li>
    </ul>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f35373035333332362f:61727469636c652f64657461696c732f313233313531373433" class_="artid" style="display:none">
 </p>
</div>


