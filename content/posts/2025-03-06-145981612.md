---
layout: post
title: "2025.3.9æœºå™¨å­¦ä¹ ç¬”è®°æ–‡çŒ®é˜…è¯»"
date: 2025-03-06 21:42:07 +0800
description: "æ´ªæ°´æ¯å¹´å¯¹å…¨ä¸–ç•Œé€ æˆäº†å·¨å¤§çš„æŸå¤±ï¼Œæœ‰æ•ˆçš„æ´ªæ°´é¢„è­¦æ˜¯é‡è¦é˜²æ´ªæ–¹å¼ï¼Œä½†æ˜¯ç°æœ‰æ´ªæ°´é¢„æµ‹æ–¹æ³•å¹¶ä¸å¯é ï¼Œæ¯”å¦‚ï¼Œä¼ ç»Ÿçš„ç‰©ç†è®¡ç®—æ–¹æ³•å’Œæ•°æ®é©±åŠ¨æ¨¡å‹éœ€å¤§é‡æ°´æ–‡å’Œåœ°è²Œæ•°æ®ï¼Œåˆå› ä¸ºæç«¯æ´ªæ°´äº‹ä»¶è§‚æµ‹æ•°æ®æœ‰é™ï¼Œè¿™ä¼šå¯¼è‡´æ¨¡å‹çš„é¢„æµ‹ä¸å‡†ç¡®ã€‚æœ¬è®ºæ–‡åŸºäºæ—¶é—´åºåˆ—GANsï¼Œæ¢ç©¶å…¶åœ¨æ´ªæ°´æ—¶é—´åºåˆ—ç”ŸæˆåŠé¢„æŠ¥ä¸­çš„ä½œç”¨ï¼Œåˆ©ç”¨æ—¶é—´åºåˆ—ç”Ÿæˆå¯¹æŠ—ç½‘ç»œè¿›è¡Œæ´ªæ°´é¢„æµ‹ï¼Œåº”ç”¨TimeGANå’ŒRTSGANç”Ÿæˆåˆæˆæ´ªæ°´æ—¶é—´åºåˆ—ã€‚ä»¥ä¸­å›½è¥¿æ±ŸæµåŸŸä¸ºä¾‹ï¼Œå®éªŒç»“æœè¡¨æ˜TimeGANèƒ½å‡†ç¡®é«˜æ•ˆæ¨¡æ‹Ÿå¤šç«™ç‚¹æ´ªæ°´åºåˆ—çš„æ—¶ç©ºç›¸å…³æ€§ï¼ŒRTSGANåœ¨é•¿åºåˆ—æ—¶è¡¨ç°æ›´ä¼˜ï¼Œä¸”åˆæˆæ•°æ®é›†å¯å‡å°‘å¸¸"
keywords: "generative adversarial networks for synthetic reservoir inflow generation"
categories: ['æœªåˆ†ç±»']
tags: ['ç¬”è®°', 'æœºå™¨å­¦ä¹ ', 'äººå·¥æ™ºèƒ½']
artid: "145981612"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=145981612
    alt: "2025.3.9æœºå™¨å­¦ä¹ ç¬”è®°æ–‡çŒ®é˜…è¯»"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=145981612
featuredImagePreview: https://bing.ee123.net/img/rand?artid=145981612
cover: https://bing.ee123.net/img/rand?artid=145981612
image: https://bing.ee123.net/img/rand?artid=145981612
img: https://bing.ee123.net/img/rand?artid=145981612
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     2025.3.9æœºå™¨å­¦ä¹ ç¬”è®°ï¼šæ–‡çŒ®é˜…è¯»
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <h2>
     <a id="_1">
     </a>
     ä¸€ã€æ–‡çŒ®é˜…è¯»
    </h2>
    <h3>
     <a id="_2">
     </a>
     é¢˜ç›®ä¿¡æ¯
    </h3>
    <ul>
     <li>
      <strong>
       é¢˜ç›®ï¼š
      </strong>
      Time-series generative adversarial networks for flood forecasting
     </li>
     <li>
      <strong>
       æœŸåˆŠï¼š
      </strong>
      Journal of Hydrology
     </li>
     <li>
      <strong>
       ä½œè€…ï¼š
      </strong>
      Peiyao Weng, Yu Tian, Yingfei Liu, Ying Zheng
     </li>
     <li>
      <strong>
       å‘è¡¨æ—¶é—´ï¼š
      </strong>
      2023/5/20
     </li>
     <li>
      <strong>
       æ–‡ç« é“¾æ¥ï¼š
      </strong>
      <a href="https://pdf.sciencedirectassets.com/271842/1-s2.0-S0022169423X00080/1-s2.0-S0022169423006443/main.pdf?X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJb%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLWVhc3QtMSJHMEUCIBOFtK93Xb8juBe00SDcHlI8WjIkLgrfBPF9MeZFCPsHAiEA2%2BMv%2FMXESsCoJb4zuXnkvoeWSanNa3hsbpwqg3vzGGUqvAUIzv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAFGgwwNTkwMDM1NDY4NjUiDKcA1VjU%2BCVi8PJxoCqQBfm3%2BGZ8HeyH7c4cqMQbBgy1xjh7NW3eSva3ABAwAf%2FWLuG3riQWSzu3eUdy11wWHwshfHR06hr4eYQfitP4WCiMuJjXdCevgAnS3EjzGoJlA%2FWDT%2FMoFtzTBE1V1N1G%2BC7UaaWDba7%2BASWJUFgYBggWf7wSHjsXpuFCitT27CATIjAJhZ4OXlbWHuzOPqEtwSq5dWQx9TKhaB3BpXCZNy4nTxxZ5HHbOWYYaqk7uY0UvzK2NI3na1vcPv1V4%2B4dEj4EnSbMKnfq%2FgfKdYqIeRj4O8hJEhPpmJqqUbiHG6goGHVT6geRH0hUvJn1GIkFiDVr3sLQMku1M3NnY%2BNs9tBqu6ICtO9WPP3LfVUYTU8ZI16PaV3QbqbSozc%2BQsoFE9HGWe%2Bvd0WYONltDeNRwY%2BCDt9X1TeDXMDgvGXHes2IIysIRDrxlEYVNnVfkM8hS33KFs3VSbAINgg%2B34e2u90u4lbAi9beeHLUzY%2BaH3MSSfIzG%2Fx0sHGSa9Wk1DVLig6VfHd5g5dmN%2BOooIlp%2BkKbcZG0v29Jd8hxAMCPOGd8jmxGSb9Q0kBJIkRypFqW8P8zxues21eZ%2FuMIjCsUQqpeJbmwfN6XwKlNtWenC4R5hnC6NCQIl0l2DKtHIUi1xKtQ5ePcqDhfISg3S4B%2BL4RWZwjxbibgwRbshzTtk8jgHJuyzGDNqXyoifQZOOcfiv5mEfQl2SS366TDk%2BimktVrLjIPObdtxRdVJf7Pm6F%2Fm4KA7fyzJ7dzXYFffVxWXa4s68Pgp9c4eGoSBfxay8PQmooWr9%2B3Y4DmMD4p4%2B4Okmiy0gYKFY2%2BJ7%2FqHPyNdfvHrOrw94YUlQod5JMBJuKkOdela3wOjHCiOgjewU2pMJXxlL4GOrEBmPBoZHpqcOWa9uBJ1bY60HyvfYBl%2BlDJH2Ed%2BikwXJeCkEOeeu8%2BACl08%2FboZjqwhXgc3KenD3G%2FPLUfHC37L3Ao5imLBDbi0MF5M5pk%2B2IWscF5mgbEUPICHegB9UZiWoPv139mtt%2F7GFRMrxE5x9W4fbTDtzHAkAcsrUEu7ov4MjhljS6h1l25RUDYPzKBjdv7Nf3XAIJJ7vSiYuSTDz2ZjnD41mF56VwlccWMlxib&amp;X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Date=20250303T060304Z&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Expires=300&amp;X-Amz-Credential=ASIAQ3PHCVTY4CAY6CN6%2F20250303%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Signature=3c084efbf973ed1be9a2dc2ba14b526188dfdc129fd504fb35b07d7708f0127a&amp;hash=7901a4909e9ccf7769c0501aabe533f25908761c84b9b933f6b17b5bcf9634c5&amp;host=68042c943591013ac2b2430a89b270f6af2c76d8dfd086a07176afe7c76c2c61&amp;pii=S0022169423006443&amp;tid=spdf-d24b26cc-557c-4961-b94a-b21448d74dc8&amp;sid=ed0ce5719dde1347418a57c36e243963e462gxrqa&amp;type=client&amp;tsoh=d3d3LnNjaWVuY2VkaXJlY3QuY29t&amp;rh=d3d3LnNjaWVuY2VkaXJlY3QuY29t&amp;ua=0e085b51045401070304&amp;rr=91a6edbaddbc20ee&amp;cc=hk" rel="nofollow">
       https://www.sciencedirect.com/science/article/pii/S0022169423006443?via%3Dihub
      </a>
     </li>
    </ul>
    <h3>
     <a id="_8">
     </a>
     æ‘˜è¦
    </h3>
    <p>
     æ´ªæ°´æ¯å¹´å¯¹å…¨ä¸–ç•Œé€ æˆäº†å·¨å¤§çš„æŸå¤±ï¼Œæœ‰æ•ˆçš„æ´ªæ°´é¢„è­¦æ˜¯é‡è¦é˜²æ´ªæ–¹å¼ï¼Œä½†æ˜¯ç°æœ‰æ´ªæ°´é¢„æµ‹æ–¹æ³•å¹¶ä¸å¯é ï¼Œæ¯”å¦‚ï¼Œä¼ ç»Ÿçš„ç‰©ç†è®¡ç®—æ–¹æ³•å’Œæ•°æ®é©±åŠ¨æ¨¡å‹éœ€å¤§é‡æ°´æ–‡å’Œåœ°è²Œæ•°æ®ï¼Œåˆå› ä¸ºæç«¯æ´ªæ°´äº‹ä»¶è§‚æµ‹æ•°æ®æœ‰é™ï¼Œè¿™ä¼šå¯¼è‡´æ¨¡å‹çš„é¢„æµ‹ä¸å‡†ç¡®ã€‚æœ¬è®ºæ–‡åŸºäºæ—¶é—´åºåˆ—GANsï¼Œæ¢ç©¶å…¶åœ¨æ´ªæ°´æ—¶é—´åºåˆ—ç”ŸæˆåŠé¢„æŠ¥ä¸­çš„ä½œç”¨ï¼Œåˆ©ç”¨æ—¶é—´åºåˆ—ç”Ÿæˆå¯¹æŠ—ç½‘ç»œè¿›è¡Œæ´ªæ°´é¢„æµ‹ï¼Œåº”ç”¨TimeGANå’ŒRTSGANç”Ÿæˆåˆæˆæ´ªæ°´æ—¶é—´åºåˆ—ã€‚ä»¥ä¸­å›½è¥¿æ±ŸæµåŸŸä¸ºä¾‹ï¼Œå®éªŒç»“æœè¡¨æ˜TimeGANèƒ½å‡†ç¡®é«˜æ•ˆæ¨¡æ‹Ÿå¤šç«™ç‚¹æ´ªæ°´åºåˆ—çš„æ—¶ç©ºç›¸å…³æ€§ï¼ŒRTSGANåœ¨é•¿åºåˆ—æ—¶è¡¨ç°æ›´ä¼˜ï¼Œä¸”åˆæˆæ•°æ®é›†å¯å‡å°‘å¸¸è§„æ·±åº¦å­¦ä¹ æ¨¡å‹çš„é¢„æµ‹è¯¯å·®ã€‚è¿™ç§æ–¹æ³•ä¸ºè§£å†³æ´ªæ°´é¢„æŠ¥ä¸­æ•°æ®ç¨€ç¼ºé—®é¢˜æä¾›äº†æ–°æ€è·¯ï¼Œå¯¹æå‡æ´ªæ°´é¢„æŠ¥å…·æœ‰é‡è¦ä½œç”¨ï¼Œæœ‰åŠ©äºå‡å°‘æ´ªæ°´é€ æˆçš„æŸå¤±ã€‚
    </p>
    <h3>
     <a id="Abstract_10">
     </a>
     Abstract
    </h3>
    <p>
     Floods cause substantial losses worldwide each year, making effective flood warning systems a critical component of flood prevention. However, existing flood prediction methods are often unreliable. For instance, traditional physically-based computational approaches and data-driven models require extensive hydrological and geomorphological data. Moreover, the limited availability of observational data for extreme flood events often leads to inaccurate predictions. This paper investigates the application of time series Generative Adversarial Networks (GANs) in generating and forecasting flood time series. Specifically, we employ TimeGAN and RTSGAN to produce synthetic flood time series data. Using the Xijiang River Basin in China as a case study, experimental results demonstrate that TimeGAN can accurately and efficiently simulate the spatiotemporal correlations of multi-site flood sequences. RTSGAN, on the other hand, exhibits superior performance for longer sequences. Furthermore, the synthetic datasets generated by these models can reduce prediction errors in conventional deep learning approaches. This methodology offers a novel solution to the challenge of data scarcity in flood forecasting, significantly enhancing flood prediction accuracy and contributing to the mitigation of flood-related damages.
    </p>
    <h3>
     <a id="_12">
     </a>
     åˆ›æ–°ç‚¹
    </h3>
    <p>
     ä½œè€…é¦–æ¬¡å°†æ—¶é—´åºåˆ—GANsåº”ç”¨äºæ´ªæ°´æ—¶é—´åºåˆ—ç”Ÿæˆä¸­ï¼Œä»¥æå‡æ´ªæ°´é¢„æŠ¥æ¨¡å‹ç²¾åº¦ï¼Œå…¶åˆ©ç”¨å†å²åºåˆ—æ•°æ®ç”Ÿæˆæ–°æ•°æ®ï¼Œä¸”æ— éœ€é¢„å¤„ç†ï¼Œç”Ÿæˆçš„åºåˆ—ä¿ç•™åŸå§‹æ—¶é—´ç‰¹å¾ã€‚
    </p>
    <h3>
     <a id="_14">
     </a>
     ç½‘ç»œæ¶æ„
    </h3>
    <p>
     åœ¨è®ºæ–‡ç¬¬3.1èŠ‚â€œFlood generating modelâ€ä¸­ï¼Œæåˆ°åœ¨ç”Ÿæˆåˆæˆæ´ªæ°´æ•°æ®ä¹‹å‰ï¼Œéœ€è¦å¯¹åŸå§‹æ´ªæ°´æ—¶é—´åºåˆ—è¿›è¡Œé¢„å¤„ç†ã€‚æ•°æ®ä¸ºæ´ªæ°´æ—¶é—´åºåˆ—ï¼ŒåŒ…å«å¤šä¸ªæ´ªæ°´äº‹ä»¶ğ‘˜ï¼Œç‰¹å¾ç»´åº¦ ğ‘›ï¼Œæ—¶é—´æ­¥é•¿ğ‘šï¼Œçª—å£å¤§å°ğ‘¤ï¼Œåºåˆ—é•¿åº¦ğ¿ã€‚å°†åŸå§‹æ´ªæ°´æ—¶é—´åºåˆ—é€šè¿‡æ»‘åŠ¨çª—å£çš„æ–¹å¼åˆ†å‰²æˆä¸‰ç»´æ•°æ®ï¼Œå…¶è¡¨ç¤ºä¸ºï¼š
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        [ 
        
        
        
          âˆ‘ 
         
         
         
           i 
          
         
           = 
          
         
           1 
          
         
        
          k 
         
        
        
        
          ( 
         
         
         
           L 
          
         
           i 
          
         
        
          âˆ’ 
         
        
          w 
         
        
          + 
         
        
          1 
         
        
          ) 
         
        
       
         , 
        
       
         n 
        
       
         , 
        
       
         w 
        
       
         ] 
        
       
      
        [\sum_{i=1}^{k}\left(L_{i}-w+1\right), n, w]
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.2887em; vertical-align: -0.2997em;">
         </span>
         <span class="mopen">
          [
         </span>
         <span class="mop">
          <span class="mop op-symbol small-op" style="position: relative; top: 0em;">
           âˆ‘
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.989em;">
              <span class="" style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mrel mtight">
                  =
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.2029em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                  k
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2997em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="minner">
          <span class="mopen delimcenter" style="top: 0em;">
           (
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            L
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   i
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           âˆ’
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0269em;">
           w
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           +
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mord">
           1
          </span>
          <span class="mclose delimcenter" style="top: 0em;">
           )
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0269em;">
          w
         </span>
         <span class="mclose">
          ]
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     çª—å£å¤§å°wå†³å®šæ¯æ¬¡å¤„ç†çš„æ•°æ®é•¿åº¦ï¼Œè®ºæ–‡ä¸­å°†å°æ—¶å°ºåº¦å®šä¸º48å°æ—¶æ¯3å°æ—¶ä¸€ä¸ªæ—¶é—´æ­¥ï¼Œåˆ™åˆ†ä¸º16ä¸ªæ—¶é—´æ­¥ï¼›æ—¥å°ºåº¦åˆ™ä¸º9å¤©ï¼Œåˆ™åˆ†ä¸º9ä¸ªæ—¶é—´æ­¥ï¼›
     <br/>
     è®ºæ–‡ä¸­â€œthe sliding step ğ‘š is set to 1â€ï¼Œå°†æ­¥é•¿mè®¾ä¸º1ï¼Œè¡¨ç¤ºçª—å£æ¯æ¬¡æ»‘åŠ¨1ä¸ªæ—¶é—´æ­¥ï¼Œç”Ÿæˆé‡å çª—å£ã€‚
     <br/>
     ä¸¾ä¸ªä¾‹å­ï¼šå¯¹äºç¬¬ğ‘–ä¸ªæ´ªæ°´äº‹ä»¶ï¼Œæ—¶é—´åºåˆ—é•¿åº¦ä¸º
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        L 
         
        
          i 
         
        
       
      
        L_i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8333em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           L
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ï¼Œè®¾
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        L 
         
        
          i 
         
        
       
         = 
        
       
         100 
        
       
      
        L_i = 100
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8333em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           L
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          100
         </span>
        </span>
       </span>
      </span>
     </span>
     (æ´ªæ°´æŒç»­äº†100ä¸ªå°äº‹)ï¼Œçª—å£å¤§å°w=16ï¼Œæ­¥é•¿m=1ï¼Œæœ‰ä¸‰ä¸ªç‰¹å¾ï¼Œå³n=3ã€‚
     <br/>
     åˆ™ç¬¬ä¸€ä¸ªçª—å£æ—¶é—´æ­¥1åˆ°16ï¼›ç¬¬äºŒä¸ªçª—å£æ—¶é—´æ­¥2åˆ°17ï¼›æœ€åä¸€ä¸ªçª—å£æ—¶é—´æ­¥85åˆ°100ã€‚â€‹
     <br/>
     æ€»çª—å£æ•°åˆ™ä¸º100âˆ’16+1=85ï¼Œä¸”ä¸€ä¸ªçª—å£æ˜¯ä¸€ä¸ªäºŒç»´çŸ©é˜µ[n,w]ã€‚
     <br/>
     æ‰€ä»¥è¿™ä¸ªä¸‰ç»´çŸ©é˜µè¡¨è¾¾ä¸ºï¼š
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        [ 
        
        
        
          âˆ‘ 
         
         
         
           i 
          
         
           = 
          
         
           1 
          
         
        
          k 
         
        
        
        
          ( 
         
         
         
           L 
          
         
           i 
          
         
        
          âˆ’ 
         
        
          w 
         
        
          + 
         
        
          1 
         
        
          ) 
         
        
       
         , 
        
       
         n 
        
       
         , 
        
       
         w 
        
       
         ] 
        
       
      
        [\sum_{i=1}^{k}\left(L_{i}-w+1\right), n, w]
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.2887em; vertical-align: -0.2997em;">
         </span>
         <span class="mopen">
          [
         </span>
         <span class="mop">
          <span class="mop op-symbol small-op" style="position: relative; top: 0em;">
           âˆ‘
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.989em;">
              <span class="" style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mrel mtight">
                  =
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.2029em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                  k
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2997em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="minner">
          <span class="mopen delimcenter" style="top: 0em;">
           (
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            L
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   i
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           âˆ’
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0269em;">
           w
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           +
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mord">
           1
          </span>
          <span class="mclose delimcenter" style="top: 0em;">
           )
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0269em;">
          w
         </span>
         <span class="mclose">
          ]
         </span>
        </span>
       </span>
      </span>
     </span>
     = [85,3,16]
     <br/>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/e2e27fd85e7e4408821df4ee72d5e8b4.png">
      <br/>
      TimeGANåŒ…å«åµŒå…¥å‡½æ•°ã€æ¢å¤å‡½æ•°ã€åºåˆ—ç”Ÿæˆå™¨å’Œåºåˆ—é‰´åˆ«å™¨çš„ç”Ÿæˆæ¨¡å‹ï¼Œé€šè¿‡æœ‰ç›‘ç£æŸå¤±å’Œæ— ç›‘ç£æŸå¤±çš„å­¦ä¹ åµŒå…¥ç©ºé—´å¯¹æŠ—æ€§å’Œè”åˆè®­ç»ƒï¼Œè®©æ¨¡å‹å¾—ä»¥åŒæ—¶å­¦ä¹ ç¼–ç ç‰¹å¾ã€ç”Ÿæˆè¡¨ç¤ºå’Œè·¨æ—¶é—´è¿­ä»£ã€‚æœ‰å…³äºTimeGANçš„çŸ¥è¯†ç‚¹ï¼Œæˆ‘åœ¨ä¹‹å‰çš„åšå®¢è®°å½•è¿‡ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ï¼Œå¤§å®¶éœ€è¦çš„è¯å¯ä»¥ç‚¹å‡»è¿™ä¸ªé“¾æ¥æŸ¥çœ‹ï¼š
      <a href="https://blog.csdn.net/Zcymatics/article/details/145011621?spm=1001.2014.3001.5501">
       https://blog.csdn.net/Zcymatics/article/details/145011621?spm=1001.2014.3001.5501
      </a>
      <br/>
      <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/f79f9e7f0b5349c5b8d24ddb2b483544.png">
       <br/>
       æ¥ä¸‹æ¥æˆ‘ä»¬è¯¦ç»†åˆ†æä¸€ä¸‹ä½œè€…æåˆ°çš„RTSGANï¼Œå…¶å…¨ç§°ä¸ºâ€œRecurrent Time-Series Generative Adversarial Networkâ€ï¼Œå®ƒæ˜¯TimeGANçš„æ”¹è¿›ç‰ˆæœ¬ï¼Œä¸“é—¨ç”¨äºç”Ÿæˆé«˜è´¨é‡æ—¶é—´åºåˆ—æ•°æ®ã€‚
       <br/>
       å…¶æ ¸å¿ƒæ˜¯é€šè¿‡
       <strong>
        ç»“åˆWGAN å’Œè‡ªå›å½’è§£ç å™¨
       </strong>
       ï¼Œå…‹æœäº†ä¼ ç»ŸTimeGANåœ¨é•¿åºåˆ—ç”Ÿæˆä¸­çš„ä¸ç¨³å®šæ€§å’Œé•¿åºåˆ—ä¿¡æ¯æ•æ‰èƒ½åŠ›å¼±é—®é¢˜ã€‚
       <br/>
       ä¼ ç»ŸGANä½¿ç”¨çš„æ˜¯JSæ•£åº¦æˆ–KLæ•£åº¦ä¼˜åŒ–ç”Ÿæˆåˆ†å¸ƒä¸çœŸå®åˆ†å¸ƒçš„ç›¸ä¼¼æ€§ã€‚æƒ³è¦äº†è§£GANå¯ä»¥å»æˆ‘è¿™ç¯‡åšå®¢çœ‹ä¸€ä¸‹åŸç†ï¼š
       <a href="https://blog.csdn.net/Zcymatics/article/details/145011685?spm=1001.2014.3001.5501">
        https://blog.csdn.net/Zcymatics/article/details/145011685?spm=1001.2014.3001.5501
       </a>
       <br/>
       è€ŒWGANä½¿ç”¨
       <strong>
        Wassersteinè·ç¦»
       </strong>
       æ›¿ä»£JSæ•£åº¦ï¼Œå‡å°‘æ¨¡å¼å´©å¡Œï¼Œæé«˜è®­ç»ƒç¨³å®šæ€§ã€‚
      </img>
     </img>
    </p>
    <pre><code>æ¨¡å‹åå¡Œæ˜¯æŒ‡æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­é€æ¸å¤±å»å¤šæ ·æ€§å’Œæ³›åŒ–èƒ½åŠ›ï¼Œå¯¼è‡´æ€§èƒ½ä¸¥é‡é€€åŒ–ç”šè‡³æ— æ³•ç»§ç»­ä¼˜åŒ–ã€‚
</code></pre>
    <p>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/a0d08ee189ff4b46a6e840f7e121db5a.jpeg">
      <br/>
      å…¶æŸå¤±å‡½æ•°è¢«å®šä¹‰ä¸ºï¼š
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         L 
        
       
         = 
        
        
        
          E 
         
         
         
           r 
          
         
           âˆ¼ 
          
          
          
            P 
           
          
            r 
           
          
         
        
       
         [ 
        
       
         D 
        
       
         ( 
        
       
         r 
        
       
         ) 
        
       
         ] 
        
       
         âˆ’ 
        
        
        
          E 
         
         
          
          
            r 
           
          
            ^ 
           
          
         
           âˆ¼ 
          
          
          
            P 
           
          
            g 
           
          
         
        
       
         [ 
        
       
         D 
        
       
         ( 
        
        
        
          r 
         
        
          ^ 
         
        
       
         ) 
        
       
         ] 
        
       
      
        L=E_{r \sim P_{r}}[D(r)]-E_{\hat{r} \sim P_{g}}[D(\hat{r})]
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord mathnormal">
           L
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1.0001em; vertical-align: -0.2501em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0576em;">
            E
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3283em;">
               <span class="" style="top: -2.55em; margin-left: -0.0576em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                   r
                  </span>
                  <span class="mrel mtight">
                   âˆ¼
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                    P
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.1645em;">
                       <span class="" style="top: -2.357em; margin-left: -0.1389em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                           r
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2501em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mopen">
           [
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           D
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           r
          </span>
          <span class="mclose">
           )]
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           âˆ’
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1.0973em; vertical-align: -0.3473em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0576em;">
            E
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3361em;">
               <span class="" style="top: -2.55em; margin-left: -0.0576em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord accent mtight">
                   <span class="vlist-t">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.6944em;">
                      <span class="" style="top: -2.7em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                        r
                       </span>
                      </span>
                      <span class="" style="top: -2.7em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="accent-body" style="left: -0.1944em;">
                        <span class="mord mtight">
                         ^
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mrel mtight">
                   âˆ¼
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                    P
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.1645em;">
                       <span class="" style="top: -2.357em; margin-left: -0.1389em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight" style="margin-right: 0.0359em;">
                           g
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.2819em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3473em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mopen">
           [
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           D
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord accent">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.6944em;">
              <span class="" style="top: -3em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="mord mathnormal" style="margin-right: 0.0278em;">
                r
               </span>
              </span>
              <span class="" style="top: -3em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="accent-body" style="left: -0.1944em;">
                <span class="mord">
                 ^
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose">
           )]
          </span>
         </span>
        </span>
       </span>
      </span>
      <br/>
      Dæ˜¯åˆ¤åˆ«å™¨
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         E 
         
         
         
           r 
          
         
           âˆ¼ 
          
          
          
            P 
           
          
            r 
           
          
         
        
       
         [ 
        
       
         D 
        
       
         ( 
        
       
         r 
        
       
         ) 
        
       
         ] 
        
       
      
        E_{r \sim P_{r}}[D(r)]
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1.0001em; vertical-align: -0.2501em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0576em;">
            E
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3283em;">
               <span class="" style="top: -2.55em; margin-left: -0.0576em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                   r
                  </span>
                  <span class="mrel mtight">
                   âˆ¼
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                    P
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.1645em;">
                       <span class="" style="top: -2.357em; margin-left: -0.1389em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                           r
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2501em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mopen">
           [
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           D
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           r
          </span>
          <span class="mclose">
           )]
          </span>
         </span>
        </span>
       </span>
      </span>
      æ˜¯çœŸå®æ ·æœ¬ğ‘Ÿé€šè¿‡ğ·çš„æœŸæœ›è¾“å‡ºï¼›
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         E 
         
         
          
          
            r 
           
          
            ^ 
           
          
         
           âˆ¼ 
          
          
          
            P 
           
          
            g 
           
          
         
        
       
         [ 
        
       
         D 
        
       
         ( 
        
        
        
          r 
         
        
          ^ 
         
        
       
         ) 
        
       
         ] 
        
       
      
        E_{\hat{r} \sim P_{g}}[D(\hat{r})]
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1.0973em; vertical-align: -0.3473em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0576em;">
            E
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3361em;">
               <span class="" style="top: -2.55em; margin-left: -0.0576em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord accent mtight">
                   <span class="vlist-t">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.6944em;">
                      <span class="" style="top: -2.7em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                        r
                       </span>
                      </span>
                      <span class="" style="top: -2.7em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="accent-body" style="left: -0.1944em;">
                        <span class="mord mtight">
                         ^
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mrel mtight">
                   âˆ¼
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                    P
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.1645em;">
                       <span class="" style="top: -2.357em; margin-left: -0.1389em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight" style="margin-right: 0.0359em;">
                           g
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.2819em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3473em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mopen">
           [
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           D
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord accent">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.6944em;">
              <span class="" style="top: -3em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="mord mathnormal" style="margin-right: 0.0278em;">
                r
               </span>
              </span>
              <span class="" style="top: -3em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="accent-body" style="left: -0.1944em;">
                <span class="mord">
                 ^
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose">
           )]
          </span>
         </span>
        </span>
       </span>
      </span>
      åˆæˆæ ·æœ¬
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         r 
         
        
          ^ 
         
        
       
      
        \hat{r}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6944em;">
          </span>
          <span class="mord accent">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.6944em;">
              <span class="" style="top: -3em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="mord mathnormal" style="margin-right: 0.0278em;">
                r
               </span>
              </span>
              <span class="" style="top: -3em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="accent-body" style="left: -0.1944em;">
                <span class="mord">
                 ^
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      é€šè¿‡ğ·çš„æœŸæœ›è¾“å‡ºã€‚
     </img>
    </p>
    <p>
     è¯´å®Œäº†Wassersteinè·ç¦»ï¼Œä¸‹é¢æ¥è¯´ä¸€ä¸‹RTSGANçš„å¦ä¸€ä¸ªæ”¹è¿›ç‚¹ï¼š
     <br/>
     <strong>
      è‡ªå›å½’ç¼–ç å™¨
     </strong>
     <br/>
     TimeGANä¸­ï¼Œä½¿ç”¨çš„æ˜¯åµŒå…¥å‡½æ•°å’Œæ¢å¤å‡½æ•°å®Œæˆã€‚å…¶åµŒå…¥å‡½æ•°æ˜¯é€æ—¶é—´æ­¥ç”Ÿæˆæ½œåœ¨åºåˆ—ğ»ï¼Œæ¯ä¸ªæ—¶é—´æ­¥éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„æ½œåœ¨è¡¨ç¤º
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        h 
         
        
          t 
         
        
       
      
        h_t
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8444em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           h
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2806em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 t
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ï¼›å…¶æ¢å¤å‡½æ•°ä»æ•´ä¸ªæ½œåœ¨åºåˆ—ğ»
     <strong>
      ä¸€æ¬¡æ€§
     </strong>
     ç”Ÿæˆé‡å»ºåºåˆ—
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        X 
         
        
          ^ 
         
        
       
      
        \hat X
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.9468em;">
         </span>
         <span class="mord accent">
          <span class="vlist-t">
           <span class="vlist-r">
            <span class="vlist" style="height: 0.9468em;">
             <span class="" style="top: -3em;">
              <span class="pstrut" style="height: 3em;">
              </span>
              <span class="mord mathnormal" style="margin-right: 0.0785em;">
               X
              </span>
             </span>
             <span class="" style="top: -3.2523em;">
              <span class="pstrut" style="height: 3em;">
              </span>
              <span class="accent-body" style="left: -0.1667em;">
               <span class="mord">
                ^
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ã€‚
     <br/>
     RTSGANä¸­ä½¿ç”¨çš„åˆ™æ˜¯è‡ªå›å½’ç¼–ç å™¨å’Œè§£ç å™¨ã€‚ç¼–ç å™¨åŒæ ·è´Ÿè´£å°†æ—¶é—´åºåˆ—Xæ˜ å°„åˆ°æ½œåœ¨ç©ºé—´ï¼Œä½†å…¶ç›®æ ‡æ˜¯ç”Ÿæˆä¸€ä¸ªå›ºå®šç»´åº¦çš„æ½œåœ¨è¡¨ç¤ºğ‘Ÿï¼Œè€Œä¸æ˜¯é€æ—¶é—´æ­¥çš„æ½œåœ¨åºåˆ—ğ»ï¼›å…¶è§£ç å™¨ä»æ½œåœ¨è¡¨ç¤º
     <strong>
      é€æ­¥
     </strong>
     ç”Ÿæˆæ—¶é—´åºåˆ—ï¼ˆä¸æ˜¯ä¸€æ¬¡æ€§è¾“å‡ºï¼‰ï¼Œé‡‡ç”¨è‡ªå›å½’æ–¹å¼ç”Ÿæˆæ¯ä¸ªæ—¶é—´æ­¥çš„è¾“å‡ºã€‚
     <br/>
     TimeGANçš„ä¸€æ¬¡æ€§ç”Ÿæˆä¼šå¯¼è‡´é•¿åºåˆ—çš„æ—¶é—´ç›¸å…³æ€§å¯èƒ½è¢«å‰Šå¼±ã€‚RTSGANä¸­è‡ªå›å½’è§£ç å™¨é€šè¿‡é€æ­¥ç”Ÿæˆçš„æ–¹å¼å­¦ä¹ æ—¶é—´ä¾èµ–æ€§ï¼Œæ¯ä¸€æ­¥çš„ç”Ÿæˆä¾èµ–äºå‰ä¸€æ­¥çš„è¾“å‡ºï¼Œæ›´åŠ èƒ½å¤Ÿæ•æ‰æ—¶é—´åŠ¨æ€å˜åŒ–ã€‚
     <br/>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/5785c3226faf475d849b7fd974a06b6d.png">
      <br/>
      ä¸‹å›¾æ˜¯è®ºæ–‡å·¥ä½œçš„æ€»ä½“çš„æµç¨‹å›¾ï¼š
      <br/>
      é¦–å…ˆæ•°æ®ç»è¿‡é¢„å¤„ç†åç»™TimeGANå’ŒRTSGANç”Ÿæˆæ•°æ®ï¼Œç„¶åçœŸå®çš„è®­ç»ƒæ•°æ®å’Œç”Ÿæˆæ•°æ®è¿›å…¥æ»‘åŠ¨çª—å£ã€‚æ»‘åŠ¨çª—å£å°†çœŸå®å’Œåˆæˆæ•°æ®åˆ†å‰²æˆä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸ºç›‘ç£å­¦ä¹ æä¾›æ•°æ®ï¼ŒçœŸå®æ•°æ®ä¸ºcovariatesï¼Œå¦‚
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         x 
         
         
         
           t 
          
         
           âˆ’ 
          
         
           2 
          
         
        
          1 
         
        
       
         , 
        
        
        
          x 
         
         
         
           t 
          
         
           âˆ’ 
          
         
           2 
          
         
        
          2 
         
        
       
         , 
        
        
        
          x 
         
         
         
           t 
          
         
           âˆ’ 
          
         
           2 
          
         
        
          3 
         
        
       
      
        x_{t-2}^1, x_{t-2}^2, x_{t-2}^3
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1.1205em; vertical-align: -0.3064em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            x
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.8141em;">
               <span class="" style="top: -2.4519em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   t
                  </span>
                  <span class="mbin mtight">
                   âˆ’
                  </span>
                  <span class="mord mtight">
                   2
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3064em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            x
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.8141em;">
               <span class="" style="top: -2.4519em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   t
                  </span>
                  <span class="mbin mtight">
                   âˆ’
                  </span>
                  <span class="mord mtight">
                   2
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  2
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3064em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            x
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.8141em;">
               <span class="" style="top: -2.4519em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   t
                  </span>
                  <span class="mbin mtight">
                   âˆ’
                  </span>
                  <span class="mord mtight">
                   2
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  3
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3064em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ï¼Œç»¿è‰²æ¡†ä¸ºGANç”Ÿæˆæ•°æ®yï¼Œå¦‚
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         y 
         
        
          t 
         
        
       
      
        y_t
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0359em;">
            y
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2806em;">
               <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  t
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ï¼Œæ¯ä¸ªå®ä¾‹åŒ…å«è¾“å…¥å’Œè¾“å‡ºã€‚è¿™äº›æ•°æ®å¯¹ä¾›GBRTå’ŒLSTMè®­ç»ƒã€‚æœ€åä¸¤ä¸ªé¢„æµ‹æ¨¡å‹è¾“å‡ºé¢„æµ‹å€¼ä¸çœŸå®å€¼å¯¹æ¯”ï¼Œå¾—å‡ºè¯„ä¼°æŒ‡æ ‡ã€‚
      <br/>
      <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/4b54796ca76047418e72381ff3ca9c44.png"/>
     </img>
    </p>
    <h3>
     <a id="_45">
     </a>
     å®éªŒ
    </h3>
    <p>
     æœ¬æ–‡å›´ç»•æ—¶é—´åºåˆ—ç”Ÿæˆå¯¹æŠ—ç½‘ç»œåœ¨æ´ªæ°´é¢„æµ‹ä¸­çš„åº”ç”¨å±•å¼€å®éªŒï¼Œ
     <br/>
     è®ºæ–‡çš„
     <strong>
      è¯„ä»·æŒ‡æ ‡
     </strong>
     å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå…¶ä¸­æ¯”è¾ƒé™Œç”Ÿçš„æœ‰ï¼š
     <br/>
     1ã€çš®å°”é€Šç›¸å…³ç³»æ•°ï¼Œå…¶ç”¨äºè¡¡é‡é¢„æµ‹å€¼ä¸è§‚æµ‹å€¼çš„çº¿æ€§ç›¸å…³æ€§ï¼Œå€¼è¶Šå¤§è¶Šå¥½ï¼ˆæœ€å¤§å€¼ä¸º1ï¼‰ï¼š
     <br/>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         C 
        
       
         = 
        
        
         
          
          
            âˆ‘ 
           
           
           
             i 
            
           
             = 
            
           
             1 
            
           
          
            n 
           
          
          
          
            ( 
           
           
           
             F 
            
           
             i 
            
           
          
            âˆ’ 
           
           
           
             F 
            
           
             Ë‰ 
            
           
          
            ) 
           
          
          
          
            ( 
           
           
           
             O 
            
           
             i 
            
           
          
            âˆ’ 
           
           
           
             O 
            
           
             Ë‰ 
            
           
          
            ) 
           
          
         
         
          
           
            
            
              âˆ‘ 
             
             
             
               i 
              
             
               = 
              
             
               1 
              
             
            
              n 
             
            
            
             
             
               ( 
              
              
              
                F 
               
              
                i 
               
              
             
               âˆ’ 
              
              
              
                F 
               
              
                Ë‰ 
               
              
             
               ) 
              
             
            
              2 
             
            
           
          
          
           
            
            
              âˆ‘ 
             
             
             
               i 
              
             
               = 
              
             
               1 
              
             
            
              n 
             
            
            
             
             
               ( 
              
              
              
                O 
               
              
                i 
               
              
             
               âˆ’ 
              
              
              
                O 
               
              
                Ë‰ 
               
              
             
               ) 
              
             
            
              2 
             
            
           
          
         
        
       
      
        O C=\frac{\sum_{i=1}^n\left(F_i-\bar{F}\right)\left(O_i-\bar{O}\right)}{\sqrt{\sum_{i=1}^n\left(F_i-\bar{F}\right)^2} \sqrt{\sum_{i=1}^n\left(O_i-\bar{O}\right)^2}}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0715em;">
          OC
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 2.3396em; vertical-align: -1.0296em;">
         </span>
         <span class="mord">
          <span class="mopen nulldelimiter">
          </span>
          <span class="mfrac">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 1.31em;">
              <span class="" style="top: -2.3041em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord sqrt mtight">
                  <span class="vlist-t vlist-t2">
                   <span class="vlist-r">
                    <span class="vlist" style="height: 1.2656em;">
                     <span class="svg-align" style="top: -3.7143em;">
                      <span class="pstrut" style="height: 3.7143em;">
                      </span>
                      <span class="mord mtight" style="padding-left: 1.4286em;">
                       <span class="mop mtight">
                        <span class="mop op-symbol small-op mtight" style="position: relative; top: 0em;">
                         âˆ‘
                        </span>
                        <span class="msupsub">
                         <span class="vlist-t vlist-t2">
                          <span class="vlist-r">
                           <span class="vlist" style="height: 0.7047em;">
                            <span class="" style="top: -2.1786em; margin-left: 0em; margin-right: 0.0714em;">
                             <span class="pstrut" style="height: 2.5em;">
                             </span>
                             <span class="sizing reset-size3 size1 mtight">
                              <span class="mord mtight">
                               <span class="mord mathnormal mtight">
                                i
                               </span>
                               <span class="mrel mtight">
                                =
                               </span>
                               <span class="mord mtight">
                                1
                               </span>
                              </span>
                             </span>
                            </span>
                            <span class="" style="top: -2.8971em; margin-right: 0.0714em;">
                             <span class="pstrut" style="height: 2.5em;">
                             </span>
                             <span class="sizing reset-size3 size1 mtight">
                              <span class="mord mathnormal mtight">
                               n
                              </span>
                             </span>
                            </span>
                           </span>
                           <span class="vlist-s">
                            â€‹
                           </span>
                          </span>
                          <span class="vlist-r">
                           <span class="vlist" style="height: 0.3214em;">
                            <span class="">
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="minner mtight">
                        <span class="minner mtight">
                         <span class="mopen sizing reset-size3 size6 mtight delimcenter" style="top: 0.075em;">
                          <span class="mtight">
                           (
                          </span>
                         </span>
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                           F
                          </span>
                          <span class="msupsub">
                           <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.3281em;">
                              <span class="" style="top: -2.357em; margin-left: -0.1389em; margin-right: 0.0714em;">
                               <span class="pstrut" style="height: 2.5em;">
                               </span>
                               <span class="sizing reset-size3 size1 mtight">
                                <span class="mord mathnormal mtight">
                                 i
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="vlist-s">
                              â€‹
                             </span>
                            </span>
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.143em;">
                              <span class="">
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                         <span class="mbin mtight">
                          âˆ’
                         </span>
                         <span class="mord accent mtight">
                          <span class="vlist-t">
                           <span class="vlist-r">
                            <span class="vlist" style="height: 0.8201em;">
                             <span class="" style="top: -2.7em;">
                              <span class="pstrut" style="height: 2.7em;">
                              </span>
                              <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                               F
                              </span>
                             </span>
                             <span class="" style="top: -2.9523em;">
                              <span class="pstrut" style="height: 2.7em;">
                              </span>
                              <span class="accent-body" style="left: -0.1667em;">
                               <span class="mord mtight">
                                Ë‰
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                         <span class="mclose sizing reset-size3 size6 mtight delimcenter" style="top: 0.075em;">
                          <span class="mtight">
                           )
                          </span>
                         </span>
                        </span>
                        <span class="msupsub">
                         <span class="vlist-t">
                          <span class="vlist-r">
                           <span class="vlist" style="height: 1.1039em;">
                            <span class="" style="top: -3.1436em; margin-right: 0.0714em;">
                             <span class="pstrut" style="height: 2.5em;">
                             </span>
                             <span class="sizing reset-size3 size1 mtight">
                              <span class="mord mtight">
                               2
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="" style="top: -3.2376em;">
                      <span class="pstrut" style="height: 3.7143em;">
                      </span>
                      <span class="hide-tail mtight" style="min-width: 1.02em; height: 1.8286em;">
                       <svg height="1.8286em" preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 1296" width="400em">
                        <path d="M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z">
                        </path>
                       </svg>
                      </span>
                     </span>
                    </span>
                    <span class="vlist-s">
                     â€‹
                    </span>
                   </span>
                   <span class="vlist-r">
                    <span class="vlist" style="height: 0.4766em;">
                     <span class="">
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mord sqrt mtight">
                  <span class="vlist-t vlist-t2">
                   <span class="vlist-r">
                    <span class="vlist" style="height: 1.2656em;">
                     <span class="svg-align" style="top: -3.7143em;">
                      <span class="pstrut" style="height: 3.7143em;">
                      </span>
                      <span class="mord mtight" style="padding-left: 1.4286em;">
                       <span class="mop mtight">
                        <span class="mop op-symbol small-op mtight" style="position: relative; top: 0em;">
                         âˆ‘
                        </span>
                        <span class="msupsub">
                         <span class="vlist-t vlist-t2">
                          <span class="vlist-r">
                           <span class="vlist" style="height: 0.7047em;">
                            <span class="" style="top: -2.1786em; margin-left: 0em; margin-right: 0.0714em;">
                             <span class="pstrut" style="height: 2.5em;">
                             </span>
                             <span class="sizing reset-size3 size1 mtight">
                              <span class="mord mtight">
                               <span class="mord mathnormal mtight">
                                i
                               </span>
                               <span class="mrel mtight">
                                =
                               </span>
                               <span class="mord mtight">
                                1
                               </span>
                              </span>
                             </span>
                            </span>
                            <span class="" style="top: -2.8971em; margin-right: 0.0714em;">
                             <span class="pstrut" style="height: 2.5em;">
                             </span>
                             <span class="sizing reset-size3 size1 mtight">
                              <span class="mord mathnormal mtight">
                               n
                              </span>
                             </span>
                            </span>
                           </span>
                           <span class="vlist-s">
                            â€‹
                           </span>
                          </span>
                          <span class="vlist-r">
                           <span class="vlist" style="height: 0.3214em;">
                            <span class="">
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="minner mtight">
                        <span class="minner mtight">
                         <span class="mopen sizing reset-size3 size6 mtight delimcenter" style="top: 0.075em;">
                          <span class="mtight">
                           (
                          </span>
                         </span>
                         <span class="mord mtight">
                          <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                           O
                          </span>
                          <span class="msupsub">
                           <span class="vlist-t vlist-t2">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.3281em;">
                              <span class="" style="top: -2.357em; margin-left: -0.0278em; margin-right: 0.0714em;">
                               <span class="pstrut" style="height: 2.5em;">
                               </span>
                               <span class="sizing reset-size3 size1 mtight">
                                <span class="mord mathnormal mtight">
                                 i
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="vlist-s">
                              â€‹
                             </span>
                            </span>
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.143em;">
                              <span class="">
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                         <span class="mbin mtight">
                          âˆ’
                         </span>
                         <span class="mord accent mtight">
                          <span class="vlist-t">
                           <span class="vlist-r">
                            <span class="vlist" style="height: 0.8201em;">
                             <span class="" style="top: -2.7em;">
                              <span class="pstrut" style="height: 2.7em;">
                              </span>
                              <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                               O
                              </span>
                             </span>
                             <span class="" style="top: -2.9523em;">
                              <span class="pstrut" style="height: 2.7em;">
                              </span>
                              <span class="accent-body" style="left: -0.1667em;">
                               <span class="mord mtight">
                                Ë‰
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                         <span class="mclose sizing reset-size3 size6 mtight delimcenter" style="top: 0.075em;">
                          <span class="mtight">
                           )
                          </span>
                         </span>
                        </span>
                        <span class="msupsub">
                         <span class="vlist-t">
                          <span class="vlist-r">
                           <span class="vlist" style="height: 1.1039em;">
                            <span class="" style="top: -3.1436em; margin-right: 0.0714em;">
                             <span class="pstrut" style="height: 2.5em;">
                             </span>
                             <span class="sizing reset-size3 size1 mtight">
                              <span class="mord mtight">
                               2
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="" style="top: -3.2376em;">
                      <span class="pstrut" style="height: 3.7143em;">
                      </span>
                      <span class="hide-tail mtight" style="min-width: 1.02em; height: 1.8286em;">
                       <svg height="1.8286em" preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 1296" width="400em">
                        <path d="M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z">
                        </path>
                       </svg>
                      </span>
                     </span>
                    </span>
                    <span class="vlist-s">
                     â€‹
                    </span>
                   </span>
                   <span class="vlist-r">
                    <span class="vlist" style="height: 0.4766em;">
                     <span class="">
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.23em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="frac-line" style="border-bottom-width: 0.04em;">
               </span>
              </span>
              <span class="" style="top: -3.6125em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mop mtight">
                  <span class="mop op-symbol small-op mtight" style="position: relative; top: 0em;">
                   âˆ‘
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.7385em;">
                      <span class="" style="top: -2.1786em; margin-left: 0em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         <span class="mord mathnormal mtight">
                          i
                         </span>
                         <span class="mrel mtight">
                          =
                         </span>
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="" style="top: -2.931em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mathnormal mtight">
                         n
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      â€‹
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3214em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="minner mtight">
                  <span class="mopen sizing reset-size3 size6 mtight delimcenter" style="top: 0.075em;">
                   <span class="mtight">
                    (
                   </span>
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                    F
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3281em;">
                       <span class="" style="top: -2.357em; margin-left: -0.1389em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mathnormal mtight">
                          i
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mbin mtight">
                   âˆ’
                  </span>
                  <span class="mord accent mtight">
                   <span class="vlist-t">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.8201em;">
                      <span class="" style="top: -2.7em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                        F
                       </span>
                      </span>
                      <span class="" style="top: -2.9523em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="accent-body" style="left: -0.1667em;">
                        <span class="mord mtight">
                         Ë‰
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mclose sizing reset-size3 size6 mtight delimcenter" style="top: 0.075em;">
                   <span class="mtight">
                    )
                   </span>
                  </span>
                 </span>
                 <span class="minner mtight">
                  <span class="mopen sizing reset-size3 size6 mtight delimcenter" style="top: 0.075em;">
                   <span class="mtight">
                    (
                   </span>
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                    O
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3281em;">
                       <span class="" style="top: -2.357em; margin-left: -0.0278em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mathnormal mtight">
                          i
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mbin mtight">
                   âˆ’
                  </span>
                  <span class="mord accent mtight">
                   <span class="vlist-t">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.8201em;">
                      <span class="" style="top: -2.7em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                        O
                       </span>
                      </span>
                      <span class="" style="top: -2.9523em;">
                       <span class="pstrut" style="height: 2.7em;">
                       </span>
                       <span class="accent-body" style="left: -0.1667em;">
                        <span class="mord mtight">
                         Ë‰
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mclose sizing reset-size3 size6 mtight delimcenter" style="top: 0.075em;">
                   <span class="mtight">
                    )
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 1.0296em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose nulldelimiter">
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        F 
         
        
          i 
         
        
       
      
        F_i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8333em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.1389em;">
           F
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.1389em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ä¸ºé¢„æµ‹å€¼ï¼›
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
         
        
          i 
         
        
       
      
        O_i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8333em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           O
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ä¸ºè§‚æµ‹å€¼ï¼›
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        F 
         
        
          Ë‰ 
         
        
       
      
        \bar{F}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8201em;">
         </span>
         <span class="mord accent">
          <span class="vlist-t">
           <span class="vlist-r">
            <span class="vlist" style="height: 0.8201em;">
             <span class="" style="top: -3em;">
              <span class="pstrut" style="height: 3em;">
              </span>
              <span class="mord mathnormal" style="margin-right: 0.1389em;">
               F
              </span>
             </span>
             <span class="" style="top: -3.2523em;">
              <span class="pstrut" style="height: 3em;">
              </span>
              <span class="accent-body" style="left: -0.1667em;">
               <span class="mord">
                Ë‰
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ä¸
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
         
        
          Ë‰ 
         
        
       
      
        \bar{O}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8201em;">
         </span>
         <span class="mord accent">
          <span class="vlist-t">
           <span class="vlist-r">
            <span class="vlist" style="height: 0.8201em;">
             <span class="" style="top: -3em;">
              <span class="pstrut" style="height: 3em;">
              </span>
              <span class="mord mathnormal" style="margin-right: 0.0278em;">
               O
              </span>
             </span>
             <span class="" style="top: -3.2523em;">
              <span class="pstrut" style="height: 3em;">
              </span>
              <span class="accent-body" style="left: -0.1667em;">
               <span class="mord">
                Ë‰
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     åˆ†åˆ«ä¸ºé¢„æµ‹å’Œè§‚æµ‹å‡å€¼ã€‚
     <br/>
     2ã€å¹³å‡ç»å¯¹ç›¸å¯¹è¯¯å·®ï¼Œè®¡ç®—é¢„æµ‹å€¼ä¸è§‚æµ‹å€¼çš„ç›¸å¯¹åå·®ï¼Œå€¼è¶Šå°è¶Šå¥½ï¼ˆ0ä¸ºæœ€å°å€¼ï¼‰ï¼š
     <br/>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        A 
        
       
         A 
        
       
         R 
        
       
         E 
        
       
         = 
        
        
        
          1 
         
        
          n 
         
        
        
        
          âˆ‘ 
         
         
         
           i 
          
         
           = 
          
         
           1 
          
         
        
          n 
         
        
        
        
          âˆ£ 
         
         
          
           
           
             F 
            
           
             i 
            
           
             p 
            
           
          
            âˆ’ 
           
           
           
             O 
            
           
             i 
            
           
             p 
            
           
          
          
          
            O 
           
          
            i 
           
          
            p 
           
          
         
        
          âˆ£ 
         
        
       
      
        A A R E=\frac{1}{n} \sum_{i=1}^n\left|\frac{F_i^p-O_i^p}{O_i^p}\right|
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal">
          AA
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0576em;">
          RE
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.8em; vertical-align: -0.65em;">
         </span>
         <span class="mord">
          <span class="mopen nulldelimiter">
          </span>
          <span class="mfrac">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8451em;">
              <span class="" style="top: -2.655em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  n
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.23em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="frac-line" style="border-bottom-width: 0.04em;">
               </span>
              </span>
              <span class="" style="top: -3.394em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.345em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose nulldelimiter">
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mop">
          <span class="mop op-symbol small-op" style="position: relative; top: 0em;">
           âˆ‘
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8043em;">
              <span class="" style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mrel mtight">
                  =
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.2029em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 n
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2997em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="minner">
          <span class="mopen">
           <span class="delimsizing mult">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.15em;">
               <span class="" style="top: -3.15em;">
                <span class="pstrut" style="height: 3.8em;">
                </span>
                <span class="" style="width: 0.333em; height: 1.8em;">
                 <svg height="1.800em" viewbox="0 0 333 1800" width="0.333em">
                  <path d="M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z">
                  </path>
                 </svg>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.65em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mord">
           <span class="mopen nulldelimiter">
           </span>
           <span class="mfrac">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.0895em;">
               <span class="" style="top: -2.6361em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                    O
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.7912em;">
                       <span class="" style="top: -2.1777em; margin-left: -0.0278em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mathnormal mtight">
                          i
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -2.9837em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mathnormal mtight">
                          p
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3223em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.23em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="frac-line" style="border-bottom-width: 0.04em;">
                </span>
               </span>
               <span class="" style="top: -3.5356em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                    F
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.7912em;">
                       <span class="" style="top: -2.1777em; margin-left: -0.1389em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mathnormal mtight">
                          i
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -2.9837em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mathnormal mtight">
                          p
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3223em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mbin mtight">
                   âˆ’
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                    O
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.7912em;">
                       <span class="" style="top: -2.1777em; margin-left: -0.0278em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mathnormal mtight">
                          i
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -2.9837em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mathnormal mtight">
                          p
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3223em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.5895em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mclose nulldelimiter">
           </span>
          </span>
          <span class="mclose">
           <span class="delimsizing mult">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.15em;">
               <span class="" style="top: -3.15em;">
                <span class="pstrut" style="height: 3.8em;">
                </span>
                <span class="" style="width: 0.333em; height: 1.8em;">
                 <svg height="1.800em" viewbox="0 0 333 1800" width="0.333em">
                  <path d="M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z">
                  </path>
                 </svg>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.65em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     ğ‘›ä¸ºæ ·æœ¬æ•°ï¼›
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        F 
         
        
          i 
         
        
          p 
         
        
       
      
        F_i^p
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.0592em; vertical-align: -0.2769em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.1389em;">
           F
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7823em;">
              <span class="" style="top: -2.4231em; margin-left: -0.1389em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
              <span class="" style="top: -3.1809em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 p
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2769em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ä¸ºé¢„æµ‹å€¼ï¼›
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
         
        
          i 
         
        
          p 
         
        
       
      
        O_i^p
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.0592em; vertical-align: -0.2769em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           O
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7823em;">
              <span class="" style="top: -2.4231em; margin-left: -0.0278em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
              <span class="" style="top: -3.1809em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 p
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2769em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ä¸ºè§‚æµ‹å€¼ã€‚
     <br/>
     3ã€é¢„æµ‹åŒºé—´è¦†ç›–æ¦‚ç‡ï¼Œè¡¡é‡è§‚æµ‹å€¼è½å…¥é¢„æµ‹åŒºé—´çš„æ¯”ä¾‹ï¼Œæœ€ä½³å€¼ä¸º1ï¼š
     <br/>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        P 
        
       
         I 
        
       
         C 
        
       
         P 
        
       
         = 
        
        
        
          1 
         
        
          n 
         
        
        
        
          âˆ‘ 
         
         
         
           i 
          
         
           = 
          
         
           1 
          
         
        
          n 
         
        
        
        
          Îµ 
         
        
          i 
         
        
       
         , 
        
        
        
        
          Îµ 
         
        
          i 
         
        
       
         = 
        
       
         1 
        
       
      
        P I C P=\frac{1}{n} \sum_{i=1}^n \varepsilon_i, \quad \varepsilon_i=1
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1389em;">
          P
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0785em;">
          I
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1389em;">
          CP
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.1901em; vertical-align: -0.345em;">
         </span>
         <span class="mord">
          <span class="mopen nulldelimiter">
          </span>
          <span class="mfrac">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8451em;">
              <span class="" style="top: -2.655em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  n
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.23em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="frac-line" style="border-bottom-width: 0.04em;">
               </span>
              </span>
              <span class="" style="top: -3.394em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.345em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose nulldelimiter">
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mop">
          <span class="mop op-symbol small-op" style="position: relative; top: 0em;">
           âˆ‘
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8043em;">
              <span class="" style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mrel mtight">
                  =
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.2029em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 n
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2997em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           Îµ
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 1em;">
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           Îµ
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          1
         </span>
        </span>
       </span>
      </span>
     </span>
     if
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
         
        
          i 
         
        
       
         âˆˆ 
        
        
        
          [ 
         
         
         
           L 
          
         
           i 
          
         
        
          , 
         
         
         
           U 
          
         
           i 
          
         
        
          ] 
         
        
       
      
        O_i \in\left[L_i, U_i\right]
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8333em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           O
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          âˆˆ
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="minner">
          <span class="mopen delimcenter" style="top: 0em;">
           [
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            L
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.109em;">
            U
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: -0.109em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose delimcenter" style="top: 0em;">
           ]
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     , else 0
     <br/>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        L 
         
        
          i 
         
        
       
      
        L_i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8333em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           L
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ä¸
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        U 
         
        
          i 
         
        
       
      
        U_i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8333em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.109em;">
           U
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.109em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ä¸ºé¢„æµ‹åŒºé—´çš„ä¸Šä¸‹ç•Œã€‚
     <br/>
     4ã€é¢„æµ‹åŒºé—´å½’ä¸€åŒ–å¹³å‡å®½åº¦ï¼Œè¯„ä¼°é¢„æµ‹åŒºé—´çš„å®½åº¦ï¼Œæœ€ä½³å€¼ä¸º0ï¼š
     <br/>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        P 
        
       
         I 
        
       
         N 
        
       
         A 
        
       
         W 
        
       
         = 
        
        
        
          1 
         
         
         
           n 
          
         
           R 
          
         
        
        
        
          âˆ‘ 
         
         
         
           i 
          
         
           = 
          
         
           1 
          
         
        
          n 
         
        
        
        
          ( 
         
         
         
           U 
          
         
           i 
          
         
        
          âˆ’ 
         
         
         
           L 
          
         
           i 
          
         
        
          ) 
         
        
       
         , 
        
        
       
         R 
        
       
         = 
        
       
         max 
        
       
         â¡ 
        
        
        
          ( 
         
         
         
           O 
          
         
           i 
          
         
        
          ) 
         
        
       
         âˆ’ 
        
       
         min 
        
       
         â¡ 
        
        
        
          ( 
         
         
         
           O 
          
         
           i 
          
         
        
          ) 
         
        
       
      
        PINAW =\frac{1}{n R} \sum_{i=1}^n\left(U_i-L_i\right), \quad R=\max \left(O_i\right)-\min \left(O_i\right)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1389em;">
          P
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0785em;">
          I
         </span>
         <span class="mord mathnormal" style="margin-right: 0.109em;">
          N
         </span>
         <span class="mord mathnormal">
          A
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1389em;">
          W
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.1901em; vertical-align: -0.345em;">
         </span>
         <span class="mord">
          <span class="mopen nulldelimiter">
          </span>
          <span class="mfrac">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8451em;">
              <span class="" style="top: -2.655em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  n
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0077em;">
                  R
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.23em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="frac-line" style="border-bottom-width: 0.04em;">
               </span>
              </span>
              <span class="" style="top: -3.394em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.345em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose nulldelimiter">
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mop">
          <span class="mop op-symbol small-op" style="position: relative; top: 0em;">
           âˆ‘
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8043em;">
              <span class="" style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mrel mtight">
                  =
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.2029em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 n
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              â€‹
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2997em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="minner">
          <span class="mopen delimcenter" style="top: 0em;">
           (
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.109em;">
            U
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: -0.109em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           âˆ’
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            L
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose delimcenter" style="top: 0em;">
           )
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 1em;">
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0077em;">
          R
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mop">
          max
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="minner">
          <span class="mopen delimcenter" style="top: 0em;">
           (
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0278em;">
            O
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose delimcenter" style="top: 0em;">
           )
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          âˆ’
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mop">
          min
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="minner">
          <span class="mopen delimcenter" style="top: 0em;">
           (
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0278em;">
            O
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose delimcenter" style="top: 0em;">
           )
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     Rä¸ºè§‚æµ‹å€¼èŒƒå›´ï¼›
     <br/>
     5ã€è¦†ç›–å®½åº¦ç»¼åˆå‡†åˆ™ï¼Œå¹³è¡¡è¦†ç›–ç‡å’ŒåŒºé—´å®½åº¦ï¼ŒPICPä½äºğœ‡æ—¶æ–½åŠ æŒ‡æ•°æƒ©ç½šï¼Œ0ä¸ºæœ€ä½³å€¼ï¼š
     <br/>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        C 
        
       
         W 
        
       
         C 
        
       
         = 
        
       
         P 
        
       
         I 
        
       
         N 
        
       
         A 
        
       
         W 
        
        
        
          ( 
         
        
          1 
         
        
          + 
         
        
          Î³ 
         
         
         
           e 
          
          
          
            Î· 
           
          
            ( 
           
          
            Î¼ 
           
          
            âˆ’ 
           
          
            P 
           
          
            I 
           
          
            C 
           
          
            P 
           
          
            ) 
           
          
         
        
          ) 
         
        
       
         , 
        
        
       
         Î³ 
        
       
         ( 
        
       
         P 
        
       
         I 
        
       
         C 
        
       
         P 
        
       
         ) 
        
       
         = 
        
       
         1 
        
       
      
        C W C=P I N A W\left(1+\gamma e^{\eta(\mu-P I C P)}\right), \quad \gamma(P I C P)=1
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0715em;">
          C
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1389em;">
          W
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0715em;">
          C
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.238em; vertical-align: -0.35em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1389em;">
          P
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0785em;">
          I
         </span>
         <span class="mord mathnormal" style="margin-right: 0.109em;">
          N
         </span>
         <span class="mord mathnormal">
          A
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1389em;">
          W
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="minner">
          <span class="mopen delimcenter" style="top: 0em;">
           <span class="delimsizing size1">
            (
           </span>
          </span>
          <span class="mord">
           1
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           +
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0556em;">
           Î³
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            e
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.888em;">
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0359em;">
                   Î·
                  </span>
                  <span class="mopen mtight">
                   (
                  </span>
                  <span class="mord mathnormal mtight">
                   Î¼
                  </span>
                  <span class="mbin mtight">
                   âˆ’
                  </span>
                  <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                   P
                  </span>
                  <span class="mord mathnormal mtight" style="margin-right: 0.0785em;">
                   I
                  </span>
                  <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                   CP
                  </span>
                  <span class="mclose mtight">
                   )
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose delimcenter" style="top: 0em;">
           <span class="delimsizing size1">
            )
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 1em;">
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0556em;">
          Î³
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1389em;">
          P
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0785em;">
          I
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1389em;">
          CP
         </span>
         <span class="mclose">
          )
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          1
         </span>
        </span>
       </span>
      </span>
     </span>
     if
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        P 
        
       
         I 
        
       
         C 
        
       
         P 
        
       
         &lt; 
        
       
         Î¼ 
        
       
      
        P I C P&lt;\mu
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7224em; vertical-align: -0.0391em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1389em;">
          P
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0785em;">
          I
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1389em;">
          CP
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          &lt;
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          Î¼
         </span>
        </span>
       </span>
      </span>
     </span>
     , else 0
     <br/>
     Î¼ä¸ºæœŸæœ›è¦†ç›–ç‡ï¼›ğœ‚ä¸ºæƒ©ç½šç³»æ•°ï¼›
     <br/>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/bb3f437f8f5b4c38b7ed3b1e7ca12fb6.png">
      <br/>
      <strong>
       ç»“æœå¦‚ä¸‹ï¼š
      </strong>
      <br/>
      è®ºæ–‡é€šè¿‡äºŒç»´t-SNEå’ŒPCAä¸¤ç§é™ç»´æ–¹æ³•å¯¹åŸå§‹æ´ªæ°´æ—¶é—´åºåˆ—ã€TimeGANç”Ÿæˆçš„åˆæˆåºåˆ—ä»¥åŠRTSGANç”Ÿæˆçš„åˆæˆåºåˆ—è¿›è¡Œäº†å¯è§†åŒ–åˆ†æã€‚ç»“æœè¡¨æ˜ï¼ŒRTSGANç”Ÿæˆçš„åˆæˆåºåˆ—åœ¨åˆ†å¸ƒä¸Šä¸åŸå§‹æ•°æ®é›†æ›´ä¸ºæ¥è¿‘ï¼Œè¡¨ç°ä¸ºæ•°æ®ç‚¹ç°‡çš„å½¢çŠ¶å’Œå¯†åº¦æ›´è´´è¿‘åŸå§‹æ•°æ®ï¼Œè€ŒTimeGANç”Ÿæˆçš„åºåˆ—åˆ†å¸ƒåˆ™ç¨æ˜¾åˆ†æ•£ï¼Œåç¦»åŸå§‹æ•°æ®çš„ç‰¹å¾ã€‚æ­¤å¤–ï¼ŒRTSGANç”Ÿæˆçš„æ•°æ®ç‚¹ä¸ä»…æ›´é›†ä¸­ï¼Œè¿˜å±•ç°å‡ºæ›´é«˜çš„å¤šæ ·æ€§ã€‚
      <br/>
      <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/3765d0b8351d4a4589584708277ad9bf.png">
       <br/>
       å›¾6é€šè¿‡çƒ­å›¾å½¢å¼å±•ç¤ºäº†åŸå§‹æ•°æ®é›†ã€TimeGANå’ŒRTSGANç”Ÿæˆåºåˆ—åœ¨ä¸åŒæ—¶é—´æ»å ğœ ä¸‹çš„æ—¶é—´ç›¸å…³æ€§å¯¹æ¯”ã€‚çƒ­å›¾ä¸­ï¼Œé¢œè‰²æ·±æµ…è¡¨ç¤ºç›¸å…³ç³»æ•°çš„å¤§å°ï¼ŒRTSGANçš„çƒ­å›¾æ¨¡å¼ä¸åŸå§‹æ•°æ®é«˜åº¦ä¸€è‡´ï¼Œå°¤å…¶æ˜¯åœ¨æ—¥å°ºåº¦ä¸Šï¼Œæ¢§å·ç«™ç‚¹çš„åˆæˆåºåˆ—æ—¶é—´ç›¸å…³ç³»æ•°å‡ ä¹å®Œå…¨é‡åˆåŸå§‹æ•°æ®ã€‚è¿™è¡¨æ˜RTSGANèƒ½å¤Ÿç²¾ç¡®å†ç°æ´ªæ°´åºåˆ—çš„æ—¶é—´ä¾èµ–æ€§ï¼Œä¾‹å¦‚æ´ªå³°çš„åˆ°è¾¾æ—¶é—´å’Œè¡°é€€è¿‡ç¨‹ã€‚
       <br/>
       åœ¨å°æ—¶å°ºåº¦ä¸Šï¼Œç”±äºæ—¶é—´æ­¥é•¿æ›´å°ï¼Œåºåˆ—é•¿åº¦å¢åŠ ï¼Œå¯¹æ¨¡å‹æ•æ‰é•¿æœŸä¾èµ–æ€§çš„è¦æ±‚æ›´é«˜ã€‚RTSGANä¾ç„¶è¡¨ç°å‡ºè‰²ï¼Œå…¶çƒ­å›¾æ˜¾ç¤ºçš„ç©ºé—´ç›¸å…³æ€§å’Œæ—¶é—´ç›¸å…³æ€§å‡ä¼˜äºTimeGANã€‚è¿™å¯èƒ½æ˜¯ç”±äºRTSGANçš„è‡ªå›å½’è§£ç å™¨è®¾è®¡ï¼Œèƒ½å¤Ÿé€æ­¥ç”Ÿæˆåºåˆ—å¹¶ä¿ç•™é•¿æœŸä¾èµ–ã€‚RTSGANè®­ç»ƒæ—¶é—´æ›´çŸ­ã€‚
       <br/>
       <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/215f472b4af64b1e9a795870d008d4fc.png"/>
       <br/>
       åœ¨å¤šæ—¶é—´æ­¥é¢„æµ‹ä»»åŠ¡ä¸­ï¼Œè®ºæ–‡æ¯”è¾ƒäº†GBRTã€LSTMã€QRLSTMç­‰æ¨¡å‹çš„æ€§èƒ½ï¼Œå›¾7å±•ç¤ºäº†æ—¥å°ºåº¦ä¸‹å„æ¨¡å‹åœ¨Tã€T+1ã€T+2çš„è¯„ä¼°æŒ‡æ ‡ç®±çº¿å›¾ï¼ŒåŒ…æ‹¬OCã€AAREç­‰ã€‚ç»“æœæ˜¾ç¤ºï¼ŒLSTMåœ¨æ‰€æœ‰é¢„æµ‹æ­¥é•¿ä¸­çš„OCæœ€é«˜ï¼ŒAAREæœ€ä½ï¼Œä¸”éšç€é¢„æµ‹æœŸä»Tåˆ°T+2å¢åŠ ï¼Œå…¶ä¼˜åŠ¿é€æ¸æ‰©å¤§ã€‚ä¾‹å¦‚ï¼Œç®±çº¿å›¾ä¸­LSTMçš„ä¸­ä½æ•°OCå€¼å¯èƒ½æ¥è¿‘1ï¼Œç¦»ç¾¤ç‚¹è¾ƒå°‘ï¼Œè€Œå…¶ä»–æ¨¡å‹çš„OCåˆ†å¸ƒæ›´åˆ†æ•£ï¼ŒAAREæ›´é«˜ã€‚LSTMâ€œä¸‰é—¨â€æœºåˆ¶ä½¿LSTMèƒ½å¤Ÿæœ‰æ•ˆæ•æ‰æ´ªæ°´æ—¶é—´åºåˆ—ä¸­çš„é•¿æœŸä¾èµ–å…³ç³»ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒGBRTåŸºäºçª—å£çš„ç‰¹å¾æå–æ›´é€‚åˆçŸ­æœŸä¾èµ–ï¼Œè€ŒQRLSTMåœ¨ä¸ç¡®å®šæ€§é¢„æµ‹ä¸Šè™½æœ‰ä¼˜åŠ¿ï¼Œä½†åœ¨ç‚¹é¢„æµ‹å‡†ç¡®æ€§ä¸Šä¸å¦‚æ ‡å‡†LSTMã€‚
       <br/>
       <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/6f7374201dd84216a870ff719e894079.png"/>
       <br/>
       RTSGANç”Ÿæˆçš„åˆæˆæ•°æ®é›†èƒ½æ˜¾è‘—æå‡åŸºäºçª—å£çš„GBRTæ¨¡å‹æ€§èƒ½ï¼Œå°¤å…¶åœ¨è¾ƒé•¿é¢„æµ‹æœŸã€‚åœ¨24å°æ—¶é¢„æµ‹ä¸­ï¼ŒGBRT - RTSGANåœ¨CCå’ŒNSEæŒ‡æ ‡ä¸Šåˆ†åˆ«æ¯”GBRTé«˜2.08%å’Œ6.74%ï¼ŒRMSEé™ä½ï¼ŒAAREå‡å°‘56.52%ã€‚è€ŒTimeGANå¯¹GBRTçš„æ”¹è¿›æ•ˆæœæœ‰é™ä¸”ä¸ç¨³å®šï¼Œå…¶åˆæˆè®­ç»ƒé›†ç”šè‡³ä¼šå¯¼è‡´è¯¯å·®èŒƒå›´å¢å¤§ã€‚åˆæˆæ•°æ®é›†å¯¹LSTMçš„æœ‰æ•ˆæ€§éšé¢„æµ‹æœŸå¢åŠ è€Œæ€¥å‰§ä¸‹é™ã€‚
       <br/>
       <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/6737e95ee46f48909105b2555e94becd.png"/>
       <br/>
       SHAPåˆ†æç”¨äºè§£é‡Šæ¨¡å‹é¢„æµ‹ä¸­å„ç‰¹å¾çš„é‡è¦æ€§ï¼Œé€šè¿‡SHAPåˆ†æå‘ç°ï¼ŒGBRTå’ŒGBRT - RTSGANæ¨¡å‹ä½¿ç”¨å‡ ä¹ç›¸åŒçš„å½±å“å› ç´ è¿›è¡Œé¢„æµ‹ï¼Œä¸”å½¢çŠ¶å€¼æ¨¡å¼è¶‹åŠ¿ä¸€è‡´ï¼›è€ŒGBRT - TimeGANä»T + 5æ­¥å¼€å§‹ä¸GBRTçš„å½¢çŠ¶å€¼æ¨¡å¼å·®å¼‚è¾ƒå¤§ã€‚
       <br/>
       <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/2a6988c485524be0b0ad484b6924319d.png"/>
       <br/>
       å¼•å…¥åˆæˆè®­ç»ƒæ•°æ®é›†å¯å¸®åŠ©QRLSTMæ¨¡å‹è·å¾—æ›´ä½çš„PINAWï¼Œä½†ä¼šé™PICPï¼Œåªæœ‰å°‘æ•°æƒ…å†µèƒ½åœ¨ä¿æŒåŒºé—´è¦†ç›–çš„åŒæ—¶å‡å°åŒºé—´å®½åº¦ã€‚å›¾12ç»“æœæ˜¾ç¤ºï¼Œä½¿ç”¨RTSGANæˆ–TimeGANçš„åˆæˆæ•°æ®åï¼ŒQRLSTMçš„PINAWé™ä½ï¼Œä¾‹å¦‚ä»0.15é™è‡³0.10ï¼Œè¡¨æ˜é¢„æµ‹åŒºé—´æ›´çª„ã€æ›´ç²¾ç¡®ã€‚ä½†æ˜¯PICPä»0.95é™è‡³0.85ï¼Œè¯´æ˜éƒ¨åˆ†è§‚æµ‹å€¼æœªè¢«åŒºé—´è¦†ç›–ã€‚è¿™ç§æƒè¡¡è¡¨æ˜åˆæˆæ•°æ®å¢å¼ºäº†æ¨¡å‹çš„å‡†ç¡®æ€§ï¼Œä½†ç‰ºç‰²äº†è¦†ç›–ç‡ã€‚åªæœ‰å°‘æ•°æƒ…å†µå®ç°äº†PINAWé™ä½çš„åŒæ—¶ä¿æŒPICPæ¥0.9ã€‚
       <br/>
       éšç€åˆæˆæ•°æ®é›†æ•°é‡å¢åŠ ï¼ŒPINAWå’ŒPICPé™ä½ï¼Œæ¨¡å‹çš„CWCä¸‹é™ã€‚RTSGANå¯¹PINAWçš„å½±å“æ›´å¤§ï¼Œè¡¨æ˜å¯é€šè¿‡è°ƒèŠ‚å‡æ ·æœ¬æ•°é‡ä½¿é¢„æµ‹åŒºé—´æ›´çµæ´»ã€æ˜“è°ƒæ•´ã€‚å°½ç®¡åˆæˆè®­ç»ƒé›†åœ¨QRLSTMä¸­è¡¨ç°ä¸ä½³ï¼Œä½†åœ¨æ´ªæ°´å³°å€¼å¤„è¾ƒçª„çš„é¢„æµ‹åŒºé—´æ˜¯å¯å–çš„ã€‚
       <br/>
       <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/7bc8f1d96b42428190f5f2767bdd526c.png"/>
      </img>
     </img>
    </p>
    <p>
     <strong>
      ä»£ç å¦‚ä¸‹ï¼š
     </strong>
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np  
<span class="token keyword">import</span> torch  
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn  
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>optim <span class="token keyword">as</span> optim  <span class="token comment"># å¯¼å…¥PyTorchçš„ä¼˜åŒ–å™¨æ¨¡å—</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> GradientBoostingRegressor  <span class="token comment"># å¯¼å…¥sklearnçš„GBRTæ¨¡å‹</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> mean_squared_error  <span class="token comment"># å¯¼å…¥sklearnçš„å‡æ–¹è¯¯å·®è®¡ç®—å‡½æ•°</span>
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt  

<span class="token comment"># è®¾ç½®éšæœºç§å­ï¼Œç¡®ä¿ç»“æœå¯é‡å¤</span>
np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span>
torch<span class="token punctuation">.</span>manual_seed<span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span>

<span class="token comment"># å®šä¹‰æ•°æ®å‚æ•°</span>
n_samples <span class="token operator">=</span> <span class="token number">1755</span>  <span class="token comment"># æ ·æœ¬æ•°é‡ï¼Œå‚è€ƒè®ºæ–‡å°æ—¶å°ºåº¦æ•°æ®</span>
n_features <span class="token operator">=</span> <span class="token number">3</span>  <span class="token comment"># ç‰¹å¾æ•°é‡ï¼ˆå‡è®¾æµé‡ã€é™é›¨é‡ç­‰ï¼‰</span>
seq_len <span class="token operator">=</span> <span class="token number">16</span>  <span class="token comment"># åºåˆ—é•¿åº¦ï¼ˆçª—å£å¤§å°ï¼Œ48å°æ—¶ï¼Œæ¯3å°æ—¶ä¸€ä¸ªæ—¶é—´æ­¥ï¼‰</span>

<span class="token comment"># ç”Ÿæˆæ¨¡æ‹Ÿæ´ªæ°´æ—¶é—´åºåˆ—æ•°æ®ï¼Œå‡è®¾æ•°æ®æœä»æ­£å¼¦æ³¢+å™ªå£°çš„å½¢å¼</span>
time_steps <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>seq_len<span class="token punctuation">)</span>  <span class="token comment"># åˆ›å»ºæ—¶é—´æ­¥æ•°ç»„</span>
data <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>n_samples<span class="token punctuation">,</span> seq_len<span class="token punctuation">,</span> n_features<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># åˆå§‹åŒ–æ•°æ®æ•°ç»„</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_samples<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> f <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_features<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># ç”Ÿæˆæ­£å¼¦æ³¢æ•°æ®ï¼Œæ¨¡æ‹Ÿå‘¨æœŸæ€§æ´ªæ°´ç‰¹å¾</span>
        data<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">,</span> f<span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span><span class="token number">0.1</span> <span class="token operator">*</span> time_steps <span class="token operator">+</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>pi<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> seq_len<span class="token punctuation">)</span>

<span class="token comment"># å°†æ•°æ®è½¬æ¢ä¸ºPyTorchå¼ é‡</span>
data <span class="token operator">=</span> torch<span class="token punctuation">.</span>FloatTensor<span class="token punctuation">(</span>data<span class="token punctuation">)</span>  <span class="token comment"># è½¬æ¢ä¸ºæµ®ç‚¹å¼ é‡ï¼Œå½¢çŠ¶ä¸º[n_samples, seq_len, n_features]</span>

<span class="token comment"># å®šä¹‰GRUç½‘ç»œç±»ï¼Œä½œä¸ºTimeGANçš„åŸºç¡€æ¨¡å—</span>
<span class="token keyword">class</span> <span class="token class-name">GRU</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_dim<span class="token punctuation">,</span> hidden_dim<span class="token punctuation">,</span> num_layers<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>GRU<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>hidden_dim <span class="token operator">=</span> hidden_dim  <span class="token comment"># è®¾ç½®éšè—å±‚ç»´åº¦</span>
        self<span class="token punctuation">.</span>num_layers <span class="token operator">=</span> num_layers  <span class="token comment"># è®¾ç½®GRUå±‚æ•°</span>
        self<span class="token punctuation">.</span>gru <span class="token operator">=</span> nn<span class="token punctuation">.</span>GRU<span class="token punctuation">(</span>input_dim<span class="token punctuation">,</span> hidden_dim<span class="token punctuation">,</span> num_layers<span class="token punctuation">,</span> batch_first<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># å®šä¹‰GRUå±‚</span>

    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># åˆå§‹åŒ–éšè—çŠ¶æ€</span>
        h0 <span class="token operator">=</span> torch<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>self<span class="token punctuation">.</span>num_layers<span class="token punctuation">,</span> x<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>hidden_dim<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>x<span class="token punctuation">.</span>device<span class="token punctuation">)</span>
        <span class="token comment"># å‰å‘ä¼ æ’­</span>
        out<span class="token punctuation">,</span> _ <span class="token operator">=</span> self<span class="token punctuation">.</span>gru<span class="token punctuation">(</span>x<span class="token punctuation">,</span> h0<span class="token punctuation">)</span>
        <span class="token keyword">return</span> out

<span class="token comment"># å®šä¹‰TimeGANæ¨¡å‹</span>
<span class="token keyword">class</span> <span class="token class-name">TimeGAN</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_dim<span class="token punctuation">,</span> hidden_dim<span class="token punctuation">,</span> num_layers<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>TimeGAN<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>hidden_dim <span class="token operator">=</span> hidden_dim  <span class="token comment"># è®¾ç½®éšè—å±‚ç»´åº¦</span>
        self<span class="token punctuation">.</span>input_dim <span class="token operator">=</span> input_dim  <span class="token comment"># è®¾ç½®è¾“å…¥ç»´åº¦</span>

        <span class="token comment"># åµŒå…¥å‡½æ•°ï¼ˆEmbedding Functionï¼‰</span>
        self<span class="token punctuation">.</span>embedder <span class="token operator">=</span> GRU<span class="token punctuation">(</span>input_dim<span class="token punctuation">,</span> hidden_dim<span class="token punctuation">,</span> num_layers<span class="token punctuation">)</span>  <span class="token comment"># å®šä¹‰åµŒå…¥å‡½æ•°ï¼Œä½¿ç”¨GRUç½‘ç»œ</span>
        <span class="token comment"># æ¢å¤å‡½æ•°ï¼ˆRecovery Functionï¼‰</span>
        self<span class="token punctuation">.</span>recovery <span class="token operator">=</span> nn<span class="token punctuation">.</span>Sequential<span class="token punctuation">(</span>
            nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>hidden_dim<span class="token punctuation">,</span> input_dim<span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># çº¿æ€§å±‚ï¼Œå°†éšè—çŠ¶æ€æ˜ å°„å›è¾“å…¥ç»´åº¦</span>
            nn<span class="token punctuation">.</span>Sigmoid<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># Sigmoidæ¿€æ´»ï¼Œç¡®ä¿è¾“å‡ºåœ¨[0, 1]èŒƒå›´å†…</span>
        <span class="token punctuation">)</span>
        <span class="token comment"># ç”Ÿæˆå™¨ï¼ˆGeneratorï¼‰</span>
        self<span class="token punctuation">.</span>generator <span class="token operator">=</span> GRU<span class="token punctuation">(</span>hidden_dim<span class="token punctuation">,</span> hidden_dim<span class="token punctuation">,</span> num_layers<span class="token punctuation">)</span>  <span class="token comment"># å®šä¹‰ç”Ÿæˆå™¨ï¼Œä½¿ç”¨GRUç½‘ç»œ</span>
        self<span class="token punctuation">.</span>gen_output <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>hidden_dim<span class="token punctuation">,</span> hidden_dim<span class="token punctuation">)</span>  <span class="token comment"># çº¿æ€§å±‚ï¼Œç”Ÿæˆæ½œåœ¨è¡¨ç¤º</span>
        <span class="token comment"># åˆ¤åˆ«å™¨ï¼ˆDiscriminatorï¼‰</span>
        self<span class="token punctuation">.</span>discriminator <span class="token operator">=</span> GRU<span class="token punctuation">(</span>hidden_dim<span class="token punctuation">,</span> hidden_dim<span class="token punctuation">,</span> num_layers<span class="token punctuation">)</span>  <span class="token comment"># å®šä¹‰åˆ¤åˆ«å™¨ï¼Œä½¿ç”¨GRUç½‘ç»œ</span>
        self<span class="token punctuation">.</span>dis_output <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>hidden_dim<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># çº¿æ€§å±‚ï¼Œè¾“å‡ºåˆ¤åˆ«ç»“æœ</span>

    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># åµŒå…¥ï¼šå°†è¾“å…¥æ•°æ®æ˜ å°„åˆ°æ½œåœ¨ç©ºé—´</span>
        h <span class="token operator">=</span> self<span class="token punctuation">.</span>embedder<span class="token punctuation">(</span>x<span class="token punctuation">)</span>  <span class="token comment"># é€šè¿‡åµŒå…¥å‡½æ•°ç”Ÿæˆæ½œåœ¨è¡¨ç¤ºh</span>
        <span class="token comment"># æ¢å¤ï¼šä»æ½œåœ¨ç©ºé—´é‡å»ºè¾“å…¥æ•°æ®</span>
        x_tilde <span class="token operator">=</span> self<span class="token punctuation">.</span>recovery<span class="token punctuation">(</span>h<span class="token punctuation">)</span>  <span class="token comment"># é€šè¿‡æ¢å¤å‡½æ•°é‡å»ºæ•°æ®</span>
        <span class="token keyword">return</span> h<span class="token punctuation">,</span> x_tilde

    <span class="token keyword">def</span> <span class="token function">generate</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># ç”Ÿæˆå™¨ï¼šä»å™ªå£°ç”Ÿæˆæ½œåœ¨è¡¨ç¤º</span>
        h_hat <span class="token operator">=</span> self<span class="token punctuation">.</span>generator<span class="token punctuation">(</span>z<span class="token punctuation">)</span>  <span class="token comment"># é€šè¿‡ç”Ÿæˆå™¨ç”Ÿæˆæ½œåœ¨è¡¨ç¤º</span>
        h_hat <span class="token operator">=</span> self<span class="token punctuation">.</span>gen_output<span class="token punctuation">(</span>h_hat<span class="token punctuation">)</span>  <span class="token comment"># æ˜ å°„åˆ°æ½œåœ¨ç©ºé—´</span>
        <span class="token comment"># æ¢å¤ï¼šä»ç”Ÿæˆçš„æ½œåœ¨è¡¨ç¤ºç”Ÿæˆæ•°æ®</span>
        x_hat <span class="token operator">=</span> self<span class="token punctuation">.</span>recovery<span class="token punctuation">(</span>h_hat<span class="token punctuation">)</span>  <span class="token comment"># é€šè¿‡æ¢å¤å‡½æ•°ç”Ÿæˆåˆæˆæ•°æ®</span>
        <span class="token keyword">return</span> x_hat

<span class="token comment"># è®¾ç½®æ¨¡å‹å‚æ•°</span>
input_dim <span class="token operator">=</span> n_features  <span class="token comment"># è¾“å…¥ç»´åº¦ï¼ˆç‰¹å¾æ•°ï¼‰</span>
hidden_dim <span class="token operator">=</span> <span class="token number">24</span>  <span class="token comment"># éšè—å±‚ç»´åº¦ï¼Œå‚è€ƒè®ºæ–‡ä¸­çš„è®¾ç½®</span>
num_layers <span class="token operator">=</span> <span class="token number">3</span>  <span class="token comment"># GRUå±‚æ•°</span>

<span class="token comment"># åˆå§‹åŒ–TimeGANæ¨¡å‹</span>
timegan <span class="token operator">=</span> TimeGAN<span class="token punctuation">(</span>input_dim<span class="token punctuation">,</span> hidden_dim<span class="token punctuation">,</span> num_layers<span class="token punctuation">)</span>

<span class="token comment"># å®šä¹‰æŸå¤±å‡½æ•°</span>
mse_loss <span class="token operator">=</span> nn<span class="token punctuation">.</span>MSELoss<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># å‡æ–¹è¯¯å·®æŸå¤±ï¼Œç”¨äºè‡ªç¼–ç å’Œç›‘ç£æŸå¤±</span>
bce_loss <span class="token operator">=</span> nn<span class="token punctuation">.</span>BCEWithLogitsLoss<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># äºŒå…ƒäº¤å‰ç†µæŸå¤±ï¼Œç”¨äºå¯¹æŠ—æŸå¤±</span>

<span class="token comment"># å®šä¹‰ä¼˜åŒ–å™¨</span>
optimizer_E <span class="token operator">=</span> optim<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>timegan<span class="token punctuation">.</span>embedder<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">list</span><span class="token punctuation">(</span>timegan<span class="token punctuation">.</span>recovery<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">)</span>  <span class="token comment"># åµŒå…¥å’Œæ¢å¤ä¼˜åŒ–å™¨</span>
optimizer_G <span class="token operator">=</span> optim<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>timegan<span class="token punctuation">.</span>generator<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">list</span><span class="token punctuation">(</span>timegan<span class="token punctuation">.</span>gen_output<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">)</span>  <span class="token comment"># ç”Ÿæˆå™¨ä¼˜åŒ–å™¨</span>
optimizer_D <span class="token operator">=</span> optim<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>timegan<span class="token punctuation">.</span>discriminator<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">list</span><span class="token punctuation">(</span>timegan<span class="token punctuation">.</span>dis_output<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">)</span>  <span class="token comment"># åˆ¤åˆ«å™¨ä¼˜åŒ–å™¨</span>

<span class="token comment"># è®­ç»ƒTimeGAN</span>
num_epochs <span class="token operator">=</span> <span class="token number">100</span>  <span class="token comment"># è®­ç»ƒè½®æ•°</span>
batch_size <span class="token operator">=</span> <span class="token number">128</span>  <span class="token comment"># æ‰¹æ¬¡å¤§å°</span>
<span class="token keyword">for</span> epoch <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> n_samples<span class="token punctuation">,</span> batch_size<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># è·å–æ‰¹æ¬¡æ•°æ®</span>
        batch_data <span class="token operator">=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> batch_size<span class="token punctuation">]</span><span class="token punctuation">.</span>cuda<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> data<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> batch_size<span class="token punctuation">]</span>

        <span class="token comment"># è®­ç»ƒåµŒå…¥å’Œæ¢å¤ï¼ˆè‡ªç¼–ç æŸå¤±ï¼‰</span>
        optimizer_E<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># æ¸…é›¶æ¢¯åº¦</span>
        h<span class="token punctuation">,</span> x_tilde <span class="token operator">=</span> timegan<span class="token punctuation">(</span>batch_data<span class="token punctuation">)</span>  <span class="token comment"># å‰å‘ä¼ æ’­ï¼Œå¾—åˆ°æ½œåœ¨è¡¨ç¤ºå’Œé‡å»ºæ•°æ®</span>
        recon_loss <span class="token operator">=</span> mse_loss<span class="token punctuation">(</span>x_tilde<span class="token punctuation">,</span> batch_data<span class="token punctuation">)</span>  <span class="token comment"># è®¡ç®—è‡ªç¼–ç æŸå¤±</span>
        recon_loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># åå‘ä¼ æ’­</span>
        optimizer_E<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># æ›´æ–°å‚æ•°</span>

        <span class="token comment"># è®­ç»ƒåˆ¤åˆ«å™¨</span>
        optimizer_D<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># æ¸…é›¶æ¢¯åº¦</span>
        real_h <span class="token operator">=</span> timegan<span class="token punctuation">.</span>embedder<span class="token punctuation">(</span>batch_data<span class="token punctuation">)</span>  <span class="token comment"># åµŒå…¥çœŸå®æ•°æ®</span>
        real_logit <span class="token operator">=</span> timegan<span class="token punctuation">.</span>dis_output<span class="token punctuation">(</span>timegan<span class="token punctuation">.</span>discriminator<span class="token punctuation">(</span>real_h<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># åˆ¤åˆ«çœŸå®æ•°æ®</span>
        z <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>batch_size<span class="token punctuation">,</span> seq_len<span class="token punctuation">,</span> hidden_dim<span class="token punctuation">)</span>  <span class="token comment"># ç”Ÿæˆéšæœºå™ªå£°</span>
        fake_x <span class="token operator">=</span> timegan<span class="token punctuation">.</span>generate<span class="token punctuation">(</span>z<span class="token punctuation">)</span>  <span class="token comment"># ç”Ÿæˆåˆæˆæ•°æ®</span>
        fake_h <span class="token operator">=</span> timegan<span class="token punctuation">.</span>embedder<span class="token punctuation">(</span>fake_x<span class="token punctuation">)</span>  <span class="token comment"># åµŒå…¥åˆæˆæ•°æ®</span>
        fake_logit <span class="token operator">=</span> timegan<span class="token punctuation">.</span>dis_output<span class="token punctuation">(</span>timegan<span class="token punctuation">.</span>discriminator<span class="token punctuation">(</span>fake_h<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># åˆ¤åˆ«åˆæˆæ•°æ®</span>
        d_loss <span class="token operator">=</span> bce_loss<span class="token punctuation">(</span>real_logit<span class="token punctuation">,</span> torch<span class="token punctuation">.</span>ones_like<span class="token punctuation">(</span>real_logit<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> bce_loss<span class="token punctuation">(</span>fake_logit<span class="token punctuation">,</span> torch<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>fake_logit<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># è®¡ç®—åˆ¤åˆ«å™¨æŸå¤±</span>
        d_loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># åå‘ä¼ æ’­</span>
        optimizer_D<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># æ›´æ–°å‚æ•°</span>

        <span class="token comment"># è®­ç»ƒç”Ÿæˆå™¨</span>
        optimizer_G<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># æ¸…é›¶æ¢¯åº¦</span>
        z <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>batch_size<span class="token punctuation">,</span> seq_len<span class="token punctuation">,</span> hidden_dim<span class="token punctuation">)</span>  <span class="token comment"># ç”Ÿæˆéšæœºå™ªå£°</span>
        fake_x <span class="token operator">=</span> timegan<span class="token punctuation">.</span>generate<span class="token punctuation">(</span>z<span class="token punctuation">)</span>  <span class="token comment"># ç”Ÿæˆåˆæˆæ•°æ®</span>
        fake_h <span class="token operator">=</span> timegan<span class="token punctuation">.</span>embedder<span class="token punctuation">(</span>fake_x<span class="token punctuation">)</span>  <span class="token comment"># åµŒå…¥åˆæˆæ•°æ®</span>
        fake_logit <span class="token operator">=</span> timegan<span class="token punctuation">.</span>dis_output<span class="token punctuation">(</span>timegan<span class="token punctuation">.</span>discriminator<span class="token punctuation">(</span>fake_h<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># åˆ¤åˆ«åˆæˆæ•°æ®</span>
        g_loss <span class="token operator">=</span> bce_loss<span class="token punctuation">(</span>fake_logit<span class="token punctuation">,</span> torch<span class="token punctuation">.</span>ones_like<span class="token punctuation">(</span>fake_logit<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># è®¡ç®—ç”Ÿæˆå™¨å¯¹æŠ—æŸå¤±</span>
        <span class="token comment"># è®¡ç®—ç›‘ç£æŸå¤±ï¼ˆä½¿ç”¨çœŸå®æ•°æ®ç›‘ç£ç”Ÿæˆå™¨ï¼‰</span>
        supervised_loss <span class="token operator">=</span> mse_loss<span class="token punctuation">(</span>fake_x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fake_x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># ç›‘ç£æŸå¤±ï¼šé¢„æµ‹ä¸‹ä¸€æ­¥</span>
        total_g_loss <span class="token operator">=</span> g_loss <span class="token operator">+</span> <span class="token number">0.1</span> <span class="token operator">*</span> supervised_loss  <span class="token comment"># æ€»ç”Ÿæˆå™¨æŸå¤±ï¼ˆå¯¹æŠ—æŸå¤±+ç›‘ç£æŸå¤±ï¼‰</span>
        total_g_loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># åå‘ä¼ æ’­</span>
        optimizer_G<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># æ›´æ–°å‚æ•°</span>

    <span class="token comment"># æ‰“å°æŸå¤±</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>epoch <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">10</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Epoch </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>epoch<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>num_epochs<span class="token punctuation">}</span></span><span class="token string">, Recon Loss: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>recon_loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">, D Loss: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>d_loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">, G Loss: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>total_g_loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># ç”Ÿæˆåˆæˆæ•°æ®</span>
<span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    z <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>n_samples<span class="token punctuation">,</span> seq_len<span class="token punctuation">,</span> hidden_dim<span class="token punctuation">)</span>  <span class="token comment"># ç”Ÿæˆéšæœºå™ªå£°</span>
    synthetic_data_timegan <span class="token operator">=</span> timegan<span class="token punctuation">.</span>generate<span class="token punctuation">(</span>z<span class="token punctuation">)</span>  <span class="token comment"># ç”Ÿæˆåˆæˆæ•°æ®</span>
synthetic_data_timegan <span class="token operator">=</span> synthetic_data_timegan<span class="token punctuation">.</span>cpu<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># è½¬æ¢ä¸ºnumpyæ•°ç»„</span>

<span class="token comment"># å®šä¹‰RTSGANæ¨¡å‹</span>
<span class="token keyword">class</span> <span class="token class-name">RTSGAN</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_dim<span class="token punctuation">,</span> hidden_dim<span class="token punctuation">,</span> num_layers<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>RTSGAN<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>hidden_dim <span class="token operator">=</span> hidden_dim  <span class="token comment"># è®¾ç½®éšè—å±‚ç»´åº¦</span>
        self<span class="token punctuation">.</span>input_dim <span class="token operator">=</span> input_dim  <span class="token comment"># è®¾ç½®è¾“å…¥ç»´åº¦</span>

        <span class="token comment"># è‡ªå›å½’ç¼–ç å™¨ï¼ˆAutoregressive Encoderï¼‰</span>
        self<span class="token punctuation">.</span>encoder <span class="token operator">=</span> GRU<span class="token punctuation">(</span>input_dim<span class="token punctuation">,</span> hidden_dim<span class="token punctuation">,</span> num_layers<span class="token punctuation">)</span>  <span class="token comment"># å®šä¹‰ç¼–ç å™¨ï¼Œä½¿ç”¨GRUç½‘ç»œ</span>
        self<span class="token punctuation">.</span>encoder_output <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>hidden_dim <span class="token operator">*</span> seq_len<span class="token punctuation">,</span> hidden_dim<span class="token punctuation">)</span>  <span class="token comment"># çº¿æ€§å±‚ï¼Œå‹ç¼©ä¸ºå›ºå®šç»´åº¦æ½œåœ¨è¡¨ç¤º</span>

        <span class="token comment"># è‡ªå›å½’è§£ç å™¨ï¼ˆAutoregressive Decoderï¼‰</span>
        self<span class="token punctuation">.</span>decoder <span class="token operator">=</span> GRU<span class="token punctuation">(</span>input_dim<span class="token punctuation">,</span> hidden_dim<span class="token punctuation">,</span> num_layers<span class="token punctuation">)</span>  <span class="token comment"># å®šä¹‰è§£ç å™¨ï¼Œä½¿ç”¨GRUç½‘ç»œ</span>
        self<span class="token punctuation">.</span>decoder_output <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>hidden_dim<span class="token punctuation">,</span> input_dim<span class="token punctuation">)</span>  <span class="token comment"># çº¿æ€§å±‚ï¼Œç”Ÿæˆè¾“å‡ºæ•°æ®</span>

        <span class="token comment"># åˆ¤åˆ«å™¨ï¼ˆCritic for WGANï¼‰</span>
        self<span class="token punctuation">.</span>critic <span class="token operator">=</span> GRU<span class="token punctuation">(</span>hidden_dim<span class="token punctuation">,</span> hidden_dim<span class="token punctuation">,</span> num_layers<span class="token punctuation">)</span>  <span class="token comment"># å®šä¹‰åˆ¤åˆ«å™¨ï¼Œä½¿ç”¨GRUç½‘ç»œ</span>
        self<span class="token punctuation">.</span>critic_output <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>hidden_dim<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># çº¿æ€§å±‚ï¼Œè¾“å‡ºWassersteinè·ç¦»</span>

    <span class="token keyword">def</span> <span class="token function">encode</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># ç¼–ç ï¼šå°†è¾“å…¥åºåˆ—å‹ç¼©ä¸ºå›ºå®šç»´åº¦æ½œåœ¨è¡¨ç¤º</span>
        h <span class="token operator">=</span> self<span class="token punctuation">.</span>encoder<span class="token punctuation">(</span>x<span class="token punctuation">)</span>  <span class="token comment"># é€šè¿‡ç¼–ç å™¨ç”Ÿæˆéšè—çŠ¶æ€</span>
        h <span class="token operator">=</span> h<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>h<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># å±•å¹³éšè—çŠ¶æ€</span>
        r <span class="token operator">=</span> self<span class="token punctuation">.</span>encoder_output<span class="token punctuation">(</span>h<span class="token punctuation">)</span>  <span class="token comment"># å‹ç¼©ä¸ºå›ºå®šç»´åº¦æ½œåœ¨è¡¨ç¤º</span>
        <span class="token keyword">return</span> r

    <span class="token keyword">def</span> <span class="token function">decode</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># è§£ç ï¼šä»æ½œåœ¨è¡¨ç¤ºç”Ÿæˆåºåˆ—</span>
        batch_size <span class="token operator">=</span> r<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># è·å–æ‰¹æ¬¡å¤§å°</span>
        <span class="token comment"># åˆå§‹åŒ–è§£ç å™¨è¾“å…¥</span>
        x_hat <span class="token operator">=</span> torch<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>batch_size<span class="token punctuation">,</span> seq_len<span class="token punctuation">,</span> self<span class="token punctuation">.</span>input_dim<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>r<span class="token punctuation">.</span>device<span class="token punctuation">)</span>  <span class="token comment"># åˆå§‹åŒ–ç”Ÿæˆåºåˆ—</span>
        h <span class="token operator">=</span> r<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>repeat<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> seq_len<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># å°†æ½œåœ¨è¡¨ç¤ºæ‰©å±•åˆ°åºåˆ—é•¿åº¦</span>
        <span class="token comment"># è‡ªå›å½’è§£ç </span>
        <span class="token keyword">for</span> t <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>seq_len<span class="token punctuation">)</span><span class="token punctuation">:</span>
            h_t <span class="token operator">=</span> self<span class="token punctuation">.</span>decoder<span class="token punctuation">(</span>x_hat<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span>t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>  <span class="token comment"># è·å–å½“å‰æ—¶é—´æ­¥çš„éšè—çŠ¶æ€</span>
            x_hat<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> t<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>decoder_output<span class="token punctuation">(</span>h_t<span class="token punctuation">)</span>  <span class="token comment"># ç”Ÿæˆå½“å‰æ—¶é—´æ­¥çš„è¾“å‡º</span>
        <span class="token keyword">return</span> x_hat

    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># å‰å‘ä¼ æ’­ï¼šç¼–ç +è§£ç </span>
        r <span class="token operator">=</span> self<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>x<span class="token punctuation">)</span>  <span class="token comment"># ç¼–ç </span>
        x_tilde <span class="token operator">=</span> self<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>r<span class="token punctuation">)</span>  <span class="token comment"># è§£ç </span>
        <span class="token keyword">return</span> r<span class="token punctuation">,</span> x_tilde

<span class="token comment"># åˆå§‹åŒ–RTSGANæ¨¡å‹</span>
rtsgan <span class="token operator">=</span> RTSGAN<span class="token punctuation">(</span>input_dim<span class="token punctuation">,</span> hidden_dim<span class="token punctuation">,</span> num_layers<span class="token punctuation">)</span>

<span class="token comment"># å®šä¹‰ä¼˜åŒ–å™¨</span>
optimizer_E <span class="token operator">=</span> optim<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>rtsgan<span class="token punctuation">.</span>encoder<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">list</span><span class="token punctuation">(</span>rtsgan<span class="token punctuation">.</span>decoder<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">)</span>  <span class="token comment"># ç¼–ç å™¨å’Œè§£ç å™¨ä¼˜åŒ–å™¨</span>
optimizer_G <span class="token operator">=</span> optim<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>rtsgan<span class="token punctuation">.</span>decoder<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">)</span>  <span class="token comment"># ç”Ÿæˆå™¨ä¼˜åŒ–å™¨</span>
optimizer_C <span class="token operator">=</span> optim<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>rtsgan<span class="token punctuation">.</span>critic<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">list</span><span class="token punctuation">(</span>rtsgan<span class="token punctuation">.</span>critic_output<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">)</span>  <span class="token comment"># åˆ¤åˆ«å™¨ä¼˜åŒ–å™¨</span>

<span class="token comment"># WGAN-GPçš„æ¢¯åº¦æƒ©ç½š</span>
<span class="token keyword">def</span> <span class="token function">gradient_penalty</span><span class="token punctuation">(</span>critic<span class="token punctuation">,</span> real<span class="token punctuation">,</span> fake<span class="token punctuation">)</span><span class="token punctuation">:</span>
    alpha <span class="token operator">=</span> torch<span class="token punctuation">.</span>rand<span class="token punctuation">(</span>real<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>real<span class="token punctuation">.</span>device<span class="token punctuation">)</span>  <span class="token comment"># éšæœºæ’å€¼ç³»æ•°</span>
    interpolates <span class="token operator">=</span> alpha <span class="token operator">*</span> real <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> alpha<span class="token punctuation">)</span> <span class="token operator">*</span> fake  <span class="token comment"># æ’å€¼æ•°æ®</span>
    interpolates<span class="token punctuation">.</span>requires_grad_<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># å…è®¸è®¡ç®—æ¢¯åº¦</span>
    critic_inter <span class="token operator">=</span> critic<span class="token punctuation">(</span>interpolates<span class="token punctuation">)</span>  <span class="token comment"># åˆ¤åˆ«æ’å€¼æ•°æ®</span>
    gradients <span class="token operator">=</span> torch<span class="token punctuation">.</span>autograd<span class="token punctuation">.</span>grad<span class="token punctuation">(</span>outputs<span class="token operator">=</span>critic_inter<span class="token punctuation">,</span> inputs<span class="token operator">=</span>interpolates<span class="token punctuation">,</span>
                                    grad_outputs<span class="token operator">=</span>torch<span class="token punctuation">.</span>ones_like<span class="token punctuation">(</span>critic_inter<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                    create_graph<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> retain_graph<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># è®¡ç®—æ¢¯åº¦</span>
    gradients <span class="token operator">=</span> gradients<span class="token punctuation">.</span>view<span class="token punctuation">(</span>gradients<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># å±•å¹³æ¢¯åº¦</span>
    gradient_norm <span class="token operator">=</span> gradients<span class="token punctuation">.</span>norm<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># è®¡ç®—æ¢¯åº¦èŒƒæ•°</span>
    gp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>gradient_norm <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># è®¡ç®—æ¢¯åº¦æƒ©ç½š</span>
    <span class="token keyword">return</span> gp

<span class="token comment"># è®­ç»ƒRTSGAN</span>
lambda_gp <span class="token operator">=</span> <span class="token number">10</span>  <span class="token comment"># æ¢¯åº¦æƒ©ç½šç³»æ•°ï¼Œå‚è€ƒè®ºæ–‡</span>
<span class="token keyword">for</span> epoch <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> n_samples<span class="token punctuation">,</span> batch_size<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># è·å–æ‰¹æ¬¡æ•°æ®</span>
        batch_data <span class="token operator">=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> batch_size<span class="token punctuation">]</span><span class="token punctuation">.</span>cuda<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> data<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> batch_size<span class="token punctuation">]</span>

        <span class="token comment"># è®­ç»ƒç¼–ç å™¨å’Œè§£ç å™¨ï¼ˆè‡ªç¼–ç æŸå¤±ï¼‰</span>
        optimizer_E<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># æ¸…é›¶æ¢¯åº¦</span>
        r<span class="token punctuation">,</span> x_tilde <span class="token operator">=</span> rtsgan<span class="token punctuation">(</span>batch_data<span class="token punctuation">)</span>  <span class="token comment"># å‰å‘ä¼ æ’­ï¼Œå¾—åˆ°æ½œåœ¨è¡¨ç¤ºå’Œé‡å»ºæ•°æ®</span>
        recon_loss <span class="token operator">=</span> mse_loss<span class="token punctuation">(</span>x_tilde<span class="token punctuation">,</span> batch_data<span class="token punctuation">)</span>  <span class="token comment"># è®¡ç®—è‡ªç¼–ç æŸå¤±</span>
        recon_loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># åå‘ä¼ æ’­</span>
        optimizer_E<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># æ›´æ–°å‚æ•°</span>

        <span class="token comment"># è®­ç»ƒåˆ¤åˆ«å™¨ï¼ˆWGAN-GPï¼‰</span>
        optimizer_C<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># æ¸…é›¶æ¢¯åº¦</span>
        real_r <span class="token operator">=</span> rtsgan<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>batch_data<span class="token punctuation">)</span>  <span class="token comment"># ç¼–ç çœŸå®æ•°æ®</span>
        real_h <span class="token operator">=</span> rtsgan<span class="token punctuation">.</span>critic<span class="token punctuation">(</span>real_r<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>repeat<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> seq_len<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># åˆ¤åˆ«çœŸå®æ•°æ®</span>
        real_score <span class="token operator">=</span> rtsgan<span class="token punctuation">.</span>critic_output<span class="token punctuation">(</span>real_h<span class="token punctuation">)</span>  <span class="token comment"># è®¡ç®—çœŸå®æ•°æ®å¾—åˆ†</span>
        z <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>batch_size<span class="token punctuation">,</span> hidden_dim<span class="token punctuation">)</span>  <span class="token comment"># ç”Ÿæˆéšæœºå™ªå£°</span>
        fake_x <span class="token operator">=</span> rtsgan<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>z<span class="token punctuation">)</span>  <span class="token comment"># ç”Ÿæˆåˆæˆæ•°æ®</span>
        fake_r <span class="token operator">=</span> rtsgan<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>fake_x<span class="token punctuation">)</span>  <span class="token comment"># ç¼–ç åˆæˆæ•°æ®</span>
        fake_h <span class="token operator">=</span> rtsgan<span class="token punctuation">.</span>critic<span class="token punctuation">(</span>fake_r<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>repeat<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> seq_len<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># åˆ¤åˆ«åˆæˆæ•°æ®</span>
        fake_score <span class="token operator">=</span> rtsgan<span class="token punctuation">.</span>critic_output<span class="token punctuation">(</span>fake_h<span class="token punctuation">)</span>  <span class="token comment"># è®¡ç®—åˆæˆæ•°æ®å¾—åˆ†</span>
        gp <span class="token operator">=</span> gradient_penalty<span class="token punctuation">(</span>rtsgan<span class="token punctuation">.</span>critic<span class="token punctuation">,</span> real_r<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>repeat<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> seq_len<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fake_r<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>repeat<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> seq_len<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># è®¡ç®—æ¢¯åº¦æƒ©ç½š</span>
        c_loss <span class="token operator">=</span> fake_score<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> real_score<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> lambda_gp <span class="token operator">*</span> gp  <span class="token comment"># WGAN-GPæŸå¤±</span>
        c_loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># åå‘ä¼ æ’­</span>
        optimizer_C<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># æ›´æ–°å‚æ•°</span>

        <span class="token comment"># è®­ç»ƒç”Ÿæˆå™¨</span>
        optimizer_G<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># æ¸…é›¶æ¢¯åº¦</span>
        z <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>batch_size<span class="token punctuation">,</span> hidden_dim<span class="token punctuation">)</span>  <span class="token comment"># ç”Ÿæˆéšæœºå™ªå£°</span>
        fake_x <span class="token operator">=</span> rtsgan<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>z<span class="token punctuation">)</span>  <span class="token comment"># ç”Ÿæˆåˆæˆæ•°æ®</span>
        fake_r <span class="token operator">=</span> rtsgan<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>fake_x<span class="token punctuation">)</span>  <span class="token comment"># ç¼–ç åˆæˆæ•°æ®</span>
        fake_h <span class="token operator">=</span> rtsgan<span class="token punctuation">.</span>critic<span class="token punctuation">(</span>fake_r<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>repeat<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> seq_len<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># åˆ¤åˆ«åˆæˆæ•°æ®</span>
        fake_score <span class="token operator">=</span> rtsgan<span class="token punctuation">.</span>critic_output<span class="token punctuation">(</span>fake_h<span class="token punctuation">)</span>  <span class="token comment"># è®¡ç®—åˆæˆæ•°æ®å¾—åˆ†</span>
        g_loss <span class="token operator">=</span> <span class="token operator">-</span>fake_score<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># ç”Ÿæˆå™¨æŸå¤±ï¼ˆWGANï¼‰</span>
        g_loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># åå‘ä¼ æ’­</span>
        optimizer_G<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># æ›´æ–°å‚æ•°</span>

    <span class="token comment"># æ‰“å°æŸå¤±</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>epoch <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">10</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Epoch </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>epoch<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>num_epochs<span class="token punctuation">}</span></span><span class="token string">, Recon Loss: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>recon_loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">, C Loss: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>c_loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">, G Loss: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>g_loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># ç”Ÿæˆåˆæˆæ•°æ®</span>
<span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    z <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>n_samples<span class="token punctuation">,</span> hidden_dim<span class="token punctuation">)</span>  <span class="token comment"># ç”Ÿæˆéšæœºå™ªå£°</span>
    synthetic_data_rtsgan <span class="token operator">=</span> rtsgan<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>z<span class="token punctuation">)</span>  <span class="token comment"># ç”Ÿæˆåˆæˆæ•°æ®</span>
synthetic_data_rtsgan <span class="token operator">=</span> synthetic_data_rtsgan<span class="token punctuation">.</span>cpu<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># è½¬æ¢ä¸ºnumpyæ•°ç»„</span>

<span class="token comment"># å‡†å¤‡ç›‘ç£å­¦ä¹ æ•°æ®</span>
<span class="token keyword">def</span> <span class="token function">prepare_supervised_data</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> window_size<span class="token punctuation">)</span><span class="token punctuation">:</span>
    inputs<span class="token punctuation">,</span> targets <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment"># åˆå§‹åŒ–è¾“å…¥å’Œç›®æ ‡åˆ—è¡¨</span>
    data <span class="token operator">=</span> data<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>data<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># å±•å¹³æ•°æ®ï¼Œå½¢çŠ¶ä¸º[n_samples, seq_len * n_features]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">-</span> window_size<span class="token punctuation">)</span><span class="token punctuation">:</span>
        inputs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> window_size<span class="token punctuation">]</span><span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># æå–è¾“å…¥çª—å£</span>
        targets<span class="token punctuation">.</span>append<span class="token punctuation">(</span>data<span class="token punctuation">[</span>i <span class="token operator">+</span> window_size<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># æå–ç›®æ ‡ï¼ˆæœ€åä¸€ä¸ªç‰¹å¾ï¼‰</span>
    <span class="token keyword">return</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>inputs<span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>targets<span class="token punctuation">)</span>

<span class="token comment"># å‡†å¤‡çœŸå®æ•°æ®å’Œåˆæˆæ•°æ®</span>
window_size <span class="token operator">=</span> <span class="token number">3</span>  <span class="token comment"># çª—å£å¤§å°ï¼Œå‚è€ƒå›¾4</span>
real_inputs<span class="token punctuation">,</span> real_targets <span class="token operator">=</span> prepare_supervised_data<span class="token punctuation">(</span>data<span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> window_size<span class="token punctuation">)</span>  <span class="token comment"># å‡†å¤‡çœŸå®æ•°æ®</span>
syn_inputs_timegan<span class="token punctuation">,</span> syn_targets_timegan <span class="token operator">=</span> prepare_supervised_data<span class="token punctuation">(</span>synthetic_data_timegan<span class="token punctuation">,</span> window_size<span class="token punctuation">)</span>  <span class="token comment"># å‡†å¤‡TimeGANåˆæˆæ•°æ®</span>
syn_inputs_rtsgan<span class="token punctuation">,</span> syn_targets_rtsgan <span class="token operator">=</span> prepare_supervised_data<span class="token punctuation">(</span>synthetic_data_rtsgan<span class="token punctuation">,</span> window_size<span class="token punctuation">)</span>  <span class="token comment"># å‡†å¤‡RTSGANåˆæˆæ•°æ®</span>

<span class="token comment"># æ··åˆçœŸå®å’Œåˆæˆæ•°æ®</span>
mixed_inputs <span class="token operator">=</span> np<span class="token punctuation">.</span>concatenate<span class="token punctuation">(</span><span class="token punctuation">[</span>real_inputs<span class="token punctuation">,</span> syn_inputs_rtsgan<span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># æ··åˆçœŸå®å’ŒRTSGANæ•°æ®</span>
mixed_targets <span class="token operator">=</span> np<span class="token punctuation">.</span>concatenate<span class="token punctuation">(</span><span class="token punctuation">[</span>real_targets<span class="token punctuation">,</span> syn_targets_rtsgan<span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># æ··åˆç›®æ ‡</span>

<span class="token comment"># è®­ç»ƒGBRTæ¨¡å‹</span>
gbrt <span class="token operator">=</span> GradientBoostingRegressor<span class="token punctuation">(</span>n_estimators<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>  <span class="token comment"># åˆå§‹åŒ–GBRTæ¨¡å‹</span>
gbrt<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>mixed_inputs<span class="token punctuation">,</span> mixed_targets<span class="token punctuation">)</span>  <span class="token comment"># è®­ç»ƒGBRTæ¨¡å‹</span>
gbrt_pred <span class="token operator">=</span> gbrt<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>real_inputs<span class="token punctuation">)</span>  <span class="token comment"># ä½¿ç”¨çœŸå®æ•°æ®é¢„æµ‹</span>
gbrt_mse <span class="token operator">=</span> mean_squared_error<span class="token punctuation">(</span>real_targets<span class="token punctuation">,</span> gbrt_pred<span class="token punctuation">)</span>  <span class="token comment"># è®¡ç®—å‡æ–¹è¯¯å·®</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"GBRT MSE: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>gbrt_mse<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  <span class="token comment"># æ‰“å°å‡æ–¹è¯¯å·®</span>

<span class="token comment"># å®šä¹‰LSTMæ¨¡å‹</span>
<span class="token keyword">class</span> <span class="token class-name">LSTM</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_dim<span class="token punctuation">,</span> hidden_dim<span class="token punctuation">,</span> num_layers<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>LSTM<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>lstm <span class="token operator">=</span> nn<span class="token punctuation">.</span>LSTM<span class="token punctuation">(</span>input_dim<span class="token punctuation">,</span> hidden_dim<span class="token punctuation">,</span> num_layers<span class="token punctuation">,</span> batch_first<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># å®šä¹‰LSTMå±‚</span>
        self<span class="token punctuation">.</span>fc <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>hidden_dim<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># å®šä¹‰å…¨è¿æ¥å±‚</span>

    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        h0 <span class="token operator">=</span> torch<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>num_layers<span class="token punctuation">,</span> x<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hidden_dim<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>x<span class="token punctuation">.</span>device<span class="token punctuation">)</span>  <span class="token comment"># åˆå§‹åŒ–éšè—çŠ¶æ€</span>
        c0 <span class="token operator">=</span> torch<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>num_layers<span class="token punctuation">,</span> x<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hidden_dim<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>x<span class="token punctuation">.</span>device<span class="token punctuation">)</span>  <span class="token comment"># åˆå§‹åŒ–å•å…ƒçŠ¶æ€</span>
        out<span class="token punctuation">,</span> _ <span class="token operator">=</span> self<span class="token punctuation">.</span>lstm<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token punctuation">(</span>h0<span class="token punctuation">,</span> c0<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># å‰å‘ä¼ æ’­</span>
        out <span class="token operator">=</span> self<span class="token punctuation">.</span>fc<span class="token punctuation">(</span>out<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># å–æœ€åä¸€ä¸ªæ—¶é—´æ­¥è¾“å‡º</span>
        <span class="token keyword">return</span> out

<span class="token comment"># åˆå§‹åŒ–LSTMæ¨¡å‹</span>
lstm <span class="token operator">=</span> LSTM<span class="token punctuation">(</span>input_dim<span class="token operator">=</span>n_features <span class="token operator">*</span> <span class="token punctuation">(</span>window_size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hidden_dim<span class="token operator">=</span>hidden_dim<span class="token punctuation">,</span> num_layers<span class="token operator">=</span>num_layers<span class="token punctuation">)</span>

<span class="token comment"># å®šä¹‰ä¼˜åŒ–å™¨å’ŒæŸå¤±å‡½æ•°</span>
optimizer <span class="token operator">=</span> optim<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span>lstm<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">)</span>  <span class="token comment"># å®šä¹‰ä¼˜åŒ–å™¨</span>
criterion <span class="token operator">=</span> nn<span class="token punctuation">.</span>MSELoss<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># å®šä¹‰æŸå¤±å‡½æ•°</span>

<span class="token comment"># å‡†å¤‡LSTMè¾“å…¥æ•°æ®</span>
lstm_inputs <span class="token operator">=</span> torch<span class="token punctuation">.</span>FloatTensor<span class="token punctuation">(</span>mixed_inputs<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> window_size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> n_features<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># é‡å¡‘è¾“å…¥æ•°æ®</span>
lstm_targets <span class="token operator">=</span> torch<span class="token punctuation">.</span>FloatTensor<span class="token punctuation">(</span>mixed_targets<span class="token punctuation">)</span>  <span class="token comment"># è½¬æ¢ç›®æ ‡æ•°æ®</span>

<span class="token comment"># è®­ç»ƒLSTMæ¨¡å‹</span>
<span class="token keyword">for</span> epoch <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># æ¸…é›¶æ¢¯åº¦</span>
    outputs <span class="token operator">=</span> lstm<span class="token punctuation">(</span>lstm_inputs<span class="token punctuation">)</span>  <span class="token comment"># å‰å‘ä¼ æ’­</span>
    loss <span class="token operator">=</span> criterion<span class="token punctuation">(</span>outputs<span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lstm_targets<span class="token punctuation">)</span>  <span class="token comment"># è®¡ç®—æŸå¤±</span>
    loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># åå‘ä¼ æ’­</span>
    optimizer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># æ›´æ–°å‚æ•°</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>epoch <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">10</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"LSTM Epoch </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>epoch<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>num_epochs<span class="token punctuation">}</span></span><span class="token string">, Loss: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  <span class="token comment"># æ‰“å°æŸå¤±</span>

<span class="token comment"># ä½¿ç”¨LSTMé¢„æµ‹</span>
<span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    lstm_pred <span class="token operator">=</span> lstm<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>FloatTensor<span class="token punctuation">(</span>real_inputs<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> window_size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> n_features<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># é¢„æµ‹</span>
lstm_pred <span class="token operator">=</span> lstm_pred<span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># è½¬æ¢ä¸ºnumpyæ•°ç»„</span>
lstm_mse <span class="token operator">=</span> mean_squared_error<span class="token punctuation">(</span>real_targets<span class="token punctuation">,</span> lstm_pred<span class="token punctuation">)</span>  <span class="token comment"># è®¡ç®—å‡æ–¹è¯¯å·®</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"LSTM MSE: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>lstm_mse<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  <span class="token comment"># æ‰“å°å‡æ–¹è¯¯å·®</span>

<span class="token comment"># å¯è§†åŒ–é¢„æµ‹ç»“æœ</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># è®¾ç½®ç”»å¸ƒå¤§å°</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>real_targets<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"True"</span><span class="token punctuation">)</span>  <span class="token comment"># ç»˜åˆ¶çœŸå®å€¼</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>gbrt_pred<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"GBRT Pred"</span><span class="token punctuation">)</span>  <span class="token comment"># ç»˜åˆ¶GBRTé¢„æµ‹å€¼</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>lstm_pred<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"LSTM Pred"</span><span class="token punctuation">)</span>  <span class="token comment"># ç»˜åˆ¶LSTMé¢„æµ‹å€¼</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># æ˜¾ç¤ºå›¾ä¾‹</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Flood Forecasting Results"</span><span class="token punctuation">)</span>  <span class="token comment"># è®¾ç½®æ ‡é¢˜</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># æ˜¾ç¤ºå›¾åƒ</span>
</code></pre>
    <h3>
     <a id="_422">
     </a>
     ç»“è®º
    </h3>
    <p>
     æœºå™¨å­¦ä¹ å¯¹æ´ªæ°´é¢„æŠ¥æœ‰ç€é‡è¦çš„ä½œç”¨ï¼Œä½†æç«¯æ´ªæ°´äº‹ä»¶ç¨€å°‘ã€ç°åœºæ•°æ®ä¸è¶³å¯¼è‡´æ¨¡å‹çš„æ€§èƒ½å¹¶æ²¡æœ‰å……åˆ†å‘æŒ¥å‡ºæ¥ã€‚TimeGANç”Ÿæˆçš„æ•°æ®èƒ½å¤Ÿä¿ç•™æ´ªæ°´åœºæ™¯çš„å¤æ‚æ—¶ç©ºç›¸å…³æ€§ï¼Œå¼•å…¥åˆæˆæ•°æ®é›†ä¹Ÿæœ‰åŠ©äºæå‡æœºå™¨å­¦ä¹ é¢„æµ‹ç²¾åº¦ã€‚ä¸è¿‡å¯¹LSTMçš„æ”¹è¿›æœ‰é™ï¼ŒTimeGANå¯¹Transformerç­‰æ·±åº¦å­¦ä¹ æ¨¡å‹çš„æœ‰æ•ˆæ€§ä¹Ÿæœ‰å¾…è¿›ä¸€æ­¥æ¢ç©¶ã€‚
    </p>
    <h3>
     <a id="_424">
     </a>
     ä¸è¶³ä»¥åŠå±•æœ›
    </h3>
    <p>
     ä½œè€…æå‡ºäº†æœ¬è®ºæ–‡ä¸­çš„ä¸è¶³ï¼Œä½œè€…è®¤ä¸ºTimeGANå¯¹å¦‚LSTMç­‰æ·±åº¦å­¦ä¹ æ¨¡å‹çš„æ”¹è¿›æ•ˆæœæœ‰é™ï¼Œæ²¡æœ‰å‘æŒ¥å‡ºå®é™…çš„ä½œç”¨ã€‚æœªå»ºç«‹TimeGANæŸå¤±å‡½æ•°ä¸ä¸‹æ¸¸é¢„æŠ¥æ€§èƒ½çš„å…³è”æ€§ï¼Œç¼ºä¹äº†å¯¹ç”¨æˆ·è‡ªå®šä¹‰å‚æ•°æ•æ„Ÿæ€§åˆ†æã€‚
     <br/>
     å…³äºå¯¹è®ºæ–‡æœªæ¥çš„å±•æœ›ï¼Œä½œè€…æå‡ºåç»­å®éªŒå¯å»ºç«‹TimeGANæŸå¤±å‡½æ•°ä¸ä¸‹æ¸¸é¢„æŠ¥æ€§èƒ½çš„ç›´æ¥è”ç³»ã€‚è¿˜éœ€è¦è€ƒè™‘å°†å¤©æ°”ä¿¡æ¯ä½œä¸ºæ´ªæ°´é¢„æŠ¥æ¨¡å‹çš„é‡è¦è¾“å…¥å˜é‡ï¼Œä»¥æä¾›é•¿å‘¨æœŸé¢„æŠ¥ã€‚æ­¤å¤–ï¼Œéœ€è¦è¿›ä¸€æ­¥æ¢ç´¢ç”Ÿæˆçš„æ´ªæ°´åœºæ™¯åœ¨æ´ªæ°´é£é™©ç®¡ç†ä¸­çš„å„ç§åº”ç”¨ã€‚
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f5a63796d61746963732f:61727469636c652f64657461696c732f313435393831363132" class_="artid" style="display:none">
 </p>
</div>


