---
layout: post
title: "代码块与设计模式"
date: 2025-03-12 20:06:59 +0800
description: "静态方法和属性的经典使用设计模式是在大量的实践中总结和理论化之后优选的代码结构、编程风格、以及解决问题的思考方式。设计模式就像是经典的棋谱,不同的棋局,我们用不同的棋谱，免去我们自己再思考和摸索。所谓类的单例设计模式，就是采取一定的方法保证在整个的软件系统中，对某个类只能存在一个对象实例，并且该类只提供一个取得其对象实例的方法。单例模式有两种方式:1) 饿汉式 2) 懒汉式。"
keywords: "代码块与设计模式"
categories: ['未分类']
tags: ['设计模式', '算法', 'Java']
artid: "146213707"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146213707
    alt: "代码块与设计模式"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146213707
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146213707
cover: https://bing.ee123.net/img/rand?artid=146213707
image: https://bing.ee123.net/img/rand?artid=146213707
img: https://bing.ee123.net/img/rand?artid=146213707
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     代码块与设计模式
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <h2>
     <a id="1_1">
     </a>
     1.代码块
    </h2>
    <h3>
     <a id="11_3">
     </a>
     1.1基本介绍
    </h3>
    <p>
     代码化块又称为初始化块,属于类中的成员[即是类的一部分]，类似于方法，将逻辑语句封装在方法体中，通过包围起来。
    </p>
    <p>
     但和方法不同，没有方法名，没有返回，没有参数，
     <strong>
      只有方法体
     </strong>
     ，而且不用通过对象或类显式调用，而是
     <strong>
      加载类时，或创建对象时隐式调用
     </strong>
     。
    </p>
    <h4>
     <a id="_9">
     </a>
     基本语法
    </h4>
    <pre><code class="prism language-java"><span class="token punctuation">[</span>修饰符<span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span>
   代码
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     说明注意;
    </p>
    <ol>
     <li>
      修饰符可选,要写的话,也只能写static
     </li>
     <li>
      代码块分为两类，使用static修饰的叫静态代码块，没有static修饰的，叫普通代码块/非静态代码块。
     </li>
     <li>
      逻辑语句可以为任何逻辑语句(输入、输出、方法调用、循环、判断等)
     </li>
     <li>
      ；号可以写上,也可以省略。
     </li>
    </ol>
    <h3>
     <a id="12_24">
     </a>
     1.2代码块的好处和案例演示
    </h3>
    <ol>
     <li>
      相当于另外一种形式的构造器(对构造器的补充机制)，可以做初始化的操作
     </li>
     <li>
      场景:如果多个构造器中都有重复的语句，可以抽取到初始化块中，提高代码的重用性
     </li>
    </ol>
    <p>
     这样当我们不管调用哪个构造器，创建对象，都会先调用代码块的内容，代码块调用的顺序优先于构造器。
    </p>
    <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>hspedu<span class="token punctuation">.</span>codeblock_</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CodeBlock01</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Movie</span> movie <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Movie</span><span class="token punctuation">(</span><span class="token string">"你好，李焕英"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"==============="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Movie</span> movie2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Movie</span><span class="token punctuation">(</span><span class="token string">"唐探3"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">"陈思诚"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Movie</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">double</span> price<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> director<span class="token punctuation">;</span>

    <span class="token comment">// 3个构造器-》重载</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"电影屏幕打开..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"广告开始..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"电影正是开始..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Movie</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Movie(String name) 被调用..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Movie</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">double</span> price<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>price <span class="token operator">=</span> price<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Movie</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">double</span> price<span class="token punctuation">,</span> <span class="token class-name">String</span> director<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Movie(String name, double price, String director) 被调用..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>price <span class="token operator">=</span> price<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>director <span class="token operator">=</span> director<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="13_75">
     </a>
     1.3代码块使用注意事项和细节讨论!!!
    </h3>
    <ol>
     <li>
      <p>
       static代码块也叫静态代码块，作用就是对类进行初始化，而且它随着
       <strong>
        类的加载
       </strong>
       而执行，并且只会执行一次。如果是普通代码块，每创建一个对象, 就执行一次。
      </p>
     </li>
     <li>
      <p>
       <strong>
        类什么时候被加载
       </strong>
      </p>
      <ul>
       <li>
        <strong>
         创建对象实例时(new)
        </strong>
       </li>
       <li>
        <strong>
         创建子类对象实例,父类也会被加载
        </strong>
       </li>
       <li>
        <strong>
         使用类的静态成员时(静态属性,静态方法)
        </strong>
       </li>
      </ul>
     </li>
     <li>
      <p>
       普通的代码块，
       <strong>
        在创建对象实例
       </strong>
       时，会被隐式的调用。被创建一次，就会调用一次。
       <br/>
       <strong>
        如果只是使用类的静态成员时,普通代码块并不会执行。（没有创建对象实例）
       </strong>
      </p>
     </li>
     <li>
      <p>
       创建一个对象时，在一个类调用顺序是
       <strong>
        (重点，难点)
       </strong>
       ∶
      </p>
      <ol start="5">
       <li>
        <p>
         调用静态代码块和静态属性初始化 (注意:静态代码块和静态属性初始化调用的优先级一样，如果有多个静态代码块和多个静态变量初始化，则按他们定义的先后顺序调用)
        </p>
       </li>
       <li>
        <p>
         调用普通代码块和普通属性的初始化(注意:普通代码块和普通属性初始化调用的优先级一样,如果有多个普通代码块和多个普通属性初始化,则按定义先后顺序调用)
        </p>
       </li>
       <li>
        <p>
         调用构造方法
        </p>
       </li>
      </ol>
     </li>
     <li>
      <p>
       最前面其实隐含了
       <strong>
        super()和调用普通代码块
       </strong>
       , 静态相关的代码块，属性初始化，在类加载时，就执行完毕，因此是优先于构造器和普通代码块执行的。
      </p>
     </li>
     <li>
      <p>
       看一下创建一个子类对象时(继承关系)，他们的调用顺序如下**:
      </p>
      <ol start="6">
       <li>
        父类的静态代码块和静态属性(优先级一样,按定义顺序执行)（类加载）
       </li>
       <li>
        子类的静态代码块和静态属性(优先级一样,按定义顺序执行)（类加载）
       </li>
       <li>
        父类的普通代码块和普通属性初始化(优先级一样，按定义顺序执行)
       </li>
       <li>
        父类的构造方法
       </li>
       <li>
        子类的普通代码块和普通属性初始化(优先级一样，按定义顺序执行)
       </li>
       <li>
        子类的构造方法
       </li>
      </ol>
     </li>
     <li>
      <p>
       代码块（本质上是静态方法）只能直接调用静态成员(静态属性和静态方法)，普通代码块（本质上是普通方法）可以调用任意成员。
      </p>
     </li>
    </ol>
    <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>hspedu<span class="token punctuation">.</span>codeblock_</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CodeBlockDetail04</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//老师说明</span>
        <span class="token comment">//(1) 进行类的加载</span>
        <span class="token comment">//1.1 先加载 父类 A02 1.2 再加载 B02</span>
        <span class="token comment">//(2) 创建对象</span>
        <span class="token comment">//2.1 从子类的构造器开始</span>
        <span class="token comment">//new B02();//对象</span>

        <span class="token keyword">new</span> <span class="token class-name">C02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">A02</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">//父类</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> n1 <span class="token operator">=</span> <span class="token function">getVal01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"A02的一个静态代码块.."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//(2)</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"A02的第一个普通代码块.."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//(5)</span>
    <span class="token punctuation">}</span>
    pulic <span class="token keyword">int</span> n3 <span class="token operator">=</span> <span class="token function">getVal02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//普通属性的初始化</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getVal01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"getVal01"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//(1)</span>
        <span class="token keyword">return</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getVal02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"getVal02"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//(6)</span>
        <span class="token keyword">return</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">A02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token comment">//构造器</span>
        <span class="token comment">//隐藏</span>
        <span class="token comment">//super()</span>
        <span class="token comment">//普通代码和普通属性的初始化......</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"A02的构造器"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//(7)</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">C02</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> n1 <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span>  <span class="token keyword">int</span> n2 <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">m1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">m2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//静态代码块，只能调用静态成员</span>
        <span class="token comment">//System.out.println(n1);错误</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>n2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ok</span>
        <span class="token comment">//m1();//错误</span>
        <span class="token function">m2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//普通代码块，可以使用任意成员</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>n1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>n2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ok</span>
        <span class="token function">m1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">m2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">B02</span> <span class="token keyword">extends</span> <span class="token class-name">A02</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">//</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> n3 <span class="token operator">=</span> <span class="token function">getVal03</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"B02的一个静态代码块.."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//(4)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> n5 <span class="token operator">=</span> <span class="token function">getVal04</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"B02的第一个普通代码块.."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//(9)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getVal03</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"getVal03"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//(3)</span>
        <span class="token keyword">return</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getVal04</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"getVal04"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//(8)</span>
        <span class="token keyword">return</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//一定要慢慢的去品..</span>
    <span class="token keyword">public</span> <span class="token function">B02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token comment">//构造器</span>
        <span class="token comment">//隐藏了</span>
        <span class="token comment">//super()</span>
        <span class="token comment">//普通代码块和普通属性的初始化...</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"B02的构造器"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//(10)</span>
        <span class="token comment">// TODO Auto-generated constructor stub</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     练习：
    </p>
    <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>hspedu<span class="token punctuation">.</span>codeblock_</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CodeBlockExercise02</span> <span class="token punctuation">{<!-- --></span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Sample</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Sample</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">Sample</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Sample默认构造函数被调用"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Sample</span> sam1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Sample</span><span class="token punctuation">(</span><span class="token string">"sam1成员初始化"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//</span>
    <span class="token keyword">static</span> <span class="token class-name">Sample</span> sam<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Sample</span><span class="token punctuation">(</span><span class="token string">"静态成员sam初始化 "</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//</span>
    <span class="token keyword">static</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"static块执行"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>sam<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"sam is null"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//构造器</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Test默认构造函数被调用"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//主方法</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span>  <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span>  str<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Test</span> a<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//无参构造器</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token number">1.</span> 静态成员sam 初始化
<span class="token number">2.</span> <span class="token keyword">static</span> 块执行
<span class="token number">3.</span> sam1 成员初始化
<span class="token number">4.</span> <span class="token class-name">Test</span> 默认构造函数被调用
</code></pre>
    <h2>
     <a id="2_253">
     </a>
     2.单例设计模式
    </h2>
    <h3>
     <a id="21_255">
     </a>
     2.1什么是设计模式
    </h3>
    <p>
     静态方法和属性的经典使用
    </p>
    <p>
     设计模式是在大量的实践中总结和理论化之后优选的代码结构、编程风格、以及解决问题的思考方式。设计模式就像是经典的棋谱,不同的棋局,我们用不同的棋谱，免去我们自己再思考和摸索。
    </p>
    <h3>
     <a id="22_260">
     </a>
     2.2什么是单例模式
    </h3>
    <ol>
     <li>
      <p>
       所谓类的单例设计模式，就是采取一定的方法保证在整个的软件系统中，对
       <strong>
        某个类只能存在一个对象实例
       </strong>
       ，并且该类只提供一个取得其对象实例的方法。
      </p>
     </li>
     <li>
      <p>
       单例模式有两种方式:1) 饿汉式 2) 懒汉式
      </p>
     </li>
    </ol>
    <h4>
     <a id="221_266">
     </a>
     2.2.1饿汉式
    </h4>
    <p>
     步骤如下:
    </p>
    <ol>
     <li>
      <p>
       构造器私有化 =》防止直接new
      </p>
     </li>
     <li>
      <p>
       类的内部创建对象
      </p>
     </li>
     <li>
      <p>
       向外暴露一个静态的公共方法。getlnstance
      </p>
     </li>
    </ol>
    <p>
     饿汉式：有可能还没有用到这个对象，但是由于类的机制已经将对象创建好了。在线程还没出现之前就已经实例化了,因此饿汉式线程一定是安全的。
    </p>
    <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>hspedu<span class="token punctuation">.</span>single_</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SingleTon01</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token comment">//        GirlFriend xh = new GirlFriend("小红");</span>
<span class="token comment">//        GirlFriend xb = new GirlFriend("小白");</span>

        <span class="token comment">//通过方法可以获取对象</span>
        <span class="token class-name">GirlFriend</span> instance <span class="token operator">=</span> <span class="token class-name">GirlFriend</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>instance<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 都是同一个对象</span>
        <span class="token class-name">GirlFriend</span> instance2 <span class="token operator">=</span> <span class="token class-name">GirlFriend</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>instance2<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>instance <span class="token operator">==</span> instance2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// T 同一个对象</span>
        <span class="token comment">//System.out.println(GirlFriend.n1);</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 有一个类， GirlFriend</span>
<span class="token comment">// 只能有一个女朋友</span>
<span class="token keyword">class</span> <span class="token class-name">GirlFriend</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token comment">// public static  int n1 = 100;</span>
    <span class="token comment">// 为了能够在静态方法中，返回 gf对象，需要将其修饰为static</span>
    <span class="token comment">// 對象，通常是重量級的對象, 餓漢式可能造成創建了對象，但是沒有使用.</span>
    <span class="token comment">// 只要类加载了，就一定创建了gf对象</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">GirlFriend</span> gf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GirlFriend</span><span class="token punctuation">(</span><span class="token string">"小红红"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 如何保障我们只能创建一个 GirlFriend 对象</span>
    <span class="token comment">// 步骤[单例模式-饿汉式]</span>
    <span class="token comment">// 1. 将构造器私有化</span>
    <span class="token comment">// 2. 在类的内部直接创建对象(该对象是static)</span>
    <span class="token comment">// 3. 提供一个公共的static方法，返回 gf 对象</span>
    <span class="token keyword">private</span> <span class="token class-name">GirlFriend</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"構造器被調用."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 用static的目的就是在不创建对象的前提下直接调用</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">GirlFriend</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> gf<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token string">"GirlFriend{"</span> <span class="token operator">+</span>
                <span class="token string">"name='"</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span>
                <span class="token char">'}'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="222_334">
     </a>
     2.2.2懒汉式
    </h4>
    <p>
     懶漢式，只有當用戶使用getInstance時，才返回cat對象, 後面再次調用時，會返回上次創建的cat對象。
    </p>
    <p>
     懒汉式可能会存在线程安全的问题。
    </p>
    <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>hspedu<span class="token punctuation">.</span>single_</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 演示懶漢式的單例模式
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SingleTon02</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//new Cat("大黃");</span>
        <span class="token comment">//System.out.println(Cat.n1);</span>
        <span class="token class-name">Cat</span> instance <span class="token operator">=</span> <span class="token class-name">Cat</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>instance<span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token comment">//再次調用getInstance</span>
        <span class="token class-name">Cat</span> instance2 <span class="token operator">=</span> <span class="token class-name">Cat</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>instance2<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>instance <span class="token operator">==</span> instance2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//T</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token comment">//希望在程序運行過程中，只能創建一個Cat對象</span>
<span class="token comment">//使用單例模式</span>
<span class="token keyword">class</span> <span class="token class-name">Cat</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span>  <span class="token keyword">int</span> n1 <span class="token operator">=</span> <span class="token number">999</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Cat</span> cat <span class="token punctuation">;</span> <span class="token comment">//默認是null</span>

    <span class="token comment">//步驟</span>
    <span class="token comment">//1.仍然構造器私有化</span>
    <span class="token comment">//2.定義一個static靜態屬性對象</span>
    <span class="token comment">//3.提供一個public的static方法，可以返回一個Cat對象</span>
    <span class="token comment">//4.懶漢式，只有當用戶使用getInstance時，才返回cat對象, 後面再次調用時，會返回上次創建的cat對象</span>
    <span class="token comment">//  從而保證了單例</span>
    <span class="token keyword">private</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"構造器調用..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Cat</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>cat <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token comment">//如果還沒有創建cat對象</span>
            cat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token string">"小可愛"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> cat<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token string">"Cat{"</span> <span class="token operator">+</span>
                <span class="token string">"name='"</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span>
                <span class="token char">'}'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="223_398">
     </a>
     2.2.3比较
    </h4>
    <ol>
     <li>
      <p>
       二者最主要的区别在于创建对象的时机不同:饿汉式是在类加载就创建了对象实例,而懒汉式是在使用时才创建。
      </p>
     </li>
     <li>
      <p>
       饿汉式不存在线程安全问题，懒汉式存在线程安全问题。(后面学习线程后，会完善一把)。
      </p>
     </li>
     <li>
      <p>
       饿汉式存在浪费资源的可能。因为如果程序员一个对象实例都没有使用，那么饿汉式创建的对象就浪费了，懒汉式是使用时才创建，就不存在这个问题。
      </p>
     </li>
     <li>
      <p>
       在我们javaSE标准类中，java.lang.Runtime就是经典的单例模式.
      </p>
     </li>
    </ol>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323330335f38323137363636372f:61727469636c652f64657461696c732f313436323133373037" class_="artid" style="display:none">
 </p>
</div>


