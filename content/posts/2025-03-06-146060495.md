---
layout: post
title: "在k8s中部署Jenkins的实践指南"
date: 2025-03-06 11:10:30 +0800
description: "本文旨在深入探讨如何在Kubernetes（K8s）集群中高效部署Jenkins，一个广泛使用的开源自动化服务器，它支持持续集成和持续部署（CI/CD）流程。随着DevOps文化的兴起，Jenkins作为CI/CD管道的核心组件，其灵活性和可扩展性在快速迭代和部署软件的过程中显得尤为重要。本文将为读者提供一个从零开始的实战教程，帮助他们在K8s环境中搭建并运行Jenkins。文章首先概述了Jenkins的基本概念及其在CI/CD流程中的作用，随后介绍了Kubernetes这一容器编排平台的优势，以及为何"
keywords: "在【k8s】中部署Jenkins的实践指南"
categories: ['未来已来云原生之旅', 'Kubernetes']
tags: ['运维', '容器', '云原生', 'Kubernetes', 'Jenkins', 'Ci']
artid: "146060495"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146060495
    alt: "在k8s中部署Jenkins的实践指南"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146060495
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146060495
cover: https://bing.ee123.net/img/rand?artid=146060495
image: https://bing.ee123.net/img/rand?artid=146060495
img: https://bing.ee123.net/img/rand?artid=146060495
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     在【k8s】中部署Jenkins的实践指南
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p class="img-center" style="margin-left:0; text-align:center">
     <img alt="" height="1080" src="https://i-blog.csdnimg.cn/blog_migrate/b0f938161dd437d90d5261dddac76e15.jpeg" width="1200"/>
    </p>
    <p style="text-align:center">
     🐇明明跟你说过：
     <span contenteditable="false" tabindex="-1">
      <a href="https://blog.csdn.net/weixin_53269650?spm=1011.2415.3001.5343" rel="noopener noreferrer" target="_blank" title="个人主页">
       个人主页
      </a>
     </span>
    </p>
    <p style="text-align:center">
     🏅个人专栏：
     <span contenteditable="false" tabindex="-1">
      <a href="https://blog.csdn.net/weixin_53269650/category_12563985.html" rel="noopener noreferrer" target="_blank" title="《Kubernetes航线图：从船长到K8s掌舵者》">
       《Kubernetes航线图：从船长到K8s掌舵者》
      </a>
     </span>
     🏅
    </p>
    <p style="text-align:center">
     🔖行路有良友，便是天堂🔖
    </p>
    <hr id="hr-toc" name="tableOfContents"/>
    <p>
    </p>
    <h2 id="%E4%B8%80%E3%80%81%E5%BC%95%E8%A8%80" name="%E4%B8%80%E3%80%81%E5%BC%95%E8%A8%80">
     一、引言
    </h2>
    <h3 id="1%E3%80%81Jenkins%E7%AE%80%E4%BB%8B" name="1%E3%80%81Jenkins%E7%AE%80%E4%BB%8B">
     1、Jenkins简介
    </h3>
    <blockquote>
     <p>
      Jenkins 是一个开源的自动化服务器，主要用于
      <span style="color:#fe2c24">
       持续集成（Continuous Integration, CI）和持续交付（Continuous Delivery, CD）
      </span>
      。它由Sun Microsystems的前员工在2004年左右开发，最初命名为Hudson。后来由于一些商标争议，项目改名为Jenkins，并且迅速成为构建、测试和部署软件项目的流行工具。
     </p>
    </blockquote>
    <p>
     <strong>
      Jenkins的主要特点包括：
     </strong>
    </p>
    <ol>
     <li>
      <strong>
       持续集成与持续交付：
      </strong>
      Jenkins可以自动监控版本控制系统中的代码变更，触发构建过程，运行测试，并根据结果决定是否部署到生产环境。这有助于快速发现集成问题并缩短开发周期。
     </li>
     <li>
      <strong>
       插件生态系统：
      </strong>
      Jenkins拥有庞大的插件库，支持几乎所有现代软件开发中可能用到的工具和技术，比如Git、Maven、Gradle等。
     </li>
     <li>
      <strong>
       易于扩展：
      </strong>
      由于Jenkins是基于Java编写的，因此它非常灵活，用户可以通过编写自定义脚本或插件来扩展其功能。
     </li>
     <li>
      <strong>
       分布式构建：
      </strong>
      Jenkins支持通过“主从”架构进行分布式构建，允许将构建任务分配给多个节点，以提高效率和资源利用率。
     </li>
     <li>
      <strong>
       图形化界面：
      </strong>
      Jenkins提供了直观的Web界面，使得配置和管理CI/CD流程变得简单。
     </li>
     <li>
      <strong>
       Pipeline即代码：
      </strong>
      Jenkins Pipeline是一个特性集，它允许用户定义其CI/CD流程为代码的形式（通常使用Groovy语言），这样可以将其纳入版本控制，并与其他团队成员共享。
     </li>
     <li>
      <strong>
       安全性：
      </strong>
      Jenkins提供了一些安全特性和认证机制，确保只有授权用户才能执行特定的操作。
     </li>
     <li>
      <strong>
       社区和支持：
      </strong>
      作为一个开源项目，Jenkins有一个活跃的社区，提供文档、论坛讨论以及第三方服务和支持。
     </li>
    </ol>
    <p>
    </p>
    <div contenteditable="false" tabindex="-1">
     <p class="img-center">
      <img alt="" height="702" src="https://i-blog.csdnimg.cn/direct/df3fd79ecbf44367a4b8339d0e9ff89f.png" width="1390">
       <span title="点击并拖拽以改变尺寸">
        ​
       </span>
      </img>
     </p>
    </div>
    <h3 id="2%E3%80%81k8s%E7%AE%80%E4%BB%8B" name="2%E3%80%81k8s%E7%AE%80%E4%BB%8B">
     2、k8s简介
    </h3>
    <blockquote>
     <p>
      <span style="color:#fe2c24">
       Kubernetes（通常简写为K8s）
      </span>
      是一个开源平台，用于自动化部署、扩展和管理容器化的应用程序。它最初由Google设计并开发，并于2014年捐赠给了云原生计算基金会（CNCF）。Kubernetes提供了强大的机制来管理分布式系统中的应用，使其能够在物理机或虚拟机集群上运行。
     </p>
    </blockquote>
    <p>
     <strong>
      特性
     </strong>
    </p>
    <ol>
     <li>
      <strong>
       自动化容器编排：
      </strong>
      自动重启失败的容器、替换和重新调度容器、水平扩展容器等。
     </li>
     <li>
      <strong>
       自我修复：
      </strong>
      如果某个节点故障，Kubernetes会自动将该节点上的工作负载迁移到其他健康的节点上。
     </li>
     <li>
      <strong>
       横向扩展：
      </strong>
      通过简单的命令、用户界面或者基于CPU使用情况自动调整应用的规模。
     </li>
     <li>
      <strong>
       服务发现与负载均衡：
      </strong>
      无需修改代码即可实现服务之间的通信，Kubernetes为容器提供了自己的IP地址以及一个DNS名称，并且可以负载均衡分配到容器上。
     </li>
     <li>
      <strong>
       自动发布与回滚：
      </strong>
      逐步发布新的版本，同时监视应用健康状况，如有问题则自动回滚更改。
     </li>
     <li>
      <strong>
       密钥与配置管理：
      </strong>
      让您可以轻松地管理和分发密码、OAuth令牌和其他敏感数据，而无需重建镜像。
     </li>
    </ol>
    <p>
     <span contenteditable="false" tabindex="-1">
      <img alt="" height="823" src="https://i-blog.csdnimg.cn/direct/0a1b342db9b342d389235b2756f2cd5e.png" width="1599">
       <span title="点击并拖拽以改变尺寸">
        ​
       </span>
      </img>
     </span>
    </p>
    <h3 id="3%E3%80%81%E4%BB%80%E4%B9%88%E5%9C%A8k8s%E4%B8%AD%E9%83%A8%E7%BD%B2Jenkins" name="3%E3%80%81%E4%BB%80%E4%B9%88%E5%9C%A8k8s%E4%B8%AD%E9%83%A8%E7%BD%B2Jenkins">
     3、什么在k8s中部署Jenkins
    </h3>
    <blockquote>
     <p>
      在Kubernetes（简称K8s）中部署Jenkins，可以带来许多好处，尤其是对于那些需要高效、可扩展和可靠的
      <span style="color:#fe2c24">
       持续集成/持续交付（CI/CD）
      </span>
      流程的企业或团队。
     </p>
    </blockquote>
    <p>
     <strong>
      <span style="background-color:#ffd7b9">
       1. 动态资源管理
      </span>
     </strong>
    </p>
    <ul>
     <li>
      想象一下，你有一家餐厅，有时候客人很多，有时候客人很少。如果每次客人都很多时，你都需要临时雇佣更多的服务员，而当客人少时又得解雇他们，这样不仅麻烦还浪费资源。而在Kubernetes中部署Jenkins就像是有一个智能管理系统，它可以根据当前的工作负载自动调整所需的服务员数量（即Jenkins构建节点）。当有很多构建任务时，系统会自动增加更多“服务员”来帮忙；反之，则减少“服务员”，从而更有效地利用资源。
     </li>
    </ul>
    <p>
     <strong>
      <span style="background-color:#ffd7b9">
       2. 提高可靠性和容错能力
      </span>
     </strong>
    </p>
    <ul>
     <li>
      如果你的餐厅只有一个厨房，一旦这个厨房出现问题，整个餐厅就无法正常运营了。同样，在传统设置下，如果Jenkins主节点出现故障，所有的构建任务都会停止。但在Kubernetes环境中，即使一个节点出问题，其他健康的节点可以立即接管工作，确保服务不间断。
     </li>
    </ul>
    <p>
     <strong>
      <span style="background-color:#ffd7b9">
       3. 快速响应变化
      </span>
     </strong>
    </p>
    <ul>
     <li>
      假设你的餐厅突然接到一个大型宴会订单，你需要快速准备好额外的食物和服务。有了Kubernetes的帮助，Jenkins可以迅速扩展其处理能力，就像瞬间增加了多个厨房一样，以应对突如其来的大量工作。完成后，还可以快速缩减规模，节省成本。
     </li>
    </ul>
    <p>
     <strong>
      <span style="background-color:#ffd7b9">
       4. 统一环境
      </span>
     </strong>
    </p>
    <ul>
     <li>
      无论是在家中准备食物还是在商业厨房里烹饪，保持一致的食谱和做法是非常重要的。将Jenkins部署到Kubernetes上，意味着你可以确保开发、测试和生产环境尽可能地相似，避免由于环境差异导致的问题。
     </li>
    </ul>
    <p>
     <span contenteditable="false" tabindex="-1">
      <img alt="" height="789" src="https://i-blog.csdnimg.cn/direct/797e8ef28570441ca3dc7e7e9e6c8fba.png" width="1518">
       <span title="点击并拖拽以改变尺寸">
        ​
       </span>
      </img>
     </span>
    </p>
    <h2 id="%E4%BA%8C%E3%80%81%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C" name="%E4%BA%8C%E3%80%81%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C">
     二、准备工作
    </h2>
    <h3 id="1%E3%80%81%E5%87%86%E5%A4%87k8s%E9%9B%86%E7%BE%A4" name="1%E3%80%81%E5%87%86%E5%A4%87k8s%E9%9B%86%E7%BE%A4">
     1、准备k8s集群
    </h3>
    <p>
     这里我们用的k8s版本为 1.23.1，大家也可以使用其他的k8s发行版本，如果还未安装k8s请参考下面的文章。
    </p>
    <p>
     <a class="link-info" href="https://blog.csdn.net/weixin_53269650/article/details/135836786" title="《在Centos中搭建 K8s 1.23 集群超详细讲解》">
      《在Centos中搭建 K8s 1.23 集群超详细讲解》
     </a>
    </p>
    <p>
     <a class="link-info" href="https://blog.csdn.net/weixin_53269650/article/details/136840197" title="《深度解析：Kubernetes 1.28.2集群安装过程中的关键步骤》">
      《深度解析：Kubernetes 1.28.2集群安装过程中的关键步骤》
     </a>
    </p>
    <p>
     <img alt="" height="739" src="https://i-blog.csdnimg.cn/direct/dc664e4d64bc435185860a60e4fd018a.png" width="1159"/>
    </p>
    <h3 id="2%E3%80%81Jenkins%E5%AE%98%E6%96%B9%E9%95%9C%E5%83%8F%E7%89%88%E6%9C%AC%E4%BB%8B%E7%BB%8D" name="2%E3%80%81Jenkins%E5%AE%98%E6%96%B9%E9%95%9C%E5%83%8F%E7%89%88%E6%9C%AC%E4%BB%8B%E7%BB%8D">
     2、Jenkins官方镜像版本介绍
    </h3>
    <p>
     <span style="background-color:#ffd7b9">
      官方镜像的推荐
     </span>
    </p>
    <ul>
     <li>
      Jenkins官方推荐使用
      <span style="color:#fe2c24">
       <span style="background-color:#f3f3f4">
        jenkinsci/blueocean
       </span>
      </span>
      这个镜像。与直接下载Jenkins的镜像相比，Blue Ocean镜像提供了更为现代和直观的用户界面，使得Jenkins的使用和管理变得更加容易。因此，对于新用户或者希望简化Jenkins使用的用户来说，推荐使用jenkinsci/blueocean镜像。
     </li>
    </ul>
    <p>
     <span style="background-color:#ffd7b9">
      镜像版本标签
     </span>
    </p>
    <p>
     Jenkins官方镜像在Docker Hub上提供了多个版本标签，以便用户选择。以下是一些常见的版本标签：
    </p>
    <ul>
     <li>
      <strong>
       latest：
      </strong>
      表示最新版本的Jenkins，包括最新的功能和安全更新。然而，由于它是最新的版本，可能存在一些未知的问题或不稳定因素。
     </li>
     <li>
      <strong>
       lts：
      </strong>
      表示长期支持版本的Jenkins，通常更稳定且经过更多的测试。它适合用于生产环境，因为提供了更多的安全更新和稳定性修复。
     </li>
     <li>
      <strong>
       具体版本号：
      </strong>
      例如2.401.1、1.24.1-bcc31d32159f等，表示特定版本的Jenkins。用户可以根据自己的需求选择特定的版本号。
     </li>
    </ul>
    <p>
     <img alt="" height="898" src="https://i-blog.csdnimg.cn/direct/f63192fa12d542e48df9635f47faae67.png" width="1647">
     </img>
    </p>
    <h3 id="3%E3%80%81Jenkins%E9%95%9C%E5%83%8F%E5%87%86%E5%A4%87" name="3%E3%80%81Jenkins%E9%95%9C%E5%83%8F%E5%87%86%E5%A4%87">
     3、Jenkins镜像准备
    </h3>
    <p>
     这里我们使用的Jenkins版本为2.410，镜像我放在个人资源中了，大家也可以自行下载或使用其他的发行版本。
    </p>
    <p>
     上传至worker节点后，执行下面的命令解压
    </p>
    <pre><code class="hljs">docker load -i jenkins-2.410.tar.gz</code></pre>
    <p>
     如果k8s版本大于1.23，则执行下面的命令
    </p>
    <pre><code class="hljs">ctr -n=k8s.io images import jenkins2.410</code></pre>
    <h2 id="%E4%B8%89%E3%80%81%E5%9C%A8Kubernetes%E4%B8%AD%E9%83%A8%E7%BD%B2Jenkins" name="%E4%B8%89%E3%80%81%E5%9C%A8Kubernetes%E4%B8%AD%E9%83%A8%E7%BD%B2Jenkins">
     <strong>
      三、在Kubernetes中部署Jenkins
     </strong>
    </h2>
    <h3 id="1%E3%80%81%E5%87%86%E5%A4%87%E5%AD%98%E5%82%A8%E8%B5%84%E6%BA%90" name="1%E3%80%81%E5%87%86%E5%A4%87%E5%AD%98%E5%82%A8%E8%B5%84%E6%BA%90">
     <strong>
      1、准备存储资源
     </strong>
    </h3>
    <p>
     我们准备一个PVC，将Jenkins的数据持久化到当中，以免pod漂移到其他节点后，历史数据丢失。
    </p>
    <p>
     下面简单介绍下如何创建PVC，更详细的可以参考
     <a class="link-info" href="https://blog.csdn.net/weixin_53269650/article/details/137505260" title="《k8s PV与PVC持久化存储详解与实际应用分享》">
      《k8s PV与PVC持久化存储详解与实际应用分享》
     </a>
     这篇文章
    </p>
    <p>
     首先准备一个NFS共享目录
    </p>
    <pre><code class="hljs">yum install nfs-utils -y
systemctl enable nfs --now
mkdir /data/jenkins -p
vim /etc/exports
# 添加下面的内容
/data/jenkins *(rw,no_root_squash)
#保存、退出
exportfs -arv</code></pre>
    <p>
     创建一个名称空间，用于部署Jenkins
    </p>
    <pre><code class="hljs">kubectl create namespace jenkins-k8s</code></pre>
    <p>
     编写pv的yaml文件
    </p>
    <pre><code class="hljs">apiVersion: v1
kind: PersistentVolume
metadata:
  name: jenkins-k8s-pv
spec:
  capacity:
    storage: 10Gi
  accessModes:
  - ReadWriteMany
  nfs:
    server: 192.168.40.181
    path: /data/jenkins</code></pre>
    <ul>
     <li>
      <span style="color:null">
       <strong>
        kind:
       </strong>
       PersistentVolume：定义了这个资源对象的类型是一个PersistentVolume（持久卷）。PersistentVolume是集群中的一段存储，它独立于Pod的生命周期而存在。
      </span>
     </li>
     <li>
      <span style="color:null">
       <strong>
        metadata:
       </strong>
       开始元数据部分，这里包含了资源对象的一些基本信息。
      </span>
      <ul>
       <li>
        <span style="color:null">
         <strong>
          <span id="cke_bm_57984C" style="display:none">
          </span>
          name: jenkins-k8s-pv：
         </strong>
         给这个PersistentVolume指定一个名称，这里是jenkins-k8s-pv。在Kubernetes集群中，每个资源对象都需要一个唯一的名称。
        </span>
       </li>
      </ul>
     </li>
     <li>
      <span style="color:null">
       <strong>
        spec:：
       </strong>
       开始定义PersistentVolume的具体规格和配置。
      </span>
      <ul>
       <li>
        <span style="color:null">
         <strong>
          <span id="cke_bm_58456C" style="display:none">
          </span>
          capacity:：
         </strong>
         定义了这个持久卷的容量。
        </span>
        <ul>
         <li>
          <span style="color:null">
           <strong>
            <span id="cke_bm_58617C" style="display:none">
            </span>
            <span id="cke_bm_58729C" style="display:none">
            </span>
            storage: 10Gi：
           </strong>
           指定了持久卷的存储大小为10GiB（Gibibytes）。
          </span>
         </li>
        </ul>
       </li>
       <li>
        <span style="color:null">
         <strong>
          <span id="cke_bm_59439C" style="display:none">
          </span>
          accessModes:：
         </strong>
         描述了持久卷可以被访问的方式或模式。
        </span>
       </li>
       <li>
        <span style="color:null">
         <strong>
          <span id="cke_bm_59923C" style="display:none">
          </span>
          - ReadWriteMany：
         </strong>
         表示这个卷可以被多个节点同时以读写方式挂载。其他可能的访问模式包括ReadWriteOnce（只能由一个节点以读写方式挂载）和ReadOnlyMany（可以被多个节点以只读方式挂载）。
        </span>
       </li>
      </ul>
     </li>
     <li>
      <span style="color:null">
       <strong>
        nfs:：
       </strong>
       指定了这个持久卷使用NFS（网络文件系统）作为其后端存储机制。
      </span>
      <ul>
       <li>
        <span style="color:null">
         <strong>
          <span id="cke_bm_60088C" style="display:none">
          </span>
          server:
         </strong>
         192.168.40.181：
        </span>
        <span style="color:#fe2c24">
         指定了NFS服务器的IP地址，这里是192.168.40.181。
        </span>
       </li>
       <li>
        <span style="color:null">
         <strong>
          <span id="cke_bm_60194C" style="display:none">
          </span>
          path:
         </strong>
         /data/jenkins：指定了NFS服务器上共享的路径，即实际存储数据的位置，在这个例子中是/data/jenkins。
        </span>
       </li>
      </ul>
     </li>
    </ul>
    <p>
     创建PV
    </p>
    <pre><code class="hljs">kubectl  apply -f pv.yaml</code></pre>
    <p>
     <span style="display:none">
     </span>
     <img alt="" height="382" src="https://i-blog.csdnimg.cn/direct/bbdeed9bc4a34e3c8ab24c304627dc7e.png" width="1296">
      <span style="display:none">
      </span>
     </img>
    </p>
    <p>
     编写创建PVC的yaml文件
    </p>
    <pre><code class="hljs">kind: PersistentVolumeClaim
apiVersion: v1
metadata:
  name: jenkins-k8s-pvc
  namespace: jenkins-k8s
spec:
  resources:
    requests:
      storage: 10Gi
  accessModes:
  - ReadWriteMany</code></pre>
    <p>
     创建PVC
    </p>
    <pre><code class="hljs">kubectl apply -f  pvc.yaml</code></pre>
    <p>
     <span style="display:none">
     </span>
     <img alt="" height="387" src="https://i-blog.csdnimg.cn/direct/3a85da94cb82473cb41b69c821bfafd5.png" width="1077">
      <span style="display:none">
      </span>
     </img>
    </p>
    <h3 id="2%E3%80%81%E5%87%86%E5%A4%87%E8%B4%A6%E5%8F%B7" name="2%E3%80%81%E5%87%86%E5%A4%87%E8%B4%A6%E5%8F%B7">
     2、准备账号
    </h3>
    <p>
     创建sa账号
    </p>
    <pre><code class="hljs">kubectl create sa jenkins-k8s-sa -n jenkins-k8s</code></pre>
    <p>
     进行RBAC授权
    </p>
    <pre><code class="hljs">kubectl create clusterrolebinding jenkins-k8s-sa-cluster -n jenkins-k8s  --clusterrole=cluster-admin --serviceaccount=jenkins-k8s:jenkins-k8s-sa</code></pre>
    <h3 id="3%E3%80%81%E9%83%A8%E7%BD%B2Jenkins" name="3%E3%80%81%E9%83%A8%E7%BD%B2Jenkins">
     3、部署Jenkins
    </h3>
    <p>
     准备yaml文件
    </p>
    <pre><code class="hljs">kind: Deployment
apiVersion: apps/v1
metadata:
  name: jenkins
  namespace: jenkins-k8s
spec:
  replicas: 1
  selector:
    matchLabels:
      app: jenkins
  template:
    metadata:
      labels:
        app: jenkins
    spec:
      serviceAccount: jenkins-k8s-sa
      containers:
      - name: jenkins
        image:  jenkins/jenkins:2.410
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 8080
          name: web
          protocol: TCP
        - containerPort: 50000
          name: agent
          protocol: TCP
        resources:
          limits:
            cpu: 2000m
            memory: 2Gi
          requests:
            cpu: 500m
            memory: 512Mi
        livenessProbe:
          httpGet:
            path: /login
            port: 8080
          initialDelaySeconds: 60
          timeoutSeconds: 5
          failureThreshold: 12
        readinessProbe:
          httpGet:
            path: /login
            port: 8080
          initialDelaySeconds: 60
          timeoutSeconds: 5
          failureThreshold: 12
        volumeMounts:
        - name: jenkins-volume
          subPath: jenkins-home
          mountPath: /var/jenkins_home
      volumes:
      - name: jenkins-volume
        persistentVolumeClaim:
          claimName: jenkins-k8s-pvc</code></pre>
    <p>
     部署Jenkins
    </p>
    <pre><code class="hljs">kubectl apply -f jenkins-deployment.yaml</code></pre>
    <h3 id="4%E3%80%81%E5%88%9B%E5%BB%BAService" name="4%E3%80%81%E5%88%9B%E5%BB%BAService">
     4、创建Service
    </h3>
    <p>
     部署成功后，创建一个service，以供外部访问
    </p>
    <p>
     编写yaml文件
    </p>
    <pre><code class="hljs">apiVersion: v1
kind: Service
metadata:
  name: jenkins-service
  namespace: jenkins-k8s
  labels:
    app: jenkins
spec:
  selector:
    app: jenkins
  type: NodePort
  ports:
  - name: web
    port: 8080
    targetPort: web
    nodePort: 30089
  - name: agent
    port: 50000
    targetPort: agent</code></pre>
    <p>
     创建service
    </p>
    <pre><code class="hljs">kubectl apply -f  service.yaml</code></pre>
    <h3 id="5%E3%80%81%E8%AE%BF%E9%97%AE%E6%B5%8B%E8%AF%95" name="5%E3%80%81%E8%AE%BF%E9%97%AE%E6%B5%8B%E8%AF%95">
     5、访问测试
    </h3>
    <p>
     浏览器输入worker节点的IP+30089端口，如果显示下面的页面，证明部署成功
    </p>
    <p>
     <span style="display:none">
     </span>
     <img alt="" height="1539" src="https://i-blog.csdnimg.cn/direct/08646395ff9043718dcebb22a8136faa.png" width="2571">
      <span style="display:none">
      </span>
     </img>
    </p>
    <blockquote>
     <p>
      💕💕💕每一次的分享都是一次成长的旅程，感谢您的陪伴和关注。希望这些关于Docker的文章能陪伴您走过技术的一段旅程，共同见证成长和进步！😺😺😺
     </p>
     <p>
     </p>
     <p>
      🧨🧨🧨让我们一起在技术的海洋中探索前行，共同书写美好的未来！！！
     </p>
    </blockquote>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f35333236393635302f:61727469636c652f64657461696c732f313436303630343935" class_="artid" style="display:none">
 </p>
</div>


