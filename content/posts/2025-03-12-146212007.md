---
layout: post
title: "npmpnpmcnpmyarnnpx之间的区别"
date: 2025-03-12 18:43:34 +0800
description: "在 NPM 的扁平化结构中，你的代码可能直接引用 B（即使未声明依赖 B），导致潜在风险；结构是非扁平化的，每个依赖只能访问其显式声明的依赖，避免了“幽灵依赖”（Phantom Dependencies）问题。早期 npm 安装依赖时是顺序下载且无缓存复用，速度较慢（NPM 5+ 已改进，但 Yarn 仍有一定优势）。文件，严格锁定依赖树中每个包的具体版本和哈希值，确保不同环境下安装的依赖完全一致，防止恶意代码注入。新项目安装依赖时，若全局已有该包，直接创建硬链接，无需重新下载。"
keywords: "npm、pnpm、cnpm、yarn、npx之间的区别"
categories: ['工具']
tags: ['前端', 'Npm', 'Node']
artid: "146212007"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146212007
    alt: "npmpnpmcnpmyarnnpx之间的区别"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146212007
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146212007
cover: https://bing.ee123.net/img/rand?artid=146212007
image: https://bing.ee123.net/img/rand?artid=146212007
img: https://bing.ee123.net/img/rand?artid=146212007
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     npm、pnpm、cnpm、yarn、npx之间的区别
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <hr/>
    <h2>
     <a id="_3">
     </a>
     区别
    </h2>
    <table>
     <thead>
      <tr>
       <th>
        特性
       </th>
       <th>
        npm
       </th>
       <th>
        yarn
       </th>
       <th>
        pnpm
       </th>
       <th>
        cnpm
       </th>
       <th>
        npx
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <strong>
         核心定位
        </strong>
       </td>
       <td>
        Node.js 默认包管理
       </td>
       <td>
        增强稳定性与性能
       </td>
       <td>
        高效存储与严格隔离
       </td>
       <td>
        国内镜像加速工具
       </td>
       <td>
        临时执行包命令
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         依赖存储方式
        </strong>
       </td>
       <td>
        扁平化 node_modules
       </td>
       <td>
        扁平化 + lock 文件
       </td>
       <td>
        全局硬链接 + 符号链接
       </td>
       <td>
        同 npm
       </td>
       <td>
        不适用
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         安装速度
        </strong>
       </td>
       <td>
        较慢
       </td>
       <td>
        较快（并行下载）
       </td>
       <td>
        最快（复用缓存）
       </td>
       <td>
        快（国内 CDN）
       </td>
       <td>
        不适用
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         磁盘占用
        </strong>
       </td>
       <td>
        高
       </td>
       <td>
        高
       </td>
       <td>
        极低（共享存储）
       </td>
       <td>
        高
       </td>
       <td>
        无
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         依赖隔离性
        </strong>
       </td>
       <td>
        弱（依赖提升）
       </td>
       <td>
        中（lock 文件控制）
       </td>
       <td>
        强（符号链接隔离）
       </td>
       <td>
        同 npm
       </td>
       <td>
        不适用
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         Monorepo 支持
        </strong>
       </td>
       <td>
        基础（workspaces）
       </td>
       <td>
        强大（workspaces）
       </td>
       <td>
        原生支持
       </td>
       <td>
        不支持
       </td>
       <td>
        不适用
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         锁文件
        </strong>
       </td>
       <td>
        <code>
         package-lock.json
        </code>
       </td>
       <td>
        <code>
         yarn.lock
        </code>
       </td>
       <td>
        <code>
         pnpm-lock.yaml
        </code>
       </td>
       <td>
        同 npm
       </td>
       <td>
        无
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         安全性
        </strong>
       </td>
       <td>
        中
       </td>
       <td>
        高
       </td>
       <td>
        极高
       </td>
       <td>
        低（镜像源风险）
       </td>
       <td>
        中
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         国内网络优化
        </strong>
       </td>
       <td>
        无
       </td>
       <td>
        无
       </td>
       <td>
        无
       </td>
       <td>
        有（淘宝镜像）
       </td>
       <td>
        无
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         典型命令
        </strong>
       </td>
       <td>
        <code>
         npm install
        </code>
       </td>
       <td>
        <code>
         yarn add
        </code>
       </td>
       <td>
        <code>
         pnpm add
        </code>
       </td>
       <td>
        <code>
         cnpm install
        </code>
       </td>
       <td>
        <code>
         npx create-app
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         适用场景
        </strong>
       </td>
       <td>
        简单项目、兼容性需求
       </td>
       <td>
        中大型项目、稳定性
       </td>
       <td>
        大型项目、Monorepo
       </td>
       <td>
        国内网络环境加速
       </td>
       <td>
        临时执行 CLI 工具
       </td>
      </tr>
     </tbody>
    </table>
    <hr/>
    <h2>
     <a id="_22">
     </a>
     特点
    </h2>
    <h3>
     <a id="pnpm_23">
     </a>
     pnpm
    </h3>
    <p>
     <font color="red">
      pnpm 使用
      <strong>
       硬链接（Hard Link）和符号链接（Symlink）
      </strong>
      来管理依赖文件。所有依赖包的实际文件存储在全局的单一内容寻址存储中（类似 Git），不同项目共享相同文件。
     </font>
    </p>
    <p>
     <strong>
      优势：
     </strong>
    </p>
    <ol>
     <li>
      <p>
       <strong>
        节省磁盘空间：
       </strong>
      </p>
      <ul>
       <li>
        <p>
         <font color="red">
          所有依赖的每个版本仅保存一份实体文件。
         </font>
         （例如，10 个项目都依赖
         <code>
          lodash@4.17.21
         </code>
         ，磁盘上只保留一份文件。）
        </p>
       </li>
       <li>
        <p>
         <font color="red">
          多个项目共用同一依赖的同一版本时，无需重复下载。
         </font>
        </p>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        安装速度快：
       </strong>
      </p>
      <ul>
       <li>
        <font color="red">
         新项目安装依赖时，若全局已有该包，直接创建硬链接，无需重新下载。
        </font>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        非扁平化结构：
       </strong>
      </p>
      <ul>
       <li>
        <p>
         pnpm 的
         <code>
          node_modules
         </code>
         结构是非扁平化的，每个依赖只能访问其显式声明的依赖，避免了“幽灵依赖”（Phantom Dependencies）问题。
        </p>
       </li>
       <li>
        <p>
         例如，你的项目依赖 A，而 A 依赖 B。在 NPM 的扁平化结构中，你的代码可能直接引用 B（即使未声明依赖 B），导致潜在风险；而 PNPM 会严格限制这种访问。
        </p>
       </li>
      </ul>
     </li>
    </ol>
    <p>
     .
    </p>
    <h3>
     <a id="yarn_47">
     </a>
     yarn
    </h3>
    <p>
     <strong>
      <a href="https://xiabing.blog.csdn.net/article/details/79205812" rel="nofollow">
       yarn详细入门教程
      </a>
     </strong>
    </p>
    <p>
     yarn 在速度、稳定性和 Monorepo 支持上优于 NPM，适合对依赖管理要求严格的场景。若项目已使用 NPM，可权衡迁移成本；若为新项目，Yarn 是更现代的选择（尤其是 Yarn 2+）。
    </p>
    <p>
     <strong>
      优势：
     </strong>
    </p>
    <ol>
     <li>
      <p>
       <strong>
        并行下载:
       </strong>
      </p>
      <ul>
       <li>
        <p>
         可以并行下载依赖包，显著提升安装速度（尤其在依赖数量多时）。
        </p>
       </li>
       <li>
        <p>
         早期 npm 安装依赖时是顺序下载且无缓存复用，速度较慢（NPM 5+ 已改进，但 Yarn 仍有一定优势）。
        </p>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        本地缓存机制：
       </strong>
      </p>
      <p>
       所有下载过的依赖会缓存在本地，后续安装直接从缓存读取，减少网络请求。
      </p>
     </li>
     <li>
      <p>
       <strong>
        lock 文件:
       </strong>
      </p>
      <ul>
       <li>
        <p>
         yarn 默认生成
         <code>
          yarn.lock
         </code>
         文件，严格锁定依赖树中每个包的具体版本和哈希值，确保不同环境下安装的依赖完全一致，防止恶意代码注入。
        </p>
       </li>
       <li>
        <p>
         对比：早期 npm 的
         <code>
          package-lock.json
         </code>
         在部分场景下可能因版本范围定义不严格导致依赖版本漂移（NPM 5+ 已改进，但 Yarn 的锁定机制更早成熟）。
        </p>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        离线模式：
       </strong>
       <br/>
       yarn 优先从本地缓存安装依赖，即使无网络连接也可完成安装（需提前缓存过依赖）。
      </p>
     </li>
    </ol>
    <p>
     .
    </p>
    <h3>
     <a id="cnpm_77">
     </a>
     cnpm
    </h3>
    <p>
     cnpm 是淘宝镜像提供的工具，主要针对国内用户，解决npm在国内下载速度慢的问题。它的核心优势应该在于镜像源的速度和稳定性，以及可能的并行安装提升速度。
    </p>
    <p>
     cnpm 默认使用淘宝镜像源（
     <code>
      https://registry.npmmirror.com
     </code>
     ），所有依赖包会从国内服务器下载，避开国际网络延迟。
    </p>
    <p>
     优势：
    </p>
    <ol>
     <li>
      <p>
       <strong>
        下载速度极快：
       </strong>
      </p>
      <ul>
       <li>
        <p>
         国内用户安装依赖的速度可提升 5-10 倍（尤其对大体积包如 node-sass、electron 等效果显著）。
        </p>
       </li>
       <li>
        <p>
         避免因国际网络波动导致的安装失败，稳定性高。
        </p>
       </li>
       <li>
        <p>
         而 npm 默认从
         <code>
          registry.npmjs.org
         </code>
         下载，国内直连速度慢且不稳定。
        </p>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        完全兼容 NPM 的命令：
       </strong>
      </p>
      <ul>
       <li>
        <p>
         cnpm 完全兼容 npm 的命令（如
         <code>
          cnpm install
         </code>
         、
         <code>
          cnpm publish
         </code>
         ），仅需将 npm 替换为 cnpm 即可使用。
        </p>
       </li>
       <li>
        <p>
         支持私有源，可通过
         <code>
          cnpm config set registry &lt;url&gt;
         </code>
         切换为私有仓库（如企业内网源）。
        </p>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        镜像同步频率高：
       </strong>
      </p>
      <ul>
       <li>
        <p>
         实时同步：淘宝镜像每隔 10 分钟与 NPM 官方仓库同步一次，基本覆盖最新版本。
        </p>
       </li>
       <li>
        <p>
         容灾备份：镜像服务器分布多地，避免单点故障。
        </p>
       </li>
      </ul>
     </li>
    </ol>
    <p>
     <strong>
      配置：
     </strong>
    </p>
    <ol>
     <li>
      <p>
       全局配置：建议全局配置淘宝镜像，提升日常开发效率
       <br/>
       <code>
        npm config set registry https://registry.npmmirror.com
       </code>
      </p>
     </li>
     <li>
      <p>
       临时需求：若需从官方源安装个别包，可通过参数临时指定
       <br/>
       <code>
        npm install some-package --registry=https://registry.npmjs.org
       </code>
      </p>
     </li>
    </ol>
    <hr/>
    <h2>
     <a id="_116">
     </a>
     关键解读
    </h2>
    <p>
     <strong>
      1. 存储机制
     </strong>
     <br/>
     pnpm 通过硬链接复用全局依赖，节省 70%+ 磁盘空间。
     <br/>
     npm/yarn 的扁平化结构易导致依赖冲突。
    </p>
    <p>
     <strong>
      2. 安装效率
     </strong>
     <br/>
     pnpm &gt; yarn &gt; npm（尤其在依赖重复场景）。
     <br/>
     cnpm 依赖国内 CDN，适合解决网络问题。
    </p>
    <p>
     <strong>
      3. Monorepo 支持
     </strong>
     <br/>
     pnpm 和 yarn 有原生优化，npm 需手动配置。
    </p>
    <p>
     <strong>
      4. 安全性
     </strong>
     <br/>
     pnpm 严格隔离依赖，避免非法访问；cnpm 镜像源需注意信任问题。
    </p>
    <p>
     <strong>
      5. 临时执行
     </strong>
     <br/>
     npx 专为运行一次性命令设计（如脚手架工具），无需全局安装。
    </p>
    <hr/>
    <h2>
     <a id="_135">
     </a>
     如何选择
    </h2>
    <ul>
     <li>
      <p>
       个人/小团队：优先 pnpm（省空间+快）或 yarn（功能全）。
      </p>
     </li>
     <li>
      <p>
       国内网络环境：用 cnpm 加速，但生产环境切回 npm 或 pnpm。
      </p>
     </li>
     <li>
      <p>
       Monorepo 项目：pnpm 或 yarn workspace。
      </p>
     </li>
     <li>
      <p>
       临时执行 CLI：无脑 npx。
      </p>
     </li>
    </ul>
    <hr/>
    <h2>
     <a id="_147">
     </a>
     代码示例
    </h2>
    <h3>
     <a id="_149">
     </a>
     安装依赖
    </h3>
    <pre><code class="prism language-bash"><span class="token comment"># npm</span>
<span class="token function">npm</span> <span class="token function">install</span> lodash

<span class="token comment"># yarn</span>
<span class="token function">yarn</span> <span class="token function">add</span> lodash

<span class="token comment"># pnpm</span>
<span class="token function">pnpm</span> <span class="token function">add</span> lodash

<span class="token comment"># cnpm</span>
cnpm <span class="token function">install</span> lodash
</code></pre>
    <h3>
     <a id="_164">
     </a>
     运行命令
    </h3>
    <pre><code class="prism language-bash"><span class="token comment"># npm</span>
<span class="token function">npm</span> run dev

<span class="token comment"># yarn</span>
<span class="token function">yarn</span> dev

<span class="token comment"># pnpm</span>
<span class="token function">pnpm</span> dev

<span class="token comment"># npx（临时运行）</span>
npx vite create my-project
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
  <div class="blog-extension-box" id="blogExtensionBox" style="width:400px;margin:auto;margin-top:12px">
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f783535303339323233362f:61727469636c652f64657461696c732f313436323132303037" class_="artid" style="display:none">
 </p>
</div>


