---
layout: post
title: "Android笔记android-6.0-TextView对state_selected失效"
date: 2025-03-06 20:35:49 +0800
description: "通过以上方法，应该可以解决 Android 6.0 中 TextView 的 state_selected 失效问题。如果问题仍然存在，建议检查日志信息，查看是否有其他异常情况。在 Android 6.0 系统中，TextView 的 state_selected 状态失效可能由多种原因导致，下面为你详细分析原因并提供相应的解决办法。"
keywords: "Android笔记：android 6.0 TextView对state_selected失效"
categories: ['未分类']
tags: ['网络', '经验分享', '笔记', '社交电子', 'Android']
artid: "146079704"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146079704
    alt: "Android笔记android-6.0-TextView对state_selected失效"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146079704
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146079704
cover: https://bing.ee123.net/img/rand?artid=146079704
image: https://bing.ee123.net/img/rand?artid=146079704
img: https://bing.ee123.net/img/rand?artid=146079704
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Android笔记：android 6.0 TextView对state_selected失效
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     在 Android 6.0 系统中，TextView 的 state_selected 状态失效可能由多种原因导致，下面为你详细分析原因并提供相应的解决办法。
     <br/>
     原因分析
    </p>
    <ol>
     <li>
      系统兼容性问题
      <br/>
      Android 6.0 系统在处理视图状态和样式方面可能存在一些兼容性问题，导致 state_selected 状态不能被正确识别和应用对应的样式。
     </li>
     <li>
      样式资源加载问题
      <br/>
      可能是样式资源文件（如 selector 文件）的配置有误，或者资源文件没有被正确加载，使得 state_selected 对应的样式无法生效。
     </li>
     <li>
      代码逻辑问题
      <br/>
      在代码中没有正确设置 TextView 的 selected 状态，或者状态的改变没有触发样式的更新。
      <br/>
      解决办法
     </li>
     <li>
      检查和优化样式资源文件
      <br/>
      确保 selector 文件正确配置，并且能被正确加载。以下是一个示例 selector 文件：
      <br/>
      xml
     </li>
    </ol>
    <pre><code class="prism language-cpp"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> res<span class="token operator">/</span>drawable<span class="token operator">/</span>text_color_selector<span class="token punctuation">.</span>xml <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>selector xmlns<span class="token operator">:</span>android<span class="token operator">=</span><span class="token string">"http://schemas.android.com/apk/res/android"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>item android<span class="token operator">:</span>state_selected<span class="token operator">=</span><span class="token string">"true"</span> android<span class="token operator">:</span>color<span class="token operator">=</span><span class="token string">"#FF0000"</span> <span class="token operator">/</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 选中状态下文字颜色为红色 <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>item android<span class="token operator">:</span>color<span class="token operator">=</span><span class="token string">"#000000"</span> <span class="token operator">/</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 默认状态下文字颜色为黑色 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>selector<span class="token operator">&gt;</span>
</code></pre>
    <p>
     在布局文件中引用该 selector 文件：
     <br/>
     xml
    </p>
    <pre><code class="prism language-cpp"><span class="token operator">&lt;</span>TextView
    android<span class="token operator">:</span>layout_width<span class="token operator">=</span><span class="token string">"wrap_content"</span>
    android<span class="token operator">:</span>layout_height<span class="token operator">=</span><span class="token string">"wrap_content"</span>
    android<span class="token operator">:</span>text<span class="token operator">=</span><span class="token string">"这是一个 TextView"</span>
    android<span class="token operator">:</span>textColor<span class="token operator">=</span><span class="token string">"@drawable/text_color_selector"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre>
    <ol start="2">
     <li>
      确保代码中正确设置 selected 状态
      <br/>
      在代码中，要确保在合适的时机正确设置 TextView 的 selected 状态。以下是一个示例：
     </li>
    </ol>
    <pre><code class="prism language-cpp">java
<span class="token keyword">import</span> <span class="token module">android<span class="token punctuation">.</span>os<span class="token punctuation">.</span>Bundle</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token module">android<span class="token punctuation">.</span>view<span class="token punctuation">.</span>View</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token module">android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span>TextView</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token module">androidx<span class="token punctuation">.</span>appcompat<span class="token punctuation">.</span>app<span class="token punctuation">.</span>AppCompatActivity</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainActivity</span> extends AppCompatActivity <span class="token punctuation">{<!-- --></span>

    @Override
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>Bundle savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        super<span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setContentView</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_main<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">final</span> TextView textView <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>textView<span class="token punctuation">)</span><span class="token punctuation">;</span>
        textView<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> View<span class="token punctuation">.</span><span class="token function">OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            @Override
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span>View v<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                textView<span class="token punctuation">.</span><span class="token function">setSelected</span><span class="token punctuation">(</span><span class="token operator">!</span>textView<span class="token punctuation">.</span><span class="token function">isSelected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
kotlin
<span class="token keyword">import</span> <span class="token module">android<span class="token punctuation">.</span>os<span class="token punctuation">.</span>Bundle</span>
<span class="token keyword">import</span> <span class="token module">android<span class="token punctuation">.</span>view<span class="token punctuation">.</span>View</span>
<span class="token keyword">import</span> <span class="token module">android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span>TextView</span>
<span class="token keyword">import</span> <span class="token module">androidx<span class="token punctuation">.</span>appcompat<span class="token punctuation">.</span>app<span class="token punctuation">.</span>AppCompatActivity</span>

<span class="token keyword">class</span> <span class="token class-name">MainActivity</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">override</span> fun <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        super<span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>
        <span class="token function">setContentView</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_main<span class="token punctuation">)</span>

        val textView<span class="token operator">:</span> TextView <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>textView<span class="token punctuation">)</span>
        textView<span class="token punctuation">.</span>setOnClickListener <span class="token punctuation">{<!-- --></span>
            textView<span class="token punctuation">.</span>isSelected <span class="token operator">=</span> <span class="token operator">!</span>textView<span class="token punctuation">.</span>isSelected
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <ol start="3">
     <li>
      使用 setBackgroundResource 方法手动更新样式
      <br/>
      如果 state_selected 仍然失效，可以尝试在代码中手动更新 TextView 的样式。以下是一个示例：
      <br/>
      java
     </li>
    </ol>
    <pre><code class="prism language-cpp"><span class="token keyword">import</span> <span class="token module">android<span class="token punctuation">.</span>os<span class="token punctuation">.</span>Bundle</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token module">android<span class="token punctuation">.</span>view<span class="token punctuation">.</span>View</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token module">android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span>TextView</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token module">androidx<span class="token punctuation">.</span>appcompat<span class="token punctuation">.</span>app<span class="token punctuation">.</span>AppCompatActivity</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainActivity</span> extends AppCompatActivity <span class="token punctuation">{<!-- --></span>

    @Override
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>Bundle savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        super<span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setContentView</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_main<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">final</span> TextView textView <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>textView<span class="token punctuation">)</span><span class="token punctuation">;</span>
        textView<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> View<span class="token punctuation">.</span><span class="token function">OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            @Override
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span>View v<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>textView<span class="token punctuation">.</span><span class="token function">isSelected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    textView<span class="token punctuation">.</span><span class="token function">setSelected</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    textView<span class="token punctuation">.</span><span class="token function">setTextColor</span><span class="token punctuation">(</span><span class="token function">getResources</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getColor</span><span class="token punctuation">(</span>android<span class="token punctuation">.</span>R<span class="token punctuation">.</span>color<span class="token punctuation">.</span>black<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    textView<span class="token punctuation">.</span><span class="token function">setSelected</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    textView<span class="token punctuation">.</span><span class="token function">setTextColor</span><span class="token punctuation">(</span><span class="token function">getResources</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getColor</span><span class="token punctuation">(</span>android<span class="token punctuation">.</span>R<span class="token punctuation">.</span>color<span class="token punctuation">.</span>holo_red_dark<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     kotlin
    </p>
    <pre><code class="prism language-cpp"><span class="token keyword">import</span> <span class="token module">android<span class="token punctuation">.</span>os<span class="token punctuation">.</span>Bundle</span>
<span class="token keyword">import</span> <span class="token module">android<span class="token punctuation">.</span>view<span class="token punctuation">.</span>View</span>
<span class="token keyword">import</span> <span class="token module">android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span>TextView</span>
<span class="token keyword">import</span> <span class="token module">androidx<span class="token punctuation">.</span>appcompat<span class="token punctuation">.</span>app<span class="token punctuation">.</span>AppCompatActivity</span>

<span class="token keyword">class</span> <span class="token class-name">MainActivity</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token function">AppCompatActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">override</span> fun <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        super<span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>
        <span class="token function">setContentView</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_main<span class="token punctuation">)</span>

        val textView<span class="token operator">:</span> TextView <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>textView<span class="token punctuation">)</span>
        textView<span class="token punctuation">.</span>setOnClickListener <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>textView<span class="token punctuation">.</span>isSelected<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                textView<span class="token punctuation">.</span>isSelected <span class="token operator">=</span> <span class="token boolean">false</span>
                textView<span class="token punctuation">.</span><span class="token function">setTextColor</span><span class="token punctuation">(</span>resources<span class="token punctuation">.</span><span class="token function">getColor</span><span class="token punctuation">(</span>android<span class="token punctuation">.</span>R<span class="token punctuation">.</span>color<span class="token punctuation">.</span>black<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                textView<span class="token punctuation">.</span>isSelected <span class="token operator">=</span> <span class="token boolean">true</span>
                textView<span class="token punctuation">.</span><span class="token function">setTextColor</span><span class="token punctuation">(</span>resources<span class="token punctuation">.</span><span class="token function">getColor</span><span class="token punctuation">(</span>android<span class="token punctuation">.</span>R<span class="token punctuation">.</span>color<span class="token punctuation">.</span>holo_red_dark<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <ol start="4">
     <li>
      关闭硬件加速
      <br/>
      有时候，硬件加速可能会导致某些视图状态和样式显示异常。可以尝试在 AndroidManifest.xml 中关闭硬件加速：
     </li>
    </ol>
    <pre><code class="prism language-cpp">
<span class="token operator">&lt;</span>application
    android<span class="token operator">:</span>hardwareAccelerated<span class="token operator">=</span><span class="token string">"false"</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token operator">&gt;</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>application<span class="token operator">&gt;</span>

或者针对特定的 Activity 关闭硬件加速：

<span class="token operator">&lt;</span>activity
    android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">".MainActivity"</span>
    android<span class="token operator">:</span>hardwareAccelerated<span class="token operator">=</span><span class="token string">"false"</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token operator">&gt;</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>activity<span class="token operator">&gt;</span>
</code></pre>
    <p>
     通过以上方法，应该可以解决 Android 6.0 中 TextView 的 state_selected 失效问题。如果问题仍然存在，建议检查日志信息，查看是否有其他异常情况。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
  <div class="blog-extension-box" id="blogExtensionBox" style="width:400px;margin:auto;margin-top:12px">
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f32353734393734392f:61727469636c652f64657461696c732f313436303739373034" class_="artid" style="display:none">
 </p>
</div>


