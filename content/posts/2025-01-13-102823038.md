---
layout: post
title: "webrtc学习笔记"
date: 2025-01-13 22:31:22 +0800
description: "内容整理自2019RTC大会webrtc工作坊李超老师演讲ppt1.实时通信的主要矛盾实时通信与网络"
keywords: "selective forwarding unit"
categories: ['Rtc']
tags: ['无标签']
artid: "102823038"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=102823038
    alt: "webrtc学习笔记"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=102823038
featuredImagePreview: https://bing.ee123.net/img/rand?artid=102823038
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     webrtc学习笔记
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     内容整理自2019RTC大会webrtc工作坊李超老师演讲ppt
    </p>
    <h2>
     1.实时通信的主要矛盾
    </h2>
    <p>
     实时通信与网络传输的矛盾
    </p>
    <p>
     网络传输质量与音视频服务质量的矛盾
    </p>
    <h2>
     2.webrtc能做啥
    </h2>
    <p>
     音视频实时互动
    </p>
    <p>
     游戏，即时通讯，文件传输等
    </p>
    <p>
     音视频处理（回音消除，降噪）
    </p>
    <h2>
     3.webrtc的主要内容
    </h2>
    <p>
     音视频采集
    </p>
    <p>
     webrtc信令服务器的实现
    </p>
    <p>
     NAT,STUN,TURN,ICE
    </p>
    <p>
     媒体协商
    </p>
    <p>
     webrtc使用的sdp
    </p>
    <p>
     1对1实时通话
    </p>
    <h2>
     4.服务质量的主要内容
    </h2>
    <p>
     （1）TCP/UDP如何选择
    </p>
    <p>
     （2）如何保证网络服务质量
    </p>
    <p>
     延迟低，丢包 RTX
    </p>
    <p>
     延迟高 FEC
    </p>
    <p>
     jitterBuffer 网络平滑，防止乱序
    </p>
    <p>
     （3）网络带宽的评估
    </p>
    <p>
     GCC-REMB
    </p>
    <p>
     GCC-TransportCC
    </p>
    <p>
     基于丢包的评估算法
    </p>
    <p>
     基于延迟的评估算法
    </p>
    <p>
     （4）减少网络上传输的内容
    </p>
    <p>
     固定带宽减少内容：动态码流，simulcast，SVC，业务定制
    </p>
    <h2>
     5.流媒体服务器的主要内容
    </h2>
    <p>
     多人互动架构方案
    </p>
    <p>
     各媒体服务器架构模型
    </p>
    <p>
     如何实现流媒体服务器
    </p>
    <h2>
     6.整体框架
    </h2>
    <p>
     <img alt="" class="has" height="200" src="https://i-blog.csdnimg.cn/blog_migrate/bdd49df71ca49211125b5542f59f5ff8.png" width="692"/>
    </p>
    <p>
    </p>
    <h2>
     7.音视频采集
    </h2>
    <p>
     枚举音视频设备
    </p>
    <p>
     采集音视频数据
    </p>
    <h2>
     8.webrtc信令系统
    </h2>
    <p>
     <img alt="" class="has" height="143" src="https://i-blog.csdnimg.cn/blog_migrate/bca404f1680ba19373fa807211c6da1e.png" width="521"/>
    </p>
    <p>
     信令系统的作用：
    </p>
    <p>
     ①让双方进入到同一个房间进行管理
    </p>
    <p>
     ②交换双方的媒体能力（SDP）
    </p>
    <p>
     ③交换双方的candidate数据
    </p>
    <h2>
     9.房间管理状态机
    </h2>
    <p>
     <img alt="" class="has" height="187" src="https://i-blog.csdnimg.cn/blog_migrate/2be4c96a5b25e105babfe2418edb01b4.png" width="315"/>
    </p>
    <h2>
     10.信令系统的实现
    </h2>
    <p>
     socket.io
    </p>
    <p>
     websocket/protoo
    </p>
    <h2>
     11.客户端信令消息
    </h2>
    <p>
     join加入房间
    </p>
    <p>
     leave离开房间
    </p>
    <p>
     message端到端消息
    </p>
    <h2>
     12.端到端信令消息
    </h2>
    <p>
     offer消息
    </p>
    <p>
     answer消息
    </p>
    <p>
     candidate消息
    </p>
    <h2>
     13.服务端信令消息
    </h2>
    <p>
     joined已加入房间
    </p>
    <p>
     otherjoin其他用户加入房间
    </p>
    <p>
     full房间人数已满
    </p>
    <p>
     leaved已离开房间
    </p>
    <p>
     bye对方离开房间
    </p>
    <h2>
     14.直播系统消息处理流程
    </h2>
    <p>
     <img alt="" class="has" height="351" src="https://i-blog.csdnimg.cn/blog_migrate/696a15d1b9391e7cb914ed1fdd2ce461.png" width="550"/>
    </p>
    <h2>
     15.webrtc传输
    </h2>
    <p>
     NAT(network address translator)
    </p>
    <p>
     STUN(simple traversal of UDP through NAT)
    </p>
    <p>
     TURN(traversal using relays around NAT)
    </p>
    <p>
     ICE(interactive connectivity establishment)
    </p>
    <h2>
     16.NAT类型
    </h2>
    <p>
     完全锥形NAT
    </p>
    <p>
     地址限制锥形NAT
    </p>
    <p>
     端口限制锥形NAT
    </p>
    <p>
     对称性NAT
    </p>
    <h2>
     17.candidate类型
    </h2>
    <p>
     主机候选者
    </p>
    <p>
     反射候选者
    </p>
    <p>
     中继候选者
    </p>
    <h2>
     18.ICE具体做些什么
    </h2>
    <p>
     收集candidate
    </p>
    <p>
     对candidate pair排序
    </p>
    <p>
     连通性检查
    </p>
    <h2>
     19.candidate关系图
    </h2>
    <p>
     <img alt="" class="has" height="192" src="https://i-blog.csdnimg.cn/blog_migrate/1fdd3cb58b9f379937d0415800a1c592.png" width="191"/>
    </p>
    <p>
     意思大概就是能直接用本机地址通信就直接用本机地址，不能的话就NAT，还不行的话就通过中继。
    </p>
    <h2>
     20.媒体协商过程
    </h2>
    <p>
     <img alt="" class="has" height="119" src="https://i-blog.csdnimg.cn/blog_migrate/5d10d535f8c03a9acfda2b12390cacab.png" width="400"/>
    </p>
    <h2>
     21.SDP规范
    </h2>
    <p>
     （1）会话层
    </p>
    <p>
     会话的名称与目的
    </p>
    <p>
     会话的存活时间
    </p>
    <p>
     会话中包括多个媒体信息
    </p>
    <p>
     （2）媒体层
    </p>
    <p>
     媒体格式
    </p>
    <p>
     传输协议
    </p>
    <p>
     传输IP与端口
    </p>
    <p>
     媒体负载类型
    </p>
    <h2>
     22.webrtc中的SDP
    </h2>
    <p>
     SDP组成：会话元，网络描述，流描述，安全描述，服务质量
    </p>
    <h2>
     23.客户端流程图
    </h2>
    <p>
     （1）加入房间
    </p>
    <p>
     <img alt="" class="has" height="256" src="https://i-blog.csdnimg.cn/blog_migrate/68ee32a4458f802b51d928edad43bef3.png" width="322"/>
    </p>
    <p>
     （2）离开房间
    </p>
    <p>
     <img alt="" class="has" height="164" src="https://i-blog.csdnimg.cn/blog_migrate/3b8fd94e3a2d65287a6a38e919089cda.png" width="295"/>
    </p>
    <h2>
     24.端对端连接的基本流程
    </h2>
    <p>
     <img alt="" class="has" height="757" src="https://i-blog.csdnimg.cn/blog_migrate/c136dec097395e5b10a9e6aec283ad7f.png" width="549"/>
    </p>
    <h2>
     25.多人音视频架构
    </h2>
    <p>
     mesh方案
    </p>
    <p>
     MCU方案
    </p>
    <p>
     SFU方案
    </p>
    <h2>
     26.mesh通信模型
    </h2>
    <p>
     所有人之间两两建立P2P连接
    </p>
    <h2>
     27.MCU通信模型
    </h2>
    <p>
     multipoint conference unit
    </p>
    <p>
     服务器把所有人的视频合并为一路视频，音频合并成一路音频，并转发给所有人，注意。给一个人转发的混合后的音视频不包含这个人本身的音视频。
    </p>
    <p>
     优点是带宽小，缺点是不够灵活，因为每个终端收到的都是混合后的一路音视频，无法在客户端侧分别处理各路音视频。
    </p>
    <h2>
     28.SFU通信模型
    </h2>
    <p>
     selective forwarding unit
    </p>
    <p>
     中心服务器转发，将收到的音视频转发给所有其他人。
    </p>
    <p>
     这样每个终端都能收到分开的各路音视频，可以灵活的进行处理，但占用带宽大。
    </p>
    <h2>
     29.一些成熟的开源架构
    </h2>
    <p>
     mediasoup架构
    </p>
    <p>
     medooz架构
    </p>
    <p>
     janus架构
    </p>
    <p>
     licode架构
    </p>
    <h2>
     30.DTLS协议
    </h2>
    <p>
     <img alt="" class="has" height="219" src="https://i-blog.csdnimg.cn/blog_migrate/198dcf10c33237611679c4a184066dae.png" width="400"/>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f753031333533363233322f:61727469636c652f64657461696c732f313032383233303338" class_="artid" style="display:none">
 </p>
</div>


