---
layout: post
title: "微信小程序生命周期"
date: 2023-09-10 16:22:09 +0800
description: "在微信小程序中，可以通过生命周期函数来执行相应的代码操作。通过在不同的生命周期函数中编写相应的代码操"
keywords: "微信小程序——生命周期"
categories: ['小程序']
tags: ['微信小程序', '小程序']
artid: "132792543"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=132792543
    alt: "微信小程序生命周期"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=132792543
featuredImagePreview: https://bing.ee123.net/img/rand?artid=132792543
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     微信小程序——生命周期
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-tomorrow-night" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="_0">
     </a>
     微信小程序生命周期
    </h3>
    <p>
     微信小程序有以下几个生命周期函数：
    </p>
    <ol>
     <li>
      <p>
       <strong>
        onLaunch
       </strong>
       ：小程序初始化时触发，只会执行一次。可以在此函数中进行全局的初始化操作。
      </p>
     </li>
     <li>
      <p>
       <strong>
        onShow
       </strong>
       ：小程序启动或从后台进入前台显示时触发。可以在此函数中执行需要在小程序显示时进行的逻辑操作。
      </p>
     </li>
     <li>
      <p>
       <strong>
        onHide
       </strong>
       ：小程序从前台进入后台时触发。可以在此函数中执行需要在小程序隐藏时进行的逻辑操作。
      </p>
     </li>
     <li>
      <p>
       <strong>
        onUnload
       </strong>
       ：小程序被关闭时触发（例如通过手动关闭或者调用
       <code>
        wx.navigateBack
       </code>
       返回到了小程序启动页面）。可以在此函数中执行需要在小程序关闭时进行的清理操作。
      </p>
     </li>
     <li>
      <p>
       <strong>
        onError
       </strong>
       ：小程序出现错误时触发。通常用于捕获并处理小程序运行时的异常情况。
      </p>
     </li>
     <li>
      <p>
       页面相关的生命周期函数：每个小程序页面也有自己的生命周期函数，包括
       <code>
        onLoad
       </code>
       、
       <code>
        onShow
       </code>
       、
       <code>
        onReady
       </code>
       、
       <code>
        onHide
       </code>
       、
       <code>
        onUnload
       </code>
       等。这些生命周期函数与全局生命周期函数类似，但是针对页面级别的操作。
      </p>
     </li>
    </ol>
    <p>
     以上是微信小程序的主要生命周期函数。通过合理利用这些生命周期函数，开发者可以在不同的阶段执行相应的逻辑和操作，以实现更好的用户体验。
     <br/>
     在微信小程序中，可以通过生命周期函数来执行相应的代码操作。以下是一些常见的生命周期代码操作示例：
    </p>
    <ol>
     <li>
      在 onLoad 生命周期中进行数据初始化和网络请求：
     </li>
    </ol>
    <pre><code class="prism language-javascript"><span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 数据初始化</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'John'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">25</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 网络请求</span>
  wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'https://api.example.com/data'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <ol start="2">
     <li>
      在 onShow 生命周期中进行页面渲染和数据更新：
     </li>
    </ol>
    <pre><code class="prism language-javascript"><span class="token function-variable function">onShow</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 页面渲染</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'Welcome to my app!'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 数据更新</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <ol start="3">
     <li>
      在 onReady 生命周期中进行页面布局调整和动画效果：
     </li>
    </ol>
    <pre><code class="prism language-javascript"><span class="token function-variable function">onReady</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 页面布局调整</span>
  wx<span class="token punctuation">.</span><span class="token function">createSelectorQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'.box'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">boundingClientRect</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">rect</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rect<span class="token punctuation">.</span>width<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 动画效果</span>
  <span class="token keyword">var</span> animation <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">createAnimation</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
    <span class="token literal-property property">timingFunction</span><span class="token operator">:</span> <span class="token string">'ease'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  animation<span class="token punctuation">.</span><span class="token function">translateX</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">step</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">animationData</span><span class="token operator">:</span> animation<span class="token punctuation">.</span><span class="token function">export</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <ol start="4">
     <li>
      在 onHide 生命周期中进行数据保存和清理：
     </li>
    </ol>
    <pre><code class="prism language-javascript"><span class="token function-variable function">onHide</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 数据保存</span>
  wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 清理数据</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <ol start="5">
     <li>
      在 onUnload 生命周期中进行资源释放和数据保存：
     </li>
    </ol>
    <pre><code class="prism language-javascript"><span class="token function-variable function">onUnload</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 资源释放</span>
  wx<span class="token punctuation">.</span><span class="token function">stopBackgroundAudio</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 数据保存</span>
  wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">'count'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     通过在不同的生命周期函数中编写相应的代码操作，可以实现对小程序的控制和逻辑处理。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a:2f2f626c6f672e6373646e2e6e65742f5469616e587561622f:61727469636c652f64657461696c732f313332373932353433" class_="artid" style="display:none">
 </p>
</div>


