---
layout: post
title: "OpenHarmony-分布式硬件关键技术"
date: 2025-03-12 11:01:03 +0800
description: "此外，该架构还支持硬件类型的扩展和按需部署，对逻辑与物理资源进行解耦，可以实现本地和分布式硬件的无差别使用，未来还可以实现基于物理硬件能够定义出不同形态的新的硬件给应用使用，应用开发者只需要调用上层服务的API就可以使用，达到软件定义硬件的效果。分布式硬件平台对超级终端中的所有设备的硬件资源池化都是基于硬件虚拟化组件来进行构建的，每一个硬件在平台上注册对应的虚拟硬件实例，虚拟硬件通过虚拟化组件实现与对应的物理硬件之间的交互，从而实现了对周边设备对应硬件的控制和数据传输。分布式硬件平台提供了硬件自适应技术。"
keywords: "OpenHarmony-分布式硬件关键技术"
categories: ['Openharmony']
tags: ['分布式']
artid: "146199391"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146199391
    alt: "OpenHarmony-分布式硬件关键技术"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146199391
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146199391
cover: https://bing.ee123.net/img/rand?artid=146199391
image: https://bing.ee123.net/img/rand?artid=146199391
img: https://bing.ee123.net/img/rand?artid=146199391
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     OpenHarmony-分布式硬件关键技术
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     <strong>
      前言
     </strong>
     ：
    </p>
    <p>
     OpenHarmony是一款面向未来万物互联场景的操作系统，其设计采用了分布式架构。那么OpenHarmony相比于传统操作系统有哪些关键的分布式技术，本文主要介绍分布式硬件设计理念、跨端分布式硬件核心挑战、以及OpenHarmony分布式硬件平台关键技术。
    </p>
    <p>
    </p>
    <h2>
     <strong>
      一、分布式硬件设计理念
     </strong>
    </h2>
    <p>
     从智能终端的发展趋势来看，单一智能智能终端硬件已经越来越难以满足用户对全场景的要求，面临发展瓶颈：由于体积的限制，无法把所有场景所涉及的硬件全部加入到一个设备中，且单一设备也无法满足所有场景的需求。基于这个现实痛点，多智能终端“组合”而成的“超级终端”应运而生。超级终端可以根据用户期望，通过分布式技术将多个设备组合起来，使设备间的硬件资源共享，实现硬件的“自由”扩展，并可以在不同的业务场景下，按需组合硬件资源，提供更好的用户体验。例如，通过手机、平板、手表、大屏幕、电脑等智能终端的组合，可以实现多屏幕串联、多摄像头和麦克风交互以及专业传感器布置等功能。
    </p>
    <p>
    </p>
    <p>
     在这样的趋势下，传统操作系统很难满足开发者的要求。因为传统操作系统只能局限使用单个设备上的硬件，每一个硬件都是割裂运行的，应用也只能在单设备垂直领域发力，实现跨设备体验成本和复杂度极高。对开发者来说，更希望能够“跨端”共享硬件，打破硬件PCB边界，从而通过软件定义硬件，构建全场景多设备的“超级终端”。分布式硬件技术能够为开发者的上述需求提供助力，因其能够构建硬件资源池，提供按需定义超级终端硬件的能力，支持多路硬件的协同和调度，且能够使硬件能力自适应。
    </p>
    <p>
     分布式硬件能够带来什么样的新体验呢？例如，在办公场景下，用户可以让各智能终端设备便捷地链接起来，实现硬件能力共享，跨设备、跨系统应用的操作，无缝传输数据；在出行场景下，用户可以通过将手机和车机组合起来，让应用共享两者的硬件，实现导航、音乐和通话等功能的无缝操作，达到“智慧出行”。对开发者而言，通过程序控制一个远端的设备，仅需要选择其对应的ID即可，其他操作和使用本地设备的方式完全一致。
    </p>
    <p>
     <img alt="" height="641" src="https://i-blog.csdnimg.cn/direct/ce4f5b96ad7f404b852745eec8669718.png" width="1185"/>
    </p>
    <p>
     图1-1 分布式硬件
    </p>
    <h2>
     <strong>
      二、跨端分布式硬件的核心挑战
     </strong>
    </h2>
    <p>
     随着超级终端包含的设备越来越多，硬件的管理复杂度也随之攀升。每一个设备的硬件，不仅对本设备提供硬件能力，还要为超级终端中的其他设备赋能。因此，操作系统必须提供各设备的管理能力。例如，各硬件状态的更新和同步、硬件冲突的处理、多路并发情况的处理等。多设备间的管理技术，是目前跨端分布式硬件的核心挑战之一。
    </p>
    <p>
     <strong>
      在无线网络环境下，带宽有限，硬件调用的时延和效果难以保障
     </strong>
     。例如，本地相机的时延和拍摄效果是由硬件总线决定的，一般可以达到几十毫秒的时延和4K甚至更高的分辨率，且非常稳定。当通过应用远端操控相机时，除了硬件总线，还受到网络信号传输的影响，时延最低只能达到几百毫秒，分辨率也仅能达到1080P ，且波动很大。无线的不可靠网络，给硬件时延和效果带来了较大的不确定性。
     <img alt="" height="254" src="https://i-blog.csdnimg.cn/direct/09558b9b63bf41709dc8d932406190dd.png" width="706"/>
    </p>
    <p>
     图2-1 超级终端硬件调用
    </p>
    <p>
     <strong>
      在跨端多路硬件并发调用时，硬件协同同步的难度非常高
     </strong>
     。如上文所述，跨端硬件调度的时延本身就很难保障，当跨端同时调用多个硬件设备时，设备间的同步更难以保障。例如，当应用需要同时操作摄像头和麦克风时，在本地可以通过两者出厂时的调试工作确定其一致性；当跨端远程操作时，由于时延的不确定性，需要操作系统在多个设备间进行硬件协同，大大增加了软件的复杂度。
    </p>
    <p>
     <img alt="" height="430" src="https://i-blog.csdnimg.cn/direct/5afd4cce482a403ebff99017fb4d7323.png" width="716">
      图2-2 超级终端多路硬件并发调用
     </img>
    </p>
    <p>
     此外，
     <strong>
      异构智能终端间的硬件兼容性和容错的难度也非常大
     </strong>
     。设备的不同，导致其各自的系统资源、处理能力、支持的硬件数据处理类型、驱动I/O等都存在较大差异，需要进一步考虑硬件之间的兼容和容错。例如，手表的处理能力相对较弱，难以使用电视的4K屏幕、高声道立体声喇叭和超高清摄像头等。
    </p>
    <h2>
     <strong>
      三、分布式硬件平台关键技术
     </strong>
    </h2>
    <h3>
     <strong>
      3.1 分布式硬件池化架构
     </strong>
    </h3>
    <p>
     OpenHarmony在设计之初时就采用了分布式硬件池化架构。通过对各设备能力的抽象，构建全局硬件资源池抽象模型，对上提供一套统一的硬件抽象接口，实现统一管理、即插即用。此外，该架构还支持硬件类型的扩展和按需部署，对逻辑与物理资源进行解耦，可以实现本地和分布式硬件的无差别使用，未来还可以实现基于物理硬件能够定义出不同形态的新的硬件给应用使用，应用开发者只需要调用上层服务的API就可以使用，达到软件定义硬件的效果。
    </p>
    <p>
     <img alt="" height="501" src="https://i-blog.csdnimg.cn/direct/9e15f489f8984137a70f82b0ecd0193e.png" width="631">
      图3-1 分布式硬件池化架构
     </img>
    </p>
    <p>
     基于“硬件资源池化”的创新理念，OpenHarmony融合硬件虚拟化、硬件资源管理及硬件数据管理等能力，构建了硬件资源池化框架，对外提供了统一的硬件能力开放接口，让开发者轻松实现应用开发。如图3-2所示，硬件资源池化框架将各类设备的硬件资源进行抽象，为北向应用提供各种分布式服务，比如分布式相机、分布式屏幕、分布式音频和分布式输入等，同时提供统一的设备管理和分布式硬件框架对硬件资源进行管理。
    </p>
    <p>
     <img alt="" height="560" src="https://i-blog.csdnimg.cn/direct/7e449165693646539850eb4b016373f3.png" width="789">
     </img>
    </p>
    <p>
     图3-2 硬件资源池化框架
    </p>
    <p>
     <img alt="" height="380" src="https://i-blog.csdnimg.cn/direct/09dc72378d99433785a27b96e8ea12a5.png" width="661">
      OpenHarmony 分层结构
     </img>
    </p>
    <p>
     HDI（Hardware Device Interface，硬件设备接口）是 HDF 驱动框架为开发者提供的硬件规范化描述性接口。在 OpenHarmony 分层结构中，HDI 位于 “基础系统服务层”和“设备抽象层（DAL）”之间。硬件设备通过 DAL 抽象化，并基于 IDL（Interface Description Language）接口描述语言描述后，为上层应用或服务提供了规范的硬件设备接口。
    </p>
    <p>
     分布式硬件平台对超级终端中的所有设备的硬件资源池化都是基于硬件虚拟化组件来进行构建的，每一个硬件在平台上注册对应的虚拟硬件实例，虚拟硬件通过虚拟化组件实现与对应的物理硬件之间的交互，从而实现了对周边设备对应硬件的控制和数据传输。硬件资源池化基于驱动接口（HDI）完成硬件虚拟化，服务层各个业务子系统可以像使用本机硬件一样使用分布式硬件。
    </p>
    <p>
     硬件资源池化框架对应的就是OpenHarmony分布式硬件管理子系统，该子系统中各模块详细解析：
     <a href="http://10.3.6.93:8090/pages/viewpage.action?pageId=49545278" rel="nofollow" title="OpenHarmony-分布式硬件管理子系统简析">
      OpenHarmony-分布式硬件管理子系统简析
     </a>
    </p>
    <h3>
     <strong>
      3.2 统一的设备发现和认证框架
     </strong>
    </h3>
    <p>
     分布式硬件平台还提供了统一的设备发现和认证框架。支持设备间通过碰、扫、靠等方式进行设备认证。一旦设备通过发现和认证后，设备的硬件就会自动进入硬件资源池，可以共享给其他设备使用。
    </p>
    <p>
     <img alt="" height="487" src="https://i-blog.csdnimg.cn/direct/9d2eb015679e4a5d984b8b308468ea78.png" width="525">
      图3-3 设备发现和认证框架
     </img>
    </p>
    <h3>
     <strong>
      3.3 硬件自适应技术
     </strong>
    </h3>
    <p>
     分布式硬件平台提供了硬件自适应技术。能够自动进行硬件能力协商，能够通过网络带宽和时延等的感知，在硬件被调用动态调整硬件效果。此外，还提供了自适应转换技术，通过增强算法实现硬件效果的增强。
    </p>
    <p>
     <img alt="" height="304" src="https://i-blog.csdnimg.cn/direct/9cbaf7168d4b4bb39a52239113fbb4e4.png" width="620">
      图3-4 硬件自适应
     </img>
    </p>
    <h3>
     <strong>
      3.4 硬件协同同步技术
     </strong>
    </h3>
    <p>
     分布式硬件平台还提供了硬件协同同步技术。能够在多路中提供毫秒级的时钟同步能力，确保多路硬件设备的一致性。通过硬件时延动态感知技术，在多个设备中动态下发同步策略，保证多个硬件之间同步的体验。
    </p>
    <p>
     <img alt="" height="390" src="https://i-blog.csdnimg.cn/direct/0499d697810b4fdda1a2b85145412808.png" width="732"/>
     图3-5 硬件协同同步
    </p>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f67:2e6373646e2e6e65742f79616e675f7175616e5f79616e672f:61727469636c652f64657461696c732f313436313939333931" class_="artid" style="display:none">
 </p>
</div>


