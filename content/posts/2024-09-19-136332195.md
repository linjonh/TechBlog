---
layout: post
title: "linux常用命令-bwrap-命令-沙箱安全"
date: 2024-09-19 15:45:18 +0800
description: "bubblewrap是一个构建沙箱环境的工具。bubblewrap不是一个完整的、具有特定安全策略的"
keywords: "bwrap"
categories: ['未分类']
tags: ['网络', '安全', 'Linux']
artid: "136332195"
image:
  path: https://api.vvhan.com/api/bing?rand=sj&artid=136332195
  alt: "linux常用命令-bwrap-命令-沙箱安全"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=136332195
featuredImagePreview: https://bing.ee123.net/img/rand?artid=136332195
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     linux常用命令 bwrap 命令 沙箱安全
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="_0">
     </a>
     系列文章目录
    </h3>
    <hr/>
    <h5>
     <a id="_4">
     </a>
     文章目录
    </h5>
    <ul>
     <li>
      系列文章目录
     </li>
     <li>
      前言
     </li>
     <li>
      一、bubblewrap 是什么？
     </li>
     <li>
      二、使用步骤
     </li>
     <li>
      <pre><code>* 2.1 安装
</code></pre>
      <ul>
       <li>
        2.2 bwrap 使用
       </li>
      </ul>
     </li>
     <li>
      总结
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="_16">
     </a>
     前言
    </h3>
    <p>
     <a href="https://github.com/containers/bubblewrap">
      bubblewrap
     </a>
     是一个构建沙箱环境的工具。bubblewrap
     <br/>
     不是一个完整的、具有特定安全策略的现成沙箱。
    </p>
    <hr/>
    <h3>
     <a id="bubblewrap__23">
     </a>
     一、bubblewrap 是什么？
    </h3>
    <p>
     bubblewrap
     <br/>
     的一些用例需要沙箱和真实系统之间的安全边界；其他用例希望能够更改沙箱内进程的文件系统布局，但不旨在成为安全边界。因此，沙盒进程和主机系统之间的保护级别完全由传递给
     <br/>
     bubblewrap 的参数决定。
    </p>
    <p>
     无论哪个程序为 bubblewrap 构造命令行参数（通常是较大的框架，如 Flatpak、libgnome-desktop、sandwine
     <br/>
     或临时脚本），都负责定义自己的安全模型，并选择适当的 bubblewrap 命令行参数来实现该模型安全模型。
    </p>
    <p>
     bubblewrap 的目标是在沙箱中运行应用程序，在沙箱中它限制对部分操作系统或用户数据（例如主目录）的访问。
    </p>
    <p>
     bubblewrap
     <br/>
     始终创建一个新的挂载命名空间，并且用户可以准确指定文件系统的哪些部分应在沙箱中可见。默认情况下，您指定的任何此类目录都会安装nodev，并且可以设置为只读。
    </p>
    <p>
     和 bwrap 类似的工具还有 SELinux 和 AppArmor。它们是作用于整个系统的，Firejail
     <br/>
     是面向应用程序的，但是配置起来也挺不容易。bwrap 更偏重于提供底层功能而不是完整的解决方案，具体用法可以让用户自由发挥。
    </p>
    <p>
     此外，您还可以使用这些内核功能：
    </p>
    <ul>
     <li>
      <p>
       <strong>
        用户命名空间 ( CLONE_NEWUSER )
       </strong>
       ：这会隐藏沙箱中除当前 uid 和 gid 之外的所有内容。您还可以更改沙箱中 uid/gid 的值。
      </p>
     </li>
     <li>
      <p>
       <strong>
        IPC 命名空间 ( CLONE_NEWIPC )
       </strong>
       ：沙箱将获得所有不同形式的 IPC 的自己的副本，例如 SysV 共享内存和信号量。
      </p>
     </li>
     <li>
      <p>
       <strong>
        PID 命名空间 ( CLONE_NEWPID )
       </strong>
       ：沙箱不会看到沙箱之外的任何进程。此外，bubblewrap 将在容器内运行一个简单的 pid1 来处理在沙箱中收获子项的要求。这避免了现在所谓的Docker pid 1 问题。
      </p>
     </li>
     <li>
      <p>
       <strong>
        网络命名空间 ( CLONE_NEWNET )
       </strong>
       ：沙箱将看不到网络。相反，它将拥有自己的网络命名空间，并且只有一个环回设备。
      </p>
     </li>
     <li>
      <p>
       <strong>
        UTS 命名空间 ( CLONE_NEWUTS )
       </strong>
       ：沙箱将有自己的主机名。
      </p>
     </li>
     <li>
      <p>
       <strong>
        Seccomp 过滤器
       </strong>
       ：您可以传入 seccomp 过滤器来限制可以在沙箱中执行哪些系统调用。有关详细信息，请参阅Seccomp。
      </p>
     </li>
    </ul>
    <p>
     如果您不使用 seccomp 过滤器过滤掉命令
     <code>
      TIOCSTI
     </code>
     ，–new-session
     <br/>
     则需要参数来防止沙箱外命令执行（请参阅CVE-2017-5226）。
    </p>
    <h3>
     <a id="_57">
     </a>
     二、使用步骤
    </h3>
    <h4>
     <a id="21__59">
     </a>
     2.1 安装
    </h4>
    <p>
     bubblewrap 在大多数 Linux 发行版的软件包存储库中都可用，并且可以从那里安装。
    </p>
    <p>
     如果您需要从源代码构建 bubblewrap，您可以使用 meson 或 autogen 来完成此操作。
    </p>
    <p>
     meson:
    </p>
    <pre><code>meson _builddir
meson compile -C _builddir
meson test -C _builddir
meson install -C _builddir
</code></pre>
    <p>
     autogen：
    </p>
    <pre><code>./autogen.sh
make
sudo make install
</code></pre>
    <h4>
     <a id="22_bwrap__84">
     </a>
     2.2 bwrap 使用
    </h4>
    <p>
     bubblewrap 的工作原理是创建一个新的、完全空的挂载命名空间，其中根位于主机上不可见的 tmpfs
     <br/>
     上，并且当最后一个进程退出时将自动清理。然后，您可以使用命令行选项构建根文件系统和进程环境以及在命名空间中运行的命令。
    </p>
    <p>
     源代码中有一个更大的[演示脚本](https://github.com/containers/bubblewrap/blob/main/demos/bubblewrap-
     <br/>
     shell.sh)，但这里有一个精简版本，它运行一个重用主机的
     <code>
      /usr
     </code>
     。
    </p>
    <pre><code>bwrap \
    --ro-bind /usr /usr \
    --symlink usr/lib64 /lib64 \
    --proc /proc \
    --dev /dev \
    --unshare-pid \
    --new-session \
    bash
</code></pre>
    <p>
     这是一个不完整的示例，但对于说明目的很有用。更常见的是，您不想使用主机的文件系统树创建容器，而是希望以 chroot 为目标。在那里，您可能已经在目标
     <br/>
     rootfs 中创建了符号链接，而不是lib64 -&gt; usr/lib64在 tmpfs 中创建符号链接。
    </p>
    <hr/>
    <h3>
     <a id="_109">
     </a>
     总结
    </h3>
    <p>
     本文介绍了 bwrap 命令的基本概念和使用场景。
    </p>
    <p>
     <strong>
      学习网络安全技术的方法无非三种:
     </strong>
    </p>
    <p>
     第一种是报网络安全专业，现在叫网络空间安全专业，主要专业课程:程序设计、计算机组成原理原理、数据结构、操作系统原理、数据库系统、 计算机网络、人工智能、自然语言处理、社会计算、网络安全法律法规、网络安全、内容安全、数字取证、机器学习，多媒体技术，信息检索、舆情分析等。
    </p>
    <p>
     第二种是自学，就是在网上找资源、找教程，或者是想办法认识一-些大佬，抱紧大腿，不过这种方法很耗时间，而且学习没有规划，可能很长一段时间感觉自己没有进步，容易劝退。
    </p>
    <p>
     如果你对网络安全入门感兴趣，那么你需要的话可以点击这里
     <strong>
      👉
     </strong>
     <a href="https://mp.weixin.qq.com/s/BWb9OzaB-gVGVpkm161PMw" rel="nofollow">
      网络安全重磅福利：入门&amp;进阶全套282G学习资源包免费分享！
     </a>
    </p>
    <p>
     第三种就是去找培训。
    </p>
    <p>
     <img alt="image.png" src="https://i-blog.csdnimg.cn/blog_migrate/06cea7634bfa64bfaa2b94427dd41e1f.png"/>
    </p>
    <p>
     接下来，我会教你零基础入门快速入门上手网络安全。
    </p>
    <p>
     网络安全入门到底是先学编程还是先学计算机基础？这是一个争议比较大的问题，有的人会建议先学编程，而有的人会建议先学计算机基础，其实这都是要学的。而且这些对学习网络安全来说非常重要。但是对于完全零基础的人来说又或者急于转行的人来说，学习编程或者计算机基础对他们来说都有一定的难度，并且花费时间太长。
    </p>
    <h4>
     <a id="_46_129">
     </a>
     第一阶段：基础准备 4周~6周
    </h4>
    <p>
     这个阶段是所有准备进入安全行业必学的部分，俗话说：基础不劳，地动山摇
     <br/>
     <img alt="image.png" src="https://i-blog.csdnimg.cn/blog_migrate/78bd273d08da4e5ca5a3d0b68c6b16ce.png"/>
    </p>
    <h4>
     <a id="web_134">
     </a>
     第二阶段：web渗透
    </h4>
    <p>
     <strong>
      学习基础 时间：1周 ~ 2周：
     </strong>
    </p>
    <p>
     ① 了解基本概念：（SQL注入、XSS、上传、CSRF、一句话木马、等）为之后的WEB渗透测试打下基础。
     <br/>
     ② 查看一些论坛的一些Web渗透，学一学案例的思路，每一个站点都不一样，所以思路是主要的。
     <br/>
     ③ 学会提问的艺术，如果遇到不懂得要善于提问。
     <br/>
     <img alt="image.png" src="https://i-blog.csdnimg.cn/blog_migrate/1c71c12f7cfe0375bc22de5040851faa.png"/>
    </p>
    <p>
     <strong>
      配置渗透环境 时间：3周 ~ 4周：
     </strong>
    </p>
    <p>
     ① 了解渗透测试常用的工具，例如（AWVS、SQLMAP、NMAP、BURP、中国菜刀等）。
     <br/>
     ② 下载这些工具无后门版本并且安装到计算机上。
     <br/>
     ③ 了解这些工具的使用场景，懂得基本的使用，推荐在Google上查找。
    </p>
    <h4>
     <a id="_6_149">
     </a>
     <strong>
      渗透实战操作 时间：约6周：
     </strong>
    </h4>
    <p>
     ① 在网上搜索渗透实战案例，深入了解SQL注入、文件上传、解析漏洞等在实战中的使用。
     <br/>
     ② 自己搭建漏洞环境测试，推荐DWVA，SQLi-labs，Upload-labs，bWAPP。
     <br/>
     ③ 懂得渗透测试的阶段，每一个阶段需要做那些动作：例如PTES渗透测试执行标准。
     <br/>
     ④ 深入研究手工SQL注入，寻找绕过waf的方法，制作自己的脚本。
     <br/>
     ⑤ 研究文件上传的原理，如何进行截断、双重后缀欺骗(IIS、PHP)、解析漏洞利用（IIS、Nignix、Apache）等，参照：上传攻击框架。
     <br/>
     ⑥ 了解XSS形成原理和种类，在DWVA中进行实践，使用一个含有XSS漏洞的cms，安装安全狗等进行测试。
     <br/>
     ⑦ 了解一句话木马，并尝试编写过狗一句话。
     <br/>
     ⑧ 研究在Windows和Linux下的提升权限，Google关键词：提权
     <br/>
     <img alt="image.png" src="https://i-blog.csdnimg.cn/blog_migrate/6bf8257490036dc5c0fef660814f837e.png">
      <br/>
      以上就是入门阶段
     </img>
    </p>
    <h4>
     <a id="_162">
     </a>
     第三阶段：进阶
    </h4>
    <p>
     已经入门并且找到工作之后又该怎么进阶？详情看下图
     <br/>
     <img alt="image.png" src="https://i-blog.csdnimg.cn/blog_migrate/7217c4638095571547b5ad2edb2a8152.png"/>
    </p>
    <p>
     给新手小白的入门建议：
     <br/>
     新手入门学习最好还是从视频入手进行学习，视频的浅显易懂相比起晦涩的文字而言更容易吸收，这里我给大家准备了一套网络安全从入门到精通的视频学习资料包免费领取哦！
    </p>
    <p>
     如果你对网络安全入门感兴趣，那么你需要的话可以点击这里
     <strong>
      👉
     </strong>
     <a href="https://mp.weixin.qq.com/s/BWb9OzaB-gVGVpkm161PMw" rel="nofollow">
      网络安全重磅福利：入门&amp;进阶全套282G学习资源包免费分享！
     </a>
    </p>
    <img src="https://i-blog.csdnimg.cn/blog_migrate/8ade4c149f6cf6b783d63a6227c51a12.jpeg">
     <p>
      <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/335288b39c16ed03ca42b51869ab97f8.png"/>
     </p>
    </img>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f496e6e6f63656e63655f302f:61727469636c652f64657461696c732f313336333332313935" class_="artid" style="display:none">
 </p>
</div>
