---
layout: post
title: "Python实战进阶No23-使用-Selenium-自动化浏览器操作"
date: 2025-03-14 22:38:56 +0800
description: "Selenium 是自动化浏览器操作的“瑞士军刀”，可模拟人类行为操作网页，适用于爬虫、测试、重复任务自动化等场景。本集通过**代码驱动实战**，从安装配置到复杂交互，带你掌握 Selenium 的核心技能，并结合电商网站登录、商品下单等真实场景，解决动态加载、反爬等实际问题。"
keywords: "《Python实战进阶》No23: 使用 Selenium 自动化浏览器操作"
categories: ['Python']
tags: ['自动化', 'Selenium', 'Python']
artid: "146268665"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146268665
    alt: "Python实战进阶No23-使用-Selenium-自动化浏览器操作"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146268665
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146268665
cover: https://bing.ee123.net/img/rand?artid=146268665
image: https://bing.ee123.net/img/rand?artid=146268665
img: https://bing.ee123.net/img/rand?artid=146268665
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     《Python实战进阶》No23: 使用 Selenium 自动化浏览器操作
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h4>
     <a id="No23__Selenium__0">
     </a>
     <strong>
      No23: 使用 Selenium 自动化浏览器操作
     </strong>
    </h4>
    <hr/>
    <h5>
     <a id="_5">
     </a>
     <strong>
      摘要
     </strong>
    </h5>
    <p>
     Selenium 是自动化浏览器操作的“瑞士军刀”，可模拟人类行为操作网页，适用于爬虫、测试、重复任务自动化等场景。本集通过
     <strong>
      代码驱动实战
     </strong>
     ，从安装配置到复杂交互，带你掌握 Selenium 的核心技能，并结合电商网站登录、商品下单等真实场景，解决动态加载、反爬等实际问题。
    </p>
    <hr/>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/bad46247686148ee81dfc9ae3596f3dc.jpeg#pic_center"/>
    </p>
    <h4>
     <a id="_11">
     </a>
     <strong>
      核心概念与代码实战
     </strong>
    </h4>
    <h5>
     <a id="1__WebDriver__13">
     </a>
     1.
     <strong>
      环境配置与 WebDriver 基础
     </strong>
    </h5>
    <p>
     <strong>
      安装命令
     </strong>
     ：
    </p>
    <pre><code class="prism language-bash">pip <span class="token function">install</span> selenium webdriver-manager  
</code></pre>
    <p>
     <strong>
      初始化浏览器
     </strong>
     （自动管理驱动）：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver  
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>chrome<span class="token punctuation">.</span>service <span class="token keyword">import</span> Service  
<span class="token keyword">from</span> webdriver_manager<span class="token punctuation">.</span>chrome <span class="token keyword">import</span> ChromeDriverManager  

<span class="token comment"># 自动下载并配置 Chrome 驱动  </span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>service<span class="token operator">=</span>Service<span class="token punctuation">(</span>ChromeDriverManager<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>install<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
</code></pre>
    <p>
     <strong>
      效果验证
     </strong>
     ：
    </p>
    <pre><code class="prism language-python">driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://www.python.org"</span><span class="token punctuation">)</span>  
<span class="token keyword">print</span><span class="token punctuation">(</span>driver<span class="token punctuation">.</span>title<span class="token punctuation">)</span>  <span class="token comment"># 输出: "Welcome to Python.org"  </span>
</code></pre>
    <hr/>
    <h5>
     <a id="2__36">
     </a>
     2.
     <strong>
      元素定位与交互
     </strong>
    </h5>
    <p>
     <strong>
      常见定位方式
     </strong>
     ：
    </p>
    <pre><code class="prism language-python"><span class="token comment"># 通过 ID 定位搜索框并输入关键词  </span>
search_box <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">"id-search-field"</span><span class="token punctuation">)</span>  
search_box<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"selenium"</span><span class="token punctuation">)</span>  

<span class="token comment"># 通过 XPATH 点击搜索按钮  </span>
driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>XPATH<span class="token punctuation">,</span> <span class="token string">"//button[@type='submit']"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>  
</code></pre>
    <p>
     <strong>
      动态交互示例
     </strong>
     （鼠标悬停与下拉菜单选择）：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>action_chains <span class="token keyword">import</span> ActionChains  

<span class="token comment"># 模拟鼠标悬停  </span>
menu <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span> <span class="token string">".menu-item"</span><span class="token punctuation">)</span>  
ActionChains<span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">.</span>move_to_element<span class="token punctuation">(</span>menu<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span>  

<span class="token comment"># 选择下拉菜单项  </span>
driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>LINK_TEXT<span class="token punctuation">,</span> <span class="token string">"Documentation"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>  
</code></pre>
    <hr/>
    <h5>
     <a id="3__61">
     </a>
     3.
     <strong>
      动态内容与显式等待
     </strong>
    </h5>
    <p>
     <strong>
      问题场景
     </strong>
     ：页面数据通过 AJAX 动态加载，直接定位会报错。
     <br/>
     <strong>
      解决方案
     </strong>
     ：显式等待（Explicit Wait）：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support<span class="token punctuation">.</span>ui <span class="token keyword">import</span> WebDriverWait  
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support <span class="token keyword">import</span> expected_conditions <span class="token keyword">as</span> EC  

<span class="token comment"># 等待搜索结果加载完成  </span>
results <span class="token operator">=</span> WebDriverWait<span class="token punctuation">(</span>driver<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>until<span class="token punctuation">(</span>  
    EC<span class="token punctuation">.</span>presence_of_all_elements_located<span class="token punctuation">(</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span> <span class="token string">".list-recent-events li"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
<span class="token punctuation">)</span>  
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"共找到 </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token builtin">len</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> 条结果"</span></span><span class="token punctuation">)</span>  
</code></pre>
    <p>
     <strong>
      输出示例
     </strong>
     ：
    </p>
    <pre><code>共找到 5 条结果  
</code></pre>
    <hr/>
    <h5>
     <a id="4__81">
     </a>
     4.
     <strong>
      反爬策略与绕过技巧
     </strong>
    </h5>
    <p>
     <strong>
      常见反爬手段与应对
     </strong>
     ：
    </p>
    <pre><code class="prism language-python"><span class="token comment"># 修改 User-Agent  </span>
options <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>ChromeOptions<span class="token punctuation">(</span><span class="token punctuation">)</span>  
options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"user-agent=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36"</span><span class="token punctuation">)</span>  

<span class="token comment"># 使用代理 IP  </span>
options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"--proxy-server=http://123.45.67.89:8080"</span><span class="token punctuation">)</span>  

<span class="token comment"># 绕过 WebDriver 检测（部分网站会识别自动化脚本）  </span>
options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"--disable-blink-features=AutomationControlled"</span><span class="token punctuation">)</span>  
</code></pre>
    <p>
     <strong>
      验证码处理建议
     </strong>
     ：
    </p>
    <ul>
     <li>
      集成第三方 API（如 2Captcha）自动识别
     </li>
     <li>
      使用 Pytesseract 进行简单图像验证码识别
     </li>
    </ul>
    <hr/>
    <h4>
     <a id="_100">
     </a>
     <strong>
      实战案例：电商自动化全流程
     </strong>
    </h4>
    <h5>
     <a id="_1_102">
     </a>
     案例 1：
     <strong>
      自动化登录与数据抓取
     </strong>
    </h5>
    <p>
     <strong>
      场景
     </strong>
     ：登录某电商后台，提取订单数据。
    </p>
    <pre><code class="prism language-python">driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://fake-ecommerce.com/login"</span><span class="token punctuation">)</span>  

<span class="token comment"># 输入账号密码  </span>
driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"user123"</span><span class="token punctuation">)</span>  
driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"pass123"</span><span class="token punctuation">)</span>  
driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span> <span class="token string">"button.login-btn"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>  

<span class="token comment"># 抓取订单列表  </span>
orders <span class="token operator">=</span> WebDriverWait<span class="token punctuation">(</span>driver<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>until<span class="token punctuation">(</span>  
    EC<span class="token punctuation">.</span>presence_of_all_elements_located<span class="token punctuation">(</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span>CLASS_NAME<span class="token punctuation">,</span> <span class="token string">"order-item"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
<span class="token punctuation">)</span>  
<span class="token keyword">for</span> order <span class="token keyword">in</span> orders<span class="token punctuation">:</span>  
    <span class="token keyword">print</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span>text<span class="token punctuation">)</span>  
</code></pre>
    <p>
     <strong>
      输出示例
     </strong>
     ：
    </p>
    <pre><code>订单号: 20230901-001 | 状态: 已发货  
订单号: 20230902-002 | 状态: 处理中  
</code></pre>
    <h5>
     <a id="_2_125">
     </a>
     案例 2：
     <strong>
      商品搜索与下单
     </strong>
    </h5>
    <pre><code class="prism language-python"><span class="token comment"># 搜索商品  </span>
search_box <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>NAME<span class="token punctuation">,</span> <span class="token string">"q"</span><span class="token punctuation">)</span>  
search_box<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"无线耳机"</span><span class="token punctuation">)</span>  
search_box<span class="token punctuation">.</span>submit<span class="token punctuation">(</span><span class="token punctuation">)</span>  

<span class="token comment"># 选择第一个商品并加入购物车  </span>
driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span> <span class="token string">".product-item:first-child .buy-btn"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>  
driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">"checkout-btn"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>  

<span class="token comment"># 提交订单（需提前登录）  </span>
driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">"place-order"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>  
</code></pre>
    <h5>
     <a id="_3_142">
     </a>
     案例 3：
     <strong>
      网页性能测试
     </strong>
    </h5>
    <pre><code class="prism language-python"><span class="token keyword">import</span> time  

start_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>  
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://example.com"</span><span class="token punctuation">)</span>  
load_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start_time  
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"页面加载耗时：</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>load_time<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string"> 秒"</span></span><span class="token punctuation">)</span>  

<span class="token comment"># 统计资源请求时间（需启用性能日志）  </span>
logs <span class="token operator">=</span> driver<span class="token punctuation">.</span>get_log<span class="token punctuation">(</span><span class="token string">"performance"</span><span class="token punctuation">)</span>  
<span class="token keyword">for</span> log <span class="token keyword">in</span> logs<span class="token punctuation">:</span>  
    <span class="token keyword">if</span> <span class="token string">"Network.responseReceived"</span> <span class="token keyword">in</span> log<span class="token punctuation">[</span><span class="token string">"message"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>  
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"资源加载时间：</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>log<span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  
</code></pre>
    <p>
     <strong>
      输出示例
     </strong>
     ：
    </p>
    <pre><code>页面加载耗时：2.35 秒  
资源加载时间：1693720000.123  
</code></pre>
    <hr/>
    <h4>
     <a id="_165">
     </a>
     <strong>
      扩展思考
     </strong>
    </h4>
    <h5>
     <a id="1_Headless__167">
     </a>
     1.
     <strong>
      Headless 模式提升效率
     </strong>
    </h5>
    <pre><code class="prism language-python">options <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>ChromeOptions<span class="token punctuation">(</span><span class="token punctuation">)</span>  
options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"--headless"</span><span class="token punctuation">)</span>  <span class="token comment"># 无头模式  </span>
options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"--disable-gpu"</span><span class="token punctuation">)</span>  
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>options<span class="token operator">=</span>options<span class="token punctuation">)</span>  

<span class="token comment"># 在后台静默执行任务  </span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://example.com"</span><span class="token punctuation">)</span>  
<span class="token keyword">print</span><span class="token punctuation">(</span>driver<span class="token punctuation">.</span>title<span class="token punctuation">)</span>  
</code></pre>
    <p>
     <strong>
      优势
     </strong>
     ：节省内存、适合服务器环境
    </p>
    <h5>
     <a id="2_Selenium__180">
     </a>
     2.
     <strong>
      Selenium 的局限性
     </strong>
    </h5>
    <ul>
     <li>
      <strong>
       性能开销大
      </strong>
      ：每个实例占用 1GB+ 内存
     </li>
     <li>
      <strong>
       无法操作非浏览器 GUI
      </strong>
      ：如桌面应用需结合 PyAutoGUI（下集详解）
     </li>
    </ul>
    <p>
     <strong>
      替代方案推荐
     </strong>
     ：
    </p>
    <ul>
     <li>
      <strong>
       Playwright
      </strong>
      ：微软开源，支持移动端模拟和更快的执行速度
     </li>
     <li>
      <strong>
       Requests + lxml
      </strong>
      ：轻量级静态页面爬取
     </li>
    </ul>
    <hr/>
    <h4>
     <a id="_190">
     </a>
     <strong>
      总结
     </strong>
    </h4>
    <p>
     通过本集实战，你已掌握：
    </p>
    <ol>
     <li>
      Selenium 动态页面操作的核心技能
     </li>
     <li>
      反爬策略的攻防实战
     </li>
     <li>
      电商自动化全流程（登录→搜索→下单→性能测试）
     </li>
     <li>
      性能优化与替代方案选择
     </li>
    </ol>
    <p>
     <strong>
      下集预告
     </strong>
     ：
     <br/>
     《No24: PyAutoGUI 实现桌面自动化》将带你突破浏览器限制，自动化操作文件管理器、Excel 等桌面应用，实现全栈自动化！
    </p>
    <hr/>
    <p>
     <strong>
      附：运行环境
     </strong>
    </p>
    <ul>
     <li>
      环境要求：Python 3.8+、Chrome 114+
     </li>
    </ul>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="6874747073:3a2f2f626c6f672e6373646e2e6e65742f7977656e6731382f:61727469636c652f64657461696c732f313436323638363635" class_="artid" style="display:none">
 </p>
</div>


