---
layout: post
title: "WPF给ListBox中的每一项添加右键菜单功能"
date: 2025-03-07 09:34:08 +0800
description: "可以使用ContextMenu 在控件上实现右键点击显示菜单。可以给菜单添加多个菜单项（MenuItem)，每个菜单项可以绑定事件或命令。ContextMenu 默认不继承父控件的，但可以使用逐级向上绑定到。"
keywords: "WPF给ListBox中的每一项添加右键菜单功能"
categories: ['Wpf', 'C']
tags: ['Wpf', 'C']
artid: "146075980"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146075980
    alt: "WPF给ListBox中的每一项添加右键菜单功能"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146075980
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146075980
cover: https://bing.ee123.net/img/rand?artid=146075980
image: https://bing.ee123.net/img/rand?artid=146075980
img: https://bing.ee123.net/img/rand?artid=146075980
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     WPF给ListBox中的每一项添加右键菜单功能
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="_0">
     </a>
     前言
    </h2>
    <h3>
     <a id="ContextMenu_1">
     </a>
     一、ContextMenu控件
    </h3>
    <blockquote>
     <p>
      <strong>
       ContextMenu 是实现在控件上右键点击时显示一个上下文菜单。
      </strong>
      <br/>
      <strong>
       ContextMenu菜单可以添加多个菜单项（MenuItem)，每个菜单项可以绑定指定事件或命令。
      </strong>
     </p>
    </blockquote>
    <h3>
     <a id="ContextMenu__DataContext__5">
     </a>
     二、ContextMenu 的 DataContext 绑定问题
    </h3>
    <blockquote>
     <p>
      案例:
     </p>
     <blockquote>
      <p>
       1、在
       <strong>
        ListBox
       </strong>
       控件中创建DataTemplate，绑定数据源为
       <strong>
        DataCollection
       </strong>
       。
       <br/>
       2、在
       <strong>
        ListBox
       </strong>
       创建了
       <strong>
        TextBlock
       </strong>
       控件，
       <br/>
       3、在
       <strong>
        TextBlock
       </strong>
       里面添加
       <strong>
        ContextMenu
       </strong>
       右键菜单。
      </p>
     </blockquote>
    </blockquote>
    <h6>
     <a id="ContextMenu__DataContext_DataContext_PlacementTarget____DataContext_11">
     </a>
     ContextMenu 默认不继承父控件的
     <em>
      DataContext
     </em>
     ，如果需要显式地绑定
     <em>
      DataContext
     </em>
     ，可以使用
     <em>
      PlacementTarget
     </em>
     逐级向上绑定到
     <em>
      DataContext
     </em>
     。
    </h6>
    <pre><code class="prism language-csharp">DataContext<span class="token operator">=</span><span class="token string">"{Binding PlacementTarget.DataContext, RelativeSource={RelativeSource Self}}"</span>
</code></pre>
    <h6>
     <a id="_MenuDownItemCommand_DataListViewModel__17">
     </a>
     但是，在此案例中如果将 【
     <em>
      MenuDownItemCommand
     </em>
     】命令创建在 【
     <em>
      DataListViewModel
     </em>
     】中，然后对菜单项进行命令绑定，是无法生效的。
    </h6>
    <pre><code class="prism language-csharp"><span class="token operator">&lt;</span><span class="token class-name">MenuItem</span> Name<span class="token operator">=</span><span class="token string">"Delete"</span> Header<span class="token operator">=</span><span class="token string">"删除"</span> Command<span class="token operator">=</span><span class="token string">"{Binding MenuDownItemCommand}"</span> CommandParameter<span class="token operator">=</span><span class="token string">"Delete"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre>
    <h6>
     <a id="ListBoxDataCollectionDataCollectionDataModel_DataModelMenuDownItemCommandMenuDownItemCommand_DataModel_21">
     </a>
     因为ListBox绑定的是DataCollection，DataCollection集合中的对象是DataModel ，而DataModel中又没有创建
     <em>
      MenuDownItemCommand
     </em>
     命令。所以正确的做法是将MenuDownItemCommand 创建在DataModel这个类中。
    </h6>
    <pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataModel</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">PropertyChangedBase</span></span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Content <span class="token punctuation">{<!-- --></span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Date <span class="token punctuation">{<!-- --></span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">ICommand</span> MenuDownItemCommand <span class="token punctuation">{<!-- --></span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <blockquote>
     <p>
      <strong>
       下面是一个在WPF中使用ContextMenu右键菜单的例子：
      </strong>
     </p>
     <blockquote>
      <p>
       该案例使用DataContext数据上下文实现前后端绑定。
       <br/>
       1、创建一个属性变更基类 PropertyChangedBase，实现属性变革事件
       <br/>
       2、创建数据集合视图模型类，处理视图视图和模型之间的数据交互
       <br/>
       3、创建DataModel类，作为数据模型，保存到集合中。
       <br/>
       4、创建命令，实现命令绑定，触发相关操作。
      </p>
     </blockquote>
    </blockquote>
    <h3>
     <a id="_38">
     </a>
     三、效果预览
    </h3>
    <h4>
     <a id="1_40">
     </a>
     1、界面效果
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/179440844f6e44c6b93726bed6832c37.png"/>
    </p>
    <h4>
     <a id="2_42">
     </a>
     2、左键
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/a33c817194c6417ca2ed9795c7174062.png"/>
    </p>
    <h4>
     <a id="3_44">
     </a>
     3、右键
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/b6a1afe06ca448a59326a95af10a402f.png"/>
    </p>
    <h3>
     <a id="_46">
     </a>
     四、前端页面代码
    </h3>
    <pre><code class="prism language-csharp"><span class="token operator">&lt;</span><span class="token class-name">UserControl</span> x<span class="token punctuation">:</span>Class<span class="token operator">=</span><span class="token string">"CS学习之WPF右键菜单.DataListView"</span>
             xmlns<span class="token operator">=</span><span class="token string">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>
             xmlns<span class="token punctuation">:</span>x<span class="token operator">=</span><span class="token string">"http://schemas.microsoft.com/winfx/2006/xaml"</span>
             xmlns<span class="token punctuation">:</span>mc<span class="token operator">=</span><span class="token string">"http://schemas.openxmlformats.org/markup-compatibility/2006"</span> 
             xmlns<span class="token punctuation">:</span>d<span class="token operator">=</span><span class="token string">"http://schemas.microsoft.com/expression/blend/2008"</span> 
             xmlns<span class="token punctuation">:</span>local<span class="token operator">=</span><span class="token string">"clr-namespace:CS学习之WPF右键菜单"</span>
             xmlns<span class="token punctuation">:</span>behavior<span class="token operator">=</span><span class="token string">"http://schemas.microsoft.com/xaml/behaviors"</span>
             mc<span class="token punctuation">:</span>Ignorable<span class="token operator">=</span><span class="token string">"d"</span> 
             d<span class="token punctuation">:</span>DesignHeight<span class="token operator">=</span><span class="token string">"450"</span> d<span class="token punctuation">:</span>DesignWidth<span class="token operator">=</span><span class="token string">"800"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>UserControl<span class="token punctuation">.</span>DataContext<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>local<span class="token punctuation">:</span><span class="token class-name">DataListViewModel</span> x<span class="token punctuation">:</span>Name<span class="token operator">=</span><span class="token string">"ViewModel"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>UserControl<span class="token punctuation">.</span>DataContext<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token class-name">Grid</span> Background<span class="token operator">=</span><span class="token string">"#FFFFFF"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token class-name">ScrollViewer</span> Background<span class="token operator">=</span><span class="token string">"#AEAEAE"</span> x<span class="token punctuation">:</span>Name<span class="token operator">=</span><span class="token string">"RecordScrollViewer"</span> HorizontalScrollBarVisibility<span class="token operator">=</span><span class="token string">"Visible"</span>
              VerticalScrollBarVisibility<span class="token operator">=</span><span class="token string">"Visible"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token class-name">ListBox</span> Margin<span class="token operator">=</span><span class="token string">"5"</span> ItemsSource<span class="token operator">=</span><span class="token string">"{Binding DataCollection}"</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>ListBox<span class="token punctuation">.</span>ItemTemplate<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>DataTemplate<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span><span class="token class-name">StackPanel</span> Orientation<span class="token operator">=</span><span class="token string">"Vertical"</span> Margin<span class="token operator">=</span><span class="token string">"10,5,0,0"</span><span class="token operator">&gt;</span>
                            <span class="token operator">&lt;</span><span class="token class-name">TextBlock</span> Name<span class="token operator">=</span><span class="token string">"TitleDate"</span> FontSize<span class="token operator">=</span><span class="token string">"14"</span>  Margin<span class="token operator">=</span><span class="token string">"10,5,0,0"</span> Foreground<span class="token operator">=</span><span class="token string">"#BBBBBB"</span> Text<span class="token operator">=</span><span class="token string">"{Binding Date}"</span> <span class="token operator">&gt;</span>
                               
                            <span class="token operator">&lt;</span><span class="token operator">/</span>TextBlock<span class="token operator">&gt;</span>
                            <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 显示消息内容 <span class="token operator">--</span><span class="token operator">&gt;</span>
                            <span class="token operator">&lt;</span><span class="token class-name">TextBlock</span> FontSize<span class="token operator">=</span><span class="token string">"14"</span>  Margin<span class="token operator">=</span><span class="token string">"10,5,0,0"</span> 
                               Text<span class="token operator">=</span><span class="token string">"{Binding Content}"</span> <span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span>TextBlock<span class="token punctuation">.</span>ContextMenu<span class="token operator">&gt;</span>
                                    <span class="token operator">&lt;</span><span class="token class-name">ContextMenu</span> Name<span class="token operator">=</span><span class="token string">"RightKeyMenu"</span> DataContext<span class="token operator">=</span><span class="token string">"{Binding PlacementTarget.DataContext,RelativeSource={RelativeSource Self}}"</span><span class="token operator">&gt;</span>    
                                        <span class="token operator">&lt;</span><span class="token class-name">MenuItem</span> Name<span class="token operator">=</span><span class="token string">"Delete"</span> Header<span class="token operator">=</span><span class="token string">"删除"</span>
                                            Command<span class="token operator">=</span><span class="token string">"{Binding MenuDownItemCommand}"</span> CommandParameter<span class="token operator">=</span><span class="token string">"{Binding}"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
                                        <span class="token operator">&lt;</span>Separator<span class="token operator">/</span><span class="token operator">&gt;</span>
                                    <span class="token operator">&lt;</span><span class="token operator">/</span>ContextMenu<span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span><span class="token operator">/</span>TextBlock<span class="token punctuation">.</span>ContextMenu<span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span>behavior<span class="token punctuation">:</span>Interaction<span class="token punctuation">.</span>Triggers<span class="token operator">&gt;</span>
                                    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>鼠标点击命令事件<span class="token operator">--</span><span class="token operator">&gt;</span>
                                    <span class="token operator">&lt;</span>behavior<span class="token punctuation">:</span><span class="token class-name">EventTrigger</span> EventName<span class="token operator">=</span><span class="token string">"PreviewMouseDown"</span><span class="token operator">&gt;</span>
                                        <span class="token operator">&lt;</span>behavior<span class="token punctuation">:</span><span class="token class-name">InvokeCommandAction</span>
                                         Command<span class="token operator">=</span>"<span class="token punctuation">{<!-- --></span>Binding DataContext<span class="token punctuation">.</span>DataMouseDownCommand<span class="token punctuation">,</span> 
                                                   RelativeSource<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token class-name">RelativeSource</span> AncestorType<span class="token operator">=</span>ListBox<span class="token punctuation">}</span><span class="token punctuation">}</span>"
                                                   PassEventArgsToCommand<span class="token operator">=</span><span class="token string">"True"</span><span class="token operator">&gt;</span>
                                        <span class="token operator">&lt;</span><span class="token operator">/</span>behavior<span class="token punctuation">:</span>InvokeCommandAction<span class="token operator">&gt;</span>
                                    <span class="token operator">&lt;</span><span class="token operator">/</span>behavior<span class="token punctuation">:</span>EventTrigger<span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span><span class="token operator">/</span>behavior<span class="token punctuation">:</span>Interaction<span class="token punctuation">.</span>Triggers<span class="token operator">&gt;</span>
                            <span class="token operator">&lt;</span><span class="token operator">/</span>TextBlock<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span><span class="token operator">/</span>StackPanel<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span><span class="token operator">/</span>DataTemplate<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>ListBox<span class="token punctuation">.</span>ItemTemplate<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>ListBox<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>ScrollViewer<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Grid<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>UserControl<span class="token operator">&gt;</span>

</code></pre>
    <h4>
     <a id="1__PropertyChangedBase_101">
     </a>
     1、属性变更 == PropertyChangedBase
    </h4>
    <pre><code class="prism language-csharp"><span class="token comment">///属性变更基类</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PropertyChangedBase</span><span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">INotifyPropertyChanged</span></span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">public</span> <span class="token keyword">event</span> <span class="token class-name">PropertyChangedEventHandler<span class="token punctuation">?</span></span> PropertyChanged<span class="token punctuation">;</span>
	<span class="token keyword">protected</span> <span class="token keyword">virtual</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnPropertyChanged</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">CallerMemberName</span></span><span class="token punctuation">]</span> <span class="token class-name"><span class="token keyword">string</span></span> propertyName <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		PropertyChanged<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PropertyChangedEventArgs</span><span class="token punctuation">(</span>propertyName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="2__DataListViewModel_113">
     </a>
     2、数据集合视图模型 == DataListViewModel
    </h4>
    <pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataListViewModel</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">PropertyChangedBase</span></span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">ObservableCollection<span class="token punctuation">&lt;</span>DataModel<span class="token punctuation">&gt;</span></span> _dataCollection<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token return-type class-name">ObservableCollection<span class="token punctuation">&lt;</span>DataModel<span class="token punctuation">&gt;</span></span> DataCollection
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">get</span> <span class="token operator">=&gt;</span> _dataCollection<span class="token punctuation">;</span>
        <span class="token keyword">set</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>_dataCollection <span class="token operator">!=</span> <span class="token keyword">value</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                _dataCollection <span class="token operator">=</span> <span class="token keyword">value</span><span class="token punctuation">;</span>
                <span class="token function">OnPropertyChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">ICommand</span> DataMouseDownCommand <span class="token punctuation">{<!-- --></span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token comment">//无参构造</span>
    <span class="token keyword">public</span> <span class="token function">DataListViewModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">Initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/// &lt;summary&gt;</span>
    <span class="token comment">/// 初始化数据</span>
    <span class="token comment">/// &lt;/summary&gt;</span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        DataMouseDownCommand <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">RelayCommand</span><span class="token punctuation">(</span>OnDataMouseDown<span class="token punctuation">)</span><span class="token punctuation">;</span>
        DataCollection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ObservableCollection<span class="token punctuation">&lt;</span>DataModel<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">DataModel</span> dataModel <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">DataModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            dataModel<span class="token punctuation">.</span>Date <span class="token operator">=</span> DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">"yyyy-MM-dd HH:mm:ss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            dataModel<span class="token punctuation">.</span>Content <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$"测试数据0000</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">i</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">;</span>
            dataModel<span class="token punctuation">.</span>MenuDownItemCommand <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">RelayCommand</span><span class="token punctuation">(</span>OnMenuItemMouseDown<span class="token punctuation">)</span><span class="token punctuation">;</span>
            DataCollection<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>dataModel<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnDataMouseDown</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> args<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//业务处理</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnMenuItemMouseDown</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> args<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//业务处理</span>
        MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"右键菜单被点击了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="3__DataModel_166">
     </a>
     3、数据模型类 == DataModel
    </h4>
    <pre><code class="prism language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataModel</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">PropertyChangedBase</span></span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Content <span class="token punctuation">{<!-- --></span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Date <span class="token punctuation">{<!-- --></span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">ICommand</span> MenuDownItemCommand <span class="token punctuation">{<!-- --></span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="4__RelayCommand_176">
     </a>
     4、命令 == RelayCommand
    </h4>
    <pre><code class="prism language-csharp"> <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RelayCommand</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ICommand</span></span>
 <span class="token punctuation">{<!-- --></span>
     <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">Action<span class="token punctuation">&lt;</span><span class="token keyword">object</span><span class="token punctuation">&gt;</span></span> _execute<span class="token punctuation">;</span>
     <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">Predicate<span class="token punctuation">&lt;</span><span class="token keyword">object</span><span class="token punctuation">&gt;</span></span> _canExecute<span class="token punctuation">;</span>
     <span class="token keyword">public</span> <span class="token function">RelayCommand</span><span class="token punctuation">(</span><span class="token class-name">Action<span class="token punctuation">&lt;</span><span class="token keyword">object</span><span class="token punctuation">&gt;</span></span> execute<span class="token punctuation">,</span> <span class="token class-name">Predicate<span class="token punctuation">&lt;</span><span class="token keyword">object</span><span class="token punctuation">&gt;</span></span> canExecute <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
     <span class="token punctuation">{<!-- --></span>
         _execute <span class="token operator">=</span> execute <span class="token operator">??</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ArgumentNullException</span><span class="token punctuation">(</span><span class="token keyword">nameof</span><span class="token punctuation">(</span>execute<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         _canExecute <span class="token operator">=</span> canExecute<span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">CanExecute</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> parameter<span class="token punctuation">)</span>
     <span class="token punctuation">{<!-- --></span>
         <span class="token keyword">return</span> _canExecute <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token function">_canExecute</span><span class="token punctuation">(</span>parameter<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Execute</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> parameter<span class="token punctuation">)</span>
     <span class="token punctuation">{<!-- --></span>
         <span class="token function">_execute</span><span class="token punctuation">(</span>parameter<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">public</span> <span class="token keyword">event</span> <span class="token return-type class-name">EventHandler</span> CanExecuteChanged
     <span class="token punctuation">{<!-- --></span>
         <span class="token keyword">add</span> <span class="token punctuation">{<!-- --></span> CommandManager<span class="token punctuation">.</span>RequerySuggested <span class="token operator">+=</span> <span class="token keyword">value</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
         <span class="token keyword">remove</span> <span class="token punctuation">{<!-- --></span> CommandManager<span class="token punctuation">.</span>RequerySuggested <span class="token operator">-=</span> <span class="token keyword">value</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="_205">
     </a>
     五、总结
    </h3>
    <blockquote>
     <p>
      <strong>
       可以使用ContextMenu 在控件上实现右键点击显示菜单。
      </strong>
      <br/>
      <strong>
       可以给菜单添加多个菜单项（MenuItem)，每个菜单项可以绑定事件或命令。
      </strong>
      <br/>
      <strong>
       ContextMenu 默认不继承父控件的
       <em>
        DataContext
       </em>
       ，但可以使用
       <em>
        PlacementTarget
       </em>
       逐级向上绑定到
       <em>
        DataContext
       </em>
       。
      </strong>
     </p>
    </blockquote>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34333632363231382f:61727469636c652f64657461696c732f313436303735393830" class_="artid" style="display:none">
 </p>
</div>


