---
layout: post
title: "WPF窗口读取显示修改另存excel文件CAD-c二次开发"
date: 2025-03-14 23:56:37 +0800
description: "【代码】WPF窗口读取、显示、修改、另存excel文件——CAD c#二次开发。"
keywords: "WPF窗口读取、显示、修改、另存excel文件——CAD c#二次开发"
categories: ['Cad', 'C']
tags: ['Wpf', 'Excel', 'C']
artid: "146269723"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146269723
    alt: "WPF窗口读取显示修改另存excel文件CAD-c二次开发"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146269723
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146269723
cover: https://bing.ee123.net/img/rand?artid=146269723
image: https://bing.ee123.net/img/rand?artid=146269723
img: https://bing.ee123.net/img/rand?artid=146269723
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     WPF窗口读取、显示、修改、另存excel文件——CAD c#二次开发
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     效果如下：
    </p>
    <p>
     <img alt="" height="582" src="https://i-blog.csdnimg.cn/direct/4eb3237dc4204526bd69faa5996eacd4.png" width="758"/>
    </p>
    <p>
     <img alt="" height="308" src="https://i-blog.csdnimg.cn/direct/c01b70aa13184e78a641b167d49b39d4.png" width="440">
      <img alt="" height="403" src="https://i-blog.csdnimg.cn/direct/3a2efbdf67054eee9352ca92e7349bf2.png" width="439"/>
     </img>
    </p>
    <pre><code class="language-cs">using System.Data;
using System.IO;
using System.Windows;
using Microsoft.Win32;
using ExcelDataReader;
using System.Text;
using ClosedXML.Excel;

namespace IfoxDemo
{
    public partial class SimpleWindow : Window
    {
        public SimpleWindow()
        {
            InitializeComponent();
        }

        private void OnSelectFileButtonClick(object sender, RoutedEventArgs e)
        {
            OpenFileDialog openFileDialog = new OpenFileDialog
            {
                Filter = "Excel Files|*.xls;*.xlsx;*.xlsm"
            };

            if (openFileDialog.ShowDialog() == true)
            {
                string filePath = openFileDialog.FileName;
                System.Data.DataTable dataTable = ReadExcelFile(filePath);
                //dataGrid.HeadersVisibility = DataGridHeadersVisibility.None; // Hide the header row
                dataGrid.ItemsSource = dataTable.DefaultView;
            }
        }

        private void OnSaveFileButtonClick(object sender, RoutedEventArgs e)
        {
            SaveFileDialog saveFileDialog = new SaveFileDialog
            {
                Filter = "Excel Files|*.xlsx",
                DefaultExt = "xlsx"
            };

            if (saveFileDialog.ShowDialog() == true)
            {
                string filePath = saveFileDialog.FileName;
                SaveDataGridToExcel(filePath);
            }
        }

        private System.Data.DataTable ReadExcelFile(string filePath)
        {
            Encoding.RegisterProvider(CodePagesEncodingProvider.Instance);
            using (var stream = File.Open(filePath, FileMode.Open, FileAccess.Read))
            {
                using (var reader = ExcelReaderFactory.CreateReader(stream))
                {
                    var result = reader.AsDataSet();
                    return result.Tables[0];
                }
            }
        }

        private void SaveDataGridToExcel(string filePath)
        {
            var dataTable = ((DataView)dataGrid.ItemsSource).ToTable();
            // Remove the first row
      

            using (var workbook = new XLWorkbook())
            {
                var worksheet = workbook.Worksheets.Add(dataTable, "Sheet1");
                workbook.SaveAs(filePath);
            }
        }
    }
}
</code></pre>
    <pre><code class="language-cs">&lt;Window x:Class="IfoxDemo.SimpleWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="SimpleWindow" Height="500" Width="600"&gt;
    &lt;Grid&gt;
        &lt;StackPanel&gt;
            &lt;Button Content="选择Excel文件" Margin="10" Click="OnSelectFileButtonClick"/&gt;
            &lt;Button Content="保存修改后的数据" Margin="10" Click="OnSaveFileButtonClick"/&gt;
            &lt;DataGrid Name="dataGrid" AutoGenerateColumns="True" Margin="10" 
                      HorizontalScrollBarVisibility="Visible" VerticalScrollBarVisibility="Visible" 
                      Height="300" CanUserResizeColumns="True" /&gt;
        &lt;/StackPanel&gt;
    &lt;/Grid&gt;
&lt;/Window&gt;
</code></pre>
    <p>
    </p>
    <p>
    </p>
    <pre><code class="language-cs">using System.Collections;
using System.Collections.Generic;
using static IFoxCAD.Cad.OpFilter;

namespace IfoxDemo
{
    public class 生成迷宫
    {
        [CommandMethod("xx")]
        public void Demo()
        {
            using var tr = new DBTrans();
            tr.Database.EraseAll();
            Env.Editor.WriteMessage("开始生成迷宫1");
            if (System.Windows.Application.Current == null)
            {
                new System.Windows.Application { ShutdownMode = ShutdownMode.OnExplicitShutdown };
            }

            // 显示WPF窗口
            System.Windows.Application.Current.Dispatcher.Invoke(() =&gt;
            {
                var window = new SimpleWindow();
                window.ShowDialog();
            });
        }
    }
  
}
</code></pre>
    <p>
    </p>
   </div>
  </div>
  <div class="blog-extension-box" id="blogExtensionBox" style="width:400px;margin:auto;margin-top:12px">
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f796f6e6773686971712f:61727469636c652f64657461696c732f313436323639373233" class_="artid" style="display:none">
 </p>
</div>


