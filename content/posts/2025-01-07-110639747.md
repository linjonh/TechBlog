---
layout: post
title: "小程序-uniapp-实现pdf-电子合同签名-并导出功能"
date: 2025-01-07 22:50:42 +0800
description: "小程序 uniapp  实现pdf 电子合同签名 并导出功能需求流程：用户只允许上传pdf后端将上传"
keywords: "uniapp pdf转canvas"
categories: ['微信小程序', '公司项目相关', 'Vue']
tags: ['无标签']
artid: "110639747"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=110639747
    alt: "小程序-uniapp-实现pdf-电子合同签名-并导出功能"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=110639747
featuredImagePreview: https://bing.ee123.net/img/rand?artid=110639747
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     小程序 uniapp  实现pdf 电子合同签名 并导出功能
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-dracula" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="_uniapp__pdf___0">
     </a>
     小程序 uniapp 实现pdf 电子合同签名 并导出功能
    </h2>
    <p>
     需求流程：
    </p>
    <ol>
     <li>
      用户只允许上传pdf
     </li>
     <li>
      后端将上传后的pdf以base64图片的形式返回
     </li>
     <li>
      用户设置签名的位置
     </li>
     <li>
      位置设置完成，将电子签名放到设定的位置处
     </li>
     <li>
      利用canvas将两张图片合成一张图片，保存至相册
     </li>
    </ol>
    <p>
     实操
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/03ab71cb406712f402441a833458f4cd.gif#pic_center"/>
    </p>
    <h4>
     <a id="_11">
     </a>
     基本功能不再赘述，简要概括
    </h4>
    <p>
     1：首先是新建签名，出现可缩放，拖拽的框，我是借鉴uniapp插件
     <br/>
     <a href="https://ext.dcloud.net.cn/plugin?id=2059" rel="nofollow">
      插件地址： https://ext.dcloud.net.cn/plugin?id=2059
     </a>
    </p>
    <p>
     2: 按照插件步骤执行完毕，下一步就是获取拖拽，缩放之后的 宽高和坐标
     <br/>
     x, y, w, h
     <br/>
     在下载的插件里面，有个end方法，在end方法里面，获取当前框的大小的位置
    </p>
    <pre><code class="prism language-java"><span class="token operator">&lt;</span>canvas
    canvas<span class="token operator">-</span>id<span class="token operator">=</span><span class="token string">"canvas-drag"</span>
    disable<span class="token operator">-</span>scroll<span class="token operator">=</span><span class="token string">"true"</span>
    <span class="token annotation punctuation">@touchstart</span><span class="token operator">=</span><span class="token string">"start"</span>
    <span class="token annotation punctuation">@touchmove</span><span class="token operator">=</span><span class="token string">"move"</span>
    <span class="token annotation punctuation">@touchend</span><span class="token operator">=</span><span class="token string">"end"</span>
    <span class="token operator">:</span>style<span class="token operator">=</span><span class="token string">"'width: ' + width + 'rpx; height: ' + height + 'rpx;'"</span>
  <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>canvas<span class="token operator">&gt;</span>
</code></pre>
    <pre><code class="prism language-java">    <span class="token function">end</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      uni<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">"storage_x"</span><span class="token punctuation">,</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>pdfX<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      uni<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">"storage_y"</span><span class="token punctuation">,</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>pdfY<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      uni<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">"storage_w"</span><span class="token punctuation">,</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>pdfW<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      uni<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">"storage_h"</span><span class="token punctuation">,</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>pdfH<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>tempGraphArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>isMove<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        isMove <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// 重置移动标识</span>
        <span class="token comment">// 用户操作结束时记录历史</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">recordHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
    <p>
     记录之后，画框，旋转，缩放，这一快就结束了。之后就是
     <br/>
     写签名
     <br/>
     将签名放在指定位置
     <br/>
     将签名导出本地
    </p>
    <h5>
     <a id="_48">
     </a>
     写签名直接复制过去就能用
    </h5>
    <h6>
     <a id="unicanvasToTempFilePath__49">
     </a>
     画完之后，调用uni.canvasToTempFilePath ,会返回一个本地路径，并将本地路劲传到之前选择框的页面
    </h6>
    <pre><code class="prism language-java"><span class="token generics function"><span class="token punctuation">&lt;</span>template<span class="token punctuation">&gt;</span></span>
  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token operator">&lt;</span>div v<span class="token operator">-</span>show<span class="token operator">=</span><span class="token string">"showCanvas"</span><span class="token operator">&gt;</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"contain"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>canvas
      canvas<span class="token operator">-</span>id<span class="token operator">=</span><span class="token string">"mycanvas"</span>
      <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"mycanvas"</span>
      disable<span class="token operator">-</span>scroll<span class="token operator">=</span><span class="token string">"true"</span>
      <span class="token annotation punctuation">@touchstart</span><span class="token operator">=</span><span class="token string">"ontouchstart"</span>
      <span class="token annotation punctuation">@touchmove</span><span class="token operator">=</span><span class="token string">"touchmove"</span>
      <span class="token annotation punctuation">@touchend</span><span class="token operator">=</span><span class="token string">"touchend"</span>
    <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>canvas<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"footer"</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"footer-wrap"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>pdf<span class="token operator">-</span>button
          text<span class="token operator">=</span><span class="token string">"清除"</span>
          mode<span class="token operator">=</span><span class="token string">"clear"</span>
          <span class="token annotation punctuation">@pdfButton</span><span class="token operator">=</span><span class="token string">"clear"</span>
          <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"btn"</span>
        <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>pdf<span class="token operator">-</span>button<span class="token operator">&gt;</span>

        <span class="token operator">&lt;</span>pdf<span class="token operator">-</span>button
          v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"show"</span>
          text<span class="token operator">=</span><span class="token string">"完成"</span>
          mode<span class="token operator">=</span><span class="token string">"pdfGary"</span>
          left<span class="token operator">=</span><span class="token string">"31rpx"</span>
          <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"btn"</span>
        <span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>pdf<span class="token operator">-</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>pdf<span class="token operator">-</span>button
          v<span class="token operator">-</span><span class="token keyword">else</span>
          text<span class="token operator">=</span><span class="token string">"完成"</span>
          mode<span class="token operator">=</span><span class="token string">"pdfFinssh"</span>
          <span class="token annotation punctuation">@pdfButton</span><span class="token operator">=</span><span class="token string">"close"</span>
          left<span class="token operator">=</span><span class="token string">"31rpx"</span>
          <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"btn"</span>
        <span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>pdf<span class="token operator">-</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token generics function"><span class="token punctuation">&lt;</span>script<span class="token punctuation">&gt;</span></span>
<span class="token keyword">import</span> pdfButton from <span class="token string">"../../components/pdfButton"</span><span class="token punctuation">;</span>


export <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  components<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    pdfButton<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      headerStyleHeight<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      headerStyleTop<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      oc<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
      points<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//路径点集合</span>
      showCanvas<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//</span>
      show<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">onShow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initCanvas</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// console.log('参数',+uni.getStorageSync("storage_w"));</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      uni<span class="token punctuation">.</span><span class="token function">canvasToTempFilePath</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        canvasId<span class="token operator">:</span> <span class="token string">"mycanvas"</span><span class="token punctuation">,</span>
        success<span class="token operator">:</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"res"</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>tempFilePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">const</span> canvas <span class="token operator">=</span> res<span class="token punctuation">.</span>tempFilePath<span class="token punctuation">;</span>
          uni<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            url<span class="token operator">:</span> `<span class="token operator">/</span>pages<span class="token operator">/</span>previewFinally<span class="token operator">/</span>index<span class="token operator">?</span>hasSingle<span class="token operator">=</span>$<span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">}</span><span class="token operator">&amp;</span>canvas<span class="token operator">=</span>$<span class="token punctuation">{<!-- --></span>canvas<span class="token punctuation">}</span>`<span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token function">initCanvas</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>showCanvas <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>oc <span class="token operator">=</span> uni<span class="token punctuation">.</span><span class="token function">createCanvasContext</span><span class="token punctuation">(</span><span class="token string">"mycanvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//设置画笔样式</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>oc<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>oc<span class="token punctuation">.</span>lineCap <span class="token operator">=</span> <span class="token string">"round"</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>oc<span class="token punctuation">.</span>lineJoin <span class="token operator">=</span> <span class="token string">"round"</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>oc<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">"black"</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>oc<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">"#fff"</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>oc<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>oc<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">700</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>oc<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>oc<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">ontouchend</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"结束啊啊啊啊"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      oc<span class="token punctuation">.</span>ontouchmove <span class="token operator">=</span> null<span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>show <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">ontouchmove</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> clientX<span class="token punctuation">,</span> clientY <span class="token punctuation">}</span> <span class="token operator">=</span> e<span class="token punctuation">.</span>changedTouches<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      oc<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>clientX <span class="token operator">-</span> oc<span class="token punctuation">.</span>offsetLeft<span class="token punctuation">,</span> clientY <span class="token operator">-</span> oc<span class="token punctuation">.</span>offsetTop<span class="token punctuation">)</span><span class="token punctuation">;</span>
      oc<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//触摸开始，获取到起点</span>

    <span class="token function">ontouchstart</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// debugger</span>
      <span class="token comment">//   ctx.beginPath();</span>
      <span class="token keyword">const</span> startX <span class="token operator">=</span> e<span class="token punctuation">.</span>changedTouches<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">;</span>
      <span class="token keyword">const</span> startY <span class="token operator">=</span> e<span class="token punctuation">.</span>changedTouches<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">;</span>

      let startPoint <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        X<span class="token operator">:</span> startX<span class="token punctuation">,</span>
        Y<span class="token operator">:</span> startY<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>points<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>startPoint<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//每次触摸开始，开启新的路径</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>oc<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//触摸移动，获取到路径点</span>
    <span class="token function">touchmove</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      let moveX <span class="token operator">=</span> e<span class="token punctuation">.</span>changedTouches<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">;</span>
      let moveY <span class="token operator">=</span> e<span class="token punctuation">.</span>changedTouches<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">;</span>
      let movePoint <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        X<span class="token operator">:</span> moveX<span class="token punctuation">,</span>
        Y<span class="token operator">:</span> moveY<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>points<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>movePoint<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//存点</span>
      let len <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>points<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//绘制路径</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// 触摸结束，将未绘制的点清空防止对后续路径产生干扰</span>
    <span class="token function">touchend</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>points <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>show <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/* ***********************************************
                                                                                                                #   绘制笔迹
                                                                                                                #   1.为保证笔迹实时显示，必须在移动的同时绘制笔迹
                                                                                                                #   2.为保证笔迹连续，每次从路径集合中区两个点作为起点（moveTo）和终点(lineTo)
                                                                                                                #   3.将上一次的终点作为下一次绘制的起点（即清除第一个点）
                                                                                                                ************************************************ */</span>
    <span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      let point1 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>points<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      let point2 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>points<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>points<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>oc<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span>point1<span class="token punctuation">.</span>X<span class="token punctuation">,</span> point1<span class="token punctuation">.</span>Y<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>oc<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>point2<span class="token punctuation">.</span>X<span class="token punctuation">,</span> point2<span class="token punctuation">.</span>Y<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>oc<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>oc<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//清空画布</span>
    <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>show <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      let that <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
      uni<span class="token punctuation">.</span><span class="token function">getSystemInfo</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        success<span class="token operator">:</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
          let canvasw <span class="token operator">=</span> res<span class="token punctuation">.</span>windowWidth<span class="token punctuation">;</span>
          let canvash <span class="token operator">=</span> res<span class="token punctuation">.</span>windowHeight<span class="token punctuation">;</span>
          that<span class="token punctuation">.</span>oc<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> canvasw<span class="token punctuation">,</span> canvash<span class="token punctuation">)</span><span class="token punctuation">;</span>
          that<span class="token punctuation">.</span>oc<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token comment">//   that.initCanvas();</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style lang<span class="token operator">=</span><span class="token string">"scss"</span><span class="token operator">&gt;</span>
<span class="token punctuation">.</span>contain <span class="token punctuation">{<!-- --></span>
  height<span class="token operator">:</span> <span class="token number">100</span>vh<span class="token punctuation">;</span>
  position<span class="token operator">:</span> relative<span class="token punctuation">;</span>
  <span class="token punctuation">.</span>button <span class="token punctuation">{<!-- --></span>
    width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
    height<span class="token operator">:</span> <span class="token number">50</span>px<span class="token punctuation">;</span>
    line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">50</span>px<span class="token punctuation">;</span>
    text<span class="token operator">-</span>align<span class="token operator">:</span> center<span class="token punctuation">;</span>
    font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span>
    border<span class="token operator">:</span> <span class="token number">1</span>px solid #bbbbbb<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token punctuation">.</span>header<span class="token operator">-</span>box <span class="token punctuation">{<!-- --></span>
    width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
    background<span class="token operator">-</span>color<span class="token operator">:</span> #ffffff<span class="token punctuation">;</span>
    padding<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">20</span>rpx<span class="token punctuation">;</span>
    color<span class="token operator">:</span> red<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token punctuation">.</span>content<span class="token operator">-</span>box <span class="token punctuation">{<!-- --></span>
    width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
    height<span class="token operator">:</span> <span class="token number">500</span>px<span class="token punctuation">;</span>
    <span class="token comment">//   background-color: aliceblue;</span>
    padding<span class="token operator">:</span> <span class="token number">20</span>rpx<span class="token punctuation">;</span>
    box<span class="token operator">-</span>sizing<span class="token operator">:</span> border<span class="token operator">-</span>box<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token punctuation">.</span>signature <span class="token punctuation">{<!-- --></span>
    position<span class="token operator">:</span> fixed<span class="token punctuation">;</span>
    top<span class="token operator">:</span> <span class="token number">10</span>px<span class="token punctuation">;</span>
    left<span class="token operator">:</span> <span class="token number">2</span><span class="token operator">%</span><span class="token punctuation">;</span>
    z<span class="token operator">-</span>index<span class="token operator">:</span> <span class="token number">999</span><span class="token punctuation">;</span>
    width<span class="token operator">:</span> <span class="token number">96</span><span class="token operator">%</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token punctuation">.</span>mycanvas <span class="token punctuation">{<!-- --></span>
    width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
    height<span class="token operator">:</span> <span class="token number">330</span>rpx<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token punctuation">.</span>footer <span class="token punctuation">{<!-- --></span>
    font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">14</span>px<span class="token punctuation">;</span>
    height<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
    display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
    justify<span class="token operator">-</span>content<span class="token operator">:</span> space<span class="token operator">-</span>around<span class="token punctuation">;</span>
    align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
    background<span class="token operator">:</span> #f2f3f5<span class="token punctuation">;</span>
    <span class="token punctuation">.</span>footer<span class="token operator">-</span>wrap <span class="token punctuation">{<!-- --></span>
      height<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
      padding<span class="token operator">:</span> <span class="token number">57</span>rpx <span class="token number">37</span>rpx <span class="token number">17</span>rpx <span class="token number">37</span>rpx<span class="token punctuation">;</span>
      box<span class="token operator">-</span>sizing<span class="token operator">:</span> border<span class="token operator">-</span>box<span class="token punctuation">;</span>
      display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
      align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token punctuation">.</span>sty<span class="token operator">-</span>single <span class="token punctuation">{<!-- --></span>
    position<span class="token operator">:</span> absolute<span class="token punctuation">;</span>
    top<span class="token operator">:</span> <span class="token number">70</span>rpx<span class="token punctuation">;</span>
    left<span class="token operator">:</span> <span class="token number">0</span>rpx<span class="token punctuation">;</span>
    width<span class="token operator">:</span> <span class="token number">569</span>rpx<span class="token punctuation">;</span>
    height<span class="token operator">:</span> <span class="token number">200</span>rpx<span class="token punctuation">;</span>
    z<span class="token operator">-</span>index<span class="token operator">:</span> <span class="token number">111</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>btn <span class="token punctuation">{<!-- --></span>
  height<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>

</code></pre>
    <h5>
     <a id="_299">
     </a>
     在之前设置位置的页面，将画好的签名。放到指定位置
    </h5>
    <pre><code class="prism language-java"><span class="token comment">// 接收传来的canvas</span>

<span class="token function">onLoad</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>hasSingle <span class="token operator">=</span> options<span class="token punctuation">.</span>hasSingle<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>canvas <span class="token operator">=</span> options<span class="token punctuation">.</span>canvas<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">px</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 渲染canvas，注意宽高，坐标。用之前保存的坐标</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      pdfDataList<span class="token operator">:</span> uni<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">"filePath"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      hasSingle<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      canvas<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
      rpx<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
      finillyX<span class="token operator">:</span> uni<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">"storage_x"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      finillyY<span class="token operator">:</span> uni<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">"storage_y"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      finillyW<span class="token operator">:</span> uni<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">"storage_w"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      finillyH<span class="token operator">:</span> uni<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">"storage_h"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token comment">//  渲染</span>
 <span class="token operator">&lt;</span>image
        v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"pdfDataList != '' &amp;&amp; hasSingle == 1"</span>
        <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">"canvas"</span>
        <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"sty-single transfo"</span>
        <span class="token operator">:</span>style<span class="token operator">=</span>"<span class="token punctuation">{<!-- --></span>
          width<span class="token operator">:</span> finillyW <span class="token operator">+</span> <span class="token string">'px'</span><span class="token punctuation">,</span>
          height<span class="token operator">:</span> finillyH <span class="token operator">+</span> <span class="token string">'px'</span><span class="token punctuation">,</span>
          top<span class="token operator">:</span> finillyY <span class="token operator">+</span> <span class="token string">'px'</span><span class="token punctuation">,</span>
          left<span class="token operator">:</span> finillyX <span class="token operator">+</span> <span class="token string">'px'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>"
      <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
</code></pre>
    <h4>
     <a id="canvasAPI_335">
     </a>
     合成图片，将两个图片都画成canvas，然后利用API导出
    </h4>
    <h6>
     <a id="_336">
     </a>
     结构
    </h6>
    <pre><code class="prism language-java"><span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"footer-wrap"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>pdf<span class="token operator">-</span>button
          v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"canvas"</span>
          text<span class="token operator">=</span><span class="token string">"保存合同"</span>
          mode<span class="token operator">=</span><span class="token string">"finishBig"</span>
          <span class="token annotation punctuation">@pdfButton</span><span class="token operator">=</span><span class="token string">"finishSave"</span>
          <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"btn"</span>
        <span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>pdf<span class="token operator">-</span>button<span class="token operator">&gt;</span>
</code></pre>
    <h6>
     <a id="_348">
     </a>
     功能
    </h6>
    <pre><code class="prism language-java"><span class="token function">finishSave</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 提示用户正在合成，否则用户可能有不当操作或者以为手机卡死</span>
      wx<span class="token punctuation">.</span><span class="token function">showLoading</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        title<span class="token operator">:</span> <span class="token string">"合成中"</span><span class="token punctuation">,</span>
        mask<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 创建画布对象</span>
      <span class="token keyword">const</span> ctx <span class="token operator">=</span> uni<span class="token punctuation">.</span><span class="token function">createCanvasContext</span><span class="token punctuation">(</span><span class="token string">"myCanvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"ctx"</span><span class="token punctuation">,</span> ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 获取图片信息，要按照原图来绘制，否则图片会变形</span>
      uni<span class="token punctuation">.</span><span class="token function">getImageInfo</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        src<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pdfDataList<span class="token punctuation">,</span> <span class="token comment">// 底图</span>
        success<span class="token operator">:</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
          <span class="token comment">// 根据 图片的大小 绘制底图 的大小</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">" 底图"</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
          let imgPath <span class="token operator">=</span> res<span class="token punctuation">.</span>path<span class="token punctuation">;</span>
          ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>
            imgPath<span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token number">750</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>rpx<span class="token punctuation">,</span>
            <span class="token punctuation">(</span><span class="token number">1061</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>rpx
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
          wx<span class="token punctuation">.</span><span class="token function">getImageInfo</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            src<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>canvas<span class="token punctuation">,</span>
            success<span class="token operator">:</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
              console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">" 签名"</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
              ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>
                res<span class="token punctuation">.</span>path<span class="token punctuation">,</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>finillyX<span class="token punctuation">,</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>finillyY<span class="token punctuation">,</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>finillyW<span class="token punctuation">,</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>finillyH
              <span class="token punctuation">)</span><span class="token punctuation">;</span>
              ctx<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"111"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                uni<span class="token punctuation">.</span><span class="token function">canvasToTempFilePath</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                  canvasId<span class="token operator">:</span> <span class="token string">"myCanvas"</span><span class="token punctuation">,</span>
                  success<span class="token operator">:</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
                    uni<span class="token punctuation">.</span><span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"合成图片"</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">const</span> tempFilePath <span class="token operator">=</span> res<span class="token punctuation">.</span>tempFilePath<span class="token punctuation">;</span>
                    <span class="token comment">// 保存到相册</span>
                    wx<span class="token punctuation">.</span><span class="token function">saveImageToPhotosAlbum</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                      filePath<span class="token operator">:</span> tempFilePath<span class="token punctuation">,</span>
                      success<span class="token operator">:</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token comment">// 修改下载状态</span>
                        wx<span class="token punctuation">.</span><span class="token function">showModal</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                          title<span class="token operator">:</span> <span class="token string">"温馨提示"</span><span class="token punctuation">,</span>
                          content<span class="token operator">:</span> <span class="token string">"已保存到本地相册"</span><span class="token punctuation">,</span>
                          confirmText<span class="token operator">:</span> <span class="token string">"我知道了"</span><span class="token punctuation">,</span>
                          showCancel<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                          success<span class="token operator">:</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
                            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"res图片保存成功"</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>confirm<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                              uni<span class="token punctuation">.</span><span class="token function">reLaunch</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                                url<span class="token operator">:</span> <span class="token string">"/pages/contract/index"</span><span class="token punctuation">,</span>
                              <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                            uni<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">"sing"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            uni<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">"File"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            uni<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">"filePath"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                          <span class="token punctuation">}</span><span class="token punctuation">,</span>
                        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                      <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                  <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
    <p>
     由于canvas画出来的坐标都是px,所以在保存的时候。为了不同机型，需要做适配，按比例就好
    </p>
    <pre><code class="prism language-java"> <span class="token function">px</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> windowWidth <span class="token punctuation">}</span> <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">getSystemInfoSync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>rpx <span class="token operator">=</span> windowWidth <span class="token operator">/</span> <span class="token number">375</span><span class="token punctuation">;</span>
      <span class="token comment">//获取屏幕宽度，获取自适应单位</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"rpx"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>rpx<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
    <h2>
     <a id="vif_pdfbutton_438">
     </a>
     以上代码仅供参考，出现v-if 判断，或者pdf-button之类的。改成自己需要即可
    </h2>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f33383834353835382f:61727469636c652f64657461696c732f313130363339373437" class_="artid" style="display:none">
 </p>
</div>


