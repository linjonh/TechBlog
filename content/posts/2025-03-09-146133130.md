---
arturl_encode: "68747470733a2f2f626c:6f672e6373646e2e6e65742f5072696e63653134303637382f:61727469636c652f64657461696c732f313436313333313330"
layout: post
title: "SpringBootæ·±å…¥å‰–æ-Spring-Boot-è‡ªåŠ¨è£…é…åŸç†é™„æºç ä¸å®æˆ˜"
date: 2025-03-09 15:32:20 +0800
description: "Beanè€Œåœ¨ Spring Boot ä¸­ï¼Œè¿™äº› Beanå¯ä»¥ä¸å†™ï¼ŒSpring Boot ä¼šè‡ªåŠ¨è£…é…åˆé€‚çš„ Beanã€‚ä¾‹å¦‚ï¼Œæ·»åŠ ä¾èµ–åï¼ŒSpring Boot ä¼šè‡ªåŠ¨é…ç½®DataSourceä½†æˆ‘ä»¬ä»æœªåœ¨ä»£ç ä¸­æ˜¾å¼å®šä¹‰å®ƒï¼å‡è®¾æˆ‘ä»¬å¸Œæœ› Spring Bootåœ¨é¡¹ç›®å¯åŠ¨æ—¶è‡ªåŠ¨è£…é…ä¸€ä¸ªè‡ªå®šä¹‰çš„ HelloServiceï¼Œè€Œæ— éœ€æ‰‹åŠ¨é…ç½® Beanï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å®ç°ã€‚å¦‚æœä¸æƒ³è®©æŸäº›è‡ªåŠ¨é…ç½®ç”Ÿæ•ˆï¼Œå¯ä»¥ä½¿ç”¨excludeæˆ–è€…åœ¨Spring Boot é€šè¿‡å’ŒåŠ è½½ä¸­çš„è‡ªåŠ¨é…ç½®ç±»ã€‚è‡ªåŠ¨é…ç½®ç±»ä½¿ç”¨ã€‚"
keywords: "ã€SpringBootã€‘æ·±å…¥å‰–æ Spring Boot è‡ªåŠ¨è£…é…åŸç†ï¼ˆé™„æºç ä¸å®æˆ˜ï¼‰"
categories: ['åŸç†åˆ†æ', 'Springboot']
tags: ['åŸç†åˆ†æ', 'Spring', 'Boot']
artid: "146133130"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146133130
    alt: "SpringBootæ·±å…¥å‰–æ-Spring-Boot-è‡ªåŠ¨è£…é…åŸç†é™„æºç ä¸å®æˆ˜"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146133130
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146133130
cover: https://bing.ee123.net/img/rand?artid=146133130
image: https://bing.ee123.net/img/rand?artid=146133130
img: https://bing.ee123.net/img/rand?artid=146133130
---

# ã€SpringBootã€‘æ·±å…¥å‰–æ Spring Boot è‡ªåŠ¨è£…é…åŸç†ï¼ˆé™„æºç ä¸å®æˆ˜ï¼‰

## æ·±å…¥å‰–æ Spring Boot è‡ªåŠ¨è£…é…åŸç†ï¼ˆé™„æºç ä¸å®æˆ˜ï¼‰

Spring Boot çš„\*\*è‡ªåŠ¨è£…é…ï¼ˆAuto Configurationï¼‰
**æ˜¯å…¶æ ¸å¿ƒç‰¹æ€§ä¹‹ä¸€ï¼Œä½¿å¾—å¼€å‘è€…æ— éœ€æ‰‹åŠ¨é…ç½®å¤æ‚çš„ Beanï¼Œå³å¯å¿«é€Ÿæ„å»ºåº”ç”¨ã€‚ä½†**
Spring Boot æ˜¯å¦‚ä½•å®ç°è‡ªåŠ¨è£…é…çš„ï¼Ÿå®ƒçš„åº•å±‚åŸç†æ˜¯ä»€ä¹ˆï¼Ÿæˆ‘ä»¬åˆè¯¥å¦‚ä½•è‡ªå®šä¹‰è‡ªåŠ¨è£…é…ï¼Ÿ\*\*æœ¬æ–‡å°†ä»æºç å…¥æ‰‹ï¼Œæ·±å…¥å‰–æ Spring Boot çš„è‡ªåŠ¨è£…é…åŸç†ï¼Œå¹¶é€šè¿‡ä»£ç å®æˆ˜åŠ æ·±ç†è§£ã€‚

---

### 1. ä»€ä¹ˆæ˜¯è‡ªåŠ¨è£…é…ï¼Ÿ

åœ¨ä¼ ç»Ÿçš„ Spring é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨é…ç½® Beanï¼Œä¾‹å¦‚ XML æˆ– Java é…ç½®ï¼š

```java
@Bean
public DataSource dataSource() {
    return new HikariDataSource();
}

```

è€Œåœ¨ Spring Boot ä¸­ï¼Œè¿™äº› Bean
**å¯ä»¥ä¸å†™**
ï¼ŒSpring Boot ä¼šè‡ªåŠ¨è£…é…åˆé€‚çš„ Beanã€‚ä¾‹å¦‚ï¼Œæ·»åŠ 
`spring-boot-starter-data-jpa`
ä¾èµ–åï¼ŒSpring Boot ä¼šè‡ªåŠ¨é…ç½®
`DataSource`
ï¼Œ
**ä½†æˆ‘ä»¬ä»æœªåœ¨ä»£ç ä¸­æ˜¾å¼å®šä¹‰å®ƒï¼**

---

### 2. è‡ªåŠ¨è£…é…çš„åº•å±‚åŸç†

Spring Boot çš„è‡ªåŠ¨è£…é…åŸºäº\*\*
`@EnableAutoConfiguration`
\*\*ï¼Œè¯¥æ³¨è§£çš„æ ¸å¿ƒé€»è¾‘å¦‚ä¸‹ï¼š

```java
@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Inherited
@AutoConfigurationPackage
@Import(AutoConfigurationImportSelector.class) // å¯¼å…¥è‡ªåŠ¨è£…é…é€‰æ‹©å™¨
public @interface EnableAutoConfiguration {
}

```

#### 2.1 `@EnableAutoConfiguration` åšäº†ä»€ä¹ˆï¼Ÿ

1. **`@AutoConfigurationPackage`**
   ï¼šè‡ªåŠ¨æ‰«æå¹¶æ³¨å†ŒåŒ…è·¯å¾„ä¸‹çš„ç»„ä»¶ã€‚
2. **`@Import(AutoConfigurationImportSelector.class)`**
   ï¼šåŠ è½½æ‰€æœ‰è‡ªåŠ¨é…ç½®ç±»ã€‚

å…¶ä¸­ï¼Œ
**`AutoConfigurationImportSelector`**
æ˜¯ Spring Boot è‡ªåŠ¨è£…é…çš„æ ¸å¿ƒï¼Œè´Ÿè´£åŠ è½½
`META-INF/spring.factories`
é‡Œçš„è‡ªåŠ¨é…ç½®ç±»ã€‚

---

### 3. Spring Boot å¦‚ä½•åŠ è½½è‡ªåŠ¨é…ç½®ç±»ï¼Ÿ

#### 3.1 `AutoConfigurationImportSelector` æºç åˆ†æ

`AutoConfigurationImportSelector`
é€šè¿‡
`getAutoConfigurationEntry()`
æ–¹æ³•åŠ è½½æ‰€æœ‰è‡ªåŠ¨é…ç½®ç±»ï¼š

```java
@Override
protected AutoConfigurationEntry getAutoConfigurationEntry(AutoConfigurationMetadata metadata, AnnotationMetadata annotationMetadata) {
    List<String> configurations = getCandidateConfigurations(annotationMetadata, metadata);
    configurations = removeDuplicates(configurations);
    return new AutoConfigurationEntry(configurations, exclusions);
}

```

å…¶ä¸­ï¼Œ
`getCandidateConfigurations()`
æ–¹æ³•ä¼šåŠ è½½
`spring.factories`
æ–‡ä»¶ï¼š

```java
protected List<String> getCandidateConfigurations(AnnotationMetadata metadata, AutoConfigurationMetadata autoConfigurationMetadata) {
    return SpringFactoriesLoader.loadFactoryNames(getSpringFactoriesLoaderFactoryClass(), getBeanClassLoader());
}

```

#### 3.2 `spring.factories` æ–‡ä»¶

Spring Boot çš„
`spring-boot-autoconfigure.jar`
åŒ…å«
`META-INF/spring.factories`
ï¼Œé‡Œé¢å®šä¹‰äº†æ‰€æœ‰çš„è‡ªåŠ¨è£…é…ç±»ã€‚ä¾‹å¦‚ï¼š

```
org.springframework.boot.autoconfigure.EnableAutoConfiguration=\
org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration,\
org.springframework.boot.autoconfigure.web.servlet.ServletWebServerFactoryAutoConfiguration,\
org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration

```

è¿™æ„å‘³ç€ï¼š
**Spring Boot ä¼šè‡ªåŠ¨åŠ è½½
`DataSourceAutoConfiguration`
ã€
`HibernateJpaAutoConfiguration`
ç­‰è‡ªåŠ¨é…ç½®ç±»ã€‚**

---

### 4. ä»£ç å®æˆ˜ï¼šè‡ªå®šä¹‰è‡ªåŠ¨è£…é…

å‡è®¾æˆ‘ä»¬å¸Œæœ› Spring Boot
**åœ¨é¡¹ç›®å¯åŠ¨æ—¶è‡ªåŠ¨è£…é…ä¸€ä¸ªè‡ªå®šä¹‰çš„ HelloService**
ï¼Œè€Œæ— éœ€æ‰‹åŠ¨é…ç½® Beanï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å®ç°ã€‚

#### 4.1 å®šä¹‰ `HelloService`

é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªç®€å•çš„æœåŠ¡ç±»ï¼š

```java
public class HelloService {
    public String sayHello() {
        return "Hello, Spring Boot AutoConfiguration!";
    }
}

```

#### 4.2 åˆ›å»ºè‡ªåŠ¨é…ç½®ç±»

åœ¨
`com.example.config`
åŒ…ä¸‹åˆ›å»º
`HelloServiceAutoConfiguration`
ï¼Œä½¿ç”¨
`@Configuration`
å’Œ
`@ConditionalOnMissingBean`
ï¼Œç¡®ä¿ä»…åœ¨æ²¡æœ‰ç”¨æˆ·æ‰‹åŠ¨å®šä¹‰
`HelloService`
æ—¶æ‰è¿›è¡Œè£…é…ï¼š

```java
@Configuration
public class HelloServiceAutoConfiguration {

    @Bean
    @ConditionalOnMissingBean
    public HelloService helloService() {
        return new HelloService();
    }
}

```

#### 4.3 æ³¨å†Œåˆ° `spring.factories`

åœ¨
`resources/META-INF/spring.factories`
æ–‡ä»¶ä¸­ï¼ŒåŠ å…¥ï¼š

```
org.springframework.boot.autoconfigure.EnableAutoConfiguration=com.example.config.HelloServiceAutoConfiguration

```

è¿™æ ·ï¼ŒSpring Boot å¯åŠ¨æ—¶ï¼Œä¼šè‡ªåŠ¨åŠ è½½
`HelloServiceAutoConfiguration`
ï¼Œå¹¶è£…é…
`HelloService`
ã€‚

#### 4.4 æµ‹è¯•è‡ªåŠ¨è£…é…

åˆ›å»º Spring Boot å¯åŠ¨ç±»ï¼š

```java
@SpringBootApplication
public class AutoConfigDemoApplication {
    public static void main(String[] args) {
        ApplicationContext context = SpringApplication.run(AutoConfigDemoApplication.class, args);
        HelloService helloService = context.getBean(HelloService.class);
        System.out.println(helloService.sayHello());
    }
}

```

è¿è¡Œåï¼Œè¾“å‡ºï¼š

```
Hello, Spring Boot AutoConfiguration!

```

**è¿™è¯æ˜æˆ‘ä»¬çš„
`HelloService`
å·²ç»è¢« Spring Boot è‡ªåŠ¨è£…é…ï¼**

---

### 5. è‡ªåŠ¨è£…é…çš„æ’é™¤ä¸è‡ªå®šä¹‰

#### 5.1 æ’é™¤ç‰¹å®šçš„è‡ªåŠ¨é…ç½®

å¦‚æœä¸æƒ³è®©æŸäº›è‡ªåŠ¨é…ç½®ç”Ÿæ•ˆï¼Œå¯ä»¥ä½¿ç”¨
`exclude`
ï¼š

```java
@SpringBootApplication(exclude = DataSourceAutoConfiguration.class)
public class MyApplication {
}

```

æˆ–è€…åœ¨
`application.properties`
ä¸­æ’é™¤ï¼š

```
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration

```

#### 5.2 æŸ¥çœ‹å·²åŠ è½½çš„è‡ªåŠ¨é…ç½®

Spring Boot æä¾›
`spring-boot-actuator`
ä¾èµ–ï¼Œå¯ä»¥ä½¿ç”¨
`/actuator/beans`
æŸ¥çœ‹å·²åŠ è½½çš„è‡ªåŠ¨é…ç½® Beanï¼š

```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-actuator</artifactId>
</dependency>

```

ç„¶åè®¿é—®ï¼š

```
http://localhost:8080/actuator/beans

```

å¯ä»¥çœ‹åˆ°å½“å‰åº”ç”¨åŠ è½½äº†å“ªäº›è‡ªåŠ¨è£…é…çš„ Beanã€‚

---

### 6. æ€»ç»“

1. **Spring Boot é€šè¿‡
   `@EnableAutoConfiguration`
   å’Œ
   `AutoConfigurationImportSelector`
   åŠ è½½
   `spring.factories`
   ä¸­çš„è‡ªåŠ¨é…ç½®ç±»ã€‚**
2. **è‡ªåŠ¨é…ç½®ç±»ä½¿ç”¨
   `@ConditionalOnMissingBean`
   ç­‰æ³¨è§£ï¼Œç¡®ä¿åªæœ‰åœ¨å¿…è¦æ—¶æ‰è¿›è¡Œè£…é…ã€‚**
3. **å¯ä»¥è‡ªå®šä¹‰è‡ªåŠ¨è£…é…ç»„ä»¶ï¼Œè®© Spring Boot åœ¨å¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½è‡ªå®šä¹‰ Beanã€‚**
4. **å¯ä»¥ä½¿ç”¨
   `exclude`
   é…ç½®æ’é™¤ç‰¹å®šçš„è‡ªåŠ¨è£…é…ç±»ï¼Œé¿å…ä¸å¿…è¦çš„ Bean åŠ è½½ã€‚**

Spring Boot çš„è‡ªåŠ¨è£…é…æœºåˆ¶æå¤§åœ°ç®€åŒ–äº† Spring åº”ç”¨çš„å¼€å‘ï¼ŒåŒæ—¶æä¾›äº†è¶³å¤Ÿçš„æ‰©å±•æ€§ï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿè½»æ¾åœ°è‡ªå®šä¹‰å’Œç®¡ç† Bean é…ç½®ã€‚å¸Œæœ›æœ¬æ–‡èƒ½å¸®åŠ©ä½ æ·±å…¥ç†è§£ Spring Boot è‡ªåŠ¨è£…é…çš„åº•å±‚åŸç†ï¼ğŸš€

---

ğŸ“Œ
**ä½ å­¦ä¼šäº†å—ï¼Ÿ**
æ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€äº¤æµï¼ğŸ”¥