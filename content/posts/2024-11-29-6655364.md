---
layout: post
title: "发布vc调用Python的独立运行程序"
date: 2024-11-29 14:37:40 +0800
description: "编译Python脚本生成可执行程序，可以通过py2exe编译完成。在VC中调用python时，可以结"
keywords: "发布vc调用python的独立运行的程序"
categories: ['Python']
tags: ['脚本', 'Python', 'Null', 'Import', 'Google', 'Exe']
artid: "6655364"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=6655364
    alt: "发布vc调用Python的独立运行程序"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=6655364
featuredImagePreview: https://bing.ee123.net/img/rand?artid=6655364
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     发布vc调用Python的独立运行程序
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     编译Python脚本生成可执行程序，可以通过py2exe编译完成。
    </p>
    <p>
     在VC中调用python时，可以结合py2exe，完成整个程序的独立发布^_^
    </p>
    <p>
     google.py:
    </p>
    <p>
     #! /usr/bin/env python
    </p>
    <p>
     import sys, webbrowser
    </p>
    <p>
     def main(a):
     <br/>
     url = "
     <a href="http://www.google.com/search?q=%s" rel="nofollow">
      http://www.google.com/search?q=%s
     </a>
     " % a
     <br/>
     webbrowser.open(url)
    </p>
    <p>
     VC源码（python路径等需要自己设置），本程序是通过调用python打开google搜索传入的关键字
    </p>
    <p>
     #include
     <br/>
     int main()
     <br/>
     {
     <!-- -->
     <br/>
     Py_NoSiteFlag = 1;    //避免出现“'import site' failed”的错误
     <br/>
     Py_Initialize();
     <br/>
     PyObject * pModule = NULL;
     <br/>
     PyObject * pFunc = NULL;
     <br/>
     pModule = PyImport_ImportModule("google");    //调用的文件名
     <br/>
     pFunc= PyObject_GetAttrString(pModule, "main");    //调用的函数名
     <br/>
     <br/>
     PyObject *arg;
     <br/>
     arg = Py_BuildValue("(s)", "look");    //构造参数，关键字为“look”
     <br/>
     PyEval_CallObject(pFunc, arg);    //调用函数
     <br/>
     Py_Finalize();
     <br/>
     getchar();
     <br/>
     return 0;
     <br/>
     }
    </p>
    <p>
     一、首先利用py2exe将google.py编译为可执行程序：
    </p>
    <p>
     目的是利用其中生成的python25.dll（这个所有对于所有的python脚本都一样吧）和library.zip（不同脚本生成不同的库文件）。
    </p>
    <p>
     二、发布VC编译生成的程序时，需要以下文件：
    </p>
    <p>
     可执行程序：*.exe；
    </p>
    <p>
     dll：python25.dll；
    </p>
    <p>
     python脚本：google.py；
    </p>
    <p>
     库文件：python25.zip(将library.zip重命名为python25.zip，程序默认调用这个名字的库文件)。
    </p>
    <p>
     三、放到一个无python环境的机器中，测试成功鸟。
    </p>
    <p>
     So Now，可以发布调用python的VC程序了！
    </p>
    <br/>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f77616c6c6163656c69313938:312f61727469636c652f64657461696c732f36363535333634" class_="artid" style="display:none">
 </p>
</div>


