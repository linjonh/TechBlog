---
layout: post
title: "C模拟鼠标点击,模拟鼠标双击,模拟鼠标恒定速度移动,可以看到轨迹"
date: 2025-03-08 17:17:34 +0800
description: "C#模拟鼠标点击，模拟鼠标双击，模拟鼠标恒定速度移动，可以看到轨迹"
keywords: "C#模拟鼠标点击，模拟鼠标双击，模拟鼠标恒定速度移动，可以看到轨迹"
categories: ['Windows', 'C']
tags: ['模拟鼠标', 'C']
artid: "146119167"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146119167
    alt: "C模拟鼠标点击,模拟鼠标双击,模拟鼠标恒定速度移动,可以看到轨迹"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146119167
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146119167
cover: https://bing.ee123.net/img/rand?artid=146119167
image: https://bing.ee123.net/img/rand?artid=146119167
img: https://bing.ee123.net/img/rand?artid=146119167
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     C#模拟鼠标点击，模拟鼠标双击，模拟鼠标恒定速度移动，可以看到轨迹
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     C#模拟鼠标点击，模拟鼠标双击，模拟鼠标恒定速度移动，可以看到轨迹
    </p>
    <pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Linq</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Runtime<span class="token punctuation">.</span>InteropServices</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Text</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Tasks</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">WpfAppYolo11_test1<span class="token punctuation">.</span>Tool</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">/// &lt;summary&gt;</span>
    <span class="token comment">/// 模拟鼠标点击</span>
    <span class="token comment">/// &lt;/summary&gt;</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyMouseClick</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 当鼠标移动时触发</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">event</span> <span class="token class-name">EventHandler</span> OnMoveMouse<span class="token punctuation">;</span>

        <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DllImport</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"User32.dll"</span><span class="token punctuation">,</span> EntryPoint <span class="token operator">=</span> <span class="token string">"GetDC"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
        <span class="token keyword">private</span> <span class="token keyword">extern</span> <span class="token keyword">static</span> <span class="token return-type class-name">IntPtr</span> <span class="token function">GetDC</span><span class="token punctuation">(</span><span class="token class-name">IntPtr</span> hWnd<span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DllImport</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"gdi32.dll"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">extern</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">GetDeviceCaps</span><span class="token punctuation">(</span><span class="token class-name">IntPtr</span> hdc<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> nIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">int</span></span> DESKTOPVERTRES <span class="token operator">=</span> <span class="token number">117</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">int</span></span> DESKTOPHORZRES <span class="token operator">=</span> <span class="token number">118</span><span class="token punctuation">;</span>

        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 获取屏幕的尺寸, </span>
        <span class="token comment">/// 屏幕宽度</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token keyword">readonly</span> <span class="token keyword">static</span> <span class="token class-name"><span class="token keyword">int</span></span> width <span class="token operator">=</span> <span class="token function">GetDeviceCaps</span><span class="token punctuation">(</span><span class="token function">GetDC</span><span class="token punctuation">(</span>IntPtr<span class="token punctuation">.</span>Zero<span class="token punctuation">)</span><span class="token punctuation">,</span> DESKTOPHORZRES<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">///  屏幕高度</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token keyword">readonly</span> <span class="token keyword">static</span> <span class="token class-name"><span class="token keyword">int</span></span> height <span class="token operator">=</span> <span class="token function">GetDeviceCaps</span><span class="token punctuation">(</span><span class="token function">GetDC</span><span class="token punctuation">(</span>IntPtr<span class="token punctuation">.</span>Zero<span class="token punctuation">)</span><span class="token punctuation">,</span> DESKTOPVERTRES<span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 操作鼠标，模拟操作</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name="dwFlags"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="dx"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="dy"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="dwData"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="dwExtraInfo"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;returns&gt;&lt;/returns&gt;</span>
        <span class="token punctuation">[</span>System<span class="token punctuation">.</span>Runtime<span class="token punctuation">.</span>InteropServices<span class="token punctuation">.</span><span class="token function">DllImport</span><span class="token punctuation">(</span><span class="token string">"user32"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">extern</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">mouse_event</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> dwFlags<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> dx<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> dy<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> dwData<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> dwExtraInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 鼠标瞬移到一个坐标；绝对坐标,有悬浮提示效果；</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name="point"&gt;到达的坐标点&lt;/param&gt;</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">MouseMove</span><span class="token punctuation">(</span><span class="token class-name">POINT</span> point<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//移动鼠标到某个点，绝对坐标</span>
            <span class="token function">mouse_event</span><span class="token punctuation">(</span>MOUSEEVENTF_absolute <span class="token operator">|</span> MOUSEEVENTF_move<span class="token punctuation">,</span>
                point<span class="token punctuation">.</span>X <span class="token operator">*</span> <span class="token number">65536</span> <span class="token operator">/</span> width<span class="token punctuation">,</span>
                point<span class="token punctuation">.</span>Y <span class="token operator">*</span> <span class="token number">65536</span> <span class="token operator">/</span> height
                <span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 移动鼠标</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">int</span></span> MOUSEEVENTF_move <span class="token operator">=</span> <span class="token number">0x0001</span><span class="token punctuation">;</span>

        <span class="token comment">//模拟鼠标左键按下 </span>
        <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">int</span></span> MOUSEEVENTF_LEFTDOWN <span class="token operator">=</span> <span class="token number">0x0002</span><span class="token punctuation">;</span>

        <span class="token comment">//模拟鼠标左键抬起 </span>
        <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">int</span></span> MOUSEEVENTF_LEFTUP <span class="token operator">=</span> <span class="token number">0x0004</span><span class="token punctuation">;</span>

        <span class="token comment">//模拟鼠标右键按下 </span>
        <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">int</span></span> MOUSEEVENTF_RIGHTDOWN <span class="token operator">=</span> <span class="token number">0x0008</span><span class="token punctuation">;</span>

        <span class="token comment">//模拟鼠标右键抬起 </span>
        <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">int</span></span> MOUSEEVENTF_rightup <span class="token operator">=</span> <span class="token number">0x0010</span><span class="token punctuation">;</span>

        <span class="token comment">//模拟鼠标中键按下 </span>
        <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">int</span></span> MOUSEEVENTF_MIDDLEDOWN <span class="token operator">=</span> <span class="token number">0x0020</span><span class="token punctuation">;</span>

        <span class="token comment">//模拟鼠标中键抬起 </span>
        <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">int</span></span> MOUSEEVENTF_MIDDLEUP <span class="token operator">=</span> <span class="token number">0x0040</span><span class="token punctuation">;</span>

        <span class="token comment">//标示是否采用绝对坐标 </span>
        <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">int</span></span> MOUSEEVENTF_absolute <span class="token operator">=</span> <span class="token number">0x8000</span><span class="token punctuation">;</span>

        <span class="token comment">//模拟鼠标滚轮滚动操作，必须配合dwData参数</span>
        <span class="token keyword">public</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">int</span></span> MOUSEEVENTF_wheel <span class="token operator">=</span> <span class="token number">0x0800</span><span class="token punctuation">;</span>




        <span class="token comment">// 定义鼠标事件标志枚举</span>
        <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Flags</span></span><span class="token punctuation">]</span>
        <span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">MouseEventFlags</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token keyword">uint</span></span>
        <span class="token punctuation">{<!-- --></span>
            Move <span class="token operator">=</span> <span class="token number">0x0001</span><span class="token punctuation">,</span>
            LeftDown <span class="token operator">=</span> <span class="token number">0x0002</span><span class="token punctuation">,</span>
            LeftUp <span class="token operator">=</span> <span class="token number">0x0004</span><span class="token punctuation">,</span>
            RightDown <span class="token operator">=</span> <span class="token number">0x0008</span><span class="token punctuation">,</span>
            RightUp <span class="token operator">=</span> <span class="token number">0x0010</span><span class="token punctuation">,</span>
            MiddleDown <span class="token operator">=</span> <span class="token number">0x0020</span><span class="token punctuation">,</span>
            MiddleUp <span class="token operator">=</span> <span class="token number">0x0040</span><span class="token punctuation">,</span>
            XDown <span class="token operator">=</span> <span class="token number">0x0080</span><span class="token punctuation">,</span>
            XUp <span class="token operator">=</span> <span class="token number">0x0100</span><span class="token punctuation">,</span>
            Wheel <span class="token operator">=</span> <span class="token number">0x0800</span><span class="token punctuation">,</span>
            VirtualDesk <span class="token operator">=</span> <span class="token number">0x4000</span><span class="token punctuation">,</span>
            Absolute <span class="token operator">=</span> <span class="token number">0x8000</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 移动鼠标到一个坐标</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name="X"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="Y"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;returns&gt;&lt;/returns&gt;        </span>
        <span class="token punctuation">[</span><span class="token function">DllImport</span><span class="token punctuation">(</span><span class="token string">"user32.dll"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">extern</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">SetCursorPos</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> X<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> Y<span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token comment">// 导入user32.dll中的mouse_event函数</span>
        <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DllImport</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"user32.dll"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">extern</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">mouse_event</span><span class="token punctuation">(</span><span class="token class-name">MouseEventFlags</span> flags<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> dx<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> dy<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">uint</span></span> data<span class="token punctuation">,</span> <span class="token class-name">UIntPtr</span> extraInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 当前鼠标位置</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name="lpPoint"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;returns&gt;&lt;/returns&gt; </span>
        <span class="token punctuation">[</span><span class="token function">DllImport</span><span class="token punctuation">(</span><span class="token string">"user32.dll"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span><span class="token attribute"><span class="token target keyword">return</span><span class="token punctuation">:</span> <span class="token class-name">MarshalAs</span><span class="token attribute-arguments"><span class="token punctuation">(</span>UnmanagedType<span class="token punctuation">.</span>Bool<span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">extern</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">GetCursorPos</span><span class="token punctuation">(</span><span class="token keyword">out</span> <span class="token class-name">POINT</span> lpPoint<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 导入模拟键盘的方法</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name="bVk" &gt;按键的虚拟键值&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name= "bScan" &gt;扫描码，一般不用设置，用0代替就行&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name= "dwFlags" &gt;选项标志：0：表示按下，2：表示松开&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name= "dwExtraInfo"&gt;一般设置为0&lt;/param&gt;</span>
        <span class="token punctuation">[</span><span class="token function">DllImport</span><span class="token punctuation">(</span><span class="token string">"user32.dll"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">extern</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">keybd_event</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">byte</span></span> bVk<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">byte</span></span> bScan<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> dwFlags<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> dwExtraInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 定义POINT结构体</span>
        <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">StructLayout</span><span class="token attribute-arguments"><span class="token punctuation">(</span>LayoutKind<span class="token punctuation">.</span>Sequential<span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
        <span class="token keyword">public</span> <span class="token keyword">struct</span> <span class="token class-name">POINT</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> X<span class="token punctuation">;</span>
            <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> Y<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>



        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 点击鼠标左键</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name="x"&gt;坐标x&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="y"&gt;坐标y&lt;/param&gt;</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">MouseLeftClick</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> x<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> y<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//移动鼠标到一个坐标</span>
            <span class="token function">SetCursorPos</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">mouse_event</span><span class="token punctuation">(</span>MouseEventFlags<span class="token punctuation">.</span>LeftDown<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> UIntPtr<span class="token punctuation">.</span>Zero<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">mouse_event</span><span class="token punctuation">(</span>MouseEventFlags<span class="token punctuation">.</span>LeftUp<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> UIntPtr<span class="token punctuation">.</span>Zero<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 点击鼠标左键</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name="point"&gt;&lt;/param&gt;</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">MouseLeftClick</span><span class="token punctuation">(</span><span class="token class-name">POINT</span> point<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//移动鼠标到一个坐标</span>
            <span class="token function">SetCursorPos</span><span class="token punctuation">(</span>point<span class="token punctuation">.</span>X<span class="token punctuation">,</span> point<span class="token punctuation">.</span>Y<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">mouse_event</span><span class="token punctuation">(</span>MouseEventFlags<span class="token punctuation">.</span>LeftDown<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> UIntPtr<span class="token punctuation">.</span>Zero<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">mouse_event</span><span class="token punctuation">(</span>MouseEventFlags<span class="token punctuation">.</span>LeftUp<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> UIntPtr<span class="token punctuation">.</span>Zero<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 双击鼠标左键</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name="x"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="y"&gt;&lt;/param&gt;</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">MouseDoubleLeftClick</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> x<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> y<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">MouseLeftClick</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">MouseLeftClick</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 双击鼠标左键</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name="x"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="y"&gt;&lt;/param&gt;</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">MouseDoubleLeftClick</span><span class="token punctuation">(</span><span class="token class-name">POINT</span> pOINT<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">MouseLeftClick</span><span class="token punctuation">(</span>pOINT<span class="token punctuation">.</span>X<span class="token punctuation">,</span> pOINT<span class="token punctuation">.</span>Y<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">MouseLeftClick</span><span class="token punctuation">(</span>pOINT<span class="token punctuation">.</span>X<span class="token punctuation">,</span> pOINT<span class="token punctuation">.</span>Y<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 移动鼠标从一个点到另一个点，有移动轨迹</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name="startPoint"&gt;开始坐标&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="endPoint"&gt;停止坐标&lt;/param&gt;    </span>
        <span class="token comment">/// &lt;param name="delay"&gt;每步歇息耗时毫秒&lt;/param&gt;</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">MoveMouseSmoothly</span><span class="token punctuation">(</span><span class="token class-name">POINT</span> startPoint<span class="token punctuation">,</span> <span class="token class-name">POINT</span> endPoint<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> delay <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name"><span class="token keyword">int</span></span> currentX <span class="token operator">=</span> startPoint<span class="token punctuation">.</span>X<span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">int</span></span> currentY <span class="token operator">=</span> startPoint<span class="token punctuation">.</span>Y<span class="token punctuation">;</span>

            <span class="token class-name"><span class="token keyword">int</span></span> step <span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">int</span></span> deltaX <span class="token operator">=</span> <span class="token punctuation">(</span>endPoint<span class="token punctuation">.</span>X <span class="token operator">-</span> startPoint<span class="token punctuation">.</span>X<span class="token punctuation">)</span> <span class="token operator">/</span> step<span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">int</span></span> deltaY <span class="token operator">=</span> <span class="token punctuation">(</span>endPoint<span class="token punctuation">.</span>Y <span class="token operator">-</span> startPoint<span class="token punctuation">.</span>Y<span class="token punctuation">)</span> <span class="token operator">/</span> step<span class="token punctuation">;</span>
            OnMoveMouse<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">POINT</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> X <span class="token operator">=</span> deltaX<span class="token punctuation">,</span> Y <span class="token operator">=</span> deltaY <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">EventArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name"><span class="token keyword">int</span></span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            Task<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">try</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">while</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;=</span> step<span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        OnMoveMouse<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">POINT</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> X <span class="token operator">=</span> currentX<span class="token punctuation">,</span> Y <span class="token operator">=</span> currentY <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">EventArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                        <span class="token function">SetCursorPos</span><span class="token punctuation">(</span>currentX<span class="token punctuation">,</span> currentY<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        currentX <span class="token operator">+=</span> deltaX<span class="token punctuation">;</span>
                        currentY <span class="token operator">+=</span> deltaY<span class="token punctuation">;</span>

                        index<span class="token operator">++</span><span class="token punctuation">;</span>
                        Thread<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token function">SetCursorPos</span><span class="token punctuation">(</span>endPoint<span class="token punctuation">.</span>X<span class="token punctuation">,</span> endPoint<span class="token punctuation">.</span>Y<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>


        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 计算两点之间的距离</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name="x1"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="y1"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="x2"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="y2"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;returns&gt;&lt;/returns&gt;</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">double</span></span> <span class="token function">CalculateDistance</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> x1<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> y1<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> x2<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> y2<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name"><span class="token keyword">var</span></span> num1 <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Abs</span><span class="token punctuation">(</span>x2 <span class="token operator">-</span> x1<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">var</span></span> num2 <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Abs</span><span class="token punctuation">(</span>y2 <span class="token operator">-</span> y1<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">Sqrt</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">Pow</span><span class="token punctuation">(</span>num1<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">Pow</span><span class="token punctuation">(</span>num2<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>


        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 以恒定速度移动鼠标，可以看轨迹</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name="startX"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="startY"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="endX"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="endY"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="speedPixelsPerSecond"&gt;移动速度，多少像素/5毫秒&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="cancellationToken"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;returns&gt;&lt;/returns&gt;</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">MoveMouseAtConstantSpeedAsync</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> startX<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> startY<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> endX<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> endY<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">double</span></span> speedPixelsPerSecond <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token class-name">CancellationToken</span> cancellationToken <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name"><span class="token keyword">double</span></span> distance <span class="token operator">=</span> <span class="token function">CalculateDistance</span><span class="token punctuation">(</span>startX<span class="token punctuation">,</span> startY<span class="token punctuation">,</span> endX<span class="token punctuation">,</span> endY<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//移动总步数，毫秒</span>
            <span class="token class-name"><span class="token keyword">double</span></span> steps <span class="token operator">=</span> distance <span class="token operator">/</span> speedPixelsPerSecond<span class="token punctuation">;</span> <span class="token comment">// in seconds</span>

            <span class="token class-name"><span class="token keyword">int</span></span> currentX <span class="token operator">=</span> startX<span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">int</span></span> currentY <span class="token operator">=</span> startY<span class="token punctuation">;</span>

            <span class="token comment">//每步移动的像素</span>
            <span class="token class-name"><span class="token keyword">double</span></span> x_move <span class="token operator">=</span> <span class="token punctuation">(</span>endX <span class="token operator">-</span> startX<span class="token punctuation">)</span> <span class="token operator">/</span> steps<span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">double</span></span> y_move <span class="token operator">=</span> <span class="token punctuation">(</span>endY <span class="token operator">-</span> startY<span class="token punctuation">)</span> <span class="token operator">/</span> steps<span class="token punctuation">;</span>

            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> steps<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token comment">//if (cancellationToken.IsCancellationRequested)</span>
                <span class="token comment">//{<!-- --></span>
                <span class="token comment">//    Console.WriteLine("Mouse movement cancelled.");</span>
                <span class="token comment">//    return;</span>
                <span class="token comment">//}</span>
                currentX <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>x_move<span class="token punctuation">;</span>
                currentY <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>y_move<span class="token punctuation">;</span>

                <span class="token function">SetCursorPos</span><span class="token punctuation">(</span>currentX<span class="token punctuation">,</span> currentY<span class="token punctuation">)</span><span class="token punctuation">;</span>
                Task<span class="token punctuation">.</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">//SetCursorPos(endX, endY);</span>
        <span class="token punctuation">}</span>


        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">///  以恒定速度移动鼠标，可以看轨迹</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name="startX"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="startY"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="endX"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="endY"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="speedPixelsPerSecond"&gt;移动速度，多少像素/5毫秒&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="cancellationToken"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;returns&gt;&lt;/returns&gt;</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">MoveMouseAtConstantSpeedAsync2</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> startX<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> startY<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> endX<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> endY<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">double</span></span> speedPixelsPerSecond <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token class-name">CancellationToken</span> cancellationToken <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>


            <span class="token class-name"><span class="token keyword">int</span></span> currentX <span class="token operator">=</span> startX<span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">int</span></span> currentY <span class="token operator">=</span> startY<span class="token punctuation">;</span>

            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token comment">//当前鼠标位置</span>
                <span class="token class-name">POINT</span> startPoint<span class="token punctuation">;</span>
                <span class="token function">GetCursorPos</span><span class="token punctuation">(</span><span class="token keyword">out</span> startPoint<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token class-name"><span class="token keyword">double</span></span> distance <span class="token operator">=</span> <span class="token function">CalculateDistance</span><span class="token punctuation">(</span>startPoint<span class="token punctuation">.</span>X<span class="token punctuation">,</span> startPoint<span class="token punctuation">.</span>Y<span class="token punctuation">,</span> endX<span class="token punctuation">,</span> endY<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">//移动总步数，毫秒</span>
                <span class="token class-name"><span class="token keyword">double</span></span> steps <span class="token operator">=</span> distance <span class="token operator">/</span> speedPixelsPerSecond<span class="token punctuation">;</span>

                <span class="token comment"> 移动总共多少步</span>
                <span class="token comment">//double stepsX = Math.Abs(endX - startPoint.X) / speedPixelsPerSecond;</span>
                <span class="token comment">//double stepsY = Math.Abs(endY - startPoint.Y) / speedPixelsPerSecond;</span>

                <span class="token comment">//每步移动像素</span>
                <span class="token class-name"><span class="token keyword">double</span></span> xMove <span class="token operator">=</span> <span class="token punctuation">(</span>endX <span class="token operator">-</span> startPoint<span class="token punctuation">.</span>X<span class="token punctuation">)</span> <span class="token operator">/</span> steps<span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">double</span></span> yMove <span class="token operator">=</span> <span class="token punctuation">(</span>endY <span class="token operator">-</span> startPoint<span class="token punctuation">.</span>Y<span class="token punctuation">)</span> <span class="token operator">/</span> steps<span class="token punctuation">;</span>

                currentX <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>xMove<span class="token punctuation">;</span>
                currentY <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>yMove<span class="token punctuation">;</span>

                <span class="token function">SetCursorPos</span><span class="token punctuation">(</span>currentX<span class="token punctuation">,</span> currentY<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span>currentX <span class="token operator">==</span> endX <span class="token operator">&amp;&amp;</span> currentY <span class="token operator">==</span> endY
                    <span class="token operator">||</span> <span class="token punctuation">(</span>
                            Math<span class="token punctuation">.</span><span class="token function">Abs</span><span class="token punctuation">(</span>currentX <span class="token operator">-</span> endX<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">8</span> <span class="token operator">&amp;&amp;</span> Math<span class="token punctuation">.</span><span class="token function">Abs</span><span class="token punctuation">(</span>currentY <span class="token operator">-</span> endY<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">8</span>
                        <span class="token punctuation">)</span>
                    <span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                Task<span class="token punctuation">.</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token function">SetCursorPos</span><span class="token punctuation">(</span>endX<span class="token punctuation">,</span> endY<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// （推荐）以恒定速度移动鼠标，可以看轨迹；鼠标悬浮可以看到提示；</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name="startX"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="startY"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="endX"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="endY"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="speedPixelsPerSecond"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="cancellationToken"&gt;&lt;/param&gt;</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">MoveMouseAtConstantSpeed3</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> startX<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> startY<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> endX<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> endY<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">double</span></span> speedPixelsPerSecond <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token class-name">CancellationToken</span> cancellationToken <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name"><span class="token keyword">int</span></span> currentX <span class="token operator">=</span> startX<span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">int</span></span> currentY <span class="token operator">=</span> startY<span class="token punctuation">;</span>

            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token comment">//当前鼠标位置</span>
                <span class="token class-name">POINT</span> startPoint<span class="token punctuation">;</span>
                <span class="token function">GetCursorPos</span><span class="token punctuation">(</span><span class="token keyword">out</span> startPoint<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token class-name"><span class="token keyword">double</span></span> distance <span class="token operator">=</span> <span class="token function">CalculateDistance</span><span class="token punctuation">(</span>startPoint<span class="token punctuation">.</span>X<span class="token punctuation">,</span> startPoint<span class="token punctuation">.</span>Y<span class="token punctuation">,</span> endX<span class="token punctuation">,</span> endY<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">//移动总步数，毫秒</span>
                <span class="token class-name"><span class="token keyword">double</span></span> steps <span class="token operator">=</span> distance <span class="token operator">/</span> speedPixelsPerSecond<span class="token punctuation">;</span>

                <span class="token comment"> 移动总共多少步</span>
                <span class="token comment">//double stepsX = Math.Abs(endX - startPoint.X) / speedPixelsPerSecond;</span>
                <span class="token comment">//double stepsY = Math.Abs(endY - startPoint.Y) / speedPixelsPerSecond;</span>

                <span class="token comment">//每步移动像素</span>
                <span class="token class-name"><span class="token keyword">double</span></span> xMove <span class="token operator">=</span> <span class="token punctuation">(</span>endX <span class="token operator">-</span> startPoint<span class="token punctuation">.</span>X<span class="token punctuation">)</span> <span class="token operator">/</span> steps<span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">double</span></span> yMove <span class="token operator">=</span> <span class="token punctuation">(</span>endY <span class="token operator">-</span> startPoint<span class="token punctuation">.</span>Y<span class="token punctuation">)</span> <span class="token operator">/</span> steps<span class="token punctuation">;</span>

                currentX <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>xMove<span class="token punctuation">;</span>
                currentY <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>yMove<span class="token punctuation">;</span>

                <span class="token function">MouseMove</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">POINT</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> X <span class="token operator">=</span> currentX<span class="token punctuation">,</span> Y <span class="token operator">=</span> currentY <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span>currentX <span class="token operator">==</span> endX <span class="token operator">&amp;&amp;</span> currentY <span class="token operator">==</span> endY
                    <span class="token operator">||</span> <span class="token punctuation">(</span>
                            Math<span class="token punctuation">.</span><span class="token function">Abs</span><span class="token punctuation">(</span>currentX <span class="token operator">-</span> endX<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> speedPixelsPerSecond<span class="token operator">*</span><span class="token number">1</span> 
                            <span class="token operator">&amp;&amp;</span> Math<span class="token punctuation">.</span><span class="token function">Abs</span><span class="token punctuation">(</span>currentY <span class="token operator">-</span> endY<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> speedPixelsPerSecond <span class="token operator">*</span> <span class="token number">1</span>
                        <span class="token punctuation">)</span>
                    <span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                Task<span class="token punctuation">.</span><span class="token function">Delay</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token function">MouseMove</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">POINT</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> X <span class="token operator">=</span> endX<span class="token punctuation">,</span> Y <span class="token operator">=</span> endY <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f753031313531313038362f:61727469636c652f64657461696c732f313436313139313637" class_="artid" style="display:none">
 </p>
</div>


