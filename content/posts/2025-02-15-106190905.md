---
layout: post
title: "Python3中的StringIO"
date: 2025-02-15 20:04:29 +0800
description: "I am using Python 3.2.1 and I can't import the Str"
keywords: "python3 cstringio"
categories: ['未分类']
tags: ['X', 'Python', 'Io']
artid: "106190905"
image:
  path: https://api.vvhan.com/api/bing?rand=sj&artid=106190905
  alt: "Python3中的StringIO"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=106190905
featuredImagePreview: https://bing.ee123.net/img/rand?artid=106190905
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Python3中的StringIO
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     本文翻译自：
     <a href="https://oldbug.net/q/nzUu/StringIO-in-Python3" rel="nofollow">
      StringIO in Python3
     </a>
    </p>
    <p>
     <i>
      I am using Python 3.2.1 and I can't import the
      <code>
       StringIO
      </code>
      module.
     </i>
     <b>
      我正在使用Python 3.2.1，但无法导入
      <code>
       StringIO
      </code>
      模块。
     </b>
     <i>
      I use
      <code>
       io.StringIO
      </code>
      and it works, but I can't use it with
      <code>
       numpy
      </code>
      's
      <code>
       genfromtxt
      </code>
      like this:
     </i>
     <b>
      我使用
      <code>
       io.StringIO
      </code>
      并且可以工作，但是不能将其与
      <code>
       numpy
      </code>
      的
      <code>
       genfromtxt
      </code>
      一起使用，如下所示：
     </b>
    </p>
    <pre><code>x="1 3\n 4.5 8"        
numpy.genfromtxt(io.StringIO(x))
</code></pre>
    <p>
     <i>
      I get the following error:
     </i>
     <b>
      我收到以下错误：
     </b>
    </p>
    <pre><code>TypeError: Can't convert 'bytes' object to str implicitly  
</code></pre>
    <p>
     <i>
      and when I write
      <code>
       import StringIO
      </code>
      it says
     </i>
     <b>
      当我写
      <code>
       import StringIO
      </code>
      时说
     </b>
    </p>
    <pre><code>ImportError: No module named 'StringIO'
</code></pre>
    <hr/>
    <h4>
     #1楼
    </h4>
    <p>
     参考：
     <a href="https://stackoom.com/question/nzUu/Python-%E4%B8%AD%E7%9A%84StringIO" rel="nofollow">
      https://stackoom.com/question/nzUu/Python-中的StringIO
     </a>
    </p>
    <hr/>
    <h4>
     #2楼
    </h4>
    <p>
     <i>
      On Python 3
      <code>
       numpy.genfromtxt
      </code>
      expects a bytes stream.
     </i>
     <b>
      在Python 3上，
      <code>
       numpy.genfromtxt
      </code>
      需要字节流。
     </b>
     <i>
      Use the following:
     </i>
     <b>
      使用以下内容：
     </b>
    </p>
    <pre><code>numpy.genfromtxt(io.BytesIO(x.encode()))
</code></pre>
    <hr/>
    <h4>
     #3楼
    </h4>
    <blockquote>
     <p>
      <i>
       when i write import StringIO it says there is no such module.
      </i>
      <b>
       当我写导入StringIO时，它说没有这样的模块。
      </b>
     </p>
    </blockquote>
    <p>
     <i>
      From
      <a href="http://docs.python.org/3.0/whatsnew/3.0.html" rel="nofollow">
       What's New In Python 3.0
      </a>
      :
     </i>
     <b>
      从
      <a href="http://docs.python.org/3.0/whatsnew/3.0.html" rel="nofollow">
       Python 3.0的新功能开始
      </a>
      ：
     </b>
    </p>
    <blockquote>
     <p>
      <i>
       The
       <code>
        StringIO
       </code>
       and
       <code>
        cStringIO
       </code>
       modules are gone.
      </i>
      <b>
       <code>
        StringIO
       </code>
       和
       <code>
        cStringIO
       </code>
       模块不见了。
      </b>
      <i>
       Instead, import the
       <code>
        io
       </code>
       module and use
       <code>
        io.StringIO
       </code>
       or
       <code>
        io.BytesIO
       </code>
       for text and data respectively.
      </i>
      <b>
       而是导入
       <code>
        io
       </code>
       模块，并将
       <code>
        io.StringIO
       </code>
       或
       <code>
        io.BytesIO
       </code>
       分别用于文本和数据。
      </b>
     </p>
    </blockquote>
    <p>
     <i>
      .
     </i>
     <b>
      。
     </b>
    </p>
    <hr/>
    <p>
     <i>
      A possibly useful method of fixing some Python 2 code to also work in Python 3 (caveat emptor):
     </i>
     <b>
      修复一些Python 2代码以使其在Python 3（caveat emptor）中工作的可能有用的方法：
     </b>
    </p>
    <pre><code>try:
    from StringIO import StringIO ## for Python 2
except ImportError:
    from io import StringIO ## for Python 3
</code></pre>
    <blockquote>
     <p>
      <i>
       <em>
        Note: This example may be tangential to the main issue of the question and is included only as something to consider when generically addressing the missing
        <code>
         StringIO
        </code>
        module.
       </em>
      </i>
      <b>
       <em>
        注意：此示例可能与问题的主要内容相切，仅作为一般性地解决缺少的
        <code>
         StringIO
        </code>
        模块时要考虑的
        <code>
         StringIO
        </code>
        。
       </em>
      </b>
      <i>
       For a more direct solution the the message
       <code>
        TypeError: Can't convert 'bytes' object to str implicitly
       </code>
       , see
       <a href="https://stackoverflow.com/a/11970414/86967" rel="nofollow">
        this answer
       </a>
       .
      </i>
      <b>
       要获得更直接的解决方案，请输入消息
       <code>
        TypeError: Can't convert 'bytes' object to str implicitly
       </code>
       ，请参见此
       <a href="https://stackoverflow.com/a/11970414/86967" rel="nofollow">
        答案
       </a>
       。
      </b>
     </p>
    </blockquote>
    <hr/>
    <h4>
     #4楼
    </h4>
    <p>
     就我而言，我使用了：
    </p>
    <pre><code>from io import StringIO
</code></pre>
    <hr/>
    <h4>
     #5楼
    </h4>
    <p>
     <i>
      Thank you OP for your question, and Roman for your answer.
     </i>
     <b>
      谢谢OP的问题，以及Roman的回答。
     </b>
     <i>
      I had to search a bit to find this;
     </i>
     <b>
      我不得不花点时间找到它。
     </b>
     <i>
      I hope the following helps others.
     </i>
     <b>
      希望以下内容对他人有所帮助。
     </b>
    </p>
    <p>
     <i>
      <strong>
       Python 2.7
      </strong>
     </i>
     <b>
      <strong>
       Python 2.7
      </strong>
     </b>
    </p>
    <p>
     <i>
      See:
      <a href="https://docs.scipy.org/doc/numpy/user/basics.io.genfromtxt.html" rel="nofollow">
       https://docs.scipy.org/doc/numpy/user/basics.io.genfromtxt.html
      </a>
     </i>
     <b>
      请参阅：
      <a href="https://docs.scipy.org/doc/numpy/user/basics.io.genfromtxt.html" rel="nofollow">
       https
      </a>
      ：
      <a href="https://docs.scipy.org/doc/numpy/user/basics.io.genfromtxt.html" rel="nofollow">
       //docs.scipy.org/doc/numpy/user/basics.io.genfromtxt.html
      </a>
     </b>
    </p>
    <pre><code>import numpy as np
from StringIO import StringIO

data = "1, abc , 2\n 3, xxx, 4"

print type(data)
"""
&lt;type 'str'&gt;
"""

print '\n', np.genfromtxt(StringIO(data), delimiter=",", dtype="|S3", autostrip=True)
"""
[['1' 'abc' '2']
 ['3' 'xxx' '4']]
"""

print '\n', type(data)
"""
&lt;type 'str'&gt;
"""

print '\n', np.genfromtxt(StringIO(data), delimiter=",", autostrip=True)
"""
[[1.  nan   2.]
 [  3.  nan   4.]]
"""
</code></pre>
<p>
<i>
<strong>
Python 3.5:
</strong>
</i>
<b>
<strong>
Python 3.5：
</strong>
</b>
</p>
<pre><code>import numpy as np
from io import StringIO
import io

data = "1, abc , 2\n 3, xxx, 4"
#print(data)
"""
1, abc , 2
3, xxx, 4
"""

#print(type(data))
"""
&lt;class 'str'&gt;
"""

#np.genfromtxt(StringIO(data), delimiter=",", autostrip=True)

# TypeError: Can't convert 'bytes' object to str implicitly

print('\n')
print(np.genfromtxt(io.BytesIO(data.encode()), delimiter=",", dtype="|S3", autostrip=True))
"""
[[b'1' b'abc' b'2']
 [b'3' b'xxx' b'4']]
"""

print('\n')
print(np.genfromtxt(io.BytesIO(data.encode()), delimiter=",", autostrip=True))
"""
[[1.  nan   2.]
 [  3.  nan   4.]]
"""
</code></pre>
<p>
<i>
<strong>
Aside:
</strong>
</i>
<b>
<strong>
在旁边：
</strong>
</b>
</p>
<p>
<i>
dtype="|Sx", where x = any of { 1, 2, 3, ...}:
</i>
<b>
dtype =“ | Sx”，其中 x = {1，2，3，...}中的任何一个：
</b>
</p>
<p>
<i>
<a href="https://stackoverflow.com/questions/14790130/dtypes-difference-between-s1-and-s2-in-python" rel="nofollow">
dtypes.
</a>
</i>
<b>
<a href="https://stackoverflow.com/questions/14790130/dtypes-difference-between-s1-and-s2-in-python" rel="nofollow">
dtypes。
</a>
</b>
<i>
<a href="https://stackoverflow.com/questions/14790130/dtypes-difference-between-s1-and-s2-in-python" rel="nofollow">
Difference between S1 and S2 in Python
</a>
</i>
<b>
<a href="https://stackoverflow.com/questions/14790130/dtypes-difference-between-s1-and-s2-in-python" rel="nofollow">
Python 中 S1 和 S2 之间的区别
</a>
</b>
</p>
<p>
<i>
"The |S1 and |S2 strings are data type descriptors; the first means the array holds strings of length 1, the second of length 2. ..."
</i>
<b>
“ | S1 和| S2 字符串是数据类型描述符；第一个表示数组保存长度为 1 的字符串，第二个表示长度为 2...。”
</b>
</p>
<hr/>
<h4>
#6 楼
</h4>
<p>
<i>
You can use the
<a href="https://pythonhosted.org/six/#six.StringIO" rel="nofollow">
StringIO
</a>
from the
<a href="https://pythonhosted.org/six/" rel="nofollow">
six
</a>
module:
</i>
<b>
您可以从
<a href="https://pythonhosted.org/six/" rel="nofollow">
六个
</a>
模块中使用
<a href="https://pythonhosted.org/six/#six.StringIO" rel="nofollow">
StringIO
</a>
：
</b>
</p>
<pre><code>import six
import numpy

x = "1 3\n 4.5 8"
numpy.genfromtxt(six.StringIO(x))
</code></pre>

   </div>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f7733363638303133302f:61727469636c652f64657461696c732f313036313930393035" class_="artid" style="display:none">
 </p>
</div>
