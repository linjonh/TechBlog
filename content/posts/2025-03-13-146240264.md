---
layout: post
title: "django自动添加接口文档"
date: 2025-03-13 19:29:17 +0800
description: "•推荐方案: 使用drf-yasg，功能更强大且维护活跃。•核心步骤安装库并配置和urls.py。通过装饰器或注释为视图添加接口描述。访问/swagger/查看文档。•注意事项• 确保视图继承自 DRF 的基类（如APIView• 若接口涉及认证（如 JWT），需在文档中配置安全策略。"
keywords: "django自动添加接口文档"
categories: ['Django']
tags: ['数据库', 'Sqlite', 'Django']
artid: "146240264"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146240264
    alt: "django自动添加接口文档"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146240264
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146240264
cover: https://bing.ee123.net/img/rand?artid=146240264
image: https://bing.ee123.net/img/rand?artid=146240264
img: https://bing.ee123.net/img/rand?artid=146240264
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     django自动添加接口文档
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-tomorrow-night" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     以下是使用 Django 和
     <strong>
      django-rest-swagger
     </strong>
     （或替代方案
     <strong>
      drf-yasg
     </strong>
     ）生成 API 接口文档的详细指南。由于
     <code>
      django-rest-swagger
     </code>
     已停止维护，推荐使用
     <strong>
      drf-yasg
     </strong>
     （支持 Swagger 2.0 和 OpenAPI 3.0），但两种方法均会说明：
    </p>
    <hr/>
    <h4>
     <a id="_6">
     </a>
     一、方案选择与安装
    </h4>
    <h5>
     <a id="1__7">
     </a>
     1.
     <strong>
      方案对比
     </strong>
    </h5>
    <table>
     <thead>
      <tr>
       <th>
        库名
       </th>
       <th>
        维护状态
       </th>
       <th>
        支持规范
       </th>
       <th>
        功能特点
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <code>
         django-rest-swagger
        </code>
       </td>
       <td>
        已弃用
       </td>
       <td>
        Swagger 2.0
       </td>
       <td>
        旧项目兼容，文档生成简单
       </td>
      </tr>
      <tr>
       <td>
        <code>
         drf-yasg
        </code>
       </td>
       <td>
        活跃维护
       </td>
       <td>
        OpenAPI 3.0
       </td>
       <td>
        功能强大，支持更详细的配置
       </td>
      </tr>
     </tbody>
    </table>
    <h5>
     <a id="2_drfyasg_13">
     </a>
     2.
     <strong>
      安装推荐库（drf-yasg）
     </strong>
    </h5>
    <pre><code class="prism language-bash"><span class="token comment"># 安装 drf-yasg（推荐）</span>
pip <span class="token function">install</span> drf-yasg

<span class="token comment"># 或安装旧版 django-rest-swagger（不推荐）</span>
<span class="token comment"># pip install django-rest-swagger==2.2.0</span>
</code></pre>
    <hr/>
    <h4>
     <a id="_drfyasg__24">
     </a>
     二、配置
     <code>
      drf-yasg
     </code>
     生成接口文档（推荐）
    </h4>
    <h5>
     <a id="1__settingspy_25">
     </a>
     1.
     <strong>
      配置
      <code>
       settings.py
      </code>
     </strong>
    </h5>
    <pre><code class="prism language-python"><span class="token comment"># settings.py</span>
INSTALLED_APPS <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token string">'rest_framework'</span><span class="token punctuation">,</span>
    <span class="token string">'drf_yasg'</span><span class="token punctuation">,</span>  <span class="token comment"># 添加 drf-yasg</span>
<span class="token punctuation">]</span>

<span class="token comment"># 可选：配置 DRF 的默认权限（按需设置）</span>
REST_FRAMEWORK <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'DEFAULT_PERMISSION_CLASSES'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token string">'rest_framework.permissions.AllowAny'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
    <h5>
     <a id="2__URL__42">
     </a>
     2.
     <strong>
      配置 URL 路由
     </strong>
    </h5>
    <pre><code class="prism language-python"><span class="token comment"># urls.py</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path<span class="token punctuation">,</span> include
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> permissions
<span class="token keyword">from</span> drf_yasg<span class="token punctuation">.</span>views <span class="token keyword">import</span> get_schema_view
<span class="token keyword">from</span> drf_yasg <span class="token keyword">import</span> openapi

<span class="token comment"># 定义 Swagger 文档视图</span>
schema_view <span class="token operator">=</span> get_schema_view<span class="token punctuation">(</span>
    openapi<span class="token punctuation">.</span>Info<span class="token punctuation">(</span>
        title<span class="token operator">=</span><span class="token string">"API 文档"</span><span class="token punctuation">,</span>
        default_version<span class="token operator">=</span><span class="token string">'v1'</span><span class="token punctuation">,</span>
        description<span class="token operator">=</span><span class="token string">"项目接口文档"</span><span class="token punctuation">,</span>
        terms_of_service<span class="token operator">=</span><span class="token string">"https://example.com/terms/"</span><span class="token punctuation">,</span>
        contact<span class="token operator">=</span>openapi<span class="token punctuation">.</span>Contact<span class="token punctuation">(</span>email<span class="token operator">=</span><span class="token string">"contact@example.com"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        license<span class="token operator">=</span>openapi<span class="token punctuation">.</span>License<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"MIT License"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    public<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    permission_classes<span class="token operator">=</span><span class="token punctuation">(</span>permissions<span class="token punctuation">.</span>AllowAny<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 控制文档访问权限</span>
<span class="token punctuation">)</span>

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token comment"># Swagger 文档路由</span>
    path<span class="token punctuation">(</span><span class="token string">'swagger/'</span><span class="token punctuation">,</span> schema_view<span class="token punctuation">.</span>with_ui<span class="token punctuation">(</span><span class="token string">'swagger'</span><span class="token punctuation">,</span> cache_timeout<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'swagger-ui'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'redoc/'</span><span class="token punctuation">,</span> schema_view<span class="token punctuation">.</span>with_ui<span class="token punctuation">(</span><span class="token string">'redoc'</span><span class="token punctuation">,</span> cache_timeout<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'redoc'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    
    <span class="token comment"># 其他 API 路由</span>
    path<span class="token punctuation">(</span><span class="token string">'api/'</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token string">'myapp.urls'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre>
    <h5>
     <a id="3__74">
     </a>
     3.
     <strong>
      为视图添加文档注释
     </strong>
    </h5>
    <p>
     在视图（如
     <code>
      views.py
     </code>
     ）中使用装饰器或 YAML 注释描述接口：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">from</span> drf_yasg<span class="token punctuation">.</span>utils <span class="token keyword">import</span> swagger_auto_schema
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>views <span class="token keyword">import</span> APIView
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response

<span class="token keyword">class</span> <span class="token class-name">UserListView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token decorator annotation punctuation">@swagger_auto_schema</span><span class="token punctuation">(</span>
        operation_description<span class="token operator">=</span><span class="token string">"获取用户列表"</span><span class="token punctuation">,</span>
        manual_parameters<span class="token operator">=</span><span class="token punctuation">[</span>
            openapi<span class="token punctuation">.</span>Parameter<span class="token punctuation">(</span>
                <span class="token string">'page'</span><span class="token punctuation">,</span> 
                openapi<span class="token punctuation">.</span>IN_QUERY<span class="token punctuation">,</span> 
                description<span class="token operator">=</span><span class="token string">"页码"</span><span class="token punctuation">,</span> 
                <span class="token builtin">type</span><span class="token operator">=</span>openapi<span class="token punctuation">.</span>TYPE_INTEGER
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        responses<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token number">200</span><span class="token punctuation">:</span> <span class="token string">'成功获取用户列表'</span><span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"users"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <h5>
     <a id="4__98">
     </a>
     4.
     <strong>
      访问文档
     </strong>
    </h5>
    <p>
     •
     <strong>
      Swagger UI
     </strong>
     :
     <code>
      http://localhost:8000/swagger/
     </code>
     <br/>
     •
     <strong>
      ReDoc
     </strong>
     :
     <code>
      http://localhost:8000/redoc/
     </code>
    </p>
    <hr/>
    <h4>
     <a id="_djangorestswagger_104">
     </a>
     三、使用旧版
     <code>
      django-rest-swagger
     </code>
     （不推荐）
    </h4>
    <h5>
     <a id="1__settingspy_105">
     </a>
     1.
     <strong>
      配置
      <code>
       settings.py
      </code>
     </strong>
    </h5>
    <pre><code class="prism language-python"><span class="token comment"># settings.py</span>
INSTALLED_APPS <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token string">'rest_framework'</span><span class="token punctuation">,</span>
    <span class="token string">'rest_framework_swagger'</span><span class="token punctuation">,</span>  <span class="token comment"># 添加 django-rest-swagger</span>
<span class="token punctuation">]</span>

<span class="token comment"># 配置 Swagger 设置</span>
SWAGGER_SETTINGS <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'SECURITY_DEFINITIONS'</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'basic'</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token string">'basic'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">'USE_SESSION_AUTH'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span>  <span class="token comment"># 是否启用 Django 的 Session 认证</span>
<span class="token punctuation">}</span>
</code></pre>
    <h5>
     <a id="2__URL__125">
     </a>
     2.
     <strong>
      配置 URL 路由
     </strong>
    </h5>
    <pre><code class="prism language-python"><span class="token comment"># urls.py</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>schemas <span class="token keyword">import</span> get_schema_view
<span class="token keyword">from</span> rest_framework_swagger<span class="token punctuation">.</span>renderers <span class="token keyword">import</span> SwaggerUIRenderer<span class="token punctuation">,</span> OpenAPIRenderer

schema_view <span class="token operator">=</span> get_schema_view<span class="token punctuation">(</span>
    title<span class="token operator">=</span><span class="token string">"API 文档"</span><span class="token punctuation">,</span>
    renderer_classes<span class="token operator">=</span><span class="token punctuation">[</span>OpenAPIRenderer<span class="token punctuation">,</span> SwaggerUIRenderer<span class="token punctuation">]</span>
<span class="token punctuation">)</span>

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">'swagger/'</span><span class="token punctuation">,</span> schema_view<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'swagger'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'api/'</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token string">'myapp.urls'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre>
    <h5>
     <a id="3__143">
     </a>
     3.
     <strong>
      为视图添加注释
     </strong>
    </h5>
    <p>
     在视图类或函数中使用文档字符串（YAML 格式）：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">UserListView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        获取用户列表

        ---
        parameters:
            - name: page
              in: query
              type: integer
              required: false
              description: 页码
        responses:
            200:
                description: 成功返回用户列表
        """</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"users"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <h5>
     <a id="4__165">
     </a>
     4.
     <strong>
      访问文档
     </strong>
    </h5>
    <p>
     • 访问
     <code>
      http://localhost:8000/swagger/
     </code>
    </p>
    <hr/>
    <h4>
     <a id="_170">
     </a>
     四、常见问题与优化
    </h4>
    <h5>
     <a id="1__171">
     </a>
     1.
     <strong>
      文档不显示接口
     </strong>
    </h5>
    <p>
     •
     <strong>
      原因
     </strong>
     : 视图未继承
     <code>
      APIView
     </code>
     或未配置路由。
     <br/>
     •
     <strong>
      解决
     </strong>
     : 确保所有接口使用 DRF 的视图类（如
     <code>
      APIView
     </code>
     ,
     <code>
      ViewSet
     </code>
     ），并正确注册到路由。
    </p>
    <h5>
     <a id="2__175">
     </a>
     2.
     <strong>
      认证配置
     </strong>
    </h5>
    <p>
     •
     <strong>
      场景
     </strong>
     : 需要登录才能访问 Swagger 文档。
     <br/>
     •
     <strong>
      配置
     </strong>
     （在
     <code>
      settings.py
     </code>
     中）：
    </p>
    <pre><code class="prism language-python">SWAGGER_SETTINGS <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'LOGIN_URL'</span><span class="token punctuation">:</span> <span class="token string">'/admin/login/'</span><span class="token punctuation">,</span>  <span class="token comment"># 登录地址</span>
    <span class="token string">'LOGOUT_URL'</span><span class="token punctuation">:</span> <span class="token string">'/admin/logout/'</span><span class="token punctuation">,</span>
    <span class="token string">'USE_SESSION_AUTH'</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre>
    <h5>
     <a id="3__186">
     </a>
     3.
     <strong>
      自定义文档样式
     </strong>
    </h5>
    <p>
     •
     <strong>
      方法
     </strong>
     : 覆盖默认模板或使用
     <code>
      drf-yasg
     </code>
     的扩展参数：
    </p>
    <pre><code class="prism language-python">schema_view <span class="token operator">=</span> get_schema_view<span class="token punctuation">(</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    patterns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># 指定要包含的路由</span>
    generator_class<span class="token operator">=</span><span class="token string">'myapp.schemas.CustomSchemaGenerator'</span><span class="token punctuation">,</span>  <span class="token comment"># 自定义生成器</span>
<span class="token punctuation">)</span>
</code></pre>
    <h5>
     <a id="4__196">
     </a>
     4.
     <strong>
      隐藏特定接口
     </strong>
    </h5>
    <p>
     •
     <strong>
      使用
      <code>
       drf_yasg
      </code>
     </strong>
     :
    </p>
    <pre><code class="prism language-python"><span class="token decorator annotation punctuation">@swagger_auto_schema</span><span class="token punctuation">(</span>auto_schema<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">my_view</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre>
    <hr/>
    <h4>
     <a id="_206">
     </a>
     五、总结
    </h4>
    <p>
     •
     <strong>
      推荐方案
     </strong>
     : 使用
     <strong>
      drf-yasg
     </strong>
     ，功能更强大且维护活跃。
     <br/>
     •
     <strong>
      核心步骤
     </strong>
     ：
    </p>
    <ol>
     <li>
      安装库并配置
      <code>
       settings.py
      </code>
      和
      <code>
       urls.py
      </code>
      。
     </li>
     <li>
      通过装饰器或注释为视图添加接口描述。
     </li>
     <li>
      访问
      <code>
       /swagger/
      </code>
      查看文档。
      <br/>
      •
      <strong>
       注意事项
      </strong>
      ：
      <br/>
      • 确保视图继承自 DRF 的基类（如
      <code>
       APIView
      </code>
      ）。
      <br/>
      • 若接口涉及认证（如 JWT），需在文档中配置安全策略。
     </li>
    </ol>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470:733a2f2f626c6f672e6373646e2e6e65742f4c43593133332f:61727469636c652f64657461696c732f313436323430323634" class_="artid" style="display:none">
 </p>
</div>


