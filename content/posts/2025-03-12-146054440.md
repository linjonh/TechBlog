---
layout: post
title: "Linux系统进程优先级进程间的权力游戏"
date: 2025-03-12 12:07:43 +0800
description: "进程优先级调度是是指操作系统，根据进程的优先级来分配CPU资源的一种调度算法。系统会为每个进程分配一个优先级，优先级高的进程会优先获取CPU资源，从而更好地决定进程执行顺序。这种机制极大程度上提高了，系统的运行效率。"
keywords: "【Linux系统】进程优先级：进程间的权力游戏"
categories: ['未分类']
tags: ['运维', '游戏', 'Linux']
artid: "146054440"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146054440
    alt: "Linux系统进程优先级进程间的权力游戏"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146054440
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146054440
cover: https://bing.ee123.net/img/rand?artid=146054440
image: https://bing.ee123.net/img/rand?artid=146054440
img: https://bing.ee123.net/img/rand?artid=146054440
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     【Linux系统】进程优先级：进程间的权力游戏
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="Linux_0">
     </a>
     Linux系列
    </h2>
    <hr/>
    <p>
    </p>
    <p>
    </p>
    <hr/>
    <h2>
     <a id="_10">
     </a>
     前言
    </h2>
    <p>
     进程优先级调度是是指操作系统，根据进程的优先级来分配
     <code>
      CPU
     </code>
     资源的一种调度算法。系统会为每个进程分配一个优先级，优先级高的进程会优先获取
     <code>
      CPU
     </code>
     资源，从而更好地决定进程执行顺序。这种机制极大程度上提高了，系统的运行效率。
    </p>
    <h2>
     <a id="_14">
     </a>
     一、优先级的概念
    </h2>
    <p>
     首先，要知道这几个概念：
     <br/>
     1、什么是优先级？
     <br/>
     优先级就是对于系统资源，谁先访问，谁后访问的问题。
     <br/>
     2、为什么要有优先级？
     <br/>
     因为对于一个多任务的操作系统来说，
     <code>
      CPU
     </code>
     资源有限，进程是多个的，注定了进程之间是竞争关系，而如果一个进程长时间得不到
     <code>
      CPU
     </code>
     资源，该进程就一直得不到推进（就相当于某个程一直无法启动），我们称这个为
     <strong>
      进程饥饿
     </strong>
     问题，而操作系统为了规避这种情况，保证进程间的良性竞争，就给每个进程分配了对应的优先级（号码牌），进程就拿着自己的优先级去排队了。
     <br/>
     总结一下：
    </p>
    <ul>
     <li>
      优先级：对
      <code>
       CPU
      </code>
      资源访问优先的问题
     </li>
     <li>
      存在原因：
      <code>
       CPU
      </code>
      的资源不足
     </li>
     <li>
      优先级高的比优先级低的更早被调度，能够确保关键任务及时完成，同时提高系统的运行效率
     </li>
    </ul>
    <h2>
     <a id="_26">
     </a>
     二、查看、修改优先级
    </h2>
    <h3>
     <a id="21_27">
     </a>
     2.1、查看优先级
    </h3>
    <p>
     <code>
      随便写的程序，用来演示
     </code>
    </p>
    <pre><code class="prism language-c">  <span class="token number">1</span> #include<span class="token operator">&lt;</span>stdio<span class="token punctuation">.</span>h<span class="token operator">&gt;</span>  
  <span class="token number">2</span> #include<span class="token operator">&lt;</span>unistd<span class="token punctuation">.</span>h<span class="token operator">&gt;</span>  
  <span class="token number">3</span> <span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
  <span class="token number">4</span> <span class="token punctuation">{<!-- --></span>
  <span class="token number">5</span>   <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token number">6</span>   <span class="token punctuation">{<!-- --></span>
  <span class="token number">7</span>                                                               
  <span class="token number">8</span>   <span class="token punctuation">}</span>
  <span class="token number">9</span>   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
 <span class="token number">10</span> <span class="token punctuation">}</span>        
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/5feeef5f233e4378b04c5c9b88c784ac.png"/>
    </p>
    <p>
     在Linux系统中，
     <code>
      PRI（Priority）
     </code>
     和
     <code>
      NI（Nice）
     </code>
     两个参数共同决定了进程的优先级，影响进程的调度顺序。
     <br/>
     可以通过
     <code>
      ps指令
     </code>
     来查看具体信息。
     <br/>
     <strong>
      PRI（Priority）
     </strong>
     <br/>
     <code>
      PRI
     </code>
     是进程的最终优先级，由内核通过计算得到，直接影响调度器为进程分配
     <code>
      CPU
     </code>
     资源的顺序。
     <br/>
     <code>
      优先级数值越小，优先级月高！！
     </code>
     <br/>
     <strong>
      PRI的范围
     </strong>
    </p>
    <ul>
     <li>
      实时任务：范围为0到99
     </li>
     <li>
      普通任务：范围为100到139
     </li>
    </ul>
    <blockquote>
     <p>
      <strong>
       实时任务：是指必须在规定时间内完成处理，并对响应时间和处理结果的准确性有严格要求的。
       <br/>
       普通任务：是指对时间要求宽松没有严格时间限制的任务。
      </strong>
     </p>
    </blockquote>
    <p>
     <strong>
      PRI的计算公式
     </strong>
     <br/>
     <code>
      PRI(new)=PRI(old)+NI（nice）
     </code>
     <br/>
     其中：
    </p>
    <ul>
     <li>
      <code>
       PRI(old)
      </code>
      :是进程原来优先级（其实对我们写的程序来说固定为80）
     </li>
     <li>
      <code>
       NI
      </code>
      ：是进程的
      <code>
       nice
      </code>
      值，我们可以通过设置不同的
      <code>
       nice
      </code>
      达到改变进程优先级的目的，但是操作系统规定
      <code>
       nice
      </code>
      值的范围必须在【-20，19】
     </li>
    </ul>
    <p>
     对于我们执行的程序，优先级一般初始为80。
    </p>
    <h3>
     <a id="22_66">
     </a>
     2.2、修改指令
    </h3>
    <p>
     <strong>
      NI(Nice)
     </strong>
     <br/>
     <code>
      NI
     </code>
     值是用户空间设置的静态优先级，默认值为0，用户可以通过对
     <code>
      NI
     </code>
     赋予不同的值，来达到修改优先级的目的，帮助我们对一些比较重要的程序，优先分配
     <code>
      CPU
     </code>
     资源。如果修改
     <code>
      NI
     </code>
     的值超过规定空间，如：设为30，则
     <code>
      NI
     </code>
     会取其范围内最靠进的值19.
     <br/>
     <strong>
      修改NI的值
     </strong>
     <br/>
     启动
     <code>
      top
     </code>
     命令，进入下面页面：
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/45598c215fcc41dab63332e3c9edc252.png">
      <br/>
      找到要修改进程的
      <code>
       PID
      </code>
      ,可使用
      <code>
       /
      </code>
      搜索，按下
      <code>
       r
      </code>
      键，输入要修改进程的
      <code>
       PID
      </code>
      ，输入后直接回车，系统会提示你输入要修改的值，下面为我输入
      <code>
       19
      </code>
      后的值，其进程优先级修改结果为：
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/900c8dc4201044d3b4d0537bab4f3ebb.png">
       <br/>
       注意，我们平时不建议修改进程优先级，内核调度器分配的优先级是比较合理的，如果改动可能会导致进程响应变慢。
      </img>
     </img>
    </p>
    <h2>
     <a id="Linux_o1_78">
     </a>
     三、Linux o(1)调度算法
    </h2>
    <h3>
     <a id="31_79">
     </a>
     3.1、内核调度器算法的工作方式
    </h3>
    <p>
     一个
     <code>
      CPU
     </code>
     绑定一个运行队列，和两个优先级队列，在这两个优先级队列中，一个是活跃的一个是过期的，每个优先级队列包含
     <code>
      140
     </code>
     个优先级：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/dcc7077fb0554c95ad7b823dd38dbbca.png"/>
    </p>
    <p>
     在这个优先级队列中，按优先级顺序存储着PCB结构体对象的指针，如果有两相同优先级的进程，那么他们的PCB结构体通过指针链接起来进行排队，另外操作系统还会为他创建一个对应的位图，同过遍历位图的方式判断，对应位置是否为空，若不为空则对该位图映射对应的优先级队列位置的进程，进行调度，被调度的进程时间片消耗完后，就会去另一个不活跃的优先级队列中，重新进程排对，当
     <code>
      CPU
     </code>
     将活跃优先级队列遍历完后，此时只要将活跃优先级的队列同不活跃优先级的队列的指针交换，就可以再次遍历队列，调度进程了，而这个交换的时间复杂度为o（1）,因此被称为，o（1）的调度算法。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/0f19fdb6f8844705a97a668d1b9aeae3.png"/>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323330315f38303737343837352f:61727469636c652f64657461696c732f313436303534343430" class_="artid" style="display:none">
 </p>
</div>


