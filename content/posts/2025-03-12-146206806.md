---
layout: post
title: "机器学习-朴素贝叶斯原理到应用"
date: 2025-03-12 20:19:11 +0800
description: "分类算法常用的有很多种，朴素贝叶斯算法是其中一个比较常用的，之所以称为朴素贝叶斯算法主要是因为该算法最基本的原理是基于贝叶斯定理的，称为朴素是因为该算法成立的前提是特征之间必须得是独立的。朴素贝叶斯（Naive Bayes）算法理论基础是基于贝叶斯定理和条件独立性假设的一种分类方法。朴素贝叶斯的算法精度不会太高，因为它更适用于自然语言处理，对数据处理方面效果不是特别好。"
keywords: "机器学习----朴素贝叶斯原理到应用"
categories: ['机器学习']
tags: ['算法', '机器学习', '人工智能']
artid: "146206806"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146206806
    alt: "机器学习-朴素贝叶斯原理到应用"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146206806
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146206806
cover: https://bing.ee123.net/img/rand?artid=146206806
image: https://bing.ee123.net/img/rand?artid=146206806
img: https://bing.ee123.net/img/rand?artid=146206806
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     机器学习----朴素贝叶斯原理到应用
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <hr/>
    <p>
    </p>
    <p>
    </p>
    <hr/>
    <h2>
     <a id="_8">
     </a>
     前言
    </h2>
    <p>
     分类算法常用的有很多种，朴素贝叶斯算法是其中一个比较常用的，之所以称为朴素贝叶斯算法主要是因为该算法最基本的原理是基于贝叶斯定理的，称为朴素是因为该算法成立的前提是特征之间必须得是独立的。
     <br/>
     朴素贝叶斯（Naive Bayes）算法理论基础是基于贝叶斯定理和条件独立性假设的一种分类方法。
    </p>
    <hr/>
    <h3>
     <a id="_16">
     </a>
     一、贝叶斯定理
    </h3>
    <p>
     公式如下：
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/6068a3b7e3e14419b1d167e393fa0c18.png"/>
    </p>
    <blockquote>
     <p>
      通俗地说在 B 出现的前提下 A 出现的概率，等于 A 和 B 都出现的概率除以 B 出现的概率。
     </p>
    </blockquote>
    <h3>
     <a id="_24">
     </a>
     二、朴素贝叶斯分类器
    </h3>
    <p>
     “朴素贝叶斯”（Naive Bayes）既可以是一种算法——朴素贝叶斯算法，也可以是一种模型——朴素贝叶斯分类模型（分类器）。
     <br/>
     数学公式可以写为：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/25210d954fe042389927117709a125c6.png"/>
    </p>
    <ul>
     <li>
      <p>
       y为类别变量；
      </p>
     </li>
     <li>
      <p>
       x1，x2，x3,…,xn为特征变量。
      </p>
     </li>
    </ul>
    <h3>
     <a id="_33">
     </a>
     三、代码实现
    </h3>
    <p>
     数学公式我们可以求解，然而机器学习所给的是一行一行的数据集，那么贝叶斯是如何将样本数据进行计算实现预测的呢？
     <br/>
     这是一个鸢尾花数据集：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/9cc91c2ab7a54c5f963863a5067f0f94.png">
      <br/>
      接下来我们就用代码实现预测：
     </img>
    </p>
    <h4>
     <a id="1_41">
     </a>
     1.引入库
    </h4>
    <p>
     代码如下：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>naive_bayes <span class="token keyword">import</span> MultinomialNB<span class="token comment">#导入朴素贝叶斯分类器</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> confusion_matrix
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
</code></pre>
    <h4>
     <a id="2_53">
     </a>
     2.可视化混淆矩阵
    </h4>
    <p>
     代码如下：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">cm_plot</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span>yp<span class="token punctuation">)</span><span class="token punctuation">:</span>
    cm <span class="token operator">=</span> confusion_matrix<span class="token punctuation">(</span>y<span class="token punctuation">,</span> yp<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>matshow<span class="token punctuation">(</span>cm<span class="token punctuation">,</span> cmap<span class="token operator">=</span>plt<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>Blues<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>colorbar<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>cm<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>cm<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            plt<span class="token punctuation">.</span>annotate<span class="token punctuation">(</span>cm<span class="token punctuation">[</span>x<span class="token punctuation">,</span>y<span class="token punctuation">]</span><span class="token punctuation">,</span>xy<span class="token operator">=</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span>horizontalalignment<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">,</span>
                         verticalalignment<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">)</span>
            plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'True label'</span><span class="token punctuation">)</span>
            plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Predicted label'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> plt
</code></pre>
    <h4>
     <a id="3_71">
     </a>
     3、数据预处理
    </h4>
    <pre><code class="prism language-python">data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"iris.csv"</span><span class="token punctuation">,</span>header<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token comment">#header=None代表读取的csv文件是没有表头</span>
data <span class="token operator">=</span> data<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">#把第1列删除，</span>
</code></pre>
    <p>
     因为第一列是索引没有用，我们把它删掉。
    </p>
    <h4>
     <a id="4_78">
     </a>
     4、切分数据集
    </h4>
    <pre><code class="prism language-python">X_whole <span class="token operator">=</span> data<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
y_whole <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span>


x_train_w<span class="token punctuation">,</span> x_test_w<span class="token punctuation">,</span> y_train_w<span class="token punctuation">,</span> y_test_w <span class="token operator">=</span> \
    train_test_split<span class="token punctuation">(</span>X_whole<span class="token punctuation">,</span> y_whole<span class="token punctuation">,</span> test_size <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">,</span> random_state <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
</code></pre>
    <h4>
     <a id="5_89">
     </a>
     5、创建朴素贝叶斯分类器并进行预测
    </h4>
    <pre><code class="prism language-python">classifier <span class="token operator">=</span> MultinomialNB<span class="token punctuation">(</span>alpha<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
classifier<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train_w<span class="token punctuation">,</span> y_train_w<span class="token punctuation">)</span><span class="token comment">#传入训练集数据</span>

<span class="token triple-quoted-string string">"""训练集预测"""</span>
<span class="token comment">#绘制训练集混淆矩阵</span>
train_pred <span class="token operator">=</span> classifier<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_train_w<span class="token punctuation">)</span><span class="token comment">#自测</span>

cm_plot<span class="token punctuation">(</span>y_train_w<span class="token punctuation">,</span> train_pred<span class="token punctuation">)</span><span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token triple-quoted-string string">"""测试集预测"""</span>
test_pred <span class="token operator">=</span> classifier<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test_w<span class="token punctuation">)</span>
cm_plot<span class="token punctuation">(</span>y_test_w<span class="token punctuation">,</span> test_pred<span class="token punctuation">)</span><span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <hr/>
    <h3>
     <a id="__107">
     </a>
     四. 贝叶斯算法的优缺点
    </h3>
    <h4>
     <a id="1_108">
     </a>
     1.优点
    </h4>
    <ul>
     <li>
      简单高效：计算速度快，适合大规模数据集。
     </li>
     <li>
      对小规模数据表现良好：即使在数据较少的情况下也能取得不错的效果。
     </li>
     <li>
      对缺失数据不敏感：能够处理缺失值问题。
     </li>
     <li>
      可解释性强：基于概率的分类结果易于理解
     </li>
    </ul>
    <h4>
     <a id="2_114">
     </a>
     2.缺点
    </h4>
    <ul>
     <li>
      独立性假设过强：现实中特征之间往往存在相关性，独立性假设可能导致模型性能下降。
     </li>
     <li>
      对输入数据分布敏感：如果数据分布与假设不符（如非高斯分布），模型性能可能较差。
     </li>
     <li>
      零概率问题：当某个特征值在训练集中未出现时，会导致概率为零，可通过拉普拉斯平滑（Laplace Smoothing）解决。
     </li>
    </ul>
    <h2>
     <a id="_120">
     </a>
     总结
    </h2>
    <p>
     朴素贝叶斯的算法精度不会太高，因为它更适用于自然语言处理，对数据处理方面效果不是特别好。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f36353036353039352f:61727469636c652f64657461696c732f313436323036383036" class_="artid" style="display:none">
 </p>
</div>


