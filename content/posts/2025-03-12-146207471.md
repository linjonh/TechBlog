---
layout: post
title: "React-中如何实现表单的受控组件"
date: 2025-03-12 15:56:42 +0800
description: "受控组件是指其值由 React 组件的状态（state）控制的表单元素。与之相对的是非受控组件，其值不受 React 状态管理。受控组件的优点在于可以更方便地进行表单验证、条件渲染等操作，因为所有的表单数据都会存储在组件的状态中。受控组件是 React 表单管理的强大工具，能帮助开发者更好地处理用户输入、动态渲染以及表单验证等操作。"
keywords: "React 中如何实现表单的受控组件？"
categories: ['未分类']
tags: ['前端', 'React', 'Javascript']
artid: "146207471"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146207471
    alt: "React-中如何实现表单的受控组件"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146207471
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146207471
cover: https://bing.ee123.net/img/rand?artid=146207471
image: https://bing.ee123.net/img/rand?artid=146207471
img: https://bing.ee123.net/img/rand?artid=146207471
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     React 中如何实现表单的受控组件？
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     在 React 中，表单元素（如输入框、选择框等）可以被实现为受控组件。这种模式使得 React 组件的状态与表单元素的值保持同步，从而使得表单的管理更加灵活和强大。本文将深入探讨如何在 React 中实现受控组件，涵盖基础概念、示例代码、最佳实践以及常见问题。
    </p>
    <h3>
     <a id="_2">
     </a>
     什么是受控组件？
    </h3>
    <p>
     受控组件是指其值由 React 组件的状态（state）控制的表单元素。与之相对的是非受控组件，其值不受 React 状态管理。受控组件的优点在于可以更方便地进行表单验证、条件渲染等操作，因为所有的表单数据都会存储在组件的状态中。
    </p>
    <h4>
     <a id="_6">
     </a>
     受控组件的工作原理
    </h4>
    <ol>
     <li>
      <strong>
       状态管理
      </strong>
      ：组件内部的状态用于存储表单元素的值。
     </li>
     <li>
      <strong>
       事件处理
      </strong>
      ：当用户与表单元素交互（如输入文字）时，通过事件处理函数更新状态。
     </li>
     <li>
      <strong>
       渲染
      </strong>
      ：每次状态更新时，组件都会重新渲染，确保表单元素显示的是最新的值。
     </li>
    </ol>
    <h3>
     <a id="_12">
     </a>
     实现受控组件
    </h3>
    <p>
     下面我们将通过一个简单的示例来演示如何实现受控组件。
    </p>
    <h4>
     <a id="_16">
     </a>
     示例：简单的输入表单
    </h4>
    <h5>
     <a id="_1_React__18">
     </a>
     步骤 1：创建一个基本的 React 应用
    </h5>
    <p>
     首先，确保你有一个 React 环境。如果没有，可以使用 Create React App 创建一个新的项目：
    </p>
    <pre><code class="prism language-bash">npx create-react-app controlled-components-demo
<span class="token builtin class-name">cd</span> controlled-components-demo
<span class="token function">npm</span> start
</code></pre>
    <h5>
     <a id="_2_28">
     </a>
     步骤 2：创建受控组件
    </h5>
    <p>
     在
     <code>
      src
     </code>
     目录下创建一个新的文件
     <code>
      ControlledForm.js
     </code>
     ，并编写以下代码：
    </p>
    <pre><code class="prism language-jsx">import React, { useState } from 'react';

function ControlledForm() {
  const [inputValue, setInputValue] = useState('');

  const handleChange = (event) =&gt; {
    setInputValue(event.target.value);
  };

  const handleSubmit = (event) =&gt; {
    event.preventDefault();
    alert('提交的值: ' + inputValue);
  };

  return (
    &lt;form onSubmit={handleSubmit}&gt;
      &lt;label&gt;
        输入内容:
        &lt;input
          type="text"
          value={inputValue}
          onChange={handleChange}
        /&gt;
      &lt;/label&gt;
      &lt;button type="submit"&gt;提交&lt;/button&gt;
    &lt;/form&gt;
  );
}

export default ControlledForm;
</code></pre>
    <h5>
     <a id="_3_65">
     </a>
     步骤 3：在应用中使用受控组件
    </h5>
    <p>
     打开
     <code>
      src/App.js
     </code>
     ，然后导入并使用
     <code>
      ControlledForm
     </code>
     组件：
    </p>
    <pre><code class="prism language-jsx">import React from 'react';
import ControlledForm from './ControlledForm';

function App() {
  return (
    &lt;div&gt;
      &lt;h1&gt;受控组件示例&lt;/h1&gt;
      &lt;ControlledForm /&gt;
    &lt;/div&gt;
  );
}

export default App;
</code></pre>
    <h4>
     <a id="_85">
     </a>
     代码解析
    </h4>
    <ol>
     <li>
      <strong>
       useState
      </strong>
      ：我们使用
      <code>
       useState
      </code>
      钩子来管理输入框的值。初始值为空字符串。
     </li>
     <li>
      <strong>
       handleChange
      </strong>
      ：这个函数会在输入框的值变化时被调用，更新组件的状态。
     </li>
     <li>
      <strong>
       handleSubmit
      </strong>
      ：当表单提交时，阻止默认行为并弹出当前输入的值。
     </li>
     <li>
      <strong>
       value 属性
      </strong>
      ：输入框的
      <code>
       value
      </code>
      属性被设置为
      <code>
       inputValue
      </code>
      ，确保输入框显示的是当前状态的值。
     </li>
    </ol>
    <h3>
     <a id="_92">
     </a>
     受控组件的优势
    </h3>
    <ul>
     <li>
      <strong>
       单一数据源
      </strong>
      ：所有表单数据都存储在组件的状态中，方便管理和访问。
     </li>
     <li>
      <strong>
       轻松验证
      </strong>
      ：可以在提交前对输入进行验证。
     </li>
     <li>
      <strong>
       条件渲染
      </strong>
      ：可以根据用户输入动态渲染其他组件或信息。
     </li>
     <li>
      <strong>
       可测试性
      </strong>
      ：由于状态集中管理，测试变得更加简单。
     </li>
    </ul>
    <h3>
     <a id="_99">
     </a>
     常见用法
    </h3>
    <h4>
     <a id="1__101">
     </a>
     1. 多个输入框的受控组件
    </h4>
    <p>
     如果你有多个输入框，可以使用对象状态来管理多个字段。例如：
    </p>
    <pre><code class="prism language-jsx">const [formData, setFormData] = useState({ name: '', email: '' });

const handleChange = (event) =&gt; {
  const { name, value } = event.target;
  setFormData({ ...formData, [name]: value });
};

// 在返回的 JSX 中
&lt;input
  type="text"
  name="name"
  value={formData.name}
  onChange={handleChange}
/&gt;
&lt;input
  type="email"
  name="email"
  value={formData.email}
  onChange={handleChange}
/&gt;
</code></pre>
    <h4>
     <a id="2__128">
     </a>
     2. 选择框和单选按钮
    </h4>
    <p>
     受控组件不仅适用于文本输入框，还可以用于选择框和单选按钮。例如：
    </p>
    <pre><code class="prism language-jsx">const [selectedOption, setSelectedOption] = useState('');

const handleOptionChange = (event) =&gt; {
  setSelectedOption(event.target.value);
};

// 在返回的 JSX 中
&lt;label&gt;
  &lt;input
    type="radio"
    value="option1"
    checked={selectedOption === 'option1'}
    onChange={handleOptionChange}
  /&gt;
  选项 1
&lt;/label&gt;
&lt;label&gt;
  &lt;input
    type="radio"
    value="option2"
    checked={selectedOption === 'option2'}
    onChange={handleOptionChange}
  /&gt;
  选项 2
&lt;/label&gt;
</code></pre>
    <h4>
     <a id="3__160">
     </a>
     3. 处理表单验证
    </h4>
    <p>
     你可以在
     <code>
      handleSubmit
     </code>
     中添加验证逻辑。例如，确保输入不为空：
    </p>
    <pre><code class="prism language-jsx">const handleSubmit = (event) =&gt; {
  event.preventDefault();
  if (inputValue.trim() === '') {
    alert('输入不能为空');
    return;
  }
  alert('提交的值: ' + inputValue);
};
</code></pre>
    <h3>
     <a id="_175">
     </a>
     最佳实践
    </h3>
    <ol>
     <li>
      <strong>
       保持状态简单
      </strong>
      ：尽量将状态简单化，避免过多的嵌套结构。
     </li>
     <li>
      <strong>
       使用合适的事件处理
      </strong>
      ：根据需要选择合适的事件处理函数，避免不必要的性能开销。
     </li>
     <li>
      <strong>
       分离组件
      </strong>
      ：如果表单变得复杂，可以考虑将其拆分为多个子组件，以提高可读性和可维护性。
     </li>
    </ol>
    <h3>
     <a id="_181">
     </a>
     常见问题
    </h3>
    <h4>
     <a id="1__183">
     </a>
     1. 受控组件和非受控组件的区别？
    </h4>
    <ul>
     <li>
      受控组件：表单值由 React 组件的状态管理。
     </li>
     <li>
      非受控组件：表单值由 DOM 自己管理，使用
      <code>
       ref
      </code>
      获取值。
     </li>
    </ul>
    <h4>
     <a id="2__value__188">
     </a>
     2. 当输入框没有
     <code>
      value
     </code>
     属性时会发生什么？
    </h4>
    <p>
     如果输入框没有
     <code>
      value
     </code>
     属性，它将变为非受控组件，用户的输入将不会更新到组件的状态中。
    </p>
    <h4>
     <a id="3__192">
     </a>
     3. 如何处理动态生成的表单字段？
    </h4>
    <p>
     可以使用数组或对象来管理动态表单字段的状态，确保每个字段的
     <code>
      name
     </code>
     属性唯一，并在
     <code>
      handleChange
     </code>
     中更新对应的状态。
    </p>
    <h3>
     <a id="_196">
     </a>
     总结
    </h3>
    <p>
     受控组件是 React 表单管理的强大工具，能帮助开发者更好地处理用户输入、动态渲染以及表单验证等操作。
    </p>
   </div>
   <link href="./../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="./../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f33363533383031322f:61727469636c652f64657461696c732f313436323037343731" class_="artid" style="display:none">
 </p>
</div>


