---
layout: post
title: "Beeline的使用和Hive-JDBC"
date: 2025-03-05 18:40:16 +0800
description: "Hive JDBC"
keywords: "Beeline的使用和Hive JDBC"
categories: ['Hadoop']
tags: ['数据仓库', 'Hive', 'Hadoop']
artid: "146024900"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146024900
    alt: "Beeline的使用和Hive-JDBC"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146024900
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146024900
cover: https://bing.ee123.net/img/rand?artid=146024900
image: https://bing.ee123.net/img/rand?artid=146024900
img: https://bing.ee123.net/img/rand?artid=146024900
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Beeline的使用和Hive JDBC
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <h2>
     <a id="1__1">
     </a>
     1. 引言
    </h2>
    <p>
     尽管Hadoop和HBase都提供了对应的启动和停止脚本，但是启动的过程都很繁琐。而Hive没有提供对应的启动和停止脚本，因此它的启动和停止比Hadoop和HBase更加困难。下面将展示如何把Hadoop、HBase和Hive配置成系统服务，然后通过
     <code>
      service name start[/stop]
     </code>
     进行启停。
     <br/>
     创建Hadoop、HBase、Hive服务脚本的命令：
    </p>
    <pre><code class="prism language-bash"><span class="token builtin class-name">cd</span> /etc/init.d
<span class="token function">touch</span> hadoop hbase hive
<span class="token function">chmod</span> +x hadoop hbase hive
</code></pre>
    <h3>
     <a id="11_Hadoop_9">
     </a>
     1.1 Hadoop
    </h3>
    <p>
     用
     <code>
      vim hadoop
     </code>
     编辑hadoop，输入如下内容后，然后按ESC输入:wq!保存。
    </p>
    <pre><code class="prism language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HDFS_NAMENODE_USER</span><span class="token operator">=</span>root
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HDFS_DATANODE_USER</span><span class="token operator">=</span>root
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HDFS_SECONDARYNAMENODE_USER</span><span class="token operator">=</span>root
<span class="token builtin class-name">export</span> <span class="token assign-left variable">YARN_RESOURCEMANAGER_USER</span><span class="token operator">=</span>root
<span class="token builtin class-name">export</span> <span class="token assign-left variable">YARN_NODEMANAGER_USER</span><span class="token operator">=</span>root

<span class="token assign-left variable">LOG_FILE</span><span class="token operator">=</span>/var/log/hadoop-service.log
<span class="token assign-left variable">RED</span><span class="token operator">=</span><span class="token string">'\033[0;31m'</span>
<span class="token assign-left variable">NC</span><span class="token operator">=</span><span class="token string">'\033[0m'</span>

<span class="token keyword">case</span> <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token keyword">in</span>
start<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> <span class="token string">'+%Y-%m-%d %H:%M:%S'</span><span class="token variable">)</span></span> Starting Hadoop cluster..."</span> <span class="token operator">&gt;&gt;</span><span class="token variable">$LOG_FILE</span>
    <span class="token keyword">if</span> start-dfs.sh <span class="token operator">&gt;&gt;</span><span class="token variable">$LOG_FILE</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token keyword">if</span> start-yarn.sh <span class="token operator">&gt;&gt;</span><span class="token variable">$LOG_FILE</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
            <span class="token builtin class-name">echo</span> <span class="token string">"Cluster started successfully."</span>
        <span class="token keyword">else</span>
            <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">${RED}</span>YARN failed to start, Check <span class="token variable">$LOG_FILE</span>.<span class="token variable">${NC}</span>"</span>
            <span class="token builtin class-name">exit</span> <span class="token number">1</span>
        <span class="token keyword">fi</span>
    <span class="token keyword">else</span>
        <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">${RED}</span>HDFS failed to start, Check <span class="token variable">$LOG_FILE</span>.<span class="token variable">${NC}</span>"</span>
        <span class="token builtin class-name">exit</span> <span class="token number">1</span>
    <span class="token keyword">fi</span>
    <span class="token punctuation">;</span><span class="token punctuation">;</span>
stop<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> <span class="token string">'+%Y-%m-%d %H:%M:%S'</span><span class="token variable">)</span></span> Stopping Hadoop cluster..."</span> <span class="token operator">&gt;&gt;</span><span class="token variable">$LOG_FILE</span>
    stop-yarn.sh <span class="token operator">&gt;&gt;</span><span class="token variable">$LOG_FILE</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>
    stop-dfs.sh <span class="token operator">&gt;&gt;</span><span class="token variable">$LOG_FILE</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"Cluster stopped."</span>
    <span class="token punctuation">;</span><span class="token punctuation">;</span>
*<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"Usage: <span class="token variable">$0</span> {start|stop}."</span>
    <span class="token builtin class-name">exit</span> <span class="token number">1</span>
    <span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>

<span class="token builtin class-name">exit</span> <span class="token number">0</span>
</code></pre>
    <h3>
     <a id="12_HBase_52">
     </a>
     1.2 HBase
    </h3>
    <p>
     用
     <code>
      vim hbase
     </code>
     编辑hbase，输入如下内容，然后按ESC输入:wq!保存。由于HBase依赖Hadoop，因此在HBase服务启动之前必须检查Hadoop是否启动，下面脚本中的check_dependencies函数实现了检查Hadoop是否启动的功能。
     <br/>
     (下面的Hive同样依赖于Hadoop，同样需要该函数)
    </p>
    <pre><code class="prism language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token assign-left variable">LOG_FILE</span><span class="token operator">=</span>/var/log/hbase-service.log
<span class="token assign-left variable">RED</span><span class="token operator">=</span><span class="token string">'\033[0;31m'</span>
<span class="token assign-left variable">NC</span><span class="token operator">=</span><span class="token string">'\033[0m'</span>

<span class="token function-name function">check_dependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token operator">!</span> hdfs dfsadmin <span class="token parameter variable">-report</span> <span class="token operator">&amp;&gt;</span>/dev/null<span class="token punctuation">;</span> <span class="token keyword">then</span>
                <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"<span class="token variable">${RED}</span>Error: HDFS didn't run!<span class="token variable">${NC}</span>"</span>
                <span class="token builtin class-name">return</span> <span class="token number">1</span>
        <span class="token keyword">fi</span>

        <span class="token keyword">if</span> <span class="token operator">!</span> <span class="token function">yarn</span> <span class="token function">node</span> <span class="token parameter variable">-list</span> <span class="token operator">&amp;&gt;</span>/dev/null<span class="token punctuation">;</span> <span class="token keyword">then</span>
                <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"<span class="token variable">${RED}</span>Error: YARN didn't run!<span class="token variable">${NC}</span>"</span>
                <span class="token builtin class-name">return</span> <span class="token number">1</span>
        <span class="token keyword">fi</span>
<span class="token punctuation">}</span>

<span class="token keyword">case</span> <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token keyword">in</span>
start<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token operator">!</span> check_dependencies<span class="token punctuation">;</span> <span class="token keyword">then</span>
                <span class="token builtin class-name">exit</span> <span class="token number">1</span>
        <span class="token keyword">fi</span>

        <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> <span class="token string">'+%Y-%m-%d %H:%M:%S'</span><span class="token variable">)</span></span> Starting HBase cluster..."</span> <span class="token operator">&gt;&gt;</span><span class="token variable">$LOG_FILE</span>
        <span class="token keyword">if</span> start-hbase.sh <span class="token operator">&gt;&gt;</span><span class="token variable">$LOG_FILE</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
                <span class="token builtin class-name">echo</span> <span class="token string">"HBase started successfully."</span>
        <span class="token keyword">else</span>
                <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">${RED}</span>HBase failed to start, Check <span class="token variable">$LOG_FILE</span>.<span class="token variable">${NC}</span>"</span>
                <span class="token builtin class-name">exit</span> <span class="token number">1</span>
        <span class="token keyword">fi</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
stop<span class="token punctuation">)</span>
        <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> <span class="token string">'+%Y-%m-%d %H:%M:%S'</span><span class="token variable">)</span></span> Stopping HBase cluster..."</span> <span class="token operator">&gt;&gt;</span><span class="token variable">$LOG_FILE</span>
        stop-hbase.sh <span class="token operator">&gt;&gt;</span><span class="token variable">$LOG_FILE</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>
        <span class="token builtin class-name">echo</span> <span class="token string">"HBase stopped."</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
*<span class="token punctuation">)</span>
        <span class="token builtin class-name">echo</span> <span class="token string">"Usage: <span class="token variable">$0</span> {start|stop}."</span>
        <span class="token builtin class-name">exit</span> <span class="token number">1</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>

<span class="token builtin class-name">exit</span> <span class="token number">0</span>
</code></pre>
    <h3>
     <a id="13_Hive_100">
     </a>
     1.3 Hive
    </h3>
    <p>
     由于Hive没有官方提供的启动和停止脚本，因此Hive服务脚本比上面两个更加复杂。因为在使用Beeline访问Hive之前，必须启动MetaStore和HiveServer2。官方提供的启动方法是：
    </p>
    <pre><code class="prism language-bash"><span class="token function">nohup</span> hive <span class="token parameter variable">--service</span> metastore <span class="token operator">&amp;</span>
<span class="token function">nohup</span> hive <span class="token parameter variable">--service</span> hiveserver2 <span class="token operator">&amp;</span>
</code></pre>
    <p>
     接着通过运行jps命令，就会发现多了两个RunJar进程——它们就是MetaStore和Hiveserver2。而停止的方法是通过jps命令查看这两个进程的pid——即jps命令显示出的第一列中的数据，然后通过
     <code>
      kill -9 pid1 pid2
     </code>
     (pid1，pid2代指这两个RunJar的pid)。因此Hive的启动与停止非常繁琐。
     <br/>
     用
     <code>
      vim hive
     </code>
     编辑hive，输入如下内容，然后按ESC输入:wq!保存。下面的check_dependencies函数实现了检查Hadoop是否启动的功能，start_metastore函数实现了MetaStore服务的启动，start_hiveserver2实现了HiveServer2服务的启动，stop_process实现了这两个服务的停止，脚本中停止这两个服务的具体调用命令是：
    </p>
    <pre><code class="prism language-bash">stop_process <span class="token string">"MetaStore"</span> <span class="token string">"metastore"</span>
stop_process <span class="token string">"HiveServer2"</span> <span class="token string">"hiveserver2"</span>
</code></pre>
    <p>
     此外，在start_metastore和start_hiveserver2中通过nc命令来检查MetaStore和HiveServer2的指定端口是否开放，以达到判断这两个服务是否启动的目的。并且由于端口开放可能存在延迟的原因，在这两个函数设置RETRY_TIMES来进行多次判断。
    </p>
    <pre><code class="prism language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token assign-left variable">LOG_DIR</span><span class="token operator">=</span>/var/log/hive
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-d</span> <span class="token variable">$LOG_DIR</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$LOG_DIR</span>
<span class="token keyword">fi</span>

<span class="token assign-left variable">HOST</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">hostname</span> <span class="token parameter variable">-I</span><span class="token variable">)</span></span>
<span class="token assign-left variable">START_LOG</span><span class="token operator">=</span><span class="token variable">$LOG_DIR</span>/hive-start.log
<span class="token assign-left variable">STOP_LOG</span><span class="token operator">=</span><span class="token variable">$LOG_DIR</span>/hive-stop.log
<span class="token assign-left variable">METASTORE_PORT</span><span class="token operator">=</span><span class="token number">9083</span>
<span class="token assign-left variable">HIVESERVER2_PORT</span><span class="token operator">=</span><span class="token number">10000</span>
<span class="token assign-left variable">RETRY_TIMES</span><span class="token operator">=</span><span class="token number">3</span>

<span class="token assign-left variable">RED</span><span class="token operator">=</span><span class="token string">'\033[0;31m'</span>
<span class="token assign-left variable">NC</span><span class="token operator">=</span><span class="token string">'\033[0m'</span>

<span class="token function-name function">check_dependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token operator">!</span> <span class="token function">nc</span> <span class="token parameter variable">--version</span> <span class="token operator">&amp;&gt;</span>/dev/null<span class="token punctuation">;</span> <span class="token keyword">then</span>
                <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"<span class="token variable">${RED}</span>Please use apt to install ncat!<span class="token variable">${NC}</span>"</span>
                <span class="token builtin class-name">return</span> <span class="token number">1</span>
        <span class="token keyword">fi</span>

        <span class="token keyword">if</span> <span class="token operator">!</span> pgrep <span class="token parameter variable">--version</span> <span class="token operator">&amp;&gt;</span>/dev/null<span class="token punctuation">;</span> <span class="token keyword">then</span>
                <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"<span class="token variable">${RED}</span>Please use apt to install procps-ng!<span class="token variable">${NC}</span>"</span>
                <span class="token builtin class-name">return</span> <span class="token number">1</span>
        <span class="token keyword">fi</span>

        <span class="token keyword">if</span> <span class="token operator">!</span> hdfs dfsadmin <span class="token parameter variable">-report</span> <span class="token operator">&amp;&gt;</span>/dev/null<span class="token punctuation">;</span> <span class="token keyword">then</span>
                <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"<span class="token variable">${RED}</span>Error: HDFS didn't run!<span class="token variable">${NC}</span>"</span>
                <span class="token builtin class-name">return</span> <span class="token number">1</span>
        <span class="token keyword">fi</span>

        <span class="token keyword">if</span> <span class="token operator">!</span> <span class="token function">yarn</span> <span class="token function">node</span> <span class="token parameter variable">-list</span> <span class="token operator">&amp;&gt;</span>/dev/null<span class="token punctuation">;</span> <span class="token keyword">then</span>
                <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"<span class="token variable">${RED}</span>Error: YARN didn't run!<span class="token variable">${NC}</span>"</span>
                <span class="token builtin class-name">return</span> <span class="token number">1</span>
        <span class="token keyword">fi</span>
<span class="token punctuation">}</span>

<span class="token function-name function">start_metastore</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token builtin class-name">local</span> <span class="token assign-left variable">retry</span><span class="token operator">=</span><span class="token number">0</span>

        <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> <span class="token string">'+%Y-%m-%d %H:%M:%S'</span><span class="token variable">)</span></span> Starting metastore service..."</span> <span class="token operator">&gt;&gt;</span><span class="token variable">$START_LOG</span>
        <span class="token function">nohup</span> hive <span class="token parameter variable">--service</span> metastore <span class="token parameter variable">-p</span> <span class="token variable">$METASTORE_PORT</span> <span class="token operator">&gt;&gt;</span><span class="token variable">$START_LOG</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span>
        <span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token variable">$retry</span> <span class="token parameter variable">-lt</span> <span class="token variable">$RETRY_TIMES</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
                <span class="token function">sleep</span> <span class="token number">5</span>
                <span class="token keyword">if</span> <span class="token function">nc</span> <span class="token parameter variable">-z</span> <span class="token variable">$HOST</span> <span class="token variable">$METASTORE_PORT</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
                        <span class="token builtin class-name">return</span> <span class="token number">0</span>
                <span class="token keyword">fi</span>
                <span class="token variable"><span class="token punctuation">((</span>retry<span class="token operator">++</span><span class="token punctuation">))</span></span>
        <span class="token keyword">done</span>

        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$retry</span> <span class="token parameter variable">-eq</span> <span class="token variable">$RETRY_TIMES</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
                <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"<span class="token variable">${RED}</span>MetaStore failed to start, Check <span class="token variable">$START_LOG</span>.<span class="token variable">${NC}</span>"</span>
                <span class="token builtin class-name">return</span> <span class="token number">1</span>
        <span class="token keyword">fi</span>
<span class="token punctuation">}</span>

<span class="token function-name function">start_hiveserver2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token builtin class-name">local</span> <span class="token assign-left variable">retry</span><span class="token operator">=</span><span class="token number">0</span>

        <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> <span class="token string">'+%Y-%m-%d %H:%M:%S'</span><span class="token variable">)</span></span> Starting hiveserver2 service...)"</span> <span class="token operator">&gt;&gt;</span><span class="token variable">$START_LOG</span>
        <span class="token function">nohup</span> hive <span class="token parameter variable">--service</span> hiveserver2 <span class="token operator">&gt;&gt;</span><span class="token variable">$START_LOG</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span>
        <span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token variable">$retry</span> <span class="token parameter variable">-le</span> <span class="token variable">$RETRY_TIMES</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
                <span class="token function">sleep</span> <span class="token number">5</span>
                <span class="token keyword">if</span> <span class="token function">nc</span> <span class="token parameter variable">-z</span> <span class="token variable">$HOST</span> <span class="token variable">$HIVESERVER2_PORT</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
                        <span class="token builtin class-name">return</span> <span class="token number">0</span>
                <span class="token keyword">fi</span>
                <span class="token variable"><span class="token punctuation">((</span>retry<span class="token operator">++</span><span class="token punctuation">))</span></span>
        <span class="token keyword">done</span>

        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$retry</span> <span class="token parameter variable">-eq</span> <span class="token variable">$RETRY_TIMES</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
                <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"<span class="token variable">${RED}</span>HiveServer2 failed to start, Check <span class="token variable">$START_LOG</span>.<span class="token variable">${NC}</span>"</span>
                <span class="token builtin class-name">return</span> <span class="token number">1</span>
        <span class="token keyword">fi</span>
<span class="token punctuation">}</span>

<span class="token function-name function">stop_process</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token builtin class-name">local</span> <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token variable">$1</span>
        <span class="token builtin class-name">local</span> <span class="token assign-left variable">pattern</span><span class="token operator">=</span><span class="token variable">$2</span>
        <span class="token builtin class-name">local</span> pid
        <span class="token assign-left variable">pid</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>pgrep <span class="token parameter variable">-f</span> <span class="token string">"<span class="token variable">$pattern</span>"</span><span class="token variable">)</span></span>

        <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-n</span> <span class="token variable">$pid</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
                <span class="token builtin class-name">echo</span> <span class="token string">"Stopping <span class="token variable">$name</span>..."</span> <span class="token operator">&gt;&gt;</span><span class="token variable">$STOP_LOG</span>
                <span class="token function">kill</span> <span class="token variable">$pid</span>
                <span class="token function">sleep</span> <span class="token number">10</span>
                <span class="token keyword">if</span> pgrep <span class="token parameter variable">-f</span> <span class="token string">"<span class="token variable">$pattern</span>"</span> <span class="token operator">&amp;&gt;</span>/dev/null<span class="token punctuation">;</span> <span class="token keyword">then</span>
                        <span class="token function">kill</span> <span class="token parameter variable">-9</span> <span class="token variable">$pid</span>
                <span class="token keyword">fi</span>
        <span class="token keyword">fi</span>
<span class="token punctuation">}</span>

<span class="token keyword">case</span> <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token keyword">in</span>
start<span class="token punctuation">)</span>
        <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> <span class="token string">'+%Y-%m-%d %H:%M:%S'</span><span class="token variable">)</span></span> Starting Hive Cluster..."</span> <span class="token operator">&gt;&gt;</span><span class="token variable">$START_LOG</span>
        <span class="token keyword">if</span> <span class="token operator">!</span> check_dependencies<span class="token punctuation">;</span> <span class="token keyword">then</span>
                <span class="token builtin class-name">exit</span> <span class="token number">1</span>
        <span class="token keyword">fi</span>

        <span class="token keyword">if</span> <span class="token operator">!</span> start_metastore<span class="token punctuation">;</span> <span class="token keyword">then</span>
                <span class="token builtin class-name">exit</span> <span class="token number">1</span>
        <span class="token keyword">fi</span>

        <span class="token keyword">if</span> <span class="token operator">!</span> start_hiveserver2<span class="token punctuation">;</span> <span class="token keyword">then</span>
                <span class="token builtin class-name">exit</span> <span class="token number">1</span>
        <span class="token keyword">fi</span>

        <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"Hive started successfully."</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
stop<span class="token punctuation">)</span>
        <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> <span class="token string">'+%Y-%m-%d %H:%M:%S'</span><span class="token variable">)</span></span> Stopping Hive Cluster..."</span> <span class="token operator">&gt;&gt;</span><span class="token variable">$STOP_LOG</span>
        stop_process <span class="token string">"MetaStore"</span> <span class="token string">"metastore"</span>
        stop_process <span class="token string">"HiveServer2"</span> <span class="token string">"hiveserver2"</span>
        <span class="token builtin class-name">echo</span> <span class="token string">"Hive stopped."</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
*<span class="token punctuation">)</span>
        <span class="token builtin class-name">echo</span> <span class="token string">"Usage: <span class="token variable">$0</span> {start|stop}"</span>
        <span class="token builtin class-name">exit</span> <span class="token number">1</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>

<span class="token builtin class-name">exit</span> <span class="token number">0</span>
</code></pre>
    <h2>
     <a id="2_Beeline_237">
     </a>
     2. Beeline
    </h2>
    <p>
     Beeline是Hive目前的客户端，可以通过JDBC连接远程服务。
    </p>
    <h3>
     <a id="21_BeelineHive_239">
     </a>
     2.1 使用Beeline访问Hive
    </h3>
    <p>
     首先必须启动MetaStore服务和HiveServer2服务，如果你在/etc/init.d中配置了上面提到的Hadoop、HBase、Hive服务的话，就可以通过
     <code>
      service hadoop start &amp;&amp; service hive start
     </code>
     来启动MetaStore服务和HiveServer2服务。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/db1d17b47d7c4b5fb463c0d3fb45dfa1.png#pic_center"/>
    </p>
    <h4>
     <a id="211_beelineHive_242">
     </a>
     2.1.1 通过beeline直接连接Hive
    </h4>
    <p>
     <code>
      beeline -u 'jdbc:hive2://172.18.0.2:10000' -n root
     </code>
     ，退出的话需要输入beeline命令
     <code>
      !exit
     </code>
     。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/3a5f0c747539455bbda484c493ee278c.png#pic_center"/>
    </p>
    <h4>
     <a id="212_beelineHive_245">
     </a>
     2.1.2 先进入beeline客户端再连接Hive
    </h4>
    <p>
     先输入
     <code>
      hive
     </code>
     进入beeline客户端，然后输入
     <code>
      !connect 'jdbc:hive2://172.18.0.2:10000
     </code>
     ，接着输入对应的用户名root和密码123456，最后同样通过
     <code>
      !exit
     </code>
     退出。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/d191e91cebe44f078cce8e3b8757d26d.png"/>
    </p>
    <h4>
     <a id="213_beelineMySQL_248">
     </a>
     2.1.3 先进入beeline客户端再连接MySQL
    </h4>
    <p>
     输入
     <code>
      !connect 'jdbc:mysql://172.18.0.3:3306'
     </code>
     ，然后输入用户名root和密码123456，最后用
     <code>
      !close
     </code>
     结束连接。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/c2324c5cf4da478b9a65255f2ba1b7af.png"/>
    </p>
    <h3>
     <a id="22_Beeline_251">
     </a>
     2.2 Beeline命令
    </h3>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/f371152e5fe14583b8b63bf57a8c28a2.png#pic_center">
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/424d1e7174c7494f9782d97c416ca585.png#pic_center"/>
     </img>
    </p>
    <h2>
     <a id="3_Hive_JDBC_254">
     </a>
     3. Hive JDBC
    </h2>
    <h3>
     <a id="31_pomxml_255">
     </a>
     3.1 pom.xml中依赖配置
    </h3>
    <pre><code class="prism language-xml">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.11<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.hive<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>hive-service<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.0.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.logging.log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>log4j-slf4j-impl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.hive<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>hive-jdbc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.0.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.hadoop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>hadoop-client-runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.3.6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <h3>
     <a id="32_Util_287">
     </a>
     3.2 Util工具类
    </h3>
    <pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Connection</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">DriverManager</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">SQLException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Statement</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Util</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Connection</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token class-name">String</span> driverName<span class="token punctuation">,</span> <span class="token class-name">String</span> url<span class="token punctuation">,</span> <span class="token class-name">String</span> user<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span><span class="token punctuation">,</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>driverName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Connection</span> conn <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> user<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> conn<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Statement</span> <span class="token function">getStatement</span><span class="token punctuation">(</span><span class="token class-name">Connection</span> conn<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> conn<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">closeStatement</span><span class="token punctuation">(</span><span class="token class-name">Statement</span> stmt<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        stmt<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">closeConnection</span><span class="token punctuation">(</span><span class="token class-name">Connection</span> conn<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        conn<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="33__314">
     </a>
     3.3 代码
    </h3>
    <pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Connection</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">ResultSet</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">ResultSetMetaData</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">SQLException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Statement</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span><span class="token punctuation">,</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Connection</span> conn <span class="token operator">=</span> <span class="token class-name">Util</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"org.apache.hive.jdbc.HiveDriver"</span><span class="token punctuation">,</span> <span class="token string">"jdbc:hive2://172.18.0.2:10000"</span><span class="token punctuation">,</span> <span class="token string">"root"</span><span class="token punctuation">,</span>
                <span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Statement</span> stmt <span class="token operator">=</span> <span class="token class-name">Util</span><span class="token punctuation">.</span><span class="token function">getStatement</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span><span class="token punctuation">;</span>
        stmt<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token string">"drop table if exists users"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stmt<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>
                <span class="token string">"create table users (user_id int, fname string, lname string) row format delimited fields terminated by ','"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stmt<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token string">"insert into users (user_id, fname, lname) values(222, 'yang', 'yang2')"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stmt<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token string">"load data local inpath '/root/CodeProject/hive-advance/data.txt' into table users"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"select * from users"</span><span class="token punctuation">;</span>
        <span class="token class-name">ResultSet</span> res <span class="token operator">=</span> stmt<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ResultSetMetaData</span> meta <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">getMetaData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> meta<span class="token punctuation">.</span><span class="token function">getColumnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>meta<span class="token punctuation">.</span><span class="token function">getColumnName</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\t"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">while</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\t\t"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\t\t"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        sql <span class="token operator">=</span> <span class="token string">"show tables"</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Running: "</span> <span class="token operator">+</span> sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        res <span class="token operator">=</span> stmt<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        sql <span class="token operator">=</span> <span class="token string">"desc users"</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Running: "</span> <span class="token operator">+</span> sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        res <span class="token operator">=</span> stmt<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\t"</span> <span class="token operator">+</span> res<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">Util</span><span class="token punctuation">.</span><span class="token function">closeStatement</span><span class="token punctuation">(</span>stmt<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Util</span><span class="token punctuation">.</span><span class="token function">closeConnection</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="34__368">
     </a>
     3.4 结果
    </h3>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/84a99a97f8004e5e8471d15ac69dfd8e.png"/>
    </p>
    <h2>
     <a id="_370">
     </a>
     参考
    </h2>
    <p>
     吴章勇 杨强著 大数据Hadoop3.X分布式处理实战
     <br/>
     <a href="https://stackoverflow.com/questions/60943753/new-hiveconf-exception-noclassdeffounderror-com-ctc-wstx-io-inputbootstrapper" rel="nofollow">
      https://stackoverflow.com/questions/60943753/new-hiveconf-exception-noclassdeffounderror-com-ctc-wstx-io-inputbootstrapper
     </a>
     通过添加hadoop-client-runtime依赖解决了这个问题。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/efc77c3ed4134e5a9a190fb9999d5d12.png#pic_center"/>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f35313138303932382f:61727469636c652f64657461696c732f313436303234393030" class_="artid" style="display:none">
 </p>
</div>


