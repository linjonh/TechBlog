---
layout: post
title: "从学习ts的三斜线指令到项目中声明类型的最佳实践"
date: 2025-03-12 18:00:06 +0800
description: "三斜线指令（Triple-Slash Directives）是 TypeScript 提供的一种特殊的单行注释格式，用于在编译期间引入额外的类型声明。问题推荐做法是否需要在每个.ts文件里引用 vite/client？❌ 不需要，只需集中在引用一次。多个.d.ts文件需要重复///吗？❌ 不需要，推荐通过的include统一包含。三斜线指令可以放在文件中间吗？❌ 不可以，必须放在文件开头。可以用 path 引入自定义 d.ts 吗？⚠️ 不推荐，推荐直接放types/"
keywords: "从学习ts的三斜线指令到项目中声明类型的最佳实践"
categories: ['未分类']
tags: ['学习']
artid: "146211217"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146211217
    alt: "从学习ts的三斜线指令到项目中声明类型的最佳实践"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146211217
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146211217
cover: https://bing.ee123.net/img/rand?artid=146211217
image: https://bing.ee123.net/img/rand?artid=146211217
img: https://bing.ee123.net/img/rand?artid=146211217
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     从学习ts的三斜线指令到项目中声明类型的最佳实践
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-tomorrow-night-eighties" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     在使用create-vue创建项目模版的时候，生成的文件里有一个
     <code>
      env.d.ts
     </code>
     里面只有一行内容
     <code>
      /// &lt;reference types="vite/client" /&gt;
     </code>
     本文将从它入手逐步讲解
     <code>
      vue-ts
     </code>
     项目里对类型声明的最佳实践
    </p>
    <h2>
     <a id="__reference__1">
     </a>
     📌 三斜线指令（
     <code>
      /// &lt;reference /&gt;
     </code>
     ）使用规范
    </h2>
    <h3>
     <a id="_3">
     </a>
     一、什么是三斜线指令？
    </h3>
    <p>
     三斜线指令（Triple-Slash Directives）是 TypeScript 提供的一种特殊的单行注释格式，用于在编译期间引入额外的类型声明。
    </p>
    <p>
     语法如下：
    </p>
    <pre><code class="prism language-ts"><span class="token comment">/// &lt;reference path="..." /&gt;</span>
<span class="token comment">/// &lt;reference types="..." /&gt;</span>
<span class="token comment">/// &lt;reference lib="..." /&gt;</span>
</code></pre>
    <h4>
     <a id="_reference_typesviteclient___13">
     </a>
     <code>
      /// &lt;reference types="vite/client" /&gt;
     </code>
     作用是什么？
    </h4>
    <p>
     表示：
    </p>
    <blockquote>
     <p>
      <strong>
       引入 Vite 内置的类型声明文件
      </strong>
      ，通常是 vite/client.d.ts，让 TypeScript 知道 Vite 特有的东西，比如：
     </p>
    </blockquote>
    <ul>
     <li>
      import.meta.env
     </li>
     <li>
      Vite 的模块类型（比如 SVG、CSS 模块等）
     </li>
    </ul>
    <p>
     🔑 举个例子：
    </p>
    <pre><code class="prism language-typescript"><span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VITE_API_URL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     如果不加，TypeScript 会提示：
    </p>
    <blockquote>
     <p>
      Property ‘env’ does not exist on type ‘ImportMeta’
     </p>
    </blockquote>
    <h4>
     <a id="_27">
     </a>
     常见指令说明：
    </h4>
    <table>
     <thead>
      <tr>
       <th>
        指令
       </th>
       <th>
        说明
       </th>
       <th>
        示例
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <code>
         /// &lt;reference path="..." /&gt;
        </code>
       </td>
       <td>
        引入其他
        <code>
         .d.ts
        </code>
        文件（路径引用）
       </td>
       <td>
        <code>
         /// &lt;reference path="./types/global.d.ts" /&gt;
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <code>
         /// &lt;reference types="..." /&gt;
        </code>
       </td>
       <td>
        引用某个模块或包的类型声明（自动从
        <code>
         @types/xxx
        </code>
        查找）
       </td>
       <td>
        <code>
         /// &lt;reference types="vite/client" /&gt;
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <code>
         /// &lt;reference lib="..." /&gt;
        </code>
       </td>
       <td>
        引入内置的标准库声明（如 DOM、ES2020 等）
       </td>
       <td>
        <code>
         /// &lt;reference lib="esnext" /&gt;
        </code>
       </td>
      </tr>
     </tbody>
    </table>
    <hr/>
    <h3>
     <a id="_37">
     </a>
     二、常用场景
    </h3>
    <ol>
     <li>
      <p>
       <strong>
        引入 Vite 环境变量类型（vite/client）和引入Node.js类型
       </strong>
      </p>
      <pre><code class="prism language-ts"><span class="token comment">/// &lt;reference types="vite/client" /&gt;</span>
<span class="token comment">/// &lt;reference types="node" /&gt;</span>
</code></pre>
      <p>
       用于支持
       <code>
        import.meta.env
       </code>
       自动类型提示，通常放在
       <code>
        env.d.ts
       </code>
       或
       <code>
        vite-env.d.ts
       </code>
       中。
      </p>
     </li>
     <li>
      <p>
       <strong>
        引入自定义全局类型
       </strong>
      </p>
      <pre><code class="prism language-ts"><span class="token comment">/// &lt;reference path="./types/global.d.ts" /&gt;</span>
</code></pre>
      <p>
       显式引入其他
       <code>
        .d.ts
       </code>
       文件中的类型定义。
      </p>
     </li>
     <li>
      <p>
       <strong>
        引入标准库
       </strong>
      </p>
      <pre><code class="prism language-ts"><span class="token comment">/// &lt;reference lib="dom" /&gt;</span>
</code></pre>
      <p>
       显式增加标准库支持，一般不建议，推荐通过
       <code>
        tsconfig.json
       </code>
       的
       <code>
        lib
       </code>
       配置统一设置。
      </p>
     </li>
    </ol>
    <hr/>
    <h3>
     <a id="_66">
     </a>
     三、三斜线指令的注意事项
    </h3>
    <table>
     <thead>
      <tr>
       <th>
        问题
       </th>
       <th>
        说明
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <strong>
         位置要求
        </strong>
       </td>
       <td>
        必须写在
        <code>
         .d.ts
        </code>
        文件的第一行或开头部分，
        <strong>
         不能放在 import 语句之后
        </strong>
        。
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         作用范围
        </strong>
       </td>
       <td>
        <strong>
         仅作用于当前文件
        </strong>
        ，不会自动影响其他
        <code>
         .ts
        </code>
        /
        <code>
         .d.ts
        </code>
        文件。
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         是否必须
        </strong>
       </td>
       <td>
        如果通过
        <code>
         tsconfig.json
        </code>
        的
        <code>
         include
        </code>
        或
        <code>
         typeRoots
        </code>
        配置包含了类型声明，则无需每个文件重复写。
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         相对路径使用
        </strong>
       </td>
       <td>
        <code>
         path
        </code>
        指令必须是相对路径，例如
        <code>
         ./types/global.d.ts
        </code>
        。
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         引入库类型
        </strong>
       </td>
       <td>
        使用
        <code>
         types
        </code>
        时，优先从
        <code>
         @types
        </code>
        包里查找，例如
        <code>
         @types/node
        </code>
        。
       </td>
      </tr>
     </tbody>
    </table>
    <hr/>
    <p>
     引入库类型的查找逻辑具体如下
    </p>
    <pre><code>写了：/// &lt;reference types="vite/client" /&gt;
        ↓
优先找：node_modules/@types/vite/client.d.ts
        ↓
其次找：node_modules/vite/client.d.ts 或 package.json -&gt; types 指定的路径
        ↓
找不到：报错 (类型未找到)

</code></pre>
    <h3>
     <a id="_vs_import__89">
     </a>
     四、三斜线指令 vs import 有啥区别？
    </h3>
    <table>
     <thead>
      <tr>
       <th>
        对比项
       </th>
       <th>
        三斜线指令 (
        <code>
         ///
        </code>
        )
       </th>
       <th>
        <code>
         import
        </code>
        语法
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <strong>
         目的
        </strong>
       </td>
       <td>
        引用类型声明文件（仅类型相关，不引入运行时代码）
       </td>
       <td>
        引入模块，可能包含运行时代码和类型
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         是否执行代码
        </strong>
       </td>
       <td>
        ❌ 纯类型引用
       </td>
       <td>
        ✅ 引入模块，执行相关代码
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         作用范围
        </strong>
       </td>
       <td>
        文件级别（当前文件有效）
       </td>
       <td>
        模块级别（import 进来的模块、类型、值）
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         适合场景
        </strong>
       </td>
       <td>
        仅为了类型系统识别第三方库或特殊语法（如 Vite、Node 环境等）
       </td>
       <td>
        正常的模块加载，包含值和类型
       </td>
      </tr>
     </tbody>
    </table>
    <h3>
     <a id="_97">
     </a>
     五、如何避免每个文件都写三斜线指令？（全局生效方式）
    </h3>
    <p>
     为了不在每个 .d.ts 文件里重复声明，可以使用 统一入口声明文件，例如 env.d.ts，然后让它被全局加载，方法如下：
    </p>
    <p>
     ✅ 推荐方式 1：在 tsconfig.json 里显式指定
    </p>
    <pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 其他配置...</span>
    <span class="token string-property property">"types"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"vite/client"</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">"include"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"src/**/*.ts"</span><span class="token punctuation">,</span> <span class="token string">"src/**/*.d.ts"</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

</code></pre>
    <ul>
     <li>
      这样就相当于全局加了
      <code>
       /// &lt;reference types="vite/client" /&gt;
      </code>
      。
     </li>
     <li>
      所有文件（不论 ts 还是 d.ts）都能识别 vite/client 的类型了，无需单独声明。
     </li>
    </ul>
    <p>
     ✅ 推荐方式 2：统一放在 env.d.ts
    </p>
    <pre><code class="prism language-json"><span class="token comment">/// &lt;reference types="vite/client" /&gt;</span>
</code></pre>
    <p>
     然后在 tsconfig.json 的 include 中包含这个文件即可。
     <br/>
     ⚠️ 注意：这样所有编译参与的文件都会间接识别 vite/client 类型。
    </p>
    <h3>
     <a id="_121">
     </a>
     六、最佳实践（推荐做法）
    </h3>
    <h4>
     <a id="1__123">
     </a>
     1.
     <strong>
      集中管理，全局统一
     </strong>
    </h4>
    <ul>
     <li>
      项目根目录或
      <code>
       types/
      </code>
      目录下统一创建全局类型文件，例如：
     </li>
    </ul>
    <pre><code>├── types/
│   ├── env.d.ts          // Vite 环境变量类型
│   └── global.d.ts       // 全局扩展类型
</code></pre>
    <ul>
     <li>
      <strong>
       只在
       <code>
        env.d.ts
       </code>
       里写一次
       <code>
        /// &lt;reference types="vite/client" /&gt;
       </code>
       ，全局有效
      </strong>
      ，其他文件无需再写。
     </li>
    </ul>
    <blockquote>
     <p>
      ✅
      <strong>
       推荐示例：types/env.d.ts
      </strong>
     </p>
    </blockquote>
    <pre><code class="prism language-ts"><span class="token comment">/// &lt;reference types="vite/client" /&gt;</span>
</code></pre>
    <h4>
     <a id="2__tsconfigjson__140">
     </a>
     2.
     <strong>
      通过 tsconfig.json 管理包含路径
     </strong>
    </h4>
    <p>
     确保在
     <code>
      tsconfig.json
     </code>
     中包含
     <code>
      types
     </code>
     目录，无需在其他地方重复三斜线指令。
    </p>
    <pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"types"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string-property property">"lib"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"ESNext"</span><span class="token punctuation">,</span> <span class="token string">"DOM"</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">"include"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">"types/**/*.d.ts"</span><span class="token punctuation">,</span>
    <span class="token string">"src/**/*.ts"</span><span class="token punctuation">,</span>
    <span class="token string">"src/**/*.vue"</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
    <blockquote>
     <p>
      ⚠️ 注意：
      <code>
       types
      </code>
      可以为空，意味着不强制全局类型，单独在
      <code>
       types/
      </code>
      下声明的类型文件，通过
      <code>
       include
      </code>
      自动生效。
     </p>
    </blockquote>
    <h4>
     <a id="3__path__160">
     </a>
     3.
     <strong>
      避免滥用 path 指令
     </strong>
    </h4>
    <ul>
     <li>
      不推荐在每个文件用
      <code>
       /// &lt;reference path="..." /&gt;
      </code>
      方式去引入，容易混乱且难以维护。
     </li>
     <li>
      推荐方式是集中声明 +
      <code>
       tsconfig.json
      </code>
      自动引入。
     </li>
    </ul>
    <h4>
     <a id="4__viteclient_165">
     </a>
     4.
     <strong>
      避免多个地方重复引入 vite/client
     </strong>
    </h4>
    <ul>
     <li>
      只在一个公共的
      <code>
       .d.ts
      </code>
      文件中引入一次即可（如
      <code>
       types/env.d.ts
      </code>
      ）。
     </li>
     <li>
      不要在所有
      <code>
       .vue
      </code>
      或
      <code>
       .ts
      </code>
      文件头部重复书写。
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="_172">
     </a>
     七、总结
    </h3>
    <table>
     <thead>
      <tr>
       <th>
        问题
       </th>
       <th>
        推荐做法
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        是否需要在每个
        <code>
         .ts
        </code>
        文件里引用 vite/client？
       </td>
       <td>
        ❌ 不需要，只需集中在
        <code>
         types/env.d.ts
        </code>
        引用一次。
       </td>
      </tr>
      <tr>
       <td>
        多个
        <code>
         .d.ts
        </code>
        文件需要重复
        <code>
         ///
        </code>
        吗？
       </td>
       <td>
        ❌ 不需要，推荐通过
        <code>
         tsconfig.json
        </code>
        的
        <code>
         include
        </code>
        统一包含。
       </td>
      </tr>
      <tr>
       <td>
        三斜线指令可以放在文件中间吗？
       </td>
       <td>
        ❌ 不可以，
        <strong>
         必须放在文件开头
        </strong>
        。
       </td>
      </tr>
      <tr>
       <td>
        可以用 path 引入自定义 d.ts 吗？
       </td>
       <td>
        ⚠️ 不推荐，推荐直接放
        <code>
         types/
        </code>
        目录，并通过 tsconfig 引入。
       </td>
      </tr>
     </tbody>
    </table>
    <hr/>
    <h3>
     <a id="_183">
     </a>
     八、示例项目结构推荐
    </h3>
    <pre><code>├── src/
│   └── ...
├── types/
│   ├── env.d.ts        // 全局 Vite 类型
│   └── global.d.ts     // 扩展 ImportMetaEnv、Window、静态资源等
├── tsconfig.json      // 包含 types/ 目录
└── vite.config.ts
</code></pre>
    <p>
     <strong>
      types/global.d.ts
     </strong>
    </p>
    <pre><code class="prism language-ts"><span class="token comment">// 扩展 window 对象</span>
<span class="token keyword">interface</span> <span class="token class-name">Window</span> <span class="token punctuation">{<!-- --></span>
  __MY_APP_CONFIG__<span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 扩展 ImportMetaEnv</span>
<span class="token keyword">interface</span> <span class="token class-name">ImportMetaEnv</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">readonly</span> <span class="token constant">VITE_API_URL</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token keyword">readonly</span> <span class="token constant">VITE_APP_TITLE</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token comment">// 这里按需扩展其他自定义的 VITE 环境变量</span>
  <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 扩展 ImportMeta</span>
<span class="token keyword">interface</span> <span class="token class-name">ImportMeta</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">readonly</span> env<span class="token operator">:</span> ImportMetaEnv<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 声明静态资源模块（如 .svg、.png、.jpg 文件）</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'*.svg'</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> src<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> src<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'*.png'</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> src<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> src<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'*.jpg'</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> src<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> src<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'*.json'</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> json<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> json<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f706172616465303339332f:61727469636c652f64657461696c732f313436323131323137" class_="artid" style="display:none">
 </p>
</div>


