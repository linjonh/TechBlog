---
layout: post
title: "网络工具之流量测试工具nuttcp安装和使用"
date: 2022-01-05 08:00:00 +0800
description: "nuttcp是一种网络性能测量工具，供网络和系统管理员使用。它最基本的用途是确定原始TCP（或UDP"
keywords: "nuttcp"
categories: ['运维工具研究']
tags: ['网络流量测试', '测试工具', '带宽测试', 'Tcp', 'Nuttcp']
artid: "122242074"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=122242074
    alt: "网络工具之流量测试工具nuttcp安装和使用"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=122242074
featuredImagePreview: https://bing.ee123.net/img/rand?artid=122242074
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     网络工具之流量测试工具nuttcp安装和使用
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="nuttcp_0">
     </a>
     一、nuttcp简介
    </h2>
    <p>
     nuttcp是一种网络性能测量工具，供网络和系统管理员使用。它最基本的用途是确定原始TCP（或UDP）网络层吞吐量，方法是通过将内存缓冲区从源系统跨互连网络传输到目标系统，或者传输指定时间间隔的数据，或者传输指定数量的字节。除了以Mbps为单位报告已实现的网络吞吐量外，nuttcp还提供与数据传输相关的其他有用信息，如用户、系统和挂钟时间、发射机和接收机CPU利用率以及丢失百分比（对于UDP传输）。
     <br/>
     nuttcp基于nttcp，而nttcp又是Silicon Graphics（SGI）在原始ttcp上的一个增强，ttcp是1984年12月前某个时候由BRL的Mike Muuss编写的，用于比较U.C.Berkeley和BBN的TCP堆栈性能，以帮助DARPA决定将哪个版本放在第一个BSD Unix版本中。nuttcp除了基本的ttcp/nttcp之外，还有一些有用的特性，例如服务器模式、速率限制、多个并行流和基于计时器的使用。最近的变化包括IPv6支持、IPv4多播以及设置最大段大小或TOS/DSCP位的能力。nuttcp正在不断发展，以满足出现的新需求，并添加所需的新功能。nuttcp已经成功构建并运行在各种Solaris、SGI和PPC/X86 Linux系统上，并且可能在大多数Unix版本上运行良好。它还成功地用于各种版本的Windows操作系统。
    </p>
    <h2>
     <a id="_3">
     </a>
     二、安装步骤
    </h2>
    <h3>
     <a id="1_4">
     </a>
     1、下载软件包
    </h3>
    <blockquote>
     <p>
      nuttcp当前最新版本为8.2.2，发布时间是2020年5月11号。
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/0732a20b77d448db52cc04c3b4793cef.png"/>
     </p>
    </blockquote>
    <blockquote>
     <p>
      [root@s145 opt]# wget http://nuttcp.net/nuttcp/nuttcp-8.2.2.tar.bz2
     </p>
    </blockquote>
    <h3>
     <a id="2bzip2_9">
     </a>
     2、安装bzip2压缩工具
    </h3>
    <blockquote>
     <p>
      [root@s145 opt]# yum install -y bzip2
     </p>
    </blockquote>
    <h3>
     <a id="3_11">
     </a>
     3、解压软件包
    </h3>
    <blockquote>
     <p>
      [root@s145 opt]# tar -jxvf nuttcp-8.2.2.tar.bz2
     </p>
    </blockquote>
    <h3>
     <a id="4nuttcp_13">
     </a>
     4、编译nuttcp
    </h3>
    <blockquote>
     <p>
      [root@s145 nuttcp-8.2.2]# gcc -O2 -o nuttcp nuttcp-8.2.2.c
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/a106c71af02ea357faec5f8600f6f46c.png"/>
     </p>
    </blockquote>
    <h3>
     <a id="5_16">
     </a>
     5、查看命令版本
    </h3>
    <blockquote>
     <p>
      [root@s145 nuttcp-8.2.2]# ./nuttcp -V
      <br/>
      nuttcp-8.2.2
     </p>
    </blockquote>
    <h2>
     <a id="_19">
     </a>
     三、使用示例
    </h2>
    <h3>
     <a id="1nuttcp_20">
     </a>
     1、获取nuttcp命令帮助
    </h3>
    <blockquote>
     <p>
      [root@s145 nuttcp-8.2.2]# ./nuttcp --help
     </p>
    </blockquote>
    <h3>
     <a id="2nutcp_server_22">
     </a>
     2、开启nutcp server
    </h3>
    <blockquote>
     <p>
      [root@s145 nuttcp-8.2.2]# ./nuttcp -S
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/f7c04e0dda0c32be207ff6b1c9754929.png"/>
     </p>
    </blockquote>
    <h3>
     <a id="3sender_25">
     </a>
     3、sender主机上发送数据包
    </h3>
    <blockquote>
     <p>
      #默认发送10秒钟的数据包
      <br/>
      [root@s142 nuttcp-8.2.2]# ./nuttcp 192.168.0.145
      <br/>
      115.2640 MB / 10.33 sec = 93.6465 Mbps 0 %TX 11 %RX 0 retrans 1539 KB-cwnd 1.63 msRTT
      <br/>
      #说明s142和s145主机之间带宽是100M
      <br/>
      [root@s146 nuttcp-8.2.2]# ./nuttcp 192.168.0.145
      <br/>
      27935.5000 MB / 10.00 sec = 23436.2504 Mbps 73 %TX 97 %RX 0 retrans 2040 KB-cwnd 1.02 msRTT
      <br/>
      #s146和s145主机是两个虚拟机，在同一个宿主机上带宽可达23Gbps。
     </p>
    </blockquote>
    <h3>
     <a id="4server_33">
     </a>
     4、启动server时指定监听端口
    </h3>
    <blockquote>
     <p>
      #nuttcp支持启动多个server
      <br/>
      [root@s145 nuttcp-8.2.2]# ./nuttcp -S -P5001
      <br/>
      [root@s145 nuttcp-8.2.2]# netstat -tnpl
      <br/>
      Active Internet connections (only servers)
      <br/>
      Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name
      <br/>
      tcp 0 0 0.0.0.0:5000 0.0.0.0:* LISTEN 11262/./nuttcp
      <br/>
      tcp 0 0 0.0.0.0:5001 0.0.0.0:* LISTEN 11282/./nuttcp
      <br/>
      tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN 3494/sshd
      <br/>
      tcp 0 0 127.0.0.1:25 0.0.0.0:* LISTEN 4490/master
      <br/>
      tcp6 0 0 :::3306 ::😗 LISTEN 27669/mysqld
      <br/>
      tcp6 0 0 :::22 ::😗 LISTEN 3494/sshd
      <br/>
      tcp6 0 0 ::1:25 ::😗 LISTEN 4490/master
     </p>
    </blockquote>
    <h3>
     <a id="515001G_46">
     </a>
     5、发送1500字节大小的包1G
    </h3>
    <blockquote>
     <p>
      [root@s146 nuttcp-8.2.2]# ./nuttcp -n1G -l1500 192.168.0.145
      <br/>
      1023.9987 MB / 9.64 sec = 891.1428 Mbps 99 %TX 69 %RX 0 retrans 159 KB-cwnd 1.07 msRTT
     </p>
    </blockquote>
    <h3>
     <a id="61_50">
     </a>
     6、间隔1秒展示数据
    </h3>
    <blockquote>
     <p>
      [root@s142 nuttcp-8.2.2]# ./nuttcp -i1 192.168.0.145
      <br/>
      11.1250 MB / 1.00 sec = 93.3333 Mbps 0 retrans 547 KB-cwnd
      <br/>
      11.2500 MB / 1.00 sec = 94.3723 Mbps 0 retrans 1073 KB-cwnd
      <br/>
      11.1875 MB / 1.00 sec = 93.8473 Mbps 0 retrans 1539 KB-cwnd
      <br/>
      11.2500 MB / 1.00 sec = 94.3722 Mbps 0 retrans 1539 KB-cwnd
      <br/>
      11.1875 MB / 1.00 sec = 93.8467 Mbps 0 retrans 1539 KB-cwnd
      <br/>
      11.1875 MB / 1.00 sec = 93.8483 Mbps 0 retrans 1539 KB-cwnd
      <br/>
      11.2500 MB / 1.00 sec = 94.3714 Mbps 0 retrans 1539 KB-cwnd
      <br/>
      11.1875 MB / 1.00 sec = 93.8479 Mbps 0 retrans 1539 KB-cwnd
      <br/>
      11.1875 MB / 1.00 sec = 93.8476 Mbps 0 retrans 1539 KB-cwnd
      <br/>
      11.1875 MB / 1.00 sec = 93.8442 Mbps 0 retrans 1539 KB-cwnd
      <br/>
      <br/>
      115.3814 MB / 10.30 sec = 93.9696 Mbps 0 %TX 9 %RX 0 retrans 1539 KB-cwnd 1.60 msRTT
     </p>
    </blockquote>
    <h3>
     <a id="7_64">
     </a>
     7、反向测试
    </h3>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/3c6ae7c7a5dce041f14325386b77657d.png"/>
    </p>
    <h3>
     <a id="82M_66">
     </a>
     8、设置发射机窗口为2M
    </h3>
    <blockquote>
     <p>
      [root@s142 nuttcp-8.2.2]# ./nuttcp -w2m 192.168.0.145
      <br/>
      nuttcp-t: Warning: send window size 212992 &lt; requested window size 2097152
      <br/>
      nuttcp-r: Warning: receive window size 212992 &lt; requested window size 2097152
      <br/>
      112.4138 MB / 10.03 sec = 94.0136 Mbps 0 %TX 10 %RX 0 retrans 209 KB-cwnd 1.78 msRTT
     </p>
    </blockquote>
    <h3>
     <a id="9udp_71">
     </a>
     9、使用udp进行测试
    </h3>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/5c9f74b8aef1a6a8ad3d2f6f032b48b5.png"/>
    </p>
    <h3>
     <a id="101080Mbps_UDP5_74">
     </a>
     10、10个数据包的突发发送80Mbps UDP包并持续5秒
    </h3>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/6b6419bf36b2573725e039fad097009e.png"/>
    </p>
    <h2>
     <a id="nuttcp_77">
     </a>
     四、nuttcp命令常用参数建设
    </h2>
    <table>
     <thead>
      <tr>
       <th align="left">
        参数
       </th>
       <th align="left">
        参数说明
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td align="left">
        -S
       </td>
       <td align="left">
        服务器模式
       </td>
      </tr>
      <tr>
       <td align="left">
        -p##
       </td>
       <td align="left">
        要发送到的端口号
       </td>
      </tr>
      <tr>
       <td align="left">
        -P##
       </td>
       <td align="left">
        控制连接端口号，默认5000
       </td>
      </tr>
      <tr>
       <td align="left">
        -T##
       </td>
       <td align="left">
        传输超时，单位为秒（或（m
       </td>
      </tr>
      <tr>
       <td align="left">
        -i##
       </td>
       <td align="left">
        接收器间隔报告，以秒（或（m
       </td>
      </tr>
      <tr>
       <td align="left">
        -r
       </td>
       <td align="left">
        反向
       </td>
      </tr>
      <tr>
       <td align="left">
        -N##
       </td>
       <td align="left">
        平行流的数量
       </td>
      </tr>
      <tr>
       <td align="left">
        -u
       </td>
       <td align="left">
        使用UDP而不是TCP
       </td>
      </tr>
      <tr>
       <td align="left">
        -R 90m
       </td>
       <td align="left">
        （UDP的速率限制）
       </td>
      </tr>
      <tr>
       <td align="left">
        -Ri
       </td>
       <td align="left">
        设置数据包突发大小
       </td>
      </tr>
      <tr>
       <td align="left">
        -w##
       </td>
       <td align="left">
        发射机|接收机TCP窗口大小，单位为KB（或（m | m）B或（g | g）B）
       </td>
      </tr>
      <tr>
       <td align="left">
        -xt
       </td>
       <td align="left">
        跟踪路由功能。它显示了从服务器到客户端的路由，反之亦然
       </td>
      </tr>
     </tbody>
    </table>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c:6f672e6373646e2e6e65742f6361726566726565323030352f:61727469636c652f64657461696c732f313232323432303734" class_="artid" style="display:none">
 </p>
</div>


