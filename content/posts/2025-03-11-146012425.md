---
layout: post
title: "Cstring类的相关成员函数以及string的模拟实现"
date: 2025-03-11 21:23:30 +0800
description: "主要介绍了string类中常见的接口，以及相关的成员函数的模拟实现"
keywords: "【C++】string类的相关成员函数以及string的模拟实现"
categories: ['C']
tags: ['开发语言', 'C', 'C']
artid: "146012425"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146012425
    alt: "Cstring类的相关成员函数以及string的模拟实现"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146012425
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146012425
cover: https://bing.ee123.net/img/rand?artid=146012425
image: https://bing.ee123.net/img/rand?artid=146012425
img: https://bing.ee123.net/img/rand?artid=146012425
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     【C++】string类的相关成员函数以及string的模拟实现
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-github-gist" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <hr/>
    <h2>
     <a id="_5">
     </a>
     前言
    </h2>
    <blockquote>
     <p>
      在日常生活中呢？经常会用到字符串，比如：身份证号码，电话号码，家庭住址等。所以为了方便管理，就单独搞一份管理字符串的类型出来。所以就有了string类
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/7b90a73b271648a4981a266be6047178.jpeg#pic_center"/>
     </p>
    </blockquote>
    <hr/>
    <p>
     <strong>
      这里小编会从两个方向来了解string：
     </strong>
    </p>
    <ol>
     <li>
      <strong>
       string类的常用的接口
      </strong>
      （这里主要是最常用的接口，因为string的接口太多了，大概有一百多个接口）
     </li>
     <li>
      <strong>
       string的模拟实现
      </strong>
      <br/>
      <font color="red">
       <strong>
        注意
       </strong>
      </font>
      ：
      <strong>
       在使用string类时，必须包含#include头文件以及using namespace std;
      </strong>
     </li>
    </ol>
    <h2>
     <a id="string_18">
     </a>
     一、string类的常用接口
    </h2>
    <p>
     想学好string除外还要，还要结合文档来学习
     <a href="https://legacy.cplusplus.com/reference/clibrary/" rel="nofollow">
      https://legacy.cplusplus.com/reference/clibrary/
     </a>
     <br/>
     这个呢是C语言的一个标准库。我们可以通过这里看到string的全部成员函数以及相关介绍。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/4ce9d4779bc340cd8b48688469b4f41d.png">
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/4efdbae6ba0a486693b7d21d89db8ed7.png">
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/06aeddfb3f644d429c5156528b1ebe6c.png"/>
      </img>
     </img>
    </p>
    <p>
     接下来接结合这个文档来看一下string都有哪些常用的接口吧！
    </p>
    <h3>
     <a id="1_string_26">
     </a>
     1. string类对象的常见构造
    </h3>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/7735771ddbe74d31bb618e286f820737.png"/>
    </p>
    <ol>
     <li>
      string()：构造一个空的string类的对象，即空字符串。
     </li>
     <li>
      string (const string&amp; str)：拷贝构造函数。
     </li>
     <li>
      string (const string&amp; str, size_t pos, size_t len = npos)：复制str从字符pos开始的部分并跨越len字符（或直到str，如果str太短或len为string::npos）。
     </li>
     <li>
      string (const char* s);用C-string来构造string类对象.
     </li>
     <li>
      string (const char* s, size_t n);从s指向的字符数组中复制前n个字符。
     </li>
     <li>
      string (size_t n, char c);用n个字符来初始化。
     </li>
    </ol>
    <p>
     具体用法：
    </p>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string.h&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	string s1<span class="token punctuation">;</span><span class="token comment">//构造一个空的的string对象</span>
	cout <span class="token operator">&lt;&lt;</span> s1 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	string <span class="token function">s2</span><span class="token punctuation">(</span><span class="token string">"hello world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//用C格式字符串构造string类对象s2</span>
	cout <span class="token operator">&lt;&lt;</span> s2 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	string <span class="token function">s3</span><span class="token punctuation">(</span>s2<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//当我们给的参数大于npos的时候，编译器会以npos来运行</span>
	cout <span class="token operator">&lt;&lt;</span> s3 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token comment">//string s3(s2, 6);//如果不传参数，他也会按照npos来运行</span>
	<span class="token comment">//cout &lt;&lt; s3 &lt;&lt; endl;</span>
	<span class="token comment">//string s3(s2, 6, 4);//如果参数小于npos，那么编译器 就会按照传的直来运行</span>
	<span class="token comment">//cout &lt;&lt; s3 &lt;&lt; endl;</span>
	string <span class="token function">s4</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/// 拷贝构造s3</span>
	cout <span class="token operator">&lt;&lt;</span> s4 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	string <span class="token function">s5</span><span class="token punctuation">(</span><span class="token string">"hello world"</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> s5 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	string <span class="token function">s6</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token char">'x'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//用5个‘x’来初始化字符串</span>
	cout <span class="token operator">&lt;&lt;</span> s6 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/afb3cd3e22d94458bc63774f10f15b1c.png"/>
    </p>
    <h3>
     <a id="2iterator_63">
     </a>
     2.迭代器（iterator）
    </h3>
    <p>
     <font color="red">
      <strong>
       迭代器是一种访问容器内元素的接口，它允许我们在不暴露容器内部表示的情况下遍历容器中的所有元素
      </strong>
     </font>
     。在C++中，迭代器是一个重要的组成部分，尤其是在STL（标准模板库）中，迭代器提供了一种方法来访问容器中的元素，就像指针一样，但比指针更加通用和强大。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/bfe69ba2af95436881846735b48eba2c.png">
      <br/>
      begin是字符串起始的位置，end是字符串"\0"的位置。然而rbegin和rend则是反向迭代器。
      <br/>
      具体这样用呢？看代码：
     </img>
    </p>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string.h&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	string <span class="token function">s</span><span class="token punctuation">(</span><span class="token string">"hello world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> s <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> 
	string<span class="token double-colon punctuation">::</span>iterator it <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//反向迭代器只需要把begin换成rbegin。end也是要换成rend。</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>it <span class="token operator">!=</span> s<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>it<span class="token operator">&lt;&lt;</span><span class="token string">" "</span><span class="token punctuation">;</span>
		it<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/942f0083c78143e0b985a0e257837ae2.png"/>
    </p>
    <h3>
     <a id="3string_88">
     </a>
     3.string类对象的容量操作
    </h3>
    <ol>
     <li>
      size() :返回字符串的有效长度
     </li>
     <li>
      length(）:返回字符串的有效长度
     </li>
     <li>
      capacity（）：返回总空间的大小
     </li>
     <li>
      enmpty（）；检测字符串释放为空串，是返回true，否则返回false
     </li>
     <li>
      clear():清空有效字符
     </li>
     <li>
      reserve(size_t n ):开辟n个字符大小的空间
     </li>
     <li>
      resize（）:将有效字符的个数该成n个，多出的空间用字符c填充
     </li>
    </ol>
    <p>
     <font color="red">
      <strong>
       注意：
      </strong>
     </font>
     <br/>
     8. size()与length()方法底层实现原理完全相同，引入size()的原因是为了与其他容器的接口保持一致，一般情况下基本都是用size()。
     <br/>
     9. clear()只是将string中有效字符清空，不改变底层空间大小。
     <br/>
     10. resize(size_t n) 与 resize(size_t n, char c)都是将字符串中有效字符个数改变到n个,不同的是当字符个数增多时：resize(n)用0来填充多出的元素空间，resize(size_t n, char c)用字符c来填充多出的元素空间。注意：resize在改变元素个数时，如果是将元素个数增多，可能会改变底层容量的大小，如果是将元素个数减少，底层空间总大小不变
     <br/>
     11. reserve(size_t res_arg=0)：为string预留空间，不改变有效元素个数，当reserve的参数小于string的底层空间总大小时，reserver不会改变容量大小。
    </p>
    <h3>
     <a id="4string_103">
     </a>
     4.string类对象的修改操作
    </h3>
    <ol>
     <li>
      push_bank(char c):在字符串后面尾插一个字符c
     </li>
     <li>
      append(const char *str):在字符串后面追加一个字符串str
     </li>
     <li>
      opertaor+=（）在字符串后面追加一个字符串或者字符
     </li>
     <li>
      c_str():返回字符串
     </li>
     <li>
      find ：返回查找字符在字符串中位置（下标）
     </li>
     <li>
      substr():在str中从pos位置开始，截取n个字符，然后将其返回
      <br/>
      <strong>
       注意：
      </strong>
     </li>
    </ol>
    <ul>
     <li>
      在string尾部追加字符时，s.push_back© / s.append(1, c) / s += 'c’三种的实现方式差不多，一般情况下string类的+=操作用的比较多，+=操作不仅可以连接单个字符，还可以连接字符串。
     </li>
     <li>
      对string操作时，如果能够大概预估到放多少字符，可以先通过reserve把空间预留
      <br/>
      好。
     </li>
    </ul>
    <h3>
     <a id="5string_115">
     </a>
     5.string类非成员函数
    </h3>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/d67a63c5dc444c418d49c0cdcc596f6f.png"/>
     <br/>
     以上就是常见的string的接口了。如果还有其他的话那就去查文档吧！上面有链接的。这里小编带着大家来看看string的底层（模拟实现）。这里我不一一写出来了。
    </p>
    <h2>
     <a id="string_118">
     </a>
     二、string的模拟实现
    </h2>
    <p>
     这里我们需要创建三个文件: string.cpp string.h test.cpp 。这里我们用到了一个namespace和一个类来封装一下。具体代码请看下面：
    </p>
    <h3>
     <a id="1stringh_121">
     </a>
     1.string.h文件
    </h3>
    <pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_CRT_SECURE_NO_WARNINGS</span> <span class="token expression"><span class="token number">1</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;assert.h&gt;</span></span>
using namespace std<span class="token punctuation">;</span>
namespace S
<span class="token punctuation">{<!-- --></span>
	class string 
	<span class="token punctuation">{<!-- --></span>
	public<span class="token operator">:</span>
		<span class="token comment">//string()//默认构造函数</span>
		<span class="token comment">//	:_str(new char [1]{'\0'})</span>
		<span class="token comment">//	, _size(0) </span>
		<span class="token comment">//	,_capacity(0) </span>
		<span class="token comment">//{}</span>
		<span class="token comment">//短小且频繁使用的函数，可以直接定义到类里面，默认是内联函数（inline)</span>
	
	<span class="token comment">//初始化，这里给"\0"是为了防止传的是空的字符。如果不写并且传的是空的话，</span>
	<span class="token comment">//那么后面在c_str哪里返回时就要解引用，但是不能对空指针解引用，所以这里就会报错。</span>
    <span class="token comment">//当然这里也可以不用这样子写。可以用上面被注释掉的代码。但是这样要方便一点</span>
		<span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> s <span class="token operator">=</span> <span class="token string">"\0"</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_size <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
			_capacity <span class="token operator">=</span> _size<span class="token punctuation">;</span>
			_str <span class="token operator">=</span> new <span class="token keyword">char</span><span class="token punctuation">[</span>_capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
				<span class="token function">strcpy</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token operator">~</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//析构函数</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>_str<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				delete<span class="token punctuation">[</span><span class="token punctuation">]</span>_str<span class="token punctuation">;</span>
				_str <span class="token operator">=</span> nullptr<span class="token punctuation">;</span>
				_size <span class="token operator">=</span> _capacity <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> str<span class="token punctuation">)</span><span class="token comment">//拷贝构造</span>
		<span class="token punctuation">{<!-- --></span>
			_str <span class="token operator">=</span> new <span class="token keyword">char</span><span class="token punctuation">[</span>str<span class="token punctuation">.</span>_capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token function">strcpy</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> str<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
			_size <span class="token operator">=</span> str<span class="token punctuation">.</span>_size<span class="token punctuation">;</span>
			_capacity <span class="token operator">=</span> str<span class="token punctuation">.</span>_capacity<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//取到_str中的数据</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _str<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token class-name">size_t</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span><span class="token comment">//返回字符串中的有效大小</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _size<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">char</span><span class="token operator">&amp;</span> operator<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> pos<span class="token punctuation">)</span><span class="token comment">//返回pos的数据,可以修改的</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> _str<span class="token punctuation">[</span>pos<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">&amp;</span> operator<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> pos<span class="token punctuation">)</span><span class="token keyword">const</span><span class="token comment">//只返回pos的数据，不能修改</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> _str<span class="token punctuation">[</span>pos<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">typedef</span> <span class="token keyword">char</span><span class="token operator">*</span> iterator<span class="token punctuation">;</span><span class="token comment">//迭代器</span>
		iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _str<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _str <span class="token operator">+</span> _size<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">typedef</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> const_iterator<span class="token punctuation">;</span><span class="token comment">//cosnt_iterator迭代器</span>
		const_iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span> 
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _str<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		const_iterator  <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span> 
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _str <span class="token operator">+</span> _size<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//清空有效字符</span>
		<span class="token punctuation">{<!-- --></span>
			_str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
			_size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token comment">//上面的代码比较短，比较简单，所以就可以在类里面实现。默认是内联（inline），</span>
		<span class="token comment">//这里我们重点讲一下以下这些成员函数吧。</span>
	    <span class="token keyword">void</span>  <span class="token function">reserve</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">void</span> <span class="token function">push_bank</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">void</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		string<span class="token operator">&amp;</span> operator<span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
		string<span class="token operator">&amp;</span> operator<span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		string<span class="token operator">&amp;</span> operator<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> pos<span class="token punctuation">,</span> <span class="token keyword">char</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> pos<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">void</span> <span class="token function">erase</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> pos<span class="token punctuation">,</span> <span class="token class-name">size_t</span> len<span class="token operator">=</span> npos<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">size_t</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">,</span> <span class="token class-name">size_t</span> pos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		string <span class="token function">substr</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> pos<span class="token punctuation">,</span> <span class="token class-name">size_t</span> len<span class="token operator">=</span>npos<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
	private<span class="token operator">:</span>
		<span class="token keyword">char</span><span class="token operator">*</span> _str<span class="token punctuation">;</span>
		<span class="token class-name">size_t</span> _size<span class="token punctuation">;</span>
		<span class="token class-name">size_t</span> _capacity<span class="token punctuation">;</span>
		<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token class-name">size_t</span> npos<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	ostream<span class="token operator">&amp;</span> operator<span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> out<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
	istream<span class="token operator">&amp;</span> operator <span class="token operator">&gt;&gt;</span> <span class="token punctuation">(</span>istream<span class="token operator">&amp;</span> in<span class="token punctuation">,</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">test_string5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="2string_233">
     </a>
     2.string的相关成员函数的实现：
    </h3>
    <ol>
     <li>
      void reserve(size_t n) ：开辟n个字符大小的空间，开空间的顺序是：先开好n个新的空间（tmp），然后在把tmp拷贝给_str，然后在释放掉旧的空间（_str），在让_str指向新的空间tmp，最后再把空间容量改成n就行了
     </li>
    </ol>
    <pre><code class="prism language-cpp"><span class="token keyword">void</span>  string<span class="token double-colon punctuation">::</span><span class="token function">reserve</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">)</span><span class="token comment">//扩容</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span><span class="token comment">//这里是为了这个函数单独使用</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">char</span><span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//多开一个空间</span>
		<span class="token function">strcpy</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> _str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span>_str<span class="token punctuation">;</span>
		_str <span class="token operator">=</span> tmp<span class="token punctuation">;</span> 
		_capacity <span class="token operator">=</span> n<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     2.void push_bank(char ch);在字符串的后面插入一个字符。这里需要注意的是_str[_size] = ‘\0’，如果这里不写这段代码的话。那么程序运行的结果就会跟我们预想的不一样。这里是因为我们在原来的字符串’\0’插入了一个字符ch。都知道字符串是以’\0’结束的。如果这里不在新的字符串后面插入’\0’，那么运行的结果就是在新的字符串后面会出现随之值直到把空间装满。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/94b3fa5f28414b70be41296bb75ae993.png"/>
    </p>
    <pre><code class="prism language-cpp"><span class="token keyword">void</span> string<span class="token double-colon punctuation">::</span><span class="token function">push_bank</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">)</span><span class="token comment">//插入</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">==</span> _capacity<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">reserve</span><span class="token punctuation">(</span>_capacity <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">4</span> <span class="token operator">:</span> <span class="token number">2</span> <span class="token operator">*</span> _capacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	_str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span>
	<span class="token operator">++</span>_size<span class="token punctuation">;</span>
	_str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span><span class="token comment">//这里特别要注意</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     void append(const char
     <em>
      str);在字符串后面追加一个字符串，这里需要注意的即使扩容哪里。如果len+_size小于2
     </em>
     _capacity，要多少空间就给多大的空间。如果大于就按2*_capacity来扩容
    </p>
    <pre><code class="prism language-cpp"><span class="token keyword">void</span> string<span class="token double-colon punctuation">::</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span><span class="token comment">//在字符串之后添加一个字符串</span>
<span class="token punctuation">{<!-- --></span>
	size_t len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">+</span> len <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">//小于2*_capacity，要多少空间就给多大的空间。如果大于就按2*_capacity来扩容</span>
		<span class="token function">reserve</span><span class="token punctuation">(</span>len <span class="token operator">+</span> _size <span class="token operator">&lt;</span> <span class="token number">2</span> <span class="token operator">*</span> _capacity <span class="token operator">?</span> len <span class="token operator">+</span> _size <span class="token operator">:</span> <span class="token number">2</span> <span class="token operator">*</span> _capacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">strcpy</span><span class="token punctuation">(</span>_str <span class="token operator">+</span> _size<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span> 
	<span class="token comment">/*for (int i = 0; i &lt; len; i++)//这里的效果跟strcpy是一样的
	{
		_str[_size+i] = str[i];
	}
	_str[_size+len] = '\0';
	_size += len;*/</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     string&amp; operator+= (char ch);
     <br/>
     string&amp; operator+=(const char *_str);
     <br/>
     由于这两个函数比较简单所以就全部写出来：
    </p>
    <pre><code class="prism language-cpp">string<span class="token operator">&amp;</span> string<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">)</span><span class="token comment">//+=一个字符</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">push_bank</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
string<span class="token operator">&amp;</span> string <span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> _str<span class="token punctuation">)</span><span class="token comment">//+=一个字符串</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">append</span><span class="token punctuation">(</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     string&amp; operator=(const string&amp; s);赋值运算符重载，其实这里跟拷贝构造差不多，但是这里要考虑一下自己给自己赋值的情况。虽然运行会报错，但是这样的语法是正确的。所以这里要处理这里情况。
    </p>
    <pre><code class="prism language-cpp">string<span class="token operator">&amp;</span> string <span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token comment">//赋值</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">!=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token comment">//这里就是小心自己给自己赋值的情况</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span>_str<span class="token punctuation">;</span><span class="token comment">//先释放掉原来的空间</span>
		_str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>s<span class="token punctuation">.</span>_capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token function">strcpy</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		_size <span class="token operator">=</span> s<span class="token punctuation">.</span>_size<span class="token punctuation">;</span>
		_capacity <span class="token operator">=</span> s<span class="token punctuation">.</span>_capacity<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     void insert(size_t pos, char ch);在指定的位置插入一个字符ch。这里代码运行的原理就是挪动数据。跟之前顺序表哪里一样的。
    </p>
    <pre><code class="prism language-cpp"><span class="token keyword">void</span> string <span class="token double-colon punctuation">::</span><span class="token function">insert</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> <span class="token keyword">char</span> ch<span class="token punctuation">)</span><span class="token comment">//在pos点插入一个字符</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">=</span> _capacity<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">reserve</span><span class="token punctuation">(</span>_capacity <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">4</span> <span class="token operator">:</span> <span class="token number">2</span> <span class="token operator">*</span> _capacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	size_t end <span class="token operator">=</span> _size<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//这里从'\0'的下一个位置开始插入，防止pos&lt;=end在比较的过程中的隐式类型转换</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>pos<span class="token operator">&lt;</span>end<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_str<span class="token punctuation">[</span>end<span class="token punctuation">]</span> <span class="token operator">=</span> _str<span class="token punctuation">[</span>end <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token operator">--</span>end<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	_str<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span>
	<span class="token operator">++</span>_size<span class="token punctuation">;</span>
	
<span class="token punctuation">}</span>
</code></pre>
    <p>
     void insert(size_t pos, const char* str);在pos点插入一个字符串。原理还是挪动数据，只不过这里是挪动str的大小的数据。
    </p>
    <pre><code class="prism language-cpp"><span class="token keyword">void</span> string<span class="token double-colon punctuation">::</span> <span class="token function">insert</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span> <span class="token comment">//在pos插入一个字符串</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
	size_t len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">+</span> _size <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">reserve</span><span class="token punctuation">(</span>len <span class="token operator">+</span> _size <span class="token operator">&lt;</span> <span class="token number">2</span> <span class="token operator">*</span> _capacity <span class="token operator">?</span> len <span class="token operator">+</span> _size <span class="token operator">:</span> <span class="token number">2</span> <span class="token operator">*</span> _capacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	size_t end <span class="token operator">=</span> len <span class="token operator">+</span> _size<span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>pos<span class="token operator">+</span>len<span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&lt;</span> end<span class="token punctuation">)</span><span class="token comment">//这里要仔细思考，建议画图了解，跟上面插入一个字符的相似</span>
	<span class="token punctuation">{<!-- --></span>
		_str<span class="token punctuation">[</span>end<span class="token punctuation">]</span><span class="token operator">=</span> _str<span class="token punctuation">[</span>end <span class="token operator">-</span> len<span class="token punctuation">]</span><span class="token punctuation">;</span> 
		<span class="token operator">--</span>end<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_str<span class="token punctuation">[</span>pos <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	_size <span class="token operator">+=</span> len<span class="token punctuation">;</span>
	
<span class="token punctuation">}</span>
</code></pre>
    <p>
     void erase(size_t pos, size_t len= npos)：删除pos之后的len个字符。这个要分两种情况，一种是想删除的数据的大小要大于或等于字符串的大小。第二种就是小于字符串的大小的。npos是最大有效数据的大小。
    </p>
    <pre><code class="prism language-cpp"><span class="token keyword">void</span> string<span class="token double-colon punctuation">::</span> <span class="token function">erase</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> size_t len <span class="token punctuation">)</span><span class="token comment">//删除pos之后的len个字符</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">assert</span><span class="token punctuation">(</span>pos<span class="token operator">&lt;</span>_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">&gt;</span> _size <span class="token operator">-</span> pos<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_str<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
		_size <span class="token operator">=</span> pos<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> pos <span class="token operator">+</span> len<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> _size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">//挪动数据</span>
		<span class="token punctuation">{<!-- --></span>
			_str<span class="token punctuation">[</span>i <span class="token operator">-</span> len<span class="token punctuation">]</span> <span class="token operator">=</span> _str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		_size <span class="token operator">-=</span> len<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
<span class="token punctuation">}</span>
</code></pre>
    <p>
     size_t find(char ch, size_t pos = 0);查找。找到了就返回对应的位置。没有找到就返回npos
    </p>
    <pre><code class="prism language-cpp">size_t string<span class="token double-colon punctuation">::</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">,</span> size_t pos<span class="token punctuation">)</span><span class="token comment">//查找</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> pos<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> _size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>ch <span class="token operator">==</span> _str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span> i<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> npos<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     string subtr(size_t pos, size_t len=npos);拷贝pos到len之间的数据。这里分两种情况。len大于或等于_size-pos。那就要重新更新一下len。len的大小就是_size-pos。另一种则是小于。大小就是len。
    </p>
    <pre><code class="prism language-cpp">string string <span class="token double-colon punctuation">::</span><span class="token function">substr</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> size_t len <span class="token punctuation">)</span><span class="token comment">//拷贝pos到len之间的数据</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;=</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">&gt;</span> _size <span class="token operator">-</span> pos<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		len <span class="token operator">=</span> _size <span class="token operator">-</span> pos<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	string sub<span class="token punctuation">;</span>
	sub<span class="token punctuation">.</span><span class="token function">reserve</span><span class="token punctuation">(</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//提前开好空间，提高效率</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span>len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		sub <span class="token operator">+=</span> _str<span class="token punctuation">[</span>i <span class="token operator">+</span> pos<span class="token punctuation">]</span><span class="token punctuation">;</span> 
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> sub<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <font color="red">
      <strong>
       注意
      </strong>
      ：
     </font>
     这里我们在调用这个函数的时候，一定要写拷贝构造函数。因为我们这里是传值传参，那就要调用拷贝构造。当我们没有显示写拷贝构造的时候，编译器会自动生成一个拷贝构造函数。但是这里是自定义类型，所以这里当没有显示写拷贝构造时，默认为浅浅拷贝。自定义类型的浅拷贝呢会存在一个问题就是这里会调用两次析构函数。同一块空间是不可以同时析构两次的。这里相当于野指针一样。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/c62a2d623fe44916b4463ed670a156c6.png"/>
     <br/>
     这里sub会拷贝到这个临时对象中，然后在拷贝给ret，这里有的编译器这里会优化。但是这里sub是出了作用域就会销毁。销毁了是不是他指向的空间都被销毁了啊。那ret也是指向sub指向的空间。那是不是就指向一个野指针啊？
    </p>
    <p>
     ostream&amp; operator&lt;&lt;(ostream&amp; out, const string&amp; s);流提取。
    </p>
    <pre><code class="prism language-cpp">ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> out<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> e <span class="token operator">:</span> s<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		out <span class="token operator">&lt;&lt;</span> e<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> out<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     istream&amp; operator &gt;&gt; (istream&amp; in, string&amp; s);流插入，这里我们可以为了提高效率，来定义一个数组，依次放入数据，当放满了在插入到字符串中。这里就是减少了开空间次数。当然这里可以根据个人爱好来决定程序运行的效率。只不过这样效率要高一点。
    </p>
    <pre><code class="prism language-cpp">istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span> <span class="token operator">&gt;&gt;</span> <span class="token punctuation">(</span>istream<span class="token operator">&amp;</span> in<span class="token punctuation">,</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">const</span> <span class="token keyword">int</span> N <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> buff<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token comment">//char buff[256] = { 0 };</span>
	<span class="token keyword">char</span> ch<span class="token punctuation">;</span>
	ch<span class="token operator">=</span>in<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//一个一个字符的提取</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">!=</span> <span class="token char">'\n'</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		buff<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			buff<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
			s <span class="token operator">+=</span> buff<span class="token punctuation">;</span>
			i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		ch<span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		buff<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
		s <span class="token operator">+=</span> buff<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
		<span class="token keyword">return</span> in<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     拷贝构造的现代写法：
    </p>
    <pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span>string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span> 
<span class="token punctuation">{<!-- --></span>
	std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//这里要用库里面的交换函数，不然他会调用他自己</span>
	std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_size<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_size<span class="token punctuation">)</span><span class="token punctuation">;</span>  
	std<span class="token double-colon punctuation">::</span><span class="token function">swap</span><span class="token punctuation">(</span>_capacity<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_capacity<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
<span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token comment">//拷贝构造的现代写法，让编译器自己去构造，然后在交换</span>
<span class="token punctuation">{<!-- --></span>
	string <span class="token function">tmp</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">swap</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> str<span class="token punctuation">)</span><span class="token comment">//拷贝构造的传统写法</span>
<span class="token punctuation">{<!-- --></span>
	_str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>str<span class="token punctuation">.</span>_capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">strcpy</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> str<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
	_size <span class="token operator">=</span> str<span class="token punctuation">.</span>_size<span class="token punctuation">;</span>
	_capacity <span class="token operator">=</span> str<span class="token punctuation">.</span>_capacity<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="3stringcpp_485">
     </a>
     3.string.cpp文件
    </h3>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"string.h"</span></span>
<span class="token keyword">namespace</span> S
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">void</span>  string<span class="token double-colon punctuation">::</span><span class="token function">reserve</span><span class="token punctuation">(</span>size_t n<span class="token punctuation">)</span><span class="token comment">//扩容</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span><span class="token comment">//这里是为了这个函数单独使用</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">char</span><span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//多开一个空间</span>
			<span class="token function">strcpy</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> _str<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span>_str<span class="token punctuation">;</span>
			_str <span class="token operator">=</span> tmp<span class="token punctuation">;</span> 
			_capacity <span class="token operator">=</span> n<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> string<span class="token double-colon punctuation">::</span><span class="token function">push_bank</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">)</span><span class="token comment">//插入</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">==</span> _capacity<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">reserve</span><span class="token punctuation">(</span>_capacity <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">4</span> <span class="token operator">:</span> <span class="token number">2</span> <span class="token operator">*</span> _capacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		_str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span>
		<span class="token operator">++</span>_size<span class="token punctuation">;</span>
		_str<span class="token punctuation">[</span>_size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span><span class="token comment">//这里特别要注意</span>
	<span class="token punctuation">}</span>
	string<span class="token operator">&amp;</span> string <span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span><span class="token comment">//赋值</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">!=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token comment">//这里就是小心自己给自己赋值的情况</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span>_str<span class="token punctuation">;</span><span class="token comment">//先释放掉原来的空间</span>
			_str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>s<span class="token punctuation">.</span>_capacity <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token function">strcpy</span><span class="token punctuation">(</span>_str<span class="token punctuation">,</span> s<span class="token punctuation">.</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
			_size <span class="token operator">=</span> s<span class="token punctuation">.</span>_size<span class="token punctuation">;</span>
			_capacity <span class="token operator">=</span> s<span class="token punctuation">.</span>_capacity<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	string<span class="token operator">&amp;</span> string<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">)</span><span class="token comment">//+=一个字符</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">push_bank</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> string<span class="token double-colon punctuation">::</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span><span class="token comment">//在字符串之后添加一个字符串</span>
	<span class="token punctuation">{<!-- --></span>
		size_t len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">+</span> len <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token comment">//小于2*_capacity，要多少空间就给多大的空间。如果大于就按2*_capacity来扩容</span>
			<span class="token function">reserve</span><span class="token punctuation">(</span>len <span class="token operator">+</span> _size <span class="token operator">&lt;</span> <span class="token number">2</span> <span class="token operator">*</span> _capacity <span class="token operator">?</span> len <span class="token operator">+</span> _size <span class="token operator">:</span> <span class="token number">2</span> <span class="token operator">*</span> _capacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token function">strcpy</span><span class="token punctuation">(</span>_str <span class="token operator">+</span> _size<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span> 
		<span class="token comment">/*for (int i = 0; i &lt; len; i++)//这里的效果跟strcpy是一样的
		{
			_str[_size+i] = str[i];
		}
		_str[_size+len] = '\0';
		_size += len;*/</span>
	<span class="token punctuation">}</span>
	string<span class="token operator">&amp;</span> string <span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> _str<span class="token punctuation">)</span><span class="token comment">//+=一个字符串</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">append</span><span class="token punctuation">(</span>_str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> string <span class="token double-colon punctuation">::</span><span class="token function">insert</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> <span class="token keyword">char</span> ch<span class="token punctuation">)</span><span class="token comment">//在pos点插入一个字符</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>_size <span class="token operator">=</span> _capacity<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">reserve</span><span class="token punctuation">(</span>_capacity <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">4</span> <span class="token operator">:</span> <span class="token number">2</span> <span class="token operator">*</span> _capacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		size_t end <span class="token operator">=</span> _size<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>pos<span class="token operator">&lt;</span>end<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_str<span class="token punctuation">[</span>end<span class="token punctuation">]</span> <span class="token operator">=</span> _str<span class="token punctuation">[</span>end <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token operator">--</span>end<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		_str<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span>
		<span class="token operator">++</span>_size<span class="token punctuation">;</span>
		
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> string<span class="token double-colon punctuation">::</span> <span class="token function">insert</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> str<span class="token punctuation">)</span> <span class="token comment">//在pos插入一个字符串</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
		size_t len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">+</span> _size <span class="token operator">&gt;</span> _capacity<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">reserve</span><span class="token punctuation">(</span>len <span class="token operator">+</span> _size <span class="token operator">&lt;</span> <span class="token number">2</span> <span class="token operator">*</span> _capacity <span class="token operator">?</span> len <span class="token operator">+</span> _size <span class="token operator">:</span> <span class="token number">2</span> <span class="token operator">*</span> _capacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		size_t end <span class="token operator">=</span> len <span class="token operator">+</span> _size<span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>pos<span class="token operator">+</span>len<span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&lt;</span> end<span class="token punctuation">)</span><span class="token comment">//这里要仔细思考，建议画图了解</span>
		<span class="token punctuation">{<!-- --></span>
			_str<span class="token punctuation">[</span>end<span class="token punctuation">]</span><span class="token operator">=</span> _str<span class="token punctuation">[</span>end <span class="token operator">-</span> len<span class="token punctuation">]</span><span class="token punctuation">;</span> 
			<span class="token operator">--</span>end<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_str<span class="token punctuation">[</span>pos <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		_size <span class="token operator">+=</span> len<span class="token punctuation">;</span>
		
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> string<span class="token double-colon punctuation">::</span> <span class="token function">erase</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> size_t len <span class="token punctuation">)</span><span class="token comment">//删除pos之后的len个字符</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">&gt;</span> _size <span class="token operator">-</span> pos<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			_str<span class="token punctuation">[</span>pos<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
			_size <span class="token operator">=</span> pos<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> pos <span class="token operator">+</span> len<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> _size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				_str<span class="token punctuation">[</span>i <span class="token operator">-</span> len<span class="token punctuation">]</span> <span class="token operator">=</span> _str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			_size <span class="token operator">-=</span> len<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
	<span class="token punctuation">}</span>
	size_t string<span class="token double-colon punctuation">::</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">,</span> size_t pos<span class="token punctuation">)</span><span class="token comment">//查找</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> pos<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> _size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>ch <span class="token operator">==</span> _str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
				<span class="token keyword">return</span> i<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> npos<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	string string <span class="token double-colon punctuation">::</span><span class="token function">substr</span><span class="token punctuation">(</span>size_t pos<span class="token punctuation">,</span> size_t len <span class="token punctuation">)</span><span class="token comment">//拷贝pos到len之间的数据</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">assert</span><span class="token punctuation">(</span>pos <span class="token operator">&lt;=</span> _size<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">&gt;</span> _size <span class="token operator">-</span> pos<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			len <span class="token operator">=</span> _size <span class="token operator">-</span> pos<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		string sub<span class="token punctuation">;</span>
		sub<span class="token punctuation">.</span><span class="token function">reserve</span><span class="token punctuation">(</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//提前开好空间，提高效率</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span>len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			sub <span class="token operator">+=</span> _str<span class="token punctuation">[</span>i <span class="token operator">+</span> pos<span class="token punctuation">]</span><span class="token punctuation">;</span> 
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> sub<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> out<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> e <span class="token operator">:</span> s<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token generic-function"><span class="token function">out</span> <span class="token generic class-name"><span class="token operator">&lt;&lt;</span> e<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> out<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	istream<span class="token operator">&amp;</span> <span class="token keyword">operator</span> <span class="token operator">&gt;&gt;</span></span></span> <span class="token punctuation">(</span>istream<span class="token operator">&amp;</span> in<span class="token punctuation">,</span> string<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">const</span> <span class="token keyword">int</span> N <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
		<span class="token keyword">char</span> buff<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token comment">//char buff[256] = { 0 };</span>
		<span class="token keyword">char</span> ch<span class="token punctuation">;</span>
		ch<span class="token operator">=</span>in<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span> <span class="token punctuation">(</span>ch <span class="token operator">!=</span> <span class="token char">'\n'</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			buff<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> N <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				buff<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
				s <span class="token operator">+=</span> buff<span class="token punctuation">;</span>
				i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			ch<span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			buff<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
			s <span class="token operator">+=</span> buff<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token comment">//in &gt;&gt; ch;</span>
		<span class="token comment">//while (ch!=' '&amp;&amp;ch!='\0')//in在输入和提取任何类型的值时默认空格和换行都是分隔符，</span>
		<span class="token comment">//	//所以这里就要用到get().</span>
		<span class="token comment">//{<!-- --></span>
		<span class="token comment">//	s += ch;</span>
		<span class="token comment">//	cin &gt;&gt; ch;</span>
		<span class="token comment">//}</span>

		<span class="token keyword">return</span> in<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">test_string5</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>

	string <span class="token function">s</span><span class="token punctuation">(</span><span class="token string">"hello world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	string ret <span class="token operator">=</span> s<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> ret<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	
	<span class="token comment">/*size_t ret = s.find('w');
	string s1=s.subtr(ret);
	cout &lt;&lt; s1.c_str() &lt;&lt; endl;
	string copy(s);*/</span>
	<span class="token comment">//cout &lt;&lt; copy.c_str() &lt;&lt; endl;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="4testcpp_685">
     </a>
     4.test.cpp文件
    </h3>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">"string.h"</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token class-name">S</span><span class="token double-colon punctuation">::</span><span class="token function">test_string5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h2>
     <a id="autofor_695">
     </a>
     三、auto和范围for
    </h2>
    <p>
     这里小编补充一个知识点，就是auto关键字和范围for。
    </p>
    <ol>
     <li>
      auto声明的变量必须由编译器在编译时期推导而得
     </li>
     <li>
      auto不能作为函数的参数，可以做返回值，但是建议谨慎使用
     </li>
     <li>
      .auto不能直接用来声明数组
     </li>
     <li>
      用auto声明指针类型时，用auto和auto*没有任何区别，但用auto声明引用类型时则必须加&amp;
     </li>
     <li>
      当在同一行声明多个变量时，这些变量必须是相同的类型，否则编译器将会报错，因为编译器实际只对第一个类型进行推导，然后用推导出来的类型定义其他变量。
     </li>
    </ol>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">auto</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
	<span class="token keyword">auto</span> b<span class="token operator">=</span> <span class="token number">2.2</span><span class="token punctuation">;</span>
	<span class="token keyword">auto</span> d <span class="token operator">=</span> <span class="token char">'c'</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">typeid</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">typeid</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">typeid</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">auto</span> aa <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> bb <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token comment">// 编译报错：error C3538: 在声明符列表中，“auto”必须始终推导为同一类型</span>
	<span class="token keyword">auto</span> cc <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> dd <span class="token operator">=</span> <span class="token number">4.0</span>

    <span class="token comment">// 编译报错：error C3318: “auto []”: 数组不能具有其中包含“auto”的元素类型</span>
	<span class="token keyword">auto</span> array<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span> <span class="token punctuation">}</span>
	
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      auto的用途：
     </strong>
    </p>
    <pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
std<span class="token double-colon punctuation">::</span>map<span class="token operator">&lt;</span>std<span class="token double-colon punctuation">::</span>string<span class="token punctuation">,</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&gt;</span> dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token punctuation">{<!-- --></span> <span class="token string">"apple"</span><span class="token punctuation">,</span> <span class="token string">"苹果"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span> <span class="token string">"orange"</span><span class="token punctuation">,</span>
<span class="token string">"橙子"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token string">"pear"</span><span class="token punctuation">,</span><span class="token string">"梨"</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// auto的用武之地</span>
<span class="token comment">//std::map&lt;std::string, std::string&gt;::iterator it = dict.begin();</span>
<span class="token keyword">auto</span> it <span class="token operator">=</span> dict<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>it <span class="token operator">!=</span> dict<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
cout <span class="token operator">&lt;&lt;</span> it<span class="token operator">-&gt;</span>first <span class="token operator">&lt;&lt;</span> <span class="token string">":"</span> <span class="token operator">&lt;&lt;</span> it<span class="token operator">-&gt;</span>second <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token operator">++</span>it<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
之前实现的迭代器代码那里也可以这样写。
<span class="token comment">//string::iterator it = s1.begin();</span>
<span class="token keyword">auto</span> it<span class="token operator">=</span>s1<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>it <span class="token operator">!=</span> s1<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>it<span class="token punctuation">;</span>
	<span class="token operator">++</span>it<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
</code></pre>
    <h3>
     <a id="2for_751">
     </a>
     2.范围for
    </h3>
    <ol>
     <li>
      对于一个有范围的集合而言，由程序员来说明循环的范围是多余的，有时候还会容易犯错误。因此C++11中引入了基于范围的for循环。f
      <strong>
       or循环后的括号由冒号“ ：”分为两部分：第一部分是范围内用于迭代的变量，第二部分则表示被迭代的范围，自动迭代，自动取数据，自动判断结束。
      </strong>
     </li>
     <li>
      <strong>
       范围for可以作用到数组和容器对象上进行遍历
      </strong>
     </li>
     <li>
      <strong>
       范围for的底层很简单，容器遍历实际就是替换为迭代器
      </strong>
      ，这个从汇编层也可以看到。
     </li>
    </ol>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;map&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// C++98的遍历</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
array<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
cout <span class="token operator">&lt;&lt;</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// C++11的遍历</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> e <span class="token operator">:</span> array<span class="token punctuation">)</span>
e <span class="token operator">*=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> e <span class="token operator">:</span> array<span class="token punctuation">)</span>
cout <span class="token operator">&lt;&lt;</span> e <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
string <span class="token function">str</span><span class="token punctuation">(</span><span class="token string">"hello world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> ch <span class="token operator">:</span> str<span class="token punctuation">)</span><span class="token comment">//依次把str中的数据给ch</span>
<span class="token punctuation">{<!-- --></span>
cout <span class="token operator">&lt;&lt;</span> ch <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <hr/>
    <p>
     <font color="orange">
      今天的分享就到这里吧，祝大家天天开心！
     </font>
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/7ec2221430b44513934f7014e0337e50.png"/>
    </p>
    <h2>
     <a id="_795">
     </a>
     总结
    </h2>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f6a686a393230313633332f:61727469636c652f64657461696c732f313436303132343235" class_="artid" style="display:none">
 </p>
</div>


