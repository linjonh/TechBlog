---
layout: post
title: "深入云原生解析-Docker-容器Serverless-计算和微服务架构的实战应用"
date: 2024-04-02 09:55:41 +0800
description: "本文详细解读了《2023腾讯云容器和函数计算技术实践精选集》，涉及StableDiffusion部署"
keywords: "容器 serverless"
categories: ['云计算解决方案与架构Fy23H2Fy24']
tags: ['架构', '云计算', '云原生', 'Docker']
artid: "137094957"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=137094957
    alt: "深入云原生解析-Docker-容器Serverless-计算和微服务架构的实战应用"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=137094957
featuredImagePreview: https://bing.ee123.net/img/rand?artid=137094957
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     深入云原生：解析 Docker 容器、Serverless 计算和微服务架构的实战应用
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-dracula" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/d2e62db60dfeb17257d92769f8df0a98.png"/>
    </p>
    <p>
    </p>
    <div class="toc">
     <h4>
      文章目录
     </h4>
     <ul>
      <li>
       <ul>
        <li>
         <a href="#_4" rel="nofollow">
          一、前言
         </a>
        </li>
        <li>
         <a href="#_8" rel="nofollow">
          二、行业顶尖技术实践精华集概览
         </a>
        </li>
        <li>
         <a href="#_19" rel="nofollow">
          三、腾讯云容器和函数计算技术实践案例
         </a>
        </li>
        <li>
         <ul>
          <li>
           <a href="#31__Stable_Diffusion__21" rel="nofollow">
            3.1 精选集中的 Stable Diffusion 腾讯云云原生容器部署实践
           </a>
          </li>
          <li>
           <a href="#32__44" rel="nofollow">
            3.2 精选集中的数数科技大数据查询引擎云原生实践
           </a>
          </li>
          <li>
           <ul>
            <li>
             <a href="#321__46" rel="nofollow">
              3.2.1 大数据查询引擎技术痛点
             </a>
            </li>
            <li>
             <a href="#322__56" rel="nofollow">
              3.2.2 基于腾讯云云原生解决方案
             </a>
            </li>
            <li>
             <ul>
              <li>
               <a href="#_60" rel="nofollow">
                （一）弹性容器资源的智能调度与优化
               </a>
              </li>
              <li>
               <a href="#_68" rel="nofollow">
                （二）解决方案
               </a>
              </li>
             </ul>
            </li>
           </ul>
          </li>
         </ul>
        </li>
        <li>
         <a href="#_105" rel="nofollow">
          四、文末总结
         </a>
        </li>
       </ul>
      </li>
     </ul>
    </div>
    <p>
    </p>
    <h3>
     <a id="_4">
     </a>
     一、前言
    </h3>
    <p>
     今天我想跟大家聊聊云计算的一些新潮玩意儿，我对云计算领域的一些前沿技术本身就特别感兴趣，比如 Docker 容器、Serverless 计算、微服务架构以及云原生架构。这些技术在数字化浪潮中扮演着重要角色，不仅改变了软件开发和部署的方式，还大大提高了企业的运营效率和市场响应速度。特别是最近看了《
     <strong>
      2023腾讯云容器和函数计算技术实践精选集
     </strong>
     》，里面汇集了行业顶尖专家们如何应对挑战、实现创新的经验。这里面不仅聚焦于容器和Serverless技术，还包括了微服务和云原生架构的深入案例分析，为我们提供了宝贵的学习和参考资源。本文将带你更加详细的阅读这本实践精选集。
    </p>
    <h3>
     <a id="_8">
     </a>
     二、行业顶尖技术实践精华集概览
    </h3>
    <p>
     阅读完这本《2023 年腾讯云容器和函数计算技术实践精选集》后，个人觉得它是一份汇集了行业内顶尖技术实践的精华文集。文集内涵盖了多个领域的实践案例，包括云原生实践与监控、调度器设计与实现、资源配置与管理、Serverless 技术应用、Kubernetes 和容器技术、应用场景实践等内容。这些案例展示了腾讯云在容器化和无服务器计算领域的最佳实践，为读者提供了丰富的学习和借鉴资源。
    </p>
    <p>
     在这个精选集中，你将了解到如何利用容器和函数计算技术构建高效的云原生架构，提升应用部署效率，降低成本，实现业务的敏捷性和弹性。通过实例分析和深度解读，你将深入了解容器部署、调度器设计、资源优化、Serverless 应用等方面的最佳实践和技术要点。
    </p>
    <p>
     这份精选集不仅是对腾讯云在云原生领域的技术积累和实践经验的展示，更是对整个行业发展趋势和最新技术应用的把握。博主为了为了方便大家阅读，我直接给这本精选集做了一个概括分类，基本可以分为几个类别，其中包括云原生技术的实践监控、K8S 和容器的技术实践、Serverless 技术的应用案例以及资源配置与管理几个方面，因为精选集篇幅内容较多，本文会着重讲解一下 k8s 案例以及 Serverless 的实践案例。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/b1f161814a6d993bebc5b55fc1ec694f.png"/>
    </p>
    <h3>
     <a id="_19">
     </a>
     三、腾讯云容器和函数计算技术实践案例
    </h3>
    <h4>
     <a id="31__Stable_Diffusion__21">
     </a>
     3.1 精选集中的 Stable Diffusion 腾讯云云原生容器部署实践
    </h4>
    <p>
     想必在 AIGC 爆发的今天，你或多或少都听说过一些前言的 AI 工具，其中文生图非常证明的就是 Stable Diffusion，在 2023 腾讯云容器和函数计算技术实践案例中就有详细的介绍基于腾讯云的详细部署 Stable Diffusion 步骤，并且提供了一些进阶操作技巧。这些操作步骤以及技巧，无论是第一次接触的对初学者还是对有经验的使用者，都有一定的帮助。
    </p>
    <p>
     在该案例中使用了腾讯云云原生容器服务 TKE 和文件存储 CFS 在腾讯云上的轻松部署 Stable Diffusion ，以及如何使用云原生网关、qGPU、TACO 和 COS 在云原生推理场景下进行能力扩展。其设计的架构图如下：
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/492a61507a613439a218bde45b3e5c32.png"/>
    </p>
    <p>
     在准备需使用 Stable Diffusion 容器镜像阶段，使用到的腾讯云服务是：腾讯云容器镜像服务（Tencent Container Registry，TCR），TCR 是腾讯云提供的容器镜像云端托管服务，支持 Docker 镜像、Helm Chart 存储分发及镜像安全扫描，为企业级客户提供了细颗粒度的访问权限管理和网络访问控制。TCR 支持上千节点并发拉取 GB 级大镜像，配合镜像加速能力，实现极速分发。以这个为案例，提供了你所需要的前期准备资源，这其中就包括 Stable Diffusion web UI 代码的 Docker 镜像，如果将镜像上传到容器镜像仓库 TCR，可以直接访问 TCR 服务的企业指南。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/4b467a85cc8001ebd287ec78cb3022d0.png"/>
    </p>
    <p>
     在指南中提到的另一个部署准备是准备待部署StableDiffusion的TKE集群，腾讯云容器服务TKE基于原生Kubernetes提供以容器为核心的解决方案，覆盖Serverless、边缘计算、分布式云等多种业务部署场景，业内首创单个集群兼容多种计算节点的容器资源管理模式。通过TKE的弹性、混部、轻运维等特性助力AIGC业务提升资源利用率、从而降低成本。
    </p>
    <p>
     在部署阶段，可以直接通过 TKE+CFS 快速部署 Stable Diffusion Web UI， CFS也就是腾讯云文件存储（Cloud File Storage，CFS） 服务。CFS 提供了标准的 NFS 文件系统访问协议，为多个 CVM 实例提供共享的数据源，支持弹性容量和性能的扩展，现有应用无需修改即可挂载使用，是一种高可用、高可靠的分布式文件系统。
    </p>
    <p>
     在指南中核心部分重点讲解了在腾讯云上部署 Stable Diffusion 的具体步骤，这对希望利用这项技术的读者来说极其重要。从准备容器镜像的详细操作，到创建和配置 TKE 集群的过程，再到如何使用云原生网关、qGPU、TACO 和 COS 进行能力扩展，每一步都被详尽地阐述。尤其值得注意的是，文章提供了关于如何快速部署 Stable Diffusion Web UI、创建存放模型的文件存储 CFS、以及创建静态 PV &amp; PVC 的明确指导，确保了部署过程的高效和顺畅。
    </p>
    <p>
     此外，通过开启腾讯云云原生容器 TKE+qGPU 的使用介绍和配置 Stable Diffusion Web UI 工作负载的具体操作，文章为技术人员提供了一条清晰的路径，以便他们能够在自己的云环境中快速有效地部署 Stable Diffusion，个人觉得这个精选集的案例中可以帮助读者掌握在腾讯云上部署此Stable Diffusion 的关键步骤。
    </p>
    <h4>
     <a id="32__44">
     </a>
     3.2 精选集中的数数科技大数据查询引擎云原生实践
    </h4>
    <h5>
     <a id="321__46">
     </a>
     3.2.1 大数据查询引擎技术痛点
    </h5>
    <p>
     ThinkingEngine，简称TE，这个新一代的数据分析引擎，是由数数科技带来的，它就像是那种能帮你打理一切数据需求的万能小助手。这玩意儿让数据分析能够覆盖到各种各样的场景里去，特别对游戏公司来说，它们可以更专注于游戏本身的事务，从而更好地挖掘数据里的金矿。
    </p>
    <p>
     我们这边经常听客户说，啊，到了业务高峰期，分析查询就变得慢吞吞的，有时候还卡住不动。原因嘛，简单来说就是在高峰期的时候，查询引擎的资源就像是被挤兑了一样，查询操作只能乖乖排队。客户们也试过通过增加资源来解决问题，但因为架构之间的依赖关系密不可分，扩展起来就像是要爬过一堵墙一样困难。这样一来，当业务不那么繁忙的时候，资源利用率就跌到谷底了。
    </p>
    <p>
     虽然通过加大投入可以在一定程度上解决查询慢的问题，但这就意味着得花更多的钱和人力。我们就想了个办法，通过架构的演变，让资源能根据需求弹性伸缩，从而提升了架构的扩展性。这样一来，既提升了查询的效率，又能在服务器成本上做到平衡。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/bb790456824931174f08d98b340a4c83.png"/>
    </p>
    <h5>
     <a id="322__56">
     </a>
     3.2.2 基于腾讯云云原生解决方案
    </h5>
    <p>
     在阅读该案例过程中，博主可以清晰的阅读出根据不同的痛点，腾讯云都给出了不同的解决方案，由于篇幅问题，这里重点博主提取几个关键的案例信息出来：
    </p>
    <h6>
     <a id="_60">
     </a>
     （一）弹性容器资源的智能调度与优化
    </h6>
    <p>
     在这方面的核心痛点是
    </p>
    <ul>
     <li>
      弹性资源调配不够灵活：需要根据自定义监控数据（如消息队列积压数、请求处理等待时间等）动态调整资源，而非仅依赖于 CPU 和内存使用情况。
     </li>
     <li>
      服务接入限制：外部服务访问 Kubernetes (K8s) 集群不直观，受限于网络策略和接入方法。
     </li>
     <li>
      镜像仓库访问效率低下：国内外客户在获取系统容器镜像时遇到稳定性和速度问题。
     </li>
    </ul>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/a49b1dd0dce60c0871a98ad3212f1ab7.png"/>
    </p>
    <h6>
     <a id="_68">
     </a>
     （二）解决方案
    </h6>
    <p>
     就上面提到的痛点问题，基于腾讯云云原生解决方案给出了具体的实现方式
    </p>
    <ul>
     <li>
      <p>
       <strong>
        在弹性伸缩的智能化实现方面
       </strong>
      </p>
      <ul>
       <li>
        技术路线：利用 Kubernetes API Aggregator 特性，整合第三方监控服务，如 Prometheus，通过 prometheus-adapter 注册至 K8s API，实现自定义监控数据驱动的弹性伸缩。
       </li>
       <li>
        实践成果：结合 HPA (Horizontal Pod Autoscaler) 和 CronHPA，实现了业务负载的动态调整。对于缓慢增长的负载，使用 HPA 自动扩缩；对于瞬时高负载，CronHPA 根据业务规律预先调度资源。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        服务接入与网络优化方面
       </strong>
      </p>
      <ul>
       <li>
        <p>
         策略：通过云服务 LoadBalancer 将请求转发到 ingress-nginx-controller，再利用 Ingress 规则进行路由转发，简化外部访问流程，同时保证服务隔离与安全。
        </p>
       </li>
       <li>
        <p>
         镜像仓库的优化迭代
        </p>
       </li>
       <li>
        <p>
         阶段式优化：
        </p>
        <ul>
         <li>
          初期：基本的镜像分发能力，遇到海外访问慢的问题。
         </li>
         <li>
          中期：解决了国内外镜像分发的稳定性问题，但存在访问 DockerHub 的网络延时和频率限制问题。
         </li>
         <li>
          后期：通过 DNS 就近解析和镜像优先推送策略，实现了国内外稳定的镜像分发，同时保留 DockerHub 作为备份源。
         </li>
        </ul>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        镜像加速与版本管理
       </strong>
      </p>
      <ul>
       <li>
        面临的挑战：大型镜像（如 Trino 镜像）的获取耗时长，影响弹性应用的启动效率。
        <br/>
        创新方案：腾讯云推出的 imc 镜像加速组件，与自动化部署流程集成，优化了镜像获取速度和版本管理，特别针对 ToB 业务私有化部署的需求。
       </li>
       <li>
        实施效果
        <br/>
        通过这一系列技术创新与优化措施，显著提高了弹性资源的调度效率，缩短了应用部署时间，提升了客户获取镜像的速度和稳定性，最终达到了资源高效利用和业务稳定运行的目标。
       </li>
      </ul>
     </li>
    </ul>
    <p>
     在阅读完整体的技术实践案例后，个人觉得更加深入的了解了在云原生方案在资源调度、服务接入、镜像仓库管理以及镜像加速等方面的应用，案例中克服了一系列技术挑战，并通过创新的解决方案有效解决了业务痛点。通过引入弹性容器资源的管理，利用 Kubernetes 的 HPA 和 CronHPA，我们不仅提升了资源的利用效率，还实现了业务的高可用性和弹性伸缩。此外，对外部服务的灵活接入和镜像仓库的优化改进，进一步增强了系统的稳定性和访问速度。
    </p>
    <p>
     在这个案例中是我个人觉得在整个《2023腾讯云容器和函数计算技术实践精选集》中对我帮助最大的，因为其中有我们经常遇到的现实中的架构设计问题，以及现有架构的难重构的问题，甚至包括一些如何降低成本的问题，涵盖的非常全面，有兴趣的同学可以直接阅读这个精选集，我相信你也会有所发现，这里直接引用案例中数数科技的一段话：
    </p>
    <blockquote>
     <p>
      我们的经验表明，面对架构调研和演进中遇到的挑战，保持开放的心态，加强与云服务厂商技术团队的沟通是非常关键的。这样不仅可以拓展技术视野，还能够不断提升解决方案的成熟度和完备性。我们特别感谢腾讯云容器团队的支持，在这一过程中提供了巨大的帮助。
     </p>
    </blockquote>
    <h3>
     <a id="_105">
     </a>
     四、文末总结
    </h3>
    <p>
     通过阅读《2023腾讯云容器和函数计算技术实践精选集》，可以深入了解到容器和函数计算技术在当今数字化转型和云原生应用开发中扮演的关键角色。这些技术不仅为企业提供了更灵活、高效的解决方案，还是推动创新、加速业务发展的重要动力。
    </p>
    <p>
     文章的讨论和案例分析强调了深入理解和应用这些先进技术的重要性，同时也揭示了云原生技术实践中的创新应用和最佳实践。对于希望保持技术领先地位的开发者和企业来说，这些见解和经验无疑具有极高的价值。其实在上面我已经有所提到了两个案例，尤其是后来的第二个，对我个人来说知识面非常广，也解决了行业上常见的痛点问题，当然这只是其中的一个而已，在文章开头我有提过，在《2023腾讯云容器和函数计算技术实践精选集》中有众多的关于云原生容器和函数计算的很多案例，个人非常鼓励大家深入研究《2023腾讯云容器和函数计算技术实践精选集》，不仅因为它提供了丰富的技术知识和实践案例，更因为它能激发我们对未来技术趋势的思考和探索。让我们共同努力，通过不断学习和实践，推动技术的不断进步，共同塑造数字化未来。
    </p>
    <p>
     想了解更多精彩案例和详细内容，请下载阅读：
     <a href="https://download.csdn.net/download/csdnnews/88942959?spm=1001.2014.3001.5503">
      精选集下载链接
     </a>
     。一起来探索云计算技术的无限可能，共同促进技术生态的繁荣发展。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
  <div class="blog-extension-box" id="blogExtensionBox" style="width:400px;margin:auto;margin-top:12px">
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f64696574696d65313934332f:61727469636c652f64657461696c732f313337303934393537" class_="artid" style="display:none">
 </p>
</div>


