---
layout: post
title: "报表控件stimulsoft操作使用-Angular-应用程序的报告查看器组件"
date: 2025-03-10 16:51:00 +0800
description: "本文将探讨如何使用嵌入式查看器组件在 ASP.NET Core Web 应用程序中创建报告和仪表板的示例。"
keywords: "报表控件stimulsoft操作：使用 Angular 应用程序的报告查看器组件"
categories: ['控件']
tags: ['前端', 'Javascript', 'Angular']
artid: "146158226"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146158226
    alt: "报表控件stimulsoft操作使用-Angular-应用程序的报告查看器组件"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146158226
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146158226
cover: https://bing.ee123.net/img/rand?artid=146158226
image: https://bing.ee123.net/img/rand?artid=146158226
img: https://bing.ee123.net/img/rand?artid=146158226
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     报表控件stimulsoft操作：使用 Angular 应用程序的报告查看器组件
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     <a href="https://www.evget.com/product/2398/download" rel="nofollow" title="Stimulsoft Ultimate">
      Stimulsoft Ultimate
     </a>
     （原Stimulsoft Reports.Ultimate）是用于创建报表和仪表板的通用工具集。该产品包括用于WinForms、ASP.NET、.NET Core、JavaScript、WPF、PHP、Java和其他环境的完整工具集。无需比较产品功能，Stimulsoft Ultimate包含了所有内容！
    </p>
    <p>
     <strong>
      <a href="https://www.evget.com/product/2398/download" rel="nofollow" title="Stimulsoft Reports 最新版下载">
       Stimulsoft Reports 最新版下载
      </a>
     </strong>
    </p>
    <h2>
     介绍
    </h2>
    <p>
     报告和仪表板查看器是用于查看文档的专用组件。它完全可定制、速度快、用户友好，提供多种功能。为了确保无缝集成到项目中，我们为应用程序的外观和功能提供了多种主题和自定义选项。
    </p>
    <p>
    </p>
    <p class="img-center">
     <img alt="" height="376" src="https://i-blog.csdnimg.cn/img_convert/6268a3ea3031cf935e894f6974220015.png" width="1045"/>
    </p>
    <h2>
     入门
    </h2>
    <p>
     打开 Visual Studio 并转到
     <strong>
      文件
     </strong>
     菜单。选择
     <strong>
      新建
     </strong>
     ，然后选择
     <strong>
      项目
     </strong>
     。接下来，选择
     <strong>
      ASP.NET Core Web 应用程序
     </strong>
     并单击
     <strong>
      下一步
     </strong>
     。
     <br/>
     <br/>
     现在，指定项目名称、位置和解决方案名称（例如
     <strong>
      AngularViewer
     </strong>
     ），然后单击
     <strong>
      创建
     </strong>
     。
     <br/>
     <br/>
     继续选择平台：在此示例中，选择 .NET 8 或更高版本。确保禁用
     <strong>
      配置 HTTPS
     </strong>
     选项，然后单击
     <strong>
      创建
     </strong>
     。
    </p>
    <h2>
     安装 NuGet 包
    </h2>
    <p>
     您可以
     <a href="https://affim.baidu.com/unique_2540657/chat?siteId=19102105&amp;userId=2540657&amp;siteToken=ebe6fb967db98f516ed49162dfbdcd2a" rel="nofollow" title="联系慧都在线客服">
      联系慧都在线客服
     </a>
     ，安装
     <strong>
      Stimulsoft.Reports.Angular.NetCore
     </strong>
     NuGet 包：
    </p>
    <ul>
     <li>
      在项目的上下文菜单中，选择
      <strong>
       管理 NuGet 包
      </strong>
      ；
     </li>
     <li>
      选择一个元素并指定包版本；
     </li>
     <li>
      单击
      <strong>
       “安装”
      </strong>
      。
     </li>
    </ul>
    <p>
     接下来，您需要按照以下步骤将
     <strong>
      ViewerController
     </strong>
     添加到
     <strong>
      Controllers文件夹：
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       打开Controllers
      </strong>
      文件夹的上下文菜单并选择
      <strong>
       添加项目
      </strong>
      ；
     </li>
     <li>
      选择
      <strong>
       控制器...
      </strong>
      并将控制器类型设置为
      <strong>
       MVC 控制器 – 空
      </strong>
      ；
     </li>
     <li>
      单击
      <strong>
       添加
      </strong>
      并输入控制器名称，例如
      <strong>
       ViewerController
      </strong>
      ；
     </li>
     <li>
      再次单击
      <strong>
       “添加” 。
      </strong>
     </li>
    </ul>
    <p>
     接下来，继续处理报告：在项目中创建一个
     <strong>
      Reports文件夹，创建一个模板，例如
     </strong>
     <strong>
      MasterDetail.mrt ，并在
     </strong>
     <strong>
      ViewerController.cs
     </strong>
     中插入以下代码：
     <br/>
     <strong>
      ViewController.cs
     </strong>
    </p>
    <pre><code class="hljs">using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using Microsoft.AspNetCore.Mvc;
using Stimulsoft.Report;
using Stimulsoft.Report.Angular;
using Stimulsoft.Report.Web;

namespace AngularViewer.Controllers
{
    [Controller]
    public class ViewerController : Controller
    {
        static ViewerController()
        {
            // How to Activate
            //Stimulsoft.Base.StiLicense.Key = "6vJhGtLLLz2GNviWmUTrhSqnO...";
            //Stimulsoft.Base.StiLicense.LoadFromFile("license.key");
            //Stimulsoft.Base.StiLicense.LoadFromStream(stream);
        }

        [HttpPost]
        public IActionResult InitViewer()
        {
            var requestParams = StiAngularViewer.GetRequestParams(this);

            var options = new StiAngularViewerOptions();
            options.Actions.GetReport = "GetReport";
            options.Actions.ViewerEvent = "ViewerEvent";
            options.Appearance.ScrollbarsMode = true;

            return StiAngularViewer.ViewerDataResult(requestParams, options);
        }

        [HttpPost]
        public IActionResult GetReport()
        {
            var report = StiReport.CreateNewReport();
            var path = StiAngularHelper.MapPath(this, $"Reports/MasterDetail.mrt");
            report.Load(path);

            return StiAngularViewer.GetReportResult(this, report);
        }

        [HttpPost]
        public IActionResult ViewerEvent()
        {
            return StiAngularViewer.ViewerEventResult(this);
        }
    }
}</code></pre>
    <p>
     此外，您还应通过启用 CORS 策略和定义 Angular 的回退机制来配置 .NET 服务器。这应在
     <strong>
      Program.cs
     </strong>
     文件中完成
     <strong>
      。
     </strong>
    </p>
    <p>
     <strong>
      Program.cs
     </strong>
    </p>
    <pre><code class="hljs">using Microsoft.AspNetCore.Builder;
using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Hosting;

var builder = WebApplication.CreateBuilder(args);

builder.Services.AddControllersWithViews();
builder.Services.AddCors(options =&gt;
{
    options.AddDefaultPolicy(policy =&gt;
    {
        policy.AllowAnyOrigin().AllowAnyHeader().AllowAnyMethod();
    });
});

var app = builder.Build();

if (!app.Environment.IsDevelopment())
{
    app.UseExceptionHandler("/Error");
}

app.UseDefaultFiles();
app.UseStaticFiles();

app.UseRouting();
app.UseCors();
app.UseAuthorization();

app.MapControllerRoute(
    name: "default",
    pattern: "{controller=Home}/{action=Index}/{id?}");

app.Use(async (context, next) =&gt;
{
    await next();
    if (context.Response.StatusCode == 404 &amp;&amp; !context.Request.Path.Value.StartsWith("/api"))
    {
        context.Request.Path = "/index.html";
        await next();
    }
});

app.Run();</code></pre>
    <p>
     <strong>
      接下来，在文件资源管理器
     </strong>
     中打开项目文件夹，并使用
     <strong>
      npm
     </strong>
     安装必要的 Angular-client 组件。
     <br/>
     <br/>
     <strong>
      控制台
     </strong>
    </p>
    <pre><code class="hljs">npm install stimulsoft-viewer-angular</code></pre>
    <p>
     关闭控制台，删除
     <strong>
      ClientApp
     </strong>
     文件夹，重新打开控制台，输入以下命令：
     <br/>
     <br/>
     <strong>
      Console
     </strong>
    </p>
    <pre><code class="hljs">ng new ClientApp</code></pre>
    <p>
     选择
     <strong>
      CSS
     </strong>
     格式，按
     <strong>
      Enter
     </strong>
     ，关闭控制台，然后导航到
     <strong>
      ClientApp
     </strong>
     文件夹。
     <br/>
     <br/>
     再次打开控制台并安装
     <strong>
      stimulsoft-viewer-angular
     </strong>
     :
     <br/>
     <br/>
     <strong>
      控制台
     </strong>
    </p>
    <pre><code class="hljs">npm install stimulsoft-viewer-angular</code></pre>
    <p>
     关闭控制台。在文本编辑器中打开目录“
     <em>
      ...ClientApp\src\app\ ”中的
     </em>
     <strong>
      app.module.ts
     </strong>
     文件并添加
     <strong>
      StimulsoftViewerModule
     </strong>
     。然后将以下代码插入
     <strong>
      app.module.ts
     </strong>
     ：
     <strong>
      app.module.ts
     </strong>
    </p>
    <pre><code class="hljs">import { BrowserModule } from '@angular/platform-browser';
import { NgModule } from '@angular/core';
import { StimulsoftViewerModule } from 'stimulsoft-viewer-angular';
import { HttpClientModule } from '@angular/common/http';
import { BrowserAnimationsModule } from '@angular/platform-browser/animations';
import { FormsModule } from '@angular/forms';

import { AppComponent } from './app.component';

@NgModule({
  declarations: [
    AppComponent
  ],
  imports: [
    BrowserModule,
    StimulsoftViewerModule,
    HttpClientModule,
    BrowserAnimationsModule,
    FormsModule,
  ],
  providers: [],
  bootstrap: [AppComponent]
})
export class AppModule { }</code></pre>
    <p>
     在文本编辑器中打开目录“
     <em>
      ...ClientApp\src\app\ ”中的
     </em>
     <strong>
      app.component.html
     </strong>
     文件并添加
     <strong>
      AppComponent
     </strong>
     。然后将以下代码插入
     <strong>
      app.component.html
     </strong>
     ：
     <strong>
      app.component.html
     </strong>
    </p>
    <pre><code class="hljs">&lt;stimulsoft-viewer-angular
  [requestUrl]="'http://localhost:5151/Viewer/{action}'"
  [action]="'InitViewer'"
  [height]="'100vh'"
&gt;&lt;/stimulsoft-viewer-angular&gt;</code></pre>
    <p>
     转到 Visual Studio 并运行项目。您将看到一个带有指定报告的查看器。
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f33363132393733332f:61727469636c652f64657461696c732f313436313538323236" class_="artid" style="display:none">
 </p>
</div>


