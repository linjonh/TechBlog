---
layout: post
title: "React-组件的新旧生命周期"
date: 2025-03-11 17:43:34 +0800
description: "❤React-组件的新旧生命周期1、组件的生命周期概述.????生命周期含义：从组件出生到更新、改变、销毁(创建\\更新\\销毁)的整个阶段。????生命周期的钩子函数含义：组件的每个阶段都伴随着一些方法，就是生命周期的钩子函数,我们就是通过控制这些生命周期函数从而控制组件。????生命周期意义：组件的生命周期有助于理解组件的运行..."
keywords: "❤React-组件的新旧生命周期"
categories: ['未分类']
tags: ['前端框架', '前端', 'React', 'Javascript', 'Ecmascript']
artid: "146194347"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146194347
    alt: "React-组件的新旧生命周期"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146194347
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146194347
cover: https://bing.ee123.net/img/rand?artid=146194347
image: https://bing.ee123.net/img/rand?artid=146194347
img: https://bing.ee123.net/img/rand?artid=146194347
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     ❤React-组件的新旧生命周期
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <div class="article-content-wrap" style="font-size: 16px;">
     <div class="artical-content-bak main-content">
      <div class="con artical-content editor-preview-side" id="markdownContent">
       <h3 class="markdown-h" id="h0">
        <a id="React_1">
        </a>
        ❤React-组件的新旧生命周期
       </h3>
       <h4 class="markdown-h" id="h1">
        <a id="1_4">
        </a>
        1、组件的生命周期概述.
       </h4>
       <h5 class="markdown-h" id="h2">
        <a id="_6">
        </a>
        👉
        <code>
         生命周期
        </code>
        含义：
       </h5>
       <p>
        从组件出生到更新、改变、销毁(创建\更新\销毁)的整个阶段。
       </p>
       <h5 class="markdown-h" id="h3">
        <a id="_10">
        </a>
        👉
        <code>
         生命周期的钩子函数
        </code>
        含义：
       </h5>
       <p>
        组件的每个阶段都伴随着一些方法，就是生命周期的钩子函数,我们就是通过控制这些生命周期函数从而控制组件。
       </p>
       <h5 class="markdown-h" id="h4">
        <a id="_14">
        </a>
        👉
        <code>
         生命周期
        </code>
        意义：
       </h5>
       <p>
        组件的生命周期有助于理解组件的运行方式、完成更复杂的组件功能、分析组件错误原因
       </p>
       <h5 class="markdown-h" id="h5">
        <a id="TIPS_18">
        </a>
        👉
        <code>
         TIPS
        </code>
       </h5>
       <p>
        只有类组件才有生命周期
       </p>
       <h4 class="markdown-h" id="h6">
        <a id="2__22">
        </a>
        2、 组件生命周期的三个阶段
       </h4>
       <p>
        1.每个阶段的执行时机
       </p>
       <p>
        2、每个阶段钩子函数的执行顺序
       </p>
       <p>
        3、每个阶段钩子函数的作用
       </p>
       <h5 class="markdown-h" id="h7">
        <a id="_30">
        </a>
        👉主要阶段
       </h5>
       <p>
        组件的生命周期主要分为三个主要阶段：
       </p>
       <p>
        <code>
         挂载(Mounting)、
        </code>
       </p>
       <p>
        <code>
         更新(Updating)、
        </code>
       </p>
       <p>
        <code>
         卸载(Unmounting)
        </code>
       </p>
       <blockquote>
        <p>
         生命周期图
         <img alt="❤React-组件的新旧生命周期_钩子函数" src="https://i-blog.csdnimg.cn/img_convert/61f238aed2e80dfae401cc09ebf1dcc4.png" style="outline: none;"/>
        </p>
       </blockquote>
       <h5 class="markdown-h" id="h8">
        <a id="__44">
        </a>
        👉 创建时
       </h5>
       <ol>
        <li>
         创建时(挂载阶段)
        </li>
       </ol>
       <div class="code-toolbar">
        <div class="hljs-cto">
         <div class="operation_box">
          <button class="copy_btn disable">
           登录后复制
          </button>
          <a class="downloadCode" title="登录后一键下载全文代码">
           <i class="iconblog blogimport">
           </i>
          </a>
         </div>
         <pre class="has" tabindex="0"><code class="language-js" id="code_id_0">执行时机：组件创建时(页面加载时)</code></pre>
         <ul class="pre-numbering">
          <li>
           1.
          </li>
         </ul>
        </div>
       </div>
       <p>
        执行顺序：
        <img alt="❤React-组件的新旧生命周期_初始化_02" src="https://i-blog.csdnimg.cn/img_convert/10dc0dc9d4d7e1b66adca79d9db34a88.png" style="outline: none;"/>
       </p>
       <h5 class="markdown-h" id="h9">
        <a id="_54">
        </a>
        👉钩子函数
       </h5>
       <table>
        <thead>
         <tr>
          <th>
           钩子函数
          </th>
          <th>
           触发时机
          </th>
          <th>
           作用
          </th>
         </tr>
        </thead>
        <tbody>
         <tr>
          <td>
           <strong>
            constructor
           </strong>
          </td>
          <td>
           创建组件时，最先执行
          </td>
          <td>
           1. 初始化 state
           <br/>
           2. 为事件处理程序绑定 this
          </td>
         </tr>
         <tr>
          <td>
           <strong>
            render
           </strong>
          </td>
          <td>
           每次组件渲染都会触发
          </td>
          <td>
           1. 渲染 UI(注意：不能调用
           <code>
            setState()
           </code>
           )
          </td>
         </tr>
         <tr>
          <td>
           <strong>
            componentDidMount
           </strong>
          </td>
          <td>
           组件挂载(完成 DOM 渲染)后
          </td>
          <td>
           1. 发送网络请求
           <br/>
           2. DOM 操作
          </td>
         </tr>
        </tbody>
       </table>
       <h5 class="markdown-h" id="h10">
        <a id="_62">
        </a>
        👉使用示例
       </h5>
       <div class="code-toolbar">
        <div class="hljs-cto">
         <div class="operation_box">
          <button class="copy_btn disable">
           登录后复制
          </button>
          <a class="downloadCode" title="登录后一键下载全文代码">
           <i class="iconblog blogimport">
           </i>
          </a>
         </div>
         <pre class="has" tabindex="0"><code class="language-js" id="code_id_1"><span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 初始化 state</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// 处理 this 指向问题</span>
    console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">'生命周期钩子函数：constructor'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 1. 进行 DOM 操作</span>
  <span class="token comment">// 2. 发送 ajax 请求，获取远程数据</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">'生命周期钩子函数：componentDidMount'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 这里可以进行 AJAX 请求等操作</span>
    <span class="token comment">// const title = document.getElementById('title');</span>
    <span class="token comment">// console.log(title);</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 错误演示！！！不要在 render 中调用 setState</span>
    <span class="token comment">// this.setState({ count: 1 });  // **错误**：不要在 render 中调用 setState！</span>

    console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">'生命周期钩子函数：render'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token literal-property property">Count</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count<span class="token punctuation">}</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
          Increment
        <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> MyComponent<span class="token punctuation">;</span>
</code></pre>
         <ul class="pre-numbering">
          <li>
           1.
          </li>
          <li>
           2.
          </li>
          <li>
           3.
          </li>
          <li>
           4.
          </li>
          <li>
           5.
          </li>
          <li>
           6.
          </li>
          <li>
           7.
          </li>
          <li>
           8.
          </li>
          <li>
           9.
          </li>
          <li>
           10.
          </li>
          <li>
           11.
          </li>
          <li>
           12.
          </li>
          <li>
           13.
          </li>
          <li>
           14.
          </li>
          <li>
           15.
          </li>
          <li>
           16.
          </li>
          <li>
           17.
          </li>
          <li>
           18.
          </li>
          <li>
           19.
          </li>
          <li>
           20.
          </li>
          <li>
           21.
          </li>
          <li>
           22.
          </li>
          <li>
           23.
          </li>
          <li>
           24.
          </li>
          <li>
           25.
          </li>
          <li>
           26.
          </li>
          <li>
           27.
          </li>
          <li>
           28.
          </li>
          <li>
           29.
          </li>
          <li>
           30.
          </li>
          <li>
           31.
          </li>
          <li>
           32.
          </li>
          <li>
           33.
          </li>
          <li>
           34.
          </li>
          <li>
           35.
          </li>
          <li>
           36.
          </li>
          <li>
           37.
          </li>
          <li>
           38.
          </li>
         </ul>
        </div>
       </div>
       <h5 class="markdown-h" id="h11">
        <a id="_106">
        </a>
        👉更新时
       </h5>
       <h6 class="markdown-h" id="h12">
        <a id="_107">
        </a>
        更新的三种情况
       </h6>
       <div class="code-toolbar">
        <div class="hljs-cto">
         <div class="operation_box">
          <button class="copy_btn disable">
           登录后复制
          </button>
          <a class="downloadCode" title="登录后一键下载全文代码">
           <i class="iconblog blogimport">
           </i>
          </a>
         </div>
         <pre class="has" tabindex="0"><code class="language-js" id="code_id_2"><span class="token operator">-</span> <span class="token operator">**</span>执行时机<span class="token operator">**</span>：
  <span class="token number">1.</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">setState()</span><span class="token template-punctuation string">`</span></span>
  <span class="token number">2.</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">forceUpdate()</span><span class="token template-punctuation string">`</span></span>
  <span class="token number">3.</span> 组件接收到新的 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">props</span><span class="token template-punctuation string">`</span></span>
</code></pre>
         <ul class="pre-numbering">
          <li>
           1.
          </li>
          <li>
           2.
          </li>
          <li>
           3.
          </li>
          <li>
           4.
          </li>
         </ul>
        </div>
       </div>
       <ul>
        <li>
         <strong>
          说明
         </strong>
         ：以上三者任意一种变化，组件就会重新渲染。
        </li>
       </ul>
       <h6 class="markdown-h" id="h13">
        <a id="_117">
        </a>
        <strong>
         执行顺序
        </strong>
       </h6>
       <table>
        <thead>
         <tr>
          <th>
           钩子函数
          </th>
          <th>
           触发时机
          </th>
          <th>
           作用
          </th>
         </tr>
        </thead>
        <tbody>
         <tr>
          <td>
           <strong>
            render()
           </strong>
          </td>
          <td>
           每次组件渲染都会触发
          </td>
          <td>
           渲染 UI(与挂载阶段是同一个
           <code>
            render
           </code>
           )
          </td>
         </tr>
         <tr>
          <td>
           <strong>
            componentDidUpdate()
           </strong>
          </td>
          <td>
           组件更新(完成 DOM 渲染)后
          </td>
          <td>
           1. 发送网络请求
           <br/>
           2. DOM 操作
           <br/>
           注意：如果要
           <code>
            setState()
           </code>
           ，必须放在一个
           <code>
            if
           </code>
           条件中
          </td>
         </tr>
        </tbody>
       </table>
       <h6 class="markdown-h" id="h14">
        <a id="_124">
        </a>
        👉使用示例
       </h6>
       <div class="code-toolbar">
        <div class="hljs-cto">
         <div class="operation_box">
          <button class="copy_btn disable">
           登录后复制
          </button>
          <a class="downloadCode" title="登录后一键下载全文代码">
           <i class="iconblog blogimport">
           </i>
          </a>
         </div>
         <pre class="has" tabindex="0"><code class="language-js" id="code_id_3"><span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">'--子组件--生命周期钩子函数：render'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token literal-property property">统计豆豆被打的次数</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>count<span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token parameter">prevProps</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">'--子组件--生命周期钩子函数：componentDidUpdate'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 正确做法：在条件中调用 setState</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>prevProps<span class="token punctuation">.</span>count <span class="token operator">!==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>count<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 可以在这里调用 setState，但需要确保不会导致无限循环</span>
      <span class="token comment">// this.setState({});</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 错误演示！！！</span>
    <span class="token comment">// 直接调用 setState 会导致递归更新</span>
    <span class="token comment">// this.setState({});</span>

    <span class="token comment">// 获取 DOM</span>
    <span class="token keyword">const</span> title <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'title'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>title<span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
         <ul class="pre-numbering">
          <li>
           1.
          </li>
          <li>
           2.
          </li>
          <li>
           3.
          </li>
          <li>
           4.
          </li>
          <li>
           5.
          </li>
          <li>
           6.
          </li>
          <li>
           7.
          </li>
          <li>
           8.
          </li>
          <li>
           9.
          </li>
          <li>
           10.
          </li>
          <li>
           11.
          </li>
          <li>
           12.
          </li>
          <li>
           13.
          </li>
          <li>
           14.
          </li>
          <li>
           15.
          </li>
          <li>
           16.
          </li>
          <li>
           17.
          </li>
          <li>
           18.
          </li>
          <li>
           19.
          </li>
          <li>
           20.
          </li>
          <li>
           21.
          </li>
          <li>
           22.
          </li>
          <li>
           23.
          </li>
          <li>
           24.
          </li>
          <li>
           25.
          </li>
          <li>
           26.
          </li>
          <li>
           27.
          </li>
         </ul>
        </div>
       </div>
       <div class="code-toolbar">
        <div class="hljs-cto">
         <div class="operation_box">
          <button class="copy_btn disable">
           登录后复制
          </button>
          <a class="downloadCode" title="登录后一键下载全文代码">
           <i class="iconblog blogimport">
           </i>
          </a>
         </div>
         <pre class="has" tabindex="0"><code class="language-js" id="code_id_4"><span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token parameter">prevProps</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">'--子组件--生命周期钩子函数：componentDidUpdate'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 比较更新前后的 props 是否相同，决定是否重新渲染组件</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'上一次的props:'</span><span class="token punctuation">,</span> prevProps<span class="token punctuation">,</span> <span class="token string">', 当前的props:'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 如果 count 发生变化，更新状态</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>prevProps<span class="token punctuation">.</span>count <span class="token operator">!==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>count<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 假设你想将 count 状态重置为 0</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
         <ul class="pre-numbering">
          <li>
           1.
          </li>
          <li>
           2.
          </li>
          <li>
           3.
          </li>
          <li>
           4.
          </li>
          <li>
           5.
          </li>
          <li>
           6.
          </li>
          <li>
           7.
          </li>
          <li>
           8.
          </li>
          <li>
           9.
          </li>
          <li>
           10.
          </li>
          <li>
           11.
          </li>
         </ul>
        </div>
       </div>
       <h6 class="markdown-h" id="h15">
        <a id="_171">
        </a>
        组件的函数周期
       </h6>
       <p>
        render 生命周期渲染 componenetDidUpdate() 生命周期更新
       </p>
       <p>
        <strong>
         注意部分：
        </strong>
       </p>
       <p>
        seState 应该放在判断if 里面ajax的请求部分应该放在这里
       </p>
       <div class="code-toolbar">
        <div class="hljs-cto">
         <div class="operation_box">
          <button class="copy_btn disable">
           登录后复制
          </button>
          <a class="downloadCode" title="登录后一键下载全文代码">
           <i class="iconblog blogimport">
           </i>
          </a>
         </div>
         <pre class="has" tabindex="0"><code class="language-js" id="code_id_5"><span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">'--子组件--生命周期钩子函数：render'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token literal-property property">统计豆豆被打的次数</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>count<span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">'--子组件--生命周期钩子函数：componentDidUpdate'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 获取 DOM 元素</span>
    <span class="token keyword">const</span> title <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'title'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>title<span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 打印 h1 元素的内容</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Counter<span class="token punctuation">;</span>
</code></pre>
         <ul class="pre-numbering">
          <li>
           1.
          </li>
          <li>
           2.
          </li>
          <li>
           3.
          </li>
          <li>
           4.
          </li>
          <li>
           5.
          </li>
          <li>
           6.
          </li>
          <li>
           7.
          </li>
          <li>
           8.
          </li>
          <li>
           9.
          </li>
          <li>
           10.
          </li>
          <li>
           11.
          </li>
          <li>
           12.
          </li>
          <li>
           13.
          </li>
          <li>
           14.
          </li>
          <li>
           15.
          </li>
          <li>
           16.
          </li>
         </ul>
        </div>
       </div>
       <h5 class="markdown-h" id="h16">
        <a id="_197">
        </a>
        👉组件卸载时(卸载阶段)
       </h5>
       <p>
        <code>
         执行时间：组件从页面之中消失时
        </code>
       </p>
       <table>
        <thead>
         <tr>
          <th>
           钩子函数
          </th>
          <th>
           触发时机
          </th>
          <th>
           作用
          </th>
         </tr>
        </thead>
        <tbody>
         <tr>
          <td>
           <strong>
            componentWillUnmount
           </strong>
          </td>
          <td>
           组件卸载(从页面中消失)
          </td>
          <td>
           执行清理工作(比如：清理定时器等)
          </td>
         </tr>
        </tbody>
       </table>
       <ul>
        <li>
         componentDidMount(){}组件的挂载阶段
        </li>
        <li>
         componentWillUnmount(){}组件的卸载阶段
        </li>
       </ul>
       <p>
        <code>
         组件的挂载阶段执行的一些方法可以在组件的卸载阶段除去
        </code>
       </p>
       <div class="code-toolbar">
        <div class="hljs-cto">
         <div class="operation_box">
          <button class="copy_btn disable">
           登录后复制
          </button>
          <a class="downloadCode" title="登录后一键下载全文代码">
           <i class="iconblog blogimport">
           </i>
          </a>
         </div>
         <pre class="has" tabindex="0"><code class="language-js" id="code_id_6"><span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 开启定时器</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>timerId <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'定时器正在执行~'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token literal-property property">统计豆豆被打的次数</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>count<span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">'生命周期钩子函数: componentWillUnmount'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 清理定时器</span>
    <span class="token function">clearInterval</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>timerId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
         <ul class="pre-numbering">
          <li>
           1.
          </li>
          <li>
           2.
          </li>
          <li>
           3.
          </li>
          <li>
           4.
          </li>
          <li>
           5.
          </li>
          <li>
           6.
          </li>
          <li>
           7.
          </li>
          <li>
           8.
          </li>
          <li>
           9.
          </li>
          <li>
           10.
          </li>
          <li>
           11.
          </li>
          <li>
           12.
          </li>
          <li>
           13.
          </li>
          <li>
           14.
          </li>
          <li>
           15.
          </li>
          <li>
           16.
          </li>
          <li>
           17.
          </li>
          <li>
           18.
          </li>
         </ul>
        </div>
       </div>
       <h4 class="markdown-h" id="h17">
        <a id="3react_15__233">
        </a>
        3、旧版本-生命周期钩子函数(react 15 可直接跳过)
       </h4>
       <p>
        <img alt="❤React-组件的新旧生命周期_初始化_03" src="https://i-blog.csdnimg.cn/img_convert/80764f9be2021cb828481e8e61575bf8.png" style="outline: none;"/>
       </p>
       <p>
        我们可以来看看React15 的生命周期函数
       </p>
       <p>
        (1)
        <code>
         constructor()
        </code>
        : ES6 类中的构造函数，初始化使用(比如初始化组件状态(state)绑定事件处理器；),组件实例化时调用
       </p>
       <p>
        (2)
        <code>
         componentWillReceiveProps()
        </code>
        : 一般使用都是传值
        <code>
         componentWillReceiveProps(nextProps)
        </code>
       </p>
       <ul>
        <li>
         <strong>
          已废弃
         </strong>
         ：这个生命周期函数就是在组件即将接收新的属性时被调用(旧版本React中就是更新用)。可以在这里比较新旧属性，然后更新组件的状态;
        </li>
       </ul>
       <p>
        (3)
        <code>
         shouldComponentUpdate(nextProps, nextState)
        </code>
        : 组件接收到新的属性或者状态时，在更新组件之前调用
        <code>
         shouldComponentUpdate()
        </code>
        函数。
       </p>
       <p>
        根据新的属性和状态判断是否需要重新渲染组件(性能优化常用)
       </p>
       <p>
        (4)
        <code>
         componentWillMount()
        </code>
        :
       </p>
       <ul>
        <li>
         <strong>
          已废弃
         </strong>
         ：新版本不再推荐使用。 在组件即将被挂载到 DOM 中时被调用,很多时候我们可以使用
         <code>
          constructor()
         </code>
         或者
         <code>
          componentDidMount()
         </code>
         来替代。
        </li>
       </ul>
       <p>
        (5)
        <code>
         componentWillUpdate(nextProps, nextState)
        </code>
        :
        <strong>
         已废弃
        </strong>
        ：新版本不再推荐,在组件即将被更新之前被调用，我们可以在组件即将更新之前控制组件。
       </p>
       <p>
        (6)
        <code>
         componentDidUpdate()
        </code>
        : 组件第一次被渲染到 DOM 中之后被调用。我们可以进行一些初始化的操作，获取远程数据、订阅事件等
       </p>
       <p>
        (7)
        <code>
         render()
        </code>
        :
        <code>
         render()
        </code>
        <code>
         最重要
        </code>
        的生命周期函数之一,返回虚拟 DOM 元素，渲染组件外观和结构.
       </p>
       <p>
        (8)
        <code>
         componentWillUnmount()
        </code>
        : 在组件即将被销毁和从 DOM 中移除之前被调用,就类似砸门在vue销毁之前一样，可以取消订阅、清除定时器。
       </p>
       <h4 class="markdown-h" id="h18">
        <a id="4_react_16__260">
        </a>
        4、
        <code>
         重要
        </code>
        - 新版本-生命周期钩子函数(react 16 )
       </h4>
       <h5 class="markdown-h" id="h19">
        <a id="1_constructor_264">
        </a>
        (1) constructor
       </h5>
       <p>
        在类组件创建实例时调用，初始化的时候执行一次，可以在组件进行初始化时候控制组件。
       </p>
       <p>
        不定义
        <code>
         constructor
        </code>
        ，React 会自动为组件创建一个默认的
        <code>
         constructor
        </code>
       </p>
       <p>
        我们来写一个简单的
        <code>
         类组件
        </code>
        看看
       </p>
       <div class="code-toolbar">
        <div class="hljs-cto">
         <div class="operation_box">
          <button class="copy_btn disable">
           登录后复制
          </button>
          <a class="downloadCode" title="登录后一键下载全文代码">
           <i class="iconblog blogimport">
           </i>
          </a>
         </div>
         <pre class="has" tabindex="0"><code class="language-js" id="code_id_7"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token comment">// 生命周期</span>
<span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">props</span><span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//super作用 ： 传递props,才能在接下来的上下文中，获取到props</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'constructor-生命周期'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"App"</span> id<span class="token operator">=</span><span class="token string">'link'</span><span class="token operator">&gt;</span>constructor<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> Demo<span class="token punctuation">;</span>
</code></pre>
         <ul class="pre-numbering">
          <li>
           1.
          </li>
          <li>
           2.
          </li>
          <li>
           3.
          </li>
          <li>
           4.
          </li>
          <li>
           5.
          </li>
          <li>
           6.
          </li>
          <li>
           7.
          </li>
          <li>
           8.
          </li>
          <li>
           9.
          </li>
          <li>
           10.
          </li>
          <li>
           11.
          </li>
          <li>
           12.
          </li>
          <li>
           13.
          </li>
          <li>
           14.
          </li>
         </ul>
        </div>
       </div>
       <div class="code-toolbar">
        <div class="hljs-cto">
         <div class="operation_box">
          <button class="copy_btn disable">
           登录后复制
          </button>
          <a class="downloadCode" title="登录后一键下载全文代码">
           <i class="iconblog blogimport">
           </i>
          </a>
         </div>
         <pre class="has" tabindex="0"><code class="language-js" id="code_id_8">constructor<span class="token operator">-</span>生命周期
</code></pre>
         <ul class="pre-numbering">
          <li>
           1.
          </li>
         </ul>
        </div>
       </div>
       <p>
        作用
       </p>
       <div class="code-toolbar">
        <div class="hljs-cto">
         <div class="operation_box">
          <button class="copy_btn disable">
           登录后复制
          </button>
          <a class="downloadCode" title="登录后一键下载全文代码">
           <i class="iconblog blogimport">
           </i>
          </a>
         </div>
         <pre class="has" tabindex="0"><code class="language-js" id="code_id_9"><span class="token operator">-</span>   初始化 state ，获取路由中的参数，组件传值赋值给 state等 。
<span class="token operator">-</span>   绑定类组件事件，绑定 <span class="token keyword">this</span> 、节流，防抖。
<span class="token operator">-</span>   对类组件进行生命周期的劫持，渲染劫持等。
</code></pre>
         <ul class="pre-numbering">
          <li>
           1.
          </li>
          <li>
           2.
          </li>
          <li>
           3.
          </li>
         </ul>
        </div>
       </div>
       <div class="code-toolbar">
        <div class="hljs-cto">
         <div class="operation_box">
          <button class="copy_btn disable">
           登录后复制
          </button>
          <a class="downloadCode" title="登录后一键下载全文代码">
           <i class="iconblog blogimport">
           </i>
          </a>
         </div>
         <pre class="has" tabindex="0"><code class="language-js" id="code_id_10"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token comment">// 01  初始化状态</span>
<span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">props</span><span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span><span class="token string">'props'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'constructor-生命周期'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//初始化状态</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token operator">=</span><span class="token punctuation">{<!-- --></span> 
            <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'alien'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> Demo<span class="token punctuation">;</span>


<span class="token comment">// 02 **绑定事件处理器**</span>
<span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>handleClick <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleClick</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
 <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">name</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'handleClick'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token number">03</span> <span class="token operator">**</span>初始化引用<span class="token operator">**</span>
<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> 
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">this</span><span class="token punctuation">.</span>myRef <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre>
         <ul class="pre-numbering">
          <li>
           1.
          </li>
          <li>
           2.
          </li>
          <li>
           3.
          </li>
          <li>
           4.
          </li>
          <li>
           5.
          </li>
          <li>
           6.
          </li>
          <li>
           7.
          </li>
          <li>
           8.
          </li>
          <li>
           9.
          </li>
          <li>
           10.
          </li>
          <li>
           11.
          </li>
          <li>
           12.
          </li>
          <li>
           13.
          </li>
          <li>
           14.
          </li>
          <li>
           15.
          </li>
          <li>
           16.
          </li>
          <li>
           17.
          </li>
          <li>
           18.
          </li>
          <li>
           19.
          </li>
          <li>
           20.
          </li>
          <li>
           21.
          </li>
          <li>
           22.
          </li>
          <li>
           23.
          </li>
          <li>
           24.
          </li>
          <li>
           25.
          </li>
          <li>
           26.
          </li>
          <li>
           27.
          </li>
          <li>
           28.
          </li>
          <li>
           29.
          </li>
          <li>
           30.
          </li>
          <li>
           31.
          </li>
          <li>
           32.
          </li>
          <li>
           33.
          </li>
          <li>
           34.
          </li>
          <li>
           35.
          </li>
          <li>
           36.
          </li>
          <li>
           37.
          </li>
          <li>
           38.
          </li>
         </ul>
        </div>
       </div>
       <h5 class="markdown-h" id="h20">
        <a id="2_getDerivedStateFromProps_react_16__340">
        </a>
        (2) getDerivedStateFromProps (react 16 新增)
       </h5>
       <div class="code-toolbar">
        <div class="hljs-cto">
         <div class="operation_box">
          <button class="copy_btn disable">
           登录后复制
          </button>
          <a class="downloadCode" title="登录后一键下载全文代码">
           <i class="iconblog blogimport">
           </i>
          </a>
         </div>
         <pre class="has" tabindex="0"><code class="language-js" id="code_id_11"><span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">,</span>prevState<span class="token punctuation">)</span>
<span class="token comment">// nextProps 父组件新传递的 props ;</span>
<span class="token comment">// prevState 组件在此次更新前的 state</span>
</code></pre>
         <ul class="pre-numbering">
          <li>
           1.
          </li>
          <li>
           2.
          </li>
          <li>
           3.
          </li>
          <li>
           4.
          </li>
         </ul>
        </div>
       </div>
       <p>
        组件更新执行包括(props变化，setState、forceUpdate)
       </p>
       <p>
        <code>
         注意点
        </code>
       </p>
       <p>
        getDerivedStateFromProps 被定义为 static 方法 —— static 方法内部拿不到组件实例的 this
       </p>
       <p>
        任何操作 this.fetch()之类的都不可以在里卖面使用
       </p>
       <p>
        在组件的操作之中大致归为两类
       </p>
       <ul>
        <li>
         <strong>
          基于 props 更新状态
         </strong>
        </li>
       </ul>
       <div class="code-toolbar">
        <div class="hljs-cto">
         <div class="operation_box">
          <button class="copy_btn disable">
           登录后复制
          </button>
          <a class="downloadCode" title="登录后一键下载全文代码">
           <i class="iconblog blogimport">
           </i>
          </a>
         </div>
         <pre class="has" tabindex="0"><code class="language-js" id="code_id_12"><span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">''</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span><span class="token parameter">nextProps<span class="token punctuation">,</span> prevState</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 如果接收到新的值，更新状态</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>nextProps<span class="token punctuation">.</span>value <span class="token operator">!==</span> prevState<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">value</span><span class="token operator">:</span> nextProps<span class="token punctuation">.</span>value
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// 不更新状态</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre>
         <ul class="pre-numbering">
          <li>
           1.
          </li>
          <li>
           2.
          </li>
          <li>
           3.
          </li>
          <li>
           4.
          </li>
          <li>
           5.
          </li>
          <li>
           6.
          </li>
          <li>
           7.
          </li>
          <li>
           8.
          </li>
          <li>
           9.
          </li>
          <li>
           10.
          </li>
          <li>
           11.
          </li>
          <li>
           12.
          </li>
          <li>
           13.
          </li>
          <li>
           14.
          </li>
          <li>
           15.
          </li>
          <li>
           16.
          </li>
          <li>
           17.
          </li>
          <li>
           18.
          </li>
          <li>
           19.
          </li>
         </ul>
        </div>
       </div>
       <ul>
        <li>
         <strong>
          控制内部状态
         </strong>
        </li>
       </ul>
       <div class="code-toolbar">
        <div class="hljs-cto">
         <div class="operation_box">
          <button class="copy_btn disable">
           登录后复制
          </button>
          <a class="downloadCode" title="登录后一键下载全文代码">
           <i class="iconblog blogimport">
           </i>
          </a>
         </div>
         <pre class="has" tabindex="0"><code class="language-js" id="code_id_13"><span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">isFocused</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span><span class="token parameter">nextProps<span class="token punctuation">,</span> prevState</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>nextProps<span class="token punctuation">.</span>autoFocus <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>prevState<span class="token punctuation">.</span>isFocused<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">isFocused</span><span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre>
         <ul class="pre-numbering">
          <li>
           1.
          </li>
          <li>
           2.
          </li>
          <li>
           3.
          </li>
          <li>
           4.
          </li>
          <li>
           5.
          </li>
          <li>
           6.
          </li>
          <li>
           7.
          </li>
          <li>
           8.
          </li>
          <li>
           9.
          </li>
          <li>
           10.
          </li>
          <li>
           11.
          </li>
          <li>
           12.
          </li>
          <li>
           13.
          </li>
          <li>
           14.
          </li>
          <li>
           15.
          </li>
          <li>
           16.
          </li>
          <li>
           17.
          </li>
          <li>
           18.
          </li>
         </ul>
        </div>
       </div>
       <h5 class="markdown-h" id="h21">
        <a id="3_render_405">
        </a>
        (3 )render
       </h5>
       <p>
        渲染时操作元素
       </p>
       <h5 class="markdown-h" id="h22">
        <a id="4componentDidMount_408">
        </a>
        (4)componentDidMount
       </h5>
       <div class="code-toolbar">
        <div class="hljs-cto">
         <div class="operation_box">
          <button class="copy_btn disable">
           登录后复制
          </button>
          <a class="downloadCode" title="登录后一键下载全文代码">
           <i class="iconblog blogimport">
           </i>
          </a>
         </div>
         <pre class="has" tabindex="0"><code class="language-js" id="code_id_14"><span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
组件挂载到 <span class="token constant">DOM</span> 后立即被调用，跟上面作用一样，进行数据获取、订阅事件等初始化工作
</code></pre>
         <ul class="pre-numbering">
          <li>
           1.
          </li>
          <li>
           2.
          </li>
         </ul>
        </div>
       </div>
       <h5 class="markdown-h" id="h23">
        <a id="5shouldComponentUpdate_414">
        </a>
        (5)shouldComponentUpdate
       </h5>
       <p>
        就是判断是否需要重新渲染组件，主要依赖传入的props 或 state 来决定是否更新组件
       </p>
       <div class="code-toolbar">
        <div class="hljs-cto">
         <div class="operation_box">
          <button class="copy_btn disable">
           登录后复制
          </button>
          <a class="downloadCode" title="登录后一键下载全文代码">
           <i class="iconblog blogimport">
           </i>
          </a>
         </div>
         <pre class="has" tabindex="0"><code class="language-js" id="code_id_15"><span class="token function">shouldComponentUpdate</span><span class="token punctuation">(</span><span class="token parameter">newProps<span class="token punctuation">,</span>newState<span class="token punctuation">,</span>nextContext</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token comment">// 参数含义 (新的 旧的 更新的)</span>
</code></pre>
         <ul class="pre-numbering">
          <li>
           1.
          </li>
          <li>
           2.
          </li>
         </ul>
        </div>
       </div>
       <h5 class="markdown-h" id="h24">
        <a id="6getSnapshotBeforeUpdate_422">
        </a>
        (6)getSnapshotBeforeUpdate
       </h5>
       <p>
        组件更新 DOM 之前被调用(如滚动位置的使用)
       </p>
       <div class="code-toolbar">
        <div class="hljs-cto">
         <div class="operation_box">
          <button class="copy_btn disable">
           登录后复制
          </button>
          <a class="downloadCode" title="登录后一键下载全文代码">
           <i class="iconblog blogimport">
           </i>
          </a>
         </div>
         <pre class="has" tabindex="0"><code class="language-js" id="code_id_16"><span class="token function">getSnapshotBeforeUpdate</span><span class="token punctuation">(</span><span class="token parameter">prevProps<span class="token punctuation">,</span> prevState</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> 
<span class="token comment">// 返回滚动位置 return this.myRef.current.scrollHeight; </span>

<span class="token comment">// prevProps更新前的props   preState更新前的state；</span>
<span class="token punctuation">}</span>
<span class="token comment">// 参数含义 (新的 旧的 更新的)</span>
</code></pre>
         <ul class="pre-numbering">
          <li>
           1.
          </li>
          <li>
           2.
          </li>
          <li>
           3.
          </li>
          <li>
           4.
          </li>
          <li>
           5.
          </li>
          <li>
           6.
          </li>
         </ul>
        </div>
       </div>
       <p>
        注意点：
       </p>
       <ul>
        <li>
         <code>
          getSnapshotBeforeUpdate
         </code>
         必须与
         <code>
          componentDidUpdate
         </code>
         一起使用，因为它的返回值会作为第三个参数传递给
         <code>
          componentDidUpdate
         </code>
         。
        </li>
        <li>
         我们在大多数情况下不使用,它主要用于处理一些处理复杂的 UI 动画或需要手动保存和恢复某些 DOM 状态的情况。
        </li>
       </ul>
       <h5 class="markdown-h" id="h25">
        <a id="7componentDidUpdate_439">
        </a>
        (7)componentDidUpdate
       </h5>
       <p>
        组件更新(re-render)完成之后被调用
       </p>
       <div class="code-toolbar">
        <div class="hljs-cto">
         <div class="operation_box">
          <button class="copy_btn disable">
           登录后复制
          </button>
          <a class="downloadCode" title="登录后一键下载全文代码">
           <i class="iconblog blogimport">
           </i>
          </a>
         </div>
         <pre class="has" tabindex="0"><code class="language-js" id="code_id_17"><span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token parameter">prevProps<span class="token punctuation">,</span> prevState<span class="token punctuation">,</span> snapshot</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token comment">// 更新之前的 props 更新之前的 prevState  更新之前的 DOM 信息   </span>
<span class="token comment">// 操作可能会触发额外的组件更新，因此需要谨慎处理，以避免陷入无限循环</span>
</code></pre>
         <ul class="pre-numbering">
          <li>
           1.
          </li>
          <li>
           2.
          </li>
          <li>
           3.
          </li>
         </ul>
        </div>
       </div>
       <h5 class="markdown-h" id="h26">
        <a id="8_componentWillUnmount_448">
        </a>
        (8) componentWillUnmount
       </h5>
       <p>
        组件销毁阶段唯一执行的生命周期
       </p>
       <p>
        componentDidMount 设置定时器，componentWillUnmount清楚定时器
       </p>
       <div class="code-toolbar">
        <div class="hljs-cto">
         <div class="operation_box">
          <button class="copy_btn disable">
           登录后复制
          </button>
          <a class="downloadCode" title="登录后一键下载全文代码">
           <i class="iconblog blogimport">
           </i>
          </a>
         </div>
         <pre class="has" tabindex="0"><code class="language-js" id="code_id_18"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token comment">// 生命周期</span>
<span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span><span class="token string">'props'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'constructor-生命周期'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//初始化状态</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token operator">=</span><span class="token punctuation">{<!-- --></span> 
            <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'componentDidMount'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>interval <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'componentWillUnmount'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token function">clearInterval</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>interval<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>Timer<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
            
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> Demo<span class="token punctuation">;</span>
</code></pre>
         <ul class="pre-numbering">
          <li>
           1.
          </li>
          <li>
           2.
          </li>
          <li>
           3.
          </li>
          <li>
           4.
          </li>
          <li>
           5.
          </li>
          <li>
           6.
          </li>
          <li>
           7.
          </li>
          <li>
           8.
          </li>
          <li>
           9.
          </li>
          <li>
           10.
          </li>
          <li>
           11.
          </li>
          <li>
           12.
          </li>
          <li>
           13.
          </li>
          <li>
           14.
          </li>
          <li>
           15.
          </li>
          <li>
           16.
          </li>
          <li>
           17.
          </li>
          <li>
           18.
          </li>
          <li>
           19.
          </li>
          <li>
           20.
          </li>
          <li>
           21.
          </li>
          <li>
           22.
          </li>
          <li>
           23.
          </li>
          <li>
           24.
          </li>
          <li>
           25.
          </li>
          <li>
           26.
          </li>
          <li>
           27.
          </li>
          <li>
           28.
          </li>
          <li>
           29.
          </li>
          <li>
           30.
          </li>
          <li>
           31.
          </li>
          <li>
           32.
          </li>
          <li>
           33.
          </li>
          <li>
           34.
          </li>
          <li>
           35.
          </li>
          <li>
           36.
          </li>
         </ul>
        </div>
       </div>
       <p>
        输出结果：
       </p>
       <div class="code-toolbar">
        <div class="hljs-cto">
         <div class="operation_box">
          <button class="copy_btn disable">
           登录后复制
          </button>
          <a class="downloadCode" title="登录后一键下载全文代码">
           <i class="iconblog blogimport">
           </i>
          </a>
         </div>
         <pre class="has" tabindex="0"><code class="language-js" id="code_id_19"><span class="token number">48</span> alien
</code></pre>
         <ul class="pre-numbering">
          <li>
           1.
          </li>
         </ul>
        </div>
       </div>
       <p>
        刷新以后组件重新销毁创建定时器
       </p>
       <h4 class="markdown-h" id="h27">
        <a id="6React_499">
        </a>
        6、(函数式组件)React声明周期函数
       </h4>
       <p>
        需要注意的是：
       </p>
       <p>
        React函数式组件中，没有像类组件那样明确的声明周期函数，可以通过 React Hooks实现类似的生命周期函数
       </p>
       <p>
        常用的 React Hooks 及其对应的生命周期函数
       </p>
       <div class="code-toolbar">
        <div class="hljs-cto">
         <div class="operation_box">
          <button class="copy_btn disable">
           登录后复制
          </button>
          <a class="downloadCode" title="登录后一键下载全文代码">
           <i class="iconblog blogimport">
           </i>
          </a>
         </div>
         <pre class="has" tabindex="0"><code class="language-js" id="code_id_20"><span class="token number">1.</span>  <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">useState</span><span class="token template-punctuation string">`</span></span><span class="token operator">:</span> 用于声明状态变量，类似于类组件中的 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">state</span><span class="token template-punctuation string">`</span></span>
<span class="token number">1.</span>  <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">useEffect</span><span class="token template-punctuation string">`</span></span><span class="token operator">:</span> 在组件渲染后执行副作用操作，类似于类组件中的 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">componentDidMount</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">componentDidUpdate</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">componentWillUnmount</span><span class="token template-punctuation string">`</span></span>
<span class="token number">1.</span>  <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">useContext</span><span class="token template-punctuation string">`</span></span><span class="token operator">:</span> 用于访问 React 的上下文，类似于类组件中的 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">static contextType</span><span class="token template-punctuation string">`</span></span> 或 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Context.Consumer</span><span class="token template-punctuation string">`</span></span>
<span class="token number">1.</span>  <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">useReducer</span><span class="token template-punctuation string">`</span></span><span class="token operator">:</span> 用于应对复杂的状态管理逻辑，类似于类组件中的 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">setState</span><span class="token template-punctuation string">`</span></span>
<span class="token number">1.</span>  <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">useRef</span><span class="token template-punctuation string">`</span></span><span class="token operator">:</span> 创建一个可变的 ref 对象，类似于类组件中的 <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">createRef</span><span class="token template-punctuation string">`</span></span>
</code></pre>
         <ul class="pre-numbering">
          <li>
           1.
          </li>
          <li>
           2.
          </li>
          <li>
           3.
          </li>
          <li>
           4.
          </li>
          <li>
           5.
          </li>
         </ul>
        </div>
       </div>
       <p>
        Hooks 都可以帮助我们在函数式组件中实现类似于类组件的生命周期函数的功能
       </p>
      </div>
     </div>
    </div>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34333933323838362f:61727469636c652f64657461696c732f313436313934333437" class_="artid" style="display:none">
 </p>
</div>


