---
layout: post
title: "react中的文件下载"
date: 2025-03-11 15:12:49 +0800
description: "react中的文件下载"
keywords: "react中的文件下载"
categories: ['未分类']
tags: ['开发语言', '前端框架', '前端', 'React']
artid: "146179751"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146179751
    alt: "react中的文件下载"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146179751
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146179751
cover: https://bing.ee123.net/img/rand?artid=146179751
image: https://bing.ee123.net/img/rand?artid=146179751
img: https://bing.ee123.net/img/rand?artid=146179751
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     react中的文件下载
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <pre><code class="language-javascript">export async function download(url, params) {  

    const urls = /api/${url}?${stringify(params)};
    const response = await fetch(urls, {
        method: 'GET',
        headers: {
            Authorization: Basic c3dvcmQ6c3dvcmRfc2VjcmV0,
            'Blade-Auth': Bearer ${getAccessToken()},
            'Content-Type': 'application/x-www-form-urlencoded',
         
        },
    });

    if (!response.ok) {
        throw new Error(HTTP error! status: ${response.status});
    }

    const blob = await response.blob();
    const contentDisposition = response.headers.get('content-disposition');

    const filename = decodeURIComponent(contentDisposition).split('=')[1];
    const urlBlob = window.URL.createObjectURL(blob);
    const a = document.createElement('a');
    if (blob) {
        a.href = urlBlob;
        a.download = filename;
        document.body.appendChild(a);

        a.click();
        a.remove();
        window.URL.revokeObjectURL(urlBlob);
        return true;
    }
}</code></pre>
    <blockquote>
     <p>
      以上是相关的说明
     </p>
     <p>
      <code>
       download
      </code>
      方法是一个用于下载文件的异步函数，主要功能如下：
     </p>
     <ol>
      <li>
       <p>
        <strong>
         构建请求 URL
        </strong>
        ：
       </p>
       <ul>
        <li>
         使用
         <code>
          stringify(params)
         </code>
         将参数转换为查询字符串，并拼接到
         <code>
          url
         </code>
         上。
        </li>
        <li>
         拼接后的 URL 形如
         <code>
          /api/yourEndpoint?key=value
         </code>
         。
        </li>
       </ul>
      </li>
      <li>
       <p>
        <strong>
         发送 GET 请求
        </strong>
        ：
       </p>
       <ul>
        <li>
         通过
         <code>
          fetch
         </code>
         发送请求，携带
         <code>
          Authorization
         </code>
         和
         <code>
          Blade-Auth
         </code>
         认证头。
        </li>
        <li>
         设置
         <code>
          Content-Type
         </code>
         为
         <code>
          application/x-www-form-urlencoded
         </code>
         。
        </li>
       </ul>
      </li>
      <li>
       <p>
        <strong>
         错误处理
        </strong>
        ：
       </p>
       <ul>
        <li>
         如果
         <code>
          response.ok
         </code>
         为
         <code>
          false
         </code>
         ，抛出 HTTP 错误。
        </li>
       </ul>
      </li>
      <li>
       <p>
        <strong>
         处理响应
        </strong>
        ：
       </p>
       <ul>
        <li>
         将返回的数据转换为
         <code>
          blob
         </code>
         （二进制文件）。
        </li>
        <li>
         从
         <code>
          content-disposition
         </code>
         头中提取文件名。
        </li>
       </ul>
      </li>
      <li>
       <p>
        <strong>
         创建并触发下载
        </strong>
        ：
       </p>
       <ul>
        <li>
         通过
         <code>
          URL.createObjectURL
         </code>
         生成 Blob URL。
        </li>
        <li>
         创建
         <code>
          &lt;a&gt;
         </code>
         标签并设置
         <code>
          href
         </code>
         和
         <code>
          download
         </code>
         属性，模拟用户点击下载文件。
        </li>
        <li>
         下载完成后移除
         <code>
          &lt;a&gt;
         </code>
         标签并释放 Blob URL。
        </li>
       </ul>
      </li>
      <li>
       <p>
        <strong>
         返回下载状态
        </strong>
        ：
       </p>
       <ul>
        <li>
         如果文件成功下载，返回
         <code>
          true
         </code>
         。
        </li>
       </ul>
      </li>
     </ol>
    </blockquote>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34343136313730332f:61727469636c652f64657461696c732f313436313739373531" class_="artid" style="display:none">
 </p>
</div>


