---
layout: post
title: "vue3中ref和reactive的区别"
date: 2025-03-08 09:43:42 +0800
description: "在 Vue3 的响应式系统中，ref 和 reactive 是最核心的两个 API，它们的区别是开发者必须掌握的底层原理。"
keywords: "vue3 中 ref和reactive区别"
categories: ['Vue']
tags: ['开发语言', '前端框架', '前端', 'Vue', 'Javascript', 'Ecmascript']
artid: "146104886"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146104886
    alt: "vue3中ref和reactive的区别"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146104886
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146104886
cover: https://bing.ee123.net/img/rand?artid=146104886
image: https://bing.ee123.net/img/rand?artid=146104886
img: https://bing.ee123.net/img/rand?artid=146104886
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     vue3中ref和reactive的区别
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <h2>
     <a id="_2">
     </a>
     一、核心机制对比
    </h2>
    <table>
     <thead>
      <tr>
       <th>
        特性
       </th>
       <th>
        ref
       </th>
       <th>
        reactive
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <strong>
         包装对象
        </strong>
       </td>
       <td>
        RefImpl类实现
       </td>
       <td>
        Proxy代理对象
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         响应式原理
        </strong>
       </td>
       <td>
        通过 .value 的 getter/setter 拦截
       </td>
       <td>
        深度代理对象的属性访问
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         数据类型支持
        </strong>
       </td>
       <td>
        任意类型（推荐基本类型）
       </td>
       <td>
        仅对象/数组/集合类型
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         深层响应式
        </strong>
       </td>
       <td>
        自动展开（对象会转为 reactive）
       </td>
       <td>
        默认深层响应
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         模板自动解包
        </strong>
       </td>
       <td>
        支持（顶层属性自动解包）
       </td>
       <td>
        不支持（需保持对象引用）
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         TS类型推断
        </strong>
       </td>
       <td>
        Ref 类型包裹
       </td>
       <td>
        原始类型推断
       </td>
      </tr>
     </tbody>
    </table>
    <h2>
     <a id="_12">
     </a>
     二、底层实现剖析
    </h2>
    <h3>
     <a id="1_reactive_14">
     </a>
     1. reactive简单实现
    </h3>
    <pre><code class="prism language-js"><span class="token keyword">const</span> <span class="token function-variable function">reactive</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 依赖收集</span>
      <span class="token function">track</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
      <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">const</span> oldValue <span class="token operator">=</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
      <span class="token keyword">const</span> result <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>oldValue <span class="token operator">!==</span> value<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 触发更新</span>
        <span class="token function">trigger</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> result
    <span class="token punctuation">}</span>
    <span class="token comment">// 其他拦截操作...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
    <ul>
     <li>
      <strong>
       依赖收集(Track):
      </strong>
      <ul>
       <li>
        通过 track 函数将当前正在执行的副作用（effect）与目标对象的属性关联。
       </li>
       <li>
        使用 WeakMap 存储依赖关系，结构为：
       </li>
      </ul>
     </li>
    </ul>
    <pre><code class="prism language-js">targetMap <span class="token operator">=</span> <span class="token function">WeakMap</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token function">Map</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token function">Set</span><span class="token punctuation">(</span>effect1<span class="token punctuation">,</span> effect2<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <ul>
     <li>
      <strong>
       触发更新(Trigger):
      </strong>
      <ul>
       <li>
        当属性变化时，通过 trigger 函数找到所有关联的副作用并执行。
       </li>
      </ul>
     </li>
    </ul>
    <h3>
     <a id="2_ref__50">
     </a>
     2. ref 实现原理
    </h3>
    <pre><code class="prism language-ts"><span class="token keyword">class</span> <span class="token class-name">RefImpl</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_value <span class="token operator">=</span> <span class="token function">isObject</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">reactive</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">:</span> value<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>dep <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 依赖集合</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">get</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">track</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dep<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 依赖收集</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">set</span> <span class="token function">value</span><span class="token punctuation">(</span>newVal<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_value <span class="token operator">!==</span> newVal<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>_value <span class="token operator">=</span> <span class="token function">isObject</span><span class="token punctuation">(</span>newVal<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">reactive</span><span class="token punctuation">(</span>newVal<span class="token punctuation">)</span> <span class="token operator">:</span> newVal<span class="token punctuation">;</span>
      <span class="token function">trigger</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dep<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 触发更新</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">ref</span> <span class="token operator">=</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">RefImpl</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <ul>
     <li>
      <strong>
       依赖收集与触发更新:
      </strong>
      <ul>
       <li>
        每个 ref 实例内部维护一个 dep 集合（类似 reactive 的依赖管理）。
       </li>
       <li>
        当通过 .value 访问时，触发 track；修改时触发 trigger。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       关键设计：
      </strong>
      <ul>
       <li>
        <strong>
         值类型包装:
        </strong>
        通过 .value 访问值，解决基本类型无法被 Proxy 直接代理的问题。
       </li>
       <li>
        <strong>
         自动解包:
        </strong>
        在模板中使用 ref 时，Vue 会自动解包（无需写 .value）。
       </li>
      </ul>
     </li>
    </ul>
    <h2>
     <a id="_82">
     </a>
     三、实战场景对比
    </h2>
    <h3>
     <a id="1__83">
     </a>
     1. 基本类型处理
    </h3>
    <pre><code class="prism language-ts"><span class="token comment">// 正确用法</span>
<span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// ✅ 自动类型推断为 Ref&lt;number&gt;</span>

<span class="token comment">// 错误尝试</span>
<span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// ❌ 参数必须是对象类型</span>
</code></pre>
    <h3>
     <a id="2__91">
     </a>
     2. 对象类型处理
    </h3>
    <pre><code class="prism language-ts"><span class="token comment">// ref 处理对象（自动解包）</span>
<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  name<span class="token operator">:</span> <span class="token string">'John'</span><span class="token punctuation">,</span>
  address<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    city<span class="token operator">:</span> <span class="token string">'New York'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 等效于 reactive 写法</span>
<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  name<span class="token operator">:</span> <span class="token string">'John'</span><span class="token punctuation">,</span>
  address<span class="token operator">:</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    city<span class="token operator">:</span> <span class="token string">'New York'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 访问方式对比</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>value<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// ref 需要 .value</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span>        <span class="token comment">// reactive 直接访问</span>
</code></pre>
    <h3>
     <a id="3__115">
     </a>
     3. 数组处理
    </h3>
    <pre><code class="prism language-ts"><span class="token comment">// ref 数组</span>
<span class="token keyword">const</span> listRef <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
listRef<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment">// ✅ 正确修改方式</span>

<span class="token comment">// reactive 数组</span>
<span class="token keyword">const</span> listReactive <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
listReactive<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment">// ✅ 直接操作</span>
</code></pre>
    <h2>
     <a id="_127">
     </a>
     四、高级特性差异
    </h2>
    <h3>
     <a id="1__129">
     </a>
     1. 响应式丢失问题
    </h3>
    <pre><code class="prism language-ts"><span class="token comment">// reactive 的解构问题</span>
<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> count<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> count <span class="token punctuation">}</span> <span class="token operator">=</span> state <span class="token comment">// ❌ 失去响应性</span>

<span class="token comment">// ref 的 解构</span>
<span class="token keyword">const</span> countRef <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> count <span class="token operator">=</span> countRef <span class="token comment">// ❌ 仍需通过 .value 访问</span>

<span class="token comment">// 正确解构方式（reactive）</span>
<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> count<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> countRef <span class="token operator">=</span> <span class="token function">toRef</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> <span class="token string">'count'</span><span class="token punctuation">)</span> <span class="token comment">// ✅ 保持响应</span>
</code></pre>
    <h3>
     <a id="2__145">
     </a>
     2. 类型替换场景
    </h3>
    <pre><code class="prism language-ts"><span class="token comment">// ref 允许整体替换</span>
<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> items<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
data<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// ✅ 响应式更新</span>

<span class="token comment">// reactive 需保持引用</span>
<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> items<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// ✅ 正确方式</span>
data <span class="token operator">=</span> <span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> ❌ 破坏响应性
</code></pre>
    <h2>
     <a id="_158">
     </a>
     五、性能对比分析
    </h2>
    <table>
     <thead>
      <tr>
       <th>
        操作
       </th>
       <th>
        ref(基本类型)
       </th>
       <th>
        reactive(对象)
       </th>
       <th>
        差异原因
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        创建速度
       </td>
       <td>
        ★★★★☆
       </td>
       <td>
        ★★★☆☆
       </td>
       <td>
        Proxy初始化成本较高
       </td>
      </tr>
      <tr>
       <td>
        属性访问
       </td>
       <td>
        ★★★★☆
       </td>
       <td>
        ★★★☆☆
       </td>
       <td>
        Proxy拦截带来额外开销
       </td>
      </tr>
      <tr>
       <td>
        深层监听
       </td>
       <td>
        ★☆☆☆☆
       </td>
       <td>
        ★★★★★
       </td>
       <td>
        Proxy自动深度代理
       </td>
      </tr>
      <tr>
       <td>
        内存占用
       </td>
       <td>
        较低
       </td>
       <td>
        较高
       </td>
       <td>
        Proxy对象占用更多内存
       </td>
      </tr>
     </tbody>
    </table>
    <h2>
     <a id="_167">
     </a>
     六、最佳实践
    </h2>
    <h3>
     <a id="1__169">
     </a>
     1. 组合式函数规范
    </h3>
    <pre><code class="prism language-ts"><span class="token comment">// 推荐返回 ref 保持灵活性</span>
<span class="token keyword">function</span> <span class="token function">useCounter</span><span class="token punctuation">(</span>initial <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span>initial<span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span> count <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 复杂状态使用 reactive + toRefs</span>
<span class="token keyword">function</span> <span class="token function">useUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    name<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    age<span class="token operator">:</span> <span class="token string">''</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span> <span class="token operator">...</span><span class="token function">toRefs</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="2__187">
     </a>
     2. 表单处理策略
    </h3>
    <pre><code class="prism language-ts"><span class="token comment">// 复杂表单使用 reactive</span>
<span class="token keyword">const</span> form <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  username<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
  password<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
  preferences<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    theme<span class="token operator">:</span> <span class="token string">'light'</span><span class="token punctuation">,</span>
    notifications<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 单个表单字段使用 ref</span>
<span class="token keyword">const</span> searchQuery <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
</code></pre>
    <h2>
     <a id="_203">
     </a>
     七、特殊场景处理
    </h2>
    <h3>
     <a id="1_DOM__205">
     </a>
     1. DOM 引用
    </h3>
    <p>
     <strong>
      获取元素对象或者组件对象只能使用 ref ，reactive无法处理 DOM 引用
     </strong>
    </p>
    <pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">

<span class="token keyword">const</span> inputRef <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>templete</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>inputRef<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>templete</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <h3>
     <a id="2__218">
     </a>
     2. 第三方库集成
    </h3>
    <pre><code class="prism language-js"><span class="token comment">// 需要保持引用的场景</span>
<span class="token keyword">const</span> chartInstance <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>

<span class="token comment">// 响应式配置对象</span>
<span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token function">reacitve</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">'热销'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">series</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token operator">...</span> <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <h2>
     <a id="_229">
     </a>
     八、总结选择策略
    </h2>
    <h3>
     <a id="1__ref__231">
     </a>
     1. 优先使用 ref 的场景
    </h3>
    <ul>
     <li>
      基本类型值（string/number/boolean）
     </li>
     <li>
      需要模板自动解包
     </li>
     <li>
      可能被整体替换的对象
     </li>
     <li>
      需要传递给composable函数的参数
     </li>
    </ul>
    <h3>
     <a id="2__reactive__238">
     </a>
     2. 优先使用 reactive 的场景
    </h3>
    <ul>
     <li>
      复杂嵌套对象
     </li>
     <li>
      需要深度响应式监听
     </li>
     <li>
      表单/配置对象等结构化数据
     </li>
     <li>
      需要直接操作集合类型（Map/Set）
     </li>
    </ul>
    <h3>
     <a id="3__245">
     </a>
     3. 混合使用
    </h3>
    <h4>
     <a id="31_reactive__ref_247">
     </a>
     3.1 reactive 嵌套 ref
    </h4>
    <pre><code class="prism language-ts"><span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  count<span class="token operator">:</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 基础类型 ref ，自动解包</span>
  user<span class="token operator">:</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span>User<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> name<span class="token operator">:</span> <span class="token string">''</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// 对象类型 ref ，自动解包</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <ul>
     <li>
      <strong>
       行为特点:
      </strong>
      Vue 会自动解包嵌套在 reactive 中的 ref，访问时无需 .value
     </li>
    </ul>
    <pre><code class="prism language-ts">state<span class="token punctuation">.</span>count<span class="token operator">++</span> <span class="token comment">// 直接操作数字（等价于 state.count.value++）</span>
state<span class="token punctuation">.</span>user<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'john'</span> <span class="token comment">// 直接操作对象（等价于 state.user.value.name）</span>
</code></pre>
    <ul>
     <li>
      <strong>
       适用场景
      </strong>
      <ul>
       <li>
        <strong>
         混合响应式类型：
        </strong>
        当 reactive 对象需要包含基础类型 + 对象类型的混合数据时，用 ref 统一包裹，享受自动解包特性。
       </li>
       <li>
        <strong>
         外部数据注入：
        </strong>
        当某个属性需要从外部接收 ref 类型时（如组合式函数返回的 ref），直接将其嵌入 reactive 对象。
       </li>
      </ul>
     </li>
    </ul>
    <h4>
     <a id="32_ref__reactive_267">
     </a>
     3.2 ref 嵌套 reactive
    </h4>
    <pre><code class="prism language-ts"><span class="token keyword">const</span> complexRef <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  data<span class="token operator">:</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token comment">/*...*/</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 嵌套 reactive 对象</span>
  status<span class="token operator">:</span> <span class="token string">'loading'</span>  <span class="token comment">// 普通属性（非响应式）</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <ul>
     <li>
      <strong>
       行为特点:
      </strong>
      <ul>
       <li>
        <strong>
         层级访问：
        </strong>
        需要 .value 访问容器内内容
       </li>
       <li>
        <strong>
         响应式范围：
        </strong>
        <ul>
         <li>
          complexRef.value.data 是响应式对象（reactive 创建）
         </li>
         <li>
          complexRef.value.status 是普通字符串（非响应式）
         </li>
        </ul>
       </li>
      </ul>
     </li>
    </ul>
    <pre><code class="prism language-ts">complexRef<span class="token punctuation">.</span>value<span class="token punctuation">.</span>data<span class="token punctuation">.</span>key <span class="token operator">=</span> <span class="token string">"value"</span><span class="token punctuation">;</span>  <span class="token comment">// 直接修改 reactive 对象</span>
complexRef<span class="token punctuation">.</span>value<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token string">"success"</span><span class="token punctuation">;</span>  <span class="token comment">// 修改普通属性（非响应式）</span>
</code></pre>
    <ul>
     <li>
      <strong>
       适用场景：
      </strong>
      <ul>
       <li>
        <strong>
         整体替换响应式对象
        </strong>
        :如果需要完全替换整个响应式对象，用 ref 包裹可以保持引用。
       </li>
       <li>
        <strong>
         组合非响应式数据：
        </strong>
        当需要混合响应式和非响应式数据时，ref 作为容器更灵活。
       </li>
      </ul>
     </li>
    </ul>
    <pre><code class="prism language-ts">complexRef<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>  <span class="token comment">// 替换整个对象（触发响应式更新）</span>
  data<span class="token operator">:</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token comment">/*...*/</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  status<span class="token operator">:</span> <span class="token string">'success'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f37343131343431372f:61727469636c652f64657461696c732f313436313034383836" class_="artid" style="display:none">
 </p>
</div>


