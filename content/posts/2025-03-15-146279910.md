---
layout: post
title: "前端面试题-vue项目打包时,-内存不足了怎么办-为什么会出现这样的情况"
date: 2025-03-15 15:21:11 +0800
description: "增加 Node.js 内存限制（最有效）关闭 Source Map启用 Webpack 缓存减少 Webpack 处理的文件启用 Webpack 多进程升级 Vue CLI 和 Webpack这样可以显著降低打包时的内存占用，提高构建速度。"
keywords: "前端面试题---vue项目打包时, 内存不足了怎么办 为什么会出现这样的情况"
categories: ['未分类']
tags: ['前端', 'Vue', 'Javascript']
artid: "146279910"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146279910
    alt: "前端面试题-vue项目打包时,-内存不足了怎么办-为什么会出现这样的情况"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146279910
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146279910
cover: https://bing.ee123.net/img/rand?artid=146279910
image: https://bing.ee123.net/img/rand?artid=146279910
img: https://bing.ee123.net/img/rand?artid=146279910
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     前端面试题---vue项目打包时, 内存不足了怎么办 为什么会出现这样的情况
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     Vue 项目打包时如果出现 内存不足（OOM，Out of Memory）简称就是OOM，通常是因为项目代码量较大、依赖过多、打包时 Webpack 需要处理的文件过多，导致 Node.js 运行时超出了默认的内存限制。
    </p>
    <h2>
     <a id="_2">
     </a>
     一、为什么会出现内存不足？
    </h2>
    <ul>
     <li>
      项目过大：项目代码文件过多，Webpack 需要处理的内容太多。
     </li>
     <li>
      第三方库过多：node_modules 体积过大，依赖库多且未进行优化。
     </li>
     <li>
      Source Map 过大：默认 production 模式会生成 .map 文件，占用大量内存。
     </li>
     <li>
      Tree Shaking 失败：未正确优化 Webpack，导致无用代码未被剔除。
     </li>
     <li>
      Node.js 默认内存限制：Node.js 进程默认最大内存约为 1.76GB（32 位）或 4GB（64 位），超出就会 OOM。
     </li>
     <li>
      Loader 处理文件过多：如 vue-loader、babel-loader 在转换文件时占用大量内存。
      <br/>
      缓存未启用：Webpack 没有缓存处理，每次都要重新编译所有文件，增加内存消耗。
     </li>
    </ul>
    <h2>
     <a id="_10">
     </a>
     二、如何解决内存不足问题？
    </h2>
    <ol>
     <li>
      增加 Node.js 内存限制（最直接的方法）
      <br/>
      在 package.json 的 scripts 里修改 build 命令：
     </li>
    </ol>
    <pre><code class="prism language-json"><span class="token string-property property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"build"</span><span class="token operator">:</span> <span class="token string">"node --max-old-space-size=8192 node_modules/.bin/vue-cli-service build"</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     或者直接在命令行执行：
    </p>
    <pre><code class="prism language-sh"><span class="token builtin class-name">export</span> <span class="token assign-left variable">NODE_OPTIONS</span><span class="token operator">=</span><span class="token string">"--max-old-space-size=8192"</span>  <span class="token comment"># Linux/macOS</span>
<span class="token builtin class-name">set</span> <span class="token assign-left variable">NODE_OPTIONS</span><span class="token operator">=</span><span class="token string">"--max-old-space-size=8192"</span>    <span class="token comment"># Windows</span>
<span class="token function">npm</span> run build
</code></pre>
    <p>
     这里 8192 代表 8GB，你可以改成 4096（4GB）或 16384（16GB）看情况调整。
    </p>
    <ol start="2">
     <li>
      关闭 Source Map
      <br/>
      如果不需要调试 SourceMap，可以在 vue.config.js 中关闭：
     </li>
    </ol>
    <pre><code class="prism language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">productionSourceMap</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     这样可以减少 .map 文件的生成，降低内存占用。
    </p>
    <h2>
     <a id="3__Webpack__38">
     </a>
     3. 开启 Webpack 持久化缓存
    </h2>
    <p>
     在 vue.config.js 里启用持久化缓存，提高二次打包速度，减少内存占用：
    </p>
    <pre><code class="prism language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">cache</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'filesystem'</span><span class="token punctuation">,</span> <span class="token comment">// 持久化缓存</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <ol start="4">
     <li>
      减少 Webpack 处理的文件
      <br/>
      （1）排除不必要的模块
      <br/>
      可以通过 externals 让 Webpack 不打包某些库，改为 CDN 方式：
     </li>
    </ol>
    <pre><code class="prism language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">externals</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">vue</span><span class="token operator">:</span> <span class="token string">'Vue'</span><span class="token punctuation">,</span>
      <span class="token string-property property">'vue-router'</span><span class="token operator">:</span> <span class="token string">'VueRouter'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">axios</span><span class="token operator">:</span> <span class="token string">'axios'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     这样 Webpack 就不会打包这些库，减少打包体积和内存占用。
    </p>
    <p>
     （2）减少 Babel 转译的范围
     <br/>
     在 babel.config.js 里排除 node_modules：
    </p>
    <pre><code class="prism language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">presets</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@vue/cli-plugin-babel/preset'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">ignore</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'node_modules'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
    <ol start="5">
     <li>
      启用 Webpack 多进程构建（thread-loader）
      <br/>
      在 vue.config.js 里开启多线程：
     </li>
    </ol>
    <pre><code class="prism language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
          <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
          <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'thread-loader'</span><span class="token punctuation">,</span> <span class="token string">'babel-loader'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     这样可以利用多核 CPU，提高构建效率，减少单个进程的内存压力。
    </p>
    <ol start="6">
     <li>
      升级依赖，优化 Webpack
      <br/>
      升级 Vue CLI、Webpack：旧版本的 Webpack 可能有性能问题，可以尝试升级 Vue CLI：
     </li>
    </ol>
    <pre><code class="prism language-sh"><span class="token function">npm</span> update <span class="token parameter variable">-g</span> @vue/cli
</code></pre>
    <p>
     优化 Tree Shaking：确保 sideEffects 设置正确，避免无用代码进入打包：
    </p>
    <pre><code class="prism language-json"><span class="token string-property property">"sideEffects"</span><span class="token operator">:</span> <span class="token boolean">false</span>
</code></pre>
    <h2>
     <a id="_105">
     </a>
     总结
    </h2>
    <p>
     如果 Vue 项目打包时内存不足，可以尝试：
    </p>
    <ul>
     <li>
      增加 Node.js 内存限制（最有效）
     </li>
     <li>
      关闭 Source Map
     </li>
     <li>
      启用 Webpack 缓存
     </li>
     <li>
      减少 Webpack 处理的文件
     </li>
     <li>
      启用 Webpack 多进程
     </li>
     <li>
      升级 Vue CLI 和 Webpack
     </li>
     <li>
      这样可以显著降低打包时的内存占用，提高构建速度。
     </li>
    </ul>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323330325f38303137313631392f:61727469636c652f64657461696c732f313436323739393130" class_="artid" style="display:none">
 </p>
</div>


