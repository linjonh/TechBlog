---
layout: post
title: "初探-Threejs-物理引擎CANNON,解锁-3D-动态魅力"
date: 2025-03-15 16:20:17 +0800
description: "开启 Threejs 物理引擎cannon初体验！此教程带你认识物理引擎基础，轻松掌握在 Threejs 里添加物体重力、碰撞效果，无需复杂操作，快速赋予 3D 场景真实物理交互，开启不一样的 3D 创作。"
keywords: "初探 Threejs 物理引擎CANNON，解锁 3D 动态魅力"
categories: ['Threejs']
tags: ['前端', 'Webgl', 'Threejs', 'Cannon', '3D']
artid: "146281099"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146281099
    alt: "初探-Threejs-物理引擎CANNON,解锁-3D-动态魅力"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146281099
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146281099
cover: https://bing.ee123.net/img/rand?artid=146281099
image: https://bing.ee123.net/img/rand?artid=146281099
img: https://bing.ee123.net/img/rand?artid=146281099
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     初探 Threejs 物理引擎CANNON，解锁 3D 动态魅力
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="_0">
     </a>
     简介
    </h3>
    <p>
     Cannon.js 是一个基于 JavaScript 的物理引擎，它可以在浏览器中模拟物理效果。它支持碰撞检测、刚体动力学、约束等物理效果，可以用于创建逼真的物理场景和交互。
    </p>
    <p>
     <a href="https://pmndrs.github.io/cannon-es/docs/index.html" rel="nofollow">
      参考文档
     </a>
    </p>
    <p>
     <a href="https://pmndrs.github.io/cannon-es/" rel="nofollow">
      官方示例
     </a>
    </p>
    <h3>
     <a id="_8">
     </a>
     原理
    </h3>
    <p>
     Cannon.js 使用了欧拉角来表示物体的旋转，而不是四元数。这使得它在处理旋转时更加直观和易于理解。Cannon.js 还支持多种碰撞检测算法，包括离散碰撞检测和连续碰撞检测。
    </p>
    <p>
     Cannon.js 还支持多种约束类型，包括固定约束、滑动约束和铰链约束等。这些约束可以用于限制物体的运动，例如将两个物体固定在一起，或者将一个物体限制在一个滑动路径上。这使得 Cannon.js 可以创建逼真的物理场景和交互。
    </p>
    <h3>
     <a id="_14">
     </a>
     安装
    </h3>
    <pre><code class="prism language-bash"><span class="token function">npm</span> <span class="token function">install</span> cannon-es
</code></pre>
    <h3>
     <a id="_20">
     </a>
     使用
    </h3>
    <p>
     需要要使用 Cannon.js，首先需要创建一个物理世界，然后向其中添加物体和约束。接下来，在每个时间步长中更新物理世界，并使用物理世界中的物体和约束来计算物体的位置和旋转，由于在物理世界中创建的物体是看不到的，所以需要将这些位置和旋转应用到 Three.js 场景中的物体上。
    </p>
    <h4>
     <a id="_24">
     </a>
     引入
    </h4>
    <pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> <span class="token constant">CANNON</span> <span class="token keyword">from</span> <span class="token string">"cannon-es"</span><span class="token punctuation">;</span>
</code></pre>
    <h4>
     <a id="_30">
     </a>
     创建物理世界
    </h4>
    <pre><code class="prism language-js"><span class="token keyword">const</span> world <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CANNON<span class="token punctuation">.</span>World</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
world<span class="token punctuation">.</span>gravity<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">9.82</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置重力</span>
</code></pre>
    <p>
     <strong>
      word.gravity：
     </strong>
     属性用于设置物理世界的重力。
    </p>
    <ul>
     <li>
      x: 重力的 x 分量。
     </li>
     <li>
      y: 重力的 y 分量。
     </li>
     <li>
      z: 重力的 z 分量。
     </li>
    </ul>
    <h4>
     <a id="_43">
     </a>
     创建物体
    </h4>
    <pre><code class="prism language-js"><span class="token comment">//物理世界物体</span>
<span class="token keyword">const</span> sphereShape <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CANNON<span class="token punctuation">.</span>Sphere</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建一个球体形状</span>
<span class="token keyword">const</span> sphereBody <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CANNON<span class="token punctuation">.</span>Body</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">mass</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token literal-property property">shape</span><span class="token operator">:</span> sphereShape<span class="token punctuation">,</span>
  <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">CANNON<span class="token punctuation">.</span>Vec3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建一个球体物体</span>
world<span class="token punctuation">.</span><span class="token function">addBody</span><span class="token punctuation">(</span>sphereBody<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将球体添加到物理世界中</span>
<span class="token comment">//Three.js 场景中的物体</span>
<span class="token keyword">const</span> sphereGeometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SphereGeometry</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建一个球体几何体</span>
<span class="token keyword">const</span> sphereMaterial <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0x00ff00</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建一个球体材质</span>
<span class="token keyword">const</span> sphereMesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>sphereGeometry<span class="token punctuation">,</span> sphereMaterial<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建一个球体网格</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>sphereMesh<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将球体网格添加到场景中</span>
</code></pre>
    <p>
     <strong>
      CANNON.Sphere()：
     </strong>
     方法用于创建一个球体形状。
    </p>
    <ul>
     <li>
      radius: 球体的半径。
     </li>
    </ul>
    <p>
     <strong>
      CANNON.Body()：
     </strong>
     方法用于创建一个物体。
    </p>
    <ul>
     <li>
      mass: 物体的质量。
     </li>
     <li>
      shape: 物体的形状。
     </li>
     <li>
      position: 物体的位置。
     </li>
    </ul>
    <p>
     <strong>
      world.addBody()：
     </strong>
     方法用于将物体添加到物理世界中。
    </p>
    <h4>
     <a id="_73">
     </a>
     更新物理世界
    </h4>
    <pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>animate<span class="token punctuation">)</span><span class="token punctuation">;</span>
  world<span class="token punctuation">.</span><span class="token function">step</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 更新物理世界</span>
  <span class="token comment">// 将物理世界中的球体位置应用到 Three.js 场景中的球体网格上</span>
  sphereMesh<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>sphereBody<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 将物理世界中的球体旋转应用到 Three.js 场景中的球体网格上</span>
  sphereMesh<span class="token punctuation">.</span>quaternion<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>sphereBody<span class="token punctuation">.</span>quaternion<span class="token punctuation">)</span><span class="token punctuation">;</span>
  renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>scene<span class="token punctuation">,</span> camera<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 渲染场景</span>
<span class="token punctuation">}</span>
<span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <strong>
      world.step()：
     </strong>
     方法用于更新物理世界中的物体和约束的状态。
    </p>
    <ul>
     <li>
      dt: 时间步长，用于计算物体的运动和碰撞。
     </li>
     <li>
      time: 当前时间，用于计算物体的运动和碰撞。
     </li>
     <li>
      correction: 时间步长修正，用于修正时间步长导致的误差。
     </li>
    </ul>
    <p>
     <strong>
      copy()：
     </strong>
     方法用于将一个向量的值复制到另一个向量中。
    </p>
    <ul>
     <li>
      v: 要复制的向量。
     </li>
    </ul>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/b1fb00f3b1c64eba99c8317ab041785e.gif#pic_center"/>
    </p>
    <h3>
     <a id="_100">
     </a>
     碰撞检测
    </h3>
    <p>
     Cannon.js 支持多种碰撞检测算法，包括离散碰撞检测和连续碰撞检测。离散碰撞检测是在每个时间步长中检查物体之间的碰撞，而连续碰撞检测则是在物体之间可能发生碰撞的路径上插入额外的检查点。这使得 Cannon.js 可以处理复杂的碰撞场景，例如物体之间的穿透和重叠。
    </p>
    <pre><code class="prism language-js"><span class="token keyword">const</span> groundShape <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CANNON<span class="token punctuation">.</span>Box</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CANNON<span class="token punctuation">.</span>Vec3</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> groundBody <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CANNON<span class="token punctuation">.</span>Body</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">shape</span><span class="token operator">:</span> groundShape<span class="token punctuation">,</span>
  <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">CANNON<span class="token punctuation">.</span>Vec3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">CANNON</span><span class="token punctuation">.</span>Body<span class="token punctuation">.</span><span class="token constant">STATIC</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
groundBody<span class="token punctuation">.</span>quaternion<span class="token punctuation">.</span><span class="token function">setFromAxisAngle</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CANNON<span class="token punctuation">.</span>Vec3</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
world<span class="token punctuation">.</span><span class="token function">addBody</span><span class="token punctuation">(</span>groundBody<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//创建一个平面的几何体</span>
<span class="token keyword">const</span> groundGeometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BoxGeometry</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//创建一个平面的材质</span>
<span class="token keyword">const</span> groundMaterial <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0xffff00</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//创建一个平面的网格</span>
<span class="token keyword">const</span> ground <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>groundGeometry<span class="token punctuation">,</span> groundMaterial<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//设置平面的位置</span>
ground<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">;</span>
<span class="token comment">//将平面添加到场景中</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>ground<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <strong>
      CANNON.Plane()：
     </strong>
     方法用于创建一个平面形状。
    </p>
    <p>
     <strong>
      CANNON.Box()：
     </strong>
     方法用于创建一个盒子形状。
    </p>
    <p>
     <strong>
      setFromAxisAngle()：
     </strong>
     方法用于设置物体的旋转。
    </p>
    <ul>
     <li>
      axis: 旋转轴。
     </li>
     <li>
      angle: 旋转角度。
     </li>
    </ul>
    <p>
     <strong>
      body.type:
     </strong>
     物体的类型
    </p>
    <ul>
     <li>
      CANNON.Body.KINEMATIC: 物体是动态的，可以移动和旋转。
     </li>
     <li>
      CANNON.Body.STATIC: 物体是静态的，不能移动和旋转。
     </li>
     <li>
      CANNON.Body.DYNAMIC: 物体是动态的，可以移动和旋转，并且受到物理世界的重力和其他力的作用。
     </li>
    </ul>
    <pre><code class="prism language-js"><span class="token keyword">const</span> groundBody <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CANNON<span class="token punctuation">.</span>Body</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">shape</span><span class="token operator">:</span> groundShape<span class="token punctuation">,</span>
  <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">CANNON<span class="token punctuation">.</span>Vec3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">CANNON</span><span class="token punctuation">.</span>Body<span class="token punctuation">.</span><span class="token constant">STATIC</span><span class="token punctuation">,</span> <span class="token comment">// 设置物体类型为静态</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre>
    <h3>
     <a id="_149">
     </a>
     示例
    </h3>
    <pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> <span class="token constant">THREE</span> <span class="token keyword">from</span> <span class="token string">"three"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> OrbitControls <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"three/examples/jsm/controls/OrbitControls.js"</span><span class="token punctuation">;</span>
<span class="token comment">//引入CannonJS</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> <span class="token constant">CANNON</span> <span class="token keyword">from</span> <span class="token string">"cannon-es"</span><span class="token punctuation">;</span>

<span class="token comment">// 创建场景</span>
<span class="token keyword">const</span> scene <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Scene</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 创建相机</span>
<span class="token keyword">const</span> camera <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PerspectiveCamera</span><span class="token punctuation">(</span><span class="token number">75</span><span class="token punctuation">,</span> window<span class="token punctuation">.</span>innerWidth <span class="token operator">/</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
camera<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
camera<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
camera<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">;</span>

<span class="token comment">// 创建渲染器</span>
<span class="token keyword">const</span> renderer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>WebGLRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">antialias</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
renderer<span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">,</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>renderer<span class="token punctuation">.</span>domElement<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建物理世界</span>
<span class="token keyword">const</span> world <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CANNON<span class="token punctuation">.</span>World</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
world<span class="token punctuation">.</span>gravity<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">9.82</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建一个球体</span>
<span class="token keyword">const</span> sphereShape <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CANNON<span class="token punctuation">.</span>Sphere</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> sphereBody <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CANNON<span class="token punctuation">.</span>Body</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">mass</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token literal-property property">shape</span><span class="token operator">:</span> sphereShape<span class="token punctuation">,</span>
  <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">CANNON<span class="token punctuation">.</span>Vec3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
world<span class="token punctuation">.</span><span class="token function">addBody</span><span class="token punctuation">(</span>sphereBody<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建一个平面</span>
<span class="token keyword">const</span> groundShape <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CANNON<span class="token punctuation">.</span>Box</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CANNON<span class="token punctuation">.</span>Vec3</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> groundBody <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CANNON<span class="token punctuation">.</span>Body</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">shape</span><span class="token operator">:</span> groundShape<span class="token punctuation">,</span>
  <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">CANNON<span class="token punctuation">.</span>Vec3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">CANNON</span><span class="token punctuation">.</span>Body<span class="token punctuation">.</span><span class="token constant">STATIC</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
groundBody<span class="token punctuation">.</span>quaternion<span class="token punctuation">.</span><span class="token function">setFromAxisAngle</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CANNON<span class="token punctuation">.</span>Vec3</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
world<span class="token punctuation">.</span><span class="token function">addBody</span><span class="token punctuation">(</span>groundBody<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//创建一个球体的几何体</span>
<span class="token keyword">const</span> sphereGeometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SphereGeometry</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//创建一个球体的材质</span>
<span class="token keyword">const</span> sphereMaterial <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0x00ff00</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//创建一个球体的网格</span>
<span class="token keyword">const</span> sphere <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>sphereGeometry<span class="token punctuation">,</span> sphereMaterial<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//将球体添加到场景中</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>sphere<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//创建一个平面的几何体</span>
<span class="token keyword">const</span> groundGeometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BoxGeometry</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//创建一个平面的材质</span>
<span class="token keyword">const</span> groundMaterial <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0xffff00</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//创建一个平面的网格</span>
<span class="token keyword">const</span> ground <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>groundGeometry<span class="token punctuation">,</span> groundMaterial<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//设置平面的位置</span>
ground<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">;</span>
<span class="token comment">//将平面添加到场景中</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>ground<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//创建控制器</span>
<span class="token keyword">const</span> controls <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OrbitControls</span><span class="token punctuation">(</span>camera<span class="token punctuation">,</span> renderer<span class="token punctuation">.</span>domElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 启用阻尼效果</span>
controls<span class="token punctuation">.</span>enableDamping <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>animate<span class="token punctuation">)</span><span class="token punctuation">;</span>
  world<span class="token punctuation">.</span><span class="token function">step</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  sphere<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>sphereBody<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token punctuation">;</span>
  sphere<span class="token punctuation">.</span>quaternion<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>sphereBody<span class="token punctuation">.</span>quaternion<span class="token punctuation">)</span><span class="token punctuation">;</span>
  renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>scene<span class="token punctuation">,</span> camera<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//监听窗口大小变化</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"resize"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  camera<span class="token punctuation">.</span>aspect <span class="token operator">=</span> window<span class="token punctuation">.</span>innerWidth <span class="token operator">/</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">;</span>
  camera<span class="token punctuation">.</span><span class="token function">updateProjectionMatrix</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  renderer<span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">,</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/a12ea1c7654e4800b8b33e7f2a64c535.gif#pic_center">
      <br/>
      <a href="https://mp.weixin.qq.com/s/52R6dhlP6jdZnmgcD3H6Nw" rel="nofollow">
       书洞笔记
      </a>
     </img>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34353438353735392f:61727469636c652f64657461696c732f313436323831303939" class_="artid" style="display:none">
 </p>
</div>


