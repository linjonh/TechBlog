---
layout: post
title: 自动备份SQL-Server数据库,试试这4种方法
date: 2024-12-30 13:01:48 +0800
categories: ['数据库备份']
tags: ['数据库备份', '数据库', '傲梅企业备份', 'Sql']
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=139865908
    alt: 自动备份SQL-Server数据库,试试这4种方法
artid: 139865908
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=139865908
featuredImagePreview: https://bing.ee123.net/img/rand?artid=139865908
---

# 自动备份SQL Server数据库，试试这4种方法！

![](https://i-blog.csdnimg.cn/blog_migrate/0d63beb4ce36ccac174959ec22975d07.png)

各种规模的企业都使用 SQL 数据库来存储数据。因此，备份 SQL Server 数据库对于确保数据安全并在发生灾难时可恢复至关重要。对于 SQL 数据库备份，有多种可行的方法，对于特定组织来说，方法将取决于其具体需求。

SQL Server 备份的主要类型

您可以使用四种主要类型的 SQL Server 备份来保护数据：完整备份、差异备份、事务日志备份和仅复制备份。

1. ****完整备份****

   包含数据库中的所有数据，它们通常用作其他类型备份的基准。
2. ****差异备份****

   仅保留自上次完整备份以来更改的数据。
3. ****数据库事务日志备份****

   保存自上次完整备份或差异备份以来发生的所有事务。
4. ****仅复制备份****

   是不用于恢复数据库的数据库副本；它们用于创建测试环境或将数据复制到另一个位置等任务。

### ******如何自动备份SQL Server数据库******

现在我们已经了解了基础知识，让我们开始一起备份 SQL 数据库。

#### ******方法 1. 通过维护计划自动备份 SQL数据库******

维护计划创建任务工作流来维护您的数据库。您也可以将其用于定期备份。

1. 启动 SSMS 并连接到您的服务器。展开实例下的
****“管理”****

菜单，然后右键单击
****“维护计划”****

以创建
****“新维护计划”****

，或打开
****“维护计划向导”****

。

它们本质上是相同的，但向导将引导您完成整个操作。这里我将选择前者作为例子。

![](https://i-blog.csdnimg.cn/blog_migrate/59f7cddf0220ca17899323bde905c37f.png)

2. 您将被要求为该计划命名。确认后，您可以单击左侧的
****“工具箱，将”“备份数据库任务”****

拖到维护计划窗口的下方。

3. 双击生成的任务，可以在弹窗中进行配置。首先，从“
****完全****

”、“
****差异****

”和“
****日志****

”中选择
****“备份类型”。****

然后选择一个或多个
****“数据库”****

进行备份。单击“
****“确定”****

”进行确认。如果您选择了多个数据库，您还可以根据需要选择
****“为每个数据库创建一个备份文件”****

。

1. ****“完整备份”****

   包括备份期间发生的所有数据库对象、系统表、数据和事务。
2. ****“差异备份”****

   包括自上次完整备份以来在备份过程中发生更改的数据和事务。
3. ****“事务日志备份”****

   包括自上次事务日志备份以来数据库上发生的事务，然后截断事务日志，然后截断事务日志。事务日志备份确保数据库恢复到特定时间点，例如数据丢失之前的时刻。

![](https://i-blog.csdnimg.cn/blog_migrate/2185b73954d30f8790a0db1f1c09b215.png)

4. 现在您可以单击日历图标，即
****Subplan 计划任务****

来自动执行数据库备份任务。对于基于时间的计划，您可以保留“定期”作为
****“计划类型”****

的选择，并进一步配置频率和持续时间。

或者，您也可以将任务设置为“SQL Server 代理启动时自动启动”或“CPU 空闲时启动”。

5. 保存更改，现在您已经设置了SQL Server自动备份。然后您可以在 SQL Server 代理下找到该任务，您的所有备份都将按照指定的计划进行。

### ******方法 2. 使用 SQL Server 代理程序备份数据库的计划作业******

SQL Server 代理是一项执行计划管理作业的服务。每个作业都

1. 要使用它，启动 SSMS 并连接到您的实例。确保启用了 SQL Server 代理。如果没有，请右键单击它并
****“启动”****

它。然后，从右键菜单中选择
****“新建”****

>
****“作业”。****

![](https://i-blog.csdnimg.cn/blog_migrate/2e3c452b96997fea47eb563e60378477.png)

2. 新建作业 窗口将弹出。
****“您可以在“常规”****

”选项卡中键入其“名称”和“描述” 。

3.然后移动到
****“步骤”****

选项卡，单击左下角的
****“新建”****

进行配置。首先确保
****Type****

是“Transact-SQL script (T-SQL)”，然后选择
****Database****

作为“master”。然后就可以输入命令进行备份了。

数据库备份的基本命令如下：

备份数据库示例
  


To DISK = 'D:\SQL Server\example.bak';

您只需要根据需要替换数据库名称和文件路径。如果要对数据库进行差异备份，可以添加一行“WITH DIFFERENTIAL”。但请注意，必须事先创建完整备份。

要备份事务日志，只需将命令中的“DATABASE”替换为“LOG”即可：

备份日志示例
  


To DISK = 'D:\SQL Server\example.trn';

单击“
****“确定”****

”以确认命令，然后移至“
****“计划”****

”选项卡。

4. 同样，单击
****“新建”****

以创建新计划。您可以为其命名，选择计划类型并根据需要配置频率。完成后，单击“
****“确定”****

”保存。

![](https://i-blog.csdnimg.cn/blog_migrate/028384347d62b7b5d3a54beaccae0e9f.png)

5. 主要设置完成。您可以点击
****“完成”****

立即执行，或继续配置
****“警告”****

and
****Notifications****

。一切就绪后，您可以右键单击创建的作业，选择
****"从步骤开始"****

以测试它是否正常工作。如果没有，请从右键菜单中点击
****“查看历史记录以检查错误”。****

### ******方法 3. 使用任务计划程序自动执行SQL Server(Express) 备份******

尽管有多种解决方案可以执行SQL Server自动备份，但在 Express 版本中，您没有太多选择。如果没有 SSMS 中内置的维护计划和SQL Server代理功能，您必须创建一个 Transact-SQL 脚本批处理文件，并使用 Windows 任务计划程序将其自动化。

也就是说，您需要执行以下操作：

1. 在SQLQuery窗口中，复制这个里面的所有内容

，

然后单击上面的
****“执行”****

按钮。它将 在您的主数据库中创建一个 sp\_BackupDatabases 存储过程。

![](https://i-blog.csdnimg.cn/blog_migrate/f1833d92a7672b4ff48f0dbcaff8f759.png)

3. 打开文本编辑器并在其中输入备份脚本。执行完整备份的基本命令如下：

sqlcmd -S server -E -Q "EXEC sp\_BackupDatabases @backupLocation='path', @backupType='F'"

例如，我想通过 Windows Authentication 备份本地命名实例 MSSQLSERVER\_01 中的所有数据库，命令为：

sqlcmd -S .\MSSQLSERVER\_01 -E -Q "EXEC sp\_BackupDatabases @backupLocation='D:\SQL Server\', @backupType='F'"

\*如果要使用 SQL Server 身份验证，可以添加开关：-U -P

\* -E 开关表示使用可信连接，不能 与 -U 或 -P 一起使用。

\*如需进行差异备份，请将最后的“F”替换为“D”。同样，您可以使用“L”进行事务日志备份。

您还可以根据需要备份单个 SQL数据库，例如：

sqlcmd -S .\MSSQLSERVER\_01 -Q "备份数据库示例To DISK = 'D:\SQL Server\example.bak'"

4. 将文件另存为 .bat 扩展名。您可以为其命名，例如 Sqlbackup.bat。

5. 打开
****“任务计划程序”****

以自动备份批处理文件。您可以通过在 Windows 中搜索“任务计划程序”或转到“控制窗格”>“管理工具”>“任务计划程序”来找到它。

![](https://i-blog.csdnimg.cn/blog_migrate/52078010211e9ecbd6d1d140b7e39cca.png)

6. 单击
****“创建基本任务”****

并按照向导选择
****“触发器”****

。如果要每天执行 SQL Server自动备份，请选择“每日”。

![](https://i-blog.csdnimg.cn/blog_migrate/32606cc057a0886d5c4a826a46d3d3da.png)

7. 选择
****“动作”****

为“启动程序”，并将批处理文件指定为程序。设置完成后，您将自动运行一个自动备份任务。

![](https://i-blog.csdnimg.cn/blog_migrate/d9c58214478dd94d046556d3dc24949c.png)

计划自动备份任务可能会在你的磁盘中积累很多备份文件，所以如果你想区分这些日常备份，你也可以在 SQL Server中创建具有唯一名称的每日数据库备份

### ******方法 4. 使用自动备份软件安排 SQL 数据库备份******

以上方法都可以备份单个或多个数据库，但都不是很简单直接。由于设置过程中的小疏忽，也存在很高的错误风险。

要轻松自动备份SQL Server数据库或实例，您还可以尝试 SQL 自动备份软件，例如傲梅企业备份网络版它带有直观的 GUI，使您无需专业知识即可操作。有了它，您可以简单地
****“自动备份任意数量的数据库”****

。
****除了 SQL 数据库，它还支持文件、分区、磁盘和操作系统****

等其他数据类型。

此软件适用于 Windows 11/10/8.1/8/7/Vista/XP、Windows Server 2022/2019/2016/2012 (R2)/2008 (R2)/2003 (R2)、Microsoft Windows Home Server (WHS) 2011 , Windows Small Business Server (SBS) 2011 并允许您备份 SQL Server 2005 - 2019。

****如何使用软件创建 SQL Server 自动备份：****

1.在
****“主页”****

选项卡中或从
****“任务选项卡下的”“新建任务”****

菜单中选择
****SQL Server 备份****

。

![](https://i-blog.csdnimg.cn/blog_migrate/252149fc489b05464592ae1eb1525c81.png)

2. 点击
****第 1 步中的+ 添加计算机****

以检测所有带有 SQL Server 数据库的受控计算机。然后选择您要备份的客户端，然后单击
****“OK”****

。

![](https://i-blog.csdnimg.cn/blog_migrate/e8a147997b428404404fcda332eba99d.png)

3. 单击
****第 2 步****

。从左侧选择客户端计算机，然后可以单击
****+ 添加****

以检测其上的所有 SQL Server 实例。在选择屏幕上，您可以检查多个数据库甚至多个实例。

![](https://i-blog.csdnimg.cn/blog_migrate/7a530b54c47ff73887a344ec08405844.png)

4. 现在转到
****第 3 步****

。在弹出的窗口中，单击
****“添加存储”****

以指定共享或 NAS 设备作为目标位置。

5. 之后，单击
****“计划”****

以自动执行 SQL Server 备份。选项包括一次/每天/每周/每月，以及更具体的频率和间隔。
****“完全备份和差异备份在高级”****

窗口中也是可选的。设置完成后，您可以单击
****“开始备份”****

以执行任务。

### ******结论******

傲梅企业备份网络版不仅用于 SQL数据库备份。它也适用于 Windows PC 和服务器的集中备份和恢复。例如，您可以使用它来通过网络备份所有计算机，或将文件夹同步到客户端计算机上的其他位置。