---
arturl_encode: "68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34343634373130302f:61727469636c652f64657461696c732f313337323434323431"
layout: post
title: "RK3568æµ‹è¯•"
date: 2024-04-01 21:03:07 +0800
description: "æœ¬æ–‡è¯¦ç»†æè¿°äº†åœ¨RK3568å¼€å‘æ¿ä¸Šè¿›è¡ŒRS232ã€RS485ã€CANé€šä¿¡æ¥å£ä»¥åŠç»§ç”µå™¨ã€LEDå’ŒB"
keywords: "rk3568 uartæµ‹å›ç¯å‘½ä»¤"
categories: ['é©±åŠ¨å¼€å‘', 'Rk', 'Linux']
tags: ['æ¨¡å—æµ‹è¯•', 'åµŒå…¥å¼ç¡¬ä»¶', 'åŠŸèƒ½æµ‹è¯•', 'Linux']
artid: "137244241"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=137244241
    alt: "RK3568æµ‹è¯•"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=137244241
featuredImagePreview: https://bing.ee123.net/img/rand?artid=137244241
---

# RK3568æµ‹è¯•

ä½œè€…ç®€ä»‹ï¼š ä¸€ä¸ªå¹³å‡¡è€Œä¹äºåˆ†äº«çš„å°æ¯”ç‰¹ï¼Œä¸­å—æ°‘æ—å¤§å­¦é€šä¿¡å·¥ç¨‹ä¸“ä¸šç ”ç©¶ç”Ÿåœ¨è¯»ï¼Œç ”ç©¶æ–¹å‘æ— çº¿è”é‚¦å­¦ä¹ 
  
æ“…é•¿é¢†åŸŸï¼šé©±åŠ¨å¼€å‘ï¼ŒåµŒå…¥å¼è½¯ä»¶å¼€å‘ï¼ŒBSPå¼€å‘
  
ä½œè€…ä¸»é¡µï¼š
[ä¸€ä¸ªå¹³å‡¡è€Œä¹äºåˆ†äº«çš„å°æ¯”ç‰¹çš„ä¸ªäººä¸»é¡µ](https://blog.csdn.net/qq_44647100?type=blog)
  
æ–‡ç« æ”¶å½•ä¸“æ ï¼š
[RK3568é©±åŠ¨å¼€å‘](https://blog.csdn.net/qq_44647100/category_12625025.html)
ï¼Œæœ¬ä¸“æ ä¸ºrk3568é©±åŠ¨å¼€å‘å­¦ä¹ è®°å½•
  
æ¬¢è¿å¤§å®¶ç‚¹èµ ğŸ‘ æ”¶è— â­ åŠ å…³æ³¨å“¦ï¼ğŸ’–ğŸ’–

## RK3568æµ‹è¯•(RS232/RS485/CAN/ç»§ç”µå™¨/ä¸‰è·¯LED/èœ‚é¸£å™¨)

#### RS232æµ‹è¯•

è®¾å¤‡æ ‘å¦‚ä¸‹

```c
&uart3{
        dma-names = "tx", "rx";
        pinctrl-names = "default";
        pinctrl-0 = <&uart3m1_xfer>;
        status = "okay";
};

&uart4{
        dma-names = "tx", "rx";
        pinctrl-names = "default";
        pinctrl-0 = <&uart4m1_xfer>;
        status = "okay";
};

```

åœ¨/devç›®å½•ä¸‹çš„ttyS3å’ŒttyS4ä¸ºä¸¤è·¯RS232è®¾å¤‡ï¼Œä½¿ç”¨microcom å‘½ä»¤å¯ä»¥æ“ä½œ232ä¸²å£ã€‚å…·ä½“æµ‹è¯•å¦‚ä¸‹

å°†ä¸¤ä¸ª232è®¾å¤‡çš„RXå’ŒTXå£ç”¨æœé‚¦çº¿è¿›è¡Œè¿æ¥ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/85b7c426fb2a579ca1417885f28030fe.png#pic_center)

è¿æ¥å¥½ä¹‹åæˆ‘ä»¬åœ¨è®¾å¤‡1å’Œè®¾å¤‡2ä¸Šå‡è¾“å…¥

```c
microcom /dev/ttyS3 -s 115200

```

æµ‹è¯•ç»“æœ

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/c9b722d080ba86df0014d129e1ed80e4.png#pic_center)
  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/a3514cbf72f25441b8e0fc1a0b6246e0.png#pic_center)

ç”±äºmicrocomæ²¡æœ‰å›æ˜¾ï¼Œæ‰€ä»¥çœ‹ä¸åˆ°è‡ªå·±å‘é€çš„æ˜¯ä»€ä¹ˆï¼Œä½†æ˜¯æ¥å—çš„ç»“æœæ˜¯æ²¡é”™çš„

#### RS485æµ‹è¯•

è®¾å¤‡æ ‘å¦‚ä¸‹

```c
&uart9 {
        pinctrl-names = "default";
        pinctrl-0 = <&uart9m1_xfer &rs485_ctrl>;
        status = "okay";
};

//åœ¨rk3568-pinctrl.dtsiä¸‹åŠ å…¥
rs485 {
        rs485_ctrl: rs485-ctrl {
        rockchip,pins =
                <4 RK_PD2 RK_FUNC_GPIO &pcfg_output_low>;
        };
};


```

å› ä¸ºRS485æ˜¯åŠåŒå·¥çš„ï¼Œæ‰€ä»¥è¦ä¹ˆå…ˆæµ‹æ¥æ”¶åŠŸèƒ½è¦ä¹ˆæµ‹å‘é€åŠŸèƒ½ï¼Œä»åŸç†å›¾ä¸Šå¯ä»¥çœ‹åˆ°ï¼Œæ¥å—ä¸å‘é€åŠŸèƒ½çš„åˆ‡æ¢æ˜¯GPIO4\_D2æ¥æ§åˆ¶çš„ï¼Œé»˜è®¤æƒ…å†µæ˜¯æ¥æ”¶åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨gpiosetå‘½ä»¤æ‹‰é«˜è¯¥gpioè®©å…¶å·¥ä½œåœ¨å‘é€æ¨¡å¼

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/024d252a3f8b394be2e6e7fa01099d66.png#pic_center)

##### æµ‹è¯•æ¥å—åŠŸèƒ½

å¦‚å›¾æ‰€ç¤ºï¼Œåˆ©ç”¨TTLè½¬RS485æ¨¡å—æ¥ä½œä¸ºå¦å¤–ä¸€å°RS485è®¾å¤‡ï¼Œè¿çº¿å¦‚ä¸‹å›¾æ‰€ç¤º

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/7bd276c9a89ad552bf9e42f8e0e9628e.png#pic_center)
  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/05686c5e9e40dae8139a70e348425288.png#pic_center)

##### æµ‹è¯•å‘é€åŠŸèƒ½

å°†æ§åˆ¶å¼•è„šæ‹‰é«˜ç”µå¹³,è¾“å…¥å¦‚ä¸‹å‘½ä»¤

```c
gpioset 4 28=1

```

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/f7d929c4637b8776b2d8fbe92b055533.png#pic_center)

#### CANæµ‹è¯•

è®¾å¤‡æ ‘å¦‚ä¸‹

```c
&can0 {
        compatible = "rockchip,can-1.0";
        assigned-clocks = <&cru CLK_CAN0>;
        assigned-clock-rates = <150000000>;
        pinctrl-names = "default";
        pinctrl-0 = <&can0m1_pins>;
        status = "okay";
};

&can1 {
        compatible = "rockchip,can-1.0";
        assigned-clocks = <&cru CLK_CAN1>;
        assigned-clock-rates = <150000000>;
        pinctrl-names = "default";
        pinctrl-0 = <&can1m1_pins>;
        status = "okay";
};

```

æˆ‘ä»¬å¯ä»¥ç”¨ifconfig -aæ¥æŸ¥çœ‹cançš„æ•°é‡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/aa7aa2995bdcb973c5997a142c514ab6.png#pic_center)

è¿™é‡Œæˆ‘ä»¬æµ‹è¯•can1çš„æ”¶å‘åŠŸèƒ½ï¼Œcan0ä¸ä¹‹å®Œå…¨ç›¸åŒ

é¦–å…ˆæˆ‘ä»¬å°†ä¸¤ä¸ªcanè®¾å¤‡åˆ©ç”¨æœé‚¦çº¿è¿›è¡Œè¿æ¥ï¼Œè¿æ¥å¦‚ä¸‹å›¾æ‰€ç¤º

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/58b986d65baba32f5a2e4e0e6cdca412.png#pic_center)

è¿æ¥å¥½ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦å¯¹can1è¿›è¡Œé…ç½®ï¼Œåˆ©ç”¨ipå‘½ä»¤

```c
ip link set can1 down //å…³é—­ can ç½‘ç»œ
ip link set can1 up type can bitrate 800000 //è®¾ç½® can1 çš„æ³¢ç‰¹ç‡ä¸º 800kbpsï¼Œcan ç½‘ç»œæ³¢ç‰¹ç‡æœ€å¤§å€¼ä¸º 1mbps
ip link set can1 up type can //æ‰“å¼€ can ç½‘ç»œ

```

è®¾ç½®å¥½ä¹‹åï¼Œæˆ‘ä»¬ä¸Šå›¾æ‰€ç¤ºä¸­çš„è®¾å¤‡1ä½œä¸ºæ¥å—æ–¹ï¼Œè®¾å¤‡2ä½œä¸ºå‘é€æ–¹

åœ¨è®¾å¤‡1ä¸Šè¾“å…¥

```c
candump can1

```

åœ¨è®¾å¤‡2ä¸Šè¾“å…¥

```c
cansend can1 123#01020304050607

```

ç»“æœå¦‚å›¾æ‰€ç¤º

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/25288bb0d57dc2f8a16aa21e952fca80.png#pic_center)

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/5b6f2a1a8c07aa1cb2ebaccd1a74ea5f.png#pic_center)

#### ç»§ç”µå™¨æµ‹è¯•

å¼€å‘æ¿ä¸Šæœ‰ä¸¤è·¯ç»§ç”µå™¨

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/403791c15096ef4f12a94facf4391a9b.png#pic_center)

åˆ©ç”¨gpiosetæ¥æ§åˆ¶ç»§ç”µå™¨çš„å¼€ä¸å…³ï¼Œå½“æˆ‘ä»¬è®¾ç½®è¿™ä¸¤ä¸ªgpioçš„ç”µå¹³æ—¶ä¼šå¬åˆ°ç»§ç”µå™¨å‘å‡ºâ€œå’”åš“â€çš„å£°éŸ³ï¼Œæ­¤æ—¶è¯æ˜ç»§ç”µå™¨æ˜¯æ­£å¸¸çš„ã€‚

ä¾‹å¦‚è¾“å…¥

```c
gpioset 3 28=0
gpioset 3 28=1

```

#### ä¸‰è·¯LEDå’ŒBuzzerå¼•è„šæµ‹è¯•

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/e0bfa9780284ea1d1f94149c12ca77f8.png#pic_center)

è¿™é‡Œçš„æµ‹è¯•åªè¦å°±æ˜¯å¯¹è¿™äº›gpioè¿›è¡Œé…ç½®å³å¯ï¼Œåˆ©ç”¨gpiosetæ¥æ§åˆ¶é«˜ä½ç”µå¹³

**æ³¨æ„ï¼šè¿™å››ä¸ªgpioåœ¨è®¾å¤‡æ ‘ä¸­å¯èƒ½ä¼šè¢«å…¶ä»–è®¾å¤‡æ‰€å ç”¨ï¼Œå¯¼è‡´ä¸èƒ½æ“ä½œgpioï¼Œæ‰€ä»¥è¦æŸ¥çœ‹å“ªäº›è®¾å¤‡å ç”¨ç€è¿™å‡ ä¸ªgpioéœ€è¦å±è”½æ‰è¿™äº›è®¾å¤‡ã€‚**

##### æµ‹è¯•æ–¹æ³•

ç”±äºè¿™å››ä¸ªå¼•è„šéƒ½æ˜¯ç”¨MOSç®¡æ§åˆ¶çš„å¼€æ¼è¾“å‡ºï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å»æµ‹è¯•MOSç®¡çš„æ …æçœ‹çœ‹æ˜¯å¦æ˜¯3.3Vç”µå¹³

**è§„åˆ™ï¼š**

**GPIOè¾“å‡º1çš„æ—¶å€™ï¼Œå¯¹åº”çš„æ …ææ˜¯0V**
  
**GPIOè¾“å‡º0çš„æ—¶å€™ï¼Œå¯¹åº”çš„æ …ææ˜¯3.3V**

åˆ©ç”¨ä¸‡ç”¨è¡¨ï¼Œå°†ä¸‡ç”¨è¡¨è°ƒåˆ°ç›´æµç”µå‹20Vè¿™ä¸€æ¡£ï¼Œè¿™å››ä¸ªæ¨¡å—å¯¹åº”çš„ä¸‰æç®¡å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåˆ©ç”¨gpiosetæ¥æ§åˆ¶å››ä¸ªgpioçš„é«˜ä½ç”µå¹³ï¼Œçœ‹çœ‹æ˜¯å¦ç¬¦åˆä¸Šè¿°è§„åˆ™ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/eb340039617ee75fba1de4443b0cde06.png#pic_center)