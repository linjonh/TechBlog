---
layout: post
title: "笔记记一次easyExcel中注解ExcelProperty映射字段赋值无效问题"
date: 2025-03-06 11:16:00 +0800
description: "在使用@ExcelProperty注解标记字段的时候，该字段最好命名标准和规范，比如以上pType命名如果标准化为projectType可以避免此类BUG出现。"
keywords: "【笔记】记一次easyExcel中注解ExcelProperty映射字段赋值无效问题"
categories: ['未分类']
tags: ['笔记', '开发语言', 'Java']
artid: "146062859"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146062859
    alt: "笔记记一次easyExcel中注解ExcelProperty映射字段赋值无效问题"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146062859
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146062859
cover: https://bing.ee123.net/img/rand?artid=146062859
image: https://bing.ee123.net/img/rand?artid=146062859
img: https://bing.ee123.net/img/rand?artid=146062859
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     【笔记】记一次easyExcel中注解ExcelProperty映射字段赋值无效问题
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h4>
     <a id="_0">
     </a>
     背景
    </h4>
    <p>
     最近在开发一个导入excel文件解析数据并入库的功能，导入过程中出现一个BUG：后端映射实体字段pType没有被赋值，但是导入的excel源文件是有数据。
    </p>
    <h4>
     <a id="_2">
     </a>
     定位问题
    </h4>
    <p>
     经过debug源码发现最终创建对象并赋值使用的是net.sf.cglib.beans.BeanMap类中的create方法，BeanMap中创建实体对象并赋值使用类中字段的setter方法，其中pType字段使用的Setter方法为setpType，但是lombok.Data注解的类的字段pType的setter方法为setPType，所以导致最终没有被赋值。
    </p>
    <h4>
     <a id="_4">
     </a>
     解决方案
    </h4>
    <p>
     方式1：将pType字段改成projectType字段名，使用lombok.Data注解。
    </p>
    <pre><code>  @ExcelProperty(value = "项目类型*")
    private String projectType;
</code></pre>
    <p>
     方式2：手动添加pType的Setter和Getter方法。
    </p>
    <pre><code>public String getpType() {
        return pType;
    }

    public void setpType(String pType) {
        this.pType = pType;
    }
</code></pre>
    <h4>
     <a id="_20">
     </a>
     最后
    </h4>
    <p>
     在使用@ExcelProperty注解标记字段的时候，该字段最好命名标准和规范，比如以上pType命名如果标准化为projectType可以避免此类BUG出现。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f753031343230393535332f:61727469636c652f64657461696c732f313436303632383539" class_="artid" style="display:none">
 </p>
</div>


