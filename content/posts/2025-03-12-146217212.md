---
layout: post
title: "Vite项目中vite.config.js中为什么只能使用process.env,无法使用import.meta.env"
date: 2025-03-12 22:52:35 +0800
description: "vite.config.js 只能使用 process.env 访问环境变量，因为它运行在 Node.js 环境中，而 import.meta.env 是专为客户端代码设计的特性，不适用于配置文件。通过合理使用 process.env 配置构建过程，并通过 import.meta.env 在客户端访问环境变量，可以最大化利用 Vite 的现代化特性，同时确保安全性和可维护性"
keywords: "Vite项目中vite.config.js中为什么只能使用process.env，无法使用import.meta.env？"
categories: ['Vue', 'Javascript']
tags: ['开发语言', '前端', 'Javascript']
artid: "146217212"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146217212
    alt: "Vite项目中vite.config.js中为什么只能使用process.env,无法使用import.meta.env"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146217212
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146217212
cover: https://bing.ee123.net/img/rand?artid=146217212
image: https://bing.ee123.net/img/rand?artid=146217212
img: https://bing.ee123.net/img/rand?artid=146217212
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Vite项目中vite.config.js中为什么只能使用process.env，无法使用import.meta.env？
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-tomorrow-night" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h4>
     <a id="_0">
     </a>
     关键要点
    </h4>
    <ul>
     <li>
      研究表明，Vite 配置文件（
      <code>
       vite.config.js
      </code>
      ）运行在 Node.js 环境中，因此只能使用
      <code>
       process.env
      </code>
      访问环境变量，而
      <code>
       import.meta.env
      </code>
      专为客户端代码设计，在配置文件中不可用。
     </li>
     <li>
      于建议在
      <code>
       vite.config.js
      </code>
      中使用
      <code>
       process.env
      </code>
      来配置构建过程，在客户端代码中使用
      <code>
       import.meta.env
      </code>
      访问以
      <code>
       VITE_
      </code>
      开头的环境变量。
     </li>
     <li>
      存在争议：一些开发者可能尝试在配置文件中使用
      <code>
       import.meta.env
      </code>
      ，但这会导致错误，因为它不适用于 Node.js 环境。
     </li>
    </ul>
    <hr/>
    <h4>
     <a id="_viteconfigjs__processenv_7">
     </a>
     为什么
     <code>
      vite.config.js
     </code>
     只能使用
     <code>
      process.env
     </code>
     ？
    </h4>
    <p>
     <strong>
      什么是
      <code>
       process.env
      </code>
      和
      <code>
       import.meta.env
      </code>
      ？
     </strong>
     <br/>
     <code>
      process.env
     </code>
     是 Node.js 的全局对象，用于访问环境变量，适用于服务器端脚本，如 Vite 的配置文件。
     <br/>
     <code>
      import.meta.env
     </code>
     是 Vite 为客户端代码提供的特性，允许在浏览器环境中访问以
     <code>
      VITE_
     </code>
     开头的环境变量。
    </p>
    <p>
     <strong>
      为什么不能在
      <code>
       vite.config.js
      </code>
      中使用
      <code>
       import.meta.env
      </code>
      ？
     </strong>
     <br/>
     Vite 的配置文件运行在 Node.js 环境中，而
     <code>
      import.meta.env
     </code>
     专为客户端代码设计，因此在配置文件中不可用。尝试使用
     <code>
      import.meta.env
     </code>
     会导致错误，因为它在 Node.js 环境中未定义。
    </p>
    <p>
     <strong>
      使用场景示例
     </strong>
    </p>
    <ul>
     <li>
      <p>
       <strong>
        在
        <code>
         vite.config.js
        </code>
        中使用
        <code>
         process.env
        </code>
       </strong>
       ：
       <br/>
       假设你想根据环境变量设置构建输出目录：
      </p>
      <pre><code class="prism language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vite'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">build</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">outDir</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">OUT_DIR</span> <span class="token operator">||</span> <span class="token string">'dist'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
      <p>
       这里，
       <code>
        process.env.OUT_DIR
       </code>
       用于动态配置输出目录。
      </p>
     </li>
     <li>
      <p>
       <strong>
        在客户端代码中使用
        <code>
         import.meta.env
        </code>
       </strong>
       ：
       <br/>
       在你的应用代码中，可以这样访问环境变量：
      </p>
      <pre><code class="prism language-javascript">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VITE_API_URL</span><span class="token punctuation">)</span>
</code></pre>
      <p>
       这会输出
       <code>
        VITE_API_URL
       </code>
       的值，但前提是它在
       <code>
        .env
       </code>
       文件中以
       <code>
        VITE_
       </code>
       开头。
      </p>
     </li>
    </ul>
    <p>
     <strong>
      意外的细节
     </strong>
     <br/>
     你可能以为
     <code>
      import.meta.env
     </code>
     在配置文件中也能工作，因为两者都涉及环境变量，但实际上它们的适用范围完全不同：
     <code>
      process.env
     </code>
     适用于服务器端，
     <code>
      import.meta.env
     </code>
     适用于客户端。
    </p>
    <hr/>
    <h4>
     <a id="_viteconfigjs__processenv__importmetaenv__42">
     </a>
     详细解释
     <code>
      vite.config.js
     </code>
     中
     <code>
      process.env
     </code>
     和
     <code>
      import.meta.env
     </code>
     的使用
    </h4>
    <h5>
     <a id="_44">
     </a>
     背景与原理
    </h5>
    <p>
     Vite 是一个现代前端构建工具，旨在提供快速的开发体验和高效的构建过程。其配置文件（通常为
     <code>
      vite.config.js
     </code>
     ）允许开发者自定义构建行为，而环境变量是配置过程中的关键部分。
     <code>
      process.env
     </code>
     是 Node.js 的标准特性，用于访问环境变量，而
     <code>
      import.meta.env
     </code>
     是 Vite 专为客户端代码设计的特性，用于在浏览器环境中访问环境变量。
    </p>
    <p>
     具体来说，
     <code>
      vite.config.js
     </code>
     运行在 Node.js 环境中，因此可以直接使用
     <code>
      process.env
     </code>
     访问任何环境变量。相反，
     <code>
      import.meta.env
     </code>
     是 Vite 在构建过程中注入到客户端代码中的，旨在提供安全的环境变量访问，仅暴露以
     <code>
      VITE_
     </code>
     开头的变量，以防止敏感信息泄露。因此，在
     <code>
      vite.config.js
     </code>
     中尝试使用
     <code>
      import.meta.env
     </code>
     会导致错误，因为它在 Node.js 环境中未定义。
    </p>
    <h5>
     <a id="_49">
     </a>
     功能与机制
    </h5>
    <ul>
     <li>
      <p>
       <strong>
        <code>
         process.env
        </code>
       </strong>
       ：这是 Node.js 的全局对象，包含进程的环境变量。在
       <code>
        vite.config.js
       </code>
       中，Vite 会加载
       <code>
        .env
       </code>
       文件中的变量到
       <code>
        process.env
       </code>
       ，开发者可以直接访问。例如：
      </p>
      <ul>
       <li>
        如果
        <code>
         .env
        </code>
        文件中有
        <code>
         OUT_DIR=build
        </code>
        ，则在
        <code>
         vite.config.js
        </code>
        中可以写
        <code>
         process.env.OUT_DIR
        </code>
        来获取 “build”。
       </li>
       <li>
        这适用于配置构建输出目录、端口号等服务器端设置。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        <code>
         import.meta.env
        </code>
       </strong>
       ：这是 Vite 为客户端代码提供的特性。在构建过程中，Vite 会将
       <code>
        import.meta.env.VARIABLE_NAME
       </code>
       替换为对应的环境变量值，但仅限于以
       <code>
        VITE_
       </code>
       开头的变量。例如：
      </p>
      <ul>
       <li>
        如果
        <code>
         .env
        </code>
        文件中有
        <code>
         VITE_API_URL=http://api.com
        </code>
        ，则在客户端代码中
        <code>
         import.meta.env.VITE_API_URL
        </code>
        会是 “http://api.com”。
       </li>
       <li>
        这适用于需要在浏览器中动态配置 API 端点、调试标志等。
       </li>
      </ul>
     </li>
    </ul>
    <p>
     由于
     <code>
      vite.config.js
     </code>
     是 Node.js 脚本，
     <code>
      import.meta.env
     </code>
     在此环境中不可用。如果尝试在配置文件中写
     <code>
      console.log(import.meta.env)
     </code>
     ，会抛出错误，因为
     <code>
      import.meta.env
     </code>
     未定义。
    </p>
    <h5>
     <a id="_60">
     </a>
     实际使用场景与示例
    </h5>
    <p>
     以下是几个实际使用场景，并结合代码说明：
    </p>
    <ol>
     <li>
      <p>
       <strong>
        配置构建输出目录
       </strong>
       <br/>
       假设你想根据环境变量设置构建输出目录：
      </p>
      <pre><code class="prism language-javascript"><span class="token comment">// vite.config.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vite'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">build</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">outDir</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">OUT_DIR</span> <span class="token operator">||</span> <span class="token string">'dist'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
      <p>
       这里，
       <code>
        process.env.OUT_DIR
       </code>
       用于动态设置输出目录。如果尝试用
       <code>
        import.meta.env.OUT_DIR
       </code>
       ，会报错。
      </p>
     </li>
     <li>
      <p>
       <strong>
        传递环境变量到客户端
       </strong>
       <br/>
       在客户端代码中，你可能需要访问 API 端点：
      </p>
      <pre><code class="prism language-javascript"><span class="token comment">// src/main.js</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VITE_API_URL</span><span class="token punctuation">)</span>
</code></pre>
      <p>
       但在
       <code>
        vite.config.js
       </code>
       中，如果你想基于同样的环境变量做配置，必须用
       <code>
        process.env.VITE_API_URL
       </code>
       ，例如：
      </p>
      <pre><code class="prism language-javascript"><span class="token comment">// vite.config.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vite'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">define</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">'process.env.VITE_API_URL'</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VITE_API_URL</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
      <p>
       这里，
       <code>
        process.env.VITE_API_URL
       </code>
       被用作配置的一部分。
      </p>
     </li>
     <li>
      <p>
       <strong>
        加载
        <code>
         .env
        </code>
        文件中的变量
       </strong>
       <br/>
       Vite 使用
       <code>
        dotenv
       </code>
       自动加载
       <code>
        .env
       </code>
       文件中的变量到
       <code>
        process.env
       </code>
       ，因此在
       <code>
        vite.config.js
       </code>
       中可以直接访问。例如：
      </p>
      <ul>
       <li>
        <code>
         .env
        </code>
        文件中有
        <code>
         PORT=3000
        </code>
        ，则
        <code>
         process.env.PORT
        </code>
        在配置文件中可用。
       </li>
       <li>
        但在客户端代码中，只有
        <code>
         VITE_PORT=3000
        </code>
        才会通过
        <code>
         import.meta.env.VITE_PORT
        </code>
        暴露。
       </li>
      </ul>
     </li>
    </ol>
    <h5>
     <a id="_101">
     </a>
     最佳实践与注意事项
    </h5>
    <p>
     尽管
     <code>
      process.env
     </code>
     在
     <code>
      vite.config.js
     </code>
     中可用，但需要注意以下几点：
    </p>
    <ul>
     <li>
      <strong>
       安全性
      </strong>
      ：确保不将敏感信息（如数据库密码）通过
      <code>
       process.env
      </code>
      暴露到客户端。如果需要传递到客户端，必须通过
      <code>
       define
      </code>
      选项手动设置，并确保值安全。
     </li>
     <li>
      <strong>
       前缀规则
      </strong>
      ：客户端代码只能访问以
      <code>
       VITE_
      </code>
      开头的变量，这是 Vite 的安全机制。
     </li>
     <li>
      <strong>
       动态性
      </strong>
      ：
      <code>
       process.env
      </code>
      的值在运行时固定，而
      <code>
       import.meta.env
      </code>
      的值在构建时由 Vite 处理。
     </li>
    </ul>
    <p>
     以下是
     <code>
      process.env
     </code>
     与
     <code>
      import.meta.env
     </code>
     的对比表：
    </p>
    <table>
     <thead>
      <tr>
       <th>
        特性
       </th>
       <th>
        <code>
         process.env
        </code>
       </th>
       <th>
        <code>
         import.meta.env
        </code>
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        适用环境
       </td>
       <td>
        Node.js（服务器端）
       </td>
       <td>
        浏览器（客户端）
       </td>
      </tr>
      <tr>
       <td>
        访问方式
       </td>
       <td>
        <code>
         process.env.VARIABLE_NAME
        </code>
       </td>
       <td>
        <code>
         import.meta.env.VITE_VARIABLE
        </code>
       </td>
      </tr>
      <tr>
       <td>
        暴露规则
       </td>
       <td>
        所有环境变量
       </td>
       <td>
        仅
        <code>
         VITE_
        </code>
        前缀变量
       </td>
      </tr>
      <tr>
       <td>
        安全性
       </td>
       <td>
        需要手动确保不泄露
       </td>
       <td>
        自动过滤，非
        <code>
         VITE_
        </code>
        不暴露
       </td>
      </tr>
      <tr>
       <td>
        使用场景
       </td>
       <td>
        构建配置、服务器逻辑
       </td>
       <td>
        客户端动态配置
       </td>
      </tr>
     </tbody>
    </table>
    <h5>
     <a id="_117">
     </a>
     争议与复杂性
    </h5>
    <p>
     使用
     <code>
      process.env
     </code>
     和
     <code>
      import.meta.env
     </code>
     存在一些争议，主要围绕它们的适用范围。一些开发者可能误以为
     <code>
      import.meta.env
     </code>
     在配置文件中也能工作，导致错误。研究表明，Vite 社区倾向于明确区分两者的使用场景：
     <code>
      process.env
     </code>
     用于服务器端配置，
     <code>
      import.meta.env
     </code>
     用于客户端代码。这种区分有助于减少混淆，但也增加了学习成本，尤其对新手开发者。
    </p>
    <h5>
     <a id="_120">
     </a>
     结论
    </h5>
    <p>
     综上所述，
     <code>
      vite.config.js
     </code>
     只能使用
     <code>
      process.env
     </code>
     访问环境变量，因为它运行在 Node.js 环境中，而
     <code>
      import.meta.env
     </code>
     是专为客户端代码设计的特性，不适用于配置文件。通过合理使用
     <code>
      process.env
     </code>
     配置构建过程，并通过
     <code>
      import.meta.env
     </code>
     在客户端访问环境变量，可以最大化利用 Vite 的现代化特性，同时确保安全性和可维护性。
    </p>
    <hr/>
    <h4>
     <a id="_125">
     </a>
     关键引文
    </h4>
    <ul>
     <li>
      <a href="https://vite.dev/guide/env-and-mode.html" rel="nofollow">
       Env Variables and Modes Vite 官方文档
      </a>
     </li>
     <li>
      <a href="https://stackoverflow.com/questions/70709987/how-to-load-environment-variables-from-env-file-using-vite" rel="nofollow">
       How to load environment variables from .env file using Vite Stack Overflow
      </a>
     </li>
     <li>
      <a href="https://github.com/vitejs/vite/discussions/11517">
       Why did vite select import.meta.env for providing environment variables? Vite GitHub Discussion
      </a>
     </li>
    </ul>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f6375696a6979696e672f:61727469636c652f64657461696c732f313436323137323132" class_="artid" style="display:none">
 </p>
</div>


