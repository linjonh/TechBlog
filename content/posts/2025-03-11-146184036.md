---
layout: post
title: "Android-Compose-MutableInteractionSource介绍"
date: 2025-03-11 17:09:08 +0800
description: "在 Android 开发中，Compose 是 Google 推出的现代化 UI 工具包，它让开发者能够更简洁高效地构建应用界面。而 `MutableInteractionSource` 是 Compose 中一个重要的组件，它可以帮助你处理用户与界面交互时的状态变化，尤其在处理交互反馈（比如点击、按下、聚焦等）时非常有用。接下来，我们将详细解析 `MutableInteractionSource` 的作用及如何在实际开发中使用它。"
keywords: "Android Compose MutableInteractionSource介绍"
categories: ['夯实基础', 'Android']
tags: ['Android']
artid: "146184036"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146184036
    alt: "Android-Compose-MutableInteractionSource介绍"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146184036
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146184036
cover: https://bing.ee123.net/img/rand?artid=146184036
image: https://bing.ee123.net/img/rand?artid=146184036
img: https://bing.ee123.net/img/rand?artid=146184036
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Android Compose MutableInteractionSource介绍
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-dracula" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/7897f7de988743b98abeb537295ebd7f.png"/>
    </p>
    <p>
     在 Android 开发中，Compose 是 Google 推出的现代化 UI 工具包，它让开发者能够更简洁高效地构建应用界面。而
     <code>
      MutableInteractionSource
     </code>
     是 Compose 中一个重要的组件，它可以帮助你处理用户与界面交互时的状态变化，尤其在处理交互反馈（比如点击、按下、聚焦等）时非常有用。接下来，我们将详细解析
     <code>
      MutableInteractionSource
     </code>
     的作用及如何在实际开发中使用它。
    </p>
    <h3>
     <a id="_MutableInteractionSource_4">
     </a>
     什么是 MutableInteractionSource？
    </h3>
    <p>
     <code>
      MutableInteractionSource
     </code>
     是一个用来管理和跟踪 UI 元素与用户交互的状态的工具。在 Compose 中，用户的每一次点击、按下、聚焦等动作都会触发交互状态的变化，而
     <code>
      MutableInteractionSource
     </code>
     就是用来记录这些交互的工具。
    </p>
    <p>
     <code>
      MutableInteractionSource
     </code>
     是一个可变的交互源，它实现了
     <code>
      InteractionSource
     </code>
     接口。你可以通过它获取当前的交互状态，或者修改交互状态。它通常与 Compose 中的 UI 控件（比如按钮、文本框等）一起使用，用来监听交互事件并更新 UI。
    </p>
    <h3>
     <a id="_MutableInteractionSource_10">
     </a>
     为什么需要 MutableInteractionSource？
    </h3>
    <p>
     在传统的 Android 开发中，我们可能使用
     <code>
      View.OnClickListener
     </code>
     或者
     <code>
      View.OnTouchListener
     </code>
     等监听器来处理用户的交互。而在 Compose 中，
     <code>
      MutableInteractionSource
     </code>
     主要用于处理与交互状态相关的变化，比如元素的按下、点击或聚焦等。
    </p>
    <p>
     举个例子：当我们点击一个按钮时，我们可能想要给用户一个按下的反馈，比如改变按钮的背景色或者显示点击效果。这个交互过程就需要通过
     <code>
      MutableInteractionSource
     </code>
     来进行追踪和管理。
    </p>
    <h3>
     <a id="MutableInteractionSource__16">
     </a>
     MutableInteractionSource 的基本使用
    </h3>
    <p>
     让我们来看一个简单的例子，展示如何在 Compose 中使用
     <code>
      MutableInteractionSource
     </code>
     来实现一个按钮的点击效果。
    </p>
    <pre><code class="prism language-kotlin"><span class="token keyword">import</span> android<span class="token punctuation">.</span>os<span class="token punctuation">.</span>Bundle
<span class="token keyword">import</span> androidx<span class="token punctuation">.</span>activity<span class="token punctuation">.</span>ComponentActivity
<span class="token keyword">import</span> androidx<span class="token punctuation">.</span>activity<span class="token punctuation">.</span>compose<span class="token punctuation">.</span>setContent
<span class="token keyword">import</span> androidx<span class="token punctuation">.</span>compose<span class="token punctuation">.</span>foundation<span class="token punctuation">.</span>interaction<span class="token punctuation">.</span>MutableInteractionSource
<span class="token keyword">import</span> androidx<span class="token punctuation">.</span>compose<span class="token punctuation">.</span>foundation<span class="token punctuation">.</span>interaction<span class="token punctuation">.</span>rememberMutableInteractionSource
<span class="token keyword">import</span> androidx<span class="token punctuation">.</span>compose<span class="token punctuation">.</span>material<span class="token punctuation">.</span>Button
<span class="token keyword">import</span> androidx<span class="token punctuation">.</span>compose<span class="token punctuation">.</span>material<span class="token punctuation">.</span>Text
<span class="token keyword">import</span> androidx<span class="token punctuation">.</span>compose<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span>Composable
<span class="token keyword">import</span> androidx<span class="token punctuation">.</span>compose<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>Modifier
<span class="token keyword">import</span> androidx<span class="token punctuation">.</span>compose<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>graphics<span class="token punctuation">.</span>Color
<span class="token keyword">import</span> androidx<span class="token punctuation">.</span>compose<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>tooling<span class="token punctuation">.</span>preview<span class="token punctuation">.</span>Preview
<span class="token keyword">import</span> androidx<span class="token punctuation">.</span>compose<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>unit<span class="token punctuation">.</span>dp
<span class="token keyword">import</span> androidx<span class="token punctuation">.</span>compose<span class="token punctuation">.</span>foundation<span class="token punctuation">.</span>shape<span class="token punctuation">.</span>RoundedCornerShape
<span class="token keyword">import</span> androidx<span class="token punctuation">.</span>compose<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>draw<span class="token punctuation">.</span>shadow

<span class="token keyword">class</span> MainActivity <span class="token operator">:</span> <span class="token function">ComponentActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token operator">:</span> Bundle<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span>
        setContent <span class="token punctuation">{<!-- --></span>
            <span class="token function">InteractiveButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">InteractiveButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 创建一个 MutableInteractionSource 实例</span>
    <span class="token keyword">val</span> interactionSource <span class="token operator">=</span> remember <span class="token punctuation">{<!-- --></span> <span class="token function">MutableInteractionSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>

    <span class="token comment">// 创建按钮，监听点击交互</span>
    <span class="token function">Button</span><span class="token punctuation">(</span>
        onClick <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">/* 处理点击事件 */</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        interactionSource <span class="token operator">=</span> interactionSource<span class="token punctuation">,</span>
        modifier <span class="token operator">=</span> Modifier
            <span class="token punctuation">.</span><span class="token function">shadow</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">.</span>dp<span class="token punctuation">,</span> shape <span class="token operator">=</span> <span class="token function">RoundedCornerShape</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>Modifier<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">Text</span><span class="token punctuation">(</span>text <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"点击我"</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 在这里，你可以根据 interactionSource 的状态，进行 UI 的响应</span>
    <span class="token comment">// 比如在交互过程中改变按钮的颜色或者样式</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     在上面的例子中，我们首先创建了一个
     <code>
      MutableInteractionSource
     </code>
     实例，通过
     <code>
      rememberMutableInteractionSource()
     </code>
     来记住它的状态。然后我们将这个
     <code>
      interactionSource
     </code>
     传递给
     <code>
      Button
     </code>
     组件，表示这个按钮会在用户与其交互时更新状态。
    </p>
    <h3>
     <a id="MutableInteractionSource__68">
     </a>
     MutableInteractionSource 的状态和事件
    </h3>
    <p>
     <code>
      MutableInteractionSource
     </code>
     会记录多个交互事件的状态，常见的状态包括：
    </p>
    <ul>
     <li>
      <strong>
       PressInteraction
      </strong>
      ：按下状态。
     </li>
     <li>
      <strong>
       ClickInteraction
      </strong>
      ：点击状态。
     </li>
     <li>
      <strong>
       FocusInteraction
      </strong>
      ：聚焦状态。
     </li>
    </ul>
    <p>
     我们可以通过
     <code>
      interactionSource
     </code>
     来获取这些交互的状态，并根据状态的变化来更新 UI。
    </p>
    <p>
     下面是如何监听
     <code>
      PressInteraction
     </code>
     和
     <code>
      ClickInteraction
     </code>
     的状态：
    </p>
    <pre><code class="prism language-kotlin"><span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">InteractiveButtonWithState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">val</span> interactionSource <span class="token operator">=</span> remember <span class="token punctuation">{<!-- --></span> <span class="token function">MutableInteractionSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
    
    <span class="token keyword">val</span> isPressed <span class="token operator">=</span> interactionSource<span class="token punctuation">.</span><span class="token function">collectIsPressedAsState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value

    <span class="token function">Button</span><span class="token punctuation">(</span>
        onClick <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">/* 处理点击事件 */</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        interactionSource <span class="token operator">=</span> interactionSource<span class="token punctuation">,</span>
        modifier <span class="token operator">=</span> Modifier<span class="token punctuation">,</span>
    <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">Text</span><span class="token punctuation">(</span>
            text <span class="token operator">=</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>isPressed<span class="token punctuation">)</span> <span class="token string-literal singleline"><span class="token string">"按钮按下中"</span></span> <span class="token keyword">else</span> <span class="token string-literal singleline"><span class="token string">"点击我"</span></span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     在这个例子中，
     <code>
      collectIsPressedAsState()
     </code>
     可以用于监测按钮的按下状态。如果用户按住按钮，我们会看到按钮显示“按钮按下中”，而当用户松开按钮时，显示“点击我”。
    </p>
    <h3>
     <a id="_100">
     </a>
     总结
    </h3>
    <p>
     <code>
      MutableInteractionSource
     </code>
     是 Compose 中处理用户交互的一种非常有效的方式。它能够帮助我们更灵活地监听和响应用户与界面组件的交互。通过将其与 UI 控件结合使用，我们能够轻松地实现交互反馈效果，比如按钮的按下、点击、聚焦等状态的变化。
    </p>
    <p>
     在日常的 Android 开发中，合理使用
     <code>
      MutableInteractionSource
     </code>
     可以大大提高应用的用户体验，使得 UI 与用户的交互更加平滑和自然。如果你正在使用 Compose 来开发应用，掌握
     <code>
      MutableInteractionSource
     </code>
     是非常重要的，它是实现复杂交互和动画效果的基础。
    </p>
    <h3>
     <a id="_105">
     </a>
     参考文档
    </h3>
    <ul>
     <li>
      <a href="https://developer.android.com/jetpack/compose" rel="nofollow">
       Compose 官方文档
      </a>
     </li>
     <li>
      <a href="https://developer.android.com/reference/androidx/compose/foundation/interaction/MutableInteractionSource" rel="nofollow">
       MutableInteractionSource API
      </a>
     </li>
    </ul>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34323735313031302f:61727469636c652f64657461696c732f313436313834303336" class_="artid" style="display:none">
 </p>
</div>


