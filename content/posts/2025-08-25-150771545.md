---
layout: post
title: "CPTS-Pressed复现XML-RPC"
date: 2025-08-25T21:29:09+0800
description: "PHP Everywhere是一个 WordPress 插件，允许在 WordPress 文章中运行 PHP。得到凭证，尝试登陆（这里是将原密码的2021修改为2022尝试登陆，该主机发布时间为2022年）发现有2FA，但是能够滥用 xmlrpc.php 绕过双重身份验证 (2FA) 并使用凭证登录。该box较难，主要是了解wordpress-XML-RPC 的使用。似乎正在运行此代码，通过从此日志文件中读取它来生成网站上的表格。尝试加入一个system函数，写入一个webshell。"
keywords: "CPTS-Pressed复现（XML-RPC）"
categories: ['靶机']
tags: ['渗透测试', 'Cpts']
artid: "150771545"
arturl: "https://blog.csdn.net/qq_33522010/article/details/150771545"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=150771545
    alt: "CPTS-Pressed复现XML-RPC"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=150771545
featuredImagePreview: https://bing.ee123.net/img/rand?artid=150771545
cover: https://bing.ee123.net/img/rand?artid=150771545
image: https://bing.ee123.net/img/rand?artid=150771545
img: https://bing.ee123.net/img/rand?artid=150771545
---



# CPTS-Pressed复现（XML-RPC）



该box主要是了解wordpress-XML-RPC 的使用  
端口扫描  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/3bbbbcdf8be54fea8299130a98ac6f61.png)

```bash
plist = client.call(posts.GetPosts())

```

会得到一个WordPressPost对象  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/4dace4522d624ae791cce6fe3209aacf.png)  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/880c9bc27e96432fb96030984d50e341.png)  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/2a295616c574426e8993015ca6a23f22.png)  
似乎正在运行此代码，通过从此日志文件中读取它来生成网站上的表格。  
PHP Everywhere是一个 WordPress 插件，允许在 WordPress 文章中运行 PHP。  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/0ebd40e5b287498f9f3ba74e01094664.png)  
尝试加入一个system函数，写入一个webshell  
查看官方文档  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/b6ad04f89d6a4229aeaebdad3d698ae4.png)  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/ae0a88a5d0f64026891577490ac74762.png)  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/f232178ede7f42a3bb95910bab535087.png)  
成功  
提权

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/49dd47d01aa44862bf85f99b98d9679e.png)  
枚举版本  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/b0d2e0994d614fb08153d5b87f45b593.png)  
使用这个exp  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/b25b97329b2c4bb0a3dcd947d5984f90.png)  
修改payload  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/493174f45b4246e58b7b315e3d38e47e.png)  
上传  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/af955923b913487499e90bd06c6b3a76.png)  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/7af0706a4e4549c589600c0915e306bd.png)  
成功读取flag



