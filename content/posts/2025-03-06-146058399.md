---
layout: post
title: "Unity-小功能"
date: 2025-03-06 09:12:31 +0800
description: "dic.y = 0;if (dic!//看向目标。"
keywords: "Unity 小功能"
categories: ['未分类']
tags: ['游戏引擎', 'Unity']
artid: "146058399"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146058399
    alt: "Unity-小功能"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146058399
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146058399
cover: https://bing.ee123.net/img/rand?artid=146058399
image: https://bing.ee123.net/img/rand?artid=146058399
img: https://bing.ee123.net/img/rand?artid=146058399
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Unity 小功能
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h2>
     1.物体a看向物体b方向，而忽略b的高度
    </h2>
    <p>
     private void LookTargetDirection(Transform target)
     <br/>
     {
     <!-- -->
     <br/>
     var dic = (target.position - transform.position).normalized;
     <br/>
     dic.y = 0;
     <br/>
     if (dic != Vector3.zero)
     <br/>
     {
     <!-- -->
     <br/>
     Quaternion targetRotation = Quaternion.LookRotation(dic);
     <br/>
     transform.rotation = Quaternion.Slerp(transform.rotation, targetRotation, Time.deltaTime * 20f); //看向目标
     <br/>
     }
     <br/>
     }
    </p>
    <p>
    </p>
    <h2>
     2.延迟调用方法
    </h2>
    <p>
     public void WaitActionTime(float timer, Action act)
     <br/>
     {
     <!-- -->
     <br/>
     StartCoroutine(DelayAction(timer, act));
     <br/>
     }
    </p>
    <p>
     public IEnumerator DelayAction(float timer, Action callback)
     <br/>
     {
     <!-- -->
     <br/>
     yield return new WaitForSeconds(timer);
    </p>
    <p>
     callback?.Invoke();
    </p>
    <p>
     }
    </p>
    <p>
    </p>
    <h2>
     3.代码指定动画添加事件
    </h2>
    <p>
     public void GetAnim(string aniName)
     <br/>
     {
     <!-- -->
     <br/>
     // 获取动画控制器中的所有动画剪辑
     <br/>
     RuntimeAnimatorController runtimeController = ani.runtimeAnimatorController;
     <br/>
     if (runtimeController == null)
     <br/>
     {
     <!-- -->
     <br/>
     Debug.LogError("Animator Controller 未找到！");
     <br/>
     return;
     <br/>
     }
    </p>
    <p>
     AnimationClip[] animationClips = runtimeController.animationClips;
     <br/>
     if (animationClips == null || animationClips.Length == 0)
     <br/>
     {
     <!-- -->
     <br/>
     Debug.LogError("未找到动画剪辑！");
     <br/>
     return;
     <br/>
     }
    </p>
    <p>
     // 遍历动画剪辑
     <br/>
     foreach (AnimationClip clip in animationClips)
     <br/>
     {
     <!-- -->
     <br/>
     Debug.Log("找到动画剪辑: " + clip.name);
    </p>
    <p>
     // 如果找到目标动画剪辑
     <br/>
     if (clip.name == aniName)
     <br/>
     {
     <!-- -->
     <br/>
     // 添加动画事件
     <br/>
     AddEventToClip(clip);
     <br/>
     Debug.Log("已为动画剪辑 " + clip.name + " 添加动画事件");
     <br/>
     }
     <br/>
     }
     <br/>
     }
    </p>
    <p>
     // 添加动画事件
     <br/>
     void AddEventToClip(AnimationClip clip)
     <br/>
     {
     <!-- -->
     <br/>
     // 创建动画事件
     <br/>
     AnimationEvent animationEvent = new AnimationEvent
     <br/>
     {
     <!-- -->
     <br/>
     time = 0.7f, // 事件触发时间（秒）
     <br/>
     functionName = "OnAnimationEvent", // 回调函数名称
     <br/>
     stringParameter = "Hello from Animation Event!" // 传递的参数
     <br/>
     };
    </p>
    <p>
     // 将事件添加到动画剪辑
     <br/>
     clip.AddEvent(animationEvent);
     <br/>
     }
    </p>
    <p>
     // 动画事件回调函数
     <br/>
     void OnAnimationEvent(string message)
     <br/>
     {
     <!-- -->
     <br/>
     Debug.Log("动画事件触发: " + message);
     <br/>
     StoneMove();
     <br/>
     }
    </p>
    <h2>
     4.距离范围检测
    </h2>
    <p>
     bool IsTargetInRange(float range)
     <br/>
     {
     <!-- -->
     <br/>
     float distance = Vector3.Distance(transform.position, target.position);
     <br/>
     return distance &lt;= range;
     <br/>
     }
    </p>
    <h2>
     5.编辑器选中物体并绘制范围线条
    </h2>
    <p>
     void OnDrawGizmosSelected()
     <br/>
     {
     <!-- -->
     <br/>
     Gizmos.color = Color.red; // 设置 Gizmos 的颜色
     <br/>
     Gizmos.DrawWireSphere(transform.position, range); // 绘制一个半径为 range 米的线框球体
    </p>
    <p>
     }
    </p>
    <h2>
     6.范围内施加爆炸力
    </h2>
    <p>
     void Explode()
     <br/>
     {
     <!-- -->
     <br/>
     // 检测以物体为中心，半径为 explosionRadius 的周围所有碰撞体
     <br/>
     Collider[] colliders = Physics.OverlapSphere(transform.position, explosionRadius);
    </p>
    <p>
     foreach (Collider collider in colliders)
     <br/>
     {
     <!-- -->
     <br/>
     Rigidbody rb = collider.GetComponent&lt;Rigidbody&gt;();  // 获取碰撞体的 Rigidbody 组件
     <br/>
     <br/>
     // 对周围物体施加爆炸力
     <br/>
     rb.constraints = RigidbodyConstraints.None;
     <br/>
     rb.useGravity = true;
     <br/>
     rb.AddExplosionForce(100, transform.position, 10, 1, ForceMode.Impulse);
     <br/>
     <br/>
     <br/>
     }
     <br/>
     }
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f32303532373930352f:61727469636c652f64657461696c732f313436303538333939" class_="artid" style="display:none">
 </p>
</div>


