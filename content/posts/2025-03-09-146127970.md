---
layout: post
title: "使用-Python-将-PDF-转换为文本打造一个简单高效的提取工具"
date: 2025-03-09 09:55:18 +0800
description: "这个简单的工具展示了 Python 在文档处理中的实用性。通过PyPDF2，我们能够快速提取 PDF 中的文字，并以用户友好的方式呈现结果。如果你需要处理大量 PDF 文件，可以考虑扩展脚本，例如支持批量处理目录中的文件，或者集成 OCR 功能以处理扫描件。"
keywords: "使用 Python 将 PDF 转换为文本：打造一个简单高效的提取工具"
categories: ['Python']
tags: ['开发语言', 'Python', 'Pdf']
artid: "146127970"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146127970
    alt: "使用-Python-将-PDF-转换为文本打造一个简单高效的提取工具"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146127970
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146127970
cover: https://bing.ee123.net/img/rand?artid=146127970
image: https://bing.ee123.net/img/rand?artid=146127970
img: https://bing.ee123.net/img/rand?artid=146127970
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     使用 Python 将 PDF 转换为文本：打造一个简单高效的提取工具
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     在数字化时代，PDF 文件是我们日常生活中常见的文档格式。无论是学术论文、工作报告还是电子书，PDF 的广泛使用让提取其中文字内容成为一个常见需求。手动复制粘贴显然效率低下，而借助 Python，我们可以轻松实现自动化提取。本文将介绍一个基于 Python 和
     <code>
      PyPDF2
     </code>
     的工具，用于将 PDF 文件中的文字提取并保存为文本文件。让我们一起来探索它的实现过程吧！
    </p>
    <h3>
     <a id="_2">
     </a>
     背景与需求
    </h3>
    <p>
     PDF 文件通常包含丰富的文本信息，但其格式特性使得直接访问内容并不总是直观。许多场景下，我们需要将 PDF 转为纯文本，例如：
    </p>
    <ul>
     <li>
      将电子书内容导入笔记软件。
     </li>
     <li>
      提取报告数据进行分析。
     </li>
     <li>
      为后续自然语言处理任务准备数据。
     </li>
    </ul>
    <p>
     Python 的
     <code>
      PyPDF2
     </code>
     库为我们提供了读取 PDF 文件并提取文字的便捷方法。通过编写一个简单的脚本，我们可以实现从 PDF 到 TXT 的转换，并支持交互式操作。这个工具的目标是：
    </p>
    <ol>
     <li>
      输入单个 PDF 文件路径。
     </li>
     <li>
      提取所有页面的文字内容。
     </li>
     <li>
      将结果保存为同名的 TXT 文件。
     </li>
     <li>
      提供错误提示和用户友好的交互界面。
     </li>
    </ol>
    <h3>
     <a id="_15">
     </a>
     功能概览
    </h3>
    <p>
     脚本包含以下核心功能：
    </p>
    <ul>
     <li>
      <strong>
       文本提取
      </strong>
      ：逐页读取 PDF 并提取文字。
     </li>
     <li>
      <strong>
       文件处理
      </strong>
      ：将提取的文本保存为 TXT 文件。
     </li>
     <li>
      <strong>
       错误管理
      </strong>
      ：处理文件不存在、格式错误等问题。
     </li>
     <li>
      <strong>
       交互式界面
      </strong>
      ：支持用户输入路径并选择是否继续。
     </li>
    </ul>
    <p>
     接下来，我们将深入探讨代码的实现细节。
    </p>
    <h3>
     <a id="_25">
     </a>
     技术实现
    </h3>
    <h4>
     <a id="_27">
     </a>
     依赖库
    </h4>
    <p>
     脚本依赖以下两个库：
    </p>
    <ul>
     <li>
      <code>
       os
      </code>
      ：用于文件路径操作。
     </li>
     <li>
      <code>
       PyPDF2
      </code>
      ：用于读取 PDF 文件并提取文本。
     </li>
    </ul>
    <p>
     安装
     <code>
      PyPDF2
     </code>
     的命令如下：
    </p>
    <pre><code class="prism language-bash">pip <span class="token function">install</span> PyPDF2
</code></pre>
    <h4>
     <a id="_37">
     </a>
     核心函数解析
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        <code>
         pdf_to_txt(pdf_path)
        </code>
       </strong>
      </p>
      <ul>
       <li>
        <strong>
         功能
        </strong>
        ：将指定 PDF 文件的文字提取并保存为 TXT 文件。
       </li>
       <li>
        <strong>
         逻辑
        </strong>
        ：
        <ul>
         <li>
          检查文件是否存在及是否为 PDF 格式。
         </li>
         <li>
          使用
          <code>
           PdfReader
          </code>
          打开 PDF 文件。
         </li>
         <li>
          逐页提取文本并拼接。
         </li>
         <li>
          将结果写入同名 TXT 文件（UTF-8 编码）。
         </li>
        </ul>
       </li>
       <li>
        <strong>
         错误处理
        </strong>
        ：
        <ul>
         <li>
          <code>
           FileNotFoundError
          </code>
          ：文件不存在。
         </li>
         <li>
          <code>
           ValueError
          </code>
          ：文件不是 PDF 格式。
         </li>
         <li>
          通用异常：其他潜在错误。
         </li>
        </ul>
       </li>
       <li>
        <strong>
         返回值
        </strong>
        ：布尔值，表示操作是否成功。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        <code>
         main()
        </code>
       </strong>
      </p>
      <ul>
       <li>
        <strong>
         功能
        </strong>
        ：提供交互式入口。
       </li>
       <li>
        <strong>
         流程
        </strong>
        ：
        <ul>
         <li>
          提示用户输入 PDF 文件路径。
         </li>
         <li>
          调用
          <code>
           pdf_to_txt
          </code>
          执行转换。
         </li>
         <li>
          根据结果询问是否继续处理其他文件。
         </li>
         <li>
          支持输入 ‘q’ 退出程序。
         </li>
        </ul>
       </li>
      </ul>
     </li>
    </ol>
    <h4>
     <a id="_60">
     </a>
     代码亮点
    </h4>
    <ul>
     <li>
      <strong>
       异常处理
      </strong>
      ：通过多层次
      <code>
       try-except
      </code>
      ，确保程序在遇到问题时不会崩溃，并给出清晰提示。
     </li>
     <li>
      <strong>
       简洁性
      </strong>
      ：核心逻辑集中在
      <code>
       pdf_to_txt
      </code>
      函数中，易于维护和扩展。
     </li>
     <li>
      <strong>
       用户体验
      </strong>
      ：交互式设计让操作直观，支持非技术用户。
     </li>
    </ul>
    <h3>
     <a id="_65">
     </a>
     使用场景
    </h3>
    <p>
     假设你有一份学术论文的 PDF 文件，想提取其中的文字进行引用或分析。你可以：
    </p>
    <ol>
     <li>
      运行脚本，输入文件路径（例如
      <code>
       C:/Docs/paper.pdf
      </code>
      ）。
     </li>
     <li>
      脚本自动生成
      <code>
       paper.txt
      </code>
      ，包含所有页面文字。
     </li>
     <li>
      打开 TXT 文件，轻松复制或编辑内容。
     </li>
    </ol>
    <p>
     输出文件示例：
    </p>
    <pre><code>第一页内容...
第二页内容...
</code></pre>
    <h3>
     <a id="_78">
     </a>
     如何运行
    </h3>
    <ol>
     <li>
      确保安装了 Python 和
      <code>
       PyPDF2
      </code>
      。
     </li>
     <li>
      将脚本保存为
      <code>
       pdf_to_txt.py
      </code>
      。
     </li>
     <li>
      在终端运行：
      <pre><code class="prism language-bash">python pdf_to_txt.py
</code></pre>
     </li>
     <li>
      按照提示输入 PDF 文件路径即可。
     </li>
    </ol>
    <h3>
     <a id="_88">
     </a>
     注意事项
    </h3>
    <ul>
     <li>
      <strong>
       文字提取限制
      </strong>
      ：
      <code>
       PyPDF2
      </code>
      的
      <code>
       extract_text()
      </code>
      方法依赖 PDF 的文本编码。如果 PDF 是扫描件或图像格式，提取可能失败（需配合 OCR 工具如 Tesseract）。
     </li>
     <li>
      <strong>
       编码支持
      </strong>
      ：使用 UTF-8 确保多语言兼容性。
     </li>
     <li>
      <strong>
       文件覆盖
      </strong>
      ：如果目标 TXT 文件已存在，会被覆盖。
     </li>
    </ul>
    <h3>
     <a id="_93">
     </a>
     完整代码
    </h3>
    <p>
     以下是完整的 Python 脚本：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> PyPDF2
<span class="token keyword">import</span> os

<span class="token keyword">def</span> <span class="token function">pdf_to_txt</span><span class="token punctuation">(</span>pdf_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token comment"># 检查文件是否存在</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>pdf_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> FileNotFoundError<span class="token punctuation">(</span><span class="token string">"指定的PDF文件未找到"</span><span class="token punctuation">)</span>
            
        <span class="token comment"># 检查文件是否为PDF</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> pdf_path<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">'.pdf'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"文件必须是PDF格式"</span><span class="token punctuation">)</span>
            
        <span class="token comment"># 获取文件名（不含扩展名）</span>
        file_name <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>splitext<span class="token punctuation">(</span>pdf_path<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        <span class="token comment"># 创建输出txt文件路径</span>
        txt_path <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>file_name<span class="token punctuation">}</span></span><span class="token string">.txt"</span></span>
        
        <span class="token comment"># 打开PDF文件</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>pdf_path<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> pdf_file<span class="token punctuation">:</span>
            <span class="token comment"># 创建PDF阅读器对象</span>
            pdf_reader <span class="token operator">=</span> PyPDF2<span class="token punctuation">.</span>PdfReader<span class="token punctuation">(</span>pdf_file<span class="token punctuation">)</span>
            <span class="token comment"># 获取PDF页数</span>
            num_pages <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pdf_reader<span class="token punctuation">.</span>pages<span class="token punctuation">)</span>
            
            <span class="token comment"># 初始化存储提取文本的字符串</span>
            text <span class="token operator">=</span> <span class="token string">""</span>
            
            <span class="token comment"># 逐页提取文字</span>
            <span class="token keyword">for</span> page_num <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_pages<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token comment"># 获取页面对象</span>
                page <span class="token operator">=</span> pdf_reader<span class="token punctuation">.</span>pages<span class="token punctuation">[</span>page_num<span class="token punctuation">]</span>
                <span class="token comment"># 提取文字并添加到text中</span>
                text <span class="token operator">+=</span> page<span class="token punctuation">.</span>extract_text<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span>  <span class="token comment"># 每页后加换行符</span>
                
            <span class="token comment"># 将提取的文字写入txt文件</span>
            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>txt_path<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> txt_file<span class="token punctuation">:</span>
                txt_file<span class="token punctuation">.</span>write<span class="token punctuation">(</span>text<span class="token punctuation">)</span>
                
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"\n成功提取 </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>num_pages<span class="token punctuation">}</span></span><span class="token string"> 页内容！"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"文字已保存到: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>txt_path<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>
        
    <span class="token keyword">except</span> FileNotFoundError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"\n错误: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>
    <span class="token keyword">except</span> ValueError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"\n错误: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"\n发生错误: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"欢迎使用 PDF 文字提取工具！"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"请输入完整的 PDF 文件路径（或输入 'q' 退出）"</span><span class="token punctuation">)</span>
    
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token comment"># 获取用户输入</span>
        pdf_path <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"\nPDF 文件路径: "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 检查是否退出</span>
        <span class="token keyword">if</span> pdf_path<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'q'</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"程序已退出"</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
            
        <span class="token comment"># 执行转换</span>
        success <span class="token operator">=</span> pdf_to_txt<span class="token punctuation">(</span>pdf_path<span class="token punctuation">)</span>
        
        <span class="token comment"># 如果成功，问是否继续</span>
        <span class="token keyword">if</span> success<span class="token punctuation">:</span>
            <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
                choice <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"\n是否继续处理其他文件？(y/n): "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> choice <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">'y'</span><span class="token punctuation">,</span> <span class="token string">'n'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                    <span class="token keyword">break</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"请输入 'y' 或 'n'"</span><span class="token punctuation">)</span>
            
            <span class="token keyword">if</span> choice <span class="token operator">==</span> <span class="token string">'n'</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"程序已退出"</span><span class="token punctuation">)</span>
                <span class="token keyword">break</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"请检查文件路径后重试"</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <hr/>
    <h3>
     <a id="_187">
     </a>
     总结
    </h3>
    <p>
     这个简单的工具展示了 Python 在文档处理中的实用性。通过
     <code>
      PyPDF2
     </code>
     ，我们能够快速提取 PDF 中的文字，并以用户友好的方式呈现结果。如果你需要处理大量 PDF 文件，可以考虑扩展脚本，例如支持批量处理目录中的文件，或者集成 OCR 功能以处理扫描件。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f36343433323130362f:61727469636c652f64657461696c732f313436313237393730" class_="artid" style="display:none">
 </p>
</div>


