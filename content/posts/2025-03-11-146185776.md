---
arturl_encode: "68747470733a2f2f:626c6f672e6373646e2e6e65742f636865727279353233302f:61727469636c652f64657461696c732f313436313835373736"
layout: post
title: "第4章项目实战-亿级电商系统需求分析"
date: 2025-03-11 18:09:11 +08:00
description: "平台类型: B2B 电商平台年交易额: 超200亿元客户定位: 行业龙头企业项目规模历时: 1年以上总投入: 450+人月费用等级: 千万级课程定位：需求分析基础与架构设计前提课程结构：分上下两部分，本节为上半部分学习目标：明确客户正向下单业务流程的系统边界前置知识：需求分析方法与业务流程分析系统边界：本系统与外部系统的交互关系当前聚焦场景：客户正向下单业务流程（订单创建环节）系统边界明确是架构设计基础需重点关注多系统协同场景后续将结合业务深入细化边界目标。"
keywords: "【第4章】项目实战-亿级电商系统需求分析"
categories: ['架构']
tags: ['需求分析', '架构', '数据库', '大数据']
artid: "146185776"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146185776
    alt: "第4章项目实战-亿级电商系统需求分析"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146185776
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146185776
cover: https://bing.ee123.net/img/rand?artid=146185776
image: https://bing.ee123.net/img/rand?artid=146185776
img: https://bing.ee123.net/img/rand?artid=146185776
---

# 【第4章】项目实战-亿级电商系统需求分析

##### 1-14 项目背景介绍

###### 项目基本背景

* **平台类型**
  : B2B 电商平台
* **年交易额**
  : 超200亿元
* **客户定位**
  : 行业龙头企业
* **项目规模**
  :
  + 历时: 1年以上
  + 总投入: 450+人月
  + 费用等级: 千万级

###### 业务背景解析

###### 1. 平台业务模式演进

初始阶段

* **自营模式**
  :
  + 自有品牌商品
  + 完整生产链: 设计→生产→制造→销售
  + 主要客户: 企业采购
  + 业务特点: 自产自销

发展阶段

* **平台扩展**
  :
  + 引入供应商体系
  + 商品结构:
    - 自有商品
    - 供应商商品
  + 客户服务升级:
    - 提供综合商品包
    - 一站式采购解决方案

###### 2. 供应链结构

供货







供货







自营商品







采购







采购









供应商








B2B平台方








企业客户

###### 3. 业务扩展补充

* B2C业务:
  + 业务占比: 较小规模
  + 服务对象: 个人消费者
  + 运营模式:
    - 类似常规电商平台
    - 支持混合商品销售
    - 个人直接购买渠道

###### 客户分层体系

* 大客户标准:
  + 年采购额5000万+
* 服务特点:
  + 企业集采优先
  + 供应链整合服务
  + 定制化采购方案

###### 项目核心价值

1. 行业资源整合能力
2. 供应链效率优化
3. 采购场景全覆盖
4. 规模经济效应

##### 1-15 初始业务场景-上

###### 课程介绍

* 课程定位：需求分析基础与架构设计前提
* 课程结构：分上下两部分，本节为上半部分

---

###### 课程核心共识

###### 1. 业务理解与需求分析的重要性

* **根本认知**
  ：
  + 软件本质是解决业务问题的工具
  + 架构师必须深入理解业务才能设计有效架构
* **面试标准**
  ：
  + 架构师面试先考察业务能力（业务背景/架构/模块关系）
  + 业务不过关直接淘汰（水货/PPT架构师识别标准）
* **阶段关联**
  ：
  + 需求分析是架构设计基本功
  + 需求分析阶段是架构师理解业务的关键窗口

###### 2. 架构设计本质认知

* **从零到一过程**
  ：
  + 输入：原始需求资料（软件角度为"零状态"）
  + 输出：可落地的软件蓝图
* **方法论破除神秘感**
  ：
  + C系架构设计法提供标准化路径
  + 课程将逐步演示设计过程（非单纯展示结果）

###### 3. 学习重点说明

* **过程>结果**
  ：
  + 重点学习架构演化过程（GitHub可看结果但难学方法）
  + 课程特色：手把手演示设计过程（包含不完美中间态）
* **迭代学习模式**
  ：
  + 业务场景需反复推敲（初始→深化→验证）
  + 知识吸收需多次循环（预计4-5次反刍理解）

---

###### 初始业务场景解析

###### 场景选择背景

* **项目规模**
  ：数百人月工作量（抽取典型场景教学）
* **选择场景**
  ：企业客户正向下单流程（订单需求说明书摘录）

###### 业务角色说明

| 角色 | 系统归属 | 功能定位 |
| --- | --- | --- |
| 客户采购人员 | 商城前台(B2B) | 商品选购与订单提交 |
| 客户管理人员 | 客户中心(平台侧) | 内部管理与参数配置 |
| 中台系统 | 平台侧 | 核心业务逻辑处理 |

###### 核心业务流程

签约商品







非签约商品



































已配置







未配置




























是







否







允许超卖







禁止超卖









开始








库存显示设置








客户采购登录








商品类型判断








协议价展示








市场价展示








库存显示策略








加入购物车








会计科目配置?








科目选择








直接提交








库存校验








库存充足?








地址选择








超卖判断








客户确认








订单终止

###### 关键业务规则

1. **库存显示策略**
   ：
   * 显示模式：有货/无货、真实库存、虚拟库存
   * 配置路径：客户中心→库存管理→显示设置
   * 影响范围：商品详情页展示逻辑
2. **商品准入规则**
   ：
   * 签约商品：协议价采购（支持阶梯价/固定价）
   * 非签约商品：市场价采购（需客户开通权限）
   * 权限控制：客户级采购白名单管理
3. **财务合规要求**
   ：
   * 会计科目绑定：采购品类→财务科目映射
   * 强制校验规则：已配置科目必须选择才能提交
   * 审计要求：科目选择记录留存≥5年
4. **超卖处理机制**
   ：
   * 配置层级：商品SPU维度设置
   * 业务场景：支持预采购（分批交付）
   * 风险控制：超卖确认二次弹窗提醒

###### 下节课预告

1. 地址选择规则（固定地址库管理）
2. 企业级采购预算控制
3. 多批次发货配置
4. 异常流程处理（地址篡改预防）

##### 1-16 初识业务场景-下

###### 一、业务流程节点梳理

###### 1. 订单提交页 - 地址选择后流程

* **核心判断项**
  ：成本中心选择
  + 成本中心定义：平台方的分公司
  + 选择逻辑：
    - 客户签约分公司自动成为成本中心
    - 未签约时通过收货地址自动归属
  + 未选择处理：
    - 系统根据收货地址自动匹配
    - 地址归属规则由平台预先配置

###### 2. 审核流程判断机制

* **审核触发条件**
  ：

  + 客户自主设置的审核要求
  + 系统参数配置项：
    - 金额阶梯审核（示例）：

      | 金额区间 | 审批人 |
      | --- | --- |
      | >1万 | 张三 |
      | >10万 | 李四 |
      | >100万 | 王五 |
    - 会计科目维度审核
    - 混合审核模式（科目→金额）
* **审核流程路径**
  ：

  是







  否





















  是







  否









  订单提交








  需审核?








  启动审批流程








  直接支付








  按设置规则审批








  通过?








  流程终止

###### 3. 支付处理模块

* **支付类型判断**
  ：
  + 月结客户处理：
    - 信用额度校验机制
    - 自动拆分支付：
      * 信用支付部分
      * 现金支付部分（超额时）
  + 现结客户处理：
    - 全款支付要求
    - 第三方支付通道对接
* **订单拆单逻辑**
  ：
  + 默认拆单规则：
    - 按商品税点分类
    - 按供应商分类
  + 客户自定义规则：
    - 会计科目维度
    - 业务类型维度

###### 二、关键业务实体说明

###### 1. 成本中心(Cost Center)

| 属性 | 说明 |
| --- | --- |
| 关联对象 | 平台分公司 |
| 匹配方式 | 签约绑定/地址自动匹配 |
| 业务影响 | 货权归属/成本核算 |

###### 2. 审核流程模板

```JSON
{
  "template_type": ["金额审核", "科目审核"],
  "approval_rules": [
    {
      "condition_type": "amount",
      "threshold": 10000,
      "approvers": ["张三"]
    },
    {
      "condition_type": "account",
      "subject_code": "A001",
      "approvers": ["李四"]
    }
  ]
}

```

###### 三、异常处理机制

###### 1. 成本中心匹配失败

* 触发条件：地址无法关联有效分公司
* 处理方案：
  + 强制人工介入选择
  + 系统预警机制启动
  + 区域服务人员跟进

###### 2. 支付失败场景

* 常见错误类型：
  + 信用额度不足
  + 支付渠道异常
  + 金额拆分错误
* 失败处理流程：
  + 自动重试机制（3次）
  + 订单状态回退
  + 客户服务通知

###### 四、业务扩展设计

###### 1. 多成本中心支持

* 实现方式：
  + 货品维度成本分配
  + 支持分批发货
  + 多分公司结算对账

###### 2. 智能审核优化

* 功能规划：
  + 机器学习审批预测
  + 历史审批模式学习
  + 风险订单自动识别

##### 1-17 初步明确系统边界

###### 课程简介

* 学习目标：明确客户正向下单业务流程的系统边界
* 前置知识：需求分析方法与业务流程分析

###### 系统边界概述

###### 定义

* 系统边界：本系统与外部系统的交互关系
* 当前聚焦场景：客户正向下单业务流程（订单创建环节）

###### 核心要素

推送订单







发货数据







价格校验









本系统








SAP








WMS








比价系统

###### 外部系统交互关系

###### SAP系统交互

1. 交互场景：

   * 订单推送（信用支付/现金支付）
   * 订单变更推送（拆分/合并后）
2. 核心作用：

   * 财务对账
   * 实物匹配（钱物对应）
3. Tob业务特点：

   * 订单执行灵活性（可替换商品）
   * 需实时同步执行单

###### WMS系统交互

1. **交互节点**
   ：订单发货阶段
2. 功能对接：

   * 发货单生成
   * 库存实物管理
3. 与电商库存区别：

   * 本系统：虚拟库存管理
   * WMS：实物库存管理

###### 比价系统交互

1. 核心机制：

   * 价格爬取（京东/天猫等平台）
   * 价格合规校验
2. 业务流程：

   * 商品浏览阶段价格校验
   * 价格违规处理流程
   * 人工审核改价机制

###### 业务流程特点

###### Tob业务复杂性

* **订单灵活性要求**
  ： ✅ 支持任意拆分/合并 ✅ 商品替换权限 ✅ 动态价格调整
* **系统设计挑战**
  ： ⚠️ 无固定业务规则 ⚠️ 实时同步需求 ⚠️ 多系统协同

###### 后续计划

1. 边界图迭代路径：
   * 当前版本：基础交互关系
   * V2.0：补充交互协议
   * V3.0：增加异常处理流程
2. 深入分析方向：
   * 信用支付风控机制
   * 拆单合并业务规则
   * 价格校验性能优化

###### 课程总结

* 系统边界明确是架构设计基础
* 需重点关注多系统协同场景
* 后续将结合业务深入细化边界

##### 1-18 初步构建业务架构-上

###### 课程概述

* **目标**
  ：通过需求分析方法构建业务架构图
* **前置内容**
  ：业务场景理解、系统边界确认

---

###### 需求分析方法回顾

1. **第一轮需求分析**
   * 业务流程梳理
   * 系统边界初步确认
2. **第二轮需求分析**
   * 逐字逐句审读法
   * 问题挖掘法
   * 功能点分析法
   * 业务走查法

---

###### 业务架构构建步骤

###### 1. 客户中心模块

* **核心功能**
  ：
  + 审核流程维护
    - 中台代客户维护
    - 客户自主维护（Web端）
  + 会计科目管理
    - 科目设置/维护
    - 成本中心配置
  + 采购账号管理
    - 账号与会计科目关联
    - 角色权限管理
  + 库存显示设置
    - 显示模式（有货/无货、实际库存/虚拟库存）
    - 超卖控制（尾货限制）

---

###### 2. 中台管理模块

* **核心功能**
  ：
  + 客户信息管理
    - 企业基本信息维护
    - 协议管理（可购商品清单）
  + 商品清单配置
    - 协议内商品（固定价/折扣价/阶梯价）
    - 协议外商品规则
  + 价格策略管理
    - 客户专属价格配置
    - 跨客户价格策略

---

###### 3. 商品中心模块

* **核心功能**
  ：
  + 商品搜索
    - 关键词搜索
    - 分类筛选
  + 商品详情管理
    - 基础信息展示
    - 实时库存显示
    - 价格展示（协议价/标准价）
  + 库存联动机制
    - 全国仓/区域仓库存同步
    - 虚拟库存计算规则

---

###### 4. 购物车模块

* **核心功能**
  ：
  + 商品添加规则
    - 会计科目校验
    - 库存可用性验证
  + 订单预处理
    - 按会计科目分组展示
    - 价格二次确认
    - 超卖预警提示

---

###### 5. 价格中心模块

* **核心功能**
  ：
  + 动态定价
    - 协议价优先原则
    - 阶梯折扣计算
  + 价格验证
    - 历史价格对比
    - 最低价保护机制
  + 客户专属报价
    - 协议外商品折扣规则
    - 临时调价审批流

---

###### 关键业务规则

1. **库存显示规则**
   * 区域仓优先显示
   * 虚拟库存随机算法
2. **订单执行规则**
   * 半小时人工审核窗口
   * 货品替换机制（B端特性）
3. **价格保护机制**
   * 协议价锁定周期
   * 价格变动通知流程

---

###### 架构构建方法论

1. **从零构建流程**
   * 逐句解析需求文档
   * 功能点即时映射
   * 动态调整模块关系
2. **验证机制**
   * 业务场景反向验证
   * 异常流压力测试
   * 客户角色视角走查

##### 1-19 初步构建业务架构-下

###### 课程衔接

* 接续「初步构建业务架构（上）」内容
* 本节重点：业务架构下半部分解析

---

###### 核心业务模块解析

###### 1. 库存中心

1.1 核心功能模块

* **商品库存管理**
  + 实时库存监控
  + 库存不足预警机制
* **尾货管理**
  + 超卖策略配置
  + 尾货特殊处理流程

1.2 业务规则

* 购物车库存校验逻辑
* 超卖场景处理方案

---

###### 2. 客户中心

2.1 地址管理

* **地址权限控制**
  + 地址新增/修改权限配置
  + 企业采购地址白名单机制
* **地址校验规则**
  + 地理位置有效性验证

2.2 成本中心

* 成本中心关联规则
* 订单提交校验逻辑

---

###### 3. 仓库中心

3.1 基础管理

* 仓库信息管理
* 覆盖范围配置

3.2 核心业务逻辑

* **智能寻仓系统**
  + 多维度寻仓策略
    - 地理覆盖匹配
    - 成本中心关联
    - 库存分布优化
* 仓库-成本中心映射管理

---

###### 4. 订单中心

4.1 订单处理流程

* **订单创建**
  + 库存预锁定机制
* **智能拆单系统**
  + 多维度拆单策略
    - 税点拆单（强制）
    - 品类拆单（可选）
    - 会计科目拆单（可选）

4.2 配置管理

* 拆单规则配置中心
* 审核流程配置

---

###### 5. 财务中心

5.1 客户账务管理

* **结算方式配置**
  + 月结/现结模式管理
* **信用体系**
  + 授信额度管理
  + 信用消费账本
  + 额度预警机制

5.2 支付策略

* 自动确认支付规则
* 混合支付支持策略

---

###### 6. 支付中心

6.1 核心功能

* 支付单生命周期管理
* 多支付渠道整合

6.2 数据记录

* 支付流水记录
* 信用支付对账机制

---

###### 业务流程关键点

1. **订单状态机**

   * 待支付 → 已支付 → 已确认 → 发货处理
   * 特殊状态处理：
     + 月结客户自动确认
     + 改单特殊处理流程
2. **异常处理机制**

   * 库存不足多场景应对
   * 信用额度超额处理
   * 拆单异常回滚机制

---

###### 架构验证方法论

1. 业务走查法应用
2. 模块间依赖关系验证
3. 端到端流程完整性检查

##### 1-20 明确系统边界

###### 课程引言

* 学习目标：深化系统边界定义，构建模块关系图
* 前置知识：已完成业务架构图绘制与初步系统边界确认

###### 初步系统边界现状

客户正向订单系统








SAP








WMS








比价系统

###### 现有交互关系

1. **SAP系统**
   * 订单主数据同步
   * 订单状态双向更新
2. **WMS系统**
   * 发货单推送
   * 物流状态回传
3. **比价系统**
   * 价格策略推送
   * 第三方价格监控

###### 系统边界细化流程

###### 外部边界强化原则

```
Mermaid

```

####### 关键交互规范

1. **SAP接口规范**

   * ```
     SAP_01

     ```

     推送新订单

     + 触发条件：订单创建
     + 数据内容：客户信息/商品明细/支付方式
   * ```
     SAP_02

     ```

     订单修改推送

     + 触发条件：订单状态变更
     + 异步响应：SAP订单号回传
2. **WMS接口规范**

   * ```
     WMS_01

     ```

     发货单生成

     + 包含字段：商品批次/物流商信息/包裹明细
   * ```
     WMS_02

     ```

     签收状态推送

     + 支持状态：已签收/拒收/部分签收
3. **比价系统接口**

   * ```
     PRICE_01

     ```

     实时比价请求

     + 请求频率：QPS≤50
   * ```
     PRICE_02

     ```

     价格异常预警

     + 推送方式：Webhook回调

###### 一级模块关系图构建

###### 系统内部架构

```
Mermaid

```

###### 模块交互矩阵

| 模块名称 | 依赖服务 | 接口数量 | 事务类型 |
| --- | --- | --- | --- |
| 订单创建模块 | 用户中心/商品中心 | 12 | 同步/异步 |
| 订单履约模块 | WMS/支付网关 | 8 | 异步消息驱动 |
| 异常处理模块 | 日志中心/消息平台 | 5 | 定时补偿 |

###### 后续计划

1. 二级子系统边界定义（下节课重点）
2. 接口文档自动化生成方案
3. 跨系统事务一致性验证

> **架构原则强调**
>
> 1. 外部系统交互遵循"异步优先"原则
> 2. 核心业务模块保持高内聚特征
> 3. 异常处理机制实现全链路覆盖

##### 1-21 构建一级模块关系图

###### 课程概述

* 课程主题：在已明确系统边界基础上构建模块关系图
* 教学工具：MindMaster思维导图工具
* 课程衔接：延续上节课"业务架构完善"成果

###### 核心内容框架

###### 1. 系统边界分析维度

* 内部关系分析
  + 同级模块交互关系
  + 依赖方向识别
* 外部关系分析
  + 与外部系统接口
  + 数据流向确认

###### 2. 一级模块识别

前端入口（3个独立模块）

* 暂不纳入当前分析范围

后端中心（10大核心模块）

1. 订单中心
2. 客户中心
3. 购车中心
4. 仓库中心
5. 库存中心
6. 价格中心
7. 商品中心
8. 支付中心
9. 财务中心
10. 分公司中心

###### 3. 模块依赖关系构建

客户中心核心交互

```plaintext
┌──────────────┐       ┌──────────────┐
│   订单中心   │ ← 获取拆单设置 ──┤   客户中心   │
└──────────────┘               └──────────────┘
       ▲                             ▲
       │ 下单流程数据                │ 客户设置数据
┌──────────────┐               ┌──────────────┐
│  购车中心    │ ──────────────┘   财务中心   │
└──────────────┘ ← 信用额度设置      ▲
       │                             │
       ▼                             │
┌──────────────┐               ┌──────────────┐
│ 价格中心     │ ← 客户价格协议 ──┤ 分公司中心   │
└──────────────┘               └──────────────┘

```

###### 订单中心交互链

```Plaintext
订单中心 → 仓库中心：寻仓与成本计算
订单中心 → 库存中心：商品库存锁定
订单中心 → 价格中心：价格校验

```

###### 商品价格体系

```Plaintext
商品中心 → 价格中心：基础价格设置
客户中心 → 价格中心：协议价格设置

```

###### 4. 图形优化原则

1. 布局策略
   * 核心模块居中（客户中心）
   * 业务流顺时针排布
   * 层级间距控制（1屏可见）
2. 可视化规范
   * 依赖关系使用单向箭头
   * 关键交互添加简明注释
   * 采用统一配色方案（推荐蓝灰色系）

###### 课程成果

* 完成10大核心模块关系图
* 建立模块间23项关键依赖关系
* 形成可扩展的系统架构基线

> 注：本图重点展示模块级交互关系，具体接口细节需在详细设计阶段补充

##### 1-22 构建功能点列表-上

###### 课程简介

* 本节为功能点列表构建课程的上半部分
* 前置内容回顾：
  + 业务场景理解
  + 业务架构图构建
  + 系统边界明确
  + 一级模块关系图绘制

###### 功能点列表概述

###### 核心要素

1. **层级分类**
   ：

   * 一级分类（如客户中心/订单中心）
   * 二级分类（如采购流程/库存管理）
   * 三级功能点（具体操作）
2. **功能描述**
   ：

   * 明确每个功能的业务目标
   * 典型粒度：增删改查审
3. **功能说明**
   ：

   * 补充复杂功能的细节描述
   * 示例：
     `库存显示规则设置`

###### 价值体现

* 架构设计依据（1功能点≈1 API）
* 开发任务分解基础
* 需求覆盖度验证工具

---

###### 功能点列表构建步骤

###### 1. 客户中心功能点

1.1 采购流程设置

* 采购审核流程设置
  + 设置金额阈值与审核人对应关系
  + 设置会计科目审核规则

1.2 客户信息管理

* 客户基本信息（CRUD）
* 工作人员管理：
  + 账号密码管理（含商城登录权限）
  + 角色分配与权限配置

1.3 审核流程管理

* 审核单自动生成规则
* 审核记录管理：
  + 审核意见存档
  + 订单状态联动更新

1.4 库存规则设置

```markdown
库存显示规则：
- 显示模式：有货/无货 | 实际库存量
- 尾货标志设置（禁止超卖）

```

###### 2. 商品中心功能点

2.1 可购商品管理

* 协议商品清单设置：
  + 按商品分类批量设置
  + 特殊商品单独配置
* 非协议商品采购规则：
  + 是否允许采购开关
  + 统一折扣率设置

2.2 商品分类体系

* 多级分类管理
* 分类-商品关联维护

###### 核心业务流程对应

###### 采购下单流程功能点

1. **登录认证**
   ：
   * 采购账号权限验证
   * 角色权限校验
2. **商品展示**
   ：
   * 库存实时状态显示
   * 客户专属价格展示
3. **订单创建**
   ：
   * 地址选择（仅限预置地址）
   * 成本中心关联
   * 自动拆单规则执行

###### 特别注意事项

1. **扩展性设计**
   ：
   * 客户→成本中心（1→N扩展准备）
   * 拆单规则自定义扩展接口
2. **安全机制**
   ：
   * 采购地址修改限制
   * 敏感操作日志追踪

> **示例说明**
> ： 审核流程设置中的
> `金额阈值`
> 需支持：
>
> * 多级审核阶梯设置
> * 生效时间范围配置
> * 审核人分组管理

##### 1-23 构建功能点列表-中

###### 课程结构

* **当前进度**
  ：课程中段（已讲解客户中心）
* **本节重点**
  ：前台、中台登录、分公司中心、商品中心、库存中心等模块功能点梳理

---

###### 功能模块分解

###### 1. 分公司中心

1.1 核心功能

* 分公司基本信息管理
* 分公司工作人员管理
* 分公司人员角色管理
* 中台登录管理（后端管理系统账号）

1.2 界面规范

```代码示例
[表格格式建议]
| 功能模块        | 操作权限     |
|----------------|-------------|
| 基本信息管理   | 分公司管理员 |
| 工作人员管理   | 总部管理员   |

```

###### 2. 商品中心

2.1 核心功能

1. **商品展示**
   * 分页展示商品列表
   * 商品编号获取明细功能
   * 商品搜索（支持多条件检索）
2. **分类管理**
   * 多级分类体系（父子层级）
   * 分类增删改查
   * 分类调整审核机制

2.2 业务特性

```
 电商分类规范：
- 后端分类：5级固定分类（调整需审批）
- 前端分类：动态可配置分类

```

###### 3. 库存中心

3.1 核心功能

1. **库存管理**
   * 实时库存查询
   * 库存锁定/解锁机制
     + 订单关联锁定
     + 超时自动解锁
     + 拒收处理流程
2. **尾货管理**
   * 尾货标记设置
   * 尾货状态解除
   * 尾货促销策略接口

###### 4. 仓库中心

4.1 核心功能

1. **基础管理**

   * 仓库信息管理（CRUD）
   * 覆盖范围设置（省-市-区三级）
2. **业务逻辑**

   * 成本中心关联（1:N关系）
   * 智能寻仓算法

     ```
      送货地址 -> 覆盖仓库 -> 关联成本中心

     ```

###### 5. 价格中心

5.1 核心功能

* 客户专属定价
* 协议价管理
* 价格获取接口：

  ```
   GET /price?clientId={cid}&sku={sku}

  ```

###### 6. 购物车管理

6.1 核心功能

* 商品加入逻辑
* 协议内外商品区分
* 会计科目分组展示

###### 7. 支付中心

7.1 核心流程

1. **支付单管理**
   * 创建支付单
   * 支付方式：
     + 信用支付（优先）
     + 现金支付（支付宝/微信/银联）
2. **回调处理**
   * 支付状态同步
   * 财务记账触发

###### 8. 财务中心

8.1 核心功能

1. **信用管理**
   * 信用额度审批流程
   * 授信额度调整
   * 信用流水账本
2. **结算设置**
   * 月结/现结配置
   * 结算周期管理

###### 课程总结

```
 [业务流程图示意]
订单提交 -> 库存校验 -> 仓库匹配 -> 支付处理 -> 财务记账

```

> **特别提示**
> ：需求分析阶段聚焦于业务需求，暂不考虑技术实现细节

##### 1-24 构建功能点列表-下

###### 订单中心功能分析

###### 1. 下单功能

* **核心功能**
  ：保存下单数据
* **状态管理**
  ：
  + 若需客户方审核 → 订单状态置为「待客户审核」
  + 自动生成采购审核单
* **关联流程**
  ：

  需要审核









  提交订单








  审核判断








  生成采购审核单

###### 2. 拆单功能

2.1 拆单规则

1. 强制拆单：

   * 按商品税点拆单（必须执行）
2. 可选拆单：

   * 按客户设置拆单
   * 按会计科目拆单
   * 按自定义分类拆单

2.2 拆单流程

```
Mermaid

```

###### 3. 库存锁定

* 锁定流程：

  1. 通过仓库中心查询：

     + 目标仓库
     + 成本中心
  2. 检查可售库存
  3. 执行库存转换：

     ```
      可售库存 → 锁定库存

     ```

###### 4. 客户审核

* 审核判断：

  + 是否设置审核流程
  + 是否满足审核条件
* 审核类型：

  + 金额审核（示例）：

    ```json
    Json{
      "金额阈值": ">10万 → 王五审核",
      "科目审核": "会计科目1 → 张三"
    }

    ```
  + 科目审核
* 流程特点：

  + 支持多级串联审核
  + 自动推进审核流程

###### 5. 订单支付

5.1 支付方式

* 信用支付：
  + 自动完成额度抵扣
  + 额度不足时转在线支付
* 在线支付：
  + 支持渠道：
    - 支付宝
    - 微信
    - 银联

5.2 支付流程

```
Mermaid

```

###### 功能验证要点

1. 跨中心交互验证：
   * 仓库中心库存查询
   * 支付中心回调机制
2. 异常场景覆盖：
   * 拆单后部分库存不足
   * 审核流程中断处理
3. 状态机完整性：
   * 订单状态流转闭环
   * 支付超时自动取消

> **特别说明**
> ：本功能列表已做教学简化，实际需求分析需结合：
>
> * 业务流程图解耦
> * 用户场景走查
> * 系统交互验证

##### 需求分析成果物课程笔记

###### 课程简介

* 学习目标：掌握需求分析的核心成果物及其形成过程
* 核心要点：功能点列表、需求分析说明书

---

###### 需求分析过程回顾

###### 1. 需求分析起点

* **基础材料**
  ：
  + 需求调研成果物
  + 订单需求说明书（含客户下单流程）
  + 场景描述文档
  + 独立保存的下单流程图

###### 2. 分析过程框架

* **核心目标**
  ：
  + 准确/全面/深入理解业务
  + 理解业务功能点
  + 理清业务流程
* **关键产出**
  ：
  + 业务架构图（迭代完善版）
  + 系统边界图（内部/外部系统关系）
  + 同级模块关系图

###### 3. 分析方法体系

* **方法论工具**
  ：
  + 逐字逐句审读法
  + 业务走查法
  + 问题挖掘法
  + 功能点分析法
  + 业务流程分析法
* **应用案例**
  ：
  + 拆单功能模板示范（课上案例）
  + 50+功能点梳理（课后作业）

---

###### 1-26 需求分析成果物

###### 1. 核心成果物结构

| 成果物名称 | 内容构成 | 存储形式 |
| --- | --- | --- |
| 功能点列表 | 50+功能点条目 | 独立文件 |
| 需求分析说明书 | 架构图+功能描述+流程描述 | 综合文档 |

###### 2. 需求分析说明书构成

* **业务架构部分**
  ：

  + 业务模式说明
  + 业务架构图（迭代演进版）
  + 系统边界图
  + 同级模块关系图
* **功能描述部分**
  ：

  + 功能点详细描述（模板化）
  + 业务流程详细描述（含流程图）
  + 非功能质量要求
  + 系统约束说明

###### 3. 文档生成逻辑

1. 架构图导入文档主体
2. 补充功能/流程文字说明
3. 添加非功能性要求
4. 形成完整需求基线

---

###### 总结与重要性强调

> **架构师必备能力**
> ：
>
> * 需求分析质量直接影响：
>   + 架构设计方案可行性
>   + 开发实现效率
>   + 最终产品成功率
>
> **实践建议**
> ：
>
> * 投入足够时间进行需求验证
> * 采用迭代式分析方法
> * 重视文档模板的规范使用
> * 建立功能点跟踪机制

> *注：功能点列表需保持独立，作为需求跟踪基准*

##### 1-27 本章总结

###### 学习目标

通过本章学习掌握：

1. 需求分析阶段的核心任务
2. 需求分析的具体实施方法

###### 需求分析流程

###### 1. 业务背景理解

* 分析对象：年交易额200亿的BToB电商平台订单系统
* 输入材料：
  + 需求调研报告
  + 相关调研资料

###### 2. 需求分析方法

* 应用六大实战心法：
  1. 业务功能点分析
  2. 业务流程梳理
  3. 业务需求深度理解
  4. 系统边界界定
  5. 业务架构构建
  6. 需求文档规范化

###### 3. 核心工作产出

* 订单系统功能点列表
* 系统交互关系图
* 业务架构演进路径：

初步业务聚合分析 → 架构图完善 → 最终架构确认

```
 成果物清单
✅ 功能点列表
✅ 业务流程图
✅ 需求分析报告
✅ 业务架构图
✅ 系统交互关系图

本章小结
"从零开始完整经历项目需求分析阶段，为后续架构设计奠定坚实基础。"

```