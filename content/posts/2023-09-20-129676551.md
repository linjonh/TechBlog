---
layout: post
title: "嵌入式BSP的理解"
date: 2023-09-20 10:24:24 +0800
description: "嵌入式：BSP的理解_嵌入式bsp"
keywords: "嵌入式bsp"
categories: ['Linux']
tags: ['嵌入式', 'Linux', 'Bsp']
artid: "129676551"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=129676551
    alt: "嵌入式BSP的理解"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=129676551
featuredImagePreview: https://bing.ee123.net/img/rand?artid=129676551
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     嵌入式：BSP的理解
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <div class="toc">
     <h4>
      BSP概念总结
     </h4>
     <ul>
      <li>
       <a href="#BSP_8" rel="nofollow">
        BSP定义
       </a>
      </li>
      <li>
       <a href="#BSP_18" rel="nofollow">
        BSP的特点
       </a>
      </li>
      <li>
       <a href="#BSP_23" rel="nofollow">
        BSP的主要工作
       </a>
      </li>
      <li>
       <a href="#BSPWindowsx_38" rel="nofollow">
        BSP在嵌入式系统和Windowsx系统中的不同
       </a>
      </li>
      <li>
       <a href="#BSPPCBIOS_42" rel="nofollow">
        BSP和PC机主板上的BIOS区别
       </a>
      </li>
      <li>
       <a href="#BSP_HAL_47" rel="nofollow">
        BSP与 HAL关系
       </a>
      </li>
     </ul>
    </div>
    <br/>
    嵌入式计算机系统主要由 硬件层，中间层，系统软件层和应用软件层四层组成。
    <p>
    </p>
    <ol>
     <li>
      硬件层：包含CPU，存储器(SDRAM，ROM，Flash等),通用设备接口和I/O接口(A/D、D/A、I/O)，其中操作系统和应用程序都可以固话在ROM中。
     </li>
     <li>
      中间层：硬件层与软件层之间称为中间层，可以称为硬件抽象层(Hardware Abstract Layer , HAL)或板级支持包BSP(Board Support Package)
     </li>
     <li>
      系统软件层：系统软件层由操作系统(RTOS，Linux，VxWindows)，文件系统，网络系统及通用组件模块组成。
     </li>
     <li>
      应用软件层：应用软件层是由操作系统开发的应用软件程序组成，用来实现某种功能或者业务。
     </li>
    </ol>
    <h2>
     <a id="BSP_8">
     </a>
     BSP定义
    </h2>
    <p>
     硬件层与软件层之间为中间层，也称为硬件抽象层(Hardware Abstract Layer HAL)或板级支持包(Board Support Package BSP) ，它将系统上层与底层硬件分类开来，使系统的底层驱动程序与硬件无关，上次软件开发人员无需关心底层硬件的具体情况，根据BSP层体用的接口即可进行开发，该层一般包含相关底层硬件的初始化，数据的输入，输出操作和硬件的配置功能。
    </p>
    <p>
     应该说是属于操作系统的一部分，主要目的是为了支持操作系统，使之能够更好的运行于硬件主板。
    </p>
    <p>
     BSP是相对于操作系统而言的，不同的操作系统对应于不同定义形式的BSP。
     <br/>
     🚀🚀🚀如下图所示 BSP定义。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/063e65692a30d9fee4f52529d1f3a2ec.png"/>
    </p>
    <h2>
     <a id="BSP_18">
     </a>
     BSP的特点
    </h2>
    <ul>
     <li>
      硬件相关性 ： 因为嵌入式实时系统的硬件环境具有应用相关性，而作为上层软件与硬件平台之间的接口，BSP需要为操作系统提供操作和控制具体硬件的方法。
     </li>
     <li>
      操作系统相关性：不同的操作系统具有各自的软件层次结构，因此，不同的操作系统具有特定的硬件接口形式，实际上，BSP是一个介于操作系统和底层硬件之间的软件层次，包括了系统中大部分与硬件联系紧密的软件模块。
     </li>
    </ul>
    <h2>
     <a id="BSP_23">
     </a>
     BSP的主要工作
    </h2>
    <p>
     设计一个完整的BSP需要完成两部分工作，嵌入式系统的硬件初始化以及设计硬件相关的设备驱动程序。
    </p>
    <p>
     🚀1. 嵌入式系统硬件初始化
     <br/>
     从硬件到权健的次序，可以将硬件初始化分为3个部分，分别为片级初始化，板级初始化和系统级初始化。
    </p>
    <blockquote>
     <p>
      <strong>
       片级初始化
      </strong>
      ：主要工作是完成嵌入式微处理的初始化，即 RAM，PowerPC等CPU初始化工作，包括设置 微处理的核心寄存器和控制寄存器，微处理器核心工作模式和微处理的局部总线模式等。片级初始化把微处理器从上电时的默认状态逐步设置成系统所要求的工作状态，这是一个纯一年的初始化过程。
      <br/>
      <strong>
       板级初始化：
      </strong>
      主要工作是完成嵌入式微处理器以外的其他硬件设备的初始化，即外围电路的初始化，另外，还需设置某些软件的数据结构和参数，为随后的系统级初始化和应用程序的运行建立硬件好软件环境，这是一个同时包含软硬件两部分在内的初始化过程。
      <br/>
      <strong>
       系统级初始化
      </strong>
      ：主要工作是进行操作系统的初始化，BSP将对嵌入式微处理的控制权转交给嵌入式操作系统，由操作系统完成余下的初始化操作，包含加载和初始化与硬件无关的设备驱动程序，建立系统内存区，加载并初始化其他系统软件模块，如：网络系统，文件系统等。最后，操作系统创建应用程序环境，并见控制权交给应用程序的入口。
     </p>
    </blockquote>
    <p>
     🚀 2. 设计硬件相关的设备驱动程序
     <br/>
     BSP的另一个主要功能是硬件相关的设备驱动，硬件相关的设备驱动程序的初始化通常是一个从 高到低的过程，尽管BSP中包含硬件相关的设备驱动程序，但是这些设备驱动程序通常不直接由于 BSP使用，而是在系统初始化过程中由BSP将他们与操作系统中通用的设备驱动程序关联起来，并在随后的应用中由通用的设备驱动程序调用，实现对硬件设备的操作，与硬件相关的驱动程序 是BSP设计与开发中另一个非常重要的环节
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/ac890d03164a0c8cc0c26e2e8442c446.png"/>
    </p>
    <h2>
     <a id="BSPWindowsx_38">
     </a>
     BSP在嵌入式系统和Windowsx系统中的不同
    </h2>
    <p>
     🚀在日常生活使用的PC机上(WIndows或Linux)也是有 BSP的，只是PC机均采用的 CPU架构为统一的 x86体系架构，因此操作系统的 BSP相对于 x86架构是单一确定的，不需要做任何修改就可以很统支持操作系统在 x86上正常运行，所以在PC机上谈论 x86这个概念就显得没什么意思了。
     <br/>
     🚀 但是在嵌入式系统则完全不同，目前市场上存在多种架构的嵌入式 CPU(ARM，MIPS，RISC-V等)，同时外围设备也会根据需求有不同的选择和定义，一个嵌入式操作系统针对不同的CPU，就会有不同的 BSP，即使用一种CPU，由于外设的差异，其BSP也会部分不一样，所以根据硬件设计编写和修改BSP，保证系统正常的运行工作是非常重要的。
    </p>
    <h2>
     <a id="BSPPCBIOS_42">
     </a>
     BSP和PC机主板上的BIOS区别
    </h2>
    <p>
     🚀BSP和PC机主板上的BIOS区别很大，BIOS主要是负责在电脑开启时检测，初始化系统设备(设置栈指针，中断分配，内存初始化等)，装入操作系统并调度操作系统向硬件发出的指令，它的 Firmware代码是在芯片生成过程中固话的，一般来说用户是无法修改的，其实就是为下载运行操作系统做的准备，把操作系统由硬盘加载到内存中，并传递一些硬件接口设置给系统。
     <br/>
     🚀 在操作系统运行正常后，BIOS的作用基本上也就完成了，这就是为什么更改BIOS一定要关机重启。PC机BIOS的作用更像嵌入式系统中的 Bootloader（最底层的引导软件，初始化主板的基本设置，为接收外部程序做硬件上的准备），与Bootloader 不同的是 BIOS在装载 OS系统的同时，还传递一些参数设置(中断端口定义等)，而 Bootloader 只是简单的装载系统。
     <br/>
     🚀 BSP和操作系统绑在一起运行在主板上，尽管BSP的开始部分和 BIOS所做的工作类似，可是大部分和BIOS不同，作用也完全不同，此外BSP还包含和系统有关的基本驱动(串口，网口等)，此外程序员还可以编程修改 BSP， 在BSP中任意添加一些和系统无关的驱动或者程序，慎重可以把上次开发的软件放到 BSP中，而 BIOS程序用户是不能修改的。
    </p>
    <h2>
     <a id="BSP_HAL_47">
     </a>
     BSP与 HAL关系
    </h2>
    <p>
     硬件的变动将会对 BSP造成大规模的改动，这无疑对 BSP的维护是一种巨大的负担。
     <br/>
     🚀 引入HAL(硬件抽象层)的概念，由HAL库 对BSP库进一步的封装，形成统一的标准，而下次再改动硬件电路部分时，只需要改动 BSP库的具体功能函数，而不需要对上层进行任何的修改。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/9c5bb5188ba61a70445a2a829d8d3090.png"/>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f753031333632303330362f:61727469636c652f64657461696c732f313239363736353531" class_="artid" style="display:none">
 </p>
</div>


