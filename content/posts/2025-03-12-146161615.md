---
arturl_encode: "68747470733a2f2f626c6f:672e6373646e2e6e65742f323330335f37373230303332342f:61727469636c652f64657461696c732f313436313631363135"
layout: post
title: "æœºå™¨å­¦ä¹ åŸºäºt-SNEçš„MNISTæ•°æ®é›†å¯è§†åŒ–æ¢ç´¢"
date: 2025-03-12 10:00:00 +08:00
description: "åœ¨æœºå™¨å­¦ä¹ å’Œæ•°æ®ç§‘å­¦é¢†åŸŸï¼Œé«˜ç»´æ•°æ®çš„å¯è§†åŒ–æ˜¯ä¸€ä¸ªæå…·æŒ‘æˆ˜ä½†åˆè‡³å…³é‡è¦çš„é—®é¢˜ã€‚é«˜ç»´æ•°æ®éš¾ä»¥ç›´è§‚åœ°ç†è§£å’Œåˆ†æï¼Œè€Œæœ‰æ•ˆçš„å¯è§†åŒ–æ–¹æ³•èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å‘ç°æ•°æ®ä¸­çš„æ½œåœ¨ç»“æ„ã€æ¨¡å¼å’Œå…³ç³»ã€‚æœ¬æ–‡ä»¥ç»å…¸çš„MNISTæ‰‹å†™æ•°å­—æ•°æ®é›†ä¸ºä¾‹ï¼Œæ¢è®¨å¦‚ä½•åˆ©ç”¨t-åˆ†å¸ƒéšæœºé‚»åŸŸåµŒå…¥ï¼ˆt-SNEï¼‰è¿™ä¸€å¼ºå¤§çš„é™ç»´æŠ€æœ¯ï¼Œå°†é«˜ç»´çš„å›¾åƒæ•°æ®é™ç»´åˆ°äºŒç»´ç©ºé—´ï¼Œå¹¶è¿›è¡Œå¯è§†åŒ–å±•ç¤ºã€‚é€šè¿‡æœ¬æ–‡ï¼Œæˆ‘ä»¬å°†æ·±å…¥äº†è§£t-SNEçš„åŸç†ã€ç®—æ³•æ­¥éª¤ï¼Œä»¥åŠå¦‚ä½•åœ¨Pythonä¸­å®ç°å¹¶åº”ç”¨å®ƒï¼Œä»è€Œæ›´å¥½åœ°ç†è§£å’Œæ¢ç´¢é«˜ç»´æ•°æ®çš„å†…åœ¨ç‰¹æ€§ã€‚"
keywords: "t-sneæ•°æ®å¯è§†åŒ–"
categories: ['æœºå™¨å­¦ä¹ ', 'Py']
tags: ['é™ç»´', 'èšç±»', 'æœºå™¨å­¦ä¹ ', 'äººå·¥æ™ºèƒ½']
artid: "146161615"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146161615
    alt: "æœºå™¨å­¦ä¹ åŸºäºt-SNEçš„MNISTæ•°æ®é›†å¯è§†åŒ–æ¢ç´¢"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146161615
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146161615
cover: https://bing.ee123.net/img/rand?artid=146161615
image: https://bing.ee123.net/img/rand?artid=146161615
img: https://bing.ee123.net/img/rand?artid=146161615
---

# ã€æœºå™¨å­¦ä¹ ã€‘åŸºäºt-SNEçš„MNISTæ•°æ®é›†å¯è§†åŒ–æ¢ç´¢

## **ä¸€ã€å‰è¨€**

åœ¨æœºå™¨å­¦ä¹ å’Œæ•°æ®ç§‘å­¦é¢†åŸŸï¼Œé«˜ç»´æ•°æ®çš„å¯è§†åŒ–æ˜¯ä¸€ä¸ªæå…·æŒ‘æˆ˜ä½†åˆè‡³å…³é‡è¦çš„é—®é¢˜ã€‚é«˜ç»´æ•°æ®éš¾ä»¥ç›´è§‚åœ°ç†è§£å’Œåˆ†æï¼Œè€Œæœ‰æ•ˆçš„å¯è§†åŒ–æ–¹æ³•èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å‘ç°æ•°æ®ä¸­çš„æ½œåœ¨ç»“æ„ã€æ¨¡å¼å’Œå…³ç³»ã€‚æœ¬æ–‡ä»¥ç»å…¸çš„MNISTæ‰‹å†™æ•°å­—æ•°æ®é›†ä¸ºä¾‹ï¼Œæ¢è®¨å¦‚ä½•åˆ©ç”¨t-åˆ†å¸ƒéšæœºé‚»åŸŸåµŒå…¥ï¼ˆt-SNEï¼‰è¿™ä¸€å¼ºå¤§çš„é™ç»´æŠ€æœ¯ï¼Œå°†é«˜ç»´çš„å›¾åƒæ•°æ®é™ç»´åˆ°äºŒç»´ç©ºé—´ï¼Œå¹¶è¿›è¡Œå¯è§†åŒ–å±•ç¤ºã€‚é€šè¿‡æœ¬æ–‡ï¼Œæˆ‘ä»¬å°†æ·±å…¥äº†è§£t-SNEçš„åŸç†ã€ç®—æ³•æ­¥éª¤ï¼Œä»¥åŠå¦‚ä½•åœ¨Pythonä¸­å®ç°å¹¶åº”ç”¨å®ƒï¼Œä»è€Œæ›´å¥½åœ°ç†è§£å’Œæ¢ç´¢é«˜ç»´æ•°æ®çš„å†…åœ¨ç‰¹æ€§ã€‚

---

## **äºŒã€** æŠ€æœ¯ä¸åŸç†ç®€ä»‹

åœ¨æ·±å…¥æ¢è®¨t-SNEä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦åŒºåˆ†æœºå™¨å­¦ä¹ ä¸­çš„ä¸¤å¤§ä¸»è¦èŒƒç•´ï¼šç›‘ç£å­¦ä¹ å’Œæ— ç›‘ç£å­¦ä¹ ã€‚

### **1.Â ç›‘ç£å­¦ä¹ **

ç›‘ç£å­¦ä¹ æ˜¯æŒ‡åœ¨å·²çŸ¥è¾“å…¥æ•°æ®å’Œå¯¹åº”æ ‡ç­¾çš„æƒ…å†µä¸‹ï¼Œè®­ç»ƒæ¨¡å‹å­¦ä¹ è¾“å…¥ä¸è¾“å‡ºä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚æ¨¡å‹é€šè¿‡å­¦ä¹ å¤§é‡çš„å¸¦æ ‡ç­¾æ•°æ®ï¼Œèƒ½å¤Ÿå¯¹æ–°çš„ã€æœªè§è¿‡çš„æ•°æ®è¿›è¡Œé¢„æµ‹æˆ–åˆ†ç±»ã€‚å¸¸è§çš„ç›‘ç£å­¦ä¹ ç®—æ³•åŒ…æ‹¬ï¼š

* **çº¿æ€§å›å½’:**
  ç”¨äºé¢„æµ‹è¿ç»­å‹å˜é‡ã€‚
* **é€»è¾‘å›å½’:**
  ç”¨äºåˆ†ç±»é—®é¢˜ã€‚
* **æ”¯æŒå‘é‡æœº (SVM):**
  ç”¨äºåˆ†ç±»å’Œå›å½’é—®é¢˜ï¼Œå°¤å…¶æ“…é•¿å¤„ç†é«˜ç»´æ•°æ®ã€‚
* **å†³ç­–æ ‘:**
  åŸºäºæ ‘çŠ¶ç»“æ„è¿›è¡Œå†³ç­–ï¼Œæ˜“äºç†è§£å’Œè§£é‡Šã€‚
* **éšæœºæ£®æ—:**
  é›†æˆå¤šä¸ªå†³ç­–æ ‘ï¼Œæé«˜é¢„æµ‹çš„å‡†ç¡®æ€§å’Œé²æ£’æ€§ã€‚
* **ç¥ç»ç½‘ç»œ:**
  æ¨¡æ‹Ÿäººè„‘ç¥ç»å…ƒç»“æ„ï¼Œèƒ½å¤Ÿå­¦ä¹ å¤æ‚çš„éçº¿æ€§å…³ç³»ã€‚

### **2. æ— ç›‘ç£å­¦ä¹ **

æ— ç›‘ç£å­¦ä¹ æ˜¯æŒ‡åœ¨æ²¡æœ‰æ ‡ç­¾çš„æƒ…å†µä¸‹ï¼Œè®­ç»ƒæ¨¡å‹å‘ç°æ•°æ®ä¸­çš„æ½œåœ¨ç»“æ„å’Œæ¨¡å¼ã€‚æ¨¡å‹é€šè¿‡åˆ†ææ•°æ®çš„å†…åœ¨ç‰¹å¾ï¼Œèƒ½å¤Ÿè¿›è¡Œèšç±»ã€é™ç»´ã€å…³è”è§„åˆ™æŒ–æ˜ç­‰ä»»åŠ¡ã€‚å¸¸è§çš„æ— ç›‘ç£å­¦ä¹ ç®—æ³•åŒ…æ‹¬ï¼š

* **èšç±»:**
  å°†æ•°æ®åˆ’åˆ†ä¸ºä¸åŒçš„ç°‡ï¼Œä½¿å¾—åŒä¸€ç°‡å†…çš„æ•°æ®ç›¸ä¼¼åº¦è¾ƒé«˜ï¼Œä¸åŒç°‡ä¹‹é—´çš„æ•°æ®ç›¸ä¼¼åº¦è¾ƒä½ã€‚å¸¸è§çš„èšç±»ç®—æ³•åŒ…æ‹¬K-meansã€å±‚æ¬¡èšç±»ã€DBSCANç­‰ã€‚
* **é™ç»´:**
  å°†é«˜ç»´æ•°æ®é™ç»´åˆ°ä½ç»´ç©ºé—´ï¼ŒåŒæ—¶å°½å¯èƒ½ä¿ç•™æ•°æ®çš„å…³é”®ä¿¡æ¯ã€‚å¸¸è§çš„é™ç»´ç®—æ³•åŒ…æ‹¬ä¸»æˆåˆ†åˆ†æ (PCA)ã€t-SNEã€UMAPç­‰ã€‚
* **å…³è”è§„åˆ™æŒ–æ˜:**
  å‘ç°æ•°æ®ä¸­ä¸åŒé¡¹ä¹‹é—´çš„å…³è”å…³ç³»ï¼Œä¾‹å¦‚è´­ç‰©ç¯®åˆ†æã€‚

### **3. ç›‘ç£å­¦ä¹ ä¸æ— ç›‘ç£å­¦ä¹ çš„åŒºåˆ«**

![](https://i-blog.csdnimg.cn/direct/6671f326daf4403283e344b0f9dfaf46.png)

### **4. MNISTæ•°æ®é›†ç®€ä»‹**

MNIST (Modified National Institute of Standards and Technology database) æ˜¯ä¸€ä¸ªç»å…¸çš„æ‰‹å†™æ•°å­—æ•°æ®é›†ï¼Œå¹¿æ³›åº”ç”¨äºæœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ é¢†åŸŸã€‚å®ƒåŒ…å«60,000ä¸ªè®­ç»ƒæ ·æœ¬å’Œ10,000ä¸ªæµ‹è¯•æ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬éƒ½æ˜¯ä¸€ä¸ª28x28åƒç´ çš„ç°åº¦å›¾åƒï¼Œä»£è¡¨0åˆ°9ä¹‹é—´çš„æ‰‹å†™æ•°å­—ã€‚

![](https://i-blog.csdnimg.cn/direct/1e86f074b31247f4bb72517110c0be58.png)

**4.1 æ•°æ®æ ¼å¼**

MNISTæ•°æ®é›†é€šå¸¸ä»¥ä¸¤ç§æ ¼å¼æä¾›ï¼š

* **å›¾åƒæ ¼å¼:**
  æ¯ä¸ªæ ·æœ¬éƒ½æ˜¯ä¸€ä¸ªå›¾åƒæ–‡ä»¶ï¼Œä¾‹å¦‚PNGæˆ–JPEGæ ¼å¼ã€‚
* **æ•°å€¼æ ¼å¼:**
  æ¯ä¸ªæ ·æœ¬éƒ½è¢«è½¬æ¢ä¸ºä¸€ä¸ª784ç»´çš„å‘é‡ï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ ä»£è¡¨ä¸€ä¸ªåƒç´ çš„ç°åº¦å€¼ (0åˆ°255)ã€‚

**4.2 æ•°æ®é›†ç‰¹ç‚¹**

* **è§„æ¨¡é€‚ä¸­:**
  MNISTæ•°æ®é›†çš„è§„æ¨¡é€‚ä¸­ï¼Œæ—¢å¯ä»¥ç”¨äºå¿«é€ŸåŸå‹éªŒè¯ï¼Œåˆå¯ä»¥ç”¨äºè®­ç»ƒå¤æ‚çš„æ¨¡å‹ã€‚
* **æ˜“äºè·å–:**
  MNISTæ•°æ®é›†å¯ä»¥ä»å¤šä¸ªæ¥æºå…è´¹è·å–ï¼Œä¾‹å¦‚Scikit-learnã€TensorFlowç­‰ã€‚
* **å¹¿æ³›åº”ç”¨:**
  MNISTæ•°æ®é›†è¢«å¹¿æ³›åº”ç”¨äºå„ç§æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ ç®—æ³•çš„è¯„ä¼°å’Œæ¯”è¾ƒã€‚

### 5. t-SNEç®—æ³•åŸç†ä¸æ•°å­¦æ¨å¯¼

#### 5.1 ç®—æ³•æ ¸å¿ƒæ€æƒ³

t-SNEï¼ˆt-Distributed Stochastic Neighbor Embeddingï¼‰æ˜¯ä¸€ç§éçº¿æ€§é™ç»´æŠ€æœ¯ï¼Œé€šè¿‡ä»¥ä¸‹æ­¥éª¤å®ç°é«˜ç»´æ•°æ®åˆ°ä½ç»´ç©ºé—´çš„æ˜ å°„ï¼š

1. **è®¡ç®—é«˜ç»´ç›¸ä¼¼åº¦**
   ï¼šåœ¨åŸå§‹ç©ºé—´ä¸­ï¼Œè®¡ç®—æ¯å¯¹æ ·æœ¬é—´çš„ç›¸ä¼¼åº¦
2. **æ„å»ºä½ç»´åµŒå…¥ç©ºé—´**
   ï¼šåœ¨ç›®æ ‡ç©ºé—´ï¼ˆå¦‚2Dï¼‰ä¸­ï¼Œé€šè¿‡ä¼˜åŒ–ä½¿ç›¸ä¼¼åº¦åˆ†å¸ƒåŒ¹é…
3. **æ¢¯åº¦ä¸‹é™ä¼˜åŒ–**
   ï¼šæœ€å°åŒ–ä¸¤ç©ºé—´åˆ†å¸ƒçš„KLæ•£åº¦

#### **5.2 æ•°å­¦å…¬å¼è¯¦è§£**

##### 5.2.1 é«˜ç»´ç›¸ä¼¼åº¦è®¡ç®—

å¯¹åŸå§‹ç©ºé—´ä¸­çš„æ ·æœ¬å¯¹(ğ‘¥ğ‘–,ğ‘¥ğ‘—) ï¼Œå®šä¹‰æ¡ä»¶æ¦‚ç‡ï¼š

![](https://i-blog.csdnimg.cn/direct/03c8dd8281e94510936e0fd549c48842.png)

å…¶ä¸­ğœğ‘– â€‹ä¸ºé«˜æ–¯æ ¸å¸¦å®½ï¼Œé€šè¿‡äºŒåˆ†æŸ¥æ‰¾ç¡®å®šä»¥æ»¡è¶³\*\*
**perplexity**
\*\*å‚æ•°ï¼ˆæ§åˆ¶é‚»åŸŸå¤§å°ï¼‰ã€‚

##### 5.2.2 ä½ç»´ç›¸ä¼¼åº¦å»ºæ¨¡

åœ¨ç›®æ ‡ç©ºé—´ä¸­ï¼Œå®šä¹‰è”åˆæ¦‚ç‡ï¼š

![](https://i-blog.csdnimg.cn/direct/47940b53ef2444ee84cb78e32bb82457.png)

é‡‡ç”¨t-åˆ†å¸ƒï¼ˆè‡ªç”±åº¦ä¸º1çš„Studentåˆ†å¸ƒï¼‰ä»¥å¢å¼ºå¯¹å¼‚å¸¸å€¼çš„é²æ£’æ€§ã€‚

##### 5.2.3 ç›®æ ‡å‡½æ•°ä¼˜åŒ–

é€šè¿‡æœ€å°åŒ–KLæ•£åº¦å®ç°åˆ†å¸ƒåŒ¹é…ï¼š

![](https://i-blog.csdnimg.cn/direct/ab630535d86c403397bdc12a520f01d2.png)

å…¶ä¸­

![](https://i-blog.csdnimg.cn/direct/c24c16a797924b1a879808161d3ccad1.png)

ä¼˜åŒ–è¿‡ç¨‹ä½¿ç”¨æ¢¯åº¦ä¸‹é™ï¼š

![](https://i-blog.csdnimg.cn/direct/559a07f71c634e09869a6648d5fcc6cc.png)

#### 5.3 ç®—æ³•æ­¥éª¤æµç¨‹

1. **å‚æ•°åˆå§‹åŒ–**
   ï¼šè®¾ç½®é™ç»´ç»´åº¦ï¼ˆå¦‚2Dï¼‰ã€perplexityï¼ˆé€šå¸¸5-50ï¼‰ã€å­¦ä¹ ç‡ç­‰
2. **é«˜ç»´ç›¸ä¼¼åº¦è®¡ç®—**
   ï¼šä¸ºæ¯ä¸ªæ ·æœ¬è®¡ç®—æ¡ä»¶æ¦‚ç‡çŸ©é˜µğ‘ƒP
3. **ä½ç»´åˆå§‹åŒ–**
   ï¼šéšæœºç”Ÿæˆåˆå§‹åµŒå…¥åæ ‡ğ‘ŒY
4. **æ¢¯åº¦ä¸‹é™ä¼˜åŒ–**
   ï¼šè¿­ä»£æ›´æ–°ğ‘ŒYä»¥æœ€å°åŒ–KLæ•£åº¦
5. **ç»“æœè¾“å‡º**
   ï¼šè¿”å›ä½ç»´åæ ‡çŸ©é˜µ

---

## ä¸‰ã€ä»£ç è¯¦è§£

æœ¬æ–‡çš„ä»£ç ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š

### 1. å¯¼å…¥åº“

```python
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import seaborn as sns
from sklearn import datasets
from sklearn import manifold
%matplotlib inline

```

**è¯´æ˜**
ï¼š

* `import matplotlib.pyplot as plt`
  : å¯¼å…¥matplotlibåº“ï¼Œç”¨äºç»˜åˆ¶å›¾åƒã€‚
* `import numpy as np`
  : å¯¼å…¥numpyåº“ï¼Œç”¨äºè¿›è¡Œæ•°å€¼è®¡ç®—ã€‚
* `import pandas as pd`
  : å¯¼å…¥pandasåº“ï¼Œç”¨äºæ•°æ®å¤„ç†ã€‚
* `import seaborn as sns`
  : å¯¼å…¥seabornåº“ï¼Œç”¨äºæ•°æ®å¯è§†åŒ–ã€‚
* `from sklearn import datasets`
  : å¯¼å…¥sklearnåº“ä¸­çš„datasetsæ¨¡å—ï¼Œç”¨äºåŠ è½½æ•°æ®é›†ã€‚
* `from sklearn import manifold`
  : å¯¼å…¥sklearnåº“ä¸­çš„manifoldæ¨¡å—ï¼Œç”¨äºé™ç»´ã€‚
* `%matplotlib inline`
  : åœ¨Jupyter Notebookä¸­æ˜¾ç¤ºå›¾åƒã€‚

### 2. åŠ è½½æ•°æ®

```python
# åŠ è½½æ•°æ®
data = datasets.fetch_openml('mnist_784', version=1, return_X_y=True)
pixel_values, targets = data
targets = targets.astype(int)

# å°†DataFrameè½¬æ¢ä¸ºnumpyæ•°ç»„ä»¥ä¾¿æ›´å®¹æ˜“æ“ä½œ
# å¦‚æœpixel_valueså·²ç»æ˜¯numpyæ•°ç»„ï¼Œè¿™ä¸€æ­¥å¯ä»¥è·³è¿‡
if isinstance(pixel_values, pd.DataFrame):
    pixel_values_array = pixel_values.values
else:
    pixel_values_array = pixel_values

```

**è¯´æ˜**
ï¼š

* `data = datasets.fetch_openml('mnist_784', version=1, return_X_y=True)`
  : ä½¿ç”¨
  `datasets.fetch_openml`
  å‡½æ•°åŠ è½½MNISTæ•°æ®é›†ã€‚
  `'mnist_784'`
  è¡¨ç¤ºæ•°æ®é›†çš„åç§°ï¼Œ
  `version=1`
  è¡¨ç¤ºæ•°æ®é›†çš„ç‰ˆæœ¬ï¼Œ
  `return_X_y=True`
  è¡¨ç¤ºè¿”å›è¾“å…¥æ•°æ®å’Œæ ‡ç­¾ã€‚
* `pixel_values, targets = data`
  : å°†è¿”å›çš„æ•°æ®è§£åŒ…ä¸º
  `pixel_values`
  å’Œ
  `targets`
  ã€‚
  `pixel_values`
  åŒ…å«å›¾åƒçš„åƒç´ å€¼ï¼Œ
  `targets`
  åŒ…å«å›¾åƒçš„æ ‡ç­¾ã€‚
* `targets = targets.astype(int)`
  : å°†æ ‡ç­¾è½¬æ¢ä¸ºæ•´æ•°ç±»å‹ã€‚
* `if isinstance(pixel_values, pd.DataFrame):`
  : æ£€æŸ¥
  `pixel_values`
  æ˜¯å¦ä¸ºpandas DataFrameç±»å‹ã€‚
* `pixel_values_array = pixel_values.values`
  : å¦‚æœ
  `pixel_values`
  ä¸ºpandas DataFrameç±»å‹ï¼Œåˆ™å°†å…¶è½¬æ¢ä¸ºnumpyæ•°ç»„ã€‚
* `else: pixel_values_array = pixel_values`
  : å¦åˆ™ï¼Œç›´æ¥ä½¿ç”¨
  `pixel_values`
  ã€‚

### 3. æ˜¾ç¤ºå•ä¸ªå›¾åƒ

```python
# æ˜¾ç¤ºå•ä¸ªå›¾åƒ
single_image = pixel_values_array[1].reshape(28, 28)
plt.imshow(single_image, cmap='gray')

```

**è¯´æ˜**
ï¼š

* `single_image = pixel_values_array[1].reshape(28, 28)`
  : é€‰æ‹©ç¬¬ä¸€ä¸ªå›¾åƒï¼Œå¹¶å°†å…¶reshapeä¸º28x28çš„çŸ©é˜µã€‚
* `plt.imshow(single_image, cmap='gray')`
  : ä½¿ç”¨
  `plt.imshow`
  å‡½æ•°æ˜¾ç¤ºå›¾åƒï¼Œ
  `cmap='gray'`
  è¡¨ç¤ºä½¿ç”¨ç°åº¦é¢œè‰²æ˜ å°„ã€‚

### **4.** t-SNEé™ç»´

```python
# t-SNEé™ç»´
tsne = manifold.TSNE(n_components=2, random_state=42)
transformed_data = tsne.fit_transform(pixel_values_array[:3000])

```

**è¯´æ˜**
ï¼š

* `tsne = manifold.TSNE(n_components=2, random_state=42)`
  : åˆ›å»ºä¸€ä¸ªt-SNEå¯¹è±¡ã€‚
  `n_components=2`
  è¡¨ç¤ºå°†æ•°æ®é™ç»´åˆ°äºŒç»´ç©ºé—´ï¼Œ
  `random_state=42`
  è¡¨ç¤ºè®¾ç½®éšæœºç§å­ï¼Œä¿è¯ç»“æœçš„å¯é‡å¤æ€§ã€‚
* `transformed_data = tsne.fit_transform(pixel_values_array[:3000])`
  : ä½¿ç”¨
  `fit_transform`
  å‡½æ•°å¯¹æ•°æ®è¿›è¡Œé™ç»´ã€‚è¿™é‡Œåªä½¿ç”¨äº†å‰3000ä¸ªæ ·æœ¬ï¼Œå› ä¸ºt-SNEçš„è®¡ç®—å¤æ‚åº¦è¾ƒé«˜ã€‚

### 5. åˆ›å»ºDataFrameç”¨äºå¯è§†åŒ–

```python
# åˆ›å»ºDataFrameç”¨äºå¯è§†åŒ–
tsne_df = pd.DataFrame(
    np.column_stack((transformed_data, targets[:3000])),
    columns=["x", "y", "targets"]
)
tsne_df.loc[:, "targets"] = tsne_df.targets.astype(int)

```

**è¯´æ˜**
ï¼š

* `tsne_df = pd.DataFrame(...)`
  : åˆ›å»ºä¸€ä¸ªpandas DataFrameå¯¹è±¡ï¼Œç”¨äºå­˜å‚¨é™ç»´åçš„æ•°æ®å’Œæ ‡ç­¾ã€‚
* `np.column_stack((transformed_data, targets[:3000]))`
  : å°†é™ç»´åçš„æ•°æ®å’Œæ ‡ç­¾æŒ‰åˆ—æ‹¼æ¥åœ¨ä¸€èµ·ã€‚
* `columns=["x", "y", "targets"]`
  : è®¾ç½®DataFrameçš„åˆ—åã€‚
* `tsne_df.loc[:, "targets"] = tsne_df.targets.astype(int)`
  : å°†DataFrameä¸­çš„æ ‡ç­¾è½¬æ¢ä¸ºæ•´æ•°ç±»å‹ã€‚

### 6. å¯è§†åŒ–

```python
# å¯è§†åŒ–
# æ³¨æ„ï¼šåœ¨æ–°ç‰ˆæœ¬çš„seabornä¸­ï¼Œsizeå‚æ•°å·²æ›´æ”¹ä¸ºheight
try:
    grid = sns.FacetGrid(tsne_df, hue="targets", size=8)
except TypeError:
    grid = sns.FacetGrid(tsne_df, hue="targets", height=8)
    
grid.map(plt.scatter, "x", "y").add_legend()

```

**è¯´æ˜**
ï¼š

* `grid = sns.FacetGrid(tsne_df, hue="targets", size=8)`
  : åˆ›å»ºä¸€ä¸ªseaborn FacetGridå¯¹è±¡ï¼Œç”¨äºå¯è§†åŒ–é™ç»´åçš„æ•°æ®ã€‚
  `hue="targets"`
  è¡¨ç¤ºä½¿ç”¨æ ‡ç­¾ä½œä¸ºé¢œè‰²ç¼–ç ï¼Œ
  `size=8`
  è¡¨ç¤ºè®¾ç½®å›¾åƒçš„å¤§å°ã€‚
* `grid.map(plt.scatter, "x", "y").add_legend()`
  : ä½¿ç”¨
  `plt.scatter`
  å‡½æ•°ç»˜åˆ¶æ•£ç‚¹å›¾ï¼Œ
  `"x"`
  å’Œ
  `"y"`
  è¡¨ç¤ºæ•£ç‚¹å›¾çš„æ¨ªåæ ‡å’Œçºµåæ ‡ï¼Œ
  `add_legend()`
  è¡¨ç¤ºæ·»åŠ å›¾ä¾‹ã€‚

### 7. å®Œæ•´ä»£ç 

```python
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import seaborn as sns
from sklearn import datasets
from sklearn import manifold
%matplotlib inline

# åŠ è½½æ•°æ®
data = datasets.fetch_openml('mnist_784', version=1, return_X_y=True)
pixel_values, targets = data
targets = targets.astype(int)

# å°†DataFrameè½¬æ¢ä¸ºnumpyæ•°ç»„ä»¥ä¾¿æ›´å®¹æ˜“æ“ä½œ
# å¦‚æœpixel_valueså·²ç»æ˜¯numpyæ•°ç»„ï¼Œè¿™ä¸€æ­¥å¯ä»¥è·³è¿‡
if isinstance(pixel_values, pd.DataFrame):
    pixel_values_array = pixel_values.values
else:
    pixel_values_array = pixel_values

# æ˜¾ç¤ºå•ä¸ªå›¾åƒ
single_image = pixel_values_array[1].reshape(28, 28)
plt.imshow(single_image, cmap='gray')

# t-SNEé™ç»´
tsne = manifold.TSNE(n_components=2, random_state=42)
transformed_data = tsne.fit_transform(pixel_values_array[:3000])

# åˆ›å»ºDataFrameç”¨äºå¯è§†åŒ–
tsne_df = pd.DataFrame(
    np.column_stack((transformed_data, targets[:3000])),
    columns=["x", "y", "targets"]
)
tsne_df.loc[:, "targets"] = tsne_df.targets.astype(int)

# å¯è§†åŒ–
# æ³¨æ„ï¼šåœ¨æ–°ç‰ˆæœ¬çš„seabornä¸­ï¼Œsizeå‚æ•°å·²æ›´æ”¹ä¸ºheight
try:
    grid = sns.FacetGrid(tsne_df, hue="targets", size=8)
except TypeError:
    grid = sns.FacetGrid(tsne_df, hue="targets", height=8)
    
grid.map(plt.scatter, "x", "y").add_legend()
```

![](https://i-blog.csdnimg.cn/direct/fea1ab0e85ad45c5866311bd87b3d5de.png)

![](https://i-blog.csdnimg.cn/direct/b6da1b126227437db51753060b2c1d32.png)

---

## å››ã€æ€»ç»“ä¸æ€è€ƒ

æœ¬æ–‡ä»¥MNISTæ•°æ®é›†ä¸ºä¾‹ï¼Œè¯¦ç»†ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨t-SNEè¿›è¡Œé«˜ç»´æ•°æ®å¯è§†åŒ–ã€‚é€šè¿‡t-SNEé™ç»´ï¼Œæˆ‘ä»¬å¯ä»¥å°†784ç»´çš„å›¾åƒæ•°æ®é™ç»´åˆ°äºŒç»´ç©ºé—´ï¼Œå¹¶åœ¨æ•£ç‚¹å›¾ä¸Šæ¸…æ™°åœ°çœ‹åˆ°ä¸åŒæ•°å­—ä¹‹é—´çš„åˆ†å¸ƒæƒ…å†µã€‚

t-SNEæ˜¯ä¸€ç§å¼ºå¤§çš„é™ç»´æŠ€æœ¯ï¼Œä½†ä¹Ÿæœ‰ä¸€äº›å±€é™æ€§ï¼š

* **è®¡ç®—å¤æ‚åº¦é«˜:**
  t-SNEçš„è®¡ç®—å¤æ‚åº¦ä¸ºO(n^2)ï¼Œå¯¹äºå¤§è§„æ¨¡æ•°æ®é›†ï¼Œè®¡ç®—æ—¶é—´ä¼šéå¸¸é•¿ã€‚
* **å‚æ•°æ•æ„Ÿ:**
  t-SNEçš„æ€§èƒ½å—åˆ°å‚æ•°çš„å½±å“ï¼Œä¾‹å¦‚å›°æƒ‘åº¦ (perplexity) å’Œå­¦ä¹ ç‡ (learning_rate)ã€‚
* **å…¨å±€ç»“æ„å¤±çœŸ:**
  t-SNEä¸»è¦å…³æ³¨å±€éƒ¨ç»“æ„ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…¨å±€ç»“æ„å¤±çœŸã€‚

åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®å…·ä½“æƒ…å†µé€‰æ‹©åˆé€‚çš„é™ç»´æŠ€æœ¯ã€‚å¯¹äºå¤§è§„æ¨¡æ•°æ®é›†ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨PCAæˆ–UMAPç­‰æ›´é«˜æ•ˆçš„ç®—æ³•ã€‚å¯¹äºéœ€è¦ä¿ç•™å…¨å±€ç»“æ„çš„åœºæ™¯ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨Isomapæˆ–LLEç­‰ç®—æ³•ã€‚

---

## ã€ä½œè€…å£°æ˜ã€‘

æœ¬æ–‡å†…å®¹åŸºäºä½œè€…å¯¹åŸºäºt-SNEçš„MNISTæ•°æ®é›†å¯è§†åŒ–æ¢ç´¢å®ç°è¿‡ç¨‹çš„å®éªŒä¸æ€»ç»“ï¼Œæ‰€æœ‰æ•°æ®å’Œä»£ç å‡ä¸ºåŸåˆ›ã€‚æ–‡ç« ä¸­çš„è§‚ç‚¹ä»…ä»£è¡¨ä¸ªäººè§è§£ï¼Œä¾›è¯»è€…å‚è€ƒäº¤æµã€‚è‹¥æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€è®¨è®ºï¼Œå…±åŒä¿ƒè¿›æŠ€æœ¯è¿›æ­¥ã€‚

---

## ã€å…³æ³¨æˆ‘ä»¬ã€‘

å¦‚æœæ‚¨å¯¹ç¥ç»ç½‘ç»œã€ç¾¤æ™ºèƒ½ç®—æ³•åŠäººå·¥æ™ºèƒ½æŠ€æœ¯æ„Ÿå…´è¶£ï¼Œæ¬¢è¿ç‚¹èµã€æ”¶è—å¹¶è½¬å‘ï¼Œä¸æ›´å¤šæœ‹å‹ä¸€èµ·æ¢è®¨ä¸äº¤æµï¼