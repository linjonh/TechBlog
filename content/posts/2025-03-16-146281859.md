---
layout: post
title: "Day09-实例拿到加密密文进行解密"
date: 2025-03-16 16:58:07 +0800
description: "Day09 -实例：拿到密文解密思路（可否获得源码分类）"
keywords: "Day09 -实例：拿到加密密文进行解密"
categories: ['小迪V2024全栈']
tags: ['算法', '安全性测试', '安全']
artid: "146281859"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146281859
    alt: "Day09-实例拿到加密密文进行解密"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146281859
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146281859
cover: https://bing.ee123.net/img/rand?artid=146281859
image: https://bing.ee123.net/img/rand?artid=146281859
img: https://bing.ee123.net/img/rand?artid=146281859
---

# Day09 -实例：拿到加密密文进行解密

#### 前置条件：是能入库拿到密文及带的salt。

#### 一、拿得到源码

##### 实例1：【dz3.2网站】

###### 00x1 拿到密文

#####
![](https://i-blog.csdnimg.cn/direct/ece305b9a297428cb1419a5993ea61a1.png)

pwd：1bc86728263c0d5b497fa1e0be486566

salt：e4402c

###### 00x2 打开网站文件夹 找到文件

![](https://i-blog.csdnimg.cn/direct/0d54c347cb474b33951842591d2abe33.png)

【先直接用这个路径去找，php开发架构还没讲到】

> /upload/uc_client/model/user.php

###### 00x3 代码审计找到加密逻辑

######
![](https://i-blog.csdnimg.cn/direct/3630dfc5293644baab2e04c7fcc624c3.png)00x4
根据加密逻辑进行解密

![](https://i-blog.csdnimg.cn/direct/130f0b4b27a948ac9985daf6afa57682.png)

> $password = md5(md5($password).$salt);

> pwd：1bc86728263c0d5b497fa1e0be486566
>
> salt：e4402c

加密逻辑是：先对pwd进行一次md5 --> 而后再添加上salt进行第二次md5加密

复现：

![](https://i-blog.csdnimg.cn/direct/74890c5c4e6d4c8ab3e7d0cc6da1f72a.png)

拿走第一次md5的加盐 再进行二次md5加密

![](https://i-blog.csdnimg.cn/direct/15843768b0fc45d5be7c6864fa803e2f.png)

###### 00x5 或使用在线php工具进行脚本编写

[PHP 在线工具 | 菜鸟工具](https://www.jyshare.com/compile/1/ "PHP 在线工具 | 菜鸟工具")

> <?php  
>  $password='123456';  
>  $salt='e4402c';
>
> $a=md5($password);  
>  $aa=md5($a.$salt);
>
> if($aa='1bc86728263c0d5b497fa1e0be486566'){  
>  echo 'ok';  
>  }else{  
>  echo 'no';  
>  }
>
> ?>

![](https://i-blog.csdnimg.cn/direct/71b9121c25794fde803f9d43ddfa5a26.png)

##### 实例2：【dz3.5网站】

与dz3.2同理。

###### 00x1 拿到密文

![](https://i-blog.csdnimg.cn/direct/0c6bfca337d3430f94dcbb2b9beda5de.png)

> 发现salt的值为空
>
> pwd是：
>
> $10$rzzzykB/CUmS9/NhXDQXuuD3n502rbfH./MJSzWnGaHNHVqgF5HEG

###### 00x2 打开网站根目录，找到关键文件

> 路径：/dsicuzx3.5/upload/uc_client/model/user.php

###### 00x3 代码审计找到加密逻辑

![](https://i-blog.csdnimg.cn/direct/3bb2e0419f3042408e4e51a8829f7899.png)

![](https://i-blog.csdnimg.cn/direct/b58d703ce3734213bbc44c0c186a0ce1.png)

![](https://i-blog.csdnimg.cn/direct/f090daf482c0400a91562eb84c049007.png)

不知道password_hash是什么函数，去搜；

[PHP password_hash() 函数 | 菜鸟教程](https://www.runoob.com/php/php-password_hash.html "PHP password_hash\(\) 函数 | 菜鸟教程")

发现就很像我们刚刚拿到的密文

![](https://i-blog.csdnimg.cn/direct/2a2a1c60adf64097a541c874f8de5b0d.png)

###### 00x4 用php脚本进行解密

> <?php  
>  $hash = '$2y$10$rzzzykB/CUmS9/NhXDQXuuD3n502rbfH./MJSzWnGaHNHVqgF5HEG';
>
> if (password_verify('123456',$hash)){  
>  echo 'ok';  
>  }else{  
>  echo 'error';  
>  }
>
> ?>

![](https://i-blog.csdnimg.cn/direct/99f9d84e98c14f7ab35e3d9316c90d22.png)

#### 二、拿不到源码 尝试前端抓包

【z-blog】我们还是用云服务器去进行一个zblog站点的搭建，搭建教程详见我的这一篇博客：

[Day02-阿里云服务器+宝塔集成化配置 -宝塔一键部署失败问题解决-
CSDN博客](https://blog.csdn.net/2401_84908950/article/details/146026926?spm=1001.2014.3001.5501
"Day02-阿里云服务器+宝塔集成化配置 -宝塔一键部署失败问题解决-CSDN博客")

我们搭建好后，进行后台登录，用户名：admin 密码：123456；右击检查，输入验证码后，

![](https://i-blog.csdnimg.cn/direct/641f021ed13343078df264d6c3abd437.png)

抓到了一个这个数据包，然后我们看到了密文。

![](https://i-blog.csdnimg.cn/direct/ddd8b44d3fa7441fba69ebed7d8bd2ea.png)

> e10adc3949ba59abbe56e057f20f883e

##### 思路1：根据要求密文猜是什么算法的加密

我们看这个密文的格式，就特别像32位的md5加密，我们拿去在线工具试试解密

[md5在线解密破解,md5解密加密](https://www.cmd5.com/default.aspx "md5在线解密破解,md5解密加密")

![](https://i-blog.csdnimg.cn/direct/7aec6f35c8a74df89d388f6c3d57c237.png)

##### 思路2：判断是否是前端加密，js抓包

刚刚提示输入错误的页面，我们点击返回，右键检查一下登录按钮，看一下javascript（js）的语句，我们找找看关于密码输入的处理。

![](https://i-blog.csdnimg.cn/direct/0d6cfc0874d94249b47413f7135fa844.png)

于此判断，zblog用的是前端加密，加密算法是md5。

至此，关于解密的实例演示就结束啦！最终贴一张总结的解密思路给大家。

![](https://i-blog.csdnimg.cn/direct/faaf3fd811034cee93382da300796c96.png)



