---
layout: post
title: "线性dp数字三角形,LIS,LCS,LCIS"
date: 2025-03-16 19:46:10 +0800
description: "为了提高效率，我们可以在遍历 j 的过程中维护一个最大值 mx，表示在当前 i 的情况下，所有 f [i-1] [k] 的最大值，其中 k < j 且 B[k] < A[i]。既然两个数组都是1-n的全排列，那么可以用一个新的数组c存放b[i]在数组a中的位置，只有c中递增的子序列才可构成a,b的公共子序列。包含a[i] 的子集，将这个子集继续划分,依据是子序列的倒数第二个元素在b[]中是哪个数（也就是由谁递推而来）不包含a [i]的子集，最大值是f[i-1] [j]首先判断公共子序列中是否包含a[i]"
keywords: "线性dp(数字三角形，LIS,LCS，LCIS)"
categories: ['动态规划']
tags: ['线性Dp', '算法', '数据结构', '动态规划', 'Lis', 'Lcs', 'Lcis']
artid: "146300156"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146300156
    alt: "线性dp数字三角形,LIS,LCS,LCIS"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146300156
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146300156
cover: https://bing.ee123.net/img/rand?artid=146300156
image: https://bing.ee123.net/img/rand?artid=146300156
img: https://bing.ee123.net/img/rand?artid=146300156
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     线性dp(数字三角形，LIS,LCS，LCIS)
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <h2>
     <a id="dp_1">
     </a>
     线性dp
    </h2>
    <h3>
     <a id="_3">
     </a>
     数字三角形
    </h3>
    <p>
     <a href="https://www.luogu.com.cn/problem/P1216" rel="nofollow">
      P1216 数字三角形 - 洛谷
     </a>
    </p>
    <h4>
     <a id="_7">
     </a>
     题目
    </h4>
    <p>
     观察下面的数字金字塔。
    </p>
    <p>
     写一个程序来查找从最高点到底部任意处结束的路径，使路径经过数字的和最大。每一步可以走到左下方的点也可以到达右下方的点。
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/e0df5cdb69f7887c1010b9ea91fcf320.png"/>
    </p>
    <h4>
     <a id="_16">
     </a>
     思路
    </h4>
    <p>
     每个数字只能有上方，左上，数字递推而来。最后计算最底层最大值。
    </p>
    <pre><code class="prism language-c"><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">1100</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1100</span><span class="token punctuation">]</span><span class="token punctuation">,</span>f<span class="token punctuation">[</span><span class="token number">1100</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> n<span class="token punctuation">;</span>
	cin<span class="token operator">&gt;&gt;</span>n<span class="token punctuation">;</span>
	<span class="token function">fir</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span>
	<span class="token function">fir</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cin<span class="token operator">&gt;&gt;</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">fir</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">fir</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span>
		f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">max</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>f<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">int</span> mx<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">fir</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span>
	mx<span class="token operator">=</span><span class="token function">max</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>mx<span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout<span class="token operator">&lt;&lt;</span>mx<span class="token operator">&lt;&lt;</span><span class="token char">'\n'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <ul>
     <li>
      <blockquote>
       <p>
        那如果向左和向右移动次数相差不能大于1，最大值又是多少了？
       </p>
      </blockquote>
      <p>
       <strong>
        易知，当n为偶数，最后一层落在的点一定在n/2或n/2+1.而n为奇数时，最后一层落在的点一定在n/2+1
       </strong>
      </p>
     </li>
    </ul>
    <h3>
     <a id="LIS_51">
     </a>
     LIS（最长上升子序列）
    </h3>
    <p>
     <strong>
      例题
     </strong>
    </p>
    <p>
     <a href="https://www.luogu.com.cn/problem/B3637" rel="nofollow">
      B3637 最长上升子序列 - 洛谷 | 计算机科学教育新生态
     </a>
    </p>
    <p>
     数组f【i】，用来存储以a【i】作末尾的上升子序列长度。
    </p>
    <h4>
     <a id="n2_59">
     </a>
     代码（n^2）
    </h4>
    <pre><code class="prism language-C">#include&lt;bits/stdc++.h&gt;
using namespace std;
int a[1000050],f[100050];
int main()
{
    int n,ans=1;
    cin&gt;&gt;n;
    for(int i=1;i&lt;=n;i++)
    cin&gt;&gt;a[i]; 
    fill(f,f+n+2,1);//初始化
    for(int i=2;i&lt;=n;i++)
    {
        for(int j=1;j&lt;i;j++)
        {
            if(a[j]&lt;a[i])//递增
            f[i]=max(f[i],f[j]+1);
        }
        ans=max(ans,f[i]);
    }
    cout&lt;&lt;ans&lt;&lt;'\n';
}
</code></pre>
    <h4>
     <a id="nlogn_85">
     </a>
     二分优化（nlogn）
    </h4>
    <p>
     维和一个数组b,存放上升子序列。 其中 b[i]表示长度为 i 的上升子序列的
     <strong>
      最小
     </strong>
     末尾元素。
    </p>
    <p>
     从前往后遍历数组a
    </p>
    <ul>
     <li>
      a[i]&gt;b[len]末尾元素,b[++len]=a[i]
     </li>
     <li>
      a[i]&lt;=b[len],用a[i] 替换b数组第一个&gt;=a[i]的元素
     </li>
    </ul>
    <p>
     最终b数组的长度便是答案
    </p>
    <p>
     用vector和lower_bound实现
    </p>
    <pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h&gt;</span></span>
using namespace std<span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span>a<span class="token punctuation">[</span><span class="token number">1000050</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    cin<span class="token operator">&gt;&gt;</span>n<span class="token punctuation">;</span>
    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> d<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>    cin<span class="token operator">&gt;&gt;</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">auto</span> it<span class="token operator">=</span><span class="token function">lower_bound</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>d<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>it<span class="token operator">==</span>d<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        d<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token operator">*</span>it<span class="token operator">=</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    cout<span class="token operator">&lt;&lt;</span>d<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="LCS_119">
     </a>
     LCS(最长公共子序列)
    </h3>
    <p>
     这个视频讲的不错
     <a href="https://www.bilibili.com/video/BV1EK411K7Eb?vd_source=67186f29c3efb728bcff34035cf5aba2" rel="nofollow">
      E05 线性DP 最长公共子序列
     </a>
     ，本文思路节选于此视频
    </p>
    <p>
     <strong>
      例题
     </strong>
    </p>
    <p>
     <a href="https://www.luogu.com.cn/problem/U165581" rel="nofollow">
      U165581 最长公共子序列（Longest Common Subsequence，LCS） - 洛谷 | 计算机科学教育新生态
     </a>
    </p>
    <p>
     <strong>
      设
      <code>
       f[i][j]
      </code>
      表示序列
      <code>
       a[1...i]
      </code>
      和
      <code>
       b[1...j]
      </code>
      的最长公共子序列长度。
     </strong>
    </p>
    <p>
     现在判断末尾元素
     <code>
      a[i]
     </code>
     与
     <code>
      b[j]
     </code>
     是否在公共子序列中：
    </p>
    <ol>
     <li>
      <strong>
       若
       <code>
        a[i] = b[j]
       </code>
      </strong>
      ：
      <ul>
       <li>
        则
        <code>
         a[i]
        </code>
        与
        <code>
         b[j]
        </code>
        在公共子序列中。
       </li>
       <li>
        递推关系：
        <code>
         f[i][j] = f[i-1][j-1] + 1
        </code>
       </li>
      </ul>
     </li>
     <li>
      <strong>
       若
       <code>
        a[i] ≠ b[j]
       </code>
       ，且
       <code>
        a[i]
       </code>
       不在公共子序列中
      </strong>
      ：
      <ul>
       <li>
        则可去掉
        <code>
         a[i]
        </code>
        。
       </li>
       <li>
        递推关系：
        <code>
         f[i][j] = f[i-1][j]
        </code>
       </li>
      </ul>
     </li>
     <li>
      <strong>
       若
       <code>
        a[i] ≠ b[j]
       </code>
       ，且
       <code>
        b[j]
       </code>
       不在公共子序列中
      </strong>
      ：
      <ul>
       <li>
        则可去掉
        <code>
         b[j]
        </code>
        。
       </li>
       <li>
        递推关系：
        <code>
         f[i][j] = f[i][j-1]
        </code>
       </li>
      </ul>
     </li>
    </ol>
    <p>
     <strong>
      状态转移方程
     </strong>
     ：
    </p>
    <p>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         f 
         
        
          [ 
         
        
          i 
         
        
          ] 
         
        
          [ 
         
        
          j 
         
        
          ] 
         
        
          = 
         
         
         
           { 
          
          
           
            
             
              
              
                f 
               
              
                [ 
               
              
                i 
               
              
                − 
               
              
                1 
               
              
                ] 
               
              
                [ 
               
              
                j 
               
              
                − 
               
              
                1 
               
              
                ] 
               
              
                + 
               
              
                1 
               
              
                , 
               
              
             
            
            
             
              
              
                若  
               
              
                a 
               
              
                [ 
               
              
                i 
               
              
                ] 
               
              
                = 
               
              
                b 
               
              
                [ 
               
              
                j 
               
              
                ] 
               
              
             
            
           
           
            
             
              
              
                max 
               
              
                ⁡ 
               
              
                ( 
               
              
                f 
               
              
                [ 
               
              
                i 
               
              
                − 
               
              
                1 
               
              
                ] 
               
              
                [ 
               
              
                j 
               
              
                ] 
               
              
                , 
               
              
                f 
               
              
                [ 
               
              
                i 
               
              
                ] 
               
              
                [ 
               
              
                j 
               
              
                − 
               
              
                1 
               
              
                ] 
               
              
                ) 
               
              
                , 
               
              
             
            
            
             
              
              
                若  
               
              
                a 
               
              
                [ 
               
              
                i 
               
              
                ] 
               
              
                ≠ 
               
              
                b 
               
              
                [ 
               
              
                j 
               
              
                ] 
               
              
             
            
           
          
         
        
       
         f[i][j] = \begin{cases} f[i-1][j-1] + 1, &amp; \text{若 } a[i] = b[j] \\ \max(f[i-1][j], f[i][j-1]), &amp; \text{若 } a[i] \neq b[j] \end{cases}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.1076em;">
           f
          </span>
          <span class="mopen">
           [
          </span>
          <span class="mord mathnormal">
           i
          </span>
          <span class="mclose">
           ]
          </span>
          <span class="mopen">
           [
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0572em;">
           j
          </span>
          <span class="mclose">
           ]
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 3em; vertical-align: -1.25em;">
          </span>
          <span class="minner">
           <span class="mopen delimcenter" style="top: 0em;">
            <span class="delimsizing size4">
             {
             <!-- -->
            </span>
           </span>
           <span class="mord">
            <span class="mtable">
             <span class="col-align-l">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 1.69em;">
                 <span class="" style="top: -3.69em;">
                  <span class="pstrut" style="height: 3.008em;">
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal" style="margin-right: 0.1076em;">
                    f
                   </span>
                   <span class="mopen">
                    [
                   </span>
                   <span class="mord mathnormal">
                    i
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mbin">
                    −
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mord">
                    1
                   </span>
                   <span class="mclose">
                    ]
                   </span>
                   <span class="mopen">
                    [
                   </span>
                   <span class="mord mathnormal" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mbin">
                    −
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mord">
                    1
                   </span>
                   <span class="mclose">
                    ]
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mbin">
                    +
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mord">
                    1
                   </span>
                   <span class="mpunct">
                    ,
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -2.25em;">
                  <span class="pstrut" style="height: 3.008em;">
                  </span>
                  <span class="mord">
                   <span class="mop">
                    max
                   </span>
                   <span class="mopen">
                    (
                   </span>
                   <span class="mord mathnormal" style="margin-right: 0.1076em;">
                    f
                   </span>
                   <span class="mopen">
                    [
                   </span>
                   <span class="mord mathnormal">
                    i
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mbin">
                    −
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mord">
                    1
                   </span>
                   <span class="mclose">
                    ]
                   </span>
                   <span class="mopen">
                    [
                   </span>
                   <span class="mord mathnormal" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="mclose">
                    ]
                   </span>
                   <span class="mpunct">
                    ,
                   </span>
                   <span class="mspace" style="margin-right: 0.1667em;">
                   </span>
                   <span class="mord mathnormal" style="margin-right: 0.1076em;">
                    f
                   </span>
                   <span class="mopen">
                    [
                   </span>
                   <span class="mord mathnormal">
                    i
                   </span>
                   <span class="mclose">
                    ]
                   </span>
                   <span class="mopen">
                    [
                   </span>
                   <span class="mord mathnormal" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mbin">
                    −
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mord">
                    1
                   </span>
                   <span class="mclose">
                    ])
                   </span>
                   <span class="mpunct">
                    ,
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 ​
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 1.19em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="arraycolsep" style="width: 1em;">
             </span>
             <span class="col-align-l">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 1.69em;">
                 <span class="" style="top: -3.69em;">
                  <span class="pstrut" style="height: 3.008em;">
                  </span>
                  <span class="mord">
                   <span class="mord text">
                    <span class="mord cjk_fallback">
                     若
                    </span>
                    <span class="mord">
                    </span>
                   </span>
                   <span class="mord mathnormal">
                    a
                   </span>
                   <span class="mopen">
                    [
                   </span>
                   <span class="mord mathnormal">
                    i
                   </span>
                   <span class="mclose">
                    ]
                   </span>
                   <span class="mspace" style="margin-right: 0.2778em;">
                   </span>
                   <span class="mrel">
                    =
                   </span>
                   <span class="mspace" style="margin-right: 0.2778em;">
                   </span>
                   <span class="mord mathnormal">
                    b
                   </span>
                   <span class="mopen">
                    [
                   </span>
                   <span class="mord mathnormal" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="mclose">
                    ]
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -2.25em;">
                  <span class="pstrut" style="height: 3.008em;">
                  </span>
                  <span class="mord">
                   <span class="mord text">
                    <span class="mord cjk_fallback">
                     若
                    </span>
                    <span class="mord">
                    </span>
                   </span>
                   <span class="mord mathnormal">
                    a
                   </span>
                   <span class="mopen">
                    [
                   </span>
                   <span class="mord mathnormal">
                    i
                   </span>
                   <span class="mclose">
                    ]
                   </span>
                   <span class="mspace" style="margin-right: 0.2778em;">
                   </span>
                   <span class="mrel">
                    <span class="mrel">
                     <span class="mord vbox">
                      <span class="thinbox">
                       <span class="rlap">
                        <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
                        </span>
                        <span class="inner">
                         <span class="mord">
                          <span class="mrel">
                           
                          </span>
                         </span>
                        </span>
                        <span class="fix">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                    <span class="mrel">
                     =
                    </span>
                   </span>
                   <span class="mspace" style="margin-right: 0.2778em;">
                   </span>
                   <span class="mord mathnormal">
                    b
                   </span>
                   <span class="mopen">
                    [
                   </span>
                   <span class="mord mathnormal" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="mclose">
                    ]
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 ​
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 1.19em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mclose nulldelimiter">
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     <strong>
      边界条件
     </strong>
     ：
    </p>
    <p>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        f 
        
       
         [ 
        
       
         0 
        
       
         ] 
        
       
         [ 
        
       
         j 
        
       
         ] 
        
       
         = 
        
       
         0 
        
       
         ; 
        
       
         f 
        
       
         [ 
        
       
         i 
        
       
         ] 
        
       
         [ 
        
       
         0 
        
       
         ] 
        
       
         = 
        
       
         0 
        
       
         ; 
        
       
      
        f[0][j]=0;f[i][0]=0;
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1076em;">
          f
         </span>
         <span class="mopen">
          [
         </span>
         <span class="mord">
          0
         </span>
         <span class="mclose">
          ]
         </span>
         <span class="mopen">
          [
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0572em;">
          j
         </span>
         <span class="mclose">
          ]
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          0
         </span>
         <span class="mpunct">
          ;
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1076em;">
          f
         </span>
         <span class="mopen">
          [
         </span>
         <span class="mord mathnormal">
          i
         </span>
         <span class="mclose">
          ]
         </span>
         <span class="mopen">
          [
         </span>
         <span class="mord">
          0
         </span>
         <span class="mclose">
          ]
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8389em; vertical-align: -0.1944em;">
         </span>
         <span class="mord">
          0
         </span>
         <span class="mpunct">
          ;
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <h4>
     <a id="_156">
     </a>
     代码
    </h4>
    <pre><code class="prism language-c"><span class="token keyword">int</span> n<span class="token punctuation">,</span>f<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>   string a<span class="token punctuation">,</span>b<span class="token punctuation">;</span>
	cin<span class="token operator">&gt;&gt;</span>a<span class="token operator">&gt;&gt;</span>b<span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>a<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>b<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>b<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
		f<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span>
		f<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">max</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>f<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
     cout<span class="token operator">&lt;&lt;</span>f<span class="token punctuation">[</span>a<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span>b<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="LCSLIS_177">
     </a>
     LCS——&gt;&gt;LIS
    </h3>
    <p>
     <strong>
      例题
     </strong>
    </p>
    <p>
     <a href="https://www.luogu.com.cn/problem/P1439" rel="nofollow">
      P1439 【模板】最长公共子序列 - 洛谷
     </a>
    </p>
    <h4>
     <a id="_183">
     </a>
     思路
    </h4>
    <p>
     此题特殊之处在于：
     <strong>
      全排列
     </strong>
    </p>
    <p>
     数据范围大，N^2不行
    </p>
    <p>
     既然两个数组都是1-n的全排列，那么可以用一个新的数组c存放b[i]在数组a中的位置，只有c中递增的子序列才可构成a,b的公共子序列。这样题目就转化为求最长上升子序列了
    </p>
    <h4>
     <a id="_191">
     </a>
     代码
    </h4>
    <pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h&gt;</span></span>
using namespace std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> N<span class="token operator">=</span><span class="token number">1e5</span><span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span>a<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span>b<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span>c<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>   cin<span class="token operator">&gt;&gt;</span>n<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
    	 cin<span class="token operator">&gt;&gt;</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    	 b<span class="token punctuation">[</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">=</span>i<span class="token punctuation">;</span><span class="token comment">//哈希</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
   <span class="token punctuation">{<!-- --></span> <span class="token keyword">int</span> x<span class="token punctuation">;</span>
   	 cin<span class="token operator">&gt;&gt;</span>x<span class="token punctuation">;</span>
   	 c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>b<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//LCS——&gt;LIS</span>
    <span class="token punctuation">}</span>
    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> v<span class="token punctuation">;</span><span class="token comment">//二分优化的最长上升子序列</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
    	<span class="token keyword">auto</span> it<span class="token operator">=</span><span class="token function">lower_bound</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>v<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token keyword">if</span><span class="token punctuation">(</span>it<span class="token operator">==</span>v<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> v<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token keyword">else</span> <span class="token operator">*</span>it<span class="token operator">=</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    cout<span class="token operator">&lt;&lt;</span>v<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="_225">
     </a>
     最长公共子串
    </h3>
    <ul>
     <li>
      <p>
       公共子串：字符必须是连续相等的
      </p>
     </li>
     <li>
      <p>
       公共子序列：字符必须是相等的，可以不连续
      </p>
      <p>
       <strong>
        设
        <code>
         f[i][j]
        </code>
        表示序列
        <code>
         a[1...i]
        </code>
        和
        <code>
         b[1...j]
        </code>
        的最长公共子串长度。
       </strong>
      </p>
     </li>
    </ul>
    <p>
     与最长公共子序列类似，递推公式有所不同。
     <br/>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         f 
         
        
          [ 
         
        
          i 
         
        
          ] 
         
        
          [ 
         
        
          j 
         
        
          ] 
         
        
          = 
         
         
         
           { 
          
          
           
            
             
              
              
                f 
               
              
                [ 
               
              
                i 
               
              
                − 
               
              
                1 
               
              
                ] 
               
              
                [ 
               
              
                j 
               
              
                − 
               
              
                1 
               
              
                ] 
               
              
                + 
               
              
                1 
               
              
                , 
               
              
             
            
            
             
              
              
                若  
               
              
                a 
               
              
                [ 
               
              
                i 
               
              
                ] 
               
              
                = 
               
              
                b 
               
              
                [ 
               
              
                j 
               
              
                ] 
               
              
             
            
           
           
            
             
              
              
                  
               
              
                0 
               
              
                ， 
               
              
             
            
            
             
              
              
                若  
               
              
                a 
               
              
                [ 
               
              
                i 
               
              
                ] 
               
              
                ≠ 
               
              
                b 
               
              
                [ 
               
              
                j 
               
              
                ] 
               
              
             
            
           
          
         
        
       
         f[i][j] = \begin{cases} f[i-1][j-1] + 1, &amp; \text{若 } a[i] = b[j] \\\ 0， &amp; \text{若 } a[i] \neq b[j]\end{cases}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.1076em;">
           f
          </span>
          <span class="mopen">
           [
          </span>
          <span class="mord mathnormal">
           i
          </span>
          <span class="mclose">
           ]
          </span>
          <span class="mopen">
           [
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0572em;">
           j
          </span>
          <span class="mclose">
           ]
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 3em; vertical-align: -1.25em;">
          </span>
          <span class="minner">
           <span class="mopen delimcenter" style="top: 0em;">
            <span class="delimsizing size4">
             {
             <!-- -->
            </span>
           </span>
           <span class="mord">
            <span class="mtable">
             <span class="col-align-l">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 1.69em;">
                 <span class="" style="top: -3.69em;">
                  <span class="pstrut" style="height: 3.008em;">
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal" style="margin-right: 0.1076em;">
                    f
                   </span>
                   <span class="mopen">
                    [
                   </span>
                   <span class="mord mathnormal">
                    i
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mbin">
                    −
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mord">
                    1
                   </span>
                   <span class="mclose">
                    ]
                   </span>
                   <span class="mopen">
                    [
                   </span>
                   <span class="mord mathnormal" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mbin">
                    −
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mord">
                    1
                   </span>
                   <span class="mclose">
                    ]
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mbin">
                    +
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mord">
                    1
                   </span>
                   <span class="mpunct">
                    ,
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -2.25em;">
                  <span class="pstrut" style="height: 3.008em;">
                  </span>
                  <span class="mord">
                   <span class="mspace">
                   </span>
                   <span class="mord">
                    0
                   </span>
                   <span class="mord cjk_fallback">
                    ，
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 ​
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 1.19em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="arraycolsep" style="width: 1em;">
             </span>
             <span class="col-align-l">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 1.69em;">
                 <span class="" style="top: -3.69em;">
                  <span class="pstrut" style="height: 3.008em;">
                  </span>
                  <span class="mord">
                   <span class="mord text">
                    <span class="mord cjk_fallback">
                     若
                    </span>
                    <span class="mord">
                    </span>
                   </span>
                   <span class="mord mathnormal">
                    a
                   </span>
                   <span class="mopen">
                    [
                   </span>
                   <span class="mord mathnormal">
                    i
                   </span>
                   <span class="mclose">
                    ]
                   </span>
                   <span class="mspace" style="margin-right: 0.2778em;">
                   </span>
                   <span class="mrel">
                    =
                   </span>
                   <span class="mspace" style="margin-right: 0.2778em;">
                   </span>
                   <span class="mord mathnormal">
                    b
                   </span>
                   <span class="mopen">
                    [
                   </span>
                   <span class="mord mathnormal" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="mclose">
                    ]
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -2.25em;">
                  <span class="pstrut" style="height: 3.008em;">
                  </span>
                  <span class="mord">
                   <span class="mord text">
                    <span class="mord cjk_fallback">
                     若
                    </span>
                    <span class="mord">
                    </span>
                   </span>
                   <span class="mord mathnormal">
                    a
                   </span>
                   <span class="mopen">
                    [
                   </span>
                   <span class="mord mathnormal">
                    i
                   </span>
                   <span class="mclose">
                    ]
                   </span>
                   <span class="mspace" style="margin-right: 0.2778em;">
                   </span>
                   <span class="mrel">
                    <span class="mrel">
                     <span class="mord vbox">
                      <span class="thinbox">
                       <span class="rlap">
                        <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
                        </span>
                        <span class="inner">
                         <span class="mord">
                          <span class="mrel">
                           
                          </span>
                         </span>
                        </span>
                        <span class="fix">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                    <span class="mrel">
                     =
                    </span>
                   </span>
                   <span class="mspace" style="margin-right: 0.2778em;">
                   </span>
                   <span class="mord mathnormal">
                    b
                   </span>
                   <span class="mopen">
                    [
                   </span>
                   <span class="mord mathnormal" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="mclose">
                    ]
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 ​
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 1.19em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mclose nulldelimiter">
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     最长公共子串不一定是以n,m结尾的，需要比较出最大值。
    </p>
    <h3>
     <a id="LCIS_241">
     </a>
     最长公共上升子序列（LCIS）
    </h3>
    <p>
     这是LIS和LCS的结合。
    </p>
    <p>
     <strong>
      动态规划状态转移
     </strong>
    </p>
    <ol>
     <li>
      <p>
       <strong>
        初始化
       </strong>
       ：我们初始化一个二维数组 f，大小为 (n+1) x (n+1)，并将所有元素初始化为 0。这里 n 是序列 A 和 B 的长度。
      </p>
     </li>
     <li>
      <p>
       <strong>
        状态转移
       </strong>
       ：
      </p>
      <p>
       首先判断公共子序列中是否包含a[i]
      </p>
      <ul>
       <li>
        <p>
         不包含a [i]的子集，最大值是f[i-1] [j]
        </p>
       </li>
       <li>
        <p>
         包含a[i] 的子集，将这个子集继续划分,依据是子序列的倒数第二个元素在b[]中是哪个数（也就是由谁递推而来）
        </p>
        <p>
         所以需要一个mx，来记录在当前
         <code>
          i
         </code>
         的条件下，满足
         <code>
          a[i] &gt; b[k]
         </code>
         的
         <code>
          f[i - 1][k] + 1
         </code>
         的前缀最大值。
        </p>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        优化
       </strong>
       ：为了提高效率，我们可以在遍历 j 的过程中维护一个最大值 mx，表示在当前 i 的情况下，所有 f [i-1] [k] 的最大值，其中 k &lt; j 且 B[k] &lt; A[i]。这样，我们就可以在 O(1) 的时间更新 f[i][j]。
      </p>
     </li>
    </ol>
    <ul>
     <li>
      <code>
       f[i][j]
      </code>
      表示所有
      <code>
       a[1 ~ i]
      </code>
      和
      <code>
       b[1 ~ j]
      </code>
      中以
      <code>
       b[j]
      </code>
      结尾的公共上升子序列的长度最大值。
     </li>
     <li>
      <code>
       mx
      </code>
      用于记录在当前
      <code>
       i
      </code>
      的条件下，满足
      <code>
       a[i] &gt; b[k]
      </code>
      的
      <code>
       f[i - 1][k] + 1
      </code>
      的前缀最大值。
     </li>
     <li>
      下面代码是一维优化后的代码
     </li>
    </ul>
    <pre><code class="prism language-c"><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">3050</span><span class="token punctuation">]</span><span class="token punctuation">,</span>b<span class="token punctuation">[</span><span class="token number">3050</span><span class="token punctuation">]</span><span class="token punctuation">,</span>f<span class="token punctuation">[</span><span class="token number">3050</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> n<span class="token punctuation">,</span>mx<span class="token punctuation">;</span>
	cin<span class="token operator">&gt;&gt;</span>n<span class="token punctuation">;</span>
	<span class="token function">fir</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span>
	cin<span class="token operator">&gt;&gt;</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">fir</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span>
	cin<span class="token operator">&gt;&gt;</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">fir</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token comment">//只看前i个</span>
	<span class="token punctuation">{<!-- --></span>
		mx<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token function">fir</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>b<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">max</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span>mx<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&gt;</span>b<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> mx<span class="token operator">=</span><span class="token function">max</span><span class="token punctuation">(</span>mx<span class="token punctuation">,</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	mx<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">fir</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span>
	mx<span class="token operator">=</span><span class="token function">max</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>mx<span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout<span class="token operator">&lt;&lt;</span>mx<span class="token operator">&lt;&lt;</span><span class="token char">'\n'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>  
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323330315f38313639323733392f:61727469636c652f64657461696c732f313436333030313536" class_="artid" style="display:none">
 </p>
</div>


