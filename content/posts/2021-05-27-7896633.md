---
layout: post
title: "Android在游戏的SurfaceView中获取输入与使用EditText,Spinner等控件的方法"
date: 2021-05-27 14:17:52 +0800
description: "游戏中有时候需要玩家输入信息，选择信息。在普通的Android程序里面，可以使用EditText，S"
keywords: "spinner获取输入框"
categories: ['游戏开发', '手机游戏', 'Android']
tags: ['网络', '游戏', '工作', 'Ui', 'Service', 'Android']
artid: "7896633"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=7896633
    alt: "Android在游戏的SurfaceView中获取输入与使用EditText,Spinner等控件的方法"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=7896633
featuredImagePreview: https://bing.ee123.net/img/rand?artid=7896633
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     [Android]在游戏的SurfaceView中获取输入与使用EditText,Spinner等控件的方法
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <div>
     <p>
      游戏中有时候需要玩家输入信息，选择信息。在普通的
      <span style="font-family:'Times New Roman'">
       Android
      </span>
      <span style="font-family:宋体">
       程序里面，可以使用
      </span>
      <span style="font-family:Times New Roman">
       EditText
      </span>
      <span style="font-family:宋体">
       ，
      </span>
      <span style="font-family:Times New Roman">
       Spinner
      </span>
      <span style="font-family:宋体">
       等输入控件方便地实现这些功能。但是，一般游戏是使用
      </span>
      <span style="font-family:Times New Roman">
       SurfaceView
      </span>
      <span style="font-family:宋体">
       ，所有的东西都是自己绘制。所以加入控件有些不伦不类。而且
      </span>
      <span style="font-family:Times New Roman">
       SurfaceView
      </span>
      <span style="font-family:宋体">
       属于
      </span>
      <span style="font-family:Times New Roman">
       View
      </span>
      <span style="font-family:宋体">
       ，本身是不能追加的控件的。我在网络上找了许多文件，一般来说提到了一个方法在外面使用布局。但说到底还是不伦不类。而且使游戏的
      </span>
      <span style="font-family:Times New Roman">
       UI
      </span>
      <span style="font-family:宋体">
       变得复杂。我想，做为一个游戏开发者，想要的应该是
      </span>
      一个获取输入的机制。
     </p>
     <p>
     </p>
     <p>
      我在网上找了许多资料，没有一个资料实际上解决了这个问题。有些文件介绍到了使用BaseConnectionInput
      <span style="font-family:宋体">
       加
      </span>
      <span style="font-family:Times New Roman">
       InputMethodManager
      </span>
      <span style="font-family:宋体">
       来使
      </span>
      <span style="font-family:Times New Roman">
       SurfaceView
      </span>
      <span style="font-family:宋体">
       获得输入，这个方法被到处转，但实际上不起作用。到最后，我在一个老外的网站上找到了答案，要使用以上的方法来使控件获取输入，这个控件至少是继承自
      </span>
      <span style="font-family:Times New Roman">
       TextView
      </span>
      <span style="font-family:宋体">
       这种“具有接受输入能力”的控件。但既然继承了
      </span>
      <span style="font-family:Times New Roman">
       SurfaceView
      </span>
      <span style="font-family:宋体">
       ，那这就不一个选择了。
      </span>
     </p>
     <p>
     </p>
     <p>
      到最后没办法，我想了一个旁门左道来解决这个问题。我称为“
      <span style="font-size:18px; color:#ff0000">
       <strong>
        代理机制
       </strong>
      </span>
      ”。这实际上不是通过
      <span style="font-family:Times New Roman">
       SurfaceView
      </span>
      <span style="font-family:宋体">
       获得输入，但是能够工作得很好。
      </span>
     </p>
     <p>
     </p>
     <p>
      首先，关于使用
      <span style="font-family:Times New Roman">
       EditText
      </span>
      <span style="font-family:宋体">
       的问题。游戏中需要获取玩家的输入，这是最关键的。其它的控件都可以使用点击事件来处理，只有这个最麻烦，需要键盘。要实现这个，需要几步。
      </span>
     </p>
     <p>
     </p>
     <p>
      <span style="font-size:18px; color:#3366ff">
       <strong>
        1、建立一个自己的
        <span style="font-family:Times New Roman">
         EditText
        </span>
        <span style="font-family:宋体">
         。
        </span>
       </strong>
      </span>
     </p>
     <p>
      这个很简单，人人都会做。继承
      <span style="font-family:Times New Roman">
       EditText
      </span>
      <span style="font-family:宋体">
       ，复写
      </span>
      <span style="font-family:Times New Roman">
       draw
      </span>
      <span style="font-family:宋体">
       方法，复写
      </span>
      <span style="font-family:Times New Roman">
       draw
      </span>
      <span style="font-family:宋体">
       方法直接就使他变成空函数，什么都不做。增加一个自己的
      </span>
      <span style="font-family:Times New Roman">
       TextWatcher
      </span>
      <span style="font-family:宋体">
       类用于处理文本改变后的逻辑。
      </span>
     </p>
     <p>
     </p>
     <p>
     </p>
     <p>
      <span style="font-size:18px; color:#3366ff">
       <strong>
        2、将自己的
        <span style="font-family:Times New Roman">
         EditText
        </span>
        <span style="font-family:宋体">
         添加到
        </span>
        ContentView中。
       </strong>
      </span>
     </p>
     <p>
      一般使用
      <span style="font-family:Times New Roman">
       SurfaceView
      </span>
      <span style="font-family:宋体">
       是通过如下的方法：
      </span>
     </p>
     <p>
      SurfaceView gameSurface = new SurfaceView(this);
     </p>
     <p>
      setContentView(gameSurface );
     </p>
     <p>
      在后面加上：
     </p>
     <p>
      EditText myEdit = new MyEditText(this);
     </p>
     <p>
      addContentView(myEdit);
     </p>
     <p>
      使
      <span style="font-family:Times New Roman">
       myEdit
      </span>
      <span style="font-family:宋体">
       成为主
      </span>
      <span style="font-family:Times New Roman">
       Activity
      </span>
      <span style="font-family:宋体">
       的一个
      </span>
      <span style="font-family:Times New Roman">
       ContentView
      </span>
      <span style="font-family:宋体">
       。但是，你在主界面看不到它。因为它的
      </span>
      <span style="font-family:Times New Roman">
       draw
      </span>
      <span style="font-family:宋体">
       方法被你重写成不绘制任何东西了。他除了看不见之外，其它功能都是完好的。
      </span>
     </p>
     <p>
      有人会问，用
      <span style="font-family:Times New Roman">
       setVisibility(View.GONE)
      </span>
      <span style="font-family:宋体">
       把它配置成看不见行吗？不行，不知道为什么，这样它的功能就失效了。也许是因为它无法获得焦点或是其它什么原因。
      </span>
     </p>
     <p>
     </p>
     <p>
      <strong>
       <span style="font-size:18px; color:#3366ff">
        3、使用输入代理。
       </span>
      </strong>
     </p>
     <p>
      在你需要输入的时候，使你的
      <span style="font-family:Times New Roman">
       EditText
      </span>
      <span style="font-family:宋体">
       获得焦点，然后使用
      </span>
      InputMethodManager打开软键盘。这样就大功造成了。其它的业务处理逻辑都在
      <span style="font-family:Times New Roman">
       TextWatcher
      </span>
      <span style="font-family:宋体">
       中处理就行了。关于
      </span>
      InputMethodManager的使用可以在网上查找，我就不详细介绍了。
     </p>
     <p>
      public void openEditAgent(){
      <!-- -->
     </p>
     <p>
      myEdit.requestFocus();
     </p>
     <p>
      InputMethodManager input  = (InputMethodManager) context.getSystemService( Context.INPUT_METHOD_SERVICE);
     </p>
     <p>
      input.toggleSoftInput(0, InputMethodManager.SHOW_FORCED);
     </p>
     <p>
      }
     </p>
     <p>
     </p>
     <p>
     </p>
     <p>
      <br/>
     </p>
     <p>
      关于
      <span style="font-family:Times New Roman">
       Spinner
      </span>
      <span style="font-family:宋体">
       的使用也是如于同样的原理。
      </span>
      <span style="font-family:Times New Roman">
       1
      </span>
      <span style="font-family:宋体">
       、继承，然后复写
      </span>
      <span style="font-family:Times New Roman">
       draw
      </span>
      <span style="font-family:宋体">
       方法，使它看不见。
      </span>
      <span style="font-family:Times New Roman">
       2
      </span>
      <span style="font-family:宋体">
       、使用
      </span>
      <span style="font-family:Times New Roman">
       addContentView
      </span>
      <span style="font-family:宋体">
       加入到主
      </span>
      <span style="font-family:Times New Roman">
       Activity
      </span>
      <span style="font-family:宋体">
       。
      </span>
      <span style="font-family:Times New Roman">
       3
      </span>
      <span style="font-family:宋体">
       、调用。
      </span>
      <span style="font-family:Times New Roman">
       Spinner
      </span>
      <span style="font-family:宋体">
       的调用比
      </span>
      <span style="font-family:Times New Roman">
       EditText
      </span>
      <span style="font-family:宋体">
       简单，只需要模拟点击就行了。
      </span>
     </p>
     <p>
      public void openSpinnerAgent(){
      <!-- -->
     </p>
     <p>
      mySpinner.requestFocus();
     </p>
     <p>
      mySpinner.performClick();
     </p>
     <p>
      }
     </p>
     <p>
      这样，你就可以使用
      <span style="font-family:Times New Roman">
       Spinner
      </span>
      <span style="font-family:宋体">
       控件来完成游戏中要求的输入。当然，你也可以如法炮制其它控件的使用。
      </span>
     </p>
     <p>
      <span style="font-family:宋体">
       这是使用Spinner来获取输入时的样子。EditText不截图和平时使用一样把整个屏幕占了。
      </span>
     </p>
     <p>
      <span style="font-family:宋体">
       <img alt="" src="https://img-my.csdn.net/uploads/201208/22/1345630369_8015.png">
        <br/>
       </img>
      </span>
     </p>
     <p>
     </p>
    </div>
   </div>
  </div>
 </article>
 <p alt="68:747470733a2f2f626c6f672e6373646e2e6e65742f65727869:6a2f61727469636c652f64657461696c732f37383936363333" class_="artid" style="display:none">
 </p>
</div>


