---
layout: post
title: "Lineageos-22.1Android-15通知栏添加截图开关"
date: 2025-03-10 00:16:55 +0800
description: "通知栏添加截图要注意一个问题，就是截图的时候要关闭通知栏，不然就直接截图通知栏了，然后就没有意义了。在下面的路径下添加开关，使用dagger注解注入即可。lineageos/frameworks/base/packages/SystemUI/src/com/android/systemui/qs/tiles/加上finishi方法的回调lineageos/frameworks/base/packages/SystemUI/src/com/android/systemui/shade/Notificat"
keywords: "Lineageos 22.1(Android 15)通知栏添加截图开关"
categories: ['Lineageos', 'Android15Rom定制']
tags: ['Lineageos', 'Android', 'Android', '15']
artid: "146141471"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146141471
    alt: "Lineageos-22.1Android-15通知栏添加截图开关"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146141471
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146141471
cover: https://bing.ee123.net/img/rand?artid=146141471
image: https://bing.ee123.net/img/rand?artid=146141471
img: https://bing.ee123.net/img/rand?artid=146141471
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Lineageos 22.1(Android 15)通知栏添加截图开关
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="_0">
     </a>
     一、前言
    </h3>
    <p>
     通知栏添加截图要注意一个问题，就是截图的时候要关闭通知栏，不然就直接截图通知栏了，然后就没有意义了。
    </p>
    <h3>
     <a id="_4">
     </a>
     二、添加快捷开关
    </h3>
    <p>
     在下面的路径下添加开关，使用dagger注解注入即可。
     <br/>
     lineageos/frameworks/base/packages/SystemUI/src/com/android/systemui/qs/tiles/
    </p>
    <pre><code class="prism language-java"><span class="token comment">/*
 * Copyright (C) 2014 The Android Open Source Project
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License
 */</span>

<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">android<span class="token punctuation">.</span>content<span class="token punctuation">.</span></span><span class="token class-name">Intent</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">android<span class="token punctuation">.</span>os<span class="token punctuation">.</span></span><span class="token class-name">Handler</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">android<span class="token punctuation">.</span>os<span class="token punctuation">.</span></span><span class="token class-name">Looper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">android<span class="token punctuation">.</span>provider<span class="token punctuation">.</span></span><span class="token class-name">MediaStore</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">android<span class="token punctuation">.</span>service<span class="token punctuation">.</span>quicksettings<span class="token punctuation">.</span></span><span class="token class-name">Tile</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>logging<span class="token punctuation">.</span></span><span class="token class-name">MetricsLogger</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ScreenshotHelper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>animation<span class="token punctuation">.</span></span><span class="token class-name">Expandable</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>dagger<span class="token punctuation">.</span>qualifiers<span class="token punctuation">.</span></span><span class="token class-name">Background</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>dagger<span class="token punctuation">.</span>qualifiers<span class="token punctuation">.</span></span><span class="token class-name">Main</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span></span><span class="token class-name">ActivityStarter</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span></span><span class="token class-name">FalsingManager</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span>qs<span class="token punctuation">.</span></span><span class="token class-name">QSTile</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span>statusbar<span class="token punctuation">.</span></span><span class="token class-name">StatusBarStateController</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span></span><span class="token class-name">QSHost</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span></span><span class="token class-name">QsEventLogger</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>logging<span class="token punctuation">.</span></span><span class="token class-name">QSLogger</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tileimpl<span class="token punctuation">.</span></span><span class="token class-name">QSTileImpl</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>res<span class="token punctuation">.</span></span><span class="token class-name">R</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>shade<span class="token punctuation">.</span></span><span class="token class-name">NotificationPanelViewController</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>inject<span class="token punctuation">.</span></span><span class="token class-name">Inject</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">androidx<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Nullable</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">dagger<span class="token punctuation">.</span></span><span class="token class-name">Lazy</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token import static"><span class="token namespace">android<span class="token punctuation">.</span>view<span class="token punctuation">.</span></span><span class="token class-name">WindowManager</span><span class="token punctuation">.</span><span class="token class-name">ScreenshotSource</span><span class="token punctuation">.</span><span class="token static">SCREENSHOT_ACCESSIBILITY_ACTIONS</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>res<span class="token punctuation">.</span></span><span class="token class-name">R</span><span class="token punctuation">.</span>string<span class="token punctuation">.</span>quick_settings_flashlight_label<span class="token punctuation">;</span>

<span class="token comment">/**
 * Quick settings tile: Control flashlight
 **/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ScreenShotTile</span> <span class="token keyword">extends</span> <span class="token class-name">QSTileImpl</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">QSTile<span class="token punctuation">.</span>State</span><span class="token punctuation">&gt;</span></span>  <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">TILE_SPEC</span> <span class="token operator">=</span> <span class="token string">"screenshot"</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ScreenshotHelper</span> mScreenshotHelper<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Lazy</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">NotificationPanelViewController</span><span class="token punctuation">&gt;</span></span> mShadeViewControllerLazy<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">boolean</span> requestScreenShot<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Inject</span>
    <span class="token keyword">public</span> <span class="token class-name">ScreenShotTile</span><span class="token punctuation">(</span>
            <span class="token class-name">QSHost</span> host<span class="token punctuation">,</span>
            <span class="token class-name">QsEventLogger</span> uiEventLogger<span class="token punctuation">,</span>
            <span class="token annotation punctuation">@Background</span> <span class="token class-name">Looper</span> backgroundLooper<span class="token punctuation">,</span>
            <span class="token annotation punctuation">@Main</span> <span class="token class-name">Handler</span> mainHandler<span class="token punctuation">,</span>
            <span class="token class-name">FalsingManager</span> falsingManager<span class="token punctuation">,</span>
            <span class="token class-name">MetricsLogger</span> metricsLogger<span class="token punctuation">,</span>
            <span class="token class-name">StatusBarStateController</span> statusBarStateController<span class="token punctuation">,</span>
            <span class="token class-name">ActivityStarter</span> activityStarter<span class="token punctuation">,</span>
            <span class="token class-name">QSLogger</span> qsLogger<span class="token punctuation">,</span>
            <span class="token class-name">Lazy</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">NotificationPanelViewController</span><span class="token punctuation">&gt;</span></span> shadeViewControllerLazy
    <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> uiEventLogger<span class="token punctuation">,</span> backgroundLooper<span class="token punctuation">,</span> mainHandler<span class="token punctuation">,</span> falsingManager<span class="token punctuation">,</span> metricsLogger<span class="token punctuation">,</span>
                statusBarStateController<span class="token punctuation">,</span> activityStarter<span class="token punctuation">,</span> qsLogger<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mScreenshotHelper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ScreenshotHelper</span><span class="token punctuation">(</span>mContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mShadeViewControllerLazy <span class="token operator">=</span> shadeViewControllerLazy<span class="token punctuation">;</span>
        mShadeViewControllerLazy<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setIOnPannelExpandListener</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>requestScreenShot<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>

                mScreenshotHelper<span class="token punctuation">.</span><span class="token function">takeScreenshot</span><span class="token punctuation">(</span>
                        <span class="token constant">SCREENSHOT_ACCESSIBILITY_ACTIONS</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Handler</span><span class="token punctuation">(</span><span class="token class-name">Looper</span><span class="token punctuation">.</span><span class="token function">getMainLooper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> uri <span class="token operator">-&gt;</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token comment">//do something</span>
                            requestScreenShot<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">handleDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">handleDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">BooleanState</span> <span class="token function">newTileState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">BooleanState</span> state <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BooleanState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        state<span class="token punctuation">.</span>handlesLongClick <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> state<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">handleUserSwitch</span><span class="token punctuation">(</span><span class="token keyword">int</span> newUserId<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Intent</span> <span class="token function">getLongClickIntent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token class-name">MediaStore</span><span class="token punctuation">.</span><span class="token constant">INTENT_ACTION_STILL_IMAGE_CAMERA</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isAvailable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Expandable</span> expandable<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

        mContext<span class="token punctuation">.</span><span class="token function">getMainExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token punctuation">{<!-- --></span>
            requestScreenShot<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
            mShadeViewControllerLazy<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collapse</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token boolean">false</span> <span class="token comment">/* delayed */</span><span class="token punctuation">,</span> <span class="token number">1.0f</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">handleUpdateState</span><span class="token punctuation">(</span><span class="token class-name">State</span> state<span class="token punctuation">,</span> <span class="token class-name">Object</span> arg<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        state<span class="token punctuation">.</span>icon <span class="token operator">=</span> <span class="token class-name">ResourceIcon</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>qs_flashlight_icon_off<span class="token punctuation">)</span><span class="token punctuation">;</span>
        state<span class="token punctuation">.</span>label<span class="token operator">=</span><span class="token string">"ScreenShot"</span><span class="token punctuation">;</span>
        state<span class="token punctuation">.</span>stateDescription <span class="token operator">=</span> mContext<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>quick_settings_flashlight_label<span class="token punctuation">)</span><span class="token punctuation">;</span>
        state<span class="token punctuation">.</span>secondaryLabel<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">;</span>
        state<span class="token punctuation">.</span>state<span class="token operator">=</span> <span class="token class-name">Tile</span><span class="token punctuation">.</span><span class="token constant">STATE_ACTIVE</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">CharSequence</span> <span class="token function">getTileLabel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token string">"Screen shot"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">handleLongClick</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Expandable</span> expandable<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">handleClick</span><span class="token punctuation">(</span>expandable<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getMetricsCategory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre>
    <p>
     加上finishi方法的回调
     <br/>
     lineageos/frameworks/base/packages/SystemUI/src/com/android/systemui/shade/NotificationPanelViewController.java
    </p>
    <pre><code class="prism language-java">  <span class="token class-name">IOnPannelExpandListener</span>  mIOnPannelExpandListener<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setIOnPannelExpandListener</span><span class="token punctuation">(</span><span class="token class-name">IOnPannelExpandListener</span> <span class="token class-name">IOnPannelExpandListener</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        mIOnPannelExpandListener <span class="token operator">=</span> <span class="token class-name">IOnPannelExpandListener</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IOnPannelExpandListener</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">void</span> <span class="token function">onExpandingFinished</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">onExpandingFinished</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">SceneContainerFlag</span><span class="token punctuation">.</span><span class="token function">isEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            mNotificationStackScrollLayoutController<span class="token punctuation">.</span><span class="token function">onExpansionStopped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        mHeadsUpManager<span class="token punctuation">.</span><span class="token function">onExpandingFinished</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mConversationNotificationManager<span class="token punctuation">.</span><span class="token function">onNotificationPanelExpandStateChanged</span><span class="token punctuation">(</span><span class="token function">isFullyCollapsed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mIsExpandingOrCollapsing <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        mMediaHierarchyManager<span class="token punctuation">.</span><span class="token function">setCollapsingShadeFromQS</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mMediaHierarchyManager<span class="token punctuation">.</span><span class="token function">setQsExpanded</span><span class="token punctuation">(</span>mQsController<span class="token punctuation">.</span><span class="token function">getExpanded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isFullyCollapsed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
           <span class="token comment">//加上下面的通知代码</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>mIOnPannelExpandListener<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                mIOnPannelExpandListener<span class="token punctuation">.</span><span class="token function">onExpandingFinished</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">DejankUtils</span><span class="token punctuation">.</span><span class="token function">postAfterTraversal</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token function">setListening</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// Workaround b/22639032: Make sure we invalidate something because else RenderThread</span>
            <span class="token comment">// thinks we are actually drawing a frame put in reality we don't, so RT doesn't go</span>
            <span class="token comment">// ahead with rendering and we jank.</span>
            mView<span class="token punctuation">.</span><span class="token function">postOnAnimation</span><span class="token punctuation">(</span>
                    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> mView<span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">invalidateChild</span><span class="token punctuation">(</span>mView<span class="token punctuation">,</span> <span class="token constant">M_DUMMY_DIRTY_RECT</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">setListening</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>mBarState <span class="token operator">!=</span> <span class="token constant">SHADE</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// TODO(b/277909752): remove below logs when bug is fixed</span>
            mShadeLog<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"onExpandingFinished called"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>mSplitShadeEnabled <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>mQsController<span class="token punctuation">.</span><span class="token function">getExpanded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                mShadeLog<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"onExpandingFinished called before QS got expanded"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// updating qsExpandImmediate is done in onPanelStateChanged for unlocked shade but</span>
            <span class="token comment">// on keyguard panel state is always OPEN so we need to have that extra update</span>
            mQsController<span class="token punctuation">.</span><span class="token function">setExpandImmediate</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">setShowShelfOnly</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mQsController<span class="token punctuation">.</span><span class="token function">setTwoFingerExpandPossible</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mShadeHeadsUpTracker<span class="token punctuation">.</span><span class="token function">updateTrackingHeadsUp</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mExpandingFromHeadsUp <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token function">setPanelScrimMinFraction</span><span class="token punctuation">(</span><span class="token number">0.0f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Reset status bar alpha so alpha can be calculated upon updating view state.</span>
        <span class="token function">setKeyguardStatusBarAlpha</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">}</span>
</code></pre>
    <p>
     开关配置，上面下面都要加自定义的
     <br/>
     /media/arcxea/stat/lineageos/frameworks/base/packages/SystemUI/res/values/config.xml
    </p>
    <pre><code class="prism language-xml"><span class="token comment">&lt;!-- The default tiles to display in QuickSettings --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>string</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>quick_settings_tiles_default<span class="token punctuation">"</span></span> <span class="token attr-name">translatable</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        internet,bt,screenshot,flashlight,dnd,alarm,airplane,controls,wallet,rotation,battery,cast,screenrecord,mictoggle,cameratoggle,custom(com.android.permissioncontroller/.permission.service.v33.SafetyCenterQsTileService)
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>string</span><span class="token punctuation">&gt;</span></span>
       <span class="token comment">&lt;!-- Tiles native to System UI. Order should match "quick_settings_tiles_default" --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>string</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>quick_settings_tiles_stock<span class="token punctuation">"</span></span> <span class="token attr-name">translatable</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        internet,screenshot,wifi,cell,bt,flashlight,dnd,alarm,airplane,nfc,controls,wallet,rotation,battery,cast,screenrecord,mictoggle,cameratoggle,location,hotspot,inversion,saver,dark,work,night,reverse,reduce_brightness,qr_code_scanner,onehanded,color_correction,dream,font_scaling,record_issue,hearing_devices,ambient_display,aod,caffeine,heads_up,powershare,profiles,reading_mode,sync,usb_tether,vpn
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>string</span><span class="token punctuation">&gt;</span></span>

</code></pre>
    <p>
     接入dagger2的配置，照葫芦画瓢，参照其他的写就行了，这时候已经配置完成。
    </p>
    <p>
     lineageos/frameworks/base/packages/SystemUI/src/com/android/systemui/statusbar/policy/PolicyModule.kt
    </p>
    <pre><code class="prism language-java"><span class="token comment">/*
 * Copyright (C) 2022 The Android Open Source Project
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use mHost file
 * except in compliance with the License. You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the
 * License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied. See the License for the specific language governing
 * permissions and limitations under the License.
 */</span>

<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>statusbar<span class="token punctuation">.</span>policy</span>

<span class="token keyword">import</span> <span class="token namespace">android<span class="token punctuation">.</span>hardware<span class="token punctuation">.</span></span><span class="token class-name">SensorPrivacyManager<span class="token punctuation">.</span>Sensors</span><span class="token punctuation">.</span><span class="token constant">CAMERA</span>
<span class="token keyword">import</span> <span class="token namespace">android<span class="token punctuation">.</span>hardware<span class="token punctuation">.</span></span><span class="token class-name">SensorPrivacyManager<span class="token punctuation">.</span>Sensors</span><span class="token punctuation">.</span><span class="token constant">MICROPHONE</span>
<span class="token keyword">import</span> <span class="token namespace">android<span class="token punctuation">.</span>os<span class="token punctuation">.</span></span><span class="token class-name">UserManager</span><span class="token punctuation">.</span><span class="token constant">DISALLOW_CAMERA_TOGGLE</span>
<span class="token keyword">import</span> <span class="token namespace">android<span class="token punctuation">.</span>os<span class="token punctuation">.</span></span><span class="token class-name">UserManager</span><span class="token punctuation">.</span><span class="token constant">DISALLOW_CONFIG_LOCATION</span>
<span class="token keyword">import</span> <span class="token namespace">android<span class="token punctuation">.</span>os<span class="token punctuation">.</span></span><span class="token class-name">UserManager</span><span class="token punctuation">.</span><span class="token constant">DISALLOW_MICROPHONE_TOGGLE</span>
<span class="token keyword">import</span> <span class="token namespace">android<span class="token punctuation">.</span>os<span class="token punctuation">.</span></span><span class="token class-name">UserManager</span><span class="token punctuation">.</span><span class="token constant">DISALLOW_SHARE_LOCATION</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span></span><span class="token class-name">Flags</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>modes<span class="token punctuation">.</span>shared<span class="token punctuation">.</span></span><span class="token class-name">ModesUi</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span></span><span class="token class-name">QsEventLogger</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>pipeline<span class="token punctuation">.</span>shared<span class="token punctuation">.</span></span><span class="token class-name">TileSpec</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>shared<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">TileCategory</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tileimpl<span class="token punctuation">.</span></span><span class="token class-name">QSTileImpl</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span></span><span class="token class-name">AlarmTile</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span></span><span class="token class-name">CameraToggleTile</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span></span><span class="token class-name">DndTile</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span></span><span class="token class-name">FlashlightTile</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span></span><span class="token class-name">LocationTile</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span></span><span class="token class-name">MicrophoneToggleTile</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span></span><span class="token class-name">ModesTile</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span></span><span class="token class-name">ScreenShotTile</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span></span><span class="token class-name">UiModeNightTile</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span></span><span class="token class-name">WorkModeTile</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>base<span class="token punctuation">.</span>interactor<span class="token punctuation">.</span></span><span class="token class-name">QSTileAvailabilityInteractor</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>base<span class="token punctuation">.</span>viewmodel<span class="token punctuation">.</span></span><span class="token class-name">QSTileViewModelFactory</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>alarm<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">AlarmTileMapper</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>alarm<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>interactor<span class="token punctuation">.</span></span><span class="token class-name">AlarmTileDataInteractor</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>alarm<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>interactor<span class="token punctuation">.</span></span><span class="token class-name">AlarmTileUserActionInteractor</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>alarm<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">AlarmTileModel</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>flashlight<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">FlashlightMapper</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>flashlight<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>interactor<span class="token punctuation">.</span></span><span class="token class-name">FlashlightTileDataInteractor</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>flashlight<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>interactor<span class="token punctuation">.</span></span><span class="token class-name">FlashlightTileUserActionInteractor</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>flashlight<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">FlashlightTileModel</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>location<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">LocationTileMapper</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>location<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>interactor<span class="token punctuation">.</span></span><span class="token class-name">LocationTileDataInteractor</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>location<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>interactor<span class="token punctuation">.</span></span><span class="token class-name">LocationTileUserActionInteractor</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>location<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">LocationTileModel</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>modes<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>interactor<span class="token punctuation">.</span></span><span class="token class-name">ModesTileDataInteractor</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>modes<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>interactor<span class="token punctuation">.</span></span><span class="token class-name">ModesTileUserActionInteractor</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>modes<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">ModesTileModel</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>modes<span class="token punctuation">.</span>ui<span class="token punctuation">.</span></span><span class="token class-name">ModesTileMapper</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>sensorprivacy<span class="token punctuation">.</span></span><span class="token class-name">SensorPrivacyToggleTileDataInteractor</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>sensorprivacy<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">SensorPrivacyToggleTileUserActionInteractor</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>sensorprivacy<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">SensorPrivacyToggleTileModel</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>sensorprivacy<span class="token punctuation">.</span>ui<span class="token punctuation">.</span></span><span class="token class-name">SensorPrivacyTileResources</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>sensorprivacy<span class="token punctuation">.</span>ui<span class="token punctuation">.</span></span><span class="token class-name">SensorPrivacyToggleTileMapper</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>uimodenight<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">UiModeNightTileMapper</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>uimodenight<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>interactor<span class="token punctuation">.</span></span><span class="token class-name">UiModeNightTileDataInteractor</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>uimodenight<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>interactor<span class="token punctuation">.</span></span><span class="token class-name">UiModeNightTileUserActionInteractor</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>uimodenight<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">UiModeNightTileModel</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>work<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>interactor<span class="token punctuation">.</span></span><span class="token class-name">WorkModeTileDataInteractor</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>work<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>interactor<span class="token punctuation">.</span></span><span class="token class-name">WorkModeTileUserActionInteractor</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>work<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>model<span class="token punctuation">.</span></span><span class="token class-name">WorkModeTileModel</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>work<span class="token punctuation">.</span>ui<span class="token punctuation">.</span></span><span class="token class-name">WorkModeTileMapper</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>viewmodel<span class="token punctuation">.</span></span><span class="token class-name">QSTileConfig</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>viewmodel<span class="token punctuation">.</span></span><span class="token class-name">QSTilePolicy</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>viewmodel<span class="token punctuation">.</span></span><span class="token class-name">QSTileUIConfig</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>viewmodel<span class="token punctuation">.</span></span><span class="token class-name">QSTileViewModel</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>qs<span class="token punctuation">.</span>tiles<span class="token punctuation">.</span>viewmodel<span class="token punctuation">.</span></span><span class="token class-name">StubQSTileViewModel</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>systemui<span class="token punctuation">.</span>res<span class="token punctuation">.</span></span><span class="token class-name">R</span>
<span class="token keyword">import</span> <span class="token namespace">dagger<span class="token punctuation">.</span></span><span class="token class-name">Binds</span>
<span class="token keyword">import</span> <span class="token namespace">dagger<span class="token punctuation">.</span></span><span class="token class-name">Module</span>
<span class="token keyword">import</span> <span class="token namespace">dagger<span class="token punctuation">.</span></span><span class="token class-name">Provides</span>
<span class="token keyword">import</span> <span class="token namespace">dagger<span class="token punctuation">.</span>multibindings<span class="token punctuation">.</span></span><span class="token class-name">IntoMap</span>
<span class="token keyword">import</span> <span class="token namespace">dagger<span class="token punctuation">.</span>multibindings<span class="token punctuation">.</span></span><span class="token class-name">StringKey</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>inject<span class="token punctuation">.</span></span><span class="token class-name">Provider</span>

<span class="token annotation punctuation">@Module</span>
<span class="token keyword">interface</span> <span class="token class-name">PolicyModule</span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">/** Inject WorkModeTile into tileMap in QSModule */</span>
    <span class="token annotation punctuation">@Binds</span>
    <span class="token annotation punctuation">@IntoMap</span>
    <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token class-name">WorkModeTile</span><span class="token punctuation">.</span><span class="token constant">TILE_SPEC</span><span class="token punctuation">)</span>
    fun <span class="token function">bindWorkModeTile</span><span class="token punctuation">(</span>workModeTile<span class="token operator">:</span> <span class="token class-name">WorkModeTile</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileImpl</span><span class="token operator">&lt;</span><span class="token operator">*</span><span class="token operator">&gt;</span>

    <span class="token annotation punctuation">@Binds</span>
    <span class="token annotation punctuation">@IntoMap</span>
    <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token constant">FLASHLIGHT_TILE_SPEC</span><span class="token punctuation">)</span>
    fun <span class="token function">provideAirplaneModeAvailabilityInteractor</span><span class="token punctuation">(</span>
        impl<span class="token operator">:</span> <span class="token class-name">FlashlightTileDataInteractor</span>
    <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileAvailabilityInteractor</span>

    <span class="token annotation punctuation">@Binds</span>
    <span class="token annotation punctuation">@IntoMap</span>
    <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token constant">LOCATION_TILE_SPEC</span><span class="token punctuation">)</span>
    fun <span class="token function">provideLocationAvailabilityInteractor</span><span class="token punctuation">(</span>
        impl<span class="token operator">:</span> <span class="token class-name">LocationTileDataInteractor</span>
    <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileAvailabilityInteractor</span>

    <span class="token annotation punctuation">@Binds</span>
    <span class="token annotation punctuation">@IntoMap</span>
    <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token constant">ALARM_TILE_SPEC</span><span class="token punctuation">)</span>
    fun <span class="token function">provideAlarmAvailabilityInteractor</span><span class="token punctuation">(</span>
        impl<span class="token operator">:</span> <span class="token class-name">AlarmTileDataInteractor</span>
    <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileAvailabilityInteractor</span>

    <span class="token annotation punctuation">@Binds</span>
    <span class="token annotation punctuation">@IntoMap</span>
    <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token constant">UIMODENIGHT_TILE_SPEC</span><span class="token punctuation">)</span>
    fun <span class="token function">provideUiModeNightAvailabilityInteractor</span><span class="token punctuation">(</span>
        impl<span class="token operator">:</span> <span class="token class-name">UiModeNightTileDataInteractor</span>
    <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileAvailabilityInteractor</span>

    <span class="token annotation punctuation">@Binds</span>
    <span class="token annotation punctuation">@IntoMap</span>
    <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token constant">WORK_MODE_TILE_SPEC</span><span class="token punctuation">)</span>
    fun <span class="token function">provideWorkModeAvailabilityInteractor</span><span class="token punctuation">(</span>
        impl<span class="token operator">:</span> <span class="token class-name">WorkModeTileDataInteractor</span>
    <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileAvailabilityInteractor</span>

    companion object <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> val <span class="token constant">FLASHLIGHT_TILE_SPEC</span> <span class="token operator">=</span> <span class="token string">"flashlight"</span>
        <span class="token keyword">const</span> val <span class="token constant">LOCATION_TILE_SPEC</span> <span class="token operator">=</span> <span class="token string">"location"</span>
        <span class="token keyword">const</span> val <span class="token constant">ALARM_TILE_SPEC</span> <span class="token operator">=</span> <span class="token string">"alarm"</span>
        <span class="token keyword">const</span> val <span class="token constant">UIMODENIGHT_TILE_SPEC</span> <span class="token operator">=</span> <span class="token string">"dark"</span>
        <span class="token keyword">const</span> val <span class="token constant">WORK_MODE_TILE_SPEC</span> <span class="token operator">=</span> <span class="token string">"work"</span>
        <span class="token keyword">const</span> val <span class="token constant">CAMERA_TOGGLE_TILE_SPEC</span> <span class="token operator">=</span> <span class="token string">"cameratoggle"</span>
        <span class="token keyword">const</span> val <span class="token constant">MIC_TOGGLE_TILE_SPEC</span> <span class="token operator">=</span> <span class="token string">"mictoggle"</span>
        <span class="token keyword">const</span> val <span class="token constant">DND_TILE_SPEC</span> <span class="token operator">=</span> <span class="token string">"dnd"</span>
        <span class="token keyword">const</span> val <span class="token constant">SCREENSHOT_TILE_SPEC</span> <span class="token operator">=</span> <span class="token string">"screenshot"</span>



        <span class="token comment">/** Inject screenshot config */</span>
        <span class="token annotation punctuation">@Provides</span>
        <span class="token annotation punctuation">@IntoMap</span>
        <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token constant">SCREENSHOT_TILE_SPEC</span><span class="token punctuation">)</span>
        fun <span class="token function">provideScreenShotTileConfig</span><span class="token punctuation">(</span>uiEventLogger<span class="token operator">:</span> <span class="token class-name">QsEventLogger</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileConfig</span> <span class="token operator">=</span>
            <span class="token class-name">QSTileConfig</span><span class="token punctuation">(</span>
                tileSpec <span class="token operator">=</span> <span class="token class-name">TileSpec</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">SCREENSHOT_TILE_SPEC</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                uiConfig <span class="token operator">=</span>
                <span class="token class-name">QSTileUIConfig<span class="token punctuation">.</span>Resource</span><span class="token punctuation">(</span>
                    iconRes <span class="token operator">=</span> <span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>qs_flashlight_icon_off<span class="token punctuation">,</span>
                    labelRes <span class="token operator">=</span> <span class="token class-name">R</span><span class="token punctuation">.</span>string<span class="token punctuation">.</span>quick_settings_flashlight_label<span class="token punctuation">,</span>
                <span class="token punctuation">)</span><span class="token punctuation">,</span>
                instanceId <span class="token operator">=</span> uiEventLogger<span class="token punctuation">.</span><span class="token function">getNewInstanceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                category <span class="token operator">=</span> <span class="token class-name">TileCategory</span><span class="token punctuation">.</span><span class="token constant">UTILITIES</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span>

        <span class="token comment">/** Inject ScreenShotTile into tileViewModelMap in QSModule */</span>
        <span class="token annotation punctuation">@Provides</span>
        <span class="token annotation punctuation">@IntoMap</span>
        <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token constant">SCREENSHOT_TILE_SPEC</span><span class="token punctuation">)</span>
        fun <span class="token function">provideScreenShotTileViewModel</span><span class="token punctuation">(</span>
            factory<span class="token operator">:</span> <span class="token class-name">QSTileViewModelFactory<span class="token punctuation">.</span>Static</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FlashlightTileModel</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span>
            mapper<span class="token operator">:</span> <span class="token class-name">FlashlightMapper</span><span class="token punctuation">,</span>
            stateInteractor<span class="token operator">:</span> <span class="token class-name">FlashlightTileDataInteractor</span><span class="token punctuation">,</span>
            userActionInteractor<span class="token operator">:</span> <span class="token class-name">FlashlightTileUserActionInteractor</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileViewModel</span> <span class="token operator">=</span>
            factory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>
                <span class="token class-name">TileSpec</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">SCREENSHOT_TILE_SPEC</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                userActionInteractor<span class="token punctuation">,</span>
                stateInteractor<span class="token punctuation">,</span>
                mapper<span class="token punctuation">,</span>
            <span class="token punctuation">)</span>




        <span class="token comment">/** Inject DndTile or ModesTile into tileMap in QSModule based on feature flag */</span>
        <span class="token annotation punctuation">@Provides</span>
        <span class="token annotation punctuation">@IntoMap</span>
        <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token constant">DND_TILE_SPEC</span><span class="token punctuation">)</span>
        fun <span class="token function">bindDndOrModesTile</span><span class="token punctuation">(</span>
            <span class="token comment">// Using providers to make sure that the unused tile isn't initialised at all if the</span>
            <span class="token comment">// flag is off.</span>
            dndTile<span class="token operator">:</span> <span class="token class-name">Provider</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DndTile</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span>
            modesTile<span class="token operator">:</span> <span class="token class-name">Provider</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ModesTile</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileImpl</span><span class="token operator">&lt;</span><span class="token operator">*</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">ModesUi</span><span class="token punctuation">.</span>isEnabled<span class="token punctuation">)</span> modesTile<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> dndTile<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/** Inject flashlight config */</span>
        <span class="token annotation punctuation">@Provides</span>
        <span class="token annotation punctuation">@IntoMap</span>
        <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token constant">FLASHLIGHT_TILE_SPEC</span><span class="token punctuation">)</span>
        fun <span class="token function">provideFlashlightTileConfig</span><span class="token punctuation">(</span>uiEventLogger<span class="token operator">:</span> <span class="token class-name">QsEventLogger</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileConfig</span> <span class="token operator">=</span>
            <span class="token class-name">QSTileConfig</span><span class="token punctuation">(</span>
                tileSpec <span class="token operator">=</span> <span class="token class-name">TileSpec</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">FLASHLIGHT_TILE_SPEC</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                uiConfig <span class="token operator">=</span>
                    <span class="token class-name">QSTileUIConfig<span class="token punctuation">.</span>Resource</span><span class="token punctuation">(</span>
                        iconRes <span class="token operator">=</span> <span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>qs_flashlight_icon_off<span class="token punctuation">,</span>
                        labelRes <span class="token operator">=</span> <span class="token class-name">R</span><span class="token punctuation">.</span>string<span class="token punctuation">.</span>quick_settings_flashlight_label<span class="token punctuation">,</span>
                    <span class="token punctuation">)</span><span class="token punctuation">,</span>
                instanceId <span class="token operator">=</span> uiEventLogger<span class="token punctuation">.</span><span class="token function">getNewInstanceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                category <span class="token operator">=</span> <span class="token class-name">TileCategory</span><span class="token punctuation">.</span><span class="token constant">UTILITIES</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span>

        <span class="token comment">/** Inject FlashlightTile into tileViewModelMap in QSModule */</span>
        <span class="token annotation punctuation">@Provides</span>
        <span class="token annotation punctuation">@IntoMap</span>
        <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token constant">FLASHLIGHT_TILE_SPEC</span><span class="token punctuation">)</span>
        fun <span class="token function">provideFlashlightTileViewModel</span><span class="token punctuation">(</span>
            factory<span class="token operator">:</span> <span class="token class-name">QSTileViewModelFactory<span class="token punctuation">.</span>Static</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FlashlightTileModel</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span>
            mapper<span class="token operator">:</span> <span class="token class-name">FlashlightMapper</span><span class="token punctuation">,</span>
            stateInteractor<span class="token operator">:</span> <span class="token class-name">FlashlightTileDataInteractor</span><span class="token punctuation">,</span>
            userActionInteractor<span class="token operator">:</span> <span class="token class-name">FlashlightTileUserActionInteractor</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileViewModel</span> <span class="token operator">=</span>
            factory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>
                <span class="token class-name">TileSpec</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">FLASHLIGHT_TILE_SPEC</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                userActionInteractor<span class="token punctuation">,</span>
                stateInteractor<span class="token punctuation">,</span>
                mapper<span class="token punctuation">,</span>
            <span class="token punctuation">)</span>

        <span class="token comment">/** Inject location config */</span>
        <span class="token annotation punctuation">@Provides</span>
        <span class="token annotation punctuation">@IntoMap</span>
        <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token constant">LOCATION_TILE_SPEC</span><span class="token punctuation">)</span>
        fun <span class="token function">provideLocationTileConfig</span><span class="token punctuation">(</span>uiEventLogger<span class="token operator">:</span> <span class="token class-name">QsEventLogger</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileConfig</span> <span class="token operator">=</span>
            <span class="token class-name">QSTileConfig</span><span class="token punctuation">(</span>
                tileSpec <span class="token operator">=</span> <span class="token class-name">TileSpec</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">LOCATION_TILE_SPEC</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                uiConfig <span class="token operator">=</span>
                    <span class="token class-name">QSTileUIConfig<span class="token punctuation">.</span>Resource</span><span class="token punctuation">(</span>
                        iconRes <span class="token operator">=</span> <span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>qs_location_icon_off<span class="token punctuation">,</span>
                        labelRes <span class="token operator">=</span> <span class="token class-name">R</span><span class="token punctuation">.</span>string<span class="token punctuation">.</span>quick_settings_location_label<span class="token punctuation">,</span>
                    <span class="token punctuation">)</span><span class="token punctuation">,</span>
                instanceId <span class="token operator">=</span> uiEventLogger<span class="token punctuation">.</span><span class="token function">getNewInstanceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                policy <span class="token operator">=</span>
                    <span class="token class-name">QSTilePolicy<span class="token punctuation">.</span>Restricted</span><span class="token punctuation">(</span>
                        <span class="token function">listOf</span><span class="token punctuation">(</span><span class="token constant">DISALLOW_SHARE_LOCATION</span><span class="token punctuation">,</span> <span class="token constant">DISALLOW_CONFIG_LOCATION</span><span class="token punctuation">)</span>
                    <span class="token punctuation">)</span><span class="token punctuation">,</span>
                category <span class="token operator">=</span> <span class="token class-name">TileCategory</span><span class="token punctuation">.</span><span class="token constant">PRIVACY</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span>

        <span class="token comment">/** Inject LocationTile into tileViewModelMap in QSModule */</span>
        <span class="token annotation punctuation">@Provides</span>
        <span class="token annotation punctuation">@IntoMap</span>
        <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token constant">LOCATION_TILE_SPEC</span><span class="token punctuation">)</span>
        fun <span class="token function">provideLocationTileViewModel</span><span class="token punctuation">(</span>
            factory<span class="token operator">:</span> <span class="token class-name">QSTileViewModelFactory<span class="token punctuation">.</span>Static</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">LocationTileModel</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span>
            mapper<span class="token operator">:</span> <span class="token class-name">LocationTileMapper</span><span class="token punctuation">,</span>
            stateInteractor<span class="token operator">:</span> <span class="token class-name">LocationTileDataInteractor</span><span class="token punctuation">,</span>
            userActionInteractor<span class="token operator">:</span> <span class="token class-name">LocationTileUserActionInteractor</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileViewModel</span> <span class="token operator">=</span>
            factory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>
                <span class="token class-name">TileSpec</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">LOCATION_TILE_SPEC</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                userActionInteractor<span class="token punctuation">,</span>
                stateInteractor<span class="token punctuation">,</span>
                mapper<span class="token punctuation">,</span>
            <span class="token punctuation">)</span>

        <span class="token comment">/** Inject alarm config */</span>
        <span class="token annotation punctuation">@Provides</span>
        <span class="token annotation punctuation">@IntoMap</span>
        <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token constant">ALARM_TILE_SPEC</span><span class="token punctuation">)</span>
        fun <span class="token function">provideAlarmTileConfig</span><span class="token punctuation">(</span>uiEventLogger<span class="token operator">:</span> <span class="token class-name">QsEventLogger</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileConfig</span> <span class="token operator">=</span>
            <span class="token class-name">QSTileConfig</span><span class="token punctuation">(</span>
                tileSpec <span class="token operator">=</span> <span class="token class-name">TileSpec</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">ALARM_TILE_SPEC</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                uiConfig <span class="token operator">=</span>
                    <span class="token class-name">QSTileUIConfig<span class="token punctuation">.</span>Resource</span><span class="token punctuation">(</span>
                        iconRes <span class="token operator">=</span> <span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>ic_alarm<span class="token punctuation">,</span>
                        labelRes <span class="token operator">=</span> <span class="token class-name">R</span><span class="token punctuation">.</span>string<span class="token punctuation">.</span>status_bar_alarm<span class="token punctuation">,</span>
                    <span class="token punctuation">)</span><span class="token punctuation">,</span>
                instanceId <span class="token operator">=</span> uiEventLogger<span class="token punctuation">.</span><span class="token function">getNewInstanceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                category <span class="token operator">=</span> <span class="token class-name">TileCategory</span><span class="token punctuation">.</span><span class="token constant">UTILITIES</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span>

        <span class="token comment">/** Inject AlarmTile into tileViewModelMap in QSModule */</span>
        <span class="token annotation punctuation">@Provides</span>
        <span class="token annotation punctuation">@IntoMap</span>
        <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token constant">ALARM_TILE_SPEC</span><span class="token punctuation">)</span>
        fun <span class="token function">provideAlarmTileViewModel</span><span class="token punctuation">(</span>
            factory<span class="token operator">:</span> <span class="token class-name">QSTileViewModelFactory<span class="token punctuation">.</span>Static</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AlarmTileModel</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span>
            mapper<span class="token operator">:</span> <span class="token class-name">AlarmTileMapper</span><span class="token punctuation">,</span>
            stateInteractor<span class="token operator">:</span> <span class="token class-name">AlarmTileDataInteractor</span><span class="token punctuation">,</span>
            userActionInteractor<span class="token operator">:</span> <span class="token class-name">AlarmTileUserActionInteractor</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileViewModel</span> <span class="token operator">=</span>
            factory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>
                <span class="token class-name">TileSpec</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">ALARM_TILE_SPEC</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                userActionInteractor<span class="token punctuation">,</span>
                stateInteractor<span class="token punctuation">,</span>
                mapper<span class="token punctuation">,</span>
            <span class="token punctuation">)</span>

        <span class="token comment">/** Inject uimodenight config */</span>
        <span class="token annotation punctuation">@Provides</span>
        <span class="token annotation punctuation">@IntoMap</span>
        <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token constant">UIMODENIGHT_TILE_SPEC</span><span class="token punctuation">)</span>
        fun <span class="token function">provideUiModeNightTileConfig</span><span class="token punctuation">(</span>uiEventLogger<span class="token operator">:</span> <span class="token class-name">QsEventLogger</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileConfig</span> <span class="token operator">=</span>
            <span class="token class-name">QSTileConfig</span><span class="token punctuation">(</span>
                tileSpec <span class="token operator">=</span> <span class="token class-name">TileSpec</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">UIMODENIGHT_TILE_SPEC</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                uiConfig <span class="token operator">=</span>
                    <span class="token class-name">QSTileUIConfig<span class="token punctuation">.</span>Resource</span><span class="token punctuation">(</span>
                        iconRes <span class="token operator">=</span> <span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>qs_light_dark_theme_icon_off<span class="token punctuation">,</span>
                        labelRes <span class="token operator">=</span> <span class="token class-name">R</span><span class="token punctuation">.</span>string<span class="token punctuation">.</span>quick_settings_ui_mode_night_label<span class="token punctuation">,</span>
                    <span class="token punctuation">)</span><span class="token punctuation">,</span>
                instanceId <span class="token operator">=</span> uiEventLogger<span class="token punctuation">.</span><span class="token function">getNewInstanceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                category <span class="token operator">=</span> <span class="token class-name">TileCategory</span><span class="token punctuation">.</span><span class="token constant">DISPLAY</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span>

        <span class="token comment">/** Inject uimodenight into tileViewModelMap in QSModule */</span>
        <span class="token annotation punctuation">@Provides</span>
        <span class="token annotation punctuation">@IntoMap</span>
        <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token constant">UIMODENIGHT_TILE_SPEC</span><span class="token punctuation">)</span>
        fun <span class="token function">provideUiModeNightTileViewModel</span><span class="token punctuation">(</span>
            factory<span class="token operator">:</span> <span class="token class-name">QSTileViewModelFactory<span class="token punctuation">.</span>Static</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UiModeNightTileModel</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span>
            mapper<span class="token operator">:</span> <span class="token class-name">UiModeNightTileMapper</span><span class="token punctuation">,</span>
            stateInteractor<span class="token operator">:</span> <span class="token class-name">UiModeNightTileDataInteractor</span><span class="token punctuation">,</span>
            userActionInteractor<span class="token operator">:</span> <span class="token class-name">UiModeNightTileUserActionInteractor</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileViewModel</span> <span class="token operator">=</span>
            factory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>
                <span class="token class-name">TileSpec</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">UIMODENIGHT_TILE_SPEC</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                userActionInteractor<span class="token punctuation">,</span>
                stateInteractor<span class="token punctuation">,</span>
                mapper<span class="token punctuation">,</span>
            <span class="token punctuation">)</span>

        <span class="token comment">/** Inject work mode tile config */</span>
        <span class="token annotation punctuation">@Provides</span>
        <span class="token annotation punctuation">@IntoMap</span>
        <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token constant">WORK_MODE_TILE_SPEC</span><span class="token punctuation">)</span>
        fun <span class="token function">provideWorkModeTileConfig</span><span class="token punctuation">(</span>uiEventLogger<span class="token operator">:</span> <span class="token class-name">QsEventLogger</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileConfig</span> <span class="token operator">=</span>
            <span class="token class-name">QSTileConfig</span><span class="token punctuation">(</span>
                tileSpec <span class="token operator">=</span> <span class="token class-name">TileSpec</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">WORK_MODE_TILE_SPEC</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                uiConfig <span class="token operator">=</span>
                    <span class="token class-name">QSTileUIConfig<span class="token punctuation">.</span>Resource</span><span class="token punctuation">(</span>
                        iconRes <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>internal<span class="token punctuation">.</span></span>R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>stat_sys_managed_profile_status<span class="token punctuation">,</span>
                        labelRes <span class="token operator">=</span> <span class="token class-name">R</span><span class="token punctuation">.</span>string<span class="token punctuation">.</span>quick_settings_work_mode_label<span class="token punctuation">,</span>
                    <span class="token punctuation">)</span><span class="token punctuation">,</span>
                instanceId <span class="token operator">=</span> uiEventLogger<span class="token punctuation">.</span><span class="token function">getNewInstanceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                autoRemoveOnUnavailable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                category <span class="token operator">=</span> <span class="token class-name">TileCategory</span><span class="token punctuation">.</span><span class="token constant">PRIVACY</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span>

        <span class="token comment">/** Inject work mode into tileViewModelMap in QSModule */</span>
        <span class="token annotation punctuation">@Provides</span>
        <span class="token annotation punctuation">@IntoMap</span>
        <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token constant">WORK_MODE_TILE_SPEC</span><span class="token punctuation">)</span>
        fun <span class="token function">provideWorkModeTileViewModel</span><span class="token punctuation">(</span>
            factory<span class="token operator">:</span> <span class="token class-name">QSTileViewModelFactory<span class="token punctuation">.</span>Static</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WorkModeTileModel</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span>
            mapper<span class="token operator">:</span> <span class="token class-name">WorkModeTileMapper</span><span class="token punctuation">,</span>
            stateInteractor<span class="token operator">:</span> <span class="token class-name">WorkModeTileDataInteractor</span><span class="token punctuation">,</span>
            userActionInteractor<span class="token operator">:</span> <span class="token class-name">WorkModeTileUserActionInteractor</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileViewModel</span> <span class="token operator">=</span>
            factory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>
                <span class="token class-name">TileSpec</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">WORK_MODE_TILE_SPEC</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                userActionInteractor<span class="token punctuation">,</span>
                stateInteractor<span class="token punctuation">,</span>
                mapper<span class="token punctuation">,</span>
            <span class="token punctuation">)</span>

        <span class="token comment">/** Inject camera toggle config */</span>
        <span class="token annotation punctuation">@Provides</span>
        <span class="token annotation punctuation">@IntoMap</span>
        <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token constant">CAMERA_TOGGLE_TILE_SPEC</span><span class="token punctuation">)</span>
        fun <span class="token function">provideCameraToggleTileConfig</span><span class="token punctuation">(</span>uiEventLogger<span class="token operator">:</span> <span class="token class-name">QsEventLogger</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileConfig</span> <span class="token operator">=</span>
            <span class="token class-name">QSTileConfig</span><span class="token punctuation">(</span>
                tileSpec <span class="token operator">=</span> <span class="token class-name">TileSpec</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">CAMERA_TOGGLE_TILE_SPEC</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                uiConfig <span class="token operator">=</span>
                    <span class="token class-name">QSTileUIConfig<span class="token punctuation">.</span>Resource</span><span class="token punctuation">(</span>
                        iconRes <span class="token operator">=</span> <span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>qs_camera_access_icon_off<span class="token punctuation">,</span>
                        labelRes <span class="token operator">=</span> <span class="token class-name">R</span><span class="token punctuation">.</span>string<span class="token punctuation">.</span>quick_settings_camera_label<span class="token punctuation">,</span>
                    <span class="token punctuation">)</span><span class="token punctuation">,</span>
                instanceId <span class="token operator">=</span> uiEventLogger<span class="token punctuation">.</span><span class="token function">getNewInstanceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                policy <span class="token operator">=</span> <span class="token class-name">QSTilePolicy<span class="token punctuation">.</span>Restricted</span><span class="token punctuation">(</span><span class="token function">listOf</span><span class="token punctuation">(</span><span class="token constant">DISALLOW_CAMERA_TOGGLE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                category <span class="token operator">=</span> <span class="token class-name">TileCategory</span><span class="token punctuation">.</span><span class="token constant">PRIVACY</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span>

        <span class="token comment">/** Inject camera toggle tile into tileViewModelMap in QSModule */</span>
        <span class="token annotation punctuation">@Provides</span>
        <span class="token annotation punctuation">@IntoMap</span>
        <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token constant">CAMERA_TOGGLE_TILE_SPEC</span><span class="token punctuation">)</span>
        fun <span class="token function">provideCameraToggleTileViewModel</span><span class="token punctuation">(</span>
            factory<span class="token operator">:</span> <span class="token class-name">QSTileViewModelFactory<span class="token punctuation">.</span>Static</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SensorPrivacyToggleTileModel</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span>
            mapper<span class="token operator">:</span> <span class="token class-name">SensorPrivacyToggleTileMapper<span class="token punctuation">.</span>Factory</span><span class="token punctuation">,</span>
            stateInteractor<span class="token operator">:</span> <span class="token class-name">SensorPrivacyToggleTileDataInteractor<span class="token punctuation">.</span>Factory</span><span class="token punctuation">,</span>
            userActionInteractor<span class="token operator">:</span> <span class="token class-name">SensorPrivacyToggleTileUserActionInteractor<span class="token punctuation">.</span>Factory</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileViewModel</span> <span class="token operator">=</span>
            factory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>
                <span class="token class-name">TileSpec</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">CAMERA_TOGGLE_TILE_SPEC</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                userActionInteractor<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">CAMERA</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                stateInteractor<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">CAMERA</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                mapper<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">SensorPrivacyTileResources<span class="token punctuation">.</span>CameraPrivacyTileResources</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span>

        <span class="token annotation punctuation">@Provides</span>
        <span class="token annotation punctuation">@IntoMap</span>
        <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token constant">CAMERA_TOGGLE_TILE_SPEC</span><span class="token punctuation">)</span>
        fun <span class="token function">provideCameraToggleAvailabilityInteractor</span><span class="token punctuation">(</span>
            factory<span class="token operator">:</span> <span class="token class-name">SensorPrivacyToggleTileDataInteractor<span class="token punctuation">.</span>Factory</span>
        <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileAvailabilityInteractor</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> factory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">CAMERA</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/** Inject microphone toggle config */</span>
        <span class="token annotation punctuation">@Provides</span>
        <span class="token annotation punctuation">@IntoMap</span>
        <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token constant">MIC_TOGGLE_TILE_SPEC</span><span class="token punctuation">)</span>
        fun <span class="token function">provideMicrophoneToggleTileConfig</span><span class="token punctuation">(</span>uiEventLogger<span class="token operator">:</span> <span class="token class-name">QsEventLogger</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileConfig</span> <span class="token operator">=</span>
            <span class="token class-name">QSTileConfig</span><span class="token punctuation">(</span>
                tileSpec <span class="token operator">=</span> <span class="token class-name">TileSpec</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">MIC_TOGGLE_TILE_SPEC</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                uiConfig <span class="token operator">=</span>
                    <span class="token class-name">QSTileUIConfig<span class="token punctuation">.</span>Resource</span><span class="token punctuation">(</span>
                        iconRes <span class="token operator">=</span> <span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>qs_mic_access_off<span class="token punctuation">,</span>
                        labelRes <span class="token operator">=</span> <span class="token class-name">R</span><span class="token punctuation">.</span>string<span class="token punctuation">.</span>quick_settings_mic_label<span class="token punctuation">,</span>
                    <span class="token punctuation">)</span><span class="token punctuation">,</span>
                instanceId <span class="token operator">=</span> uiEventLogger<span class="token punctuation">.</span><span class="token function">getNewInstanceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                policy <span class="token operator">=</span> <span class="token class-name">QSTilePolicy<span class="token punctuation">.</span>Restricted</span><span class="token punctuation">(</span><span class="token function">listOf</span><span class="token punctuation">(</span><span class="token constant">DISALLOW_MICROPHONE_TOGGLE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                category <span class="token operator">=</span> <span class="token class-name">TileCategory</span><span class="token punctuation">.</span><span class="token constant">PRIVACY</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span>

        <span class="token comment">/** Inject microphone toggle tile into tileViewModelMap in QSModule */</span>
        <span class="token annotation punctuation">@Provides</span>
        <span class="token annotation punctuation">@IntoMap</span>
        <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token constant">MIC_TOGGLE_TILE_SPEC</span><span class="token punctuation">)</span>
        fun <span class="token function">provideMicrophoneToggleTileViewModel</span><span class="token punctuation">(</span>
            factory<span class="token operator">:</span> <span class="token class-name">QSTileViewModelFactory<span class="token punctuation">.</span>Static</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SensorPrivacyToggleTileModel</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span>
            mapper<span class="token operator">:</span> <span class="token class-name">SensorPrivacyToggleTileMapper<span class="token punctuation">.</span>Factory</span><span class="token punctuation">,</span>
            stateInteractor<span class="token operator">:</span> <span class="token class-name">SensorPrivacyToggleTileDataInteractor<span class="token punctuation">.</span>Factory</span><span class="token punctuation">,</span>
            userActionInteractor<span class="token operator">:</span> <span class="token class-name">SensorPrivacyToggleTileUserActionInteractor<span class="token punctuation">.</span>Factory</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileViewModel</span> <span class="token operator">=</span>
            factory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>
                <span class="token class-name">TileSpec</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">MIC_TOGGLE_TILE_SPEC</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                userActionInteractor<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">MICROPHONE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                stateInteractor<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">MICROPHONE</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                mapper<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">SensorPrivacyTileResources<span class="token punctuation">.</span>MicrophonePrivacyTileResources</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span>

        <span class="token annotation punctuation">@Provides</span>
        <span class="token annotation punctuation">@IntoMap</span>
        <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token constant">MIC_TOGGLE_TILE_SPEC</span><span class="token punctuation">)</span>
        fun <span class="token function">provideMicToggleModeAvailabilityInteractor</span><span class="token punctuation">(</span>
            factory<span class="token operator">:</span> <span class="token class-name">SensorPrivacyToggleTileDataInteractor<span class="token punctuation">.</span>Factory</span>
        <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileAvailabilityInteractor</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> factory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">MICROPHONE</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/** Inject DND tile or Modes tile config based on feature flag */</span>
        <span class="token annotation punctuation">@Provides</span>
        <span class="token annotation punctuation">@IntoMap</span>
        <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token constant">DND_TILE_SPEC</span><span class="token punctuation">)</span>
        fun <span class="token function">provideDndOrModesTileConfig</span><span class="token punctuation">(</span>uiEventLogger<span class="token operator">:</span> <span class="token class-name">QsEventLogger</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileConfig</span> <span class="token operator">=</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">ModesUi</span><span class="token punctuation">.</span>isEnabled<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">QSTileConfig</span><span class="token punctuation">(</span>
                    tileSpec <span class="token operator">=</span> <span class="token class-name">TileSpec</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">DND_TILE_SPEC</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    uiConfig <span class="token operator">=</span>
                        <span class="token class-name">QSTileUIConfig<span class="token punctuation">.</span>Resource</span><span class="token punctuation">(</span>
                            iconRes <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>internal<span class="token punctuation">.</span></span>R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>ic_zen_priority_modes<span class="token punctuation">,</span>
                            labelRes <span class="token operator">=</span> <span class="token class-name">R</span><span class="token punctuation">.</span>string<span class="token punctuation">.</span>quick_settings_modes_label<span class="token punctuation">,</span>
                        <span class="token punctuation">)</span><span class="token punctuation">,</span>
                    instanceId <span class="token operator">=</span> uiEventLogger<span class="token punctuation">.</span><span class="token function">getNewInstanceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    category <span class="token operator">=</span> <span class="token class-name">TileCategory</span><span class="token punctuation">.</span><span class="token constant">CONNECTIVITY</span><span class="token punctuation">,</span>
                <span class="token punctuation">)</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">QSTileConfig</span><span class="token punctuation">(</span>
                    tileSpec <span class="token operator">=</span> <span class="token class-name">TileSpec</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">DND_TILE_SPEC</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    uiConfig <span class="token operator">=</span>
                        <span class="token class-name">QSTileUIConfig<span class="token punctuation">.</span>Resource</span><span class="token punctuation">(</span>
                            iconRes <span class="token operator">=</span> <span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>qs_dnd_icon_off<span class="token punctuation">,</span>
                            labelRes <span class="token operator">=</span> <span class="token class-name">R</span><span class="token punctuation">.</span>string<span class="token punctuation">.</span>quick_settings_dnd_label<span class="token punctuation">,</span>
                        <span class="token punctuation">)</span><span class="token punctuation">,</span>
                    instanceId <span class="token operator">=</span> uiEventLogger<span class="token punctuation">.</span><span class="token function">getNewInstanceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    category <span class="token operator">=</span> <span class="token class-name">TileCategory</span><span class="token punctuation">.</span><span class="token constant">CONNECTIVITY</span><span class="token punctuation">,</span>
                <span class="token punctuation">)</span>
            <span class="token punctuation">}</span>

        <span class="token comment">/** Inject ModesTile into tileViewModelMap in QSModule */</span>
        <span class="token annotation punctuation">@Provides</span>
        <span class="token annotation punctuation">@IntoMap</span>
        <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token constant">DND_TILE_SPEC</span><span class="token punctuation">)</span>
        fun <span class="token function">provideModesTileViewModel</span><span class="token punctuation">(</span>
            factory<span class="token operator">:</span> <span class="token class-name">QSTileViewModelFactory<span class="token punctuation">.</span>Static</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ModesTileModel</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span>
            mapper<span class="token operator">:</span> <span class="token class-name">ModesTileMapper</span><span class="token punctuation">,</span>
            stateInteractor<span class="token operator">:</span> <span class="token class-name">ModesTileDataInteractor</span><span class="token punctuation">,</span>
            userActionInteractor<span class="token operator">:</span> <span class="token class-name">ModesTileUserActionInteractor</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileViewModel</span> <span class="token operator">=</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">ModesUi</span><span class="token punctuation">.</span>isEnabled <span class="token operator">&amp;&amp;</span> <span class="token class-name">Flags</span><span class="token punctuation">.</span><span class="token function">qsNewTilesFuture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                factory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>
                    <span class="token class-name">TileSpec</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token constant">DND_TILE_SPEC</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    userActionInteractor<span class="token punctuation">,</span>
                    stateInteractor<span class="token punctuation">,</span>
                    mapper<span class="token punctuation">,</span>
                <span class="token punctuation">)</span>
            <span class="token keyword">else</span> <span class="token class-name">StubQSTileViewModel</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/** Inject FlashlightTile into tileMap in QSModule */</span>
    <span class="token annotation punctuation">@Binds</span>
    <span class="token annotation punctuation">@IntoMap</span>
    <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token class-name">FlashlightTile</span><span class="token punctuation">.</span><span class="token constant">TILE_SPEC</span><span class="token punctuation">)</span>
    fun <span class="token function">bindFlashlightTile</span><span class="token punctuation">(</span>flashlightTile<span class="token operator">:</span> <span class="token class-name">FlashlightTile</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileImpl</span><span class="token operator">&lt;</span><span class="token operator">*</span><span class="token operator">&gt;</span>



    <span class="token comment">/** Inject ScreenShotTile into tileMap in QSModule */</span>
    <span class="token annotation punctuation">@Binds</span>
    <span class="token annotation punctuation">@IntoMap</span>
    <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token class-name">ScreenShotTile</span><span class="token punctuation">.</span><span class="token constant">TILE_SPEC</span><span class="token punctuation">)</span>
    fun <span class="token function">bindScreenShotTile</span><span class="token punctuation">(</span>screenShot<span class="token operator">:</span> <span class="token class-name">ScreenShotTile</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileImpl</span><span class="token operator">&lt;</span><span class="token operator">*</span><span class="token operator">&gt;</span>

    <span class="token comment">/** Inject LocationTile into tileMap in QSModule */</span>
    <span class="token annotation punctuation">@Binds</span>
    <span class="token annotation punctuation">@IntoMap</span>
    <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token class-name">LocationTile</span><span class="token punctuation">.</span><span class="token constant">TILE_SPEC</span><span class="token punctuation">)</span>
    fun <span class="token function">bindLocationTile</span><span class="token punctuation">(</span>locationTile<span class="token operator">:</span> <span class="token class-name">LocationTile</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileImpl</span><span class="token operator">&lt;</span><span class="token operator">*</span><span class="token operator">&gt;</span>

    <span class="token comment">/** Inject CameraToggleTile into tileMap in QSModule */</span>
    <span class="token annotation punctuation">@Binds</span>
    <span class="token annotation punctuation">@IntoMap</span>
    <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token class-name">CameraToggleTile</span><span class="token punctuation">.</span><span class="token constant">TILE_SPEC</span><span class="token punctuation">)</span>
    fun <span class="token function">bindCameraToggleTile</span><span class="token punctuation">(</span>cameraToggleTile<span class="token operator">:</span> <span class="token class-name">CameraToggleTile</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileImpl</span><span class="token operator">&lt;</span><span class="token operator">*</span><span class="token operator">&gt;</span>

    <span class="token comment">/** Inject MicrophoneToggleTile into tileMap in QSModule */</span>
    <span class="token annotation punctuation">@Binds</span>
    <span class="token annotation punctuation">@IntoMap</span>
    <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token class-name">MicrophoneToggleTile</span><span class="token punctuation">.</span><span class="token constant">TILE_SPEC</span><span class="token punctuation">)</span>
    fun <span class="token function">bindMicrophoneToggleTile</span><span class="token punctuation">(</span>microphoneToggleTile<span class="token operator">:</span> <span class="token class-name">MicrophoneToggleTile</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileImpl</span><span class="token operator">&lt;</span><span class="token operator">*</span><span class="token operator">&gt;</span>

    <span class="token comment">/** Inject AlarmTile into tileMap in QSModule */</span>
    <span class="token annotation punctuation">@Binds</span>
    <span class="token annotation punctuation">@IntoMap</span>
    <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token class-name">AlarmTile</span><span class="token punctuation">.</span><span class="token constant">TILE_SPEC</span><span class="token punctuation">)</span>
    fun <span class="token function">bindAlarmTile</span><span class="token punctuation">(</span>alarmTile<span class="token operator">:</span> <span class="token class-name">AlarmTile</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileImpl</span><span class="token operator">&lt;</span><span class="token operator">*</span><span class="token operator">&gt;</span>

    <span class="token annotation punctuation">@Binds</span>
    <span class="token annotation punctuation">@IntoMap</span>
    <span class="token annotation punctuation">@StringKey</span><span class="token punctuation">(</span><span class="token class-name">UiModeNightTile</span><span class="token punctuation">.</span><span class="token constant">TILE_SPEC</span><span class="token punctuation">)</span>
    fun <span class="token function">bindUiModeNightTile</span><span class="token punctuation">(</span>uiModeNightTile<span class="token operator">:</span> <span class="token class-name">UiModeNightTile</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">QSTileImpl</span><span class="token operator">&lt;</span><span class="token operator">*</span><span class="token operator">&gt;</span>
<span class="token punctuation">}</span>

</code></pre>
    <p>
     编译导入，然后杀掉systemui的进程即可
    </p>
    <pre><code class="prism language-bash"><span class="token function">make</span> SystemUI<span class="token punctuation">;</span>adb push out/target/product/blueline/system_ext/priv-app/SystemUI/SystemUI.apk /system_ext/priv-app/SystemUI/SystemUI.apk
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/da7f889b02804c8abfa05757f963127a.gif#pic_center"/>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f613536383437383331322f:61727469636c652f64657461696c732f313436313431343731" class_="artid" style="display:none">
 </p>
</div>


