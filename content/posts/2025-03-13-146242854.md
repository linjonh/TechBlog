---
layout: post
title: "正常的一个编码器的架构是怎么样,有哪些模块构成"
date: 2025-03-13 21:38:11 +0800
description: "在音视频编码器（Video Encoder）中，通常包括多个核心模块，整个编码器架构遵循。，能更好地进行音视频编码优化！"
keywords: "正常的一个编码器的架构是怎么样，有哪些模块构成"
categories: ['未分类']
tags: ['音视频']
artid: "146242854"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146242854
    alt: "正常的一个编码器的架构是怎么样,有哪些模块构成"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146242854
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146242854
cover: https://bing.ee123.net/img/rand?artid=146242854
image: https://bing.ee123.net/img/rand?artid=146242854
img: https://bing.ee123.net/img/rand?artid=146242854
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     正常的一个编码器的架构是怎么样，有哪些模块构成
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     <strong>
      正常的一个编码器架构及其模块构成
     </strong>
    </p>
    <p>
     在音视频编码器（Video Encoder）中，通常包括多个核心模块，整个编码器架构遵循
     <strong>
      输入 -&gt; 预处理 -&gt; 编码核心 -&gt; 码流封装
     </strong>
     的流程。
    </p>
    <hr/>
    <h4>
     <strong>
      1. 编码器的整体架构
     </strong>
    </h4>
    <p>
     编码器的主要架构如下：
    </p>
    <p>
     <code>
      ┌──────────────────────────────────┐ │ **视频输入 (RAW/YUV)** │ │ 传感器、视频文件、摄像头数据等 │ └──────────────┬─────────────┘ │ ┌──────────────┴──────────────┐ │ **预处理模块 (Preprocessing)** │ │ 颜色空间转换、缩放、去噪、帧率调整 │ └──────────────┬──────────────┘ │ ┌──────────────┴──────────────┐ │ **编码核心 (Encoding Core)** │ │ (1) 帧内/帧间预测 │ │ (2) 变换量化 │ │ (3) 熵编码 │ └──────────────┬──────────────┘ │ ┌──────────────┴──────────────┐ │ **码流封装 (Bitstream Packaging)** │ │ 组帧、NALU 组包、RTP 打包等 │ └──────────────┬──────────────┘ │ ┌──────────────┴──────────────┐ │ **网络/存储 (Network/Storage)** │ │ 传输（RTMP/SRT）或存储（MP4/TS） │ └────────────────────────────┘
     </code>
    </p>
    <hr/>
    <h4>
     <strong>
      2. 主要模块详解
     </strong>
    </h4>
    <h5>
     <strong>
      (1) 预处理模块（Preprocessing）
     </strong>
    </h5>
    <p>
     <strong>
      主要功能：
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       颜色空间转换
      </strong>
      （RGB -&gt; YUV420P）
     </li>
     <li>
      <strong>
       图像缩放
      </strong>
      （如 1080P 转 720P）
     </li>
     <li>
      <strong>
       去噪
      </strong>
      （降噪滤波）
     </li>
     <li>
      <strong>
       帧率调整
      </strong>
      （如 30fps 降到 15fps）
     </li>
    </ul>
    <p>
     <strong>
      技术实现：
     </strong>
    </p>
    <ul>
     <li>
      FFmpeg
      <code>
       swscale
      </code>
      进行颜色转换：
     </li>
    </ul>
    <h5>
     <strong>
      (2) 编码核心（Encoding Core）
     </strong>
    </h5>
    <p>
     <strong>
      主要模块：
     </strong>
    </p>
    <ol>
     <li>
      <strong>
       帧内预测（Intra Prediction）
      </strong>
      <ul>
       <li>
        只利用当前帧信息，适用于静态场景。
       </li>
       <li>
        H.264 支持
        <strong>
         9 种方向预测模式
        </strong>
        。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       帧间预测（Inter Prediction）
      </strong>
      <ul>
       <li>
        使用 P 帧（前向参考）或 B 帧（前后参考）减少数据量。
       </li>
       <li>
        运动估计算法：
        <strong>
         块匹配算法（Block Matching Algorithm）
        </strong>
        。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       变换量化（Transform &amp; Quantization）
      </strong>
      <ul>
       <li>
        使用
        <strong>
         DCT（离散余弦变换）
        </strong>
        提取重要信息。
       </li>
       <li>
        量化（Quantization）降低数据精度以减少比特率。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       熵编码（Entropy Coding）
      </strong>
      <ul>
       <li>
        采用 CABAC/CAVLC 进行无损压缩，降低码率。
       </li>
      </ul>
     </li>
    </ol>
    <p>
     <strong>
      技术实现：
     </strong>
    </p>
    <ul>
     <li>
      H.264 采用
      <strong>
       CAVLC 或 CABAC
      </strong>
      算法进行熵编码：
     </li>
    </ul>
    <hr/>
    <h5>
     <strong>
      (3) 码流封装（Bitstream Packaging）
     </strong>
    </h5>
    <p>
     <strong>
      主要功能：
     </strong>
    </p>
    <ul>
     <li>
      将编码后的数据封装成标准
      <strong>
       NALU（Network Abstraction Layer Unit）
      </strong>
      格式。
     </li>
     <li>
      组成 GOP（Group of Pictures），提高解码效率。
     </li>
     <li>
      <strong>
       支持不同封装格式
      </strong>
      ：
      <ul>
       <li>
        RTMP 直播流：封装为 FLV
       </li>
       <li>
        RTP 传输：封装为 RTP 包
       </li>
       <li>
        存储：封装为 MP4 或 TS
       </li>
      </ul>
     </li>
    </ul>
    <p>
     <strong>
      技术实现：
     </strong>
    </p>
    <ul>
     <li>
      使用 FFmpeg 将编码数据封装为 MP4：
     </li>
    </ul>
    <hr/>
    <h5>
     <strong>
      (4) 网络传输（Streaming / Storage）
     </strong>
    </h5>
    <p>
     <strong>
      主要功能：
     </strong>
    </p>
    <ul>
     <li>
      直播：RTMP / SRT / RTP
     </li>
     <li>
      存储：MP4 / TS / FLV
     </li>
     <li>
      码率控制（CBR / VBR）
     </li>
    </ul>
    <p>
     <strong>
      技术实现：
     </strong>
    </p>
    <ul>
     <li>
      FFmpeg 推 RTMP 流：
     </li>
    </ul>
    <hr/>
    <h3>
     <strong>
      3. 编码器的技术难点
     </strong>
    </h3>
    <h4>
     <strong>
      (1) 码率控制（Bitrate Control）
     </strong>
    </h4>
    <ul>
     <li>
      <strong>
       CBR（固定码率）
      </strong>
      ：适合直播，码率固定，但质量可能下降。
     </li>
     <li>
      <strong>
       VBR（可变码率）
      </strong>
      ：适合本地存储，质量更好但码率波动大。
     </li>
     <li>
      <strong>
       解决方案
      </strong>
      ：
      <ul>
       <li>
        使用
        <strong>
         QP 调节
        </strong>
        ，适当降低复杂帧的 QP 值
       </li>
      </ul>
     </li>
    </ul>
    <hr/>
    <h4>
     <strong>
      (2) 低延迟优化（Low Latency Encoding）
     </strong>
    </h4>
    <ul>
     <li>
      <strong>
       关键问题
      </strong>
      ：
      <ul>
       <li>
        H.264 默认有
        <strong>
         B 帧（双向预测帧）
        </strong>
        ，导致延迟增加。
       </li>
       <li>
        <strong>
         解决方案
        </strong>
        ：
        <ul>
         <li>
          <strong>
           禁用 B 帧
          </strong>
          ：
         </li>
         <li>
          <strong>
           使用超快编码模式
          </strong>
          ：
         </li>
        </ul>
       </li>
      </ul>
     </li>
    </ul>
    <hr/>
    <h4>
     <strong>
      (3) 音视频同步（A/V Synchronization）
     </strong>
    </h4>
    <ul>
     <li>
      <strong>
       问题
      </strong>
      ：
      <ul>
       <li>
        视频帧率和音频采样率不同，可能导致
        <strong>
         音画不同步
        </strong>
        。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       解决方案
      </strong>
      ：
      <ul>
       <li>
        计算
        <strong>
         音视频时间戳（PTS/DTS）
        </strong>
        ，确保时间基一致：
       </li>
      </ul>
     </li>
    </ul>
    <h3>
     <strong>
      总结
     </strong>
    </h3>
    <h4>
     <strong>
      编码器的核心架构
     </strong>
    </h4>
    <ol>
     <li>
      <strong>
       视频采集 &amp; 预处理
      </strong>
      （去噪、缩放、格式转换）
     </li>
     <li>
      <strong>
       编码核心
      </strong>
      （帧内/帧间预测、变换量化、熵编码）
     </li>
     <li>
      <strong>
       码流封装
      </strong>
      （H.264/H.265 NALU 结构）
     </li>
     <li>
      <strong>
       网络传输 &amp; 存储
      </strong>
      （RTMP/SRT 推流、MP4 录制）
     </li>
    </ol>
    <h4>
     <strong>
      常见技术难点
     </strong>
    </h4>
    <ol>
     <li>
      <strong>
       码率控制（CBR/VBR 调优）
      </strong>
     </li>
     <li>
      <strong>
       低延迟优化（禁用 B 帧、减少缓冲）
      </strong>
     </li>
     <li>
      <strong>
       音视频同步（时间戳调整）
      </strong>
     </li>
    </ol>
    <p>
     掌握
     <strong>
      FFmpeg、H.264/H.265 编码技术、SRT/RTMP 传输
     </strong>
     ，能更好地进行音视频编码优化！
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34393532393530372f:61727469636c652f64657461696c732f313436323432383534" class_="artid" style="display:none">
 </p>
</div>


