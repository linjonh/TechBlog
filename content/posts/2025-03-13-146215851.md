---
layout: post
title: "HCIA复习实验拓扑详细版"
date: 2025-03-13 01:03:43 +0800
description: "1.学校内部的HTTP客户端可以正常通过域名www.baidu.com访问到百度网络中HTTP服务器2.学校网络内部网段基于192.168.1.0/24划分，PC1可以正常访问3.3.3.0/24网段，但是PC2不允许3.学校内部路由使用静态路由，R1和R2之间两条链路进行浮动静态4.运营商网络内部使用动态路由协议5.AR1可以被telnet远程控制。"
keywords: "HCIA复习实验拓扑详细版"
categories: ['未分类']
tags: ['网络', '智能路由器']
artid: "146215851"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146215851
    alt: "HCIA复习实验拓扑详细版"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146215851
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146215851
cover: https://bing.ee123.net/img/rand?artid=146215851
image: https://bing.ee123.net/img/rand?artid=146215851
img: https://bing.ee123.net/img/rand?artid=146215851
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     HCIA复习实验拓扑详细版
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h2>
     一.拓扑图
    </h2>
    <h2>
     <img alt="" height="983" src="https://i-blog.csdnimg.cn/direct/04d8ac1f534448e289d84c1fcdad3daf.png" width="1347">
      <br/>
      二.需求
     </img>
    </h2>
    <p>
     1.学校内部的HTTP客户端可以正常通过域名www.baidu.com访问到百度网络中HTTP服务器
    </p>
    <p>
     2.学校网络内部网段基于192.168.1.0/24划分，PC1可以正常访问3.3.3.0/24网段，但是PC2不允许
    </p>
    <p>
     3.学校内部路由使用静态路由，R1和R2之间两条链路进行浮动静态
    </p>
    <p>
     4.运营商网络内部使用动态路由协议
    </p>
    <p>
     5.AR1可以被telnet远程控制
    </p>
    <h2>
     三.步骤分析
    </h2>
    <h3>
     第一步：由大化小
    </h3>
    <p style="margin-left:0; margin-right:0">
     将拓扑图分成三个架构 (学校内网，运营商，百度网络)，再着眼于其中一个架构
    </p>
    <h3 style="margin-left:0px; margin-right:0px">
     第二步： 先看学校内网：
    </h3>
    <p>
     <span style="color:#1a439c">
      将学校内网分成两个部分
     </span>
     ：1.二层交换机  2.三层路由器   【
     <span style="color:#be191c">
      先配二层再做三层
     </span>
     】
    </p>
    <h5>
     2.1：配置交换机：
    </h5>
    <p>
     1.创建VLAN
    </p>
    <p>
     2.接口划分VLAN：
    </p>
    <p>
     access链路：连接终端，终端无法处理802.1Q数据帧；
    </p>
    <p style="margin-left:0; margin-right:0">
     特征：1.发送数据时，不携带Tag
    </p>
    <p style="margin-left:0; margin-right:0">
     2.仅放通一个VLAN
    </p>
    <p style="margin-left:0; margin-right:0">
    </p>
    <p style="margin-left:0; margin-right:0">
     trunk链路：连接交换机。
    </p>
    <p style="margin-left:0; margin-right:0">
     特征：1.允许放通多个VLAN
    </p>
    <p style="margin-left:0; margin-right:0">
     2.发送数据时，大部分会携带Tag
    </p>
    <h6 style="margin-left:0px; margin-right:0px">
     代码：
    </h6>
    <pre><code class="hljs">[Swl] interface g0/0/1 
[Swl-GigabitEthernet0/0/1] port link-type access
[Swl-GigabitEthernet0/0/1] port default vlan 3

[Swl-GigabitEthernet0/0/2]port link-type access
[Swl-GigabitEthernet0/0/2] port default vlan 3

[Swl-GigabitEthernet0/0/3]port link-type access
[Swl-GigabitEthernet0/0/3] port default vlan 2

//因为路由器g0/0/0接口为子接口，子接口接受的信息必须携带标签

[Swl-GigabitEthernet0/0/4]port link-type trunk
[Swl-GigabitEthernet0/0/4] port trunk allow-pss vlan 2 3
</code></pre>
    <h5>
     2.2 配置三层路由器进行网段划分
    </h5>
    <p>
     1.判断学校内网有几个广播域(四个):路由器两个接口，交换机两个VLAN(路由器其中一个接口广播域消失)
    </p>
    <p>
     2. 将192.168.1.0/24子网划分-----VLSM--可变长子网掩码(逻辑地址：从主机位借位给网络位，被借的位数被称为子网位)
    </p>
    <p>
     考虑到IP地址浪费问题从用户网段+骨干网段 出发：
    </p>
    <pre><code class="hljs">192.168.1.0/25---用户
    192.168.1.0/26----VLAN 2
    192.168.1.64/26---VLAN 3

192.168.1.128/25--骨干
    192.168.1.128/30
    192.168.1.132/30</code></pre>
    <p>
     <img alt="" height="884" src="https://i-blog.csdnimg.cn/direct/9bf8bb4cdaab4ba98e3a4260c9a8cee1.png" width="590"/>
    </p>
    <h6>
     代码：
    </h6>
    <pre><code class="hljs">[r1] interface g0/0/0
[r1-GigabitEthernet0/0/0]ip address 192.168.1.133 30

[r1-GigabitEthernet0/0/2]ip address 192.168.1.129 30

[r2-GigabitEthernet0/0/1]ip address 192.168.1.134 30
[r2-GigabitEthernet0/0/2]ip address 192.168.1.130 30
</code></pre>
    <h5>
     2.3 R2的G0/0/0接口为子接口
    </h5>
    <p>
     子接口：诞生目的：为了处理VLAN Tag
    </p>
    <p>
     属于逻辑接口
    </p>
    <p>
     子接口继承物理接口的特性：1.可以通过物理接口收发数据 2.具备物理接口的MAC地址
    </p>
    <h6>
     代码：
    </h6>
    <pre><code class="hljs">[r2]Interface g0/0/0.2
[r2-GigabitEthernet0/0/0.2]ip address 192.168.1.126 26
[r2-GigabitEthernet0/0/0.2]dot1q termination vid 2


[r2]Interface g0/0/0.3
[r2-GigabitEthernet0/0/0.3]ip address 192.168.1.62 26
[r2-GigabitEthernet0/0/0.3]dot1q termination vid 2
</code></pre>
    <p>
     <img alt="" height="193" src="https://i-blog.csdnimg.cn/direct/a35fc260ed5040a7881da9741b6fe787.png" width="1107"/>
    </p>
    <h5>
     2.4 开启两个子接口的ARP广播
    </h5>
    <p>
     可以避免由于eNSP自身问题导致不能ping通
    </p>
    <h6>
     代码：
    </h6>
    <pre><code class="hljs">[r2-GigabitEthernet0/0/0.2]arp broadcast enable

[r2-GigabitEthernet0/0/0.3]arp broadcast enabel
</code></pre>
    <h5>
     2.5 检验
    </h5>
    <h6>
     PC1ping 192.168.1.62
    </h6>
    <p>
     <img alt="" height="545" src="https://i-blog.csdnimg.cn/direct/faa7868cbeef41d79f918fa6e65ce3f2.png" width="1171"/>
    </p>
    <p>
     <img alt="" height="266" src="https://i-blog.csdnimg.cn/direct/a40ee92260da40a083d06e810c8eb519.png" width="897"/>
    </p>
    <p>
     PC1ping 客户端
    </p>
    <p>
     <img alt="" height="500" src="https://i-blog.csdnimg.cn/direct/bac90e40247648ba98a775811ee3d388.png" width="1130"/>
    </p>
    <p>
    </p>
    <p>
     <img alt="" height="421" src="https://i-blog.csdnimg.cn/direct/37abc9d33c094257be2174deb83582a0.png" width="977"/>
    </p>
    <p>
     检验完成后ping 192.168.1.129
    </p>
    <p>
     这个时候不能ping通192.168.1.129/30【R1】因为R1现在路由不完整所以进行下一步
    </p>
    <h3>
     第三步：给R1补充路由
    </h3>
    <p>
     CIDR---无类域间路由
    </p>
    <h5>
     3.1配置静态路由
    </h5>
    <pre><code class="hljs">[r1]ip route-static 192.168.1.0 25 192.168.1.1.130
</code></pre>
    <h5>
     3.2配置浮动静态路由（备份路由）
    </h5>
    <pre><code class="hljs">[r1] ip route-static 192.168.1.0 25 192.168.1.134 poreference 61
</code></pre>
    <p>
     <img alt="" height="501" src="https://i-blog.csdnimg.cn/direct/c999d101e8ad4ee8a7f95eb465541df6.png" width="1168"/>
    </p>
    <h6>
     这个时候就实现了学校内部网络全通
    </h6>
    <h3>
     第四步：运营商网络
    </h3>
    <h5>
     4.1 配置IP
    </h5>
    <p>
     <img alt="" height="447" src="https://i-blog.csdnimg.cn/direct/300493b316f34442befe2c1a77dc2e48.png" width="726"/>
    </p>
    <pre><code class="hljs">[r1-GigabitEthernet0/0/1]ip address 13.0.0.1 24

[r3-GigabitEthernet0/0/0]ip address 13.0.0.3 24

[r3-GigabitEthernet0/0/1]ip address  34.0.0.3 24

[r3-GigabitEthernet0/0/2]ip address  35.0.0.3 24

环回接口
Int 1 0
[r3-LoopBack0]ip address 3.3.3.3 24

[r4-GigabitEthernet0/0/0]ip address  34.0.0.4 24
[r4-GigabitEthernet0/0/1]ip address  100.1.1.254 24

[r5-GigabitEthernet0/0/0]ip address  34.0.0.5 24
[r5-GigabitEthernet0/0/1]ip address  56.0.0.5 24

[r6-GigabitEthernet0/0/0]ip address  56.0.0.6 24
</code></pre>
    <h5>
     4.2 配置路由协议
    </h5>
    <p>
     <strong>
      <span style="color:#1a439c">
       运行OSPF协议的：R3 R4 R5
      </span>
     </strong>
    </p>
    <pre><code class="hljs">[r3]ospf 1 router-id 3.3.3.3
[r3-ospf-1]area 0
[r3-ospf-1-area-0.0.0.0]network 13.0.0.3 0.0.0.0
[r3-ospf-1-area-0.0.0.0]network 34.0.0.3 0.0.0.0
[r3-ospf-1-area-0.0.0.0]network 35.0.0.3 0.0.0.0
[r3-ospf-1-area-0.0.0.0]network 3.3.3.3   0.0.0.0

[r4]ospf 1 router-id 4.4.4.4
[r4-ospf-1]area 0
[r4-ospf-1-area-0.0.0.0]network 34.0.0.4       0.0.0.0
[r4-ospf-1-area-0.0.0.0]network 100.1.1.254 0.0.0.0

[r5]ospf 1 router-id 5.5.5.5
[r5-ospf-1]area 0
[r5-ospf-1-area-0.0.0.0]network 35.0.0.5       0.0.0.0
[r5-ospf-1-area-0.0.0.0]network 56.0.0.5      0.0.0.0
</code></pre>
    <h3>
     第五步：百度网络
    </h3>
    <p>
     <img alt="" height="476" src="https://i-blog.csdnimg.cn/direct/7878b6041453489989c701af74649540.png" width="370"/>
    </p>
    <p>
     <img alt="" height="488" src="https://i-blog.csdnimg.cn/direct/49be75dcfb054d8b811b6f12252a8865.png" width="1120"/>
    </p>
    <pre><code class="hljs">[r6-GigabitEthernet0/0/1]ip address 10.1.1.254 24</code></pre>
    <h6>
     这个时候不同区域内部全通，下面进行不同区域之间的通信
    </h6>
    <h3>
     第六步：学校内网与运营商
    </h3>
    <h5 style="margin-left:0px; margin-right:0px">
     6.1 给R2补路由
    </h5>
    <p style="margin-left:0; margin-right:0">
     不能将公网IP所有写进路由表所以需要将公网IP汇总（0.0.0.0）
    </p>
    <p style="margin-left:0; margin-right:0">
     给R2写缺省路由
    </p>
    <p style="margin-left:0; margin-right:0">
     对于私网环境而言，缺省路由的方向一定是指向公网环境
    </p>
    <pre><code class="hljs">[r2]Ip route-static 0.0.0.0 0 192.168.1.129
[r2]Ip route-static 0.0.0.0 0 192.168.1.131 preference 61
</code></pre>
    <h5>
     6.2 给R1补路由
    </h5>
    <pre><code class="hljs">[r1]Ip route-static 0.0.0.0 0 13.0.0.3</code></pre>
    <h6 style="margin-left:0px; margin-right:0px">
     这个时候学校内网还没有跟运营商通因为没有回程路由
    </h6>
    <p style="margin-left:0; margin-right:0">
     现在不能通过补路由的方式，因为公网设备不允许存在私网IP
    </p>
    <p style="margin-left:0; margin-right:0">
     可以用NAT--网络地址转换协议：
    </p>
    <p style="margin-left:0; margin-right:0">
     Esay-ip:用于转换源地址（在边界设备的公网接口上配置）
    </p>
    <p style="margin-left:0; margin-right:0">
     NAT Server:用于转换目的地址
    </p>
    <p style="margin-left:0; margin-right:0">
     将192.168.1.1转换成13.0.0.1
    </p>
    <p>
    </p>
    <pre><code class="hljs">这里用easy-ip
[r1]acl 2000
[r1-acl-basic-2000]rule permit source 192.168.1.0 0.0.0.255

[r1-GigabitEthernet0/0/1]nat outbound 2000
</code></pre>
    <p>
     <img alt="" height="470" src="https://i-blog.csdnimg.cn/direct/40876ee753e24199a617d3499b39995e.png" width="1107"/>
    </p>
    <h6>
     学校内网跟运营商就可以通了
    </h6>
    <p>
     <img alt="" height="167" src="https://i-blog.csdnimg.cn/direct/21dc6b17c7f44da5ad77061360fb2fa7.png" width="1114"/>
    </p>
    <h3>
     第七步 运营商跟百度网络
    </h3>
    <pre><code class="hljs">[r6]ip route-static 0.0.0.0 0 56.0.0.5
[r6]acl 2000
[r6-acl-basic-2000]rule permit source 10.1.1.0 0.0.0.255

[r6-GigabitEthernet0/0/0]nat outbound 2000
</code></pre>
    <h6>
     运营商跟百度网络通了
    </h6>
    <p>
     <img alt="" height="750" src="https://i-blog.csdnimg.cn/direct/fe0b3ed592ed46f28d170b051304556a.png" width="1095"/>
    </p>
    <h3>
     第八步：学校内网跟百度网络
    </h3>
    <p style="margin-left:0; margin-right:0">
     需要将公网地址变成56.0.0.6才能发到R6
    </p>
    <p style="margin-left:0; margin-right:0">
     R6需要将56.0.0.6变成10.1.1.0/24 （用NAT Server）
    </p>
    <pre><code class="hljs">[r6-GigabitEthernet0/0/0]nat server protocol tcp global current-interface www in side 10.1.1.1 www //将10.1.1.1：80映射为56.0.0.6</code></pre>
    <p>
     <img alt="" height="707" src="https://i-blog.csdnimg.cn/direct/5097dfc63eef47a8a635093e9df4d9f0.png" width="1120"/>
    </p>
    <h6>
     现在客户端可以访问服务器
    </h6>
    <h3>
     第九步：补充需求
    </h3>
    <h5>
     9.1 DNS域名解析
    </h5>
    <p>
     <img alt="" height="555" src="https://i-blog.csdnimg.cn/direct/ec98a83d44df449a99a1c9b71cea642d.png" width="1068"/>
    </p>
    <p>
     HTTP客户端加上域名
    </p>
    <p>
     <img alt="" height="491" src="https://i-blog.csdnimg.cn/direct/b35efcd8203d49278e7a0c2d69b108ee.png" width="1143"/>
    </p>
    <p>
     访问www.baidu.com
    </p>
    <p>
     <img alt="" height="651" src="https://i-blog.csdnimg.cn/direct/d587b674b1504a2387fe52b45f0137ff.png" width="1261"/>
    </p>
    <h5>
     9.2 PC1可以访问3.3.3.3PC2不能访问3.3.3.3
    </h5>
    <pre><code class="hljs">[r2]acl 3000
[r2-acl-adv-3000]rule permit ip source 192.168.1.1 0 destination 3.3.3.3 0

[r2-acl-adv-3000]rule permit ip source 192.168.1.0 0.0.0.63 destination 3.3.3.3 0

[r2-GigabitEthernet0/0/0]traffic-filter inbound acl 3000

[r2-GigabitEthernet0/0/0.3]dhcp select interface
[r2-GigabitEthernet0/0/0.3]dhcp server dns-list 100.1.1.0
</code></pre>
    <h5>
     9.3 R1可以被R3远程
    </h5>
    <pre><code class="hljs">[r1]user-interface vty 0 4
[r1-ul-vty0-4]authentication-mode aaa
[r1-aaa]local-user huawei password cliper 123456
[r1-aaa]local-user huawei  service-type telnet
</code></pre>
    <p>
     <img alt="" height="436" src="https://i-blog.csdnimg.cn/direct/3711ef452d834ab2a3b567196fe5c834.png" width="583"/>
    </p>
    <h6>
     所以需求配置完成
    </h6>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f6d656e6765323333332f:61727469636c652f64657461696c732f313436323135383531" class_="artid" style="display:none">
 </p>
</div>


