---
layout: post
title: "Flask从入门到精通-初始Flask"
date: 2025-03-16 23:36:20 +0800
description: "在创建虚拟环境时，如果项目根目录下没有Pipfile文件，pipenv install命令还会在项目文件夹根目录下创建Pipfile和Pipfile.lock文件，前者用来记录项目依赖包列表，而后者记录了固定版本的详细依赖包列表。推荐Pipenv进行虚拟环境管理，Pipenv是基于pip的Python包管理工具，它和pip的用法非常相似，可以看作pip的加强版，它的出现解决了旧的pip+virtualenv+requirements.txt的工作方式的弊端。Flask不会替你做决定，也不会限制你的选择。"
keywords: "Flask从入门到精通--初始Flask"
categories: ['Python']
tags: ['后端', 'Python', 'Flask']
artid: "146303876"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146303876
    alt: "Flask从入门到精通-初始Flask"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146303876
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146303876
cover: https://bing.ee123.net/img/rand?artid=146303876
image: https://bing.ee123.net/img/rand?artid=146303876
img: https://bing.ee123.net/img/rand?artid=146303876
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Flask从入门到精通--初始Flask
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="_0">
     </a>
     基本了解
    </h3>
    <p>
     Flask是使用Python编写的Web微框架。Web框架可以让我们不用关心底层的请求响应处理，更方便高效地编写Web程序。
     <strong>
      因为Flask核心简单且易于扩展，所以被称作微框架(micro framework)
     </strong>
     。
    </p>
    <p>
     <strong>
      Flask有两个主要依赖：
     </strong>
    </p>
    <ul>
     <li>
      一个是**WSGI（**Web Server Gateway Interface，Web服务器网关接口）工具集——Werkzeug(
      <a href="http://werkzeug.pocoo.org/" rel="nofollow">
       http://werkzeug.pocoo.org/
      </a>
      )
     </li>
     <li>
      另一个是
      <strong>
       Jinja2模板引擎
      </strong>
      (
      <a href="http://jinja.pocoo.org/" rel="nofollow">
       http://jinja.pocoo.org/
      </a>
      )。
     </li>
    </ul>
    <p>
     <strong>
      Flask只保留了Web开发的核心功能，其他的功能都由外部扩展来实现
     </strong>
     ，比如数据库集成、表单认证、文件上传等。如果没有合适的扩展，你甚至可以自己动手开发。Flask不会替你做决定，也不会限制你的选择。总之，Flask可以变成任何你想要的东西，一切都由你做主。
    </p>
    <blockquote>
     <p>
      WSGI(Web Server Gateway Interface)是Python中用来规定Web服务器如何与Python Web程序进行沟通的标准
     </p>
    </blockquote>
    <h3>
     <a id="_13">
     </a>
     开发环境搭建
    </h3>
    <p>
     推荐Pipenv进行虚拟环境管理，Pipenv是基于pip的Python包管理工具，它和pip的用法非常相似，可以看作pip的加强版，它的出现解决了旧的pip+virtualenv+requirements.txt的工作方式的弊端。
    </p>
    <p>
     默认情况下，Pipenv会统一管理所有虚拟环境。在Windows系统中，虚拟环境文件夹会在C：\Users\Administrator.virtualenvs\目录下创建。
    </p>
    <h4>
     <a id="pipenv_19">
     </a>
     安装pipenv:
    </h4>
    <pre><code class="prism language-Bash">pip install pipenv
</code></pre>
    <h4>
     <a id="_25">
     </a>
     创建虚拟环境：
    </h4>
    <pre><code class="prism language-Bash">pipenv install
</code></pre>
    <p>
     这会为当前项目创建一个文件夹，其中包含隔离的Python解释器环境，并且安装pip、wheel、setuptools等基本的包。因为示例程序仓库里包含Pipfile文件，所以这个文件中列出的依赖包也会一并被安装。默认情况下，Pipenv会统一管理所有虚拟环境。在Windows系统中，虚拟环境文件夹会在C：\Users\Administrator.virtualenvs\目录下创建。
    </p>
    <h4>
     <a id="_33">
     </a>
     激活虚拟环境
    </h4>
    <p>
     在单独使用Virtualenv时，我们通常会显式地激活虚拟环境。在Pipenv中，可以使用pipenv shell命令显式地激活虚拟环境：
    </p>
    <pre><code class="prism language-Bash">pipenv shell
</code></pre>
    <p>
     当执行pipenv shell或pipenv run命令时，Pipenv会自动从项目目录下的.env文件中加载环境变量。
    </p>
    <p>
     除了显式地激活虚拟环境，Pipenv还提供了一个
     <strong>
      pipenv run
     </strong>
     命令，这个命令允许你不显式激活虚拟环境即可在当前项目的虚拟环境中执行命令:
    </p>
    <pre><code class="prism language-Bash">pipenv run python hello.py
</code></pre>
    <h4>
     <a id="_49">
     </a>
     管理依赖
    </h4>
    <p>
     如果你打算开源的话，就可能会有更多的人需要在他们的电脑上运行。为了能顺利运行程序，他们不得不记下所有依赖包，然后使用pip或Pipenv安装，这些重复无用的工作当然应该避免。在以前我们通常使用pip搭配一个requirements.txt文件来记录依赖。但requirements.txt需要手动维护，在使用上不够灵活。Pipfile的出现就是为了替代难于管理的requirements.txt。
    </p>
    <p>
     在创建虚拟环境时，如果项目根目录下没有Pipfile文件，pipenv install命令还会在项目文件夹根目录下创建Pipfile和Pipfile.lock文件，前者用来记录项目依赖包列表，而后者记录了固定版本的详细依赖包列表。当我们使用Pipenv安装/删除/更新依赖包时，Pipfile以及Pipfile.lock会自动更新。
    </p>
    <p>
     你可以使用
     <strong>
      pipenv graph命令查看当前环境下的依赖情况
     </strong>
     ，或是在虚拟环境中使用pip list命令查看依赖列表。
    </p>
    <p>
     当需要在一个新的环境运行程序时，只需要执行pipenv install命令。Pipenv就会创建一个新的虚拟环境，然后自动从Pipfile中读取依赖并安装到新创建的虚拟环境中。
    </p>
    <h4>
     <a id="Flask_61">
     </a>
     安装Flask
    </h4>
    <pre><code class="prism language-Bash">pipenv install flask
</code></pre>
    <h4>
     <a id="IDE_69">
     </a>
     使用IDE
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/575564856dce4f6aa12d634e7675b0a5.png"/>
    </p>
    <p>
     在Pycharm中配置好前面创建的虚拟环境路径之后，以后每次打开项目，PyCharm都会自动帮你激活虚拟环境，并且把工作目录定位到项目根目录。
    </p>
    <h3>
     <a id="Hello_Flask_78">
     </a>
     Hello Flask
    </h3>
    <h4>
     <a id="Flask_80">
     </a>
     最小Flask程序
    </h4>
    <pre><code class="prism language-Python">from flask import Flask

app = Flask(__name__)  # 

# the minimal Flask application
@app.route('/')
def index():
    return '&lt;h1&gt;Hello, World!&lt;/h1&gt;'
    
</code></pre>
    <ul>
     <li>
      创建Flask类的实例：先从flask包导入Flask类，这个类表示一个Flask程序。实例化这个类，就得到我们的程序实例app。
     </li>
     <li>
      注册路由：为函数附加app.route()装饰器，并传入URL规则作为参数，我们就可以让URL与函数建立关联。这个过程我们称为注册路由(route)，路由负责管理URL和函数之间的映射，而这个函数则被称为视图函数(view function)。
     </li>
     <li>
      URL为相对地址
     </li>
    </ul>
    <p>
     例如绝对路径为
     <a href="http://127.0.0.1:5000" rel="nofollow">
      http://127.0.0.1:5000
     </a>
     ，那么’/‘即表示网址’
     <a href="http://127.0.0.1:5000/" rel="nofollow">
      http://127.0.0.1:5000/
     </a>
     '。
    </p>
    <p>
     上述代码的意思就是，当你输入网址
     <a href="http://127.0.0.1:5000/" rel="nofollow">
      http://127.0.0.1:5000/
     </a>
     时，会调用index这个函数。这个函数会返回一些内容，从而显示为页面。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/e722da1befca4ceab6be2a678ab0381d.png"/>
    </p>
    <p>
     在一个Web应用里，客户端和服务器上的Flask程序的交互可以简单概括为以下几步：
    </p>
    <p>
     1)用户在浏览器输入URL访问某个资源。
    </p>
    <p>
     2)Flask接收用户请求并分析请求的URL。
    </p>
    <p>
     3)为这个URL找到对应的处理函数。
    </p>
    <p>
     4)执行函数并生成响应，返回给浏览器。
    </p>
    <p>
     5)浏览器接收并解析响应，将信息显示在页面中。
    </p>
    <h4>
     <a id="URL_117">
     </a>
     为一个视图函数绑定多个URL
    </h4>
    <pre><code class="prism language-Python">@app.route('/hi')
@app.route('/hello')
def say_hello():
    return '&lt;h1&gt;Hello, Flask!&lt;/h1&gt;'
</code></pre>
    <h4>
     <a id="URL_126">
     </a>
     动态URL
    </h4>
    <pre><code class="prism language-Python">@app.route('/greet/&lt;name&gt;')
def greet(name):
    return '&lt;h1&gt;Hello, %s!&lt;/h1&gt;' % name
</code></pre>
    <h3>
     <a id="Web_136">
     </a>
     启动开发服务器（查看Web网页）
    </h3>
    <h4>
     <a id="flask_run_138">
     </a>
     flask run
    </h4>
    <pre><code class="prism language-Bash">$ flask run
* Environment: production
  WARNING: Do not use the development server in a production environment.
  Use a production WSGI server instead.
* Debug mode: off
* Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
</code></pre>
    <p>
     flask run命令运行的开发服务器默认会监听
     <a href="http://127.0.0.1" rel="nofollow">
      http://127.0.0.1
     </a>
     ：5000/地址（按Ctrl+C退出）​，并开启多线程支持。
    </p>
    <p>
     打开网址
     <a href="http://127.0.0.1" rel="nofollow">
      http://127.0.0.1
     </a>
     ：5000/，会发现显示内容：
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/e722da1befca4ceab6be2a678ab0381d.png"/>
    </p>
    <h4>
     <a id="web_154">
     </a>
     自动发现web程序实例
    </h4>
    <p>
     一般来说，在执行flask run命令运行程序前，我们需要提供程序实例所在模块的位置。我们在上面可以直接运行程序，是因为Flask会自动探测程序实例，自动探测存在下面这些规则：
    </p>
    <p>
     • 从当前目录寻找app.py和wsgi.py模块，并从中
     <strong>
      寻找名为app或application
     </strong>
     的程序实例。
    </p>
    <p>
     • 从
     <strong>
      环境变量FLASK_APP
     </strong>
     对应的模块名/导入路径
     <strong>
      寻找名为app或application
     </strong>
     的程序实例。
    </p>
    <p>
     在Windows系统中使用set命令设置环境变量:
    </p>
    <pre><code class="prism language-Bash">&gt;set FLASK_APP=hello
</code></pre>
    <h4>
     <a id="Pycharm_172">
     </a>
     使用Pycharm直接运行服务器
    </h4>
    <p>
     配置过程如下：
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/c9ac04cd56b746e5a1c5bbe093378c0f.png"/>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/9221967efff44a3bbefb7be2f2282c0b.png"/>
    </p>
    <p>
     配置之后，可以直接在Pycharm中点运行就可以实现服务器启动。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/3097884496164378916e02d0c96cd452.png"/>
    </p>
    <h4>
     <a id="_186">
     </a>
     设置运行环境
    </h4>
    <p>
     开发环境(development environment)和生产环境(productionenvironment)是我们后面会频繁接触到的概念。开发环境是指我们在本地编写和测试程序时的计算机环境，而生产环境与开发环境相对，它指的是网站部署上线供用户访问时的服务器环境。
    </p>
    <p>
     为了区分程序运行环境，Flask提供了一个FLASK_ENV环境变量用来设置环境，默认为production（生产）​。
    </p>
    <pre><code class="prism language-Bash">FLASK_ENV=development
</code></pre>
    <p>
     在开发环境下，调试模式(Debug Mode)将被开启，这时执行flask run启动程序会
     <strong>
      自动激活Werkzeug
     </strong>
     内置的
     <strong>
      调试器(debugger)和重载器(reloader)
     </strong>
     ，它们会为开发带来很大的帮助。
    </p>
    <p>
     调试器允许你
     <strong>
      在错误页面上执行Python代码
     </strong>
     。单击错误信息右侧的命令行图标，会弹出窗口要求输入PIN码，也就是在启动服务器时命令行窗口打印出的调试器PIN码(Debugger PIN)。输入PIN码后，我们可以单击错误堆栈的某个节点右侧的命令行界面图标，这会打开一个
     <strong>
      包含代码执行上下文信息的Python Shell
     </strong>
     ，我们可以利用它来进行调试。
    </p>
    <p>
     如果项目中使用了单独的CSS或JavaScript文件时，那么浏览器可能会缓存这些文件，从而导致对文件做出的修改不能立刻生效。在浏览器中，我们可以
     <strong>
      按下Ctrl+F5或Shift+F5执行硬重载(hard reload)
     </strong>
     ，即忽略缓存并重载（刷新）页面。
    </p>
    <h3>
     <a id="Python_Shell_204">
     </a>
     Python Shell
    </h3>
    <p>
     在开发Flask程序时，我们并不会直接使用python命令启动PythonShell，而是使用flask shell命令：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/93239416d3634ae68863962eea4d8d8e.png"/>
    </p>
    <h3>
     <a id="Flask_210">
     </a>
     Flask扩展
    </h3>
    <p>
     我们将会接触到很多Flask扩展。扩展(extension)即使用Flask提供的API接口编写的Python库，可以为Flask程序添加各种各样的功能。
    </p>
    <h3>
     <a id="_216">
     </a>
     项目配置
    </h3>
    <p>
     在很多情况下，你需要设置程序的某些行为，这时你就需要使用配置变量。在Flask中，配置变量就是一些大写形式的Python变量，你也可以称之为配置参数或配置键。使用统一的配置变量可以避免在程序中以硬编码(hard coded)的形式设置程序。
    </p>
    <p>
     这些配置变量都通过Flask对象的app.config属性作为统一的接口来设置和获取。
    </p>
    <pre><code class="prism language-Python"># 像添加字典键值一样添加
app.config['ADMIN_NAME']='Peter'
# 一次加载多个值
app.config.update(
    TESTING=True,
    SECRET_KEY='_5#yF4Q8z\n\xec]'
)

</code></pre>
    <h3>
     <a id="URL_235">
     </a>
     URL与端点
    </h3>
    <p>
     当你修改了某个路由的URL规则，那么程序里对应的URL都要一个一个进行修改。更好的解决办法是使用Flask提供的
     <strong>
      url_for()函数获取URL
     </strong>
     ，当路由中定义的URL规则被修改时，这个函数总会返回正确的URL。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/a35dddcdd5fa48029924e96c06add3da.png"/>
    </p>
    <p>
     这时使用url_for(‘greet’，name=‘Jack’)得到的URL为“/hello/Jack”​。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a:2f2f626c6f672e6373646e2e6e65742f7a65726f5f6c7a792f:61727469636c652f64657461696c732f313436333033383736" class_="artid" style="display:none">
 </p>
</div>


