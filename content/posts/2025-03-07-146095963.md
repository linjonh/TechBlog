---
layout: post
title: "SpreadVue实现内置excel在线编辑并保存为后端可以接受的json格式"
date: 2025-03-07 15:04:39 +0800
description: "如何使用spreadVue内置excel实现在线编辑并保存效果"
keywords: "SpreadVue实现内置excel在线编辑并保存为后端可以接受的json格式"
categories: ['Vue']
tags: ['Spreadvue', 'Spreadjs', 'Json', 'Excel']
artid: "146095963"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146095963
    alt: "SpreadVue实现内置excel在线编辑并保存为后端可以接受的json格式"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146095963
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146095963
cover: https://bing.ee123.net/img/rand?artid=146095963
image: https://bing.ee123.net/img/rand?artid=146095963
img: https://bing.ee123.net/img/rand?artid=146095963
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     SpreadVue实现内置excel在线编辑并保存为后端可以接受的json格式
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <blockquote>
     <p>
      项目背景：需要在线录入部分数据，其他行数据由特定公式计算，且公式不可编辑，用于存在很多行公式，通过前端JS计算非常不方便，且公式一改js要变动的很多，所以这时候推荐使用SpreadVue内置excel
     </p>
    </blockquote>
    <h2>
     <a id="excel_2">
     </a>
     一、定义excel模板
    </h2>
    <h3>
     <a id="11_speadVue_3">
     </a>
     1.1 用speadVue默认例子，直接在线编辑模板，并绑定工作表
    </h3>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/1161b9a6138e47339feebcd7b7304744.png"/>
    </p>
    <h3>
     <a id="12_excel_5">
     </a>
     1.2 下载模板excel文件，补充行的公式，并锁定公式不允许编辑
    </h3>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/cca24114acff4c88842788b5018c3ea3.png"/>
    </p>
    <h2>
     <a id="_7">
     </a>
     二、实际使用
    </h2>
    <h3>
     <a id="21_excel_8">
     </a>
     2.1 初始化刚才保存的excel模板文件
    </h3>
    <pre><code class="prism language-java"><span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token char">'GET'</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//这里url是文件请求地址</span>
xhr<span class="token punctuation">.</span>responseType <span class="token operator">=</span> <span class="token char">'blob'</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span>onload <span class="token operator">=</span> function <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">var</span> blob <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>response<span class="token punctuation">;</span>
        <span class="token keyword">var</span> fd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"file"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>blob<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> fd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token punctuation">[</span>blob<span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token string">"文件名.xlsx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Spread</span><span class="token punctuation">.</span><span class="token keyword">import</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> function <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> function <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token punctuation">}</span><span class="token punctuation">,</span> openOptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <h3>
     <a id="22__25">
     </a>
     2.2 在录入数据后保存数据
    </h3>
    <pre><code class="prism language-java"><span class="token keyword">var</span> <span class="token class-name">Spread</span> <span class="token operator">=</span> designer<span class="token punctuation">.</span><span class="token function">getWorkbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">var</span> sheetid <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
 <span class="token keyword">var</span> sheet <span class="token operator">=</span> <span class="token class-name">Spread</span><span class="token punctuation">.</span><span class="token function">getSheet</span><span class="token punctuation">(</span>sheetid<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">var</span> table <span class="token operator">=</span> sheet<span class="token punctuation">.</span>tables<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
 <span class="token keyword">var</span> range <span class="token operator">=</span> table<span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">var</span> mm <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getArray</span><span class="token punctuation">(</span>range<span class="token punctuation">.</span>row<span class="token punctuation">,</span> range<span class="token punctuation">.</span>col<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> range<span class="token punctuation">.</span>colCount<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//列字段field</span>
 <span class="token keyword">var</span> gg <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getArray</span><span class="token punctuation">(</span>range<span class="token punctuation">.</span>row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> range<span class="token punctuation">.</span>col<span class="token punctuation">,</span> range<span class="token punctuation">.</span>rowCount<span class="token punctuation">,</span> range<span class="token punctuation">.</span>colCount<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//行数据</span>
 <span class="token keyword">var</span> datalist <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> gg<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
     <span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> n <span class="token operator">&lt;</span> mm<span class="token punctuation">.</span>length<span class="token punctuation">;</span> n<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
         object<span class="token punctuation">[</span>mm<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> gg<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     datalist<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 <span class="token comment">// console.log(datalist,'datalist')//最终传递给服务器的数据</span>
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c:6f672e6373646e2e6e65742f747261626563756c615f686a2f:61727469636c652f64657461696c732f313436303935393633" class_="artid" style="display:none">
 </p>
</div>


