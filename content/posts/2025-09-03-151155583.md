---
layout: post
title: "é¢è¯•å¤ä¹ é¢˜-kotlinçš„è®¾è®¡æ¨¡å¼"
date: 2025-09-03T19:19:34+0800
description: "æ¨¡å¼Kotlin æœ€ä½³å®è·µSingletonobjectBuilderdata class+ é»˜è®¤å‚æ•° æˆ– DSLStrategyé«˜é˜¶å‡½æ•°(T) -&gt; RObserverFlowSharedFlowStatewhenDecoratoræ‰©å±•å‡½æ•° æˆ–byå§”æ‰˜FactorywhenAdapteræ‰©å±•å‡½æ•°ç›´æ¥è½¬æ¢ğŸ’¡æ ¸å¿ƒæ€æƒ³ç”¨è¯­è¨€ç‰¹æ€§ç®€åŒ–æ¨¡å¼ï¼Œè€Œä¸æ˜¯ç”¨æ¨¡å¼æ¨¡æ‹Ÿè¯­è¨€ç‰¹æ€§ã€‚æŒæ¡è¿™äº› Kotlin ç‰¹æœ‰çš„å®ç°æ–¹å¼ï¼Œèƒ½è®©ä½ åœ¨é¢è¯•ä¸­è„±é¢–è€Œå‡ºï¼Œå±•ç°å¯¹è¯­è¨€æ·±åº¦çš„ç†è§£ã€‚"
keywords: "é¢è¯•å¤ä¹ é¢˜--kotlinçš„è®¾è®¡æ¨¡å¼"
categories: ['æœªåˆ†ç±»']
tags: ['é¢è¯•', 'è®¾è®¡æ¨¡å¼', 'Kotlin']
artid: "151155583"
arturl: "https://blog.csdn.net/hqiangtai/article/details/151155583"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=151155583
    alt: "é¢è¯•å¤ä¹ é¢˜-kotlinçš„è®¾è®¡æ¨¡å¼"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=151155583
featuredImagePreview: https://bing.ee123.net/img/rand?artid=151155583
cover: https://bing.ee123.net/img/rand?artid=151155583
image: https://bing.ee123.net/img/rand?artid=151155583
img: https://bing.ee123.net/img/rand?artid=151155583
---



# é¢è¯•å¤ä¹ é¢˜--kotlinçš„è®¾è®¡æ¨¡å¼

Kotlin ä»¥å…¶ç®€æ´ã€å®‰å…¨ã€å‡½æ•°å¼ç‰¹æ€§ï¼Œæå¤§åœ°æ”¹å˜äº†è®¾è®¡æ¨¡å¼çš„å®ç°æ–¹å¼ã€‚ç›¸æ¯” Javaï¼ŒKotlin èƒ½ä»¥æ›´å°‘çš„ä»£ç å®ç°ç›¸åŒçš„è®¾è®¡æ¨¡å¼ï¼Œç”šè‡³è®©æŸäº›æ¨¡å¼å˜å¾—â€œè¿‡æ—¶â€æˆ–â€œå†…ç½®â€ã€‚

ä»¥ä¸‹æ˜¯é’ˆå¯¹ **Kotlin è¯­è¨€ç‰¹æ€§ä¼˜åŒ–åçš„è®¾è®¡æ¨¡å¼é¢è¯•é¢˜**ï¼Œæ¶µç›– **å¸¸è§æ¨¡å¼ã€Kotlin å®ç°ã€å¯¹æ¯” Javaã€é«˜çº§æŠ€å·§**ã€‚

---

### ä¸€ã€Kotlin ç‰¹æ€§å¦‚ä½•å½±å“è®¾è®¡æ¨¡å¼ï¼Ÿ

| Kotlin ç‰¹æ€§ | å¯¹è®¾è®¡æ¨¡å¼çš„å½±å“ |
| --- | --- |
| **æ•°æ®ç±»Â `data class`** | æ›¿ä»£Â `Builder`ã€`Value Object`Â æ¨¡å¼ |
| **å•ä¾‹Â `object`** | å†…ç½®çº¿ç¨‹å®‰å…¨å•ä¾‹ï¼Œæ›¿ä»£Â `Double-Checked Locking` |
| **å¯†å°ç±»Â `sealed class`** | å®Œç¾å®ç°çŠ¶æ€æœºã€ç­–ç•¥æ¨¡å¼ï¼Œæ›¿ä»£æšä¸¾æˆ–å¤æ‚ç»§æ‰¿ |
| **æ‰©å±•å‡½æ•°Â `extension function`** | å®ç°è£…é¥°å™¨ã€é€‚é…å™¨æ›´ç®€æ´ |
| **é«˜é˜¶å‡½æ•° & Lambda** | æ›¿ä»£ç­–ç•¥ã€å‘½ä»¤ã€è§‚å¯Ÿè€…ç­‰è¡Œä¸ºæ¨¡å¼ |
| **å§”æ‰˜Â `by`Â å…³é”®å­—** | å†…ç½®ä»£ç†æ¨¡å¼ |
| **ç©ºå®‰å…¨Â `?`** | å‡å°‘Â `Null Object`Â æ¨¡å¼çš„ä½¿ç”¨ |
| **ä½œç”¨åŸŸå‡½æ•°Â `let`,Â `apply`,Â `run`,Â `also`** | ç®€åŒ–æ„å»ºã€é…ç½®é€»è¾‘ |

---

### äºŒã€é«˜é¢‘ Kotlin è®¾è®¡æ¨¡å¼é¢è¯•é¢˜

#### 1. å¦‚ä½•åœ¨ Kotlin ä¸­å®ç°å•ä¾‹æ¨¡å¼ï¼Ÿæœ‰å“ªäº›æ–¹å¼ï¼Ÿæ¨èå“ªç§ï¼Ÿ

**ç­”**ï¼š

##### æ–¹å¼ä¸€ï¼š`object`ï¼ˆæ¨è âœ…ï¼‰

```



```

kotlin

æ·±è‰²ç‰ˆæœ¬

```

object DatabaseManager {
    fun connect() = println("Connected")
}
// ä½¿ç”¨
DatabaseManager.connect()
```

* âœ… çº¿ç¨‹å®‰å…¨
* âœ… æ‡’åŠ è½½ï¼ˆé¦–æ¬¡è®¿é—®æ—¶åˆå§‹åŒ–ï¼‰
* âœ… ä»£ç æœ€ç®€æ´
* âœ… é˜²æ­¢åå°„æ”»å‡»ï¼ˆKotlin 1.4+ï¼‰

##### æ–¹å¼äºŒï¼š`object`Â +Â `@JvmStatic`ï¼ˆç”¨äº Java äº’æ“ä½œï¼‰

```



```

kotlin

æ·±è‰²ç‰ˆæœ¬

```

object Logger {
    @JvmStatic
    fun log(msg: String) { ... }
}
```

##### æ–¹å¼ä¸‰ï¼šé™æ€å†…éƒ¨ç±»ï¼ˆJava é£æ ¼ï¼Œä¸æ¨è âŒï¼‰

```



```

kotlin

æ·±è‰²ç‰ˆæœ¬

```

class Preferences private constructor() {
    companion object {
        val instance by lazy { Preferences() }
    }
}
```

> **ç»“è®º**ï¼š**ä¼˜å…ˆä½¿ç”¨ `object`**ï¼Œå®ƒæ˜¯ Kotlin çš„â€œä¸€ç­‰å…¬æ°‘â€ã€‚

---

#### 2. å¦‚ä½•ç”¨ Kotlin å®ç° Builder æ¨¡å¼ï¼Ÿèƒ½å¦ä¼˜åŒ–ï¼Ÿ

**ä¼ ç»Ÿ Java Builder**ï¼š

```



```

java

æ·±è‰²ç‰ˆæœ¬

```

User user = new User.Builder()
    .name("Alice")
    .age(25)
    .build();
```

**Kotlin ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š

##### æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨Â **é»˜è®¤å‚æ•° + å‘½åå‚æ•°**

```



```

kotlin

æ·±è‰²ç‰ˆæœ¬

```

data class User(
    val name: String,
    val age: Int = 0,
    val email: String? = null
)

// ä½¿ç”¨
val user = User(name = "Alice", age = 25)
```

* âœ… æœ€ç®€æ´
* âœ… ç¼–è¯‘æœŸå®‰å…¨
* âŒ ä¸é€‚åˆå¤§é‡å¯é€‰å‚æ•°ï¼ˆå¯è¯»æ€§ä¸‹é™ï¼‰

##### æ–¹æ¡ˆäºŒï¼šä½¿ç”¨Â **DSL é£æ ¼ Builder**

```



```

kotlin

æ·±è‰²ç‰ˆæœ¬

```

class UserBuilder {
    var name: String = ""
    var age: Int = 0
    var email: String? = null

    fun build() = User(name, age, email)
}

fun user(init: UserBuilder.() -> Unit): User {
    return UserBuilder().apply(init).build()
}

// ä½¿ç”¨ï¼ˆDSL é£æ ¼ï¼‰
val user = user {
    name = "Alice"
    age = 25
    email = "alice@example.com"
}
```

* âœ… å¯è¯»æ€§å¼ºï¼Œé€‚åˆå¤æ‚å¯¹è±¡
* âœ… ç±»å‹å®‰å…¨

> **ç»“è®º**ï¼š**ä¼˜å…ˆç”¨é»˜è®¤å‚æ•°**ï¼Œå¤æ‚åœºæ™¯ç”¨ **DSL Builder**ã€‚

---

#### 3. å¦‚ä½•ç”¨ Kotlin å®ç°ç­–ç•¥æ¨¡å¼ï¼Ÿæ¯” Java å¥½åœ¨å“ªï¼Ÿ

**Java å®ç°**ï¼š

```



```

java

æ·±è‰²ç‰ˆæœ¬

```

interface Strategy { void execute(); }
class ConcreteStrategyA implements Strategy { ... }
class Context {
    private Strategy strategy;
    void setStrategy(Strategy s) { this.strategy = s; }
}
```

**Kotlin å®ç°**ï¼š

##### æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨Â **é«˜é˜¶å‡½æ•°ï¼ˆæ¨è âœ…ï¼‰**

```



```

kotlin

æ·±è‰²ç‰ˆæœ¬

```

class PaymentProcessor {
    private var strategy: (amount: Double) -> Boolean = { false }

    fun setStrategy(strategy: (Double) -> Boolean) {
        this.strategy = strategy
    }

    fun process(amount: Double) = strategy(amount)
}

// ä½¿ç”¨
val processor = PaymentProcessor()
processor.setStrategy { amount ->
    println("Paying $amount via Credit Card")
    true
}
processor.process(100.0)
```

##### æ–¹æ¡ˆäºŒï¼šä½¿ç”¨Â **å¯†å°ç±» + when**

```



```

kotlin

æ·±è‰²ç‰ˆæœ¬

```

sealed class PaymentStrategy {
    object CreditCard : PaymentStrategy()
    object PayPal : PaymentStrategy()
}

fun processPayment(strategy: PaymentStrategy, amount: Double) {
    when (strategy) {
        PaymentStrategy.CreditCard -> println("Credit Card: $amount")
        PaymentStrategy.PayPal -> println("PayPal: $amount")
    }
}
```

> **ä¼˜åŠ¿**ï¼š

* âœ… ä»£ç æ›´çŸ­ï¼Œæ— éœ€å®šä¹‰æ¥å£/ç±»
* âœ… è¿è¡Œæ—¶æ€§èƒ½æ›´å¥½ï¼ˆæ— å¯¹è±¡åˆ›å»ºï¼‰
* âœ… æ”¯æŒ lambda æ•è·ä¸Šä¸‹æ–‡

---

#### 4. å¦‚ä½•ç”¨ Kotlin å®ç°è§‚å¯Ÿè€…æ¨¡å¼ï¼Ÿ

**Java å®ç°**ï¼šæ¥å£ + åˆ—è¡¨ç»´æŠ¤è§‚å¯Ÿè€…ã€‚

**Kotlin ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š

##### æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨Â **é«˜é˜¶å‡½æ•° + MutableList**

```



```

kotlin

æ·±è‰²ç‰ˆæœ¬

```

class DataStore {
    private val observers = mutableListOf<(String) -> Unit>()

    fun addObserver(observer: (String) -> Unit) {
        observers.add(observer)
    }

    fun notify(data: String) {
        observers.forEach { it(data) }
    }
}

// ä½¿ç”¨
val store = DataStore()
store.addObserver { println("Observer 1: $it") }
store.notify("Hello")
```

##### æ–¹æ¡ˆäºŒï¼šä½¿ç”¨Â **Flowï¼ˆæ¨è âœ…ï¼‰**

```



```

kotlin

æ·±è‰²ç‰ˆæœ¬

```

class DataStore {
    private val _data = MutableSharedFlow<String>()
    val data: Flow<String> = _data.asSharedFlow()

    suspend fun update(data: String) {
        _data.emit(data)
    }
}

// ä½¿ç”¨
store.data.collect { println(it) }
```

* âœ… å†…ç½®èƒŒå‹ã€çº¿ç¨‹åˆ‡æ¢ã€é”™è¯¯å¤„ç†
* âœ… æ”¯æŒÂ `debounce`ã€`distinctUntilChanged`Â ç­‰æ“ä½œç¬¦
* âœ… åç¨‹é›†æˆ

> **ç»“è®º**ï¼š**ç°ä»£ Kotlin é¡¹ç›®æ¨èç”¨ `Flow` æ›¿ä»£ä¼ ç»Ÿè§‚å¯Ÿè€…æ¨¡å¼**ã€‚

---

#### 5. å¦‚ä½•ç”¨ Kotlin å®ç°è£…é¥°å™¨æ¨¡å¼ï¼Ÿ

**Java å®ç°**ï¼šç»§æ‰¿æˆ–ç»„åˆ + æ¥å£ã€‚

**Kotlin ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š

##### æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨Â **æ‰©å±•å‡½æ•°ï¼ˆæ¨è âœ…ï¼‰**

```



```

kotlin

æ·±è‰²ç‰ˆæœ¬

```

interface Notifier {
    fun send(message: String)
}

class EmailNotifier : Notifier {
    override fun send(message: String) {
        println("Email: $message")
    }
}

// è£…é¥°ï¼šæ·»åŠ  SMS
fun Notifier.withSMS(): Notifier = object : Notifier by this {
    override fun send(message: String) {
        this@withSMS.send(message) // è°ƒç”¨åŸæ–¹æ³•
        println("SMS: $message")   // æ–°åŠŸèƒ½
    }
}

// ä½¿ç”¨
val notifier = EmailNotifier().withSMS()
notifier.send("Hello") // Email + SMS
```

##### æ–¹æ¡ˆäºŒï¼šä½¿ç”¨Â **å§”æ‰˜Â `by`**

```



```

kotlin

æ·±è‰²ç‰ˆæœ¬

```

class SMSDecorator(private val notifier: Notifier) : Notifier by notifier {
    override fun send(message: String) {
        notifier.send(message)
        println("SMS: $message")
    }
}
```

> **ä¼˜åŠ¿**ï¼šKotlin çš„ `by` å’Œæ‰©å±•å‡½æ•°è®©è£…é¥°å™¨æ¨¡å¼**å®ç°æ›´ç®€æ´ã€ç±»å‹å®‰å…¨**ã€‚

---

#### 6. å¦‚ä½•ç”¨ Kotlin å®ç°çŠ¶æ€æ¨¡å¼ï¼Ÿ

**Java å®ç°**ï¼šå¤šæ€ + çŠ¶æ€ç±»ã€‚

**Kotlin ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š**å¯†å°ç±» + when**

```



```

kotlin

æ·±è‰²ç‰ˆæœ¬

```

sealed class UiState {
    object Loading : UiState()
    data class Success(val data: List<String>) : UiState()
    data class Error(val message: String) : UiState()
}

fun render(state: UiState) {
    when (state) {
        UiState.Loading -> showLoading()
        is UiState.Success -> showData(state.data)
        is UiState.Error -> showError(state.message)
    }
}
```

* âœ… ç¼–è¯‘æœŸ exhaustive checkï¼ˆ`when`Â å¿…é¡»è¦†ç›–æ‰€æœ‰æƒ…å†µï¼‰
* âœ… æ•°æ®å°è£…å®‰å…¨
* âœ… æ¯”ç»§æ‰¿æ ‘æ›´æ¸…æ™°

> **ç»“è®º**ï¼š**å¯†å°ç±»æ˜¯ Kotlin å®ç°çŠ¶æ€æ¨¡å¼çš„æœ€ä½³æ–¹å¼**ã€‚

---

#### 7. Kotlin ä¸­å“ªäº›è®¾è®¡æ¨¡å¼å˜å¾—â€œè¿‡æ—¶â€äº†ï¼Ÿ

| æ¨¡å¼ | ä¸ºä»€ä¹ˆâ€œè¿‡æ—¶â€ | Kotlin æ›¿ä»£æ–¹æ¡ˆ |
| --- | --- | --- |
| **Builder æ¨¡å¼** | æ•°æ®ç±» + é»˜è®¤å‚æ•°æ›´ç®€æ´ | `data class`Â + å‘½åå‚æ•° |
| **Singleton** | `object`Â æ›´å®‰å…¨ç®€æ´ | `object` |
| **Factory Method** | `companion object`Â +Â `when`Â æ›´ç›´æ¥ | `companion object create()` |
| **Null Object** | ç©ºå®‰å…¨Â `?`Â å‡å°‘ç©ºæŒ‡é’ˆ | ç±»å‹ç³»ç»Ÿæœ¬èº« |
| **Visitor** | å¯†å°ç±» +Â `when`Â æ›´å®‰å…¨ | `sealed class`Â +Â `when` |

---

### ä¸‰ã€é«˜çº§é¢è¯•é¢˜ï¼ˆç»“åˆåç¨‹ã€DSLï¼‰

#### 1. å¦‚ä½•ç”¨ Kotlin å®ç°ä¸€ä¸ª DSLï¼ˆé¢†åŸŸç‰¹å®šè¯­è¨€ï¼‰ï¼Ÿ

```



```

kotlin

æ·±è‰²ç‰ˆæœ¬

```

// å®ç°ä¸€ä¸ªç®€å•çš„ HTML DSL
fun html(init: HTML.() -> Unit): HTML {
    val html = HTML()
    html.init()
    return html
}

class HTML {
    val body = Body()
    fun body(init: Body.() -> Unit) = body.init()
}

class Body {
    val divs = mutableListOf<Div>()
    fun div(init: Div.() -> Unit) {
        divs += Div().apply(init)
    }
}

class Div {
    var text: String = ""
}

// ä½¿ç”¨ï¼ˆåƒ HTML ä¸€æ ·å†™ Kotlinï¼‰
val result = html {
    body {
        div {
            text = "Hello"
        }
    }
}
```

> **åº”ç”¨åœºæ™¯**ï¼šGradle Kotlin DSLã€Ankoï¼ˆå·²å¼ƒç”¨ï¼‰ã€Ktor è·¯ç”±ã€‚

---

#### 2. å¦‚ä½•ç”¨ Flow å®ç°å‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼Ÿ

```



```

kotlin

æ·±è‰²ç‰ˆæœ¬

```

class EventBus {
    private val _events = MutableSharedFlow<Event>()
    val events: Flow<Event> = _events.asSharedFlow()

    suspend fun post(event: Event) {
        _events.emit(event)
    }
}

// ä½¿ç”¨
eventBus.events
    .onEach { handleEvent(it) }
    .launchIn(scope)
```

* âœ… æ”¯æŒèƒŒå‹
* âœ… çº¿ç¨‹åˆ‡æ¢ï¼ˆ`flowOn`ï¼‰
* âœ… æ“ä½œç¬¦ä¸°å¯Œï¼ˆ`filter`,Â `debounce`ï¼‰

---

### å››ã€æ€»ç»“ï¼šKotlin è®¾è®¡æ¨¡å¼é¢è¯•è¦ç‚¹

| æ¨¡å¼ | Kotlin æœ€ä½³å®è·µ |
| --- | --- |
| **Singleton** | `object` |
| **Builder** | `data class`Â + é»˜è®¤å‚æ•° æˆ– DSL |
| **Strategy** | é«˜é˜¶å‡½æ•°Â `(T) -> R` |
| **Observer** | `Flow`Â /Â `SharedFlow` |
| **State** | `sealed class`Â +Â `when` |
| **Decorator** | æ‰©å±•å‡½æ•° æˆ–Â `by`Â å§”æ‰˜ |
| **Factory** | `companion object`Â +Â `when` |
| **Adapter** | æ‰©å±•å‡½æ•°ç›´æ¥è½¬æ¢ |

> ğŸ’¡ **æ ¸å¿ƒæ€æƒ³**ï¼š**ç”¨è¯­è¨€ç‰¹æ€§ç®€åŒ–æ¨¡å¼ï¼Œè€Œä¸æ˜¯ç”¨æ¨¡å¼æ¨¡æ‹Ÿè¯­è¨€ç‰¹æ€§**ã€‚

æŒæ¡è¿™äº› Kotlin ç‰¹æœ‰çš„å®ç°æ–¹å¼ï¼Œèƒ½è®©ä½ åœ¨é¢è¯•ä¸­è„±é¢–è€Œå‡ºï¼Œå±•ç°å¯¹è¯­è¨€æ·±åº¦çš„ç†è§£ã€‚



