---
layout: post
title: "后端django-drfdrf-spectacular总结在-drf-spectacular-中添加-API-注释的方法"
date: 2025-03-15 15:22:45 +0800
description: "生成的 OpenAPI 文档，使其符合您的需求并提升 API 可读性。配置全局的 API 信息，如 API 名称、描述、版本等。中，可以通过几种不同的方式来添加 API 注释（如。如果你希望某个 API 端点不出现在文档中，可以使用。等），以生成更具描述性的 OpenAPI 文档。可以指定响应的格式、状态码和返回的数据结构。定义查询参数，并为其添加说明。中的多个方法注释，可以使用。通过这些方法，您可以精确控制。修饰单个视图方法，添加。，指定数据结构和示例。"
keywords: "【后端】【django-drf】【drf-spectacular】总结：在 drf-spectacular 中添加 API 注释的方法"
categories: ['后端系统功能', 'Django']
tags: ['数据库', 'Sqlite', 'Django']
artid: "146279997"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146279997
    alt: "后端django-drfdrf-spectacular总结在-drf-spectacular-中添加-API-注释的方法"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146279997
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146279997
cover: https://bing.ee123.net/img/rand?artid=146279997
image: https://bing.ee123.net/img/rand?artid=146279997
img: https://bing.ee123.net/img/rand?artid=146279997
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     【后端】【django-drf】【drf-spectacular】总结：在 drf-spectacular 中添加 API 注释的方法
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="_drfspectacular__API__0">
     </a>
     <strong>
      总结：在 drf-spectacular 中添加 API 注释的方法
     </strong>
    </h3>
    <p>
     在
     <code>
      drf-spectacular
     </code>
     中，可以通过几种不同的方式来添加 API 注释（如
     <code>
      summary
     </code>
     、
     <code>
      tags
     </code>
     、
     <code>
      description
     </code>
     等），以生成更具描述性的 OpenAPI 文档。
    </p>
    <h4>
     <a id="_API__4">
     </a>
     <strong>
      （一）全局配置：修改 API 的标题、描述等信息
     </strong>
    </h4>
    <p>
     可以在
     <code>
      settings.py
     </code>
     中使用
     <code>
      SPECTACULAR_SETTINGS
     </code>
     配置全局的 API 信息，如 API 名称、描述、版本等。
    </p>
    <pre><code class="prism language-python">SPECTACULAR_SETTINGS <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'TITLE'</span><span class="token punctuation">:</span> <span class="token string">"My API"</span><span class="token punctuation">,</span>  <span class="token comment"># API 标题</span>
    <span class="token string">'DESCRIPTION'</span><span class="token punctuation">:</span> <span class="token string">"这是 API 文档的描述信息"</span><span class="token punctuation">,</span>  <span class="token comment"># API 描述</span>
    <span class="token string">'VERSION'</span><span class="token punctuation">:</span> <span class="token string">"v1.0"</span><span class="token punctuation">,</span>  <span class="token comment"># API 版本</span>
    <span class="token string">'CONTACT'</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">"API Support"</span><span class="token punctuation">,</span>
        <span class="token string">'email'</span><span class="token punctuation">:</span> <span class="token string">"support@example.com"</span><span class="token punctuation">,</span>
        <span class="token string">'url'</span><span class="token punctuation">:</span> <span class="token string">"https://www.example.com/support"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">'LICENSE'</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">"MIT License"</span><span class="token punctuation">,</span>
        <span class="token string">'url'</span><span class="token punctuation">:</span> <span class="token string">"https://opensource.org/licenses/MIT"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">'TOS'</span><span class="token punctuation">:</span> <span class="token string">"https://www.example.com/terms/"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="_extend_schema__extend_schema_view_24">
     </a>
     <strong>
      （二）在视图中添加注释：使用
      <code>
       @extend_schema
      </code>
      和
      <code>
       @extend_schema_view
      </code>
     </strong>
    </h4>
    <h5>
     <a id="1__extend_schema__26">
     </a>
     <strong>
      1. 使用
      <code>
       @extend_schema
      </code>
      添加单个视图的注释
     </strong>
    </h5>
    <p>
     可以通过
     <code>
      @extend_schema
     </code>
     修饰单个视图方法，添加
     <code>
      summary
     </code>
     、
     <code>
      description
     </code>
     、
     <code>
      tags
     </code>
     等注释信息。
    </p>
    <pre><code class="prism language-python"><span class="token keyword">from</span> drf_spectacular<span class="token punctuation">.</span>utils <span class="token keyword">import</span> extend_schema
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>views <span class="token keyword">import</span> APIView
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response

<span class="token keyword">class</span> <span class="token class-name">MyAPIView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token decorator annotation punctuation">@extend_schema</span><span class="token punctuation">(</span>
        summary<span class="token operator">=</span><span class="token string">"获取用户信息"</span><span class="token punctuation">,</span>  <span class="token comment"># API 简短描述</span>
        description<span class="token operator">=</span><span class="token string">"此端点用于获取用户的详细信息"</span><span class="token punctuation">,</span>  <span class="token comment"># API 详细描述</span>
        tags<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"用户管理"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># API 分类标签</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"Tom"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <h5>
     <a id="2__extend_schema_view__44">
     </a>
     <strong>
      2. 使用
      <code>
       @extend_schema_view
      </code>
      添加视图集的注释
     </strong>
    </h5>
    <p>
     如果要批量修改一个
     <code>
      ViewSet
     </code>
     中的多个方法注释，可以使用
     <code>
      @extend_schema_view
     </code>
     。
    </p>
    <pre><code class="prism language-python"><span class="token keyword">from</span> drf_spectacular<span class="token punctuation">.</span>utils <span class="token keyword">import</span> extend_schema_view<span class="token punctuation">,</span> extend_schema

<span class="token decorator annotation punctuation">@extend_schema_view</span><span class="token punctuation">(</span>
    <span class="token builtin">list</span><span class="token operator">=</span>extend_schema<span class="token punctuation">(</span>summary<span class="token operator">=</span><span class="token string">"获取用户列表"</span><span class="token punctuation">,</span> tags<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"用户管理"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    create<span class="token operator">=</span>extend_schema<span class="token punctuation">(</span>summary<span class="token operator">=</span><span class="token string">"创建新用户"</span><span class="token punctuation">,</span> tags<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"用户管理"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">CustomUserViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> CustomUser<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> CustomUserSerializer
    permission_classes <span class="token operator">=</span> <span class="token punctuation">[</span>AllowAny<span class="token punctuation">]</span>
</code></pre>
    <h4>
     <a id="_59">
     </a>
     <strong>
      （三）自定义请求参数、响应格式和示例
     </strong>
    </h4>
    <h5>
     <a id="1__61">
     </a>
     <strong>
      1. 自定义查询参数
     </strong>
    </h5>
    <p>
     可以使用
     <code>
      OpenApiParameter
     </code>
     定义查询参数，并为其添加说明。
    </p>
    <pre><code class="prism language-python"><span class="token keyword">from</span> drf_spectacular<span class="token punctuation">.</span>utils <span class="token keyword">import</span> OpenApiParameter

<span class="token keyword">class</span> <span class="token class-name">UserSearchView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token decorator annotation punctuation">@extend_schema</span><span class="token punctuation">(</span>
        parameters<span class="token operator">=</span><span class="token punctuation">[</span>
            OpenApiParameter<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"q"</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">"搜索关键字"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            OpenApiParameter<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"page"</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">"分页页码"</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        summary<span class="token operator">=</span><span class="token string">"搜索用户"</span><span class="token punctuation">,</span>
        tags<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"用户管理"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"results"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <h5>
     <a id="2__80">
     </a>
     <strong>
      2. 自定义请求体
     </strong>
    </h5>
    <p>
     可以为
     <code>
      POST
     </code>
     请求自定义
     <code>
      request body
     </code>
     ，指定数据结构和示例。
    </p>
    <pre><code class="prism language-python"><span class="token keyword">from</span> drf_spectacular<span class="token punctuation">.</span>utils <span class="token keyword">import</span> OpenApiExample

<span class="token keyword">class</span> <span class="token class-name">UserCreateView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token decorator annotation punctuation">@extend_schema</span><span class="token punctuation">(</span>
        request<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
            <span class="token string">"application/json"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"object"</span><span class="token punctuation">,</span>
                <span class="token string">"properties"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token string">"username"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span> <span class="token string">"example"</span><span class="token punctuation">:</span> <span class="token string">"Tom"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token string">"email"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span> <span class="token string">"example"</span><span class="token punctuation">:</span> <span class="token string">"tom@example.com"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        examples<span class="token operator">=</span><span class="token punctuation">[</span>
            OpenApiExample<span class="token punctuation">(</span>
                <span class="token string">"示例请求"</span><span class="token punctuation">,</span>
                summary<span class="token operator">=</span><span class="token string">"示例 1"</span><span class="token punctuation">,</span>
                value<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">"username"</span><span class="token punctuation">:</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"email"</span><span class="token punctuation">:</span> <span class="token string">"tom@example.com"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        summary<span class="token operator">=</span><span class="token string">"创建用户"</span><span class="token punctuation">,</span>
        tags<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"用户管理"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"User created"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <h5>
     <a id="3__111">
     </a>
     <strong>
      3. 自定义响应格式
     </strong>
    </h5>
    <p>
     可以指定响应的格式、状态码和返回的数据结构。
    </p>
    <pre><code class="prism language-python"><span class="token keyword">from</span> drf_spectacular<span class="token punctuation">.</span>utils <span class="token keyword">import</span> OpenApiResponse

<span class="token keyword">class</span> <span class="token class-name">UserDetailView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token decorator annotation punctuation">@extend_schema</span><span class="token punctuation">(</span>
        responses<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
            <span class="token number">200</span><span class="token punctuation">:</span> OpenApiResponse<span class="token punctuation">(</span>response<span class="token operator">=</span>UserSerializer<span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">"成功返回用户详情"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token number">400</span><span class="token punctuation">:</span> OpenApiResponse<span class="token punctuation">(</span>description<span class="token operator">=</span><span class="token string">"请求参数错误"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        summary<span class="token operator">=</span><span class="token string">"获取用户详情"</span><span class="token punctuation">,</span>
        tags<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"用户管理"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"username"</span><span class="token punctuation">:</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span> <span class="token string">"email"</span><span class="token punctuation">:</span> <span class="token string">"tom@example.com"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <hr/>
    <h4>
     <a id="_API__132">
     </a>
     <strong>
      （四）隐藏 API 端点
     </strong>
    </h4>
    <p>
     如果你希望某个 API 端点不出现在文档中，可以使用
     <code>
      exclude=True
     </code>
     隐藏该 API。
    </p>
    <pre><code class="prism language-python"><span class="token keyword">from</span> drf_spectacular<span class="token punctuation">.</span>utils <span class="token keyword">import</span> extend_schema

<span class="token decorator annotation punctuation">@extend_schema</span><span class="token punctuation">(</span>exclude<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">HiddenView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"This API is hidden"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <hr/>
    <h4>
     <a id="_146">
     </a>
     <strong>
      （五）总结
     </strong>
    </h4>
    <table>
     <thead>
      <tr>
       <th>
        <strong>
         功能
        </strong>
       </th>
       <th>
        <strong>
         方法
        </strong>
       </th>
       <th>
        <strong>
         适用场景
        </strong>
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <strong>
         修改 API 标题、描述等信息
        </strong>
       </td>
       <td>
        在
        <code>
         settings.py
        </code>
        中配置
        <code>
         SPECTACULAR_SETTINGS
        </code>
       </td>
       <td>
        设置全局的 API 信息（如标题、版本、描述、许可证等）
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         修改单个视图注释
        </strong>
       </td>
       <td>
        使用
        <code>
         @extend_schema
        </code>
        修饰视图方法
       </td>
       <td>
        为单个视图或端点添加
        <code>
         summary
        </code>
        、
        <code>
         description
        </code>
        和
        <code>
         tags
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         修改多个视图注释
        </strong>
       </td>
       <td>
        使用
        <code>
         @extend_schema_view
        </code>
        修饰
        <code>
         ViewSet
        </code>
        或多个方法
       </td>
       <td>
        为多个视图方法批量修改 API 注释
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         自定义请求参数
        </strong>
       </td>
       <td>
        使用
        <code>
         OpenApiParameter
        </code>
        添加查询参数
       </td>
       <td>
        添加查询参数，如
        <code>
         q
        </code>
        或
        <code>
         page
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         自定义请求体
        </strong>
       </td>
       <td>
        使用
        <code>
         OpenApiExample
        </code>
        定义请求体和示例
       </td>
       <td>
        定义
        <code>
         POST
        </code>
        请求的请求体数据结构及示例
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         自定义响应格式
        </strong>
       </td>
       <td>
        使用
        <code>
         OpenApiResponse
        </code>
        定义响应格式、状态码及返回数据结构
       </td>
       <td>
        自定义响应数据结构和返回状态码
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         隐藏 API 端点
        </strong>
       </td>
       <td>
        使用
        <code>
         @extend_schema(exclude=True)
        </code>
        隐藏某个端点
       </td>
       <td>
        隐藏某些 API 端点，避免它们出现在生成的文档中
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     通过这些方法，您可以精确控制
     <code>
      drf-spectacular
     </code>
     生成的 OpenAPI 文档，使其符合您的需求并提升 API 可读性。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f35393334343132372f:61727469636c652f64657461696c732f313436323739393937" class_="artid" style="display:none">
 </p>
</div>


