---
arturl_encode: "68747470:733a2f2f626c6f672e6373646e2e6e65742f4c65655f30312f:61727469636c652f64657461696c732f313232333530363233"
layout: post
title: "å‰ç«¯ç‚¹å‡»æŒ‰é’®æ‰“å°Excel"
date: 2024-11-28 15:31:03 +0800
description: "å‰ç«¯ç‚¹å‡»æŒ‰é’®æ‰“å°Excelå®ç°æ€è·¯å¤ªé•¿ä¸çœ‹ç‰ˆåç«¯spire.xlså°†excelè½¬ä¸ºhtmlï¼Œå‰ç«¯æ‰“å°"
keywords: "å‰ç«¯æ‰“å°åç«¯è¿”å›çš„excelæ–‡ä»¶"
categories: ['å‰ç«¯å¼€å‘', 'Web']
tags: ['å‰ç«¯', 'Javascript', 'Html']
artid: "122350623"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=122350623
    alt: "å‰ç«¯ç‚¹å‡»æŒ‰é’®æ‰“å°Excel"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=122350623
featuredImagePreview: https://bing.ee123.net/img/rand?artid=122350623
---

# å‰ç«¯ç‚¹å‡»æŒ‰é’®æ‰“å°Excel

## å‰ç«¯ç‚¹å‡»æŒ‰é’®æ‰“å°Excel

### å®ç°æ€è·¯

#### å¤ªé•¿ä¸çœ‹ç‰ˆ

åç«¯spire.xlså°†excelè½¬ä¸ºhtmlï¼Œå‰ç«¯æ‰“å°iframe

#### å…·ä½“è¯´æ˜

å‰ç«¯åªèƒ½æ‰“å°htmlæ–‡æ¡£å·²æœ‰çš„domèŠ‚ç‚¹ï¼Œæ— æ³•ç›´æ¥æ‰“å°Excelï¼Œé‚£ä¹ˆå¯ä»¥å°†Excelè½¬æ¢ä¸ºhtmlï¼Œåœ¨iframeä¸­å°†htmlæ¸²æŸ“å‡ºæ¥ï¼Œæœ€åjsè°ƒç”¨æ‰“å°æ¥å£å°±å¯ä»¥äº†ã€‚è€Œè½¬æ¢è¿™ä¸€æ­¥å¯ä»¥æ”¾åœ¨åç«¯æ“ä½œï¼Œå®ç°å·¥å…·åº“æ˜¯
`spire.xls`
ï¼Œpomçœ‹ä¸‹é¢ä»£ç ã€‚

æ•ˆæœè¿˜å¯ä»¥ ğŸ•
  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/e3d31a490afcd3868b4635c2e050c4e6.png)

### ä»£ç 

#### åç«¯

* pom

```xml
<dependency>
	<groupId>e-iceblue</groupId>
	<artifactId>spire.xls</artifactId>
	<version>3.12.3</version>
</dependency>

<repository>
	<id>com.e-iceblue</id>
	<url>https://repo.e-iceblue.cn/repository/maven-public/</url>
</repository>

```

```java
// è¯»å–Excel
Workbook wb = new Workbook();
String excelFileName = "xxx/xx.xlsx";
wb.loadFromFile(excelFileName);
// è·å–Excelçš„ç¬¬ä¸€å¼ è¡¨
Worksheet sheet = wb.getWorksheets().get(0);
// åˆ é™¤ç©ºç™½
for (int i = sheet.getLastRow(); i >= 1; i--) {
    if (sheet.getRows()[i - 1].isBlank()) {
        sheet.deleteRow(i);
    }
}

for (int j = sheet.getLastColumn(); j >= 1; j--) {
    if (sheet.getColumns()[j - 1].isBlank()) {
        sheet.deleteColumn(j);
    }
}

// å¦ä¿å­˜ä¸ºhtml
String htmlFileName = "yyy/yy.html";
sheet.saveToHtml(htmlFileName);

```

#### å‰ç«¯

```js
// content æ˜¯ä»åç«¯æ‹¿åˆ°çš„htmlæ–‡æ¡£å­—ç¬¦ä¸²
export function printIframe(content) {
  let iframe = document.createElement('iframe')
  iframe.id = new Date().getTime()
  iframe.width = '1200'
  // é«˜åº¦çœ‹æƒ…å†µè®¾å®š
  iframe.height = '60000'
  iframe.style.display = 'none'
  document.body.appendChild(iframe)
  iframe.contentWindow.document.write(content)
  // ç§»é™¤spire.xlsè½¬æ¢æ—¶æ·»åŠ åœ¨é¡µé¢é¡¶éƒ¨çš„æ°´å°
  let watermark = iframe.contentWindow.document.querySelector('body > h2')
  iframe.contentWindow.document.body.removeChild(watermark)
  iframe.contentWindow.print()

  // ç§»é™¤iframe
  setTimeout(() => {
    document.body.removeChild(document.getElementById(iframe.id))
  }, 5000)
}


```

### å‚è€ƒåšå®¢

https://blog.csdn.net/Game\_Object\_/article/details/117810111

https://blog.csdn.net/hani\_wen/article/details/100030429