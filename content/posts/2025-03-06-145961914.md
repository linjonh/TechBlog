---
layout: post
title: "LinuxCentos-7.6命令详解vi"
date: 2025-03-06 10:00:00 +0800
description: "vi/vim 是Linux 系统内置不可或缺的文本编辑命令，vim 是vi 的加强版本，兼容vi 的所有指令，不仅能编辑文本，而且还具有shell 程序编辑的功能，可以不同颜色的字体来辨别语法的正确性。"
keywords: "vi命令"
categories: ['未分类']
tags: ['运维', 'Linux', 'Centos']
artid: "145961914"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=145961914
    alt: "LinuxCentos-7.6命令详解vi"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=145961914
featuredImagePreview: https://bing.ee123.net/img/rand?artid=145961914
cover: https://bing.ee123.net/img/rand?artid=145961914
image: https://bing.ee123.net/img/rand?artid=145961914
img: https://bing.ee123.net/img/rand?artid=145961914
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Linux(Centos 7.6)命令详解：vi
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h2>
     1.命令作用
    </h2>
    <p>
     vi/vim 是Linux 系统内置不可或缺的文本编辑命令，vim 是vi 的加强版本，兼容vi 的所有指令，不仅能编辑文本，而且还具有shell 程序编辑的功能，可以不同颜色的字体来辨别语法的正确性。
    </p>
    <h2>
     2.命令语法
    </h2>
    <p>
     <span style="color:#1c7892">
      <strong>
       usage: vim [arguments] [file ..]   edit specified file(s)                 编辑指定文件
       <br/>
       or: vim [arguments] -             read text from stdin                 从标准输入中读取文本
      </strong>
     </span>
     <br/>
     <span style="color:#1c7892">
      <strong>
       or: vim [arguments] -t tag     edit file where tag is defined
      </strong>
      <strong>
       编辑定义标记的文件
      </strong>
     </span>
    </p>
    <h2>
     3.参数详解
    </h2>
    <p>
     <span style="color:#1c7892">
      <strong>
       arguments
      </strong>
     </span>
     :
    </p>
    <ul>
     <li>
      <strong>
       <span style="color:#1c7892">
        --
       </span>
      </strong>
      ，仅列出此后的文件名(执行后进入命令模式，可点击i进图编辑模式进行编辑)
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        -v
       </strong>
      </span>
      ，Vi 模式(如同"vi")
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        -e
       </strong>
      </span>
      ，Ex 模式(如同"ex")
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        -E
       </strong>
      </span>
      ，改进Ex模式
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        -s
       </strong>
      </span>
      ，静默(批量)模式(仅适用于"ex")
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        -y
       </strong>
      </span>
      ，简易模式(如同"evim"，无模式)(进去后不好退出来)
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        -R
       </strong>
      </span>
      ，只读模式(如同"view")
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        -Z
       </strong>
      </span>
      ，限制模式(如同"rvim")
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        -m
       </strong>
      </span>
      ，不允许修改(写文件)(可以写入到不能保存，保存会提示不能写入)
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        -M
       </strong>
      </span>
      ，不允许修改文本(不能转换为插入模式，命令模式删除也不行)
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        -b
       </strong>
      </span>
      ，二进制模式
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        -C
       </strong>
      </span>
      ，兼容Vi: '兼容'
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        -N
       </strong>
      </span>
      ，不完全兼容Vi: '不完全兼容'
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        -V[N][fname]
       </strong>
      </span>
      ，显示详细信息[数量 N] [日志信息记录到fname]
     </li>
     <li>
      <strong>
       <span style="color:#1c7892">
        -n
       </span>
      </strong>
      ，没有交换文件，只使用内存
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        -r
       </strong>
      </span>
      ，列出交换文件并退出(vi -r不跟文件)
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        -r (with file name)
       </strong>
      </span>
      ，恢复崩溃的会话(vi -r filename 跟文件恢复异常的vi 编辑会话)
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        -L
       </strong>
      </span>
      ，与-r一样
     </li>
     <li>
      -T &lt;terminal&gt;，终端类型设置为&lt;terminal&gt;
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        -u &lt;vimrc&gt;
       </strong>
      </span>
      ，使用&lt;vimrc&gt;而不是任何.vimrc(.vimrc默认存在的，可在用户家目录下创建，可在家目录创建，如.vimrc写入set number，vi/vim打开就会显示行号)
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        --noplugin
       </strong>
      </span>
      ，不要加载插件脚本
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        -p[N]
       </strong>
      </span>
      ，打开N个标签页(default: 每个文件一个)(用于同时打开多个文件，或一个文件多次打开)
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        -o[N]
       </strong>
      </span>
      ，打开N个窗口(default: 每个文件一个)(用于同时打开多个文件，或一个文件多次打开)
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        -O[N]
       </strong>
      </span>
      ，像-o一样，但是垂直分开
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        +
       </strong>
      </span>
      ，从文件末尾开始(vi打开后光标直接定位到文件末尾行行首)
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        +&lt;lnum&gt;
       </strong>
      </span>
      ，从行&lt;lnum&gt;开始(vi打开后光标定位在指定行行首)
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        --cmd &lt;command&gt;
       </strong>
      </span>
      ，在加载任何vimrc文件之前执行&lt;command&gt;(command为编辑器的命令)
     </li>
     <li>
      <strong>
       <span style="color:#1c7892">
        -c &lt;command&gt;
       </span>
      </strong>
      ，加载第一个文件后执行&lt;command&gt;(command为编辑器的命令)
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        -S &lt;session&gt;
       </strong>
      </span>
      ，加载第一个文件后执行文件&lt;session&gt;(session内容为编辑器的命令和操作)
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        -s &lt;scriptin&gt;
       </strong>
      </span>
      ，从文件&lt;scriptin&gt;中读取普通模式命令(scriptin内容为编辑器的命令和操作)
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        -w &lt;scriptout&gt;
       </strong>
      </span>
      ，将vi 编辑文件的所有操作追加记录到文件&lt;scriptout&gt;
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        -W &lt;scriptout&gt;
       </strong>
      </span>
      ，将vi 编辑文件的所有操作覆盖记录到文件&lt;scriptout&gt;
     </li>
    </ul>
    <h2>
     4.模式详解
    </h2>
    <p>
     <span style="color:#1c7892">
      <strong>
       三种模式:
      </strong>
     </span>
    </p>
    <ol>
     <li>
      <span style="color:#1c7892">
       <strong>
        一般模式/命令模式(command mode)
       </strong>
      </span>
      ：刚刚启动 vi/vim，则进入一般模式，可以移动光标、复制粘贴、删除字符等。此状态下键盘输入会被识别为命令操作，常用到的包括 i(切换到插入模式)，x(删除当前光标所在字符)，:(切换到命令行模式)
     </li>
     <li>
      <strong>
       <span style="color:#1c7892">
        插入模式(input mode)
       </span>
      </strong>
      ：在一般模式下按下键盘【i, I, o, O, a, A】进入插入模式，屏幕的左下方会出现【–INSERT–】的字样，表示当前模式下，用户可以编辑修改文本的内容。按下【Esc】则退出编辑模式
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        命令行模式/末行模式(last line mode)
       </strong>
      </span>
      ：在一般模式下按下键盘【: / ?】任意一个，光标移动到最下面一行，进入末行模式。可以查找数据、替换、可保存文件、退出 vi、显示行号等操作
     </li>
    </ol>
    <h2>
     5.常用用例
    </h2>
    <h3>
     5.1.创建文件
    </h3>
    <p>
     创建文件，打开 test.txt 文件进入一般模式；当 test.txt 不存在则会创建 test.txt 文件，保存退出后，则新建成功。
    </p>
    <pre><code class="language-bash">vi test.txt</code></pre>
    <h3>
     5.2.移动光标
    </h3>
    <p>
     进入一般模式后，可在键盘输入以下，移动光标位置。
    </p>
    <ul>
     <li>
      <span style="color:#1c7892">
       <strong>
        [Ctrl]+[f]
       </strong>
      </span>
      ：光标向下移动一页。
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        [Ctrl]+[d]
       </strong>
      </span>
      ：光标向下翻半页
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        [Ctrl]+[b]
       </strong>
      </span>
      ：光标向上移动一页。
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        [Ctrl]+[u]
       </strong>
      </span>
      ：光标向上 翻半页
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        0
       </strong>
      </span>
      ：移动到光标所在这一行的最前面字符处。
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        $
       </strong>
      </span>
      ：移动到光标所在这一行的最后面字符处。
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        h j k l 或者箭头按键
       </strong>
      </span>
      ：从当前光标处往上、下、左、右移动。
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        gg
       </strong>
      </span>
      ：移动到这个文件的第一行。
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        G
       </strong>
      </span>
      ：移动到这个文件的最后一行。
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        N[Enter]
       </strong>
      </span>
      ：N 为数字，光标向下移动 N 行。
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        ngg 或 nG
       </strong>
      </span>
      ：n 代表行号，光标会跳转到文件的第n行，例如 66gg 或 66G，光标会跳转到第66行。
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        :n
       </strong>
      </span>
      ： 英文冒号":"后面输入行号n，按回车键，光标会跳转到第n行。例如，输入 :600，按回车键光标会跳转到第600行
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        vim +n 文件名
       </strong>
      </span>
      ：使光标在正常模式下直接跳转到第n行，例如 vim +10 nation.tbl
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        n|
       </strong>
      </span>
      ：跳转到当前行的第n个字符，例如 3| 会使光标跳转到当前行的第3个字符。（空格也算一个字符）
     </li>
    </ul>
    <h3>
     5.3.删除、复制、粘贴
    </h3>
    <p>
     进入一般模式后，可在键盘输入以下，实现删除、复制、粘贴。
    </p>
    <ul>
     <li>
      <span style="color:#1c7892">
       <strong>
        x,X
       </strong>
      </span>
      ：在一行字中，x 为向后删除一个字符（相当于[Del]键），X 为向前删除一个字符（相当于[Backspace]）
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        dd
       </strong>
      </span>
      ：删除光标所在的一整行。 ndd：删除光标所在的向下 n 行。
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        s
       </strong>
      </span>
      ：删除光标所在字符并进入编辑模式
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        d+w
       </strong>
      </span>
      ：删除光标往后的整个单词
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        yy
       </strong>
      </span>
      ：复制光标所在的一行。
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        nyy
       </strong>
      </span>
      ：复制光标所在的向下 n 行。
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        p,P
       </strong>
      </span>
      ：p 为将已复制的内容在光标的下一行粘贴，P 则为粘贴在光标的上一行。
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        D（shift +d） d+$(shift+4)
       </strong>
      </span>
      ：删除当前行光标后的所有字符
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        d+0 d+^
       </strong>
      </span>
      ：删除当前行光标前的所有字符
     </li>
    </ul>
    <h3>
     5.4.插入模式
    </h3>
    <p>
     进入一般模式后，可在键盘输入以下，切换到插入模式，进行文件编辑操作。
    </p>
    <ul>
     <li>
      <span style="color:#1c7892">
       <strong>
        i，I
       </strong>
      </span>
      ：进入插入模式，i 为从目前光标所在处插入。I 为在目前所在行的第一个非空格字符处开始插入。
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        a，A
       </strong>
      </span>
      ：进入插入模式。a 为从目前光标所在处的下一个字符处开始插入。A 为从所在行的最后一个字符处开始插入。
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        o，O
       </strong>
      </span>
      ：进入插入模式。o 为在下一行插入。O 为在上一行插入。
     </li>
    </ul>
    <h3>
     5.5.查找、替换
    </h3>
    <p>
     按 vi 进入文件后，可进行以下操作进行查找和替换
    </p>
    <ul>
     <li>
      <span style="color:#1c7892">
       <strong>
        /xxx
       </strong>
      </span>
      ：向下寻找一个名称为 xxx的字符串。
     </li>
     <li>
      <strong>
       <span style="color:#1c7892">
        ?xxx
       </span>
      </strong>
      ：向上寻找一个名称为 xxx的字符串。
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        ^
       </strong>
      </span>
      ：表示匹配行首
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        $
       </strong>
      </span>
      ：表示匹配行尾
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        :n1,n2s/xxx1/xxx2/g
       </strong>
      </span>
      ：在第 n1 行和 n2行之间寻找 xxx1 这个字符串，并且将其替换为 xxx2.
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        :1,$s/xxx1/xxx2/g
       </strong>
      </span>
      ：从第一行到最后一行寻找xxx1 这个字符串，并且将其替换为xxx2.
     </li>
     <li>
      <span style="color:#1c7892">
       <strong>
        :1,$s/xxx1/xxx2/gc
       </strong>
      </span>
      ：从第一行到最后一行寻找xxx1 这个字符串，并且将其替换为xxx2.且在替换前显示提示字符给用户确认是否需要替换。
     </li>
    </ul>
    <h3>
     5.6.保存退出
    </h3>
    <p>
     编辑数据后切换到末行模式，":w"命令表示将当前编辑的内容保存到文件中，而":q"命令表示退出vim编辑器
    </p>
    <ul>
     <li>
      保存并退出：":wq"或者":x"
     </li>
     <li>
      丢弃修改并退出：":q!"
     </li>
     <li>
      强制保存并退出：":wq!"
     </li>
     <li>
      保存但不退出：":w"
     </li>
     <li>
      放弃编辑并退出：":q!"
     </li>
    </ul>
    <h3>
     5.7.vim列编辑
    </h3>
    <ul>
     <li>
      列删除 ctrl+v, 选中后 d
     </li>
     <li>
      列插入 ctrl+v, 选中后 I(大写i)，编辑完毕后两次ESC
     </li>
     <li>
      列替换 ctrl+v, 选中后 s ，编辑完毕后两次ESC
     </li>
     <li>
      列复制 ctrl+v, 选中后 y
     </li>
     <li>
      列粘贴 p
     </li>
    </ul>
    <h3>
     5.8.合并行
    </h3>
    <p>
     命令模式下执行
    </p>
    <ul>
     <li>
      J：将下一行合并到光标当前行，中间以空格分隔
     </li>
     <li>
      gJ：将下一行合并到光标当前行，中间无符号分隔
     </li>
     <li>
      vGJ：将文件所有行合并为一行，中间以空格分隔
     </li>
     <li>
      vGgJ：将文件所有行合并为一行，中间无符号分隔
     </li>
    </ul>
    <h3>
     5.9.常用末行模式
    </h3>
    <pre><code class="language-bash">1.查看文件编码 
:set fileencoding 

2.修改文件编码 
:set fileencoding=utf-8 

3.显示行号
:set nu /number 

4.取消行号 
:set nonu  

5.搜索时忽略大小写（先set ic 再 /搜索）
:set ic

6.把6到10行 粘贴到20行下面
:6,10 co 20 

7.删除6到10行
:6,10 d  

8.把外面复制的内容复制到文件中（源内容可能会出现粘贴成一行的情况，:set paste可以粘贴成多行）
:set paste </code></pre>
    <h3>
     5.10.文件对比
    </h3>
    <pre><code class="language-bash">vim -d nation.tbl nation_1.tbl # 输出内容显示不全
vim -d -c 'set wrap' -c 'wincmd w' -c 'set wrap' aa ab # 输出内容换行显示(显示全)
vimdiff -c 'set wrap' -c 'wincmd w' -c 'set wrap' aa.txt ab.txt
vimdiff +"windo set wrap" aa ab</code></pre>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f517565727963616368652f:61727469636c652f64657461696c732f313435393631393134" class_="artid" style="display:none">
 </p>
</div>


