---
arturl_encode: "68747470733a2f:2f626c6f672e6373646e2e6e65742f71713337373234383631:2f61727469636c652f64657461696c732f3531383337393435"
layout: post
title: "运行时错误91问题汇总"
date: 2024-12-07 11:46:00 +08:00
description: "在总账中，查询管理费用时报\"7-内存溢出\"或“未设置对象变量，运行时91错误”。     此问题请检"
keywords: "运行错误91"
categories: ['用友相关']
tags: ['无标签']
artid: "51837945"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=51837945
    alt: "运行时错误91问题汇总"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=51837945
featuredImagePreview: https://bing.ee123.net/img/rand?artid=51837945
---

# 运行时错误91问题汇总

在总账中，查询管理费用时报"7-内存溢出"或“未设置对象变量，运行时91错误”。

此问题请检查机器环境: 机器名是否含特殊字符或中文,登陆操作系统的操作员名是否含特殊字符或中文,其权限是否为超级管理员或高级用户. 重新注册软件的所有组件,可使用通网站服务工具中的维护通2.0中的三十九号工具进行注册. 清空系统临时文件夹,路径:   C:\Documents and Settings\Administrator\Local Settings\Temp 如问题未解决,请将账套引入到其它机器确定是否为数据问题.

2. 在总账记账时提示“运行时错误 91，未设置对象变量或With block 变量”。

总账中遇到这种错误，可能就是和计算机名称、登陆账户有关。计算机名称最好是全英文的，登陆账户也应该用英文名。查看登陆操作系统的用户具有什么权限，我们要求必须是超级用户以上的权限才可以。

3. 客户在使用薪资统计查询时，出现“91号错误，未设置对象变量或With block 变量”同时个人工资统计查询表不可用，不能查询出结果

此问题是因为组件丢失所致请重新注册一下组件或是重新安装一下软件

4. 销售发票列表联查销售发票，出错“运行错误91”

开发已做出补丁，请上网下载相应版本的补丁。补丁路径：用友通10.2标准版：\\tongserver\补丁包\补丁包\用友通10.2补丁包\标准版\2007-11-05星期一\23335-23067   用友通10.2工业版\\tongserver\补丁包\补丁包\用友通10.2补丁包\工业版\2007-11-05星期一\23335- 23067

5. 查询账表时提示，
**运行时错误91**
，服务器为2000server可以正常登陆，客户端为xp出现此问题< /font>

使用服务工具中的维护通2.0中的工具三十九把客户端的组件重新注册一下,或卸载客户端软件,删除system32\ fcomsql这个文件夹，然后再重新安装软件。

6. 凭证无法打印，预览时提示“
**运行时错误91**
，未设置变量或with block”。

先检查机器名是否为纯英文,不允许有.\_%等特殊字符;   2.如果正常,则删除ZWSQLTemp.mdb文件，重新登录产品,文件保存位置:ZWSQLTemp.mdb默认路径(XXX：指系统登录帐户) 操作系统路径\Documents and Settings\XXX\Local Settings\Temp，此路径即系统环境变量中用户变量的Tmp变量值(参见系统环境参数章),如C:\Documents   and Settings\Administrator \Local Settings\Temp; 3.如果不行,请使用注册组件的工具,下载:http: //tong.ufida.com.cn/infomanage/qudao/ewebeditor/UploadFile/200771883845683.rar   还解决不了,请重新安装软件,卸载完软件后,删除c:\window\system32下的ufcomsql文件夹,再装。

7. 新装系统，安装用友通10.1plus2后，运行自定义转帐、期间损益结转、查询明细账时均报错“
**运行时错误91**
”。卸载软件，删除ufcomsql后重装软件问题依旧。
  
用for %%s in   (%windir%\system32\ufcomsql\\*.dll) do regsvr32.exe/s %%s
  
for %%s in (%windir%\system32\ufcomsql\\*.ocx) do regsvr32.exe/s %%s
  
注册后问题依旧。
  
此提示有这个几种情况 1、登录系统的操作员不够 2、登录系统的操作员是中文名 3、ZWSQLTemp.mdb出错，此文件存于操作系统路径\Documents and Settings\XXX\Local Settings\Temp，删除掉即可,所以建立一个新的只有英文字母的操作员来登录系统。
  
8. 在查询明细账时提示“
**运行时错误91**
,未设置对象变量或with   block变量”。
  
请看一下机器名和登陆操作系统的用户名有没有特殊符号，或带有中文名，如有请将机器名修改为纯英文的，增加一个纯英文的操作系统用户。如过没有，那请将软件进行卸载，删除system32下的ufcomsql文件夹，重新安装软件。
  
9. 用户在安装用友通普及版10.2时,在进行打印设置时,打印预览凭证时,提示:“
**运行时错误91**
未设置对象变量或 WITH BLOCK变量”。此时自动退出.此后进入填制凭证时,刚又提示:“运行时错误429ACTIVEX.部件不能创建对象”.重新注册后,才可进行填制凭证界面。已经试过重装软件.等一些操作,仍不能解决问题。
  
有控件没有注册上,重新注册下列文件:ufmoney.ocx,ufrtpm.ocx,uszzpub.dll, usnate.dll   2.硬盘可能有坏道,换一个硬盘安装软件 3.重装软件没删除干净,请重装前把安装目录和注册表以及c:\window\system32\ufcomsql 删除
  
10. 点击如凭证打印，明细账查询，打印等查询和打印时都提示“运行时错误９１，未设置对象变量或with& nbsp; block 变量”。
  
请检查登陆操作系统的用户名是否为中文名，计算机名称是否带有特殊符号，或是以中文开头，这两者最好是全英文的。2. 请将软件进行卸载，然后停止mssqlserver服务（开始/运行/net   stop mssqlserver),删除ufcomsql文件夹，再启动mssqlserver服务，重装软件。
  
11.在总账模块中，在进行月末结账时提示为＂运行错误９１＂不能进行结账。
  
请检查一下机器名是否带有特殊符号或以数字开头，机器名最好是纯英文的，还有登陆操作系统的用户名也应该上以英文字母开头，不能带特殊符号。
  
12.一客户有普及版总账．出现很多报错．能做凭证其他的什么都不能做．包括打印．提示＂运行错误９１未设置对象变量或 with   block变量＂．如果重新注册再进问题又发生变化了可能不能做凭证但能做其他的一项．不知是什么原因造成的．安装时没有任何报错。
  
请按如下操作假如操作系统安装在c盘下 打开开始里的运行输入   xp版本:regsvr32 c:\windows\system32\ufcomsql\ufmoney.ocx   2000版本:regsvr32 c:\winnt\system32\ufcomsql\ufmoney.ocx   提示成功。
  
13.固定资产减少时报错ＤＡＯ－ＡＤＯ对象模型，然后“运行时错误９１”，“运行时错误４４０”
  
请检查机器名字是否为纯英文（不要有-号等特殊字符）；请检查卡片项目中是否有特殊字符。

14.一客户在局域网内十几台电脑,进总帐查询科目明细帐时提示'运行时错误９１，未设置对象变量或with& nbsp; block 变量”,点确定后出现错误440-Automation ,然后就像死机一样动不了电脑.

经查,该客户帐套有两个年度,07年度帐里查询科目明细帐正常,排除不是系统环境问题,用数据库事件查看器跟踪事务,发现在08年度帐里少了一个存储过程:GL\_subsledger,从07年度帐里复制该存储过程后,问题解决