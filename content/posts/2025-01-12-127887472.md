---
arturl_encode: "68747470733a:2f2f626c6f672e6373646e2e6e65742f4241534b323331322f:61727469636c652f64657461696c732f313237383837343732"
layout: post
title: "æ€ä¹ˆå°±æ•¢ç”¨NodeJSå†™åƒä¸‡çº§åˆ«çš„æœåŠ¡åç«¯"
date: 2025-01-12 02:45:35 +0800
description: "é€šè¿‡å¤šçº§ç¼“å­˜ç­–ç•¥ã€ä¼˜åŒ–æ¸²æŸ“æ¨¡å¼å’Œå€ŸåŠ©kafkaè§£è€¦ï¼Œå°½ç®¡åˆæœŸè®¤ä¸ºé‡ä¸å¤§ï¼Œä½†å®é™…ä¸Šçº¿å"
keywords: "nodejsèƒ½æŠ—ä½1000ä¸‡å¹¶å‘"
categories: ['æœªåˆ†ç±»']
tags: ['ç³»ç»Ÿæ¶æ„']
artid: "127887472"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=127887472
    alt: "æ€ä¹ˆå°±æ•¢ç”¨NodeJSå†™åƒä¸‡çº§åˆ«çš„æœåŠ¡åç«¯"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=127887472
featuredImagePreview: https://bing.ee123.net/img/rand?artid=127887472
---

# æ€ä¹ˆå°±æ•¢ç”¨NodeJSå†™åƒä¸‡çº§åˆ«çš„æœåŠ¡åç«¯

å‰è¨€ï¼šNodeJSçœŸçš„æ˜¯ç©å…·å—ï¼ŸçœŸæœ‰äººæ•¢ç”¨è¿™ä¸ªç©å…·æ¥å†™åç«¯æœåŠ¡ï¼Œå®ƒèƒ½æ”¯æ’‘æˆä¸€ä¸ª
**åƒä¸‡çº§åˆ«**
çš„ç”¨æˆ·é‡çº§å—ï¼Ÿæ€ä¹ˆå°±å¸¦ç€æˆ‘çš„å›¢é˜Ÿç¨€é‡Œç³Šæ¶‚æŠŠè¿™äº‹è€Œä¸”åšæˆã€‚è¿™ç¯‡æ–‡ç« å°†åˆ†äº«è¿™æ¬¡é¡¹ç›®çš„å¹¶å‘å®è·µç»éªŒã€‚

### ä¸€ã€é¡¹ç›®èƒŒæ™¯

> è€æ¿è¯´ï¼šå…¬å¸è¦ææˆ˜ç•¥NPSï¼Œéœ€è¦ä¸€å¥—é—®å·ç³»ç»Ÿã€‚è¦èƒ½é…ç½®é—®å·å’Œå›æ”¶ç­”æ¡ˆå°±è¡Œï¼Œåç«¯æœ¨æœ‰èµ„æºï¼Œç»™ä¸ªæœºä¼šå‰ç«¯æå…¨æ ˆå“ˆï¼Œå…ˆç®€å•æå“ˆï¼Œæ—©æœŸæ²¡å•¥é‡ï¼Œä¸ç”¨æ…Œå“ˆï¼Œçœ‹å¥½ä½ ä»¬å“Ÿã€‚

![](https://i-blog.csdnimg.cn/blog_migrate/cbbf2d262a6ddf29687b9637aa6f2c66.png)

å†™ä¸ªé—®å·ç³»ç»Ÿï¼Œå°†å®ƒåˆ†æˆä¸¤ä¸ªéƒ¨åˆ†å°±è¡Œã€‚

![](https://i-blog.csdnimg.cn/blog_migrate/c935e9bbba401564c131e608fb8b9e8b.png)

* **é—®å·é…ç½®ç®¡ç†ç«¯**
  ï¼šä¸å°±æ˜¯ä¸€ä¸ªå†…éƒ¨ç³»ç»Ÿï¼Œå…¬å¸å†…éƒ¨äººç”¨ï¼Œæœ‰å•¥é‡çš„ï¼Œé—®é¢˜ä¸å¤§ã€‚ï¼ˆä¸åœ¨æœ¬æ–‡å†…å®¹è®¨è®ºèŒƒå›´ï¼‰
* **é—®å·æœåŠ¡**
  ï¼šè¦ç»™ç”¨æˆ·è®¿é—®çš„å‘€ï¼Œè¦åšé«˜å¹¶å‘å‘€ã€‚æ—©æœŸä¸æ˜¯æ²¡å•¥é‡å˜›ï¼Œå…ˆç”¨NodeJSå†™ï¼Œç­‰å¹¶å‘èµ·æ¥åï¼Œå¦‚æœæä¸å®šå†è®©åç«¯æ¥é”…ğŸ˜„å‘—ï¼Œå†è¯´ä¸šåŠ¡èƒ½ä¸èƒ½èµ·æ¥éƒ½å¾ˆéš¾è¯´ï¼Œï¼ˆåæ­£äººå’Œä»£ç æœ‰ä¸€ä¸ªèƒ½è·‘å°±è¡ŒğŸ˜‚ï¼‰

![](https://i-blog.csdnimg.cn/blog_migrate/d5c9c7097937adb71ffd9718196d2e54.png)

*éš¾å¾—æœ‰ä¸€ä¸ªæœºä¼šå¯ä»¥æå…¨æ ˆè€Œä¸”è¿˜è¦ä¸€å®šçš„ç”¨æˆ·ä½“é‡ï¼Œè™½ç„¶å¾ˆæ…Œï¼Œä½†æ˜¯ï¼Œè¿˜æ˜¯å¾ˆæœ‰å¹²åŠ²çš„å‘€ğŸ˜*

![](https://i-blog.csdnimg.cn/blog_migrate/e836b77e4c02beda82218ed0f9ddd38d.png)

### äºŒã€ç³»ç»Ÿæ¶æ„

> æœ‰ä¸€ä¸ªæå…¨æ ˆçš„æœºä¼šï¼Œè™½ç„¶å¾ˆæ…Œï¼Œä½†æ˜¯ï¼Œè¿˜æ˜¯å¾ˆæœ‰å¹²åŠ²çš„å‘€ğŸ˜ï¼Œæ¶ˆåŒ–è€æ¿çš„å¤§é¥¼ï¼Œæ˜¯æ—¶å€™è¦å¼€å¹²äº†ã€‚

![](https://i-blog.csdnimg.cn/blog_migrate/8121badb4195940a9dd12a2765db7f64.png)

è®¾è®¡ä¸€ä¸ªæ¶æ„å›¾ï¼Œå†æ‰¾æœ‰ç»éªŒçš„åç«¯å¤§ä½¬ä»¬è¿‡ä¸€ä¸‹ã€‚

![](https://i-blog.csdnimg.cn/blog_migrate/6ce5388af35ae29582402f39c0a3b2df.png)

ä¸Šå›¾é»„è‰²éƒ¨åˆ†æ˜¯é…ç½®é—®å·çš„ç®¡ç†çš„æ¨¡å—ï¼Œå³è¾¹ç»¿è‰²éƒ¨åˆ†é—®å·å¯¹å¤–çš„æœåŠ¡æ¨¡å—ï¼Œåœ¨æ•´ä¸ªæ¶æ„å…¨å±€æ¥çœ‹ï¼Œéœ€è¦æ”¯æŒå¹¶å‘çš„å…¶å®åªæœ‰ä¸¤ä¸ªæ¨¡å—ï¼š

* **GET**
  é—®å·é¡µé¢æ¸²æŸ“æ¨¡å—
* **POST**
  ç­”æ¡ˆä¸ŠæŠ¥æ¨¡å—

### ä¸‰ã€åº”å¯¹ä¹‹ç­–

æŒ‰ç…§é—®å·å›æ”¶ç»éªŒæ¥è¯´ï¼Œå¤§æ¦‚ï¼Œ
**10ä¸ªé—®å·é¡µé¢æµè§ˆ > æ‰ä¼šæœ‰1ç­”æ¡ˆä¸ŠæŠ¥**
å¤„ç†å¹¶å‘è¦å‘½çš„æ˜¯é¡µé¢è¯»æ¥å£ï¼Œå…¶æ¬¡æ˜¯ç­”æ¡ˆä¸ŠæŠ¥çš„å†™æ¥å£ã€‚å¹¶å‘å¤„ç†å¼€å¹²äº†ã€‚

![](https://i-blog.csdnimg.cn/blog_migrate/9527c1b98c6a26f5a1079831ece21d17.png)

#### 3.1 é¡µé¢æ¸²æŸ“å¹¶å‘å¤„ç†

æ¸²æŸ“è¿è¥é…ç½®çš„é—®å·é¡µé¢ï¼Œå¹¶å‘é‡æ˜¯æ•´ä¸ªtoCæµé‡æœ€å¤§çš„ï¼Œæœ€å…·æœ‰æŒ‘æˆ˜éš¾åº¦çš„ã€‚ æ¥ä¸‹æ¥é€šè¿‡æ‹†è§£æ•´ä¸ªæ¥å£çš„è¿‡ç¨‹ï¼Œç„¶åä½¿ç”¨å¤šçº§ç¼“å­˜ç­–ç•¥å’Œæ”¹è¿›çš„CSRæ¥è§£å†³å¹¶å‘éš¾é¢˜ã€‚

![](https://i-blog.csdnimg.cn/blog_migrate/44622f0f73353a2cef53f1007986de44.png)

3.1.1 æ¸²æŸ“æµç¨‹

æ¸²æŸ“å‰ï¼Œéœ€è¦è·å–åˆ°æ•°æ®åº“è¿è¥é…ç½®é—®å·çš„é¢˜ç›®ç›¸å…³çš„ä¿¡æ¯

![](https://i-blog.csdnimg.cn/blog_migrate/65869952ab3f778db102f9e0509d8feb.png)

* pageDataï¼Œæ¯ä¸ªé—®å·é…ç½®çš„å†…å®¹ä¸ä¸€æ ·ï¼Œè¿è¥å•¥æ—¶å€™ä¿®æ”¹é—®å·ä¹Ÿä¸çŸ¥é“ï¼Œéœ€è¦åœ¨æ•°æ®åº“æ‹‰å»é…ç½®å¯¹åº”é—®å·IDçš„é…ç½®ç»™åˆ°å‰ç«¯æ¥æ¸²æŸ“é¡µé¢ï¼›ï¼ˆ
  **é¡µé¢çº§åˆ«çš„æ•°æ®ï¼Œå˜æ›´ä¸å¯æ§**
  ï¼‰
* renderæ˜¯ä¸€ä¸ªJSæ¸²æŸ“åº“ï¼Œæ‰€æœ‰é—®å·éƒ½æ˜¯ä¸€æ ·ï¼Œåªè¦ä¸å‘å¸ƒç‰ˆå°±ä¸ä¼šæ›´æ–°ï¼Œæ”¾åˆ°CDNæ¥æ‰›å¹¶å‘å³å¯ã€‚ï¼ˆ
  **åº”ç”¨çº§åˆ«çš„æ•°æ®ï¼Œå˜æ›´å¯æ§**
  ï¼‰

![](https://i-blog.csdnimg.cn/blog_migrate/461cc70a09acf1bbcd73ec6aaa54fa0c.png)

3.1.2 é¡µé¢æ•°æ®ç¼“å­˜ç­–ç•¥

pageDataæ˜¯é¡µé¢æ•°æ®ï¼Œè™½ç„¶è¦å®æ—¶æ¥å–ï¼Œä½†æ˜¯å¯ä»¥åšé€‚å½“çš„ç¼“å­˜ç­–ç•¥ã€‚æ‹‰å»pageDataè¯»æ¥å£é‡‡ç”¨äº†å¤šçº§ç¼“å­˜ï¼Œæµç¨‹å¦‚ä¸‹ï¼š

* é¦–æ¬¡é€šè¿‡è¿œç¨‹è°ƒç”¨å–è¯»å–å†…éƒ¨ç®¡ç†çš„é—®å·é…ç½®æ•°æ®ï¼›
* æ¸²æŸ“é¡µé¢å®Œæˆï¼Œå†™å…¥å†…å­˜ç¼“å­˜å’ŒRedisç¼“å­˜ï¼›
* ä¸‹æ¬¡æ¸²æŸ“ï¼Œå…ˆæŒ‰ç…§å†…å­˜ > rediesç¼“å­˜è¯»å–ï¼Œæ²¡æœ‰å†é‡å¤é¦–æ¬¡è®¿é—®é€»è¾‘ã€‚

![](https://i-blog.csdnimg.cn/blog_migrate/bbe0499d253f364a3de6e38078aba5dc.png)

é€šè¿‡è®¾ç½®å¤šçº§ç¼“å­˜ï¼Œå‡å°‘mysqlçš„å¹¶å‘å‹åŠ›å’Œé¡µé¢åŠ é€ŸğŸ˜„

![](https://i-blog.csdnimg.cn/blog_migrate/6a7fc012a1a6f0cad549d3a1b304f548.png)

3.1.3 æ¸²æŸ“æ¨¡å¼

ä¸ºäº†å‘å¹¶å‘å¦¥åï¼Œæ²¡æœ‰ä½¿ç”¨æœåŠ¡å™¨ç«¯æ¸²æŸ“ã€‚

![](https://i-blog.csdnimg.cn/blog_migrate/707aabae19b6619e25666b9c16fab427.png)

æˆ‘ä»¬é€‰æ‹©äº†CSRã€‚

![](https://i-blog.csdnimg.cn/blog_migrate/8b0f7be971d98827c0dfe2812af92cfa.png)

ä½†æ˜¯ï¼Œä¸ºäº†é¡µé¢æ€§èƒ½æ›´å¥½ï¼Œæˆ‘ä»¬æ”¹è¿›CSRæ¨¡å¼ï¼ŒæŠŠæœ¬æ¥è¦è¯»pageDataæ¥å£å’Œhtmlæ¡†æ¶é¡µé¢æ”¾åˆ°æœåŠ¡å™¨ç«¯åˆå¹¶èµ·æ¥ã€‚

```
/**
* htmlæ‹¼æ¥æ–¹æ³•
* @param pageDataï¼Œé—®å·é¢˜ç›®é…ç½®æ•°æ®
* @param resouceInfoï¼Œå‰ç«¯èµ„æºç‰ˆæœ¬æ§åˆ¶ï¼Œç”±æœåŠ¡ç«¯æ§åˆ¶åšé•¿ç¼“å­˜æ›´æ–°ä½¿ç”¨
*/
function render(pageDataï¼ŒresouceInfo){
 const html = `<!DOCTYPE html>
 <html lang="en">
 <head>
  <title>${pageData.title || 'é—®å·'}</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-COMPATIBLE" content="IE=Edge,chrome=1">
  <meta name="nightmode" content="disable">
  <link rel="shortcut icon" type="image/x-icon" href="//wenjuan-static-cn.heytapimage.com/wj-prod/faviconIcon.ico" id="favicon">
  <!--é—®å·é¡µé¢æ ·å¼æ–‡ä»¶-->
  <link href="${resouceInfo['main-css']}"  rel="stylesheet">
  <!--babelå«ç‰‡-->
  <script content="babel-polyfill" nomodule  src="${resouceInfo['babel-polyfill']}"></script>
  <!--vueå…¨å®¶æ¡¶-->
  <script content="vue-all" src="${resouceInfo['vue-all']}"></script>
 </head>
 <body ${bodyStyle}>
  <div id="app"></div>
    <script content="page-data">
      // pageData ç›´å‡ºåˆ°é¡µé¢å¹¶æŒ‚åœ¨åœ¨windowï¼Œæ–¹ä¾¿vueä½¿ç”¨
      window.asyncData = ${JSON.stringify(pageData)};
    </script>
    <!--é—®å·é¡µé¢å…¥å£js-->
    <script content="main-js"  src="${resouceInfo['main-js']}"></script>
  </body>
  </html>`
  
  return html
}
å¤åˆ¶ä»£ç 
```

æ”¹è¿›çš„CSRæ¨¡å¼ï¼Œåœ¨ä¸å¢åŠ æœåŠ¡å™¨è´Ÿè½½çš„æƒ…å†µä¸‹ï¼Œå‡å°‘äº†æ•°æ®è¯»å–è¿‡ç¨‹ï¼Œå°†getPageDataæ¥å£å’ŒhtmlåˆäºŒä¸ºä¸€ã€‚é¡µé¢åœ¨æµè§ˆå™¨æ¸²æŸ“ï¼Œä¸ç”¨åœ¨è¯·æ±‚åç«¯æ¥å£è·å–pageDataï¼Œé¦–å±æ¸²æŸ“é€Ÿåº¦æ›´å¿«ï¼ï¼ï¼

![](https://i-blog.csdnimg.cn/blog_migrate/54078ef2b0e71fd1bd60858b4e27d0ab.png)

![](https://i-blog.csdnimg.cn/blog_migrate/e323ac6c95faa9b57928b194aeff53bb.png)

#### 3.2 ä¸ŠæŠ¥æ¥å£å¹¶å‘å¤„ç†

é—®å·ç­”æ¡ˆä¸ŠæŠ¥æ¥å£ï¼Œè™½ç„¶é‡åªæœ‰ä¸Šé¢æ¸²æŸ“æ¥å£çš„1/10ï¼Œä½†æ˜¯å®ƒæ˜¯ä¸ªå†™æ¥å£ï¼Œä»å¤–ç½‘æµé‡å†™å…¥æ˜¯å†…éƒ¨ç³»ç»ŸæœåŠ¡çš„ï¼ˆææ…Œ.jpgï¼‰ã€‚

![](https://i-blog.csdnimg.cn/blog_migrate/54fdc4879c2f4b41a6700208cb0c968c.png)

å€ŸåŠ©kafkaè§£è€¦åï¼Œå¹¶å‘è¯·æ±‚å¸¦æ¥å¯ä»¥å‘åå€Ÿæ—¶é—´ï¼Œè¿™å°±è§£å†³å†™å…¥çš„ç“¶é¢ˆå’Œç³»ç»Ÿè´Ÿè½½ã€‚

* é€šè¿‡è°ƒèŠ‚kafkaæ¶ˆæ¯æ¶ˆè´¹çš„é€Ÿåº¦ï¼Œè®©å†…éƒ¨ç®¡ç†çš„ä¹Ÿå¯ä»¥åº”å¯¹ToCçš„é—®å·ç­”æ¡ˆä¸ŠæŠ¥æµé‡çš„å†™å…¥æ“ä½œã€‚
* è§£å†³ç³»ç»Ÿè´Ÿè½½ï¼ŒåŸæœ¬ä¸‰ä¸ªä¸²è¡Œä»»åŠ¡çš„è€—æ—¶é‡è®¡ç®—ä»»åŠ¡æ”¾åœ¨å¹¶å‘å¤„ç†ä¸­ï¼Œæ”¹åˆ°åªç•™
  **æ•°æ®è¡¥é½å’Œæ ¡éªŒ**
  ä»»åŠ¡ï¼Œå¦ä½ä¸¤ä¸ªæ”¾åˆ°æ¶ˆè´¹æ•°æ®å†æ‰§è¡Œï¼Œè¾¾åˆ°å‘åå€Ÿæ—¶é—´ç›®çš„ã€‚

![](https://i-blog.csdnimg.cn/blog_migrate/125459f03ea0df16f04410458e6a1ddf.png)

### å››ã€è¾¾åˆ°æ•ˆæœ

> æ€»ç®—å¼€å‘å®Œæˆäº†ï¼Œ è€æ¿è¯´ï¼šç»™ä½ ä»¬æ‰¾åˆ°äº†ä¸€ä¸ªä¸šåŠ¡æ¥ç”¨ï¼Œä»–ä»¬åå¤©è¦æŠ•Xåƒä¸‡ç”¨æˆ·ï¼Œè¦èµ°PUSHæ¸ é“ï¼Œä½ ä»¬æ¥ä¸€ä¸‹ã€‚

å•Šï¼å•Šï¼å•Šï¼è¿™ï¼Ÿä¸æ˜¯è¯´æ—©æœŸæ²¡å•¥é‡å—ï¼ŸğŸ˜¢å’‹ä¸€ä¸Šæ¥å°±xåƒä¸‡ç”¨æˆ·å‘¢ï¼Ÿè¿˜æ˜¯èµ°
**PUSHæ¸ é“**
ã€‚

![](https://i-blog.csdnimg.cn/blog_migrate/6e9a6df9a9e0b5b11fe3ca4901cd4a22.png)

æœ€åçº¿ä¸Šæ•ˆæœå¦‚ä¸‹ï¼š

![](https://i-blog.csdnimg.cn/blog_migrate/22c13dce5941d019140be40f5d9ae13e.png)

*æ³¨ï¼šéƒ¨ç½²äº†4å°8G16æ ¸çš„å®¹å™¨ä¸»æœºã€‚*

![](https://i-blog.csdnimg.cn/blog_migrate/898b3b2bebec1f36668ffb546bf1b836.png)

### äº”ã€æ€»ç»“

è¿™æ¬¡é¡¹ç›®ç”¨åˆ°redisã€kafkaã€mysqlå®Œæˆç”±äº‘å¹³å°æä¾›ï¼Œå°±æ˜¯ä¹°ä¹°ä¹°å°±è¡Œï¼Œéšç€å„ç§æ•°æ®åº“å’Œä¸­é—´ä»¶ä¸Šäº‘äº¤ä»˜ï¼Œå‰ç«¯å†™åç«¯å·²ç»å®Œå…¨å¯è¡Œã€‚è€Œä¸”åƒå°ç¨‹åºäº‘è¿™ç§æˆç†Ÿçš„FASSäº‘è®¾æ–½æ™®åŠï¼ŒæŠŠåç«¯ä»£ç ä¹Ÿå¯ä»¥å†™åˆ°å‰ç«¯é‡Œå»å†™ä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œå‰ç«¯äººï¼Œå·²ç»ä¸å†æ˜¯åˆ‡å›¾ä»”äº†ã€‚