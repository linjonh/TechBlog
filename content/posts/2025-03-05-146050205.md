---
arturl_encode: "68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f36393833383739352f:61727469636c652f64657461696c732f313436303530323035"
layout: post
title: "Vue-3-å®ç°å¯Œæ–‡æœ¬å†…å®¹å¯¼å‡º-Word-æ–‡æ¡£å‰ç«¯ç›´å‡ºæ–¹æ¡ˆä¸ä¼˜åŒ–å®è·µ"
date: 2025-03-05 18:42:37 +0800
description: "ä¼˜åŠ¿äº®ç‚¹ğŸš€ 300ms å†…å®Œæˆæ–‡æ¡£ç”ŸæˆğŸ–¨ï¸ å®Œç¾å…¼å®¹ WPS/Office ç­‰åŠå…¬è½¯ä»¶ğŸ“¦ é›¶æœåŠ¡ç«¯ä¾èµ–ğŸ”’ å†…å®¹ä¸ç»è¿‡ç½‘ç»œä¼ è¾“æ‰©å±•æ–¹å‘ä¸åç«¯åä½œå®ç°æ¨¡æ¿åŒ–å¯¼å‡ºé›†æˆç”µå­ç­¾ååŠŸèƒ½æ·»åŠ æ–‡æ¡£åŠ å¯†ä¿æŠ¤æºç å‚è€ƒæç¤ºï¼šç”Ÿäº§ç¯å¢ƒå»ºè®®æ·»åŠ æ–‡ä»¶å¤§å°ç›‘æ§ï¼Œé˜²æ­¢ç”Ÿæˆè¶…å¤§æ–‡æ¡£å¯¼è‡´æµè§ˆå™¨å´©æºƒã€‚"
keywords: "Vue 3 å®ç°å¯Œæ–‡æœ¬å†…å®¹å¯¼å‡º Word æ–‡æ¡£ï¼šå‰ç«¯ç›´å‡ºæ–¹æ¡ˆä¸ä¼˜åŒ–å®è·µ"
categories: ['æœªåˆ†ç±»']
tags: ['å‰ç«¯', 'Word', 'Vue']
artid: "146050205"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146050205
    alt: "Vue-3-å®ç°å¯Œæ–‡æœ¬å†…å®¹å¯¼å‡º-Word-æ–‡æ¡£å‰ç«¯ç›´å‡ºæ–¹æ¡ˆä¸ä¼˜åŒ–å®è·µ"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146050205
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146050205
cover: https://bing.ee123.net/img/rand?artid=146050205
image: https://bing.ee123.net/img/rand?artid=146050205
img: https://bing.ee123.net/img/rand?artid=146050205
---

# Vue 3 å®ç°å¯Œæ–‡æœ¬å†…å®¹å¯¼å‡º Word æ–‡æ¡£ï¼šå‰ç«¯ç›´å‡ºæ–¹æ¡ˆä¸ä¼˜åŒ–å®è·µ

---

![Word Export Demo](https://i-blog.csdnimg.cn/img_convert/db62ae3fc5f566bdfed9494c32b5c2e9.jpeg)

æœ¬æ–‡å°†æ·±å…¥è®²è§£å¦‚ä½•é€šè¿‡çº¯å‰ç«¯æ–¹æ¡ˆå°†å¯Œæ–‡æœ¬å†…å®¹ç›´æ¥å¯¼å‡ºä¸ºç¬¦åˆä¸­æ–‡æ’ç‰ˆè§„èŒƒçš„ Word æ–‡æ¡£ï¼Œå¯¹æ¯”ä¼ ç»ŸæœåŠ¡ç«¯ç”Ÿæˆæ–¹æ¡ˆï¼Œæœ¬æ–¹æ¡ˆå¯é™ä½æœåŠ¡å™¨å‹åŠ› 80% ä»¥ä¸Šï¼ŒåŒæ—¶æ”¯æŒå³æ—¶ä¸‹è½½åŠŸèƒ½ã€‚

---

##### ä¸€ã€åŠŸèƒ½å…¨æ™¯å›¾

è¯¥æ–¹æ¡ˆå®ç°ä»¥ä¸‹æ ¸å¿ƒèƒ½åŠ›ï¼š
  
âœ… çº¯å‰ç«¯ Word æ–‡æ¡£ç”Ÿæˆ
  
âœ… ä¸­æ–‡ä»¿å®‹å­—ä½“å®Œç¾æ”¯æŒ
  
âœ… æ™ºèƒ½åˆ†é¡µä¸é¡µè¾¹è·æ§åˆ¶
  
âœ… å†…å­˜å®‰å…¨å›æ”¶æœºåˆ¶
  
âœ… æµè§ˆå™¨å…¨å…¼å®¹æ–¹æ¡ˆ

---

##### äºŒã€æŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | å“åº”é€Ÿåº¦ | æœåŠ¡å™¨å‹åŠ› | å…¼å®¹æ€§è¦æ±‚ | å®ç°å¤æ‚åº¦ |
| --- | --- | --- | --- | --- |
| æœåŠ¡ç«¯ç”Ÿæˆï¼ˆä¼ ç»Ÿæ–¹æ¡ˆï¼‰ | æ…¢ | é«˜ | ä½ | é«˜ |
| å‰ç«¯ç›´å‡ºï¼ˆæœ¬æ–¹æ¡ˆï¼‰ | å¿« | é›¶ | ä¸­ | ä¸­ |

---

##### ä¸‰ã€æ ¸å¿ƒä»£ç å®ç°

###### 1. åŸºç¡€å¯¼å‡ºåŠŸèƒ½

```typescript
const exportDocx = async (html: string) => {
  try {
    // æ„å»ºå®Œæ•´HTMLç»“æ„
    const fullHtml = `
      <!DOCTYPE html>
      <html>
        <body style="font-family:æ–¹æ­£ä»¿å®‹_GBK,serif;mso-ascii-font-family:'Times New Roman'">
          ${html}
        </body>
      </html>
    `;

    // è½¬æ¢ä¸ºWordæ–‡æ¡£Blob
    const blob = await asBlob(fullHtml, {
      paperSize: 'A4',
      orientation: 'portrait',
      margins: { top: 100 } // å•ä½ï¼špt
    });

    // åˆ›å»ºä¸‹è½½é“¾æ¥
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `æ–‡æ¡£_${new Date().getTime()}.docx`;
    
    // è§¦å‘ä¸‹è½½
    document.body.appendChild(a);
    a.click();
    
    // æ¸…ç†èµ„æº
    URL.revokeObjectURL(url);
    document.body.removeChild(a);
  } catch (error) {
    console.error('å¯¼å‡ºå¤±è´¥:', error);
    showErrorToast('æ–‡æ¡£ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•');
  }
};

```

###### 2. æ ¸å¿ƒé…ç½®è¯´æ˜

```javascript
{
  paperSize: 'A4',        // çº¸å¼ ç±»å‹
  orientation: 'portrait',// çºµå‘æ’ç‰ˆ
  margins: {              // é¡µè¾¹è·é…ç½®
    top: 100,             // ä¸Šè¾¹è·ï¼ˆ1ptâ‰ˆ0.35mmï¼‰
    right: 85,
    bottom: 100,
    left: 85
  },
  fontFamily: {           // å­—ä½“å›é€€æ–¹æ¡ˆ
    default: 'æ–¹æ­£ä»¿å®‹_GBK',
    ascii: 'Times New Roman'
  }
}

```

---

##### å››ã€å…³é”®æŠ€æœ¯ç‚¹è§£æ

###### 1. å­—ä½“å…¼å®¹æ–¹æ¡ˆ

```html
<!-- å£°æ˜å­—ä½“ä¼˜å…ˆçº§ -->
<style>
  @page {
    mso-font-charset: 0;
    mso-header-margin: 36pt;
    mso-footer-margin: 36pt;
  }
  body {
    font-family: æ–¹æ­£ä»¿å®‹_GBK, SimSun, serif;
    mso-ascii-font-family: 'Times New Roman';
  }
</style>

```

###### 2. å†…å­˜å®‰å…¨æœºåˆ¶

```typescript
// åˆ›å»ºä¸´æ—¶URL
const url = URL.createObjectURL(blob);

// ä¸‹è½½å®Œæˆåç«‹å³æ¸…ç†
a.addEventListener('click', () => {
  setTimeout(() => {
    URL.revokeObjectURL(url); // é˜²æ­¢å†…å­˜æ³„æ¼
  }, 100);
});

```

###### 3. ç”¨æˆ·ä½“éªŒä¼˜åŒ–

```typescript
// æ·»åŠ åŠ è½½çŠ¶æ€
const isLoading = ref(false);

const exportWithLoading = async (html: string) => {
  isLoading.value = true;
  try {
    await exportDocx(html);
  } finally {
    isLoading.value = false;
  }
};

```

---

##### äº”ã€é«˜çº§åŠŸèƒ½æ‰©å±•

###### 1. åˆ†é¡µæ§åˆ¶

```html
<!-- æ’å…¥åˆ†é¡µç¬¦ -->
<div style="page-break-before: always;"></div>

```

###### 2. é¡µçœ‰é¡µè„š

```html
<!-- é€šè¿‡CSSæ¨¡æ‹Ÿ -->
<style>
  @page {
    @top-center {
      content: "ä¼ä¸šæœºå¯†æ–‡æ¡£";
      font-size: 9pt;
    }
    @bottom-right {
      content: "ç¬¬ " counter(page) " é¡µ";
    }
  }
</style>

```

###### 3. æ°´å°åŠŸèƒ½

```javascript
// æ·»åŠ èƒŒæ™¯æ°´å°
body {
  background-image: url("data:image/svg+xml,...");
  background-repeat: repeat;
}

```

---

##### å…­ã€æœ€ä½³å®è·µå»ºè®®

1. **å†…å®¹å®‰å…¨**

   ```typescript
   // ä½¿ç”¨ DOMPurify æ¶ˆæ¯’å†…å®¹
   import DOMPurify from 'dompurify';
   const cleanHtml = DOMPurify.sanitize(rawHtml);

   ```
2. **æ–‡ä»¶å‘½åè§„èŒƒ**

   ```typescript
   // ç”Ÿæˆæ ‡å‡†åŒ–æ–‡ä»¶å
   const filename = `${title}_${dayjs().format('YYYYMMDD-HHmm')}.docx`;

   ```
3. **é”™è¯¯ç›‘æ§**

   ```typescript
   try {
     await exportDocx(html);
   } catch (err) {
     captureException(err); // æ¥å…¥Sentryç­‰ç›‘æ§
   }

   ```

---

##### ä¸ƒã€æµè§ˆå™¨å…¼å®¹æ–¹æ¡ˆ

| æµè§ˆå™¨ | å…¼å®¹æ€§å¤„ç†æ–¹æ¡ˆ |
| --- | --- |
| Chrome/Firefox | åŸç”Ÿæ”¯æŒ |
| IE 11 | æ·»åŠ  polyfillï¼š   npm install blob-polyfill |
| Safari | æ·»åŠ  MIME ç±»å‹å£°æ˜ï¼š   application/vnd.openxmlformats-officedocument.wordprocessingml.document |

---

##### å…«ã€æ–¹æ¡ˆæ€»ç»“

**ä¼˜åŠ¿äº®ç‚¹**
ï¼š
  
ğŸš€ 300ms å†…å®Œæˆæ–‡æ¡£ç”Ÿæˆ
  
ğŸ–¨ï¸ å®Œç¾å…¼å®¹ WPS/Office ç­‰åŠå…¬è½¯ä»¶
  
ğŸ“¦ é›¶æœåŠ¡ç«¯ä¾èµ–
  
ğŸ”’ å†…å®¹ä¸ç»è¿‡ç½‘ç»œä¼ è¾“

**æ‰©å±•æ–¹å‘**
ï¼š

* ä¸åç«¯åä½œå®ç°æ¨¡æ¿åŒ–å¯¼å‡º
* é›†æˆç”µå­ç­¾ååŠŸèƒ½
* æ·»åŠ æ–‡æ¡£åŠ å¯†ä¿æŠ¤

**æºç å‚è€ƒ**
ï¼š

* [html-docx-js](https://github.com/evidenceprime/html-docx-js)
* [FileSaver.js](https://github.com/eligrey/FileSaver.js)

*æç¤ºï¼šç”Ÿäº§ç¯å¢ƒå»ºè®®æ·»åŠ æ–‡ä»¶å¤§å°ç›‘æ§ï¼Œé˜²æ­¢ç”Ÿæˆè¶…å¤§æ–‡æ¡£å¯¼è‡´æµè§ˆå™¨å´©æºƒ*