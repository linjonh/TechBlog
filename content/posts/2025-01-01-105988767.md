---
layout: post
title: "一张图理解对分增长函数打散突破点VC维"
date: 2025-01-01 21:35:36 +0800
description: "对分（Dichotomy）、增长函数（Growth Function）、突破点（Break Poin"
keywords: "增长函数"
categories: ['机器学习初阶']
tags: ['无标签']
artid: "105988767"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=105988767
    alt: "一张图理解对分增长函数打散突破点VC维"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=105988767
featuredImagePreview: https://bing.ee123.net/img/rand?artid=105988767
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     一张图理解对分、增长函数、打散、突破点、VC维
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     对分（Dichotomy）、增长函数（Growth Function）、突破点（Break Point）、VC维（Vapink-Chervonenkis Dimension）是计算学习理论中非常重要的概念，也是机器学习的基石。可以说如果不理解计算学习理论，那就不能从根本上理解机器学习。
    </p>
    <p>
     机器学习最基本的问题是二分类和回归，在这里我们讨论的是二分类的问题。我们知道有很多二分类的模型，我们把这些模型称为分类器，常见的分类器有下面几种：
    </p>
    <ul>
     <li>
      正射线
     </li>
     <li>
      正间隔
     </li>
     <li>
      一维感知机
     </li>
     <li>
      二维感知机
     </li>
    </ul>
    <p>
     详情可以参考《快乐机器学习》这本书，或者林轩田老师的
     <a href="https://redstonewill.com/category/ai-notes/lin-ml-foundations/" rel="nofollow">
      机器学习基石
     </a>
     课程。
    </p>
    <p>
     如果一种操作能把正负样点线性分开，我们就把这种操作称为对分。一种对分其实就是线性二分类的一种分类方式。一种模型可以有若干种对分方式。我们把模型能产生对分的种类的数量定义为这种分类器的增长函数。增长函数和样本点的数量有关系，显然，样本点越多，对分的方式越多，增长函数就越大。直观上，我们感觉有
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        n 
        
       
      
        n
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.43056em; vertical-align: 0em;">
         </span>
         <span class="mord mathdefault">
          n
         </span>
        </span>
       </span>
      </span>
     </span>
     个点，就有
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        2 
         
        
          n 
         
        
       
      
        2^n
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.664392em; vertical-align: 0em;">
         </span>
         <span class="mord">
          <span class="mord">
           2
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.664392em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathdefault mtight">
                 n
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     中对分方式，因为对于二分类，每个点有2中可能的取值，总共有
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        2 
         
        
          n 
         
        
       
      
        2^n
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.664392em; vertical-align: 0em;">
         </span>
         <span class="mord">
          <span class="mord">
           2
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.664392em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathdefault mtight">
                 n
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     中组合总数。但是实际上，很多组合是线性不可分的，因此真实情况下，在n比较小的时候，能满足增长函数等于
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        2 
         
        
          n 
         
        
       
      
        2^n
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.664392em; vertical-align: 0em;">
         </span>
         <span class="mord">
          <span class="mord">
           2
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.664392em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathdefault mtight">
                 n
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ；随着n增大，增长函数将小于
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        2 
         
        
          n 
         
        
       
      
        2^n
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.664392em; vertical-align: 0em;">
         </span>
         <span class="mord">
          <span class="mord">
           2
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.664392em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathdefault mtight">
                 n
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     。
    </p>
    <p>
     常见的二分类问题增长函数如下表所示：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/277cad800e01bddb2372ad863a625f41.png">
      <br/>
      以一维感知机为例我们可以用下图表示增长函数
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         d 
         
        
          h 
         
        
       
         ( 
        
       
         n 
        
       
         ) 
        
       
      
        d_h(n)
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord">
           <span class="mord mathdefault">
            d
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.336108em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mathdefault mtight">
                  h
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord mathdefault">
           n
          </span>
          <span class="mclose">
           )
          </span>
         </span>
        </span>
       </span>
      </span>
      和指数函数
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         f 
        
       
         ( 
        
       
         n 
        
       
         ) 
        
       
      
        f(n)
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord mathdefault" style="margin-right: 0.10764em;">
           f
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord mathdefault">
           n
          </span>
          <span class="mclose">
           )
          </span>
         </span>
        </span>
       </span>
      </span>
      之间的关系。
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/553fde7d7addeb3762da04e20fafba9b.png">
       <br/>
       我们可以看到，在
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          n 
        
       
         &lt; 
        
       
         = 
        
       
         2 
        
       
      
        n&lt;=2
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;">
           </span>
           <span class="mord mathdefault">
            n
           </span>
           <span class="mspace" style="margin-right: 0.277778em;">
           </span>
           <span class="mrel">
            &lt;
           </span>
          </span>
          <span class="base">
           <span class="strut" style="height: 0.36687em; vertical-align: 0em;">
           </span>
           <span class="mrel">
            =
           </span>
           <span class="mspace" style="margin-right: 0.277778em;">
           </span>
          </span>
          <span class="base">
           <span class="strut" style="height: 0.64444em; vertical-align: 0em;">
           </span>
           <span class="mord">
            2
           </span>
          </span>
         </span>
        </span>
       </span>
       时，增长函数和指数函数是重合的，我们把这样的情况称为，在这样的n下，数据集可以被这个分类器打散（Shatter）。当n&gt;2时，增长函数就小于指数函数了，这个时候就是不能打散的情况了，第一个出现不能打散情况时n的取值3，称为突破点（BreakPoint），我们通常记为
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          k 
        
       
      
        k
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 0.69444em; vertical-align: 0em;">
           </span>
           <span class="mord mathdefault" style="margin-right: 0.03148em;">
            k
           </span>
          </span>
         </span>
        </span>
       </span>
       。k-1又被称为VC维（Vapink-Chervonenkis Dimension）
      </img>
     </img>
    </p>
    <p>
     这样，我们就把这几个计算学习理论中的概念用可视化的方式展示了出来。
    </p>
    <p>
     该图的代码如下：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> matplotlib<span class="token punctuation">.</span>legend_handler <span class="token keyword">import</span> HandlerLine2D
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
n <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span>
g <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span>n
f <span class="token operator">=</span> np<span class="token punctuation">.</span>power<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span>

line1<span class="token punctuation">,</span> <span class="token operator">=</span> plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>n<span class="token punctuation">,</span>g<span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'o'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Line 1'</span><span class="token punctuation">)</span>
line2<span class="token punctuation">,</span> <span class="token operator">=</span> plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>n<span class="token punctuation">,</span>f<span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'o'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Line 2'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">[</span>line1<span class="token punctuation">,</span>line2<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'Growth Function'</span><span class="token punctuation">,</span>r<span class="token string">'$2^n$'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>loc<span class="token operator">=</span><span class="token string">'upper left'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'g--'</span><span class="token punctuation">,</span>lw<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>annotate<span class="token punctuation">(</span><span class="token string">'BreakPoint=3'</span><span class="token punctuation">,</span>xy<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>xytext<span class="token operator">=</span><span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token operator">+</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>textcoords<span class="token operator">=</span><span class="token string">'offset points'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span>
             arrowprops<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>arrowstyle<span class="token operator">=</span><span class="token string">'-&gt;'</span><span class="token punctuation">,</span>connectionstyle<span class="token operator">=</span><span class="token string">'arc3,rad=.2'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span>r<span class="token string">'$Growth Func\ v.s. 2^n$'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'g--'</span><span class="token punctuation">,</span>lw<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>annotate<span class="token punctuation">(</span>r<span class="token string">'Shatter'</span><span class="token punctuation">,</span>xy<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>xytext<span class="token operator">=</span><span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>textcoords<span class="token operator">=</span><span class="token string">'offset points'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>annotate<span class="token punctuation">(</span>r<span class="token string">'Cannot Shatter'</span><span class="token punctuation">,</span>xy<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>xytext<span class="token operator">=</span><span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>textcoords<span class="token operator">=</span><span class="token string">'offset points'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     20200523看林老师视频后的理解更新：
     <br/>
     成长函数：关于数据大小n的函数，这个数表示某种操作能产生全部二分的种数。这个数目其实可以看成是在这种操作下能产生假设的数量。
     <br/>
     成长函数的接口定义可以写成是 int growth_func(operation_fun H, int data_len)
     <br/>
     简单记忆：成长函数就是二分种数
     <br/>
     什么叫做成长，就是假设的数量会随着数据大小增长，假设的数量越多，表达能力就越强。
    </p>
    <p>
     突破点：对于某种操作，当数据集达到k时，这种操作无法打散该数据集，那么k就是这种操作的突破点。
     <br/>
     突破点的接口定义可以写成 int break_point(operation_fun H)
     <br/>
     我们就可以用突破点来量化这种操作
    </p>
    <p>
     打散：对于某种操作，如果能产生对某数据集的全部对分，则成为这种操作能够打散该数据集。
     <br/>
     shatter的使用语法：一种操作shatter了一个数据集
    </p>
    <p>
     打散的接口定义可写成 bool is_shatter(operation_fun H,dataset)
     <br/>
     我们的目标是把成长函数从关于数据集大小的函数编程关于突破点的函数，也就是把成长函数的定义变为：
     <br/>
     int growth_func(int break_point, int data_len)
     <br/>
     即 mH(N) -&gt; mK(N)&lt;=poly(N)
     <br/>
     第3页slide讲的是，突破点为k的某种操作，当数据集大小为n的时候，可能的二分种类有多少个，也即集成长函数是多少。为了证明如果尺寸大于k的数据集，都不能被该操作shatter。并且找到成长函数和k之间的关系。因为成长函数受到了k的约束。这个约束会产生一个上界，这个上界就是Bounding Func，边界函数。
    </p>
    <p>
     这页ppt本质上讲的是突破点为k的操作的成长函数的变化趋势
    </p>
    <p>
     如果n&lt;k的，数据集是可以被shatter的，如果n&gt;k，那么数据集不能被shatter。对于三个数据点，不能shatter其中任意的两个点。
    </p>
    <p>
     成长函数本质上是某个操作（假设）对于大小为N的数据集的有效假设的数量函数
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        M 
         
        
          H 
         
        
       
         ( 
        
       
         n 
        
       
         ) 
        
       
      
        M_H(n)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          <span class="mord mathdefault" style="margin-right: 0.10903em;">
           M
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.328331em;">
              <span class="" style="top: -2.55em; margin-left: -0.10903em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathdefault mtight" style="margin-right: 0.08125em;">
                 H
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathdefault">
          n
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     ，我们可以通过推导（林老师课程的第六章）代换为他的上限函数B(n,k)，其中k是对应操作的的突破点。也就是不能被打散的最小值。VC维度就是通过breakpoint引出来的，VC维度=k-1，也就是能够这种假设能够shatter的最多点。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34313835353031302f:61727469636c652f64657461696c732f313035393838373637" class_="artid" style="display:none">
 </p>
</div>


