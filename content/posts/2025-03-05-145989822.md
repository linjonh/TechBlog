---
layout: post
title: "CCpython调用OpenCV进行图像处理耗时对比"
date: 2025-03-05 17:28:45 +0800
description: "本文主要介绍了C++、C#、python三种不同语言调用OpenCV进行图像处理操作时的耗时情况，进行了实际对比，并简单总结了对比结果，最后还给出了OpenCV的imread函数以不同模式读取图片的细微差别之处，还给出了imread读取彩色图转换为灰度图的原理公式。"
keywords: "c# 高速比较bmp 图像"
categories: ['机器视觉', 'Opencv']
tags: ['机器视觉', '图像处理', 'Python', 'Opencvsharp', 'Opencv', 'C', 'C']
artid: "145989822"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=145989822
    alt: "CCpython调用OpenCV进行图像处理耗时对比"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=145989822
featuredImagePreview: https://bing.ee123.net/img/rand?artid=145989822
cover: https://bing.ee123.net/img/rand?artid=145989822
image: https://bing.ee123.net/img/rand?artid=145989822
img: https://bing.ee123.net/img/rand?artid=145989822
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     C++、C#、python调用OpenCV进行图像处理耗时对比
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <h2>
     <a id="_1">
     </a>
     一、前言
    </h2>
    <p>
     图像处理算法库中OpenCV是比较常用的算法库，可使用不同语言进行调用编写算法，常用的语言有
     <mark>
      C++、C#、python
     </mark>
     ，本文主要对比了不同语言调用OpenCV进行
     <mark>
      图像读取、图像保存、图像灰度化、图像腐蚀与膨胀、OTSU分割
     </mark>
     几种常用的图像处理操作，耗费的时间长短，为在图像处理算法的
     <mark>
      编程语言选择上提供一些参考
     </mark>
     。
    </p>
    <h2>
     <a id="_3">
     </a>
     二、环境介绍
    </h2>
    <table>
     <thead>
      <tr>
       <th>
        编程语言/OpenCV
       </th>
       <th>
        版本
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        python
       </td>
       <td>
        3.7.10
       </td>
      </tr>
      <tr>
       <td>
        opencv-python-headless
       </td>
       <td>
        4.10.0.84
       </td>
      </tr>
      <tr>
       <td>
        C#
       </td>
       <td>
        .NET Framework4.7.2——C# 7.3
       </td>
      </tr>
      <tr>
       <td>
        opencvsharp
       </td>
       <td>
        4.10.0.20241108
       </td>
      </tr>
      <tr>
       <td>
        C++
       </td>
       <td>
        VS2019——C++14
       </td>
      </tr>
      <tr>
       <td>
        opencv
       </td>
       <td>
        4.10.0
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     其中opencv-python-headless为python调用的包，
     <mark>
      opencv-python-headless是opencv-python的轻量版本
     </mark>
     ，仅包含用于图像处理的核心模块。
    </p>
    <p>
     opencvsharp是C#调用的软件库，是第三方开发的适配C#的OpenCV。
    </p>
    <p>
     C++调用的opencv是从官网下载的官方版本。
    </p>
    <p>
     三种编程语言调用的opencv
     <mark>
      统一为4.10.0版本，发布日期为2024-06-03
     </mark>
     。
    </p>
    <h2>
     <a id="_20">
     </a>
     三、耗时对比
    </h2>
    <p>
     图像处理操作对象图片为
     <mark>
      500万像素图片
     </mark>
     。
    </p>
    <h3>
     <a id="31jpgbmp_22">
     </a>
     3.1读写jpg、bmp图片耗时对比
    </h3>
    <table>
     <thead>
      <tr>
       <th>
        -
       </th>
       <th>
        python
       </th>
       <th>
        C#
       </th>
       <th>
        C++
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        imread-彩色图jpg
       </td>
       <td>
        0.026s
       </td>
       <td>
        0.067s
       </td>
       <td>
        0.026s
       </td>
      </tr>
      <tr>
       <td>
        imread-灰度图jpg
       </td>
       <td>
        0.008s
       </td>
       <td>
        0.045s
       </td>
       <td>
        0.009s
       </td>
      </tr>
      <tr>
       <td>
        imread-彩色图bmp
       </td>
       <td>
        0.011s
       </td>
       <td>
        0.043s
       </td>
       <td>
        0.011s
       </td>
      </tr>
      <tr>
       <td>
        imread-灰度图bmp
       </td>
       <td>
        0.005s
       </td>
       <td>
        0.038s
       </td>
       <td>
        0.006s
       </td>
      </tr>
      <tr>
       <td>
        imwrite-彩色图jpg
       </td>
       <td>
        0.045s
       </td>
       <td>
        0.050s
       </td>
       <td>
        0.036s
       </td>
      </tr>
      <tr>
       <td>
        imwrite-灰度图jpg
       </td>
       <td>
        0.026s
       </td>
       <td>
        0.027s
       </td>
       <td>
        0.023s
       </td>
      </tr>
      <tr>
       <td>
        imwrite-彩色图bmp
       </td>
       <td>
        0.007s
       </td>
       <td>
        0.007s
       </td>
       <td>
        0.007s
       </td>
      </tr>
      <tr>
       <td>
        imwrite-灰度图bmp
       </td>
       <td>
        0.003s
       </td>
       <td>
        0.003s
       </td>
       <td>
        0.003s
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     对表中数据进行分析：
    </p>
    <ol>
     <li>
      <mark>
       python与C++读写
      </mark>
      图片的耗时
      <mark>
       基本一致
      </mark>
      ，而
      <mark>
       C#读取
      </mark>
      图片的耗时约为
      <mark>
       二者的3倍以上
      </mark>
      ，
      <mark>
       写入
      </mark>
      图片的速度
      <mark>
       基本一致
      </mark>
      ；
     </li>
     <li>
      读写
      <mark>
       灰度图像
      </mark>
      的耗时约为读写
      <mark>
       彩色图像的一半
      </mark>
      ；
     </li>
     <li>
      <mark>
       jpg
      </mark>
      图片
      <mark>
       写入
      </mark>
      耗时约为
      <mark>
       bmp图像的6倍
      </mark>
      ，
      <mark>
       读取
      </mark>
      耗时约为
      <mark>
       bmp图像的1倍
      </mark>
      。
     </li>
    </ol>
    <h3>
     <a id="32_38">
     </a>
     3.2灰度化、阈值分割、膨胀腐蚀耗时对比
    </h3>
    <table>
     <thead>
      <tr>
       <th>
        -
       </th>
       <th>
        python
       </th>
       <th>
        C#
       </th>
       <th>
        C++
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        cvtColor-转灰度
       </td>
       <td>
        0.004s
       </td>
       <td>
        0.005s
       </td>
       <td>
        0.010s
       </td>
      </tr>
      <tr>
       <td>
        threshold-Otsu
       </td>
       <td>
        0.004s
       </td>
       <td>
        0.004s
       </td>
       <td>
        0.004s
       </td>
      </tr>
      <tr>
       <td>
        dilate + erode
       </td>
       <td>
        0.069s
       </td>
       <td>
        0.095s
       </td>
       <td>
        0.065s
       </td>
      </tr>
      <tr>
       <td>
        morphologyEx-闭运算
       </td>
       <td>
        0.069s
       </td>
       <td>
        0.095s
       </td>
       <td>
        0.065s
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     从表中数据可分析得出：
    </p>
    <ol>
     <li>
      python、C#、C++ 在灰度化、阈值分割、膨胀腐蚀三种算法上
      <mark>
       三种语言耗时基本一致，C#膨胀腐蚀的耗时高出二者50%
      </mark>
      ；
     </li>
     <li>
      <mark>
       先膨胀再腐蚀与直接进行闭运算耗时一致
      </mark>
      ，与理论相符。
     </li>
    </ol>
    <h2>
     <a id="_50">
     </a>
     附录
    </h2>
    <h3>
     <a id="1imread_51">
     </a>
     （1）imread函数以不同模式读取图片
    </h3>
    <p>
     OpenCV读取图片使用的imread函数，可通过指定
     <mark>
      第二个参数以不同模式读取图片
     </mark>
     ：
    </p>
    <table>
     <thead>
      <tr>
       <th>
        参数值
       </th>
       <th>
        含义
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        1或IMREAD_COLOR（
        <mark>
         默认参数
        </mark>
        ）
       </td>
       <td>
        将图像调整为3通道BGR图像，即使图片是灰度图
       </td>
      </tr>
      <tr>
       <td>
        0或IMREAD_GRAYSCALE
       </td>
       <td>
        将图像调整为灰度图像
       </td>
      </tr>
      <tr>
       <td>
        -1或IMREAD_UNCHANGED
       </td>
       <td>
        保持原格式不变，深度、通道数都不变
       </td>
      </tr>
      <tr>
       <td>
        2或IMREAD_ANYDEPTH
       </td>
       <td>
        保持原始位深度，例如16位或32位，不强制转换为8位，
        <mark>
         但可能会转换通道数
        </mark>
       </td>
      </tr>
      <tr>
       <td>
        4或IMREAD_ANYCOLOR
       </td>
       <td>
        保持原始通道数不变，但
        <mark>
         可能会压缩图片深度为8位
        </mark>
       </td>
      </tr>
     </tbody>
    </table>
    <h3>
     <a id="2OpenCVPIL_61">
     </a>
     （2）OpenCV读取图片格式与PIL读取图片格式区别
    </h3>
    <p>
     OpenCV的imread函数读取图片后的通道顺序为
     <mark>
      BGR
     </mark>
     ，PIL库的Image类读取图片后的通道顺序为
     <mark>
      RGB
     </mark>
     ，二者读取图片的坐标原点为左上角，x轴为高度方向，y轴为宽度方向，如下图所示：
     <br/>
     <img alt="在这里插入图片描述" height="450" src="https://i-blog.csdnimg.cn/direct/2ea29a65cbbb4e8caa792976aa821993.png#pic_center" width="600">
      <br/>
      OpenCV的imread函数以IMREAD_GRAYSCALE读取彩色图片时，会将图像强制转换为灰度图，这种转换过程遵循特定的加权平均法，公式如下：
      <br/>
      Gray=0.114×B+0.587×G+0.299×R
      <br/>
      计算结果会
      <mark>
       四舍五入保留为整数
      </mark>
      。
     </img>
    </p>
    <p>
     这种加权公式的依据为：
    </p>
    <ol>
     <li>
      绿色权重最大，因为
      <mark>
       人眼对绿色最敏感
      </mark>
      。
     </li>
     <li>
      蓝色权重最小，因为人眼对蓝色不太敏感。
     </li>
    </ol>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34363834363638352f:61727469636c652f64657461696c732f313435393839383232" class_="artid" style="display:none">
 </p>
</div>


