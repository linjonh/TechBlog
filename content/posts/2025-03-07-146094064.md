---
layout: post
title: "77.ObservableCollection使用介绍1-C例子-WPF例子"
date: 2025-03-07 13:51:23 +0800
description: "可观察集合ObservableCollection在现代的软件开发中，尤其是在构建动态用户界面（如 WPF、UWP 或 Xamarin）时，数据绑定是一个核心概念。它允许开发者将数据源与界面元素绑定，从而实现数据的自动更新和同步。在 .NET 中， 是一个专门为这种场景设计的集合类，它提供了动态通知功能，使得集合的变化能够实时反映到绑定的用户界面上。 是一个位于  命名空间下的动态数据集合。它继承自 ，并实现了  和  接口。这意味着当集合中的数据发生变化（如添加、删除或修改元素）时，它会自动通知绑定"
keywords: "77.ObservableCollection使用介绍1 C#例子 WPF例子"
categories: ['未分类']
tags: ['Wpf', 'Windows', 'C']
artid: "146094064"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146094064
    alt: "77.ObservableCollection使用介绍1-C例子-WPF例子"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146094064
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146094064
cover: https://bing.ee123.net/img/rand?artid=146094064
image: https://bing.ee123.net/img/rand?artid=146094064
img: https://bing.ee123.net/img/rand?artid=146094064
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     77.ObservableCollection使用介绍1 C#例子 WPF例子
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     <strong>
      可观察集合ObservableCollection
     </strong>
    </p>
    <pre><code class="language-cs">using System;
using System.Collections.ObjectModel;

class Program
{
    static void Main()
    {
        // 创建一个可观察集合
        ObservableCollection&lt;string&gt; list = new ObservableCollection&lt;string&gt;();

        // 注册集合变化事件
        list.CollectionChanged += (sender, e) =&gt;
        {
            Console.WriteLine($"Action: {e.Action}");

            // 处理新增项
            if (e.NewItems != null)
            {
                foreach (var item in e.NewItems)
                {
                    Console.WriteLine($"Added: {item}");
                }
            }

            // 处理删除项
            if (e.OldItems != null)
            {
                foreach (var item in e.OldItems)
                {
                    Console.WriteLine($"Removed: {item}");
                }
            }
        };

        // 添加元素
        list.Add("Hello");
        list.Add("World");

        list.Remove("Hell"); // 删除不存在的元素，不会触发事件
        //list.Remove("Hello"); // 删除存在的元素，会触发事件

        // 删除元素
        // 注意：删除时索引会随着元素的移除而改变
        // 先删除 "World"（索引 1），再删除 "Hello"（索引 0）
        list.RemoveAt(1); // 删除索引为 1 的元素（"World"）
        list.RemoveAt(0); // 删除索引为 0 的元素（"Hello"）

        // 其他删除方式（可选）
        // 先删除 "Hello"，再删除 "World"
        // list.RemoveAt(0);
        // list.RemoveAt(0);



        // 清空集合
        // 注意：Clear 方法会触发 CollectionChanged 事件，但不会触发 NewItems 和 OldItems 的变化
        list.Clear();
    }
}</code></pre>
    <p>
     在现代的软件开发中，尤其是在构建动态用户界面（如 WPF、UWP 或 Xamarin）时，数据绑定是一个核心概念。它允许开发者将数据源与界面元素绑定，从而实现数据的自动更新和同步。在 .NET 中，
     <code>
      ObservableCollection&lt;T&gt;
     </code>
     是一个专门为这种场景设计的集合类，它提供了动态通知功能，使得集合的变化能够实时反映到绑定的用户界面上。
    </p>
    <h3>
     什么是
     <code>
      ObservableCollection
     </code>
     ？
    </h3>
    <p>
     <code>
      ObservableCollection&lt;T&gt;
     </code>
     是一个位于
     <code>
      System.Collections.ObjectModel
     </code>
     命名空间下的动态数据集合。它继承自
     <code>
      Collection&lt;T&gt;
     </code>
     ，并实现了
     <code>
      INotifyCollectionChanged
     </code>
     和
     <code>
      INotifyPropertyChanged
     </code>
     接口。这意味着当集合中的数据发生变化（如添加、删除或修改元素）时，它会自动通知绑定的界面元素，从而触发界面的更新。
    </p>
    <p>
     这种特性使得
     <code>
      ObservableCollection
     </code>
     成为实现数据绑定的理想选择，尤其是在需要实时更新用户界面的场景中。
    </p>
    <h3>
     核心功能与特性
    </h3>
    <h4>
     1. 动态通知
    </h4>
    <p>
     <code>
      ObservableCollection
     </code>
     的核心功能之一是它能够动态通知外部（如绑定的 UI 元素）集合的变化。这种通知通过
     <code>
      CollectionChanged
     </code>
     事件实现，每当集合中的数据发生变化时，该事件会被触发。事件参数
     <code>
      NotifyCollectionChangedEventArgs
     </code>
     提供了关于变化的详细信息，例如：
    </p>
    <ul>
     <li>
      <p>
       <strong>
        <code>
         Action
        </code>
       </strong>
       ：表示操作类型（如添加、删除、替换等）。
      </p>
     </li>
     <li>
      <p>
       <strong>
        <code>
         NewItems
        </code>
       </strong>
       ：表示新增的项。
      </p>
     </li>
     <li>
      <p>
       <strong>
        <code>
         OldItems
        </code>
       </strong>
       ：表示被删除的项。
      </p>
     </li>
    </ul>
    <h4>
     2. 支持数据绑定
    </h4>
    <p>
     <code>
      ObservableCollection
     </code>
     是专为数据绑定设计的集合类型。在 WPF 和 UWP 中，它可以与各种控件（如
     <code>
      ListBox
     </code>
     、
     <code>
      ComboBox
     </code>
     、
     <code>
      DataGrid
     </code>
     等）无缝配合，使得开发者能够轻松实现动态数据的展示和更新。
    </p>
    <h4>
     3. 线程安全问题
    </h4>
    <p>
     需要注意的是，
     <code>
      ObservableCollection
     </code>
     默认情况下不是线程安全的。如果需要在多线程环境中使用，需要额外的同步处理。
    </p>
    <h4>
     输出结果
    </h4>
    <p>
     运行上述代码后，控制台输出如下：
    </p>
    <pre><code>Action: Add
Added: Hello
Action: Add
Added: World
Action: Remove
Removed: World
Action: Remove
Removed: Hello
Action: Reset</code></pre>
    <h4>
     代码解析
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        创建集合
       </strong>
       <br/>
       创建了一个
       <code>
        ObservableCollection&lt;string&gt;
       </code>
       实例，用于存储字符串数据。
      </p>
     </li>
     <li>
      <p>
       <strong>
        注册事件监听
       </strong>
       <br/>
       通过
       <code>
        CollectionChanged
       </code>
       事件监听集合的变化。事件处理器会根据操作类型（
       <code>
        Action
       </code>
       ）和变化的项（
       <code>
        NewItems
       </code>
       和
       <code>
        OldItems
       </code>
       ）输出相关信息。
      </p>
     </li>
     <li>
      <p>
       <strong>
        添加和删除元素
       </strong>
      </p>
      <ul>
       <li>
        <p>
         使用
         <code>
          Add
         </code>
         方法添加元素。
        </p>
       </li>
       <li>
        <p>
         使用
         <code>
          Remove
         </code>
         方法尝试删除一个不存在的元素（不会触发事件）。
        </p>
       </li>
       <li>
        <p>
         使用
         <code>
          RemoveAt
         </code>
         方法按索引删除元素。
        </p>
       </li>
       <li>
        <p>
         使用
         <code>
          Clear
         </code>
         方法清空整个集合（会触发
         <code>
          Reset
         </code>
         事件）。
        </p>
       </li>
      </ul>
     </li>
    </ol>
    <p>
    </p>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c:6f672e6373646e2e6e65742f5331333436313132303731332f:61727469636c652f64657461696c732f313436303934303634" class_="artid" style="display:none">
 </p>
</div>


