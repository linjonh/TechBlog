---
layout: post
title: "利用python生成excel中模板范围对应的shape文件"
date: 2025-03-11 20:34:07 +0800
description: "利用python生成excel中模板范围对应的shape文件。"
keywords: "利用python生成excel中模板范围对应的shape文件"
categories: ['未分类']
tags: ['Python', 'Numpy', 'Excel']
artid: "146188484"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146188484
    alt: "利用python生成excel中模板范围对应的shape文件"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146188484
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146188484
cover: https://bing.ee123.net/img/rand?artid=146188484
image: https://bing.ee123.net/img/rand?artid=146188484
img: https://bing.ee123.net/img/rand?artid=146188484
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     利用python生成excel中模板范围对应的shape文件
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     利用python生成excel中模板范围对应的shape文件
    </p>
    <pre><code class="prism language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token keyword">import</span> os<span class="token punctuation">.</span>path

<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> shapely<span class="token punctuation">.</span>geometry <span class="token keyword">import</span> Polygon
<span class="token keyword">from</span> shapely<span class="token punctuation">.</span>wkt <span class="token keyword">import</span> dumps
<span class="token keyword">import</span> argparse

<span class="token comment"># 创建解析器</span>
parser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span>description<span class="token operator">=</span><span class="token string">"这是一个示例程序"</span><span class="token punctuation">)</span>
<span class="token comment"># 添加位置参数（必须提供）</span>
parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"-i"</span><span class="token punctuation">,</span><span class="token string">"--input"</span><span class="token punctuation">,</span>default<span class="token operator">=</span><span class="token string">"qqdlsjkV0312_final.xlsx"</span><span class="token punctuation">,</span>  <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">"输入文件路径"</span><span class="token punctuation">)</span>
<span class="token comment"># 读取Excel文件的默认工作表</span>
<span class="token comment"># 解析参数</span>
args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 使用参数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"输入文件路径: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>args<span class="token punctuation">.</span><span class="token builtin">input</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span class="token comment"># df = pd.read_excel('demo.xlsx')</span>

<span class="token keyword">def</span> <span class="token function">getWkt</span><span class="token punctuation">(</span>minx<span class="token punctuation">,</span>miny<span class="token punctuation">,</span>maxx<span class="token punctuation">,</span>maxy<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 创建一个几何多边形对象</span>
    polygon <span class="token operator">=</span> Polygon<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span>minx<span class="token punctuation">,</span> miny<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>minx<span class="token punctuation">,</span> maxy<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>maxx<span class="token punctuation">,</span> maxy<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>maxx<span class="token punctuation">,</span> miny<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token comment"># 调用dumps方法，将几何对象转换为WKT字符串</span>
    wkt_string <span class="token operator">=</span> dumps<span class="token punctuation">(</span>polygon<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>wkt_string<span class="token punctuation">)</span>
    <span class="token keyword">return</span> wkt_string

<span class="token keyword">def</span> <span class="token function">getlistFromStr</span><span class="token punctuation">(</span>strs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    str_l <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>strs<span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"'"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"["</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"]"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span>
    str_ll <span class="token operator">=</span> str_l<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token builtin">float</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">for</span> s <span class="token keyword">in</span> str_ll<span class="token punctuation">]</span>
    ccc<span class="token operator">=</span><span class="token number">0</span>

<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">def</span> <span class="token function">getUpdateExtent</span><span class="token punctuation">(</span>externs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    exten_np <span class="token operator">=</span> np<span class="token punctuation">.</span>stack<span class="token punctuation">(</span>externs<span class="token punctuation">)</span>
    minx <span class="token operator">=</span>np<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span>exten_np<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span>exten_np<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    miny <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span>exten_np<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span>exten_np<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    maxx <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>exten_np<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>exten_np<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    maxy <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>exten_np<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>exten_np<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>minx<span class="token punctuation">,</span>miny<span class="token punctuation">,</span>maxx<span class="token punctuation">,</span>maxy<span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">dealNanhai</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    file_path <span class="token operator">=</span> path
    df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">'Sheet1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values
    row_nums<span class="token punctuation">,</span> col_nums <span class="token operator">=</span> df<span class="token punctuation">.</span>shape
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"nanhai_deal.csv"</span><span class="token punctuation">,</span><span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"id;airport;extent;center;wkt\n"</span><span class="token punctuation">)</span>
        idx<span class="token operator">=</span><span class="token number">1</span>
        <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>row_nums<span class="token punctuation">)</span><span class="token punctuation">:</span>
            key <span class="token operator">=</span> df<span class="token punctuation">[</span>row<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
            extent <span class="token operator">=</span> df<span class="token punctuation">[</span>row<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
            jw_s <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>extent<span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>
            zb_s <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> jw <span class="token keyword">in</span> jw_s<span class="token punctuation">:</span>
                zbs<span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>jw<span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">)</span>
                <span class="token keyword">for</span> zb <span class="token keyword">in</span> zbs<span class="token punctuation">:</span>
                    zb_s<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>zb<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    ccc<span class="token operator">=</span><span class="token number">0</span>
            extent <span class="token operator">=</span> <span class="token punctuation">[</span>zb_s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>zb_s<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>zb_s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>zb_s<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
            ccc<span class="token operator">=</span><span class="token number">0</span>
            wktstr <span class="token operator">=</span> getWkt<span class="token punctuation">(</span><span class="token operator">*</span>extent<span class="token punctuation">)</span>
            center <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>extent<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>extent<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">(</span>extent<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>extent<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">]</span>
            <span class="token comment"># 输出到文件</span>
            extentStr <span class="token operator">=</span> <span class="token string">","</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span>  extent<span class="token punctuation">]</span><span class="token punctuation">)</span>
            centerStr <span class="token operator">=</span> <span class="token string">","</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> center<span class="token punctuation">]</span><span class="token punctuation">)</span>
            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>idx<span class="token punctuation">}</span></span><span class="token string">;</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>key<span class="token punctuation">}</span></span><span class="token string">;</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>extentStr<span class="token punctuation">}</span></span><span class="token string">;</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>centerStr<span class="token punctuation">}</span></span><span class="token string">;</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>wktstr<span class="token punctuation">}</span></span><span class="token string">\n"</span></span><span class="token punctuation">)</span>
            idx <span class="token operator">+=</span><span class="token number">1</span>

<span class="token keyword">def</span> <span class="token function">dealDuplicate</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    file_path <span class="token operator">=</span> path
    <span class="token comment">#处理 shiju</span>
    df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">'shiju'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values
    row_nums<span class="token punctuation">,</span> col_nums <span class="token operator">=</span> df<span class="token punctuation">.</span>shape
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"shijuAFB_deal.csv"</span><span class="token punctuation">,</span><span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"id;airport;extent;center;wkt\n"</span><span class="token punctuation">)</span>
        idx<span class="token operator">=</span><span class="token number">1</span>
        <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>row_nums<span class="token punctuation">)</span><span class="token punctuation">:</span>
            key <span class="token operator">=</span> df<span class="token punctuation">[</span>row<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
            extent <span class="token operator">=</span> df<span class="token punctuation">[</span>row<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
            extent <span class="token operator">=</span> extent<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"["</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"]"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\""</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\""</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\'"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
            jw_s <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>extent<span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>
            zb_s <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> jw <span class="token keyword">in</span> jw_s<span class="token punctuation">:</span>
                zb_s<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>jw<span class="token punctuation">)</span><span class="token punctuation">)</span>
                ccc<span class="token operator">=</span><span class="token number">0</span>
            extent <span class="token operator">=</span> <span class="token punctuation">[</span>zb_s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>zb_s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>zb_s<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>zb_s<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
            ccc<span class="token operator">=</span><span class="token number">0</span>
            wktstr <span class="token operator">=</span> getWkt<span class="token punctuation">(</span><span class="token operator">*</span>extent<span class="token punctuation">)</span>
            center <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>extent<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>extent<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">(</span>extent<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>extent<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">]</span>
            <span class="token comment"># 输出到文件</span>
            extentStr <span class="token operator">=</span> <span class="token string">","</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span>  extent<span class="token punctuation">]</span><span class="token punctuation">)</span>
            centerStr <span class="token operator">=</span> <span class="token string">","</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> center<span class="token punctuation">]</span><span class="token punctuation">)</span>
            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>idx<span class="token punctuation">}</span></span><span class="token string">;</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>key<span class="token punctuation">}</span></span><span class="token string">;</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>extentStr<span class="token punctuation">}</span></span><span class="token string">;</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>centerStr<span class="token punctuation">}</span></span><span class="token string">;</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>wktstr<span class="token punctuation">}</span></span><span class="token string">\n"</span></span><span class="token punctuation">)</span>
            idx <span class="token operator">+=</span><span class="token number">1</span>
    <span class="token comment">#处理 ditu</span>
    df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">'ditu'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values
    row_nums<span class="token punctuation">,</span> col_nums <span class="token operator">=</span> df<span class="token punctuation">.</span>shape
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"dituAFB_deal.csv"</span><span class="token punctuation">,</span><span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"id;airport;extent;center;wkt\n"</span><span class="token punctuation">)</span>
        idx<span class="token operator">=</span><span class="token number">1</span>
        <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>row_nums<span class="token punctuation">)</span><span class="token punctuation">:</span>
            key <span class="token operator">=</span> df<span class="token punctuation">[</span>row<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
            extent <span class="token operator">=</span> df<span class="token punctuation">[</span>row<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
            extent <span class="token operator">=</span> extent<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\""</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\""</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"["</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"]"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\'"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
            jw_s <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>extent<span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>

            zb_s <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> jw <span class="token keyword">in</span> jw_s<span class="token punctuation">:</span>
                <span class="token comment"># zbs= str(jw).split('-')</span>
                <span class="token comment"># for zb in zbs:</span>
                zb_s<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>jw<span class="token punctuation">)</span><span class="token punctuation">)</span>
                ccc<span class="token operator">=</span><span class="token number">0</span>
            extent <span class="token operator">=</span> <span class="token punctuation">[</span>zb_s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>zb_s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>zb_s<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>zb_s<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
            ccc<span class="token operator">=</span><span class="token number">0</span>
            wktstr <span class="token operator">=</span> getWkt<span class="token punctuation">(</span><span class="token operator">*</span>extent<span class="token punctuation">)</span>
            center <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>extent<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>extent<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">(</span>extent<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>extent<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">]</span>
            <span class="token comment"># 输出到文件</span>
            extentStr <span class="token operator">=</span> <span class="token string">","</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span>  extent<span class="token punctuation">]</span><span class="token punctuation">)</span>
            centerStr <span class="token operator">=</span> <span class="token string">","</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> center<span class="token punctuation">]</span><span class="token punctuation">)</span>
            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>idx<span class="token punctuation">}</span></span><span class="token string">;</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>key<span class="token punctuation">}</span></span><span class="token string">;</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>extentStr<span class="token punctuation">}</span></span><span class="token string">;</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>centerStr<span class="token punctuation">}</span></span><span class="token string">;</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>wktstr<span class="token punctuation">}</span></span><span class="token string">\n"</span></span><span class="token punctuation">)</span>
            idx <span class="token operator">+=</span><span class="token number">1</span>

    <span class="token comment">#处理补充</span>
    <span class="token comment"># 处理 ditu</span>
    df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">'buchong'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values
    row_nums<span class="token punctuation">,</span> col_nums <span class="token operator">=</span> df<span class="token punctuation">.</span>shape
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"buchongAFB_deal.csv"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"id;airport;extent;center;wkt\n"</span><span class="token punctuation">)</span>
        idx <span class="token operator">=</span> <span class="token number">1</span>
        <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>row_nums<span class="token punctuation">)</span><span class="token punctuation">:</span>
            key <span class="token operator">=</span> df<span class="token punctuation">[</span>row<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
            extent <span class="token operator">=</span> df<span class="token punctuation">[</span>row<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
            extent <span class="token operator">=</span> extent<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"["</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"]"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\'"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
            jw_s <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>extent<span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>

            zb_s <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> jw <span class="token keyword">in</span> jw_s<span class="token punctuation">:</span>
                <span class="token comment"># zbs= str(jw).split('-')</span>
                <span class="token comment"># for zb in zbs:</span>
                zb_s<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>jw<span class="token punctuation">)</span><span class="token punctuation">)</span>
                ccc <span class="token operator">=</span> <span class="token number">0</span>
            extent <span class="token operator">=</span> <span class="token punctuation">[</span>zb_s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> zb_s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> zb_s<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> zb_s<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
            ccc <span class="token operator">=</span> <span class="token number">0</span>
            wktstr <span class="token operator">=</span> getWkt<span class="token punctuation">(</span><span class="token operator">*</span>extent<span class="token punctuation">)</span>
            center <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>extent<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> extent<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>extent<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> extent<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span>
            <span class="token comment"># 输出到文件</span>
            extentStr <span class="token operator">=</span> <span class="token string">","</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> extent<span class="token punctuation">]</span><span class="token punctuation">)</span>
            centerStr <span class="token operator">=</span> <span class="token string">","</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> center<span class="token punctuation">]</span><span class="token punctuation">)</span>
            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>idx<span class="token punctuation">}</span></span><span class="token string">;</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>key<span class="token punctuation">}</span></span><span class="token string">;</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>extentStr<span class="token punctuation">}</span></span><span class="token string">;</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>centerStr<span class="token punctuation">}</span></span><span class="token string">;</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>wktstr<span class="token punctuation">}</span></span><span class="token string">\n"</span></span><span class="token punctuation">)</span>
            idx <span class="token operator">+=</span> <span class="token number">1</span>

    <span class="token comment">#处理南海</span>
    df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">'nanhai'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values
    row_nums<span class="token punctuation">,</span> col_nums <span class="token operator">=</span> df<span class="token punctuation">.</span>shape
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"nanhaiAFB_deal.csv"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"id;airport;extent;center;wkt\n"</span><span class="token punctuation">)</span>
        idx <span class="token operator">=</span> <span class="token number">1</span>
        <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>row_nums<span class="token punctuation">)</span><span class="token punctuation">:</span>
            key <span class="token operator">=</span> df<span class="token punctuation">[</span>row<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
            extent <span class="token operator">=</span> df<span class="token punctuation">[</span>row<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
            extent <span class="token operator">=</span> extent<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"["</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"]"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\'"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
            jw_s <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>extent<span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>

            zb_s <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> jw <span class="token keyword">in</span> jw_s<span class="token punctuation">:</span>
                <span class="token comment"># zbs= str(jw).split('-')</span>
                <span class="token comment"># for zb in zbs:</span>
                zb_s<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>jw<span class="token punctuation">)</span><span class="token punctuation">)</span>
                ccc <span class="token operator">=</span> <span class="token number">0</span>
            extent <span class="token operator">=</span> <span class="token punctuation">[</span>zb_s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> zb_s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> zb_s<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> zb_s<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
            ccc <span class="token operator">=</span> <span class="token number">0</span>
            wktstr <span class="token operator">=</span> getWkt<span class="token punctuation">(</span><span class="token operator">*</span>extent<span class="token punctuation">)</span>
            center <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>extent<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> extent<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>extent<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> extent<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span>
            <span class="token comment"># 输出到文件</span>
            extentStr <span class="token operator">=</span> <span class="token string">","</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> extent<span class="token punctuation">]</span><span class="token punctuation">)</span>
            centerStr <span class="token operator">=</span> <span class="token string">","</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> center<span class="token punctuation">]</span><span class="token punctuation">)</span>
            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>idx<span class="token punctuation">}</span></span><span class="token string">;</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>key<span class="token punctuation">}</span></span><span class="token string">;</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>extentStr<span class="token punctuation">}</span></span><span class="token string">;</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>centerStr<span class="token punctuation">}</span></span><span class="token string">;</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>wktstr<span class="token punctuation">}</span></span><span class="token string">\n"</span></span><span class="token punctuation">)</span>
            idx <span class="token operator">+=</span> <span class="token number">1</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token comment"># file_path = "南海目标.xlsx"</span>
    <span class="token comment"># dealNanhai(file_path)</span>
    <span class="token comment"># print(f"success")</span>
    dealDuplicate<span class="token punctuation">(</span>args<span class="token punctuation">.</span><span class="token builtin">input</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"success"</span></span><span class="token punctuation">)</span>
    <span class="token comment"># getWkt(10,20,30,60)</span>
    <span class="token comment"># file_path = 'demo.xlsx'</span>
    <span class="token comment"># file_path = args.input</span>
    <span class="token comment"># df = pd.read_excel(file_path, sheet_name='Sheet1',usecols=['file_path','extent']).values</span>
    <span class="token comment"># row_nums,col_nums = df.shape</span>
    <span class="token comment"># port_map={}</span>
    <span class="token comment"># with open("demo_deal.csv","w") as f:</span>
    <span class="token comment">#     f.write("id;airport;extent;center;wkt\n")</span>
    <span class="token comment">#     for row in range(row_nums):</span>
    <span class="token comment">#         file_path = df[row,0]</span>
    <span class="token comment">#         extent = df[row,1]</span>
    <span class="token comment">#         extent_list = getlistFromStr(extent)</span>
    <span class="token comment">#         airport_name = file_path.split('/')[0]</span>
    <span class="token comment">#         extents = port_map.get(airport_name,list())</span>
    <span class="token comment">#         extents.append(extent_list)</span>
    <span class="token comment">#         port_map[airport_name]=extents</span>
    <span class="token comment">#         ccc=0</span>
    <span class="token comment">#     idx=1</span>
    <span class="token comment">#     for key,value in port_map.items():</span>
    <span class="token comment">#         extent = getUpdateExtent(value)</span>
    <span class="token comment">#         wktstr = getWkt(*extent)</span>
    <span class="token comment">#         center = [(extent[0]+extent[2])/2,(extent[1]+extent[3])/2]</span>
    <span class="token comment">#         # 输出到文件</span>
    <span class="token comment">#         extentStr = ",".join([str(_) for _ in  extent])</span>
    <span class="token comment">#         centerStr = ",".join([str(_) for _ in center])</span>
    <span class="token comment">#         f.write(f"{idx};{key};{extentStr};{centerStr};{wktstr}\n")</span>
    <span class="token comment">#</span>
    <span class="token comment">#</span>
    <span class="token comment">#</span>
    <span class="token comment">#</span>
    <span class="token comment">#         idx += 1</span>
    <span class="token comment"># print(f"success! output:{os.path.abspath(os.path.join(os.getcwd(),'demo_deal.csv'))}")</span>
    <span class="token comment"># ccc=0</span>
    <span class="token comment"># ccc=0</span>
<span class="token comment"># import pandas as pd</span>
<span class="token comment">#</span>
<span class="token comment"># file_path = 'data.xlsx'</span>
<span class="token comment"># df = pd.read_excel(file_path, sheet_name='Sheet2', usecols=['A', 'C'])</span>
<span class="token comment">#</span>
<span class="token comment"># print(df)</span>
<span class="token comment"># # 读取指定的工作表</span>
<span class="token comment"># df = pd.read_excel('demo.xlsx', sheet_name='Sheet1')</span>
<span class="token comment"># ccc=0</span>
<span class="token comment"># # # 读取特定的列</span>
<span class="token comment"># # df = pd.read_excel('demo.xlsx', usecols=['A', 'C', 'E'])</span>
<span class="token comment">#</span>
<span class="token comment"># # 指定数据类型</span>
<span class="token comment"># # df = pd.read_excel('demo.xlsx', dtype={'列名': str})</span>
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f646f646f646f646f646f6f6f6f2f:61727469636c652f64657461696c732f313436313838343834" class_="artid" style="display:none">
 </p>
</div>


