---
layout: post
title: "JVM参数调整"
date: 2025-03-06 23:28:20 +0800
description: "【代码】JVM参数调整。"
keywords: "JVM参数调整"
categories: ['未分类']
tags: ['算法', 'Jvm', 'Java']
artid: "146082895"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146082895
    alt: "JVM参数调整"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146082895
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146082895
cover: https://bing.ee123.net/img/rand?artid=146082895
image: https://bing.ee123.net/img/rand?artid=146082895
img: https://bing.ee123.net/img/rand?artid=146082895
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     JVM参数调整
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h4>
     <strong>
      一、内存相关参数
     </strong>
    </h4>
    <h5>
     1.
     <strong>
      堆内存控制
     </strong>
    </h5>
    <ul>
     <li>
      <code>
       -Xmx
      </code>
      ：最大堆内存（如
      <code>
       -Xmx4g
      </code>
      ，默认物理内存1/4）。
     </li>
     <li>
      <code>
       -Xms
      </code>
      ：初始堆内存（建议与
      <code>
       -Xmx
      </code>
      相等，避免动态扩容带来的性能波动）。
     </li>
     <li>
      <code>
       -Xmn
      </code>
      ：新生代大小（如
      <code>
       -Xmn2g
      </code>
      ，需权衡老年代空间）。
     </li>
     <li>
      <code>
       -XX:NewRatio
      </code>
      ：老年代与新生代的比例（如
      <code>
       -XX:NewRatio=2
      </code>
      表示老年代是新生代的2倍）。
     </li>
     <li>
      <code>
       -XX:SurvivorRatio
      </code>
      ：Eden区与Survivor区的比例（如
      <code>
       -XX:SurvivorRatio=8
      </code>
      表示Eden:S0:S1=8:1:1）。
     </li>
    </ul>
    <h5>
     2.
     <strong>
      元空间（方法区）
     </strong>
    </h5>
    <ul>
     <li>
      <code>
       -XX:MetaspaceSize
      </code>
      ：初始元空间大小（默认约21M）。
     </li>
     <li>
      <code>
       -XX:MaxMetaspaceSize
      </code>
      ：最大元空间大小（防止无限膨胀，如
      <code>
       -XX:MaxMetaspaceSize=256m
      </code>
      ）。
     </li>
    </ul>
    <h5>
     3.
     <strong>
      直接内存（堆外内存）
     </strong>
    </h5>
    <ul>
     <li>
      <code>
       -XX:MaxDirectMemorySize
      </code>
      ：限制NIO直接内存（如
      <code>
       -XX:MaxDirectMemorySize=512m
      </code>
      ）。
     </li>
    </ul>
    <hr/>
    <h4>
     <strong>
      二、垃圾回收器（GC）相关
     </strong>
    </h4>
    <h5>
     1.
     <strong>
      指定GC算法
     </strong>
    </h5>
    <ul>
     <li>
      <code>
       -XX:+UseSerialGC
      </code>
      ：串行回收器（单线程，适合客户端应用）。
     </li>
     <li>
      <code>
       -XX:+UseParallelGC
      </code>
      ：并行回收器（多线程，吞吐量优先）。
     </li>
     <li>
      <code>
       -XX:+UseConcMarkSweepGC
      </code>
      ：CMS回收器（低延迟，JDK8及之前）。
     </li>
     <li>
      <code>
       -XX:+UseG1GC
      </code>
      ：G1回收器（平衡吞吐与延迟，JDK9+默认）。
     </li>
     <li>
      <code>
       -XX:+UseZGC
      </code>
      ：ZGC（超低延迟，JDK11+）。
     </li>
     <li>
      <code>
       -XX:+UseShenandoahGC
      </code>
      ：Shenandoah（低延迟，RedHat贡献）。
     </li>
    </ul>
    <h5>
     2.
     <strong>
      GC调优参数
     </strong>
    </h5>
    <ul>
     <li>
      <code>
       -XX:MaxGCPauseMillis
      </code>
      ：目标最大GC停顿时间（G1默认200ms，如
      <code>
       -XX:MaxGCPauseMillis=100
      </code>
      ）。
     </li>
     <li>
      <code>
       -XX:G1HeapRegionSize
      </code>
      ：G1的Region大小（如
      <code>
       -XX:G1HeapRegionSize=4m
      </code>
      ）。
     </li>
     <li>
      <code>
       -XX:ParallelGCThreads
      </code>
      ：并行GC线程数（默认CPU核数）。
     </li>
     <li>
      <code>
       -XX:InitiatingHeapOccupancyPercent
      </code>
      ：G1触发并发周期的堆占用阈值（默认45%）。
     </li>
    </ul>
    <h5>
     3.
     <strong>
      GC日志与分析
     </strong>
    </h5>
    <ul>
     <li>
      <code>
       -Xloggc:&lt;file&gt;
      </code>
      ：输出GC日志到文件。
     </li>
     <li>
      <code>
       -XX:+PrintGCDetails
      </code>
      ：打印详细GC信息。
     </li>
     <li>
      <code>
       -XX:+PrintGCDateStamps
      </code>
      ：显示GC发生的时间戳。
     </li>
     <li>
      <code>
       -XX:+UseGCLogFileRotation
      </code>
      ：GC日志轮转（配合
      <code>
       -XX:NumberOfGCLogFiles=5
      </code>
      和
      <code>
       -XX:GCLogFileSize=10M
      </code>
      ）。
     </li>
    </ul>
    <hr/>
    <h4>
     <strong>
      三、故障诊断与监控
     </strong>
    </h4>
    <h5>
     1.
     <strong>
      内存溢出（OOM）处理
     </strong>
    </h5>
    <ul>
     <li>
      <code>
       -XX:+HeapDumpOnOutOfMemoryError
      </code>
      ：OOM时生成堆快照。
     </li>
     <li>
      <code>
       -XX:HeapDumpPath=&lt;path&gt;
      </code>
      ：指定堆快照保存路径。
     </li>
    </ul>
    <h5>
     2.
     <strong>
      类加载监控
     </strong>
    </h5>
    <ul>
     <li>
      <code>
       -XX:+TraceClassLoading
      </code>
      ：跟踪类加载过程。
     </li>
     <li>
      <code>
       -XX:+TraceClassUnloading
      </code>
      ：跟踪类卸载过程。
     </li>
    </ul>
    <h5>
     3.
     <strong>
      调试参数
     </strong>
    </h5>
    <ul>
     <li>
      <code>
       -XX:NativeMemoryTracking=summary
      </code>
      ：监控堆外内存使用（通过
      <code>
       jcmd &lt;pid&gt; VM.native_memory detail
      </code>
      查看）。
     </li>
     <li>
      <code>
       -XX:+PrintFlagsFinal
      </code>
      ：查看所有JVM参数的最终值。
     </li>
    </ul>
    <hr/>
    <h4>
     <strong>
      四、其他优化参数
     </strong>
    </h4>
    <h5>
     1.
     <strong>
      JIT编译器
     </strong>
    </h5>
    <ul>
     <li>
      <code>
       -XX:+TieredCompilation
      </code>
      ：分层编译（JDK8默认开启）。
     </li>
     <li>
      <code>
       -XX:CompileThreshold
      </code>
      ：触发JIT编译的方法调用阈值。
     </li>
    </ul>
    <h5>
     2.
     <strong>
      线程控制
     </strong>
    </h5>
    <ul>
     <li>
      <code>
       -Xss
      </code>
      ：线程栈大小（如
      <code>
       -Xss256k
      </code>
      ，默认1M）。
     </li>
    </ul>
    <h5>
     3.
     <strong>
      禁用显式GC
     </strong>
    </h5>
    <ul>
     <li>
      <code>
       -XX:+DisableExplicitGC
      </code>
      ：禁用
      <code>
       System.gc()
      </code>
      调用（注意可能影响NIO直接内存回收）。
     </li>
    </ul>
    <hr/>
    <h4>
     <strong>
      五、生产环境典型配置示例
     </strong>
    </h4>
    <pre><code># 堆内存与GC（G1）
-Xmx4g -Xms4g -XX:+UseG1GC -XX:MaxGCPauseMillis=200 

# 元空间限制与OOM诊断
-XX:MaxMetaspaceSize=256m -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/logs

# GC日志
-Xloggc:/logs/gc.log -XX:+PrintGCDetails -XX:+PrintGCDateStamps 
</code></pre>
    <hr/>
    <h4>
     <strong>
      六、回答模板
     </strong>
    </h4>
    <ol>
     <li>
      <strong>
       分类说明
      </strong>
      ：先按内存、GC、监控等模块分类，避免遗漏。
     </li>
     <li>
      <strong>
       核心参数
      </strong>
      ：重点说明
      <code>
       -Xmx
      </code>
      、
      <code>
       -Xms
      </code>
      、
      <code>
       -XX:+UseG1GC
      </code>
      等高频参数。
     </li>
     <li>
      <strong>
       场景结合
      </strong>
      ：例如“高吞吐场景用ParallelGC，低延迟用G1/ZGC”。
     </li>
     <li>
      <strong>
       调优原则
      </strong>
      ：强调参数调整前需通过日志（如GC日志）和工具（如jstat、MAT）定位问题。
     </li>
    </ol>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f37333736323631322f:61727469636c652f64657461696c732f313436303832383935" class_="artid" style="display:none">
 </p>
</div>


