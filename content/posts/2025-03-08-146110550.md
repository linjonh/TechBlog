---
layout: post
title: "C学习之格斗小游戏综合案例"
date: 2025-03-08 09:43:28 +0800
description: "/构造函数//武器id//武器名称//武器攻击力//武器暴击系数//武器暴击率//武器吸血系数//武器吸血率//武器冰冻率//获取基础伤害//暴击效果  返回值大于0 触发暴击 否则不触发elsereturn 0;//吸血效果 返回值大于0 触发吸血 否则不触发elsereturn 0;//冰冻效果 返回true代表触发 否则不触发。"
keywords: "C++学习之格斗小游戏综合案例"
categories: ['未分类']
tags: ['学习', 'C']
artid: "146110550"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146110550
    alt: "C学习之格斗小游戏综合案例"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146110550
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146110550
cover: https://bing.ee123.net/img/rand?artid=146110550
image: https://bing.ee123.net/img/rand?artid=146110550
img: https://bing.ee123.net/img/rand?artid=146110550
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     C++学习之格斗小游戏综合案例
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h2>
     <img alt="" height="1468" src="https://i-blog.csdnimg.cn/direct/977b2675949d4b299596f3b2c5c874b2.png" width="1778"/>
    </h2>
    <div class="video">
     <iframe allowfullscreen="true" data-mediaembed="csdn" frameborder="0" id="QaM8OZl7-1741401466482" src="https://live.csdn.net/v/embed/467618" style="width:100%;height:100%;">
     </iframe>
     <p>
      C++格斗游戏效果视频
     </p>
    </div>
    <h2>
     1.案例简介
    </h2>
    <p>
     <img alt="" height="281" src="https://i-blog.csdnimg.cn/direct/b3ab4602fcc34084b36510a55cd7f313.png" width="875"/>
    </p>
    <p>
     #include "broadSword.h"
    </p>
    <p>
     <br/>
     //构造函数
     <br/>
     BroadSword::BroadSword()
     <br/>
     {
     <!-- -->
     <br/>
     FileManager fm;
     <br/>
     map&lt;string, map&lt;string, string&gt;&gt; mWeapon;
     <br/>
     fm.loadCSVData("Weapons.csv", mWeapon);
    </p>
    <p>
     //武器id
     <br/>
     string id = mWeapon["2"]["weaponId"];
    </p>
    <p>
     //武器名称
     <br/>
     this-&gt;weaponName = mWeapon[id]["weaponName"];
     <br/>
     //武器攻击力
     <br/>
     this-&gt;baseDamage = atoi(mWeapon[id]["weaponAtk"].c_str());
     <br/>
     //武器暴击系数
     <br/>
     this-&gt;critPlus = atoi(mWeapon[id]["weaponCritPlus"].c_str());
     <br/>
     //武器暴击率
     <br/>
     this-&gt;critRate = atoi(mWeapon[id]["weaponCritRate"].c_str());
     <br/>
     //武器吸血系数
     <br/>
     this-&gt;suckPlus = atoi(mWeapon[id]["weaponSuckPlus"].c_str());
     <br/>
     //武器吸血率
     <br/>
     this-&gt;suckRate = atoi(mWeapon[id]["weaponSuckRate"].c_str());
     <br/>
     //武器冰冻率
     <br/>
     this-&gt;frozenRate = atoi(mWeapon[id]["weaponFrozenRate"].c_str());
     <br/>
     }
    </p>
    <p>
     //获取基础伤害
     <br/>
     int BroadSword::getBaseDamage()
     <br/>
     {
     <!-- -->
     <br/>
     return this-&gt;baseDamage;
     <br/>
     }
    </p>
    <p>
     //暴击效果  返回值大于0 触发暴击 否则不触发
     <br/>
     int BroadSword::getCrit()
     <br/>
     {
     <!-- -->
     <br/>
     if (isTrigger(this-&gt;critRate))
     <br/>
     {
     <!-- -->
     <br/>
     return this-&gt;baseDamage * this-&gt;critPlus;
     <br/>
     }
     <br/>
     else
     <br/>
     {
     <!-- -->
     <br/>
     return 0;
     <br/>
     }
     <br/>
     }
    </p>
    <p>
     //吸血效果 返回值大于0 触发吸血 否则不触发
     <br/>
     int BroadSword::getSuckBlood()
     <br/>
     {
     <!-- -->
     <br/>
     if (isTrigger(this-&gt;suckRate))
     <br/>
     {
     <!-- -->
     <br/>
     return this-&gt;baseDamage * this-&gt;suckPlus;
     <br/>
     }
     <br/>
     else
     <br/>
     {
     <!-- -->
     <br/>
     return 0;
     <br/>
     }
    </p>
    <p>
     }
    </p>
    <p>
     //冰冻效果 返回true代表触发 否则不触发
     <br/>
     bool BroadSword::getFrozen()
     <br/>
     {
     <!-- -->
     <br/>
     if (isTrigger(this-&gt;frozenRate))
     <br/>
     {
     <!-- -->
     <br/>
     return true;
     <br/>
     }
     <br/>
     else
     <br/>
     {
     <!-- -->
     <br/>
     return false;
     <br/>
     }
    </p>
    <p>
     }
    </p>
    <p>
     //触发概率的算法
     <br/>
     bool BroadSword::isTrigger(int rate)
     <br/>
     {
     <!-- -->
     <br/>
     int num = rand() % 100 + 1;  // 1 ~ 100
     <br/>
     if (num &lt;= rate)
     <br/>
     {
     <!-- -->
     <br/>
     return true;
     <br/>
     }
     <br/>
     return false;
    </p>
    <p>
     }
    </p>
    <p>
     <img alt="" height="292" src="https://i-blog.csdnimg.cn/direct/ae220ebb82bb48f7ad704f580cc4e50c.png" width="569"/>
    </p>
    <p>
     <img alt="" height="402" src="https://i-blog.csdnimg.cn/direct/ee88e31f5bbe48bbba0b85d114426830.png" width="962"/>
    </p>
    <h2>
     2.CSV文件制作
    </h2>
    <p>
     <img alt="" height="499" src="https://i-blog.csdnimg.cn/direct/c40b524ccb81466182233a782b4decfd.png" width="871"/>
    </p>
    <h2>
     <img alt="" height="379" src="https://i-blog.csdnimg.cn/direct/85991d46e61543938c988a812501621c.png" width="804"/>
    </h2>
    <h2>
     <img alt="" height="496" src="https://i-blog.csdnimg.cn/direct/3da4e10f40cc4c8a91a54cfe010621aa.png" width="1026"/>
    </h2>
    <p>
     <img alt="" height="539" src="https://i-blog.csdnimg.cn/direct/e8068bcf92bb40f1bc4aae95fb36cd43.png" width="1140"/>
    </p>
    <h2>
     3.解析单行CSV数据
    </h2>
    <p>
     <img alt="" height="450" src="https://i-blog.csdnimg.cn/direct/8a1928a543b2407ea4cd67a54a267b28.png" width="881"/>
    </p>
    <h2>
     <img alt="" height="354" src="https://i-blog.csdnimg.cn/direct/8116bc738dd442d09a41519c124721d8.png" width="852"/>
    </h2>
    <p>
     #include "fileManager.h"
    </p>
    <p>
     //加载CSV格式文件
     <br/>
     void FileManager::loadCSVData(string path, map&lt;string, map&lt;string, string&gt;&gt;&amp; mData)
     <br/>
     {
     <!-- -->
     <br/>
     //读文件
     <br/>
     ifstream ifs(path);
    </p>
    <p>
     if (!ifs.is_open())
     <br/>
     {
     <!-- -->
     <br/>
     cout &lt;&lt; "文件打开失败" &lt;&lt; endl;
     <br/>
     return;
     <br/>
     }
    </p>
    <p>
     //第一个数据
     <br/>
     string firstLine;
     <br/>
     ifs &gt;&gt; firstLine;
    </p>
    <p>
     <br/>
     //cout &lt;&lt; "第一行数据为： " &lt;&lt; firstLine &lt;&lt; endl;
     <br/>
     //heroId,heroName,heroHp,heroAtk,heroDef,heroInfo
    </p>
    <p>
     vector&lt;string&gt;vFirst; //第一行解析后数据放入的容器
    </p>
    <p>
     this-&gt;parseLineToVector(firstLine, vFirst);
    </p>
    <p>
     //测试
     <br/>
     /*for (vector&lt;string&gt;::iterator it = vFirst.begin(); it != vFirst.end(); it++)
     <br/>
     {
     <!-- -->
     <br/>
     cout &lt;&lt; *it &lt;&lt; endl;
     <br/>
     }*/
    </p>
    <p>
     string otherLine;
     <br/>
     while (ifs &gt;&gt; otherLine)
     <br/>
     {
     <!-- -->
     <br/>
     //cout &lt;&lt; "otherLine = " &lt;&lt; otherLine &lt;&lt; endl;
    </p>
    <p>
     vector&lt;string&gt;vOther;
    </p>
    <p>
     this-&gt;parseLineToVector(otherLine, vOther);
    </p>
    <p>
     map&lt;string, string&gt;m;
     <br/>
     for (int i = 0; i &lt; vFirst.size(); i++)
     <br/>
     {
     <!-- -->
     <br/>
     m.insert(make_pair(vFirst[i], vOther[i]));
     <br/>
     }
     <br/>
     //将小map容器插入到大map容器中
     <br/>
     mData.insert(make_pair(vOther[0], m));
     <br/>
     }
    </p>
    <p>
     //cout &lt;&lt; "第一个英雄姓名： " &lt;&lt; mData["1"]["heroName"] &lt;&lt; endl;
     <br/>
     //cout &lt;&lt; "第二个英雄血量： " &lt;&lt; mData["2"]["heroHp"] &lt;&lt; endl;
     <br/>
     //cout &lt;&lt; "第三个英雄攻击力： " &lt;&lt; mData["3"]["heroAtk"] &lt;&lt; endl;
     <br/>
     }
    </p>
    <p>
     //解析单行数据到vector容器中
     <br/>
     void FileManager::parseLineToVector(string line, vector&lt;string&gt;&amp; v)
     <br/>
     {
     <!-- -->
     <br/>
     int pos = -1;
     <br/>
     int start = 0;
    </p>
    <p>
     while (true)
     <br/>
     {
     <!-- -->
     <br/>
     pos = (int)line.find(",", start);
     <br/>
     if (pos == -1)
     <br/>
     {
     <!-- -->
     <br/>
     //最后一个单词处理
     <br/>
     string temp = line.substr(start);
     <br/>
     v.push_back(temp);
     <br/>
     break;
     <br/>
     }
     <br/>
     string temp = line.substr(start, pos - start);
     <br/>
     v.push_back(temp);
     <br/>
     start = pos + 1;
     <br/>
     }
    </p>
    <p>
     }
    </p>
    <h2>
     <img alt="" height="766" src="https://i-blog.csdnimg.cn/direct/0925ae5e22704427924434dc0b426b05.png" width="1651"/>
    </h2>
    <h2>
     4.解析全部CSV数据
    </h2>
    <p>
     <img alt="" height="437" src="https://i-blog.csdnimg.cn/direct/2beccaffe0f74aa8b2ce8f77f9d8a22c.png" width="889"/>
    </p>
    <h2>
     <img alt="" height="457" src="https://i-blog.csdnimg.cn/direct/6ed4f6a9de8046229851f82a330c57f7.png" width="779"/>
    </h2>
    <h2>
     <img alt="" height="604" src="https://i-blog.csdnimg.cn/direct/5d9898df2a03431bad36e51935d87eb9.png" width="1140"/>
    </h2>
    <h2>
     <img alt="" height="537" src="https://i-blog.csdnimg.cn/direct/1900a9f43b3d49adb53d21f6afe6e485.png" width="1137"/>
    </h2>
    <h2>
     5.创建武器基类
    </h2>
    <p>
     <img alt="" height="409" src="https://i-blog.csdnimg.cn/direct/72cde57dbd5945ef9cfd07a456daf3e9.png" width="885"/>
    </p>
    <h2>
     <img alt="" height="456" src="https://i-blog.csdnimg.cn/direct/71e8e80ac1884ccda79dbe08d937afa5.png" width="854"/>
    </h2>
    <h2>
     <img alt="" height="402" src="https://i-blog.csdnimg.cn/direct/5e281384b79a4bcb94ff3860281ab670.png" width="845"/>
    </h2>
    <h2>
     <img alt="" height="580" src="https://i-blog.csdnimg.cn/direct/c06cb5a279ad4d75be8f0655742c356d.png" width="1150"/>
    </h2>
    <h2>
     6.小刀类实现
    </h2>
    <p>
     <img alt="" height="251" src="https://i-blog.csdnimg.cn/direct/2c5f199341434d35a2eb2e5790aaf345.png" width="816"/>
    </p>
    <h2>
     <img alt="" height="349" src="https://i-blog.csdnimg.cn/direct/cbb0f350f5614cbe9c719caccde7c476.png" width="847"/>
    </h2>
    <h2>
     <img alt="" height="487" src="https://i-blog.csdnimg.cn/direct/e4d0ce0f34ad4978aa46df319cbd799e.png" width="976"/>
    </h2>
    <p>
     <img alt="" height="635" src="https://i-blog.csdnimg.cn/direct/c2920da70d5b4fc09d9445958ee5e13f.png" width="1045"/>
    </p>
    <p>
     <img alt="" height="560" src="https://i-blog.csdnimg.cn/direct/bd755a43241e4c2792174ccd33b25f66.png" width="1142"/>
    </p>
    <h2 style="background-color:transparent">
     7.其他武器类实现
    </h2>
    <p>
     <img alt="" height="321" src="https://i-blog.csdnimg.cn/direct/66989f090bd5474cb1d83e95579ef597.png" width="801"/>
    </p>
    <h2>
     <img alt="" height="312" src="https://i-blog.csdnimg.cn/direct/affad6d1acee4aedaff16937262942a1.png" width="875"/>
    </h2>
    <p>
     <img alt="" height="554" src="https://i-blog.csdnimg.cn/direct/ec382e0e7ede4d4caea23f6700981704.png" width="1111"/>
    </p>
    <h2>
     8.英雄类实现
    </h2>
    <p>
     <img alt="" height="381" src="https://i-blog.csdnimg.cn/direct/cdf57da3fc4446229322072e0d132d37.png" width="797"/>
    </p>
    <h2>
     <img alt="" height="420" src="https://i-blog.csdnimg.cn/direct/4c8e11ca60584f04bcb13458fdd2f996.png" width="821"/>
    </h2>
    <p>
     <img alt="" height="396" src="https://i-blog.csdnimg.cn/direct/563191ba82384b0ca418583389b9078f.png" width="1054"/>
    </p>
    <p>
     <img alt="" height="474" src="https://i-blog.csdnimg.cn/direct/c433e90d79254dc3acba7efbba23259c.png" width="1021"/>
    </p>
    <p>
     <img alt="" height="515" src="https://i-blog.csdnimg.cn/direct/47f7c0327e9a4056b4708d658c95007d.png" width="1061"/>
    </p>
    <h2>
     9.怪物类实现
    </h2>
    <p>
     <img alt="" height="401" src="https://i-blog.csdnimg.cn/direct/af7cd7b455f94df39fd91c5e8fa21d47.png" width="726"/>
    </p>
    <h2>
     <img alt="" height="416" src="https://i-blog.csdnimg.cn/direct/c858ed1e40484cd68a68e87b57e887ea.png" width="876"/>
    </h2>
    <p>
     <img alt="" height="485" src="https://i-blog.csdnimg.cn/direct/1a64bb1a9db140db931a818e69eb797b.png" width="956"/>
    </p>
    <p>
     <img alt="" height="556" src="https://i-blog.csdnimg.cn/direct/dee4c059ae4a44f29367ed42509377e1.png" width="1136"/>
    </p>
    <h2>
     10.英雄的攻击实现
    </h2>
    <p>
     <img alt="" height="391" src="https://i-blog.csdnimg.cn/direct/e3064724022249fda5621825ed70dd21.png" width="810"/>
    </p>
    <h2>
     <img alt="" height="426" src="https://i-blog.csdnimg.cn/direct/2f4330a1a65f4eb3a5c63d499171d4e0.png" width="752"/>
    </h2>
    <p>
     <img alt="" height="474" src="https://i-blog.csdnimg.cn/direct/63b15aa1a54e4be1a7e8d1cfd3dee2d9.png" width="1000"/>
    </p>
    <p>
     <img alt="" height="859" src="https://i-blog.csdnimg.cn/direct/c6449a4ac5864febb8313c8db02cdccc.png" width="1764"/>
    </p>
    <p>
    </p>
    <h2>
     11.战斗交互实现
    </h2>
    <p>
     <img alt="" height="444" src="https://i-blog.csdnimg.cn/direct/88ceb10e10494165bb54a659c693520e.png" width="837"/>
    </p>
    <p>
     <img alt="" height="545" src="https://i-blog.csdnimg.cn/direct/9ef40a1fe830471096e555aeb1c256bc.png" width="991"/>
    </p>
    <p>
     <img alt="" height="501" src="https://i-blog.csdnimg.cn/direct/315c68362bc6403185fda474c581d7f0.png" width="979"/>
    </p>
    <p>
     <img alt="" height="882" src="https://i-blog.csdnimg.cn/direct/3fa91021d0b7451f8964bcbe0fd685b8.png" width="1705"/>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f32373330323838352f:61727469636c652f64657461696c732f313436313130353530" class_="artid" style="display:none">
 </p>
</div>


