---
layout: post
title: "安卓7.0到11.0的更新变化简单理解"
date: 2025-03-11 10:45:08 +0800
description: "ART 内部结构和编译机制的改变使得传统的动态 hook 技术面临巨大挑战，迫使工具和技术不断更新。系统安全性和隐私保护措施的加强（如更严格的 SELinux、隐藏 API 限制、一次性权限等）增加了动态调试和代码注入的难度。内存保护和代码完整性检查机制的完善使得逆向工程师在进行内存补丁、dump 解密后的代码时需要额外的步骤和技巧。工具适配性和动态分析环境的构建要求逆向工程师不断跟进系统更新，采用新工具并开发新的绕过技术。"
keywords: "安卓7.0到11.0的更新变化（简单理解）"
categories: ['安卓逆向']
tags: ['安卓逆向', 'Android']
artid: "146172665"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146172665
    alt: "安卓7.0到11.0的更新变化简单理解"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146172665
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146172665
cover: https://bing.ee123.net/img/rand?artid=146172665
image: https://bing.ee123.net/img/rand?artid=146172665
img: https://bing.ee123.net/img/rand?artid=146172665
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     安卓7.0到11.0的更新变化（简单理解）
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <hr/>
    <h4>
     <a id="1_ARTAndroid_Runtime_3">
     </a>
     1. ART（Android Runtime）内部结构和编译机制的变化
    </h4>
    <ul>
     <li>
      <p>
       <strong>
        Android 7.0 Nougat
       </strong>
      </p>
      <ul>
       <li>
        ART 开始逐步取代 Dalvik，但内部数据结构和 JIT（即时编译）机制仍然相对稳定。
       </li>
       <li>
        逆向工程师可以利用现有的 hook 框架（如早期 Xposed）来进行动态调试和修改。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        Android 8.0 / 8.1 Oreo
       </strong>
      </p>
      <ul>
       <li>
        ART 内部结构发生了重大变化，重构了对象模型、方法解析和内存管理机制。
       </li>
       <li>
        AOT（预编译）技术进一步普及，使得代码在运行前就被编译为机器码，给静态分析带来一定困难。
       </li>
       <li>
        传统的 Xposed hook 技术失效，迫使逆向工程师寻找新的 hook 方法，如使用 EdXposed 或 LSPosed 等适配新版 ART 的工具。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        Android 9.0 Pie
       </strong>
      </p>
      <ul>
       <li>
        ART 优化更为激进，内联缓存、方法内联等优化手段使得代码执行路径更复杂。
       </li>
       <li>
        对于动态调试和内存补丁，逆向工程师需要更加精细地分析优化后的代码和跳转逻辑。
       </li>
      </ul>
     </li>
    </ul>
    <hr/>
    <h4>
     <a id="2__20">
     </a>
     2. 安全性与隐私保护机制的加强
    </h4>
    <ul>
     <li>
      <p>
       <strong>
        反调试和反篡改措施
       </strong>
      </p>
      <ul>
       <li>
        从 Android 8.0 开始，系统在底层加强了对调试器和 hook 工具的检测。
       </li>
       <li>
        Android 9.0 及以后版本引入了更严格的 SELinux 策略和隐藏 API 限制，增加了动态分析和修改的难度。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        权限和沙箱机制
       </strong>
      </p>
      <ul>
       <li>
        Android 10 和 11 对权限管理进行了精细化控制，比如一次性权限、自动重置权限以及后台定位权限的更严格管理。
       </li>
       <li>
        这种变化使得在逆向过程中，动态调试工具和注入代码时需要更细致的权限绕过技巧。
       </li>
      </ul>
     </li>
    </ul>
    <hr/>
    <h4>
     <a id="3__32">
     </a>
     3. 内存保护与代码完整性检查
    </h4>
    <ul>
     <li>
      <p>
       <strong>
        内存保护机制
       </strong>
      </p>
      <ul>
       <li>
        更新版本中，内存区域的读写权限更严格，比如代码段通常被标记为只读，防止直接的内联补丁。
       </li>
       <li>
        逆向工程师需要利用 mprotect 等系统调用来临时修改权限，或者借助外部调试工具进行内存 dump。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        代码混淆与完整性校验
       </strong>
      </p>
      <ul>
       <li>
        随着版本更新，厂商和应用开发者越来越倾向于采用代码混淆和自校验机制，防止逆向分析和修改。
       </li>
       <li>
        这要求逆向工程师在静态分析时需要识别混淆逻辑，并在动态调试时绕过完整性检查。
       </li>
      </ul>
     </li>
    </ul>
    <hr/>
    <h4>
     <a id="4_Hook__44">
     </a>
     4. Hook 技术和动态分析工具的适应性
    </h4>
    <ul>
     <li>
      <p>
       <strong>
        工具更新
       </strong>
      </p>
      <ul>
       <li>
        随着 ART 内部机制和安全防护的改变，传统的 Xposed、Substrate 等 hook 框架在新版系统上往往失效。
       </li>
       <li>
        逆向社区推出了如 EdXposed、LSPosed、Frida 等新工具，这些工具针对新版本系统做了适配和改进，但实现难度和稳定性也面临挑战。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        动态分析环境
       </strong>
      </p>
      <ul>
       <li>
        由于系统更新带来的反调试手段更严密，逆向工程师需要构建更隐蔽和稳健的调试环境，比如利用模拟器、硬件调试器以及特殊的内核补丁来规避检测。
       </li>
      </ul>
     </li>
    </ul>
    <hr/>
    <h4>
     <a id="_55">
     </a>
     总结
    </h4>
    <p>
     从逆向工程的视角看，Android 从 7.0 到 11.0 的更新主要带来了以下影响：
    </p>
    <ul>
     <li>
      <strong>
       ART 内部结构和编译机制的改变
      </strong>
      使得传统的动态 hook 技术面临巨大挑战，迫使工具和技术不断更新。
     </li>
     <li>
      <strong>
       系统安全性和隐私保护措施的加强
      </strong>
      （如更严格的 SELinux、隐藏 API 限制、一次性权限等）增加了动态调试和代码注入的难度。
     </li>
     <li>
      <strong>
       内存保护和代码完整性检查机制的完善
      </strong>
      使得逆向工程师在进行内存补丁、dump 解密后的代码时需要额外的步骤和技巧。
     </li>
     <li>
      <strong>
       工具适配性和动态分析环境的构建
      </strong>
      要求逆向工程师不断跟进系统更新，采用新工具并开发新的绕过技术。
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="1_ART__68">
     </a>
     1. ART 内部结构与编译机制的演变
    </h3>
    <h4>
     <a id="_70">
     </a>
     <strong>
      背景
     </strong>
    </h4>
    <ul>
     <li>
      <strong>
       Dalvik 到 ART
      </strong>
      ：Android 5.0 开始，Google 将 Dalvik 虚拟机替换为 ART，采用 AOT（Ahead-Of-Time）编译技术，从而大幅提升应用启动速度和运行效率。
     </li>
    </ul>
    <h4>
     <a id="_73">
     </a>
     <strong>
      变化原理
     </strong>
    </h4>
    <ul>
     <li>
      <p>
       <strong>
        性能优化
       </strong>
       ：
      </p>
      <ul>
       <li>
        ART 的设计目标是让 Java 代码运行得更快、更稳定。为此，系统不断优化内存管理、垃圾回收（GC）、JIT（Just-In-Time）与 AOT 编译机制。
       </li>
       <li>
        随着硬件性能的提升，ART 在后续版本中不断引入更高效的内联缓存、方法内联和优化的逃逸分析等技术。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        安全性与防篡改
       </strong>
       ：
      </p>
      <ul>
       <li>
        为防止逆向分析和内存篡改，Android 8.0 及以上版本对 ART 内部数据结构、方法解析逻辑进行了重构。
       </li>
       <li>
        这种变化使得传统的 hook 技术（比如基于旧版本内部结构的 Xposed）失效，从而迫使逆向工程师更新技术手段。
       </li>
      </ul>
     </li>
    </ul>
    <h4>
     <a id="_82">
     </a>
     <strong>
      及时变化的原因
     </strong>
    </h4>
    <ul>
     <li>
      需求上：为了更好地平衡性能和安全，ART 的内部机制必须根据新硬件和新安全需求进行不断调整。
     </li>
     <li>
      对抗上：当逆向技术或漏洞利用手段被滥用时，系统开发者会修改内部实现来“堵漏”，导致逆向工具不得不跟进。
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="2__88">
     </a>
     2. 动态链接与内存保护机制的升级
    </h3>
    <h4>
     <a id="_90">
     </a>
     <strong>
      背景
     </strong>
    </h4>
    <ul>
     <li>
      <strong>
       动态链接与加载
      </strong>
      ：Android 应用通常依赖于动态链接库（.so 文件），其加载过程中涉及 GOT（Global Offset Table）和 PLT（Procedure Linkage Table）的解析与重定向。
     </li>
    </ul>
    <h4>
     <a id="_93">
     </a>
     <strong>
      变化原理
     </strong>
    </h4>
    <ul>
     <li>
      <strong>
       ASLR（地址随机化）加强
      </strong>
      ：
      <ul>
       <li>
        随着版本升级，系统进一步强化了 ASLR 机制，使得动态库加载时地址随机性更高，从而提高了利用难度。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       内存权限管理
      </strong>
      ：
      <ul>
       <li>
        代码段（.text）通常被标记为只读，防止恶意代码修改。反调试、完整性校验等技术也随之增强，迫使逆向者必须通过修改内存权限（如 mprotect）或寻找其它绕过方法。
       </li>
      </ul>
     </li>
    </ul>
    <h4>
     <a id="_99">
     </a>
     <strong>
      及时变化的原因
     </strong>
    </h4>
    <ul>
     <li>
      防御需求：随着利用手法不断成熟，操作系统必须不断更新内存保护策略来确保程序完整性和安全性。
     </li>
     <li>
      攻防博弈：攻击者在利用动态链接或内存修改技术成功 hook 了某些函数后，厂商会修补这些漏洞，引入新的检查和保护机制。
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="3__105">
     </a>
     3. 安全策略与权限管理的细化
    </h3>
    <h4>
     <a id="_107">
     </a>
     <strong>
      背景
     </strong>
    </h4>
    <ul>
     <li>
      Android 10、11 等版本对权限管理和隐私保护进行了细化，例如一次性权限、后台定位权限的控制、自动重置长期未使用的权限等。
     </li>
    </ul>
    <h4>
     <a id="_110">
     </a>
     <strong>
      变化原理
     </strong>
    </h4>
    <ul>
     <li>
      <strong>
       权限控制细化
      </strong>
      ：
      <ul>
       <li>
        新版本引入更精细的权限模型，确保应用在运行时只能访问必要资源，从而减少潜在的攻击面。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       隐藏 API 限制
      </strong>
      ：
      <ul>
       <li>
        为防止应用或逆向工具通过反射等手段调用内部 API，系统开始严格限制对非公开 API 的访问。
       </li>
      </ul>
     </li>
    </ul>
    <h4>
     <a id="_116">
     </a>
     <strong>
      及时变化的原因
     </strong>
    </h4>
    <ul>
     <li>
      用户隐私与数据安全：随着用户数据泄露事件的增多，系统必须加强隐私保护措施。
     </li>
     <li>
      逆向技术改进：当一些应用通过隐藏 API 实现功能被逆向滥用时，系统会调整策略，限制对敏感 API 的调用。
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="4_Hook__122">
     </a>
     4. Hook 技术与反调试技术的博弈
    </h3>
    <h4>
     <a id="_124">
     </a>
     <strong>
      背景
     </strong>
    </h4>
    <ul>
     <li>
      Hook 技术（如 GOT hook、PLT hook、Inline hook）长期被逆向工程师用于动态分析和修改程序行为，而系统则不断推出反调试和完整性校验机制来对抗这种行为。
     </li>
    </ul>
    <h4>
     <a id="_127">
     </a>
     <strong>
      变化原理
     </strong>
    </h4>
    <ul>
     <li>
      <strong>
       传统 Hook 技术受限
      </strong>
      ：
      <ul>
       <li>
        旧版 Android 中，hook 技术相对容易实现，但随着 ART 内部重构、内存保护加强及调试器检测手段的升级，传统技术失效。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       新型 Hook 工具的诞生
      </strong>
      ：
      <ul>
       <li>
        社区中涌现出诸如 Frida、EdXposed、LSPosed 等工具，它们利用不同原理（如代码注入、内联 hook、虚拟机层 hook）来应对新版系统。
       </li>
      </ul>
     </li>
    </ul>
    <hr/>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f535858594e484858582f:61727469636c652f64657461696c732f313436313732363635" class_="artid" style="display:none">
 </p>
</div>


