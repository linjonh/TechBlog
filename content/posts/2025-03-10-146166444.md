---
layout: post
title: "SpringAI介绍及本地模型使用方法"
date: 2025-03-10 23:08:33 +0800
description: "Spring在Java语言中一直稳居高位，与AI的洪流碰撞后也产生了一些有趣的”化学反应“，当然你要非要说碰撞属于物理反应也可以，在经历了一系列复杂的反应方程后，Spring家族的新成员——SpringAI，就此诞生。需要注意的是，springai目前仍处于试验阶段，可能会出现许多不稳定因素，希望各位使用者能放平心态面对BUG（或者去issues里发表自己的见解Spring AI 项目为开发 AI 应用程序提供了 Spring 友好的 API 和抽象类。"
keywords: "SpringAI介绍及本地模型使用方法"
categories: ['面试', '阿里巴巴', '学习路线']
tags: ['Java']
artid: "146166444"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146166444
    alt: "SpringAI介绍及本地模型使用方法"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146166444
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146166444
cover: https://bing.ee123.net/img/rand?artid=146166444
image: https://bing.ee123.net/img/rand?artid=146166444
img: https://bing.ee123.net/img/rand?artid=146166444
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     SpringAI介绍及本地模型使用方法
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h4>
     <a id="http602041746archivesspringai__4">
     </a>
     <a href="http://60.204.174.6/archives/springai" rel="nofollow" title="博客原文地址">
      博客原文地址
     </a>
    </h4>
    <h4>
     <a id="_6">
     </a>
     前言
    </h4>
    <p>
     Spring在Java语言中一直稳居高位，与AI的洪流碰撞后也产生了一些有趣的”化学反应“，当然你要非要说碰撞属于物理反应也可以，
    </p>
    <p>
     在经历了一系列复杂的反应方程后，Spring家族的新成员——
     <strong>
      SpringAI
     </strong>
     ，就此诞生。
    </p>
    <p>
     需要注意的是，springai目前仍处于试验阶段，可能会出现许多不稳定因素，希望各位使用者能放平心态面对BUG
     <sub>
      （或者去issues里发表自己的见解
     </sub>
     ）
    </p>
    <h4>
     <a id="_14">
     </a>
     简介
    </h4>
    <p>
     Spring AI 项目为开发 AI 应用程序提供了 Spring 友好的 API 和抽象类。
    </p>
    <p>
     其目标是将 Spring 生态系统设计原则（如可移植性和模块化设计）应用于 AI 领域，并将使用 POJO 作为应用程序的构建块推广到 AI 领域。
    </p>
    <p>
     <strong>
      github仓库
     </strong>
     ：
     <a href="https://github.com/spring-projects/spring-ai" title="spring-projects/spring-ai: An Application Framework for AI Engineering">
      spring-projects/spring-ai: An Application Framework for AI Engineering
     </a>
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/direct/75ea3eebbcf44e86821e30838b7ce32a.png"/>
    </p>
    <p>
     目前该项目已经集成了
     <strong>
      OpenAI、Azure OpenAI、Hugging Face、Ollama
     </strong>
     等API。
    </p>
    <p>
     我们一般对于AI类项目嵌入JAVA的做法为：
    </p>
    <ol>
     <li>
      <p>
       <em>
        开发java后端和前端部分代码
       </em>
      </p>
     </li>
     <li>
      <p>
       <em>
        确定功能需求，如文本生成类项目，即接收部分参数，返回一个String文本
       </em>
      </p>
     </li>
     <li>
      <p>
       <em>
        确定模型主题，如BERT/T5等等
       </em>
      </p>
     </li>
     <li>
      <p>
       <em>
        对模型进行训练或微调，并编写使用方法代码
       </em>
      </p>
     </li>
     <li>
      <p>
       <em>
        使用web框架（如：FastAPI/Flask）开放接口，规范接参收参格式
       </em>
      </p>
     </li>
     <li>
      <p>
       <em>
        java使用webclient（也可以用别的）请求接口调用AI服务
       </em>
      </p>
     </li>
     <li>
      <p>
       <em>
        测试联调（你也可以选择一步一测试，都可以）
       </em>
      </p>
     </li>
    </ol>
    <p>
     对于具体的模型对接代码可以参考我的Transformers文章中有详细的对于模型使用和训练的代码：
     <a href="http://60.204.174.6/archives/transformerku" rel="nofollow" title="transformer库 | ADulcimer Blog">
      transformer库 | ADulcimer Blog
     </a>
    </p>
    <p>
     所以SpringAI也就相当于是集合了大部分厂商的API接口，提供调用，再进行一些java适配和代码优化等等。最终也是通过接惨（文本和key等等）然后传参，被java接收
    </p>
    <p>
     请注意：springai的API调用并不能让你在离线模式进行大模型的访问，如果你是AI开发人员，那么springai可以让你在java中离线运行本地torch或其他模型，但是相比于python还是较为局限，但如果你只是通过此技术调用大模型API，那么离线模式下是无法实现对话功能的
    </p>
    <p>
     应该足够清楚的表明了： springAI到底是个什么技术，总结一下：
    </p>
    <p>
     Spring AI 是一个强大的工具，适合那些已经在使用 Spring 框架的开发者，并且希望将 AI 能力集成到他们的企业级应用中。它的优势在于与 Spring 生态系统的无缝集成和企业级支持，但对于初学者或者需求较简单的 AI 项目来说，它可能过于复杂
    </p>
    <h4>
     <a id="PythonAI_53">
     </a>
     Python开AI接口区别
    </h4>
    <p>
     SpringAI在解决复杂问题时，会比传统的AI开接口更加优秀，请注意，这里说的是复杂的业务逻辑，如果是复杂的AI功能，比如，需求不断微调，训练，或者更换模型，对模型进行更改等等等等，Python开接口的方式还是会更加灵活，如果说业务复杂，但AI需求功能单一，则使用SpringAI，如果业务逻辑简单，则都可以使用python接口的方式，因为SpringAI是一个很重的框架
    </p>
    <h5>
     <a id="1_57">
     </a>
     <strong>
      1、企业级架构与可扩展性
     </strong>
    </h5>
    <ul>
     <li>
      <p>
       <strong>
        Spring AI
       </strong>
       是构建在
       <strong>
        Spring 框架
       </strong>
       上的，Spring 本身就是为企业级、分布式、高并发系统设计的框架。因此，如果你的需求涉及到复杂的业务逻辑、大规模的用户交互或者高可用、高并发的环境，Spring AI 提供的
       <strong>
        可扩展性
       </strong>
       和
       <strong>
        可靠性
       </strong>
       将使得系统更加稳定。
      </p>
     </li>
     <li>
      <p>
       <strong>
        Spring Cloud
       </strong>
       和
       <strong>
        Spring Boot
       </strong>
       等工具，使得它在微服务架构中的表现非常出色，这对于那些需求复杂的系统（如需要多个模块、服务和组件的系统）来说，是一个很大的优势。
      </p>
     </li>
    </ul>
    <h5>
     <a id="2__64">
     </a>
     2.
     <strong>
      集成能力
     </strong>
    </h5>
    <ul>
     <li>
      <p>
       <strong>
        Spring AI
       </strong>
       能够无缝集成
       <strong>
        Java 生态系统中的其他工具和技术
       </strong>
       ，比如数据库、消息队列、缓存系统、认证与授权、安全等模块。如果你的系统已经在使用 Spring 框架，这使得 Spring AI 能够与现有的基础设施进行更好的集成。
      </p>
     </li>
     <li>
      <p>
       如果需要和传统的
       <strong>
        Java 后端服务
       </strong>
       、
       <strong>
        企业级应用
       </strong>
       或
       <strong>
        第三方服务（如支付、ERP 系统）
       </strong>
       进行集成，Spring 提供的成熟的解决方案和丰富的生态系统使得这种集成更加顺畅。
      </p>
     </li>
    </ul>
    <h5>
     <a id="3__71">
     </a>
     3.
     <strong>
      高并发和高可靠性
     </strong>
    </h5>
    <ul>
     <li>
      <p>
       Spring 框架和相关工具（如 Spring Boot、Spring Cloud）具有极强的
       <strong>
        高并发
       </strong>
       支持和
       <strong>
        高可用
       </strong>
       设计。对于大规模用户请求、海量数据处理等需求，Spring 框架能够通过
       <strong>
        多线程、异步处理、负载均衡、服务容错、分布式系统管理等技术
       </strong>
       来确保系统的稳定性和高效运行。
      </p>
     </li>
     <li>
      <p>
       在这些场景下，Spring AI 提供的
       <strong>
        性能优化
       </strong>
       和
       <strong>
        容错机制
       </strong>
       使得系统更加可靠，而 Python 写的模型可能需要通过额外的优化和工具来应对这些挑战。
      </p>
     </li>
    </ul>
    <h5>
     <a id="4__78">
     </a>
     4.
     <strong>
      生产环境的成熟度与稳定性
     </strong>
    </h5>
    <ul>
     <li>
      <p>
       Spring 框架已经在
       <strong>
        生产环境
       </strong>
       中得到了广泛的应用，尤其是在
       <strong>
        大型企业级应用
       </strong>
       中，具有非常高的稳定性和可靠性。Spring 提供了很多企业级功能，如
       <strong>
        事务管理、缓存、日志记录、调试工具
       </strong>
       等，这些功能对于复杂需求的应用至关重要。
      </p>
     </li>
     <li>
      <p>
       对比之下，传统的 Python 接口通常更多用于
       <strong>
        原型开发、快速部署
       </strong>
       或
       <strong>
        中小规模应用
       </strong>
       ，虽然在灵活性和开发速度上有优势，但在大规模生产环境中的稳定性和可维护性上可能没有 Spring 那么强。
      </p>
     </li>
    </ul>
    <h5>
     <a id="5__85">
     </a>
     5.
     <strong>
      安全性
     </strong>
    </h5>
    <ul>
     <li>
      <p>
       在涉及到
       <strong>
        敏感数据、权限管理、认证与授权
       </strong>
       的复杂需求时，Spring 提供了丰富的
       <strong>
        安全机制
       </strong>
       。通过 Spring Security 等工具，可以高效地管理和控制用户权限、进行身份验证、数据加密等，确保系统的安全性。
      </p>
     </li>
     <li>
      <p>
       Python 虽然也有相关的库（如 Flask-Security、Django Security 等），但在集成和管理方面可能没有 Spring 的安全框架那么成熟和全面。
      </p>
     </li>
    </ul>
    <h5>
     <a id="6_DevOps__92">
     </a>
     6.
     <strong>
      DevOps 支持与自动化部署
     </strong>
    </h5>
    <ul>
     <li>
      <p>
       <strong>
        Spring
       </strong>
       在 DevOps 和自动化部署方面也有很强的支持，Spring Boot 和 Spring Cloud 的集成功能使得部署、监控、日志管理和版本管理等任务更加自动化，极大地提高了运维效率。
      </p>
     </li>
     <li>
      <p>
       Python 部署方面也可以使用 Docker、Kubernetes 等工具，但由于 Spring 提供的微服务架构和生产环境支持更加丰富，Spring AI 在大规模应用部署和运维上表现更佳。
      </p>
     </li>
    </ul>
    <h5>
     <a id="7__99">
     </a>
     7.
     <strong>
      维护与支持
     </strong>
    </h5>
    <ul>
     <li>
      <p>
       对于
       <strong>
        大型团队
       </strong>
       和
       <strong>
        长期项目
       </strong>
       ，Spring 框架提供了成熟的企业级支持，文档和社区也非常强大。对于一些需求复杂、时间长的项目，使用 Spring AI 可以更容易进行
       <strong>
        长期维护
       </strong>
       和
       <strong>
        团队协作
       </strong>
       。
      </p>
     </li>
     <li>
      <p>
       Python 的开发者社区虽然庞大，但在企业级开发、集成和维护方面，可能不如 Spring 框架在行业中的积淀和支持那么全面。
      </p>
     </li>
    </ul>
    <h4>
     <a id="_106">
     </a>
     代码部分
    </h4>
    <p>
     根据官方文档，分为两种方式调用，一种是springboot项目，交给spring管理
    </p>
    <p>
     参考官方文档：transforms（我们以它为例）
    </p>
    <p>
     <a href="https://spring-doc.cn/spring-ai/1.0.0-SNAPSHOT/api_embeddings_onnx.html#_auto_configuration" rel="nofollow" title="（ONNX）变形金刚 ((ONNX) Transformers) _ Spring AI 1.0.0-SNAPSHOT 中文文档(官方文档中文翻译) —— CADN开发者文档中心">
      （ONNX）变形金刚 ((ONNX) Transformers) _ Spring AI 1.0.0-SNAPSHOT 中文文档(官方文档中文翻译) —— CADN开发者文档中心
     </a>
    </p>
    <p>
     参考maven文档：
    </p>
    <p>
     <a href="https://repo.spring.io/ui/native/milestone/org/springframework/ai/spring-ai-transformers-spring-boot-starter/1.0.0.M2/" rel="nofollow" title="repo.spring.io">
      repo.spring.io
     </a>
    </p>
    <h5>
     <a id="1Springboot_118">
     </a>
     1、Springboot管理
    </h5>
    <h6>
     <a id="1_120">
     </a>
     1、引入依赖：
    </h6>
    <pre><code>    &lt;repositories&gt;
        &lt;repository&gt;
            &lt;id&gt;spring-milestones&lt;/id&gt;
            &lt;name&gt;Spring Milestones&lt;/name&gt;
            &lt;url&gt;https://repo.spring.io/milestone&lt;/url&gt;
            &lt;snapshots&gt;
                &lt;enabled&gt;false&lt;/enabled&gt;
            &lt;/snapshots&gt;
        &lt;/repository&gt;
        &lt;repository&gt;
            &lt;id&gt;spring-snapshots&lt;/id&gt;
            &lt;name&gt;Spring Snapshots&lt;/name&gt;
            &lt;url&gt;https://repo.spring.io/snapshot&lt;/url&gt;
            &lt;releases&gt;
                &lt;enabled&gt;false&lt;/enabled&gt;
            &lt;/releases&gt;
        &lt;/repository&gt;
    &lt;/repositories&gt;
    &lt;dependencyManagement&gt;
        &lt;dependencies&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework.ai&lt;/groupId&gt;
                &lt;artifactId&gt;spring-ai-bom&lt;/artifactId&gt;
                &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;
                &lt;type&gt;pom&lt;/type&gt;
                &lt;scope&gt;import&lt;/scope&gt;
            &lt;/dependency&gt;
        &lt;/dependencies&gt;
    &lt;/dependencyManagement&gt;

&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.ai&lt;/groupId&gt;
    &lt;artifactId&gt;spring-ai-transformers-spring-boot-starter&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
    <h6>
     <a id="2applicationyml_157">
     </a>
     2、编写application.yml配置文件
    </h6>
    <pre><code>spring:
  ai:
    embedding:
        transformer:
          onnx:
            model-uri: https://huggingface.co/intfloat/e5-small-v2/resolve/main/model.onnx
          tokenizer:
            uri: https://huggingface.co/intfloat/e5-small-v2/raw/main/tokenizer.json
          cache:
            directory: /tmp/ai-embedding-transformer
            enabled: true
</code></pre>
    <p>
     部分的配置详情如下：
    </p>
    <p>
     <strong>
      Property
     </strong>
    </p>
    <p>
     <strong>
      Description
     </strong>
    </p>
    <p>
     <strong>
      spring.ai.embedding.transformer.enabled
     </strong>
    </p>
    <p>
     启用 Transformer Embedding 模型。
    </p>
    <p>
     <strong>
      spring.ai.embedding.transformer.tokenizer.uri
     </strong>
    </p>
    <p>
     Transformer分词器地址
    </p>
    <p>
     <strong>
      spring.ai.embedding.transformer.tokenizer.options
     </strong>
    </p>
    <p>
     模型的一些参数，max_length这些
    </p>
    <p>
     <strong>
      spring.ai.embedding.transformer.cache.enabled
     </strong>
    </p>
    <p>
     是否启用缓存
    </p>
    <p>
     <strong>
      spring.ai.embedding.transformer.cache.directory
     </strong>
    </p>
    <p>
     缓存路径
    </p>
    <p>
     <strong>
      spring.ai.embedding.transformer.onnx.modelUri
     </strong>
    </p>
    <p>
     Transformers预训练模型地址
    </p>
    <p>
     <strong>
      spring.ai.embedding.transformer.onnx.gpuDeviceId
     </strong>
    </p>
    <p>
     GPU设备ID
    </p>
    <p>
     这些是一些常用的，具体请参考官方文档
     <img alt="" src="https://i-blog.csdnimg.cn/direct/1dfce4fc4f47422ebaa59205c328aaab.png"/>
    </p>
    <h6>
     <a id="3controllerservice_207">
     </a>
     3、搭建controller和service层
    </h6>
    <pre><code>import com.adulcimer.ai.service.ToxicityService;
import jakarta.annotation.Resource;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
class MyController {
    @Resource
    private ToxicityService toxicityService;

    @PostMapping("/test")
    public String test() throws Exception {
        toxicityService.modelTest();
        return "Hello, World!";
    }
}

import jakarta.annotation.Resource;
import org.springframework.ai.transformers.TransformersEmbeddingModel;
import org.springframework.stereotype.Service;

import java.util.Arrays;

@Service
public class ToxicityService {

    @Resource
    private TransformersEmbeddingModel transformersEmbeddingModel;

    public void modelTest() throws Exception {
        float[] embed = transformersEmbeddingModel.embed("Hello World");
        System.out.println(Arrays.toString(embed));
    }
}
</code></pre>
    <h6>
     <a id="4httpsiblogcsdnimgcndirecta9dddc2a965c4dba8982338b5c8a3da6png_244">
     </a>
     4、结果
     <img alt="" src="https://i-blog.csdnimg.cn/direct/a9dddc2a965c4dba8982338b5c8a3da6.png"/>
    </h6>
    <p>
     <strong>
      <em>
       我们已经得到模型的返回值了，成功使用springboot调用了AI模型
      </em>
     </strong>
    </p>
    <p>
     具体的业务逻辑也可以轻松嵌入，是不是很轻松？
    </p>
    <h5>
     <a id="2_250">
     </a>
     2、自定义配置
    </h5>
    <p>
     当然你也可以不使用spring的管理
    </p>
    <pre><code>TransformersEmbeddingModel embeddingModel = new TransformersEmbeddingModel();

embeddingModel.setTokenizerResource("classpath:/onnx/all-MiniLM-L6-v2/tokenizer.json");

embeddingModel.setModelResource("classpath:/onnx/all-MiniLM-L6-v2/model.onnx");

embeddingModel.setResourceCacheDirectory("/tmp/onnx-zoo");

embeddingModel.setTokenizerOptions(Map.of("padding", "true"));

embeddingModel.afterPropertiesSet();

List&lt;List&lt;Double&gt;&gt; embeddings = this.embeddingModel.embed(List.of("Hello world", "World is big"));
</code></pre>
    <p>
     然后正常使用架构搭建即可
    </p>
    <h4>
     <a id="_270">
     </a>
     最后
    </h4>
    <p>
     以上部分内容和图片来自于官方文档，本文中已声明原作地址。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f35343835303330332f:61727469636c652f64657461696c732f313436313636343434" class_="artid" style="display:none">
 </p>
</div>


