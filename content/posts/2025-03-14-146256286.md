---
layout: post
title: "硬件驱动51单片机独立按键中断定时器计数器"
date: 2025-03-14 21:44:12 +0800
description: "以16位定时器模式工作，按下不同的按键，使LED灯分别按照1s,500ms,200ms,100ms动态闪烁。打开外部中断0和外部中断1，当外部中断0执行时，点亮所有LED灯，当外部中断1执行时，熄灭所有LED灯。单片机通电后，51单片机的40个引脚均为高电平（即值均为1），其中引脚5~8为。若需要1毫秒计数一次，则定时器的初值应为65535-(921600÷1000)=本人使用的51单片机的系统时钟频率为11.0592MHz，定时器。按下特定按键，对应的LED灯亮起，同时数码管显示对应数字。"
keywords: "硬件驱动——51单片机：独立按键、中断、定时器/计数器"
categories: ['学习记录']
tags: ['嵌入式硬件', '单片机', '51单片机']
artid: "146256286"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146256286
    alt: "硬件驱动51单片机独立按键中断定时器计数器"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146256286
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146256286
cover: https://bing.ee123.net/img/rand?artid=146256286
image: https://bing.ee123.net/img/rand?artid=146256286
img: https://bing.ee123.net/img/rand?artid=146256286
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     硬件驱动——51单片机：独立按键、中断、定时器/计数器
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <hr id="hr-toc" name="tableOfContents"/>
    <p>
    </p>
    <h2 id="%E4%B8%80%E3%80%81%E7%8B%AC%E7%AB%8B%E6%8C%89%E9%94%AE" name="%E4%B8%80%E3%80%81%E7%8B%AC%E7%AB%8B%E6%8C%89%E9%94%AE">
     一、独立按键
    </h2>
    <hr/>
    <h3 id="1.%E5%8E%9F%E7%90%86" name="1.%E5%8E%9F%E7%90%86">
     1.原理
    </h3>
    <p>
     单片机通电后，51单片机的40个引脚均为高电平（即值均为1），其中引脚5~8为
     <strong>
      寄存器P1
     </strong>
     的
     <strong>
      后四个
     </strong>
     引脚P14~P17，负责控制独立按键模块的
     <strong>
      4个按键开关
     </strong>
     。
    </p>
    <p>
     按键
     <strong>
      按下后
     </strong>
     ，对应线路
     <strong>
      导通
     </strong>
     ，电压接低变为
     <strong>
      低电平
     </strong>
     。
    </p>
    <p class="img-center">
     <img alt="" height="381" src="https://i-blog.csdnimg.cn/direct/64a02275c78043c18f40916b8b398c99.png" width="594"/>
    </p>
    <h3 id="2.%E5%B0%81%E8%A3%85%E5%87%BD%E6%95%B0%C2%A0" name="2.%E5%B0%81%E8%A3%85%E5%87%BD%E6%95%B0%C2%A0">
     2.封装函数
    </h3>
    <p class="img-center">
     <img alt="" height="659" src="https://i-blog.csdnimg.cn/direct/918b478abc1841a48d46b80eb9744ce4.png" width="553"/>
    </p>
    <h3 id="3.%E6%8C%89%E9%94%AE%E6%8E%A7%E5%88%B6%E7%82%B9%E7%81%AF%2B%20%E6%95%B0%E7%A0%81%E7%AE%A1" name="3.%E6%8C%89%E9%94%AE%E6%8E%A7%E5%88%B6%E7%82%B9%E7%81%AF%2B%20%E6%95%B0%E7%A0%81%E7%AE%A1">
     <strong>
      3.按键控制点灯+ 数码管
     </strong>
    </h3>
    <p>
     <strong>
     </strong>
     按下特定按键，对应的LED灯亮起，同时数码管显示对应数字
    </p>
    <p class="img-center">
     <img alt="" height="350" src="https://i-blog.csdnimg.cn/direct/738fc1b76fe044f8b2b4ac4e7ab04949.png" width="546"/>
    </p>
    <p>
    </p>
    <h2 id="%E4%BA%8C%E3%80%81%E4%B8%AD%E6%96%AD%C2%A0" name="%E4%BA%8C%E3%80%81%E4%B8%AD%E6%96%AD%C2%A0">
     二、中断
    </h2>
    <hr/>
    <h3 id="1.%E5%8E%9F%E7%90%86%C2%A0" name="1.%E5%8E%9F%E7%90%86%C2%A0">
     1.原理
    </h3>
    <p class="img-center">
     <img alt="" height="392" src="https://i-blog.csdnimg.cn/direct/230f1c5b9e3f40f497fc0c3b40479bca.png" width="881"/>
    </p>
    <ul>
     <li>
      <strong>
       中断向量表：
      </strong>
     </li>
    </ul>
    <p>
     即一个
     <strong>
      函数指针的数组
     </strong>
     。
    </p>
    <p>
     <strong>
      void (*pfn)(void)  interrupt n
     </strong>
    </p>
    <p class="img-center">
     <img alt="" height="241" src="https://i-blog.csdnimg.cn/direct/947b4415ccb34925870989455b763f86.png" width="745"/>
    </p>
    <h3 id="%C2%A02.%E6%AD%A5%E9%AA%A4" name="%C2%A02.%E6%AD%A5%E9%AA%A4">
     2.步骤
    </h3>
    <p>
     <strong>
      中断处理六大步骤：
     </strong>
    </p>
    <p class="img-center">
     <img alt="" height="484" src="https://i-blog.csdnimg.cn/direct/418bb5a8ad6d48c795b09b8b240f5579.png" width="1517"/>
    </p>
    <h3 id="3.%E4%B8%AD%E6%96%AD%E5%AF%84%E5%AD%98%E5%99%A8IE" name="3.%E4%B8%AD%E6%96%AD%E5%AF%84%E5%AD%98%E5%99%A8IE" style="background-color:transparent">
     3.中断寄存器IE
    </h3>
    <p class="img-center">
     <img alt="" height="522" src="https://i-blog.csdnimg.cn/direct/a5c103f7e53848cbb78b37128abfd635.png" width="1098"/>
    </p>
    <h3 id="4.%E6%8E%A7%E5%88%B6%E5%AF%84%E5%AD%98%E5%99%A8TCON" name="4.%E6%8E%A7%E5%88%B6%E5%AF%84%E5%AD%98%E5%99%A8TCON" style="background-color:transparent">
     4.控制寄存器TCON
    </h3>
    <p class="img-center">
     <img alt="" height="769" src="https://i-blog.csdnimg.cn/direct/67bfec397c514993be420be7830b2d24.png" width="1117"/>
    </p>
    <h3 id="5.%E6%89%93%E5%BC%80%E5%A4%96%E9%83%A8%E4%B8%AD%E6%96%AD0%E5%92%8C1" name="5.%E6%89%93%E5%BC%80%E5%A4%96%E9%83%A8%E4%B8%AD%E6%96%AD0%E5%92%8C1" style="background-color:transparent">
     5.打开外部中断0和1
    </h3>
    <p>
     打开外部中断0和外部中断1，当外部中断0执行时，点亮所有LED灯，当外部中断1执行时，熄灭所有LED灯
    </p>
    <p class="img-center">
     <img alt="" height="478" src="https://i-blog.csdnimg.cn/direct/6a50961d22d7400693dcc41c9fe93957.png" width="681"/>
    </p>
    <p>
    </p>
    <h2 id="%E4%B8%89%E3%80%81%E5%AE%9A%E6%97%B6%E5%99%A8%2F%E8%AE%A1%E6%95%B0%E5%99%A8" name="%E4%B8%89%E3%80%81%E5%AE%9A%E6%97%B6%E5%99%A8%2F%E8%AE%A1%E6%95%B0%E5%99%A8">
     三、定时器/计数器
    </h2>
    <hr/>
    <h3 id="1.%E5%8E%9F%E7%90%86" name="1.%E5%8E%9F%E7%90%86">
     1.原理
    </h3>
    <p>
     定时器/计数器的核心部件是一个
     <strong>
      加法计数器
     </strong>
     ，其本质是对脉冲进行计数。
    </p>
    <p>
     本人使用的51单片机的系统时钟频率为11.0592MHz，定时器
     <strong>
      每12个时钟
     </strong>
     得到一个计数脉冲，计数值加1。计数值的类型为
     <strong>
      unsigned short
     </strong>
     ，大小为
     <strong>
      两个字节
     </strong>
     ，计数范围为
     <strong>
      0~65535
     </strong>
     。
    </p>
    <p>
     故实际有效频率为：11.0592*1000*1000÷12=921600Hz
    </p>
    <p>
     周期为：1÷921600=1.08507e^-6秒，接近1微秒。
    </p>
    <p>
     若需要1毫秒计数一次，则定时器的初值应为65535-(921600÷1000)=
     <strong>
      64613
     </strong>
    </p>
    <h3 id="2.%E6%8E%A7%E5%88%B6%E5%AF%84%E5%AD%98%E5%99%A8TCON" name="2.%E6%8E%A7%E5%88%B6%E5%AF%84%E5%AD%98%E5%99%A8TCON">
     2.控制寄存器TCON
    </h3>
    <p class="img-center">
     <img alt="" height="822" src="https://i-blog.csdnimg.cn/direct/787d9e03cadd41bf836ab1d545b40b63.png" width="822"/>
    </p>
    <h3 id="3.%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F%E5%AF%84%E5%AD%98%E5%99%A8TMOD" name="3.%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F%E5%AF%84%E5%AD%98%E5%99%A8TMOD">
     3.工作模式寄存器TMOD
    </h3>
    <p class="img-center">
     <img alt="" height="105" src="https://i-blog.csdnimg.cn/direct/4695fd27114546dbab3675f0d2fdce32.png" width="800"/>
    </p>
    <p class="img-center">
     <img alt="" height="778" src="https://i-blog.csdnimg.cn/direct/b6e16938916e48408db1c865d5e07460.png" width="810"/>
    </p>
    <h3 id="4.%E6%8C%89%E9%94%AE%E6%8E%A7%E5%88%B6%E9%A2%91%E7%8E%87%E7%9A%84%E5%8A%A8%E6%80%81%E9%97%AA%E7%83%81%C2%A0%20%C2%A0%C2%A0" name="4.%E6%8C%89%E9%94%AE%E6%8E%A7%E5%88%B6%E9%A2%91%E7%8E%87%E7%9A%84%E5%8A%A8%E6%80%81%E9%97%AA%E7%83%81%C2%A0%20%C2%A0%C2%A0">
     4.按键控制频率的动态闪烁
    </h3>
    <p>
     以16位定时器模式工作，按下不同的按键，使LED灯分别按照1s,500ms,200ms,100ms动态闪烁
    </p>
    <p>
     <img alt="" class="left" height="729" src="https://i-blog.csdnimg.cn/direct/3a477446de3e4b329b23031619edc935.png" width="562"/>
    </p>
    <p>
     <img alt="" class="left" height="231" src="https://i-blog.csdnimg.cn/direct/ef50fb07fdaa482195095cb95dc2a8f0.png" width="514"/>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323330315f37393839353534312f:61727469636c652f64657461696c732f313436323536323836" class_="artid" style="display:none">
 </p>
</div>


