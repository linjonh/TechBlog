---
layout: post
title: "é€šè¿‡IDEAå†™ä¸€ä¸ªæœåŠ¡ç«¯å’Œä¸€ä¸ªå®¢æˆ·ç«¯ä¹‹é—´çš„äº¤äº’"
date: 2025-09-03T10:51:47+0800
description: "WebSocketConfigä»£ç MessageHandlerä»£ç HufamessagedemoApplicationä»£ç ã€‚"
keywords: "é€šè¿‡IDEAå†™ä¸€ä¸ªæœåŠ¡ç«¯å’Œä¸€ä¸ªå®¢æˆ·ç«¯ä¹‹é—´çš„äº¤äº’"
categories: ['æœªåˆ†ç±»']
tags: ['Java', 'Idea', 'Ide']
artid: "151141141"
arturl: "https://blog.csdn.net/hashiqimiya/article/details/151141141"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=151141141
    alt: "é€šè¿‡IDEAå†™ä¸€ä¸ªæœåŠ¡ç«¯å’Œä¸€ä¸ªå®¢æˆ·ç«¯ä¹‹é—´çš„äº¤äº’"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=151141141
featuredImagePreview: https://bing.ee123.net/img/rand?artid=151141141
cover: https://bing.ee123.net/img/rand?artid=151141141
image: https://bing.ee123.net/img/rand?artid=151141141
img: https://bing.ee123.net/img/rand?artid=151141141
---



# é€šè¿‡IDEAå†™ä¸€ä¸ªæœåŠ¡ç«¯å’Œä¸€ä¸ªå®¢æˆ·ç«¯ä¹‹é—´çš„äº¤äº’

## æœåŠ¡ç«¯ä»£ç ï¼š

WebSocketConfigä»£ç 

```

package org.example.hufamessagedemo;


import org.springframework.context.annotation.Configuration;
import org.springframework.web.socket.config.annotation.*;

@Configuration
@EnableWebSocket
public class WebSocketConfig implements WebSocketConfigurer {
    @Override
    public void registerWebSocketHandlers(WebSocketHandlerRegistry registry) {
        registry.addHandler(new MessageHandler(), "/ws")
                .setAllowedOrigins("*"); // å…è®¸æ‰€æœ‰å®¢æˆ·ç«¯è·¨åŸŸè¿æ¥
    }
}

```

```

MessageHandlerä»£ç 
```

```

package org.example.hufamessagedemo;

import org.springframework.web.socket.*;
import org.springframework.web.socket.handler.TextWebSocketHandler;

import java.util.concurrent.CopyOnWriteArrayList;

public class MessageHandler extends TextWebSocketHandler {
    private static final CopyOnWriteArrayList<WebSocketSession> sessions = new CopyOnWriteArrayList<>();

    @Override
    public void afterConnectionEstablished(WebSocketSession session) {
        sessions.add(session);
        System.out.println("æ–°å®¢æˆ·ç«¯è¿æ¥: " + session.getId());
    }

    @Override
    protected void handleTextMessage(WebSocketSession session, TextMessage message) throws Exception {
        System.out.println("æ”¶åˆ°æ¶ˆæ¯: " + message.getPayload());
        // å¹¿æ’­ç»™æ‰€æœ‰å®¢æˆ·ç«¯
        for (WebSocketSession s : sessions) {
            if (s.isOpen()) {
                s.sendMessage(new TextMessage("ç”¨æˆ·" + session.getId() + ": " + message.getPayload()));
            }
        }
    }

    @Override
    public void afterConnectionClosed(WebSocketSession session, CloseStatus status) {
        sessions.remove(session);
        System.out.println("å®¢æˆ·ç«¯æ–­å¼€: " + session.getId());
    }
}

```

```

HufamessagedemoApplicationä»£ç 

```

```

package org.example.hufamessagedemo;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class HufamessagedemoApplication {

    public static void main(String[] args) {
        SpringApplication.run(HufamessagedemoApplication.class, args);
    }

}

```

pom.xmlä»£ç å¦‚ä¸‹ï¼š

```

<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>3.5.5</version>
        <relativePath/> <!-- lookup parent from repository -->
    </parent>
    <groupId>org.example</groupId>
    <artifactId>hufamessagedemo</artifactId>
    <version>0.0.1-SNAPSHOT</version>
    <name>hufamessagedemo</name>
    <description>hufamessagedemo</description>
    <url/>
    <licenses>
        <license/>
    </licenses>
    <developers>
        <developer/>
    </developers>
    <scm>
        <connection/>
        <developerConnection/>
        <tag/>
        <url/>
    </scm>
    <properties>
        <java.version>17</java.version>
    </properties>
    <dependencies>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter</artifactId>
        </dependency>

        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-test</artifactId>
            <scope>test</scope>
        </dependency>

        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-websocket</artifactId>
        </dependency>






    </dependencies>

    <build>
        <plugins>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
            </plugin>
        </plugins>
    </build>

</project>

```

## å®¢æˆ·ç«¯ä»£ç ï¼š

```

DemoApplicationä»£ç 
```

```

package com.example.demo;

import org.springframework.boot.CommandLineRunner;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.web.socket.TextMessage;
import org.springframework.web.socket.WebSocketHandler;
import org.springframework.web.socket.WebSocketHttpHeaders;
import org.springframework.web.socket.WebSocketSession;
import org.springframework.web.socket.client.WebSocketClient;
import org.springframework.web.socket.client.standard.StandardWebSocketClient;
import org.springframework.web.socket.handler.TextWebSocketHandler;


import java.net.URI;



@SpringBootApplication
public class DemoApplication implements CommandLineRunner{

    public static void main(String[] args) {
        SpringApplication.run(DemoApplication.class, args);
    }

    @Override
    public void run(String... args) throws Exception {
        WebSocketClient client = new StandardWebSocketClient();

        WebSocketHandler handler = new TextWebSocketHandler() {
            @Override
            public void afterConnectionEstablished(WebSocketSession session) throws Exception {
                System.out.println("âœ… å·²è¿æ¥åˆ°æœåŠ¡ç«¯");
                session.sendMessage(new TextMessage("ä½ å¥½ï¼Œæˆ‘æ˜¯å®¢æˆ·ç«¯ï¼"));
            }

            @Override
            protected void handleTextMessage(WebSocketSession session, TextMessage message) {
                System.out.println("ğŸ“© æ”¶åˆ°æœåŠ¡ç«¯æ¶ˆæ¯: " + message.getPayload());
            }
        };

        WebSocketHttpHeaders headers = new WebSocketHttpHeaders();

        // è¿™é‡Œä¼  handlerã€headersã€URI
        WebSocketSession session = client.execute(handler, headers, URI.create("ws://localhost:8080/ws")).get();

        // å†å‘ä¸€æ¡æ¶ˆæ¯
        session.sendMessage(new TextMessage("ç¬¬äºŒæ¡æ¶ˆæ¯ from client"));
    }
}


```

pom.xmlä»£ç å¦‚ä¸‹ï¼š

```

<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>3.5.5</version>
        <relativePath/> <!-- lookup parent from repository -->
    </parent>
    <groupId>org.example</groupId>
    <artifactId>demo</artifactId>
    <version>0.0.1-SNAPSHOT</version>
    <name>demo</name>
    <description>demo</description>
    <url/>
    <licenses>
        <license/>
    </licenses>
    <developers>
        <developer/>
    </developers>
    <scm>
        <connection/>
        <developerConnection/>
        <tag/>
        <url/>
    </scm>
    <properties>
        <java.version>17</java.version>
    </properties>
    <dependencies>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter</artifactId>
        </dependency>

        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-test</artifactId>
            <scope>test</scope>
        </dependency>


        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-websocket</artifactId>
        </dependency>


        <dependency>
            <groupId>org.glassfish.tyrus.bundles</groupId>
            <artifactId>tyrus-standalone-client</artifactId>
            <version>2.1.3</version>
        </dependency>

    </dependencies>

    <build>
        <plugins>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
            </plugin>
        </plugins>
    </build>

</project>

```

å®¢æˆ·ç«¯ç«¯å£8081ï¼ŒæœåŠ¡ç«¯ç«¯å£8080.

## æ•ˆæœå›¾ï¼š

![](https://i-blog.csdnimg.cn/direct/c368361989914f718f4b90c951d7e707.png)

![](https://i-blog.csdnimg.cn/direct/18ac597a9aa34caa844a0ff983f446bb.png)



