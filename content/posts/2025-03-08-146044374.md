---
layout: post
title: "upload-labs文件上传"
date: 2025-03-08 11:18:21 +0800
description: "上传一个1.jpg的文件，在里面写好一句webshell保留一个数据包，将其中截获的1.jpg改为1.php后重新发送可以看到，已经成功上传。"
keywords: "upload-labs文件上传"
categories: ['未分类']
tags: ['安全']
artid: "146044374"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146044374
    alt: "upload-labs文件上传"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146044374
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146044374
cover: https://bing.ee123.net/img/rand?artid=146044374
image: https://bing.ee123.net/img/rand?artid=146044374
img: https://bing.ee123.net/img/rand?artid=146044374
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     upload-labs文件上传
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h2>
     第一关
    </h2>
    <p>
     上传一个1.jpg的文件，在里面写好一句webshell
    </p>
    <p>
     <img alt="" height="437" src="https://i-blog.csdnimg.cn/direct/fbf8e4db499a433e94539ceb89bfd6d4.png" width="921"/>
    </p>
    <p>
     保留一个数据包，将其中截获的1.jpg改为1.php后重新发送
    </p>
    <p>
     <img alt="" height="792" src="https://i-blog.csdnimg.cn/direct/eab7677733734a0f9d3b74a154addb5b.png" width="1872"/>
    </p>
    <p>
     可以看到，已经成功上传
    </p>
    <p>
     <img alt="" height="352" src="https://i-blog.csdnimg.cn/direct/a3a631eddbb54317a5c135c37fc2ad28.png" width="857"/>
    </p>
    <h2>
     第二关
    </h2>
    <p>
     写一个webshell如图，为2.php
    </p>
    <p>
     <img alt="" height="140" src="https://i-blog.csdnimg.cn/direct/ae6725d5dc0445b498834cfd4424b0f4.png" width="651"/>
    </p>
    <p>
     <img alt="" height="412" src="https://i-blog.csdnimg.cn/direct/34659c8378af4b409d5210161f210aa7.png" width="1321"/>
    </p>
    <p>
     第二关在过滤tpye的属性，在上传2.php后使用burp suite抓包，将其type属性那一栏改为image/jpeg即可上传
    </p>
    <p>
     <img alt="" height="595" src="https://i-blog.csdnimg.cn/direct/e4807b28f9e5447c973f8ef7c33ee65c.png" width="1640"/>
    </p>
    <p>
     使用蚁剑连接该webshell，成功
    </p>
    <p>
     <img alt="" height="240" src="https://i-blog.csdnimg.cn/direct/0cf922d5f48b4c56836cdd9cad344ede.png" width="1261"/>
    </p>
    <h2>
     第三关
    </h2>
    <p>
     由源代码可以看到，该关过滤了文件名，也是通过burp suite抓包进行解决
    </p>
    <p>
     <img alt="" height="401" src="https://i-blog.csdnimg.cn/direct/b4dfed97b93942f2a5b989a644c4d052.png" width="1332"/>
    </p>
    <p>
     这里使用到windows自带的一个特性，可以在文件名后加"."或一个数字进行上传
    </p>
    <p>
     <img alt="" height="547" src="https://i-blog.csdnimg.cn/direct/63c5ad44b7104c54847d8667ada1ce8d.png" width="1790"/>
    </p>
    <p>
     访问该文件，可以看到，已经上传成功
    </p>
    <p>
     <img alt="" height="154" src="https://i-blog.csdnimg.cn/direct/27f11974a8b5463994747848bd6537db.png" width="667"/>
    </p>
    <h2>
     第四关
    </h2>
    <p>
     <img alt="" height="292" src="https://i-blog.csdnimg.cn/direct/7151766c3eb04b8298c0ca141f80e567.png" width="847"/>
    </p>
    <p>
     将httpd.conf中AllowOverride改为All
    </p>
    <p>
     <img alt="" height="184" src="https://i-blog.csdnimg.cn/direct/246f4d8e6aec48fe8764c7765cd4ad5f.png" width="1336"/>
    </p>
    <p>
     该关在过滤文件后缀，可以利用.htaccess这个文件进行上传
    </p>
    <p>
     <img alt="" height="114" src="https://i-blog.csdnimg.cn/direct/9c50b5c194c74f51a0c0146b0e300816.png" width="360"/>
    </p>
    <p>
     在里面写入这样的代码，可以将上传的info.jpg使用php进行解析
    </p>
    <p>
     在上传一个写有webshell的info.jpg图片，可以完成本关
    </p>
    <h2>
     第五关
    </h2>
    <p>
     使用”. .“绕过
    </p>
    <p>
     先使用1.php上传，使用burp suite抓包，修改为1.php. .即可上传成功
    </p>
    <p>
     <img alt="" height="526" src="https://i-blog.csdnimg.cn/direct/05bfbbb45e7048a28961a248c0a72650.png" width="1360"/>
    </p>
    <p>
     <img alt="" height="739" src="https://i-blog.csdnimg.cn/direct/4f899865e803406babfc668fd591ea42.png" width="1356"/>
    </p>
    <h2>
     第六关
    </h2>
    <p>
     观察代码可以看出，相比前面几关，并未对大小写进行过滤
    </p>
    <p>
     <img alt="" height="389" src="https://i-blog.csdnimg.cn/direct/41bbda962d74489484646e77cbe899c6.png" width="1342"/>
    </p>
    <p>
     使用burp suite进行抓包，将其改为1.phP即可成功上传
    </p>
    <p>
     <img alt="" height="530" src="https://i-blog.csdnimg.cn/direct/e113d800e1114a6db804fa36af506aa5.png" width="1440"/>
    </p>
    <h2>
     第七关
    </h2>
    <p>
     观察可以看出
    </p>
    <p>
     <img alt="" height="65" src="https://i-blog.csdnimg.cn/direct/d3ed7a95bb2842fb8df4f5d1fa58e489.png" width="747"/>
    </p>
    <p>
     少了一个trim函数，可以使用空格绕过
    </p>
    <p>
     <img alt="" height="531" src="https://i-blog.csdnimg.cn/direct/f41427d0867e49e3873722602a851886.png" width="1479"/>
    </p>
    <p>
     结果成功
    </p>
    <p>
     <img alt="" height="567" src="https://i-blog.csdnimg.cn/direct/bc9061f208384d0087c2bf252d891b33.png" width="1349"/>
    </p>
    <h2>
     第八关
    </h2>
    <p>
     观察代码可以看出，并未对后面的“.”进行过滤，可以使用“.”绕过
    </p>
    <p>
     同样使用burp suite改包实现
    </p>
    <p>
     <img alt="" height="549" src="https://i-blog.csdnimg.cn/direct/3809fa1291dd4c8abfe6bb6836eb12d1.png" width="1476"/>
    </p>
    <h2>
     第九关
    </h2>
    <p>
     观察代码，本关并未对“::$DATA”这个符号进行过滤，使用“::$DATA”绕过
    </p>
    <p>
     <img alt="" height="41" src="https://i-blog.csdnimg.cn/direct/3844acbadfe6483e84bf24c5224807b5.png" width="1105"/>
    </p>
    <p>
     <img alt="" height="494" src="https://i-blog.csdnimg.cn/direct/9866727186944d28ba171bed4e656001.png" width="1481"/>
    </p>
    <h2>
     第十关
    </h2>
    <p>
     与第五关一样，使用“. .”绕过
    </p>
    <p>
     <img alt="" height="542" src="https://i-blog.csdnimg.cn/direct/5360061df399406282c7f840efe36fbf.png" width="1484"/>
    </p>
    <h2>
     第十一关
    </h2>
    <p>
     该关过滤文件后缀，当文件后缀匹配上$deny_ext中的后缀时，进行删除，所以通过写两个相同的字符进行绕过
    </p>
    <p>
     <img alt="" height="520" src="https://i-blog.csdnimg.cn/direct/088e641c4a7e41b697b1bcbce859a789.png" width="1325"/>
    </p>
    <p>
     <img alt="" height="511" src="https://i-blog.csdnimg.cn/direct/34a22002dc934ff7a1567d133b95c57b.png" width="1400"/>
    </p>
    <h2 style="background-color:transparent">
     第十二、十三关
    </h2>
    <p>
     使用%00截断来进行绕过
    </p>
    <p>
     <img alt="" height="542" src="https://i-blog.csdnimg.cn/direct/bd1bd4fe561d4bef8874d7cec1e5a278.png" width="1476"/>
    </p>
    <p>
     因为我的php版本为5.6.9，所以并未绕过成功，需要php5.3.29以下的版本
    </p>
    <h2>
     第十四、十五、十六关
    </h2>
    <p>
     上传一个图片马，并使用文件包含进行访问
    </p>
    <p>
     在windows下使用copy 3.jpg /b + 2.php /a shell.jpg制作一个图片马，直接上传后进行文件包含
    </p>
    <p>
     <img alt="" height="822" src="https://i-blog.csdnimg.cn/direct/2f4226ef19534b6294adcd559123b7ac.png" width="1591"/>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323230315f37353637373637372f:61727469636c652f64657461696c732f313436303434333734" class_="artid" style="display:none">
 </p>
</div>


