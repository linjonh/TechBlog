---
layout: post
title: "2数据库的基础学习中分组查询连接查询-有小例子"
date: 2025-03-07 18:55:01 +0800
description: "​\t\t按年代分： sql 92 标准：仅支持内连接；sql 99 标准（推荐）：内连接+外连接（左外和右外）+交叉连接。​\t\t2、group by 子句支持单个字段分组，多个字段分组（多个字段之间用逗号隔开没有顺序要求），表达式或函数（用的较少）​\t\t\tsum 、avg、min、max、count （以上分组函数都忽略 null 值）忽略 null 值。​\t\t分组后筛选\t\t分组后的结果表\t\t\tgroup by 字句的后面\t\t\t having。又称：多表查询，当查询到的字段来自多个表时，需要用到连接查询。"
keywords: "2、数据库的基础学习（中）：分组查询、连接查询 有小例子"
categories: ['未分类']
tags: ['学习', 'Sql']
artid: "146102826"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146102826
    alt: "2数据库的基础学习中分组查询连接查询-有小例子"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146102826
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146102826
cover: https://bing.ee123.net/img/rand?artid=146102826
image: https://bing.ee123.net/img/rand?artid=146102826
img: https://bing.ee123.net/img/rand?artid=146102826
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     2、数据库的基础学习（中）：分组查询、连接查询 有小例子
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h5>
     <a id="_0">
     </a>
     二、分组函数
    </h5>
    <hr/>
    <p>
     功能：用作统计使用，又称为聚合函数或者统计函数或组函数
    </p>
    <p>
     1、分类：
    </p>
    <p>
     sum 求和、avg 平均值、max最大值、min 最小值、count 计算个数
    </p>
    <p>
     2、参数支持哪些类型
    </p>
    <p>
     ​ Sum\avg 一般处理数值型数据
    </p>
    <p>
     ​ max、min 可以数值型也可以字符型
    </p>
    <p>
     ​ count 基本上都可以处理
    </p>
    <p>
     ​
     <strong>
      是否忽略 null 值
     </strong>
    </p>
    <p>
     ​ sum 、avg、min、max、count （以上分组函数都忽略 null 值）忽略 null 值
    </p>
    <p>
     3、可以和DISTINCT 搭配
    </p>
    <p>
     <strong>
      <u>
       4、count 函数的详细介绍
      </u>
     </strong>
    </p>
    <p>
     ​ SELECT count（*） from employees 统计 employees 表里面的行数
    </p>
    <p>
     ​ select count（1） from employees 也是统计 employees 表中的行数
    </p>
    <p>
     效率：MYISAM存储引擎下，count（*）效率高 INNODB 存储引擎下，两者效率接近
    </p>
    <p>
     5、和分组函数一同查询的字段有限制
    </p>
    <p>
     <font color="red">
      和分组函数一同查询的字段要求是 groups by 后的字段
     </font>
    </p>
    <p>
     小例题：
    </p>
    <pre><code class="prism language-sql"><span class="token comment">-- 查询员工表中的最大入职时间和最小入职时间的相差天数</span>
<span class="token keyword">select</span> datediff<span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span>hiredate<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>hiredate<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> DIFFERENCE 
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>

<span class="token comment">-- 查询部门编号为 90 的员工个数</span>
<span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> department_id<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     其中 datediff()为求两日期间的差值的函数
    </p>
    <hr/>
    <h4>
     <a id="_59">
     </a>
     三、分组查询
    </h4>
    <p>
     引入：查询每个部门的平均工资
    </p>
    <p>
     语法：
    </p>
    <p>
     ​ SELECT 分组函数,列（要求出现在 group by 的后面）
    </p>
    <p>
     ​ from 表
    </p>
    <p>
     ​ 【where 筛选条件】
    </p>
    <p>
     ​ group by 分组的列表
    </p>
    <p>
     ​ 【order by 字句】
    </p>
    <p>
     注意：查询列表必须特殊，要求是分组函数和 group by 后出现的字段
    </p>
    <pre><code class="prism language-sql"><span class="token comment">-- 查询邮箱中包含字符 a 的，每个部门的平均工资</span>
<span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span>department_id
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> email <span class="token operator">like</span> <span class="token string">'%a%'</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> department_id<span class="token punctuation">;</span>

<span class="token comment">-- 查询有奖金的每个领导手下员工的最高工资</span>
<span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span>manager_id
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> commission_pct <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">NULL</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> manager_id<span class="token punctuation">;</span>




<span class="token comment">-- 添加复杂的筛选条件</span>

<span class="token comment">-- 案例一 查询哪个部门的员工个数＞2</span>
<span class="token comment">-- 1️⃣查询每个部门的员工个数</span>
<span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>department_id
<span class="token keyword">from</span> employees
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id<span class="token punctuation">;</span>

<span class="token comment">-- 2️⃣根据1️⃣的结果进行筛选，查询哪个部门的员工个数大于 2  使用 having 进行连接</span>
<span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>department_id
<span class="token keyword">from</span> employees
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id
<span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">2</span><span class="token punctuation">;</span>

<span class="token comment">-- 案例二：查询每个工种有奖金的员工的最高工资大于 12000 的工种编号和最高工资</span>
<span class="token keyword">select</span> job_id<span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> commission_pct <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> job_id
<span class="token keyword">having</span> <span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">12000</span> <span class="token punctuation">;</span>


<span class="token comment">-- 案例三：查询领导编号&gt;102 的每个领导手下的最低工资＞5000 的领导编号，以及其最低工资</span>
<span class="token keyword">SELECT</span> <span class="token function">min</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span>manager_id
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> manager_id<span class="token operator">&gt;</span><span class="token number">102</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> manager_id
<span class="token keyword">having</span> <span class="token function">min</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">5000</span><span class="token punctuation">;</span>
<span class="token comment">-- 注意这个 group by 别顺手写出 order by了 不然找半天都找不到问题 作者在 navicat 一阵快捷键 弄错了没发现 找半天才找到问题</span>

<span class="token comment">-- 按多个字段分组查询</span>
<span class="token comment">-- 案例：查询每个部门每个工种的员工的平均工资</span>
<span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span>department_id<span class="token punctuation">,</span>job_id
<span class="token keyword">from</span> employees
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id<span class="token punctuation">,</span>job_id<span class="token punctuation">;</span>

</code></pre>
    <p>
     <u>
      <strong>
       特点
      </strong>
     </u>
     ：
    </p>
    <p>
     ​ 1、分组查询中的筛选条件分为两类
    </p>
    <p>
     ​ 数据源 位置 关键字
    </p>
    <p>
     ​ 分组前筛选 原始表 group by 字句的前面 where
    </p>
    <p>
     ​ 分组后筛选 分组后的结果表 group by 字句的后面 having
    </p>
    <p>
     <font color="red">
      分组函数做条件 肯定是放在 having 字句中
     </font>
    </p>
    <p>
     能用分组前筛选的，优先考虑使用分组查询
     <u>
      <strong>
       前
      </strong>
     </u>
     筛选
    </p>
    <p>
     ​ 2、group by 子句支持单个字段分组，多个字段分组（多个字段之间用逗号隔开没有顺序要求），表达式或函数（用的较少）
    </p>
    <p>
     ​ 3、也可以添加排序 排序是放在整个分组查询的最后
    </p>
    <hr/>
    <h4>
     <a id="_153">
     </a>
     四、连接查询
    </h4>
    <hr/>
    <p>
     又称：多表查询，当查询到的字段来自多个表时，需要用到连接查询
    </p>
    <p>
     笛卡尔乘积现象：表 1 有 m行，表 2 有 n 行，结果有 m*n 行
    </p>
    <p>
     ​ 发生原因：没有有效的连接条件
    </p>
    <p>
     ​ 如何 避免：添加有效的连接条件
    </p>
    <p>
     <strong>
      分类
     </strong>
     ：
    </p>
    <p>
     ​ 按年代分： sql 92 标准：仅支持内连接 ；； sql 99 标准（推荐）：内连接+外连接（左外和右外）+交叉连接
    </p>
    <p>
     ​
    </p>
    <p>
     ​ 按功能分类：
    </p>
    <p>
     ​ 内连接： 等值连接
    </p>
    <p>
     ​ 非等值连接
    </p>
    <p>
     ​ 自连接
    </p>
    <p>
     ​
    </p>
    <p>
     ​ 外连接：左外连接
    </p>
    <p>
     ​ 右外连接
    </p>
    <p>
     ​ 全外连接
    </p>
    <p>
     ​ 交叉连接
    </p>
    <p>
     <strong>
      为表起别名：提高语句的简洁度； 区分多个重名的字段
     </strong>
    </p>
    <p>
     <font color="red">
      注意：如果为表起了别名，则查询的字段就不能使用原来的表名去限定
     </font>
    </p>
    <hr/>
    <h5>
     <a id="ASql92__201">
     </a>
     <strong>
      A、Sql92 内连接
     </strong>
    </h5>
    <pre><code class="prism language-sql">
<span class="token comment">#一、sql192 标准</span>
<span class="token comment">#1、等值连接</span>
<span class="token comment">-- 案例一、查询女神名和对应的男神名</span>
<span class="token keyword">use</span> girls<span class="token punctuation">;</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span>boyName
<span class="token keyword">from</span> beauty<span class="token punctuation">,</span>boys
<span class="token keyword">where</span> beauty<span class="token punctuation">.</span>boyfriend_id<span class="token operator">=</span>boys<span class="token punctuation">.</span>id<span class="token punctuation">;</span>

<span class="token comment">-- 案例二、查询员工名和对应的部门名</span>
<span class="token keyword">use</span> myemployees<span class="token punctuation">;</span>
<span class="token keyword">select</span> last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">from</span> employees<span class="token punctuation">,</span>departments
<span class="token keyword">where</span> employees<span class="token punctuation">.</span>department_id<span class="token operator">=</span>departments<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>

<span class="token comment">-- 查询城市名中第二个字符为 o 的部门名和城市名</span>
<span class="token keyword">select</span> department_name<span class="token punctuation">,</span>city
<span class="token keyword">from</span> departments d<span class="token punctuation">,</span>locations l
<span class="token keyword">where</span> d<span class="token punctuation">.</span>location_id<span class="token operator">=</span>l<span class="token punctuation">.</span>location_id
<span class="token operator">and</span> l<span class="token punctuation">.</span>city <span class="token operator">like</span> <span class="token string">'_o%'</span><span class="token punctuation">;</span>

<span class="token comment">-- 可以加分组不？？？</span>
<span class="token comment">-- 案例： 查询每个城市的部门个数</span>
<span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> 个数<span class="token punctuation">,</span>city 
<span class="token keyword">from</span> departments d<span class="token punctuation">,</span>locations l
<span class="token keyword">where</span> d<span class="token punctuation">.</span>location_id<span class="token operator">=</span>l<span class="token punctuation">.</span>location_id
<span class="token keyword">group</span> <span class="token keyword">by</span> city<span class="token punctuation">;</span>

<span class="token comment">-- 案例二：查询有奖金的每个部门的部门名和部门的领导编号以及该部门的最低工资</span>
<span class="token keyword">select</span> department_name<span class="token punctuation">,</span>e<span class="token punctuation">.</span>manager_id<span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">from</span> departments d<span class="token punctuation">,</span>employees e
<span class="token keyword">where</span> d<span class="token punctuation">.</span>department_id<span class="token operator">=</span>e<span class="token punctuation">.</span>department_id
<span class="token operator">and</span> e<span class="token punctuation">.</span>commission_pct <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> d<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span>e<span class="token punctuation">.</span>manager_id<span class="token punctuation">;</span>

<span class="token comment">#2、非等值连接</span>
<span class="token comment">-- 案例：查询员工的</span>
<span class="token keyword">SELECT</span> salary<span class="token punctuation">,</span>grade_level
<span class="token keyword">from</span> employees e<span class="token punctuation">,</span>job_grades j
<span class="token keyword">where</span>  salary <span class="token operator">between</span> j<span class="token punctuation">.</span>lowest_sal <span class="token operator">and</span> j<span class="token punctuation">.</span>highest_sal<span class="token punctuation">;</span>

<span class="token comment">#3、自连接</span>
<span class="token comment">#案例：查询 员工名和上级的名称</span>
<span class="token keyword">select</span> e<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span>e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>m<span class="token punctuation">.</span>manager_id<span class="token punctuation">,</span>m<span class="token punctuation">.</span>last_name
<span class="token keyword">from</span> employees e<span class="token punctuation">,</span>employees m
<span class="token keyword">where</span>  e<span class="token punctuation">.</span>employee_id<span class="token operator">=</span>m<span class="token punctuation">.</span>manager_id<span class="token punctuation">;</span>


</code></pre>
    <hr/>
    <h5>
     <a id="Bsql99_256">
     </a>
     B、sql99语法
    </h5>
    <p>
     语法：
    </p>
    <p>
     ​ select 查询列表
    </p>
    <p>
     ​ from 表1 别名 【连接类型】
    </p>
    <p>
     ​ join 表2 别名
    </p>
    <p>
     ​ on 连接条件
    </p>
    <p>
     ​ 【where 筛选条件】
    </p>
    <p>
     ​ 【group by 分组】
    </p>
    <p>
     ​ 【having筛选条件】
    </p>
    <p>
     ​ 【order by 排序】
    </p>
    <p>
     分类
    </p>
    <p>
     ​ 内连接： 连接类型关键字 inner
    </p>
    <p>
     ​ 外连接：左外连接：left 【outer】（outer 可以省略）
    </p>
    <p>
     ​ 右外连接 right 【outer】
    </p>
    <p>
     ​ 全外连接：full 【outer】
    </p>
    <p>
     ​ 交叉连接：cross
    </p>
    <p>
     <strong>
      <u>
       sql99 的 内连接
      </u>
     </strong>
    </p>
    <pre><code class="prism language-sql"><span class="token comment"># 二、sql 99 语法</span>
<span class="token comment">/*
	
*/</span>
<span class="token comment">#1、等值连接</span>
<span class="token comment">-- 案例一：查询员工名、部门名</span>
<span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name
<span class="token keyword">from</span> employees e
<span class="token keyword">inner</span> <span class="token keyword">JOIN</span> departments d
<span class="token keyword">on</span> e<span class="token punctuation">.</span>department_id<span class="token operator">=</span>d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>

<span class="token comment">-- 案例二：查询名字中包含 e 的员工名和工种名（添加筛选）</span>
<span class="token keyword">select</span> last_name<span class="token punctuation">,</span>job_title
<span class="token keyword">from</span> employees e
<span class="token keyword">inner</span> <span class="token keyword">join</span> jobs j
<span class="token keyword">on</span> j<span class="token punctuation">.</span>job_id<span class="token operator">=</span>e<span class="token punctuation">.</span>job_id
<span class="token keyword">where</span> e<span class="token punctuation">.</span>last_name <span class="token operator">like</span> <span class="token string">'%e%'</span><span class="token punctuation">;</span>

<span class="token comment">-- 案例三：查询部门个数&gt;3 的城市名和部门个数 （添加分组和筛选）</span>
<span class="token comment">-- 下面这个建议看看 自己做的时候老是有点问题</span>
<span class="token keyword">select</span> city<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token keyword">from</span> departments d
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> locations l
<span class="token keyword">on</span> l<span class="token punctuation">.</span>location_id<span class="token operator">=</span>d<span class="token punctuation">.</span>location_id
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> city
<span class="token keyword">HAVING</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">3</span><span class="token punctuation">;</span>


<span class="token comment">-- 案例四：查询哪个部门的员工个数&gt;3 的部门名和员工个数，并按个数降序（添加排序）</span>
<span class="token keyword">select</span> department_name<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> 员工个数
<span class="token keyword">from</span> departments
<span class="token keyword">inner</span> <span class="token keyword">join</span> employees
<span class="token keyword">on</span> departments<span class="token punctuation">.</span>department_id<span class="token operator">=</span>employees<span class="token punctuation">.</span>department_id
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_name
<span class="token keyword">having</span>  <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">3</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">desc</span><span class="token punctuation">;</span>

<span class="token comment">-- 案例五：查询员工名、部门名、工种名，并且按照部门名称降序</span>
<span class="token comment">-- 注意看三表链接的格式</span>
<span class="token keyword">select</span> last_name<span class="token punctuation">,</span>department_name<span class="token punctuation">,</span>job_title
<span class="token keyword">from</span> employees
<span class="token keyword">inner</span> <span class="token keyword">join</span> departments <span class="token keyword">on</span> employees<span class="token punctuation">.</span>department_id<span class="token operator">=</span>departments<span class="token punctuation">.</span>department_id
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> jobs <span class="token keyword">on</span> employees<span class="token punctuation">.</span>job_id<span class="token operator">=</span>jobs<span class="token punctuation">.</span>job_id
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> department_name <span class="token keyword">desc</span><span class="token punctuation">;</span>

<span class="token comment">#2、非等值连接</span>
<span class="token comment">-- 案例一：查询员工的工资级别</span>
<span class="token keyword">SELECT</span> salary<span class="token punctuation">,</span>grade_level
<span class="token keyword">from</span> employees e
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> job_grades g
<span class="token keyword">on</span> e<span class="token punctuation">.</span>salary <span class="token operator">between</span> g<span class="token punctuation">.</span>lowest_sal <span class="token operator">and</span> g<span class="token punctuation">.</span>highest_sal<span class="token punctuation">;</span>
<span class="token comment">-- 案例二：查询每个工资级别的个数&gt;20的个数，并且按工资级别降序</span>
<span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>grade_level
<span class="token keyword">from</span> employees e
<span class="token keyword">inner</span> <span class="token keyword">join</span> job_grades g
<span class="token keyword">on</span> e<span class="token punctuation">.</span>salary <span class="token operator">between</span> g<span class="token punctuation">.</span>lowest_sal <span class="token operator">and</span> g<span class="token punctuation">.</span>highest_sal
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> grade_level
<span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">20</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">desc</span><span class="token punctuation">;</span>

<span class="token comment">#3、自连接</span>
<span class="token comment">-- 案例；查询员工的名字、上级的名字</span>
<span class="token keyword">select</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>m<span class="token punctuation">.</span>last_name
<span class="token keyword">from</span> employees e
<span class="token keyword">inner</span> <span class="token keyword">join</span> employees m
<span class="token keyword">on</span> e<span class="token punctuation">.</span>manager_id<span class="token operator">=</span>m<span class="token punctuation">.</span>employee_id<span class="token punctuation">;</span>

</code></pre>
    <p>
     特点：1、添加排序、分组、筛选
    </p>
    <p>
     2、inner可以省略
    </p>
    <p>
     3、筛选条件放在where后面，连接条件放在on后面，提高分离性，便于阅读
    </p>
    <p>
     4、inner join连接与sql92的等值连接效果是一样的
    </p>
    <p>
     <font color="red">
      having一般用于有分组的筛选条件
     </font>
    </p>
    <p>
     <strong>
      <u>
       sql 99 外连接
      </u>
     </strong>
    </p>
    <pre><code class="prism language-sql"><span class="token comment">#二、外连接</span>
<span class="token comment">-- 应用 场景：查询一个表中有，另一个表中没有的记录</span>
<span class="token comment">/*

特点：
1、外连接的查询结果为主表中的所有记录
	如果从表中有和它匹配的，则显示匹配的值
	如果从表中梅雨欧和它匹配的，则显示 null 值
	外连接查询结果=内连接结果+主表中有而从表中没有的记录
2、左外连接，left join 左边是主表
3、右外连接，right join 右边是主表
4、左外和右外交换两个表顺序，则可以实现同样的效果

5、外连接：=内连接的结果+表 1 中有但表 2 没有的+表 2 中有但表 1 没有的
*/</span>
<span class="token comment">-- 案例一： 查询男朋友不在男神表的女神名  （左外连接）</span>
<span class="token keyword">use</span> girls<span class="token punctuation">;</span>
<span class="token keyword">select</span> b<span class="token punctuation">.</span>name
<span class="token keyword">from</span> beauty b
<span class="token keyword">left</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> boys bo
<span class="token keyword">on</span> b<span class="token punctuation">.</span>boyfriend_id<span class="token operator">=</span>bo<span class="token punctuation">.</span>id
<span class="token keyword">where</span> bo<span class="token punctuation">.</span>id <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">;</span>

<span class="token comment">-- 案例二：查询哪个部门没有员工</span>
<span class="token keyword">use</span> myemployees<span class="token punctuation">;</span>
<span class="token keyword">select</span> d<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span>e<span class="token punctuation">.</span>department_id
<span class="token keyword">from</span> departments d
<span class="token keyword">left</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> employees e
<span class="token keyword">on</span> d<span class="token punctuation">.</span>department_id<span class="token operator">=</span>e<span class="token punctuation">.</span>department_id
<span class="token keyword">where</span> e<span class="token punctuation">.</span>employee_id <span class="token operator">is</span> <span class="token boolean">null</span><span class="token punctuation">;</span>



</code></pre>
    <p>
     <strong>
      <u>
       sql99 交叉连接
      </u>
     </strong>
    </p>
    <pre><code class="prism language-sql"><span class="token comment">#交叉连接  相当于笛卡尔乘积</span>
<span class="token keyword">SELECT</span> b<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>bo<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">from</span> beauty b
<span class="token keyword">cross</span> <span class="token keyword">join</span> boys bo<span class="token punctuation">;</span>
</code></pre>
    <p>
     <u>
      子查询
     </u>
    </p>
    <pre><code class="prism language-sql"><span class="token comment"># 子查询： 出现在其他语句中的select 语句 称为子查询或内查询</span>
<span class="token comment">/*
分类：
	按子查询出现的位置：
				select 后面	： 仅仅支持标量子查询
									
				from 后面		：	支持表子查询
				
（**重要的**）where 或 having 后面		：标量子查询、列子查询、行子查询
				
				exists 后面		：表 子查询
	按结果集的行列数不同分：
				标量子查询（结果集只有一行一列）
				列子查询（结果集只有一列多行）
				行子查询（结果集有一行多列）
				表子查询（一般为多行多列）
*/</span>
<span class="token comment">#一、where 或 having 后面</span>
	<span class="token comment">-- 1、标量子查询（单行子查询）</span>
	<span class="token comment">-- 2、列子查询（多行子查询）</span>
	<span class="token comment">-- 3、行子查询（多行多列）</span>
	<span class="token comment">/*
		特点：
		子查询放在小括号内
		子查询一般放在条件的右侧
		标量子查询，一般搭配着单行操作符使用
		&gt;&lt; &gt;= &lt;=  &lt;&gt;
		列子查询，一般搭配着多行操作符使用： in、any/some、all
		子查询执行顺序优于主查询
	
	*/</span>
	<span class="token comment">#1、标量子查询</span>
	<span class="token comment">-- 案例一：谁的工资比 Abel 高</span>
	<span class="token comment">-- 第一步： 先查询 abel 工资</span>
<span class="token keyword">select</span> salary
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> last_name<span class="token operator">=</span><span class="token string">'Abel'</span><span class="token punctuation">;</span>
<span class="token comment">-- 第二步：查询员工的信息，满足 salary&gt;1 的结果</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> salary<span class="token operator">&gt;</span><span class="token punctuation">(</span>
			<span class="token keyword">select</span> salary
			<span class="token keyword">from</span> employees
			<span class="token keyword">where</span> last_name<span class="token operator">=</span><span class="token string">'Abel'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>		

<span class="token comment"># 案例二：返回 job_id 与 141 号员工相同，salary 比143号员工多的员工 姓名，job_id 和工资</span>
<span class="token comment">-- 第一步：查询 141 号员工的 job_id</span>
<span class="token keyword">select</span> job_id 
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> employee_id<span class="token operator">=</span><span class="token number">141</span>

<span class="token comment">-- 第二步：查询 143 号员工的工资</span>
<span class="token keyword">select</span> salary 
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> employee_id<span class="token operator">=</span><span class="token number">143</span>

<span class="token comment">-- 第三步 返回 job_id 与 141 号员工相同，salary 比143号员工多的员工 姓名，job_id 和工资</span>
<span class="token keyword">select</span> last_name<span class="token punctuation">,</span>job_id<span class="token punctuation">,</span>salary
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> job_id<span class="token operator">=</span><span class="token punctuation">(</span>
	<span class="token keyword">select</span> job_id 
	<span class="token keyword">from</span> employees
	<span class="token keyword">where</span> employee_id<span class="token operator">=</span><span class="token number">141</span>
	<span class="token punctuation">)</span>
 <span class="token operator">and</span> salary<span class="token operator">&gt;</span><span class="token punctuation">(</span>
		<span class="token keyword">select</span> salary 
		<span class="token keyword">from</span> employees
		<span class="token keyword">where</span> employee_id<span class="token operator">=</span><span class="token number">143</span>
		<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment"># 案例三：查询最低工资大于 50 号部门最低工资的部门 id 和其最低工资</span>
<span class="token comment">-- 第一步查询 50 号部门的最低工资</span>
<span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> department_id<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">;</span>
<span class="token comment">-- 第二步：查询每个部门的最低工资</span>
<span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">from</span> employees
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id；
<span class="token comment">-- 第三步：筛选 min（salary）&gt;1</span>
<span class="token keyword">select</span> department_id<span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token keyword">from</span> employees
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id
<span class="token keyword">HAVING</span> <span class="token function">min</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>
	<span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
	<span class="token keyword">from</span> employees
	<span class="token keyword">where</span> department_id<span class="token operator">=</span><span class="token number">50</span>
	<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#列子查询（多行子查询）</span>
<span class="token comment">/*
	使用多行比较操作符
		in/not in
		any|some
		all
*/</span>
<span class="token comment">--  案例一：返回 location_id 是 1400 或 1700 的部门中的所有员工姓名</span>
<span class="token comment">-- 第一步：查询 location_id 是 1400 或 1700de 部门编号</span>
<span class="token keyword">select</span> <span class="token keyword">distinct</span> department_id
<span class="token keyword">from</span> departments
<span class="token keyword">where</span> location_id <span class="token operator">in</span><span class="token punctuation">(</span><span class="token number">1400</span><span class="token punctuation">,</span><span class="token number">1700</span><span class="token punctuation">)</span>

<span class="token comment">-- 第二步 查询员工姓名，要求部门编号是 1 列表中的某一个</span>
<span class="token keyword">select</span> last_name
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> department_id <span class="token operator">in</span><span class="token punctuation">(</span>
	<span class="token keyword">select</span> <span class="token keyword">distinct</span> department_id
		<span class="token keyword">from</span> departments
		<span class="token keyword">where</span> location_id <span class="token operator">in</span><span class="token punctuation">(</span><span class="token number">1400</span><span class="token punctuation">,</span><span class="token number">1700</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#3、行 子查询（使用比较少 了解）</span>
<span class="token comment">-- 案例：查询员工编号最小并且工资最高的员工信息</span>
<span class="token comment">-- 第一步：查询最小的员工编号</span>
<span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>employee_id<span class="token punctuation">)</span>
<span class="token keyword">from</span> employees<span class="token punctuation">;</span>
<span class="token comment">-- 第二步：查询最高工资</span>
	<span class="token keyword">SELECT</span> <span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
	<span class="token keyword">from</span> 	employees

<span class="token comment">-- 第三步:查询员工信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> employee_id<span class="token operator">=</span><span class="token punctuation">(</span>
	<span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>employee_id<span class="token punctuation">)</span>
	<span class="token keyword">from</span> employees
<span class="token punctuation">)</span> <span class="token operator">and</span> salary<span class="token operator">=</span><span class="token punctuation">(</span>
	<span class="token keyword">SELECT</span> <span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
	<span class="token keyword">from</span> 	employees
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 行子查询的格式</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> employees
<span class="token keyword">where</span> <span class="token punctuation">(</span>employee_id<span class="token punctuation">,</span>salary<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span>
	<span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>employee_id<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">max</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
	<span class="token keyword">from</span> employees
	<span class="token punctuation">)</span><span class="token punctuation">;</span>


</code></pre>
    <p>
     <strong>
      <u>
       分页查询
      </u>
     </strong>
    </p>
    <pre><code class="prism language-sql"><span class="token comment">#分页查询</span>
<span class="token comment">/*
应用场景：当我们要显示的数据一页显示不全的时候，需要分页提交 sql 请求

语法：
			select 查询列表
			from 表
			[join type】 join 表二
			on 连接条件
			where 筛选条件
			group by 分组字段
			having 分组后的筛选
			order by 排序的字段
			limit offset，size
			
		注解：offset：是要显示条目的起始索引（起始索引从 0 开始 如果从 0 开始 这个可以省略） ； size  要显示的条目个数
		
	*/</span>
	<span class="token comment">-- 案例一：查询前五条 员工信息</span>
	<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">from</span> employees <span class="token keyword">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">;</span>	
<span class="token comment">/*
特点：
	limit 语句放在查询语句的最后
	公式： 要显示的页数 page，每页的条目是：size
	select 查询列表
	from 表
	limit  (page-1)*size，size；

*/</span>
</code></pre>
    <p>
     <strong>
      <u>
       联合查询
      </u>
     </strong>
    </p>
    <pre><code class="prism language-sql"><span class="token comment">#联合查询</span>
<span class="token comment">/*
union 联合 合并：将多条查询语句的结果合并成一个结果

语法：
		查询语句 1
		union
		查询语句 2
		union
		...
		
特点（注意事项）： 要求多条查询语句的查询列数 是一致的
								要求多条查询语句的查询的每一列的类型和顺序最好一致
								union 关键字默认去重 如果使用 union all 可以包含重复项
								
*/</span>

<span class="token comment">#引入的案例：查询部门编号&gt;90 或 邮箱包含 a 的员工信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">from</span> employees <span class="token keyword">where</span> email <span class="token operator">like</span> <span class="token string">'%a%'</span> <span class="token operator">or</span> department_id<span class="token operator">&gt;</span><span class="token number">90</span><span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> employees <span class="token keyword">where</span> email <span class="token operator">like</span> <span class="token string">'%a%'</span>
<span class="token keyword">UNION</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">from</span> employees <span class="token keyword">where</span> department_id<span class="token operator">&gt;</span><span class="token number">90</span><span class="token punctuation">;</span>
</code></pre>
    <hr/>
    <hr/>
   </div>
   <link href="./../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="./../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34363634383430332f:61727469636c652f64657461696c732f313436313032383236" class_="artid" style="display:none">
 </p>
</div>


