---
arturl_encode: "687474:70733a2f2f626c6f672e6373646e2e6e65742f677a68303232:322f61727469636c652f64657461696c732f37303038303032"
layout: post
title: "斗地主性能测试感想"
date: 2022-09-15 19:53:47 +08:00
description: "这几天要做一个斗地主有些的性能测试，由于在这之前做过了一个黑白棋的性能测试，所以这次显得没那么怕，所"
keywords: "斗地主性能测试感想"
categories: ['杂文']
tags: ['脚本', '测试', '服务器', '工具', 'Socket', 'Loadrunner']
artid: "7008002"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=7008002
    alt: "斗地主性能测试感想"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=7008002
featuredImagePreview: https://bing.ee123.net/img/rand?artid=7008002
---

# 斗地主性能测试感想

这几天要做一个斗地主有些的性能测试，由于在这之前做过了一个黑白棋的性能测试，所以这次显得没那么怕，所以做起来还是比较的心应手的。

由于对socket的脚步开发还是比较熟悉的，目前最困难的问题就是对发生和接受数据的分析了，要想写好本次脚本必须对这些数据进行分析，于是开始利用抓包工具开始抓包分析。完成了这一步，本想着剩下的就好做了、

于是进行第二步，对这些数据进行改造，时期符合loadrunner的格式要求，这一步也比较简单。很快就完成了，这个2个步骤加起来最多3个小时搞定。

做完这些工作心理自然轻松了不少，于是着急欣赏一下自己的成果，这次本来也只能算是调试脚本，于是开启了服务器后台的日志，以防出现问题进行分析和调整。但是运行后，前基本进行很顺利，眼看着进入房间，分桌，发牌，都Ok 但是到叫地主这块傻眼了，因为叫地主这个功能是随机的，而我抓的数据时写死的，这当然行不通的。这是我们做性能经常遇到的问题之一，好解决---关联。再次进行尝试，果然可以通过。

但是最让人痛苦的问题来了，斗地主不如黑白棋，黑白棋只要抓取一局的数据就可以了，在做性能的时候都按照这个模式走就可以了，但是斗地主每次发的牌都不一样，所以就不可能按着一定模式出牌了。这一下子把我给弄蒙了，不可能让我写一套逻辑吧，如果做个性能就要写一套斗地主的游戏，这时间也拖不起啊。这条路肯定走不通。想了半天总与想到了一个好办法，就是地主一家出牌，其他2家都不出就可以，这一张张的就出完了，这也算是一局，做性能不是做功能测试，只要能够更真实的模拟用户就可以了。再说服务器端对逻辑基本上没有判断，只是负责数据的分发而已，所以就按着这个思路走下去了。果然很顺利，半天就搞定了所有的脚步。