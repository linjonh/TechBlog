---
layout: post
title: "常见Web应用源码泄露问题"
date: 2025-03-07 16:21:57 +0800
description: "在Web应用方面对于安全来说，可能大家对SQL注入、XSS跨站脚本攻击、文件上传等一些漏洞已经耳熟于心了，这些漏洞可以对系统造成严重的安全风险，今天的所讲述的漏洞不亚于我们所提及到的 Owasp top 10，那就是系统源码泄露，而且Web源码泄露在实际项目中并不少见，一些大的厂商有可能也存在这类安全问题。"
keywords: "常见Web应用源码泄露问题"
categories: ['经验知识总结', '工具安装使用']
tags: ['源码泄露']
artid: "146088956"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146088956
    alt: "常见Web应用源码泄露问题"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146088956
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146088956
cover: https://bing.ee123.net/img/rand?artid=146088956
image: https://bing.ee123.net/img/rand?artid=146088956
img: https://bing.ee123.net/img/rand?artid=146088956
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     常见Web应用源码泄露问题
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-kimbie-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <hr/>
    <h2>
     <a id="_4">
     </a>
     前言
    </h2>
    <p>
     在Web应用方面对于安全来说，可能大家对SQL注入、XSS跨站脚本攻击、文件上传等一些漏洞已经耳熟于心了，这些漏洞可以对系统造成严重的安全风险，今天的所讲述的漏洞不亚于我们所提及到的 Owasp top 10，那就是系统源码泄露，而且Web源码泄露在实际项目中并不少见，一些大的厂商有可能也存在这类安全问题。
    </p>
    <hr/>
    <h2>
     <a id="_9">
     </a>
     一、常见的源码泄露漏洞
    </h2>
    <p>
     下图中把常见的源码泄露问题进行列举整理
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/56aad1f9ee254ecd854492482250e2d1.png"/>
    </p>
    <h3>
     <a id="git_13">
     </a>
     git源码泄露
    </h3>
    <p>
     <strong>
      漏洞成因
     </strong>
     <br/>
     Git是一个开源的分布式版本控制系统，在执行git init初始化目录的时候，会在当前目录下自动创建一个
     <code>
      .git
     </code>
     目录，用来记录代码的变更记录等。发布代码的时候，如果没有把
     <code>
      .git
     </code>
     这个目录删除，就直接发布到了服务器上，攻击者就可以通过它来恢复源代码。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/1ac37917cae243438bca11ac4dc56bb7.png"/>
    </p>
    <ul>
     <li>
      HEAD 这个git项目当前处在哪个分支里
     </li>
     <li>
      config 文件包含项目特有的配置选项，git config 命令会改动它
     </li>
     <li>
      description 项目的描述信息
     </li>
     <li>
      hooks/ 系统默认钩子脚本目录
     </li>
     <li>
      info/ 目录包含一个全局性排除（global exclude）文件，用以放置不希望被记录在
      <code>
       .gitignore
      </code>
      文件中的忽略模式（ignored patterns）
     </li>
     <li>
      objects/ 目录存储所有数据内容（commits，trees，blobs，tags）
     </li>
     <li>
      refs/ 标识你项目里的每个分支指向了哪个提交（commit）
     </li>
     <li>
      index 文件保存暂存区信息
     </li>
    </ul>
    <p>
     <strong>
      漏洞利用
     </strong>
    </p>
    <p>
     利用工具 Githack
    </p>
    <p>
     下载地址：https://github.com/lijiejie/GitHack
    </p>
    <p>
     使用方式 python GitHack.py http://www.example.com/.git/
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/d6e8ff9adcb24bab975b12c8ea820457.png">
      <br/>
      修复建议
     </img>
    </p>
    <p>
     删除
     <code>
      .git
     </code>
     目录或者修改中间件配置进行对
     <code>
      .git
     </code>
     隐藏文件夹的访问。
    </p>
    <h3>
     <a id="SVN_40">
     </a>
     SVN源码泄露
    </h3>
    <p>
     <strong>
      漏洞成因
     </strong>
    </p>
    <p>
     SVN是源代码本地管理软件。使用SVN管理本地代码过程中，会生成一个名为
     <code>
      .svn
     </code>
     的隐藏文件夹，其中包含重要的源码信息，而造成
     <code>
      .svn
     </code>
     文件泄露的主要原因还是网站管理员在发布代码时，没有使用导出功能，而直接进行复制粘贴。这就使
     <code>
      .svn
     </code>
     隐藏文件夹被暴露于外网环境，可以利用
     <code>
      .svn/entries
     </code>
     文件，获取到服务器源码。
    </p>
    <p>
     <strong>
      漏洞利用
     </strong>
    </p>
    <p>
     利用工具 svnExploit
     <br/>
     下载地址：https://github.com/admintony/svnExploit
    </p>
    <p>
     <strong>
      使用方式
     </strong>
    </p>
    <pre><code>安装依赖库
sudo pip install -r requirements.txt
查看帮助
python SvnExploit.py -h
检测SVN源代码泄露
python SvnExploit.py -u http://192.168.27.128/.svn
下载源代码
python SvnExploit.py -u http://192.168.27.128/.svn --dump
</code></pre>
    <p>
     <strong>
      修复建议
     </strong>
    </p>
    <p>
     1、不要使用
     <code>
      svn checkout
     </code>
     和
     <code>
      svn up
     </code>
     更新服务器上的代码，使用
     <code>
      svn export
     </code>
     （导出）功能代替。
     <br/>
     2、服务器软件（
     <code>
      Nginx
     </code>
     、
     <code>
      Apache
     </code>
     、
     <code>
      Tomcat
     </code>
     、
     <code>
      IIS
     </code>
     等）设置目录权限，禁止访问
     <code>
      .svn
     </code>
     、
     <code>
      .git
     </code>
     目录
    </p>
    <h3>
     <a id="DS_Store_67">
     </a>
     DS_Store文件泄漏
    </h3>
    <p>
     <strong>
      漏洞成因
     </strong>
    </p>
    <p>
     <code>
      .DS_Store
     </code>
     是Mac OS保存文件夹的自定义属性的隐藏文件，如文件的图标位置或背景色，相当于Windows 的
     <code>
      desktop.ini
     </code>
     。由于开发人员发布代码时未删除文件夹中隐藏的 .DS_Store，可能造成文件目录结构泄漏，源代码文件等敏感信息的泄露。
    </p>
    <p>
     <strong>
      漏洞利用
     </strong>
    </p>
    <p>
     利用工具：ds_store_exp
    </p>
    <p>
     下载地址：https://github.com/lijiejie/ds_store_exp
    </p>
    <p>
     使用方式
    </p>
    <pre><code>python3 ds_store_exp.py http://27.0.0.1/.DS_Store
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/3f56cf1dfa884ef5a5d4b76b5e90afc6.png">
      <br/>
      <strong>
       修复建议
      </strong>
     </img>
    </p>
    <p>
     不影响应用运行的情况下删除
     <code>
      .DS_Store
     </code>
     文件
    </p>
    <h3>
     <a id="_87">
     </a>
     网站备份压缩文件泄露
    </h3>
    <p>
     <strong>
      漏洞成因
     </strong>
    </p>
    <p>
     在网站正常使用中，往往需要经过修改和升级，这时就需要对网站或对某处数据进行备份。而备份文件会因为各种原因保存在网站Web目录下，而当对此目录没有访问权限限制时，就很可能会导致备份或缓存文件被下载下来。
     <br/>
     该漏洞往往会导致服务器整站源代码或者部分页面的源代码被下载，利用。源代码中所包含的各类敏感信息，如服务器数据库连接信息，服务器配置信息等会因此而泄露，造成巨大损失。
    </p>
    <p>
     <strong>
      常见备份文件后缀名
     </strong>
    </p>
    <ul>
     <li>
      .rar
     </li>
     <li>
      .zip
     </li>
     <li>
      .7z
     </li>
     <li>
      .tar
     </li>
     <li>
      .gz
     </li>
     <li>
      .bak
     </li>
     <li>
      .swp
     </li>
     <li>
      .txt
     </li>
     <li>
      .html
     </li>
    </ul>
    <p>
     常见的网站源码备份文件名
    </p>
    <ul>
     <li>
      web
     </li>
     <li>
      website
     </li>
     <li>
      backup
     </li>
     <li>
      back
     </li>
     <li>
      www
     </li>
     <li>
      wwwroot
     </li>
     <li>
      temp
     </li>
    </ul>
    <p>
     <strong>
      漏洞利用
     </strong>
    </p>
    <p>
     像备份压缩文件泄露，可以直接用专门的目录扫描工具进行敏感文件扫描
    </p>
    <p>
     利用工具：御剑、dirseach.py、gobuster 等
    </p>
    <p>
     <strong>
      修复建议
     </strong>
    </p>
    <p>
     1、做好目录访问限制
     <br/>
     2、在不影响运行的情况下，及时删除备份文件
    </p>
    <h3>
     <a id="WEBINFwebxml_127">
     </a>
     WEB-INF/web.xml泄露
    </h3>
    <p>
     <strong>
      漏洞成因
     </strong>
    </p>
    <p>
     WEB-INF是Java的WEB应用的安全目录，该目录原则上来说是客户端无法访问，只有服务端才可以访问。如果想在页面中直接访问其中的文件，必须通过
     <code>
      web.xml
     </code>
     文件对要访问的文件进行相应映射才能访问。
    </p>
    <p>
     WEB-INF主要包含以下文件或目录：
    </p>
    <p>
     •
     <code>
      /WEB-INF/web.xml
     </code>
     ：Web应用程序配置文件，描述了 servlet 和其他的应用组件配置及命名规则
     <br/>
     •
     <code>
      /WEB-INF/classes/
     </code>
     ：含了站点所有用的 class 文件，包括 servlet class 和非servlet class，他们不能包含在 .jar文件中
     <br/>
     •
     <code>
      /WEB-INF/lib/
     </code>
     ：存放web应用需要的各种JAR文件，放置仅在这个应用中要求使用的jar文件,如数据库驱动jar文件
     <br/>
     •
     <code>
      /WEB-INF/src/
     </code>
     ：源码目录，按照包名结构放置各个java文件。
     <br/>
     •
     <code>
      /WEB-INF/database.properties
     </code>
     ：数据库配置文件
    </p>
    <p>
     WEB-INF/web.xml泄露的起因就是我们在使用网络架构的时候，对静态资源的目录或文件的映射配置不当，可能会引发一些的安全问题，导致web.xml等文件能够被读取。
    </p>
    <p>
     <strong>
      漏洞利用
     </strong>
    </p>
    <p>
     扫描后台有没有WEB-INF/web.xml，然后直接访问 通过找到web.xml文件，分析可用敏感信息，推断class文件的路径，直接class文件，最后再通过反编译class文件，得到网站源码。
    </p>
    <p>
     <strong>
      修复建议
     </strong>
    </p>
    <p>
     合理配置，控制目录访问权限
    </p>
    <h3>
     <a id="CVS_151">
     </a>
     CVS泄露
    </h3>
    <p>
     <strong>
      漏洞成因
     </strong>
    </p>
    <p>
     cvs项目在初始化（cvs checkout project）的时候，会在project目录下创建一个名为CVS的目录，其中保存了各个文件的修改和commit记录，通过此目录可以获取代码的历史版本，其中两个关键文件为：CVS/Root和CVS/Entries，分别记录了项目的根信息和所有文件的结构
    </p>
    <p>
     <strong>
      漏洞利用
     </strong>
    </p>
    <p>
     主要是针对CVS/Root以及CVS/Entries目录，直接就可以看到泄露的信息。
    </p>
    <p>
     利用工具：dvcs-ripper
    </p>
    <p>
     下载地址：https://github.com/kost/dvcs-ripper
    </p>
    <p>
     <strong>
      使用方式
     </strong>
    </p>
    <pre><code>rip-cvs.pl -v -u http://www.example.com/CVS/
</code></pre>
    <p>
     <strong>
      修复方式
     </strong>
    </p>
    <p>
     删除CVS的CVS目录
    </p>
    <h3>
     <a id="hg_173">
     </a>
     .hg源码泄露
    </h3>
    <p>
     <strong>
      漏洞成因
     </strong>
    </p>
    <p>
     Mercurial是一种轻量级分布式版本控制系统，使用 hg init 新建仓库的时候，会生成一个备份文件
     <code>
      .hg
     </code>
    </p>
    <p>
     <strong>
      利用方式
     </strong>
    </p>
    <p>
     利用工具：dvcs-rippergithub
     <br/>
     下载地址：https://github.com/kost/dvcs-ripper
     <br/>
     Example run (for hg):
    </p>
    <pre><code>rip-hg.pl -v -u http://www.example.com/.hg/
</code></pre>
    <p>
     It will automatically do hg revert
     <br/>
     or if you would like to ignore SSL certification verification (with -s):
    </p>
    <pre><code>rip-hg.pl -s -v -u http://www.example.com/.hg/
</code></pre>
    <p>
     <strong>
      修复建议
     </strong>
    </p>
    <p>
     删除Web目录中所有
     <code>
      .hg
     </code>
     隐藏文件夹
    </p>
    <h3>
     <a id="Bazaarbzr_195">
     </a>
     Bazaar/bzr泄露
    </h3>
    <p>
     <strong>
      漏洞成因
     </strong>
    </p>
    <p>
     bzr也是个版本控制工具, 虽然不是很热门, 但它也是多平台支持, 并且有不错的图形界面。
    </p>
    <p>
     <strong>
      利用方式
     </strong>
    </p>
    <p>
     利用工具：dvcs-rippergithub
     <br/>
     下载地址：https://github.com/kost/dvcs-ripper
    </p>
    <p>
     Example run (for bzr):
    </p>
    <pre><code>rip-bzr.pl -v -u http://www.example.com/.bzr/
</code></pre>
    <p>
     It will automatically do bzr revertor if you would like to ignore SSL certification verification (with -s):
    </p>
    <pre><code>rip-bzr.pl -s -v -u http://www.example.com/.bzr/
</code></pre>
    <p>
     <strong>
      修复建议
     </strong>
    </p>
    <p>
     删除web目录中所有
     <code>
      .bzr
     </code>
     隐藏文件夹
    </p>
    <h3>
     <a id="swp_217">
     </a>
     .swp文件泄露
    </h3>
    <p>
     <strong>
      漏洞成因
     </strong>
    </p>
    <p>
     swp即swap文件，在编辑文件时产生的临时文件，它是隐藏文件，如果程序正常退出，临时文件自动删除，如果意外退出就会保留，文件名为
     <code>
      .filename.swp
     </code>
    </p>
    <p>
     <strong>
      漏洞利用
     </strong>
    </p>
    <p>
     可通过直接访问
     <code>
      .swp
     </code>
     文件，下载回来后删掉末尾的
     <code>
      .swp
     </code>
     ，获得源码文件。
    </p>
    <p>
     <strong>
      修复建议
     </strong>
    </p>
    <p>
     删除web目录中所有
     <code>
      .swp
     </code>
     隐藏文件夹
    </p>
    <p>
     <strong>
      防范措施
     </strong>
    </p>
    <p>
     源码泄露的危害是巨大的，因此在企业内要根据实际情况选择恰当的方式去发现以及杜绝此类风险。
    </p>
    <p>
     1） nginx上配置拒绝对对相应目录的访问
     <br/>
     2）上线时检测是否存在相应的目录，防止带有.git的目录上线
     <br/>
     3）线上定期巡检web目录，检查是否有相关的目录
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
  <div class="blog-extension-box" id="blogExtensionBox" style="width:400px;margin:auto;margin-top:12px">
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34363934343531392f:61727469636c652f64657461696c732f313436303838393536" class_="artid" style="display:none">
 </p>
</div>


