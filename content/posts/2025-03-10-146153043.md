---
layout: post
title: "QT简易小六壬起卦器-遇事不决-六壬决断"
date: 2025-03-10 13:48:50 +0800
description: "整点有意思的，用qt写了个简易小六壬起卦器。心血来潮时获取当时起卦结果。不多说，直接上源码。"
keywords: "【QT】简易小六壬起卦器 遇事不决 六壬决断"
categories: ['Qt', 'C']
tags: ['算法', 'Qt', 'Java']
artid: "146153043"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146153043
    alt: "QT简易小六壬起卦器-遇事不决-六壬决断"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146153043
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146153043
cover: https://bing.ee123.net/img/rand?artid=146153043
image: https://bing.ee123.net/img/rand?artid=146153043
img: https://bing.ee123.net/img/rand?artid=146153043
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     【QT】简易小六壬起卦器 遇事不决 六壬决断
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     整点有意思的，用qt写了个简易小六壬起卦器。
     <br/>
     一天不超过三次，占卜前提 不诚不占， 不疑不占， 不义不占
     <br/>
     心血来潮时获取当时起卦结果。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/5a65046b95364c03a300178c24cb7147.png"/>
    </p>
    <p>
     不多说，直接上源码。
    </p>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"DADMPCoreExportLib.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>

<span class="token keyword">class</span> <span class="token class-name">DADMP_CORE_EXPORT</span> CLR
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">enum</span> <span class="token class-name">E_RESULT</span> <span class="token punctuation">{<!-- --></span>
		E_DA <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//大安</span>
		E_LL <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment">//流连</span>
		E_SX <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token comment">//速喜</span>
		E_CK <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token comment">//赤口</span>
		E_XJ <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token comment">//小吉</span>
		E_KW <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">//空亡 </span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">static</span> std<span class="token double-colon punctuation">::</span>string <span class="token function">GetLR</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">GetLunarDate</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">&amp;</span> nLunarMonth<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> nLunarDay<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> nLunarHour<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">DayOfSolarYear</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">,</span> <span class="token keyword">int</span> day<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"../include/LR.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"Base/LogSystem/Include/LogSystem.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QDateTime&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> BEGIN_YEAR <span class="token operator">=</span> <span class="token number">1901</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> NUMBER_YEAR <span class="token operator">=</span> <span class="token number">199</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> LUNAR_YEARS<span class="token punctuation">[</span><span class="token number">199</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
	 <span class="token number">0x04AE53</span><span class="token punctuation">,</span><span class="token number">0x0A5748</span><span class="token punctuation">,</span><span class="token number">0x5526BD</span><span class="token punctuation">,</span><span class="token number">0x0D2650</span><span class="token punctuation">,</span><span class="token number">0x0D9544</span><span class="token punctuation">,</span>
	 <span class="token number">0x46AAB9</span><span class="token punctuation">,</span><span class="token number">0x056A4D</span><span class="token punctuation">,</span><span class="token number">0x09AD42</span><span class="token punctuation">,</span><span class="token number">0x24AEB6</span><span class="token punctuation">,</span><span class="token number">0x04AE4A</span><span class="token punctuation">,</span> <span class="token comment">//1901-1910</span>

	 <span class="token number">0x6A4DBE</span><span class="token punctuation">,</span><span class="token number">0x0A4D52</span><span class="token punctuation">,</span><span class="token number">0x0D2546</span><span class="token punctuation">,</span><span class="token number">0x5D52BA</span><span class="token punctuation">,</span><span class="token number">0x0B544E</span><span class="token punctuation">,</span>
	 <span class="token number">0x0D6A43</span><span class="token punctuation">,</span><span class="token number">0x296D37</span><span class="token punctuation">,</span><span class="token number">0x095B4B</span><span class="token punctuation">,</span><span class="token number">0x749BC1</span><span class="token punctuation">,</span><span class="token number">0x049754</span><span class="token punctuation">,</span> <span class="token comment">//1911-1920</span>

	 <span class="token number">0x0A4B48</span><span class="token punctuation">,</span><span class="token number">0x5B25BC</span><span class="token punctuation">,</span><span class="token number">0x06A550</span><span class="token punctuation">,</span><span class="token number">0x06D445</span><span class="token punctuation">,</span><span class="token number">0x4ADAB8</span><span class="token punctuation">,</span>
	 <span class="token number">0x02B64D</span><span class="token punctuation">,</span><span class="token number">0x095742</span><span class="token punctuation">,</span><span class="token number">0x2497B7</span><span class="token punctuation">,</span><span class="token number">0x04974A</span><span class="token punctuation">,</span><span class="token number">0x664B3E</span><span class="token punctuation">,</span> <span class="token comment">//1921-1930</span>

	 <span class="token number">0x0D4A51</span><span class="token punctuation">,</span><span class="token number">0x0EA546</span><span class="token punctuation">,</span><span class="token number">0x56D4BA</span><span class="token punctuation">,</span><span class="token number">0x05AD4E</span><span class="token punctuation">,</span><span class="token number">0x02B644</span><span class="token punctuation">,</span>
	 <span class="token number">0x393738</span><span class="token punctuation">,</span><span class="token number">0x092E4B</span><span class="token punctuation">,</span><span class="token number">0x7C96BF</span><span class="token punctuation">,</span><span class="token number">0x0C9553</span><span class="token punctuation">,</span><span class="token number">0x0D4A48</span><span class="token punctuation">,</span> <span class="token comment">//1931-1940</span>

	 <span class="token number">0x6DA53B</span><span class="token punctuation">,</span><span class="token number">0x0B554F</span><span class="token punctuation">,</span><span class="token number">0x056A45</span><span class="token punctuation">,</span><span class="token number">0x4AADB9</span><span class="token punctuation">,</span><span class="token number">0x025D4D</span><span class="token punctuation">,</span>
	 <span class="token number">0x092D42</span><span class="token punctuation">,</span><span class="token number">0x2C95B6</span><span class="token punctuation">,</span><span class="token number">0x0A954A</span><span class="token punctuation">,</span><span class="token number">0x7B4ABD</span><span class="token punctuation">,</span><span class="token number">0x06CA51</span><span class="token punctuation">,</span> <span class="token comment">//1941-1950</span>

	 <span class="token number">0x0B5546</span><span class="token punctuation">,</span><span class="token number">0x555ABB</span><span class="token punctuation">,</span><span class="token number">0x04DA4E</span><span class="token punctuation">,</span><span class="token number">0x0A5B43</span><span class="token punctuation">,</span><span class="token number">0x352BB8</span><span class="token punctuation">,</span>
	 <span class="token number">0x052B4C</span><span class="token punctuation">,</span><span class="token number">0x8A953F</span><span class="token punctuation">,</span><span class="token number">0x0E9552</span><span class="token punctuation">,</span><span class="token number">0x06AA48</span><span class="token punctuation">,</span><span class="token number">0x7AD53C</span><span class="token punctuation">,</span> <span class="token comment">//1951-1960</span>

	 <span class="token number">0x0AB54F</span><span class="token punctuation">,</span><span class="token number">0x04B645</span><span class="token punctuation">,</span><span class="token number">0x4A5739</span><span class="token punctuation">,</span><span class="token number">0x0A574D</span><span class="token punctuation">,</span><span class="token number">0x052642</span><span class="token punctuation">,</span>
	 <span class="token number">0x3E9335</span><span class="token punctuation">,</span><span class="token number">0x0D9549</span><span class="token punctuation">,</span><span class="token number">0x75AABE</span><span class="token punctuation">,</span><span class="token number">0x056A51</span><span class="token punctuation">,</span><span class="token number">0x096D46</span><span class="token punctuation">,</span> <span class="token comment">//1961-1970</span>

	 <span class="token number">0x54AEBB</span><span class="token punctuation">,</span><span class="token number">0x04AD4F</span><span class="token punctuation">,</span><span class="token number">0x0A4D43</span><span class="token punctuation">,</span><span class="token number">0x4D26B7</span><span class="token punctuation">,</span><span class="token number">0x0D254B</span><span class="token punctuation">,</span>
	 <span class="token number">0x8D52BF</span><span class="token punctuation">,</span><span class="token number">0x0B5452</span><span class="token punctuation">,</span><span class="token number">0x0B6A47</span><span class="token punctuation">,</span><span class="token number">0x696D3C</span><span class="token punctuation">,</span><span class="token number">0x095B50</span><span class="token punctuation">,</span> <span class="token comment">//1971-1980</span>

	 <span class="token number">0x049B45</span><span class="token punctuation">,</span><span class="token number">0x4A4BB9</span><span class="token punctuation">,</span><span class="token number">0x0A4B4D</span><span class="token punctuation">,</span><span class="token number">0xAB25C2</span><span class="token punctuation">,</span><span class="token number">0x06A554</span><span class="token punctuation">,</span>
	 <span class="token number">0x06D449</span><span class="token punctuation">,</span><span class="token number">0x6ADA3D</span><span class="token punctuation">,</span><span class="token number">0x0AB651</span><span class="token punctuation">,</span><span class="token number">0x093746</span><span class="token punctuation">,</span><span class="token number">0x5497BB</span><span class="token punctuation">,</span> <span class="token comment">//1981-1990</span>

	 <span class="token number">0x04974F</span><span class="token punctuation">,</span><span class="token number">0x064B44</span><span class="token punctuation">,</span><span class="token number">0x36A537</span><span class="token punctuation">,</span><span class="token number">0x0EA54A</span><span class="token punctuation">,</span><span class="token number">0x86B2BF</span><span class="token punctuation">,</span>
	 <span class="token number">0x05AC53</span><span class="token punctuation">,</span><span class="token number">0x0AB647</span><span class="token punctuation">,</span><span class="token number">0x5936BC</span><span class="token punctuation">,</span><span class="token number">0x092E50</span><span class="token punctuation">,</span><span class="token number">0x0C9645</span><span class="token punctuation">,</span> <span class="token comment">//1991-2000</span>

	 <span class="token number">0x4D4AB8</span><span class="token punctuation">,</span><span class="token number">0x0D4A4C</span><span class="token punctuation">,</span><span class="token number">0x0DA541</span><span class="token punctuation">,</span><span class="token number">0x25AAB6</span><span class="token punctuation">,</span><span class="token number">0x056A49</span><span class="token punctuation">,</span>
	 <span class="token number">0x7AADBD</span><span class="token punctuation">,</span><span class="token number">0x025D52</span><span class="token punctuation">,</span><span class="token number">0x092D47</span><span class="token punctuation">,</span><span class="token number">0x5C95BA</span><span class="token punctuation">,</span><span class="token number">0x0A954E</span><span class="token punctuation">,</span> <span class="token comment">//2001-2010</span>

	 <span class="token number">0x0B4A43</span><span class="token punctuation">,</span><span class="token number">0x4B5537</span><span class="token punctuation">,</span><span class="token number">0x0AD54A</span><span class="token punctuation">,</span><span class="token number">0x955ABF</span><span class="token punctuation">,</span><span class="token number">0x04BA53</span><span class="token punctuation">,</span>
	 <span class="token number">0x0A5B48</span><span class="token punctuation">,</span><span class="token number">0x652BBC</span><span class="token punctuation">,</span><span class="token number">0x052B50</span><span class="token punctuation">,</span><span class="token number">0x0A9345</span><span class="token punctuation">,</span><span class="token number">0x474AB9</span><span class="token punctuation">,</span> <span class="token comment">//2011-2020</span>

	 <span class="token number">0x06AA4C</span><span class="token punctuation">,</span><span class="token number">0x0AD541</span><span class="token punctuation">,</span><span class="token number">0x24DAB6</span><span class="token punctuation">,</span><span class="token number">0x04B64A</span><span class="token punctuation">,</span><span class="token number">0x69573D</span><span class="token punctuation">,</span>
	 <span class="token number">0x0A4E51</span><span class="token punctuation">,</span><span class="token number">0x0D2646</span><span class="token punctuation">,</span><span class="token number">0x5E933A</span><span class="token punctuation">,</span><span class="token number">0x0D534D</span><span class="token punctuation">,</span><span class="token number">0x05AA43</span><span class="token punctuation">,</span> <span class="token comment">//2021-2030</span>

	 <span class="token number">0x36B537</span><span class="token punctuation">,</span><span class="token number">0x096D4B</span><span class="token punctuation">,</span><span class="token number">0xB4AEBF</span><span class="token punctuation">,</span><span class="token number">0x04AD53</span><span class="token punctuation">,</span><span class="token number">0x0A4D48</span><span class="token punctuation">,</span>
	 <span class="token number">0x6D25BC</span><span class="token punctuation">,</span><span class="token number">0x0D254F</span><span class="token punctuation">,</span><span class="token number">0x0D5244</span><span class="token punctuation">,</span><span class="token number">0x5DAA38</span><span class="token punctuation">,</span><span class="token number">0x0B5A4C</span><span class="token punctuation">,</span> <span class="token comment">//2031-2040</span>

	 <span class="token number">0x056D41</span><span class="token punctuation">,</span><span class="token number">0x24ADB6</span><span class="token punctuation">,</span><span class="token number">0x049B4A</span><span class="token punctuation">,</span><span class="token number">0x7A4BBE</span><span class="token punctuation">,</span><span class="token number">0x0A4B51</span><span class="token punctuation">,</span>
	 <span class="token number">0x0AA546</span><span class="token punctuation">,</span><span class="token number">0x5B52BA</span><span class="token punctuation">,</span><span class="token number">0x06D24E</span><span class="token punctuation">,</span><span class="token number">0x0ADA42</span><span class="token punctuation">,</span><span class="token number">0x355B37</span><span class="token punctuation">,</span> <span class="token comment">//2041-2050</span>

	 <span class="token number">0x09374B</span><span class="token punctuation">,</span><span class="token number">0x8497C1</span><span class="token punctuation">,</span><span class="token number">0x049753</span><span class="token punctuation">,</span><span class="token number">0x064B48</span><span class="token punctuation">,</span><span class="token number">0x66A53C</span><span class="token punctuation">,</span>
	 <span class="token number">0x0EA54F</span><span class="token punctuation">,</span><span class="token number">0x06B244</span><span class="token punctuation">,</span><span class="token number">0x4AB638</span><span class="token punctuation">,</span><span class="token number">0x0AAE4C</span><span class="token punctuation">,</span><span class="token number">0x092E42</span><span class="token punctuation">,</span> <span class="token comment">//2051-2060</span>

	 <span class="token number">0x3C9735</span><span class="token punctuation">,</span><span class="token number">0x0C9649</span><span class="token punctuation">,</span><span class="token number">0x7D4ABD</span><span class="token punctuation">,</span><span class="token number">0x0D4A51</span><span class="token punctuation">,</span><span class="token number">0x0DA545</span><span class="token punctuation">,</span>
	 <span class="token number">0x55AABA</span><span class="token punctuation">,</span><span class="token number">0x056A4E</span><span class="token punctuation">,</span><span class="token number">0x0A6D43</span><span class="token punctuation">,</span><span class="token number">0x452EB7</span><span class="token punctuation">,</span><span class="token number">0x052D4B</span><span class="token punctuation">,</span> <span class="token comment">//2061-2070</span>

	 <span class="token number">0x8A95BF</span><span class="token punctuation">,</span><span class="token number">0x0A9553</span><span class="token punctuation">,</span><span class="token number">0x0B4A47</span><span class="token punctuation">,</span><span class="token number">0x6B553B</span><span class="token punctuation">,</span><span class="token number">0x0AD54F</span><span class="token punctuation">,</span>
	 <span class="token number">0x055A45</span><span class="token punctuation">,</span><span class="token number">0x4A5D38</span><span class="token punctuation">,</span><span class="token number">0x0A5B4C</span><span class="token punctuation">,</span><span class="token number">0x052B42</span><span class="token punctuation">,</span><span class="token number">0x3A93B6</span><span class="token punctuation">,</span> <span class="token comment">//2071-2080</span>

	 <span class="token number">0x069349</span><span class="token punctuation">,</span><span class="token number">0x7729BD</span><span class="token punctuation">,</span><span class="token number">0x06AA51</span><span class="token punctuation">,</span><span class="token number">0x0AD546</span><span class="token punctuation">,</span><span class="token number">0x54DABA</span><span class="token punctuation">,</span>
	 <span class="token number">0x04B64E</span><span class="token punctuation">,</span><span class="token number">0x0A5743</span><span class="token punctuation">,</span><span class="token number">0x452738</span><span class="token punctuation">,</span><span class="token number">0x0D264A</span><span class="token punctuation">,</span><span class="token number">0x8E933E</span><span class="token punctuation">,</span> <span class="token comment">//2081-2090</span>

	 <span class="token number">0x0D5252</span><span class="token punctuation">,</span><span class="token number">0x0DAA47</span><span class="token punctuation">,</span><span class="token number">0x66B53B</span><span class="token punctuation">,</span><span class="token number">0x056D4F</span><span class="token punctuation">,</span><span class="token number">0x04AE45</span><span class="token punctuation">,</span>
	 <span class="token number">0x4A4EB9</span><span class="token punctuation">,</span><span class="token number">0x0A4D4C</span><span class="token punctuation">,</span><span class="token number">0x0D1541</span><span class="token punctuation">,</span><span class="token number">0x2D92B5</span> <span class="token comment">//2091-2099</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>


std<span class="token double-colon punctuation">::</span>string <span class="token class-name">CLR</span><span class="token double-colon punctuation">::</span><span class="token function">GetLR</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> nLunarMonth <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> nLunarDay <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> nLunarHour <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">GetLunarDate</span><span class="token punctuation">(</span>nLunarMonth<span class="token punctuation">,</span> nLunarDay<span class="token punctuation">,</span> nLunarHour<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> nResult <span class="token operator">=</span> <span class="token punctuation">(</span>nLunarMonth <span class="token operator">+</span> nLunarDay  <span class="token operator">+</span> nLunarHour <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">6</span><span class="token punctuation">;</span>
	<span class="token function">LogDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"nLunarMonth:"</span> <span class="token operator">&lt;&lt;</span> nLunarMonth <span class="token operator">&lt;&lt;</span> <span class="token string">"nLunarDay:"</span> <span class="token operator">&lt;&lt;</span> nLunarDay <span class="token operator">&lt;&lt;</span> <span class="token string">"nLunarHour:"</span> <span class="token operator">&lt;&lt;</span> nLunarHour<span class="token punctuation">;</span>
	<span class="token function">LogInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"nResult:"</span>  <span class="token operator">&lt;&lt;</span> nResult<span class="token punctuation">;</span>
	<span class="token keyword">switch</span> <span class="token punctuation">(</span>nResult<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">case</span> E_DA<span class="token operator">:</span>
		<span class="token keyword">return</span> <span class="token string">"大安"</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> E_LL<span class="token operator">:</span>
		<span class="token keyword">return</span> <span class="token string">"流连"</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> E_SX<span class="token operator">:</span>
		<span class="token keyword">return</span> <span class="token string">"速喜"</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> E_CK<span class="token operator">:</span>
		<span class="token keyword">return</span> <span class="token string">"赤口"</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> E_XJ<span class="token operator">:</span>
		<span class="token keyword">return</span> <span class="token string">"小吉"</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> E_KW<span class="token operator">:</span>
		<span class="token keyword">return</span> <span class="token string">"空亡"</span><span class="token punctuation">;</span>
	<span class="token keyword">default</span><span class="token operator">:</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
*	农历时间表：
	"01.【子】23:00 ~ 01:00"
	"02.【丑】01:00 ~ 03:00"
	"03.【寅】03:00 ~ 05:00"
	"04.【卯】05:00 ~ 07:00"
	"05.【辰】07:00 ~ 09:00"
	"06.【巳】09:00 ~ 11:00"
	"07.【午】11:00 ~ 13:00"
	"08.【未】13:00 ~ 15:00"
	"09.【申】15:00 ~ 17:00"
	"10.【酉】17:00 ~ 19:00"
	"11.【戌】19:00 ~ 21:00"
	"12.【亥】21:00 ~ 23:00"
*/</span>
<span class="token keyword">void</span> <span class="token class-name">CLR</span><span class="token double-colon punctuation">::</span><span class="token function">GetLunarDate</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">&amp;</span> nLunarMonth<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> nLunarDay<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> nLunarHour<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	QDateTime currentDateTime <span class="token operator">=</span> <span class="token class-name">QDateTime</span><span class="token double-colon punctuation">::</span><span class="token function">currentDateTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> solar_year <span class="token operator">=</span> currentDateTime<span class="token punctuation">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">year</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> solar_month <span class="token operator">=</span> currentDateTime<span class="token punctuation">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">month</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> solar_day <span class="token operator">=</span> currentDateTime<span class="token punctuation">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">day</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> nHour <span class="token operator">=</span> currentDateTime<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hour</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> nLunarYear <span class="token operator">=</span> solar_year<span class="token punctuation">;</span>
	<span class="token keyword">bool</span> isLeapMonth <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>


	<span class="token keyword">if</span> <span class="token punctuation">(</span>nHour <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> nHour <span class="token operator">==</span> <span class="token number">23</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		nLunarHour <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>nHour <span class="token operator">&lt;</span> <span class="token number">3</span> <span class="token operator">&amp;&amp;</span> nHour <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		nLunarHour <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>nHour <span class="token operator">&lt;</span> <span class="token number">5</span> <span class="token operator">&amp;&amp;</span> nHour <span class="token operator">&gt;=</span> <span class="token number">3</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		nLunarHour <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>nHour <span class="token operator">&lt;</span> <span class="token number">7</span> <span class="token operator">&amp;&amp;</span> nHour <span class="token operator">&gt;=</span> <span class="token number">5</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		nLunarHour <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>nHour <span class="token operator">&lt;</span> <span class="token number">9</span> <span class="token operator">&amp;&amp;</span> nHour <span class="token operator">&gt;=</span> <span class="token number">7</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		nLunarHour <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>nHour <span class="token operator">&lt;</span> <span class="token number">11</span> <span class="token operator">&amp;&amp;</span> nHour <span class="token operator">&gt;=</span> <span class="token number">9</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		nLunarHour <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>nHour <span class="token operator">&lt;</span> <span class="token number">13</span> <span class="token operator">&amp;&amp;</span> nHour <span class="token operator">&gt;=</span> <span class="token number">11</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		nLunarHour <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>nHour <span class="token operator">&lt;</span> <span class="token number">15</span> <span class="token operator">&amp;&amp;</span> nHour <span class="token operator">&gt;=</span> <span class="token number">13</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		nLunarHour <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>nHour <span class="token operator">&lt;</span> <span class="token number">17</span> <span class="token operator">&amp;&amp;</span> nHour <span class="token operator">&gt;=</span> <span class="token number">15</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		nLunarHour <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>nHour <span class="token operator">&lt;</span> <span class="token number">19</span> <span class="token operator">&amp;&amp;</span> nHour <span class="token operator">&gt;=</span> <span class="token number">17</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		nLunarHour <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>nHour <span class="token operator">&lt;</span> <span class="token number">21</span> <span class="token operator">&amp;&amp;</span> nHour <span class="token operator">&gt;=</span> <span class="token number">19</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		nLunarHour <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>nHour <span class="token operator">&lt;</span> <span class="token number">23</span> <span class="token operator">&amp;&amp;</span> nHour <span class="token operator">&gt;=</span> <span class="token number">21</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		nLunarHour <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{<!-- --></span>
		nLunarHour <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//越界检查，如果越界，返回无效日期</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>solar_year <span class="token operator">&lt;=</span> BEGIN_YEAR <span class="token operator">||</span> solar_year <span class="token operator">&gt;</span> BEGIN_YEAR <span class="token operator">+</span> NUMBER_YEAR <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">LogError</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"solar_year is out of range."</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">int</span> year_index <span class="token operator">=</span> solar_year <span class="token operator">-</span> BEGIN_YEAR<span class="token punctuation">;</span>

	<span class="token comment">//计算春节的公历日期</span>

	<span class="token keyword">int</span> spring_ny_month <span class="token operator">=</span> <span class="token punctuation">(</span>LUNAR_YEARS<span class="token punctuation">[</span>year_index<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x60</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> spring_ny_day <span class="token operator">=</span> <span class="token punctuation">(</span>LUNAR_YEARS<span class="token punctuation">[</span>year_index<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//计算今天是公历年的第几天</span>

	<span class="token keyword">int</span> today_solar_yd <span class="token operator">=</span> <span class="token function">DayOfSolarYear</span><span class="token punctuation">(</span>solar_year<span class="token punctuation">,</span> solar_month<span class="token punctuation">,</span> solar_day<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//计算春节是公历年的第几天</span>

	<span class="token keyword">int</span> spring_ny_yd <span class="token operator">=</span> <span class="token function">DayOfSolarYear</span><span class="token punctuation">(</span>solar_year<span class="token punctuation">,</span> spring_ny_month<span class="token punctuation">,</span> spring_ny_day<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//计算今天是农历年的第几天</span>

	<span class="token keyword">int</span> today_luanr_yd <span class="token operator">=</span> today_solar_yd <span class="token operator">-</span> spring_ny_yd <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token comment">//如果今天在春节的前面，重新计算today_luanr_yd</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>today_luanr_yd <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">//农历年比当前公历年小1</span>

		year_index<span class="token operator">--</span><span class="token punctuation">;</span>
		nLunarYear<span class="token operator">--</span><span class="token punctuation">;</span>
		<span class="token comment">//越界，返回无效日期</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>year_index <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">LogError</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"year_index is out of range."</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		spring_ny_month <span class="token operator">=</span> <span class="token punctuation">(</span>LUNAR_YEARS<span class="token punctuation">[</span>year_index<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x60</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">;</span>
		spring_ny_day <span class="token operator">=</span> <span class="token punctuation">(</span>LUNAR_YEARS<span class="token punctuation">[</span>year_index<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		spring_ny_yd <span class="token operator">=</span> <span class="token function">DayOfSolarYear</span><span class="token punctuation">(</span>solar_year<span class="token punctuation">,</span> spring_ny_month<span class="token punctuation">,</span> spring_ny_day<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">int</span> year_total_day <span class="token operator">=</span> <span class="token function">DayOfSolarYear</span><span class="token punctuation">(</span>nLunarYear<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		today_luanr_yd <span class="token operator">=</span> today_solar_yd <span class="token operator">+</span> year_total_day <span class="token operator">-</span> spring_ny_yd <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">int</span> luanr_month <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token comment">//计算月份和日期</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> luanr_month <span class="token operator">&lt;=</span> <span class="token number">13</span><span class="token punctuation">;</span> luanr_month<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">int</span> month_day <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>LUNAR_YEARS<span class="token punctuation">[</span>year_index<span class="token punctuation">]</span> <span class="token operator">&gt;&gt;</span> <span class="token punctuation">(</span><span class="token number">6</span> <span class="token operator">+</span> luanr_month<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			month_day <span class="token operator">=</span> <span class="token number">29</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>today_luanr_yd <span class="token operator">&lt;=</span> month_day<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">{<!-- --></span>
			today_luanr_yd <span class="token operator">-=</span> month_day<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	nLunarDay <span class="token operator">=</span> today_luanr_yd<span class="token punctuation">;</span>
	<span class="token comment">//处理闰月</span>

	<span class="token keyword">int</span> leap_month <span class="token operator">=</span> <span class="token punctuation">(</span>LUNAR_YEARS<span class="token punctuation">[</span>year_index<span class="token punctuation">]</span> <span class="token operator">&gt;&gt;</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xf</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>leap_month <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> leap_month <span class="token operator">&lt;</span> luanr_month<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		luanr_month<span class="token operator">--</span><span class="token punctuation">;</span>
		<span class="token comment">//如果当前月为闰月，设置闰月标志</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>luanr_month <span class="token operator">==</span> leap_month<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			isLeapMonth <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token function">assert</span><span class="token punctuation">(</span>leap_month <span class="token operator">&lt;=</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	nLunarMonth <span class="token operator">=</span> luanr_month<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//计算这个公历日期是一年中的第几天</span>
<span class="token keyword">int</span> <span class="token class-name">CLR</span><span class="token double-colon punctuation">::</span><span class="token function">DayOfSolarYear</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">,</span> <span class="token keyword">int</span> day<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//为了提高效率，记录每月一日是一年中的第几天</span>

	<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> NORMAL_YDAY<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">91</span><span class="token punctuation">,</span><span class="token number">121</span><span class="token punctuation">,</span><span class="token number">152</span><span class="token punctuation">,</span>
					<span class="token number">182</span><span class="token punctuation">,</span><span class="token number">213</span><span class="token punctuation">,</span><span class="token number">244</span><span class="token punctuation">,</span><span class="token number">274</span><span class="token punctuation">,</span><span class="token number">305</span><span class="token punctuation">,</span><span class="token number">335</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token comment">//闰年的情况</span>

	<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> LEAP_YDAY<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">61</span><span class="token punctuation">,</span><span class="token number">92</span><span class="token punctuation">,</span><span class="token number">122</span><span class="token punctuation">,</span><span class="token number">153</span><span class="token punctuation">,</span>
				<span class="token number">183</span><span class="token punctuation">,</span><span class="token number">214</span><span class="token punctuation">,</span><span class="token number">245</span><span class="token punctuation">,</span><span class="token number">275</span><span class="token punctuation">,</span><span class="token number">306</span><span class="token punctuation">,</span><span class="token number">336</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> <span class="token keyword">int</span><span class="token operator">*</span> t_year_yday_ <span class="token operator">=</span> NORMAL_YDAY<span class="token punctuation">;</span>

	<span class="token comment">//判断是否是公历闰年</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>year <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>year <span class="token operator">%</span> <span class="token number">100</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
			t_year_yday_ <span class="token operator">=</span> LEAP_YDAY<span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>year <span class="token operator">%</span> <span class="token number">400</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
			t_year_yday_ <span class="token operator">=</span> LEAP_YDAY<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> t_year_yday_<span class="token punctuation">[</span>month <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span>day <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34353339373334342f:61727469636c652f64657461696c732f313436313533303433" class_="artid" style="display:none">
 </p>
</div>


