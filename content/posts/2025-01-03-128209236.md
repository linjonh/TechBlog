---
layout: post
title: "微信小程序自动化测试框架-Minium快速开始"
date: 2025-01-03 17:20:06 +0800
description: "本文主要介绍如何快速开始使用MInium自动化测试框架_minium怎么用"
keywords: "minium怎么用"
categories: ['微信小程序自动化测试框架']
tags: ['微信小程序', '小程序']
artid: "128209236"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=128209236
    alt: "微信小程序自动化测试框架-Minium快速开始"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=128209236
featuredImagePreview: https://bing.ee123.net/img/rand?artid=128209236
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     微信小程序自动化测试框架 Minium——快速开始
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     <a href="https://minitest.weixin.qq.com/#/minium/Python/readme" rel="nofollow">
      Minium
     </a>
     是微信测试团队为小程序专门开发的自动化框架。它实现了
     <a href="https://developers.weixin.qq.com/miniprogram/dev/devtools/auto/quick-start.html" rel="nofollow">
      miniprogram-automator
     </a>
     中小程序自动化能力。使用 Minium 可以进行小程序 UI 自动化测试，但是 minium 的功能不止于仅仅是 UI 自动化，甚至可以使用 Minium 来进行函数的 Mock，可以直接跳转到小程序某个页面并设置页面数据，做针对性的全面测试，这些都得益于我们开放了部分小程序 API 的能力。此外，还支持并封装了所有的原生操作都进行了封装，屏蔽了iOS/Android底层差异，实现了
     <strong>
      一套脚本在三端同时运行
     </strong>
     。
    </p>
    <p>
     下面重点介绍Minium的安装和使用，以及可能遇到的问题和解决方案
    </p>
    <h3>
     <a id="Minium_5">
     </a>
     安装Minium框架
    </h3>
    <ul>
     <li>
      自动安装（推荐）
     </li>
    </ul>
    <p>
     pip安装，拉取最新版本minium
    </p>
    <p>
     <code>
      pip3 install https://minitest.weixin.qq.com/minium/Python/dist/minium-latest.zip
     </code>
    </p>
    <ul>
     <li>
      手动安装
     </li>
    </ul>
    <p>
     下载minium安装包，解压后进入文件夹，python安装
    </p>
    <p>
     <code>
      python3 setup.py install
     </code>
    </p>
    <h3>
     <a id="_19">
     </a>
     环境检查
    </h3>
    <ul>
     <li>
      minium安装完成后，可执行以下命令查看版本：
     </li>
    </ul>
    <p>
     <code>
      minitest -v
     </code>
    </p>
    <p>
     例如输出以下信息
    </p>
    <pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span><span class="token string-property property">'version'</span><span class="token operator">:</span> <span class="token string">'1.2.8'</span><span class="token punctuation">,</span> <span class="token string-property property">'revision'</span><span class="token operator">:</span> <span class="token string">'d9e296d820fc572ce7a36bef23f16294e8dbaf46'</span><span class="token punctuation">,</span> <span class="token string-property property">'branch'</span><span class="token operator">:</span> <span class="token string">'master'</span><span class="token punctuation">,</span> <span class="token string-property property">'update_at'</span><span class="token operator">:</span> <span class="token string">'2022-07-01 14:30:51'</span><span class="token punctuation">}</span>
</code></pre>
    <ul>
     <li>
      开发者工具自动化能力检查
     </li>
    </ul>
    <p>
     <code>
      "path/to/cli" auto --project "path/to/project" --auto-port 9420
     </code>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/5898265e57bdb258cfad557b74cadd39.png"/>
    </p>
    <h4>
     <a id="_38">
     </a>
     可能遇到的问题
    </h4>
    <ul>
     <li>
      端口被占用
     </li>
    </ul>
    <p>
     <code>
      Error: Port 9420 is in use (code 10)
     </code>
    </p>
    <p>
     关闭项目，杀掉端口进程，重新执行，或者使用其他端口号
    </p>
    <ul>
     <li>
      连接超时问题
     </li>
    </ul>
    <p>
     <code>
      receive from remote timeout, id:xxxxxxxxxxx
     </code>
    </p>
    <p>
     一般是因为ide的通道被远程调试占用了，请检查ide是否有打开。建议关闭工具，重新执行，防止端口被占用。或者网络环境等原因引起
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/8a81258163b9d17348824b77ce8b26c2.png"/>
    </p>
    <ul>
     <li>
      报错traceback中有出现
      <code>
       _miniClassSetUp
      </code>
      的调用
     </li>
    </ul>
    <p>
     确认下开发者工具上选用的基础库是最新的：
     <code>
      开发者工具项目窗口右上角 -&gt; 详情 -&gt; 本地设置 -&gt; 调试基础库
     </code>
    </p>
    <p>
     <strong>
      注意
     </strong>
    </p>
    <ul>
     <li>
      微信开发者工具需保持登录状态
     </li>
     <li>
      登录账号需有该小程序的开发者权限
     </li>
    </ul>
    <h3>
     <a id="PyCharm____63">
     </a>
     PyCharm + 虚拟环境 配置开发环境
    </h3>
    <p>
     PyCharm工具编写用例脚本，使用Minium框架，配置虚拟环境，具体操作如下
    </p>
    <ul>
     <li>
      <p>
       Python Interpreter
       <br/>
       打开设置窗口，进入Python Interpreter
       <br/>
       [
       <code>
        Settings -&gt; Project: xxx -&gt; Python Interpreter
       </code>
       ]
      </p>
     </li>
     <li>
      <p>
       Add Python Interpreter
       <br/>
       点击设置按钮，点击
       <code>
        Add Python Interpreter
       </code>
      </p>
     </li>
     <li>
      <p>
       配置虚拟环境
       <br/>
       配置
       <code>
        Virtualenv Enviroment
       </code>
       ，选择
       <code>
        Existing enviroment
       </code>
       ，
       <code>
        interpreter
       </code>
       选择python安装路径
       <br/>
       （注意：需python3.8及以上，若有多个python环境，选择3.8及以上即可）
      </p>
     </li>
     <li>
      <p>
       验证
       <br/>
       配置好环境后，会加载多个package，包括minium包。
       <br/>
       若没有，可能是由于配置的python环境没有安装minium包，可重新选择python环境（配置虚拟环境）
       <br/>
       或 安装minium框架（执行
       <code>
        pip3 install https://minitest.weixin.qq.com/minium/Python/dist/minium-latest.zip
       </code>
       ）
      </p>
     </li>
    </ul>
    <h3>
     <a id="PyCharm____83">
     </a>
     PyCharm + 虚拟环境 配置开发环境
    </h3>
    <p>
     PyCharm工具编写用例脚本，使用Minium框架，配置虚拟环境，具体操作如下
    </p>
    <ul>
     <li>
      <p>
       Python Interpreter
       <br/>
       打开设置窗口，进入Python Interpreter
       <br/>
       [
       <code>
        Settings -&gt; Project: xxx -&gt; Python Interpreter
       </code>
       ]
      </p>
     </li>
     <li>
      <p>
       Add Python Interpreter
       <br/>
       点击设置按钮，点击
       <code>
        Add Python Interpreter
       </code>
      </p>
     </li>
     <li>
      <p>
       配置虚拟环境
       <br/>
       配置
       <code>
        Virtualenv Enviroment
       </code>
       ，选择
       <code>
        Existing enviroment
       </code>
       ，
       <code>
        interpreter
       </code>
       选择python安装路径
       <br/>
       （注意：需python3.8及以上，若有多个python环境，选择3.8及以上即可）
      </p>
     </li>
     <li>
      <p>
       验证
       <br/>
       配置好环境后，会加载多个package，包括minium包。
       <br/>
       若没有，可能是由于配置的python环境没有安装minium包，可重新选择python环境（配置虚拟环境）
       <br/>
       或 安装minium框架（执行
       <code>
        pip3 install https://minitest.weixin.qq.com/minium/Python/dist/minium-latest.zip
       </code>
       ）
      </p>
     </li>
    </ul>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/f127e78f66e93001f376833ab60b9198.gif#pic_center"/>
    </p>
    <h3>
     <a id="_106">
     </a>
     简单例子
    </h3>
    <p>
     小程序demo参考
     <a href="https://git.weixin.qq.com/minitest/minitest-demo" rel="nofollow">
      miniprogram-demo
     </a>
    </p>
    <h6>
     <a id="UI_110">
     </a>
     简单UI页面操作
    </h6>
    <pre><code class="prism language-py"><span class="token keyword">class</span> <span class="token class-name">FirstTest</span><span class="token punctuation">(</span>minium<span class="token punctuation">.</span>MiniTest<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">def</span> <span class="token function">test_ui_op</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 页面跳转</span>
            self<span class="token punctuation">.</span>app<span class="token punctuation">.</span>switch_tab<span class="token punctuation">(</span><span class="token string">"/pages/index/index"</span><span class="token punctuation">)</span>
            <span class="token comment"># 元素定位</span>
            ele <span class="token operator">=</span> self<span class="token punctuation">.</span>page<span class="token punctuation">.</span>get_element<span class="token punctuation">(</span><span class="token string">"/page/view/navigator[3]/button"</span><span class="token punctuation">)</span>
            <span class="token comment"># 元素点击</span>
            ele<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment"># 判断元素是否存在</span>
            self<span class="token punctuation">.</span>assertTrue<span class="token punctuation">(</span>self<span class="token punctuation">.</span>page<span class="token punctuation">.</span>element_is_exists<span class="token punctuation">(</span><span class="token string">"/page/view[9]/mytest//view"</span><span class="token punctuation">,</span> max_timeout<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token comment"># 打印元素文本</span>
            inner <span class="token operator">=</span> self<span class="token punctuation">.</span>page<span class="token punctuation">.</span>get_element<span class="token punctuation">(</span><span class="token string">"/page/view[9]/mytest//view"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>inner_text
            self<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"UI Case %s"</span><span class="token punctuation">,</span> inner<span class="token punctuation">)</span>
</code></pre>
    <h6>
     <a id="configjson__128">
     </a>
     config.json 配置
    </h6>
    <pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"project_path"</span><span class="token operator">:</span><span class="token string">"xxx"</span><span class="token punctuation">,</span>     <span class="token comment">// 小程序项目路径</span>
  <span class="token string-property property">"dev_tool_path"</span><span class="token operator">:</span><span class="token string">"xxx"</span><span class="token punctuation">,</span>  <span class="token comment">// 微信开发者工具安装路径</span>
  <span class="token string-property property">"platform"</span><span class="token operator">:</span> <span class="token string">"ide"</span>
<span class="token punctuation">}</span>
</code></pre>
    <h6>
     <a id="case_137">
     </a>
     运行case
    </h6>
    <p>
     <code>
      minitest -m test.first_test -c config.json -g
     </code>
    </p>
    <h6>
     <a id="_141">
     </a>
     运行结果
    </h6>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/90933d95182eb56c5f8c516eb35f4d5e.png"/>
    </p>
    <h6>
     <a id="_146">
     </a>
     查看结果
    </h6>
    <p>
     测试结果默认存储在outputs文件下，运行命令
     <code>
      python3 -m http.server 12345 -d outputs
     </code>
     然后在浏览器上访问
     <code>
      http://localhost:12345
     </code>
     即可查看报告，如图：
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/a371c745d6f8f02394f0ddfe1c676701.png"/>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f57584d696e69546573742f:61727469636c652f64657461696c732f313238323039323336" class_="artid" style="display:none">
 </p>
</div>


