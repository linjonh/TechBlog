---
layout: post
title: "STM32之I2C硬件外设"
date: 2025-03-07 14:44:32 +0800
description: "STM32之硬件I2C原理"
keywords: "STM32之I2C硬件外设"
categories: ['未分类']
tags: ['嵌入式硬件', '单片机', 'Stm']
artid: "146093023"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146093023
    alt: "STM32之I2C硬件外设"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146093023
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146093023
cover: https://bing.ee123.net/img/rand?artid=146093023
image: https://bing.ee123.net/img/rand?artid=146093023
img: https://bing.ee123.net/img/rand?artid=146093023
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     STM32之I2C硬件外设
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/4d79fca3d53943fd92e9524a37557ea6.png#pic_center">
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/2eded4bd34d94d03a52cdf3f9e5349c4.png#pic_center">
       <br/>
       注意：硬件I2C的引脚是固定的
       <br/>
       SDA和SCL都是复用到外部引脚。
       <br/>
       SDA发送时数据寄存器的数据在数据移位寄存器空闲的状态下进入数据移位寄存器，此时会置状态寄存器的TXE为1，表示发送寄存器为空，然后往数据控制寄存器中一位一位的移送数据。接收时数据控制寄存器中的数据一位一位的从引脚移位到数据移位寄存器中，当一个数据以为完成后就从数据移位寄存器中转移到数据寄存器，同时置RXNE表示接收寄存器非空。自身地址寄存器时STM32作为从机时的地址，比较器会比较主机的发出的地址与自身地址是否匹配，如果匹配就响应主机的召唤。STM32支持同时响应两个主机的召唤，所以有双低地址寄存器。PEC是用来数据校验的模块，执行CRC数据校算。
      </img>
     </img>
    </p>
    <p>
     SCL的时钟控制是用来控制SCL的，时钟控制寄存器写对应的位，电路就会启用对应的功能，控制逻辑电路写入控制寄存器可以对电路进行控制，读取状态寄存器，可以读取电路的状态。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/0d63b1ef75cf4164bd4dab7a49fe6135.png#pic_center">
      <br/>
      注意：使用I2C的时候，两个GPIO口都要配置成复用开漏输出的模式。此时是片上外设控制引脚电平。
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/8b2ba67a9af14f85b20012e3a85ce636.png#pic_center">
       <br/>
       图中线路对应SDA的GPIO的连个箭头。分别对应输出和输入。
      </img>
     </img>
    </p>
    <p>
     硬件I2C的操作流程：
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/52d8d593c5fb4fdd8a932a054f1a655f.png#pic_center">
      <br/>
      7位主发送：
      <br/>
      1.产生开始条件
      <br/>
      2.EV5标志位，表示起始条件已发送，发送从机地址，然后等待从机应答A，如果没有应答就会产生中断
      <br/>
      3.EV6事件：表示地址发送结束
      <br/>
      4.EV8_1事件：准备好发送
      <br/>
      5.EV8事件：表示可以写入下一个数据
      <br/>
      6.EV8_2：表示数据发送完，可以产生终止条件
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/a65788fc65184630a6d069faf1a817c7.png#pic_center">
       <br/>
       7位主接收：
       <br/>
       1.EV5：起始条件已经发送
       <br/>
       2.寻址接收应答A
       <br/>
       3.EV6：代表寻址已完成
       <br/>
       4.EV6_1:表示数据正在移位
       <br/>
       5.EV7：表示收到一个字节的数据
       <br/>
       6.EV7_1:表示想要结束
      </img>
     </img>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34343431383236322f:61727469636c652f64657461696c732f313436303933303233" class_="artid" style="display:none">
 </p>
</div>


