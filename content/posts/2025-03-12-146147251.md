---
layout: post
title: "CAMEL-学习笔记一"
date: 2025-03-12 00:12:57 +0800
description: "CAMEL (Communicative Agents for “Mind” Exploration of Large Language Models)是一个开源的多智能体框架，专注于构建基于大语言模型的智能体交互系统。该框架通过角色扮演和结构化对话机制，实现智能体之间的有效协作。在CAMEL框架中，ChatAgent 是最基础的智能体单元，负责处理对话逻辑和任务执行。而RolePlaying 和Workforce 则是多智能体系统，用于协调多个智能体的协作。"
keywords: "CAMEL 学习笔记一"
categories: ['大模型']
tags: ['笔记', '学习']
artid: "146147251"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146147251
    alt: "CAMEL-学习笔记一"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146147251
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146147251
cover: https://bing.ee123.net/img/rand?artid=146147251
image: https://bing.ee123.net/img/rand?artid=146147251
img: https://bing.ee123.net/img/rand?artid=146147251
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     CAMEL 学习笔记一
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     <a href="https://avf1wnzdxzh.feishu.cn/wiki/UpRWwrwUqiFXH6k7dk2cFrkYnXd?from=from_copylink" rel="nofollow">
      课程讲义
     </a>
     <br/>
     <a href="https://github.com/camel-ai/owl">
      https://github.com/camel-ai/owl
     </a>
    </p>
    <p>
     CAMEL (Communicative Agents for “Mind” Exploration of Large Language Models)是一个开源的多智能体框架，专注于构建基于大语言模型的智能体交互系统。该框架通过角色扮演和结构化对话机制，实现智能体之间的有效协作。在CAMEL框架中，ChatAgent 是最基础的智能体单元，负责处理对话逻辑和任务执行。而RolePlaying 和Workforce 则是多智能体系统，用于协调多个智能体的协作。
    </p>
    <h2>
     <a id="RolePlaying_6">
     </a>
     RolePlaying
    </h2>
    <p>
     一个典型的智能体包含三个核心部分：
    </p>
    <ul>
     <li>
      感知模块：处理输入信息
     </li>
     <li>
      决策模块：制定行动计划
     </li>
     <li>
      执行模块：实施具体行动
     </li>
    </ul>
    <p>
     结构化提示词引导角色行为 + 环境协调消息路由，使得 AI 智能体能够模拟人类团队的任务协作过程。
    </p>
    <h2>
     <a id="demo_14">
     </a>
     跑demo
    </h2>
    <pre><code class="prism language-python"><span class="token keyword">from</span> colorama <span class="token keyword">import</span> Fore

<span class="token keyword">from</span> camel<span class="token punctuation">.</span>societies <span class="token keyword">import</span> RolePlaying
<span class="token keyword">from</span> camel<span class="token punctuation">.</span>utils <span class="token keyword">import</span> print_text_animated
<span class="token keyword">from</span> camel<span class="token punctuation">.</span>models <span class="token keyword">import</span> ModelFactory
<span class="token keyword">from</span> camel<span class="token punctuation">.</span>types <span class="token keyword">import</span> ModelPlatformType


model <span class="token operator">=</span> ModelFactory<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
    model_platform<span class="token operator">=</span>ModelPlatformType<span class="token punctuation">.</span>OPENAI_COMPATIBLE_MODEL<span class="token punctuation">,</span>
    model_type<span class="token operator">=</span><span class="token string">"Qwen/Qwen2.5-72B-Instruct"</span><span class="token punctuation">,</span>
    url<span class="token operator">=</span><span class="token string">'https://api-inference.modelscope.cn/v1/'</span><span class="token punctuation">,</span>
    api_key<span class="token operator">=</span><span class="token string">'xxx'</span>
<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span>model<span class="token operator">=</span>model<span class="token punctuation">,</span> chat_turn_limit<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    task_prompt <span class="token operator">=</span> <span class="token string">"我们是一家材料开发公司，很多工厂任务，你是一个排产专家，你会设计什么方案排产呢？保证各项任务紧密安全不冲突"</span><span class="token comment">#设置任务目标</span>
    role_play_session <span class="token operator">=</span> RolePlaying<span class="token punctuation">(</span>
        assistant_role_name<span class="token operator">=</span><span class="token string">"排产专家"</span><span class="token punctuation">,</span><span class="token comment">#设置AI助手角色名</span>
        assistant_agent_kwargs<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>model<span class="token operator">=</span>model<span class="token punctuation">)</span><span class="token punctuation">,</span>
        user_role_name<span class="token operator">=</span><span class="token string">"操作员"</span><span class="token punctuation">,</span><span class="token comment">#设置用户角色名，在roleplay中，user用于指导AI助手完成任务</span>
        user_agent_kwargs<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>model<span class="token operator">=</span>model<span class="token punctuation">)</span><span class="token punctuation">,</span>
        task_prompt<span class="token operator">=</span>task_prompt<span class="token punctuation">,</span>
        with_task_specify<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        task_specify_agent_kwargs<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>model<span class="token operator">=</span>model<span class="token punctuation">)</span><span class="token punctuation">,</span>
        output_language<span class="token operator">=</span><span class="token string">'中文'</span><span class="token comment">#设置输出语言</span>
    <span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span>
        Fore<span class="token punctuation">.</span>GREEN
        <span class="token operator">+</span> <span class="token string-interpolation"><span class="token string">f"AI 助手系统消息:\n</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>role_play_session<span class="token punctuation">.</span>assistant_sys_msg<span class="token punctuation">}</span></span><span class="token string">\n"</span></span>
    <span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>
        Fore<span class="token punctuation">.</span>BLUE <span class="token operator">+</span> <span class="token string-interpolation"><span class="token string">f"AI 用户系统消息:\n</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>role_play_session<span class="token punctuation">.</span>user_sys_msg<span class="token punctuation">}</span></span><span class="token string">\n"</span></span>
    <span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span>Fore<span class="token punctuation">.</span>YELLOW <span class="token operator">+</span> <span class="token string-interpolation"><span class="token string">f"原始任务提示:\n</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>task_prompt<span class="token punctuation">}</span></span><span class="token string">\n"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>
        Fore<span class="token punctuation">.</span>CYAN
        <span class="token operator">+</span> <span class="token string">"指定的任务提示:"</span>
        <span class="token operator">+</span> <span class="token string-interpolation"><span class="token string">f"\n</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>role_play_session<span class="token punctuation">.</span>specified_task_prompt<span class="token punctuation">}</span></span><span class="token string">\n"</span></span>
    <span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>Fore<span class="token punctuation">.</span>RED <span class="token operator">+</span> <span class="token string-interpolation"><span class="token string">f"最终任务提示:\n</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>role_play_session<span class="token punctuation">.</span>task_prompt<span class="token punctuation">}</span></span><span class="token string">\n"</span></span><span class="token punctuation">)</span>

    n <span class="token operator">=</span> <span class="token number">0</span>
    input_msg <span class="token operator">=</span> role_play_session<span class="token punctuation">.</span>init_chat<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">while</span> n <span class="token operator">&lt;</span> chat_turn_limit<span class="token punctuation">:</span>
        n <span class="token operator">+=</span> <span class="token number">1</span>
        assistant_response<span class="token punctuation">,</span> user_response <span class="token operator">=</span> role_play_session<span class="token punctuation">.</span>step<span class="token punctuation">(</span>input_msg<span class="token punctuation">)</span>

        <span class="token keyword">if</span> assistant_response<span class="token punctuation">.</span>terminated<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>
                Fore<span class="token punctuation">.</span>GREEN
                <span class="token operator">+</span> <span class="token punctuation">(</span>
                    <span class="token string">"AI 助手已终止。原因: "</span>
                    <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>assistant_response<span class="token punctuation">.</span>info<span class="token punctuation">[</span><span class="token string">'termination_reasons'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">."</span></span>
                <span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
            <span class="token keyword">break</span>
        <span class="token keyword">if</span> user_response<span class="token punctuation">.</span>terminated<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>
                Fore<span class="token punctuation">.</span>GREEN
                <span class="token operator">+</span> <span class="token punctuation">(</span>
                    <span class="token string">"AI 用户已终止。"</span>
                    <span class="token string-interpolation"><span class="token string">f"原因: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>user_response<span class="token punctuation">.</span>info<span class="token punctuation">[</span><span class="token string">'termination_reasons'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">."</span></span>
                <span class="token punctuation">)</span>
            <span class="token punctuation">)</span>
            <span class="token keyword">break</span>

        print_text_animated<span class="token punctuation">(</span>
            Fore<span class="token punctuation">.</span>BLUE <span class="token operator">+</span> <span class="token string-interpolation"><span class="token string">f"AI 用户:\n\n</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>user_response<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>content<span class="token punctuation">}</span></span><span class="token string">\n"</span></span>
        <span class="token punctuation">)</span>
        print_text_animated<span class="token punctuation">(</span>
            Fore<span class="token punctuation">.</span>GREEN <span class="token operator">+</span> <span class="token string">"AI 助手:\n\n"</span>
            <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>assistant_response<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>content<span class="token punctuation">}</span></span><span class="token string">\n"</span></span>
        <span class="token punctuation">)</span>

        <span class="token keyword">if</span> <span class="token string">"CAMEL_TASK_DONE"</span> <span class="token keyword">in</span> user_response<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>content<span class="token punctuation">:</span>
            <span class="token keyword">break</span>

        input_msg <span class="token operator">=</span> assistant_response<span class="token punctuation">.</span>msg

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     初步的使用体验还是挺流畅的，回答很有启发。下一步希望深入了解Agent 重要api：step， init_chat 这些的使用。 roleplaying 通过给定两个不同角色进行对话的方式来完成任务，设计还挺巧妙的。
    </p>
    <h2>
     <a id="_103">
     </a>
     问题
    </h2>
    <ul>
     <li>
      拆解任务是如何做到的？主要是通过 prompt 吗？
      <br/>
      感觉相较于 langgraph而言，camel 主要多了一个角色扮演的功能。
     </li>
     <li>
      试用了两个 tools 调用的案例，都失败了，还要进一步查看原因。不知道对tool 的调用封装逻辑是怎么样的，会对模型本身支持function call 与否有要求么？
     </li>
    </ul>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34313738333432342f:61727469636c652f64657461696c732f313436313437323531" class_="artid" style="display:none">
 </p>
</div>


