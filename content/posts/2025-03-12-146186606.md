---
layout: post
title: "SSL-配置"
date: 2025-03-12 10:19:17 +0800
description: "如果需要放行SSL流量，必须通过防火墙安全策略来进行管理，必须关闭service-manage  enable。此时仍然无法访问内部资源，需要放行源目IP地址的流量。放行客户端通告认证的网卡的IP地址通往内网IP地址。3）调整网关关联用户认证/并发数量等。3）调整网关关联用户认证/并发数量等。仍然访问内部资源因为安全策略未放行。实现远程的出差客户端访问内网资源。ssl_client网卡配置。放行想要本地的接口的流量。4）开启网络-网络扩展。4）开启网络-网络扩展。此时多了ssl的网卡。"
keywords: "SSL 配置"
categories: ['网络工程师', '网络安全', '华为']
tags: ['防火墙', '华为', 'Ssl']
artid: "146186606"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146186606
    alt: "SSL-配置"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146186606
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146186606
cover: https://bing.ee123.net/img/rand?artid=146186606
image: https://bing.ee123.net/img/rand?artid=146186606
img: https://bing.ee123.net/img/rand?artid=146186606
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     SSL 配置
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <hr id="hr-toc" name="tableOfContents"/>
    <p>
    </p>
    <h2 name="%E5%BC%95%E8%A8%80">
     引言
    </h2>
    <blockquote>
     <p>
      可查看这篇文章
     </p>
    </blockquote>
    <h2 id="%E5%AE%9E%E9%AA%8C" name="%E5%AE%9E%E9%AA%8C">
     实验
    </h2>
    <h3 id="1.%E6%8B%93%E6%89%91%E5%9B%BE" name="1.%E6%8B%93%E6%89%91%E5%9B%BE">
     1.拓扑图
    </h3>
    <p>
     <img alt="" height="931" src="https://i-blog.csdnimg.cn/direct/1b77d032d46f407e980a0df73e1ac04a.png" width="2330"/>
    </p>
    <h3 id="2.%E7%9B%AE%E7%9A%84" name="2.%E7%9B%AE%E7%9A%84">
     2.目的
    </h3>
    <p>
     实现远程的出差客户端访问内网资源
    </p>
    <h3 id="3.%E9%85%8D%E7%BD%AE%E6%80%9D%E8%B7%AF" name="3.%E9%85%8D%E7%BD%AE%E6%80%9D%E8%B7%AF">
     3.配置思路
    </h3>
    <blockquote>
     <p>
      <strong>
       ①基础配置
      </strong>
     </p>
     <p>
      <strong>
       ②在web防火墙上配置ssl
      </strong>
     </p>
     <p>
      1）创建ssl网关
     </p>
     <p>
      2）创建登录用户
     </p>
     <p>
      3）调整网关关联用户认证/并发数量等
     </p>
     <p>
      4）开启网络-网络扩展
     </p>
     <p>
      <strong>
       ③防火墙放行ssl流量
      </strong>
     </p>
     <p>
      放行想要本地的接口的流量
     </p>
     <p>
      <strong>
       ④ssl登录
      </strong>
     </p>
     <p>
      <strong>
       ⑤防火墙放行访问内网的流量
      </strong>
     </p>
     <p>
      放行客户端通告认证的网卡的IP地址通往内网IP地址
     </p>
    </blockquote>
    <h3 id="4.%E9%85%8D%E7%BD%AE" name="4.%E9%85%8D%E7%BD%AE">
     4.配置
    </h3>
    <h4 id="%E2%91%A0%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE" name="%E2%91%A0%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE">
     ①基础配置
    </h4>
    <pre><code class="language-javascript">FW1
[FW]int g1/0/0
[FW-GigabitEthernet1/0/0]ip add 12.12.12.1 24
[FW-GigabitEthernet1/0/0]service-manage ping permit 
[FW]int g0/0/0                 
[FW-GigabitEthernet0/0/0]ip add 192.168.199.91 24
[FW-GigabitEthernet0/0/0]service-manage all permit 
[FW]int g1/0/1                 
[FW-GigabitEthernet1/0/1]ip add 1.1.1.254 24
[FW-GigabitEthernet1/0/1]service-manage ping permit 

[FW]firewall zone untrust 
[FW-zone-untrust]add int g1/0/0
[FW]firewall zone trust 
[FW-zone-trust]add int g1/0/1

[FW]ip route-static 0.0.0.0 0.0.0.0 12.12.12.2</code></pre>
    <p>
     cloud1 ，server1、server2
    </p>
    <p>
     <img alt="" height="781" src="https://i-blog.csdnimg.cn/direct/dd024c34b4a54fe8842185de2393765f.png" width="1156">
      <img alt="" height="867" src="https://i-blog.csdnimg.cn/direct/d671c60a4ee4471391b838b3b30a19ca.png" width="936">
       <img alt="" height="1054" src="https://i-blog.csdnimg.cn/direct/23f7702c6aaf443f9eabb0e34c548c3b.png" width="1120"/>
      </img>
     </img>
    </p>
    <p>
     ssl_client网卡配置
    </p>
    <p>
     <img alt="" height="1042" src="https://i-blog.csdnimg.cn/direct/c669a53aa2934945ac08a6b208143126.png" width="1475"/>
    </p>
    <h4 id="%E2%91%A1%E5%9C%A8web%E9%98%B2%E7%81%AB%E5%A2%99%E4%B8%8A%E9%85%8D%E7%BD%AEssl" name="%E2%91%A1%E5%9C%A8web%E9%98%B2%E7%81%AB%E5%A2%99%E4%B8%8A%E9%85%8D%E7%BD%AEssl">
     ②在web防火墙上配置ssl
    </h4>
    <p>
     1）创建ssl网关
    </p>
    <pre><code class="language-javascript">[FW]v-gateway sslvpn int g1/0/0 port 11443 private www.kobe.com</code></pre>
    <p>
     2）创建登录用户
    </p>
    <p>
     <img alt="" height="1066" src="https://i-blog.csdnimg.cn/direct/bbab333546f743f898e0619d5d21e8c5.png" width="2115"/>
    </p>
    <p>
     3）调整网关关联用户认证/并发数量等
    </p>
    <p>
     <img alt="" height="1066" src="https://i-blog.csdnimg.cn/direct/2dd4855e1c684cfa8a803761e7a96419.png" width="2129"/>
    </p>
    <p>
     4）开启网络-网络扩展
    </p>
    <p>
     <img alt="" height="864" src="https://i-blog.csdnimg.cn/direct/525470bfc2fc41e3866f58315e7cf1af.png" width="1481"/>
    </p>
    <h4 id="%E2%91%A2%E9%98%B2%E7%81%AB%E5%A2%99%E6%94%BE%E8%A1%8Cssl%E6%B5%81%E9%87%8F" name="%E2%91%A2%E9%98%B2%E7%81%AB%E5%A2%99%E6%94%BE%E8%A1%8Cssl%E6%B5%81%E9%87%8F">
     ③防火墙放行ssl流量
    </h4>
    <p>
     仍然访问内部资源因为安全策略未放行
    </p>
    <p>
     <img alt="" height="94" src="https://i-blog.csdnimg.cn/direct/f2460ee853cb424b98f5515c2bcc5e8d.png" width="151"/>
    </p>
    <p style="margin-left:.0001pt; margin-right:0">
     如果需要放行SSL流量，必须通过防火墙安全策略来进行管理，必须关闭service-manage  enable。
    </p>
    <pre><code class="language-javascript">FW1
[FW]security-policy
[FW-policy-security]security-policy
[FW-policy-security] rule name sslenter
[FW-policy-security-rule-sslenter]  source-zone untrust
[FW-policy-security-rule-sslenter]  destination-zone local
[FW-policy-security-rule-sslenter]  destination-address 12.12.12.1 mask 255.255.255.255
[FW-policy-security-rule-sslenter]  action permit


[FW1-GigabitEthernet1/0/1]undo service-manage  enable</code></pre>
    <h4 id="%E2%91%A3%E7%99%BB%E5%BD%95ssl" name="%E2%91%A3%E7%99%BB%E5%BD%95ssl">
     ④登录ssl
    </h4>
    <p>
     <img alt="" height="69" src="https://i-blog.csdnimg.cn/direct/0269066f5c3a4d6bab7ab087c5926a41.png" width="1585"/>
    </p>
    <p>
     此时多了ssl的网卡
    </p>
    <p>
     <img alt="" height="991" src="https://i-blog.csdnimg.cn/direct/bd5795975e544c14bd96f8948dceb947.png" width="1137"/>
    </p>
    <h4 id="%E2%91%A4%E9%98%B2%E7%81%AB%E5%A2%99%E6%94%BE%E8%A1%8C%E8%AE%BF%E9%97%AE%E5%86%85%E7%BD%91%E7%9A%84%E6%B5%81%E9%87%8F" name="%E2%91%A4%E9%98%B2%E7%81%AB%E5%A2%99%E6%94%BE%E8%A1%8C%E8%AE%BF%E9%97%AE%E5%86%85%E7%BD%91%E7%9A%84%E6%B5%81%E9%87%8F">
     ⑤防火墙放行访问内网的流量
    </h4>
    <p>
     此时仍然无法访问内部资源，需要放行源目IP地址的流量
    </p>
    <pre><code class="language-javascript">[FW]security-policy
[FW-policy-security] rule name 2inter
[FW-policy-security-rule-2inter]  source-zone untrust
[FW-policy-security-rule-2inter]  destination-zone trust
[FW-policy-security-rule-2inter]  source-address 19.19.19.0 mask 255.255.255.0
[FW-policy-security-rule-2inter]  destination-address 1.1.1.0 mask 255.255.255.0
[FW-policy-security-rule-2inter]  action permit</code></pre>
    <p>
     <img alt="" height="263" src="https://i-blog.csdnimg.cn/direct/3991627bd0ae486aa254d8dff5dae490.png" width="1709"/>
    </p>
    <h3 id="5.%E6%8A%93%E5%8C%85%E5%88%86%E6%9E%90%EF%BC%9A" name="5.%E6%8A%93%E5%8C%85%E5%88%86%E6%9E%90%EF%BC%9A">
     5.抓包分析：
    </h3>
    <p>
     内网网关的接口
    </p>
    <p>
     <img alt="" height="426" src="https://i-blog.csdnimg.cn/direct/87c32ac3fa5e4f338dd0b7810b756413.png" width="2273"/>
    </p>
    <p>
     外网接口
    </p>
    <p>
     <img alt="" height="543" src="https://i-blog.csdnimg.cn/direct/84ce93b05b1d43ca8981c5106ade1246.png" width="2424"/>
    </p>
    <h4 id="%E8%AE%BF%E9%97%AE1.1.1.1%E7%9A%84%E8%B5%84%E6%BA%90" name="%E8%AE%BF%E9%97%AE1.1.1.1%E7%9A%84%E8%B5%84%E6%BA%90">
     访问1.1.1.1的资源
    </h4>
    <h4 id="%E2%80%8B%E7%BC%96%E8%BE%91%E8%AE%BF%E9%97%AE1.1.1.2%E7%9A%84%E8%B5%84%E6%BA%90" name="%E2%80%8B%E7%BC%96%E8%BE%91%E8%AE%BF%E9%97%AE1.1.1.2%E7%9A%84%E8%B5%84%E6%BA%90">
     <img alt="" height="454" src="https://i-blog.csdnimg.cn/direct/9723609c539f40e4aed607abc56eb664.png" width="1590"/>
     访问1.1.1.2的资源
    </h4>
    <p>
     <img alt="" height="695" src="https://i-blog.csdnimg.cn/direct/e910dfa9a19f4372b8548279e63c29f5.png" width="1569"/>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323430335f38333131323432322f:61727469636c652f64657461696c732f313436313836363036" class_="artid" style="display:none">
 </p>
</div>


