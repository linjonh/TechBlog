---
arturl_encode: "68747470733a2f2f626c:6f672e6373646e2e6e65742f416e67656c5f54656172735f2f:61727469636c652f64657461696c732f313436313036353238"
layout: post
title: "å¦‚ä½•åœ¨rustä¸­è§£æ-windows-çš„-lnkæ–‡ä»¶å¿«æ·æ–¹å¼"
date: 2025-03-07 22:47:25 +0800
description: "è¿™äº›å¤©åœ¨ä½¿ç”¨rustå†™ä¸€ä¸ªpcç«¯åº”ç”¨ç¨‹åºï¼Œéœ€è¦è§£æ`nkæ–‡ä»¶è·å–lnkçš„å›¾æ ‡ä»¥åŠåŸç¨‹åºåœ°å€ï¼Œä¹‹å‰å¹¶æ²¡æœ‰è¿‡pcç«¯åº”ç”¨ç¨‹åºå¼€å‘çš„ç»éªŒï¼Œ æ‰€ä»¥åœ¨å¹¿å¤§çš„äº’è”ç½‘ä¸Šæ¸¸è¡äº†ä¸¤å¤©ã€‚é¢ğŸ¥ºä»Šå¤©æ‰¾åˆ°æ‰¾åˆ°äº†è¿™ä¸ªåº“å¾ˆå¥½çš„è§£å†³æ ‡é¢˜çš„è¿™ä¸ªé—®é¢˜ã€‚"
keywords: "å¦‚ä½•åœ¨rustä¸­è§£æ windows çš„ lnkæ–‡ä»¶ï¼ˆå¿«æ·æ–¹å¼ï¼‰"
categories: ['æœªåˆ†ç±»']
tags: ['å¼€å‘è¯­è¨€', 'Windows', 'Rust']
artid: "146106528"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146106528
    alt: "å¦‚ä½•åœ¨rustä¸­è§£æ-windows-çš„-lnkæ–‡ä»¶å¿«æ·æ–¹å¼"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146106528
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146106528
cover: https://bing.ee123.net/img/rand?artid=146106528
image: https://bing.ee123.net/img/rand?artid=146106528
img: https://bing.ee123.net/img/rand?artid=146106528
---

# å¦‚ä½•åœ¨rustä¸­è§£æ windows çš„ lnkæ–‡ä»¶ï¼ˆå¿«æ·æ–¹å¼ï¼‰

## ä¸€ã€ä»æ ‡é¢˜äºŒå¼€å§‹çœ‹ğŸ˜

è¿™äº›å¤©åœ¨ä½¿ç”¨rustå†™ä¸€ä¸ªpcç«¯åº”ç”¨ç¨‹åºï¼Œéœ€è¦è§£ælnkæ–‡ä»¶è·å–lnkçš„å›¾æ ‡ä»¥åŠåŸç¨‹åºåœ°å€ï¼Œä¹‹å‰å¹¶æ²¡æœ‰è¿‡pcç«¯åº”ç”¨ç¨‹åºå¼€å‘çš„ç»éªŒï¼Œ æ‰€ä»¥åœ¨å¹¿å¤§çš„äº’è”ç½‘ä¸Šæ¸¸è¡äº†ä¸¤å¤©ã€‚é¢ğŸ¥º

ä»Šå¤©æ‰¾åˆ°äº†è¿™ä¸ªåº“
[lnk\_parse](https://docs.rs/lnk_parser/latest/lnk_parser/)
å¾ˆå¥½çš„è§£å†³æ ‡é¢˜çš„è¿™ä¸ªé—®é¢˜ã€‚

## äºŒã€æ–‡æ¡£åŠgithubåœ°å€

æ‚¨å¯ä»¥åœ¨ä»¥ä¸‹é“¾æ¥æ‰¾åˆ°ä»–ï¼š

* lib.rsï¼ˆæ¨èï¼‰:
  <https://lib.rs/crates/lnk_parser>
* githubï¼ˆæ¨èï¼‰ï¼š
  <https://github.com/abdulrhmanalfaifi/lnk_parser>
* docs.rsï¼ˆæ²¡æœ‰ç¤ºä¾‹ä»£ç ï¼‰:
  <https://lib.rs/crates/lnk_parser>

## ä¸‰ã€ ä½¿ç”¨

1. åœ¨
   `Cargo.toml`
   æ–‡ä»¶ä¸­

```
[dependencies]
lnk_parser = "0.4.0"   #  æ·»åŠ è¿™è¡Œ

```

2. ä½¿ç”¨ç¤ºä¾‹

```rust
use std::fs::File;
use std::io::Write;
use lnk_parser::LNKParser;

fn main() {
    let lnk_path = "example.lnk";
    let mut  file = File::open(lnk_path).unwrap();
    let lnk_file = LNKParser::from_reader(&mut file).unwrap();
    
    // å°†ç»“æœè½¬åŒ–æˆjsonæ–‡ä»¶è¾“åˆ°./lnk.jsonä¸­
    let json = serde_json::to_string(&lnk_file).unwrap();
    let mut output_file = File::create("./lnk.json").unwrap();
    output_file.write_all(json.as_bytes()).unwrap();
}

```

è¾“å‡ºçš„
`json`
å†…å®¹å¦‚ä¸‹(è¿™é‡Œå¤åˆ¶çš„
`lnk_parse`
ç»™å‡ºçš„ç¤ºä¾‹)

```json
{
    "target_full_path": "C:\\Users\\u0041\\Desktop\\test\\test.txt",
    "lnk_file_metadata": {
        "full_path": "C:\\Users\\u0041\\Documents\\Projects\\LNKParser-rs\\samples\\WIN10\\1607_14393\\windows_generated.lnk",
        "mtime": "2021-02-08T12:52:20Z",
        "atime": "2021-02-13T19:14:07Z",
        "ctime": "2021-02-08T12:52:13Z"
    },
    "shell_link_header": {
        "file_attr": [
            "ARCHIVE"
        ],
        "mtime": "2021-02-08T12:41:58Z",
        "atime": "2021-02-08T12:41:03Z",
        "ctime": "2021-02-08T12:41:03Z",
        "file_size": 4
    },
    "link_target_id_list": {
        "id_list": [
            {
                "shell_item_data": {
                    "FileEntry": {
                        "is_file": false,
                        "file_size": 0,
                        "last_modified": "2021-02-08T12:46:24Z",
                        "file_attr_flags": [
                            "DIRECTORY"
                        ],
                        "name": "test",
                        "extention_block": {
                            "ctime": "2021-02-08T12:46:24Z",
                            "atime": "2021-02-08T12:46:24Z",
                            "file_ref": {
                                "mft_entry": 91461,
                                "sequence_number": 3
                            },
                            "primary_name": "test"
                        }
                    }
                }
            },
            {
                "shell_item_data": {
                    "FileEntry": {
                        "is_file": true,
                        "file_size": 4,
                        "last_modified": "2021-02-08T12:42:00Z",
                        "file_attr_flags": [
                            "ARCHIVE"
                        ],
                        "name": "test.txt",
                        "extention_block": {
                            "ctime": "2021-02-08T12:41:04Z",
                            "atime": "2021-02-08T12:41:04Z",
                            "file_ref": {
                                "mft_entry": 90070,
                                "sequence_number": 3
                            },
                            "primary_name": "test.txt"
                        }
                    }
                }
            }
        ]
    },
    "link_info": {
        "volume_id": {
            "drive_type": "DRIVE_FIXED",
            "serial_number": "E02E-8A93"
        },
        "local_base_path": "C:\\Users\\u0041\\Desktop\\test\\test.txt"
    },
    "relative_path": "..\\..\\..\\..\\..\\Desktop\\test\\test.txt",
    "working_dir": "C:\\Users\\u0041\\Desktop\\test",
    "extra_data": {
        "extra_data_blocks": [
            {
                "Tracker": {
                    "machine_id": "win10",
                    "file_droid": "BD4FAD74-6A0A-11EB-8ECF-5076AFA95947",
                    "file_droid_birth": "BD4FAD74-6A0A-11EB-8ECF-5076AFA95947",
                    "volume_droid": "00D2581C-4749-44BD-9381-9BDFADF8A9DE",
                    "volume_droid_birth": "00D2581C-4749-44BD-9381-9BDFADF8A9DE"
                }
            }
        ]
    }
}

```

è‡³äºå¦‚ä½•è·å–å›¾æ ‡ï¼ˆçœ‹æœ‰æ³¨é‡Šé‚£è¡Œï¼‰ï¼š

```rust
use std::fs::File;
use std::io::Write;
use lnk_parser::LNKParser;

fn main() {
    let lnk_path = "example.lnk";
    let mut  file = File::open(lnk_path).unwrap();
    let lnk_file = LNKParser::from_reader(&mut file).unwrap();
    let icon = lnk_file.get_icon_location(); // ä½¿ç”¨è¿™ä¸ªæ–¹æ³•å°±å¯ä»¥è·å–lnkçš„å›¾æ ‡
    let mut icon_path:String;
    if let Some(path) = icon {
        icon_path = path.string.clone();
        println!("path: {:?}",  path.string);
    }
}

```