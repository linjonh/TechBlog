---
layout: post
title: "C小游戏贪吃蛇详细过程全部代码"
date: 2020-11-28 22:44:41 +0800
description: "文章目录一、介绍1）背景2）环境3）演示游戏过程文件格式4)基本逻辑概述i 游戏主体ii 刷新iii"
keywords: "c#语言编写贪吃蛇代码"
categories: ['C']
tags: ['游戏', 'Winform', 'C', '.Net']
artid: "110295170"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=110295170
    alt: "C小游戏贪吃蛇详细过程全部代码"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=110295170
featuredImagePreview: https://bing.ee123.net/img/rand?artid=110295170
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     C#小游戏——贪吃蛇~详细过程+全部代码
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h6>
     <a id="_1">
     </a>
     一个好玩的🐍……
    </h6>
    <p>
    </p>
    <div class="toc">
     <h4>
      文章目录
     </h4>
     <ul>
      <li>
       <ul>
        <li>
         <ul>
          <li>
           <ul>
            <li>
             <ul>
              <li>
               <a href="#_1" rel="nofollow">
                一个好玩的🐍……
               </a>
              </li>
             </ul>
            </li>
           </ul>
          </li>
         </ul>
        </li>
       </ul>
      </li>
      <li>
       <a href="#_3" rel="nofollow">
        一、介绍
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#1_5" rel="nofollow">
          1）背景
         </a>
        </li>
        <li>
         <a href="#2_9" rel="nofollow">
          2）环境
         </a>
        </li>
        <li>
         <a href="#3_17" rel="nofollow">
          3）演示
         </a>
        </li>
        <li>
         <ul>
          <li>
           <a href="#_19" rel="nofollow">
            游戏过程
           </a>
          </li>
          <li>
           <a href="#_24" rel="nofollow">
            文件格式
           </a>
          </li>
         </ul>
        </li>
        <li>
         <a href="#4_29" rel="nofollow">
          4)基本逻辑概述
         </a>
        </li>
        <li>
         <ul>
          <li>
           <a href="#i__31" rel="nofollow">
            i 游戏主体
           </a>
          </li>
          <li>
           <a href="#ii__35" rel="nofollow">
            ii 刷新
           </a>
          </li>
          <li>
           <a href="#iii__39" rel="nofollow">
            iii 控制蛇的移动
           </a>
          </li>
          <li>
           <a href="#iiii__43" rel="nofollow">
            iiii 保存最高记录
           </a>
          </li>
          <li>
           <a href="#iiiii__51" rel="nofollow">
            iiiii 吃食物
           </a>
          </li>
          <li>
           <a href="#iiiiii_____55" rel="nofollow">
            iiiiii 记录用户的输入（很重要）
           </a>
          </li>
         </ul>
        </li>
       </ul>
      </li>
      <li>
       <a href="#_61" rel="nofollow">
        二、步骤
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#1ControlFrm_63" rel="nofollow">
          1）ControlFrm窗体
         </a>
        </li>
        <li>
         <a href="#2GameFrm_103" rel="nofollow">
          2）GameFrm窗体：游戏窗体
         </a>
        </li>
        <li>
         <ul>
          <li>
           <a href="#i____107" rel="nofollow">
            i 变量
           </a>
          </li>
          <li>
           <a href="#ii___139" rel="nofollow">
            ii 窗体加载事件
           </a>
          </li>
          <li>
           <a href="#iii_______164" rel="nofollow">
            iii 玩家敲击键盘的事件
           </a>
          </li>
          <li>
           <a href="#iiii___timer1_tick_208" rel="nofollow">
            iiii timer1 tick事件：
           </a>
          </li>
          <li>
           <a href="#iiiii_____243" rel="nofollow">
            iiiii 相关方法
           </a>
          </li>
          <li>
           <ul>
            <li>
             <a href="#_245" rel="nofollow">
              蛇移动的方法
             </a>
            </li>
            <li>
             <a href="#_332" rel="nofollow">
              擦除蛇身
             </a>
            </li>
            <li>
             <a href="#_344" rel="nofollow">
              生成食物
             </a>
            </li>
            <li>
             <a href="#_371" rel="nofollow">
              判断是否吃到食物
             </a>
            </li>
            <li>
             <a href="#_384" rel="nofollow">
              从磁盘文件中获取历史最高分
             </a>
            </li>
            <li>
             <a href="#_409" rel="nofollow">
              播放音乐
             </a>
            </li>
            <li>
             <a href="#_434" rel="nofollow">
              死之前判断是否打破了记录
             </a>
            </li>
           </ul>
          </li>
          <li>
           <a href="#iiiiii____timer2_451" rel="nofollow">
            iiiiii timer2事件
           </a>
          </li>
         </ul>
        </li>
       </ul>
      </li>
      <li>
       <a href="#_462" rel="nofollow">
        三、最后
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#1_464" rel="nofollow">
          1）整个工程文件
         </a>
        </li>
        <li>
         <a href="#2_476" rel="nofollow">
          2）扩展
         </a>
        </li>
        <li>
         <a href="#3_491" rel="nofollow">
          3）最后
         </a>
        </li>
       </ul>
      </li>
     </ul>
    </div>
    <p>
    </p>
    <h2>
     <a id="_3">
     </a>
     一、介绍
    </h2>
    <h3>
     <a id="1_5">
     </a>
     1）背景
    </h3>
    <p>
     一到期末课就基本没了。闲来无事，整理一下之前写的C#的一个小游戏——贪吃蛇。今年疫情在家写的，蛮有趣的吧！
    </p>
    <h3>
     <a id="2_9">
     </a>
     2）环境
    </h3>
    <p>
     系统：Windows 10
    </p>
    <p>
     环境：.Net Framework 4.7
    </p>
    <p>
     平台：VS 2019
    </p>
    <h3>
     <a id="3_17">
     </a>
     3）演示
    </h3>
    <h4>
     <a id="_19">
     </a>
     游戏过程
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/126c924d3776526a66c879075b066437.gif#pic_center"/>
    </p>
    <h4>
     <a id="_24">
     </a>
     文件格式
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/b2359fff754c9bf57aa6ad5dfc77e735.png#pic_center"/>
    </p>
    <h3>
     <a id="4_29">
     </a>
     4)基本逻辑概述
    </h3>
    <h4>
     <a id="i__31">
     </a>
     i 游戏主体
    </h4>
    <p>
     声明Label类型的二维数组，表示每一个格子，用不同的颜色来区分蛇和地图（例如，表示蛇身的label的BackColor设置为蓝色，食物设置为红色，其他的设置为绿色）;
    </p>
    <h4>
     <a id="ii__35">
     </a>
     ii 刷新
    </h4>
    <p>
     通过timer刷新。每一次刷新，蛇会朝着其蛇头的方向移动一格。所以通过对timer的interval属性控制蛇移动的快慢。
    </p>
    <h4>
     <a id="iii__39">
     </a>
     iii 控制蛇的移动
    </h4>
    <p>
     在timer中，同时判断有无键盘（w，s，a，d）的输入，进行改变蛇的移动方向（也是通过修改label的颜色实现）。
    </p>
    <h4>
     <a id="iiii__43">
     </a>
     iiii 保存最高记录
    </h4>
    <p>
     程序自动创建二进制文件
     <font color="orange">
      MaxScore.dat
     </font>
     ，每次游戏结束时，读取数据，判断大小，并保存。
    </p>
    <p>
     该文件路径是程序的bin目录Debug下。
    </p>
    <h4>
     <a id="iiiii__51">
     </a>
     iiiii 吃食物
    </h4>
    <p>
     random生成食物的位置，将该位置的label颜色设置为红色，就可以吃了。在timer中判断是否吃到了食物，进行增长的操作。
    </p>
    <h4>
     <a id="iiiiii_____55">
     </a>
     iiiiii 记录用户的输入（很重要）
    </h4>
    <p>
     有时用户有可能连续输入多个值（如上上上左左），这些值输入的间隔可能会小于timer的interval值，造成
     <font color="red">
      ”上一个动作还没有完成，直接进行下一个动作了，从而导致误判死亡！”
     </font>
    </p>
    <p>
     我的解决办法是：用string字符串记录用户的输入，每次输入都加到该字符串的末尾。而每次的timer从该字符串的串首取值，这样一来，玩家可以的连续输入，不影响timer的刷新。
    </p>
    <h2>
     <a id="_61">
     </a>
     二、步骤
    </h2>
    <h3>
     <a id="1ControlFrm_63">
     </a>
     1）ControlFrm窗体
    </h3>
    <p>
     项目的初始运行的窗体，就三个按钮，分别打开不同的窗体：
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/07e268385f90d67dd5d6037f341f2d51.png#pic_center"/>
    </p>
    <p>
     代码逻辑如下：
    </p>
    <pre><code class="prism language-csharp"><span class="token keyword">namespace</span> 贪吃蛇
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">partial</span> <span class="token keyword">class</span> <span class="token class-name">ControlFrm</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Form</span></span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">public</span> <span class="token function">ControlFrm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">InitializeComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//“关于”按钮click</span>
        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">button3_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">AboutMe</span> hf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">AboutMe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            hf<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//“玩法介绍”按钮click</span>
        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">button2_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">HowToPlay</span> htp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HowToPlay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            htp<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//“开始游戏”按钮click</span>
        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">button1_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">GameFrm</span> gf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">GameFrm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            gf<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="2GameFrm_103">
     </a>
     2）GameFrm窗体：游戏窗体
    </h3>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/88cc7eb15a8d794077f3b074bc295d21.png#pic_center"/>
    </p>
    <h4>
     <a id="i____107">
     </a>
     i 变量
    </h4>
    <pre><code class="prism language-csharp"><span class="token comment">//绘制地图</span>
<span class="token class-name"><span class="token keyword">int</span></span> mapX <span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">,</span> mapY <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span><span class="token comment">//设定游戏地图边界</span>
<span class="token class-name">Label<span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token punctuation">]</span></span> mapArray<span class="token punctuation">;</span><span class="token comment">//定义地图格子的二维数组</span>
<span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> snakeX <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{<!-- --></span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token punctuation">}</span>；<span class="token comment">//snakeX[snakeX.Count-1]是蛇的头部。即初始时头部为2</span>
<span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> snakeY <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{<!-- --></span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//利用集合存放蛇身</span>
<span class="token class-name"><span class="token keyword">int</span></span> foodX<span class="token punctuation">,</span> foodY<span class="token punctuation">;</span><span class="token comment">//食物的坐标点</span>
<span class="token class-name"><span class="token keyword">string</span></span> kCode <span class="token operator">=</span> <span class="token string">"D"</span><span class="token punctuation">;</span><span class="token comment">//控制蛇移动的方向,初始值向右</span>
<span class="token comment">//level等级snakeX.Count&gt;=10</span>
<span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> level <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//值是timer的时间，等级越高时间越短</span>
<span class="token class-name"><span class="token keyword">int</span></span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//等级</span>
<span class="token comment">//枚举，游戏中的背景音乐，吃食物以及死亡音乐</span>
<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">Sound</span>
<span class="token punctuation">{<!-- --></span>
    background<span class="token punctuation">,</span> eat<span class="token punctuation">,</span> gameover
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//得分</span>
<span class="token class-name"><span class="token keyword">int</span></span> Score <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token comment">//历史最高分</span>
<span class="token class-name"><span class="token keyword">int</span></span> MaxScore<span class="token punctuation">;</span>
<span class="token comment">//存储最高分记录的文件路径</span>
<span class="token class-name"><span class="token keyword">string</span></span> path <span class="token operator">=</span> <span class="token string">"MaxScore.dat"</span><span class="token punctuation">;</span>

<span class="token comment">//字符串队列，键盘每次的输入则入队</span>
<span class="token class-name"><span class="token keyword">string</span></span> ClikRecord <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>

<span class="token preprocessor property">#<span class="token directive keyword">endregion</span></span>
</code></pre>
    <h4>
     <a id="ii___139">
     </a>
     ii 窗体加载事件
    </h4>
    <pre><code class="prism language-csharp"><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Form1_Load</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//从磁盘文件中获取历史最高分</span>
    <span class="token function">GetMaxScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//1、创建地图</span>
    <span class="token function">GreateMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//2、创建蛇身</span>
    <span class="token function">GreateSnake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//3、创建食物</span>
    <span class="token function">GreateFood</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//4、蛇身移动（死亡、吃食物）</span>
    timer1<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//计时器开启</span>
    <span class="token comment">//5、播放音乐</span>
    <span class="token function">PlayerMusic</span><span class="token punctuation">(</span>Sound<span class="token punctuation">.</span>background<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//初始化窗体下部的状态栏</span>
    toolStripStatusLabel3<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">"         当前得分："</span> <span class="token operator">+</span> Score<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    toolStripStatusLabel4<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">"         历史最高得分："</span> <span class="token operator">+</span> MaxScore<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    toolStripStatusLabel1<span class="token punctuation">.</span>Text <span class="token operator">=</span> DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//日期时间</span>
    toolStripStatusLabel2<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">"                当前等级："</span> <span class="token operator">+</span> <span class="token punctuation">(</span>k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> 
</code></pre>
    <h4>
     <a id="iii_______164">
     </a>
     iii 玩家敲击键盘的事件
    </h4>
    <pre><code class="prism language-csharp"><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Form1_KeyDown</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">KeyEventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name"><span class="token keyword">string</span></span> newKey <span class="token operator">=</span> e<span class="token punctuation">.</span>KeyCode<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//注意，当蛇向右时不能直接向左。同理，其他情况也类似</span>
    <span class="token class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token string">"W"</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">,</span> <span class="token string">"S"</span><span class="token punctuation">,</span> <span class="token string">"P"</span> <span class="token punctuation">,</span><span class="token string">"L"</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>newKey<span class="token punctuation">)</span><span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token comment">//若按下的键不是这六个键的话</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>kCode<span class="token operator">==</span><span class="token string">"A"</span><span class="token operator">&amp;&amp;</span>newKey<span class="token operator">==</span><span class="token string">"D"</span><span class="token operator">||</span>
       kCode <span class="token operator">==</span> <span class="token string">"D"</span> <span class="token operator">&amp;&amp;</span> newKey <span class="token operator">==</span> <span class="token string">"A"</span> <span class="token operator">||</span>
       kCode <span class="token operator">==</span> <span class="token string">"W"</span> <span class="token operator">&amp;&amp;</span> newKey <span class="token operator">==</span> <span class="token string">"S"</span> <span class="token operator">||</span>
       kCode <span class="token operator">==</span> <span class="token string">"S"</span> <span class="token operator">&amp;&amp;</span> newKey <span class="token operator">==</span> <span class="token string">"W"</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>newKey <span class="token operator">==</span> <span class="token string">"P"</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        timer1<span class="token punctuation">.</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>newKey<span class="token operator">==</span><span class="token string">"L"</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        timer1<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//修复BUG：</span>
    <span class="token comment">//这里一个BUG的情况：在游戏时，假如蛇的方向为D，快速敲击键盘W、D时，</span>
    <span class="token comment">//程序会来不及进入timer事件，这时蛇的状态不能经历W，直接到D，造成后面的程序</span>
    <span class="token comment">//会判断蛇咬到了自己。</span>
    <span class="token comment">//办法：加入string类型的ClikRecord当作键盘输入队列，在timer事件中取其第一个字符。</span>
    <span class="token comment">//同时仍要加入kCode=newKey，若不加的话，则前面的kcode可能会等于现在的newkey，即使他们没有挨着</span>
    kCode <span class="token operator">=</span> newKey<span class="token punctuation">;</span>
    ClikRecord <span class="token operator">=</span> ClikRecord <span class="token operator">+</span> newKey<span class="token punctuation">;</span>
<span class="token punctuation">}</span> 
<span class="token preprocessor property">#<span class="token directive keyword">endregion</span></span>

</code></pre>
    <p>
     此处的“修复BUG”就是我开始的时候说的：有时用户有可能连续输入多个值（如上上上左左），这些值输入的间隔可能会小于timer的interval值，造成
     <font color="red">
      ”上一个动作还没有完成，直接进行下一个动作了，从而导致误判死亡！”
     </font>
    </p>
    <h4>
     <a id="iiii___timer1_tick_208">
     </a>
     iiii timer1 tick事件：
    </h4>
    <p>
     这个就是对蛇进行操作刷新的事件
    </p>
    <pre><code class="prism language-csharp"><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">timer1_Tick</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//窗体下部的状态栏保持更新</span>
    toolStripStatusLabel3<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">"                当前得分："</span> <span class="token operator">+</span> Score<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    toolStripStatusLabel2<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">"                 当前等级："</span> <span class="token operator">+</span> <span class="token punctuation">(</span>k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span><span class="token punctuation">(</span>Score<span class="token operator">%</span><span class="token number">10</span><span class="token operator">==</span><span class="token number">0</span> <span class="token operator">&amp;&amp;</span> Score<span class="token operator">/</span><span class="token number">10</span><span class="token operator">&lt;=</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        k <span class="token operator">=</span> Score <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">//当得分在20以内时，设置等级</span>
        timer1<span class="token punctuation">.</span>Interval <span class="token operator">=</span> level<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//根据不同的等级设置不同的interval值，下同</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>Score<span class="token operator">%</span><span class="token number">10</span><span class="token operator">==</span><span class="token number">0</span> <span class="token operator">&amp;&amp;</span> Score<span class="token operator">/</span><span class="token number">10</span><span class="token operator">==</span><span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        k<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//等级加1</span>
        timer1<span class="token punctuation">.</span>Interval <span class="token operator">=</span> level<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Score <span class="token operator">%</span> <span class="token number">10</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> Score <span class="token operator">/</span> <span class="token number">10</span> <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        k<span class="token operator">++</span><span class="token punctuation">;</span>
        timer1<span class="token punctuation">.</span>Interval <span class="token operator">=</span> level<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ClikRecord<span class="token punctuation">.</span>Length<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        kCode <span class="token operator">=</span> ClikRecord<span class="token punctuation">.</span><span class="token function">Substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//取第一个字符的字符串</span>
        ClikRecord <span class="token operator">=</span> ClikRecord<span class="token punctuation">.</span><span class="token function">Substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> ClikRecord<span class="token punctuation">.</span>Length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">SnakeMove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//蛇移动方法</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="iiiii_____243">
     </a>
     iiiii 相关方法
    </h4>
    <h5>
     <a id="_245">
     </a>
     蛇移动的方法
    </h5>
    <pre><code class="prism language-csharp"><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SnakeMove</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//1、擦除</span>
    <span class="token function">ClearSnake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//2、修改坐标</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>kCode <span class="token operator">!=</span> <span class="token string">"P"</span><span class="token operator">&amp;&amp;</span>kCode<span class="token operator">!=</span><span class="token string">"L"</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> snakeX<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">//snakeX.Count-1忽略头部</span>
        <span class="token punctuation">{<!-- --></span>
            snakeX<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> snakeX<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            snakeY<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> snakeY<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>kCode<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">case</span> <span class="token string">"A"</span><span class="token punctuation">:</span>
                snakeX<span class="token punctuation">[</span>snakeX<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">--</span><span class="token punctuation">;</span><span class="token comment">//头部坐标减1</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">"W"</span><span class="token punctuation">:</span>
                snakeY<span class="token punctuation">[</span>snakeX<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">--</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">"D"</span><span class="token punctuation">:</span>
                snakeX<span class="token punctuation">[</span>snakeX<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">"S"</span><span class="token punctuation">:</span>
                snakeY<span class="token punctuation">[</span>snakeX<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//3、吃食物</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">EatFood</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//若吃到了食物</span>
    <span class="token punctuation">{<!-- --></span>
        Score<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//得分加1</span>
        <span class="token function">PlayerMusic</span><span class="token punctuation">(</span>Sound<span class="token punctuation">.</span>eat<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//播放吃食物的声音</span>
        snakeX<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        snakeY<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//增加一个元素，值先不管，就按0吧</span>
        <span class="token comment">//蛇身还原</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i<span class="token operator">=</span>snakeY<span class="token punctuation">.</span>Count<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">--</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            snakeX<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> snakeX<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            snakeY<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> snakeY<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">GreateFood</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//重新生成一个食物</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//4、判断是否咬到自己的身体（只需判断头部与身体是否重叠即可）</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>snakeX<span class="token punctuation">.</span>Count<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>snakeX<span class="token punctuation">[</span>snakeX<span class="token punctuation">.</span>Count<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">==</span>snakeX<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>
            snakeY<span class="token punctuation">[</span>snakeX<span class="token punctuation">.</span>Count<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">==</span>snakeY<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            timer1<span class="token punctuation">.</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">PlayerMusic</span><span class="token punctuation">(</span>Sound<span class="token punctuation">.</span>gameover<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//播放死亡的音乐</span>
            MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"你把自己咬死了！！！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>Score<span class="token operator">&gt;</span>MaxScore<span class="token punctuation">)</span><span class="token comment">//如果打破了记录</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token function">BreadARecord</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//将新纪录写入文件</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//5、判断蛇是否超出边界</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>snakeX<span class="token punctuation">[</span>snakeX<span class="token punctuation">.</span>Count<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;</span><span class="token number">0</span><span class="token operator">||</span>
        snakeY<span class="token punctuation">[</span>snakeX<span class="token punctuation">.</span>Count<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;</span><span class="token number">0</span><span class="token operator">||</span>
        snakeX<span class="token punctuation">[</span>snakeX<span class="token punctuation">.</span>Count<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;</span>mapX<span class="token operator">-</span><span class="token number">1</span><span class="token operator">||</span>
        snakeY<span class="token punctuation">[</span>snakeX<span class="token punctuation">.</span>Count<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&gt;</span>mapY<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        timer1<span class="token punctuation">.</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">PlayerMusic</span><span class="token punctuation">(</span>Sound<span class="token punctuation">.</span>gameover<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//播放死亡的音乐</span>
        MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"你撞墙上了！！！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>Score <span class="token operator">&gt;</span> MaxScore<span class="token punctuation">)</span><span class="token comment">//如果打破了记录</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">BreadARecord</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//将新纪录写入文件</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//6、重新显示</span>
    <span class="token function">GreateSnake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h5>
     <a id="_332">
     </a>
     擦除蛇身
    </h5>
    <pre><code class="prism language-csharp"><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ClearSnake</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> snakeX<span class="token punctuation">.</span>Count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        mapArray<span class="token punctuation">[</span>snakeY<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> snakeX<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>BackColor <span class="token operator">=</span> Color<span class="token punctuation">.</span>Green<span class="token punctuation">;</span><span class="token comment">//label数组mapArry,根据蛇身的下标，改变label的颜色当作蛇身</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h5>
     <a id="_344">
     </a>
     生成食物
    </h5>
    <pre><code class="prism language-csharp"><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">GreateFood</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name"><span class="token keyword">bool</span></span> flag<span class="token punctuation">;</span><span class="token comment">//标记是否重叠</span>
    <span class="token keyword">do</span>
    <span class="token punctuation">{<!-- --></span>
        flag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token class-name">Random</span> r <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        foodX <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span>mapX<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//0-39</span>
        foodY <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span>mapY<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//0-19</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>snakeX<span class="token punctuation">.</span>Count<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>snakeX<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>foodX<span class="token operator">&amp;&amp;</span>snakeY<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>foodY<span class="token punctuation">)</span><span class="token comment">//如果食物与蛇身重叠</span>
            <span class="token punctuation">{<!-- --></span>
                flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//若flag为true，则表示重叠，则重新循环</span>
    
    mapArray<span class="token punctuation">[</span>foodY<span class="token punctuation">,</span> foodX<span class="token punctuation">]</span><span class="token punctuation">.</span>BackColor <span class="token operator">=</span> Color<span class="token punctuation">.</span>Red<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre>
    <h5>
     <a id="_371">
     </a>
     判断是否吃到食物
    </h5>
    <pre><code class="prism language-csharp"><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">EatFood</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
     <span class="token keyword">if</span><span class="token punctuation">(</span>snakeX<span class="token punctuation">[</span>snakeX<span class="token punctuation">.</span>Count<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">==</span>foodX<span class="token operator">&amp;&amp;</span>snakeY<span class="token punctuation">[</span>snakeX<span class="token punctuation">.</span>Count<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">==</span>foodY<span class="token punctuation">)</span>
     <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
     <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h5>
     <a id="_384">
     </a>
     从磁盘文件中获取历史最高分
    </h5>
    <pre><code class="prism language-csharp"><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">GetMaxScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>File<span class="token punctuation">.</span><span class="token function">Exists</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token operator">==</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token comment">//若不存在此文件</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">FileStream</span> fs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FileStream</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> FileMode<span class="token punctuation">.</span>Create<span class="token punctuation">,</span> FileAccess<span class="token punctuation">.</span>Write<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">BinaryWriter</span> bw <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">BinaryWriter</span><span class="token punctuation">(</span>fs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bw<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        MaxScore <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        fs<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bw<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">FileStream</span> fs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FileStream</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> FileMode<span class="token punctuation">.</span>Open<span class="token punctuation">,</span> FileAccess<span class="token punctuation">.</span>Read<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">BinaryReader</span> br <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">BinaryReader</span><span class="token punctuation">(</span>fs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        MaxScore <span class="token operator">=</span> br<span class="token punctuation">.</span><span class="token function">ReadInt32</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fs<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        br<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre>
    <h5>
     <a id="_409">
     </a>
     播放音乐
    </h5>
    <p>
     在游戏开始、游戏结束、吃到食物和撞墙时发出相应的声音
    </p>
    <pre><code class="prism language-csharp"><span class="token class-name">SoundPlayer</span> soundPlayer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SoundPlayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">PlayerMusic</span><span class="token punctuation">(</span><span class="token class-name">Sound</span> s<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>s<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">case</span> Sound<span class="token punctuation">.</span>background<span class="token punctuation">:</span>
            soundPlayer<span class="token punctuation">.</span>SoundLocation <span class="token operator">=</span> <span class="token string">"1.wav"</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> Sound<span class="token punctuation">.</span>eat<span class="token punctuation">:</span>
            soundPlayer<span class="token punctuation">.</span>SoundLocation <span class="token operator">=</span> <span class="token string">"2.wav"</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> Sound<span class="token punctuation">.</span>gameover<span class="token punctuation">:</span>
            soundPlayer<span class="token punctuation">.</span>SoundLocation <span class="token operator">=</span> <span class="token string">"4.wav"</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    soundPlayer<span class="token punctuation">.</span><span class="token function">Play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//播放</span>
<span class="token punctuation">}</span>

</code></pre>
    <h5>
     <a id="_434">
     </a>
     死之前判断是否打破了记录
    </h5>
    <pre><code class="prism language-csharp"><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">BreadARecord</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//将新纪录写入文件</span>
    <span class="token class-name">FileStream</span> fs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FileStream</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> FileMode<span class="token punctuation">.</span>Truncate<span class="token punctuation">,</span> FileAccess<span class="token punctuation">.</span>Write<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">BinaryWriter</span> bw <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">BinaryWriter</span><span class="token punctuation">(</span>fs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    bw<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>Score<span class="token punctuation">)</span><span class="token punctuation">;</span>
    fs<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    bw<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//告诉玩家这个好消息</span>
    MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"恭喜你，创造了新纪录！！！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token preprocessor property">#<span class="token directive keyword">endregion</span></span>
</code></pre>
    <h4>
     <a id="iiiiii____timer2_451">
     </a>
     iiiiii timer2事件
    </h4>
    <p>
     这就一个作用：刷新在状态栏的时间
    </p>
    <pre><code class="prism language-csharp"><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">timer2_Tick</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    toolStripStatusLabel1<span class="token punctuation">.</span>Text <span class="token operator">=</span> DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//日期时间</span>
<span class="token punctuation">}</span>
</code></pre>
    <h2>
     <a id="_462">
     </a>
     三、最后
    </h2>
    <h3>
     <a id="1_464">
     </a>
     1）整个工程文件
    </h3>
    <p>
     其实上面已经包含了所有代码。你只需要稍微动动手，就能写出来完整的程序了。
    </p>
    <p>
     我建议你自己动手写写。或者你需要帮忙的话可以联系我！
    </p>
    <p>
     如果你需要完成的文件，也可以私信我！
    </p>
    <p>
     这里是全部代码：
     <a href="https://github.com/GoodZheng/Snake_.Net-csharp">
      https://github.com/GoodZheng/Snake_.Net-csharp
     </a>
    </p>
    <p>
     有帮助的话可以给个star，多谢多谢。
    </p>
    <h3>
     <a id="2_476">
     </a>
     2）扩展
    </h3>
    <p>
     有什么扩展的思路吗？
    </p>
    <p>
     1、弄成蛇头和蛇身不一样吧，比如这样的蛇？哈哈哈哈哈哈哈哈哈哈~
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/460ca63c8edfa7084dd35015955a542f.png#pic_center"/>
    </p>
    <p>
     2、长按一个方向键能进行加速？
     <br/>
     3、生成一些特殊的食物，比如吃了能
     <font color="blue">
      加一条命
     </font>
     ？
    </p>
    <p>
     等等吧，看你自由发挥。
    </p>
    <h3>
     <a id="3_491">
     </a>
     3）最后
    </h3>
    <p>
     有什么可以改进的地方请留言呐。
     <br/>
     <font color="yellow">
      ***************************************************************************************************************************
     </font>
     <br/>
     Don’t forget follow and like!!!
     <br/>
     啥意思？我想想……
     <font color="blue">
      别忘了点赞+关注
     </font>
     ~~~~
     <s>
      <s>
       <s>
        ------
        <s>
         <s>
          <s>
           哈哈哈哈哈
          </s>
         </s>
        </s>
       </s>
      </s>
     </s>
     --------------
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/32758a86c51d2b5d356d773f576c8284.gif#pic_center"/>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34343939363039302f:61727469636c652f64657461696c732f313130323935313730" class_="artid" style="display:none">
 </p>
</div>


