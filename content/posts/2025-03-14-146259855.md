---
arturl_encode: "6874747073:3a2f2f626c6f672e6373646e2e6e65742f6368726e68616f2f:61727469636c652f64657461696c732f313436323539383535"
layout: post
title: "STAR-Decomposition-ä¸€ç§é’ˆå¯¹æç«¯äº‹ä»¶çš„ä¿¡å·åˆ†è§£æ–¹æ³•-è®ºæ–‡ç²¾è¯»åŠ å¤ç°"
date: 2025-03-14 19:39:05 +0800
description: "æœ¬æ–‡å¤ç°äº†ä¸€ç§é’ˆå¯¹æç«¯äº‹ä»¶çš„ STAR ä¿¡å·åˆ†è§£ç®—æ³•çš„ï¼Œé¦–å…ˆé€å¥ç²¾è¯»äº†è®ºæ–‡éƒ¨åˆ†ï¼Œä¹‹åæ‰‹æ“å¤ç°äº†åˆ†è§£ä»£ç ï¼Œå¹¶æä¾›äº†ä»£ç é€è¡Œè§£é‡Šå’Œ é¡¹ç›®çš„ GitHub åœ°å€ã€‚"
keywords: "STAR Decomposition ä¸€ç§é’ˆå¯¹æç«¯äº‹ä»¶çš„ä¿¡å·åˆ†è§£æ–¹æ³• è®ºæ–‡ç²¾è¯»åŠ å¤ç°"
categories: ['æœªåˆ†ç±»']
tags: ['ä¿¡å·å¤„ç†']
artid: "146259855"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146259855
    alt: "STAR-Decomposition-ä¸€ç§é’ˆå¯¹æç«¯äº‹ä»¶çš„ä¿¡å·åˆ†è§£æ–¹æ³•-è®ºæ–‡ç²¾è¯»åŠ å¤ç°"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146259855
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146259855
cover: https://bing.ee123.net/img/rand?artid=146259855
image: https://bing.ee123.net/img/rand?artid=146259855
img: https://bing.ee123.net/img/rand?artid=146259855
---

# STAR Decomposition ä¸€ç§é’ˆå¯¹æç«¯äº‹ä»¶çš„ä¿¡å·åˆ†è§£æ–¹æ³• è®ºæ–‡ç²¾è¯»åŠ å¤ç°

## STAR åˆ†è§£ ğŸš€

---

åœ¨æ—¶åºé¢„æµ‹ä»»åŠ¡ä¸­ï¼Œä¸ºäº†æƒ…ç»ªåŒ–ä¿¡å·çš„å„ç§æˆåˆ†ï¼Œä¾‹å¦‚è¶‹åŠ¿ä¿¡æ¯å­£èŠ‚ä¿¡æ¯ç­‰å¾€å¾€éƒ½éœ€è¦å¯¹ä¿¡å·è¿›è¡Œåˆ†è§£ã€‚ç›®å‰ç†ŸçŸ¥çš„åˆ†è§£æ–¹å¼æœ‰å¾ˆå¤šç§ï¼Œç»éªŒæ¨¡æ€åˆ†è§£ EMD å˜åˆ†æ¨¡æ€åˆ†è§£ VMD ï¼Œè¿˜æœ‰ é›†åˆç»éªŒæ¨¡æ€åˆ†è§£ EEMDï¼Œè‡ªé€‚åº”å™ªå£°å®Œå¤‡é›†åˆç»éªŒæ¨¡æ€åˆ†è§£ CEEMDAN ç­‰ç­‰ï¼Œä½†è¿™äº›å’Œå°æ³¢å˜æ¢åˆ†è§£ç±»ä¼¼ï¼Œä¸€èˆ¬éƒ½ä¸ä¼šé’ˆå¯¹å¼‚å¸¸ä¿¡å·å’Œæç«¯äº‹ä»¶è¿›è¡Œåˆ†è§£ã€‚STAR æ˜¯ä¸€ä¸ªæ¯”è¾ƒå†·é—¨çš„åˆ†è§£æ–¹å¼ï¼Œæ˜¯æˆ‘åœ¨Paper with Code æ·˜å®çš„æ—¶å€™å‘ç°çš„ï¼Œä»–æ¥æºäº 2022 å¹´çš„ ä¸€ç¯‡å«
[AA-Forecast: Anomaly-Aware Forecast for Extreme Events](https://paperswithcode.com/paper/aa-forecast-anomaly-aware-forecast-for)
ã€‚ä¸­æå‡ºçš„ï¼Œä¸ªäººè®¤ä¸ºè¿™å—æ˜¯ä¸€ä¸ªæ¯”è¾ƒå®¹æ˜“æ‹¼å‡ºä¸€ä¸ªåˆ›æ–°ç‚¹çš„å†…å®¹ã€‚
  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/a210ab3d4bc74ebe83aba4724d02dea9.png)

  
æ ¹æ®è®ºæ–‡ç»“æ„å›¾ï¼Œæ•´ä¸ªè®ºæ–‡æ˜¯åˆ† STAR åˆ†è§£ï¼Œå¼‚å¸¸æ„ŸçŸ¥æ¨¡å‹ Anomaly-Aware Model ï¼ŒåŠ¨æ€ä¸ç¡®å®šæ€§ä¼˜åŒ– Dynamic Uncertainty Optimization ä¸‰ä¸ªéƒ¨åˆ†ï¼Œè¿™é‡Œå°±å…ˆå€¼å…³æ³¨ç¬¬ä¸€ä¸ª STAR åˆ†è§£çš„éƒ¨åˆ†ã€‚
  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/ae4a59a6aa3b43d59a361ee72b206118.png)

## 1.STAR Decomposition è®ºæ–‡ç²¾è¯»éƒ¨åˆ†

---

å¯¹äºè¿™ä¸ªåˆ†è§£æ–¹æ³•çš„æè¿°å†™åœ¨äº†è®ºæ–‡çš„ 3.1 éƒ¨åˆ†ï¼Œä¹Ÿä¸æ˜¯å¾ˆé•¿ï¼Œä½†æˆ‘ä¹Ÿæ˜¯æ•´ä½“ç²¾è¯»äº†ä¸‹æ¥ï¼Œä¹Ÿä» Paper with Code çš„å®˜æ–¹é“¾æ¥ä¸Šä¸‹è½½äº†ä»£ç è¿›è¡Œå¯¹ç…§ï¼Œå¯ä»¥è¯´å¦‚æœå…¶å®æœ‰ä¸€äº›æ ¸å¿ƒçš„åœ°æ–¹æ˜¯æ²¡æœ‰è®²æ¸…æ¥šçš„ï¼Œæ‰€ä»¥å¯¼è‡´çœ‹ä¸Šå»æŒºä¸é”™çš„ä¸œè¥¿ï¼Œæ²¡å•¥äººç”¨ï¼Œæ¥ä¸‹æ¥å°±ç›´æ¥å¯¹ 3.1 çš„éƒ¨åˆ†ç²¾è¯»ä¸€ä¸‹ï¼Œç¿»è¯‘çš„è¯æ˜¯ç»“åˆ DeepSeek åˆæ­¥ç¿»è¯‘ï¼Œç„¶ååŠ ä¸Šæˆ‘è‡ªå·±çš„ç†è§£ç²¾è°ƒçš„ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/20520d41420a4b3c82bcb03740bb2db5.png)

* *STAR decomposition is used as a strategy to not only extract the anomalies and sudden changes of data but also decompose the complex time series to its essential components.*
    
  **STARåˆ†è§£è¢«ç”¨ä½œä¸€ç§ç­–ç•¥ï¼Œä¸ä»…ç”¨äºæå–æ•°æ®çš„å¼‚å¸¸å€¼å’Œçªå˜ï¼Œè€Œä¸”è¿˜ç”¨äºå°†å¤æ‚çš„æ—¶é—´åºåˆ—åˆ†è§£ä¸ºå…¶åŸºæœ¬ç»„æˆéƒ¨åˆ†ã€‚**
* *Unfortunately, widely popular decomposition method such as STL [14] does not extract anomalies.*
    
  **ä¸å¹¸çš„æ˜¯ï¼Œå¹¿æ³›ä½¿ç”¨çš„ STL æ–¹æ³•ä¸é€‚ç”¨äºå»æå–å¼‚å¸¸å€¼**
  ã€‚

> STL ä¿¡å·åˆ†è§£æ–¹æ³•å³åŸºäºå±€éƒ¨åŠ æƒå›å½’çš„å­£èŠ‚æ€§è¶‹åŠ¿åˆ†è§£æ³•ï¼ˆSeasonal and Trend decomposition using Loessï¼‰ã€‚

* *Although recent works such as STR [15] and RobustSTL [16] are designed to be robust to the extreme effect of anomalies in their decomposition, they are not used to explicitly extract anomalies from the residual component.*
    
  **å°½ç®¡æœ€è¿‘çš„å·¥ä½œï¼Œå¦‚STR [15] å’Œ RobustSTL [16] è¢«è®¾è®¡ä¸ºåœ¨å…¶åˆ†è§£è¿‡ç¨‹ä¸­å¯¹å¼‚å¸¸çš„æç«¯æ•ˆåº”å…·æœ‰é²æ£’æ€§ï¼Œä½†å®ƒä»¬å¹¶æœªè¢«ç”¨æ¥æ˜ç¡®åœ°ä»æ®‹å·®åˆ†é‡ä¸­æå–å¼‚å¸¸ã€‚**
* *To alleviate these issues, we propose STAR decomposition that are decomposes the original time series

  x
  (
  k
  )
  x^{(k)}






  x










  (

  k

  )
  in multiplicative manner to its seasonal

  s
  (
  k
  )
  s^{(k)}






  s










  (

  k

  )
  ,trend

  t
  (
  k
  )
  t^{(k)}






  t










  (

  k

  )
  ,anomalies

  a
  (
  k
  )
  a^{(k)}






  a










  (

  k

  )
  , and residual

  r
  (
  k
  )
  r^{(k)}






  r










  (

  k

  )
  components:*
    

  **ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜æˆ‘ä»¬æå‡ºäº† STAR åˆ†è§£ ï¼Œå°†åŸå§‹ä¿¡å·

  x
  (
  k
  )
  x^{(k)}






  x










  (

  k

  )
  åˆ†è§£ä¸º å­£èŠ‚æˆåˆ†

  s
  (
  k
  )
  s^{(k)}






  s










  (

  k

  )
  ï¼Œè¶‹åŠ¿æˆåˆ†

  t
  (
  k
  )
  t^{(k)}






  t










  (

  k

  )
  ï¼Œå¼‚å¸¸æˆåˆ†

  a
  (
  k
  )
  a^{(k)}






  a










  (

  k

  )
  ï¼Œæ®‹å·®æˆåˆ†

  r
  (
  k
  )
  r^{(k)}






  r










  (

  k

  )
  çš„ç›¸ä¹˜ã€‚**
    




  x
  (
  k
  )
  =
  s
  (
  k
  )
  Ã—
  t
  (
  k
  )
  Ã—
  a
  (
  k
  )
  Ã—
  r
  (
  k
  )
  x^{(k)} = s^{(k)}Ã—t^{(k)}Ã—a^{(k)}Ã—r^{(k)}






  x










  (

  k

  )



  =






  s










  (

  k

  )



  Ã—






  t










  (

  k

  )



  Ã—






  a










  (

  k

  )



  Ã—






  r










  (

  k

  )

> å­£èŠ‚æˆåˆ†ï¼šæ˜¯æŒ‡æ—¶é—´åºåˆ—æ•°æ®ä¸­å‘ˆç°å‡ºçš„å‘¨æœŸæ€§ã€é‡å¤æ€§çš„æ¨¡å¼ï¼Œå…¶å‘¨æœŸé€šå¸¸æ˜¯å›ºå®šçš„ï¼Œä¸å­£èŠ‚ã€æœˆä»½ã€æ˜ŸæœŸã€ç”šè‡³ä¸€å¤©ä¸­çš„ä¸åŒæ—¶æ®µç­‰æ—¶é—´å› ç´ ç›¸å…³ã€‚

* *Such decomposition not only increases the dimensions of the original data but also supplies us withextracted anomalies.*
    
  è¿™ç§åˆ†è§£ä¸ä»…å¢åŠ äº†åŸå§‹çš„æ•°æ®ç»´åº¦ï¼Œè¿˜ä¸ºæˆ‘ä»¬æä¾›äº†æå–å‡ºçš„å¼‚å¸¸å€¼ã€‚
* As shown in Figure 1:
    
  åˆ†è§£æ•ˆæœå¦‚å›¾1æ‰€ç¤ºï¼š
    
  ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/1d65633e23af4929a5e4a6ec1caf593f.png)
* *we begin the decomposition by approximating the trend line

  t
  (
  k
  )
  t^{(k)}






  t










  (

  k

  )
  with the locally weighted scatterplot smoothing (i.e. LOESS).*
    
  **æˆ‘ä»¬é€šè¿‡å±€éƒ¨åŠ æƒæ•£ç‚¹ç‚¹å¹³æ»‘æ¥è¿‘ä¼¼è¶‹åŠ¿çº¿

  t
  (
  k
  )
  t^{(k)}






  t










  (

  k

  )
  ï¼Œå¼€å§‹è¿›è¡Œåˆ†è§£ã€‚**

> LOESS ç®—æ³•ï¼Œå³å±€éƒ¨åŠ æƒæ•£ç‚¹å¹³æ»‘æ³•ï¼ˆLocally Weighted Scatterplot Smoothingï¼‰ï¼Œæ˜¯ä¸€ç§ç”¨äºæ•°æ®æ‹Ÿåˆå’Œæ›²çº¿å¹³æ»‘çš„éå‚æ•°ç»Ÿè®¡æ–¹æ³•ã€‚å®ƒé€šè¿‡å¯¹æ¯ä¸ªæ•°æ®ç‚¹é™„è¿‘çš„å±€éƒ¨æ•°æ®è¿›è¡ŒåŠ æƒå›å½’ï¼Œæ¥ä¼°è®¡è¯¥ç‚¹çš„å¹³æ»‘å€¼ã€‚å…¶ä¼˜ç‚¹æ˜¯ä¸éœ€è¦å¯¹æ•°æ®çš„åˆ†å¸ƒå½¢å¼åšå‡ºå…ˆéªŒå‡è®¾ï¼Œèƒ½å¤Ÿè‡ªé€‚åº”åœ°æ ¹æ®æ•°æ®çš„å±€éƒ¨ç‰¹å¾è¿›è¡Œæ‹Ÿåˆï¼Œå¯¹äºå…·æœ‰å¤æ‚éçº¿æ€§å…³ç³»çš„æ•°æ®æœ‰è¾ƒå¥½çš„æ‹Ÿåˆæ•ˆæœï¼Œèƒ½æœ‰æ•ˆå»é™¤æ•°æ®ä¸­çš„å™ªå£°ï¼Œå±•ç°å‡ºæ•°æ®çš„æ½œåœ¨è¶‹åŠ¿ã€‚

* *Then, we divide the original data

  x
  (
  k
  )
  x^{(k)}






  x










  (

  k

  )
  by the approximated trend line to derive the detrended time series.*
    
  **æ¥ä¸‹æ¥æˆ‘é—¨ç”¨åŸå§‹ä¿¡å·

  x
  (
  k
  )
  x^{(k)}






  x










  (

  k

  )
  é™¤ä»¥è¶‹åŠ¿ä¿¡å·

  t
  (
  k
  )
  t^{(k)}






  t










  (

  k

  )
  ï¼Œå¾—åˆ°å»é™¤æ—¶é—´è¶‹åŠ¿ä¹‹åçš„åºåˆ—ã€‚**
* *We then partition the detrended time series into periods of cyclic sub-series where the cycle size is determined by the time interval of the dataset.*
    
  **ç„¶åæˆ‘ä»¬å°†å»è¶‹åŠ¿çš„æ—¶é—´åºåˆ—åˆ†å‰²æˆå‘¨æœŸæ€§çš„å­åºåˆ—ï¼Œå…¶ä¸­å‘¨æœŸå¤§å°ç”±æ•°æ®é›†çš„æ—¶é—´é—´éš”å†³å®šã€‚**
* *As an example, the cycle size for a monthly dataset would be 12. Then we obtain the seasonal component*
    
  **ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œå‡è®¾æ˜¯ä¸€ä¸ªæœˆåº¦æ•°æ®ï¼Œåˆ™å‘¨æœŸå¤§å°å°†æ˜¯12ã€‚**
* *Subsequently, the residual component

  r
  (
  k
  )
  r^{(k)}






  r










  (

  k

  )
  is derived by dividing the seasonal and trend segments from the original series.*
    
  **ä¹‹åï¼Œæ®‹ç•™çš„æ®‹å·®æˆåˆ†

  r
  (
  k
  )
  r^{(k)}






  r










  (

  k

  )
  æ˜¯åŸå§‹ä¿¡å·

  x
  (
  k
  )
  x^{(k)}






  x










  (

  k

  )
  é™¤ä»¥è¶‹åŠ¿æˆåˆ†

  t
  (
  k
  )
  t^{(k)}






  t










  (

  k

  )
  å’Œå­£èŠ‚æˆåˆ†

  s
  (
  k
  )
  s^{(k)}






  s










  (

  k

  )
  å¾—åˆ°çš„ã€‚**
* *Note that the anomaly component

  a
  (
  k
  )
  a^{(k)}






  a










  (

  k

  )
  can be considered as the oddities of the dataset, which do not follow the extracted trend or seasonal components.*
    
  **å€¼å¾—æ³¨æ„çš„æ˜¯

  a
  (
  k
  )
  a^{(k)}






  a










  (

  k

  )
  å¯ä»¥è¢«è§†ä¸ºæ•°æ®é›†ä¸­çš„å¼‚å¸¸æƒ…å†µï¼Œè¿™ä¸ªå¼‚å¸¸æƒ…å†µä¸éšå­£èŠ‚å’Œè¶‹åŠ¿çš„å˜åŒ–è€Œå˜åŒ–ã€‚**
* *Intuitively, anomalies are spread out through residual components, which also contain noise and other real-world effects.*
    
  **ç›´è§‚ä¸Šï¼Œå¼‚å¸¸å€¼é€šå¸¸åœ¨åˆ†å¸ƒæ®‹å·®æˆåˆ†ä¸­ï¼Œè¿™äº›å¼‚å¸¸å€¼åŒ…å«å™ªå£°å’Œå…¶ä»–æ˜¾ç¤ºçš„ç°å®ä¸–ç•Œçš„å½±å“ã€‚**

---

æ®‹å·®æˆåˆ† Residuals å’Œå¼‚å¸¸æˆåˆ†çš„åŒºåˆ« Anomalies çš„åŒºåˆ«ã€‚

|  | æ®‹å·® (Residuals) | **å¼‚å¸¸ (Anomalies)** |
| --- | --- | --- |
| **å®šä¹‰** | æ¨¡å‹æ— æ³•è§£é‡Šçš„æ‰€æœ‰å‰©ä½™æ³¢åŠ¨ | æ˜¾è‘—åç¦»æ­£å¸¸æ¨¡å¼çš„æç«¯å€¼ |
| **ç»„æˆ** | å™ªå£° + æœªå»ºæ¨¡å› ç´  + æ½œåœ¨å¼‚å¸¸ | æ®‹å·®ä¸­çš„ç‰¹æ®Šå­é›† |
| **æ€§è´¨** | å¿…ç„¶å­˜åœ¨ï¼ˆæ¨¡å‹ä¸å¯èƒ½å®Œç¾ï¼‰ | å¶ç„¶å‡ºç°ï¼ˆéœ€è¦ç‰¹åˆ«æ£€æµ‹ï¼‰ |
| **å¤„ç†** | åˆ†æåˆ†å¸ƒç‰¹å¾ | éœ€è¦å•ç‹¬è¯†åˆ«å’Œè°ƒæŸ¥ |
| **ç¤ºä¾‹** | æ—¥é”€å”®é¢æ³¢åŠ¨ Â±5% | æŸå¤©é”€å”®é¢çªç„¶æš´æ¶¨200% |

* **æ®‹å·®**
  = æµªèŠ±ï¼ˆåŒ…å«æ­£å¸¸æ¶Ÿæ¼ªã€å°é±¼è·ƒå‡ºæ°´é¢ã€å¶å°”çš„åƒåœ¾æ¼‚æµ®ï¼‰
* **å¼‚å¸¸**
  = çªç„¶å‡ºç°çš„å·¨å‹æ¼©æ¶¡ï¼ˆéœ€è¦ç«‹å³å…³æ³¨çš„ç‰¹æ®Šç°è±¡ï¼‰

---

* *To distinguish the anomalies from residual components, statistical metrics such as mean and variance are not the appropriate measure as they are highly sensitive to the severity level of anomaly values.*
    
  **ä¸ºäº†åŒºåˆ†å¼‚å¸¸å€¼å’Œæ®‹å·®åˆ†é‡ï¼Œå‡å€¼å’Œæ–¹å·®ç­‰ç»Ÿè®¡åº¦é‡ä¸æ˜¯é€‚å½“çš„è¡¡é‡æ–¹æ³•ï¼Œå› ä¸ºä»–ä»¬å¯¹å¼‚å¸¸å€¼çš„å¼‚å¸¸ç¨‹åº¦éå¸¸æ•æ„Ÿã€‚**

---

**å‡è®¾ä½ æ˜¯ç­ä¸»ä»»ï¼Œè¦æ‰¾å‡ºè€ƒè¯•ä½œå¼Šçš„å­¦ç”Ÿï¼ˆå¼‚å¸¸æ£€æµ‹ï¼‰ï¼š**

* **ç­çº§å¹³å‡åˆ†ï¼ˆmeanï¼‰**
  = æ‰€æœ‰å­¦ç”Ÿåˆ†æ•°çš„å¹³å‡å€¼
* **åˆ†æ•°æ³¢åŠ¨ï¼ˆvarianceï¼‰**
  = å­¦ç”Ÿä»¬åˆ†æ•°çš„åˆ†æ•£ç¨‹åº¦

**ç°åœ¨æœ‰ä¸¤ä¸ªä½œå¼Šæƒ…å†µï¼š**

1. å¼ ä¸‰ï¼šå·å·æŠ„ç­”æ¡ˆè€ƒäº†100åˆ†ï¼ˆæç«¯å¼‚å¸¸å€¼ï¼‰
2. æå››ï¼šå¶å°”å·çœ‹è€ƒäº†75åˆ†ï¼ˆè½»åº¦å¼‚å¸¸å€¼ï¼‰

**å¦‚æœåªç”¨å‡å€¼å’Œæ–¹å·®åˆ¤æ–­ï¼š**

* å¼ ä¸‰çš„100åˆ†ä¼šå¤§å¹…æ‹‰é«˜ç­çº§å¹³å‡åˆ†ï¼ˆæ¯”å¦‚ä»70â†’78ï¼‰
* æ–¹å·®ä¹Ÿä¼šæ€¥å‰§å¢å¤§ï¼ˆåˆ†æ•°èŒƒå›´ä»50-80å˜æˆ50-100ï¼‰

é€šè¿‡å‡å€¼å’Œæ–¹å·®åˆ¤åˆ™æ— æ³•æ‰¾å‡ºæå››çš„å¼‚å¸¸

---

* *As one expects, the severity of the anomalies can change the mean and variance values which are unwanted.*
    
  **æ­£å¦‚æ‰€è®¾æƒ³çš„å†…æ ·ï¼Œå¼‚å¸¸çš„ä¸¥é‡ç¨‹åº¦ä¼šä»¥æˆ‘ä»¬ä¸æœŸæœ›çš„å½¢å¼æ”¹å˜å‡å€¼å’Œæ–¹å¼ã€‚**
* *To resolve this issue, we leverage the median of the residuals, which is immune to the severity of the outliers in the residual components.*
    
  **ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åˆ©ç”¨æ®‹å·®çš„ä¸­ä½æ•°ï¼Œå®ƒå¯¹æ®‹å·®åˆ†é‡ä¸­çš„å¼‚å¸¸å€¼çš„ä¸¥é‡ç¨‹åº¦å…·æœ‰å…ç–«åŠ›ã€‚**
* *Next,we define robustness score

  Ï
  t
  (
  k
  )
  \rho\_t^{(k)}






  Ï









  t






  (

  k

  )

  â€‹

  for each observation at time

  t
  t





  t
  asï¼š*
    
  **æ¥ä¸‹æ¥æˆ‘ä»¬ä¸ºåœ¨å„ä¸ª

  t
  t





  t
  æ—¶åˆ»çš„æ¯ä¸€ä¸ªè§‚å¯Ÿå€¼å®šä¹‰äº†é²æ£’æ€§å› å­

  Ï
  t
  (
  k
  )
  \rho\_t^{(k)}






  Ï









  t






  (

  k

  )

  â€‹

  å…¬å¼å¦‚ä¸‹ï¼š**
    




  Ï
  t
  (
  k
  )
  =
  âˆ£
  r
  t
  (
  k
  )
  âˆ’
  r
  Ë™
  (
  k
  )
  âˆ£
  âˆ‘
  t
  =
  1
  T
  âˆ£
  r
  t
  (
  k
  )
  âˆ’
  r
  Ë™
  (
  k
  )
  âˆ£
  T
  âˆ’
  1
  \rho\_t^{(k)} = \frac{\left| r\_t^{(k)} - \dot{r}^{(k)} \right|}{\sqrt{\frac{\sum\_{t = 1}^{T} \left| r\_t^{(k)} - \dot{r}^{(k)} \right|}{T - 1}}}






  Ï









  t






  (

  k

  )

  â€‹




  =




































  T

  âˆ’

  1













  âˆ‘










  t

  =

  1






  T

  â€‹



















  â€‹



  r









  t






  (

  k

  )

  â€‹


  âˆ’









  r





  Ë™










  (

  k

  )

















  â€‹


  â€‹


  â€‹





























  â€‹



  r









  t






  (

  k

  )

  â€‹




  âˆ’











  r





  Ë™










  (

  k

  )

















  â€‹


  â€‹
* *where

  Ï
  t
  (
  k
  )
  \rho\_t^{(k)}






  Ï









  t






  (

  k

  )

  â€‹

  stand for the strength of the anomalies,

  r
  t
  (
  k
  )
  r\_t^{(k)}






  r









  t






  (

  k

  )

  â€‹

  is the residual at time step

  t
  t





  t
  and

  r
  Ë™
  (
  k
  )
  \dot{r}^{(k)}













  r





  Ë™










  (

  k

  )
  is the median of the residuals.*
    
  **å…¶ä¸­

  Ï
  t
  (
  k
  )
  \rho\_t^{(k)}






  Ï









  t






  (

  k

  )

  â€‹

  ä»£è¡¨å¼‚å¸¸å¼ºåº¦ï¼Œ

  r
  t
  (
  k
  )
  r\_t^{(k)}






  r









  t






  (

  k

  )

  â€‹

  æ—¶é—´æ­¥

  t
  t





  t
  æ—¶åˆ»çš„æ®‹å·®å€¼ï¼Œ

  r
  Ë™
  (
  k
  )
  \dot{r}^{(k)}













  r





  Ë™










  (

  k

  )
  æ˜¯æ®‹å·®æˆåˆ†çš„ä¸­ä½æ•°ã€‚**
* *Note that the larger

  Ï
  t
  \rho\_t






  Ï









  t

  â€‹

  indicates that a drastic change has occurred in the trend and seasonal components. We then extract the anomalies from residuals as below:*
    
  **Ï
  t
  \rho\_t






  Ï









  t

  â€‹

  è¾ƒå¤§è¡¨æ˜è¶‹åŠ¿å’Œå­£èŠ‚æ€§æˆåˆ†å‘ç”Ÿäº†å‰§çƒˆçš„å˜åŒ–ï¼Œæˆ‘ä»¬ä»æ®‹å·®ä¸­æå–å¼‚å¸¸å¦‚ä¸‹ã€‚**
    




  a
  t
  (
  k
  )
  =
  {
  1
  ,
  Ï
  t
  (
  k
  )
  <
  Ï
  c
  (
  k
  )
  r
  t
  (
  k
  )
  ,
  Ï
  t
  (
  k
  )
  â‰¥
  Ï
  c
  (
  k
  )
  \mathbf{a}\_t^{(k)} = \begin{cases} 1, & \rho\_t^{(k)} < \rho\_c^{(k)} \\ r\_t^{(k)}, & \rho\_t^{(k)} \geq \rho\_c^{(k)} \end{cases}






  a









  t






  (

  k

  )

  â€‹




  =







  {











  1

  ,






  r









  t






  (

  k

  )

  â€‹


  ,

  â€‹













  Ï









  t






  (

  k

  )

  â€‹




  <




  Ï









  c






  (

  k

  )

  â€‹







  Ï









  t






  (

  k

  )

  â€‹




  â‰¥




  Ï









  c






  (

  k

  )

  â€‹


  â€‹
* *where

  Ï
  c
  (
  k
  )
  \rho\_c^{(k)}






  Ï









  c






  (

  k

  )

  â€‹

  is the constant threshold given by the value of a robustness score ranked in the

  p
  âˆ’
  p-





  p

  âˆ’
  value 0.05 while the values of elements in

  Ï
  (
  k
  )
  \rho^{(k)}






  Ï










  (

  k

  )
  are ranked in descending order from large to small.*
    
  **å…¶ä¸­

  Ï
  c
  (
  k
  )
  \rho\_c^{(k)}






  Ï









  c






  (

  k

  )

  â€‹

  æ˜¯åœ¨é™åºæ’åˆ—çš„

  Ï
  (
  k
  )
  \rho^{(k)}






  Ï










  (

  k

  )
  åºåˆ—ä¸­åˆ†ä½å€¼ä¸º 0.05 çš„æ—¶å€™ç¡®å®šçš„ã€‚**

> å‡è®¾æœ‰
>
> Ï
> (
> k
> )
> \rho^{(k)}
>
>
>
>
>
>
> Ï
>
>
>
>
>
>
>
>
>
>
> (
>
> k
>
> )
> æœ‰100ä¸ªæ•°ï¼Œé˜ˆå€¼
>
> Ï
> c
> (
> k
> )
> \rho\_c^{(k)}
>
>
>
>
>
>
> Ï
>
>
>
>
>
>
>
>
>
> c
>
>
>
>
>
>
> (
>
> k
>
> )
>
> â€‹
>
> å°±æ˜¯ç¬¬5ï¼ˆ100Ã—0.05ï¼‰å¤§çš„æ•°å­—

* *Notably, when the value of the anomaly component (

  a
  (
  k
  )
  a^{(k)}






  a










  (

  k

  )
  ) deviates further from the value 1, it indicates an abrupt change in the trend and the seasonal component (no sign of anomalies).*
    
  **è¿™é‡Œè¦æ˜ç¡®çš„æ˜¯ï¼Œå½“å¼‚å¸¸å€¼

  a
  (
  k
  )
  a^{(k)}






  a










  (

  k

  )
  çš„å€¼è·ç¦» 1 å¾ˆè¿œæ—¶å€™ï¼Œå®ƒè¡¨é¢ç¡®å®å’Œå­£èŠ‚æ€§æˆåˆ†å‘ç”Ÿäº†çªç„¶çš„å˜åŒ–ï¼Œä½†ä¸ä¸€å®šæ˜¯å¼‚å¸¸ã€‚**
* *On the contrary, when both anomaly and residual values are equal 1 (

  r
  t
  (
  k
  )
  r\_t^{(k)}






  r









  t






  (

  k

  )

  â€‹

  = 1 and

  a
  t
  (
  k
  )
  a\_t^{(k)}






  a









  t






  (

  k

  )

  â€‹

  = 1)ï¼Œ it indicates that the observed signal at time

  t
  t





  t*
  *explicitly follows the trend and seasonal component.*
    
  **å¯ä»¥å¯¹æ¯”æ¥çœ‹çš„æ˜¯ï¼Œå½“å¼‚å¸¸å€¼å’Œæ®‹å·®å€¼éƒ½ç­‰äº1æ—¶ï¼Œè¡¨æ˜åœ¨æ—¶é—´

  t
  t





  t
  è§‚å¯Ÿåˆ°çš„ä¿¡å·æ˜ç¡®åœ°éµå¾ªäº†è¶‹åŠ¿å’Œå­£èŠ‚æˆåˆ†ã€‚**
* *Note that such important information might not be automatically inferred when additive decomposition methods are being used. This due to the fact that the values of residual components can differ from one dataset to another which requires manual effort in their detection.*
    
  **å½“ä½¿ç”¨åŠ æ³•åˆ†è§£æ–¹æ³•æ—¶ï¼Œè¿™æ ·çš„é‡è¦ä¿¡æ¯å¯èƒ½ä¸ä¼šè¢«è‡ªåŠ¨æ¨æ–­å‡ºæ¥ï¼Œè¿™æ˜¯å› ä¸ºæ®‹å·®åˆ†é‡çš„å€¼å¯èƒ½å› æ•°æ®é›†è€Œå¼‚ï¼Œå› æ­¤éœ€è¦æ‰‹åŠ¨ç­›é€‰å‡ºå¼‚å¸¸ã€‚**
  ï¼ˆä¸ªäººè¡¥å……ï¼šåŠ æ³•åˆ†è§£ä¸€èˆ¬åªèƒ½ç›´æ¥é€šè¿‡å¹…åº¦å¤§å°åˆ¤å®šå¼‚å¸¸ï¼Œä½†ç”±äºå„ä¸ªæ•°æ®é›†çš„æ•°æ®æƒ…å†µä¸åŒï¼Œæ— æ³•ç›´æ¥é€šè¿‡å¯¹å¹…åº¦åŠ ä¸Šé˜ˆå€¼è¿›è¡Œç›´æ¥ç­›é€‰ï¼‰
* *A sample result of anomaly decomposition is shown in the left-most part of Figure 1, where the observed time series data is decomposed into tis seasonal, trend, anomalies, and residual*
  .
    
  **å¼‚å¸¸åˆ†è§£çš„ä¸€ä¸ªç¤ºä¾‹ç»“æœæ˜¾ç¤ºåœ¨å›¾æœ€å·¦ä¾§çš„éƒ¨åˆ†ï¼Œå…¶ä¸­è§‚å¯Ÿåˆ°çš„æ—¶é—´åºåˆ—æ•°æ®è¢«åˆ†åˆ«åˆ†è§£ä¸ºå­£èŠ‚æ€§ã€è¶‹åŠ¿ã€å¼‚å¸¸å’Œæ®‹å·®åˆ†é‡ã€‚**
  ï¼ˆè¿˜æ˜¯å¼€å¤´å†…ä¸ªå›¾ä¸æ”¾æ¥ä»–åˆè¯´äº†ä¸€éï¼‰
* *Each of these components holds essential information about the characteristics of the time and will be leveraged to train the forecast model.*
    
  **è¿™äº›æˆåˆ†ä¸­çš„æ¯ä¸€ä¸ªéƒ½åŒ…å«äº†å…³äºæ—¶é—´åºåˆ—ç‰¹å¾çš„é‡è¦ä¿¡æ¯ï¼Œå¹¶å°†è¢«æˆ‘ä»¬ä½¿ç”¨æ¥é¢„æµ‹æ¨¡å‹ã€‚**
* *To this end, we concatenate the derived decomposed vector of time series with the input, which includes the observed time series and its labeled extreme event.*
    
  æœ€ç»ˆï¼Œæˆ‘ä»¬å°†è¿™äº›æ—¶é—´åºåˆ—è¿›è¡Œæ‹¼æ¥ä½œä¸ºä¸€ä¸ªè¾“å…¥æ¨¡å‹çš„è®­ç»ƒçš„ç‰¹å¾æ ·æœ¬ï¼Œè¿™ä¸ªæ ·æœ¬åŒ…å«è§‚æµ‹åˆ°çš„æ—¶é—´åºåˆ—åŠæ ‡è®°çš„æç«¯äº‹ä»¶è¿˜æœ‰æˆ‘ä»¬åˆ†è§£å‡ºçš„å„ä¸ªæˆåˆ†ã€‚

è¯»å®Œä¹‹åå…¶å®æˆ‘æ˜¯å¸¦ç€ç–‘æƒ‘çš„ï¼Œå°±æ˜¯å®é™…ä¸Š

x
(
k
)
=
s
(
k
)
Ã—
t
(
k
)
Ã—
a
(
k
)
Ã—
r
(
k
)
x^{(k)} = s^{(k)}Ã—t^{(k)}Ã—a^{(k)}Ã—r^{(k)}






x










(

k

)



=






s










(

k

)



Ã—






t










(

k

)



Ã—






a










(

k

)



Ã—






r










(

k

)
åœ¨è¿™ä¸ªä¹˜æ³•é¡¹çš„åˆ†è§£é‡Œ

a
(
k
)
a^{(k)}






a










(

k

)
è¿™ä¸€é¡¹æ˜¯æ€ä¹ˆä¹˜è¿›å»çš„å…¶å®æ˜¯æ²¡æœ‰æ¸…æ™°ç»™å‡ºçš„ï¼Œå¦‚æœä¸çœ‹ä»£ç æˆ‘è§‰å¾—ä½†ä»è¿™æ®µçš„å†™ä½œä¸Šæ¥çœ‹ï¼Œæœ‰æ•…æ„éšè—æ ¸å¿ƒç»†èŠ‚çš„å«Œç–‘ã€‚å¥½åœ¨ä»£ç è™½ç„¶æ²¡æœ‰æ³¨é‡Šä½†æˆ‘ä¹Ÿå¤ç°å‡ºæ¥äº†ã€‚

## 2.STAR ä»£ç å¤ç° æ‰‹æ“ç‰ˆ

---

ä¸ºäº†ä¿è¯å¤ç°ç»“æœçš„å¯éªŒè¯æ€§ï¼Œæˆ‘è¿™é‡Œç”¨äº†ä¸€ä¸ªé˜¿é‡Œçš„å¼€æºåŠŸç‡æ•°æ®é›†ã€‚
  
<https://tianchi.aliyun.com/dataset/159885>
  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/9ba24fda71c249fc95dde40e828e152d.png)
  
ä¸‹è½½ä¹‹åæ•°æ®å¦‚ä¸‹ä¸€ä¸ªéå¸¸æ ‡å‡†çš„é£ç”µæ•°æ®é›†ï¼Œä¹‹åæˆ‘ä»¬å°±åˆ†è§£å’Œä½¿ç”¨å®é™…å‘ç”µåŠŸç‡è¿™ä¸€é¡¹ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/0bb52c141df94d61bd905fa0f7822ff8.png)

### 2.1 æ•°æ®è¯»å–

---

![è¯·æ·»åŠ å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/f40817647e2d4f40ad865adc088df935.png)

```python
import pandas as pd
import matplotlib.pyplot as plt

data = pd.read_excel("data.xlsx")
print(data.head())

power = data["å®é™…å‘ç”µåŠŸç‡"].values

plt.plot(power)
plt.show()

```

### 2.2 æå–è¶‹åŠ¿æˆåˆ†

---

![è¯·æ·»åŠ å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/5c94b82e10a54fd997acbef4e526ea00.png)

```python
# å¯¼å…¥å¿…è¦çš„åº“
import pandas as pd  # æ•°æ®å¤„ç†åº“
import matplotlib.pyplot as plt  # ç»˜å›¾åº“
import numpy as np  # æ•°å€¼è®¡ç®—åº“
from statsmodels.nonparametric.smoothers_lowess import lowess  # éå‚æ•°å¹³æ»‘æ–¹æ³•

# è®¾ç½®ä¸­æ–‡å­—ä½“ï¼ˆä»¥ Windows çš„ SimHei ä¸ºä¾‹ï¼‰
plt.rcParams['font.sans-serif'] = ['SimHei']  # è®¾ç½®å…¨å±€å­—ä½“ä¸ºé»‘ä½“
plt.rcParams['axes.unicode_minus'] = False  # è§£å†³è´Ÿå·æ˜¾ç¤ºé—®é¢˜

# è¯»å–Excelæ•°æ®æ–‡ä»¶
data = pd.read_excel("data.xlsx")  # ä»Excelæ–‡ä»¶åŠ è½½æ•°æ®
power = data["å®é™…å‘ç”µåŠŸç‡"].values  # æå–"å®é™…å‘ç”µåŠŸç‡"åˆ—çš„å€¼è½¬ä¸ºnumpyæ•°ç»„
x = np.arange(len(power))  # åˆ›å»ºä¸åŠŸç‡æ•°æ®é•¿åº¦ç›¸åŒçš„ç´¢å¼•æ•°ç»„ä½œä¸ºxè½´

# ä½¿ç”¨LOWESSè¿›è¡Œå¹³æ»‘å¤„ç†ï¼ˆéå‚æ•°å±€éƒ¨å›å½’ï¼‰
# frac: å¹³æ»‘çª—å£æ¯”ä¾‹ï¼ˆ0.3è¡¨ç¤ºä½¿ç”¨30%çš„æ•°æ®ç‚¹è¿›è¡Œå±€éƒ¨æ‹Ÿåˆï¼‰
# it: æ‰§è¡Œ3æ¬¡ç¨³å¥æ‹Ÿåˆè¿­ä»£ï¼ˆæ¶ˆé™¤å¼‚å¸¸å€¼å½±å“ï¼‰
smoothed = lowess(power, x, frac=0.3, it=3)

# æå–å¹¶å¤„ç†å¹³æ»‘ç»“æœ
rt = smoothed[:, 1]  # æå–å¹³æ»‘åçš„è¶‹åŠ¿åˆ†é‡ï¼ˆç¬¬äºŒåˆ—ä¸ºæ‹Ÿåˆå€¼ï¼‰
data_d_rt = power / rt  # è®¡ç®—åŸå§‹åŠŸç‡ä¸è¶‹åŠ¿åˆ†é‡çš„æ¯”å€¼ï¼ˆåˆ†è§£å‘¨æœŸåˆ†é‡ï¼‰

# åˆ›å»ºç»˜å›¾ç”»å¸ƒï¼ˆå®½20è‹±å¯¸ï¼Œé«˜4è‹±å¯¸ï¼‰
plt.figure(figsize=(20, 4))

# ç»˜åˆ¶åŸå§‹åŠŸç‡æ›²çº¿
plt.plot(power,
         label="åŠŸç‡",
         color='blue',
         linestyle='-',  # å®çº¿
         linewidth=2)  # çº¿å®½2ç£…

# ç»˜åˆ¶è¶‹åŠ¿åˆ†é‡æ›²çº¿
plt.plot(rt,
         label="è¶‹åŠ¿åˆ†é‡ $r^{(k)}$",  # LaTeXæ ¼å¼çš„æ•°å­¦ç¬¦å·
         color='green',
         linestyle='--',  # è™šçº¿
         linewidth=2)

# ä¿å­˜å›¾å½¢åˆ°æ–‡ä»¶
plt.savefig("2.è·å¾—è¶‹åŠ¿åˆ†é‡.png",
            bbox_inches="tight")  # ç´§å‡‘å‹è¾¹ç•Œæ¡†

# æ˜¾ç¤ºå›¾å½¢
plt.legend(loc="upper left")  # åœ¨å·¦ä¸Šè§’æ˜¾ç¤ºå›¾ä¾‹
plt.grid(True)  # æ·»åŠ ç½‘æ ¼çº¿
plt.show()

```

### 2.3 æå–å­£èŠ‚æˆåˆ†

---

åœ¨å­£èŠ‚åˆ†é‡è¿™é‡Œï¼Œæˆ‘ä»¬é€‰æ‹©çš„å‘¨æœŸçš„ä»¥å¤©ä¸ºå‘¨æœŸï¼Œç”±äºæ•°æ®æœ¬èº«é¢—ç²’åº¦ä¸º15åˆ†é’Ÿï¼Œ
æ‰€ä»¥å°±æ˜¯96ä¸ªä¸€å¾ªç¯
ã€‚
  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/fe35231c3b904ffba29e0a3a59aaea22.png)

```python
# å¯¼å…¥æ‰€éœ€åº“
import pandas as pd  # æ•°æ®å¤„ç†åº“
import matplotlib.pyplot as plt  # ç»˜å›¾åº“
import numpy as np  # æ•°å€¼è®¡ç®—åº“
from statsmodels.nonparametric.smoothers_lowess import lowess  # LOWESSå¹³æ»‘ç®—æ³•

# è®¾ç½®ä¸­æ–‡å­—ä½“æ˜¾ç¤ºï¼ˆé’ˆå¯¹Windowsç³»ç»Ÿï¼‰
plt.rcParams['font.sans-serif'] = ['SimHei']  # æŒ‡å®šé»˜è®¤å­—ä½“ä¸ºé»‘ä½“
plt.rcParams['axes.unicode_minus'] = False  # è§£å†³è´Ÿå·æ˜¾ç¤ºå¼‚å¸¸é—®é¢˜

# æ•°æ®è¯»å–ä¸é¢„å¤„ç†
data = pd.read_excel("data.xlsx")  # ä»Excelæ–‡ä»¶åŠ è½½æ•°æ®é›†
power = data["å®é™…å‘ç”µåŠŸç‡"].values  # å°†åŠŸç‡åˆ—è½¬æ¢ä¸ºnumpyæ•°ç»„
x = np.arange(len(power))  # åˆ›å»ºä¸æ•°æ®é•¿åº¦ç›¸åŒçš„ç´¢å¼•åºåˆ—

# LOWESSè¶‹åŠ¿æå–
smoothed = lowess(power, x, frac=0.3, it=3)  # æ‰§è¡Œå±€éƒ¨åŠ æƒå›å½’
rt = smoothed[:, 1]  # æå–è¶‹åŠ¿åˆ†é‡ï¼ˆç¬¬äºŒåˆ—ä¸ºæ‹Ÿåˆå€¼ï¼‰

# å»è¶‹åŠ¿å¤„ç†
data_d_rt = power / rt  # é€šè¿‡é™¤æ³•å»é™¤è¶‹åŠ¿ï¼ˆé€‚ç”¨äºä¹˜æ³•åˆ†è§£æ¨¡å‹ï¼‰

# å‘¨æœŸç‰¹å¾æå–
son_sequence = data_d_rt.copy().reshape(96, -1)  # æŒ‰æ—¥å‘¨æœŸ(15åˆ†é’Ÿé—´éš”)é‡å¡‘æ•°æ®ä¸º96è¡Œ
sequence_len = son_sequence.shape[-1]  # è·å–æ¯ä¸ªå‘¨æœŸçš„å¤©æ•°ï¼ˆåˆ—æ•°ï¼‰

# ä¸­ä½æ•°è®¡ç®—ï¼ˆæ³¨æ„ï¼šæ­¤å¤„å®é™…ä½¿ç”¨å‡å€¼è®¡ç®—ï¼Œå»ºè®®ä¿®æ”¹ä¸ºnp.medianï¼‰
column_medians = np.mean(son_sequence, axis=1)  # è®¡ç®—æ¯ä¸ªæ—¶é—´ç‚¹çš„å‡å€¼ï¼ˆåº”ä½¿ç”¨ä¸­ä½æ•°ï¼‰
column_medians = column_medians[:, np.newaxis]  # æ·»åŠ æ–°è½´ä¾¿äºçŸ©é˜µè¿ç®—

# å­£èŠ‚åˆ†é‡é‡æ„
st = np.tile(column_medians, (1, sequence_len)).T.reshape(-1)  # å°†å‡å€¼å»¶å±•ä¸ºå®Œæ•´åºåˆ—
# æ“ä½œè§£æï¼š
# 1. np.tileè¿›è¡ŒçŸ©é˜µå¤åˆ¶ (1åˆ—â†’sequence_lenåˆ—)
# 2. .Tè½¬ç½®çŸ©é˜µé€‚é…åç»­æ“ä½œ
# 3. reshape(-1)å±•å¹³ä¸ºä¸€ç»´å­£èŠ‚åˆ†é‡

# å¯è§†åŒ–è®¾ç½®
plt.figure(figsize=(20, 4))  # åˆ›å»º20è‹±å¯¸å®½ã€4è‹±å¯¸é«˜çš„ç”»å¸ƒ
plt.plot(st,  # ç»˜åˆ¶å­£èŠ‚åˆ†é‡
         label="ä¸­ä½æ•°å»¶å±•ç»“æœ",  # å›¾ä¾‹æ ‡ç­¾
         color='blue',  # çº¿æ¡é¢œè‰²
         linewidth=2)  # çº¿å®½è®¾ç½®

# å›¾è¡¨ç¾åŒ–
plt.title("ä¸­ä½æ•°å»¶å±•ç»“æœå¯è§†åŒ–", fontsize=16)  # è®¾ç½®æ ‡é¢˜åŠå­—å·
plt.xlabel("æ—¶é—´/ç´¢å¼•", fontsize=14)  # Xè½´æ ‡ç­¾è®¾ç½®
plt.ylabel("ä¸­ä½æ•°å»¶å±•å€¼", fontsize=14)  # Yè½´æ ‡ç­¾è®¾ç½®ï¼ˆå®é™…ä¸ºå‡å€¼ï¼‰
plt.legend(loc='upper right', fontsize=12)  # å³ä¸Šè§’å›¾ä¾‹
plt.grid(True, linestyle='--', alpha=0.6)  # åŠé€æ˜è™šçº¿ç½‘æ ¼
plt.tight_layout()  # è‡ªåŠ¨è°ƒæ•´å…ƒç´ é—´è·
plt.show()  # æ˜¾ç¤ºå›¾å½¢

```

### 2.4 æå–æ®‹å·®æˆåˆ†

---

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/1d041d30bfda4f3cb5c235e8d6a14e9f.png)

```python
# å¯¼å…¥å¿…è¦çš„åº“
import pandas as pd  # æ•°æ®å¤„ç†åº“
import matplotlib.pyplot as plt  # ç»˜å›¾åº“
import numpy as np  # æ•°å€¼è®¡ç®—åº“
from statsmodels.nonparametric.smoothers_lowess import lowess  # LOWESSå¹³æ»‘ç®—æ³•

# è®¾ç½®ä¸­æ–‡æ˜¾ç¤ºï¼ˆé€‚ç”¨äºWindowsç³»ç»Ÿï¼‰
plt.rcParams['font.sans-serif'] = ['SimHei']  # æŒ‡å®šé»˜è®¤å­—ä½“ä¸ºé»‘ä½“
plt.rcParams['axes.unicode_minus'] = False  # è§£å†³è´Ÿå·æ˜¾ç¤ºå¼‚å¸¸é—®é¢˜

# æ•°æ®åŠ è½½ä¸é¢„å¤„ç†
data = pd.read_excel("data.xlsx")  # ä»Excelæ–‡ä»¶åŠ è½½æ•°æ®é›†
power = data["å®é™…å‘ç”µåŠŸç‡"].values  # æå–åŠŸç‡åˆ—æ•°æ®ä¸ºnumpyæ•°ç»„
x = np.arange(len(power))  # åˆ›å»ºæ—¶é—´ç´¢å¼•åºåˆ—ï¼ˆ0,1,2,...nï¼‰

# è¶‹åŠ¿åˆ†é‡æå–ï¼ˆLOWESSå¹³æ»‘ï¼‰
smoothed = lowess(power, x, frac=0.3, it=3)  # æ‰§è¡Œå±€éƒ¨åŠ æƒå›å½’
tk = smoothed[:, 1]  # æå–è¶‹åŠ¿åˆ†é‡ï¼ˆç¬¬äºŒåˆ—ä¸ºæ‹Ÿåˆå€¼ï¼‰

# å»è¶‹åŠ¿å¤„ç†ï¼ˆä¹˜æ³•åˆ†è§£æ¨¡å‹ï¼‰
data_d_tk = power / tk  # åŸå§‹ä¿¡å·/è¶‹åŠ¿åˆ†é‡ = å­£èŠ‚åˆ†é‡ Ã— æ®‹å·®åˆ†é‡

# å‘¨æœŸç‰¹å¾æå–ï¼ˆå‡è®¾æ¯æ—¥96ä¸ª15åˆ†é’Ÿé—´éš”ï¼‰
son_sequence = data_d_tk.copy().reshape(96, -1)  # é‡å¡‘ä¸º(96,å¤©æ•°)çŸ©é˜µ
sequence_len = son_sequence.shape[-1]  # è·å–å‘¨æœŸå¤©æ•°ï¼ˆåˆ—æ•°ï¼‰

# å­£èŠ‚åˆ†é‡è®¡ç®—ï¼ˆè¡Œä¸­ä½æ•°ï¼‰
column_means = np.mean(son_sequence, axis=1)  # è®¡ç®—æ¯ä¸ªæ—¶é—´ç‚¹çš„å¹³å‡å€¼
column_means = column_means[:, np.newaxis]  # è½¬æ¢ä¸ºåˆ—å‘é‡ä¾¿äºçŸ©é˜µè¿ç®—

# å­£èŠ‚åˆ†é‡é‡æ„
sk = np.tile(column_means, (1, sequence_len)).T.reshape(-1)  # å»¶å±•ä¸­ä½æ•°åºåˆ—
# æ“ä½œåˆ†è§£ï¼š
# 1. np.tileå¤åˆ¶åˆ—å‘é‡ä¸º(96,å¤©æ•°)çŸ©é˜µ
# 2. .Tè½¬ç½®ä¸º(å¤©æ•°,96)
# 3. reshape(-1)å±•å¹³ä¸ºåŸå§‹é•¿åº¦

# æ®‹å·®åˆ†é‡è®¡ç®—
rk = data_d_tk / sk  # æ®‹å·® = å»è¶‹åŠ¿ä¿¡å· / å­£èŠ‚åˆ†é‡

# å¯è§†åŒ–è®¾ç½®ï¼ˆåˆ›å»º4è¡Œ1åˆ—çš„å­å›¾å¸ƒå±€ï¼‰
plt.figure(figsize=(20, 10))  # è®¾ç½®ç”»å¸ƒå°ºå¯¸ï¼ˆå®½20è‹±å¯¸ï¼Œé«˜10è‹±å¯¸ï¼‰

# ---------------------------
# å­å›¾1ï¼šåŸå§‹åŠŸç‡ä¿¡å·
# ---------------------------
plt.subplot(4, 1, 1)  # å®šä½åˆ°ç¬¬1ä¸ªå­å›¾
plt.plot(x, power,
         label="åŸå§‹åŠŸç‡ä¿¡å·",  # å›¾ä¾‹æ ‡ç­¾
         color='blue',  # ä¿¡å·é¢œè‰²
         linewidth=2)  # çº¿å®½è®¾ç½®
plt.title("åŸå§‹åŠŸç‡ä¿¡å·", fontsize=14)  # å­å›¾æ ‡é¢˜
plt.xlabel("æ—¶é—´/ç´¢å¼•", fontsize=12)  # Xè½´æ ‡ç­¾
plt.ylabel("åŠŸç‡å€¼", fontsize=12)  # Yè½´æ ‡ç­¾
plt.legend(loc='upper right', fontsize=10)  # å›¾ä¾‹ä½ç½®ä¸å­—å·
plt.grid(True, linestyle='--', alpha=0.6)  # åŠé€æ˜è™šçº¿ç½‘æ ¼

# ---------------------------
# å­å›¾2ï¼šè¶‹åŠ¿åˆ†é‡ (tk)
# ---------------------------
plt.subplot(4, 1, 2)  # å®šä½åˆ°ç¬¬2ä¸ªå­å›¾
plt.plot(x, tk,
         label="è¶‹åŠ¿åˆ†é‡ (tk)",  # åˆ†é‡åç§°
         color='green',  # è¶‹åŠ¿çº¿é¢œè‰²
         linewidth=2)
plt.title("è¶‹åŠ¿åˆ†é‡ (tk)", fontsize=14)
plt.xlabel("æ—¶é—´/ç´¢å¼•", fontsize=12)
plt.ylabel("è¶‹åŠ¿å€¼", fontsize=12)
plt.legend(loc='upper right', fontsize=10)
plt.grid(True, linestyle='--', alpha=0.6)

# ---------------------------
# å­å›¾3ï¼šå­£èŠ‚åˆ†é‡ (sk)
# ---------------------------
plt.subplot(4, 1, 3)  # å®šä½åˆ°ç¬¬3ä¸ªå­å›¾
plt.plot(x, sk,
         label="å­£èŠ‚åˆ†é‡ (sk)",  # å‘¨æœŸç‰¹å¾
         color='red',  # å­£èŠ‚çº¿é¢œè‰²
         linewidth=2)
plt.title("å­£èŠ‚åˆ†é‡ (sk)", fontsize=14)
plt.xlabel("æ—¶é—´/ç´¢å¼•", fontsize=12)
plt.ylabel("å­£èŠ‚å€¼", fontsize=12)
plt.legend(loc='upper right', fontsize=10)
plt.grid(True, linestyle='--', alpha=0.6)

# ---------------------------
# å­å›¾4ï¼šæ®‹å·®åˆ†é‡ (rk)
# ---------------------------
plt.subplot(4, 1, 4)  # å®šä½åˆ°ç¬¬4ä¸ªå­å›¾
plt.plot(x, rk,
         label="æ®‹å·®åˆ†é‡ (rk)",  # å‰©ä½™æ³¢åŠ¨
         color='purple',  # æ®‹å·®çº¿é¢œè‰²
         linewidth=2)
plt.title("æ®‹å·®åˆ†é‡ (rk)", fontsize=14)
plt.xlabel("æ—¶é—´/ç´¢å¼•", fontsize=12)
plt.ylabel("æ®‹å·®å€¼", fontsize=12)
plt.legend(loc='upper right', fontsize=10)
plt.grid(True, linestyle='--', alpha=0.6)

# å…¨å±€å¸ƒå±€è°ƒæ•´
plt.tight_layout()  # è‡ªåŠ¨è°ƒæ•´å­å›¾é—´è·
plt.show()  # æ¸²æŸ“æ˜¾ç¤ºå›¾åƒ

```

### 2.5 æå–å¼‚å¸¸æˆåˆ†

---

è¿™é‡Œè¦è¯´ä¸€ä¸‹çš„æ˜¯ï¼Œåœ¨åŸæ–‡ä¸­æ²¡æœ‰ç»™å‡ºçš„æ®‹å·®æˆåˆ†å’Œæå–å¼‚å¸¸æˆåˆ†ç›¸ä¹˜çš„å…³ç³»ä»¥åŠå¦‚ä½•ä½œç”¨åˆ°åŸå§‹ä¿¡å·ä¸Šï¼Œåœ¨æˆ‘é˜…è¯»äº†ä»–çš„ä»£ç ä¹‹åï¼Œå…¶å®æ˜¯é€šè¿‡èµ‹1å€¼å®ç°çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¼‚å¸¸æˆåˆ†å°±æ˜¯æ®‹å·®æˆåˆ†ä¸­é²æ£’å› å­å¤§äºç­‰äºé˜ˆå€¼çš„ç‚¹ç»„æˆçš„ï¼Œå…¶ä»–åœ°æ–¹éƒ½æ˜¯1ï¼Œç„¶åæ®‹å·®æˆåˆ†ä¸­çš„é²æ£’å› å­å°äºé˜ˆå€¼çš„ç‚¹ç»™å˜æˆäº†1ï¼Œè¿™æ ·çš„è¯ï¼Œç»è¿‡è¿™ä¸€æ­¥ä¹‹åï¼Œå¾—åˆ°çš„å¼‚å¸¸æˆåˆ†å’Œæ®‹å·®æˆåˆ†ç›¸ä¹˜ï¼Œå…¶å®å°±æ˜¯ä¸Šä¸€æ­¥çš„æ®‹å·®æˆåˆ†ï¼Œè¿™éƒ¨åˆ†å…³é”®é€»è¾‘åœ¨åŸæ–‡ä¸­è¢«æ©ç›–äº†ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/146cd7aa71324a7b99095edce221b57a.png)

```python
# å¯¼å…¥æ‰€éœ€åº“
from statistics import median  # æä¾›ä¸­ä½æ•°è®¡ç®—å‡½æ•°
import pandas as pd  # æ•°æ®å¤„ç†åº“
import matplotlib.pyplot as plt  # ç»˜å›¾åº“
import numpy as np  # æ•°å€¼è®¡ç®—åº“
from statsmodels.nonparametric.smoothers_lowess import lowess  # LOWESSå¹³æ»‘ç®—æ³•

# è®¾ç½®ä¸­æ–‡æ˜¾ç¤ºï¼ˆé€‚ç”¨äºWindowsç³»ç»Ÿï¼‰
plt.rcParams['font.sans-serif'] = ['SimHei']  # æŒ‡å®šé»˜è®¤å­—ä½“ä¸ºé»‘ä½“
plt.rcParams['axes.unicode_minus'] = False  # è§£å†³è´Ÿå·æ˜¾ç¤ºé—®é¢˜

# æ•°æ®åŠ è½½ä¸é¢„å¤„ç†
data = pd.read_excel("data.xlsx")  # åŠ è½½Excelæ•°æ®é›†
power = data["å®é™…å‘ç”µåŠŸç‡"].values  # æå–åŠŸç‡æ•°æ®ä¸ºnumpyæ•°ç»„
x = np.arange(len(power))  # åˆ›å»ºæ—¶é—´ç´¢å¼•åºåˆ—ï¼ˆ0,1,2,...nï¼‰

# è¶‹åŠ¿åˆ†é‡æå–ï¼ˆLOWESSå¹³æ»‘ï¼‰
smoothed = lowess(power, x, frac=0.3, it=3)  # æ‰§è¡Œå±€éƒ¨åŠ æƒå›å½’
tk = smoothed[:, 1]  # æå–è¶‹åŠ¿åˆ†é‡ï¼ˆç¬¬äºŒåˆ—ä¸ºæ‹Ÿåˆå€¼ï¼‰

# å»è¶‹åŠ¿å¤„ç†ï¼ˆä¹˜æ³•åˆ†è§£æ¨¡å‹ï¼‰
data_d_tk = power / tk  # åŸå§‹ä¿¡å·/è¶‹åŠ¿åˆ†é‡ = å­£èŠ‚åˆ†é‡ Ã— æ®‹å·®åˆ†é‡

# å‘¨æœŸç‰¹å¾æå–ï¼ˆå‡è®¾æ¯æ—¥96ä¸ª15åˆ†é’Ÿé—´éš”ï¼‰
son_sequence = data_d_tk.copy().reshape(96, -1)  # é‡å¡‘ä¸º(96,å¤©æ•°)çŸ©é˜µ
sequence_len = son_sequence.shape[-1]  # è·å–å‘¨æœŸå¤©æ•°ï¼ˆåˆ—æ•°ï¼‰

# å­£èŠ‚åˆ†é‡è®¡ç®—ï¼ˆæ³¨æ„æ­¤å¤„å®é™…ä½¿ç”¨å‡å€¼ï¼Œå»ºè®®ä¿®æ”¹ä¸ºnp.medianï¼‰
column_medians = np.mean(son_sequence, axis=1)  # è®¡ç®—æ¯ä¸ªæ—¶é—´ç‚¹çš„å‡å€¼
column_medians = column_medians[:, np.newaxis]  # è½¬æ¢ä¸ºåˆ—å‘é‡

# å­£èŠ‚åˆ†é‡é‡æ„
sk = np.tile(column_medians, (1, sequence_len)).T.reshape(-1)  # å»¶å±•ä¸ºå®Œæ•´åºåˆ—

# æ®‹å·®åˆ†é‡è®¡ç®—
rk = data_d_tk / sk  # æ®‹å·® = å»è¶‹åŠ¿ä¿¡å· / å­£èŠ‚åˆ†é‡

# å¼‚å¸¸æ£€æµ‹ç®—æ³• --------------------------------------------------
# è®¡ç®—æ®‹å·®ä¸­ä½æ•°
rk_median = np.median(rk)  # è·å–æ®‹å·®çš„ä¸­ä½æ•°å€¼

# è®¡ç®—ç»å¯¹ç¦»å·®ï¼ˆMedian Absolute Deviation, MADï¼‰
rou_abs = np.abs(rk - rk_median)  # æ¯ä¸ªæ®‹å·®ä¸ä¸­ä½æ•°çš„ç»å¯¹è·ç¦»

# è®¡ç®—æ ‡å‡†åŒ–ç¦»å·®ï¼ˆç±»ä¼¼Z-scoreæ ‡å‡†åŒ–ï¼‰
rou_k = rou_abs / np.sqrt(np.sum(rou_abs)/(len(rou_abs)-1))  # è‡ªå®šä¹‰æ ‡å‡†åŒ–æ–¹æ³•

# ç¡®å®šå¼‚å¸¸é˜ˆå€¼ï¼ˆå–95%åˆ†ä½æ•°ï¼‰
sorted_data = sorted(rou_k, reverse=True)  # é™åºæ’åˆ—ç¦»å·®å€¼
rou_c = sorted_data[int(0.05*len(sorted_data))-1]  # å–å‰5%ä½œä¸ºå¼‚å¸¸é˜ˆå€¼

# ç”Ÿæˆå¼‚å¸¸æŒ‡ç¤ºå‘é‡
ak = rk.copy()  # åˆ›å»ºå‰¯æœ¬
ak[np.where(rou_k < rou_c)] = 1  # æ­£å¸¸ç‚¹æ ‡è®°ä¸º1
rk[np.where(rou_k >= rou_c)] = 1  # å¼‚å¸¸ç‚¹æ®‹å·®è®¾ä¸º1ï¼ˆéœ€éªŒè¯é€»è¾‘åˆç†æ€§ï¼‰

# å¯è§†åŒ–è®¾ç½® ---------------------------------------------------
fig, axes = plt.subplots(5, 1, figsize=(20, 14))  # åˆ›å»º5è¡Œå­å›¾å¸ƒå±€

# å­å›¾1ï¼šåŸå§‹åŠŸç‡æ•°æ®
axes[0].plot(power,
            label='åŸå§‹åŠŸç‡æ•°æ®',
            color='blue')
axes[0].set_ylabel('åŸå§‹åŠŸç‡æ•°æ®')
axes[0].legend()
axes[0].grid(True)

# å­å›¾2ï¼šè¶‹åŠ¿åˆ†é‡
axes[1].plot(tk,
            label='è¶‹åŠ¿ä¿¡æ¯ (tk)',
            color='orange')
axes[1].set_ylabel('è¶‹åŠ¿æˆåˆ†')
axes[1].legend()
axes[1].grid(True)

# å­å›¾3ï¼šå­£èŠ‚åˆ†é‡
axes[2].plot(sk,
            label='å­£èŠ‚ä¿¡æ¯åˆ†é‡ (sk)',
            color='green')
axes[2].set_ylabel('å­£èŠ‚æˆåˆ†')
axes[2].legend()
axes[2].grid(True)

# å­å›¾4ï¼šå¼‚å¸¸åˆ†é‡ï¼ˆéœ€æ³¨æ„æ ‡è®°é€»è¾‘ï¼‰
axes[3].plot(ak,
            label='å¼‚å¸¸åˆ†é‡ (ak)',
            color='red')
axes[3].set_ylabel('å¼‚å¸¸æˆåˆ†')
axes[3].legend()
axes[3].grid(True)

# å­å›¾5ï¼šä¿®æ­£åçš„æ®‹å·®åˆ†é‡
axes[4].plot(rk,
            label='æ®‹å·®åˆ†é‡ (rk)',
            color='purple')
axes[4].set_ylabel('æ®‹å·®æˆåˆ†')
axes[4].legend()
axes[4].grid(True)

# å¸ƒå±€è°ƒæ•´
plt.tight_layout()
plt.show()

```

## 3.é¡¹ç›® GitHub åœ°å€

---

ä»£ç ä¹Ÿé¡ºæ‰‹ä¼ ä¸Šå»äº†ï¼Œå¦‚æœæ‡’å¾—å¤åˆ¶äº†å°±ä¸Šå» GitHub ä¸Šç›´æ¥å»ä¸‹ä¸€ä¸‹å§ã€‚
  
<https://github.com/StChenHaoGitHub/STAR_Decomposition>

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/b33cacf8808548e08cfef6555032a6fa.png)

## 4.ç»“æŸ

---

è¿™ç¯‡å†…å®¹å†™çš„ä¹Ÿæ˜¯æ¯”è¾ƒç´¯çš„ï¼Œç¡®å®éš¾åº¦ä¹Ÿä¸å°ï¼Œè€Œä¸”å®ç”¨æ€§ä¹Ÿå­˜ç–‘ï¼Œä½†æ˜¯æˆ‘è¦æ˜¯ç”¨ä¸äº†ç»™å¸ˆå¼Ÿæ‹¿å»æ•´ä¸ªèŠ±æ´»å‡‘ä¸ªä¸å®ç”¨çš„åˆ›æ–°ç‚¹ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚è¿™ä¸ªå°±å…ˆè¿™æ ·å§ã€‚