---
layout: post
title: "STAR-Decomposition-一种针对极端事件的信号分解方法-论文精读加复现"
date: 2025-03-14 19:39:05 +0800
description: "本文复现了一种针对极端事件的 STAR 信号分解算法的，首先逐句精读了论文部分，之后手搓复现了分解代码，并提供了代码逐行解释和 项目的 GitHub 地址。"
keywords: "STAR Decomposition 一种针对极端事件的信号分解方法 论文精读加复现"
categories: ['未分类']
tags: ['信号处理']
artid: "146259855"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146259855
    alt: "STAR-Decomposition-一种针对极端事件的信号分解方法-论文精读加复现"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146259855
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146259855
cover: https://bing.ee123.net/img/rand?artid=146259855
image: https://bing.ee123.net/img/rand?artid=146259855
img: https://bing.ee123.net/img/rand?artid=146259855
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     STAR Decomposition 一种针对极端事件的信号分解方法 论文精读加复现
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="font_colorredSTAR_font_0">
     </a>
     <font color="red">
      STAR 分解
     </font>
     🚀
    </h2>
    <hr/>
    <p>
     在时序预测任务中，为了情绪化信号的各种成分，例如趋势信息季节信息等往往都需要对信号进行分解。目前熟知的分解方式有很多种，经验模态分解 EMD 变分模态分解 VMD ，还有 集合经验模态分解 EEMD，自适应噪声完备集合经验模态分解 CEEMDAN 等等，但这些和小波变换分解类似，一般都不会针对异常信号和极端事件进行分解。STAR 是一个比较冷门的分解方式，是我在Paper with Code 淘宝的时候发现的，他来源于 2022 年的 一篇叫
     <a href="https://paperswithcode.com/paper/aa-forecast-anomaly-aware-forecast-for" rel="nofollow">
      AA-Forecast: Anomaly-Aware Forecast for Extreme Events
     </a>
     。中提出的，个人认为这块是一个比较容易拼出一个创新点的内容。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/a210ab3d4bc74ebe83aba4724d02dea9.png">
      <br/>
     </img>
    </p>
    <br/>
    根据论文结构图，整个论文是分 STAR 分解，异常感知模型 Anomaly-Aware Model ，动态不确定性优化 Dynamic Uncertainty Optimization 三个部分，这里就先值关注第一个 STAR 分解的部分。
    <br/>
    <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/ae4a59a6aa3b43d59a361ee72b206118.png">
     <p>
     </p>
     <h2>
      <a id="font_colorblue1STAR_Decomposition_font_7">
      </a>
      <font color="blue">
       1.STAR Decomposition 论文精读部分
      </font>
     </h2>
     <hr/>
     <p>
      对于这个分解方法的描述写在了论文的 3.1 部分，也不是很长，但我也是整体精读了下来，也从 Paper with Code 的官方链接上下载了代码进行对照，可以说如果其实有一些核心的地方是没有讲清楚的，所以导致看上去挺不错的东西，没啥人用，接下来就直接对 3.1 的部分精读一下，翻译的话是结合 DeepSeek 初步翻译，然后加上我自己的理解精调的。
     </p>
     <p>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/20520d41420a4b3c82bcb03740bb2db5.png"/>
     </p>
     <ul>
      <li>
       <p>
        <em>
         STAR decomposition is used as a strategy to not only extract the anomalies and sudden changes of data but also decompose the complex time series to its essential components.
        </em>
        <br/>
        <strong>
         STAR分解被用作一种策略，不仅用于提取数据的异常值和突变，而且还用于将复杂的时间序列分解为其基本组成部分。
        </strong>
       </p>
      </li>
      <li>
       <p>
        <em>
         Unfortunately, widely popular decomposition method such as STL [14] does not extract anomalies.
        </em>
        <br/>
        <strong>
         不幸的是，广泛使用的 STL 方法不适用于去提取异常值
        </strong>
        。
       </p>
      </li>
     </ul>
     <blockquote>
      <p>
       STL 信号分解方法即基于局部加权回归的季节性趋势分解法（Seasonal and Trend decomposition using Loess）。
      </p>
     </blockquote>
     <ul>
      <li>
       <p>
        <em>
         Although recent works such as STR [15] and RobustSTL [16] are designed to be robust to the extreme effect of anomalies in their decomposition, they are not used to explicitly extract anomalies from the residual component.
        </em>
        <br/>
        <strong>
         尽管最近的工作，如STR [15] 和 RobustSTL [16] 被设计为在其分解过程中对异常的极端效应具有鲁棒性，但它们并未被用来明确地从残差分量中提取异常。
        </strong>
       </p>
      </li>
      <li>
       <p>
        <em>
         To alleviate these issues, we propose STAR decomposition that are decomposes the original time series
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            x 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           x^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.888em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               x
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.888em;">
                  <span class="" style="top: -3.063em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         in multiplicative manner to its seasonal
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            s 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           s^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.888em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               s
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.888em;">
                  <span class="" style="top: -3.063em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         ,trend
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            t 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           t^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.888em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               t
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.888em;">
                  <span class="" style="top: -3.063em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         ,anomalies
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            a 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           a^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.888em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               a
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.888em;">
                  <span class="" style="top: -3.063em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         , and residual
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            r 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           r^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.888em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal" style="margin-right: 0.0278em;">
               r
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.888em;">
                  <span class="" style="top: -3.063em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         components:
        </em>
        <br/>
        <mark>
         <strong>
          为了解决这个问题我们提出了 STAR 分解 ，将原始信号
          <span class="katex--inline">
           <span class="katex">
            <span class="katex-mathml">
             x 
             
             
             
               ( 
              
             
               k 
              
             
               ) 
              
             
            
           
          
            x^{(k)}
            </span>
            <span class="katex-html">
             <span class="base">
              <span class="strut" style="height: 0.888em;">
              </span>
              <span class="mord">
               <span class="mord mathnormal">
                x
               </span>
               <span class="msupsub">
                <span class="vlist-t">
                 <span class="vlist-r">
                  <span class="vlist" style="height: 0.888em;">
                   <span class="" style="top: -3.063em; margin-right: 0.05em;">
                    <span class="pstrut" style="height: 2.7em;">
                    </span>
                    <span class="sizing reset-size6 size3 mtight">
                     <span class="mord mtight">
                      <span class="mopen mtight">
                       (
                      </span>
                      <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                       k
                      </span>
                      <span class="mclose mtight">
                       )
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          分解为 季节成分
          <span class="katex--inline">
           <span class="katex">
            <span class="katex-mathml">
             s 
             
             
             
               ( 
              
             
               k 
              
             
               ) 
              
             
            
           
          
            s^{(k)}
            </span>
            <span class="katex-html">
             <span class="base">
              <span class="strut" style="height: 0.888em;">
              </span>
              <span class="mord">
               <span class="mord mathnormal">
                s
               </span>
               <span class="msupsub">
                <span class="vlist-t">
                 <span class="vlist-r">
                  <span class="vlist" style="height: 0.888em;">
                   <span class="" style="top: -3.063em; margin-right: 0.05em;">
                    <span class="pstrut" style="height: 2.7em;">
                    </span>
                    <span class="sizing reset-size6 size3 mtight">
                     <span class="mord mtight">
                      <span class="mopen mtight">
                       (
                      </span>
                      <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                       k
                      </span>
                      <span class="mclose mtight">
                       )
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          ，趋势成分
          <span class="katex--inline">
           <span class="katex">
            <span class="katex-mathml">
             t 
             
             
             
               ( 
              
             
               k 
              
             
               ) 
              
             
            
           
          
            t^{(k)}
            </span>
            <span class="katex-html">
             <span class="base">
              <span class="strut" style="height: 0.888em;">
              </span>
              <span class="mord">
               <span class="mord mathnormal">
                t
               </span>
               <span class="msupsub">
                <span class="vlist-t">
                 <span class="vlist-r">
                  <span class="vlist" style="height: 0.888em;">
                   <span class="" style="top: -3.063em; margin-right: 0.05em;">
                    <span class="pstrut" style="height: 2.7em;">
                    </span>
                    <span class="sizing reset-size6 size3 mtight">
                     <span class="mord mtight">
                      <span class="mopen mtight">
                       (
                      </span>
                      <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                       k
                      </span>
                      <span class="mclose mtight">
                       )
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          ，异常成分
          <span class="katex--inline">
           <span class="katex">
            <span class="katex-mathml">
             a 
             
             
             
               ( 
              
             
               k 
              
             
               ) 
              
             
            
           
          
            a^{(k)}
            </span>
            <span class="katex-html">
             <span class="base">
              <span class="strut" style="height: 0.888em;">
              </span>
              <span class="mord">
               <span class="mord mathnormal">
                a
               </span>
               <span class="msupsub">
                <span class="vlist-t">
                 <span class="vlist-r">
                  <span class="vlist" style="height: 0.888em;">
                   <span class="" style="top: -3.063em; margin-right: 0.05em;">
                    <span class="pstrut" style="height: 2.7em;">
                    </span>
                    <span class="sizing reset-size6 size3 mtight">
                     <span class="mord mtight">
                      <span class="mopen mtight">
                       (
                      </span>
                      <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                       k
                      </span>
                      <span class="mclose mtight">
                       )
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          ，残差成分
          <span class="katex--inline">
           <span class="katex">
            <span class="katex-mathml">
             r 
             
             
             
               ( 
              
             
               k 
              
             
               ) 
              
             
            
           
          
            r^{(k)}
            </span>
            <span class="katex-html">
             <span class="base">
              <span class="strut" style="height: 0.888em;">
              </span>
              <span class="mord">
               <span class="mord mathnormal" style="margin-right: 0.0278em;">
                r
               </span>
               <span class="msupsub">
                <span class="vlist-t">
                 <span class="vlist-r">
                  <span class="vlist" style="height: 0.888em;">
                   <span class="" style="top: -3.063em; margin-right: 0.05em;">
                    <span class="pstrut" style="height: 2.7em;">
                    </span>
                    <span class="sizing reset-size6 size3 mtight">
                     <span class="mord mtight">
                      <span class="mopen mtight">
                       (
                      </span>
                      <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                       k
                      </span>
                      <span class="mclose mtight">
                       )
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          的相乘。
         </strong>
        </mark>
        <br/>
        <span class="katex--display">
         <span class="katex-display">
          <span class="katex">
           <span class="katex-mathml">
            x 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
            = 
           
           
           
             s 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
            × 
           
           
           
             t 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
            × 
           
           
           
             a 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
            × 
           
           
           
             r 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           x^{(k)} = s^{(k)}×t^{(k)}×a^{(k)}×r^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.938em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               x
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.938em;">
                  <span class="" style="top: -3.113em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="mspace" style="margin-right: 0.2778em;">
             </span>
             <span class="mrel">
              =
             </span>
             <span class="mspace" style="margin-right: 0.2778em;">
             </span>
            </span>
            <span class="base">
             <span class="strut" style="height: 1.0213em; vertical-align: -0.0833em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               s
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.938em;">
                  <span class="" style="top: -3.113em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="mspace" style="margin-right: 0.2222em;">
             </span>
             <span class="mbin">
              ×
             </span>
             <span class="mspace" style="margin-right: 0.2222em;">
             </span>
            </span>
            <span class="base">
             <span class="strut" style="height: 1.0213em; vertical-align: -0.0833em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               t
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.938em;">
                  <span class="" style="top: -3.113em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="mspace" style="margin-right: 0.2222em;">
             </span>
             <span class="mbin">
              ×
             </span>
             <span class="mspace" style="margin-right: 0.2222em;">
             </span>
            </span>
            <span class="base">
             <span class="strut" style="height: 1.0213em; vertical-align: -0.0833em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               a
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.938em;">
                  <span class="" style="top: -3.113em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="mspace" style="margin-right: 0.2222em;">
             </span>
             <span class="mbin">
              ×
             </span>
             <span class="mspace" style="margin-right: 0.2222em;">
             </span>
            </span>
            <span class="base">
             <span class="strut" style="height: 0.938em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal" style="margin-right: 0.0278em;">
               r
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.938em;">
                  <span class="" style="top: -3.113em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </p>
      </li>
     </ul>
     <blockquote>
      <p>
       季节成分：是指时间序列数据中呈现出的周期性、重复性的模式，其周期通常是固定的，与季节、月份、星期、甚至一天中的不同时段等时间因素相关。
      </p>
     </blockquote>
     <ul>
      <li>
       <p>
        <em>
         Such decomposition not only increases the dimensions of the original data but also supplies us withextracted anomalies.
        </em>
        <br/>
        这种分解不仅增加了原始的数据维度，还为我们提供了提取出的异常值。
       </p>
      </li>
      <li>
       <p>
        As shown in Figure 1:
        <br/>
        分解效果如图1所示：
        <br/>
        <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/1d65633e23af4929a5e4a6ec1caf593f.png"/>
       </p>
      </li>
      <li>
       <p>
        <em>
         we begin the decomposition by approximating the trend line
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            t 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           t^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.888em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               t
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.888em;">
                  <span class="" style="top: -3.063em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         with the locally weighted scatterplot smoothing (i.e. LOESS).
        </em>
        <br/>
        <strong>
         我们通过局部加权散点点平滑来近似趋势线
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            t 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           t^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.888em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               t
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.888em;">
                  <span class="" style="top: -3.063em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         ，开始进行分解。
        </strong>
       </p>
      </li>
     </ul>
     <blockquote>
      <p>
       LOESS 算法，即局部加权散点平滑法（Locally Weighted Scatterplot Smoothing），是一种用于数据拟合和曲线平滑的非参数统计方法。它通过对每个数据点附近的局部数据进行加权回归，来估计该点的平滑值。其优点是不需要对数据的分布形式做出先验假设，能够自适应地根据数据的局部特征进行拟合，对于具有复杂非线性关系的数据有较好的拟合效果，能有效去除数据中的噪声，展现出数据的潜在趋势。
      </p>
     </blockquote>
     <ul>
      <li>
       <p>
        <em>
         Then, we divide the original data
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            x 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           x^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.888em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               x
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.888em;">
                  <span class="" style="top: -3.063em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         by the approximated trend line to derive the detrended time series.
        </em>
        <br/>
        <strong>
         接下来我门用原始信号
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            x 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           x^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.888em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               x
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.888em;">
                  <span class="" style="top: -3.063em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         除以趋势信号
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            t 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           t^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.888em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               t
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.888em;">
                  <span class="" style="top: -3.063em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         ，得到去除时间趋势之后的序列。
        </strong>
       </p>
      </li>
      <li>
       <p>
        <em>
         We then partition the detrended time series into periods of cyclic sub-series where the cycle size is determined by the time interval of the dataset.
        </em>
        <br/>
        <strong>
         然后我们将去趋势的时间序列分割成周期性的子序列，其中周期大小由数据集的时间间隔决定。
        </strong>
       </p>
      </li>
      <li>
       <p>
        <em>
         As an example, the cycle size for a monthly dataset would be 12. Then we obtain the seasonal component
        </em>
        <br/>
        <strong>
         举一个例子，假设是一个月度数据，则周期大小将是12。
        </strong>
       </p>
      </li>
      <li>
       <p>
        <em>
         Subsequently, the residual component
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            r 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           r^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.888em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal" style="margin-right: 0.0278em;">
               r
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.888em;">
                  <span class="" style="top: -3.063em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         is derived by dividing the seasonal and trend segments from the original series.
        </em>
        <br/>
        <strong>
         之后，残留的残差成分
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            r 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           r^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.888em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal" style="margin-right: 0.0278em;">
               r
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.888em;">
                  <span class="" style="top: -3.063em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         是原始信号
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            x 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           x^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.888em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               x
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.888em;">
                  <span class="" style="top: -3.063em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         除以趋势成分
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            t 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           t^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.888em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               t
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.888em;">
                  <span class="" style="top: -3.063em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         和季节成分
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            s 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           s^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.888em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               s
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.888em;">
                  <span class="" style="top: -3.063em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         得到的。
        </strong>
       </p>
      </li>
      <li>
       <p>
        <em>
         Note that the anomaly component
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            a 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           a^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.888em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               a
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.888em;">
                  <span class="" style="top: -3.063em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         can be considered as the oddities of the dataset, which do not follow the extracted trend or seasonal components.
        </em>
        <br/>
        <strong>
         值得注意的是
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            a 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           a^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.888em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               a
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.888em;">
                  <span class="" style="top: -3.063em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         可以被视为数据集中的异常情况，这个异常情况不随季节和趋势的变化而变化。
        </strong>
       </p>
      </li>
      <li>
       <p>
        <em>
         Intuitively, anomalies are spread out through residual components, which also contain noise and other real-world effects.
        </em>
        <br/>
        <strong>
         直观上，异常值通常在分布残差成分中，这些异常值包含噪声和其他显示的现实世界的影响。
        </strong>
       </p>
      </li>
     </ul>
     <hr/>
     <p>
      残差成分 Residuals 和异常成分的区别 Anomalies 的区别。
     </p>
     <table>
      <thead>
       <tr>
        <th>
        </th>
        <th>
         残差 (Residuals)
        </th>
        <th>
         <strong>
          异常 (Anomalies)
         </strong>
        </th>
       </tr>
      </thead>
      <tbody>
       <tr>
        <td>
         <strong>
          定义
         </strong>
        </td>
        <td>
         模型无法解释的所有剩余波动
        </td>
        <td>
         显著偏离正常模式的极端值
        </td>
       </tr>
       <tr>
        <td>
         <strong>
          组成
         </strong>
        </td>
        <td>
         噪声 + 未建模因素 + 潜在异常
        </td>
        <td>
         残差中的特殊子集
        </td>
       </tr>
       <tr>
        <td>
         <strong>
          性质
         </strong>
        </td>
        <td>
         必然存在（模型不可能完美）
        </td>
        <td>
         偶然出现（需要特别检测）
        </td>
       </tr>
       <tr>
        <td>
         <strong>
          处理
         </strong>
        </td>
        <td>
         分析分布特征
        </td>
        <td>
         需要单独识别和调查
        </td>
       </tr>
       <tr>
        <td>
         <strong>
          示例
         </strong>
        </td>
        <td>
         日销售额波动 ±5%
        </td>
        <td>
         某天销售额突然暴涨200%
        </td>
       </tr>
      </tbody>
     </table>
     <ul>
      <li>
       <strong>
        残差
       </strong>
       = 浪花（包含正常涟漪、小鱼跃出水面、偶尔的垃圾漂浮）
      </li>
      <li>
       <strong>
        异常
       </strong>
       = 突然出现的巨型漩涡（需要立即关注的特殊现象）
      </li>
     </ul>
     <hr/>
     <ul>
      <li>
       <em>
        To distinguish the anomalies from residual components, statistical metrics such as mean and variance are not the appropriate measure as they are highly sensitive to the severity level of anomaly values.
       </em>
       <br/>
       <strong>
        为了区分异常值和残差分量，均值和方差等统计度量不是适当的衡量方法，因为他们对异常值的异常程度非常敏感。
       </strong>
      </li>
     </ul>
     <hr/>
     <p>
      <strong>
       假设你是班主任，要找出考试作弊的学生（异常检测）：
      </strong>
     </p>
     <ul>
      <li>
       <strong>
        班级平均分（mean）
       </strong>
       = 所有学生分数的平均值
      </li>
      <li>
       <strong>
        分数波动（variance）
       </strong>
       = 学生们分数的分散程度
      </li>
     </ul>
     <p>
      <strong>
       现在有两个作弊情况：
      </strong>
     </p>
     <ol>
      <li>
       张三：偷偷抄答案考了100分（极端异常值）
      </li>
      <li>
       李四：偶尔偷看考了75分（轻度异常值）
      </li>
     </ol>
     <p>
      <strong>
       如果只用均值和方差判断：
      </strong>
     </p>
     <ul>
      <li>
       张三的100分会大幅拉高班级平均分（比如从70→78）
      </li>
      <li>
       方差也会急剧增大（分数范围从50-80变成50-100）
      </li>
     </ul>
     <p>
      <mark>
       通过均值和方差判则无法找出李四的异常
      </mark>
     </p>
     <hr/>
     <ul>
      <li>
       <p>
        <em>
         As one expects, the severity of the anomalies can change the mean and variance values which are unwanted.
        </em>
        <br/>
        <strong>
         正如所设想的内样，异常的严重程度会以我们不期望的形式改变均值和方式。
        </strong>
       </p>
      </li>
      <li>
       <p>
        <em>
         To resolve this issue, we leverage the median of the residuals, which is immune to the severity of the outliers in the residual components.
        </em>
        <br/>
        <strong>
         为了解决这个问题，我们利用残差的中位数，它对残差分量中的异常值的严重程度具有免疫力。
        </strong>
       </p>
      </li>
      <li>
       <p>
        <em>
         Next,we define robustness score
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            ρ 
            
           
             t 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           \rho_t^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 1.2906em; vertical-align: -0.2458em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               ρ
              </span>
              <span class="msupsub">
               <span class="vlist-t vlist-t2">
                <span class="vlist-r">
                 <span class="vlist" style="height: 1.0448em;">
                  <span class="" style="top: -2.4542em; margin-left: 0em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mathnormal mtight">
                     t
                    </span>
                   </span>
                  </span>
                  <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="vlist-s">
                  ​
                 </span>
                </span>
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.2458em;">
                  <span class="">
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         for each observation at time
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            t 
           
          
         
           t
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.6151em;">
             </span>
             <span class="mord mathnormal">
              t
             </span>
            </span>
           </span>
          </span>
         </span>
         as：
        </em>
        <br/>
        <strong>
         接下来我们为在各个
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            t 
           
          
         
           t
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.6151em;">
             </span>
             <span class="mord mathnormal">
              t
             </span>
            </span>
           </span>
          </span>
         </span>
         时刻的每一个观察值定义了鲁棒性因子
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            ρ 
            
           
             t 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           \rho_t^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 1.2906em; vertical-align: -0.2458em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               ρ
              </span>
              <span class="msupsub">
               <span class="vlist-t vlist-t2">
                <span class="vlist-r">
                 <span class="vlist" style="height: 1.0448em;">
                  <span class="" style="top: -2.4542em; margin-left: 0em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mathnormal mtight">
                     t
                    </span>
                   </span>
                  </span>
                  <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="vlist-s">
                  ​
                 </span>
                </span>
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.2458em;">
                  <span class="">
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         公式如下：
        </strong>
        <br/>
        <span class="katex--display">
         <span class="katex-display">
          <span class="katex">
           <span class="katex-mathml">
            ρ 
            
           
             t 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
            = 
           
           
            
            
              ∣ 
             
             
             
               r 
              
             
               t 
              
              
              
                ( 
               
              
                k 
               
              
                ) 
               
              
             
            
              − 
             
             
              
              
                r 
               
              
                ˙ 
               
              
              
              
                ( 
               
              
                k 
               
              
                ) 
               
              
             
            
              ∣ 
             
            
            
             
              
               
               
                 ∑ 
                
                
                
                  t 
                 
                
                  = 
                 
                
                  1 
                 
                
               
                 T 
                
               
               
               
                 ∣ 
                
                
                
                  r 
                 
                
                  t 
                 
                 
                 
                   ( 
                  
                 
                   k 
                  
                 
                   ) 
                  
                 
                
               
                 − 
                
                
                 
                 
                   r 
                  
                 
                   ˙ 
                  
                 
                 
                 
                   ( 
                  
                 
                   k 
                  
                 
                   ) 
                  
                 
                
               
                 ∣ 
                
               
              
              
              
                T 
               
              
                − 
               
              
                1 
               
              
             
            
           
          
         
           \rho_t^{(k)} = \frac{\left| r_t^{(k)} - \dot{r}^{(k)} \right|}{\sqrt{\frac{\sum_{t = 1}^{T} \left| r_t^{(k)} - \dot{r}^{(k)} \right|}{T - 1}}}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 1.2906em; vertical-align: -0.2458em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               ρ
              </span>
              <span class="msupsub">
               <span class="vlist-t vlist-t2">
                <span class="vlist-r">
                 <span class="vlist" style="height: 1.0448em;">
                  <span class="" style="top: -2.4542em; margin-left: 0em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mathnormal mtight">
                     t
                    </span>
                   </span>
                  </span>
                  <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="vlist-s">
                  ​
                 </span>
                </span>
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.2458em;">
                  <span class="">
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="mspace" style="margin-right: 0.2778em;">
             </span>
             <span class="mrel">
              =
             </span>
             <span class="mspace" style="margin-right: 0.2778em;">
             </span>
            </span>
            <span class="base">
             <span class="strut" style="height: 4.52em; vertical-align: -2.33em;">
             </span>
             <span class="mord">
              <span class="mopen nulldelimiter">
              </span>
              <span class="mfrac">
               <span class="vlist-t vlist-t2">
                <span class="vlist-r">
                 <span class="vlist" style="height: 2.19em;">
                  <span class="" style="top: -2.11em;">
                   <span class="pstrut" style="height: 3.8383em;">
                   </span>
                   <span class="mord">
                    <span class="mord sqrt">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 1.8383em;">
                        <span class="svg-align" style="top: -4.4em;">
                         <span class="pstrut" style="height: 4.4em;">
                         </span>
                         <span class="mord" style="padding-left: 1em;">
                          <span class="mord">
                           <span class="mopen nulldelimiter">
                           </span>
                           <span class="mfrac">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 1.51em;">
                               <span class="" style="top: -2.655em;">
                                <span class="pstrut" style="height: 3em;">
                                </span>
                                <span class="sizing reset-size6 size3 mtight">
                                 <span class="mord mtight">
                                  <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                                   T
                                  </span>
                                  <span class="mbin mtight">
                                   −
                                  </span>
                                  <span class="mord mtight">
                                   1
                                  </span>
                                 </span>
                                </span>
                               </span>
                               <span class="" style="top: -3.23em;">
                                <span class="pstrut" style="height: 3em;">
                                </span>
                                <span class="frac-line" style="border-bottom-width: 0.04em;">
                                </span>
                               </span>
                               <span class="" style="top: -3.735em;">
                                <span class="pstrut" style="height: 3em;">
                                </span>
                                <span class="sizing reset-size6 size3 mtight">
                                 <span class="mord mtight">
                                  <span class="mop mtight">
                                   <span class="mop op-symbol small-op mtight" style="position: relative; top: 0em;">
                                    ∑
                                   </span>
                                   <span class="msupsub">
                                    <span class="vlist-t vlist-t2">
                                     <span class="vlist-r">
                                      <span class="vlist" style="height: 0.8852em;">
                                       <span class="" style="top: -2.1786em; margin-left: 0em; margin-right: 0.0714em;">
                                        <span class="pstrut" style="height: 2.5em;">
                                        </span>
                                        <span class="sizing reset-size3 size1 mtight">
                                         <span class="mord mtight">
                                          <span class="mord mathnormal mtight">
                                           t
                                          </span>
                                          <span class="mrel mtight">
                                           =
                                          </span>
                                          <span class="mord mtight">
                                           1
                                          </span>
                                         </span>
                                        </span>
                                       </span>
                                       <span class="" style="top: -2.8971em; margin-right: 0.0714em;">
                                        <span class="pstrut" style="height: 2.5em;">
                                        </span>
                                        <span class="sizing reset-size3 size1 mtight">
                                         <span class="mord mtight">
                                          <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                                           T
                                          </span>
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                      <span class="vlist-s">
                                       ​
                                      </span>
                                     </span>
                                     <span class="vlist-r">
                                      <span class="vlist" style="height: 0.3214em;">
                                       <span class="">
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                  <span class="minner mtight">
                                   <span class="mopen sizing reset-size3 size6 mtight">
                                    <span class="delimsizing mult">
                                     <span class="vlist-t vlist-t2">
                                      <span class="vlist-r">
                                       <span class="vlist" style="height: 0.775em;">
                                        <span class="" style="top: -2.775em;">
                                         <span class="pstrut" style="height: 3.2em;">
                                         </span>
                                         <span class="mtight" style="width: 0.333em; height: 1.2em;">
                                          <svg height="1.200em" viewbox="0 0 333 1200" width="0.333em">
                                           <path d="M145 15 v585 v0 v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v0 v585 h43z">
                                           </path>
                                          </svg>
                                         </span>
                                        </span>
                                       </span>
                                       <span class="vlist-s">
                                        ​
                                       </span>
                                      </span>
                                      <span class="vlist-r">
                                       <span class="vlist" style="height: 0.425em;">
                                        <span class="">
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                   <span class="mord mtight">
                                    <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                                     r
                                    </span>
                                    <span class="msupsub">
                                     <span class="vlist-t vlist-t2">
                                      <span class="vlist-r">
                                       <span class="vlist" style="height: 1.0591em;">
                                        <span class="" style="top: -2.2452em; margin-left: -0.0278em; margin-right: 0.0714em;">
                                         <span class="pstrut" style="height: 2.5357em;">
                                         </span>
                                         <span class="sizing reset-size3 size1 mtight">
                                          <span class="mord mathnormal mtight">
                                           t
                                          </span>
                                         </span>
                                        </span>
                                        <span class="" style="top: -3.0591em; margin-right: 0.0714em;">
                                         <span class="pstrut" style="height: 2.5357em;">
                                         </span>
                                         <span class="sizing reset-size3 size1 mtight">
                                          <span class="mord mtight">
                                           <span class="mopen mtight">
                                            (
                                           </span>
                                           <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                                            k
                                           </span>
                                           <span class="mclose mtight">
                                            )
                                           </span>
                                          </span>
                                         </span>
                                        </span>
                                       </span>
                                       <span class="vlist-s">
                                        ​
                                       </span>
                                      </span>
                                      <span class="vlist-r">
                                       <span class="vlist" style="height: 0.2905em;">
                                        <span class="">
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                   <span class="mbin mtight">
                                    −
                                   </span>
                                   <span class="mord mtight">
                                    <span class="mord accent mtight">
                                     <span class="vlist-t">
                                      <span class="vlist-r">
                                       <span class="vlist" style="height: 0.6679em;">
                                        <span class="" style="top: -2.7em;">
                                         <span class="pstrut" style="height: 2.7em;">
                                         </span>
                                         <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                                          r
                                         </span>
                                        </span>
                                        <span class="" style="top: -2.7em;">
                                         <span class="pstrut" style="height: 2.7em;">
                                         </span>
                                         <span class="accent-body" style="left: -0.0833em;">
                                          <span class="mord mtight">
                                           ˙
                                          </span>
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                    <span class="msupsub">
                                     <span class="vlist-t">
                                      <span class="vlist-r">
                                       <span class="vlist" style="height: 0.822em;">
                                        <span class="" style="top: -2.822em; margin-right: 0.0714em;">
                                         <span class="pstrut" style="height: 2.5357em;">
                                         </span>
                                         <span class="sizing reset-size3 size1 mtight">
                                          <span class="mord mtight">
                                           <span class="mopen mtight">
                                            (
                                           </span>
                                           <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                                            k
                                           </span>
                                           <span class="mclose mtight">
                                            )
                                           </span>
                                          </span>
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                   <span class="mclose sizing reset-size3 size6 mtight">
                                    <span class="delimsizing mult">
                                     <span class="vlist-t vlist-t2">
                                      <span class="vlist-r">
                                       <span class="vlist" style="height: 0.775em;">
                                        <span class="" style="top: -2.775em;">
                                         <span class="pstrut" style="height: 3.2em;">
                                         </span>
                                         <span class="mtight" style="width: 0.333em; height: 1.2em;">
                                          <svg height="1.200em" viewbox="0 0 333 1200" width="0.333em">
                                           <path d="M145 15 v585 v0 v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v0 v585 h43z">
                                           </path>
                                          </svg>
                                         </span>
                                        </span>
                                       </span>
                                       <span class="vlist-s">
                                        ​
                                       </span>
                                      </span>
                                      <span class="vlist-r">
                                       <span class="vlist" style="height: 0.425em;">
                                        <span class="">
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               ​
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.4033em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                           <span class="mclose nulldelimiter">
                           </span>
                          </span>
                         </span>
                        </span>
                        <span class="" style="top: -3.7983em;">
                         <span class="pstrut" style="height: 4.4em;">
                         </span>
                         <span class="hide-tail" style="min-width: 1.02em; height: 2.48em;">
                          <svg height="2.48em" preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 2592" width="400em">
                           <path d="M424,2478
c-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514
c0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20
s-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121
s209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081
l0 -0c4,-6.7,10,-10,18,-10 H400000
v40H1014.6
s-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185
c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2z M1001 80
h400000v40h-400000z">
                           </path>
                          </svg>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        ​
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.6017em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="" style="top: -4.0683em;">
                   <span class="pstrut" style="height: 3.8383em;">
                   </span>
                   <span class="frac-line" style="border-bottom-width: 0.04em;">
                   </span>
                  </span>
                  <span class="" style="top: -4.8783em;">
                   <span class="pstrut" style="height: 3.8383em;">
                   </span>
                   <span class="mord">
                    <span class="minner">
                     <span class="mopen">
                      <span class="delimsizing mult">
                       <span class="vlist-t vlist-t2">
                        <span class="vlist-r">
                         <span class="vlist" style="height: 1.15em;">
                          <span class="" style="top: -3.15em;">
                           <span class="pstrut" style="height: 3.8em;">
                           </span>
                           <span class="" style="width: 0.333em; height: 1.8em;">
                            <svg height="1.800em" viewbox="0 0 333 1800" width="0.333em">
                             <path d="M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z">
                             </path>
                            </svg>
                           </span>
                          </span>
                         </span>
                         <span class="vlist-s">
                          ​
                         </span>
                        </span>
                        <span class="vlist-r">
                         <span class="vlist" style="height: 0.65em;">
                          <span class="">
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="mord">
                      <span class="mord mathnormal" style="margin-right: 0.0278em;">
                       r
                      </span>
                      <span class="msupsub">
                       <span class="vlist-t vlist-t2">
                        <span class="vlist-r">
                         <span class="vlist" style="height: 1.0448em;">
                          <span class="" style="top: -2.4542em; margin-left: -0.0278em; margin-right: 0.05em;">
                           <span class="pstrut" style="height: 2.7em;">
                           </span>
                           <span class="sizing reset-size6 size3 mtight">
                            <span class="mord mathnormal mtight">
                             t
                            </span>
                           </span>
                          </span>
                          <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                           <span class="pstrut" style="height: 2.7em;">
                           </span>
                           <span class="sizing reset-size6 size3 mtight">
                            <span class="mord mtight">
                             <span class="mopen mtight">
                              (
                             </span>
                             <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                              k
                             </span>
                             <span class="mclose mtight">
                              )
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                         <span class="vlist-s">
                          ​
                         </span>
                        </span>
                        <span class="vlist-r">
                         <span class="vlist" style="height: 0.2458em;">
                          <span class="">
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="mspace" style="margin-right: 0.2222em;">
                     </span>
                     <span class="mbin">
                      −
                     </span>
                     <span class="mspace" style="margin-right: 0.2222em;">
                     </span>
                     <span class="mord">
                      <span class="mord accent">
                       <span class="vlist-t">
                        <span class="vlist-r">
                         <span class="vlist" style="height: 0.6679em;">
                          <span class="" style="top: -3em;">
                           <span class="pstrut" style="height: 3em;">
                           </span>
                           <span class="mord mathnormal" style="margin-right: 0.0278em;">
                            r
                           </span>
                          </span>
                          <span class="" style="top: -3em;">
                           <span class="pstrut" style="height: 3em;">
                           </span>
                           <span class="accent-body" style="left: -0.0833em;">
                            <span class="mord">
                             ˙
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="msupsub">
                       <span class="vlist-t">
                        <span class="vlist-r">
                         <span class="vlist" style="height: 0.888em;">
                          <span class="" style="top: -3.063em; margin-right: 0.05em;">
                           <span class="pstrut" style="height: 2.7em;">
                           </span>
                           <span class="sizing reset-size6 size3 mtight">
                            <span class="mord mtight">
                             <span class="mopen mtight">
                              (
                             </span>
                             <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                              k
                             </span>
                             <span class="mclose mtight">
                              )
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="mclose">
                      <span class="delimsizing mult">
                       <span class="vlist-t vlist-t2">
                        <span class="vlist-r">
                         <span class="vlist" style="height: 1.15em;">
                          <span class="" style="top: -3.15em;">
                           <span class="pstrut" style="height: 3.8em;">
                           </span>
                           <span class="" style="width: 0.333em; height: 1.8em;">
                            <svg height="1.800em" viewbox="0 0 333 1800" width="0.333em">
                             <path d="M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z">
                             </path>
                            </svg>
                           </span>
                          </span>
                         </span>
                         <span class="vlist-s">
                          ​
                         </span>
                        </span>
                        <span class="vlist-r">
                         <span class="vlist" style="height: 0.65em;">
                          <span class="">
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="vlist-s">
                  ​
                 </span>
                </span>
                <span class="vlist-r">
                 <span class="vlist" style="height: 2.33em;">
                  <span class="">
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="mclose nulldelimiter">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </p>
      </li>
      <li>
       <p>
        <em>
         where
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            ρ 
            
           
             t 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           \rho_t^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 1.2906em; vertical-align: -0.2458em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               ρ
              </span>
              <span class="msupsub">
               <span class="vlist-t vlist-t2">
                <span class="vlist-r">
                 <span class="vlist" style="height: 1.0448em;">
                  <span class="" style="top: -2.4542em; margin-left: 0em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mathnormal mtight">
                     t
                    </span>
                   </span>
                  </span>
                  <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="vlist-s">
                  ​
                 </span>
                </span>
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.2458em;">
                  <span class="">
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         stand for the strength of the anomalies,
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            r 
            
           
             t 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           r_t^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 1.2906em; vertical-align: -0.2458em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal" style="margin-right: 0.0278em;">
               r
              </span>
              <span class="msupsub">
               <span class="vlist-t vlist-t2">
                <span class="vlist-r">
                 <span class="vlist" style="height: 1.0448em;">
                  <span class="" style="top: -2.4542em; margin-left: -0.0278em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mathnormal mtight">
                     t
                    </span>
                   </span>
                  </span>
                  <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="vlist-s">
                  ​
                 </span>
                </span>
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.2458em;">
                  <span class="">
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         is the residual at time step
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            t 
           
          
         
           t
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.6151em;">
             </span>
             <span class="mord mathnormal">
              t
             </span>
            </span>
           </span>
          </span>
         </span>
         and
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            r 
             
            
              ˙ 
             
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           \dot{r}^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.888em;">
             </span>
             <span class="mord">
              <span class="mord accent">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.6679em;">
                  <span class="" style="top: -3em;">
                   <span class="pstrut" style="height: 3em;">
                   </span>
                   <span class="mord mathnormal" style="margin-right: 0.0278em;">
                    r
                   </span>
                  </span>
                  <span class="" style="top: -3em;">
                   <span class="pstrut" style="height: 3em;">
                   </span>
                   <span class="accent-body" style="left: -0.0833em;">
                    <span class="mord">
                     ˙
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.888em;">
                  <span class="" style="top: -3.063em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         is the median of the residuals.
        </em>
        <br/>
        <strong>
         其中
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            ρ 
            
           
             t 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           \rho_t^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 1.2906em; vertical-align: -0.2458em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               ρ
              </span>
              <span class="msupsub">
               <span class="vlist-t vlist-t2">
                <span class="vlist-r">
                 <span class="vlist" style="height: 1.0448em;">
                  <span class="" style="top: -2.4542em; margin-left: 0em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mathnormal mtight">
                     t
                    </span>
                   </span>
                  </span>
                  <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="vlist-s">
                  ​
                 </span>
                </span>
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.2458em;">
                  <span class="">
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         代表异常强度，
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            r 
            
           
             t 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           r_t^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 1.2906em; vertical-align: -0.2458em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal" style="margin-right: 0.0278em;">
               r
              </span>
              <span class="msupsub">
               <span class="vlist-t vlist-t2">
                <span class="vlist-r">
                 <span class="vlist" style="height: 1.0448em;">
                  <span class="" style="top: -2.4542em; margin-left: -0.0278em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mathnormal mtight">
                     t
                    </span>
                   </span>
                  </span>
                  <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="vlist-s">
                  ​
                 </span>
                </span>
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.2458em;">
                  <span class="">
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         时间步
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            t 
           
          
         
           t
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.6151em;">
             </span>
             <span class="mord mathnormal">
              t
             </span>
            </span>
           </span>
          </span>
         </span>
         时刻的残差值，
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            r 
             
            
              ˙ 
             
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           \dot{r}^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.888em;">
             </span>
             <span class="mord">
              <span class="mord accent">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.6679em;">
                  <span class="" style="top: -3em;">
                   <span class="pstrut" style="height: 3em;">
                   </span>
                   <span class="mord mathnormal" style="margin-right: 0.0278em;">
                    r
                   </span>
                  </span>
                  <span class="" style="top: -3em;">
                   <span class="pstrut" style="height: 3em;">
                   </span>
                   <span class="accent-body" style="left: -0.0833em;">
                    <span class="mord">
                     ˙
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.888em;">
                  <span class="" style="top: -3.063em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         是残差成分的中位数。
        </strong>
       </p>
      </li>
      <li>
       <p>
        <em>
         Note that the larger
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            ρ 
            
           
             t 
            
           
          
         
           \rho_t
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               ρ
              </span>
              <span class="msupsub">
               <span class="vlist-t vlist-t2">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.2806em;">
                  <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mathnormal mtight">
                     t
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="vlist-s">
                  ​
                 </span>
                </span>
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.15em;">
                  <span class="">
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         indicates that a drastic change has occurred in the trend and seasonal components. We then extract the anomalies from residuals as below:
        </em>
        <br/>
        <strong>
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            ρ 
            
           
             t 
            
           
          
         
           \rho_t
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               ρ
              </span>
              <span class="msupsub">
               <span class="vlist-t vlist-t2">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.2806em;">
                  <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mathnormal mtight">
                     t
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="vlist-s">
                  ​
                 </span>
                </span>
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.15em;">
                  <span class="">
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         较大表明趋势和季节性成分发生了剧烈的变化，我们从残差中提取异常如下。
        </strong>
        <br/>
        <span class="katex--display">
         <span class="katex-display">
          <span class="katex">
           <span class="katex-mathml">
            a 
            
           
             t 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
            = 
           
           
           
             { 
            
            
             
              
               
                
                
                  1 
                 
                
                  , 
                 
                
               
              
              
               
                
                 
                 
                   ρ 
                  
                 
                   t 
                  
                  
                  
                    ( 
                   
                  
                    k 
                   
                  
                    ) 
                   
                  
                 
                
                  &lt; 
                 
                 
                 
                   ρ 
                  
                 
                   c 
                  
                  
                  
                    ( 
                   
                  
                    k 
                   
                  
                    ) 
                   
                  
                 
                
               
              
             
             
              
               
                
                 
                 
                   r 
                  
                 
                   t 
                  
                  
                  
                    ( 
                   
                  
                    k 
                   
                  
                    ) 
                   
                  
                 
                
                  , 
                 
                
               
              
              
               
                
                 
                 
                   ρ 
                  
                 
                   t 
                  
                  
                  
                    ( 
                   
                  
                    k 
                   
                  
                    ) 
                   
                  
                 
                
                  ≥ 
                 
                 
                 
                   ρ 
                  
                 
                   c 
                  
                  
                  
                    ( 
                   
                  
                    k 
                   
                  
                    ) 
                   
                  
                 
                
               
              
             
            
           
          
         
           \mathbf{a}_t^{(k)} = \begin{cases} 1, &amp; \rho_t^{(k)} &lt; \rho_c^{(k)} \\ r_t^{(k)}, &amp; \rho_t^{(k)} \geq \rho_c^{(k)} \end{cases}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 1.2906em; vertical-align: -0.2458em;">
             </span>
             <span class="mord">
              <span class="mord mathbf">
               a
              </span>
              <span class="msupsub">
               <span class="vlist-t vlist-t2">
                <span class="vlist-r">
                 <span class="vlist" style="height: 1.0448em;">
                  <span class="" style="top: -2.4542em; margin-left: 0em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mathnormal mtight">
                     t
                    </span>
                   </span>
                  </span>
                  <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="vlist-s">
                  ​
                 </span>
                </span>
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.2458em;">
                  <span class="">
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="mspace" style="margin-right: 0.2778em;">
             </span>
             <span class="mrel">
              =
             </span>
             <span class="mspace" style="margin-right: 0.2778em;">
             </span>
            </span>
            <span class="base">
             <span class="strut" style="height: 3em; vertical-align: -1.25em;">
             </span>
             <span class="minner">
              <span class="mopen delimcenter" style="top: 0em;">
               <span class="delimsizing size4">
                {
                <!-- -->
               </span>
              </span>
              <span class="mord">
               <span class="mtable">
                <span class="col-align-l">
                 <span class="vlist-t vlist-t2">
                  <span class="vlist-r">
                   <span class="vlist" style="height: 1.7268em;">
                    <span class="" style="top: -3.7268em;">
                     <span class="pstrut" style="height: 3.0448em;">
                     </span>
                     <span class="mord">
                      <span class="mord">
                       1
                      </span>
                      <span class="mpunct">
                       ,
                      </span>
                     </span>
                    </span>
                    <span class="" style="top: -2.25em;">
                     <span class="pstrut" style="height: 3.0448em;">
                     </span>
                     <span class="mord">
                      <span class="mord">
                       <span class="mord mathnormal" style="margin-right: 0.0278em;">
                        r
                       </span>
                       <span class="msupsub">
                        <span class="vlist-t vlist-t2">
                         <span class="vlist-r">
                          <span class="vlist" style="height: 1.0448em;">
                           <span class="" style="top: -2.4542em; margin-left: -0.0278em; margin-right: 0.05em;">
                            <span class="pstrut" style="height: 2.7em;">
                            </span>
                            <span class="sizing reset-size6 size3 mtight">
                             <span class="mord mathnormal mtight">
                              t
                             </span>
                            </span>
                           </span>
                           <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                            <span class="pstrut" style="height: 2.7em;">
                            </span>
                            <span class="sizing reset-size6 size3 mtight">
                             <span class="mord mtight">
                              <span class="mopen mtight">
                               (
                              </span>
                              <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                               k
                              </span>
                              <span class="mclose mtight">
                               )
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="vlist-s">
                           ​
                          </span>
                         </span>
                         <span class="vlist-r">
                          <span class="vlist" style="height: 0.2458em;">
                           <span class="">
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="mpunct">
                       ,
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="vlist-s">
                    ​
                   </span>
                  </span>
                  <span class="vlist-r">
                   <span class="vlist" style="height: 1.2268em;">
                    <span class="">
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="arraycolsep" style="width: 1em;">
                </span>
                <span class="col-align-l">
                 <span class="vlist-t vlist-t2">
                  <span class="vlist-r">
                   <span class="vlist" style="height: 1.7268em;">
                    <span class="" style="top: -3.7268em;">
                     <span class="pstrut" style="height: 3.0448em;">
                     </span>
                     <span class="mord">
                      <span class="mord">
                       <span class="mord mathnormal">
                        ρ
                       </span>
                       <span class="msupsub">
                        <span class="vlist-t vlist-t2">
                         <span class="vlist-r">
                          <span class="vlist" style="height: 1.0448em;">
                           <span class="" style="top: -2.4542em; margin-left: 0em; margin-right: 0.05em;">
                            <span class="pstrut" style="height: 2.7em;">
                            </span>
                            <span class="sizing reset-size6 size3 mtight">
                             <span class="mord mathnormal mtight">
                              t
                             </span>
                            </span>
                           </span>
                           <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                            <span class="pstrut" style="height: 2.7em;">
                            </span>
                            <span class="sizing reset-size6 size3 mtight">
                             <span class="mord mtight">
                              <span class="mopen mtight">
                               (
                              </span>
                              <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                               k
                              </span>
                              <span class="mclose mtight">
                               )
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="vlist-s">
                           ​
                          </span>
                         </span>
                         <span class="vlist-r">
                          <span class="vlist" style="height: 0.2458em;">
                           <span class="">
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="mspace" style="margin-right: 0.2778em;">
                      </span>
                      <span class="mrel">
                       &lt;
                      </span>
                      <span class="mspace" style="margin-right: 0.2778em;">
                      </span>
                      <span class="mord">
                       <span class="mord mathnormal">
                        ρ
                       </span>
                       <span class="msupsub">
                        <span class="vlist-t vlist-t2">
                         <span class="vlist-r">
                          <span class="vlist" style="height: 1.0448em;">
                           <span class="" style="top: -2.5834em; margin-left: 0em; margin-right: 0.05em;">
                            <span class="pstrut" style="height: 2.7em;">
                            </span>
                            <span class="sizing reset-size6 size3 mtight">
                             <span class="mord mathnormal mtight">
                              c
                             </span>
                            </span>
                           </span>
                           <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                            <span class="pstrut" style="height: 2.7em;">
                            </span>
                            <span class="sizing reset-size6 size3 mtight">
                             <span class="mord mtight">
                              <span class="mopen mtight">
                               (
                              </span>
                              <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                               k
                              </span>
                              <span class="mclose mtight">
                               )
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="vlist-s">
                           ​
                          </span>
                         </span>
                         <span class="vlist-r">
                          <span class="vlist" style="height: 0.1166em;">
                           <span class="">
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                    <span class="" style="top: -2.25em;">
                     <span class="pstrut" style="height: 3.0448em;">
                     </span>
                     <span class="mord">
                      <span class="mord">
                       <span class="mord mathnormal">
                        ρ
                       </span>
                       <span class="msupsub">
                        <span class="vlist-t vlist-t2">
                         <span class="vlist-r">
                          <span class="vlist" style="height: 1.0448em;">
                           <span class="" style="top: -2.4542em; margin-left: 0em; margin-right: 0.05em;">
                            <span class="pstrut" style="height: 2.7em;">
                            </span>
                            <span class="sizing reset-size6 size3 mtight">
                             <span class="mord mathnormal mtight">
                              t
                             </span>
                            </span>
                           </span>
                           <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                            <span class="pstrut" style="height: 2.7em;">
                            </span>
                            <span class="sizing reset-size6 size3 mtight">
                             <span class="mord mtight">
                              <span class="mopen mtight">
                               (
                              </span>
                              <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                               k
                              </span>
                              <span class="mclose mtight">
                               )
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="vlist-s">
                           ​
                          </span>
                         </span>
                         <span class="vlist-r">
                          <span class="vlist" style="height: 0.2458em;">
                           <span class="">
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="mspace" style="margin-right: 0.2778em;">
                      </span>
                      <span class="mrel">
                       ≥
                      </span>
                      <span class="mspace" style="margin-right: 0.2778em;">
                      </span>
                      <span class="mord">
                       <span class="mord mathnormal">
                        ρ
                       </span>
                       <span class="msupsub">
                        <span class="vlist-t vlist-t2">
                         <span class="vlist-r">
                          <span class="vlist" style="height: 1.0448em;">
                           <span class="" style="top: -2.5834em; margin-left: 0em; margin-right: 0.05em;">
                            <span class="pstrut" style="height: 2.7em;">
                            </span>
                            <span class="sizing reset-size6 size3 mtight">
                             <span class="mord mathnormal mtight">
                              c
                             </span>
                            </span>
                           </span>
                           <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                            <span class="pstrut" style="height: 2.7em;">
                            </span>
                            <span class="sizing reset-size6 size3 mtight">
                             <span class="mord mtight">
                              <span class="mopen mtight">
                               (
                              </span>
                              <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                               k
                              </span>
                              <span class="mclose mtight">
                               )
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="vlist-s">
                           ​
                          </span>
                         </span>
                         <span class="vlist-r">
                          <span class="vlist" style="height: 0.1166em;">
                           <span class="">
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="vlist-s">
                    ​
                   </span>
                  </span>
                  <span class="vlist-r">
                   <span class="vlist" style="height: 1.2268em;">
                    <span class="">
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="mclose nulldelimiter">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </p>
      </li>
      <li>
       <p>
        <em>
         where
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            ρ 
            
           
             c 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           \rho_c^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 1.2392em; vertical-align: -0.1944em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               ρ
              </span>
              <span class="msupsub">
               <span class="vlist-t vlist-t2">
                <span class="vlist-r">
                 <span class="vlist" style="height: 1.0448em;">
                  <span class="" style="top: -2.5834em; margin-left: 0em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mathnormal mtight">
                     c
                    </span>
                   </span>
                  </span>
                  <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="vlist-s">
                  ​
                 </span>
                </span>
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.1166em;">
                  <span class="">
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         is the constant threshold given by the value of a robustness score ranked in the
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            p 
           
          
            − 
           
          
         
           p-
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.7778em; vertical-align: -0.1944em;">
             </span>
             <span class="mord mathnormal">
              p
             </span>
             <span class="mord">
              −
             </span>
            </span>
           </span>
          </span>
         </span>
         value 0.05 while the values of elements in
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            ρ 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           \rho^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 1.0824em; vertical-align: -0.1944em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               ρ
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.888em;">
                  <span class="" style="top: -3.063em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         are ranked in descending order from large to small.
        </em>
        <br/>
        <strong>
         其中
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            ρ 
            
           
             c 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           \rho_c^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 1.2392em; vertical-align: -0.1944em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               ρ
              </span>
              <span class="msupsub">
               <span class="vlist-t vlist-t2">
                <span class="vlist-r">
                 <span class="vlist" style="height: 1.0448em;">
                  <span class="" style="top: -2.5834em; margin-left: 0em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mathnormal mtight">
                     c
                    </span>
                   </span>
                  </span>
                  <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="vlist-s">
                  ​
                 </span>
                </span>
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.1166em;">
                  <span class="">
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         是在降序排列的
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            ρ 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           \rho^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 1.0824em; vertical-align: -0.1944em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               ρ
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.888em;">
                  <span class="" style="top: -3.063em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         序列中分位值为 0.05 的时候确定的。
        </strong>
       </p>
      </li>
     </ul>
     <blockquote>
      <p>
       假设有
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          ρ 
          
          
          
            ( 
           
          
            k 
           
          
            ) 
           
          
         
        
       
         \rho^{(k)}
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 1.0824em; vertical-align: -0.1944em;">
           </span>
           <span class="mord">
            <span class="mord mathnormal">
             ρ
            </span>
            <span class="msupsub">
             <span class="vlist-t">
              <span class="vlist-r">
               <span class="vlist" style="height: 0.888em;">
                <span class="" style="top: -3.063em; margin-right: 0.05em;">
                 <span class="pstrut" style="height: 2.7em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mtight">
                   <span class="mopen mtight">
                    (
                   </span>
                   <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                    k
                   </span>
                   <span class="mclose mtight">
                    )
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
       有100个数，阈值
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          ρ 
          
         
           c 
          
          
          
            ( 
           
          
            k 
           
          
            ) 
           
          
         
        
       
         \rho_c^{(k)}
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 1.2392em; vertical-align: -0.1944em;">
           </span>
           <span class="mord">
            <span class="mord mathnormal">
             ρ
            </span>
            <span class="msupsub">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 1.0448em;">
                <span class="" style="top: -2.5834em; margin-left: 0em; margin-right: 0.05em;">
                 <span class="pstrut" style="height: 2.7em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mathnormal mtight">
                   c
                  </span>
                 </span>
                </span>
                <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                 <span class="pstrut" style="height: 2.7em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mtight">
                   <span class="mopen mtight">
                    (
                   </span>
                   <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                    k
                   </span>
                   <span class="mclose mtight">
                    )
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                ​
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 0.1166em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
       就是第5（100×0.05）大的数字
      </p>
     </blockquote>
     <ul>
      <li>
       <p>
        <em>
         Notably, when the value of the anomaly component (
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            a 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           a^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.888em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               a
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.888em;">
                  <span class="" style="top: -3.063em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         ) deviates further from the value 1, it indicates an abrupt change in the trend and the seasonal component (no sign of anomalies).
        </em>
        <br/>
        <strong>
         这里要明确的是，当异常值
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            a 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           a^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.888em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               a
              </span>
              <span class="msupsub">
               <span class="vlist-t">
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.888em;">
                  <span class="" style="top: -3.063em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         的值距离 1 很远时候，它表面确实和季节性成分发生了突然的变化，但不一定是异常。
        </strong>
       </p>
      </li>
      <li>
       <p>
        <em>
         On the contrary, when both anomaly and residual values are equal 1 (
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            r 
            
           
             t 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           r_t^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 1.2906em; vertical-align: -0.2458em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal" style="margin-right: 0.0278em;">
               r
              </span>
              <span class="msupsub">
               <span class="vlist-t vlist-t2">
                <span class="vlist-r">
                 <span class="vlist" style="height: 1.0448em;">
                  <span class="" style="top: -2.4542em; margin-left: -0.0278em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mathnormal mtight">
                     t
                    </span>
                   </span>
                  </span>
                  <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="vlist-s">
                  ​
                 </span>
                </span>
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.2458em;">
                  <span class="">
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         = 1 and
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            a 
            
           
             t 
            
            
            
              ( 
             
            
              k 
             
            
              ) 
             
            
           
          
         
           a_t^{(k)}
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 1.2906em; vertical-align: -0.2458em;">
             </span>
             <span class="mord">
              <span class="mord mathnormal">
               a
              </span>
              <span class="msupsub">
               <span class="vlist-t vlist-t2">
                <span class="vlist-r">
                 <span class="vlist" style="height: 1.0448em;">
                  <span class="" style="top: -2.4542em; margin-left: 0em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mathnormal mtight">
                     t
                    </span>
                   </span>
                  </span>
                  <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                   <span class="pstrut" style="height: 2.7em;">
                   </span>
                   <span class="sizing reset-size6 size3 mtight">
                    <span class="mord mtight">
                     <span class="mopen mtight">
                      (
                     </span>
                     <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                      k
                     </span>
                     <span class="mclose mtight">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="vlist-s">
                  ​
                 </span>
                </span>
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.2458em;">
                  <span class="">
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         = 1)， it indicates that the observed signal at time
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            t 
           
          
         
           t
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.6151em;">
             </span>
             <span class="mord mathnormal">
              t
             </span>
            </span>
           </span>
          </span>
         </span>
        </em>
        <em>
         explicitly follows the trend and seasonal component.
        </em>
        <br/>
        <strong>
         可以对比来看的是，当异常值和残差值都等于1时，表明在时间
         <span class="katex--inline">
          <span class="katex">
           <span class="katex-mathml">
            t 
           
          
         
           t
           </span>
           <span class="katex-html">
            <span class="base">
             <span class="strut" style="height: 0.6151em;">
             </span>
             <span class="mord mathnormal">
              t
             </span>
            </span>
           </span>
          </span>
         </span>
         观察到的信号明确地遵循了趋势和季节成分。
        </strong>
       </p>
      </li>
      <li>
       <p>
        <em>
         Note that such important information might not be automatically inferred when additive decomposition methods are being used. This due to the fact that the values of residual components can differ from one dataset to another which requires manual effort in their detection.
        </em>
        <br/>
        <strong>
         当使用加法分解方法时，这样的重要信息可能不会被自动推断出来，这是因为残差分量的值可能因数据集而异，因此需要手动筛选出异常。
        </strong>
        （个人补充：加法分解一般只能直接通过幅度大小判定异常，但由于各个数据集的数据情况不同，无法直接通过对幅度加上阈值进行直接筛选）
       </p>
      </li>
      <li>
       <p>
        <em>
         A sample result of anomaly decomposition is shown in the left-most part of Figure 1, where the observed time series data is decomposed into tis seasonal, trend, anomalies, and residual
        </em>
        .
        <br/>
        <strong>
         异常分解的一个示例结果显示在图最左侧的部分，其中观察到的时间序列数据被分别分解为季节性、趋势、异常和残差分量。
        </strong>
        （还是开头内个图不放来他又说了一遍）
       </p>
      </li>
      <li>
       <p>
        <em>
         Each of these components holds essential information about the characteristics of the time and will be leveraged to train the forecast model.
        </em>
        <br/>
        <strong>
         这些成分中的每一个都包含了关于时间序列特征的重要信息，并将被我们使用来预测模型。
        </strong>
       </p>
      </li>
      <li>
       <p>
        <em>
         To this end, we concatenate the derived decomposed vector of time series with the input, which includes the observed time series and its labeled extreme event.
        </em>
        <br/>
        最终，我们将这些时间序列进行拼接作为一个输入模型的训练的特征样本，这个样本包含观测到的时间序列及标记的极端事件还有我们分解出的各个成分。
       </p>
      </li>
     </ul>
     <p>
      读完之后其实我是带着疑惑的，就是实际上
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         x 
         
         
         
           ( 
          
         
           k 
          
         
           ) 
          
         
        
       
         = 
        
        
        
          s 
         
         
         
           ( 
          
         
           k 
          
         
           ) 
          
         
        
       
         × 
        
        
        
          t 
         
         
         
           ( 
          
         
           k 
          
         
           ) 
          
         
        
       
         × 
        
        
        
          a 
         
         
         
           ( 
          
         
           k 
          
         
           ) 
          
         
        
       
         × 
        
        
        
          r 
         
         
         
           ( 
          
         
           k 
          
         
           ) 
          
         
        
       
      
        x^{(k)} = s^{(k)}×t^{(k)}×a^{(k)}×r^{(k)}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.888em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            x
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.888em;">
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mopen mtight">
                   (
                  </span>
                  <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                   k
                  </span>
                  <span class="mclose mtight">
                   )
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.9713em; vertical-align: -0.0833em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            s
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.888em;">
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mopen mtight">
                   (
                  </span>
                  <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                   k
                  </span>
                  <span class="mclose mtight">
                   )
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           ×
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.9713em; vertical-align: -0.0833em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            t
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.888em;">
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mopen mtight">
                   (
                  </span>
                  <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                   k
                  </span>
                  <span class="mclose mtight">
                   )
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           ×
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.9713em; vertical-align: -0.0833em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            a
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.888em;">
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mopen mtight">
                   (
                  </span>
                  <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                   k
                  </span>
                  <span class="mclose mtight">
                   )
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           ×
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.888em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0278em;">
            r
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.888em;">
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mopen mtight">
                   (
                  </span>
                  <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                   k
                  </span>
                  <span class="mclose mtight">
                   )
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      在这个乘法项的分解里
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         a 
         
         
         
           ( 
          
         
           k 
          
         
           ) 
          
         
        
       
      
        a^{(k)}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.888em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            a
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.888em;">
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mopen mtight">
                   (
                  </span>
                  <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                   k
                  </span>
                  <span class="mclose mtight">
                   )
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      这一项是怎么乘进去的其实是没有清晰给出的，如果不看代码我觉得但从这段的写作上来看，有故意隐藏核心细节的嫌疑。好在代码虽然没有注释但我也复现出来了。
     </p>
     <h2>
      <a id="font_colorblue2STAR__font_144">
      </a>
      <font color="blue">
       2.STAR 代码复现 手搓版
      </font>
     </h2>
     <hr/>
     <p>
      为了保证复现结果的可验证性，我这里用了一个阿里的开源功率数据集。
      <br/>
      <a href="https://tianchi.aliyun.com/dataset/159885" rel="nofollow">
       https://tianchi.aliyun.com/dataset/159885
      </a>
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/9ba24fda71c249fc95dde40e828e152d.png">
       <br/>
       下载之后数据如下一个非常标准的风电数据集，之后我们就分解和使用实际发电功率这一项。
      </img>
     </p>
     <p>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/0bb52c141df94d61bd905fa0f7822ff8.png"/>
     </p>
     <h3>
      <a id="font_colorC2B28021_font_155">
      </a>
      <font color="#C2B280">
       2.1 数据读取
      </font>
     </h3>
     <hr/>
     <p>
      <img alt="请添加图片描述" src="https://i-blog.csdnimg.cn/direct/f40817647e2d4f40ad865adc088df935.png"/>
     </p>
     <pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">"data.xlsx"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

power <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">"实际发电功率"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values

plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>power<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
     <h3>
      <a id="font_colorC2B28022_font_171">
      </a>
      <font color="#C2B280">
       2.2 提取趋势成分
      </font>
     </h3>
     <hr/>
     <p>
      <img alt="请添加图片描述" src="https://i-blog.csdnimg.cn/direct/5c94b82e10a54fd997acbef4e526ea00.png"/>
     </p>
     <pre><code class="prism language-python"><span class="token comment"># 导入必要的库</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd  <span class="token comment"># 数据处理库</span>
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt  <span class="token comment"># 绘图库</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np  <span class="token comment"># 数值计算库</span>
<span class="token keyword">from</span> statsmodels<span class="token punctuation">.</span>nonparametric<span class="token punctuation">.</span>smoothers_lowess <span class="token keyword">import</span> lowess  <span class="token comment"># 非参数平滑方法</span>

<span class="token comment"># 设置中文字体（以 Windows 的 SimHei 为例）</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span>  <span class="token comment"># 设置全局字体为黑体</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span>  <span class="token comment"># 解决负号显示问题</span>

<span class="token comment"># 读取Excel数据文件</span>
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">"data.xlsx"</span><span class="token punctuation">)</span>  <span class="token comment"># 从Excel文件加载数据</span>
power <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">"实际发电功率"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values  <span class="token comment"># 提取"实际发电功率"列的值转为numpy数组</span>
x <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>power<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 创建与功率数据长度相同的索引数组作为x轴</span>

<span class="token comment"># 使用LOWESS进行平滑处理（非参数局部回归）</span>
<span class="token comment"># frac: 平滑窗口比例（0.3表示使用30%的数据点进行局部拟合）</span>
<span class="token comment"># it: 执行3次稳健拟合迭代（消除异常值影响）</span>
smoothed <span class="token operator">=</span> lowess<span class="token punctuation">(</span>power<span class="token punctuation">,</span> x<span class="token punctuation">,</span> frac<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> it<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>

<span class="token comment"># 提取并处理平滑结果</span>
rt <span class="token operator">=</span> smoothed<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment"># 提取平滑后的趋势分量（第二列为拟合值）</span>
data_d_rt <span class="token operator">=</span> power <span class="token operator">/</span> rt  <span class="token comment"># 计算原始功率与趋势分量的比值（分解周期分量）</span>

<span class="token comment"># 创建绘图画布（宽20英寸，高4英寸）</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 绘制原始功率曲线</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>power<span class="token punctuation">,</span>
         label<span class="token operator">=</span><span class="token string">"功率"</span><span class="token punctuation">,</span>
         color<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">,</span>
         linestyle<span class="token operator">=</span><span class="token string">'-'</span><span class="token punctuation">,</span>  <span class="token comment"># 实线</span>
         linewidth<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment"># 线宽2磅</span>

<span class="token comment"># 绘制趋势分量曲线</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>rt<span class="token punctuation">,</span>
         label<span class="token operator">=</span><span class="token string">"趋势分量 $r^{(k)}$"</span><span class="token punctuation">,</span>  <span class="token comment"># LaTeX格式的数学符号</span>
         color<span class="token operator">=</span><span class="token string">'green'</span><span class="token punctuation">,</span>
         linestyle<span class="token operator">=</span><span class="token string">'--'</span><span class="token punctuation">,</span>  <span class="token comment"># 虚线</span>
         linewidth<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># 保存图形到文件</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">"2.获得趋势分量.png"</span><span class="token punctuation">,</span>
            bbox_inches<span class="token operator">=</span><span class="token string">"tight"</span><span class="token punctuation">)</span>  <span class="token comment"># 紧凑型边界框</span>

<span class="token comment"># 显示图形</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">"upper left"</span><span class="token punctuation">)</span>  <span class="token comment"># 在左上角显示图例</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># 添加网格线</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
     <h3>
      <a id="font_colorC2B28023_font_226">
      </a>
      <font color="#C2B280">
       2.3 提取季节成分
      </font>
     </h3>
     <hr/>
     <p>
      在季节分量这里，我们选择的周期的以天为周期，由于数据本身颗粒度为15分钟，
      <mark>
       所以就是96个一循环
      </mark>
      。
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/fe35231c3b904ffba29e0a3a59aaea22.png"/>
     </p>
     <pre><code class="prism language-python"><span class="token comment"># 导入所需库</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd  <span class="token comment"># 数据处理库</span>
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt  <span class="token comment"># 绘图库</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np  <span class="token comment"># 数值计算库</span>
<span class="token keyword">from</span> statsmodels<span class="token punctuation">.</span>nonparametric<span class="token punctuation">.</span>smoothers_lowess <span class="token keyword">import</span> lowess  <span class="token comment"># LOWESS平滑算法</span>

<span class="token comment"># 设置中文字体显示（针对Windows系统）</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span>  <span class="token comment"># 指定默认字体为黑体</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span>  <span class="token comment"># 解决负号显示异常问题</span>

<span class="token comment"># 数据读取与预处理</span>
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">"data.xlsx"</span><span class="token punctuation">)</span>  <span class="token comment"># 从Excel文件加载数据集</span>
power <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">"实际发电功率"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values  <span class="token comment"># 将功率列转换为numpy数组</span>
x <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>power<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 创建与数据长度相同的索引序列</span>

<span class="token comment"># LOWESS趋势提取</span>
smoothed <span class="token operator">=</span> lowess<span class="token punctuation">(</span>power<span class="token punctuation">,</span> x<span class="token punctuation">,</span> frac<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> it<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment"># 执行局部加权回归</span>
rt <span class="token operator">=</span> smoothed<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment"># 提取趋势分量（第二列为拟合值）</span>

<span class="token comment"># 去趋势处理</span>
data_d_rt <span class="token operator">=</span> power <span class="token operator">/</span> rt  <span class="token comment"># 通过除法去除趋势（适用于乘法分解模型）</span>

<span class="token comment"># 周期特征提取</span>
son_sequence <span class="token operator">=</span> data_d_rt<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">96</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 按日周期(15分钟间隔)重塑数据为96行</span>
sequence_len <span class="token operator">=</span> son_sequence<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment"># 获取每个周期的天数（列数）</span>

<span class="token comment"># 中位数计算（注意：此处实际使用均值计算，建议修改为np.median）</span>
column_medians <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>son_sequence<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 计算每个时间点的均值（应使用中位数）</span>
column_medians <span class="token operator">=</span> column_medians<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>newaxis<span class="token punctuation">]</span>  <span class="token comment"># 添加新轴便于矩阵运算</span>

<span class="token comment"># 季节分量重构</span>
st <span class="token operator">=</span> np<span class="token punctuation">.</span>tile<span class="token punctuation">(</span>column_medians<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> sequence_len<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 将均值延展为完整序列</span>
<span class="token comment"># 操作解析：</span>
<span class="token comment"># 1. np.tile进行矩阵复制 (1列→sequence_len列)</span>
<span class="token comment"># 2. .T转置矩阵适配后续操作</span>
<span class="token comment"># 3. reshape(-1)展平为一维季节分量</span>

<span class="token comment"># 可视化设置</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 创建20英寸宽、4英寸高的画布</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>st<span class="token punctuation">,</span>  <span class="token comment"># 绘制季节分量</span>
         label<span class="token operator">=</span><span class="token string">"中位数延展结果"</span><span class="token punctuation">,</span>  <span class="token comment"># 图例标签</span>
         color<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">,</span>  <span class="token comment"># 线条颜色</span>
         linewidth<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment"># 线宽设置</span>

<span class="token comment"># 图表美化</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"中位数延展结果可视化"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">)</span>  <span class="token comment"># 设置标题及字号</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"时间/索引"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>  <span class="token comment"># X轴标签设置</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"中位数延展值"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>  <span class="token comment"># Y轴标签设置（实际为均值）</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">'upper right'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>  <span class="token comment"># 右上角图例</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">,</span> linestyle<span class="token operator">=</span><span class="token string">'--'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.6</span><span class="token punctuation">)</span>  <span class="token comment"># 半透明虚线网格</span>
plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 自动调整元素间距</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 显示图形</span>
</code></pre>
     <h3>
      <a id="font_colorC2B28024_font_284">
      </a>
      <font color="#C2B280">
       2.4 提取残差成分
      </font>
     </h3>
     <hr/>
     <p>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/1d041d30bfda4f3cb5c235e8d6a14e9f.png"/>
     </p>
     <pre><code class="prism language-python"><span class="token comment"># 导入必要的库</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd  <span class="token comment"># 数据处理库</span>
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt  <span class="token comment"># 绘图库</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np  <span class="token comment"># 数值计算库</span>
<span class="token keyword">from</span> statsmodels<span class="token punctuation">.</span>nonparametric<span class="token punctuation">.</span>smoothers_lowess <span class="token keyword">import</span> lowess  <span class="token comment"># LOWESS平滑算法</span>

<span class="token comment"># 设置中文显示（适用于Windows系统）</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span>  <span class="token comment"># 指定默认字体为黑体</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span>  <span class="token comment"># 解决负号显示异常问题</span>

<span class="token comment"># 数据加载与预处理</span>
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">"data.xlsx"</span><span class="token punctuation">)</span>  <span class="token comment"># 从Excel文件加载数据集</span>
power <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">"实际发电功率"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values  <span class="token comment"># 提取功率列数据为numpy数组</span>
x <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>power<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 创建时间索引序列（0,1,2,...n）</span>

<span class="token comment"># 趋势分量提取（LOWESS平滑）</span>
smoothed <span class="token operator">=</span> lowess<span class="token punctuation">(</span>power<span class="token punctuation">,</span> x<span class="token punctuation">,</span> frac<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> it<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment"># 执行局部加权回归</span>
tk <span class="token operator">=</span> smoothed<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment"># 提取趋势分量（第二列为拟合值）</span>

<span class="token comment"># 去趋势处理（乘法分解模型）</span>
data_d_tk <span class="token operator">=</span> power <span class="token operator">/</span> tk  <span class="token comment"># 原始信号/趋势分量 = 季节分量 × 残差分量</span>

<span class="token comment"># 周期特征提取（假设每日96个15分钟间隔）</span>
son_sequence <span class="token operator">=</span> data_d_tk<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">96</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 重塑为(96,天数)矩阵</span>
sequence_len <span class="token operator">=</span> son_sequence<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment"># 获取周期天数（列数）</span>

<span class="token comment"># 季节分量计算（行中位数）</span>
column_means <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>son_sequence<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 计算每个时间点的平均值</span>
column_means <span class="token operator">=</span> column_means<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>newaxis<span class="token punctuation">]</span>  <span class="token comment"># 转换为列向量便于矩阵运算</span>

<span class="token comment"># 季节分量重构</span>
sk <span class="token operator">=</span> np<span class="token punctuation">.</span>tile<span class="token punctuation">(</span>column_means<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> sequence_len<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 延展中位数序列</span>
<span class="token comment"># 操作分解：</span>
<span class="token comment"># 1. np.tile复制列向量为(96,天数)矩阵</span>
<span class="token comment"># 2. .T转置为(天数,96)</span>
<span class="token comment"># 3. reshape(-1)展平为原始长度</span>

<span class="token comment"># 残差分量计算</span>
rk <span class="token operator">=</span> data_d_tk <span class="token operator">/</span> sk  <span class="token comment"># 残差 = 去趋势信号 / 季节分量</span>

<span class="token comment"># 可视化设置（创建4行1列的子图布局）</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 设置画布尺寸（宽20英寸，高10英寸）</span>

<span class="token comment"># ---------------------------</span>
<span class="token comment"># 子图1：原始功率信号</span>
<span class="token comment"># ---------------------------</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 定位到第1个子图</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> power<span class="token punctuation">,</span>
         label<span class="token operator">=</span><span class="token string">"原始功率信号"</span><span class="token punctuation">,</span>  <span class="token comment"># 图例标签</span>
         color<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">,</span>  <span class="token comment"># 信号颜色</span>
         linewidth<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment"># 线宽设置</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"原始功率信号"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>  <span class="token comment"># 子图标题</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"时间/索引"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>  <span class="token comment"># X轴标签</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"功率值"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>  <span class="token comment"># Y轴标签</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">'upper right'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment"># 图例位置与字号</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">,</span> linestyle<span class="token operator">=</span><span class="token string">'--'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.6</span><span class="token punctuation">)</span>  <span class="token comment"># 半透明虚线网格</span>

<span class="token comment"># ---------------------------</span>
<span class="token comment"># 子图2：趋势分量 (tk)</span>
<span class="token comment"># ---------------------------</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment"># 定位到第2个子图</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> tk<span class="token punctuation">,</span>
         label<span class="token operator">=</span><span class="token string">"趋势分量 (tk)"</span><span class="token punctuation">,</span>  <span class="token comment"># 分量名称</span>
         color<span class="token operator">=</span><span class="token string">'green'</span><span class="token punctuation">,</span>  <span class="token comment"># 趋势线颜色</span>
         linewidth<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"趋势分量 (tk)"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"时间/索引"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"趋势值"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">'upper right'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">,</span> linestyle<span class="token operator">=</span><span class="token string">'--'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.6</span><span class="token punctuation">)</span>

<span class="token comment"># ---------------------------</span>
<span class="token comment"># 子图3：季节分量 (sk)</span>
<span class="token comment"># ---------------------------</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment"># 定位到第3个子图</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> sk<span class="token punctuation">,</span>
         label<span class="token operator">=</span><span class="token string">"季节分量 (sk)"</span><span class="token punctuation">,</span>  <span class="token comment"># 周期特征</span>
         color<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">,</span>  <span class="token comment"># 季节线颜色</span>
         linewidth<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"季节分量 (sk)"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"时间/索引"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"季节值"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">'upper right'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">,</span> linestyle<span class="token operator">=</span><span class="token string">'--'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.6</span><span class="token punctuation">)</span>

<span class="token comment"># ---------------------------</span>
<span class="token comment"># 子图4：残差分量 (rk)</span>
<span class="token comment"># ---------------------------</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>  <span class="token comment"># 定位到第4个子图</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> rk<span class="token punctuation">,</span>
         label<span class="token operator">=</span><span class="token string">"残差分量 (rk)"</span><span class="token punctuation">,</span>  <span class="token comment"># 剩余波动</span>
         color<span class="token operator">=</span><span class="token string">'purple'</span><span class="token punctuation">,</span>  <span class="token comment"># 残差线颜色</span>
         linewidth<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"残差分量 (rk)"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"时间/索引"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"残差值"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">'upper right'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">,</span> linestyle<span class="token operator">=</span><span class="token string">'--'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.6</span><span class="token punctuation">)</span>

<span class="token comment"># 全局布局调整</span>
plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 自动调整子图间距</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 渲染显示图像</span>
</code></pre>
     <h3>
      <a id="font_colorC2B28025_font_393">
      </a>
      <font color="#C2B280">
       2.5 提取异常成分
      </font>
     </h3>
     <hr/>
     <p>
      这里要说一下的是，在原文中没有给出的残差成分和提取异常成分相乘的关系以及如何作用到原始信号上，在我阅读了他的代码之后，其实是通过赋1值实现的，也就是说异常成分就是残差成分中鲁棒因子大于等于阈值的点组成的，其他地方都是1，然后残差成分中的鲁棒因子小于阈值的点给变成了1，这样的话，经过这一步之后，得到的异常成分和残差成分相乘，其实就是上一步的残差成分，这部分关键逻辑在原文中被掩盖了。
     </p>
     <p>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/146cd7aa71324a7b99095edce221b57a.png"/>
     </p>
     <pre><code class="prism language-python"><span class="token comment"># 导入所需库</span>
<span class="token keyword">from</span> statistics <span class="token keyword">import</span> median  <span class="token comment"># 提供中位数计算函数</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd  <span class="token comment"># 数据处理库</span>
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt  <span class="token comment"># 绘图库</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np  <span class="token comment"># 数值计算库</span>
<span class="token keyword">from</span> statsmodels<span class="token punctuation">.</span>nonparametric<span class="token punctuation">.</span>smoothers_lowess <span class="token keyword">import</span> lowess  <span class="token comment"># LOWESS平滑算法</span>

<span class="token comment"># 设置中文显示（适用于Windows系统）</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span>  <span class="token comment"># 指定默认字体为黑体</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span>  <span class="token comment"># 解决负号显示问题</span>

<span class="token comment"># 数据加载与预处理</span>
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">"data.xlsx"</span><span class="token punctuation">)</span>  <span class="token comment"># 加载Excel数据集</span>
power <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">"实际发电功率"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values  <span class="token comment"># 提取功率数据为numpy数组</span>
x <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>power<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 创建时间索引序列（0,1,2,...n）</span>

<span class="token comment"># 趋势分量提取（LOWESS平滑）</span>
smoothed <span class="token operator">=</span> lowess<span class="token punctuation">(</span>power<span class="token punctuation">,</span> x<span class="token punctuation">,</span> frac<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> it<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment"># 执行局部加权回归</span>
tk <span class="token operator">=</span> smoothed<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment"># 提取趋势分量（第二列为拟合值）</span>

<span class="token comment"># 去趋势处理（乘法分解模型）</span>
data_d_tk <span class="token operator">=</span> power <span class="token operator">/</span> tk  <span class="token comment"># 原始信号/趋势分量 = 季节分量 × 残差分量</span>

<span class="token comment"># 周期特征提取（假设每日96个15分钟间隔）</span>
son_sequence <span class="token operator">=</span> data_d_tk<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">96</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 重塑为(96,天数)矩阵</span>
sequence_len <span class="token operator">=</span> son_sequence<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment"># 获取周期天数（列数）</span>

<span class="token comment"># 季节分量计算（注意此处实际使用均值，建议修改为np.median）</span>
column_medians <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>son_sequence<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 计算每个时间点的均值</span>
column_medians <span class="token operator">=</span> column_medians<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>newaxis<span class="token punctuation">]</span>  <span class="token comment"># 转换为列向量</span>

<span class="token comment"># 季节分量重构</span>
sk <span class="token operator">=</span> np<span class="token punctuation">.</span>tile<span class="token punctuation">(</span>column_medians<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> sequence_len<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 延展为完整序列</span>

<span class="token comment"># 残差分量计算</span>
rk <span class="token operator">=</span> data_d_tk <span class="token operator">/</span> sk  <span class="token comment"># 残差 = 去趋势信号 / 季节分量</span>

<span class="token comment"># 异常检测算法 --------------------------------------------------</span>
<span class="token comment"># 计算残差中位数</span>
rk_median <span class="token operator">=</span> np<span class="token punctuation">.</span>median<span class="token punctuation">(</span>rk<span class="token punctuation">)</span>  <span class="token comment"># 获取残差的中位数值</span>

<span class="token comment"># 计算绝对离差（Median Absolute Deviation, MAD）</span>
rou_abs <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">abs</span><span class="token punctuation">(</span>rk <span class="token operator">-</span> rk_median<span class="token punctuation">)</span>  <span class="token comment"># 每个残差与中位数的绝对距离</span>

<span class="token comment"># 计算标准化离差（类似Z-score标准化）</span>
rou_k <span class="token operator">=</span> rou_abs <span class="token operator">/</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>rou_abs<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>rou_abs<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 自定义标准化方法</span>

<span class="token comment"># 确定异常阈值（取95%分位数）</span>
sorted_data <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>rou_k<span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># 降序排列离差值</span>
rou_c <span class="token operator">=</span> sorted_data<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">0.05</span><span class="token operator">*</span><span class="token builtin">len</span><span class="token punctuation">(</span>sorted_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment"># 取前5%作为异常阈值</span>

<span class="token comment"># 生成异常指示向量</span>
ak <span class="token operator">=</span> rk<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 创建副本</span>
ak<span class="token punctuation">[</span>np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>rou_k <span class="token operator">&lt;</span> rou_c<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>  <span class="token comment"># 正常点标记为1</span>
rk<span class="token punctuation">[</span>np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>rou_k <span class="token operator">&gt;=</span> rou_c<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>  <span class="token comment"># 异常点残差设为1（需验证逻辑合理性）</span>

<span class="token comment"># 可视化设置 ---------------------------------------------------</span>
fig<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 创建5行子图布局</span>

<span class="token comment"># 子图1：原始功率数据</span>
axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>power<span class="token punctuation">,</span>
            label<span class="token operator">=</span><span class="token string">'原始功率数据'</span><span class="token punctuation">,</span>
            color<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">)</span>
axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">'原始功率数据'</span><span class="token punctuation">)</span>
axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># 子图2：趋势分量</span>
axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>tk<span class="token punctuation">,</span>
            label<span class="token operator">=</span><span class="token string">'趋势信息 (tk)'</span><span class="token punctuation">,</span>
            color<span class="token operator">=</span><span class="token string">'orange'</span><span class="token punctuation">)</span>
axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">'趋势成分'</span><span class="token punctuation">)</span>
axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># 子图3：季节分量</span>
axes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>sk<span class="token punctuation">,</span>
            label<span class="token operator">=</span><span class="token string">'季节信息分量 (sk)'</span><span class="token punctuation">,</span>
            color<span class="token operator">=</span><span class="token string">'green'</span><span class="token punctuation">)</span>
axes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">'季节成分'</span><span class="token punctuation">)</span>
axes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
axes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># 子图4：异常分量（需注意标记逻辑）</span>
axes<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>ak<span class="token punctuation">,</span>
            label<span class="token operator">=</span><span class="token string">'异常分量 (ak)'</span><span class="token punctuation">,</span>
            color<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">)</span>
axes<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">'异常成分'</span><span class="token punctuation">)</span>
axes<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
axes<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># 子图5：修正后的残差分量</span>
axes<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>rk<span class="token punctuation">,</span>
            label<span class="token operator">=</span><span class="token string">'残差分量 (rk)'</span><span class="token punctuation">,</span>
            color<span class="token operator">=</span><span class="token string">'purple'</span><span class="token punctuation">)</span>
axes<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">'残差成分'</span><span class="token punctuation">)</span>
axes<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
axes<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># 布局调整</span>
plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
     <h2>
      <a id="font_colorblue3_GitHub_font_506">
      </a>
      <font color="blue">
       3.项目 GitHub 地址
      </font>
     </h2>
     <hr/>
     <p>
      代码也顺手传上去了，如果懒得复制了就上去 GitHub 上直接去下一下吧。
      <br/>
      <a href="https://github.com/StChenHaoGitHub/STAR_Decomposition">
       https://github.com/StChenHaoGitHub/STAR_Decomposition
      </a>
     </p>
     <p>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/b33cacf8808548e08cfef6555032a6fa.png"/>
     </p>
     <h2>
      <a id="font_colorblue_4font_513">
      </a>
      <font color="blue">
       4.结束
      </font>
     </h2>
     <hr/>
     <p>
      这篇内容写的也是比较累的，确实难度也不小，而且实用性也存疑，但是我要是用不了给师弟拿去整个花活凑个不实用的创新点也是可以的。这个就先这样吧。
     </p>
    </img>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
  <div class="blog-extension-box" id="blogExtensionBox" style="width:400px;margin:auto;margin-top:12px">
  </div>
 </article>
 <p alt="6874747073:3a2f2f626c6f672e6373646e2e6e65742f6368726e68616f2f:61727469636c652f64657461696c732f313436323539383535" class_="artid" style="display:none">
 </p>
</div>


