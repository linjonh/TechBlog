---
layout: post
title: "Python实战进阶No24-PyAutoGUI-实现桌面自动化"
date: 2025-03-14 22:46:25 +0800
description: "PyAutoGUI 是一个跨平台的桌面自动化工具，能够模拟鼠标点击、键盘输入、屏幕截图与图像识别，适用于重复性桌面任务（如表单填写、游戏操作、批量文件处理）。本集通过代码+截图+输出日志的实战形式，带你掌握从基础操作到复杂任务的全流程自动化。"
keywords: "《Python实战进阶》No24: PyAutoGUI 实现桌面自动化"
categories: ['Python']
tags: ['自动化', '开发语言', 'Python']
artid: "146268759"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146268759
    alt: "Python实战进阶No24-PyAutoGUI-实现桌面自动化"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146268759
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146268759
cover: https://bing.ee123.net/img/rand?artid=146268759
image: https://bing.ee123.net/img/rand?artid=146268759
img: https://bing.ee123.net/img/rand?artid=146268759
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     《Python实战进阶》No24: PyAutoGUI 实现桌面自动化
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h4>
     <a id="No24_PyAutoGUI__0">
     </a>
     <strong>
      No24: PyAutoGUI 实现桌面自动化
     </strong>
    </h4>
    <hr/>
    <h5>
     <a id="_4">
     </a>
     <strong>
      摘要
     </strong>
    </h5>
    <p>
     PyAutoGUI 是一个跨平台的桌面自动化工具，能够模拟鼠标点击、键盘输入、屏幕截图与图像识别，适用于重复性桌面任务（如表单填写、游戏操作、批量文件处理）。本集通过
     <strong>
      代码+截图+输出日志
     </strong>
     的实战形式，带你掌握从基础操作到复杂任务的全流程自动化。
    </p>
    <hr/>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/fc74d458903e436ab6dbfb6f4f8f3560.png#pic_center"/>
    </p>
    <h4>
     <a id="_10">
     </a>
     <strong>
      核心概念与代码实战
     </strong>
    </h4>
    <h5>
     <a id="1__12">
     </a>
     1.
     <strong>
      基础操作：鼠标与键盘控制
     </strong>
    </h5>
    <p>
     <strong>
      安装命令
     </strong>
     ：
    </p>
    <pre><code class="prism language-bash">pip <span class="token function">install</span> pyautogui  
</code></pre>
    <p>
     <strong>
      鼠标控制
     </strong>
     ：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> pyautogui  
<span class="token keyword">import</span> time  

<span class="token comment"># 移动鼠标到坐标 (500, 300)  </span>
pyautogui<span class="token punctuation">.</span>moveTo<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> duration<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  

<span class="token comment"># 模拟点击（左键单击）  </span>
pyautogui<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>  

<span class="token comment"># 滚轮滚动（向上滚动 200 单位）  </span>
pyautogui<span class="token punctuation">.</span>scroll<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>  
</code></pre>
    <p>
     <strong>
      键盘输入
     </strong>
     ：
    </p>
    <pre><code class="prism language-python"><span class="token comment"># 输入文本  </span>
pyautogui<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"Hello, PyAutoGUI!"</span><span class="token punctuation">,</span> interval<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span>  

<span class="token comment"># 组合键操作（Ctrl+C）  </span>
pyautogui<span class="token punctuation">.</span>hotkey<span class="token punctuation">(</span><span class="token string">"ctrl"</span><span class="token punctuation">,</span> <span class="token string">"c"</span><span class="token punctuation">)</span>  
</code></pre>
    <p>
     <strong>
      效果验证
     </strong>
     ：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"当前鼠标位置：</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>pyautogui<span class="token punctuation">.</span>position<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  <span class="token comment"># 输出实时坐标  </span>
</code></pre>
    <hr/>
    <h5>
     <a id="2__47">
     </a>
     2.
     <strong>
      截屏与图像识别
     </strong>
    </h5>
    <p>
     <strong>
      场景
     </strong>
     ：通过屏幕上的图标定位并点击按钮。
    </p>
    <pre><code class="prism language-python"><span class="token comment"># 截取屏幕并保存  </span>
screenshot <span class="token operator">=</span> pyautogui<span class="token punctuation">.</span>screenshot<span class="token punctuation">(</span><span class="token punctuation">)</span>  
screenshot<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"screenshot.png"</span><span class="token punctuation">)</span>  

<span class="token comment"># 查找图标位置（需提前保存图标图片）  </span>
button_location <span class="token operator">=</span> pyautogui<span class="token punctuation">.</span>locateOnScreen<span class="token punctuation">(</span><span class="token string">"submit_button.png"</span><span class="token punctuation">)</span>  
<span class="token keyword">if</span> button_location<span class="token punctuation">:</span>  
    <span class="token comment"># 计算图标中心点并点击  </span>
    button_center <span class="token operator">=</span> pyautogui<span class="token punctuation">.</span>center<span class="token punctuation">(</span>button_location<span class="token punctuation">)</span>  
    pyautogui<span class="token punctuation">.</span>click<span class="token punctuation">(</span>button_center<span class="token punctuation">)</span>  
<span class="token keyword">else</span><span class="token punctuation">:</span>  
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"图标未找到！"</span><span class="token punctuation">)</span>  
</code></pre>
    <p>
     <strong>
      输出示例
     </strong>
     ：
    </p>
    <pre><code>图标位置：Box(left=200, top=150, width=50, height=30)  
</code></pre>
    <hr/>
    <h5>
     <a id="3__70">
     </a>
     3.
     <strong>
      脚本调试与异常处理
     </strong>
    </h5>
    <p>
     <strong>
      问题场景
     </strong>
     ：图像识别失败导致脚本崩溃。
     <br/>
     <strong>
      解决方案
     </strong>
     ：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">try</span><span class="token punctuation">:</span>  
    <span class="token comment"># 设置超时时间为 5 秒  </span>
    button_location <span class="token operator">=</span> pyautogui<span class="token punctuation">.</span>locateOnScreen<span class="token punctuation">(</span>  
        <span class="token string">"save_icon.png"</span><span class="token punctuation">,</span>  
        confidence<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span>  <span class="token comment"># 允许 80% 相似度  </span>
        grayscale<span class="token operator">=</span><span class="token boolean">True</span>   <span class="token comment"># 灰度匹配提升速度  </span>
    <span class="token punctuation">)</span>  
    <span class="token keyword">if</span> <span class="token keyword">not</span> button_location<span class="token punctuation">:</span>  
        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"图标匹配失败！"</span><span class="token punctuation">)</span>  
<span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>  
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"错误：</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  
    <span class="token comment"># 回退到手动输入坐标  </span>
    pyautogui<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span>  
</code></pre>
    <p>
     <strong>
      调试技巧
     </strong>
     ：
    </p>
    <ul>
     <li>
      使用
      <code>
       pyautogui.PAUSE = 1
      </code>
      控制操作间隔
     </li>
     <li>
      启用
      <code>
       pyautogui.FAILSAFE = True
      </code>
      （鼠标移至左上角强制停止脚本）
     </li>
    </ul>
    <hr/>
    <h4>
     <a id="_94">
     </a>
     <strong>
      实战案例
     </strong>
    </h4>
    <h5>
     <a id="_1_96">
     </a>
     案例 1：
     <strong>
      自动化填写表单
     </strong>
    </h5>
    <p>
     <strong>
      场景
     </strong>
     ：批量填写 Excel 表格中的数据到某个桌面应用。
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> pyautogui  
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd  

<span class="token comment"># 读取 Excel 数据  </span>
data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">"data.xlsx"</span><span class="token punctuation">)</span>  

<span class="token keyword">for</span> index<span class="token punctuation">,</span> row <span class="token keyword">in</span> data<span class="token punctuation">.</span>iterrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  
    <span class="token comment"># 定位输入框并填写  </span>
    pyautogui<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span>  <span class="token comment"># 姓名输入框  </span>
    pyautogui<span class="token punctuation">.</span>write<span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">"姓名"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  
    pyautogui<span class="token punctuation">.</span>press<span class="token punctuation">(</span><span class="token string">"tab"</span><span class="token punctuation">)</span>      <span class="token comment"># 跳转到年龄输入框  </span>
    pyautogui<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">"年龄"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
    <span class="token comment"># 提交表单  </span>
    pyautogui<span class="token punctuation">.</span>press<span class="token punctuation">(</span><span class="token string">"enter"</span><span class="token punctuation">)</span>  
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 等待页面刷新  </span>
</code></pre>
    <p>
     <strong>
      输出示例
     </strong>
     ：
    </p>
    <pre><code>已提交姓名：张三，年龄：25  
已提交姓名：李四，年龄：30  
</code></pre>
    <h5>
     <a id="_2_121">
     </a>
     案例 2：
     <strong>
      模拟游戏中的简单操作
     </strong>
    </h5>
    <p>
     <strong>
      场景
     </strong>
     ：自动玩“键盘反应速度”游戏。
    </p>
    <pre><code class="prism language-python"><span class="token comment"># 监听屏幕特定区域的变化  </span>
game_region <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>  

<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>  
    <span class="token comment"># 截取游戏区域  </span>
    region_screenshot <span class="token operator">=</span> pyautogui<span class="token punctuation">.</span>screenshot<span class="token punctuation">(</span>region<span class="token operator">=</span>game_region<span class="token punctuation">)</span>  
    <span class="token comment"># 检测红色方块出现  </span>
    <span class="token keyword">if</span> pyautogui<span class="token punctuation">.</span>pixelMatchesColor<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  
        pyautogui<span class="token punctuation">.</span>press<span class="token punctuation">(</span><span class="token string">"space"</span><span class="token punctuation">)</span>  <span class="token comment"># 按空格键得分  </span>
</code></pre>
    <h5>
     <a id="_3_136">
     </a>
     案例 3：
     <strong>
      批量重命名文件
     </strong>
    </h5>
    <p>
     <strong>
      场景
     </strong>
     ：将文件夹中的 100 张图片按规则重命名。
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> os  
<span class="token keyword">import</span> pyautogui  

<span class="token comment"># 打开文件资源管理器  </span>
os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"explorer.exe .\\images"</span><span class="token punctuation">)</span>  
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>  

<span class="token comment"># 依次重命名文件  </span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  
    pyautogui<span class="token punctuation">.</span>hotkey<span class="token punctuation">(</span><span class="token string">"ctrl"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span>    <span class="token comment"># 全选文件  </span>
    pyautogui<span class="token punctuation">.</span>press<span class="token punctuation">(</span><span class="token string">"f2"</span><span class="token punctuation">)</span>            <span class="token comment"># 重命名  </span>
    pyautogui<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"photo_</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>i<span class="token punctuation">:</span><span class="token format-spec">03d</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  <span class="token comment"># 格式化名称（photo_001）  </span>
    pyautogui<span class="token punctuation">.</span>press<span class="token punctuation">(</span><span class="token string">"enter"</span><span class="token punctuation">)</span>  
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>  
</code></pre>
    <hr/>
    <h4>
     <a id="_157">
     </a>
     <strong>
      扩展思考
     </strong>
    </h4>
    <h5>
     <a id="1_PyAutoGUI__159">
     </a>
     1.
     <strong>
      PyAutoGUI 与其他工具的结合
     </strong>
    </h5>
    <ul>
     <li>
      <strong>
       与 Selenium 结合
      </strong>
      ：
      <pre><code class="prism language-python"><span class="token comment"># 用 Selenium 处理网页，PyAutoGUI 处理下载弹窗  </span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://example.com/download"</span><span class="token punctuation">)</span>  
pyautogui<span class="token punctuation">.</span>press<span class="token punctuation">(</span><span class="token string">"enter"</span><span class="token punctuation">)</span>  <span class="token comment"># 自动确认下载对话框  </span>
</code></pre>
     </li>
     <li>
      <strong>
       打包为可执行文件
      </strong>
      ：
      <pre><code class="prism language-bash">pip <span class="token function">install</span> pyinstaller  
pyinstaller <span class="token parameter variable">--onefile</span> your_script.py  
</code></pre>
     </li>
    </ul>
    <h5>
     <a id="2__172">
     </a>
     2.
     <strong>
      安全性和法律合规性
     </strong>
    </h5>
    <ul>
     <li>
      <strong>
       风险提示
      </strong>
      ：
      <ul>
       <li>
        避免自动化操作金融交易、社交账号等敏感场景
       </li>
       <li>
        部分软件（如游戏）可能禁止自动化脚本
       </li>
      </ul>
     </li>
     <li>
      <strong>
       合规建议
      </strong>
      ：
      <ul>
       <li>
        仅用于个人效率提升或授权场景
       </li>
       <li>
        遵守《计算机软件保护条例》和平台规则
       </li>
      </ul>
     </li>
    </ul>
    <hr/>
    <h4>
     <a id="_182">
     </a>
     <strong>
      总结
     </strong>
    </h4>
    <p>
     通过本实战，你已掌握：
    </p>
    <ol>
     <li>
      PyAutoGUI 的核心操作（鼠标、键盘、图像识别）
     </li>
     <li>
      复杂任务的异常处理与调试技巧
     </li>
     <li>
      从表单填写到游戏模拟的完整案例
     </li>
     <li>
      自动化脚本的法律边界与安全实践
     </li>
    </ol>
    <p>
     <strong>
      下集预告
     </strong>
     ：
     <br/>
     《No25: Python 并发编程：从多线程到异步 IO》将带你突破单线程性能瓶颈，实现高并发任务处理！
    </p>
    <hr/>
    <p>
     <strong>
      附：运行环境
     </strong>
    </p>
    <ul>
     <li>
      环境要求：Python 3.7+、Windows/macOS/Linux
     </li>
    </ul>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="6874747073:3a2f2f626c6f672e6373646e2e6e65742f7977656e6731382f:61727469636c652f64657461696c732f313436323638373539" class_="artid" style="display:none">
 </p>
</div>


