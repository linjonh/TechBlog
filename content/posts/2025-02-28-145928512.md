---
layout: post
title: "DeepSeek如何快速开发PDF转Word软件"
date: 2025-02-28 15:10:46 +0800
description: "🛡️ 本地化优势：处理敏感文档的首选方案⚡ 效率提升：批量处理100份PDF仅需3分钟（测试环境：i5-1135G7）🤖AI协作：DeepSeek使开发效率提升300%"
keywords: "DeepSeek如何快速开发PDF转Word软件"
categories: ['Python', 'Ai']
tags: ['Python', 'Ai']
artid: "145928512"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=145928512
    alt: "DeepSeek如何快速开发PDF转Word软件"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=145928512
featuredImagePreview: https://bing.ee123.net/img/rand?artid=145928512
cover: https://bing.ee123.net/img/rand?artid=145928512
image: https://bing.ee123.net/img/rand?artid=145928512
img: https://bing.ee123.net/img/rand?artid=145928512
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     DeepSeek如何快速开发PDF转Word软件
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="_1">
     </a>
     一、引言
    </h2>
    <p>
     如今，在线工具的普及让PDF转Word成为了一个常见需求，常见的PDF转Word工具有收费的WPS，免费的有PDFGear，以及在线工具SmallPDF、iLovePDF、24PDF等。然而，大多数免费在线转换工具存在严重隐私风险——文件需上传至云端处理，容易泄露敏感信息。
     <br/>
     许多平台如WPS、迅捷PDF等要求付费才能使用高效服务，导致用户无法快捷使用转换服务。为解决这些问题，我决定用Python开发一款本地化的
     <strong>
      PDF批量转Word软件
     </strong>
     ，具有以下优势：
    </p>
    <ul>
     <li>
      100%离线处理保障隐私安全
     </li>
     <li>
      完全免费且支持个性化服务
     </li>
     <li>
      帮助巩固Python编程知识
     </li>
     <li>
      深度运用DeepSeek模型提升开发能力
     </li>
    </ul>
    <h2>
     <a id="_9">
     </a>
     二、软件主要功能
    </h2>
    <h3>
     <a id="1__10">
     </a>
     1. 核心特性
    </h3>
    <ul>
     <li>
      ✅
      <strong>
       100%离线转换
      </strong>
      ：杜绝信息泄露风险
     </li>
     <li>
      🚀
      <strong>
       批量处理
      </strong>
      ：支持扫描子文件夹（可选）
     </li>
     <li>
      📁
      <strong>
       路径管理
      </strong>
      ：兼容中英文自定义路径
     </li>
     <li>
      📊
      <strong>
       双进度显示
      </strong>
      ：文件转换进度+页面解析进度
     </li>
     <li>
      🔍
      <strong>
       智能交互
      </strong>
      ：完成后自动打开目标文件夹
     </li>
    </ul>
    <h3>
     <a id="2__17">
     </a>
     2. 技术亮点
    </h3>
    <ul>
     <li>
      多线程处理防止界面卡顿
     </li>
     <li>
      异常捕获机制增强稳定性
     </li>
     <li>
      自适应路径创建功能
     </li>
     <li>
      队列通信实时更新进度
     </li>
    </ul>
    <h2>
     <a id="_23">
     </a>
     三、设计过程
    </h2>
    <h3>
     <a id="1__24">
     </a>
     1. 技术架构
    </h3>
    <div class="mermaid">
     <svg class="mermaid-svg" height="254" id="mermaid-svg-Wt5geV68OwIxKP17" viewbox="0 0 464 254" width="464" xmlns="http://www.w3.org/2000/svg">
      <style>
       #mermaid-svg-Wt5geV68OwIxKP17 {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-svg-Wt5geV68OwIxKP17 .error-icon{fill:#552222;}#mermaid-svg-Wt5geV68OwIxKP17 .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-Wt5geV68OwIxKP17 .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-Wt5geV68OwIxKP17 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-Wt5geV68OwIxKP17 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-Wt5geV68OwIxKP17 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-Wt5geV68OwIxKP17 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-Wt5geV68OwIxKP17 .marker{fill:#333333;stroke:#333333;}#mermaid-svg-Wt5geV68OwIxKP17 .marker.cross{stroke:#333333;}#mermaid-svg-Wt5geV68OwIxKP17 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-Wt5geV68OwIxKP17 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-svg-Wt5geV68OwIxKP17 .cluster-label text{fill:#333;}#mermaid-svg-Wt5geV68OwIxKP17 .cluster-label span{color:#333;}#mermaid-svg-Wt5geV68OwIxKP17 .label text,#mermaid-svg-Wt5geV68OwIxKP17 span{fill:#333;color:#333;}#mermaid-svg-Wt5geV68OwIxKP17 .node rect,#mermaid-svg-Wt5geV68OwIxKP17 .node circle,#mermaid-svg-Wt5geV68OwIxKP17 .node ellipse,#mermaid-svg-Wt5geV68OwIxKP17 .node polygon,#mermaid-svg-Wt5geV68OwIxKP17 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg-Wt5geV68OwIxKP17 .node .label{text-align:center;}#mermaid-svg-Wt5geV68OwIxKP17 .node.clickable{cursor:pointer;}#mermaid-svg-Wt5geV68OwIxKP17 .arrowheadPath{fill:#333333;}#mermaid-svg-Wt5geV68OwIxKP17 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-svg-Wt5geV68OwIxKP17 .flowchart-link{stroke:#333333;fill:none;}#mermaid-svg-Wt5geV68OwIxKP17 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-svg-Wt5geV68OwIxKP17 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-svg-Wt5geV68OwIxKP17 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-svg-Wt5geV68OwIxKP17 .cluster text{fill:#333;}#mermaid-svg-Wt5geV68OwIxKP17 .cluster span{color:#333;}#mermaid-svg-Wt5geV68OwIxKP17 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-Wt5geV68OwIxKP17 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}
      </style>
      <g>
       <g class="output">
        <g class="clusters">
        </g>
        <g class="edgePaths">
         <g class="edgePath LS-A LE-B" id="L-A-B" style="opacity: 1;">
          <path class="path" d="M180.7874984741211,45.80843417615775L161.65624872843424,51.340361813464796C142.5249989827474,56.87228945077184,104.2624994913737,67.93614472538592,85.13124974568684,77.63473902935962C66,87.33333333333333,66,95.66666666666667,66,99.83333333333333L66,104" marker-end="url(#arrowhead53)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead53" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-A LE-C" id="L-A-C" style="opacity: 1;">
          <path class="path" d="M232,54L232,58.166666666666664C232,62.333333333333336,232,70.66666666666667,232,79C232,87.33333333333333,232,95.66666666666667,232,99.83333333333333L232,104" marker-end="url(#arrowhead54)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead54" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-C LE-D" id="L-C-D" style="opacity: 1;">
          <path class="path" d="M232,150L232,154.16666666666666C232,158.33333333333334,232,166.66666666666666,232,175C232,183.33333333333334,232,191.66666666666666,232,195.83333333333334L232,200" marker-end="url(#arrowhead55)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead55" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-A LE-E" id="L-A-E" style="opacity: 1;">
          <path class="path" d="M283.2125015258789,45.80843417615775L302.34375127156574,51.340361813464796C321.4750010172526,56.87228945077184,359.7375005086263,67.93614472538592,378.86875025431317,77.63473902935962C398,87.33333333333333,398,95.66666666666667,398,99.83333333333333L398,104" marker-end="url(#arrowhead56)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead56" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-E LE-F" id="L-E-F" style="opacity: 1;">
          <path class="path" d="M398,150L398,154.16666666666666C398,158.33333333333334,398,166.66666666666666,398,175C398,183.33333333333334,398,191.66666666666666,398,195.83333333333334L398,200" marker-end="url(#arrowhead57)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead57" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
        </g>
        <g class="edgeLabels">
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-A' L-LE-B" id="L-L-A-B">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-A' L-LE-C" id="L-L-A-C">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-C' L-LE-D" id="L-L-C-D">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-A' L-LE-E" id="L-L-A-E">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="">
          <g class="label" transform="translate(0,0)">
           <rect height="0" rx="0" ry="0" width="0">
           </rect>
           <foreignobject height="0" width="0">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-E' L-LE-F" id="L-L-E-F">
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
        </g>
        <g class="nodes">
         <g class="node default" id="flowchart-A-50" style="opacity: 1;" transform="translate(232,31)">
          <rect class="label-container" height="46" rx="0" ry="0" width="102.42500305175781" x="-51.212501525878906" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-41.212501525878906,-13)">
            <foreignobject height="26" width="82.42500305175781">
             <div style="display: inline-block; white-space: nowrap;">
              Tkinter GUI
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-B-51" style="opacity: 1;" transform="translate(66,127)">
          <rect class="label-container" height="46" rx="0" ry="0" width="116" x="-58" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-48,-13)">
            <foreignobject height="26" width="96">
             <div style="display: inline-block; white-space: nowrap;">
              文件扫描模块
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-C-53" style="opacity: 1;" transform="translate(232,127)">
          <rect class="label-container" height="46" rx="0" ry="0" width="116" x="-58" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-48,-13)">
            <foreignobject height="26" width="96">
             <div style="display: inline-block; white-space: nowrap;">
              转换核心引擎
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-D-55" style="opacity: 1;" transform="translate(232,223)">
          <rect class="label-container" height="46" rx="0" ry="0" width="101.57500457763672" x="-50.78750228881836" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-40.78750228881836,-13)">
            <foreignobject height="26" width="81.57500457763672">
             <div style="display: inline-block; white-space: nowrap;">
              pdf2docx库
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-E-57" style="opacity: 1;" transform="translate(398,127)">
          <rect class="label-container" height="46" rx="0" ry="0" width="116" x="-58" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-48,-13)">
            <foreignobject height="26" width="96">
             <div style="display: inline-block; white-space: nowrap;">
              多线程管理器
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-F-59" style="opacity: 1;" transform="translate(398,223)">
          <rect class="label-container" height="46" rx="0" ry="0" width="116" x="-58" y="-23">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-48,-13)">
            <foreignobject height="26" width="96">
             <div style="display: inline-block; white-space: nowrap;">
              进度更新队列
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
        </g>
       </g>
      </g>
     </svg>
    </div>
    <p>
     2、设计过程
     <br/>
     <strong>
      用户界面
     </strong>
     ：界面设计以简洁易用为主。通过tkinter的标签、文本框、按钮等控件，我实现了文件夹选择、设置选项、进度条显示等功能。
    </p>
    <p>
     **PDF转Word功能：**因为有现成的pdf2docx的库，我采用了这个轮来进行PDF到Word格式的转换，再加上Python的批量处理功能，要以轻松满足我的文件转换需求。
    </p>
    <p>
     **多线程与进度更新：**为避免界面卡顿，我使用了threading库来将文件转换操作放入独立线程，并利用queue进行线程间通信，实时更新进度条显示。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/c816a3816c98431a89fa0024a3c63ba3.png"/>
    </p>
    <p>
     我们在设计时，借助了DeepSeek R1的深度思考模型。
     <br/>
     为了减少错误，我们在提示词加入了让deepseek进行自我运行代码，进行调试的功能，减少用户本地测试中产生的bug。先上传软件图片，然后给出指令：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/e229bf0b0ee6427fb8795649de4dbb7b.png"/>
    </p>
    <p>
     在其回复中，我们看到它针对我的提问题也进行了回答，尤其是在指定的Python环境下进行了测试。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/10ba7a813eed4b799071553f50016d15.png">
      <br/>
      DeepSeek自主调试功能
     </img>
    </p>
    <p>
     经过测试，代码运行无误，但是缺少进度条功能，可能是没有识别出来，或者漏掉了，于是通过追加提问：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/ca58c84d1eb441cf948f7cfc347384cb.png">
      <br/>
      这里我故意打错了一个汉字，但是DeepSeek还能正确地进行理解，同时很好地解决了进度条缺失的问题。就这样，我们通过两步，不到1分钟就可以把这个一个pdf转word工具制作出来。
     </img>
    </p>
    <p>
     在开发过程中，我为DeepSeek提供了完整的开发环境，DeepSeek通过对项目需求的分析，建议我添加更多的异常处理机制，特别是在文件路径不正确或者文件损坏的情况下的处理。最终，这些改进使得程序的稳定性和用户体验都得到了显著提升。
    </p>
    <p>
     经过多次的调试和优化，软件终于成型，并可以稳定运行。用户只需选择文件夹并点击转换按钮，程序就会自动处理所有PDF文件，最终输出为Word格式。每一步的转换进度都会实时更新，确保用户能够清晰地了解当前状态。
    </p>
    <h2>
     <a id="_59">
     </a>
     四、代码实现
    </h2>
    <h3>
     <a id="1__60">
     </a>
     1. 完整代码
    </h3>
    <pre><code class="prism language-python"><span class="token keyword">import</span> os
<span class="token keyword">import</span> tkinter <span class="token keyword">as</span> tk
<span class="token keyword">from</span> tkinter <span class="token keyword">import</span> ttk<span class="token punctuation">,</span>filedialog<span class="token punctuation">,</span> messagebox
<span class="token keyword">from</span> pdf2docx <span class="token keyword">import</span> Converter
<span class="token keyword">import</span> threading
<span class="token keyword">import</span> queue
 
<span class="token keyword">class</span> <span class="token class-name">PDFToWordConverter</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> master<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>master <span class="token operator">=</span> master
        master<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"PDF批量转Word"</span><span class="token punctuation">)</span>
        master<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">"610x295"</span><span class="token punctuation">)</span>
 
        <span class="token comment"># 输入文件夹</span>
        self<span class="token punctuation">.</span>lbl_input <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>master<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"输入文件夹："</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>ent_input <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>master<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>btn_input <span class="token operator">=</span> tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>master<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"选择"</span><span class="token punctuation">,</span> command<span class="token operator">=</span>self<span class="token punctuation">.</span>select_input<span class="token punctuation">)</span>
 
        <span class="token comment"># 输出文件夹</span>
        self<span class="token punctuation">.</span>lbl_output <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>master<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"输出文件夹："</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>ent_output <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>master<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>btn_output <span class="token operator">=</span> tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>master<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"选择"</span><span class="token punctuation">,</span> command<span class="token operator">=</span>self<span class="token punctuation">.</span>select_output<span class="token punctuation">)</span>
 
        <span class="token comment"># 复选框</span>
        self<span class="token punctuation">.</span>var_subdir <span class="token operator">=</span> tk<span class="token punctuation">.</span>BooleanVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>var_open <span class="token operator">=</span> tk<span class="token punctuation">.</span>BooleanVar<span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>chk_subdir <span class="token operator">=</span> tk<span class="token punctuation">.</span>Checkbutton<span class="token punctuation">(</span>master<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"包含子文件夹"</span><span class="token punctuation">,</span> variable<span class="token operator">=</span>self<span class="token punctuation">.</span>var_subdir<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>chk_open <span class="token operator">=</span> tk<span class="token punctuation">.</span>Checkbutton<span class="token punctuation">(</span>master<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"转换完成后打开目标文件夹"</span><span class="token punctuation">,</span> variable<span class="token operator">=</span>self<span class="token punctuation">.</span>var_open<span class="token punctuation">)</span>
 
        <span class="token comment"># 转换按钮</span>
        self<span class="token punctuation">.</span>btn_convert <span class="token operator">=</span> tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>master<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"开始转换"</span><span class="token punctuation">,</span> command<span class="token operator">=</span>self<span class="token punctuation">.</span>start_conversion<span class="token punctuation">)</span>
 
        <span class="token comment"># 布局</span>
        self<span class="token punctuation">.</span>lbl_input<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> padx<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> sticky<span class="token operator">=</span>tk<span class="token punctuation">.</span>W<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>ent_input<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> padx<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> sticky<span class="token operator">=</span>tk<span class="token punctuation">.</span>EW<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>btn_input<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> padx<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
 
        self<span class="token punctuation">.</span>lbl_output<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> padx<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> sticky<span class="token operator">=</span>tk<span class="token punctuation">.</span>W<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>ent_output<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> padx<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> sticky<span class="token operator">=</span>tk<span class="token punctuation">.</span>EW<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>btn_output<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> padx<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
 
        self<span class="token punctuation">.</span>chk_subdir<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> padx<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> sticky<span class="token operator">=</span>tk<span class="token punctuation">.</span>W<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>chk_open<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> padx<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> sticky<span class="token operator">=</span>tk<span class="token punctuation">.</span>W<span class="token punctuation">)</span>
 
        self<span class="token punctuation">.</span>btn_convert<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
 
 
        <span class="token comment"># 新增进度组件</span>
        self<span class="token punctuation">.</span>progress_label <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>master<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"准备就绪"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>progress_bar <span class="token operator">=</span> ttk<span class="token punctuation">.</span>Progressbar<span class="token punctuation">(</span>master<span class="token punctuation">,</span> orient<span class="token operator">=</span>tk<span class="token punctuation">.</span>HORIZONTAL<span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">'determinate'</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 调整布局（新增两行）</span>
        self<span class="token punctuation">.</span>progress_label<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> columnspan<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> padx<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> sticky<span class="token operator">=</span>tk<span class="token punctuation">.</span>W<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>progress_bar<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> columnspan<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> padx<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> sticky<span class="token operator">=</span>tk<span class="token punctuation">.</span>EW<span class="token punctuation">)</span>
 
        <span class="token comment"># 消息队列用于线程通信</span>
        self<span class="token punctuation">.</span>queue <span class="token operator">=</span> queue<span class="token punctuation">.</span>Queue<span class="token punctuation">(</span><span class="token punctuation">)</span>
        master<span class="token punctuation">.</span>after<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>process_queue<span class="token punctuation">)</span>
        
        <span class="token comment"># 配置列权重</span>
        master<span class="token punctuation">.</span>columnconfigure<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> weight<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
 
    <span class="token keyword">def</span> <span class="token function">select_input</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        path <span class="token operator">=</span> filedialog<span class="token punctuation">.</span>askdirectory<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> path<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>ent_input<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> tk<span class="token punctuation">.</span>END<span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>ent_input<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> path<span class="token punctuation">)</span>
 
    <span class="token keyword">def</span> <span class="token function">select_output</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        path <span class="token operator">=</span> filedialog<span class="token punctuation">.</span>askdirectory<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> path<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>ent_output<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> tk<span class="token punctuation">.</span>END<span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>ent_output<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> path<span class="token punctuation">)</span>
 
    <span class="token keyword">def</span> <span class="token function">start_conversion</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 重置进度条</span>
        self<span class="token punctuation">.</span>progress_bar<span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
        self<span class="token punctuation">.</span>progress_label<span class="token punctuation">.</span>config<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">"正在扫描PDF文件..."</span><span class="token punctuation">)</span>
        
        input_dir <span class="token operator">=</span> self<span class="token punctuation">.</span>ent_input<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
        output_dir <span class="token operator">=</span> self<span class="token punctuation">.</span>ent_output<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
        <span class="token keyword">if</span> <span class="token keyword">not</span> input_dir <span class="token keyword">or</span> <span class="token keyword">not</span> output_dir<span class="token punctuation">:</span>
            messagebox<span class="token punctuation">.</span>showerror<span class="token punctuation">(</span><span class="token string">"错误"</span><span class="token punctuation">,</span> <span class="token string">"请先选择输入和输出文件夹！"</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>
         <span class="token comment"># 禁用转换按钮</span>
        self<span class="token punctuation">.</span>btn_convert<span class="token punctuation">.</span>config<span class="token punctuation">(</span>state<span class="token operator">=</span>tk<span class="token punctuation">.</span>DISABLED<span class="token punctuation">)</span>
        
        threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>self<span class="token punctuation">.</span>convert_files<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>input_dir<span class="token punctuation">,</span> output_dir<span class="token punctuation">)</span><span class="token punctuation">,</span> daemon<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">get_pdf_list</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
        pdf_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> root<span class="token punctuation">,</span> dirs<span class="token punctuation">,</span> files <span class="token keyword">in</span> os<span class="token punctuation">.</span>walk<span class="token punctuation">(</span>input_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>var_subdir<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">and</span> root <span class="token operator">!=</span> input_dir<span class="token punctuation">:</span>
                <span class="token keyword">continue</span>
            <span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> files<span class="token punctuation">:</span>
                <span class="token keyword">if</span> <span class="token builtin">file</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">'.pdf'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    pdf_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>root<span class="token punctuation">,</span> <span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> pdf_list
    
    <span class="token keyword">def</span> <span class="token function">convert_files</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_dir<span class="token punctuation">,</span> output_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>pdf_files <span class="token operator">=</span> self<span class="token punctuation">.</span>get_pdf_list<span class="token punctuation">(</span>input_dir<span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            total_files <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>pdf_files<span class="token punctuation">)</span>
            <span class="token keyword">for</span> index<span class="token punctuation">,</span> pdf_path <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>pdf_files<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token comment"># 更新当前文件进度</span>
                self<span class="token punctuation">.</span>queue<span class="token punctuation">.</span>put<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"file_progress"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>index<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> total_files<span class="token punctuation">,</span> pdf_path<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                
                <span class="token comment"># 构建输出路径</span>
                relative_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>relpath<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>pdf_path<span class="token punctuation">)</span><span class="token punctuation">,</span> input_dir<span class="token punctuation">)</span> <span class="token keyword">if</span> self<span class="token punctuation">.</span>var_subdir<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">""</span>
                output_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>output_dir<span class="token punctuation">,</span> relative_path<span class="token punctuation">)</span>
                os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span>output_path<span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
                
                <span class="token comment"># 转换文件</span>
                docx_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>output_path<span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>splitext<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>basename<span class="token punctuation">(</span>pdf_path<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">.docx"</span></span><span class="token punctuation">)</span>
                cv <span class="token operator">=</span> Converter<span class="token punctuation">(</span>pdf_path<span class="token punctuation">)</span>
                cv<span class="token punctuation">.</span>convert<span class="token punctuation">(</span>docx_path<span class="token punctuation">,</span> progress_callback<span class="token operator">=</span>self<span class="token punctuation">.</span>update_page_progress<span class="token punctuation">)</span>
                cv<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
            self<span class="token punctuation">.</span>queue<span class="token punctuation">.</span>put<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"complete"</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>queue<span class="token punctuation">.</span>put<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">update_page_progress</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> current<span class="token punctuation">,</span> total<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 页面级别进度（每文件0-100%）</span>
        progress <span class="token operator">=</span> <span class="token punctuation">(</span>current <span class="token operator">/</span> total<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token keyword">if</span> total <span class="token operator">!=</span> <span class="token number">0</span> <span class="token keyword">else</span> <span class="token number">0</span>
        self<span class="token punctuation">.</span>queue<span class="token punctuation">.</span>put<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"page_progress"</span><span class="token punctuation">,</span> progress<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
    <span class="token keyword">def</span> <span class="token function">process_queue</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
                msg_type<span class="token punctuation">,</span> data <span class="token operator">=</span> self<span class="token punctuation">.</span>queue<span class="token punctuation">.</span>get_nowait<span class="token punctuation">(</span><span class="token punctuation">)</span>
                
                <span class="token keyword">if</span> msg_type <span class="token operator">==</span> <span class="token string">"file_progress"</span><span class="token punctuation">:</span>
                    current<span class="token punctuation">,</span> total<span class="token punctuation">,</span> path <span class="token operator">=</span> data
                    file_progress <span class="token operator">=</span> <span class="token punctuation">(</span>current <span class="token operator">/</span> total<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span>
                    self<span class="token punctuation">.</span>progress_bar<span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span> <span class="token operator">=</span> file_progress
                    self<span class="token punctuation">.</span>progress_label<span class="token punctuation">.</span>config<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"正在转换 </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>current<span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>total<span class="token punctuation">}</span></span><span class="token string">：</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>basename<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                
                <span class="token keyword">elif</span> msg_type <span class="token operator">==</span> <span class="token string">"page_progress"</span><span class="token punctuation">:</span>
                    <span class="token comment"># 综合进度 = 文件进度 + 页面进度/总文件数</span>
                    current_file_progress <span class="token operator">=</span> self<span class="token punctuation">.</span>progress_bar<span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span>
                    page_progress <span class="token operator">=</span> data <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>pdf_files<span class="token punctuation">)</span>
                    self<span class="token punctuation">.</span>progress_bar<span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span> <span class="token operator">=</span> current_file_progress <span class="token operator">+</span> page_progress
                
                <span class="token keyword">elif</span> msg_type <span class="token operator">==</span> <span class="token string">"complete"</span><span class="token punctuation">:</span>
                    messagebox<span class="token punctuation">.</span>showinfo<span class="token punctuation">(</span><span class="token string">"完成"</span><span class="token punctuation">,</span> <span class="token string">"转换完成！"</span><span class="token punctuation">)</span>
                    <span class="token keyword">if</span> self<span class="token punctuation">.</span>var_open<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                        os<span class="token punctuation">.</span>startfile<span class="token punctuation">(</span>self<span class="token punctuation">.</span>ent_output<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    self<span class="token punctuation">.</span>btn_convert<span class="token punctuation">.</span>config<span class="token punctuation">(</span>state<span class="token operator">=</span>tk<span class="token punctuation">.</span>NORMAL<span class="token punctuation">)</span>
                    self<span class="token punctuation">.</span>progress_label<span class="token punctuation">.</span>config<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">"转换完成"</span><span class="token punctuation">)</span>
                
                <span class="token keyword">elif</span> msg_type <span class="token operator">==</span> <span class="token string">"error"</span><span class="token punctuation">:</span>
                    messagebox<span class="token punctuation">.</span>showerror<span class="token punctuation">(</span><span class="token string">"错误"</span><span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f"转换出错：</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>data<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                    self<span class="token punctuation">.</span>btn_convert<span class="token punctuation">.</span>config<span class="token punctuation">(</span>state<span class="token operator">=</span>tk<span class="token punctuation">.</span>NORMAL<span class="token punctuation">)</span>
                    self<span class="token punctuation">.</span>progress_label<span class="token punctuation">.</span>config<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">"转换出错"</span><span class="token punctuation">)</span>
 
        <span class="token keyword">except</span> queue<span class="token punctuation">.</span>Empty<span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
        <span class="token keyword">finally</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>master<span class="token punctuation">.</span>after<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>process_queue<span class="token punctuation">)</span>
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    root <span class="token operator">=</span> tk<span class="token punctuation">.</span>Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>
    app <span class="token operator">=</span> PDFToWordConverter<span class="token punctuation">(</span>root<span class="token punctuation">)</span>
    root<span class="token punctuation">.</span>mainloop<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <h2>
     <a id="_228">
     </a>
     五、经验总结
    </h2>
    <h3>
     <a id="1__229">
     </a>
     1. 核心收获
    </h3>
    <ul>
     <li>
      🛡️ 本地化优势：处理敏感文档的首选方案
     </li>
     <li>
      ⚡ 效率提升：批量处理100份PDF仅需3分钟（测试环境：i5-1135G7）
     </li>
     <li>
      🤖AI协作：DeepSeek使开发效率提升300%
     </li>
    </ul>
    <h3>
     <a id="1__235">
     </a>
     1. 优化方向
    </h3>
    <ul>
     <li>
      增加文件预览功能
     </li>
     <li>
      支持更多格式转换（如Word转PDF）
     </li>
     <li>
      实现跨平台版本（基于PyInstaller打包）
     </li>
    </ul>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f5869616f52756e67656e2f:61727469636c652f64657461696c732f313435393238353132" class_="artid" style="display:none">
 </p>
</div>


