---
layout: post
title: "小米路由器SSH下安装DDNS-GO"
date: 2025-03-13 21:33:41 +0800
description: "什么是DDNS？DDNS（Dynamic Domain Name Server）是动态域名服务的缩写。目前路由器拨号上网获得的多半都是动态IP，DDNS可以将路由器变化的外网IP和固定的域名绑定，从而用户可以在外网通过该固定域名来访问路由器。一般路由器系统都支持DDNS，但支持的域名服务商比较少，一般有花生壳等，明显不够用，这里我们安装DDNS-GO插件来实现DDNS。"
keywords: "小米路由器SSH下安装DDNS-GO"
categories: ['家庭组网']
tags: ['运维', 'Ssh', 'Golang']
artid: "146242546"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146242546
    alt: "小米路由器SSH下安装DDNS-GO"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146242546
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146242546
cover: https://bing.ee123.net/img/rand?artid=146242546
image: https://bing.ee123.net/img/rand?artid=146242546
img: https://bing.ee123.net/img/rand?artid=146242546
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     小米路由器SSH下安装DDNS-GO
    </h1>
   </div>
   <div class="article-resource-info-box">
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <hr/>
    <h2>
     <a id="_5">
     </a>
     前言
    </h2>
    <p>
     什么是DDNS？
     <br/>
     DDNS（Dynamic Domain Name Server）是动态域名服务的缩写。
    </p>
    <p>
     目前路由器拨号上网获得的多半都是动态IP，DDNS可以将路由器变化的外网IP和固定的域名绑定，从而用户可以在外网通过该固定域名来访问路由器。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/86d8d5f9b22b4546b8fc357033a3f44f.png">
      <br/>
      一般路由器系统都支持DDNS，但支持的域名服务商比较少，一般有花生壳等，明显不够用，这里我们安装DDNS-GO插件来实现DDNS。
     </img>
    </p>
    <blockquote>
     <p>
      DDNS-GO 是一个开源的动态域名解析工具，使用 Go 语言编写，旨在为用户提供一个简单、高效且易于使用的动态 DNS 服务，支持阿里云、腾讯云、Cloudflare、华为云、百度云、Porkbun、GoDaddy、Namecheap、NameSilo、Dynadot 等主流域名服务商
     </p>
    </blockquote>
    <h2>
     <a id="DDNSGO_18">
     </a>
     一、下载＆安装DDNS-GO
    </h2>
    <p>
     <code>
      本文用到的ddns-go 及scp工具都已经关联到文章资源上了
     </code>
    </p>
    <p>
     github项目地址：
     <a href="https://github.com/jeessy2/ddns-go/releases">
      https://github.com/jeessy2/ddns-go/releases
     </a>
    </p>
    <p>
     AX6000路由器是64位，下载ddns-go_6.8.1_linux_arm64.tar.gz 的插件。
    </p>
    <blockquote>
     <p>
      可以通过
      <code>
       uname -m
      </code>
      来查看ARM 架构还是 AMD 架构
      <br/>
      如果返回结果是 aarch64，则表示服务器是 ARM 架构；如果返回结果是 x86_64，则通常表示是 AMD 或 Intel 等 x86 架构
     </p>
    </blockquote>
    <p>
     下载成功DDNS-GO后，解压上传到路由器/data/ddns-go目录，默认肯定没有的，我们需要新建这个目录：
    </p>
    <p>
     mkdir /data/ddns-go
    </p>
    <p>
     然后使用SCP工具将解压后的文件上传到路由器的 /data/ddns-go 目录下
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/102c9079399548379761a9b295f602ae.png">
      <br/>
      上传ddns-go文件后，给这个文件赋权：
     </img>
    </p>
    <pre><code class="prism language-bash"><span class="token function">chmod</span> +x /data/ddns-go/ddns-go
</code></pre>
    <p>
     安装ddns-go命令：
    </p>
    <pre><code class="prism language-bash">/data/ddns-go/ddns-go <span class="token parameter variable">-l</span> :9876 <span class="token parameter variable">-f</span> <span class="token number">600</span> <span class="token parameter variable">-c</span> /data/ddns-go/ddns-go.yaml <span class="token parameter variable">-s</span> <span class="token function">install</span>
</code></pre>
    <p>
     参数的含义如下：
    </p>
    <p>
     -l :9876: 监听地址，表示 DDNS-GO 将在路由器的 9876 端口上提供 Web 服务。
    </p>
    <p>
     -f 600: 同步间隔时间，表示每 600 秒（10 分钟）进行一次域名解析的同步操作。
    </p>
    <p>
     -c /data/ddns-go/ddns-go.yaml: 指定配置文件路径，使用 /data/ddns-go/ddns-go.yaml 作为配置文件。
    </p>
    <p>
     -s install: 安装并启动 DDNS-GO 服务。
    </p>
    <p>
     DDNS-GO默认的端口就是9876，指定配置文件路径是测试发现，默认配置没有读写权限，所有有这个操作。
    </p>
    <h2>
     <a id="ddnsgo_59">
     </a>
     二、配置ddns-go
    </h2>
    <p>
     首先得有一个域名，我这里使用的是阿里云。也可以用其他服务商的。
    </p>
    <blockquote>
     <p>
      注册AccessKey
      <br/>
      首先登录个人的阿里云账号，我的是RAM账户。各位的可以使用主账户进行使用AccessKey。
      <br/>
      点击ACCESSKEY管理
      <br/>
      创建你的AccessKey,并记录下来。
     </p>
    </blockquote>
    <p>
     使用路由器IP + 9876 端口访问插件，第一次登录，用户名和密码将成为管理员账号和密码
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/1b620efba2c74fe8b495031c79370cba.png">
      <br/>
      将AK和SK填写进去
      <br/>
      然后选择IPv4或IPv6配置域名保存即可
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/decbe81339594d6da7f36188796e0786.png"/>
     </img>
    </p>
    <h2>
     <a id="_72">
     </a>
     设置开机启动
    </h2>
    <p>
     在/data/ddns-go目录下创建一个sh文件
    </p>
    <pre><code class="prism language-bash"><span class="token function">vim</span> /data/ddns-go/check_ddns.sh 
</code></pre>
    <p>
     添加如下内容
    </p>
    <pre><code class="prism language-bash"><span class="token shebang important">#!/bin/sh</span>

<span class="token keyword">if</span> <span class="token function">netstat</span> <span class="token parameter variable">-tunlp</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">':9876'</span> <span class="token operator">&gt;</span> /dev/null<span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"DDNS-GO 已在运行，无需启动。"</span>
<span class="token keyword">else</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"DDNS-GO 未运行，正在启动..."</span>
    /data/ddns-go/ddns-go <span class="token parameter variable">-l</span> :9876 <span class="token parameter variable">-f</span> <span class="token number">600</span> <span class="token parameter variable">-c</span> /data/ddns-go/ddns-go.yaml <span class="token parameter variable">-s</span> <span class="token function">install</span> <span class="token operator">&gt;</span> /data/ddns-go/ddns-go.log <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span>
<span class="token keyword">fi</span>
</code></pre>
    <p>
     将脚本添加到定时任务中
    </p>
    <pre><code class="prism language-bash"><span class="token function">crontab</span> <span class="token parameter variable">-e</span> 
<span class="token comment">#追加如下内容</span>
*/5 * * * * /data/ddns-go/check_ddns.sh 
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34333534383539302f:61727469636c652f64657461696c732f313436323432353436" class_="artid" style="display:none">
 </p>
</div>


