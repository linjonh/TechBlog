---
layout: post
title: "FX-extern-C"
date: 2025-03-10 19:39:27 +0800
description: "当C++代码需要调用C语言编写的函数时，使用extern \"C\"告诉编译器按照C语言的方式处理函数名。当C语言代码需要调用C++编写的函数时，使用extern \"C\"确保函数名不被修饰。许多系统库或第三方库是用C语言编写的，使用extern \"C\"可以确保C++代码能够正确链接这些库。extern \"C\"extern \"C\"可以用于单个函数、多个函数或整个头文件。"
keywords: "FX-extern C"
categories: ['C']
tags: ['开发语言', 'Chrome', 'C']
artid: "146162011"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146162011
    alt: "FX-extern-C"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146162011
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146162011
cover: https://bing.ee123.net/img/rand?artid=146162011
image: https://bing.ee123.net/img/rand?artid=146162011
img: https://bing.ee123.net/img/rand?artid=146162011
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     FX-extern C
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <ol>
     <li>
      <p>
       <strong>
        C++调用C语言编写的函数
       </strong>
       ：
      </p>
      <ul>
       <li>
        <p>
         当C++代码需要调用C语言编写的函数时，使用
         <code>
          extern "C"
         </code>
         告诉编译器按照C语言的方式处理函数名。
        </p>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        C语言调用C++编写的函数
       </strong>
       ：
      </p>
      <ul>
       <li>
        <p>
         当C语言代码需要调用C++编写的函数时，使用
         <code>
          extern "C"
         </code>
         确保函数名不被修饰。
        </p>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        与C语言库交互
       </strong>
       ：
      </p>
      <ul>
       <li>
        <p>
         许多系统库或第三方库是用C语言编写的，使用
         <code>
          extern "C"
         </code>
         可以确保C++代码能够正确链接这些库。
        </p>
       </li>
      </ul>
     </li>
    </ol>
    <hr/>
    <h4>
     <strong>
      <code>
       extern "C"
      </code>
      的语法
     </strong>
    </h4>
    <p>
     <code>
      extern "C"
     </code>
     可以用于单个函数、多个函数或整个头文件。
    </p>
    <h5>
     1. 单个函数
    </h5>
    <pre><code class="language-cpp">extern "C" void myFunction(int a, int b);</code></pre>
    <h5>
     2. 多个函数
    </h5>
    <pre><code class="language-cpp">extern "C" {
    void function1(int a);
    void function2(double b);
}</code></pre>
    <h5>
     3. 整个头文件
    </h5>
    <pre><code class="language-cpp">extern "C" {
    #include "my_c_library.h"
}</code></pre>
    <hr/>
    <h4>
     <strong>
      示例：C++调用C语言函数
     </strong>
    </h4>
    <p>
     假设有一个C语言编写的函数，需要在C++中调用。
    </p>
    <h5>
     C语言代码（
     <code>
      my_c_code.c
     </code>
     ）
    </h5>
    <pre><code class="language-cpp">#include &lt;stdio.h&gt;

void myCFunction() {
    printf("This is a C function.\n");
}</code></pre>
    <h5>
     C++代码（
     <code>
      main.cpp
     </code>
     ）
    </h5>
    <pre><code class="language-cpp">#include &lt;iostream&gt;

// 告诉编译器 myCFunction 是用 C 语言编写的
extern "C" void myCFunction();

int main() {
    std::cout &lt;&lt; "Calling a C function from C++..." &lt;&lt; std::endl;
    myCFunction();  // 调用 C 语言函数
    return 0;
}</code></pre>
    <h5>
     编译和链接
    </h5>
    <ol>
     <li>
      <p>
       编译C语言代码：
      </p>
      <pre><code class="language-cpp">gcc -c my_c_code.c -o my_c_code.o</code></pre>
     </li>
     <li>
      <p>
       编译C++代码：
      </p>
      <pre><code class="language-cpp">g++ -c main.cpp -o main.o</code></pre>
     </li>
     <li>
      <p>
       链接生成可执行文件：
      </p>
      <pre><code class="language-cpp">g++ main.o my_c_code.o -o my_program</code></pre>
     </li>
     <li>
      <p>
       运行程序：
      </p>
      <pre><code class="language-cpp">./my_program</code></pre>
     </li>
    </ol>
    <p>
     输出：
    </p>
    <pre><code class="language-cpp">Calling a C function from C++...
This is a C function.</code></pre>
    <hr/>
    <h4>
     <strong>
      示例：C语言调用C++函数
     </strong>
    </h4>
    <p>
     假设有一个C++编写的函数，需要在C语言中调用。
    </p>
    <h5>
     C++代码（
     <code>
      my_cpp_code.cpp
     </code>
     ）
    </h5>
    <pre><code class="language-cpp">#include &lt;iostream&gt;

// 告诉编译器 myCppFunction 使用 C 语言的链接方式
extern "C" void myCppFunction() {
    std::cout &lt;&lt; "This is a C++ function." &lt;&lt; std::endl;
}</code></pre>
    <h5>
     C语言代码（
     <code>
      main.c
     </code>
     ）
    </h5>
    <pre><code class="language-cpp">#include &lt;stdio.h&gt;

// 声明 C++ 函数
void myCppFunction();

int main() {
    printf("Calling a C++ function from C...\n");
    myCppFunction();  // 调用 C++ 函数
    return 0;
}</code></pre>
    <h5>
     编译和链接
    </h5>
    <ol>
     <li>
      <p>
       编译C++代码：
      </p>
      <pre><code class="language-cpp">g++ -c my_cpp_code.cpp -o my_cpp_code.o</code></pre>
     </li>
     <li>
      <p>
       编译C语言代码：
      </p>
      <pre><code class="language-bash">gcc -c main.c -o main.o</code></pre>
     </li>
     <li>
      <p>
       链接生成可执行文件：
      </p>
      <pre><code class="language-cpp">g++ main.o my_cpp_code.o -o my_program</code></pre>
     </li>
     <li>
      <p>
       运行程序：
      </p>
      <pre><code class="language-cpp">./my_program</code></pre>
     </li>
    </ol>
    <p>
     输出：
    </p>
    <pre><code class="language-cpp">Calling a C++ function from C...
This is a C++ function.</code></pre>
    <hr/>
    <h4>
     <strong>
      注意事项
     </strong>
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        名称修饰
       </strong>
       ：
      </p>
      <ul>
       <li>
        <p>
         C++编译器会对函数名进行名称修饰以支持函数重载，而C语言不会。使用
         <code>
          extern "C"
         </code>
         可以避免名称修饰。
        </p>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        函数重载
       </strong>
       ：
      </p>
      <ul>
       <li>
        <p>
         在
         <code>
          extern "C"
         </code>
         块中不能定义重载函数，因为C语言不支持函数重载。
        </p>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        C++特性
       </strong>
       ：
      </p>
      <ul>
       <li>
        <p>
         在
         <code>
          extern "C"
         </code>
         块中不能使用C++特有的特性（如类、模板、命名空间等）。
        </p>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        头文件保护
       </strong>
       ：
      </p>
      <ul>
       <li>
        <p>
         如果头文件可能被C和C++代码同时包含，可以使用以下方式保护：
        </p>
        <pre><code class="language-cpp">#ifdef __cplusplus
extern "C" {
#endif

void myFunction(int a, int b);

#ifdef __cplusplus
}
#endif</code></pre>
       </li>
      </ul>
     </li>
    </ol>
    <hr/>
    <h4>
     <strong>
      总结
     </strong>
    </h4>
    <ul>
     <li>
      <p>
       <code>
        extern "C"
       </code>
       用于在C++和C语言之间实现互操作。
      </p>
     </li>
     <li>
      <p>
       它告诉编译器按照C语言的方式处理函数或变量的链接，避免名称修饰。
      </p>
     </li>
     <li>
      <p>
       常用于C++调用C语言库，或者C语言调用C++函数。
      </p>
     </li>
     <li>
      <p>
       使用时需要注意C和C++的语法和特性差异。
      </p>
     </li>
    </ul>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f35303537373137362f:61727469636c652f64657461696c732f313436313632303131" class_="artid" style="display:none">
 </p>
</div>


