---
layout: post
title: "华为云数据转发与分析"
date: 2024-08-08 10:07:06 +0800
description: "在之前的文章我使用小熊派 STM32 开发板移植了 LiteOS 和 PahoMQTT 连接华为云上"
keywords: "华为云数据转发到mysql"
categories: ['华为云', 'Liteos']
tags: ['数据分析', '小熊派', '华为云', 'Mqtt', 'Liteos']
artid: "122904098"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=122904098
    alt: "华为云数据转发与分析"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=122904098
featuredImagePreview: https://bing.ee123.net/img/rand?artid=122904098
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     华为云数据转发与分析
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <div class="toc">
     <h4>
      文章目录
     </h4>
     <ul>
      <li>
       <a href="#_1" rel="nofollow">
        华为云数据转发与分析
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#_3" rel="nofollow">
          前言
         </a>
        </li>
        <li>
         <a href="#_7" rel="nofollow">
          一、数据转发
         </a>
        </li>
        <li>
         <ul>
          <li>
           <a href="#11__9" rel="nofollow">
            1.1 创建对象存储
           </a>
          </li>
          <li>
           <a href="#12__27" rel="nofollow">
            1.2 设置设备转发规则
           </a>
          </li>
         </ul>
        </li>
        <li>
         <a href="#_55" rel="nofollow">
          二、数据分析
         </a>
        </li>
        <li>
         <ul>
          <li>
           <a href="#21__61" rel="nofollow">
            2.1 配置数据源
           </a>
          </li>
          <li>
           <a href="#22__67" rel="nofollow">
            2.2 创建数据管道
           </a>
          </li>
          <li>
           <a href="#23__79" rel="nofollow">
            2.3 时序数据分析
           </a>
          </li>
          <li>
           <a href="#24__91" rel="nofollow">
            2.4 资产模型数据分析
           </a>
          </li>
         </ul>
        </li>
       </ul>
      </li>
     </ul>
    </div>
    <p>
    </p>
    <h2>
     <a id="_1">
     </a>
     华为云数据转发与分析
    </h2>
    <h3>
     <a id="_3">
     </a>
     前言
    </h3>
    <p>
     在之前的文章我使用小熊派 STM32 开发板移植了 LiteOS 和 PahoMQTT 连接华为云上云，实现了数据的上传和命令的下放，在实际场景中，一个云平台可能会有若干的设备连接和海量的数据上报，华为云也提供了数据的转发保存以及数据分析功能，本篇文章即分享相关功能的使用
    </p>
    <h3>
     <a id="_7">
     </a>
     一、数据转发
    </h3>
    <h4>
     <a id="11__9">
     </a>
     1.1 创建对象存储
    </h4>
    <p>
     将设备侧上报的数据转发到对象存储 OBS ，首先我们在控制台进入对象存储服务，进入到桶列表创建桶
    </p>
    <p>
     <img alt="20220212170455" src="https://i-blog.csdnimg.cn/blog_migrate/1d8f15aa0f28fe5eb4e8074f6dc24fee.png"/>
    </p>
    <p>
     设置桶的参数：
    </p>
    <p>
     <img alt="20220212181603" src="https://i-blog.csdnimg.cn/blog_migrate/9156dbb67069bee37c3789bff924414c.png"/>
    </p>
    <p>
     主要就是设置服务器的区域，离自己越近越快，然后设置桶的名称，其他的保持默认就行，创建完成如下：
    </p>
    <p>
     <img alt="20220212181833" src="https://i-blog.csdnimg.cn/blog_migrate/46b7d332c14032b761c4229c2732b39f.png"/>
    </p>
    <p>
     进入对象，给对象创建一个文件夹用来存放小熊派的数据
    </p>
    <p>
     <img alt="20220212181749" src="https://i-blog.csdnimg.cn/blog_migrate/4cfcf0dea31576f1c6b6841f806503a1.png"/>
    </p>
    <h4>
     <a id="12__27">
     </a>
     1.2 设置设备转发规则
    </h4>
    <p>
     在设备接入控制台下面点击：规则 -&gt; 数据转发
    </p>
    <p>
     <img alt="20220212182315" src="https://i-blog.csdnimg.cn/blog_migrate/04b3cfb72fb71500776e150ae69a31bf.png"/>
    </p>
    <p>
     点击创建规则
    </p>
    <p>
     <img alt="20220212213446" src="https://i-blog.csdnimg.cn/blog_migrate/59b3f37368cd1c37dc58c262d0e8e9d0.png"/>
    </p>
    <p>
     设置转发数据规则的规则名称，数据来源选择设备属性，转发的触发事件选择设备属性上报，资源空间选择我们之前创建的空间，然后创建规则
    </p>
    <p>
     <img alt="20220212213554" src="https://i-blog.csdnimg.cn/blog_migrate/1ef0f701d1778526fd2962870412a7e5.png"/>
    </p>
    <p>
     规则创建完成后，设置转发目标为 OBS ，然后区域选择中国东部，存储桶选择我们创建的，目录设置为 bearpi
    </p>
    <p>
     <img alt="20220212214039" src="https://i-blog.csdnimg.cn/blog_migrate/e9042ddb0a12d32a1590c4528c274a81.png"/>
    </p>
    <p>
     之后我们启动规则，小熊派连接华为云上报数据，数据就会转发到该桶内，如下：
    </p>
    <p>
     <img alt="20220212214602" src="https://i-blog.csdnimg.cn/blog_migrate/b8454a1e7d90529a9eb4f1aa25134d1b.png"/>
    </p>
    <p>
     我们下载其中的一个数据，打开后可以看到该数据保存了上传的 JSON 格式数据：
    </p>
    <p>
     <img alt="20220212214643" src="https://i-blog.csdnimg.cn/blog_migrate/f141a7eda85dc548615e1597ae104aff.png"/>
    </p>
    <p>
     到此数据转发完成
    </p>
    <h3>
     <a id="_55">
     </a>
     二、数据分析
    </h3>
    <p>
     数据分析的步骤我们可以在数据分析控制台（IoT数据分析）的总览看到
    </p>
    <p>
     <img alt="20220212215710" src="https://i-blog.csdnimg.cn/blog_migrate/6258cd84153ee8761bac982c1f66ee4d.png"/>
    </p>
    <h4>
     <a id="21__61">
     </a>
     2.1 配置数据源
    </h4>
    <p>
     进入数据源，添加数据源，选择我们创建好的产品实例
    </p>
    <p>
     <img alt="20220212223732" src="https://i-blog.csdnimg.cn/blog_migrate/d6c945095c6e0b164865e85475c635e3.png"/>
    </p>
    <h4>
     <a id="22__67">
     </a>
     2.2 创建数据管道
    </h4>
    <p>
     先是基本的设置名称和数据源
    </p>
    <p>
     <img alt="20220212224848" src="https://i-blog.csdnimg.cn/blog_migrate/ccee0e12e41a1333d8a4a4c535f23d8b.png"/>
    </p>
    <p>
     创建完成后，设置存储空间：储存组选择默认的储存组，数据存储选择我新建的 2_9 ，
    </p>
    <p>
     <img alt="20220212224923" src="https://i-blog.csdnimg.cn/blog_migrate/3d8f9a0adf7ef8dc726fb152a84439d4.png"/>
    </p>
    <p>
     设置完成后启动作业
    </p>
    <h4>
     <a id="23__79">
     </a>
     2.3 时序数据分析
    </h4>
    <p>
     时序数据分析就是直接安装时间观察数据变化情况
    </p>
    <p>
     进入存储管理，选择我们新建的 2_9 数据进行实时数据分析
    </p>
    <p>
     <img alt="20220212225158" src="https://i-blog.csdnimg.cn/blog_migrate/e2e546fc4e3cd17e7eaa9d5a9c0300cb.png"/>
    </p>
    <p>
     点击设备时序探索，选择我们的设备，添加要观察的属性，然后调整右上角的时序，观察数据变化
    </p>
    <p>
     <img alt="20220212225340" src="https://i-blog.csdnimg.cn/blog_migrate/76eb34e87a61a1ceba5b93c083c34240.png"/>
    </p>
    <h4>
     <a id="24__91">
     </a>
     2.4 资产模型数据分析
    </h4>
    <p>
     资产模型数据分析就是创建资产模型处理数据后进行进一步分析，该方式首先先新建个模型和分析任务，新建的模型属性包含产品自身的属性以及用于分析任务的属性
    </p>
    <p>
     <img alt="20220212232350" src="https://i-blog.csdnimg.cn/blog_migrate/99fd5ee996bd5b779e3e236ea1db3961.png"/>
    </p>
    <p>
     添加个分析任务，显示温度和光强，在这里可以做很多其他的计算
    </p>
    <p>
     <img alt="20220212232455" src="https://i-blog.csdnimg.cn/blog_migrate/68fced6439be671ed1a513c2efbc909b.png"/>
    </p>
    <p>
     然后创建一个资产，添加模型
    </p>
    <p>
     <img alt="20220212230527" src="https://i-blog.csdnimg.cn/blog_migrate/f2eae57c554871beb9a099c79df10b0d.png"/>
    </p>
    <p>
     进入资产，具体配置设备，添加
     <strong>
      设备 ID
     </strong>
     ，然后发布模型：
    </p>
    <p>
     <img alt="20220212232650" src="https://i-blog.csdnimg.cn/blog_migrate/80714dfd996fac5f7ef4916c0fccf1c0.png"/>
    </p>
    <p>
     之后在分析任务中观察资产模型即可
    </p>
    <p>
     <img alt="20220212234717" src="https://i-blog.csdnimg.cn/blog_migrate/132118ab096fbaded08fa663d7eafbc2.png"/>
    </p>
    <p>
     到此数据分析功能使用完成
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34353339363637322f:61727469636c652f64657461696c732f313232393034303938" class_="artid" style="display:none">
 </p>
</div>


