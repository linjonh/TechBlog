---
layout: post
title: "用vue3显示websocket的状态"
date: 2025-03-16 20:09:38 +0800
description: "在上次vue3项目上增加一个标签，显示当前的连接状态，两个按钮:重新连接 和 断开连接。"
keywords: "用vue3显示websocket的状态"
categories: ['未分类']
tags: ['网络', '前端', 'Websocket', 'Linux']
artid: "146298587"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146298587
    alt: "用vue3显示websocket的状态"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146298587
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146298587
cover: https://bing.ee123.net/img/rand?artid=146298587
image: https://bing.ee123.net/img/rand?artid=146298587
img: https://bing.ee123.net/img/rand?artid=146298587
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     用vue3显示websocket的状态
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     在上次vue3项目上增加一个标签，显示当前的连接状态，两个按钮:重新连接 和 断开连接
    </p>
    <h4>
     <a id="Appvue_1">
     </a>
     修改App.vue
    </h4>
    <pre><code class="prism language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>header<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>ws状态测试<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>header<span class="token operator">&gt;</span>

  <span class="token operator">&lt;</span>main<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>WsStatus <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>main<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">"ts"</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> WsStatus <span class="token keyword">from</span> <span class="token string">'./components/WsStatus.vue'</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
header <span class="token punctuation">{<!-- --></span>
  line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">1.5</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>logo <span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">display</span><span class="token operator">:</span> block<span class="token punctuation">;</span>
  <span class="token literal-property property">margin</span><span class="token operator">:</span> <span class="token number">0</span> auto 2rem<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

@<span class="token function">media</span> <span class="token punctuation">(</span><span class="token parameter">min<span class="token operator">-</span>width<span class="token operator">:</span> 1024px</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  header <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">display</span><span class="token operator">:</span> flex<span class="token punctuation">;</span>
    place<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
    padding<span class="token operator">-</span>right<span class="token operator">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token keyword">var</span><span class="token punctuation">(</span><span class="token operator">--</span>section<span class="token operator">-</span>gap<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token punctuation">.</span>logo <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">margin</span><span class="token operator">:</span> <span class="token number">0</span> 2rem <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  header <span class="token punctuation">.</span>wrapper <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">display</span><span class="token operator">:</span> flex<span class="token punctuation">;</span>
    place<span class="token operator">-</span>items<span class="token operator">:</span> flex<span class="token operator">-</span>start<span class="token punctuation">;</span>
    flex<span class="token operator">-</span>wrap<span class="token operator">:</span> wrap<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>

</code></pre>
    <h4>
     <a id="WsStatusvue_50">
     </a>
     WsStatus.vue
    </h4>
    <p>
     创建一个组件WsStatus.vue
    </p>
    <pre><code class="prism language-c"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div class<span class="token operator">=</span><span class="token string">"WsStatus"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>WebSocket 测试<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div class<span class="token operator">=</span><span class="token string">"status"</span><span class="token operator">&gt;</span>
            连接状态<span class="token operator">:</span> <span class="token operator">&lt;</span>span <span class="token operator">:</span>class<span class="token operator">=</span><span class="token string">"statusClass"</span><span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> connectionStatus <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"reconnect"</span> <span class="token operator">:</span>disabled<span class="token operator">=</span><span class="token string">"isConnecting"</span><span class="token operator">&gt;</span>
            <span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> isConnecting <span class="token operator">?</span> <span class="token char">'连接中...'</span> <span class="token operator">:</span> <span class="token char">'重新连接'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"closeConnect"</span> <span class="token operator">:</span>disabled<span class="token operator">=</span><span class="token string">"connectStatus"</span><span class="token operator">&gt;</span>断开连接<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>canvas<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>canvas<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">"ts"</span> name<span class="token operator">=</span><span class="token string">"WsStatus"</span><span class="token operator">&gt;</span>
import <span class="token punctuation">{<!-- --></span> ref<span class="token punctuation">,</span> onMounted<span class="token punctuation">,</span> onUnmounted <span class="token punctuation">}</span> from <span class="token char">'vue'</span>

<span class="token keyword">const</span> ws <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> imageUrl <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> connectionStatus <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token char">'未连接'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> isConnecting <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span>false<span class="token punctuation">)</span>
<span class="token keyword">const</span> connectStatus <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span>false<span class="token punctuation">)</span>
<span class="token keyword">const</span> statusClass <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token char">'disconnected'</span><span class="token punctuation">)</span>

function <span class="token function">get_appropriate_ws_url</span><span class="token punctuation">(</span>extra_url<span class="token operator">:</span> string<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    var pcol<span class="token punctuation">;</span>
    <span class="token comment">// 获得页面上的url</span>
    var u <span class="token operator">=</span> document<span class="token punctuation">.</span>URL<span class="token punctuation">;</span>

    <span class="token comment">/*
     * We open the websocket encrypted if this page came on an
     * https:// url itself, otherwise unencrypted
     */</span>

    <span class="token comment">// 去掉http://或者https://</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>u<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">==</span><span class="token operator">=</span> <span class="token string">"https"</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        pcol <span class="token operator">=</span> <span class="token string">"wss://"</span><span class="token punctuation">;</span>
        u <span class="token operator">=</span> u<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
        pcol <span class="token operator">=</span> <span class="token string">"ws://"</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>u<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">==</span><span class="token operator">=</span> <span class="token string">"http"</span><span class="token punctuation">)</span>
            u <span class="token operator">=</span> u<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/* + "/xxx" bit is for IE10 workaround */</span>

    <span class="token comment">//回来的url就城了ws://地址或者wss://地址</span>
    <span class="token keyword">return</span> pcol <span class="token operator">+</span> u<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token char">'/'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"/"</span> <span class="token operator">+</span> extra_url<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment">// WebSocket配置（修改为你的服务器地址）</span>
<span class="token keyword">const</span> wsUrl <span class="token operator">=</span> <span class="token function">get_appropriate_ws_url</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> connectWebSocket <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isConnecting<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token keyword">return</span>

    isConnecting<span class="token punctuation">.</span>value <span class="token operator">=</span> true
    connectionStatus<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token char">'连接中...'</span>
    statusClass<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token char">'connecting'</span>

    ws<span class="token punctuation">.</span>value <span class="token operator">=</span> new <span class="token function">WebSocket</span><span class="token punctuation">(</span>wsUrl<span class="token punctuation">)</span>

    ws<span class="token punctuation">.</span>value<span class="token punctuation">.</span>onopen <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
        connectionStatus<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token char">'已连接'</span>
        statusClass<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token char">'connected'</span>
        isConnecting<span class="token punctuation">.</span>value <span class="token operator">=</span> false
        connectStatus<span class="token punctuation">.</span>value <span class="token operator">=</span> false
    <span class="token punctuation">}</span>

    ws<span class="token punctuation">.</span>value<span class="token punctuation">.</span>onmessage <span class="token operator">=</span> <span class="token punctuation">(</span>event<span class="token operator">:</span> any<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token char">'收到数据'</span><span class="token punctuation">)</span>

    <span class="token punctuation">}</span>

    ws<span class="token punctuation">.</span>value<span class="token punctuation">.</span>onerror <span class="token operator">=</span> <span class="token punctuation">(</span>error<span class="token operator">:</span> any<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token char">'WebSocket错误:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span>
        connectionStatus<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token char">'连接错误'</span>
        statusClass<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token char">'error'</span>
        isConnecting<span class="token punctuation">.</span>value <span class="token operator">=</span> false
    <span class="token punctuation">}</span>

    ws<span class="token punctuation">.</span>value<span class="token punctuation">.</span>onclose <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
        connectionStatus<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token char">'连接已关闭'</span>
        statusClass<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token char">'disconnected'</span>
        isConnecting<span class="token punctuation">.</span>value <span class="token operator">=</span> false
        connectStatus<span class="token punctuation">.</span>value <span class="token operator">=</span> true
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token comment">// 组件挂载时自动连接</span>
<span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">connectWebSocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 组件卸载时关闭连接</span>
<span class="token function">onUnmounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ws<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        ws<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

function <span class="token function">reconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ws<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        ws<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">connectWebSocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

function <span class="token function">closeConnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ws<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        ws<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>websocket<span class="token operator">-</span>page <span class="token punctuation">{<!-- --></span>
    padding<span class="token operator">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span>
    max<span class="token operator">-</span>width<span class="token operator">:</span> <span class="token number">800</span>px<span class="token punctuation">;</span>
    margin<span class="token operator">:</span> <span class="token number">0</span> <span class="token keyword">auto</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>status <span class="token punctuation">{<!-- --></span>
    margin<span class="token operator">:</span> <span class="token number">20</span>px <span class="token number">0</span><span class="token punctuation">;</span>
    font<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">18</span>px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>status span <span class="token punctuation">{<!-- --></span>
    font<span class="token operator">-</span>weight<span class="token operator">:</span> bold<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>connected <span class="token punctuation">{<!-- --></span>
    color<span class="token operator">:</span> #<span class="token number">4</span>CAF50<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>connecting <span class="token punctuation">{<!-- --></span>
    color<span class="token operator">:</span> #FFC107<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>disconnected <span class="token punctuation">{<!-- --></span>
    color<span class="token operator">:</span> #F44336<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>error <span class="token punctuation">{<!-- --></span>
    color<span class="token operator">:</span> #F44336<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

button <span class="token punctuation">{<!-- --></span>
    padding<span class="token operator">:</span> <span class="token number">10</span>px <span class="token number">20</span>px<span class="token punctuation">;</span>
    background<span class="token operator">-</span>color<span class="token operator">:</span> #<span class="token number">2196F</span><span class="token number">3</span><span class="token punctuation">;</span>
    color<span class="token operator">:</span> white<span class="token punctuation">;</span>
    border<span class="token operator">:</span> none<span class="token punctuation">;</span>
    border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">4</span>px<span class="token punctuation">;</span>
    cursor<span class="token operator">:</span> pointer<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

button<span class="token operator">:</span>disabled <span class="token punctuation">{<!-- --></span>
    background<span class="token operator">-</span>color<span class="token operator">:</span> #BBDEFB<span class="token punctuation">;</span>
    cursor<span class="token operator">:</span> not<span class="token operator">-</span>allowed<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>messages <span class="token punctuation">{<!-- --></span>
    margin<span class="token operator">-</span>top<span class="token operator">:</span> <span class="token number">30</span>px<span class="token punctuation">;</span>
    border<span class="token operator">-</span>top<span class="token operator">:</span> <span class="token number">1</span>px solid #eee<span class="token punctuation">;</span>
    padding<span class="token operator">-</span>top<span class="token operator">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span>
    background<span class="token operator">-</span>size<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

ul <span class="token punctuation">{<!-- --></span>
    list<span class="token operator">-</span>style<span class="token operator">-</span>type<span class="token operator">:</span> none<span class="token punctuation">;</span>
    padding<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    max<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">300</span>px<span class="token punctuation">;</span>
    overflow<span class="token operator">-</span>y<span class="token operator">:</span> <span class="token keyword">auto</span><span class="token punctuation">;</span>
    border<span class="token operator">:</span> <span class="token number">1</span>px solid #ddd<span class="token punctuation">;</span>
    padding<span class="token operator">:</span> <span class="token number">10</span>px<span class="token punctuation">;</span>
    border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">4</span>px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

li <span class="token punctuation">{<!-- --></span>
    padding<span class="token operator">:</span> <span class="token number">5</span>px <span class="token number">0</span><span class="token punctuation">;</span>
    border<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">1</span>px solid #eee<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>live<span class="token operator">-</span>image <span class="token punctuation">{<!-- --></span>
    position<span class="token operator">:</span> fixed<span class="token punctuation">;</span>
    top<span class="token operator">:</span> <span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">;</span>
    left<span class="token operator">:</span> <span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">;</span>
    width<span class="token operator">:</span> <span class="token number">100</span>vw<span class="token punctuation">;</span>
    <span class="token comment">/* 根据需要设置宽度 */</span>
    height<span class="token operator">:</span> <span class="token number">100</span>vw<span class="token punctuation">;</span>

    object<span class="token operator">-</span>fit<span class="token operator">:</span> cover<span class="token punctuation">;</span>
    transform<span class="token operator">:</span> <span class="token function">translate</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">50</span><span class="token operator">%</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">cam</span><span class="token expression">Image<span class="token punctuation">,</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">canvas</span> <span class="token expression"><span class="token punctuation">{<!-- --></span></span></span>
    position<span class="token operator">:</span> fixed<span class="token punctuation">;</span>
    left<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    top<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
    <span class="token comment">/* height: 100%; */</span>
    z<span class="token operator">-</span>index<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 竖屏 */</span>
@media screen <span class="token function">and</span> <span class="token punctuation">(</span>orientation<span class="token operator">:</span> portrait<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>

<span class="token comment">/* 横屏 */</span>
@media screen <span class="token function">and</span> <span class="token punctuation">(</span>orientation<span class="token operator">:</span> landscape<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre>
    <h4>
     <a id="_269">
     </a>
     编译打包上传部署
    </h4>
    <pre><code class="prism language-bash">$ <span class="token function">npm</span> run build
$ <span class="token function">scp</span> <span class="token parameter variable">-r</span> ./dist/* root@192.168.9.163:/oem/usr/www
</code></pre>
    <h4>
     <a id="_275">
     </a>
     测试
    </h4>
    <p>
     在rv1106摄像头打开运行ws服务器
    </p>
    <pre><code class="prism language-bash"><span class="token comment"># /oem/usr/bin/ws_cam</span>
</code></pre>
    <p>
     浏览器访问 http://192.168.9.163:7681/
     <br/>
     看到相应页面，按按键会有相应的变换。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34343634333138392f:61727469636c652f64657461696c732f313436323938353837" class_="artid" style="display:none">
 </p>
</div>


