---
arturl_encode: "68747470:733a2f2f626c6f672e6373646e2e6e65742f5965617574792f:61727469636c652f64657461696c732f313436323138353338"
layout: post
title: "ä¸‰åˆ†é’ŸæŒæ¡éŸ³è§†é¢‘ä¿¡æ¯æŸ¥è¯¢-åœ¨-Rust-ä¸­ä¼˜é›…åœ°é›†æˆ-FFmpeg"
date: 2025-03-13 00:23:01 +0800
description: "Rust å¼€å‘è€…å¯ä»¥åœ¨ä¸ç›´æ¥å¤„ç† FFmpeg å‘½ä»¤è¡Œå·¥å…·æˆ–åŸç”Ÿ API çš„æƒ…å†µä¸‹ï¼Œå®‰å…¨ã€é«˜æ•ˆåœ°è·å–åª’ä½“æ–‡ä»¶çš„ä¿¡æ¯"
keywords: "ä¸‰åˆ†é’ŸæŒæ¡éŸ³è§†é¢‘ä¿¡æ¯æŸ¥è¯¢ | åœ¨ Rust ä¸­ä¼˜é›…åœ°é›†æˆ FFmpeg"
categories: ['æœªåˆ†ç±»']
tags: ['éŸ³è§†é¢‘', 'Rust', 'Ffmpeg']
artid: "146218538"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146218538
    alt: "ä¸‰åˆ†é’ŸæŒæ¡éŸ³è§†é¢‘ä¿¡æ¯æŸ¥è¯¢-åœ¨-Rust-ä¸­ä¼˜é›…åœ°é›†æˆ-FFmpeg"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146218538
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146218538
cover: https://bing.ee123.net/img/rand?artid=146218538
image: https://bing.ee123.net/img/rand?artid=146218538
img: https://bing.ee123.net/img/rand?artid=146218538
---

# ä¸‰åˆ†é’ŸæŒæ¡éŸ³è§†é¢‘ä¿¡æ¯æŸ¥è¯¢ | åœ¨ Rust ä¸­ä¼˜é›…åœ°é›†æˆ FFmpeg

### å‰è¨€

åœ¨éŸ³è§†é¢‘å¤„ç†é¢†åŸŸï¼Œå¼€å‘è€…å¸¸å¸¸éœ€è¦è·å–åª’ä½“æ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚æ—¶é•¿ã€æ ¼å¼ã€å…ƒæ•°æ®ï¼Œä»¥åŠéŸ³è§†é¢‘æµçš„ç¼–ç å‚æ•°ç­‰ã€‚è¿™äº›ä¿¡æ¯å¯¹äºåª’ä½“ç®¡ç†ã€è½¬ç è°ƒåº¦ã€æ’­æ”¾æ§åˆ¶ç­‰åœºæ™¯è‡³å…³é‡è¦ã€‚

ç„¶è€Œï¼Œç›´æ¥ä½¿ç”¨ FFmpeg å‘½ä»¤è¡Œå·¥å…·æˆ–å…¶åŸç”Ÿ API å­˜åœ¨ä»¥ä¸‹æŒ‘æˆ˜ï¼š

* **å‘½ä»¤è¡Œå·¥å…·çš„å¤æ‚æ€§**
  ï¼šFFmpeg çš„å‘½ä»¤è¡Œå‚æ•°ä¼—å¤šä¸”å¤æ‚ï¼Œä½¿ç”¨ä¸å½“å¯èƒ½å¯¼è‡´é”™è¯¯ã€‚ä¾‹å¦‚ï¼Œå¤„ç†åŒ…å«ç©ºæ ¼çš„æ–‡ä»¶åæ—¶ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„æ­£ç¡®çš„è½¬ä¹‰å’Œå¼•ç”¨æ–¹å¼ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´æ— æ³•è¯†åˆ«æ–‡ä»¶åçš„é—®é¢˜ã€‚
* **åŸç”Ÿ API çš„å¤æ‚æ€§**
  ï¼šFFmpeg æ¶‰åŠå¤§é‡çš„æ•°æ®ç»“æ„å’Œå‡½æ•°è°ƒç”¨ï¼Œå­¦ä¹ æ›²çº¿é™¡å³­ã€‚
* **å†…å­˜ç®¡ç†çš„å¤æ‚æ€§**
  ï¼šç›´æ¥æ“ä½œåº•å±‚ C æ¥å£ï¼Œå®¹æ˜“å¼•å…¥å†…å­˜æ³„æ¼å’Œå®‰å…¨éšæ‚£ã€‚
* **ç»´æŠ¤æˆæœ¬é«˜**
  ï¼šéœ€è¦å¤„ç†ä¸åŒç‰ˆæœ¬ä¹‹é—´çš„å…¼å®¹æ€§é—®é¢˜ï¼Œå¢åŠ äº†å¼€å‘å’Œç»´æŠ¤çš„éš¾åº¦ã€‚

å› æ­¤ï¼Œåœ¨ Rust ç”Ÿæ€ä¸­ï¼Œå¯»æ‰¾ä¸€ç§ç®€æ´ã€å®‰å…¨ä¸”é«˜æ•ˆçš„æ–¹å¼æ¥é›†æˆ FFmpegï¼Œæˆä¸ºå¼€å‘è€…çš„è¿«åˆ‡éœ€æ±‚ã€‚

### æ›´å¥½çš„è§£å†³æ–¹æ¡ˆ

ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œ
`ez-ffmpeg`
åº“åº”è¿è€Œç”Ÿã€‚å®ƒé€šè¿‡ FFIï¼ˆå¤–éƒ¨å‡½æ•°æ¥å£ï¼‰è°ƒç”¨ FFmpeg çš„åº•å±‚ C ä»£ç ï¼Œä¸º Rust å¼€å‘è€…æä¾›äº†ä¸€ä¸ªå®‰å…¨ä¸”ç¬¦åˆäººä½“å·¥å­¦çš„æ¥å£ã€‚è¯¥åº“çš„è®¾è®¡ç›®æ ‡æ˜¯ç®€åŒ– FFmpeg çš„ä½¿ç”¨ï¼Œé¿å…ç›´æ¥æ“ä½œå¤æ‚çš„åŸç”Ÿ APIï¼Œä»è€Œé™ä½å¼€å‘éš¾åº¦ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚

### **å¿«é€Ÿä¸Šæ‰‹ï¼šç”¨ Rust æŸ¥è¯¢éŸ³è§†é¢‘ä¿¡æ¯**

å‡è®¾æˆ‘ä»¬éœ€è¦è·å–ä¸€ä¸ªåª’ä½“æ–‡ä»¶çš„æ—¶é•¿ã€æ ¼å¼ã€å…ƒæ•°æ®ä»¥åŠéŸ³è§†é¢‘æµä¿¡æ¯ï¼Œä½¿ç”¨
`ez-ffmpeg`
åªéœ€å‡ è¡Œä»£ç ï¼š

#### **1. å®‰è£… FFmpeg**

å¦‚æœä½ çš„ç¯å¢ƒå°šæœªå®‰è£… FFmpegï¼Œå¯ä»¥æŒ‰ä»¥ä¸‹æ–¹å¼å®‰è£…ï¼š

##### macOSï¼š

```bash
brew install ffmpeg

```

##### Windowsï¼š

```bash
vcpkg install ffmpeg
# å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡å®‰è£… vcpkgï¼Œè¿˜éœ€è®¾ç½®ç¯å¢ƒå˜é‡ VCPKG_ROOT

```

#### **2. æ·»åŠ  Rust ä¾èµ–**

åœ¨
`Cargo.toml`
ä¸­å¼•å…¥
`ez-ffmpeg`
ï¼š

```toml
[dependencies]
ez-ffmpeg = "*"

```

#### **3. è¿è¡Œä»£ç **

```rust
use ez_ffmpeg::container_info::{get_duration_us, get_format, get_metadata};
use ez_ffmpeg::stream_info::{find_all_stream_infos, find_audio_stream_info, find_video_stream_info};

fn main() -> Result<(), Box<dyn std::error::Error>> {
    let file_path = "test.mp4";

    // è·å–åª’ä½“æ–‡ä»¶çš„æ—¶é•¿ï¼ˆå¾®ç§’ï¼‰
    let duration = get_duration_us(file_path)?;
    println!("æ—¶é•¿: {} å¾®ç§’", duration);

    // è·å–åª’ä½“æ–‡ä»¶çš„æ ¼å¼
    let format = get_format(file_path)?;
    println!("æ ¼å¼: {}", format);

    // è·å–åª’ä½“æ–‡ä»¶çš„å…ƒæ•°æ®
    let metadata = get_metadata(file_path)?;
    println!("å…ƒæ•°æ®:");
    for (key, value) in metadata {
        println!("{}: {}", key, value);
    }

    // è·å–è§†é¢‘æµä¿¡æ¯
    if let Some(video_info) = find_video_stream_info(file_path)? {
        println!("è§†é¢‘æµä¿¡æ¯: {:?}", video_info);
    } else {
        println!("æœªæ‰¾åˆ°è§†é¢‘æµã€‚");
    }

    // è·å–éŸ³é¢‘æµä¿¡æ¯
    if let Some(audio_info) = find_audio_stream_info(file_path)? {
        println!("éŸ³é¢‘æµä¿¡æ¯: {:?}", audio_info);
    } else {
        println!("æœªæ‰¾åˆ°éŸ³é¢‘æµã€‚");
    }

    // è·å–æ‰€æœ‰æµä¿¡æ¯
    let all_stream_infos = find_all_stream_infos(file_path)?;
    println!("æ‰€æœ‰æµä¿¡æ¯:");
    for stream_info in all_stream_infos {
        println!("{:?}", stream_info);
    }

    Ok(())
}

```

åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼š

* `get_duration_us(file_path)`
  ï¼šè·å–åª’ä½“æ–‡ä»¶çš„æ—¶é•¿ï¼Œå•ä½ä¸ºå¾®ç§’ã€‚
* `get_format(file_path)`
  ï¼šè·å–åª’ä½“æ–‡ä»¶çš„æ ¼å¼åç§°ã€‚
* `get_metadata(file_path)`
  ï¼šè·å–åª’ä½“æ–‡ä»¶çš„å…ƒæ•°æ®ä¿¡æ¯ã€‚
* `find_video_stream_info(file_path)`
  ï¼šè·å–åª’ä½“æ–‡ä»¶ä¸­ç¬¬ä¸€ä¸ªè§†é¢‘æµçš„ä¿¡æ¯ã€‚
* `find_audio_stream_info(file_path)`
  ï¼šè·å–åª’ä½“æ–‡ä»¶ä¸­ç¬¬ä¸€ä¸ªéŸ³é¢‘æµçš„ä¿¡æ¯ã€‚
* `find_all_stream_infos(file_path)`
  ï¼šè·å–åª’ä½“æ–‡ä»¶ä¸­æ‰€æœ‰æµçš„ä¿¡æ¯ã€‚

æ‰§è¡Œæ­¤ä»£ç åï¼Œå°†è¾“å‡ºåª’ä½“æ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ—¶é•¿ã€æ ¼å¼ã€å…ƒæ•°æ®ä»¥åŠå„ä¸ªæµçš„ä¿¡æ¯ã€‚

### **æ€»ç»“**

é€šè¿‡
`ez-ffmpeg`
ï¼ŒRust å¼€å‘è€…å¯ä»¥åœ¨ä¸ç›´æ¥å¤„ç† FFmpeg å‘½ä»¤è¡Œå·¥å…·æˆ–åŸç”Ÿ API çš„æƒ…å†µä¸‹ï¼Œå®‰å…¨ã€é«˜æ•ˆåœ°è·å–åª’ä½“æ–‡ä»¶çš„ä¿¡æ¯ã€‚è¿™ä¸ä»…ç®€åŒ–äº†å¼€å‘æµç¨‹ï¼Œè¿˜é™ä½äº†å‡ºé”™çš„é£é™©ï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿä¸“æ³¨äºä¸šåŠ¡é€»è¾‘çš„å®ç°ã€‚

ğŸ”—
**å¼€æºé¡¹ç›®åœ°å€**
ï¼š
[ez-ffmpeg](https://github.com/YeautyYE/ez-ffmpeg)