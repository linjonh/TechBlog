---
layout: post
title: "Shell编程概述与Shell变量"
date: 2025-03-06 22:37:33 +0800
description: "*传递给脚本或函数的所有参数，以单一字符串的形式返回，多个参数之间用空格分隔$@传递给脚本或函数的所有参数，以字符串的形式返回，每个参数是独立的上一条命令的退出状态（返回值），0：执行正确，非0：执行异常$#命令行中位置参数的总数量$0脚本的名称或程序的名称$$当前脚本的进程 ID（PID）后台任务最后一个ID（PID）"
keywords: "Shell编程概述与Shell变量"
categories: ['未分类']
tags: ['运维开发', '运维', '服务器', 'Linux']
artid: "146078330"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146078330
    alt: "Shell编程概述与Shell变量"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146078330
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146078330
cover: https://bing.ee123.net/img/rand?artid=146078330
image: https://bing.ee123.net/img/rand?artid=146078330
img: https://bing.ee123.net/img/rand?artid=146078330
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Shell编程概述与Shell变量
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <hr id="hr-toc" name="tableOfContents"/>
    <p>
    </p>
    <h4 id="%E4%B8%80%E3%80%81Shell%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80" name="%E4%B8%80%E3%80%81Shell%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80">
     一、Shell编程基础
    </h4>
    <p>
     Shell是一个命令行解释器，它为用户提供一个向Linux内核风骚那个请求以便运行程序的界面系统程序，用户可以用Shell来启动、挂起、停止或是编写一些程序。
    </p>
    <p>
     常见的Shell解释器程序有很Shell具有各类功能，通过/etc/shells 文件可以了解当前系统所支持的Shell脚本种类。
    </p>
    <pre><code class="language-bash">oot@localhost ~]# cat /etc/shells
/bin/sh
/bin/bash
/usr/bin/sh
/usr/bin/bash
/bin/tcsh
/bin/csh
</code></pre>
    <p>
     Linux中常见的shell有：
    </p>
    <ul>
     <li>
      bash：基于gun的框架下发展的shell。
     </li>
     <li>
      csh：类似C语言的shell。
     </li>
     <li>
      tcsh：csh的改进版，支持更多功能。
     </li>
     <li>
      sh：已被bash取代。
     </li>
     <li>
      nologin：让用户无法登录。
     </li>
    </ul>
    <h5 id="1.1%E3%80%81Shell%E8%84%9A%E6%9C%AC%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF" name="1.1%E3%80%81Shell%E8%84%9A%E6%9C%AC%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF">
     1.1、Shell脚本使用场景
    </h5>
    <ul>
     <li>
      将简单的命令组合完成复杂的工作,自动化执行命令,提高工作效率。
     </li>
     <li>
      减少手工命令的重复输入，一定程度上避免人为错误。
     </li>
     <li>
      将软件或应用的安装及配置实现标准化。
     </li>
     <li>
      用于实现日常性的,重复性的运维工作,如:文件打包压缩备份,监控系统运行状态并实现告警等。
     </li>
    </ul>
    <p>
    </p>
    <h5 id="%C2%A01.2%E3%80%81Shell%E8%84%9A%E6%9C%AC%E7%9A%84%E6%A0%BC%E5%BC%8F" name="%C2%A01.2%E3%80%81Shell%E8%84%9A%E6%9C%AC%E7%9A%84%E6%A0%BC%E5%BC%8F">
     1.2、Shell脚本的格式
    </h5>
    <pre><code class="language-bash">[root@localhost data]# vim test.sh        #编写shell脚本，后缀为.sh
#!/bin/bash                               #申明所使用的解释器，#号为注释
                                         
echo "当前日期："                          
date                                      #打印当前日期

mkdir /data/aabb                          #创建目录
cd /data/aabb                             #移动到该目录内

echo "aabbccdd" &gt; aa.txt                  #将内容输入到新的文件中
cat aa.txt                                #查看文件

[root@localhost data]# bash test.sh       #执行脚本显示执行结果
当前日期：
2025年 03月 06日 星期四 20:00:05 CST
aabbccdd
</code></pre>
    <h5 id="1.3%E3%80%81Shell%E8%84%9A%E6%9C%AC%E7%9A%84%E6%89%A7%E8%A1%8C" name="1.3%E3%80%81Shell%E8%84%9A%E6%9C%AC%E7%9A%84%E6%89%A7%E8%A1%8C">
     1.3、Shell脚本的执行
    </h5>
    <pre><code class="language-bash">[root@localhost data]# bash hello.sh                       #使用申明的bash解释器执行脚本
hello world~

[root@localhost data]# chmod +x hello.sh                   #给脚本文件增加执行权限
[root@localhost data]# ll
总用量 4
drwxr-xr-x. 2 root root  20 3月   6 20:00 aabb
-rwxr-xr-x. 1 root root 113 3月   6 19:59 hello.sh
[root@localhost data]# ./hello.sh                          #以相对路径执行
[root@localhost data]# /data/aabb/hello.sh                 #以绝对路径执行
hello world~</code></pre>
    <h5 id="1.4%E3%80%81Shell%E8%84%9A%E6%9C%AC%E9%94%99%E8%AF%AF%E8%B0%83%E8%AF%95" name="1.4%E3%80%81Shell%E8%84%9A%E6%9C%AC%E9%94%99%E8%AF%AF%E8%B0%83%E8%AF%95">
     1.4、Shell脚本错误调试
    </h5>
    <ul>
     <li>
      语法错误：导致后续命令无法执行，可用 bash -n 检测语法。
     </li>
     <li>
      命令错误：命令错误不影响后续命令的执行，可用 bash -x 模拟执行。
     </li>
     <li>
      逻辑错误：可通过 bash -x 进行排错。
     </li>
    </ul>
    <h4 id="%E4%BA%8C%E3%80%81%20%E9%87%8D%E5%AE%9A%E5%90%91%E4%B8%8E%E7%AE%A1%E9%81%93%E7%AC%A6" name="%E4%BA%8C%E3%80%81%20%E9%87%8D%E5%AE%9A%E5%90%91%E4%B8%8E%E7%AE%A1%E9%81%93%E7%AC%A6">
     二、 重定向与管道符
    </h4>
    <h5 id="2.1%E3%80%81%E9%87%8D%E5%AE%9A%E5%90%91" name="2.1%E3%80%81%E9%87%8D%E5%AE%9A%E5%90%91">
     2.1、重定向
    </h5>
    <p>
     重定向将命令的标准输入、标准输出或标准错误流定向到文件或者从文件读取输入。
    </p>
    <table>
     <thead>
      <tr>
       <th>
        <strong>
         类型
        </strong>
       </th>
       <th>
        <strong>
         设备文件
        </strong>
       </th>
       <th>
        <strong>
         文件描述编号
        </strong>
       </th>
       <th>
        <strong>
         默认设备
        </strong>
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        标准输入
       </td>
       <td>
        /dev/stdin
       </td>
       <td>
        0
       </td>
       <td>
        键盘
       </td>
      </tr>
      <tr>
       <td>
        标准输出
       </td>
       <td>
        /dev/stdout
       </td>
       <td>
        1
       </td>
       <td>
        显示器
       </td>
      </tr>
      <tr>
       <td>
        标准错误输出
       </td>
       <td>
        /dev/stderr
       </td>
       <td>
        2
       </td>
       <td>
        显示器
       </td>
      </tr>
     </tbody>
    </table>
    <ul>
     <li>
      标准输入：从输入设备接收用户输入的数据
     </li>
     <li>
      标准输出：输出正确的运算结果
     </li>
     <li>
      标准错误：输出错误的运算结果
     </li>
    </ul>
    <p>
     重定向输入输出：
    </p>
    <table>
     <thead>
      <tr>
       <th>
        <strong>
         类型
        </strong>
       </th>
       <th>
        <strong>
         操作符
        </strong>
       </th>
       <th>
        <strong>
         用途
        </strong>
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td style="text-align:center">
        重定向输入
       </td>
       <td style="text-align:center">
        &lt;
       </td>
       <td>
        从指定的文件读取数据，而不是从键盘输入
       </td>
      </tr>
      <tr>
       <td style="text-align:center">
        重定向输出
       </td>
       <td style="text-align:center">
        1&gt;
       </td>
       <td>
        将输出结果保存到指定的文件（覆盖原有内容）
       </td>
      </tr>
      <tr>
       <td style="text-align:center">
        &gt;&gt;
       </td>
       <td style="text-align:center">
        将输出结果追加到指定的文件尾部
       </td>
       <td>
       </td>
      </tr>
      <tr>
       <td style="text-align:center">
        标准错误输出
       </td>
       <td style="text-align:center">
        2&gt;
       </td>
       <td>
        将错误信息保存到指定的文件（覆盖原有内容）
       </td>
      </tr>
      <tr>
       <td style="text-align:center">
        2&gt;&gt;
       </td>
       <td style="text-align:center">
        标准错误输出结果追加到指定的文件尾部
       </td>
       <td>
       </td>
      </tr>
      <tr>
       <td style="text-align:center">
        混合输出
       </td>
       <td style="text-align:center">
        &amp;&gt;无论对错都可以重定向
       </td>
       <td>
        将标准输出、标准错误的内容保存到同一个文件中
       </td>
      </tr>
     </tbody>
    </table>
    <h5 id="2.2%E3%80%81%E7%AE%A1%E9%81%93%E7%AC%A6" name="2.2%E3%80%81%E7%AE%A1%E9%81%93%E7%AC%A6">
     2.2、管道符
    </h5>
    <p>
     管道符
     <code>
      |
     </code>
     用于将一个命令的输出作为另一个命令的输入，即将多个命令串联起来。
    </p>
    <pre><code class="language-bash">#通过管道符将多个命令组合使用
[root@localhost data]# awk -F: '{print $7}' /etc/passwd |sort |uniq -c |sort -n
      1 /bin/sync
      1 /sbin/halt
      1 /sbin/shutdown
      2 /bin/bash
     40 /sbin/nologin
</code></pre>
    <h4 id="%E4%B8%89%E3%80%81Shell%E5%8F%98%E9%87%8F" name="%E4%B8%89%E3%80%81Shell%E5%8F%98%E9%87%8F">
     三、Shell变量
    </h4>
    <p>
     变量用于存储数据和信息，以便在脚本中重复使用。
    </p>
    <h5 id="3.1%E3%80%81%E5%8F%98%E9%87%8F%E5%88%86%E7%B1%BB" name="3.1%E3%80%81%E5%8F%98%E9%87%8F%E5%88%86%E7%B1%BB">
     3.1、变量分类
    </h5>
    <ul>
     <li>
      系统变量：$PATH、$UID、$HOSTNAME、$USER、￥SHELL
      <ul>
       <li>
        环境变量：由系统维护，用于设置工作环境
       </li>
       <li>
        只读变量：只可以读取不可以更改
       </li>
       <li>
        位置变量：通过命令行给脚本传递参数
       </li>
      </ul>
     </li>
     <li>
      自定义变量：由用户自己定义，修改和使用
      <ul>
       <li>
        变量名由字母、数字和下划线组成，但不能以数字开头
       </li>
       <li>
        等号两侧不能有空格
       </li>
      </ul>
     </li>
    </ul>
    <pre><code class="language-bash">#  自定义变量    变量名=变量值
[root@localhost data]# A=100
[root@localhost data]# echo $A
100
</code></pre>
    <h5 id="3.2%E3%80%81%E7%89%B9%E6%AE%8A%E7%AC%A6%E5%8F%B7" name="3.2%E3%80%81%E7%89%B9%E6%AE%8A%E7%AC%A6%E5%8F%B7">
     3.2、特殊符号
    </h5>
    <table border="1" cellpadding="1" cellspacing="1" style="width:650px">
     <tbody>
      <tr>
       <td>
        特殊符号
       </td>
       <td>
        功能
       </td>
      </tr>
      <tr>
       <td>
        {        }
       </td>
       <td>
        确定变量范围
       </td>
      </tr>
      <tr>
       <td>
        '        '
       </td>
       <td>
        单引号不识别变量，输出字符原意
       </td>
      </tr>
      <tr>
       <td>
        "        "
       </td>
       <td>
        双引号识别变量
       </td>
      </tr>
      <tr>
       <td>
        $(        )
       </td>
       <td>
        调用命令执行结果
       </td>
      </tr>
      <tr>
       <td>
        `        `
       </td>
       <td>
        反撇号调用命令执行结果
       </td>
      </tr>
     </tbody>
    </table>
    <pre><code class="language-bash">[root@localhost data]# echo '$PATH'
$PATH
[root@localhost data]# echo "$PATH"
/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/bin:/sbin:/root/bin
[root@localhost data]# echo $(date +%Y-%m-%d)
2025-03-06
[root@localhost data]# echo `date +%H:%M:%S`
21:29:27
</code></pre>
    <h5 id="3.3%E3%80%81%E6%95%B4%E6%95%B0%E8%BF%90%E7%AE%97" name="3.3%E3%80%81%E6%95%B4%E6%95%B0%E8%BF%90%E7%AE%97">
     3.3、整数运算
    </h5>
    <table border="1" cellpadding="1" cellspacing="1" style="width:650px">
     <tbody>
      <tr>
       <td style="width:292px">
        运算符
       </td>
       <td style="width:356px">
        算数表达式
       </td>
      </tr>
      <tr>
       <td style="width:292px">
        +      加法
       </td>
       <td style="width:356px">
        num1 + num2
       </td>
      </tr>
      <tr>
       <td style="width:292px">
        -       减法
       </td>
       <td style="width:356px">
        num1 - num2
       </td>
      </tr>
      <tr>
       <td style="width:292px">
        \*      乘法
       </td>
       <td style="width:356px">
        num1 \* num2
       </td>
      </tr>
      <tr>
       <td style="width:292px">
        /        除法
       </td>
       <td style="width:356px">
        num1 / num2
       </td>
      </tr>
      <tr>
       <td style="width:292px">
        %      取模
       </td>
       <td style="width:356px">
        num1 % num2 （相除后取余数）
       </td>
      </tr>
     </tbody>
    </table>
    <pre><code class="language-bash">[root@localhost data]# x=10
[root@localhost data]# y=5
[root@localhost data]# let sum=$x+$y            #let是bash中用于计算的工具
[root@localhost data]# echo $sum
15
[root@localhost data]# let sum=$x/$y
[root@localhost data]# echo $sum
2
[root@localhost data]# let sum=$x\*$y
[root@localhost data]# echo $sum
50
[root@localhost data]# expr 11 + 12             #expr为字符串及整数计算器
23
[root@localhost data]# expr $x + $y
15
</code></pre>
    <p>
     let命令拓展
    </p>
    <pre><code class="language-bash">#let命令支持自加或自减操作
#id++，id--  变量后增量，变量后减量
#++id，--id  变量预增量，变量预减量
[root@localhost ~]#i=1
[root@localhost ~]#let i++
[root@localhost ~]#echo $i
2
[root@localhost ~]#i=1;let i++;echo $i
2
[root@localhost ~]#i=1;let ++i;echo $i
2
[root@localhost ~]#i=100;let j=i++;echo $i $j
101 100
[root@localhost ~]#i=100;let j=++i;echo $i $j
101 101</code></pre>
    <p>
     生成随机数
    </p>
    <pre><code class="language-bash">#    $RANDOM   取值范围：0-32767
[root@localhost data]# echo $[$RANDOM%6]    #取0-5的随机数
5
[root@localhost data]# echo $[$RANDOM%6]
4
[root@localhost data]# echo $[$RANDOM%6]
2
[root@localhost data]# echo $[$RANDOM%6]
0
[root@localhost data]# echo $[$RANDOM%6]
2
[root@localhost data]# echo $[$RANDOM%6]
3
</code></pre>
    <h5 id="3.4%E3%80%81read" name="3.4%E3%80%81read">
     3.4、read
    </h5>
    <p>
     read命令的功能是用于读取单行数据内容，一般是从标准输入中读取数值，用于给变量赋值。
     <br/>
     <span style="color:#be191c">
      <span style="background-color:#fbd4d0">
       -p
      </span>
     </span>
     选项指定读取值时的提示符。
    </p>
    <pre><code class="language-bash">[root@localhost data]# vim aa.sh        

#!/bin/bash

read -p "输入数字：" num
echo "输入的数字为：$num"

[root@localhost data]# bash aa.sh 
输入数字：233
输入的数字为：233
</code></pre>
    <h5 id="3.5%E3%80%81%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E4%B8%8E%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F" name="3.5%E3%80%81%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E4%B8%8E%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F">
     3.5、局部变量与全局变量
    </h5>
    <ul>
     <li>
      局部变量：只在当前 Shell 函数或当前脚本中有效的变量，它们的作用范围仅限于函数内部或脚本内部，函数执行完毕或进入新的shell环境，局部变量的值会被销毁。
     </li>
     <li>
      全局变量：在整个脚本或 Shell 会话中都有效的变量。全局变量通常在脚本的顶部定义，或者是通过
      <span style="color:#be191c">
       <span style="background-color:#fbd4d0">
        export
       </span>
      </span>
      命令将局部变量转为全局（环境）变量。
     </li>
    </ul>
    <pre><code class="language-bash">#设置全局/环境变量的语法格式
#    export 变量名
#    export 变量名=变量值

[root@localhost data]# pstree |grep bash            ##通过pstree命令可以查看shell环境
        |-gnome-terminal--+-bash-+-grep
[root@localhost data]# bash                         #输入bash可以进入子shell
[root@localhost data]# pstree |grep bash
        |-gnome-terminal--+-bash---bash-+-grep
[root@localhost data]# exit                         #ctrl+d 退出shell
[root@localhost data]# pstree |grep bash
        |-gnome-terminal--+-bash-+-grep


[root@localhost opt]# abc=123
[root@localhost opt]# echo $abc 
123
[root@localhost opt]# bash
[root@localhost opt]# echo $abc
为空
[root@localhost opt]# exit
exit
[root@localhost opt]# echo $abc
123
[root@localhost opt]# export abc
#export  变量名      定义全局变量
[root@localhost opt]# bash
[root@localhost opt]# echo $abc
123</code></pre>
    <h5 id="3.6%E3%80%81%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F" name="3.6%E3%80%81%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F">
     3.6、环境变量
    </h5>
    <p>
     环境变量都存放在
     <span style="color:#be191c">
      <span style="background-color:#fbd4d0">
       /etc/profile
      </span>
     </span>
     文件内，修改此文件会作用与所有用户，用于长期变更或设置环境变量。
    </p>
    <pre><code class="language-bash">[root@localhost ~]# vim /etc/profile

export PATH=$PATH:/root                    #行末添加新的环境变量

[root@localhost ~]# source /etc/profile    #source命令是从指定文件中读取和执行命令，使之立既生效

[root@localhost ~]# env                    #查看当前环境变量或定义变量</code></pre>
    <h5 id="3.7%E3%80%81%E5%8F%AA%E8%AF%BB%E5%8F%98%E9%87%8F" name="3.7%E3%80%81%E5%8F%AA%E8%AF%BB%E5%8F%98%E9%87%8F">
     3.7、只读变量
    </h5>
    <p>
     通过readonly命令定义变量并设置只读属性，定义后变量值无法修改，可重启清除。
    </p>
    <pre><code class="language-bash">[root@localhost opt]# name=9527
[root@localhost opt]# readonly name
[root@localhost opt]# echo $name 
9527
[root@localhost opt]# unset name
bash: unset: name: 无法反设定: 只读 variable
#只有退出进程
[root@localhost opt]# echo $name 
9527
[root@localhost opt]# name=233
bash: name: 只读变量</code></pre>
    <h5 id="3.8%E3%80%81%E4%BD%8D%E7%BD%AE%E5%8F%98%E9%87%8F" name="3.8%E3%80%81%E4%BD%8D%E7%BD%AE%E5%8F%98%E9%87%8F">
     3.8、位置变量
    </h5>
    <p>
     位置变量也称为位置参数，用$1、$2、$3、…、$n 表示
    </p>
    <pre><code class="language-bash">[root@test1 ~]# vim 1.sh      
#!/bin/bash
echo "$1"            位置1
echo "$2"            位置2
echo "${10}"         位置10
echo "$10"           位置1和0
echo "$*"            将所有项当成一个值
echo "$@"            所有项
echo "$0"            脚本自身
echo "$#"            后面参数的个数
[root@test1 ~]# ./1.sh {1..10}
1 
2
10
10
1 2 3 4 5 6 7 8 9 10</code></pre>
    <h5 id="3.9%E3%80%81%E9%A2%84%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F" name="3.9%E3%80%81%E9%A2%84%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F">
     3.9、预定义变量
    </h5>
    <table border="1" cellpadding="1" cellspacing="1" style="width:650px">
     <tbody>
      <tr>
       <td style="width:144px">
        $*
       </td>
       <td style="width:504px">
        传递给脚本或函数的所有参数，以单一字符串的形式返回，多个参数之间用空格分隔
       </td>
      </tr>
      <tr>
       <td style="width:144px">
        $@
       </td>
       <td style="width:504px">
        传递给脚本或函数的所有参数，以字符串的形式返回，每个参数是独立的
       </td>
      </tr>
      <tr>
       <td style="width:144px">
        $?
       </td>
       <td style="width:504px">
        上一条命令的退出状态（返回值），0：执行正确，非0：执行异常
       </td>
      </tr>
      <tr>
       <td style="width:144px">
        $#
       </td>
       <td style="width:504px">
        命令行中位置参数的总数量
       </td>
      </tr>
      <tr>
       <td style="width:144px">
        $0
       </td>
       <td style="width:504px">
        脚本的名称或程序的名称
       </td>
      </tr>
      <tr>
       <td style="width:144px">
        $$
       </td>
       <td style="width:504px">
        当前脚本的进程 ID（PID）
       </td>
      </tr>
      <tr>
       <td style="width:144px">
        $!
       </td>
       <td style="width:504px">
        后台任务最后一个ID（PID）
       </td>
      </tr>
     </tbody>
    </table>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34333039393136322f:61727469636c652f64657461696c732f313436303738333330" class_="artid" style="display:none">
 </p>
</div>


