---
layout: post
title: "面试题sql题一"
date: 2025-07-22T20:33:14+0800
description: "这篇SQL查询用于统计各产品年销售额超过1000元的销售情况。通过关联产品表(products)和销售表(sales)，按产品ID、名称和销售年份分组，筛选年销售额总和大于1000元的记录，并按销售额降序排列。查询结果包含产品ID、名称、年销售额和销售年份4个字段。表结构显示产品表含产品ID和名称字段，销售表包含销售记录ID、产品ID、销量、单价和销售日期字段。"
keywords: "面试题：sql题一"
categories: ['未分类']
tags: ['数据库', 'Sql']
artid: "149546905"
arturl: "https://blog.csdn.net/weixin_42738495/article/details/149546905"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=149546905
    alt: "面试题sql题一"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=149546905
featuredImagePreview: https://bing.ee123.net/img/rand?artid=149546905
cover: https://bing.ee123.net/img/rand?artid=149546905
image: https://bing.ee123.net/img/rand?artid=149546905
img: https://bing.ee123.net/img/rand?artid=149546905
---



# 面试题：sql题一

```sql
SELECT
    p.product_id,                 -- 产品ID
    p.product_name,               -- 产品名称
    SUM(s.sale_qty * s.unit_price) AS sum_price,  -- 年销售总价
    YEAR(s.sale_date) AS year_date                -- 销售年份
FROM 
    products p
JOIN sales s ON p.product_id = s.product_id
GROUP BY
    p.product_id,
    p.product_name,
    YEAR(s.sale_date)
HAVING
    SUM(s.sale_qty * s.unit_price) > 1000         -- 年总价大于1000
ORDER BY
    sum_price DESC;                               -- 按总价降序排列

```

---

**表结构示例：**

**products（产品表）**

| 字段名 | 类型 | 说明 |
| --- | --- | --- |
| product_id | INT | 产品ID |
| product_name | VARCHAR | 产品名称 |

**sales（销量表）**

| 字段名 | 类型 | 说明 |
| --- | --- | --- |
| sale_id | INT | 销售记录ID |
| product_id | INT | 产品ID |
| sale_qty | INT | 销量 |
| unit_price | DECIMAL | 单价 |
| sale_date | DATE | 销售日期 |

---

**查询说明：**

* 本查询用于统计每个产品每年销量总价大于1000元的销售情况，并按总价从高到低排序。



