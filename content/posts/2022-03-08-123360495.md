---
arturl_encode: "68747470733a2f2f62:6c6f672e6373646e2e6e65742f676569646f6e67646f6e672f:61727469636c652f64657461696c732f313233333630343935"
layout: post
title: "全新领域前端处理高并发"
date: 2022-03-08 22:22:40 +0800
description: "全新领域——前端处理高并发_前端高并发解决方案"
keywords: "前端高并发解决方案"
categories: ['未分类']
tags: ['高并发', '前端']
artid: "123360495"
image:
  path: https://api.vvhan.com/api/bing?rand=sj&artid=123360495
  alt: "全新领域前端处理高并发"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=123360495
featuredImagePreview: https://bing.ee123.net/img/rand?artid=123360495
---

# 全新领域——前端处理高并发

一、静态资源上传cdn
  
什么是cnd？以下内容为转载
  
以之前很火的“延禧攻略”为例，当时曾经在某视频APP实现了1千万用户同时在线观看。

如果大家观看的是1080p清晰度的视频（理论上需要4Mbps带宽），那么，累计需要的流量带宽是10,000,000×4Mbps=40,000,000Mbps=40Tbps。

对于优酷、爱奇艺这样的互联网视频内容提供商来说，这无疑是非常巨大的流量压力。

我们普通计算机的网卡，是1Gbps的带宽。如果优酷有一台超级服务器，那么，这台超级服务器就需要4万块网卡，而且必须百分之百跑满速度，才能够实现这1千万用户的流畅观看。

对于一些实力不够的服务商，或者突发流量陡增的情况，就会造成拥塞，从而导致卡顿和延时。

有这么一个说法：当用户打开一个页面，等待超过4秒，他就会关闭这个页面。也就是说，这个用户就会流失。

这应该是大家最讨厌的符号：
  
![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/0afc005bfcc485b22aadafb7c5f7cd01.png)
  
用户的流失，就意味着金钱的流失。没有任何一家互联网服务提供商希望这样的情况发生。所以，它们必须想方设法让自己的内容尽快呈现，缩短用户的等待时间，提升用户的体验。

而CDN，就是一项非常有效的缩短时延的技术。

CDN的诞生
  
上世纪80年代，互联网技术刚刚走入民用领域。

人们主要通过拨号来访问网络，带宽很低，用户也很少，所以，没有对骨干网以及服务器带来压力。

随着互联网的爆炸式发展，用户越来越多，加上宽带接入网的出现，内容源服务器和骨干网络的压力越来越大，无法及时响应用户的访问需求。

1995年，麻省理工学院教授、互联网的发明者之一，Tim Berners-Lee博士发现，网络拥塞越来越严重，将会成为互联网发展的最大障碍。于是，他提出一个学术难题，希望有人能发明一种全新的、从根本上解决问题的方法，来实现互联网内容的无拥塞分发。

当时Tim Berners-Lee博士的隔壁，是Tom Leighton教授的办公室。他是一位麻省理工学院应用数学教授。他被Berners-Lee的挑战激起了兴趣，于是他请研究生Danny C. Lewin和其他几位顶级研究人员一起破解这个技术难题。

最终，他们开发了利用数学运算法则来处理内容的动态路由算法技术，有效地解决了这个难题。这个技术，就是CDN。他们还为此专门成立了公司，发挥其商业价值。这个公司，就是后来鼎鼎大名的CDN服务鼻祖——Akamai公司。

**CDN的原理**
  
CDN这个技术其实说起来并不复杂，最初的核心理念，就是将内容缓存在终端用户附近。
  
![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/6b261c9492bb1bee23c840fdab7177de.png)
  
因为这项技术是把内容进行了分发，所以，它的名字就叫做CDN——Content Delivery Network，内容分发网络。具体来说，CDN就是采用更多的缓存服务器（CDN边缘节点），布放在用户访问相对集中的地区或网络中。当用户访问网站时，利用全局负载技术，将用户的访问指向距离最近的缓存服务器上，由缓存服务器响应用户请求。（有点像电商的本地仓吧？）

大家可能觉得，这个不就是“镜像服务器”嘛？其实不一样。镜像服务器是源内容服务器的完整复制。而CDN，是部分内容的缓存，智能程度更高。

确切地说，CDN=更智能的镜像+缓存+流量导流。

而且还需要注意的是，CDN并不是只能缓存视频内容，它还可以对网站的静态资源（例如各类型图片、html、css、js等）进行分发，对移动应用APP的静态内容（例如安装包apk文件、APP内的图片视频等）进行分发。

我们来举个例子，看看CDN的具体工作流程。如果某个用户想要访问优酷的视频点播内容，那么：
  
![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/84b39414a9fdeef2426ca7db1fc1623f.png)
  
具体步骤：

①、当用户点击APP上的内容，APP会根据URL地址去本地DNS（域名解析系统）寻求IP地址解析。
  
②、本地DNS系统会将域名的解析权交给CDN专用DNS服务器。
  
③、CDN专用DNS服务器，将CDN的全局负载均衡设备IP地址返回用户。
  
④、用户向CDN的负载均衡设备发起内容URL访问请求。
  
⑤、CDN负载均衡设备根据用户IP地址，以及用户请求的内容URL，选择一台用户所属区域的缓存服务器。
  
⑥、负载均衡设备告诉用户这台缓存服务器的IP地址，让用户向所选择的缓存服务器发起请求。
  
⑦、用户向缓存服务器发起请求，缓存服务器响应用户请求，将用户所需内容传送到用户终端。
  
⑧、如果这台缓存服务器上并没有用户想要的内容，那么这台缓存服务器就要网站的源服务器请求内容。
  
⑨、源服务器返回内容给缓存服务器，缓存服务器发给用户，并根据用户自定义的缓存策略，判断要不要把内容缓存到缓存服务器上。
  
**CDN的好处**
  
采用CDN技术，最大的好处，就是加速了网站的访问——用户与内容之间的物理距离缩短，用户的等待时间也得以缩短。

而且，分发至不同线路的缓存服务器，也让跨运营商之间的访问得以加速。

例如中国移动手机用户访问中国电信网络的内容源，可以通过在中国移动假设CDN服务器，进行加速。效果是非常明显的。

此外，CDN还有安全方面的好处。内容进行分发后，源服务器的IP被隐藏，受到攻击的概率会大幅下降。而且，当某个服务器故障时，系统会调用临近的健康服务器，进行服务，避免对用户造成影响。

正因为CDN的好处很多，所以，目前所有主流的互联网服务提供商，都采用了CDN技术。所有的云服务提供商，也都提供了CDN服务（价格也不算贵，按流量计费）。

我认为后期的移动边缘计算和联合学习也是参考这种情况提出来的。

二、利用缓存存放数据
  
分析需要的数据，借助本地存储实现减少请求的目的…未完待续
  
三、避免高频刷新页面
  
5～10秒内刷新页面只获取一次列表数据，避免高频刷新带给服务器的压力…未完待续
  
四、设置响应头cache-control和last-modified
  
对于所有的数据和接口设置响应头，利用express模拟，如果两次请求间隔小于5秒，直接返回304，不需要服务器进行处理…未完待续