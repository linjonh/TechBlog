---
layout: post
title: "LinuxJava线上问题,一分钟日志定位"
date: 2025-08-24T22:08:58+0800
description: "【代码】【Linux】Java线上问题，一分钟日志定位。"
keywords: "【Linux】Java线上问题，一分钟日志定位"
categories: ['未分类']
tags: ['运维', 'Linux', 'Java']
artid: "150720333"
arturl: "https://blog.csdn.net/Blue_Pepsi_Cola/article/details/150720333"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=150720333
    alt: "LinuxJava线上问题,一分钟日志定位"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=150720333
featuredImagePreview: https://bing.ee123.net/img/rand?artid=150720333
cover: https://bing.ee123.net/img/rand?artid=150720333
image: https://bing.ee123.net/img/rand?artid=150720333
img: https://bing.ee123.net/img/rand?artid=150720333
---



# 【Linux】Java线上问题，一分钟日志定位



## 1. 查看异常堆栈

```bash
# 在 a.log 文件中查找包含 NullPointerException 的行，并显示该行以及其后的 50 行，然后通过分页工具 less 逐页查看结果。
grep -n -A 50 "NullPointerException" a.log | less

```

```bash
[root@iv-ye20h65dz45i3z346rvs ~]# grep -n -A 50 "Exception" log.out | less 

```

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/5818a2ca3dc34e5db6c701b1289ef285.png)

## 2. 实时叮新日志

**应用到的场景：应用在跑随时可能抛异常**

```bash
tail -f log.out | grep -n -A 50 "Exception" 

```

1️⃣ tail -f log.out

* tail：查看文件的结尾部分。
* `-f`：表示 follow，即“跟随”文件内容的变化。
* 当 log.out 文件新增内容时，会实时输出新增内容到终端。

2️⃣ | grep -n -A 50 “Exception”

* |：管道，把 tail -f 输出的内容传给 grep。

grep -n -A 50 “Exception”：

* -n：显示匹配行的行号。
* -A 50：显示匹配行之后的 50 行内容。
* “Exception”：匹配的关键字。

## 3. 翻历史/压缩日志

**老日志切分打包，照样可以查**

```bash
[root@iv-ye20h65dz45i3z346rvs ~]# grep -n -H -A 50 "Exception" log.out

```

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/0d0bcb0eaa4c4e1fb61ebe62b8aea68b.png)

* -n：显示匹配行的 行号。
* -H：显示匹配行的 文件名。 **在只搜索一个文件时效果不明显，但如果同时搜索多个文件，会显示是哪一个文件匹配的。**
* -A 50：显示匹配行 之后的 50 行 内容。
* “Exception”：要搜索的关键字。
* log.out：要搜索的文件。

---

```bash
zgrep -n -H -A 50 "Exception" log.out.gz

```

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/7a0cbaf533c84c58bc2ff03da7bde91e.png)

## 4. 统计异常数量

**统计异常数量用于区分是偶发还是高频错误**

```bash
grep -c "Exception" log.out


[root@iv-ye20h65dz45i3z346rvs ~]# grep -c "Exception" log.out
6

```

## 5. 多种异常一起查

```bash
[root@iv-ye20h65dz45i3z346rvs ~]# grep -n -A 50 -E "NullPointerException|JSONException" log.out

```

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/f350c6b2bef54c12b3d7bd3967338c06.png)

## 6. 反向过滤

```bash
grep -n -A 20 "JSONException" log.out | grep -v "ERROR"

```

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/226a1618bd09481f90eb1fa42ee69c90.png)

* 从 log.out 中找到所有包含 JSONException 的行及其后 20 行。
* 过滤掉其中包含 “ERROR” 的行。
* 输出剩余行，带行号。

## 7. 同时满足多个关键字查询

```bash
[root@iv-ye20h65dz45i3z346rvs ~]# grep "Exception" log.out | grep "JSONException"
cn.hutool.json.JSONException: Unclosed tag html at 265 [character 162 line 6]
cn.hutool.json.JSONException: Unclosed tag html at 265 [character 162 line 6]
cn.hutool.json.JSONException: Unclosed tag html at 265 [character 162 line 6]
cn.hutool.json.JSONException: Unclosed tag html at 265 [character 162 line 6]
cn.hutool.json.JSONException: Unclosed tag html at 265 [character 162 line 6]
cn.hutool.json.JSONException: Unclosed tag html at 265 [character 162 line 6]

```

## 8. 定位最近一次异常

```bash
[root@iv-ye20h65dz45i3z346rvs ~]# tac log.out | grep -m 1 "Exception" -A 20
cn.hutool.json.JSONException: Unclosed tag html at 265 [character 162 line 6]
2025-08-19 11:18:31.448 [Thread-5] ERROR c.a.i.k.g.r.e.ExtractRpcImpl - 关系抽取请求异常，modelName:通用关系及属性抽取模型,requestBody:{"contents":[{"code":"1bf670f4aa39455c916ae2ed20d8b08a","text":"那孩子是张兴旺和刘巧云生的"}]}
2025-08-19 11:18:31.445 [Thread-5] INFO  c.a.i.k.g.r.e.ExtractRpcImpl - 关系抽取请求,taskCode:5aa931fc89e7404e85e675e8dde68d53 code:1455627b16fe4643a0aaa067a7af947e modelName:通用关系及属性抽取模型 请求地址：http://10.208.61.198:38128/api/v2/re/get_relation/batch requestBody:{"contents":[{"code":"1bf670f4aa39455c916ae2ed20d8b08a","text":"那孩子是张兴旺和刘巧云生的"}]}
Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4d88f6c6]
<==    Updates: 1
==> Parameters: 1455627b16fe4643a0aaa067a7af947e(String), 5aa931fc89e7404e85e675e8dde68d53(String), 1(Integer), 32(Integer), 2600032(Integer), null
==>  Preparing: INSERT INTO data_import_status ( task_code, history_code, status, sum_size, done_size, create_time ) VALUES ( ?, ?, ?, ?, ?, ? )
JDBC Connection [com.alibaba.druid.pool.DruidStatementConnection@251360d8] will not be managed by Spring
SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4d88f6c6] was not registered for synchronization because synchronization is not active
Creating a new SqlSession
        at java.lang.Thread.run(Thread.java:748)
        at cn.ac.ict.knowledge.graph.service.extract.ExtractTaskServiceImpl.lambda$syncExecuteTask$21(ExtractTaskServiceImpl.java:1062)
        at cn.ac.ict.knowledge.graph.service.extract.ExtractTaskServiceImpl.executeTask(ExtractTaskServiceImpl.java:996)
        at cn.ac.ict.knowledge.graph.service.extract.ExtractTaskComponent.relationExtract(ExtractTaskComponent.java:289)
        at cn.ac.ict.knowledge.graph.service.extract.ExtractTaskComponent.extractRelationAndMysql(ExtractTaskComponent.java:610)
        at cn.ac.ict.knowledge.graph.rpc.extract.ExtractRpcImpl.extractRelation(ExtractRpcImpl.java:77)
        at cn.hutool.json.JSONUtil.toBean(JSONUtil.java:461)
        at cn.hutool.json.JSONUtil.toBean(JSONUtil.java:475)
        at cn.hutool.json.JSONUtil.parse(JSONUtil.java:227)
        at cn.hutool.json.JSONUtil.parseObj(JSONUtil.java:112)
        at cn.hutool.json.JSONObject.<init>(JSONObject.java:187)

```

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/18b139d72b4a4bb6b56eab4af82ba4a0.png)

---

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/6122d6484518423eaecc708def144f91.png)

## 9. 异常排行榜

```bash
 grep "Exception" log.out | sort | uniq -c | sort -nr | head

```

* 找出日志中所有包含 “Exception” 的行。
* 按行内容统计每种异常出现的次数。
* 按出现次数从高到低排序。
* 显示出现次数最多的前 10 条异常记录。

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/5dd138ff965e41e8ad03005fddaf4248.png)  
 ![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/3d8efbe62afd4fe78686d0be8b2f68f0.png)  
 ![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/2ab0ef62545b471e9fdc8e0c1d19fbd4.png)  
 ![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/2e2aae05c9c14d2b90e17d7275d32011.png)  
 ![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/9161311e23ad45dfb2ceebebe601bfc2.png)



