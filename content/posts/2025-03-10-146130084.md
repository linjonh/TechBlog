---
layout: post
title: "Pandas教程数据分析利器-从入门到精通"
date: 2025-03-10 08:00:00 +0800
description: "Series（一维数据）DataFrame（二维数据）# 创建Seriesprint(s)# 创建DataFrame'姓名': ['张三', '李四', '王五'],'年龄': [25, 28, 22],'城市': ['北京', '上海', '广州']})print(df)强大的数据处理能力灵活的数据结构高效的数据分析工具丰富的数据导入/导出功能与其他数据科学工具良好的集成熟练掌握基础操作善用链式操作提高代码可读性注意内存使用效率。"
keywords: "pandas试用"
categories: ['未分类']
tags: ['数据挖掘', '数据分析', 'Pandas']
artid: "146130084"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146130084
    alt: "Pandas教程数据分析利器-从入门到精通"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146130084
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146130084
cover: https://bing.ee123.net/img/rand?artid=146130084
image: https://bing.ee123.net/img/rand?artid=146130084
img: https://bing.ee123.net/img/rand?artid=146130084
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Pandas教程：数据分析利器 - 从入门到精通
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-tomorrow-night" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <blockquote>
     <p>
      Pandas是Python中最强大的数据分析工具之一，它提供了高性能、易用的数据结构和数据分析工具。本教程将全面介绍Pandas的核心功能和实际应用。
     </p>
    </blockquote>
    <h3>
     <a id="Pandas_3">
     </a>
     一、Pandas基础
    </h3>
    <h4>
     <a id="11__5">
     </a>
     1.1 数据结构简介
    </h4>
    <p>
     Pandas主要有两种数据结构：
    </p>
    <ul>
     <li>
      Series（一维数据）
     </li>
     <li>
      DataFrame（二维数据）
     </li>
    </ul>
    <pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token comment"># 创建Series</span>
s <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>

<span class="token comment"># 创建DataFrame</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token string">'姓名'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">,</span> <span class="token string">'王五'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'年龄'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'城市'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'北京'</span><span class="token punctuation">,</span> <span class="token string">'上海'</span><span class="token punctuation">,</span> <span class="token string">'广州'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre>
    <h4>
     <a id="12__28">
     </a>
     1.2 数据导入与导出
    </h4>
    <pre><code class="prism language-python"><span class="token comment"># 读取CSV文件</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'data.csv'</span><span class="token punctuation">)</span>

<span class="token comment"># 读取Excel文件</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">'data.xlsx'</span><span class="token punctuation">)</span>

<span class="token comment"># 保存为CSV</span>
df<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'output.csv'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token comment"># 保存为Excel</span>
df<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span><span class="token string">'output.xlsx'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre>
    <h3>
     <a id="_44">
     </a>
     二、数据操作基础
    </h3>
    <h4>
     <a id="21__46">
     </a>
     2.1 查看数据
    </h4>
    <pre><code class="prism language-python"><span class="token comment"># 查看前几行数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 查看基本信息</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 查看统计摘要</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 查看数据维度</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
</code></pre>
    <h4>
     <a id="22__62">
     </a>
     2.2 数据选择和过滤
    </h4>
    <pre><code class="prism language-python"><span class="token comment"># 选择列</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'姓名'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'姓名'</span><span class="token punctuation">,</span> <span class="token string">'年龄'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 条件过滤</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'年龄'</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># loc和iloc选择器</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 基于标签</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 基于位置</span>
</code></pre>
    <h3>
     <a id="_77">
     </a>
     三、数据清洗和预处理
    </h3>
    <h4>
     <a id="31__79">
     </a>
     3.1 处理缺失值
    </h4>
    <pre><code class="prism language-python"><span class="token comment"># 检查缺失值</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 填充缺失值</span>
df<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># 用0填充</span>
df<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>method<span class="token operator">=</span><span class="token string">'ffill'</span><span class="token punctuation">)</span>  <span class="token comment"># 用前一个值填充</span>
df<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>method<span class="token operator">=</span><span class="token string">'bfill'</span><span class="token punctuation">)</span>  <span class="token comment"># 用后一个值填充</span>

<span class="token comment"># 删除缺失值</span>
df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <h4>
     <a id="32__94">
     </a>
     3.2 数据转换
    </h4>
    <pre><code class="prism language-python"><span class="token comment"># 类型转换</span>
df<span class="token punctuation">[</span><span class="token string">'年龄'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'年龄'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'int64'</span><span class="token punctuation">)</span>

<span class="token comment"># 重命名列</span>
df <span class="token operator">=</span> df<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'姓名'</span><span class="token punctuation">:</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'年龄'</span><span class="token punctuation">:</span> <span class="token string">'age'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment"># 替换值</span>
df<span class="token punctuation">[</span><span class="token string">'城市'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'城市'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'北京'</span><span class="token punctuation">,</span> <span class="token string">'Beijing'</span><span class="token punctuation">)</span>
</code></pre>
    <h3>
     <a id="_107">
     </a>
     四、数据分析和聚合
    </h3>
    <h4>
     <a id="41__109">
     </a>
     4.1 分组操作
    </h4>
    <pre><code class="prism language-python"><span class="token comment"># 按城市分组并计算平均年龄</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'城市'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'年龄'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 多个聚合操作</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'城市'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token string">'年龄'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'mean'</span><span class="token punctuation">,</span> <span class="token string">'max'</span><span class="token punctuation">,</span> <span class="token string">'min'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'姓名'</span><span class="token punctuation">:</span> <span class="token string">'count'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
    <h4>
     <a id="42__122">
     </a>
     4.2 排序
    </h4>
    <pre><code class="prism language-python"><span class="token comment"># 按年龄排序</span>
df_sorted <span class="token operator">=</span> df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token string">'年龄'</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token comment"># 多列排序</span>
df_sorted <span class="token operator">=</span> df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'城市'</span><span class="token punctuation">,</span> <span class="token string">'年龄'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token punctuation">[</span><span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre>
    <h3>
     <a id="_132">
     </a>
     五、高级操作
    </h3>
    <h4>
     <a id="51__134">
     </a>
     5.1 合并数据
    </h4>
    <pre><code class="prism language-python"><span class="token comment"># 合并两个DataFrame</span>
df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token string">'编号'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'A1'</span><span class="token punctuation">,</span> <span class="token string">'A2'</span><span class="token punctuation">,</span> <span class="token string">'A3'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'姓名'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">,</span> <span class="token string">'王五'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token string">'编号'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'A1'</span><span class="token punctuation">,</span> <span class="token string">'A2'</span><span class="token punctuation">,</span> <span class="token string">'A4'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'成绩'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment"># 内连接</span>
merged <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df1<span class="token punctuation">,</span> df2<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">'编号'</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'inner'</span><span class="token punctuation">)</span>

<span class="token comment"># 外连接</span>
merged <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df1<span class="token punctuation">,</span> df2<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">'编号'</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'outer'</span><span class="token punctuation">)</span>
</code></pre>
    <h4>
     <a id="52__155">
     </a>
     5.2 数据透视表
    </h4>
    <pre><code class="prism language-python"><span class="token comment"># 创建透视表</span>
pivot_table <span class="token operator">=</span> pd<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>df<span class="token punctuation">,</span>
                            values<span class="token operator">=</span><span class="token string">'年龄'</span><span class="token punctuation">,</span>
                            index<span class="token operator">=</span><span class="token string">'城市'</span><span class="token punctuation">,</span>
                            columns<span class="token operator">=</span><span class="token string">'性别'</span><span class="token punctuation">,</span>
                            aggfunc<span class="token operator">=</span><span class="token string">'mean'</span><span class="token punctuation">)</span>
</code></pre>
    <h4>
     <a id="53__166">
     </a>
     5.3 时间序列
    </h4>
    <pre><code class="prism language-python"><span class="token comment"># 创建日期范围</span>
dates <span class="token operator">=</span> pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span><span class="token string">'20230101'</span><span class="token punctuation">,</span> periods<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">)</span>

<span class="token comment"># 时间序列数据</span>
ts <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span>dates<span class="token punctuation">)</span>

<span class="token comment"># 重采样</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ts<span class="token punctuation">.</span>resample<span class="token punctuation">(</span><span class="token string">'M'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 按月重采样</span>
</code></pre>
    <h3>
     <a id="_179">
     </a>
     六、实用技巧
    </h3>
    <h4>
     <a id="61__181">
     </a>
     6.1 数据可视化
    </h4>
    <pre><code class="prism language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token comment"># 绘制折线图</span>
df<span class="token punctuation">[</span><span class="token string">'年龄'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">'line'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 绘制柱状图</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'城市'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'年龄'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">'bar'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <h4>
     <a id="62__195">
     </a>
     6.2 性能优化
    </h4>
    <pre><code class="prism language-python"><span class="token comment"># 使用适当的数据类型</span>
df<span class="token punctuation">[</span><span class="token string">'年龄'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'年龄'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'int32'</span><span class="token punctuation">)</span>  <span class="token comment"># 降低内存使用</span>

<span class="token comment"># 使用query进行高效过滤</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">'年龄 &gt; 25 and 城市 == "北京"'</span><span class="token punctuation">)</span>
</code></pre>
    <h3>
     <a id="_205">
     </a>
     总结
    </h3>
    <p>
     Pandas的主要优势：
    </p>
    <ul>
     <li>
      强大的数据处理能力
     </li>
     <li>
      灵活的数据结构
     </li>
     <li>
      高效的数据分析工具
     </li>
     <li>
      丰富的数据导入/导出功能
     </li>
     <li>
      与其他数据科学工具良好的集成
     </li>
    </ul>
    <p>
     使用建议：
    </p>
    <ul>
     <li>
      熟练掌握基础操作
     </li>
     <li>
      善用链式操作提高代码可读性
     </li>
     <li>
      注意内存使用效率
     </li>
     <li>
      充分利用Pandas的向量化操作
     </li>
     <li>
      经常查阅官方文档获取最新特性
     </li>
    </ul>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="6874747073:3a2f2f626c6f672e6373646e2e6e65742f687a65746865722f:61727469636c652f64657461696c732f313436313330303834" class_="artid" style="display:none">
 </p>
</div>


