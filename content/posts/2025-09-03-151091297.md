---
layout: post
title: "如何利用SMSRDS把服务从阿里云迁移到华为云"
date: 2025-09-03T10:18:18+0800
description: "本文介绍了主机迁移服务(SMS)和数据复制服务(DRS)的核心功能与应用场景。SMS支持整机迁移，包括操作系统、应用和数据，适用于企业上云和硬件更新；而DRS专注于数据库迁移与同步，支持多种数据库类型，适用于数据库上云和灾备。文章详细对比了两者的差异，并以WordPress迁移为例，展示了SMS迁移的具体步骤：从环境准备、Agent安装到创建迁移任务。同时介绍了DRS数据库迁移流程，包括创建数据库、配置迁移任务及解决预检测问题。最后讲解了修改配置信息并验证迁移结果的步骤。"
keywords: "如何利用SMS、RDS把服务从阿里云迁移到华为云"
categories: ['华为云']
tags: ['网络', '华为云', 'Sms', 'Rds', 'Eip', 'Ecs', 'Drs']
artid: "151091297"
arturl: "https://blog.csdn.net/FHY26828/article/details/151091297"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=151091297
    alt: "如何利用SMSRDS把服务从阿里云迁移到华为云"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=151091297
featuredImagePreview: https://bing.ee123.net/img/rand?artid=151091297
cover: https://bing.ee123.net/img/rand?artid=151091297
image: https://bing.ee123.net/img/rand?artid=151091297
img: https://bing.ee123.net/img/rand?artid=151091297
---



# 如何利用SMS、RDS把服务从阿里云迁移到华为云



---

上一期我们搭建好了wordpress，将用于本实验

## 1.相关工具介绍

### 1.1 什么是主机迁移服务 SMS

主机迁移服务（**Server Migration Service, SMS**）是一种云服务，主要用于 **将本地数据中心、虚拟机或其他云上的服务器完整迁移到目标云平台**。

#### 1.1.1 核心功能

**1.整机迁移**：

* 包括操作系统、应用程序、系统配置、业务数据。
* 不用重新安装系统或软件，直接把整台主机“搬到云上”。

**2.在线迁移**：

* 支持在业务不停机的情况下进行数据同步。
* 最后切换业务时才需短暂停机，降低业务中断风险。

**3.多源环境支持**：

* 物理机、虚拟机（VMware、Hyper-V、KVM 等）、以及其他云厂商的云主机。

**4.自动化迁移**：

* 源端只需要安装一个 **迁移 Agent**，数据会自动压缩、传输、校验。

**5.一致性保障**：

* 确保迁移后的云服务器和源服务器保持完全一致。

#### 1.1.2 应用场景

* **企业上云**：将传统 IDC 机房服务器迁移到云端。
* **跨云迁移**：从一个云厂商的主机迁移到另一个云平台。
* **硬件更新**：替换老旧服务器，把业务迁到云服务器。

#### 1.1.3 总结

**SMS 就像“整体搬家服务”**，把你整个服务器（系统 + 应用 + 数据）完整复制到云上，而不是单独迁数据库或文件。

### 1.2 什么是 DRS

**DRS（Data Replication Service，数据复制服务）** 是一种云上迁移/同步服务，专门用于 **数据库或数据之间的迁移、同步和灾备**。  
 它和 SMS 不同，DRS **只管数据库层面的数据**，不会迁操作系统或应用。

#### 1.2.1 核心功能

**1.数据库迁移**

* 把本地 IDC、其他云、或不同版本的数据库 **迁到云数据库**。
* 支持全量迁移（一次性把所有数据搬过去）+ 增量迁移（实时同步新写入的数据）。

**2.数据同步**

* 实现两个数据库之间的 **实时同步**。
* 常用于多活架构、异地容灾、数据共享等场景。

**3.灾备复制**

* 将主数据库的数据实时复制到备用数据库，作为灾备。
* 主库出问题时，业务能切换到备库。

#### 1.2.2 支持的数据库类型

* **关系型数据库**：MySQL、PostgreSQL、Oracle、SQL Server 等。
* **NoSQL**：MongoDB 等。
* **跨云/跨版本迁移**：比如本地 MySQL 5.7 → 云上 MySQL 8.0。

#### 1.2.3 应用场景

* **数据库上云**：企业把本地的 MySQL/Oracle 等数据库迁到云上。
* **异地容灾**：实时复制数据到另一个地区，防止单点故障。
* **跨库同步**：实现多套数据库之间的数据实时共享。
* **平滑升级**：数据库版本升级时，通过同步减少停机时间。

#### 1.2.4 总结

**DRS = 数据库层面的迁移/同步/容灾服务**，帮助你安全、实时、低中断地把数据库数据搬到云上或者保持多地一致。

要不要我帮你做一个 **SMS vs DRS 的对比表格**，让你一眼看清两者的区别和适用场景？

### 1.3 SMS 与 DRS 对比

| 对比项 | **SMS（主机迁移服务）** | **DRS（数据复制服务）** |
| --- | --- | --- |
| **迁移对象** | 整台服务器（OS + 应用 + 配置 + 数据） | 数据库（库、表、索引、存储数据） |
| **适用场景** | 服务器上云、跨云迁移、旧硬件替换 | 数据库上云、版本升级、异地容灾、实时同步 |
| **迁移粒度** | 粗粒度（整机） | 细粒度（仅数据库） |
| **源端要求** | 需在源服务器安装迁移 Agent，可出网 | 源端数据库能联网，提供账号和权限 |
| **停机影响** | 支持在线迁移，切换时短暂停机 | 支持全量 + 增量迁移，可实现无缝切换 |
| **支持对象** | 物理机、虚拟机、其他云主机 | MySQL、PostgreSQL、Oracle、SQL Server、MongoDB 等 |
| **传输方式** | 块级数据复制（整个磁盘/系统） | 逻辑级/日志级复制（数据库事务/表记录） |
| **典型比喻** | 整栋房子整体搬家 | 只搬文件柜里的档案 |

---

总结：

* **要整体搬机器 → 用 SMS**
* **只要搬数据库 → 用 DRS**

## **2.SMS迁移**

### 2.1 迁移前准备工作

#### 2.1.1 迁移环境介绍

1.本实验基于前一章节的wordpress搭建:[阿里云创建自己的博客，部署wordpress-CSDN博客](https://blog.csdn.net/FHY26828/article/details/151002312?spm=1011.2415.3001.5331 "阿里云创建自己的博客，部署wordpress-CSDN博客")

2.架构图

![](https://i-blog.csdnimg.cn/direct/73129622875f4e2c949a92191fdad27a.png)

#### 2.1.2 ak/sk创建

1.已经注册并开通华为云账号

2.生成ak/sk

a、进入控制台

![](https://i-blog.csdnimg.cn/direct/91983e8d8f5846b088b5ca15f4b15688.png)

![](https://i-blog.csdnimg.cn/direct/dedae0fe5ffa4799a18e07e1893390bf.png)

c、生成ak/sk

![](https://i-blog.csdnimg.cn/direct/3f2116fb47934a0db8375a7117e40fee.png)

![](https://i-blog.csdnimg.cn/direct/e6f61d82c5264943a1cf44ac4f0e3e16.png)

下载后记得保存好秘钥  
   
 d、下载rsync

```
yum -y install rsync
```

#### 2.1.3 创建VPC和安全组配置

1.创建vpc-web

* subnet-web：192.168.1.0/24
* subnet-web：192.168.16.0/24

![](https://i-blog.csdnimg.cn/direct/b2f9746e04014fe09e6fc175c7663594.png)

2.创建安全组

* sg-web：放行22和8900端口，最后访问记得放开80
* sg-db：放行3310

![](https://i-blog.csdnimg.cn/direct/9e6bb972dd0d4c7aab643f52ea654d36.png)![](https://i-blog.csdnimg.cn/direct/befa2d9f476747f7813126fffa4b2695.png)

### 2.2 进入主机迁移服务SMS

#### 2.2.1 下载迁移agent并启动

1.复制下载agent

![](https://i-blog.csdnimg.cn/direct/7c76564118aa413389e7d984a4111665.png)

2.下载sha256校验码

![](https://i-blog.csdnimg.cn/direct/7b965b336f1e44b592c812e2749027fb.png)

3.启动agent

```
tar -zxvf SMS-Agent.tar.gz && cd SMS-Agent && ./startup.sh 
```

4.填写ak/sk![](https://i-blog.csdnimg.cn/direct/bac76824e9d6443e8b0ec3aad45a2a2e.png)

![](https://i-blog.csdnimg.cn/direct/18494d6a2ea345f3a8474ff81e0d2c47.png)![](https://i-blog.csdnimg.cn/direct/a5aea219b1aa40d0b6e061c205f260d4.png)

#### 2.2.2 创建ECS

（可以迁移配置中再创建）

![](https://i-blog.csdnimg.cn/direct/feb3abc81dcd40cbaec63a78b73492d5.png)

> **基础配置**
>
> 计费模式: 按需计费
>
> 区域/可用区: 西南-贵阳一 | 随机分配
>
> 实例
>
> 规格: 通用计算型 | x1.2u.2g | 2vCPUs | 2GiB
>
> 操作系统
>
> 镜像: CentOS 7.9 64bit
>
> 主机安全: 已开启基础防护
>
> 免费一个月
>
> 存储与备份
>
> 系统盘: 高IO, 40GiB
>
> 网络
>
> 虚拟私有云: vpc-web(192.168.0.0/16)
>
> 主网卡: subnet-web(192.168.1.0/24)
>
> 源/目的检查: 开启
>
> 安全组
>
> sg-web
>
> 公网访问
>
> 弹性公网IP: 静态BGP | 按流量计费 | 10 Mbit/s | 随实例释放
>
> 云服务器管理
>
> 云服务器名称: ecs-dest
>
> 登录凭证: 密码
>
> 标签: --
>
> 高级配置
>
> 云监控: 已开启详细监控
>
> 免费
>
> 购买量
>
> 定时删除时间: --
>
> 购买数量: 1

![](https://i-blog.csdnimg.cn/direct/239aba55b9aa42ba8a5fa3e175ebdc32.png)![](https://i-blog.csdnimg.cn/direct/85ee7429467a436ea912bea1df18dbb7.png)![](https://i-blog.csdnimg.cn/direct/55b751c6db86401da5953fb3fe4fea3c.png)![](https://i-blog.csdnimg.cn/direct/f5bd2b8d819e484883057b01d234bd6a.png)![](https://i-blog.csdnimg.cn/direct/b87d00c4e5904275896c75f5ebf87c3e.png)![](https://i-blog.csdnimg.cn/direct/19428a1db737400cbeb23d32f05d8912.png)![](https://i-blog.csdnimg.cn/direct/b9f8f4f9a69c44e194bb3c2756f3ff39.png)![](https://i-blog.csdnimg.cn/direct/b30693325a9d4eb9a07761ebb77f841d.png)

#### 2.2.3 配置迁移任务

1.设置目的端

![](https://i-blog.csdnimg.cn/direct/69f5cc38c1e24a4cac55a3646ba3896c.png)

2.迁移配置  
 ![](https://i-blog.csdnimg.cn/direct/804ff193bde24f6898e2ca019f9a43bc.png)![](https://i-blog.csdnimg.cn/direct/748be50c2ef04533bb5a82befd176418.png)![](https://i-blog.csdnimg.cn/direct/19567a8d9c034114bec8b3c9f5d779da.png)![](https://i-blog.csdnimg.cn/direct/faba1fed5e1f4973adee29765dbccfef.png)

3.查看迁移进度

![](https://i-blog.csdnimg.cn/direct/a785da06d98144ad9eb27277324ded0a.png)![](https://i-blog.csdnimg.cn/direct/9941162a3d944a0798c6dc1b374c8721.png)

4.迁移完成

![](https://i-blog.csdnimg.cn/direct/e417396f1ad94e09bb0312247142b6f1.png)

### 2.3 DRS数据库迁移

#### 2.3.1 创建数据库

![](https://i-blog.csdnimg.cn/direct/8ee1d47b599b4d7b80c722dc525ad923.png)![](https://i-blog.csdnimg.cn/direct/c03881191c3a4a139de5201efd480ffd.png)![](https://i-blog.csdnimg.cn/direct/e5b3c541b51543b8aaea699589f6126e.png)![](https://i-blog.csdnimg.cn/direct/9d474b4a32e4488089f9337e64012985.png)![](https://i-blog.csdnimg.cn/direct/869227d2ba744e8a99a61668e52f1e0a.png)

#### 2.3.2 创建DRS任务

1.创建迁移实例

![](https://i-blog.csdnimg.cn/direct/59ca3849e2634f66b8f66ef545d819b2.png)

![](https://i-blog.csdnimg.cn/direct/6cfa6b69d68f4462afee633b984fecf6.png)![](https://i-blog.csdnimg.cn/direct/58b953e088f341129e9c512ad8e85fa7.png)![](https://i-blog.csdnimg.cn/direct/55dffaab535a4e8fb87910ef1e4a7d54.png)

2.源库及目标库

![](https://i-blog.csdnimg.cn/direct/4aef21c99ab941ff819a9fdee5511f84.png)![](https://i-blog.csdnimg.cn/direct/f8419e7af16448969570bcfa662a7563.png)

3.迁移任务

确认所有备注，确认全部待确认

![](https://i-blog.csdnimg.cn/direct/4a625e4550a84337a37febcc8859111c.png)

4.预检测

![](https://i-blog.csdnimg.cn/direct/243a4c53d1f04463a1b4a3cd6c59e48f.png)

我们可以看到诸多问题，根据上面提示解决就行

![](https://i-blog.csdnimg.cn/direct/354729d66c3542e794d799ad95994dff.png)![](https://i-blog.csdnimg.cn/direct/361b16ffb45c49ec82338be921336fcc.png)

处理完后记得重启数据库，重新检测

![](https://i-blog.csdnimg.cn/direct/02b481816d60463380815feaf0a826f2.png)  
 5.参数对比

勾选并一键修改  
 ![](https://i-blog.csdnimg.cn/direct/9b26269289d74071a282cafe63f3190a.png)

6.创建迁移

![](https://i-blog.csdnimg.cn/direct/5f9fc705e1974456b8b3f70b8247a3a6.png)

2.3.3 启动任务并等待迁移完成

1.启动

![](https://i-blog.csdnimg.cn/direct/61ad619c2bd34d009ab46a8b8d3c43fd.png)![](https://i-blog.csdnimg.cn/direct/b3b6d78ee9d8468298861d5e3aea437d.png)

2.迁移完成

### 2.4 修改配置信息并访问

1.修改配置信息

```
vim /usr/share/nginx/html/wp-config.php
```

![](https://i-blog.csdnimg.cn/direct/a01c960616454ef2825d4cf1024b651d.png)  
   
 2.输入华为云主机公网IP

![](https://i-blog.csdnimg.cn/direct/765c7a581e39407b8be0e6b07835aab3.png)  
 3.登录源端发布文章并在目的端查看  
 ![](https://i-blog.csdnimg.cn/direct/ce1c5ec4630a42dea5f9248b0ac757d3.png)

启动目的端  
 ![](https://i-blog.csdnimg.cn/direct/d8f81540a7ba4be7a4427cf412193c5d.png)

登录查看

![](https://i-blog.csdnimg.cn/direct/4e49f30a1a4c49a690e3a7c1180b4298.png)



