---
layout: post
title: "doris阿里云-MaxCompute"
date: 2025-03-10 10:40:34 +0800
description: "doris：阿里云 MaxCompute"
keywords: "doris：阿里云 MaxCompute"
categories: ['大数据']
tags: ['Doris']
artid: "146146986"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146146986
    alt: "doris阿里云-MaxCompute"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146146986
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146146986
cover: https://bing.ee123.net/img/rand?artid=146146986
image: https://bing.ee123.net/img/rand?artid=146146986
img: https://bing.ee123.net/img/rand?artid=146146986
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     doris：阿里云 MaxCompute
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     MaxCompute 是阿里云上的企业级 SaaS（Software as a Service）模式云数据仓库。
    </p>
    <blockquote>
     <p>
      <a href="https://help.aliyun.com/zh/MaxCompute/product-overview/what-is-MaxCompute" rel="nofollow" title="什么是 MaxCompute">
       什么是 MaxCompute
      </a>
     </p>
    </blockquote>
    <h3 id="连接-maxcompute">
     连接 MaxCompute
     <a href="https://doris.apache.org/zh-CN/docs/lakehouse/database/max-compute#%E8%BF%9E%E6%8E%A5-maxcompute" rel="nofollow" title="​">
      ​
     </a>
    </h3>
    <h4 id="示例">
     示例
     <a href="https://doris.apache.org/zh-CN/docs/lakehouse/database/max-compute#%E7%A4%BA%E4%BE%8B" rel="nofollow" title="​">
      ​
     </a>
    </h4>
    <pre><code>-- 1. 创建Catalog。
CREATE CATALOG mc PROPERTIES (
  "type" = "max_compute",
  "mc.default.project" = "xxx",
  "mc.access_key" = "xxxx",
  "mc.secret_key" = "xxx",
  "mc.endpoint" = "http://service.cn-beijing-vpc.MaxCompute.aliyun-inc.com/api"
);

-- 2. 切换到新创建的Catalog下。
SWITCH mc;

-- 下面的步骤就和使用Mysql一样了。

-- 3. 查看该Catalog下所有的数据库。
SHOW DATABASES;

-- 4. 使用数据库, 这里的xxx为第三步展示出来结果的任意一个数据库。
USE xxx;

-- 5. 查看该数据库下所有的表。
SHOW TABLES;

-- 6. 进行SQL查询。
select * from tb  limit 10;
</code></pre>
    <p>
    </p>
    <h4 id="创建-catalog-的基本属性">
     创建 Catalog 的基本属性
     <a href="https://doris.apache.org/zh-CN/docs/lakehouse/database/max-compute#%E5%88%9B%E5%BB%BA-catalog-%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%B1%9E%E6%80%A7" rel="nofollow" title="​">
      ​
     </a>
    </h4>
    <table>
     <thead>
      <tr>
       <th>
        参数
       </th>
       <th>
        说明
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        type
       </td>
       <td>
        固定为
        <code>
         max_compute
        </code>
        .
       </td>
      </tr>
      <tr>
       <td>
        mc.default.project
       </td>
       <td>
        想要访问的 MaxCompute 项目名称。可以在
        <a href="https://maxcompute.console.aliyun.com/cn-beijing/project-list" rel="nofollow" title="MaxCompute 项目列表">
         MaxCompute 项目列表
        </a>
        中创建和管理。
       </td>
      </tr>
      <tr>
       <td>
        mc.access_key
       </td>
       <td>
        AccessKey。可以在
        <a href="https://ram.console.aliyun.com/manage/ak" rel="nofollow" title="阿里云控制台">
         阿里云控制台
        </a>
        中创建和管理。
       </td>
      </tr>
      <tr>
       <td>
        mc.secret_key
       </td>
       <td>
        SecretKey。可以在
        <a href="https://ram.console.aliyun.com/manage/ak" rel="nofollow" title="阿里云控制台">
         阿里云控制台
        </a>
        中创建和管理。
       </td>
      </tr>
      <tr>
       <td>
        mc.endpoint
       </td>
       <td>
        MaxCompute 开通的地域。请参照下文的
        <code>
         如何获取Endpoint 和 Quota
        </code>
        来配置。
       </td>
      </tr>
     </tbody>
    </table>
    <h4 id="创建-catalog-的可选属性">
     创建 Catalog 的可选属性
     <a href="https://doris.apache.org/zh-CN/docs/lakehouse/database/max-compute#%E5%88%9B%E5%BB%BA-catalog-%E7%9A%84%E5%8F%AF%E9%80%89%E5%B1%9E%E6%80%A7" rel="nofollow" title="​">
      ​
     </a>
    </h4>
    <table>
     <thead>
      <tr>
       <th>
        参数
       </th>
       <th>
        默认值
       </th>
       <th>
        说明
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        mc.quota
       </td>
       <td>
        pay-as-you-go
       </td>
       <td>
        Quota 名称。请参照下文的
        <code>
         如何获取Endpoint 和 Quota
        </code>
        来配置。
       </td>
      </tr>
      <tr>
       <td>
        mc.split_strategy
       </td>
       <td>
        byte_size
       </td>
       <td>
        设置 split 的划分方式，可设置为按照字节大小划分
        <code>
         byte_size
        </code>
        和按照数据行数划分
        <code>
         row_count
        </code>
       </td>
      </tr>
      <tr>
       <td>
        mc.split_byte_size
       </td>
       <td>
        268435456
       </td>
       <td>
        每个 split 读取的文件大小，单位为字节，默认为 256MB，当且仅当
        <code>
         "mc.split_strategy" = "byte_size"
        </code>
        时生效
       </td>
      </tr>
      <tr>
       <td>
        mc.split_row_count
       </td>
       <td>
        1048576
       </td>
       <td>
        每个 split 读多少行，当且仅当
        <code>
         "mc.split_strategy" = "row_count"
        </code>
        时生效
       </td>
      </tr>
     </tbody>
    </table>
    <h3 id="列类型映射">
     列类型映射
     <a href="https://doris.apache.org/zh-CN/docs/lakehouse/database/max-compute#%E5%88%97%E7%B1%BB%E5%9E%8B%E6%98%A0%E5%B0%84" rel="nofollow" title="​">
      ​
     </a>
    </h3>
    <table>
     <thead>
      <tr>
       <th>
        MaxCompute
       </th>
       <th>
        Doris
       </th>
       <th>
        备注
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        TINYINT
       </td>
       <td>
        TINYINT
       </td>
       <td>
       </td>
      </tr>
      <tr>
       <td>
        TINYINT
       </td>
       <td>
        TINYINT
       </td>
       <td>
       </td>
      </tr>
      <tr>
       <td>
        SMALLINT
       </td>
       <td>
        SMALLINT
       </td>
       <td>
       </td>
      </tr>
      <tr>
       <td>
        INT
       </td>
       <td>
        INT
       </td>
       <td>
       </td>
      </tr>
      <tr>
       <td>
        BIGINT
       </td>
       <td>
        BIGINT
       </td>
       <td>
       </td>
      </tr>
      <tr>
       <td>
        BINARY
       </td>
       <td>
        不支持
       </td>
       <td>
       </td>
      </tr>
      <tr>
       <td>
        FLOAT
       </td>
       <td>
        FLOAT
       </td>
       <td>
       </td>
      </tr>
      <tr>
       <td>
        DOUBLE
       </td>
       <td>
        DOUBLE
       </td>
       <td>
       </td>
      </tr>
      <tr>
       <td>
        DECIMAL(precision,scale)
       </td>
       <td>
        DECIMAL(precision,scale)
       </td>
       <td>
       </td>
      </tr>
      <tr>
       <td>
        VARCHAR(n)
       </td>
       <td>
        VARCHAR(n)
       </td>
       <td>
       </td>
      </tr>
      <tr>
       <td>
        CHAR(n)
       </td>
       <td>
        CHAR(n)
       </td>
       <td>
       </td>
      </tr>
      <tr>
       <td>
        STRING
       </td>
       <td>
        STRING
       </td>
       <td>
       </td>
      </tr>
      <tr>
       <td>
        DATE
       </td>
       <td>
        DATE
       </td>
       <td>
       </td>
      </tr>
      <tr>
       <td>
        DATETIME
       </td>
       <td>
        DATETIME(3)
       </td>
       <td>
        可以通过
        <code>
         SET [global] time_zone = 'Asia/Shanghai'
        </code>
        来指定时区
       </td>
      </tr>
      <tr>
       <td>
        TIMESTAMP
       </td>
       <td>
        不支持
       </td>
       <td>
       </td>
      </tr>
      <tr>
       <td>
        TIMESTAMP_NTZ
       </td>
       <td>
        DATETIME(6)
       </td>
       <td>
        MaxCompute 的 TIMESTAMP_NTZ 精度为 9, Doris 的 DATETIME 最大精度只有 6，故读取数据时会将多的部分直接截断。
       </td>
      </tr>
      <tr>
       <td>
        BOOLEAN
       </td>
       <td>
        BOOLEAN
       </td>
       <td>
       </td>
      </tr>
      <tr>
       <td>
        ARRAY
       </td>
       <td>
        ARRAY
       </td>
       <td>
       </td>
      </tr>
      <tr>
       <td>
        MAP
       </td>
       <td>
        MAP
       </td>
       <td>
       </td>
      </tr>
      <tr>
       <td>
        STRUCT
       </td>
       <td>
        STRUCT
       </td>
       <td>
       </td>
      </tr>
      <tr>
       <td>
        JSON
       </td>
       <td>
        不支持
       </td>
       <td>
       </td>
      </tr>
     </tbody>
    </table>
    <h3 id="使用须知">
     使用须知
     <a href="https://doris.apache.org/zh-CN/docs/lakehouse/database/max-compute#%E4%BD%BF%E7%94%A8%E9%A1%BB%E7%9F%A5" rel="nofollow" title="​">
      ​
     </a>
    </h3>
    <ol>
     <li>
      自 2.1.7 版本开始，MaxCompute Catalog 基于
      <a href="https://help.aliyun.com/zh/maxcompute/user-guide/overview-1" rel="nofollow" title="开放存储 SDK">
       开放存储 SDK
      </a>
      开发。
     </li>
     <li>
      开放存储 SDK 的使用有一定的限制，请参照该
      <a href="https://help.aliyun.com/zh/maxcompute/user-guide/overview-1" rel="nofollow" title="文档">
       文档
      </a>
      中
      <code>
       使用限制
      </code>
      的章节。
     </li>
     <li>
      MaxCompute 中的 Project 相当于 Doris 中的 DataBase。
     </li>
    </ol>
    <h3 id="如何获取-endpoint-和-quota">
     如何获取 Endpoint 和 Quota
     <a href="https://doris.apache.org/zh-CN/docs/lakehouse/database/max-compute#%E5%A6%82%E4%BD%95%E8%8E%B7%E5%8F%96-endpoint-%E5%92%8C-quota" rel="nofollow" title="​">
      ​
     </a>
    </h3>
    <ol>
     <li>
      <p>
       如果您使用数据传输服务独享资源组，请参照该
       <a href="https://help.aliyun.com/zh/maxcompute/user-guide/purchase-and-use-exclusive-resource-groups-for-dts" rel="nofollow" title="文档">
        文档
       </a>
       中
       <code>
        使用独享数据服务资源组
       </code>
       章节中的
       <code>
        2.授权
       </code>
       来开启相应的权限，并在
       <code>
        配额（Quota）管理
       </code>
       列表中，查看并复制对应的 QuotaName，指定
       <code>
        "mc.quota" = "QuotaName"
       </code>
       。此时您可以选择 VPC / 公网来访问 MaxCompute，但是走 VPC 的带宽有保障，公网带宽资源小。
      </p>
     </li>
     <li>
      <p>
       如果您使用按量付费，请参照该
       <a href="https://help.aliyun.com/zh/maxcompute/user-guide/overview-1" rel="nofollow" title="文档">
        文档
       </a>
       中
       <code>
        使用开放存储（按量付费）
       </code>
       的章节，来开启开放存储 (Storage API) 开关，并给 Ak,SK 对应的用户赋予权限。此时您的
       <code>
        mc.quota
       </code>
       为默认值
       <code>
        pay-as-you-go
       </code>
       ，不需要额外指定该值。此时您只能使用 VPC 来访问 MaxCompute。
      </p>
     </li>
     <li>
      <p>
       通过第 1/2 步，您已经知道该如何访问 MaxCompute，下面需要根据
       <a href="https://help.aliyun.com/zh/maxcompute/user-guide/endpoints" rel="nofollow" title="阿里云 Endpoints 文档">
        阿里云 Endpoints 文档
       </a>
       中的
       <code>
        地域Endpoint对照表
       </code>
       来配置
       <code>
        mc.endpoint
       </code>
       。使用 VPC 访问的用户，需要根据
       <code>
        各地域Endpoint对照表（阿里云VPC网络连接方式）
       </code>
       表中的
       <code>
        VPC网络Endpoint
       </code>
       列来配置
       <code>
        mc.endpoint
       </code>
       。使用公网访问的用户，可以选择
       <code>
        各地域Endpoint对照表（阿里云经典网络连接方式）
       </code>
       表中的
       <code>
        经典网络Endpoint
       </code>
       列、或者选择
       <code>
        各地域Endpoint对照表（外网连接方式)
       </code>
       表中的
       <code>
        外网Endpoint
       </code>
       列来配置
       <code>
        mc.endpoint
       </code>
       。
      </p>
     </li>
    </ol>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f33363037303130342f:61727469636c652f64657461696c732f313436313436393836" class_="artid" style="display:none">
 </p>
</div>


