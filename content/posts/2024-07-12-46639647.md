---
layout: post
title: "HTML5游戏实战之70行代码实现经典游戏伐木工"
date: 2024-07-12 11:10:56 +0800
description: "伐木工游戏大家都玩过，今天介绍它在TangIDE上的实现方式，大概70行左右代码。这个版本的伐木工，"
keywords: "伐木小游戏代码"
categories: ['Studio', 'Hola']
tags: ['游戏开发', 'Tangram', 'Tangide', 'Html', 'Cantk']
artid: "46639647"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=46639647
    alt: "HTML5游戏实战之70行代码实现经典游戏伐木工"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=46639647
featuredImagePreview: https://bing.ee123.net/img/rand?artid=46639647
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     HTML5游戏实战之70行代码实现经典游戏《伐木工》
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     伐木工游戏大家都玩过，今天介绍它在TangIDE上的实现方式，大概70行左右代码。
    </p>
    <p>
     这个版本的伐木工，是为麦当劳定制的，放了一些麦当劳的一些产品。
    </p>
    <p>
     先show一下最终的成果，您可以
     <a href="http://www.tangide.com/apprun.html?appid=previewqqArmily-11435203333061" rel="nofollow">
      点这里
     </a>
     玩，或者手机扫描二维码：
     <br/>
     <img alt="这里写图片描述" src="https://img-blog.csdn.net/20150625151420980" title="">
      <br/>
      当然如果您想在线编辑此游戏，
      <a href="http://www.tangide.com/gamebuilder.php?appid=previewqqArmily-11435203333061" rel="nofollow">
       点这里
      </a>
      。
     </img>
    </p>
    <p>
     在开始介绍游戏开发步骤前，先打个广告，对html5游戏开发，
     <a href="www.tangide.com" rel="nofollow">
      TangIDE
     </a>
     或者
     <a href="https://github.com/drawapp8/cantk">
      Cantk
     </a>
     感兴趣的朋友请扫描下方二维码，加入七巧板官方QQ交流群，一起交流做html5游戏的乐趣，群主正是Cantk作者
     <a href="http://blog.csdn.net/absurd">
      李先静
     </a>
     老师。
     <br/>
     <img alt="这里写图片描述" src="https://img-blog.csdn.net/20150624190707926" title="">
      <br/>
      相信经过一段时间的训练，每天做1～2个小游戏没有任何问题。
     </img>
    </p>
    <p>
     现在开始介绍整个游戏的开发过程：
    </p>
    <h3 id="资源加载窗口">
     资源加载窗口
    </h3>
    <p>
     打开
     <a href="http://www.tangide.com" rel="nofollow">
      www.tangide.com
     </a>
     ，在左侧树形图中，可以看到有2个窗口（场景），一个是资源加载窗口，可以随意自定义资源加载窗口。您可以像普通的窗口一样，在里面放各种控件，实现各种动画，但前提是图片得用data url，参考Cantk官方
     <a href="https://github.com/drawapp8/cantk/wiki/%E8%B5%84%E6%BA%90%E5%8A%A0%E8%BD%BD%E7%AA%97%E5%8F%A3%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9">
      WIKI说明
     </a>
     ，data url的转换参见工具-&gt;Data URL产生器。
     <br/>
     <img alt="这里写图片描述" src="https://img-blog.csdn.net/20150625160018305" title="">
      <br/>
      我们转换一张背景图的data url，然后将data url拷贝到控件的背景图片中。
     </img>
    </p>
    <p>
     <img alt="这里写图片描述" src="https://img-blog.csdn.net/20150625160133242" title=""/>
    </p>
    <p>
     然后拖一个图片控件进来，同样将loading图片的data url拷贝到它的背景图片中，然后用动画编辑器编辑一下动画。
     <br/>
     <img alt="这里写图片描述" src="https://img-blog.csdn.net/20150625160323506" title="">
      <br/>
      <img alt="这里写图片描述" src="https://img-blog.csdn.net/20150625160352261" title=""/>
     </img>
    </p>
    <p>
     然后将资源加载进度条，设置为”运行时不可见”。
     <br/>
     <img alt="这里写图片描述" src="https://img-blog.csdn.net/20150625160453996" title=""/>
    </p>
    <h3 id="开始场景">
     开始场景
    </h3>
    <p>
     新建一个场景，更名为”开始场景”，拖一个图片控件，设置背景图片为麦当劳logo，再拖一个图片控件，设置背景图片为标题…全部完成后，如图所示：
     <br/>
     <img alt="这里写图片描述" src="https://img-blog.csdn.net/20150625160758912" title=""/>
    </p>
    <h3 id="提示场景">
     提示场景
    </h3>
    <p>
     新建一个场景，更名为”提示场景”，拖一张图片作为麦当劳logo，另一张作为提示背景，拖一张图片控件作为它的子控件，设置图片为汉堡，再拖一个图片控件放禁止标识图片。
    </p>
    <p>
     其中禁止标识图片需要有动画：
     <br/>
     <img alt="这里写图片描述" src="https://img-blog.csdn.net/20150625174509876" title=""/>
     <br/>
     <img alt="这里写图片描述" src="https://img-blog.csdn.net/20150625174530999" title=""/>
     <br/>
     <img alt="这里写图片描述" src="https://img-blog.csdn.net/20150625174556686" title=""/>
     <br/>
     全部完成后，效果图如下：
     <br/>
     <img alt="这里写图片描述" src="https://img-blog.csdn.net/20150625174655810" title=""/>
    </p>
    <h3 id="游戏场景">
     游戏场景
    </h3>
    <h4 id="伐木工">
     伐木工
    </h4>
    <p>
     拖一个帧动画进来，设置3张图片，分组为3个动作”hit”,”eat”,”stand”。
     <br/>
     拖一个图片控件进来，用动画编辑器编辑一个放大动画，表示在伐木工头上的爆炸效果。
    </p>
    <h4 id="进度条">
     进度条
    </h4>
    <p>
     拖一个进度条进来，拉成竖直形状。
    </p>
    <h4 id="树木">
     树木
    </h4>
    <p>
     拖一个图片控件进来，放置一个树干图片，拖一个图片控件作为它的子控件，设置图片为事物的一种，复制3个一样的，设置不同的树干图片和食物图片。这三个带事物的树干作为样本，程序里需要复制。
    </p>
    <p>
     随机选择树干样本，复制5个到当前场景，调整位置和宽高，使其刚好能组成一颗树的模样。
    </p>
    <h4 id="其他">
     其他
    </h4>
    <p>
     其他时钟控件，分数文本控件，树桩图片控件的摆放不再赘述。
     <br/>
     全部完成后，如下图所示：
     <br/>
     <img alt="这里写图片描述" src="https://img-blog.csdn.net/20150625175859119" title=""/>
    </p>
    <h4 id="结果场景">
     结果场景
    </h4>
    <p>
     略。
    </p>
    <h3 id="代码">
     代码
    </h3>
    <p>
     这里只贴游戏场景的代码，其他场景代码极少且简单。
    </p>
    <pre class="prettyprint"><code class="language-javascript hljs"><span class="hljs-keyword">var</span> me = <span class="hljs-keyword">this</span>;
<span class="hljs-keyword">this</span>.resetGame();
<span class="hljs-keyword">var</span> win = <span class="hljs-keyword">this</span>.getWindow();
win.makeNewItem = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {<!-- --></span>
    <span class="hljs-keyword">var</span> first = win.treeArray[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">var</span> index = <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">3</span>);
    <span class="hljs-keyword">var</span> sp = win.dupChild(<span class="hljs-string">"sample"</span> + index);
    sp.setVisible(<span class="hljs-literal">true</span>);
    sp.setPosition(first.x, first.y - <span class="hljs-number">117</span>);
    win.treeArray.unshift(sp);
};
win.allDown = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {<!-- --></span>
    win.treeArray.forEach(
        <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> {<!-- --></span>
            e.animate(<span class="hljs-string">"down"</span>);
        }
    );
};
win.handleOnSwipeLeft = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {<!-- --></span>
    win.gestureArray.push(<span class="hljs-string">"left"</span>);
    win.handleSwipe();
};
win.handleOnSwipeRight = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {<!-- --></span>
    win.gestureArray.push(<span class="hljs-string">"right"</span>);
    win.handleSwipe();
};
win.handleSwipe = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {<!-- --></span>
    <span class="hljs-keyword">var</span> dir = win.gestureArray[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">var</span> last = win.treeArray[win.treeArray.length - <span class="hljs-number">1</span>];
    <span class="hljs-keyword">var</span> result = last.animate(dir, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onDone</span><span class="hljs-params">(_obj)</span> {<!-- --></span>
        win.treeArray.pop();
        win.gestureArray.shift();
        win.makeNewItem();
        win.allDown();
        <span class="hljs-keyword">if</span>(dir === <span class="hljs-string">"left"</span>) {
            <span class="hljs-keyword">var</span> img = last.getChild(<span class="hljs-number">0</span>).getValue();
            <span class="hljs-keyword">if</span>(img.indexOf(<span class="hljs-string">"shiwu-2.png"</span>) &gt; <span class="hljs-number">0</span>){
                win.score += <span class="hljs-number">1</span>;
                win.find(<span class="hljs-string">"score"</span>).setText(<span class="hljs-string">"分数: "</span> + win.score);
                win.timeLine.addValue(<span class="hljs-number">2</span>, <span class="hljs-literal">true</span>);
                win.tip.textAnimate(<span class="hljs-string">"+1分"</span>);
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(img.indexOf(<span class="hljs-string">"shiwu-1.png"</span>) &gt; <span class="hljs-number">0</span>) {
                win.timeLine.addValue(-<span class="hljs-number">10</span>, <span class="hljs-literal">true</span>);
                win.tip.textAnimate(<span class="hljs-string">"-2S"</span>);
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(img.indexOf(<span class="hljs-string">"shiwu-3.png"</span>) &gt; <span class="hljs-number">0</span>) {
                win.bomb.setVisible(<span class="hljs-literal">true</span>);
                win.bomb.animate(<span class="hljs-string">"display"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {<!-- --></span>
                    win.bomb.setVisible(<span class="hljs-literal">false</span>);
                });
                win.timeLine.addValue(-<span class="hljs-number">15</span>, <span class="hljs-literal">true</span>);
                win.tip.textAnimate(<span class="hljs-string">"-5S"</span>);
            }
        }
        last.remove();
    });
    <span class="hljs-keyword">if</span>(!result) {
        <span class="hljs-keyword">if</span>(win.gestureArray.length &gt; <span class="hljs-number">0</span>) {
            console.log(<span class="hljs-string">"length:"</span> + win.gestureArray.length);
            setTimeout(win.handleSwipe, <span class="hljs-number">20</span>);
        }
    } <span class="hljs-keyword">else</span> {
        win.man.play(dir === <span class="hljs-string">"right"</span> ? <span class="hljs-string">"hit"</span> : <span class="hljs-string">"eat"</span>, <span class="hljs-number">1</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {<!-- --></span>
            win.man.play(<span class="hljs-string">"stand"</span>);
        });
    }
};</code></pre>
    <p>
     总的代码加起来100行左右，这个游戏跟最原始的伐木工不太一样，玩法有改进，美术上还可以有更多的变化。如果您想在我的基础上进行改进，加入您的创意，
     <a href="http://www.tangide.com/gamebuilder.php?appid=previewqqArmily-11435203333061" rel="nofollow">
      点这里
     </a>
     。
    </p>
    <p>
     如果在开发过程中有任何疑问，请扫描二维码加入官方QQ群：
     <br/>
     <img alt="这里写图片描述" src="https://img-blog.csdn.net/20150624190707926" title=""/>
    </p>
    <p>
     本系列介绍的tangide游戏开发的所有的代码和资源都是开源的，你可以免费试用。
     <br/>
     ——
     <a href="http://www.tangide.com/gamebuilder.php" rel="nofollow">
      TangIDE
     </a>
     ，让H5开发变简单！
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f79696e6c696a756e32303034:2f61727469636c652f64657461696c732f3436363339363437" class_="artid" style="display:none">
 </p>
</div>


