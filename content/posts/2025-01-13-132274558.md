---
layout: post
title: "Win使用-PowerShell-命令获取计算机硬件信息"
date: 2025-01-13 12:57:19 +0800
description: "在管理和维护计算机系统时，获取计算机硬件信息是非常重要的。了解硬件配置可以帮助我们更好地了解系统的性"
keywords: "局域网远程获取电脑硬件信息的powershell"
categories: ['Windows']
tags: ['运维', 'Windows', 'Microsoft']
artid: "132274558"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=132274558
    alt: "Win使用-PowerShell-命令获取计算机硬件信息"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=132274558
featuredImagePreview: https://bing.ee123.net/img/rand?artid=132274558
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     【Win】使用 PowerShell 命令获取计算机硬件信息
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     在管理和维护计算机系统时，获取计算机硬件信息是非常重要的。了解硬件配置可以帮助我们更好地了解系统的性能和可扩展性，识别问题并进行故障排除。当你想要获取计算机系统信息时，PowerShell 是一个强大的工具。在此，我们将介绍如何使用 PowerShell 获取计算机的 BIOS 版本、操作系统信息、CPU 型号、内存信息、显卡信息、磁盘驱动器信息和网络适配器信息。
    </p>
    <p>
     首先，我们需要使用
     <code>
      Get-CimInstance
     </code>
     命令来替代过时的
     <code>
      Get-WmiObject
     </code>
     命令。这样可以提高代码的效率，并且
     <code>
      Get-CimInstance
     </code>
     是 PowerShell 中较新的命令。接下来，我们将逐个获取所需的系统信息，并将其保存在相应的变量中。
    </p>
    <h3>
     <a id="_BIOS__5">
     </a>
     获取 BIOS 版本
    </h3>
    <p>
     首先，我们使用以下代码获取计算机的 BIOS 版本号：
    </p>
    <pre><code class="prism language-powershell"><span class="token variable">$BIOS_Version</span> = <span class="token punctuation">(</span><span class="token function">Get-CimInstance</span> <span class="token operator">-</span>ClassName Win32_BIOS<span class="token punctuation">)</span><span class="token punctuation">.</span>SMBIOSBIOSVersion<span class="token punctuation">.</span>trim<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>toupper<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     这行代码会调用
     <code>
      Get-CimInstance
     </code>
     命令并选择
     <code>
      Win32_BIOS
     </code>
     类，然后获取
     <code>
      SMBIOSBIOSVersion
     </code>
     属性的值，使用
     <code>
      trim()
     </code>
     函数去除空格，并将结果转换为大写。
    </p>
    <h3>
     <a id="_15">
     </a>
     获取操作系统信息
    </h3>
    <p>
     接下来，我们获取计算机的操作系统信息，包括名称和版本号：
    </p>
    <pre><code class="prism language-powershell"><span class="token variable">$OS</span> = <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">Get-CimInstance</span> <span class="token operator">-</span>ClassName Win32_OperatingSystem<span class="token punctuation">)</span><span class="token punctuation">.</span>Caption<span class="token punctuation">)</span><span class="token punctuation">.</span>caption<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" ("</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token function">Get-ItemPropertyValue</span> <span class="token operator">-</span>Path <span class="token string">'HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion'</span> <span class="token operator">-</span>Name DisplayVersion<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span>
</code></pre>
    <p>
     这行代码将调用
     <code>
      Get-CimInstance
     </code>
     命令获取
     <code>
      Win32_OperatingSystem
     </code>
     类的实例，并选择
     <code>
      Caption
     </code>
     属性作为操作系统的名称。接着，我们使用
     <code>
      Get-ItemPropertyValue
     </code>
     函数获取注册表中的版本号，并将其与操作系统名称拼接起来。
    </p>
    <h3>
     <a id="_CPU__25">
     </a>
     获取 CPU 型号
    </h3>
    <p>
     我们也可以使用 PowerShell 获取计算机的 CPU 型号：
    </p>
    <pre><code class="prism language-powershell"><span class="token variable">$CPU</span> = <span class="token punctuation">(</span><span class="token function">Get-CimInstance</span> <span class="token operator">-</span>ClassName Win32_Processor<span class="token punctuation">)</span><span class="token punctuation">.</span>Name<span class="token punctuation">.</span>trim<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     这行代码调用
     <code>
      Get-CimInstance
     </code>
     命令并选择
     <code>
      Win32_Processor
     </code>
     类，然后获取
     <code>
      Name
     </code>
     属性的值，并使用
     <code>
      trim()
     </code>
     函数去除空格。
    </p>
    <h3>
     <a id="_35">
     </a>
     获取内存信息
    </h3>
    <p>
     下面，我们获取计算机的内存信息，包括总容量和每个物理内存条的容量和速度：
    </p>
    <pre><code class="prism language-powershell"><span class="token variable">$Memorys</span> = <span class="token function">Get-CimInstance</span> <span class="token operator">-</span>ClassName Win32_PhysicalMemory
<span class="token variable">$TotalMemory</span> = 0
<span class="token variable">$Memory</span> = <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$obj</span> in <span class="token variable">$Memorys</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token variable">$TotalMemory</span> <span class="token operator">+=</span> <span class="token variable">$obj</span><span class="token punctuation">.</span>Capacity
    <span class="token punctuation">(</span><span class="token variable">$obj</span><span class="token punctuation">.</span>Capacity/1GB<span class="token punctuation">)</span><span class="token punctuation">.</span>ToString<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" GB "</span> <span class="token operator">+</span> <span class="token variable">$obj</span><span class="token punctuation">.</span>Speed <span class="token operator">+</span> <span class="token string">"MHz"</span>
<span class="token punctuation">}</span>
<span class="token variable">$Memory</span> = <span class="token punctuation">(</span><span class="token variable">$TotalMemory</span><span class="token operator">/</span>1GB<span class="token punctuation">)</span><span class="token punctuation">.</span>ToString<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" GB ("</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token variable">$Memory</span> <span class="token operator">-join</span> <span class="token string">" / "</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span>
</code></pre>
    <p>
     首先，我们调用
     <code>
      Get-CimInstance
     </code>
     命令并选择
     <code>
      Win32_PhysicalMemory
     </code>
     类，将结果保存在
     <code>
      $Memorys
     </code>
     变量中。然后，我们使用循环遍历每个物理内存条并计算总内存容量。在循环中，我们使用每个物理内存条的容量和速度来构建一个数组
     <code>
      $Memory
     </code>
     。最后，我们将总内存容量和内存条的信息进行拼接。
    </p>
    <h3>
     <a id="_51">
     </a>
     获取显卡信息
    </h3>
    <p>
     在 PowerShell 中，我们也可以获取计算机的显卡信息：
    </p>
    <pre><code class="prism language-powershell"><span class="token variable">$Displays</span> = <span class="token function">Get-CimInstance</span> <span class="token operator">-</span>ClassName Win32_VideoController

<span class="token variable">$Display</span> = <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$controller</span> in <span class="token variable">$Displays</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token variable">$controller</span><span class="token punctuation">.</span>Name
<span class="token punctuation">}</span>

<span class="token variable">$Display</span> = <span class="token punctuation">(</span><span class="token variable">$Display</span> <span class="token operator">-join</span> <span class="token string">" / "</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     此代码会先调用
     <code>
      Get-CimInstance
     </code>
     命令来获取
     <code>
      Win32_VideoController
     </code>
     类的实例，并将结果保存在
     <code>
      $Displays
     </code>
     变量中。然后，我们使用循环遍历每个视频控制器，并将其名称添加到
     <code>
      $Display
     </code>
     数组中。最后，通过将
     <code>
      $Display
     </code>
     数组中的所有元素拼接起来，我们就可以得到一个包含所有显卡名称的字符串。
    </p>
    <h3>
     <a id="_67">
     </a>
     获取磁盘驱动器信息
    </h3>
    <p>
     接下来，我们获取计算机的磁盘驱动器信息，包括驱动器标签和容量：
    </p>
    <pre><code class="prism language-powershell"><span class="token variable">$Disks</span> = <span class="token function">Get-CimInstance</span> <span class="token operator">-</span>ClassName Win32_DiskDrive <span class="token punctuation">|</span> <span class="token function">Where-Object</span> <span class="token punctuation">{<!-- --></span> <span class="token variable">$_</span><span class="token punctuation">.</span>MediaType <span class="token operator">-eq</span> <span class="token string">'Fixed hard disk media'</span> <span class="token punctuation">}</span> <span class="token punctuation">|</span> <span class="token function">Sort-Object</span> <span class="token operator">-</span>Property Index
<span class="token variable">$HD</span> = <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$disk</span> in <span class="token variable">$Disks</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token variable">$disk</span><span class="token punctuation">.</span>Caption <span class="token operator">+</span> <span class="token string">" ("</span> <span class="token operator">+</span> <span class="token namespace">[Math]</span>::Round<span class="token punctuation">(</span><span class="token variable">$disk</span><span class="token punctuation">.</span>Size/1GB<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" GB )"</span>
<span class="token punctuation">}</span>
<span class="token variable">$HD</span> = <span class="token punctuation">(</span><span class="token variable">$HD</span> <span class="token operator">-join</span> <span class="token string">" / "</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     此代码会先调用
     <code>
      Get-CimInstance
     </code>
     命令并选择
     <code>
      Win32_DiskDrive
     </code>
     类，然后根据
     <code>
      MediaType
     </code>
     属性筛选出固定硬盘驱动器。然后，我们使用
     <code>
      Sort-Object
     </code>
     命令按照
     <code>
      Index
     </code>
     属性对驱动器进行排序。在循环中，我们获取每个磁盘驱动器的标签和大小，并将其添加到
     <code>
      $HD
     </code>
     数组中。最后，我们将所有的磁盘驱动器信息进行拼接。
    </p>
    <h3>
     <a id="_81">
     </a>
     获取网络适配器信息
    </h3>
    <p>
     最后，我们获取计算机的网络适配器信息，包括适配器名称和 MAC 地址：
    </p>
    <pre><code class="prism language-powershell"><span class="token variable">$Adapters</span> = <span class="token function">Get-CimInstance</span> <span class="token operator">-</span>ClassName Win32_NetworkAdapter <span class="token operator">-</span><span class="token keyword">Filter</span> <span class="token string">"PNPDeviceID LIKE 'PCI%'"</span>
<span class="token variable">$NT</span> = <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$adapter</span> in <span class="token variable">$Adapters</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token variable">$adapter</span><span class="token punctuation">.</span>Name <span class="token operator">+</span> <span class="token string">" ("</span> <span class="token operator">+</span> <span class="token variable">$adapter</span><span class="token punctuation">.</span>MACAddress <span class="token operator">+</span> <span class="token string">")"</span>
<span class="token punctuation">}</span>
<span class="token variable">$NT</span> = <span class="token punctuation">(</span><span class="token variable">$NT</span> <span class="token operator">-join</span> <span class="token string">" / "</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     这段代码会调用
     <code>
      Get-CimInstance
     </code>
     命令并选择
     <code>
      Win32_NetworkAdapter
     </code>
     类，并使用过滤器来筛选出 PCI 类型的适配器。然后，我们使用循环遍历每个适配器，并将适配器的名称和 MAC 地址进行拼接，放入
     <code>
      $NT
     </code>
     数组中。最后，我们将所有的网络适配器信息进行拼接。
    </p>
    <h3>
     <a id="_95">
     </a>
     最终输出结果将如下所示：
    </h3>
    <pre><code>BIOS 版本: 1.15.0
操作系统: Microsoft Windows 11 企业版 (22H2)
CPU: 11th Gen Intel(R) Core(TM) i7-11800H @ 2.30GHz
内存: 32 GB (16 GB 3200MHz / 16 GB 3200MHz)
显卡: NVIDIA GeForce RTX 3050 Ti Laptop GPU / Intel(R) UHD Graphics
硬盘: NVMe Fanxiang S690 2TB (1863 GB) / NVMe KBG40ZNS1T02 NVMe KIOXIA 1024GB (954 GB)
网络适配器: Intel(R) Wi-Fi 6 AX201 160MHz (7C:**:**:**:**:B5)  #此处隐藏了MAC地址具体信息
</code></pre>
    <p>
     这个输出结果示例包含了您提供的硬件信息，其中包括了 BIOS 版本、操作系统、CPU、内存、显卡、硬盘和网络适配器的详细信息。
    </p>
    <p>
     请注意，具体的输出结果将根据不同计算机的硬件配置而有所不同。以上只是一个示例，并不代表所有计算机的实际输出结果。
    </p>
    <p>
     希望本篇博客对你有所帮助！如有任何问题，请随时提问。
    </p>
   </div>
   <link href="./../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="./../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f753031323135333130342f:61727469636c652f64657461696c732f313332323734353538" class_="artid" style="display:none">
 </p>
</div>


