---
layout: post
title: "密码学笔记"
date: 2025-03-12 10:25:36 +0800
description: "1. 常用工具OpenSSL：命令行工具，支持证书生成、格式转换、加解密。# 生成RSA私钥# 提取公钥：Python密码学库，支持AES、RSA、哈希等。cipher = AES.new(key, AES.MODE_GCM)  # AES-GCM模式加密hashlib：Python标准库，支持SHA256、MD5等哈希算法。2. 在线工具Factordb：大整数分解（CyberChef：多功能编解码工具（"
keywords: "密码学笔记"
categories: ['网络安全']
tags: ['网络安全', '笔记', '密码学', 'Python', 'Ctf', 'Crypto']
artid: "146198272"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146198272
    alt: "密码学笔记"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146198272
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146198272
cover: https://bing.ee123.net/img/rand?artid=146198272
image: https://bing.ee123.net/img/rand?artid=146198272
img: https://bing.ee123.net/img/rand?artid=146198272
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     密码学笔记
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h4>
     <a id="_0">
     </a>
     密码学
    </h4>
    <hr/>
    <h5>
     <a id="_3">
     </a>
     一、密码学基础概念
    </h5>
    <p>
     <strong>
      1. CIA三要素
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       机密性 (Confidentiality)
      </strong>
      ：信息不被未授权者访问。
      <ul>
       <li>
        例子：用钥匙锁住日记本，只有你有钥匙。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       完整性 (Integrity)
      </strong>
      ：信息在传输/存储中不被篡改。
      <ul>
       <li>
        例子：快递包裹封条，若破损则可能被篡改。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       可用性 (Availability)
      </strong>
      ：授权用户能随时访问资源。
      <ul>
       <li>
        例子：银行系统需保证7×24小时服务。
       </li>
      </ul>
     </li>
    </ul>
    <p>
     <strong>
      2. 密码学与隐写的区别
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       密码学
      </strong>
      ：隐藏信息内容（如加密后的乱码）。
     </li>
     <li>
      <strong>
       隐写
      </strong>
      ：隐藏信息存在性（如图片藏文字）。
     </li>
    </ul>
    <hr/>
    <h5>
     <a id="_18">
     </a>
     二、古典密码
    </h5>
    <p>
     <strong>
      1. 凯撒密码
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       原理
      </strong>
      ：字母表固定偏移（如偏移3）。
      <ul>
       <li>
        加密公式：
        <code>
         密文字母 = (明文字母 + 3) mod 26
        </code>
       </li>
       <li>
        例子：
        <code>
         A → D
        </code>
        ，
        <code>
         HELLO → KHOOR
        </code>
        。
       </li>
      </ul>
     </li>
    </ul>
    <p>
     <strong>
      Python代码示例
     </strong>
    </p>
    <pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">caesar_encrypt</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> shift<span class="token punctuation">)</span><span class="token punctuation">:</span>  
    result <span class="token operator">=</span> <span class="token string">""</span>  
    <span class="token keyword">for</span> char <span class="token keyword">in</span> text<span class="token punctuation">:</span>  
        <span class="token keyword">if</span> char<span class="token punctuation">.</span>isalpha<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  
            base <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span> <span class="token keyword">if</span> char<span class="token punctuation">.</span>isupper<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>  
            result <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span> <span class="token operator">-</span> base <span class="token operator">+</span> shift<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">+</span> base<span class="token punctuation">)</span>  
        <span class="token keyword">else</span><span class="token punctuation">:</span>  
            result <span class="token operator">+=</span> char  
    <span class="token keyword">return</span> result  

<span class="token keyword">print</span><span class="token punctuation">(</span>caesar_encrypt<span class="token punctuation">(</span><span class="token string">"HELLO"</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 输出：KHOOR  </span>
</code></pre>
    <p>
     <strong>
      代码解释
     </strong>
     ：
    </p>
    <ul>
     <li>
      遍历每个字符，计算偏移后的ASCII值。
     </li>
     <li>
      <code>
       mod 26
      </code>
      确保字母循环（如
      <code>
       Z + 3 → C
      </code>
      ）。
     </li>
    </ul>
    <hr/>
    <p>
     <strong>
      2. 栅栏密码
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       原理
      </strong>
      ：将明文按行分组后按列读取。
      <ul>
       <li>
        例子：明文
        <code>
         THEQUICKBROWNFOX
        </code>
        ，分2栏：
        <pre><code>T E Q I C B O O X  
H U K R W N F X  
</code></pre>
        密文：
        <code>
         TEQICBOOXHUKRWNX
        </code>
       </li>
      </ul>
     </li>
    </ul>
    <p>
     <strong>
      Python代码示例
     </strong>
    </p>
    <pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">rail_fence_encrypt</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> rails<span class="token punctuation">)</span><span class="token punctuation">:</span>  
    fence <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>rails<span class="token punctuation">)</span><span class="token punctuation">]</span>  
    rail <span class="token operator">=</span> <span class="token number">0</span>  
    <span class="token keyword">for</span> char <span class="token keyword">in</span> text<span class="token punctuation">:</span>  
        fence<span class="token punctuation">[</span>rail<span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>char<span class="token punctuation">)</span>  
        rail <span class="token operator">=</span> <span class="token punctuation">(</span>rail <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> rails  
    <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>row<span class="token punctuation">)</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> fence<span class="token punctuation">]</span><span class="token punctuation">)</span>  

<span class="token keyword">print</span><span class="token punctuation">(</span>rail_fence_encrypt<span class="token punctuation">(</span><span class="token string">"HELLOWORLD"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 输出：HLOOL ELWRD  </span>
</code></pre>
    <p>
     <strong>
      代码解释
     </strong>
     ：
    </p>
    <ul>
     <li>
      创建
      <code>
       rails
      </code>
      个空列表模拟栅栏。
     </li>
     <li>
      按顺序循环填入字符，最后按行拼接。
     </li>
    </ul>
    <hr/>
    <p>
     <strong>
      3. 摩斯密码
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       原理
      </strong>
      ：用点（·）和划（−）表示字母。
      <ul>
       <li>
        例子：
        <code>
         SOS → ··· −−− ···
        </code>
       </li>
      </ul>
     </li>
    </ul>
    <p>
     <strong>
      Python代码示例
     </strong>
    </p>
    <pre><code class="prism language-python">morse_code <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'A'</span><span class="token punctuation">:</span><span class="token string">'.-'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">:</span><span class="token string">'-...'</span><span class="token punctuation">,</span> <span class="token string">'S'</span><span class="token punctuation">:</span><span class="token string">'...'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">:</span><span class="token string">'---'</span><span class="token punctuation">}</span>  
<span class="token keyword">def</span> <span class="token function">to_morse</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>  
    <span class="token keyword">return</span> <span class="token string">' '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>morse_code<span class="token punctuation">[</span>c<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> text <span class="token keyword">if</span> c<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">in</span> morse_code<span class="token punctuation">]</span><span class="token punctuation">)</span>  

<span class="token keyword">print</span><span class="token punctuation">(</span>to_morse<span class="token punctuation">(</span><span class="token string">"SOS"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 输出：... --- ...  </span>
</code></pre>
    <p>
     <strong>
      代码解释
     </strong>
     ：
    </p>
    <ul>
     <li>
      查表替换每个字符为对应的摩斯码。
     </li>
    </ul>
    <hr/>
    <h5>
     <a id="_88">
     </a>
     三、数学基础
    </h5>
    <p>
     <strong>
      1. 模运算
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       定义
      </strong>
      ：对整数取余数的运算，符号为
      <code>
       mod
      </code>
      。
      <ul>
       <li>
        例子：
        <code>
         17 mod 5 = 2
        </code>
        （因为 17 ÷ 5 余 2）。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       同余关系
      </strong>
      ：若
      <code>
       a mod n = b mod n
      </code>
      ，则称
      <code>
       a ≡ b (mod n)
      </code>
      。
      <ul>
       <li>
        例子：
        <code>
         23 ≡ 65 (mod 7)
        </code>
        ，因为两者余数均为 2。
       </li>
      </ul>
     </li>
    </ul>
    <p>
     <strong>
      应用场景
     </strong>
     ：钟表时间（12小时制）、密码学中的循环计算。
    </p>
    <hr/>
    <p>
     <strong>
      2. 欧拉定理
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       核心公式
      </strong>
      ：若
      <code>
       a
      </code>
      与
      <code>
       n
      </code>
      互质，则
      <code>
       a^φ(n) ≡ 1 (mod n)
      </code>
      。
      <ul>
       <li>
        <code>
         φ(n)
        </code>
        （欧拉函数）：小于
        <code>
         n
        </code>
        且与
        <code>
         n
        </code>
        互质的正整数的个数。
       </li>
       <li>
        例子：若
        <code>
         n = 7
        </code>
        （质数），则
        <code>
         φ(7) = 6
        </code>
        。
       </li>
      </ul>
     </li>
    </ul>
    <p>
     <strong>
      计算 φ(n)
     </strong>
     ：
    </p>
    <ul>
     <li>
      若
      <code>
       n = p×q
      </code>
      （p、q为不同质数），则
      <code>
       φ(n) = (p-1)(q-1)
      </code>
      。
     </li>
     <li>
      例子：
      <code>
       n = 15 = 3×5
      </code>
      ，则
      <code>
       φ(15) = 2×4 = 8
      </code>
      。
     </li>
    </ul>
    <hr/>
    <p>
     <strong>
      3. 费马小定理
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       特例
      </strong>
      ：若
      <code>
       p
      </code>
      是质数且
      <code>
       a
      </code>
      与
      <code>
       p
      </code>
      互质，则
      <code>
       a^(p-1) ≡ 1 (mod p)
      </code>
      。
      <ul>
       <li>
        例子：
        <code>
         3^6 mod 7 = 729 mod 7 = 1
        </code>
        。
       </li>
      </ul>
     </li>
    </ul>
    <hr/>
    <p>
     <strong>
      4. 扩展欧几里得算法（求逆元）
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       目标
      </strong>
      ：找到整数
      <code>
       x, y
      </code>
      使得
      <code>
       ax + by = gcd(a, b)
      </code>
      。
     </li>
     <li>
      <strong>
       逆元
      </strong>
      ：若
      <code>
       a
      </code>
      与
      <code>
       m
      </code>
      互质，则存在
      <code>
       b
      </code>
      使得
      <code>
       a×b ≡ 1 (mod m)
      </code>
      ，称
      <code>
       b
      </code>
      是
      <code>
       a
      </code>
      的模
      <code>
       m
      </code>
      逆元。
     </li>
    </ul>
    <p>
     <strong>
      Python代码示例
     </strong>
    </p>
    <pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">extended_gcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>  
    <span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>  
        <span class="token keyword">return</span> a<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span>  
    <span class="token keyword">else</span><span class="token punctuation">:</span>  
        g<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y <span class="token operator">=</span> extended_gcd<span class="token punctuation">(</span>b<span class="token punctuation">,</span> a <span class="token operator">%</span> b<span class="token punctuation">)</span>  
        <span class="token keyword">return</span> g<span class="token punctuation">,</span> y<span class="token punctuation">,</span> x <span class="token operator">-</span> <span class="token punctuation">(</span>a <span class="token operator">//</span> b<span class="token punctuation">)</span> <span class="token operator">*</span> y  

a<span class="token punctuation">,</span> m <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">11</span>  
g<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y <span class="token operator">=</span> extended_gcd<span class="token punctuation">(</span>a<span class="token punctuation">,</span> m<span class="token punctuation">)</span>  
<span class="token keyword">if</span> g <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>  
    inverse <span class="token operator">=</span> x <span class="token operator">%</span> m  
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"3的模11逆元是 </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>inverse<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  <span class="token comment"># 输出：4（因为 3×4=12 ≡1 mod11）  </span>
</code></pre>
    <p>
     <strong>
      代码解释
     </strong>
     ：
    </p>
    <ul>
     <li>
      递归计算最大公约数
      <code>
       g
      </code>
      和系数
      <code>
       x, y
      </code>
      。
     </li>
     <li>
      若
      <code>
       g=1
      </code>
      ，则
      <code>
       x % m
      </code>
      即为
      <code>
       a
      </code>
      的逆元。
     </li>
    </ul>
    <hr/>
    <h5>
     <a id="RSA_141">
     </a>
     四、RSA算法
    </h5>
    <p>
     <strong>
      1. 密钥生成步骤
     </strong>
    </p>
    <ol>
     <li>
      选两个大质数
      <code>
       p
      </code>
      和
      <code>
       q
      </code>
      （如 512位）。
     </li>
     <li>
      计算模数
      <code>
       n = p×q
      </code>
      。
     </li>
     <li>
      计算欧拉函数
      <code>
       φ(n) = (p-1)(q-1)
      </code>
      。
     </li>
     <li>
      选公钥
      <code>
       e
      </code>
      ，满足
      <code>
       1 &lt; e &lt; φ(n)
      </code>
      且
      <code>
       e
      </code>
      与
      <code>
       φ(n)
      </code>
      互质。
     </li>
     <li>
      计算私钥
      <code>
       d
      </code>
      ，即
      <code>
       d ≡ e⁻¹ (mod φ(n))
      </code>
      。
     </li>
     <li>
      公钥为
      <code>
       (n, e)
      </code>
      ，私钥为
      <code>
       (n, d)
      </code>
      。
     </li>
    </ol>
    <p>
     <strong>
      示例
     </strong>
     ：
    </p>
    <ul>
     <li>
      <code>
       p=3
      </code>
      ,
      <code>
       q=11
      </code>
      →
      <code>
       n=33
      </code>
      ,
      <code>
       φ(n)=20
      </code>
      。
     </li>
     <li>
      选
      <code>
       e=3
      </code>
      （与20互质）。
     </li>
     <li>
      计算
      <code>
       d=7
      </code>
      （因为
      <code>
       3×7=21 ≡1 mod20
      </code>
      ）。
     </li>
    </ul>
    <hr/>
    <p>
     <strong>
      2. 加密与解密
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       加密公式
      </strong>
      ：
      <code>
       密文 c = m^e mod n
      </code>
      （
      <code>
       m
      </code>
      是明文）。
     </li>
     <li>
      <strong>
       解密公式
      </strong>
      ：
      <code>
       明文 m = c^d mod n
      </code>
      。
     </li>
    </ul>
    <p>
     <strong>
      Python代码示例
     </strong>
    </p>
    <pre><code class="prism language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span> inverse  

<span class="token comment"># 密钥生成  </span>
p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment"># 生成10位质数  </span>
q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>  
n <span class="token operator">=</span> p <span class="token operator">*</span> q  
phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>  
e <span class="token operator">=</span> <span class="token number">65537</span>  <span class="token comment"># 常用公钥  </span>
d <span class="token operator">=</span> inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>  

<span class="token comment"># 加密  </span>
m <span class="token operator">=</span> <span class="token number">42</span>  
c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>  

<span class="token comment"># 解密  </span>
m_decrypted <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>  
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"明文: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>m<span class="token punctuation">}</span></span><span class="token string">, 解密结果: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>m_decrypted<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  <span class="token comment"># 输出：42  </span>
</code></pre>
    <p>
     <strong>
      代码解释
     </strong>
     ：
    </p>
    <ul>
     <li>
      <code>
       getPrime
      </code>
      生成质数，
      <code>
       inverse
      </code>
      计算逆元。
     </li>
     <li>
      <code>
       pow(c, d, n)
      </code>
      高效计算大数幂取模。
     </li>
    </ul>
    <hr/>
    <p>
     <strong>
      3. 安全性原理
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       核心难点
      </strong>
      ：大整数分解问题（已知
      <code>
       n
      </code>
      难以分解出
      <code>
       p
      </code>
      和
      <code>
       q
      </code>
      ）。
     </li>
     <li>
      <strong>
       攻击方式
      </strong>
      ：
      <ul>
       <li>
        暴力分解（对小
        <code>
         n
        </code>
        有效）。
       </li>
       <li>
        量子计算的Shor算法（威胁大数分解）。
       </li>
      </ul>
     </li>
    </ul>
    <hr/>
    <h5>
     <a id="RSA_195">
     </a>
     五、RSA常见攻击场景
    </h5>
    <p>
     <strong>
      1. 模数分解攻击
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       原理
      </strong>
      ：若模数
      <code>
       n
      </code>
      过小或存在特殊结构（如
      <code>
       p
      </code>
      和
      <code>
       q
      </code>
      接近），可通过分解
      <code>
       n
      </code>
      恢复私钥。
     </li>
     <li>
      <strong>
       工具
      </strong>
      ：
      <code>
       yafu
      </code>
      、
      <code>
       factordb
      </code>
      、
      <code>
       sagemath
      </code>
      。
     </li>
     <li>
      <strong>
       示例
      </strong>
      （费马分解）：
      <ul>
       <li>
        若
        <code>
         n = p×q
        </code>
        ，且
        <code>
         p
        </code>
        和
        <code>
         q
        </code>
        接近，则
        <code>
         p ≈ √n
        </code>
        。
       </li>
       <li>
        从
        <code>
         √n
        </code>
        开始搜索相邻素数，找到
        <code>
         p
        </code>
        和
        <code>
         q
        </code>
        。
       </li>
      </ul>
     </li>
    </ul>
    <p>
     <strong>
      Python代码示例
     </strong>
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> gmpy2  

<span class="token keyword">def</span> <span class="token function">fermat_factorization</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>  
    a <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>isqrt<span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>  
    b2 <span class="token operator">=</span> a<span class="token operator">*</span>a <span class="token operator">-</span> n  
    <span class="token keyword">while</span> <span class="token keyword">not</span> gmpy2<span class="token punctuation">.</span>is_square<span class="token punctuation">(</span>b2<span class="token punctuation">)</span><span class="token punctuation">:</span>  
        a <span class="token operator">+=</span> <span class="token number">1</span>  
        b2 <span class="token operator">=</span> a<span class="token operator">*</span>a <span class="token operator">-</span> n  
    b <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>isqrt<span class="token punctuation">(</span>b2<span class="token punctuation">)</span>  
    <span class="token keyword">return</span> <span class="token punctuation">(</span>a <span class="token operator">+</span> b<span class="token punctuation">,</span> a <span class="token operator">-</span> b<span class="token punctuation">)</span>  

n <span class="token operator">=</span> <span class="token number">1234567891011121314151617181921</span>  
p<span class="token punctuation">,</span> q <span class="token operator">=</span> fermat_factorization<span class="token punctuation">(</span>n<span class="token punctuation">)</span>  
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"p = </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>p<span class="token punctuation">}</span></span><span class="token string">, q = </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>q<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  
</code></pre>
    <p>
     <strong>
      代码解释
     </strong>
     ：
    </p>
    <ul>
     <li>
      从
      <code>
       √n
      </code>
      开始逐步增加
      <code>
       a
      </code>
      ，计算
      <code>
       b² = a² - n
      </code>
      ，直到
      <code>
       b
      </code>
      为整数。
     </li>
    </ul>
    <hr/>
    <p>
     <strong>
      2. 共模攻击
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       原理
      </strong>
      ：若同一明文用两个不同的公钥
      <code>
       (n, e1)
      </code>
      和
      <code>
       (n, e2)
      </code>
      加密，且
      <code>
       e1
      </code>
      和
      <code>
       e2
      </code>
      互质，可通过扩展欧几里得算法恢复明文。
     </li>
     <li>
      <strong>
       公式
      </strong>
      ：找到
      <code>
       a
      </code>
      和
      <code>
       b
      </code>
      使得
      <code>
       a*e1 + b*e2 = 1
      </code>
      ，则
      <code>
       m = (c1^a * c2^b) mod n
      </code>
      。
     </li>
    </ul>
    <p>
     <strong>
      Python代码示例
     </strong>
    </p>
    <pre><code class="prism language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> inverse  

n <span class="token operator">=</span> <span class="token number">123456789</span>  
e1<span class="token punctuation">,</span> e2 <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">65537</span>  
c1 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e1<span class="token punctuation">,</span> n<span class="token punctuation">)</span>  
c2 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> n<span class="token punctuation">)</span>  

<span class="token comment"># 扩展欧几里得求a和b  </span>
g<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b <span class="token operator">=</span> extended_gcd<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span>  
m <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> a<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c2<span class="token punctuation">,</span> b<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> n  
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"明文: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>m<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  
</code></pre>
    <p>
     <strong>
      代码解释
     </strong>
     ：
    </p>
    <ul>
     <li>
      <code>
       extended_gcd
      </code>
      函数返回
      <code>
       a
      </code>
      和
      <code>
       b
      </code>
      ，使得
      <code>
       a*e1 + b*e2 = 1
      </code>
      。
     </li>
    </ul>
    <hr/>
    <p>
     <strong>
      3. 低加密指数攻击
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       场景
      </strong>
      ：若公钥
      <code>
       e
      </code>
      极小（如
      <code>
       e=3
      </code>
      ），且明文
      <code>
       m
      </code>
      较小，则
      <code>
       m^e &lt; n
      </code>
      ，可直接开方恢复明文。
     </li>
     <li>
      <strong>
       示例
      </strong>
      ：
      <pre><code class="prism language-python">e <span class="token operator">=</span> <span class="token number">3</span>  
c <span class="token operator">=</span> m<span class="token operator">**</span>e  <span class="token comment"># 假设n &gt; m^e  </span>
m_decrypted <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>c<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  
</code></pre>
     </li>
    </ul>
    <hr/>
    <h5>
     <a id="AES_259">
     </a>
     六、对称密码（AES）
    </h5>
    <p>
     <strong>
      1. AES加密流程
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       分组长度
      </strong>
      ：128位（16字节）。
     </li>
     <li>
      <strong>
       核心步骤
      </strong>
      ：
      <ol>
       <li>
        <strong>
         轮密钥加
        </strong>
        （AddRoundKey）：将密钥与数据异或。
       </li>
       <li>
        <strong>
         字节替换
        </strong>
        （SubBytes）：通过S盒替换每个字节。
       </li>
       <li>
        <strong>
         行移位
        </strong>
        （ShiftRows）：循环左移每一行。
       </li>
       <li>
        <strong>
         列混淆
        </strong>
        （MixColumns）：矩阵乘法混淆列数据。
       </li>
      </ol>
     </li>
    </ul>
    <p>
     <strong>
      Python代码示例（简化版）
     </strong>
    </p>
    <pre><code class="prism language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES  

key <span class="token operator">=</span> <span class="token string">b'0123456789abcdef'</span>  
data <span class="token operator">=</span> <span class="token string">b'ThisIsASecretMsg'</span>  

<span class="token comment"># 加密  </span>
cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span>  
ciphertext <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>data<span class="token punctuation">)</span>  

<span class="token comment"># 解密  </span>
plaintext <span class="token operator">=</span> cipher<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span>  
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"解密结果: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>plaintext<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  
</code></pre>
    <p>
     <strong>
      代码解释
     </strong>
     ：
    </p>
    <ul>
     <li>
      <code>
       AES.MODE_ECB
      </code>
      表示电子密码本模式（无填充）。
     </li>
    </ul>
    <hr/>
    <p>
     <strong>
      2. AES的S盒与逆S盒
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       S盒
      </strong>
      ：非线性替换表，将每个字节映射为另一个字节。
     </li>
     <li>
      <strong>
       逆S盒
      </strong>
      ：解密时反向替换。
     </li>
     <li>
      <strong>
       生成规则
      </strong>
      ：基于有限域乘法逆元和仿射变换。
     </li>
    </ul>
    <hr/>
    <h5>
     <a id="RC4_295">
     </a>
     七、流密码（RC4）
    </h5>
    <p>
     <strong>
      1. RC4算法流程
     </strong>
    </p>
    <ol>
     <li>
      <strong>
       初始化S盒
      </strong>
      ：填充0-255，并用密钥打乱顺序。
     </li>
     <li>
      <strong>
       生成密钥流
      </strong>
      ：通过交换S盒元素生成伪随机序列。
     </li>
    </ol>
    <p>
     <strong>
      Python代码示例
     </strong>
    </p>
    <pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">rc4</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">:</span>  
    S <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
    j <span class="token operator">=</span> <span class="token number">0</span>  
    <span class="token comment"># 初始化S盒  </span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  
        j <span class="token operator">=</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> S<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> key<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>  
        S<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> S<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> S<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> S<span class="token punctuation">[</span>i<span class="token punctuation">]</span>  
    <span class="token comment"># 生成密钥流  </span>
    i <span class="token operator">=</span> j <span class="token operator">=</span> <span class="token number">0</span>  
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>  
        i <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>  
        j <span class="token operator">=</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> S<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>  
        S<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> S<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> S<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> S<span class="token punctuation">[</span>i<span class="token punctuation">]</span>  
        K <span class="token operator">=</span> S<span class="token punctuation">[</span><span class="token punctuation">(</span>S<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> S<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">]</span>  
        <span class="token keyword">yield</span> K  

key <span class="token operator">=</span> <span class="token string">b'SecretKey'</span>  
plaintext <span class="token operator">=</span> <span class="token string">b'HelloWorld'</span>  
keystream <span class="token operator">=</span> rc4<span class="token punctuation">(</span>key<span class="token punctuation">)</span>  
ciphertext <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token punctuation">[</span>p <span class="token operator">^</span> <span class="token builtin">next</span><span class="token punctuation">(</span>keystream<span class="token punctuation">)</span> <span class="token keyword">for</span> p <span class="token keyword">in</span> plaintext<span class="token punctuation">]</span><span class="token punctuation">)</span>  
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"密文: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>ciphertext<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  
</code></pre>
    <p>
     <strong>
      代码解释
     </strong>
     ：
    </p>
    <ul>
     <li>
      初始化阶段通过密钥打乱S盒，生成阶段动态交换元素并输出密钥流。
     </li>
    </ul>
    <hr/>
    <h5>
     <a id="_329">
     </a>
     八、证书格式解析
    </h5>
    <p>
     <strong>
      1. PEM与DER格式
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       PEM
      </strong>
      ：以
      <code>
       -----BEGIN/END
      </code>
      包裹的Base64编码文本，常用于存储公钥/私钥。
      <pre><code>-----BEGIN PUBLIC KEY-----  
MIIBITANBgkqhkiG9w0BAQEFAAOCAQ4AMIIBCQ...  
-----END PUBLIC KEY-----  
</code></pre>
     </li>
     <li>
      <strong>
       DER
      </strong>
      ：二进制格式，适用于程序直接解析。
     </li>
    </ul>
    <p>
     <strong>
      2. 格式转换（OpenSSL）
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       PEM转DER
      </strong>
      ：
      <pre><code class="prism language-bash">openssl rsa <span class="token parameter variable">-in</span> public.pem <span class="token parameter variable">-inform</span> PEM <span class="token parameter variable">-outform</span> DER <span class="token parameter variable">-out</span> public.der  
</code></pre>
     </li>
     <li>
      <strong>
       DER转PEM
      </strong>
      ：
      <pre><code class="prism language-bash">openssl rsa <span class="token parameter variable">-in</span> public.der <span class="token parameter variable">-inform</span> DER <span class="token parameter variable">-outform</span> PEM <span class="token parameter variable">-out</span> public.pem  
</code></pre>
     </li>
    </ul>
    <p>
     <strong>
      3. Python解析证书
     </strong>
    </p>
    <pre><code class="prism language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSA  

<span class="token comment"># 读取PEM证书  </span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"public.pem"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>  
    pem_data <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>  
key <span class="token operator">=</span> RSA<span class="token punctuation">.</span>import_key<span class="token punctuation">(</span>pem_data<span class="token punctuation">)</span>  
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"模数n=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>key<span class="token punctuation">.</span>n<span class="token punctuation">}</span></span><span class="token string">, 公钥e=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>key<span class="token punctuation">.</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  
</code></pre>
    <p>
     <strong>
      代码解释
     </strong>
     ：
    </p>
    <ul>
     <li>
      <code>
       RSA.import_key
      </code>
      可直接解析PEM格式的公钥/私钥。
     </li>
    </ul>
    <hr/>
    <h5>
     <a id="_364">
     </a>
     九、编码方式
    </h5>
    <p>
     <strong>
      1. Base64编码
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       原理
      </strong>
      ：将二进制数据按6位分组，映射到64个可打印字符（A-Z, a-z, 0-9, +/）。
     </li>
     <li>
      <strong>
       示例
      </strong>
      ：
      <pre><code class="prism language-python"><span class="token keyword">import</span> base64  
data <span class="token operator">=</span> <span class="token string">b"Hello, Crypto!"</span>  
encoded <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># SGVsbG8sIENyeXB0byE=  </span>
decoded <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>encoded<span class="token punctuation">)</span>       <span class="token comment"># b'Hello, Crypto!'  </span>
</code></pre>
     </li>
    </ul>
    <p>
     <strong>
      2. URL编码
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       原理
      </strong>
      ：将特殊字符替换为
      <code>
       %
      </code>
      后跟十六进制值（如空格→
      <code>
       %20
      </code>
      ）。
     </li>
     <li>
      <strong>
       示例
      </strong>
      ：
      <pre><code class="prism language-python"><span class="token keyword">from</span> urllib<span class="token punctuation">.</span>parse <span class="token keyword">import</span> quote<span class="token punctuation">,</span> unquote  
url <span class="token operator">=</span> <span class="token string">"flag{hello world}"</span>  
encoded <span class="token operator">=</span> quote<span class="token punctuation">(</span>url<span class="token punctuation">)</span>        <span class="token comment"># flag%7Bhello%20world%7D  </span>
decoded <span class="token operator">=</span> unquote<span class="token punctuation">(</span>encoded<span class="token punctuation">)</span>  <span class="token comment"># flag{hello world}  </span>
</code></pre>
     </li>
    </ul>
    <p>
     <strong>
      3. Quoted-printable编码
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       原理
      </strong>
      ：非ASCII字符用
      <code>
       =XX
      </code>
      表示（如
      <code>
       中
      </code>
      →
      <code>
       =E4=B8=AD
      </code>
      ）。
     </li>
     <li>
      <strong>
       示例
      </strong>
      ：
      <pre><code class="prism language-python"><span class="token keyword">import</span> quopri  
text <span class="token operator">=</span> <span class="token string">"flag{中文}"</span>  
encoded <span class="token operator">=</span> quopri<span class="token punctuation">.</span>encodestring<span class="token punctuation">(</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># flag=E4=B8=AD=E6=96=87  </span>
decoded <span class="token operator">=</span> quopri<span class="token punctuation">.</span>decodestring<span class="token punctuation">(</span>encoded<span class="token punctuation">)</span>                 <span class="token comment"># b'flag{中文}'  </span>
</code></pre>
     </li>
    </ul>
    <hr/>
    <h5>
     <a id="_397">
     </a>
     十、现代密码学工具总结
    </h5>
    <p>
     <strong>
      1. 常用工具
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       OpenSSL
      </strong>
      ：命令行工具，支持证书生成、格式转换、加解密。
      <pre><code class="prism language-bash"><span class="token comment"># 生成RSA私钥  </span>
openssl genpkey <span class="token parameter variable">-algorithm</span> RSA <span class="token parameter variable">-out</span> private.pem  
<span class="token comment"># 提取公钥  </span>
openssl rsa <span class="token parameter variable">-pubout</span> <span class="token parameter variable">-in</span> private.pem <span class="token parameter variable">-out</span> public.pem  
</code></pre>
     </li>
     <li>
      <strong>
       PyCryptodome
      </strong>
      ：Python密码学库，支持AES、RSA、哈希等。
      <pre><code class="prism language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES  
cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_GCM<span class="token punctuation">)</span>  <span class="token comment"># AES-GCM模式加密  </span>
</code></pre>
     </li>
     <li>
      <strong>
       hashlib
      </strong>
      ：Python标准库，支持SHA256、MD5等哈希算法。
      <pre><code class="prism language-python"><span class="token keyword">import</span> hashlib  
hash_obj <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span><span class="token string">b"data"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>  
</code></pre>
     </li>
    </ul>
    <p>
     <strong>
      2. 在线工具
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       Factordb
      </strong>
      ：大整数分解（
      <a href="http://factordb.com" rel="nofollow">
       factordb.com
      </a>
      ）。
     </li>
     <li>
      <strong>
       CyberChef
      </strong>
      ：多功能编解码工具（
      <a href="https://gchq.github.io/CyberChef" rel="nofollow">
       gchq.github.io/CyberChef
      </a>
      ）。
     </li>
    </ul>
    <hr/>
    <h5>
     <a id="_423">
     </a>
     十一、补充知识点
    </h5>
    <p>
     <strong>
      1. 哈希函数
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       特性
      </strong>
      ：单向性、抗碰撞性。
     </li>
     <li>
      <strong>
       应用场景
      </strong>
      ：文件完整性校验、密码存储。
      <pre><code class="prism language-python"><span class="token keyword">import</span> hashlib  
password <span class="token operator">=</span> <span class="token string">"123456"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>  
salt <span class="token operator">=</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>  
hashed <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>pbkdf2_hmac<span class="token punctuation">(</span><span class="token string">"sha256"</span><span class="token punctuation">,</span> password<span class="token punctuation">,</span> salt<span class="token punctuation">,</span> <span class="token number">100000</span><span class="token punctuation">)</span>  
</code></pre>
     </li>
    </ul>
    <p>
     <strong>
      2. 数字签名
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       流程
      </strong>
      ：
      <ol>
       <li>
        发送方用私钥签名数据。
       </li>
       <li>
        接收方用公钥验证签名。
       </li>
      </ol>
     </li>
     <li>
      <strong>
       示例（RSA签名）
      </strong>
      ：
      <pre><code class="prism language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Signature <span class="token keyword">import</span> pkcs1_15  
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Hash <span class="token keyword">import</span> SHA256  

<span class="token comment"># 签名  </span>
hash_obj <span class="token operator">=</span> SHA256<span class="token punctuation">.</span>new<span class="token punctuation">(</span>data<span class="token punctuation">)</span>  
signature <span class="token operator">=</span> pkcs1_15<span class="token punctuation">.</span>new<span class="token punctuation">(</span>private_key<span class="token punctuation">)</span><span class="token punctuation">.</span>sign<span class="token punctuation">(</span>hash_obj<span class="token punctuation">)</span>  

<span class="token comment"># 验签  </span>
<span class="token keyword">try</span><span class="token punctuation">:</span>  
    pkcs1_15<span class="token punctuation">.</span>new<span class="token punctuation">(</span>public_key<span class="token punctuation">)</span><span class="token punctuation">.</span>verify<span class="token punctuation">(</span>hash_obj<span class="token punctuation">,</span> signature<span class="token punctuation">)</span>  
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"验签成功"</span><span class="token punctuation">)</span>  
<span class="token keyword">except</span> <span class="token punctuation">(</span>ValueError<span class="token punctuation">,</span> TypeError<span class="token punctuation">)</span><span class="token punctuation">:</span>  
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"验签失败"</span><span class="token punctuation">)</span>  
</code></pre>
     </li>
    </ul>
    <hr/>
    <ul>
     <li>
     </li>
    </ul>
    <ul>
     <li>
      <strong>
       流程
      </strong>
      ：
      <ol>
       <li>
        发送方用私钥签名数据。
       </li>
       <li>
        接收方用公钥验证签名。
       </li>
      </ol>
     </li>
     <li>
      <strong>
       示例（RSA签名）
      </strong>
      ：
      <pre><code class="prism language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Signature <span class="token keyword">import</span> pkcs1_15  
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Hash <span class="token keyword">import</span> SHA256  

<span class="token comment"># 签名  </span>
hash_obj <span class="token operator">=</span> SHA256<span class="token punctuation">.</span>new<span class="token punctuation">(</span>data<span class="token punctuation">)</span>  
signature <span class="token operator">=</span> pkcs1_15<span class="token punctuation">.</span>new<span class="token punctuation">(</span>private_key<span class="token punctuation">)</span><span class="token punctuation">.</span>sign<span class="token punctuation">(</span>hash_obj<span class="token punctuation">)</span>  

<span class="token comment"># 验签  </span>
<span class="token keyword">try</span><span class="token punctuation">:</span>  
    pkcs1_15<span class="token punctuation">.</span>new<span class="token punctuation">(</span>public_key<span class="token punctuation">)</span><span class="token punctuation">.</span>verify<span class="token punctuation">(</span>hash_obj<span class="token punctuation">,</span> signature<span class="token punctuation">)</span>  
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"验签成功"</span><span class="token punctuation">)</span>  
<span class="token keyword">except</span> <span class="token punctuation">(</span>ValueError<span class="token punctuation">,</span> TypeError<span class="token punctuation">)</span><span class="token punctuation">:</span>  
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"验签失败"</span><span class="token punctuation">)</span>  
</code></pre>
     </li>
    </ul>
    <hr/>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f33363037363535362f:61727469636c652f64657461696c732f313436313938323732" class_="artid" style="display:none">
 </p>
</div>


