---
layout: post
title: "Excelä¸­ä½¿ç”¨VBAè‡ªåŠ¨ç”Ÿæˆæ’ç­è¡¨"
date: 2025-03-08 14:07:46 +0800
description: "åœ¨æˆ‘ä»¬æ’ç­è¿‡ç¨‹ä¸­ï¼Œä¼šæœ‰å¾ˆå¤šçš„é—®é¢˜ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„æœ‰å¤šå°‘ä¸ªäººï¼Œä»ä»€ä¹ˆæ—¶å€™å¼€å§‹æ’ç­ï¼ŒèŠ‚å‡æ—¥æ˜¯å¦è¦è¿›è¡Œæ’ç­ç­‰ç­‰ä¸€ç³»åˆ—é—®é¢˜ï¼Œæ‰‹åŠ¨æ’ç­çš„è¯ä¼šæœ‰å¾ˆå¤šçš„è¿™æ ·é‚£æ ·çš„é—®é¢˜ï¼Œé‚£æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥ä½¿ç”¨VBAä»£ç è¿›è¡Œæ’ç­å‘¢ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ¬ç¯‡æ–‡ç« å°±æ˜¯åŸºäºè¿™æ ·çš„ç›®çš„æ¥å±•å¼€çš„ã€‚ä»¥ä¸‹å°±æ˜¯æˆ‘ä»¬çš„è‡ªåŠ¨æ’ç­çš„ä»£ç äº†ï¼Œè®©æˆ‘ä»¬æ¥ä½¿ç”¨ä¸€ä¸‹å§ã€‚ç‚¹å‡»å¼€å‘å·¥å…·ï¼Œç‚¹å‡»æˆ‘ä»¬çš„VBAã€‚æ‰¾åˆ°å¯¹åº”çš„ä½ç½®ï¼Œç²˜è´´ä»£ç ã€‚å¦‚æœå¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·æ‚¨ã€‚"
keywords: "Excelä¸­ä½¿ç”¨VBAè‡ªåŠ¨ç”Ÿæˆæ’ç­è¡¨"
categories: ['Word', 'Ppt', 'Excel']
tags: ['Excel', 'Android']
artid: "146115166"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146115166
    alt: "Excelä¸­ä½¿ç”¨VBAè‡ªåŠ¨ç”Ÿæˆæ’ç­è¡¨"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146115166
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146115166
cover: https://bing.ee123.net/img/rand?artid=146115166
image: https://bing.ee123.net/img/rand?artid=146115166
img: https://bing.ee123.net/img/rand?artid=146115166
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Excelä¸­ä½¿ç”¨VBAè‡ªåŠ¨ç”Ÿæˆæ’ç­è¡¨
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <h2>
     <a id="1__3">
     </a>
     1. èƒŒæ™¯
    </h2>
    <p>
     åœ¨æˆ‘ä»¬æ’ç­è¿‡ç¨‹ä¸­ï¼Œä¼šæœ‰å¾ˆå¤šçš„é—®é¢˜ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„æœ‰å¤šå°‘ä¸ªäººï¼Œä»ä»€ä¹ˆæ—¶å€™å¼€å§‹æ’ç­ï¼ŒèŠ‚å‡æ—¥æ˜¯å¦è¦è¿›è¡Œæ’ç­ç­‰ç­‰ä¸€ç³»åˆ—é—®é¢˜ï¼Œæ‰‹åŠ¨æ’ç­çš„è¯ä¼šæœ‰å¾ˆå¤šçš„è¿™æ ·é‚£æ ·çš„é—®é¢˜ï¼Œé‚£æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥ä½¿ç”¨VBAä»£ç è¿›è¡Œæ’ç­å‘¢ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ¬ç¯‡æ–‡ç« å°±æ˜¯åŸºäºè¿™æ ·çš„ç›®çš„æ¥å±•å¼€çš„ã€‚
    </p>
    <h2>
     <a id="2__9">
     </a>
     2. ä»£ç 
    </h2>
    <p>
     ä»¥ä¸‹å°±æ˜¯æˆ‘ä»¬çš„è‡ªåŠ¨æ’ç­çš„ä»£ç äº†ï¼Œè®©æˆ‘ä»¬æ¥ä½¿ç”¨ä¸€ä¸‹å§
    </p>
    <pre><code class="prism language-js">Sub <span class="token function">GenerateSchedule</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    Dim startDate As Date
    Dim numPeople As Integer
    Dim <span class="token function">peopleNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span> As String
    Dim includeHolidays As Boolean
    Dim includeWeekends As Boolean
    
    ' <span class="token number">1.</span> è‡ªå®šä¹‰èµ·å§‹æ’ç­æ—¥æœŸ
    startDate <span class="token operator">=</span> <span class="token function">InputBox</span><span class="token punctuation">(</span><span class="token string">"è¯·è¾“å…¥èµ·å§‹æ’ç­æ—¥æœŸï¼ˆæ ¼å¼ï¼šyyyy-mm-ddï¼‰ï¼š"</span><span class="token punctuation">)</span>
    
    ' <span class="token number">2.</span> è‡ªå®šä¹‰æ’ç­äººå‘˜æ•°é‡å’Œå§“å
    numPeople <span class="token operator">=</span> <span class="token function">InputBox</span><span class="token punctuation">(</span><span class="token string">"è¯·è¾“å…¥æ’ç­äººå‘˜æ•°é‡ï¼š"</span><span class="token punctuation">)</span>
    ReDim <span class="token function">peopleNames</span><span class="token punctuation">(</span><span class="token number">1</span> To numPeople<span class="token punctuation">)</span>
    
    For i <span class="token operator">=</span> <span class="token number">1</span> To numPeople
        <span class="token function">peopleNames</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">InputBox</span><span class="token punctuation">(</span><span class="token string">"è¯·è¾“å…¥ç¬¬ "</span> <span class="token operator">&amp;</span> i <span class="token operator">&amp;</span> <span class="token string">" ä¸ªäººå‘˜çš„å§“åï¼š"</span><span class="token punctuation">)</span>
    Next i
    
    ' <span class="token number">3.</span> è‡ªå®šä¹‰é€‰æ‹©æ˜¯å¦è¦åœ¨èŠ‚å‡æ—¥æ’ç­
    includeHolidays <span class="token operator">=</span> <span class="token function">MsgBox</span><span class="token punctuation">(</span><span class="token string">"æ˜¯å¦åŒ…æ‹¬èŠ‚å‡æ—¥åœ¨å†…ï¼Ÿé€‰æ‹©æ˜¯ï¼ˆæ˜¯ï¼‰æˆ–å¦ï¼ˆå¦ï¼‰ã€‚"</span><span class="token punctuation">,</span> vbYesNo<span class="token punctuation">)</span> <span class="token operator">=</span> vbYes
    
    ' <span class="token number">4.</span> è‡ªå®šä¹‰é€‰æ‹©æ˜¯å¦è¦åœ¨å‘¨å…­å‘¨æ—¥æ’ç­
    includeWeekends <span class="token operator">=</span> <span class="token function">MsgBox</span><span class="token punctuation">(</span><span class="token string">"æ˜¯å¦åŒ…æ‹¬å‘¨æœ«åœ¨å†…ï¼Ÿé€‰æ‹©æ˜¯ï¼ˆæ˜¯ï¼‰æˆ–å¦ï¼ˆå¦ï¼‰ã€‚"</span><span class="token punctuation">,</span> vbYesNo<span class="token punctuation">)</span> <span class="token operator">=</span> vbYes
    
    ' è¾“å‡ºç»“æœåˆ°å·¥ä½œè¡¨
    Dim ws As Worksheet
    Set ws <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>Sheets<span class="token punctuation">.</span>Add
    
    Dim currentDate As Date
    currentDate <span class="token operator">=</span> startDate
    
    Dim rowCounter As Integer
    rowCounter <span class="token operator">=</span> <span class="token number">1</span>
    
    Do While <span class="token function">Month</span><span class="token punctuation">(</span>currentDate<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">Month</span><span class="token punctuation">(</span>startDate<span class="token punctuation">)</span>
        <span class="token function">If</span> <span class="token punctuation">(</span>includeWeekends <span class="token function">Or</span> <span class="token punctuation">(</span><span class="token function">Weekday</span><span class="token punctuation">(</span>currentDate<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token number">1</span> And <span class="token function">Weekday</span><span class="token punctuation">(</span>currentDate<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">And</span> <span class="token punctuation">(</span>includeHolidays Or <span class="token function">Not</span> <span class="token punctuation">(</span><span class="token function">IsHoliday</span><span class="token punctuation">(</span>currentDate<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> Then
            ws<span class="token punctuation">.</span><span class="token function">Cells</span><span class="token punctuation">(</span>rowCounter<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> currentDate
            ws<span class="token punctuation">.</span><span class="token function">Cells</span><span class="token punctuation">(</span>rowCounter<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token function">peopleNames</span><span class="token punctuation">(</span><span class="token punctuation">(</span>rowCounter <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> Mod numPeople <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
            rowCounter <span class="token operator">=</span> rowCounter <span class="token operator">+</span> <span class="token number">1</span>
        End If
        currentDate <span class="token operator">=</span> currentDate <span class="token operator">+</span> <span class="token number">1</span>
    Loop
    
    MsgBox <span class="token string">"æ’ç­è¡¨ç”Ÿæˆå®Œæˆï¼"</span>
End Sub

Function <span class="token function">IsHoliday</span><span class="token punctuation">(</span>dt As Date<span class="token punctuation">)</span> As Boolean
    ' åœ¨è¿™é‡Œå¯ä»¥æ·»åŠ èŠ‚å‡æ—¥åˆ¤æ–­çš„é€»è¾‘ï¼Œä¾‹å¦‚å›½å®¶æ³•å®šèŠ‚å‡æ—¥ç­‰
    ' è¿™é‡Œç®€åŒ–ä¸ºæ²¡æœ‰èŠ‚å‡æ—¥çš„æƒ…å†µ
    IsHoliday <span class="token operator">=</span> False
End Function

</code></pre>
    <h2>
     <a id="2__65">
     </a>
     2. ä»£ç ä½¿ç”¨
    </h2>
    <p>
     ç‚¹å‡»å¼€å‘å·¥å…·ï¼Œç‚¹å‡»æˆ‘ä»¬çš„VBA
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/00a8001dac194af2b34902ff21d86354.png">
      <br/>
      æ‰¾åˆ°å¯¹åº”çš„ä½ç½®ï¼Œç²˜è´´ä»£ç 
      <br/>
      <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/33b87b6900b54e1fb384bcae57e1974b.png">
       <br/>
       å…³é—­ä¹‹åï¼Œç‚¹å‡»å®
       <br/>
       <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/d2e97209c56946c2ad1eb544dfb71d61.png">
        <br/>
        å¼€å§‹æ‰§è¡Œ
        <br/>
        <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/40c310b4773f463cb64699892d2898ec.png"/>
       </img>
      </img>
     </img>
    </p>
    <p>
     è¾“å…¥èµ·å§‹æ’ç­æ—¥æœŸ
     <br/>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/bc79e6dd4fbd452c837fbad0ea4be75e.png">
      <br/>
      è¾“å…¥æ’ç­äººå‘˜æ•°é‡
      <br/>
      <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/be39b071c39a4793805d729af1f53aaa.png">
       <br/>
       è¾“å…¥æ’ç­äººå‘˜çš„å§“å
       <br/>
       <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/b15738ce953841389d6f02824bb2b105.png"/>
      </img>
     </img>
    </p>
    <p>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/52237945d40a4e0eb4a9a2844bea1738.png"/>
    </p>
    <p>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/402418da7e6440e5bb79a6ee09f4977f.png"/>
     <br/>
     é€‰æ‹©æ˜¯å¦åŒ…æ‹¬èŠ‚å‡æ—¥
     <br/>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/162c3ef754e74b85889538167697dff8.png"/>
     <br/>
     é€‰æ‹©æ˜¯å¦åŒ…æ‹¬å‘¨æœ«
     <br/>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/604baa89117f4d85bab89834a066e3c0.png"/>
    </p>
    <p>
     å®Œæˆ
    </p>
    <p>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/132cf5f49d304277a12f428c1de47ace.png"/>
     <br/>
     æˆ‘ä»¬è¿›è¡Œç®€å•çš„ç¾åŒ–
     <br/>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/79e45ce8d0614a24b2739e6c300a542b.png"/>
    </p>
    <h2>
     <a id="4__95">
     </a>
     4. å…¶ä»–æ–‡ç« 
    </h2>
    <h2>
     <a id="5__97">
     </a>
     5. æ›´å¤šç´ æ
    </h2>
    <p>
     <strong>
      <a href="https://blog.csdn.net/m0_62979475/article/details/144946889">
       å…¨éƒ¨Excelç»ƒä¹ ç´ æ
      </a>
     </strong>
     ğŸ‘ˆç‚¹å‡»å³å¯è¿›è¡ŒæŸ¥çœ‹
    </p>
    <p>
     å¦‚æœå¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·æ‚¨
     <code>
      ç‚¹èµã€æ”¶è—ã€å…³æ³¨ã€è½¬å‘
     </code>
     ï¼Œè®©æ›´å¤šçš„äººçœ‹åˆ°ã€‚
    </p>
    <blockquote>
     <h2>
      <a id="_103">
      </a>
      å¿«æ¥è¯•è¯•å§ğŸ¥°
     </h2>
    </blockquote>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f36323937393437352f:61727469636c652f64657461696c732f313436313135313636" class_="artid" style="display:none">
 </p>
</div>


