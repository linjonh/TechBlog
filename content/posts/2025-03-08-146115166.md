---
arturl_encode: "68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f36323937393437352f:61727469636c652f64657461696c732f313436313135313636"
layout: post
title: "Excelä¸­ä½¿ç”¨VBAè‡ªåŠ¨ç”Ÿæˆæ’ç­è¡¨"
date: 2025-03-08 14:07:46 +0800
description: "åœ¨æˆ‘ä»¬æ’ç­è¿‡ç¨‹ä¸­ï¼Œä¼šæœ‰å¾ˆå¤šçš„é—®é¢˜ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„æœ‰å¤šå°‘ä¸ªäººï¼Œä»ä»€ä¹ˆæ—¶å€™å¼€å§‹æ’ç­ï¼ŒèŠ‚å‡æ—¥æ˜¯å¦è¦è¿›è¡Œæ’ç­ç­‰ç­‰ä¸€ç³»åˆ—é—®é¢˜ï¼Œæ‰‹åŠ¨æ’ç­çš„è¯ä¼šæœ‰å¾ˆå¤šçš„è¿™æ ·é‚£æ ·çš„é—®é¢˜ï¼Œé‚£æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥ä½¿ç”¨VBAä»£ç è¿›è¡Œæ’ç­å‘¢ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ¬ç¯‡æ–‡ç« å°±æ˜¯åŸºäºè¿™æ ·çš„ç›®çš„æ¥å±•å¼€çš„ã€‚ä»¥ä¸‹å°±æ˜¯æˆ‘ä»¬çš„è‡ªåŠ¨æ’ç­çš„ä»£ç äº†ï¼Œè®©æˆ‘ä»¬æ¥ä½¿ç”¨ä¸€ä¸‹å§ã€‚ç‚¹å‡»å¼€å‘å·¥å…·ï¼Œç‚¹å‡»æˆ‘ä»¬çš„VBAã€‚æ‰¾åˆ°å¯¹åº”çš„ä½ç½®ï¼Œç²˜è´´ä»£ç ã€‚å¦‚æœå¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·æ‚¨ã€‚"
keywords: "Excelä¸­ä½¿ç”¨VBAè‡ªåŠ¨ç”Ÿæˆæ’ç­è¡¨"
categories: ['Word', 'Ppt', 'Excel']
tags: ['Excel', 'Android']
artid: "146115166"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146115166
    alt: "Excelä¸­ä½¿ç”¨VBAè‡ªåŠ¨ç”Ÿæˆæ’ç­è¡¨"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146115166
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146115166
cover: https://bing.ee123.net/img/rand?artid=146115166
image: https://bing.ee123.net/img/rand?artid=146115166
img: https://bing.ee123.net/img/rand?artid=146115166
---

# Excelä¸­ä½¿ç”¨VBAè‡ªåŠ¨ç”Ÿæˆæ’ç­è¡¨

## 1. èƒŒæ™¯

åœ¨æˆ‘ä»¬æ’ç­è¿‡ç¨‹ä¸­ï¼Œä¼šæœ‰å¾ˆå¤šçš„é—®é¢˜ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„æœ‰å¤šå°‘ä¸ªäººï¼Œä»ä»€ä¹ˆæ—¶å€™å¼€å§‹æ’ç­ï¼ŒèŠ‚å‡æ—¥æ˜¯å¦è¦è¿›è¡Œæ’ç­ç­‰ç­‰ä¸€ç³»åˆ—é—®é¢˜ï¼Œæ‰‹åŠ¨æ’ç­çš„è¯ä¼šæœ‰å¾ˆå¤šçš„è¿™æ ·é‚£æ ·çš„é—®é¢˜ï¼Œé‚£æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥ä½¿ç”¨VBAä»£ç è¿›è¡Œæ’ç­å‘¢ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ¬ç¯‡æ–‡ç« å°±æ˜¯åŸºäºè¿™æ ·çš„ç›®çš„æ¥å±•å¼€çš„ã€‚

## 2. ä»£ç 

ä»¥ä¸‹å°±æ˜¯æˆ‘ä»¬çš„è‡ªåŠ¨æ’ç­çš„ä»£ç äº†ï¼Œè®©æˆ‘ä»¬æ¥ä½¿ç”¨ä¸€ä¸‹å§

```js
Sub GenerateSchedule()
    Dim startDate As Date
    Dim numPeople As Integer
    Dim peopleNames() As String
    Dim includeHolidays As Boolean
    Dim includeWeekends As Boolean
    
    ' 1. è‡ªå®šä¹‰èµ·å§‹æ’ç­æ—¥æœŸ
    startDate = InputBox("è¯·è¾“å…¥èµ·å§‹æ’ç­æ—¥æœŸï¼ˆæ ¼å¼ï¼šyyyy-mm-ddï¼‰ï¼š")
    
    ' 2. è‡ªå®šä¹‰æ’ç­äººå‘˜æ•°é‡å’Œå§“å
    numPeople = InputBox("è¯·è¾“å…¥æ’ç­äººå‘˜æ•°é‡ï¼š")
    ReDim peopleNames(1 To numPeople)
    
    For i = 1 To numPeople
        peopleNames(i) = InputBox("è¯·è¾“å…¥ç¬¬ " & i & " ä¸ªäººå‘˜çš„å§“åï¼š")
    Next i
    
    ' 3. è‡ªå®šä¹‰é€‰æ‹©æ˜¯å¦è¦åœ¨èŠ‚å‡æ—¥æ’ç­
    includeHolidays = MsgBox("æ˜¯å¦åŒ…æ‹¬èŠ‚å‡æ—¥åœ¨å†…ï¼Ÿé€‰æ‹©æ˜¯ï¼ˆæ˜¯ï¼‰æˆ–å¦ï¼ˆå¦ï¼‰ã€‚", vbYesNo) = vbYes
    
    ' 4. è‡ªå®šä¹‰é€‰æ‹©æ˜¯å¦è¦åœ¨å‘¨å…­å‘¨æ—¥æ’ç­
    includeWeekends = MsgBox("æ˜¯å¦åŒ…æ‹¬å‘¨æœ«åœ¨å†…ï¼Ÿé€‰æ‹©æ˜¯ï¼ˆæ˜¯ï¼‰æˆ–å¦ï¼ˆå¦ï¼‰ã€‚", vbYesNo) = vbYes
    
    ' è¾“å‡ºç»“æœåˆ°å·¥ä½œè¡¨
    Dim ws As Worksheet
    Set ws = ThisWorkbook.Sheets.Add
    
    Dim currentDate As Date
    currentDate = startDate
    
    Dim rowCounter As Integer
    rowCounter = 1
    
    Do While Month(currentDate) = Month(startDate)
        If (includeWeekends Or (Weekday(currentDate) <> 1 And Weekday(currentDate) <> 7)) And (includeHolidays Or Not (IsHoliday(currentDate))) Then
            ws.Cells(rowCounter, 1).Value = currentDate
            ws.Cells(rowCounter, 2).Value = peopleNames((rowCounter - 1) Mod numPeople + 1)
            rowCounter = rowCounter + 1
        End If
        currentDate = currentDate + 1
    Loop
    
    MsgBox "æ’ç­è¡¨ç”Ÿæˆå®Œæˆï¼"
End Sub

Function IsHoliday(dt As Date) As Boolean
    ' åœ¨è¿™é‡Œå¯ä»¥æ·»åŠ èŠ‚å‡æ—¥åˆ¤æ–­çš„é€»è¾‘ï¼Œä¾‹å¦‚å›½å®¶æ³•å®šèŠ‚å‡æ—¥ç­‰
    ' è¿™é‡Œç®€åŒ–ä¸ºæ²¡æœ‰èŠ‚å‡æ—¥çš„æƒ…å†µ
    IsHoliday = False
End Function


```

## 2. ä»£ç ä½¿ç”¨

ç‚¹å‡»å¼€å‘å·¥å…·ï¼Œç‚¹å‡»æˆ‘ä»¬çš„VBA
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/00a8001dac194af2b34902ff21d86354.png)
  
æ‰¾åˆ°å¯¹åº”çš„ä½ç½®ï¼Œç²˜è´´ä»£ç 
  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/33b87b6900b54e1fb384bcae57e1974b.png)
  
å…³é—­ä¹‹åï¼Œç‚¹å‡»å®
  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/d2e97209c56946c2ad1eb544dfb71d61.png)
  
å¼€å§‹æ‰§è¡Œ
  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/40c310b4773f463cb64699892d2898ec.png)

è¾“å…¥èµ·å§‹æ’ç­æ—¥æœŸ
  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/bc79e6dd4fbd452c837fbad0ea4be75e.png)
  
è¾“å…¥æ’ç­äººå‘˜æ•°é‡
  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/be39b071c39a4793805d729af1f53aaa.png)
  
è¾“å…¥æ’ç­äººå‘˜çš„å§“å
  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/b15738ce953841389d6f02824bb2b105.png)

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/52237945d40a4e0eb4a9a2844bea1738.png)

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/402418da7e6440e5bb79a6ee09f4977f.png)
  
é€‰æ‹©æ˜¯å¦åŒ…æ‹¬èŠ‚å‡æ—¥
  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/162c3ef754e74b85889538167697dff8.png)
  
é€‰æ‹©æ˜¯å¦åŒ…æ‹¬å‘¨æœ«
  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/604baa89117f4d85bab89834a066e3c0.png)

å®Œæˆ

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/132cf5f49d304277a12f428c1de47ace.png)
  
æˆ‘ä»¬è¿›è¡Œç®€å•çš„ç¾åŒ–
  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/79e45ce8d0614a24b2739e6c300a542b.png)

## 4. å…¶ä»–æ–‡ç« 

## 5. æ›´å¤šç´ æ

**[å…¨éƒ¨Excelç»ƒä¹ ç´ æ](https://blog.csdn.net/m0_62979475/article/details/144946889)**
ğŸ‘ˆç‚¹å‡»å³å¯è¿›è¡ŒæŸ¥çœ‹

å¦‚æœå¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·æ‚¨
`ç‚¹èµã€æ”¶è—ã€å…³æ³¨ã€è½¬å‘`
ï¼Œè®©æ›´å¤šçš„äººçœ‹åˆ°ã€‚

> ## å¿«æ¥è¯•è¯•å§ğŸ¥°