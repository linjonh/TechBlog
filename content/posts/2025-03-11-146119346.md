---
layout: post
title: "BGP-规划问题路由黑洞与环路"
date: 2025-03-11 18:19:25 +0800
description: "当路由器从一个IBGP对等体学习到某条BGP路由时，它将不能再把这条路由通告给任何IBGP对等体。IBGP 邻居间要是没运行 BGP 的路由器，就像快递没中转站，路由拿不到，数据包自然被丢弃。通过AS_PATH属性防环，在学习到的路由中，若有本地AS号，则拒绝学习，防止环路。BGP 网络规划要是没弄好，就像走迷宫没地图，很容易出幺蛾子，比如路由黑洞。想象一下，数据包兴高采烈去旅行，结果在路由器这被 “扔掉”，多惨！造成问题：一些路由器无法学到去往其他AS的路由。2.1、EBGP水平分割（过AS_PATH）"
keywords: "bgp路由黑洞的产生"
categories: ['网络安全从小白到大神']
tags: ['网络安全', '网络协议', '网络', '智能路由器', 'Bgp']
artid: "146119346"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146119346
    alt: "BGP-规划问题路由黑洞与环路"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146119346
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146119346
cover: https://bing.ee123.net/img/rand?artid=146119346
image: https://bing.ee123.net/img/rand?artid=146119346
img: https://bing.ee123.net/img/rand?artid=146119346
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     BGP 规划问题、路由黑洞与环路
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h3>
     1、BGP 规划问题与路由黑洞
    </h3>
    <blockquote>
     <p>
      BGP 网络规划要是没弄好，就像走迷宫没地图，很容易出幺蛾子，比如路由黑洞。
     </p>
     <p>
      想象一下，数据包兴高采烈去旅行，结果在路由器这被 “扔掉”，多惨！
     </p>
    </blockquote>
    <h4>
     <img alt="" height="441" src="https://i-blog.csdnimg.cn/direct/c3e0bb68b61b4a8fad5fb195fbfa7015.png" width="830"/>
    </h4>
    <h4>
     1.1、路由黑洞咋来的？
    </h4>
    <p>
     IBGP 邻居间要是没运行 BGP 的路由器，就像快递没中转站，路由拿不到，数据包自然被丢弃。
    </p>
    <h4>
     1.2、解决办法
    </h4>
    <table>
     <thead>
      <tr>
       <th style="width:121px">
        方法
       </th>
       <th style="width:310px">
        优点
       </th>
       <th style="width:258px">
        缺点
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td style="width:121px">
        BGP 引入 IGP
       </td>
       <td style="width:310px">
        能解决黑洞
       </td>
       <td style="width:258px">
        外部路由多，内网路由器可能 “累趴下”
       </td>
      </tr>
      <tr>
       <td style="width:121px">
        <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
         <span style="color:#0d0016">
          在黑洞路由器上
         </span>
        </p>
        配静态路由
       </td>
       <td style="width:310px">
        简单直接
       </td>
       <td style="width:258px">
        目的网段多，管理员要 “疯”
       </td>
      </tr>
      <tr>
       <td style="width:121px">
        IBGP 全连接
       </td>
       <td style="width:310px">
        有效防黑洞
       </td>
       <td style="width:258px">
        邻居多，配置工作量大
       </td>
      </tr>
      <tr>
       <td style="width:121px">
        路由反射器
       </td>
       <td style="width:310px">
        减少邻居关系，无视防环
       </td>
       <td style="width:258px">
        -
       </td>
      </tr>
      <tr>
       <td style="width:121px">
        BGP联盟
       </td>
       <td style="width:310px">
        避开 IBGP全连接大坑（IBGP水平分割限制）
       </td>
       <td style="width:258px">
        -
       </td>
      </tr>
     </tbody>
    </table>
    <h3>
     2、BGP 环路问题
    </h3>
    <h4 style="margin-left:0.0001pt; margin-right:0px; text-align:justify">
     <span style="color:#000000">
      2.1、EBGP水平分割（过AS_PATH）
     </span>
    </h4>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     <span style="color:#000000">
      通过AS_PATH属性防环，在学习到的路由中，若有本地AS号，则拒绝学习，防止环路
     </span>
    </p>
    <h4 style="margin-left:0.0001pt; margin-right:0px; text-align:justify">
     <span style="color:#000000">
      2.2、IBGP水平分割
     </span>
    </h4>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     <span style="color:#000000">
      当路由器从一个IBGP对等体学习到某条BGP路由时，它将不能再把这条路由通告给任何IBGP对等体。
     </span>
    </p>
    <blockquote>
     <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
      <span style="color:#000000">
       造成问题：一些路由器无法学到去往其他AS的路由
      </span>
     </p>
     <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
      <span style="color:#000000">
       解决方法：路由反射器和联盟
      </span>
     </p>
    </blockquote>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323430315f38363531313231362f:61727469636c652f64657461696c732f313436313139333436" class_="artid" style="display:none">
 </p>
</div>


