---
layout: post
title: "git-reset的使用,以及解决还原后如何找回"
date: 2025-03-12 11:12:22 +0800
description: "git reset的使用，以及解决还原后如何找回"
keywords: "git reset的使用，以及解决还原后如何找回"
categories: ['知识点', '工具类']
tags: ['Spring', 'Gitee', 'Git', 'Boot']
artid: "146199743"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146199743
    alt: "git-reset的使用,以及解决还原后如何找回"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146199743
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146199743
cover: https://bing.ee123.net/img/rand?artid=146199743
image: https://bing.ee123.net/img/rand?artid=146199743
img: https://bing.ee123.net/img/rand?artid=146199743
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     git reset的使用，以及解决还原后如何找回
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <h2>
     <a id="git_reset__1">
     </a>
     git reset 详解
    </h2>
    <p>
     <code>
      git reset
     </code>
     是 Git 中一个功能强大且较为复杂的命令，它主要用于重置当前
     <code>
      HEAD
     </code>
     到指定的状态，能够改变提交历史，还会对工作区和暂存区产生不同的影响。下面详细介绍其作用和常用参数。
    </p>
    <h3>
     <a id="_4">
     </a>
     命令作用
    </h3>
    <p>
     <code>
      git reset
     </code>
     命令的核心作用是将当前分支的
     <code>
      HEAD
     </code>
     指针移动到指定的提交位置，并且可以根据不同的参数选项来决定是否更新暂存区和工作区的内容。这使得我们可以撤销提交、修改提交历史，或者将暂存区的内容恢复到某个特定的状态。
    </p>
    <h3>
     <a id="_7">
     </a>
     常用参数
    </h3>
    <h4>
     <a id="1_soft_8">
     </a>
     1.
     <code>
      --soft
     </code>
    </h4>
    <ul>
     <li>
      <strong>
       作用
      </strong>
      ：仅移动
      <code>
       HEAD
      </code>
      指针到指定的提交，不改变暂存区和工作区的内容。被重置的提交所做的更改会保留在暂存区中，可直接再次提交这些更改。
     </li>
     <li>
      <strong>
       示例
      </strong>
      ：
      <br/>
      假设提交历史为
      <code>
       A -- B -- C (HEAD -&gt; main)
      </code>
      ，执行
      <code>
       git reset --soft HEAD~1
      </code>
      后，提交历史变为
      <code>
       A -- B (HEAD -&gt; main)
      </code>
      ，但
      <code>
       C
      </code>
      提交的更改仍在暂存区，可直接
      <code>
       git commit
      </code>
      重新提交。
     </li>
    </ul>
    <h4>
     <a id="2_mixed_13">
     </a>
     2.
     <code>
      --mixed
     </code>
     （默认参数，可省略）
    </h4>
    <ul>
     <li>
      <strong>
       作用
      </strong>
      ：移动
      <code>
       HEAD
      </code>
      指针到指定的提交，并更新暂存区，使其与指定提交的内容一致，但工作区的内容不会改变。这意味着被重置的提交所做的更改会从暂存区移除，但仍保留在工作区中，需要重新添加到暂存区才能提交。
     </li>
     <li>
      <strong>
       示例
      </strong>
      ：
      <br/>
      同样对于提交历史
      <code>
       A -- B -- C (HEAD -&gt; main)
      </code>
      ，执行
      <code>
       git reset HEAD~1
      </code>
      （等同于
      <code>
       git reset --mixed HEAD~1
      </code>
      ）后，提交历史变为
      <code>
       A -- B (HEAD -&gt; main)
      </code>
      ，
      <code>
       C
      </code>
      提交的更改从暂存区移除，在工作区中显示为已修改但未暂存的状态，需要执行
      <code>
       git add
      </code>
      重新添加到暂存区。
     </li>
    </ul>
    <h4>
     <a id="3_hard_18">
     </a>
     3.
     <code>
      --hard
     </code>
    </h4>
    <ul>
     <li>
      <strong>
       作用
      </strong>
      ：移动
      <code>
       HEAD
      </code>
      指针到指定的提交，同时更新暂存区和工作区，使其都与指定提交的内容一致。这是一个比较危险的操作，因为它会丢弃工作区和暂存区中所有未提交的更改，直接将它们恢复到指定提交的状态。
     </li>
     <li>
      <strong>
       示例
      </strong>
      ：
      <br/>
      还是提交历史
      <code>
       A -- B -- C (HEAD -&gt; main)
      </code>
      ，执行
      <code>
       git reset --hard HEAD~1
      </code>
      后，提交历史变为
      <code>
       A -- B (HEAD -&gt; main)
      </code>
      ，
      <code>
       C
      </code>
      提交的更改不仅从暂存区移除，工作区中相应的更改也会被丢弃，恢复到提交
      <code>
       B
      </code>
      时的状态。
     </li>
    </ul>
    <h4>
     <a id="4__23">
     </a>
     4. 提交引用
    </h4>
    <ul>
     <li>
      <strong>
       作用
      </strong>
      ：除了上述参数，
      <code>
       git reset
      </code>
      还需要指定一个提交引用，用于确定要将
      <code>
       HEAD
      </code>
      指针移动到哪个提交位置。常见的提交引用方式有：
      <ul>
       <li>
        <strong>
         提交哈希值
        </strong>
        ：使用完整或部分的提交哈希值来指定具体的提交，例如
        <code>
         git reset --hard 1234567
        </code>
        ，将
        <code>
         HEAD
        </code>
        指针移动到哈希值以
        <code>
         1234567
        </code>
        开头的提交。
       </li>
       <li>
        <strong>
         相对引用
        </strong>
        ：使用
        <code>
         ~
        </code>
        和
        <code>
         ^
        </code>
        操作符来表示相对于当前提交的位置。
        <code>
         ~n
        </code>
        表示向上移动
        <code>
         n
        </code>
        个提交，
        <code>
         ^
        </code>
        表示父提交，例如
        <code>
         HEAD~1
        </code>
        表示当前提交的前一个提交，
        <code>
         HEAD^^
        </code>
        表示当前提交的祖父提交。
       </li>
      </ul>
     </li>
    </ul>
    <h3>
     <a id="_27">
     </a>
     总结
    </h3>
    <ul>
     <li>
      <code>
       --soft
      </code>
      ：仅移动
      <code>
       HEAD
      </code>
      ，保留暂存区和工作区更改。
     </li>
     <li>
      <code>
       --mixed
      </code>
      ：移动
      <code>
       HEAD
      </code>
      并更新暂存区，保留工作区更改。
     </li>
     <li>
      <code>
       --hard
      </code>
      ：移动
      <code>
       HEAD
      </code>
      ，同时更新暂存区和工作区，丢弃未提交更改。
     </li>
    </ul>
    <p>
     在使用
     <code>
      git reset
     </code>
     命令时，尤其是使用
     <code>
      --hard
     </code>
     参数时，要格外小心，因为它可能会导致数据丢失。在操作之前，建议先备份重要的更改或使用
     <code>
      git stash
     </code>
     暂存工作区的修改。
    </p>
    <h2>
     <a id="git_reset_hard_HEAD__35">
     </a>
     git reset --hard HEAD^ 还原代码如何找回？
    </h2>
    <h3>
     <a id="_git_reflog_36">
     </a>
     利用 git reflog找回
    </h3>
    <p>
     <code>
      git reflog
     </code>
     会记录所有的
     <code>
      HEAD
     </code>
     引用变化，包括
     <code>
      git reset
     </code>
     操作，即使提交已经不在当前分支的历史中，也能在
     <code>
      reflog
     </code>
     中找到相关记录。
    </p>
    <p>
     操作步骤：
    </p>
    <pre><code class="prism language-bash"><span class="token function">git</span> reflog
</code></pre>
    <p>
     该命令会列出所有 HEAD 的移动记录，每条记录包含一个哈希值、移动操作的描述和对应的时间，示例输出如下：
    </p>
    <pre><code class="prism language-text">3456789 HEAD@{0}: reset: moving to HEAD^
1234567 HEAD@{1}: commit: [之前的提交信息]
</code></pre>
    <p>
     恢复到指定提交
    </p>
    <ul>
     <li>
      从 reflog 中找到你想要恢复到的提交的哈希值（例如上面的 1234567），然后执行以下命令进行恢复：
     </li>
    </ul>
    <pre><code class="prism language-bash"><span class="token function">git</span> reset <span class="token parameter variable">--hard</span> <span class="token number">1234567</span>
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f6e656f5f47677832332f:61727469636c652f64657461696c732f313436313939373433" class_="artid" style="display:none">
 </p>
</div>


