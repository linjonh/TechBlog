---
layout: post
title: "Mybatis集合嵌套查询,三级嵌套"
date: 2025-03-06 14:40:39 +0800
description: "三个表：房间 + 玩家 + 玩家信息。前端得到的json结构。"
keywords: "Mybatis集合嵌套查询，三级嵌套"
categories: ['未分类']
tags: ['Tomcat', 'Mybatis', 'Java']
artid: "146070250"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146070250
    alt: "Mybatis集合嵌套查询,三级嵌套"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146070250
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146070250
cover: https://bing.ee123.net/img/rand?artid=146070250
image: https://bing.ee123.net/img/rand?artid=146070250
img: https://bing.ee123.net/img/rand?artid=146070250
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Mybatis集合嵌套查询，三级嵌套
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     三个表：房间 + 玩家 + 玩家信息
    </p>
    <p>
     知识点：Mybatis中级联有关联（association）、集合（collection）、鉴别器（discriminator）三种。其中，association对应一对一关系、collection对应一对多关系、discriminator可以根据情况选择采用哪个类作为实例，关联不同的结果集。
    </p>
    <p>
     参考文章：
     <a href="https://www.cnblogs.com/aaron-shu/p/7812755.html" rel="nofollow" title="Mybatis级联：关联、集合和鉴别器的使用 - aaron_shu - 博客园">
      Mybatis级联：关联、集合和鉴别器的使用 - aaron_shu - 博客园
     </a>
    </p>
    <pre><code># room.java

private List&lt;Player&gt; player;

    public List&lt;Player&gt; getPlayer()
    {
        return player;
    }

    public void setPlayer(List&lt;Player&gt; player)
    {
        this.player = player;
    }</code></pre>
    <pre><code>&lt;resultMap type="Room" id="RoomResult"&gt;
        &lt;id     property="roomId"       column="room_id"      /&gt;
        &lt;result property="roomTitle"     column="room_title"    /&gt;
        &lt;result property="roomOwnerId"     column="room_owner_id"    /&gt;
		&lt;result property="roomTags" column="room_tags" /&gt;
		&lt;result property="scoreMode"  column="score_mode" /&gt;
		&lt;result property="qrCode" column="qr_code" /&gt;
		&lt;result property="appId" column="app_id" /&gt;
		&lt;result property="isPlaten" column="is_platen" /&gt;
		&lt;result property="userId" column="user_id" /&gt;
		&lt;result property="shopId" column="shop_id" /&gt;
		&lt;result property="status"       column="status"       /&gt;
		&lt;result property="delFlag" 		column="del_flag" /&gt;
		&lt;result property="remark"       column="remark"       /&gt;
		&lt;result property="createBy"     column="create_by"    /&gt;
		&lt;result property="createTime"   column="create_time"  /&gt;
		&lt;result property="updateBy"     column="update_by"    /&gt;
		&lt;result property="updateTime"   column="update_time"  /&gt;
		&lt;collection property="player"    javaType="ArrayList"  ofType="Player" resultMap="playerResult" /&gt;
	&lt;/resultMap&gt;

	&lt;resultMap id="playerResult" type="Player"&gt;
		&lt;result property="roomId"    column="room_id"       /&gt;
		&lt;result property="playerScore"     	column="player_score"    /&gt;
		&lt;result property="isOnlooker"     	column="is_onlooker"    /&gt;
		&lt;result property="userId"     		column="user_id"    /&gt;
		&lt;association property="customerUser" javaType="CustomerUser"  resultMap="customerUserResult" /&gt;
	&lt;/resultMap&gt;

	&lt;resultMap id="customerUserResult" type="CustomerUser"&gt;
		&lt;result property="userId"    	column="user_id"       /&gt;
		&lt;result property="nickName"     column="nick_name"    /&gt;
		&lt;result property="avatar"       column="avatar"       /&gt;
	&lt;/resultMap&gt;
	
	&lt;sql id="selectRoomVo"&gt;
        select d.room_id, d.room_title, d.room_owner_id, d.score_mode, d.room_tags, d.qr_code,
        d.app_id, d.is_platen, d.del_flag, d.user_id, d.shop_id,
        p.player_score, p.is_onlooker, p.user_id,
	    c.nick_name, c.avatar,
	    d.remark, d.status, d.create_by, d.update_by, d.create_time, d.update_time
		from tb_room d
		left join tb_player p on p.room_id = d.room_id
		left join tb_customer_user c on c.user_id = p.user_id
	&lt;/sql&gt;</code></pre>
    <p>
     前端得到的json结构
    </p>
    <pre><code>{
    "msg": "操作成功",
    "code": 200,
    "data": {
        "createBy": "",
        "createTime": "2025-03-06 12:15:09",
        "updateBy": "",,
        "delFlag": "1",
        "player": [
            {
                "createBy": null,
                "customerUser": {
                    "createBy": null,
                    "createTime": null, 
                    "avatar": "https://img1.baidu.com/it/u=2587875867,850432697&amp;fm=253&amp;fmt=auto&amp;app=120&amp;f=JPEG?w=800&amp;h=800",
                }
            }
        ]
    }
}</code></pre>
    <p>
     <img alt="" height="573" src="https://i-blog.csdnimg.cn/direct/fc52bf0455784b44918aa21a9f5ac64b.png" width="801"/>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34303931383134352f:61727469636c652f64657461696c732f313436303730323530" class_="artid" style="display:none">
 </p>
</div>


