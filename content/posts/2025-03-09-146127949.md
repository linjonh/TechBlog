---
layout: post
title: "使用-Python-批量提取-PDF-书签一款实用工具的实现"
date: 2025-03-09 09:53:43 +0800
description: "这款工具展示了 Python 在文件处理和自动化任务中的强大能力。通过几行代码，我们实现了一个实用的小程序，不仅节省时间，还能轻松扩展功能（比如支持其他格式或添加图形界面）。希望这篇文章能激发你对 Python 的兴趣，也欢迎根据自己的需求改进这个脚本！"
keywords: "使用 Python 批量提取 PDF 书签：一款实用工具的实现"
categories: ['Python']
tags: ['Python', 'Pdf']
artid: "146127949"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146127949
    alt: "使用-Python-批量提取-PDF-书签一款实用工具的实现"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146127949
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146127949
cover: https://bing.ee123.net/img/rand?artid=146127949
image: https://bing.ee123.net/img/rand?artid=146127949
img: https://bing.ee123.net/img/rand?artid=146127949
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     使用 Python 批量提取 PDF 书签：一款实用工具的实现
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     在日常学习或工作中，我们经常会遇到需要整理大量 PDF 文件的情况。PDF 文件中的书签（也称为大纲或目录）是快速导航的重要工具，但有时我们需要将这些书签提取出来单独保存以便查看或编辑。本文将介绍一个基于 Python 的工具，它可以批量处理指定目录下的 PDF 文件，提取其中的书签并保存为文本文件。无论你是技术爱好者还是需要处理文档的专业人士，这个工具都能帮到你！
    </p>
    <h3>
     <a id="_2">
     </a>
     背景与需求
    </h3>
    <p>
     PDF 文件的书签通常嵌套在文档的元数据中，手动复制粘贴既费时又容易出错。如果需要处理多个 PDF 文件，这种重复劳动更是让人头疼。好在 Python 提供了强大的库，比如
     <code>
      PyPDF2
     </code>
     ，可以帮助我们轻松访问 PDF 的内部结构。通过编写一个自动化脚本，我们可以一次性处理多个文件，提取书签并按层级保存。
    </p>
    <p>
     这个工具的目标是：
    </p>
    <ol>
     <li>
      遍历指定目录下的所有 PDF 文件。
     </li>
     <li>
      提取每个 PDF 的书签（包括嵌套层级）。
     </li>
     <li>
      将书签保存为格式化的文本文件。
     </li>
     <li>
      提供友好的交互式界面，支持批量处理。
     </li>
    </ol>
    <h3>
     <a id="_12">
     </a>
     功能概览
    </h3>
    <p>
     脚本包含以下几个核心功能：
    </p>
    <ul>
     <li>
      <strong>
       递归提取书签
      </strong>
      ：支持多层嵌套的书签结构。
     </li>
     <li>
      <strong>
       批量处理
      </strong>
      ：自动扫描目录中的 PDF 文件并逐一处理。
     </li>
     <li>
      <strong>
       错误处理
      </strong>
      ：对无效文件或缺少书签的情况进行提示。
     </li>
     <li>
      <strong>
       交互式界面
      </strong>
      ：用户可以输入目录路径并选择是否继续处理。
     </li>
    </ul>
    <p>
     接下来，我们将深入探讨代码的实现细节。
    </p>
    <h3>
     <a id="_22">
     </a>
     技术实现
    </h3>
    <h4>
     <a id="_24">
     </a>
     依赖库
    </h4>
    <p>
     脚本依赖以下两个库：
    </p>
    <ul>
     <li>
      <code>
       os
      </code>
      ：用于文件和目录操作。
     </li>
     <li>
      <code>
       PyPDF2
      </code>
      ：用于读取 PDF 文件并提取书签。
     </li>
    </ul>
    <p>
     安装
     <code>
      PyPDF2
     </code>
     的命令如下：
    </p>
    <pre><code class="prism language-bash">pip <span class="token function">install</span> PyPDF2
</code></pre>
    <h4>
     <a id="_34">
     </a>
     核心函数解析
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        <code>
         extract_bookmarks(outline, level=0, bookmarks_list=None)
        </code>
       </strong>
      </p>
      <ul>
       <li>
        <strong>
         功能
        </strong>
        ：递归提取 PDF 的书签（
        <code>
         outline
        </code>
        ），支持嵌套结构。
       </li>
       <li>
        <strong>
         逻辑
        </strong>
        ：
        <ul>
         <li>
          如果传入的
          <code>
           outline
          </code>
          为空，直接返回。
         </li>
         <li>
          遍历每个书签项，检查其类型：
          <ul>
           <li>
            如果是字典（
            <code>
             dict
            </code>
            ），提取标题并记录层级（通过缩进表示）。
           </li>
           <li>
            如果是列表（
            <code>
             list
            </code>
            ），递归调用自身处理子节点。
           </li>
           <li>
            对未识别的类型打印调试信息。
           </li>
          </ul>
         </li>
        </ul>
       </li>
       <li>
        <strong>
         返回值
        </strong>
        ：包含所有书签的列表，每项前面带有缩进以反映层级。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        <code>
         save_bookmarks_to_file(bookmarks, output_file)
        </code>
       </strong>
      </p>
      <ul>
       <li>
        <strong>
         功能
        </strong>
        ：将提取的书签保存到指定文本文件中。
       </li>
       <li>
        <strong>
         细节
        </strong>
        ：使用 UTF-8 编码写入，确保支持多语言字符。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        <code>
         process_pdfs_in_directory(input_dir, output_dir)
        </code>
       </strong>
      </p>
      <ul>
       <li>
        <strong>
         功能
        </strong>
        ：处理指定目录中的所有 PDF 文件。
       </li>
       <li>
        <strong>
         步骤
        </strong>
        ：
        <ul>
         <li>
          检查并创建输出目录。
         </li>
         <li>
          扫描
          <code>
           .pdf
          </code>
          文件并逐一处理。
         </li>
         <li>
          使用
          <code>
           PdfReader
          </code>
          读取 PDF，提取
          <code>
           outline
          </code>
          。
         </li>
         <li>
          调用
          <code>
           extract_bookmarks
          </code>
          获取书签列表。
         </li>
         <li>
          将结果保存为
          <code>
           {文件名}_bookmarks.txt
          </code>
          。
         </li>
        </ul>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        <code>
         main()
        </code>
       </strong>
      </p>
      <ul>
       <li>
        <strong>
         功能
        </strong>
        ：提供交互式入口。
       </li>
       <li>
        <strong>
         流程
        </strong>
        ：
        <ul>
         <li>
          提示用户输入 PDF 文件目录和输出目录。
         </li>
         <li>
          调用
          <code>
           process_pdfs_in_directory
          </code>
          处理文件。
         </li>
         <li>
          支持循环操作，直到用户选择退出。
         </li>
        </ul>
       </li>
      </ul>
     </li>
    </ol>
    <h4>
     <a id="_66">
     </a>
     代码亮点
    </h4>
    <ul>
     <li>
      <strong>
       递归设计
      </strong>
      ：
      <code>
       extract_bookmarks
      </code>
      使用递归优雅地处理嵌套书签。
     </li>
     <li>
      <strong>
       健壮性
      </strong>
      ：通过异常捕获和条件检查，避免程序因文件损坏或缺少书签而崩溃。
     </li>
     <li>
      <strong>
       用户友好
      </strong>
      ：交互式界面让非技术用户也能轻松使用。
     </li>
    </ul>
    <h3>
     <a id="_71">
     </a>
     使用场景
    </h3>
    <p>
     假设你有一个文件夹，里面存放了多本电子书的 PDF 文件，每本都有详细的书签。你可以使用这个工具：
    </p>
    <ol>
     <li>
      运行脚本，输入文件夹路径。
     </li>
     <li>
      脚本自动扫描并生成每个 PDF 的书签文本文件。
     </li>
     <li>
      你可以将这些书签导入笔记软件，或用于快速检索内容。
     </li>
    </ol>
    <p>
     例如：
    </p>
    <ul>
     <li>
      输入目录：
      <code>
       D:/Books
      </code>
     </li>
     <li>
      输出结果：
      <code>
       D:/Books/book1_bookmarks.txt
      </code>
      ,
      <code>
       D:/Books/book2_bookmarks.txt
      </code>
     </li>
    </ul>
    <p>
     输出文件可能如下：
    </p>
    <pre><code>- Chapter 1
  - Section 1.1
  - Section 1.2
- Chapter 2
</code></pre>
    <h3>
     <a id="_90">
     </a>
     如何运行
    </h3>
    <ol>
     <li>
      确保安装了 Python 和
      <code>
       PyPDF2
      </code>
      。
     </li>
     <li>
      将脚本保存为
      <code>
       pdf_bookmark_extractor.py
      </code>
      。
     </li>
     <li>
      在终端运行：
      <pre><code class="prism language-bash">python pdf_bookmark_extractor.py
</code></pre>
     </li>
     <li>
      按照提示输入目录路径即可。
     </li>
    </ol>
    <h3>
     <a id="_100">
     </a>
     注意事项
    </h3>
    <ul>
     <li>
      脚本依赖 PDF 文件的书签数据。如果 PDF 未嵌入书签，程序会提示并跳过。
     </li>
     <li>
      对于复杂或损坏的 PDF 文件，可能会出现提取失败的情况，此时会显示错误信息。
     </li>
    </ul>
    <h3>
     <a id="_104">
     </a>
     完整代码
    </h3>
    <p>
     以下是完整的 Python 脚本：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> os
<span class="token keyword">from</span> PyPDF2 <span class="token keyword">import</span> PdfReader

<span class="token keyword">def</span> <span class="token function">extract_bookmarks</span><span class="token punctuation">(</span>outline<span class="token punctuation">,</span> level<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> bookmarks_list<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""递归提取所有层级的书签内容"""</span>
    <span class="token keyword">if</span> bookmarks_list <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        bookmarks_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    
    <span class="token keyword">if</span> <span class="token keyword">not</span> outline<span class="token punctuation">:</span>
        <span class="token keyword">return</span> bookmarks_list
    
    <span class="token keyword">for</span> item <span class="token keyword">in</span> outline<span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> <span class="token builtin">dict</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            title <span class="token operator">=</span> item<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'/Title'</span><span class="token punctuation">,</span> <span class="token string">'Unnamed'</span><span class="token punctuation">)</span>
            bookmarks_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"  "</span> <span class="token operator">*</span> level <span class="token operator">+</span> <span class="token string-interpolation"><span class="token string">f"- </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>title<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token string">'/Kids'</span> <span class="token keyword">in</span> item <span class="token keyword">or</span> <span class="token string">'kids'</span> <span class="token keyword">in</span> item<span class="token punctuation">:</span>
                kids <span class="token operator">=</span> item<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'/Kids'</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'kids'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                extract_bookmarks<span class="token punctuation">(</span>kids<span class="token punctuation">,</span> level <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> bookmarks_list<span class="token punctuation">)</span>
        <span class="token keyword">elif</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            extract_bookmarks<span class="token punctuation">(</span>item<span class="token punctuation">,</span> level <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> bookmarks_list<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"未识别的书签项类型: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token builtin">type</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> - </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>item<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> bookmarks_list

<span class="token keyword">def</span> <span class="token function">save_bookmarks_to_file</span><span class="token punctuation">(</span>bookmarks<span class="token punctuation">,</span> output_file<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""将书签保存到文件中"""</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        <span class="token keyword">for</span> line <span class="token keyword">in</span> bookmarks<span class="token punctuation">:</span>
            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>line <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"书签已保存到: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>output_file<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">process_pdfs_in_directory</span><span class="token punctuation">(</span>input_dir<span class="token punctuation">,</span> output_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""处理指定目录下的所有 PDF 文件"""</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>output_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
        os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span>output_dir<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"已创建输出目录: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>output_dir<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

    pdf_files <span class="token operator">=</span> <span class="token punctuation">[</span>f <span class="token keyword">for</span> f <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>input_dir<span class="token punctuation">)</span> <span class="token keyword">if</span> f<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">'.pdf'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    
    <span class="token keyword">if</span> <span class="token keyword">not</span> pdf_files<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"指定目录中没有找到 PDF 文件！"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"找到 </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token builtin">len</span><span class="token punctuation">(</span>pdf_files<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> 个 PDF 文件，开始处理..."</span></span><span class="token punctuation">)</span>
    
    <span class="token keyword">for</span> pdf_file <span class="token keyword">in</span> pdf_files<span class="token punctuation">:</span>
        pdf_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>input_dir<span class="token punctuation">,</span> pdf_file<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"\n正在处理: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>pdf_file<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            pdf <span class="token operator">=</span> PdfReader<span class="token punctuation">(</span>pdf_path<span class="token punctuation">)</span>
            outline <span class="token operator">=</span> pdf<span class="token punctuation">.</span>outline
            
            <span class="token keyword">if</span> <span class="token keyword">not</span> outline<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>pdf_file<span class="token punctuation">}</span></span><span class="token string"> 没有书签，跳过。"</span></span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>
            
            bookmarks <span class="token operator">=</span> extract_bookmarks<span class="token punctuation">(</span>outline<span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> bookmarks<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>pdf_file<span class="token punctuation">}</span></span><span class="token string"> 未提取到任何书签，可能结构复杂。"</span></span><span class="token punctuation">)</span>
                <span class="token keyword">continue</span>
            
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"提取到的书签："</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> idx<span class="token punctuation">,</span> bookmark <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>bookmarks<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>idx<span class="token punctuation">}</span></span><span class="token string">. </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>bookmark<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            
            output_filename <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>splitext<span class="token punctuation">(</span>pdf_file<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"_bookmarks.txt"</span>
            output_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>output_dir<span class="token punctuation">,</span> output_filename<span class="token punctuation">)</span>
            save_bookmarks_to_file<span class="token punctuation">(</span>bookmarks<span class="token punctuation">,</span> output_path<span class="token punctuation">)</span>
        
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"处理 </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>pdf_file<span class="token punctuation">}</span></span><span class="token string"> 时出错：</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""主程序：交互式选择目录并提取所有 PDF 的书签"""</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"欢迎使用 PDF 书签批量提取工具！"</span><span class="token punctuation">)</span>
    
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        input_dir <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"请输入包含 PDF 文件的目录路径（或输入 'q' 退出）："</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> input_dir<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'q'</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"退出程序。"</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
        
        <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isdir<span class="token punctuation">(</span>input_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"目录不存在，请重新输入！"</span><span class="token punctuation">)</span>
            <span class="token keyword">continue</span>
        
        output_dir <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"请输入保存书签的输出目录路径（默认与输入目录相同）："</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> output_dir<span class="token punctuation">:</span>
            output_dir <span class="token operator">=</span> input_dir
        
        process_pdfs_in_directory<span class="token punctuation">(</span>input_dir<span class="token punctuation">,</span> output_dir<span class="token punctuation">)</span>
        
        continue_choice <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"\n是否继续处理其他目录？(y/n): "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> continue_choice <span class="token operator">!=</span> <span class="token string">'y'</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"退出程序。"</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <hr/>
    <h3>
     <a id="_215">
     </a>
     总结
    </h3>
    <p>
     这款工具展示了 Python 在文件处理和自动化任务中的强大能力。通过几行代码，我们实现了一个实用的小程序，不仅节省时间，还能轻松扩展功能（比如支持其他格式或添加图形界面）。希望这篇文章能激发你对 Python 的兴趣，也欢迎根据自己的需求改进这个脚本！
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f36343433323130362f:61727469636c652f64657461696c732f313436313237393439" class_="artid" style="display:none">
 </p>
</div>


