---
layout: post
title: "Excel函数篇IF函数截取函数文本处理函数日期函数常用函数详解"
date: 2025-03-16 10:32:59 +0800
description: "IF函数、截取函数、文本处理函数、日期函数、常用函数详解"
keywords: "Excel（函数篇）：IF函数、截取函数、文本处理函数、日期函数、常用函数详解"
categories: ['数据透视表', 'Vba', 'Excel']
tags: ['职场和发展', '学习方法', 'Excel']
artid: "146260901"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146260901
    alt: "Excel函数篇IF函数截取函数文本处理函数日期函数常用函数详解"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146260901
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146260901
cover: https://bing.ee123.net/img/rand?artid=146260901
image: https://bing.ee123.net/img/rand?artid=146260901
img: https://bing.ee123.net/img/rand?artid=146260901
---

# Excel（函数篇）：IF函数、截取函数、文本处理函数、日期函数、常用函数详解

## IF函数

### 等于判断

  * 参数：IF(logical_test, [value_if_true], [value_if false]

  * 两种情况：判断是否超预算，如果C列的值大于B列，就是是，否则否！  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/b4110dbe60ad4a6f83b0facdbd01d323.png)

  * 公式：  
=IF(C2>B2,“是”,“否”)

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/20b15e937d5a4e24bdaf8f63dbcc6993.png)

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/79cbcc4970a2480b809a5a7d4ebb91f3.png)

  * 多重情况：

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/36905d3c919f469a9bc57213bb7ac9ad.png)

  * 公式 =IF(B2=“易碎”,750,IF(B2=“一般”,300,0))

唯一要注意的地方，函数第三个参数就是否则的值，它是可以嵌套的！

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/477d8d60134549b4b42984b57fda7c44.png)  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/90dc635afa364f248c9a7b0b31a0a7a2.png)

### 区间判断

  * 下例子：如何根据工龄算年假

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/2e492da7ca124d5aa47ac118467c8e82.png)

  * 公式 =IF(B2<2,5,IF(B2<=5,10,15))

注意 Excel中的公式，是从左往右执行的；第一个参数是<2
；所以第二参数的条件必定包含了>=2，然后继续写接下的判断，再让它<=5即可…对于区间只需以此类推即可！

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/a4edfbbf7c47497fbfaad2d612cc5960.png)

### 与AND函数、OR函数一同使用

  * “且”条件判断  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/3c49f70cbd1b453097557a2a0799f2f1.png)

  * 公式：=IF(AND(A2=“男”,B2>=60),1000,0)

Excel公式特性，实现“且”，利用一个单独函数，然后成为IF的一个参数，来参与判断条件！

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/875474b421bd4f96a41e6d4e7f0a4ef4.png)

  * “或”条件判断：

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/fec680bedd3d4c69bd914827dbddf1ad.png)

  * 公式：=IF(OR(B11>60,B11<40),1000,0)

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/dc6e7171a30a4d00a8c6d197804ec375.png)

  * “且”“或”嵌套

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/aa4d62f76f504a96bc7fa883bd10c414.png)

  * 公式  
=IF(OR(AND(A19=“男”,B19>60),AND(A19=“女”,B19<40)),1000,0)

### IFNA函数和IFERROR函数

  * VLOOKUP函数出现错误：

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/f24a2d3806a84851bc583a1e0faeae2c.png)  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/6733548cea15408588f5975a305c9931.png)

有一处值出现错误？因为源数据根本不存在“张三”，所以会返回#N/A值，那么如何避免呢？

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/ed493a84519c4d28877fa19cebdd9829.png)

  * 最外层再嵌套一个IFNA函数即可，也可以是IFERROR函数

  * 公式 =IFNA(VLOOKUP(F3,A:C,3,0),“”)

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/8be358f4017443118325283341d11577.png)

  * IFERROR函数，可以屏蔽一切错误原因

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/a6cb710dff064b2c8eb09b2bb2e9ff09.png)  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/607e1860a1d24b6f8c808264e801f1a7.png)

  * 公式 =IFERROR((B4-C4)/B4,“”)  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/f437174b9e1c4fdf8dff5e65f789ed75.png)

## LEFT、RIGHT、MID截取函数

  * 公式 =LEFT(A2,2)  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/5ff98dedf8a148b492724666f419cc77.png)

  * 公式 =RIGHT(A2,4)

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/e9370c38a3954bca989cf72eda41facb.png)

  * 公式 =MID(A2,3,2)

第二个参数表示从第几位开始，第三个参数表示，总共几位！

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/94c58b2b6999474891b932c9afad3dd7.png)

  * 结合VLOOKUP函数一起使用

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/8a2b7f7e0fb94841887f18483d097ffe.png)  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/1bfd13b5ae6c4afcbf276b90c972e0a8.png)

  * 公式 =VLOOKUP(LEFT(B2,6)*1,地区码!A:B,2,0)

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/b1bdb780909943c8a4a038f2009115e9.png)

## FIND函数、LEN函数

  * FIND()用来找某个字符的位置，返回一个数值  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/523195d98bf64af6a831187987d741a9.png)

  * 参数：FIND(find _text, within_text, [start _num])

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/66129f887e10401c8f271b28791a8ee0.png)

  * 和截取函数组合使用，比如例中，需要提取用户名，所以我们得先找到@符号在第几位，然后位数-1，就是呀截取的用户名！

公式：=LEFT(A2,FIND(“@”,A2)-1)

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/cd8c47ba1a2b4c19826a4395c1e9ea8b.png)

  * LEN函数返字符串长度

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/d9f79f795ab345fab45bfd8076d2608f.png)  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/e68f4f86de61432595c22b03ecef9d8c.png)

  * 嵌套，提取出域名

公式：=RIGHT(A2,LEN(A2)-FIND(“@”,A2))  
总位数-“@”符号所在位置，就是right函数需要截取的位！  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/582cd52e26cb4eb8b0133cfd0910cbb5.png)

  * 其他，提取域名方法，利用MID函数

公式 =MID(A2,FIND(“@”,A2)+1,1000)

找到@所在位数，开始取后面位数即可，1000是任意写的一个大范围，域名肯定没那么长，所以能一次性取到后面所有的值！

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/1e83b9803e574ab4b7cf4d5069b65742.png)

## SUBSTITUTE函数

  * substitute 就是函数版的替换工具，属于文本型函数，输出的内容也是文本！

  * 参数&公式 =SUBSTITUTE(A2,“.”,“-”)*1

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/92aa1a23b3824d3fba29431b6365f58b.png)

再转化下格式，即可

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/d6a10267718a4a6e8e90b95224b90175.png)

  * 实战题：将手机号码中间4位的内容，替换成*号

公式 =SUBSTITUTE(D2,MID(D2,4,4),“****”)

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/cd30584f05814f00987e896007b21a11.png)

## ASC函数、WIDECHAR函数

  * 功能：ASC全角转半角，widechar半角转全角

  * ASC()

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/20c13db870a740c5ac18ef5fc1077ddb.png)

  * widechar() 函数

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/fc31417ade824e21a0f74f54bd5c49ab.png)

## 文本处理函数

### TEXT函数

  * ‌TEXT 函数‌ 用于将数值转换为特定格式的文本，从而灵活控制数据显示形式！  
=TEXT(value, “format_code”)  
‌value‌：需要格式化的数值、日期或时间。  
‌format_code‌：用双引号包裹的格式代码，定义输出文本的样式。

  * 注意事项：  
‌TEXT 函数输出为文本类型‌，无法直接参与数值计算。  
格式代码需严格遵循规则，错误代码会返回 #VALUE!。  
日期/时间需确保原始数据是 Excel 认可的序列值。  
可通过灵活组合格式代码，TEXT 函数可以满足复杂的数据显示需求

  * 如何自动生成金额大写？

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/d1c47aa2db974982a3780a728d5c6f07.png)

  * 公式 ：

=“人民币:”&TEXT(B11,“[DBNum2][$-zh-CN]G/通用格式”)

右键金额，找到数字大写的格式，自定义，复制到格式，用text函数来处理！

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/da3c6fb4de3a4c6393751849894290ed.png)

  * 将日期格式化‌：将日期序列值转换为易读的文本格式

=TEXT(TODAY(), “yyyy-mm-dd”) → 返回当前日期，如 “2023-10-05”  
=TEXT(A1, “dddd, mmmm dd, yyyy”) → 若A1为2023/10/5，返回 "Thursday, October 05, 2

  * 数字格式化为货币‌：添加货币符号和千位分隔符

=TEXT(1234.5, “$#,##0.00”) → 返回 “$1,234.50”  
=TEXT(500, “¥#,##0”) → 返回 “¥500”

  * 百分比显示‌：将小数转换为百分比形式

=TEXT(0.25, “0.00%”) → 返回 “25.00%”  
=TEXT(0.75, “0%”) → 返回 “75%”

  * 自定义数字格式‌：控制小数位数或填充字符

=TEXT(123, “00000”) → 返回 “00123”（固定5位，不足补零）  
=TEXT(3.1415, “0.00”) → 返回 “3.14”（保留两位小数）

  * 时间格式化‌：转换时间序列值为文本

=TEXT(NOW(), “hh:mm:ss AM/PM”) → 返回当前时间，如 “03:45:30 PM”  
=TEXT(0.75, “h:mm”) → 返回 “18:00”（0.75天=18小时）

  * 条件性文本显示‌：用格式代码实现简单条件

=TEXT(A1, “[>100]超额;不足”) → 若A1=150，返回 “超额”；若A1=80，返回 “不足”

  * 电话号码分段显示‌：格式化数字为电话号码

=TEXT(13912345678, “000-0000-0000”) → 返回 “139-1234-5678”

  * 结合文本拼接‌：将格式化结果与其他文本组合

=TEXT(B2, “￥#,##0.00”) & " 元整" → 若B2=2500，返回 “￥2,500.00 元整”

  * 常用格式代码说明：  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/4616dfaa022d4611bb98fb7758c667f1.png)

### TEXTJOIN函数

  * 功能：链接文字作用

  * 公式 =TEXTJOIN(“-”,TRUE,A2:D2) 忽略空白，大多数情况下都是数据是一样的

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/d92e43c374bf40c49d338a878e4381e8.png)

  * 不忽略空白，面对数据不一样的情况下！也方便以后对数据进行处理，比如说可以进行，按照分隔符分列！

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/00938e336a624818885a096f3e2f9145.png)

再对数据进行“分列”还原一下！

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/11365a4718b84820aeb1772b6a205c42.png)

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/8aacbc831650464bbce99c9fd7fd6c33.png)

## 日期函数

### DATE函数

  * 如何提取身份证中的生日信息？用到DATE函数！

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/0e45198f0dd44b208b8d76c180cd04dc.png)

  * 公式 =DATE(MID(B2,7,4),MID(B2,11,2),MID(B2,13,2))

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/9f9713acae974f349a09254c72f01674.png)

  * DATE()函数，输入值总能返回一个正确的日期！

### YEAR、MONTH、DAY，EDATE函数

  * 实际应用：计算结款日期

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/e81fb5cb5524479f9b92d64936cafc9b.png)

  * YEAR、MONTH、DAY都是取一个日期中的，年月日

  * 公式=DATE(YEAR(A2),MONTH(A2)+B2,DAY(A2)-1)

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/b9f1e1bfc42f450681a26978431b2202.png)

  * EDATE()函数  
公式 =EDATE(A2,B2)

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/28ccaec6701f4597a8d4688dd5fe08e8.png)

### Datedif函数

  * 用Datedif函数计算工龄，datedif函数可以计算时间间隔！

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/c42d325b95314641b46c36e2792b9e79.png)

  * 公式 =DATEDIF(A2,B2,“Y”)  
参数1为开始日期；参数2为结束日期；参数3是要计算的间隔值，“Y”是年，“M”是月，“D”是天…

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/9ad01bb818d44763be44d75f44975753.png)

### Weeknum、Weekday函数

  * 如何计算当前日期，是第几周？  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/fa51dd7bee8045989d908b525d1a249c.png)

  * weeknum()函数

公式 =WEEKNUM(A3,2) 参数1是日期，参数2是选择一周开始天是什么！

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/8d951fff48ef49b088aac8ed6faf2870.png)

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/f911ec106c4745b3925ec7d3ae2f3635.png)

  * weekday()函数

公式 =WEEKDAY(A3,2)

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/86deba94497a430f87c34e7c646a213d.png)

  * 实操题：将周末标记为红色

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/425273b721c54becbab5570fd79ece6e.png)

  * 利用条件格式，加上weekday()函数来判断

ALT H L H M 打开新建条件格式，使用公式确定要设置格式的单元格，输入：weeekday(B1,2)>5

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/2184d7989b0b4b3ba1ed68577dad9e82.png)

然后双击格式刷，将后面的日期统一一下格式即可！

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/8c3b808bc3bf44c78c60ebccc7df14a8.png)

  * 这样再修改开始日期后，依旧可以利用已经设置好的格式，标记出新日期的周末~~

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/6abda8b628e246fb888546bbf00aecff.png)

####

####



