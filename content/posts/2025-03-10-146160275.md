---
arturl_encode: "68747470733a2f2f626c6f:672e6373646e2e6e65742f323330315f37363434343133332f:61727469636c652f64657461696c732f313436313630323735"
layout: post
title: "pythonå…¥é—¨ä»£ç æ¡ˆä¾‹pdfé˜…è¯»å™¨å¸¦å›¾ç‰‡è½¬æ¢"
date: 2025-03-10 18:04:34 +0800
description: "è¿˜æœ‰ä½¿ç”¨é¢‘ç‡æ¯”è¾ƒé«˜çš„çš„pdfæ–‡ä»¶è½¬æ¢å›¾ç‰‡ï¼Œå°†pdfæ–‡ä»¶ä¸­çš„æ¯ä¸€é¡µé¢åˆ†å‰²ä¸ºå•ç‹¬çš„å›¾ç‰‡ï¼Œå¦å¤–ä¸€ä¸ªå°ç»†èŠ‚ï¼Œæˆ‘ä»¬å¯¼å‡ºçš„å›¾ç‰‡åŒæ ·æ˜¯åŸºäºé¡µé¢é¡ºåºã€‚åŸºäºpythonä»£ç å®ç°çš„pdfæ–‡æ¡£é˜…è¯»å™¨ã€‚æ‰“å¼€è·¯å¾„å†…pdfæ–‡ä»¶ï¼Œæ¶µç›–äº†ä¹¦ç­¾ä¸ç›®å½•åŠŸèƒ½ã€‚ä»å›¾ç‰‡ä¸­çœ‹å‡ºï¼Œæˆ‘ä»¬è€ƒè™‘äº†uiç•Œé¢çš„æç®€æ€§ï¼Œä»¥åŠä¸Šä¸‹ç¿»é¡µåŠŸèƒ½ã€‚"
keywords: "pythonå…¥é—¨ä»£ç æ¡ˆä¾‹ï¼špdfé˜…è¯»å™¨å¸¦å›¾ç‰‡è½¬æ¢"
categories: ['Python']
tags: ['Pdf']
artid: "146160275"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146160275
    alt: "pythonå…¥é—¨ä»£ç æ¡ˆä¾‹pdfé˜…è¯»å™¨å¸¦å›¾ç‰‡è½¬æ¢"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146160275
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146160275
cover: https://bing.ee123.net/img/rand?artid=146160275
image: https://bing.ee123.net/img/rand?artid=146160275
img: https://bing.ee123.net/img/rand?artid=146160275
---

# pythonå…¥é—¨ä»£ç æ¡ˆä¾‹ï¼špdfé˜…è¯»å™¨å¸¦å›¾ç‰‡è½¬æ¢

![](https://i-blog.csdnimg.cn/direct/85401355d19e437490b45d682807d44e.jpeg)

åŸºäºpythonä»£ç å®ç°çš„pdfæ–‡æ¡£é˜…è¯»å™¨ã€‚æ‰“å¼€è·¯å¾„å†…pdfæ–‡ä»¶ï¼Œæ¶µç›–äº†ä¹¦ç­¾ä¸ç›®å½•åŠŸèƒ½ã€‚

ä»å›¾ç‰‡ä¸­çœ‹å‡ºï¼Œæˆ‘ä»¬è€ƒè™‘äº†uiç•Œé¢çš„æç®€æ€§ï¼Œä»¥åŠä¸Šä¸‹ç¿»é¡µåŠŸèƒ½ã€‚

è¿˜æœ‰ä½¿ç”¨é¢‘ç‡æ¯”è¾ƒé«˜çš„çš„pdfæ–‡ä»¶è½¬æ¢å›¾ç‰‡ï¼Œå°†pdfæ–‡ä»¶ä¸­çš„æ¯ä¸€é¡µé¢åˆ†å‰²ä¸ºå•ç‹¬çš„å›¾ç‰‡ï¼Œå¦å¤–ä¸€ä¸ªå°ç»†èŠ‚ï¼Œæˆ‘ä»¬å¯¼å‡ºçš„å›¾ç‰‡åŒæ ·æ˜¯åŸºäºé¡µé¢é¡ºåºã€‚

```
import tkinter as tk
from tkinter import ttk, filedialog, messagebox, simpledialog
import fitz  # PyMuPDF
from PIL import Image, ImageTk
import json
import re
import os
import platform
from tkinter import font
import threading
from typing import Optional
import ttkbootstrap as tb

class MacPDFExpert:
    def __init__(self, root):
        self.root = root
        self.root.title("PDFé˜…è¯»å™¨ã€å…­é“ã€")
        self.root.geometry("1200x800+200+200")
        self.setup_system_style()

        # æ–‡æ¡£çŠ¶æ€
        self.current_page = 0
        self.pdf_document: Optional[fitz.Document] = None
        self.image_list = []
        self.zoom_level = 1.0
        self.dpi = 96

        # ç”¨æˆ·æ•°æ®
        self.bookmarks = {}
        self.annotations = {}
        self.search_results = []
        self.current_search_index = -1

        # æŒä¹…åŒ–é…ç½®
        self.settings_file = "pdf_expert_settings.json"
        self.annotations_file = "pdf_annotations.json"

        # UIç»„ä»¶
        self.create_widgets()
        self.setup_bindings()
        self.load_initial_data()

    def setup_system_style(self):
        """æ ¹æ®æ“ä½œç³»ç»Ÿåº”ç”¨ç›¸åº”è§†è§‰é£æ ¼"""
        theme = "cosmo" if platform.system() == "Darwin" else "flatly"
        self.style = tb.Style(theme=theme)
        print(f"Available colors: {self.style.colors.__dict__}")  # Debugging line to see available colors
        self.root.configure(bg=self.style.colors.bg)

        # å­—ä½“é…ç½®
        system_font = "Helvetica" if platform.system() == "Darwin" else "Segoe UI"
        default_font = font.nametofont("TkDefaultFont")
        default_font.configure(family=system_font, size=12)

        # æ§ä»¶æ ·å¼
        self.style.configure("TButton",
                        padding=(10, 5),
                        relief="flat",
                        font=(system_font, 12),
                        anchor="center")

        # é€šç”¨æ ·å¼
        self.style.configure("TProgressbar",
                        thickness=3,
                        troughcolor="#E5E5EA",
                        background="#34C759")
        self.style.configure("Treeview",
                        background="white",
                        fieldbackground="white",
                        bordercolor="#CECED2",
                        font=(system_font, 11))
        self.style.map("Treeview",
                  background=[("selected", "#007AFF")],
                  foreground=[("selected", "white")])

    def create_widgets(self):
        """åˆ›å»ºæ‰€æœ‰ç•Œé¢ç»„ä»¶"""
        # ä¸»å®¹å™¨
        main_container = tb.Frame(self.root)
        main_container.pack(fill=tk.BOTH, expand=True)

        # é¡¶éƒ¨å·¥å…·æ 
        toolbar = tb.Frame(main_container, padding=(10, 5))
        toolbar.pack(side=tk.TOP, fill=tk.X)

        # æ“ä½œæŒ‰é’®ç»„
        btn_group = tb.Frame(toolbar)
        btn_group.pack(side=tk.LEFT)

        self.open_btn = tb.Button(btn_group, text="ğŸ“‚ æ‰“å¼€", command=self.open_pdf, bootstyle="outline-primary")
        self.open_btn.pack(side=tk.LEFT, padx=2)

        self.export_menu = self.create_export_menu(btn_group)
        self.export_btn = tb.Button(btn_group, text="â†©ï¸ å¯¼å‡º", command=lambda:
        self.export_menu.post(self.export_btn.winfo_rootx(),
                              self.export_btn.winfo_rooty() + 30), bootstyle="outline-secondary")
        self.export_btn.pack(side=tk.LEFT, padx=2)

        # å¯¼èˆªæ§ä»¶ç»„
        nav_group = tb.Frame(toolbar)
        nav_group.pack(side=tk.LEFT, padx=20)

        self.prev_btn = tb.Button(nav_group, text="â—€", width=3, command=self.prev_page, bootstyle="outline-info")
        self.prev_btn.pack(side=tk.LEFT)

        self.page_entry = tb.Entry(nav_group, width=5, font=("TkDefaultFont", 12))
        self.page_entry.pack(side=tk.LEFT, padx=5)
        self.page_entry.insert(0, "1")

        self.next_btn = tb.Button(nav_group, text="â–¶", width=3, command=self.next_page, bootstyle="outline-success")
        self.next_btn.pack(side=tk.LEFT)

        # ç¼©æ”¾æ§ä»¶ç»„
        zoom_group = tb.Frame(toolbar)
        zoom_group.pack(side=tk.LEFT, padx=20)

        tb.Label(zoom_group, text="ç¼©æ”¾:").pack(side=tk.LEFT)
        self.zoom_scale = tb.Scale(zoom_group, from_=25, to=400,
                                   command=lambda v: self.update_zoom(int(float(v))), orient="horizontal", length=150)
        self.zoom_scale.set(100)
        self.zoom_scale.pack(side=tk.LEFT, padx=5)

        # æœç´¢ç»„
        search_group = tb.Frame(toolbar)
        search_group.pack(side=tk.RIGHT)

        self.search_entry = tb.Entry(search_group, width=25)
        self.search_entry.pack(side=tk.LEFT)
        self.search_btn = tb.Button(search_group, text="ğŸ” æœç´¢", command=self.search_text, bootstyle="outline-warning")
        self.search_btn.pack(side=tk.LEFT, padx=5)

        # ä¸»å†…å®¹åŒº
        content_paned = tb.Panedwindow(main_container, orient=tk.HORIZONTAL)
        content_paned.pack(fill=tk.BOTH, expand=True)

        # å·¦ä¾§å¯¼èˆªé¢æ¿
        self.left_panel = tb.Frame(content_paned, width=220)
        content_paned.add(self.left_panel, weight=0)

        # å¯¼èˆªæ ‡ç­¾é¡µ
        self.nav_notebook = tb.Notebook(self.left_panel)
        self.nav_notebook.pack(fill=tk.BOTH, expand=True)

        # ç›®å½•æ ‡ç­¾
        toc_frame = tb.Frame(self.nav_notebook)
        self.toc_tree = tb.Treeview(toc_frame, show="tree", selectmode="browse")
        self.toc_tree_scroll = tb.Scrollbar(toc_frame, command=self.toc_tree.yview)
        self.toc_tree.configure(yscrollcommand=self.toc_tree_scroll.set)
        self.toc_tree.pack(side=tk.LEFT, fill=tk.BOTH, expand=True)
        self.toc_tree_scroll.pack(side=tk.RIGHT, fill=tk.Y)
        self.nav_notebook.add(toc_frame, text="ç›®å½•")

        # ä¹¦ç­¾æ ‡ç­¾
        bookmark_frame = tb.Frame(self.nav_notebook)
        self.bookmark_list = tk.Listbox(bookmark_frame, bg="white", bd=0,
                                       font=("TkDefaultFont", 11), selectbackground="#007AFF")
        self.bookmark_scroll = tk.Scrollbar(bookmark_frame, command=self.bookmark_list.yview)
        self.bookmark_list.configure(yscrollcommand=self.bookmark_scroll.set)
        self.bookmark_list.pack(side=tk.LEFT, fill=tk.BOTH, expand=True)
        self.bookmark_scroll.pack(side=tk.RIGHT, fill=tk.Y)
        self.nav_notebook.add(bookmark_frame, text="ä¹¦ç­¾")

        # ä¸»æ˜¾ç¤ºåŒº
        self.right_panel = tb.Frame(content_paned)
        content_paned.add(self.right_panel, weight=1)

        # PDFæ˜¾ç¤ºç”»å¸ƒ
        self.canvas = tb.Canvas(self.right_panel, bg="white", highlightthickness=0)
        self.canvas.pack(fill=tk.BOTH, expand=True)

        # çŠ¶æ€æ 
        self.status_bar = tb.Frame(self.root, height=24, style="StatusBar.TFrame")
        self.status_label = tb.Label(self.status_bar,
                                     text="å°±ç»ª",
                                     anchor=tk.W,
                                     style="StatusBar.TLabel")
        self.status_label.pack(side=tk.LEFT, padx=10)
        self.status_bar.pack(side=tk.BOTTOM, fill=tk.X)

        # è¿›åº¦æ¡
        self.progress = tb.Progressbar(self.root, mode="determinate")

        # ä¸Šä¸‹æ–‡èœå•
        self.context_menu = tb.Menu(self.root, tearoff=0)
        self.context_menu.add_command(label="æ·»åŠ æ³¨é‡Š", command=self.add_annotation)
        self.context_menu.add_command(label="åˆ é™¤ä¹¦ç­¾", command=self.delete_bookmark)

    def create_export_menu(self, parent):
        """åˆ›å»ºå¯¼å‡ºåŠŸèƒ½çš„ä¸‹æ‹‰èœå•"""
        menu = tb.Menu(parent, tearoff=0)
        menu.add_command(label="å¯¼å‡ºå½“å‰é¡µä¸ºå›¾ç‰‡...",
                         command=self.export_current_page,
                         accelerator="Cmd+S" if platform.system() == "Darwin" else "Ctrl+S")
        menu.add_command(label="å¯¼å‡ºå…¨éƒ¨é¡µé¢ä¸ºå›¾ç‰‡...",
                         command=self.export_all_pages,
                         accelerator="Cmd+Shift+E" if platform.system() == "Darwin" else "Ctrl+Shift+E")
        menu.add_separator()
        menu.add_command(label="å¯¼å‡ºé€‰é¡¹...", command=self.show_export_settings)
        return menu

    def show_export_settings(self):
        """æ˜¾ç¤ºå¯¼å‡ºè®¾ç½®å¯¹è¯æ¡†"""
        export_window = tb.Toplevel(self.root)
        export_window.title("å¯¼å‡ºè®¾ç½®")
        export_window.geometry("300x200+300+300")

        # DPI è®¾ç½®
        dpi_frame = tb.Frame(export_window)
        dpi_frame.pack(pady=10)
        tb.Label(dpi_frame, text="DPI:").pack(side=tk.LEFT, padx=5)
        self.dpi_var = tk.StringVar(value=str(self.dpi))
        dpi_entry = tb.Entry(dpi_frame, textvariable=self.dpi_var, width=10)
        dpi_entry.pack(side=tk.LEFT, padx=5)

        # åº”ç”¨æŒ‰é’®
        apply_btn = tb.Button(export_window, text="åº”ç”¨", command=self.apply_export_settings, bootstyle="primary-outline")
        apply_btn.pack(pady=10)

    def apply_export_settings(self):
        """åº”ç”¨å¯¼å‡ºè®¾ç½®"""
        try:
            new_dpi = int(self.dpi_var.get())
            if new_dpi > 0:
                self.dpi = new_dpi
                self.save_settings()
                messagebox.showinfo("æç¤º", "è®¾ç½®å·²ä¿å­˜")
            else:
                messagebox.showerror("é”™è¯¯", "è¯·è¾“å…¥æœ‰æ•ˆçš„DPIå€¼")
        except ValueError:
            messagebox.showerror("é”™è¯¯", "è¯·è¾“å…¥æœ‰æ•ˆçš„æ•°å­—")

    # æ–‡ä»¶æ“ä½œåŠŸèƒ½
    def open_pdf(self):
        """æ‰“å¼€PDFæ–‡ä»¶å¹¶åˆå§‹åŒ–è§†å›¾"""
        file_path = filedialog.askopenfilename(filetypes=[("PDFæ–‡ä»¶", "*.pdf"), ("æ‰€æœ‰æ–‡ä»¶", "*.*")])
        if file_path:
            try:
                if self.pdf_document:
                    self.pdf_document.close()
                self.pdf_document = fitz.open(file_path)
                self.current_page = 0
                self.zoom_level = 1.0
                self.zoom_scale.set(100)
                self.update_ui_state()
                self.load_annotations()
                self.update_toc()
                self.show_page()
            except Exception as e:
                self.show_error_message(f"æ— æ³•æ‰“å¼€PDFæ–‡ä»¶: {str(e)}")

    def update_ui_state(self):
        """æ›´æ–°ç•Œé¢çŠ¶æ€"""
        has_doc = self.pdf_document is not None
        self.export_btn.state(["!disabled" if has_doc else "disabled"])
        self.prev_btn.state(["!disabled" if has_doc else "disabled"])
        self.next_btn.state(["!disabled" if has_doc else "disabled"])
        self.search_btn.state(["!disabled" if has_doc else "disabled"])
        self.zoom_scale.state(["!disabled" if has_doc else "disabled"])

    # é¡µé¢å¯¼èˆªåŠŸèƒ½
    def jump_to_page(self):
        """è·³è½¬åˆ°æŒ‡å®šé¡µç """
        if not self.pdf_document:
            return

        try:
            page_num = int(self.page_entry.get()) - 1
            if 0 <= page_num < len(self.pdf_document):
                self.current_page = page_num
                self.show_page()
            else:
                self.show_error_message("æ— æ•ˆçš„é¡µç ")
        except ValueError:
            self.show_error_message("è¯·è¾“å…¥æœ‰æ•ˆçš„æ•°å­—")

    def prev_page(self):
        """è·³è½¬åˆ°ä¸Šä¸€é¡µ"""
        if self.current_page > 0:
            self.current_page -= 1
            self.show_page()

    def next_page(self):
        """è·³è½¬åˆ°ä¸‹ä¸€é¡µ"""
        if self.current_page < len(self.pdf_document) - 1:
            self.current_page += 1
            self.show_page()

    # æ˜¾ç¤ºé¡µé¢åŠŸèƒ½
    def show_page(self):
        """æ˜¾ç¤ºå½“å‰é¡µçš„å†…å®¹"""
        if not self.pdf_document:
            return

        page = self.pdf_document[self.current_page]
        pix = page.get_pixmap(dpi=int(self.dpi * self.zoom_level))  # Ensure dpi is an integer
        img = Image.frombytes("RGB", [pix.width, pix.height], pix.samples)
        self.image_list.append(ImageTk.PhotoImage(img))
        self.canvas.delete("all")
        self.canvas.create_image(0, 0, image=self.image_list[-1], anchor="nw")
        self.page_entry.delete(0, tk.END)
        self.page_entry.insert(0, str(self.current_page + 1))

    # ç¼©æ”¾åŠŸèƒ½
    def update_zoom(self, value):
        """æ›´æ–°ç¼©æ”¾çº§åˆ«å¹¶é‡æ–°æ˜¾ç¤ºé¡µé¢"""
        self.zoom_level = float(value) / 100
        self.show_page()

    # æœç´¢åŠŸèƒ½
    def search_text(self):
        """æœç´¢æ–‡æ¡£ä¸­çš„æ–‡æœ¬"""
        query = self.search_entry.get().strip()
        if not query:
            self.show_error_message("è¯·è¾“å…¥æœç´¢å†…å®¹")
            return

        self.search_results.clear()
        for i in range(len(self.pdf_document)):
            text_instances = self.pdf_document[i].search_for(query)
            for inst in text_instances:
                self.search_results.append((i, inst))

        if self.search_results:
            self.current_search_index = 0
            self.highlight_search_result()
        else:
            self.show_info_message("æœªæ‰¾åˆ°åŒ¹é…é¡¹")

    def highlight_search_result(self):
        """é«˜äº®æ˜¾ç¤ºæœç´¢ç»“æœ"""
        if not self.search_results or self.current_search_index == -1:
            return

        page_num, rect = self.search_results[self.current_search_index]
        self.jump_to_page(page_num)
        x0, y0, x1, y1 = rect.x0, rect.y0, rect.x1, rect.y1
        scale_factor = self.zoom_level * self.dpi / 72
        self.canvas.coords("highlight", x0 * scale_factor, y0 * scale_factor,
                          x1 * scale_factor, y1 * scale_factor)
        self.canvas.itemconfig("highlight", outline="red", width=2)

    def next_search_result(self):
        """è·³è½¬åˆ°ä¸‹ä¸€ä¸ªæœç´¢ç»“æœ"""
        if self.current_search_index >= len(self.search_results) - 1:
            self.current_search_index = 0
        else:
            self.current_search_index += 1
        self.highlight_search_result()

    def prev_search_result(self):
        """è·³è½¬åˆ°ä¸Šä¸€ä¸ªæœç´¢ç»“æœ"""
        if self.current_search_index <= 0:
            self.current_search_index = len(self.search_results) - 1
        else:
            self.current_search_index -= 1
        self.highlight_search_result()

    # æ³¨é‡Šå’Œä¹¦ç­¾åŠŸèƒ½
    def add_annotation(self):
        """æ·»åŠ æ³¨é‡Š"""
        if not self.pdf_document:
            return

        comment = simpledialog.askstring("æ·»åŠ æ³¨é‡Š", "è¾“å…¥æ‚¨çš„æ³¨é‡Š:")
        if comment:
            page = self.pdf_document[self.current_page]
            annot = page.add_highlight_annot(page.rect)
            annot.update(contents=comment)
            self.save_annotations()

    def delete_bookmark(self):
        """åˆ é™¤ä¹¦ç­¾"""
        selected_item = self.bookmark_list.curselection()
        if selected_item:
            bookmark_name = self.bookmark_list.get(selected_item[0])
            del self.bookmarks[bookmark_name]
            self.bookmark_list.delete(selected_item)
            self.save_settings()

    # ç›®å½•åŠŸèƒ½
    def update_toc(self):
        """æ›´æ–°ç›®å½•æ ‘"""
        toc = self.pdf_document.get_toc(simple=False)
        self.populate_toc(toc)

    def populate_toc(self, toc):
        """å¡«å……ç›®å½•æ ‘"""
        for level, title, page_num, _rect in toc:
            parent_node = "" if level == 1 else self.toc_tree.get_children()[level - 2]
            node_id = self.toc_tree.insert(parent_node, "end", text=title, values=(level, title, page_num, _rect))
            self.toc_tree.bind("<Double-1>", lambda event: self.on_toc_double_click(event))

    def on_toc_double_click(self, event):
        """åŒå‡»ç›®å½•é¡¹æ—¶è·³è½¬åˆ°å¯¹åº”é¡µé¢"""
        item = self.toc_tree.selection()[0]
        _, _, page_num, _ = self.toc_tree.item(item, "values")
        self.current_page = page_num - 1
        self.show_page()

    # å¯¼å‡ºåŠŸèƒ½
    def export_current_page(self):
        """å¯¼å‡ºå½“å‰é¡µä¸ºå›¾ç‰‡"""
        file_path = filedialog.asksaveasfilename(defaultextension=".png",
                                                 filetypes=[("PNGæ–‡ä»¶", "*.png"), ("æ‰€æœ‰æ–‡ä»¶", "*.*")])
        if file_path:
            page = self.pdf_document[self.current_page]
            pix = page.get_pixmap(dpi=int(self.dpi * self.zoom_level))  # Ensure dpi is an integer
            pix.save(file_path)

    def export_all_pages(self):
        """å¯¼å‡ºå…¨éƒ¨é¡µé¢ä¸ºå›¾ç‰‡"""
        folder_path = filedialog.askdirectory()
        if folder_path:
            for i in range(len(self.pdf_document)):
                page = self.pdf_document[i]
                pix = page.get_pixmap(dpi=int(self.dpi * self.zoom_level))  # Ensure dpi is an integer
                output_path = os.path.join(folder_path, f"page_{i + 1}.png")
                pix.save(output_path)

    # è®¾ç½®å’ŒæŒä¹…åŒ–åŠŸèƒ½
    def load_initial_data(self):
        """åŠ è½½åˆå§‹è®¾ç½®å’Œæ³¨é‡Šæ•°æ®"""
        self.load_settings()
        self.load_annotations()

    def save_settings(self):
        """ä¿å­˜è®¾ç½®æ•°æ®"""
        settings = {
            "zoom_level": self.zoom_level,
            "dpi": self.dpi
        }
        with open(self.settings_file, "w") as f:
            json.dump(settings, f)

    def load_settings(self):
        """åŠ è½½è®¾ç½®æ•°æ®"""
        try:
            with open(self.settings_file, "r") as f:
                settings = json.load(f)
                self.zoom_level = settings.get("zoom_level", 1.0)
                self.dpi = settings.get("dpi", 96)
        except FileNotFoundError:
            pass

    def save_annotations(self):
        """ä¿å­˜æ³¨é‡Šæ•°æ®"""
        annotations = {f"page_{i}": self.annotations.get(i, []) for i in range(len(self.pdf_document))}
        with open(self.annotations_file, "w") as f:
            json.dump(annotations, f)

    def load_annotations(self):
        """åŠ è½½æ³¨é‡Šæ•°æ®"""
        try:
            with open(self.annotations_file, "r") as f:
                annotations = json.load(f)
                self.annotations = {int(k.replace("page_", "")): v for k, v in annotations.items()}
        except FileNotFoundError:
            pass

    # ç»‘å®šäº‹ä»¶
    def setup_bindings(self):
        """ç»‘å®šå„ç§äº‹ä»¶"""
        self.root.bind("<Control-s>", lambda _: self.export_current_page())
        self.root.bind("<Control-Shift-E>", lambda _: self.export_all_pages())
        self.root.bind("<Command-s>", lambda _: self.export_current_page() if platform.system() == "Darwin" else "")
        self.root.bind("<Command-Shift-E>", lambda _: self.export_all_pages() if platform.system() == "Darwin" else "")
        self.root.bind("<Return>", lambda _: self.search_text())
        self.root.bind("<F3>", lambda _: self.next_search_result())
        self.root.bind("<Shift-F3>", lambda _: self.prev_search_result())

    # è¾…åŠ©å‡½æ•°
    def show_error_message(self, message):
        """æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯æ¡†"""
        messagebox.showerror("é”™è¯¯", message)

    def show_info_message(self, message):
        """æ˜¾ç¤ºä¿¡æ¯æ¶ˆæ¯æ¡†"""
        messagebox.showinfo("æç¤º", message)


if __name__ == "__main__":
    root = tb.Window(themename="cosmo" if platform.system() == "Darwin" else "flatly")
    app = MacPDFExpert(root)
    root.mainloop()




```