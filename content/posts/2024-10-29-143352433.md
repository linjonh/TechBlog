---
layout: post
title: "云原生云原生后端监控与观察性"
date: 2024-10-29 23:24:57 +0800
description: "在现代云原生架构中，监控与观察性不仅是确保系统稳定运行的关键，也是提升用户体验、降低故障恢复时间的重"
keywords: "云原生监控"
categories: ['监控', 'Web']
tags: ['架构', '后端', '云原生']
artid: "143352433"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=143352433
    alt: "云原生云原生后端监控与观察性"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=143352433
featuredImagePreview: https://bing.ee123.net/img/rand?artid=143352433
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     【云原生】云原生后端：监控与观察性
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <div class="toc">
     <h4>
      目录
     </h4>
     <ul>
      <li>
       <a href="#_2" rel="nofollow">
        引言
       </a>
      </li>
      <li>
       <a href="#_6" rel="nofollow">
        一、监控的概念
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#11__10" rel="nofollow">
          1.1 指标监控
         </a>
        </li>
        <li>
         <a href="#12__38" rel="nofollow">
          1.2 事件监控
         </a>
        </li>
        <li>
         <a href="#13__50" rel="nofollow">
          1.3 告警管理
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a href="#_60" rel="nofollow">
        二、观察性的定义
       </a>
      </li>
      <li>
       <a href="#_83" rel="nofollow">
        三、实现监控与观察性的方法
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#31__85" rel="nofollow">
          3.1 指标收集与监控
         </a>
        </li>
        <li>
         <a href="#32__119" rel="nofollow">
          3.2 日志管理
         </a>
        </li>
        <li>
         <a href="#33__160" rel="nofollow">
          3.3 性能分析
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a href="#_195" rel="nofollow">
        四、监控与观察性的最佳实践
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#41__203" rel="nofollow">
          4.1 监控工具选择
         </a>
        </li>
        <li>
         <a href="#42__215" rel="nofollow">
          4.2 定期回顾与优化
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a href="#_223" rel="nofollow">
        结论
       </a>
      </li>
      <li>
       <a href="#_230" rel="nofollow">
        参考资料
       </a>
      </li>
     </ul>
    </div>
    <p>
    </p>
    <h2>
     <a id="_2">
     </a>
     引言
    </h2>
    <p>
     在现代云原生架构中，监控与观察性不仅是确保系统稳定运行的关键，也是提升用户体验、降低故障恢复时间的重要工具。本文将深入探讨如何通过有效的监控、日志管理和性能分析，实现系统的全面可观测性。
    </p>
    <h2>
     <a id="_6">
     </a>
     一、监控的概念
    </h2>
    <p>
     监控是对系统运行状态的持续跟踪和分析，目的是及时发现潜在问题并采取相应措施。监控主要包括以下几个方面：
    </p>
    <h3>
     <a id="11__10">
     </a>
     1.1 指标监控
    </h3>
    <p>
     指标监控是监控体系的核心，旨在实时收集系统的性能数据，以便分析和优化系统性能。
    </p>
    <p>
     <strong>
      常用的监控指标
     </strong>
    </p>
    <table>
     <thead>
      <tr>
       <th>
        指标类型
       </th>
       <th>
        描述
       </th>
       <th>
        重要性
       </th>
       <th>
        推荐工具
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        CPU 使用率
       </td>
       <td>
        系统处理器的使用情况
       </td>
       <td>
        过高的 CPU 使用率可能导致延迟
       </td>
       <td>
        Prometheus
       </td>
      </tr>
      <tr>
       <td>
        内存使用率
       </td>
       <td>
        系统内存的使用情况
       </td>
       <td>
        过高的内存使用可能导致系统崩溃
       </td>
       <td>
        Grafana
       </td>
      </tr>
      <tr>
       <td>
        请求延迟
       </td>
       <td>
        请求在系统中处理的时间
       </td>
       <td>
        延迟过高可能影响用户体验
       </td>
       <td>
        Datadog
       </td>
      </tr>
      <tr>
       <td>
        连接数
       </td>
       <td>
        活动连接的数量
       </td>
       <td>
        连接数过高可能导致拒绝服务
       </td>
       <td>
        New Relic
       </td>
      </tr>
      <tr>
       <td>
        错误率
       </td>
       <td>
        每个请求的错误率
       </td>
       <td>
        错误率过高表明系统不稳定
       </td>
       <td>
        Sentry
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     这些指标的监控可以帮助开发团队及时了解系统的运行状况，并根据实际情况进行调整和优化。
    </p>
    <p>
     <strong>
      指标监控工作流程
     </strong>
    </p>
    <div class="mermaid">
     <svg class="mermaid-svg" height="427.8865661621094" id="mermaid-svg-xQ1fBcFSaZiu0qDm" viewbox="0 -0.0000019073486328125 393.5462646484375 427.8865661621094" width="393.5462646484375" xmlns="http://www.w3.org/2000/svg">
      <style>
       #mermaid-svg-xQ1fBcFSaZiu0qDm {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-svg-xQ1fBcFSaZiu0qDm .error-icon{fill:#552222;}#mermaid-svg-xQ1fBcFSaZiu0qDm .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-xQ1fBcFSaZiu0qDm .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-xQ1fBcFSaZiu0qDm .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-xQ1fBcFSaZiu0qDm .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-xQ1fBcFSaZiu0qDm .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-xQ1fBcFSaZiu0qDm .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-xQ1fBcFSaZiu0qDm .marker{fill:#333333;stroke:#333333;}#mermaid-svg-xQ1fBcFSaZiu0qDm .marker.cross{stroke:#333333;}#mermaid-svg-xQ1fBcFSaZiu0qDm svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-xQ1fBcFSaZiu0qDm .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-svg-xQ1fBcFSaZiu0qDm .cluster-label text{fill:#333;}#mermaid-svg-xQ1fBcFSaZiu0qDm .cluster-label span{color:#333;}#mermaid-svg-xQ1fBcFSaZiu0qDm .label text,#mermaid-svg-xQ1fBcFSaZiu0qDm span{fill:#333;color:#333;}#mermaid-svg-xQ1fBcFSaZiu0qDm .node rect,#mermaid-svg-xQ1fBcFSaZiu0qDm .node circle,#mermaid-svg-xQ1fBcFSaZiu0qDm .node ellipse,#mermaid-svg-xQ1fBcFSaZiu0qDm .node polygon,#mermaid-svg-xQ1fBcFSaZiu0qDm .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg-xQ1fBcFSaZiu0qDm .node .label{text-align:center;}#mermaid-svg-xQ1fBcFSaZiu0qDm .node.clickable{cursor:pointer;}#mermaid-svg-xQ1fBcFSaZiu0qDm .arrowheadPath{fill:#333333;}#mermaid-svg-xQ1fBcFSaZiu0qDm .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-svg-xQ1fBcFSaZiu0qDm .flowchart-link{stroke:#333333;fill:none;}#mermaid-svg-xQ1fBcFSaZiu0qDm .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-svg-xQ1fBcFSaZiu0qDm .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-svg-xQ1fBcFSaZiu0qDm .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-svg-xQ1fBcFSaZiu0qDm .cluster text{fill:#333;}#mermaid-svg-xQ1fBcFSaZiu0qDm .cluster span{color:#333;}#mermaid-svg-xQ1fBcFSaZiu0qDm div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-xQ1fBcFSaZiu0qDm :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-svg-xQ1fBcFSaZiu0qDm .watermark&gt;*{fill:#fff!important;stroke:none!important;font-size:15px!important;opacity:0.8!important;}#mermaid-svg-xQ1fBcFSaZiu0qDm .watermark span{fill:#fff!important;stroke:none!important;font-size:15px!important;opacity:0.8!important;}
      </style>
      <g>
       <g class="output">
        <g class="clusters">
        </g>
        <g class="edgePaths">
         <g class="edgePath LS-A LE-B" id="L-A-B" style="opacity: 1;">
          <path class="path" d="M196.77314376831055,53.983795166015625L196.77314376831055,60.31577825546265C196.77314376831055,66.64776134490967,196.77314376831055,79.31172752380371,196.77314376831055,91.97569370269775C196.77314376831055,104.6396598815918,196.77314376831055,117.30362606048584,196.77314376831055,123.63560914993286L196.77314376831055,129.96759223937988" marker-end="url(#arrowhead244)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead244" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-B LE-C" id="L-B-C" style="opacity: 1;">
          <path class="path" d="M196.77314376831055,175.9513874053955L196.77314376831055,182.28337049484253C196.77314376831055,188.61535358428955,196.77314376831055,201.2793197631836,196.77314376831055,213.94328594207764C196.77314376831055,226.60725212097168,196.77314376831055,239.27121829986572,196.77314376831055,245.60320138931274L196.77314376831055,251.93518447875977" marker-end="url(#arrowhead245)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead245" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-C LE-D" id="L-C-D" style="opacity: 1;">
          <path class="path" d="M196.77314376831055,297.9189796447754L196.77314376831055,304.2509627342224C196.77314376831055,310.58294582366943,196.77314376831055,323.2469120025635,196.77314376831055,335.9108781814575C196.77314376831055,348.57484436035156,196.77314376831055,361.2388105392456,196.77314376831055,367.5707936286926L196.77314376831055,373.90277671813965" marker-end="url(#arrowhead246)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead246" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
        </g>
        <g class="edgeLabels">
         <g class="edgeLabel" style="opacity: 1;" transform="translate(196.77314376831055,91.97569370269775)">
          <g class="label" transform="translate(-31.990741729736328,-12.991898536682129)">
           <rect height="25.983797073364258" rx="0" ry="0" width="63.981483459472656">
           </rect>
           <foreignobject height="25.983797073364258" width="63.981483459472656">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-A' L-LE-B" id="L-L-A-B">
              发送指标
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="translate(196.77314376831055,213.94328594207764)">
          <g class="label" transform="translate(-31.990741729736328,-12.991898536682129)">
           <rect height="25.983797073364258" rx="0" ry="0" width="63.981483459472656">
           </rect>
           <foreignobject height="25.983797073364258" width="63.981483459472656">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-B' L-LE-C" id="L-L-B-C">
              存储数据
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="translate(196.77314376831055,335.9108781814575)">
          <g class="label" transform="translate(-23.993057250976562,-12.991898536682129)">
           <rect height="25.983797073364258" rx="0" ry="0" width="47.986114501953125">
           </rect>
           <foreignobject height="25.983797073364258" width="47.986114501953125">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-C' L-LE-D" id="L-L-C-D">
              可视化
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
        </g>
        <g class="nodes">
         <g class="node watermark" id="flowchart-Z1-184" style="opacity: 1;" transform="translate(64.38888549804688,30.991897583007812)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="112.77777862548828" x="-56.38888931274414" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-46.38888931274414,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="92.77777862548828">
             <div style="display: inline-block; white-space: nowrap;">
              CSDN @ 2136
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-A-185" style="opacity: 1;" transform="translate(196.77314376831055,30.991897583007812)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="51.99074172973633" x="-25.995370864868164" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-15.995370864868164,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="31.990741729736328">
             <div style="display: inline-block; white-space: nowrap;">
              应用
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-B-186" style="opacity: 1;" transform="translate(196.77314376831055,152.9594898223877)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="83.98148345947266" x="-41.99074172973633" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-31.990741729736328,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="63.981483459472656">
             <div style="display: inline-block; white-space: nowrap;">
              监控系统
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-C-188" style="opacity: 1;" transform="translate(196.77314376831055,274.9270820617676)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="131.95602416992188" x="-65.97801208496094" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-55.97801208496094,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="111.95602416992188">
             <div style="display: inline-block; white-space: nowrap;">
              时间序列数据库
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-D-190" style="opacity: 1;" transform="translate(196.77314376831055,396.89467430114746)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="67.98611450195312" x="-33.99305725097656" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-23.993057250976562,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="47.986114501953125">
             <div style="display: inline-block; white-space: nowrap;">
              仪表盘
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node watermark" id="flowchart-Z2-191" style="opacity: 1;" transform="translate(329.1574020385742,30.991897583007812)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="112.77777862548828" x="-56.38888931274414" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-46.38888931274414,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="92.77777862548828">
             <div style="display: inline-block; white-space: nowrap;">
              CSDN @ 2136
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
        </g>
       </g>
      </g>
     </svg>
    </div>
    <h3>
     <a id="12__38">
     </a>
     1.2 事件监控
    </h3>
    <p>
     事件监控关注于记录和响应系统中的重要事件，如错误和警告。这一过程通常通过日志和告警系统实现。
    </p>
    <p>
     <strong>
      常见事件类型
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       错误事件
      </strong>
      ：如应用崩溃或功能失败，通常需要立即处理。
     </li>
     <li>
      <strong>
       警告事件
      </strong>
      ：如接近资源使用阈值，这类事件提示系统可能出现问题。
     </li>
     <li>
      <strong>
       信息事件
      </strong>
      ：系统运行正常时的状态更新，帮助监控团队了解当前状态。
     </li>
    </ul>
    <p>
     事件监控确保系统中的关键事件不会被忽视，从而帮助团队快速响应和处理潜在问题。
    </p>
    <h3>
     <a id="13__50">
     </a>
     1.3 告警管理
    </h3>
    <p>
     告警管理系统确保及时通知相关人员以便快速响应。关键要素包括：
    </p>
    <ul>
     <li>
      <strong>
       告警阈值
      </strong>
      ：合理设置告警的阈值，以避免误报和漏报。应根据历史数据进行分析，找到最佳阈值。
     </li>
     <li>
      <strong>
       通知渠道
      </strong>
      ：使用多种渠道（如电子邮件、短信、Slack 等）通知相关人员，以确保消息能及时到达。
     </li>
     <li>
      <strong>
       告警分类
      </strong>
      ：将告警分为不同级别（如严重、警告、信息）以便优先处理，确保重要问题能得到及时关注。
     </li>
    </ul>
    <p>
     告警管理的有效性直接影响到故障的处理效率，合理的告警策略可以大大提升团队的反应速度。
    </p>
    <h2>
     <a id="_60">
     </a>
     二、观察性的定义
    </h2>
    <p>
     观察性是指通过外部输出（如指标、日志和追踪信息）推测系统内部状态的能力。观察性主要依赖以下三大支柱：
    </p>
    <ul>
     <li>
      <strong>
       指标
      </strong>
      ：实时数据，反映系统的性能和健康状态。
     </li>
     <li>
      <strong>
       日志
      </strong>
      ：记录系统的操作和异常，有助于故障排查和性能优化。
     </li>
     <li>
      <strong>
       追踪
      </strong>
      ：跟踪请求在系统中的流动，帮助识别瓶颈。
     </li>
    </ul>
    <p>
     通过综合使用这些信息，团队能够更全面地理解系统的运行状况，及时发现并解决问题。
    </p>
    <p>
     <strong>
      观察性工作流程
     </strong>
    </p>
    <div class="mermaid">
     <svg class="mermaid-svg" height="305.91900634765625" id="mermaid-svg-NddNnHJyCH36RMn5" viewbox="0 -0.0000019073486328125 597.52783203125 305.91900634765625" width="597.52783203125" xmlns="http://www.w3.org/2000/svg">
      <style>
       #mermaid-svg-NddNnHJyCH36RMn5 {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-svg-NddNnHJyCH36RMn5 .error-icon{fill:#552222;}#mermaid-svg-NddNnHJyCH36RMn5 .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-NddNnHJyCH36RMn5 .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-NddNnHJyCH36RMn5 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-NddNnHJyCH36RMn5 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-NddNnHJyCH36RMn5 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-NddNnHJyCH36RMn5 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-NddNnHJyCH36RMn5 .marker{fill:#333333;stroke:#333333;}#mermaid-svg-NddNnHJyCH36RMn5 .marker.cross{stroke:#333333;}#mermaid-svg-NddNnHJyCH36RMn5 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-NddNnHJyCH36RMn5 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-svg-NddNnHJyCH36RMn5 .cluster-label text{fill:#333;}#mermaid-svg-NddNnHJyCH36RMn5 .cluster-label span{color:#333;}#mermaid-svg-NddNnHJyCH36RMn5 .label text,#mermaid-svg-NddNnHJyCH36RMn5 span{fill:#333;color:#333;}#mermaid-svg-NddNnHJyCH36RMn5 .node rect,#mermaid-svg-NddNnHJyCH36RMn5 .node circle,#mermaid-svg-NddNnHJyCH36RMn5 .node ellipse,#mermaid-svg-NddNnHJyCH36RMn5 .node polygon,#mermaid-svg-NddNnHJyCH36RMn5 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg-NddNnHJyCH36RMn5 .node .label{text-align:center;}#mermaid-svg-NddNnHJyCH36RMn5 .node.clickable{cursor:pointer;}#mermaid-svg-NddNnHJyCH36RMn5 .arrowheadPath{fill:#333333;}#mermaid-svg-NddNnHJyCH36RMn5 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-svg-NddNnHJyCH36RMn5 .flowchart-link{stroke:#333333;fill:none;}#mermaid-svg-NddNnHJyCH36RMn5 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-svg-NddNnHJyCH36RMn5 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-svg-NddNnHJyCH36RMn5 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-svg-NddNnHJyCH36RMn5 .cluster text{fill:#333;}#mermaid-svg-NddNnHJyCH36RMn5 .cluster span{color:#333;}#mermaid-svg-NddNnHJyCH36RMn5 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-NddNnHJyCH36RMn5 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-svg-NddNnHJyCH36RMn5 .watermark&gt;*{fill:#fff!important;stroke:none!important;font-size:15px!important;opacity:0.8!important;}#mermaid-svg-NddNnHJyCH36RMn5 .watermark span{fill:#fff!important;stroke:none!important;font-size:15px!important;opacity:0.8!important;}
      </style>
      <g>
       <g class="output">
        <g class="clusters">
        </g>
        <g class="edgePaths">
         <g class="edgePath LS-A LE-B" id="L-A-B" style="opacity: 1;">
          <path class="path" d="M196.77314376831055,53.983795166015625L196.77314376831055,60.31577825546265C196.77314376831055,66.64776134490967,196.77314376831055,79.31172752380371,207.3629023133503,91.97569370269775C217.95266085839003,104.6396598815918,239.1321779484695,117.30362606048584,249.72193649350925,123.63560914993286L260.311695038549,129.96759223937988" marker-end="url(#arrowhead264)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead264" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-C LE-B" id="L-C-B" style="opacity: 1;">
          <path class="path" d="M298.76388931274414,53.983795166015625L298.76388931274414,60.31577825546265C298.76388931274414,66.64776134490967,298.76388931274414,79.31172752380371,298.76388931274414,91.97569370269775C298.76388931274414,104.6396598815918,298.76388931274414,117.30362606048584,298.76388931274414,123.63560914993286L298.76388931274414,129.96759223937988" marker-end="url(#arrowhead265)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead265" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-D LE-B" id="L-D-B" style="opacity: 1;">
          <path class="path" d="M400.75463485717773,53.983795166015625L400.75463485717773,60.31577825546265C400.75463485717773,66.64776134490967,400.75463485717773,79.31172752380371,390.164876312138,91.97569370269775C379.5751177670982,104.6396598815918,358.39560067701876,117.30362606048584,347.80584213197903,123.63560914993286L337.2160835869393,129.96759223937988" marker-end="url(#arrowhead266)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead266" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-B LE-E" id="L-B-E" style="opacity: 1;">
          <path class="path" d="M298.76388931274414,175.9513874053955L298.76388931274414,182.28337049484253C298.76388931274414,188.61535358428955,298.76388931274414,201.2793197631836,298.76388931274414,213.94328594207764C298.76388931274414,226.60725212097168,298.76388931274414,239.27121829986572,298.76388931274414,245.60320138931274L298.76388931274414,251.93518447875977" marker-end="url(#arrowhead267)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead267" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
        </g>
        <g class="edgeLabels">
         <g class="edgeLabel" style="opacity: 1;" transform="translate(196.77314376831055,91.97569370269775)">
          <g class="label" transform="translate(-15.992477416992188,-12.991898536682129)">
           <rect height="25.983797073364258" rx="0" ry="0" width="31.984954833984375">
           </rect>
           <foreignobject height="25.983797073364258" width="31.984954833984375">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-A' L-LE-B" id="L-L-A-B">
              收集
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="translate(298.76388931274414,91.97569370269775)">
          <g class="label" transform="translate(-15.992477416992188,-12.991898536682129)">
           <rect height="25.983797073364258" rx="0" ry="0" width="31.984954833984375">
           </rect>
           <foreignobject height="25.983797073364258" width="31.984954833984375">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-C' L-LE-B" id="L-L-C-B">
              记录
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="translate(400.75463485717773,91.97569370269775)">
          <g class="label" transform="translate(-15.992477416992188,-12.991898536682129)">
           <rect height="25.983797073364258" rx="0" ry="0" width="31.984954833984375">
           </rect>
           <foreignobject height="25.983797073364258" width="31.984954833984375">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-D' L-LE-B" id="L-L-D-B">
              分析
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="translate(298.76388931274414,213.94328594207764)">
          <g class="label" transform="translate(-31.990741729736328,-12.991898536682129)">
           <rect height="25.983797073364258" rx="0" ry="0" width="63.981483459472656">
           </rect>
           <foreignobject height="25.983797073364258" width="63.981483459472656">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-B' L-LE-E" id="L-L-B-E">
              提供洞见
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
        </g>
        <g class="nodes">
         <g class="node watermark" id="flowchart-Z1-202" style="opacity: 1;" transform="translate(64.38888549804688,30.991897583007812)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="112.77777862548828" x="-56.38888931274414" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-46.38888931274414,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="92.77777862548828">
             <div style="display: inline-block; white-space: nowrap;">
              CSDN @ 2136
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-A-203" style="opacity: 1;" transform="translate(196.77314376831055,30.991897583007812)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="51.99074172973633" x="-25.995370864868164" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-15.995370864868164,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="31.990741729736328">
             <div style="display: inline-block; white-space: nowrap;">
              指标
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-B-204" style="opacity: 1;" transform="translate(298.76388931274414,152.9594898223877)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="99.96527862548828" x="-49.98263931274414" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-39.98263931274414,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="79.96527862548828">
             <div style="display: inline-block; white-space: nowrap;">
              观察性工具
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-C-205" style="opacity: 1;" transform="translate(298.76388931274414,30.991897583007812)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="51.99074172973633" x="-25.995370864868164" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-15.995370864868164,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="31.990741729736328">
             <div style="display: inline-block; white-space: nowrap;">
              日志
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-D-207" style="opacity: 1;" transform="translate(400.75463485717773,30.991897583007812)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="51.99074172973633" x="-25.995370864868164" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-15.995370864868164,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="31.990741729736328">
             <div style="display: inline-block; white-space: nowrap;">
              追踪
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-E-210" style="opacity: 1;" transform="translate(298.76388931274414,274.9270820617676)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="83.98148345947266" x="-41.99074172973633" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-31.990741729736328,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="63.981483459472656">
             <div style="display: inline-block; white-space: nowrap;">
              开发团队
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node watermark" id="flowchart-Z2-211" style="opacity: 1;" transform="translate(533.1388931274414,30.991897583007812)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="112.77777862548828" x="-56.38888931274414" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-46.38888931274414,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="92.77777862548828">
             <div style="display: inline-block; white-space: nowrap;">
              CSDN @ 2136
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
        </g>
       </g>
      </g>
     </svg>
    </div>
    <h2>
     <a id="_83">
     </a>
     三、实现监控与观察性的方法
    </h2>
    <h3>
     <a id="31__85">
     </a>
     3.1 指标收集与监控
    </h3>
    <p>
     使用
     <strong>
      Prometheus
     </strong>
     来收集和监控指标。Prometheus 是一个开源的监控系统，能够支持多种数据源和查询语言。
    </p>
    <p>
     <strong>
      Prometheus 工作流程
     </strong>
    </p>
    <ol>
     <li>
      <strong>
       数据抓取
      </strong>
      ：通过 HTTP 从目标应用抓取指标。
     </li>
     <li>
      <strong>
       数据存储
      </strong>
      ：将数据存储在时间序列数据库中，支持高效的查询。
     </li>
     <li>
      <strong>
       查询
      </strong>
      ：使用 PromQL（Prometheus 查询语言）进行数据查询和分析。
     </li>
    </ol>
    <p>
     <strong>
      Prometheus 监控架构
     </strong>
    </p>
    <div class="mermaid">
     <svg class="mermaid-svg" height="427.8865661621094" id="mermaid-svg-CyxuhjClcxijbE2T" viewbox="0 -0.0000019073486328125 393.5462646484375 427.8865661621094" width="393.5462646484375" xmlns="http://www.w3.org/2000/svg">
      <style>
       #mermaid-svg-CyxuhjClcxijbE2T {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-svg-CyxuhjClcxijbE2T .error-icon{fill:#552222;}#mermaid-svg-CyxuhjClcxijbE2T .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-CyxuhjClcxijbE2T .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-CyxuhjClcxijbE2T .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-CyxuhjClcxijbE2T .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-CyxuhjClcxijbE2T .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-CyxuhjClcxijbE2T .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-CyxuhjClcxijbE2T .marker{fill:#333333;stroke:#333333;}#mermaid-svg-CyxuhjClcxijbE2T .marker.cross{stroke:#333333;}#mermaid-svg-CyxuhjClcxijbE2T svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-CyxuhjClcxijbE2T .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-svg-CyxuhjClcxijbE2T .cluster-label text{fill:#333;}#mermaid-svg-CyxuhjClcxijbE2T .cluster-label span{color:#333;}#mermaid-svg-CyxuhjClcxijbE2T .label text,#mermaid-svg-CyxuhjClcxijbE2T span{fill:#333;color:#333;}#mermaid-svg-CyxuhjClcxijbE2T .node rect,#mermaid-svg-CyxuhjClcxijbE2T .node circle,#mermaid-svg-CyxuhjClcxijbE2T .node ellipse,#mermaid-svg-CyxuhjClcxijbE2T .node polygon,#mermaid-svg-CyxuhjClcxijbE2T .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg-CyxuhjClcxijbE2T .node .label{text-align:center;}#mermaid-svg-CyxuhjClcxijbE2T .node.clickable{cursor:pointer;}#mermaid-svg-CyxuhjClcxijbE2T .arrowheadPath{fill:#333333;}#mermaid-svg-CyxuhjClcxijbE2T .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-svg-CyxuhjClcxijbE2T .flowchart-link{stroke:#333333;fill:none;}#mermaid-svg-CyxuhjClcxijbE2T .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-svg-CyxuhjClcxijbE2T .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-svg-CyxuhjClcxijbE2T .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-svg-CyxuhjClcxijbE2T .cluster text{fill:#333;}#mermaid-svg-CyxuhjClcxijbE2T .cluster span{color:#333;}#mermaid-svg-CyxuhjClcxijbE2T div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-CyxuhjClcxijbE2T :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-svg-CyxuhjClcxijbE2T .watermark&gt;*{fill:#fff!important;stroke:none!important;font-size:15px!important;opacity:0.8!important;}#mermaid-svg-CyxuhjClcxijbE2T .watermark span{fill:#fff!important;stroke:none!important;font-size:15px!important;opacity:0.8!important;}
      </style>
      <g>
       <g class="output">
        <g class="clusters">
        </g>
        <g class="edgePaths">
         <g class="edgePath LS-A LE-B" id="L-A-B" style="opacity: 1;">
          <path class="path" d="M196.77314376831055,53.983795166015625L196.77314376831055,60.31577825546265C196.77314376831055,66.64776134490967,196.77314376831055,79.31172752380371,196.77314376831055,91.97569370269775C196.77314376831055,104.6396598815918,196.77314376831055,117.30362606048584,196.77314376831055,123.63560914993286L196.77314376831055,129.96759223937988" marker-end="url(#arrowhead287)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead287" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-B LE-C" id="L-B-C" style="opacity: 1;">
          <path class="path" d="M196.77314376831055,175.9513874053955L196.77314376831055,182.28337049484253C196.77314376831055,188.61535358428955,196.77314376831055,201.2793197631836,196.77314376831055,213.94328594207764C196.77314376831055,226.60725212097168,196.77314376831055,239.27121829986572,196.77314376831055,245.60320138931274L196.77314376831055,251.93518447875977" marker-end="url(#arrowhead288)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead288" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-C LE-D" id="L-C-D" style="opacity: 1;">
          <path class="path" d="M196.77314376831055,297.9189796447754L196.77314376831055,304.2509627342224C196.77314376831055,310.58294582366943,196.77314376831055,323.2469120025635,196.77314376831055,335.9108781814575C196.77314376831055,348.57484436035156,196.77314376831055,361.2388105392456,196.77314376831055,367.5707936286926L196.77314376831055,373.90277671813965" marker-end="url(#arrowhead289)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead289" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
        </g>
        <g class="edgeLabels">
         <g class="edgeLabel" style="opacity: 1;" transform="translate(196.77314376831055,91.97569370269775)">
          <g class="label" transform="translate(-15.992477416992188,-12.991898536682129)">
           <rect height="25.983797073364258" rx="0" ry="0" width="31.984954833984375">
           </rect>
           <foreignobject height="25.983797073364258" width="31.984954833984375">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-A' L-LE-B" id="L-L-A-B">
              抓取
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="translate(196.77314376831055,213.94328594207764)">
          <g class="label" transform="translate(-15.992477416992188,-12.991898536682129)">
           <rect height="25.983797073364258" rx="0" ry="0" width="31.984954833984375">
           </rect>
           <foreignobject height="25.983797073364258" width="31.984954833984375">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-B' L-LE-C" id="L-L-B-C">
              存储
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="translate(196.77314376831055,335.9108781814575)">
          <g class="label" transform="translate(-15.992477416992188,-12.991898536682129)">
           <rect height="25.983797073364258" rx="0" ry="0" width="31.984954833984375">
           </rect>
           <foreignobject height="25.983797073364258" width="31.984954833984375">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-C' L-LE-D" id="L-L-C-D">
              查询
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
        </g>
        <g class="nodes">
         <g class="node watermark" id="flowchart-Z1-220" style="opacity: 1;" transform="translate(64.38888549804688,30.991897583007812)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="112.77777862548828" x="-56.38888931274414" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-46.38888931274414,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="92.77777862548828">
             <div style="display: inline-block; white-space: nowrap;">
              CSDN @ 2136
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-A-221" style="opacity: 1;" transform="translate(196.77314376831055,30.991897583007812)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="51.99074172973633" x="-25.995370864868164" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-15.995370864868164,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="31.990741729736328">
             <div style="display: inline-block; white-space: nowrap;">
              应用
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-B-222" style="opacity: 1;" transform="translate(196.77314376831055,152.9594898223877)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="103.98148345947266" x="-51.99074172973633" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-41.99074172973633,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="83.98148345947266">
             <div style="display: inline-block; white-space: nowrap;">
              Prometheus
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-C-224" style="opacity: 1;" transform="translate(196.77314376831055,274.9270820617676)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="131.95602416992188" x="-65.97801208496094" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-55.97801208496094,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="111.95602416992188">
             <div style="display: inline-block; white-space: nowrap;">
              时间序列数据库
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-D-226" style="opacity: 1;" transform="translate(196.77314376831055,396.89467430114746)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="75.15046691894531" x="-37.575233459472656" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-27.575233459472656,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="55.15046691894531">
             <div style="display: inline-block; white-space: nowrap;">
              PromQL
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node watermark" id="flowchart-Z2-227" style="opacity: 1;" transform="translate(329.1574020385742,30.991897583007812)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="112.77777862548828" x="-56.38888931274414" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-46.38888931274414,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="92.77777862548828">
             <div style="display: inline-block; white-space: nowrap;">
              CSDN @ 2136
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
        </g>
       </g>
      </g>
     </svg>
    </div>
    <p>
     <strong>
      Prometheus 使用示例
     </strong>
    </p>
    <pre><code class="prism language-yaml"><span class="token comment"># Prometheus 配置示例</span>
<span class="token key atrule">scrape_configs</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">job_name</span><span class="token punctuation">:</span> <span class="token string">'my_app'</span>
    <span class="token key atrule">static_configs</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">targets</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'localhost:9090'</span><span class="token punctuation">]</span>
</code></pre>
    <p>
     通过以上配置，Prometheus 可以定期抓取应用的指标数据，并存储在时间序列数据库中，便于后续的查询和分析。
    </p>
    <h3>
     <a id="32__119">
     </a>
     3.2 日志管理
    </h3>
    <p>
     有效的日志管理是快速定位问题的关键。可以使用
     <strong>
      ELK Stack
     </strong>
     （Elasticsearch, Logstash, Kibana）或
     <strong>
      Fluentd
     </strong>
     来实现日志管理。
    </p>
    <p>
     <strong>
      ELK Stack 工作流程
     </strong>
    </p>
    <ol>
     <li>
      <strong>
       数据收集
      </strong>
      ：使用 Logstash 或 Fluentd 收集和解析日志数据。
     </li>
     <li>
      <strong>
       数据存储
      </strong>
      ：将日志数据存储到 Elasticsearch，以便快速检索。
     </li>
     <li>
      <strong>
       数据可视化
      </strong>
      ：使用 Kibana 进行数据分析和可视化。
     </li>
    </ol>
    <p>
     <strong>
      ELK Stack 架构示意
     </strong>
    </p>
    <div class="mermaid">
     <svg class="mermaid-svg" height="427.8865661621094" id="mermaid-svg-voJPQG7wuE2pFWF4" viewbox="0 -0.0000019073486328125 425.5370178222656 427.8865661621094" width="425.5370178222656" xmlns="http://www.w3.org/2000/svg">
      <style>
       #mermaid-svg-voJPQG7wuE2pFWF4 {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-svg-voJPQG7wuE2pFWF4 .error-icon{fill:#552222;}#mermaid-svg-voJPQG7wuE2pFWF4 .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-voJPQG7wuE2pFWF4 .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-voJPQG7wuE2pFWF4 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-voJPQG7wuE2pFWF4 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-voJPQG7wuE2pFWF4 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-voJPQG7wuE2pFWF4 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-voJPQG7wuE2pFWF4 .marker{fill:#333333;stroke:#333333;}#mermaid-svg-voJPQG7wuE2pFWF4 .marker.cross{stroke:#333333;}#mermaid-svg-voJPQG7wuE2pFWF4 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-voJPQG7wuE2pFWF4 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-svg-voJPQG7wuE2pFWF4 .cluster-label text{fill:#333;}#mermaid-svg-voJPQG7wuE2pFWF4 .cluster-label span{color:#333;}#mermaid-svg-voJPQG7wuE2pFWF4 .label text,#mermaid-svg-voJPQG7wuE2pFWF4 span{fill:#333;color:#333;}#mermaid-svg-voJPQG7wuE2pFWF4 .node rect,#mermaid-svg-voJPQG7wuE2pFWF4 .node circle,#mermaid-svg-voJPQG7wuE2pFWF4 .node ellipse,#mermaid-svg-voJPQG7wuE2pFWF4 .node polygon,#mermaid-svg-voJPQG7wuE2pFWF4 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg-voJPQG7wuE2pFWF4 .node .label{text-align:center;}#mermaid-svg-voJPQG7wuE2pFWF4 .node.clickable{cursor:pointer;}#mermaid-svg-voJPQG7wuE2pFWF4 .arrowheadPath{fill:#333333;}#mermaid-svg-voJPQG7wuE2pFWF4 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-svg-voJPQG7wuE2pFWF4 .flowchart-link{stroke:#333333;fill:none;}#mermaid-svg-voJPQG7wuE2pFWF4 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-svg-voJPQG7wuE2pFWF4 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-svg-voJPQG7wuE2pFWF4 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-svg-voJPQG7wuE2pFWF4 .cluster text{fill:#333;}#mermaid-svg-voJPQG7wuE2pFWF4 .cluster span{color:#333;}#mermaid-svg-voJPQG7wuE2pFWF4 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-voJPQG7wuE2pFWF4 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-svg-voJPQG7wuE2pFWF4 .watermark&gt;*{fill:#fff!important;stroke:none!important;font-size:15px!important;opacity:0.8!important;}#mermaid-svg-voJPQG7wuE2pFWF4 .watermark span{fill:#fff!important;stroke:none!important;font-size:15px!important;opacity:0.8!important;}
      </style>
      <g>
       <g class="output">
        <g class="clusters">
        </g>
        <g class="edgePaths">
         <g class="edgePath LS-A LE-B" id="L-A-B" style="opacity: 1;">
          <path class="path" d="M212.76851272583008,53.983795166015625L212.76851272583008,60.31577825546265C212.76851272583008,66.64776134490967,212.76851272583008,79.31172752380371,212.76851272583008,91.97569370269775C212.76851272583008,104.6396598815918,212.76851272583008,117.30362606048584,212.76851272583008,123.63560914993286L212.76851272583008,129.96759223937988" marker-end="url(#arrowhead309)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead309" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-B LE-C" id="L-B-C" style="opacity: 1;">
          <path class="path" d="M212.76851272583008,175.9513874053955L212.76851272583008,182.28337049484253C212.76851272583008,188.61535358428955,212.76851272583008,201.2793197631836,212.76851272583008,213.94328594207764C212.76851272583008,226.60725212097168,212.76851272583008,239.27121829986572,212.76851272583008,245.60320138931274L212.76851272583008,251.93518447875977" marker-end="url(#arrowhead310)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead310" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-C LE-D" id="L-C-D" style="opacity: 1;">
          <path class="path" d="M212.76851272583008,297.9189796447754L212.76851272583008,304.2509627342224C212.76851272583008,310.58294582366943,212.76851272583008,323.2469120025635,212.76851272583008,335.9108781814575C212.76851272583008,348.57484436035156,212.76851272583008,361.2388105392456,212.76851272583008,367.5707936286926L212.76851272583008,373.90277671813965" marker-end="url(#arrowhead311)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead311" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
        </g>
        <g class="edgeLabels">
         <g class="edgeLabel" style="opacity: 1;" transform="translate(212.76851272583008,91.97569370269775)">
          <g class="label" transform="translate(-15.992477416992188,-12.991898536682129)">
           <rect height="25.983797073364258" rx="0" ry="0" width="31.984954833984375">
           </rect>
           <foreignobject height="25.983797073364258" width="31.984954833984375">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-A' L-LE-B" id="L-L-A-B">
              收集
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="translate(212.76851272583008,213.94328594207764)">
          <g class="label" transform="translate(-15.992477416992188,-12.991898536682129)">
           <rect height="25.983797073364258" rx="0" ry="0" width="31.984954833984375">
           </rect>
           <foreignobject height="25.983797073364258" width="31.984954833984375">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-B' L-LE-C" id="L-L-B-C">
              存储
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="translate(212.76851272583008,335.9108781814575)">
          <g class="label" transform="translate(-23.993057250976562,-12.991898536682129)">
           <rect height="25.983797073364258" rx="0" ry="0" width="47.986114501953125">
           </rect>
           <foreignobject height="25.983797073364258" width="47.986114501953125">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-C' L-LE-D" id="L-L-C-D">
              可视化
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
        </g>
        <g class="nodes">
         <g class="node watermark" id="flowchart-Z1-236" style="opacity: 1;" transform="translate(64.38888549804688,30.991897583007812)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="112.77777862548828" x="-56.38888931274414" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-46.38888931274414,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="92.77777862548828">
             <div style="display: inline-block; white-space: nowrap;">
              CSDN @ 2136
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-A-237" style="opacity: 1;" transform="translate(212.76851272583008,30.991897583007812)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="83.98148345947266" x="-41.99074172973633" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-31.990741729736328,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="63.981483459472656">
             <div style="display: inline-block; white-space: nowrap;">
              日志来源
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-B-238" style="opacity: 1;" transform="translate(212.76851272583008,152.9594898223877)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="144.08565521240234" x="-72.04282760620117" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-62.04282760620117,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="124.08565521240234">
             <div style="display: inline-block; white-space: nowrap;">
              Logstash/Fluentd
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-C-240" style="opacity: 1;" transform="translate(212.76851272583008,274.9270820617676)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="113.44908142089844" x="-56.72454071044922" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-46.72454071044922,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="93.44908142089844">
             <div style="display: inline-block; white-space: nowrap;">
              Elasticsearch
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-D-242" style="opacity: 1;" transform="translate(212.76851272583008,396.89467430114746)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="67.73148345947266" x="-33.86574172973633" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-23.865741729736328,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="47.731483459472656">
             <div style="display: inline-block; white-space: nowrap;">
              Kibana
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node watermark" id="flowchart-Z2-243" style="opacity: 1;" transform="translate(361.1481399536133,30.991897583007812)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="112.77777862548828" x="-56.38888931274414" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-46.38888931274414,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="92.77777862548828">
             <div style="display: inline-block; white-space: nowrap;">
              CSDN @ 2136
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
        </g>
       </g>
      </g>
     </svg>
    </div>
    <p>
     <strong>
      ELK Stack 配置示例
     </strong>
    </p>
    <pre><code class="prism language-json"><span class="token comment">// Logstash 配置示例</span>
input <span class="token punctuation">{<!-- --></span>
  beats <span class="token punctuation">{<!-- --></span>
    <span class="token parameter">port</span> <span class="token operator">=&gt;</span> <span class="token number">5044</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
output <span class="token punctuation">{<!-- --></span>
  elasticsearch <span class="token punctuation">{<!-- --></span>
    <span class="token parameter">hosts</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token string">"http://localhost:9200"</span><span class="token punctuation">]</span>
    <span class="token parameter">index</span> <span class="token operator">=&gt;</span> <span class="token string">"logs-%{+YYYY.MM.dd}"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     通过以上配置，Logstash 将通过 Beats 收集到的日志数据发送到 Elasticsearch 中，方便后续进行分析和可视化。
    </p>
    <h3>
     <a id="33__160">
     </a>
     3.3 性能分析
    </h3>
    <p>
     性能分析是监控的重要组成部分，可以使用
     <strong>
      Grafana
     </strong>
     和
     <strong>
      Jaeger
     </strong>
     进行分析和可视化。
    </p>
    <ul>
     <li>
      <strong>
       Grafana
      </strong>
      ：用于可视化监控数据，支持多种数据源，提供丰富的图表和仪表板功能。
     </li>
     <li>
      <strong>
       Jaeger
      </strong>
      ：用于分布式追踪，帮助开发者了解请求在微服务中的流动，识别性能瓶颈。
     </li>
    </ul>
    <p>
     <strong>
      Grafana 与 Jaeger 工作流程
     </strong>
    </p>
    <div class="mermaid">
     <svg class="mermaid-svg" height="427.8865661621094" id="mermaid-svg-b4gfFT5qcySEfLTM" viewbox="0 -0.0000019073486328125 393.5462646484375 427.8865661621094" width="393.5462646484375" xmlns="http://www.w3.org/2000/svg">
      <style>
       #mermaid-svg-b4gfFT5qcySEfLTM {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-svg-b4gfFT5qcySEfLTM .error-icon{fill:#552222;}#mermaid-svg-b4gfFT5qcySEfLTM .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-b4gfFT5qcySEfLTM .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-b4gfFT5qcySEfLTM .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-b4gfFT5qcySEfLTM .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-b4gfFT5qcySEfLTM .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-b4gfFT5qcySEfLTM .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-b4gfFT5qcySEfLTM .marker{fill:#333333;stroke:#333333;}#mermaid-svg-b4gfFT5qcySEfLTM .marker.cross{stroke:#333333;}#mermaid-svg-b4gfFT5qcySEfLTM svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-b4gfFT5qcySEfLTM .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-svg-b4gfFT5qcySEfLTM .cluster-label text{fill:#333;}#mermaid-svg-b4gfFT5qcySEfLTM .cluster-label span{color:#333;}#mermaid-svg-b4gfFT5qcySEfLTM .label text,#mermaid-svg-b4gfFT5qcySEfLTM span{fill:#333;color:#333;}#mermaid-svg-b4gfFT5qcySEfLTM .node rect,#mermaid-svg-b4gfFT5qcySEfLTM .node circle,#mermaid-svg-b4gfFT5qcySEfLTM .node ellipse,#mermaid-svg-b4gfFT5qcySEfLTM .node polygon,#mermaid-svg-b4gfFT5qcySEfLTM .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg-b4gfFT5qcySEfLTM .node .label{text-align:center;}#mermaid-svg-b4gfFT5qcySEfLTM .node.clickable{cursor:pointer;}#mermaid-svg-b4gfFT5qcySEfLTM .arrowheadPath{fill:#333333;}#mermaid-svg-b4gfFT5qcySEfLTM .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-svg-b4gfFT5qcySEfLTM .flowchart-link{stroke:#333333;fill:none;}#mermaid-svg-b4gfFT5qcySEfLTM .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-svg-b4gfFT5qcySEfLTM .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-svg-b4gfFT5qcySEfLTM .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-svg-b4gfFT5qcySEfLTM .cluster text{fill:#333;}#mermaid-svg-b4gfFT5qcySEfLTM .cluster span{color:#333;}#mermaid-svg-b4gfFT5qcySEfLTM div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-b4gfFT5qcySEfLTM :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-svg-b4gfFT5qcySEfLTM .watermark&gt;*{fill:#fff!important;stroke:none!important;font-size:15px!important;opacity:0.8!important;}#mermaid-svg-b4gfFT5qcySEfLTM .watermark span{fill:#fff!important;stroke:none!important;font-size:15px!important;opacity:0.8!important;}
      </style>
      <g>
       <g class="output">
        <g class="clusters">
        </g>
        <g class="edgePaths">
         <g class="edgePath LS-A LE-B" id="L-A-B" style="opacity: 1;">
          <path class="path" d="M196.77314376831055,53.983795166015625L196.77314376831055,60.31577825546265C196.77314376831055,66.64776134490967,196.77314376831055,79.31172752380371,196.77314376831055,91.97569370269775C196.77314376831055,104.6396598815918,196.77314376831055,117.30362606048584,196.77314376831055,123.63560914993286L196.77314376831055,129.96759223937988" marker-end="url(#arrowhead333)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead333" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-B LE-C" id="L-B-C" style="opacity: 1;">
          <path class="path" d="M175.2114215969855,175.9513874053955L169.27330971756035,182.28337049484253C163.3351978381352,188.61535358428955,151.45897407928487,201.2793197631836,145.52086219985972,213.94328594207764C139.58275032043457,226.60725212097168,139.58275032043457,239.27121829986572,139.58275032043457,245.60320138931274L139.58275032043457,251.93518447875977" marker-end="url(#arrowhead334)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead334" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-C LE-D" id="L-C-D" style="opacity: 1;">
          <path class="path" d="M139.58275032043457,297.9189796447754L139.58275032043457,304.2509627342224C139.58275032043457,310.58294582366943,139.58275032043457,323.2469120025635,139.58275032043457,335.9108781814575C139.58275032043457,348.57484436035156,139.58275032043457,361.2388105392456,139.58275032043457,367.5707936286926L139.58275032043457,373.90277671813965" marker-end="url(#arrowhead335)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead335" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
         <g class="edgePath LS-B LE-E" id="L-B-E" style="opacity: 1;">
          <path class="path" d="M218.3348659396356,175.9513874053955L224.27297781906074,182.28337049484253C230.21108969848592,188.61535358428955,242.08731345733622,201.2793197631836,248.02542533676137,213.94328594207764C253.96353721618652,226.60725212097168,253.96353721618652,239.27121829986572,253.96353721618652,245.60320138931274L253.96353721618652,251.93518447875977" marker-end="url(#arrowhead336)" style="fill:none">
          </path>
          <defs>
           <marker id="arrowhead336" markerheight="6" markerunits="strokeWidth" markerwidth="8" orient="auto" refx="9" refy="5" viewbox="0 0 10 10">
            <path class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z" style="stroke-width: 1; stroke-dasharray: 1, 0;">
            </path>
           </marker>
          </defs>
         </g>
        </g>
        <g class="edgeLabels">
         <g class="edgeLabel" style="opacity: 1;" transform="translate(196.77314376831055,91.97569370269775)">
          <g class="label" transform="translate(-15.992477416992188,-12.991898536682129)">
           <rect height="25.983797073364258" rx="0" ry="0" width="31.984954833984375">
           </rect>
           <foreignobject height="25.983797073364258" width="31.984954833984375">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-A' L-LE-B" id="L-L-A-B">
              请求
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="translate(139.58275032043457,213.94328594207764)">
          <g class="label" transform="translate(-15.992477416992188,-12.991898536682129)">
           <rect height="25.983797073364258" rx="0" ry="0" width="31.984954833984375">
           </rect>
           <foreignobject height="25.983797073364258" width="31.984954833984375">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-B' L-LE-C" id="L-L-B-C">
              调用
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="translate(139.58275032043457,335.9108781814575)">
          <g class="label" transform="translate(-15.992477416992188,-12.991898536682129)">
           <rect height="25.983797073364258" rx="0" ry="0" width="31.984954833984375">
           </rect>
           <foreignobject height="25.983797073364258" width="31.984954833984375">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-C' L-LE-D" id="L-L-C-D">
              返回
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
         <g class="edgeLabel" style="opacity: 1;" transform="translate(253.96353721618652,213.94328594207764)">
          <g class="label" transform="translate(-15.992477416992188,-12.991898536682129)">
           <rect height="25.983797073364258" rx="0" ry="0" width="31.984954833984375">
           </rect>
           <foreignobject height="25.983797073364258" width="31.984954833984375">
            <div style="display: inline-block; white-space: nowrap;">
             <span class="edgeLabel L-LS-B' L-LE-E" id="L-L-B-E">
              追踪
             </span>
            </div>
           </foreignobject>
          </g>
         </g>
        </g>
        <g class="nodes">
         <g class="node watermark" id="flowchart-Z1-254" style="opacity: 1;" transform="translate(64.38888549804688,30.991897583007812)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="112.77777862548828" x="-56.38888931274414" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-46.38888931274414,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="92.77777862548828">
             <div style="display: inline-block; white-space: nowrap;">
              CSDN @ 2136
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-A-255" style="opacity: 1;" transform="translate(196.77314376831055,30.991897583007812)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="51.99074172973633" x="-25.995370864868164" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-15.995370864868164,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="31.990741729736328">
             <div style="display: inline-block; white-space: nowrap;">
              应用
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-B-256" style="opacity: 1;" transform="translate(196.77314376831055,152.9594898223877)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="61.423614501953125" x="-30.711807250976562" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-20.711807250976562,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="41.423614501953125">
             <div style="display: inline-block; white-space: nowrap;">
              服务A
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-C-258" style="opacity: 1;" transform="translate(139.58275032043457,274.9270820617676)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="61.041664123535156" x="-30.520832061767578" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-20.520832061767578,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="41.04166793823242">
             <div style="display: inline-block; white-space: nowrap;">
              服务B
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-D-260" style="opacity: 1;" transform="translate(139.58275032043457,396.89467430114746)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="51.99074172973633" x="-25.995370864868164" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-15.995370864868164,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="31.990741729736328">
             <div style="display: inline-block; white-space: nowrap;">
              应用
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node default" id="flowchart-E-262" style="opacity: 1;" transform="translate(253.96353721618652,274.9270820617676)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="67.71990966796875" x="-33.859954833984375" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-23.859954833984375,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="47.71990966796875">
             <div style="display: inline-block; white-space: nowrap;">
              Jaeger
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
         <g class="node watermark" id="flowchart-Z2-263" style="opacity: 1;" transform="translate(329.1574020385742,30.991897583007812)">
          <rect class="label-container" height="45.98379707336426" rx="0" ry="0" width="112.77777862548828" x="-56.38888931274414" y="-22.99189853668213">
          </rect>
          <g class="label" transform="translate(0,0)">
           <g transform="translate(-46.38888931274414,-12.991898536682129)">
            <foreignobject height="25.983797073364258" width="92.77777862548828">
             <div style="display: inline-block; white-space: nowrap;">
              CSDN @ 2136
             </div>
            </foreignobject>
           </g>
          </g>
         </g>
        </g>
       </g>
      </g>
     </svg>
    </div>
    <p>
     <strong>
      Grafana 配置示例
     </strong>
    </p>
    <pre><code class="prism language-yaml"><span class="token comment"># Grafana 数据源配置示例</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> <span class="token number">1</span>

<span class="token key atrule">datasources</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Prometheus
    <span class="token key atrule">type</span><span class="token punctuation">:</span> prometheus
    <span class="token key atrule">access</span><span class="token punctuation">:</span> proxy
    <span class="token key atrule">url</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span><span class="token number">9090</span>
</code></pre>
    <p>
     通过配置 Grafana 连接到 Prometheus，团队可以实时监控系统指标，并通过仪表盘进行可视化展示。
    </p>
    <h2>
     <a id="_195">
     </a>
     四、监控与观察性的最佳实践
    </h2>
    <ul>
     <li>
      <strong>
       合理设置告警阈值
      </strong>
      ：定期回顾和调整告警规则，基于实际系统行为进行优化，避免告警疲劳。
     </li>
     <li>
      <strong>
       集中管理日志
      </strong>
      ：确保所有服务的日志采用统一格式，便于统一分析，建议使用 JSON 格式。
     </li>
     <li>
      <strong>
       定期测试监控系统
      </strong>
      ：确保监控工具正常工作，并能及时发送告警，以防遗漏重要事件。
     </li>
     <li>
      <strong>
       进行压力测试
      </strong>
      ：在生产环境之前，通过压力测试评估系统性能，并根据结果调整监控和观察性配置。
     </li>
     <li>
      <strong>
       保持监控工具更新
      </strong>
      ：随着技术的不断演进，保持监控工具的更新，以便利用新功能和改进。
     </li>
    </ul>
    <h3>
     <a id="41__203">
     </a>
     4.1 监控工具选择
    </h3>
    <p>
     在选择监控工具时，团队应考虑以下因素：
    </p>
    <table>
     <thead>
      <tr>
       <th>
        因素
       </th>
       <th>
        描述
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        可扩展性
       </td>
       <td>
        工具是否能够支持系统的扩展，能够处理日益增长的数据量和监控需求。
       </td>
      </tr>
      <tr>
       <td>
        易用性
       </td>
       <td>
        工具的用户界面是否友好，能否方便地进行配置和使用。
       </td>
      </tr>
      <tr>
       <td>
        集成能力
       </td>
       <td>
        工具是否能够与现有的技术栈（如容器、微服务架构）无缝集成。
       </td>
      </tr>
      <tr>
       <td>
        社区支持
       </td>
       <td>
        工具是否有活跃的社区，能否获得及时的帮助和更新。
       </td>
      </tr>
      <tr>
       <td>
        成本
       </td>
       <td>
        工具的许可费用和维护成本是否在预算范围内。
       </td>
      </tr>
     </tbody>
    </table>
    <h3>
     <a id="42__215">
     </a>
     4.2 定期回顾与优化
    </h3>
    <p>
     建立定期回顾机制，评估监控和观察性策略的有效性：
    </p>
    <ul>
     <li>
      <strong>
       数据回顾
      </strong>
      ：定期分析监控数据，识别趋势和潜在问题。
     </li>
     <li>
      <strong>
       告警效果评估
      </strong>
      ：评估告警的及时性和准确性，调整告警策略以减少误报。
     </li>
     <li>
      <strong>
       文档更新
      </strong>
      ：保持监控和观察性相关文档的更新，确保团队成员随时了解当前策略和工具。
     </li>
    </ul>
    <h2>
     <a id="_223">
     </a>
     结论
    </h2>
    <p>
     在云原生架构中，监控与观察性是确保系统稳定、高效和可用的重要组成部分。通过合理选择和配置监控工具、建立有效的告警机制以及实施持续优化策略，团队能够提高系统的可观测性，快速响应潜在问题，提升用户体验。
    </p>
    <p>
     有效的监控与观察性不仅仅是技术实现，更是团队文化的一部分。鼓励团队成员关注系统的健康状态，共享监控数据和经验教训，可以在长期中提升整体的开发和运维效率。
    </p>
    <h2>
     <a id="_230">
     </a>
     参考资料
    </h2>
    <ul>
     <li>
      <a href="https://prometheus.io/docs/introduction/overview/" rel="nofollow">
       Prometheus 文档
      </a>
     </li>
     <li>
      <a href="https://www.elastic.co/what-is/elk-stack" rel="nofollow">
       ELK Stack 文档
      </a>
     </li>
     <li>
      <a href="https://grafana.com/docs/" rel="nofollow">
       Grafana 文档
      </a>
     </li>
     <li>
      <a href="https://www.jaegertracing.io/docs/" rel="nofollow">
       Jaeger 文档
      </a>
     </li>
    </ul>
    <hr/>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f5374726f6d626f6c692f:61727469636c652f64657461696c732f313433333532343333" class_="artid" style="display:none">
 </p>
</div>


