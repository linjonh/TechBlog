---
layout: post
title: "在-CLion-中使用-Boost.Test-进行-C-单元测试"
date: 2025-03-06 14:19:48 +0800
description: "本博客详细介绍了如何在CLion中安装、配置和运行Boost.Test，包括使用包管理器（vcpkg、Homebrew、APT）安装Boost，配置CMakeLists.txt，编写和运行Boost.Test测试代码，以及如何在CLion中直接运行测试。"
keywords: "在 CLion 中使用 Boost.Test 进行 C++ 单元测试"
categories: ['单元测试']
tags: ['开发语言', '单元测试', 'C']
artid: "146068354"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146068354
    alt: "在-CLion-中使用-Boost.Test-进行-C-单元测试"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146068354
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146068354
cover: https://bing.ee123.net/img/rand?artid=146068354
image: https://bing.ee123.net/img/rand?artid=146068354
img: https://bing.ee123.net/img/rand?artid=146068354
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     在 CLion 中使用 Boost.Test 进行 C++ 单元测试
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="1__BoostTest_0">
     </a>
     <strong>
      1. 安装 Boost.Test
     </strong>
    </h3>
    <p>
     Boost.Test 是
     <strong>
      Boost C++ 库
     </strong>
     的一部分，因此需要安装完整的
     <strong>
      Boost
     </strong>
     库。
    </p>
    <h4>
     <a id="_1_4">
     </a>
     <strong>
      方法 1：使用包管理器安装（推荐）
     </strong>
    </h4>
    <p>
     <strong>
      Windows（vcpkg）
     </strong>
    </p>
    <p>
     直接使用 CLion 集成的 vcpkg安装 boost-test：
    </p>
    <p>
     <img alt="安装 boost-test" src="https://i-blog.csdnimg.cn/direct/24313eafd05a4d48bf7157bcad09ac10.png"/>
    </p>
    <p>
     也可以通过命令来安装：
    </p>
    <pre><code class="prism language-sh"><span class="token function">git</span> clone https://github.com/microsoft/vcpkg.git
<span class="token builtin class-name">cd</span> <span class="token function">vcpkg</span>
bootstrap-vcpkg.bat
<span class="token function">vcpkg</span> <span class="token function">install</span> boost-test
</code></pre>
    <p>
     <strong>
      macOS（Homebrew）
     </strong>
    </p>
    <pre><code class="prism language-sh">brew <span class="token function">install</span> boost
</code></pre>
    <p>
     <strong>
      Linux（APT）
     </strong>
    </p>
    <pre><code class="prism language-sh"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> libboost-test-dev
</code></pre>
    <h4>
     <a id="_2_Boost__31">
     </a>
     <strong>
      方法 2：手动下载 Boost 并编译
     </strong>
    </h4>
    <ol>
     <li>
      <p>
       从
       <a href="https://www.boost.org/" rel="nofollow">
        Boost 官网
       </a>
       下载源码。
      </p>
     </li>
     <li>
      <p>
       解压并编译 Boost：
      </p>
      <pre><code class="prism language-sh">./bootstrap.sh
./b2
</code></pre>
     </li>
    </ol>
    <hr/>
    <h3>
     <a id="2__CLion__43">
     </a>
     <strong>
      2. 创建 CLion 项目
     </strong>
    </h3>
    <ol>
     <li>
      <strong>
       打开 CLion
      </strong>
      ，选择
      <code>
       New Project
      </code>
      。
     </li>
     <li>
      选择
      <code>
       C++ Executable
      </code>
      ，然后点击
      <code>
       Create
      </code>
      创建一个项目。
     </li>
    </ol>
    <hr/>
    <h3>
     <a id="3__CMakeListstxt_50">
     </a>
     <strong>
      3. 配置 CMakeLists.txt
     </strong>
    </h3>
    <p>
     在
     <code>
      CMakeLists.txt
     </code>
     中添加
     <strong>
      Boost.Test
     </strong>
     配置：
    </p>
    <pre><code class="prism language-cmake">cmake_minimum_required(VERSION 3.30)
project(MyTest)

set(CMAKE_CXX_STANDARD 20)

# 查找 Boost 库
find_package(Boost REQUIRED COMPONENTS unit_test_framework)
include_directories(${Boost_INCLUDE_DIRS})

# 添加测试文件
add_executable(MyTest main.cpp)

# 链接 Boost.Test 库
target_link_libraries(MyTest Boost::unit_test_framework)

# 启用测试
enable_testing()
</code></pre>
    <p>
     如果
     <strong>
      Boost
     </strong>
     安装在非默认路径（如 vcpkg），需要指定
     <code>
      CMAKE_PREFIX_PATH
     </code>
     ：
    </p>
    <pre><code class="prism language-cmake">set(CMAKE_PREFIX_PATH "C:/path/to/vcpkg/installed/x64-windows")
</code></pre>
    <hr/>
    <h3>
     <a id="4__BoostTest__82">
     </a>
     <strong>
      4. 编写 Boost.Test 测试代码
     </strong>
    </h3>
    <h4>
     <a id="_1_main_84">
     </a>
     <strong>
      方法 1：自动管理
      <code>
       main()
      </code>
     </strong>
    </h4>
    <p>
     <img alt="测试代码" src="https://i-blog.csdnimg.cn/direct/8e61b9d8dcbd4955acba5363df73787f.png"/>
    </p>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">BOOST_TEST_MODULE</span> <span class="token expression">MyTest</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;boost/test/included/unit_test.hpp&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">int</span> nA<span class="token punctuation">,</span> <span class="token keyword">int</span> nB<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> nA <span class="token operator">+</span> nB<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">BOOST_AUTO_TEST_CASE</span><span class="token punctuation">(</span>AdditionTest<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">BOOST_CHECK_EQUAL</span><span class="token punctuation">(</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">BOOST_CHECK_EQUAL</span><span class="token punctuation">(</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="_2_main_102">
     </a>
     <strong>
      方法 2：手动定义
      <code>
       main()
      </code>
     </strong>
    </h4>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">BOOST_TEST_DYN_LINK</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;boost/test/unit_test.hpp&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">int</span> nA<span class="token punctuation">,</span> <span class="token keyword">int</span> nB<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> nA <span class="token operator">+</span> nB<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">BOOST_AUTO_TEST_CASE</span><span class="token punctuation">(</span>AdditionTest<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">BOOST_CHECK_EQUAL</span><span class="token punctuation">(</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">BOOST_CHECK_EQUAL</span><span class="token punctuation">(</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

boost<span class="token double-colon punctuation">::</span>unit_test<span class="token double-colon punctuation">::</span>test_suite<span class="token operator">*</span> <span class="token function">init_unit_test_suite</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <hr/>
    <h3>
     <a id="5__BoostTest_124">
     </a>
     <strong>
      5. 运行 Boost.Test
     </strong>
    </h3>
    <h4>
     <a id="_1_126">
     </a>
     <strong>
      方法 1：手动运行
     </strong>
    </h4>
    <pre><code class="prism language-sh">cmake <span class="token parameter variable">--build</span> <span class="token builtin class-name">.</span>
./my_test
</code></pre>
    <h4>
     <a id="_2CLion__133">
     </a>
     <strong>
      方法 2：CLion 直接运行
     </strong>
    </h4>
    <p>
     不需要额外的配置，可以直接运行：
    </p>
    <p>
     <img alt="配置单元测试" src="https://i-blog.csdnimg.cn/direct/3d091a95669a423fa29f3367048682cb.png"/>
    </p>
    <hr/>
    <h3>
     <a id="6__BoostTest__141">
     </a>
     <strong>
      6. 处理 Boost.Test 断言
     </strong>
    </h3>
    <table>
     <thead>
      <tr>
       <th>
        断言类型
       </th>
       <th>
        语法
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <strong>
         基本断言
        </strong>
       </td>
       <td>
        <code>
         BOOST_CHECK_EQUAL(a, b);
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         浮点数比较
        </strong>
       </td>
       <td>
        <code>
         BOOST_CHECK_CLOSE(a, b, 0.01);
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         异常检测
        </strong>
       </td>
       <td>
        <code>
         BOOST_CHECK_THROW(foo(), ExceptionType);
        </code>
       </td>
      </tr>
     </tbody>
    </table>
    <pre><code class="prism language-cpp"><span class="token function">BOOST_AUTO_TEST_CASE</span><span class="token punctuation">(</span>TestAssertions<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">BOOST_CHECK_EQUAL</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">BOOST_CHECK_CLOSE</span><span class="token punctuation">(</span><span class="token number">3.14</span><span class="token punctuation">,</span> <span class="token number">3.1401</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">BOOST_CHECK_THROW</span><span class="token punctuation">(</span><span class="token keyword">throw</span> std<span class="token double-colon punctuation">::</span><span class="token function">runtime_error</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> std<span class="token double-colon punctuation">::</span>runtime_error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <hr/>
    <h3>
     <a id="7__BoostTest_Fixtures_159">
     </a>
     <strong>
      7. 使用 Boost.Test Fixtures
     </strong>
    </h3>
    <pre><code class="prism language-cpp"><span class="token keyword">struct</span> <span class="token class-name">MyFixture</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">MyFixture</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> nValue <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">int</span> nValue<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">BOOST_FIXTURE_TEST_CASE</span><span class="token punctuation">(</span>FixtureTest<span class="token punctuation">,</span> MyFixture<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">BOOST_CHECK_EQUAL</span><span class="token punctuation">(</span>nValue <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <hr/>
    <h3>
     <a id="8__174">
     </a>
     <strong>
      8. 解决可能遇到的问题
     </strong>
    </h3>
    <h4>
     <a id="_BoostTest_176">
     </a>
     <strong>
      找不到 Boost.Test
     </strong>
    </h4>
    <p>
     如果 CMake 找不到 Boost，请确保
     <code>
      CMAKE_PREFIX_PATH
     </code>
     正确设置：
    </p>
    <pre><code class="prism language-cmake">set(CMAKE_PREFIX_PATH "C:/path/to/vcpkg/installed/x64-windows")
</code></pre>
    <h4>
     <a id="_184">
     </a>
     <strong>
      链接错误
     </strong>
    </h4>
    <p>
     如果遇到 undefined reference to ‘boost::unit_test::framework’：
    </p>
    <ul>
     <li>
      在 CMakeLists.txt 确保：
     </li>
    </ul>
    <pre><code class="prism language-cmake">target_link_libraries(my_test Boost::unit_test_framework)
</code></pre>
    <ul>
     <li>
      Windows 下，Boost 可能需要动态链接：
     </li>
    </ul>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">BOOST_TEST_DYN_LINK</span></span>
</code></pre>
    <hr/>
    <h3>
     <a id="9__202">
     </a>
     <strong>
      9. 总结
     </strong>
    </h3>
    <table>
     <thead>
      <tr>
       <th>
        步骤
       </th>
       <th>
        说明
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <strong>
         安装 Boost.Test
        </strong>
       </td>
       <td>
        <code>
         vcpkg
        </code>
        、
        <code>
         brew
        </code>
        或
        <code>
         apt
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         创建 CLion 项目
        </strong>
       </td>
       <td>
        <code>
         New Project
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         配置 CMakeLists.txt
        </strong>
       </td>
       <td>
        <code>
         find_package(Boost REQUIRED COMPONENTS unit_test_framework)
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         编写测试代码
        </strong>
       </td>
       <td>
        <code>
         BOOST_AUTO_TEST_CASE()
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         运行测试
        </strong>
       </td>
       <td>
        CLion 直接运行 或
        <code>
         ./my_test
        </code>
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     这样，就可以在
     <strong>
      CLion + Boost.Test
     </strong>
     环境下进行
     <strong>
      C++ 单元测试
     </strong>
     了！🚀
    </p>
   </div>
   <link href="./../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="./../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f35383634383839302f:61727469636c652f64657461696c732f313436303638333534" class_="artid" style="display:none">
 </p>
</div>


