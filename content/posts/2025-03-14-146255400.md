---
layout: post
title: "React19源码系列之createRoot的执行流程是怎么的"
date: 2025-03-14 14:15:59 +0800
description: "2024年12月5日，react发布了react19版本。后面一段时间都将学习它的源码，并着手记录。react官网：react19新特性在用vite创建react项目的使用，main.ts主文件都会有以下代码。该代码是整个项目的入口。接下来我们就看看是如何执行。"
keywords: "React19源码系列之createRoot的执行流程是怎么的？"
categories: ['React']
tags: ['React', 'React']
artid: "146255400"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146255400
    alt: "React19源码系列之createRoot的执行流程是怎么的"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146255400
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146255400
cover: https://bing.ee123.net/img/rand?artid=146255400
image: https://bing.ee123.net/img/rand?artid=146255400
img: https://bing.ee123.net/img/rand?artid=146255400
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     React19源码系列之createRoot的执行流程是怎么的？
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-dracula" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     2024年12月5日，react发布了react19版本。后面一段时间都将学习它的源码，并着手记录。
    </p>
    <p>
     react官网：react19新特性
     <br/>
     <a href="https://react.dev/blog/2024/12/05/react-19" rel="nofollow">
      https://react.dev/blog/2024/12/05/react-19
     </a>
    </p>
    <p>
     在用vite创建react项目的使用，
     <code>
      main.tsx
     </code>
     主文件都会有以下代码。
    </p>
    <pre><code class="prism language-ts"><span class="token comment">//import { StrictMode } from 'react'</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> createRoot <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-dom/client'</span>
<span class="token keyword">import</span> <span class="token string">'./index.css'</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.tsx'</span>

<span class="token keyword">const</span> root <span class="token operator">=</span> <span class="token function">createRoot</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">,</span>root<span class="token punctuation">)</span>
root<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token comment">// &lt;StrictMode&gt;</span>
    <span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token comment">// &lt;/StrictMode&gt;,</span>
<span class="token punctuation">)</span>

</code></pre>
    <p>
     该代码是整个项目的入口。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/50393b73f3594b3f90c5a25c7030434b.png"/>
    </p>
    <p>
     接下来我们就看看
     <a href="https://react.dev/reference/react-dom/client/createRoot" rel="nofollow">
      createRoot
     </a>
     是如何执行。
    </p>
    <h2>
     <a id="createRoot__33">
     </a>
     createRoot 函数
    </h2>
    <p>
     <code>
      createRoot
     </code>
     函数的主要作用是创建一个 React 应用的根节点，并对其进行一系列初始化操作，最终返回一个
     <code>
      ReactDOMRoot
     </code>
     对象。
    </p>
    <pre><code class="prism language-ts"><span class="token keyword">function</span> <span class="token function">createRoot</span><span class="token punctuation">(</span>
  container<span class="token operator">:</span> Element <span class="token operator">|</span> Document <span class="token operator">|</span> DocumentFragment<span class="token punctuation">,</span>
  options<span class="token operator">?</span><span class="token operator">:</span> CreateRootOptions<span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> RootType <span class="token punctuation">{<!-- --></span>

  <span class="token comment">// 用于控制是否默认启用并发更新</span>
  <span class="token keyword">const</span> concurrentUpdatesByDefaultOverride <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

  <span class="token comment">// 表示是否启用严格模式等。</span>
  <span class="token keyword">let</span> isStrictMode <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

  <span class="token comment">//</span>
  <span class="token keyword">let</span> identifierPrefix <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
  
  <span class="token keyword">let</span> onUncaughtError <span class="token operator">=</span> defaultOnUncaughtError<span class="token punctuation">;</span>
  <span class="token keyword">let</span> onCaughtError <span class="token operator">=</span> defaultOnCaughtError<span class="token punctuation">;</span>
  <span class="token keyword">let</span> onRecoverableError <span class="token operator">=</span> defaultOnRecoverableError<span class="token punctuation">;</span>
  <span class="token keyword">let</span> transitionCallbacks <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token comment">//省略 options处理代码</span>
  
<span class="token comment">// 创建容器对象 FiberRootNode</span>
<span class="token comment">// FiberRootNode 对象，它是 React 协调器的核心数据结构，代表了整个 React 应用的根节点。</span>
  <span class="token keyword">const</span> root <span class="token operator">=</span> <span class="token function">createContainer</span><span class="token punctuation">(</span>
    container<span class="token punctuation">,</span>
    ConcurrentRoot<span class="token punctuation">,</span><span class="token comment">//ConcurrentRoot 表示使用并发模式进行渲染。</span>
    <span class="token keyword">null</span><span class="token punctuation">,</span>
    isStrictMode<span class="token punctuation">,</span>
    concurrentUpdatesByDefaultOverride<span class="token punctuation">,</span>
    identifierPrefix<span class="token punctuation">,</span>
    onUncaughtError<span class="token punctuation">,</span>
    onCaughtError<span class="token punctuation">,</span>
    onRecoverableError<span class="token punctuation">,</span>
    transitionCallbacks<span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token comment">//在dom container节点添加属性标记</span>
  <span class="token comment">// 调用 markContainerAsRoot 函数，在 DOM 容器节点上添加一些属性标记，用于标识该节点是 React 应用的根节点。</span>
  <span class="token function">markContainerAsRoot</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>current<span class="token punctuation">,</span> container<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 处理容器元素</span>
  <span class="token comment">// 如果传入的 container 是一个注释节点，则将其父节点作为根容器元素；否则，直接使用 container 作为根容器元素。</span>
  <span class="token keyword">const</span> rootContainerElement<span class="token operator">:</span> Document <span class="token operator">|</span> Element <span class="token operator">|</span> DocumentFragment <span class="token operator">=</span>
    container<span class="token punctuation">.</span>nodeType <span class="token operator">===</span> <span class="token constant">COMMENT_NODE</span> <span class="token comment">//8 注释节点</span>
      <span class="token operator">?</span> <span class="token punctuation">(</span>container<span class="token punctuation">.</span>parentNode<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span>
      <span class="token operator">:</span> container<span class="token punctuation">;</span>
  
  <span class="token comment">// 事件委托处理</span>
  <span class="token comment">// 在div#root上绑定各种事件，包括捕获和冒泡阶段</span>
  <span class="token comment">// 可以实现事件委托，提高事件处理的效率。</span>
  <span class="token function">listenToAllSupportedEvents</span><span class="token punctuation">(</span>rootContainerElement<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 根据创建的 FiberRootNode 对象 root，创建并返回一个 ReactDOMRoot 对象。这个对象提供了 render 方法，用于将 React 组件渲染到根节点上。</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ReactDOMRoot</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h2>
     <a id="createContainer__94">
     </a>
     createContainer 函数
    </h2>
    <p>
     调用
     <code>
      createFiberRoot
     </code>
     函数来创建一个
     <code>
      FiberRoot
     </code>
     对象并返回。
    </p>
    <blockquote>
     <p>
      函数参数含义：
      <br/>
      ●
      <code>
       containerInfo
      </code>
      ：类型为 Container，通常是一个 DOM 容器元素（如 div），用于指定 React 应用要挂载到的实际 DOM 节点。
      <br/>
      ●
      <code>
       tag
      </code>
      ：类型为 RootTag，用于标记根节点的类型，比如 ConcurrentRoot 表示使用并发模式渲染。
      <br/>
      ●
      <code>
       hydrationCallbacks
      </code>
      ：类型为 null | SuspenseHydrationCallbacks，在服务端渲染时，用于处理水合（hydration）过程中的回调函数。
      <br/>
      ●
      <code>
       isStrictMode
      </code>
      ：布尔类型，用于指示是否开启严格模式。严格模式会对组件进行额外的检查，帮助开发者发现潜在问题。
      <br/>
      ●
      <code>
       concurrentUpdatesByDefaultOverride
      </code>
      ：这个参数目前已被忽略，未来可能会移除。
      <br/>
      ●
      <code>
       identifierPrefix
      </code>
      ：字符串类型，用于为 React 元素生成唯一标识符的前缀。
      <br/>
      ●
      <code>
       onUncaughtError
      </code>
      ：错误处理回调函数，当发生未捕获的错误时会调用此函数。
      <br/>
      ●
      <code>
       onCaughtError
      </code>
      ：错误处理回调函数，当错误被捕获时调用，会提供更多错误信息，包括错误边界组件。
      <br/>
      ●
      <code>
       onRecoverableError
      </code>
      ：错误处理回调函数，当发生可恢复的错误时调用。
      <br/>
      ●
      <code>
       transitionCallbacks
      </code>
      ：类型为 null | TransitionTracingCallbacks，用于跟踪过渡（transition）状态的回调函数。
     </p>
    </blockquote>
    <pre><code class="prism language-ts"><span class="token keyword">function</span> <span class="token function">createContainer</span><span class="token punctuation">(</span>
  containerInfo<span class="token operator">:</span> Container<span class="token punctuation">,</span><span class="token comment">// 实际的dom容器</span>
  tag<span class="token operator">:</span> RootTag<span class="token punctuation">,</span><span class="token comment">// 渲染类型 并发模式或者传统模式</span>
  hydrationCallbacks<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token operator">|</span> SuspenseHydrationCallbacks<span class="token punctuation">,</span>
  isStrictMode<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">,</span>
  concurrentUpdatesByDefaultOverride<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token operator">|</span> <span class="token builtin">boolean</span><span class="token punctuation">,</span>
  identifierPrefix<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onUncaughtError</span><span class="token operator">:</span> <span class="token punctuation">(</span>
    error<span class="token operator">:</span> mixed<span class="token punctuation">,</span>
    errorInfo<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token operator">+</span>componentStack<span class="token operator">?</span><span class="token operator">:</span> <span class="token operator">?</span><span class="token builtin">string</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onCaughtError</span><span class="token operator">:</span> <span class="token punctuation">(</span>
    error<span class="token operator">:</span> mixed<span class="token punctuation">,</span>
    errorInfo<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token operator">+</span>componentStack<span class="token operator">?</span><span class="token operator">:</span> <span class="token operator">?</span><span class="token builtin">string</span><span class="token punctuation">,</span>
      <span class="token operator">+</span>errorBoundary<span class="token operator">?</span><span class="token operator">:</span> <span class="token operator">?</span>React$Component<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onRecoverableError</span><span class="token operator">:</span> <span class="token punctuation">(</span>
    error<span class="token operator">:</span> mixed<span class="token punctuation">,</span>
    errorInfo<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token operator">+</span>componentStack<span class="token operator">?</span><span class="token operator">:</span> <span class="token operator">?</span><span class="token builtin">string</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">,</span>
  transitionCallbacks<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token operator">|</span> TransitionTracingCallbacks<span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> OpaqueRoot <span class="token punctuation">{<!-- --></span>
  
  <span class="token comment">// 设置为 false 表示不进行水合操作。水合操作通常用于服务端渲染，将服务端渲染的 HTML 与客户端的 React 应用进行连接。</span>
  <span class="token keyword">const</span> hydrate <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  
  <span class="token comment">// 初始子元素，这里设置为 null，表示一开始没有初始的子元素。</span>
  <span class="token keyword">const</span> initialChildren <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  
  <span class="token comment">//创建 FiberRoot</span>
  <span class="token comment">// createFiberRoot 函数创建 FiberRoot 对象，该函数会根据传入的参数初始化 FiberRoot 的各种属性，包括根节点的类型、挂载的 DOM 容器、错误处理回调等，最终返回一个代表整个 React 应用根节点的 FiberRoot 对象。</span>
  <span class="token keyword">return</span> <span class="token function">createFiberRoot</span><span class="token punctuation">(</span>
    containerInfo<span class="token punctuation">,</span>
    tag<span class="token punctuation">,</span><span class="token comment">// 模式 并发模式</span>
    hydrate<span class="token punctuation">,</span>
    initialChildren<span class="token punctuation">,</span>
    hydrationCallbacks<span class="token punctuation">,</span>
    isStrictMode<span class="token punctuation">,</span>
    identifierPrefix<span class="token punctuation">,</span>
    onUncaughtError<span class="token punctuation">,</span>
    onCaughtError<span class="token punctuation">,</span>
    onRecoverableError<span class="token punctuation">,</span>
    transitionCallbacks<span class="token punctuation">,</span>
    <span class="token keyword">null</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h2>
     <a id="createFiberRoot__161">
     </a>
     createFiberRoot 函数
    </h2>
    <p>
     <code>
      createFiberRoot
     </code>
     函数是 React 中用于创建
     <code>
      FiberRoot
     </code>
     对象的核心函数，
     <code>
      FiberRoot
     </code>
     是整个 React 应用的根节点，负责管理应用的渲染和更新流程。该函数会初始化根节点的各种属性，创建对应的
     <code>
      Fiber
     </code>
     节点，并进行一些状态和更新队列的初始化操作。
    </p>
    <blockquote>
     <p>
      函数参数含义：
      <br/>
      ●
      <code>
       containerInfo
      </code>
      ：通常是一个 DOM 容器元素，用于指定 React 应用要挂载到的实际 DOM 节点。
      <br/>
      ●
      <code>
       tag
      </code>
      ：标记根节点的类型，如 ConcurrentRoot 表示使用并发模式渲染。
      <br/>
      ●
      <code>
       hydrate
      </code>
      ：布尔值，指示是否进行水合操作（用于服务端渲染）。
      <br/>
      ●
      <code>
       initialChildren
      </code>
      ：初始的子元素列表。
      <br/>
      ●
      <code>
       hydrationCallbacks
      </code>
      ：在水合过程中使用的回调函数。
      <br/>
      ●
      <code>
       isStrictMode
      </code>
      ：布尔值，指示是否开启严格模式。
      <br/>
      ●
      <code>
       identifierPrefix
      </code>
      ：用于为 React 元素生成唯一标识符的前缀。
      <br/>
      ●
      <code>
       onUncaughtError
      </code>
      ：未捕获错误的处理回调函数。
      <br/>
      ●
      <code>
       onCaughtError
      </code>
      ：已捕获错误的处理回调函数。
      <br/>
      ●
      <code>
       onRecoverableError
      </code>
      ：可恢复错误的处理回调函数。
      <br/>
      ●
      <code>
       transitionCallbacks
      </code>
      ：用于跟踪过渡状态的回调函数。
      <br/>
      ●
      <code>
       formState
      </code>
      ：表单状态信息。
     </p>
    </blockquote>
    <pre><code class="prism language-ts"><span class="token keyword">function</span> <span class="token function">createFiberRoot</span><span class="token punctuation">(</span>
  containerInfo<span class="token operator">:</span> Container<span class="token punctuation">,</span><span class="token comment">// 实际的dom容器</span>
  tag<span class="token operator">:</span> RootTag<span class="token punctuation">,</span><span class="token comment">// 渲染模式 并发模式或者传统模式</span>
  hydrate<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">,</span>
  initialChildren<span class="token operator">:</span> ReactNodeList<span class="token punctuation">,</span>
  hydrationCallbacks<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token operator">|</span> SuspenseHydrationCallbacks<span class="token punctuation">,</span>
  isStrictMode<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">,</span><span class="token comment">// 示范严格模式</span>
  identifierPrefix<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span><span class="token comment">// 前缀</span>
  <span class="token function-variable function">onUncaughtError</span><span class="token operator">:</span> <span class="token punctuation">(</span>
    error<span class="token operator">:</span> mixed<span class="token punctuation">,</span>
    errorInfo<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token operator">+</span>componentStack<span class="token operator">?</span><span class="token operator">:</span> <span class="token operator">?</span><span class="token builtin">string</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onCaughtError</span><span class="token operator">:</span> <span class="token punctuation">(</span>
    error<span class="token operator">:</span> mixed<span class="token punctuation">,</span>
    errorInfo<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token operator">+</span>componentStack<span class="token operator">?</span><span class="token operator">:</span> <span class="token operator">?</span><span class="token builtin">string</span><span class="token punctuation">,</span>
      <span class="token operator">+</span>errorBoundary<span class="token operator">?</span><span class="token operator">:</span> <span class="token operator">?</span>React$Component<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onRecoverableError</span><span class="token operator">:</span> <span class="token punctuation">(</span>
    error<span class="token operator">:</span> mixed<span class="token punctuation">,</span>
    errorInfo<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token operator">+</span>componentStack<span class="token operator">?</span><span class="token operator">:</span> <span class="token operator">?</span><span class="token builtin">string</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">,</span>
  transitionCallbacks<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token operator">|</span> TransitionTracingCallbacks<span class="token punctuation">,</span>
  formState<span class="token operator">:</span> ReactFormState<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> FiberRoot <span class="token punctuation">{<!-- --></span>

  <span class="token comment">// 创建 FiberRootNode 实例</span>
  <span class="token comment">// 创建一个 FiberRootNode 实例，该实例代表整个 React 应用的根节点，包含了与 DOM 容器、根节点类型、错误处理等相关的信息。</span>
  <span class="token keyword">const</span> root<span class="token operator">:</span> FiberRoot <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FiberRootNode</span><span class="token punctuation">(</span>
    containerInfo<span class="token punctuation">,</span>
    tag<span class="token punctuation">,</span><span class="token comment">// 并发模式</span>
    hydrate<span class="token punctuation">,</span>
    identifierPrefix<span class="token punctuation">,</span>
    onUncaughtError<span class="token punctuation">,</span>
    onCaughtError<span class="token punctuation">,</span>
    onRecoverableError<span class="token punctuation">,</span>
    formState<span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token keyword">if</span> <span class="token punctuation">(</span>enableSuspenseCallback<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 设置水合回调函数</span>
    root<span class="token punctuation">.</span>hydrationCallbacks <span class="token operator">=</span> hydrationCallbacks<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>enableTransitionTracing<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 设置过渡跟踪回调函数</span>
    root<span class="token punctuation">.</span>transitionCallbacks <span class="token operator">=</span> transitionCallbacks<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 创建 Fiber 节点，该节点代表根组件的 Fiber 节点。</span>
  <span class="token keyword">const</span> uninitializedFiber <span class="token operator">=</span> <span class="token function">createHostRootFiber</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> isStrictMode<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">//root.current 指向当前的 Fiber 节点，建立 FiberRoot 到 Fiber 节点的引用。</span>
  root<span class="token punctuation">.</span>current <span class="token operator">=</span> uninitializedFiber<span class="token punctuation">;</span>
  
  <span class="token comment">//uninitializedFiber.stateNode 指向 FiberRoot，建立 Fiber 节点到 FiberRoot 的引用。</span>
  uninitializedFiber<span class="token punctuation">.</span>stateNode <span class="token operator">=</span> root<span class="token punctuation">;</span>

  <span class="token comment">// 根据是否启用缓存，初始化 Fiber 节点的状态。状态对象包含初始子元素、是否水合以及缓存信息。</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>enableCache<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 创建缓存对象</span>
    <span class="token keyword">const</span> initialCache <span class="token operator">=</span> <span class="token function">createCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 保留缓存引用</span>
    <span class="token function">retainCache</span><span class="token punctuation">(</span>initialCache<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 将缓存对象赋值给根节点的 pooledCache 属性</span>
    root<span class="token punctuation">.</span>pooledCache <span class="token operator">=</span> initialCache<span class="token punctuation">;</span>

    <span class="token comment">// 再次保留缓存引用</span>
    <span class="token function">retainCache</span><span class="token punctuation">(</span>initialCache<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 初始化根 Fiber 节点的状态</span>
    <span class="token keyword">const</span> initialState<span class="token operator">:</span> RootState <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
      element<span class="token operator">:</span> initialChildren<span class="token punctuation">,</span><span class="token comment">//存储初始的子元素列表 initialChildren，这些子元素是 React 应用开始渲染时的初始内容。</span>
      isDehydrated<span class="token operator">:</span> hydrate<span class="token punctuation">,</span><span class="token comment">//一个布尔值，用于指示是否处于水合状态，其值来源于 hydrate 参数。</span>
      cache<span class="token operator">:</span> initialCache<span class="token punctuation">,</span><span class="token comment">// 存储前面创建的缓存对象 initialCache，这样根 Fiber 节点就可以访问这个缓存对象。</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// 存储前面创建的缓存对象 initialCache，这样根 Fiber 节点就可以访问这个缓存对象。</span>
    <span class="token comment">// memoizedState 用于存储 Fiber 节点的状态，后续在渲染和更新过程中，React 会根据这个状态来决定如何渲染组件。</span>
    uninitializedFiber<span class="token punctuation">.</span>memoizedState <span class="token operator">=</span> initialState<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> initialState<span class="token operator">:</span> RootState <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
      element<span class="token operator">:</span> initialChildren<span class="token punctuation">,</span>
      isDehydrated<span class="token operator">:</span> hydrate<span class="token punctuation">,</span>
      cache<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token keyword">null</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// not enabled yet</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    uninitializedFiber<span class="token punctuation">.</span>memoizedState <span class="token operator">=</span> initialState<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

   <span class="token comment">// 初始化更新队列</span>
  <span class="token comment">// 调用 initializeUpdateQueue 函数，为 Fiber 节点初始化更新队列，用于管理后续的状态更新操作。</span>
  <span class="token function">initializeUpdateQueue</span><span class="token punctuation">(</span>uninitializedFiber<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 返回 FiberRoot 对象</span>
  <span class="token keyword">return</span> root<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <code>
      fiberRoot
     </code>
     节点与
     <code>
      fiber
     </code>
     节点的关系：
     <br/>
     <code>
      fiberRoot
     </code>
     的
     <code>
      current
     </code>
     属性 是根节点的
     <code>
      fiber
     </code>
     对象的引用。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/d8c5d298a6894596b81ffd983e9ff572.png"/>
    </p>
    <h2>
     <a id="createHostRootFiber__285">
     </a>
     createHostRootFiber 函数
    </h2>
    <p>
     创建一个根
     <code>
      Fiber
     </code>
     节点，该节点代表整个 React 应用的根。在创建过程中，会根据不同的
     <code>
      tag
     </code>
     模式（如传统模式、并发模式）以及是否开启严格模式和性能分析器等条件，来设置
     <code>
      Fiber
     </code>
     节点的 mode 属性，最后调用
     <code>
      createFiber
     </code>
     函数完成
     <code>
      Fiber
     </code>
     节点的创建。
    </p>
    <blockquote>
     <p>
      函数参数含义：
     </p>
     <ul>
      <li>
       <code>
        tag
       </code>
       ，类型为 RootTag，用于标记根节点的类型。tag 的值可能为传统模式（值为 0）或并发模式（ConcurrentRoot，值为 1）。
      </li>
      <li>
       <code>
        isStrictMode
       </code>
       ，布尔类型，指示是否开启严格模式。严格模式会对组件进行额外的检查，帮助开发者发现潜在问题。
      </li>
     </ul>
    </blockquote>
    <pre><code class="prism language-ts"><span class="token keyword">function</span> <span class="token function">createHostRootFiber</span><span class="token punctuation">(</span>
  tag<span class="token operator">:</span> RootTag<span class="token punctuation">,</span>
  isStrictMode<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token operator">:</span> Fiber <span class="token punctuation">{<!-- --></span>
  
  <span class="token comment">//设置 mode 属性，用于存储 Fiber 节点的模式。</span>
  <span class="token keyword">let</span> mode<span class="token punctuation">;</span>
  <span class="token comment">//disableLegacyMode常量为true</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>disableLegacyMode <span class="token operator">||</span> tag <span class="token operator">===</span> ConcurrentRoot<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    mode <span class="token operator">=</span> ConcurrentMode<span class="token punctuation">;</span> <span class="token comment">// 并发模式</span>
    <span class="token comment">// 是否严格模式（只有开发环境与藕可能为true）</span>
   <span class="token comment">// if (isStrictMode === true) {<!-- --></span>
    <span class="token comment">//  mode |= StrictLegacyMode | StrictEffectsMode;</span>
   <span class="token comment">// }</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
 
    mode <span class="token operator">=</span> NoMode<span class="token punctuation">;</span><span class="token comment">// NoMode默认为0 即传统模式</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// enableProfilerTimer表示启用性能分析器，isDevToolsPresent表示开发者工具存在</span>
 <span class="token comment">// if (enableProfilerTimer &amp;&amp; isDevToolsPresent) {<!-- --></span>
       <span class="token comment">// 相当于  mode = mode | ProfileMode    例如 (1 |2) = 3</span>
 <span class="token comment">//   mode |= ProfileMode;</span>
 <span class="token comment">// }</span>

  <span class="token comment">//创建根 Fiber 节点，HostRoot常量为3</span>
  <span class="token keyword">return</span> <span class="token function">createFiber</span><span class="token punctuation">(</span>HostRoot<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> mode<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h2>
     <a id="initializeUpdateQueue__323">
     </a>
     initializeUpdateQueue 函数
    </h2>
    <p>
     <code>
      initializeUpdateQueue
     </code>
     函数的功能是为一个
     <code>
      Fiber
     </code>
     节点初始化更新队列。
    </p>
    <blockquote>
     <p>
      <code>
       UpdateQueue&lt;State&gt;
      </code>
      类型的对象
      <code>
       queue
      </code>
      ，这个对象包含了更新队列的各种属性：
     </p>
     <ul>
      <li>
       <code>
        baseState
       </code>
       ：初始状态，赋值为 fiber.memoizedState，memoizedState 存储了当前 Fiber 节点的最新状态。
      </li>
      <li>
       <code>
        firstBaseUpdate
       </code>
       和
       <code>
        lastBaseUpdate
       </code>
       ：分别指向更新队列中第一个和最后一个基础更新，初始值都为 null。基础更新是指那些已经被处理过，但由于某些原因（如优先级问题）还没有应用到 baseState 上的更新。
      </li>
      <li>
       <code>
        shared
       </code>
       ：是一个包含共享信息的对象，其中：
       <ul>
        <li>
         <code>
          pending
         </code>
         ：指向待处理的更新链表的尾部，初始值为 null。
        </li>
        <li>
         <code>
          lanes
         </code>
         ：表示更新的优先级，初始值为 NoLanes，代表没有任何优先级。
        </li>
        <li>
         <code>
          hiddenCallbacks
         </code>
         ：用于存储隐藏的回调函数，初始值为 null。
        </li>
       </ul>
      </li>
      <li>
       <code>
        callbacks
       </code>
       ：用于存储更新完成后的回调函数，初始值为 null。
      </li>
     </ul>
    </blockquote>
    <pre><code class="prism language-ts"><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">initializeUpdateQueue</span><span class="token generic class-name"><span class="token operator">&lt;</span>State<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>fiber<span class="token operator">:</span> Fiber<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> queue<span class="token operator">:</span> UpdateQueue<span class="token operator">&lt;</span>State<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    baseState<span class="token operator">:</span> fiber<span class="token punctuation">.</span>memoizedState<span class="token punctuation">,</span>
    firstBaseUpdate<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    lastBaseUpdate<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    shared<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      pending<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      lanes<span class="token operator">:</span> NoLanes<span class="token punctuation">,</span>
      hiddenCallbacks<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    callbacks<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token comment">// 将创建好的更新队列 queue 赋值给 fiber 节点的 updateQueue 属性，这样 Fiber 节点就有了自己的更新队列，后续的状态更新操作可以通过这个队列来进行管理。</span>
  fiber<span class="token punctuation">.</span>updateQueue <span class="token operator">=</span> queue<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h2>
     <a id="ReactDOMRoot__353">
     </a>
     ReactDOMRoot 构造函数
    </h2>
    <p>
     <code>
      ReactDOMRoot
     </code>
     构造函数的主要作用是创建一个
     <code>
      ReactDOMRoot
     </code>
     实例，并将传入的
     <code>
      FiberRoot
     </code>
     对象存储在实例的
     <code>
      _internalRoot
     </code>
     属性中。
    </p>
    <pre><code class="prism language-ts"><span class="token keyword">function</span> <span class="token function">ReactDOMRoot</span><span class="token punctuation">(</span>internalRoot<span class="token operator">:</span> FiberRoot<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>_internalRoot <span class="token operator">=</span> internalRoot<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h2>
     <a id="ReactDOMRootprototyperender__361">
     </a>
     ReactDOMRoot.prototype.render 函数
    </h2>
    <p>
     <code>
      render
     </code>
     是
     <code>
      ReactDOMRoot
     </code>
     原型上的一个方法，主要作用是在根 DOM 节点上渲染一个
     <code>
      React
     </code>
     元素。
    </p>
    <pre><code class="prism language-ts">ReactDOMHydrationRoot<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>render <span class="token operator">=</span> ReactDOMRoot<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>render <span class="token operator">=</span>
  <span class="token comment">// $FlowFixMe[missing-this-annot]</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span>children<span class="token operator">:</span> ReactNodeList<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> root <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_internalRoot<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Cannot update an unmounted root.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//执行更新</span>
    <span class="token function">updateContainer</span><span class="token punctuation">(</span>children<span class="token punctuation">,</span> root<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
    <h2>
     <a id="ReactDOMRootprototypeunmount__377">
     </a>
     ReactDOMRoot.prototype.unmount 函数
    </h2>
    <p>
     <code>
      unmount
     </code>
     方法是
     <code>
      ReactDOMRoot
     </code>
     原型上的一个方法，其主要作用是卸载
     <code>
      React
     </code>
     应用的根节点，清理相关资源，将根节点从 DOM 中移除，释放内存并确保应用不再占用相关资源。
    </p>
    <pre><code class="prism language-ts">ReactDOMHydrationRoot<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>unmount <span class="token operator">=</span> ReactDOMRoot<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>unmount <span class="token operator">=</span>
  <span class="token comment">// $FlowFixMe[missing-this-annot]</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 获取内部根节点实例</span>
    <span class="token keyword">const</span> root <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_internalRoot<span class="token punctuation">;</span>
    <span class="token comment">// 存在</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 清空根实例的引用</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>_internalRoot <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token comment">// root.containerInfo 存储了 React 应用渲染的 DOM 容器节点信息。通过 root.containerInfo 获取根节点对应的 DOM 容器节点。</span>
      <span class="token keyword">const</span> container <span class="token operator">=</span> root<span class="token punctuation">.</span>containerInfo<span class="token punctuation">;</span>

      <span class="token comment">// 同步更新容器</span>
      <span class="token function">updateContainerSync</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> root<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 刷新同步工作</span>
      <span class="token function">flushSyncWork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 取消容器的根节点标记</span>
      <span class="token function">unmarkContainerAsRoot</span><span class="token punctuation">(</span>container<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
    <h2>
     <a id="_403">
     </a>
     全局变量
    </h2>
    <pre><code class="prism language-ts"><span class="token keyword">const</span> randomKey <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//internalInstanceKey 用于在 DOM 元素上存储 React Fiber 实例的相关信息。</span>
<span class="token keyword">const</span> internalInstanceKey <span class="token operator">=</span> <span class="token string">'__reactFiber$'</span> <span class="token operator">+</span> randomKey<span class="token punctuation">;</span>

<span class="token comment">// internalPropsKey 用于存储传递给组件的 props 信息。</span>
<span class="token keyword">const</span> internalPropsKey <span class="token operator">=</span> <span class="token string">'__reactProps$'</span> <span class="token operator">+</span> randomKey<span class="token punctuation">;</span>

<span class="token keyword">const</span> internalContainerInstanceKey <span class="token operator">=</span> <span class="token string">'__reactContainer$'</span> <span class="token operator">+</span> randomKey<span class="token punctuation">;</span>

<span class="token comment">// internalEventHandlersKey 用于存储事件处理函数的相关信息。</span>
<span class="token keyword">const</span> internalEventHandlersKey <span class="token operator">=</span> <span class="token string">'__reactEvents$'</span> <span class="token operator">+</span> randomKey<span class="token punctuation">;</span>
<span class="token keyword">const</span> internalEventHandlerListenersKey <span class="token operator">=</span> <span class="token string">'__reactListeners$'</span> <span class="token operator">+</span> randomKey<span class="token punctuation">;</span>
<span class="token keyword">const</span> internalEventHandlesSetKey <span class="token operator">=</span> <span class="token string">'__reactHandles$'</span> <span class="token operator">+</span> randomKey<span class="token punctuation">;</span>
<span class="token keyword">const</span> internalRootNodeResourcesKey <span class="token operator">=</span> <span class="token string">'__reactResources$'</span> <span class="token operator">+</span> randomKey<span class="token punctuation">;</span>
<span class="token keyword">const</span> internalHoistableMarker <span class="token operator">=</span> <span class="token string">'__reactMarker$'</span> <span class="token operator">+</span> randomKey<span class="token punctuation">;</span>
</code></pre>
    <h2>
     <a id="_markContainerAsRoot_423">
     </a>
     工具函数 markContainerAsRoot
    </h2>
    <p>
     <code>
      markContainerAsRoot
     </code>
     的作用是将一个 DOM 容器节点标记为 React 应用的根容器，并将对应的
     <code>
      Fiber
     </code>
     根节点与该容器节点关联起来。在 React 的渲染过程中，需要将
     <code>
      Fiber
     </code>
     树与实际的
     <code>
      DOM
     </code>
     节点进行关联。
    </p>
    <blockquote>
     <p>
      函数参数含义：
     </p>
     <ul>
      <li>
       <code>
        hostRoot
       </code>
       ， 根节点fiber
      </li>
      <li>
       <code>
        node
       </code>
       ， DOM 容器节点
      </li>
     </ul>
    </blockquote>
    <pre><code class="prism language-ts"><span class="token keyword">function</span> <span class="token function">markContainerAsRoot</span><span class="token punctuation">(</span>hostRoot<span class="token operator">:</span> Fiber<span class="token punctuation">,</span> node<span class="token operator">:</span> Container<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// $FlowFixMe[prop-missing]</span>
  node<span class="token punctuation">[</span>internalContainerInstanceKey<span class="token punctuation">]</span> <span class="token operator">=</span> hostRoot<span class="token punctuation">;</span>
  <span class="token comment">// 变量internalContainerInstanceKey = '__reactContainer$' + randomKey;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/537a2b12638c4829b856b9831672e643.png"/>
    </p>
    <h2>
     <a id="_markContainerAsRoot_441">
     </a>
     工具函数 markContainerAsRoot
    </h2>
    <pre><code class="prism language-ts"><span class="token keyword">function</span> <span class="token function">unmarkContainerAsRoot</span><span class="token punctuation">(</span>node<span class="token operator">:</span> Container<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// $FlowFixMe[prop-missing]</span>
  node<span class="token punctuation">[</span>internalContainerInstanceKey<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h2>
     <a id="_449">
     </a>
     流程图
    </h2>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/b80dfd68c15a4ec4a37a65639bedbbe8.png"/>
    </p>
    <p>
     后续继续看
     <code>
      FiberRoot
     </code>
     节点和
     <code>
      Fiber
     </code>
     节点的结构以及
     <code>
      root.render
     </code>
     中的
     <code>
      updateContainer
     </code>
     是如何执行的。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34303131393431322f:61727469636c652f64657461696c732f313436323535343030" class_="artid" style="display:none">
 </p>
</div>


