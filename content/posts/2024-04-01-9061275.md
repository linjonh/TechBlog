---
layout: post
title: "MPI并行计算环境搭建以及集群测试"
date: 2024-04-01 01:26:26 +0800
description: "MPI作为一种通过消息传递进行并行计算的框架，在很多科学计算上有很重要的应用，这次因为GraphLa"
keywords: "win10+ms-mpi+局域网+多主机 组建集群计算"
categories: ['Mpi', 'Linux']
tags: ['无标签']
artid: "9061275"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=9061275
    alt: "MPI并行计算环境搭建以及集群测试"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=9061275
featuredImagePreview: https://bing.ee123.net/img/rand?artid=9061275
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     MPI并行计算环境搭建以及集群测试
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <span style="color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px; line-height:25px">
     MPI作为一种通过消息传递进行并行计算的框架，在很多科学计算上有很重要的应用，这次因为GraphLab环境搭建时的需要，花了三个来小时的时间进行了初步的搭建摸索，感觉很有意思！
    </span>
    <wbr style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px"/>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     首先是单机MPI安装
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     <strong>
      1.安装之前
     </strong>
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     因为是集群测试，所以跟hadoop一样先要设置ssh无密钥登录（可以参考
     <a href="http://www.cnblogs.com/lyq105/archive/2010/06/01/1749515.html" rel="nofollow noopener noreferrer" style="color:rgb(30,141,204); text-decoration:none" target="_blank">
      这里
     </a>
     ），我这里用的是一个服务器节点和一台虚拟机。
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     上面给出的链接里对ssh无密钥登录设置说的很清楚。
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     <strong>
      2.开始安装
     </strong>
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     <a href="http://www.mcs.anl.gov/research/projects/mpich2" rel="nofollow noopener noreferrer" style="color:rgb(30,141,204); text-decoration:none" target="_blank">
      源码下载
     </a>
     地址，这里我用的是1.0.8（mpich命名很怪气，明明是v2，它却命名是1，无力吐槽）
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     mpich2-1.0.8.tar.gz
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     单机安装很简单
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     <pre class="prettyprint" style="padding:2px; border:1px solid rgb(136,136,136)"><p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px"><span class="com" style="color:rgb(136,0,0)">#tar -zxvf mpich2-1.0.8.tar.gz</span></p><p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px"><span class="com" style="color:rgb(136,0,0)">#./configure    (我让它默认安装到/usr/local/bin下，不需要设置安装路径)</span></p><p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px"><span class="com" style="color:rgb(136,0,0)">#make</span></p><p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px"><span class="com" style="color:rgb(136,0,0)">#make install</span></p></pre>
     注意：
     <span style="color:#ff0000">
      对于集群的每一个机器都要安装，当然你如果用NFS挂载也可以，我没这样用。
     </span>
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     安装完成之后最重要的一步有人说是设置环境变量，其实你默认安装路径的话，这个变量设置与否无所谓的。因此最重要的一步是创建配置文件（mpd.conf）。
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     <pre class="prettyprint" style="padding:2px; border:1px solid rgb(136,136,136)"><p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px"><span class="com" style="color:rgb(136,0,0)">#touch /etc/mpd.conf</span></p><p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px"><span class="com" style="color:rgb(136,0,0)">#chmod 600 /etc/mpd.conf</span></p><p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px"><span class="com" style="color:rgb(136,0,0)">#echo secretword=myword &gt;&gt; /etc/mpd.conf</span></p></pre>
     到此为止，单机安装就算完成了，可以进行单机测试
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     <pre class="prettyprint" style="padding:2px; border:1px solid rgb(136,136,136)"><p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px"><span class="com" style="color:rgb(136,0,0)"># mpd &amp;</span>
<span class="pun" style="color:rgb(102,102,0)">[</span><span class="lit" style="color:rgb(0,102,102)">1</span><span class="pun" style="color:rgb(102,102,0)">]</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="lit" style="color:rgb(0,102,102)">4457</span>
<span class="com" style="color:rgb(136,0,0)"># mpdtrace</span>
<span class="pln" style="color:rgb(0,0,0)">vm4</span>
<span class="com" style="color:rgb(136,0,0)"># mpdallexit</span></p></pre>
     <strong>
      3.集群部署
     </strong>
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     集群部署就多一步，只需要在主机种创建集合文件（mpd.hosts），文件地方无所谓，内容为集群的hostname列表。
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     <pre class="prettyprint" style="padding:2px; border:1px solid rgb(136,136,136)"><p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px"><span class="pln" style="color:rgb(0,0,0)">node9         </span><span class="com" style="color:rgb(136,0,0)">#主服务器</span></p><p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px"><span class="com" style="color:rgb(136,0,0)">vm4           #子节点</span></p></pre>
     在主机中测试部署是否成功：
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     <pre class="prettyprint" style="padding:2px; border:1px solid rgb(136,136,136)"><p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px"><span class="com" style="color:rgb(136,0,0)"># mpdboot -n 2 -f /root/mpd.hosts </span>
<span class="com" style="color:rgb(136,0,0)"># mpdtrace</span>
<span class="pln" style="color:rgb(0,0,0)">node9</span>
<span class="pln" style="color:rgb(0,0,0)">vm4</span></p></pre>
     说明部署成功。
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     <strong>
      4.样例测试
     </strong>
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     icpi是已经经过编译的可执行文件，用于计算pi的值。（
     <span style="color:#ff0000">
      注意这里服务器和子节点中icpi放的地方要相同
     </span>
     ）
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     <strong>
      单机
     </strong>
     ：
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     <pre class="prettyprint" style="padding:2px; border:1px solid rgb(136,136,136)"><p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px"><span class="com" style="color:rgb(136,0,0)"># ./icpi </span>
<span class="typ" style="color:rgb(102,0,102)">Enter</span><span class="pln" style="color:rgb(0,0,0)"> the number of intervals</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="pun" style="color:rgb(102,102,0)">(</span><span class="lit" style="color:rgb(0,102,102)">0</span><span class="pln" style="color:rgb(0,0,0)"> quits</span><span class="pun" style="color:rgb(102,102,0)">)</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="lit" style="color:rgb(0,102,102)">10000000000</span>
<span class="pln" style="color:rgb(0,0,0)">pi </span><span class="kwd" style="color:rgb(0,0,136)">is</span><span class="pln" style="color:rgb(0,0,0)"> approximately </span><span class="lit" style="color:rgb(0,102,102)">3.1415926535895782</span><span class="pun" style="color:rgb(102,102,0)">,</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="typ" style="color:rgb(102,0,102)">Error</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="kwd" style="color:rgb(0,0,136)">is</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="lit" style="color:rgb(0,102,102)">0.0000000000002149</span>
<span class="pln" style="color:rgb(0,0,0)">wall clock time </span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="pln" style="color:rgb(0,0,0)"> </span><span style="color:#ff0000"><span class="lit" style="color:rgb(0,102,102)">45.378959</span></span>
<span class="typ" style="color:rgb(102,0,102)">Enter</span><span class="pln" style="color:rgb(0,0,0)"> the number of intervals</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="pun" style="color:rgb(102,102,0)">(</span><span class="lit" style="color:rgb(0,102,102)">0</span><span class="pln" style="color:rgb(0,0,0)"> quits</span><span class="pun" style="color:rgb(102,102,0)">)</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="lit" style="color:rgb(0,102,102)">1000</span>
<span class="pln" style="color:rgb(0,0,0)">pi </span><span class="kwd" style="color:rgb(0,0,136)">is</span><span class="pln" style="color:rgb(0,0,0)"> approximately </span><span class="lit" style="color:rgb(0,102,102)">3.1415927369231227</span><span class="pun" style="color:rgb(102,102,0)">,</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="typ" style="color:rgb(102,0,102)">Error</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="kwd" style="color:rgb(0,0,136)">is</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="lit" style="color:rgb(0,102,102)">0.0000000833333296</span>
<span class="pln" style="color:rgb(0,0,0)">wall clock time </span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="pln" style="color:rgb(0,0,0)"> </span><span style="color:#ff0000"><span class="lit" style="color:rgb(0,102,102)">0.000149</span></span></p></pre>
     <strong>
      集群
     </strong>
     ：
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     <pre class="prettyprint" style="padding:2px; border:1px solid rgb(136,136,136)"><p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px"><span class="pun" style="color:rgb(102,102,0)">[</span><span class="pln" style="color:rgb(0,0,0)">root@node9 wyztest</span><span class="pun" style="color:rgb(102,102,0)">]</span><span class="com" style="color:rgb(136,0,0)"># mpiexec -n 2 ./icpi </span>
<span class="typ" style="color:rgb(102,0,102)">Enter</span><span class="pln" style="color:rgb(0,0,0)"> the number of intervals</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="pun" style="color:rgb(102,102,0)">(</span><span class="lit" style="color:rgb(0,102,102)">0</span><span class="pln" style="color:rgb(0,0,0)"> quits</span><span class="pun" style="color:rgb(102,102,0)">)</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="lit" style="color:rgb(0,102,102)">10000000000</span>
<span class="pln" style="color:rgb(0,0,0)">pi </span><span class="kwd" style="color:rgb(0,0,136)">is</span><span class="pln" style="color:rgb(0,0,0)"> approximately </span><span class="lit" style="color:rgb(0,102,102)">3.1415926535895737</span><span class="pun" style="color:rgb(102,102,0)">,</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="typ" style="color:rgb(102,0,102)">Error</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="kwd" style="color:rgb(0,0,136)">is</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="lit" style="color:rgb(0,102,102)">0.0000000000002194</span>
<span class="pln" style="color:rgb(0,0,0)">wall clock time </span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="pln" style="color:rgb(0,0,0)"> </span><span style="color:#ff0000"><span class="lit" style="color:rgb(0,102,102)">22.696655</span></span>
<span class="typ" style="color:rgb(102,0,102)">Enter</span><span class="pln" style="color:rgb(0,0,0)"> the number of intervals</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="pun" style="color:rgb(102,102,0)">(</span><span class="lit" style="color:rgb(0,102,102)">0</span><span class="pln" style="color:rgb(0,0,0)"> quits</span><span class="pun" style="color:rgb(102,102,0)">)</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="lit" style="color:rgb(0,102,102)">0</span></p><p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px"><span class="lit" style="color:rgb(0,102,102)">Enter</span><span class="pln" style="color:rgb(0,0,0)"> the number of intervals</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="pun" style="color:rgb(102,102,0)">(</span><span class="lit" style="color:rgb(0,102,102)">0</span><span class="pln" style="color:rgb(0,0,0)"> quits</span><span class="pun" style="color:rgb(102,102,0)">)</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="lit" style="color:rgb(0,102,102)">1000</span>
<span class="pln" style="color:rgb(0,0,0)">pi </span><span class="kwd" style="color:rgb(0,0,136)">is</span><span class="pln" style="color:rgb(0,0,0)"> approximately </span><span class="lit" style="color:rgb(0,102,102)">3.1415927369231254</span><span class="pun" style="color:rgb(102,102,0)">,</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="typ" style="color:rgb(102,0,102)">Error</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="kwd" style="color:rgb(0,0,136)">is</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="lit" style="color:rgb(0,102,102)">0.0000000833333322</span>
<span class="pln" style="color:rgb(0,0,0)">wall clock time </span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="pln" style="color:rgb(0,0,0)"> </span><span style="color:#ff0000"><span class="lit" style="color:rgb(0,102,102)">0.001589</span></span></p></pre>
     测试结果表明：对于间隔比较大时，明显集群快，但是间隔很小时，由于消息传递机制本身会耗时，因此集群效率不如单机。
    </div>
    <span style="color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px; line-height:25px">
     部分参考资料链接：
    </span>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     http://blog.sina.com.cn/s/blog_5daeb2750100z3qx.html
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     http://blog.csdn.net/logwt/article/details/7325314
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     http://www.cnblogs.com/lyq105/archive/2010/06/01/1749515.html
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     http://blog.csdn.net/ngvjai/article/details/8000045
    </div>
    <span style="color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px; line-height:25px">
     补充：（可能会出现的问题，这是我在再次部署的时候出现的问题，第一次部署的时候太顺利了，因此没有出现问题，第二次再部署的时候出现了如下四个问题。）
    </span>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     <strong>
      问题1
     </strong>
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     <pre class="prettyprint" style="padding:2px; border:1px solid rgb(136,136,136)"><p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px"><span class="str" style="color:rgb(0,136,0)">/usr/</span><span class="kwd" style="color:rgb(0,0,136)">local</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">bin</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">mpdlib</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">py</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="lit" style="color:rgb(0,102,102)">8</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="typ" style="color:rgb(102,0,102)">DeprecationWarning</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="typ" style="color:rgb(102,0,102)">The</span><span class="pln" style="color:rgb(0,0,0)"> popen2 </span><span class="kwd" style="color:rgb(0,0,136)">module</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="kwd" style="color:rgb(0,0,136)">is</span><span class="pln" style="color:rgb(0,0,0)"> deprecated</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="typ" style="color:rgb(102,0,102)">Use</span><span class="pln" style="color:rgb(0,0,0)"> the subprocess </span><span class="kwd" style="color:rgb(0,0,136)">module</span><span class="pun" style="color:rgb(102,102,0)">.</span>
<span class="kwd" style="color:rgb(0,0,136)">import</span><span class="pln" style="color:rgb(0,0,0)"> sys</span><span class="pun" style="color:rgb(102,102,0)">,</span><span class="pln" style="color:rgb(0,0,0)"> os</span><span class="pun" style="color:rgb(102,102,0)">,</span><span class="pln" style="color:rgb(0,0,0)"> signal</span><span class="pun" style="color:rgb(102,102,0)">,</span><span class="pln" style="color:rgb(0,0,0)"> popen2</span><span class="pun" style="color:rgb(102,102,0)">,</span><span class="pln" style="color:rgb(0,0,0)"> socket</span><span class="pun" style="color:rgb(102,102,0)">,</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="kwd" style="color:rgb(0,0,136)">select</span><span class="pun" style="color:rgb(102,102,0)">,</span><span class="pln" style="color:rgb(0,0,0)"> inspect</span>
<span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">usr</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="kwd" style="color:rgb(0,0,136)">local</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">bin</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">mpdlib</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">py</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="lit" style="color:rgb(0,102,102)">15</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="typ" style="color:rgb(102,0,102)">DeprecationWarning</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)"> the md5 </span><span class="kwd" style="color:rgb(0,0,136)">module</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="kwd" style="color:rgb(0,0,136)">is</span><span class="pln" style="color:rgb(0,0,0)"> deprecated</span><span class="pun" style="color:rgb(102,102,0)">;</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="kwd" style="color:rgb(0,0,136)">use</span><span class="pln" style="color:rgb(0,0,0)"> hashlib instead</span>
<span class="kwd" style="color:rgb(0,0,136)">from</span><span class="pln" style="color:rgb(0,0,0)"> md5 </span><span class="kwd" style="color:rgb(0,0,136)">import</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="kwd" style="color:rgb(0,0,136)">new</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="kwd" style="color:rgb(0,0,136)">as</span><span class="pln" style="color:rgb(0,0,0)"> md5new</span></p></pre>
     原因：python版本太高了，python2.6开始都不支持popen2模块，转而用subprocess模块代替，因此会出现这个错误。
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     解决办法是降低python的版本，转到python2.5之后就可以了。（
     <a href="http://www.python.org/getit/releases/" rel="nofollow noopener noreferrer" style="color:rgb(30,141,204); text-decoration:none" target="_blank">
      源码下载
     </a>
     ）
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     <strong>
      问题2
     </strong>
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     <pre class="prettyprint" style="padding:2px; border:1px solid rgb(136,136,136)"><p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px"><span class="com" style="color:rgb(136,0,0)">#ssh node2</span></p><p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px"><span class="com" style="color:rgb(136,0,0)">ssh: node2: Temporary failure in name resolution</span></p><p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px"><span class="com" style="color:rgb(136,0,0)">#ssh 192.168.169.2 则成功</span></p></pre>
     原因：/etc/hosts中配置不完全
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     解决办法：
     <span style="color:#ff0000">
      两端
     </span>
     都需要配置如下：
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     <pre class="prettyprint" style="padding:2px; border:1px solid rgb(136,136,136)"><p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px"><span class="lit" style="color:rgb(0,102,102)">192.168</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">168.9</span><span class="pln" style="color:rgb(0,0,0)"> node9</span>
<span class="lit" style="color:rgb(0,102,102)">192.168</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">169.2</span><span class="pln" style="color:rgb(0,0,0)"> node2</span></p></pre>
     <strong>
      问题3
     </strong>
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     <pre class="prettyprint" style="padding:2px; border:1px solid rgb(136,136,136)"><p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px"><span class="pun" style="color:rgb(102,102,0)">[</span><span class="pln" style="color:rgb(0,0,0)">root@node9 source</span><span class="pun" style="color:rgb(102,102,0)">]</span><span class="com" style="color:rgb(136,0,0)"># mpdboot -n 2 -f /root/mpd.hosts </span>
<span class="pln" style="color:rgb(0,0,0)">mpdboot_node9 </span><span class="pun" style="color:rgb(102,102,0)">(</span><span class="pln" style="color:rgb(0,0,0)">handle_mpd_output </span><span class="lit" style="color:rgb(0,102,102)">401</span><span class="pun" style="color:rgb(102,102,0)">):</span><span class="pln" style="color:rgb(0,0,0)"> failed to connect to mpd on node2</span></p></pre>
     原因：防火墙的问题，node2中防火墙禁止node9进行mpd连接
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     解决办法：我直接将node2中端口关掉了
    </div>
    <div style="line-height:25px; color:rgb(88,89,93); font-family:Arial,Helvetica,simsun,u5b8bu4f53; font-size:14px">
     <pre class="prettyprint" style="padding:2px; border:1px solid rgb(136,136,136)"><p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px"><span class="pun" style="color:rgb(102,102,0)">[</span><span class="pln" style="color:rgb(0,0,0)">root@node2 </span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">ssh</span><span class="pun" style="color:rgb(102,102,0)">]</span><span class="com" style="color:rgb(136,0,0)"># iptables -F</span>
<span class="pun" style="color:rgb(102,102,0)">[</span><span class="pln" style="color:rgb(0,0,0)">root@node2 </span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">ssh</span><span class="pun" style="color:rgb(102,102,0)">]</span><span class="com" style="color:rgb(136,0,0)"># iptables -L</span>
<span class="typ" style="color:rgb(102,0,102)">Chain</span><span class="pln" style="color:rgb(0,0,0)"> INPUT </span><span class="pun" style="color:rgb(102,102,0)">(</span><span class="pln" style="color:rgb(0,0,0)">policy ACCEPT</span><span class="pun" style="color:rgb(102,102,0)">)</span>
<span class="pln" style="color:rgb(0,0,0)">target     prot opt source               destination         </span>

<span class="typ" style="color:rgb(102,0,102)">Chain</span><span class="pln" style="color:rgb(0,0,0)"> FORWARD </span><span class="pun" style="color:rgb(102,102,0)">(</span><span class="pln" style="color:rgb(0,0,0)">policy ACCEPT</span><span class="pun" style="color:rgb(102,102,0)">)</span>
<span class="pln" style="color:rgb(0,0,0)">target     prot opt sourc</span></p><p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px"><span class="pln" style="color:rgb(0,0,0)">
</span></p><p style="margin-top:0px; margin-bottom:10px; padding-top:0px; padding-bottom:0px"><span class="pln" style="color:rgb(0,0,0)"><a href="http://wuyanzan60688.blog.163.com/blog/static/12777616320132452036223/" rel="nofollow noopener noreferrer" target="_blank">http://wuyanzan60688.blog.163.com/blog/static/12777616320132452036223/</a>
</span></p></pre>
    </div>
   </div>
  </div>
 </article>
 <p alt="6874747073:3a2f2f626c6f672e6373646e2e6e65742f4e4f4841434b4343:432f61727469636c652f64657461696c732f39303631323735" class_="artid" style="display:none">
 </p>
</div>


