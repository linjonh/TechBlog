---
layout: post
title: "计算机网络-服务器模型"
date: 2025-03-07 20:54:45 +0800
description: "一.服务器模型一.服务器模型1.支持多客户端访问//单循环服务器socketbindlistenwhile(1)acceptwhile(1)recv/sendclose注：该模式remvform为阻塞态，服务器将等待接收数据2..支持多客户端同时访问 (并发能力)socketbindlistenwhile(1)//出错处理while(1) //负责 与 客户端通信的recv/sendclose。"
keywords: "计算机网络-服务器模型"
categories: ['未分类']
tags: ['运维', '计算机网络', '服务器']
artid: "146104719"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146104719
    alt: "计算机网络-服务器模型"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146104719
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146104719
cover: https://bing.ee123.net/img/rand?artid=146104719
image: https://bing.ee123.net/img/rand?artid=146104719
img: https://bing.ee123.net/img/rand?artid=146104719
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     计算机网络-服务器模型
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h2>
     <span style="color:#fe2c24">
      一.服务器模型
     </span>
    </h2>
    <h4>
     <span style="color:#fe2c24">
      1.支持多客户端访问
     </span>
    </h4>
    <p>
     //单循环服务器
     <br/>
     socket
     <br/>
     bind
     <br/>
     listen
     <br/>
     while(1)
     <br/>
     {
     <br/>
     accept
     <br/>
     while(1)
     <br/>
     {
     <!-- -->
     <br/>
     recv/send
     <br/>
     }
     <br/>
     }
     <br/>
     close
    </p>
    <p>
     <img alt="" height="856" src="https://i-blog.csdnimg.cn/direct/470e3e0af6c144278a72703c81040151.png" width="1544"/>
    </p>
    <p>
     注：该模式remvform为阻塞态，服务器将等待接收数据
    </p>
    <h4>
    </h4>
    <h4>
     <br/>
     <span style="color:#fe2c24">
      2..支持多客户端同时访问 (并发能力)
     </span>
    </h4>
    <p>
     <br/>
     socket
     <br/>
     bind
     <br/>
     listen
     <br/>
     while(1)
     <br/>
     {
     <br/>
     connf = accept
     <br/>
     pid_t pid = fork();
     <br/>
     //出错处理
     <br/>
     if (pid == 0)
     <br/>
     {
     <!-- -->
     <br/>
     while(1) //负责 与 客户端通信的
     <br/>
     {
     <br/>
     recv/send
     <br/>
     }
     <br/>
     }
     <br/>
     }
     <br/>
     close
    </p>
    <p>
     <img alt="" height="830" src="https://i-blog.csdnimg.cn/direct/d185755507cf4b9a878517cac27f28e9.png" width="1473"/>
    </p>
    <p>
     <img alt="" height="762" src="https://i-blog.csdnimg.cn/direct/01f1db96016246518be6d8bd3f2fa7bb.bmp" width="697"/>
    </p>
    <p>
     注：将管道设置成非阻塞一直读取
    </p>
    <p>
     <img alt="" height="656" src="https://i-blog.csdnimg.cn/direct/f132b873ee8a4c6dad9eb303d08d9ddc.bmp" width="693"/>
    </p>
    <p>
     读端设置非阻塞
    </p>
    <p>
    </p>
    <p>
     //线程
    </p>
    <p>
     void *handle_client(void *arg)
     <br/>
     {
     <!-- -->
     <br/>
     while(1) //子线程中 负责 与 客户端通信的
     <br/>
     {
     <br/>
     recv/send
     <br/>
     }
     <br/>
     }
    </p>
    <p>
     <br/>
     socket
     <br/>
     bind
     <br/>
     listen
     <br/>
     while(1)
     <br/>
     {
     <br/>
     connf = accept
     <br/>
     pthread_create();
     <br/>
     //出错处理
     <br/>
     }
     <br/>
     close
    </p>
    <h2>
     二，三种服务器模型:
    </h2>
    <h4>
     1.单循环服务器
     <br/>
     2.并发服务器
    </h4>
    <p>
     <br/>
     进程
     <br/>
     线程
     <br/>
    </p>
    <p>
     1、简单循环服务器
     <br/>
     http
     <br/>
     web 服务器，apache--》cgi，php，perl，IIS--》asp，NGIX，Nlighty
     <br/>
     <br/>
     while(1)
     <br/>
     {
     <!-- -->
     <br/>
     newfd = accept();
     <br/>
     recv();
     <br/>
     close(newfd);
     <br/>
     }
    </p>
    <p>
     特点：可以接入多个客户端的信息。
     <br/>
     缺点：数据通信过程短，客户端只能一次有效。
     <br/>
     实时性效果差。
    </p>
    <p>
     2、fork循环服务器===&gt;每次有链接则fork一个子进程为该
     <br/>
     链接处理通信过程，父进程继续等待新链接。
    </p>
    <p>
     while(1)
     <br/>
     {
     <!-- -->
     <br/>
     newfd  = accept();
     <br/>
     pid = fork()
     <br/>
     if(pid  == 0)
     <br/>
     {
     <!-- -->
     <br/>
     ///接收数据
     <br/>
     }
     <br/>
     if(pid &lt; 0)
     <br/>
     {
     <!-- -->
     <br/>
     perror("fork");
     <br/>
     return -1;
     <br/>
     }
     <br/>
     waitpid()
     <br/>
     }
     <br/>
     <br/>
     特点：可以完成多个进程的实时交互，信息的完整性可以保证。
    </p>
    <p>
     缺点：回收资源不方便，每次fork 占用系统资源多。
     <br/>
     可能出现僵尸进程
     <br/>
     <br/>
     多线程:
     <br/>
     特点:
     <br/>
     创建速度快，调度快
     <br/>
     缺点:
     <br/>
     线程共享进程资源，稳定性，安全性 较差
    </p>
    <h4>
     <br/>
     <br/>
     3.并发的服务器模型 ---更高程度上的并发
     <br/>
    </h4>
    <p>
     <br/>
     IO模型
     <br/>
     阻塞IO
     <br/>
     非阻塞IO
     <br/>
     <br/>
     <br/>
     <br/>
     1、阻塞IO
     <br/>
     用的最多。
     <br/>
     读阻塞。
     <br/>
     写阻塞。
     <br/>
     2、非阻塞IO
     <br/>
     -1 errno EAGAIN  whild(1){read()break;}忙等待
     <br/>
     contro
    </p>
    <p>
     <img alt="" height="883" src="https://i-blog.csdnimg.cn/direct/a8b9f0b69281404daf2aaf304cd0fb8d.png" width="1398"/>
    </p>
    <p>
     <img alt="" height="705" src="https://i-blog.csdnimg.cn/direct/b2d76782354a4e86ad58a74d02ed96c3.bmp" width="1148"/>
    </p>
    <p>
     注：信号驱动IO
    </p>
    <p>
    </p>
    <h4>
     <br/>
     4.SELECT函数并发
    </h4>
    <p>
     #include &lt;unistd.h&gt;
     <br/>
     #include &lt;fcntl.h&gt;
     <br/>
     int fcntl(int fd, int cmd, ... /* arg */ );
     <br/>
     功能：修改指定文件的属性信息。
     <br/>
     参数：fd 要调整的文件描述符
     <br/>
     cmd 要调整的文件属性宏名称
     <br/>
     ... 可变长的属性值参数。
     <br/>
     返回值：成功  不一定，看cmd
     <br/>
     失败  -1；
     <br/>
     <br/>
     <br/>
     int fcntl(int fd, int cmd, ... /* arg */ );
    </p>
    <p>
     //驱动:
     <br/>
     //1.驱动程序 ---- 驱使硬件工作起来的程序
     <br/>
     让灯亮起来
     <br/>
     <br/>
     //2.应用程序
     <br/>
     应用程序
     <br/>
     led_ctnl(led_fd,ON );
     <br/>
     led_ctnl(led_fd,OFF );
     <br/>
     led_ctnl(led_ctnl,STREAM); //流水灯
    </p>
    <p>
     <br/>
     eg：修改文件的非阻塞属性：
     <br/>
     int flag ;
     <br/>
     flag  = fcntl(fd,F_GETFL,0);  ///获取fd文件的默认属性到flag变量中。
     <br/>
     flag  = flag | O_NONBLOCK;    ///将变量的值调整并添加非阻塞属性
     <br/>
     fcntl(fd,F_SETFL,flag);       ///将新属性flag设置到fd对应的文件生效。
    </p>
    <p>
     以上代码执行后的阻塞IO将变成非阻塞方式。
     <br/>
     <img alt="" height="895" src="https://i-blog.csdnimg.cn/direct/7dce2f34bec049c1a22613bf0ac4df96.png" width="1645"/>
    </p>
    <p>
     <br/>
     <br/>
    </p>
    <p>
    </p>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323430315f38333533323332332f:61727469636c652f64657461696c732f313436313034373139" class_="artid" style="display:none">
 </p>
</div>


