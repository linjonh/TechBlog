---
layout: post
title: "COpenCVMat初始化赋值误区"
date: 2025-03-11 16:00:22 +0800
description: "一直以为下面这样会将每个通道均初始化为1，导致一个bug调了半天根本没有怀疑过这里。连deepseek和chatgpt也这样说，实际上只会对一个通道初始化。"
keywords: "C++/OpenCV：Mat初始化赋值误区"
categories: ['Opencv', 'C']
tags: ['计算机视觉', '人工智能', 'Opencv']
artid: "146181308"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146181308
    alt: "COpenCVMat初始化赋值误区"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146181308
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146181308
cover: https://bing.ee123.net/img/rand?artid=146181308
image: https://bing.ee123.net/img/rand?artid=146181308
img: https://bing.ee123.net/img/rand?artid=146181308
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     C++/OpenCV：Mat初始化赋值误区
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <pre><code class="language-cpp">#include &lt;opencv2/opencv.hpp&gt;
#include &lt;iostream&gt;

using namespace cv;
using namespace std;

int main() {
    int pic_height = 2;
    int pic_width = 2;

    {
        Mat alpha_map = Mat::ones(pic_height, pic_width, CV_32FC4);
        cout &lt;&lt; "alpha_map = " &lt;&lt; endl &lt;&lt; alpha_map &lt;&lt; endl;
        //alpha_map =
        //    [1, 0, 0, 0, 1, 0, 0, 0;
        //     1, 0, 0, 0, 1, 0, 0, 0]
    }
    {
        Mat alpha_map = Mat::ones(pic_height, pic_width, CV_32FC4);
        alpha_map.setTo(1);
        cout &lt;&lt; "alpha_map = " &lt;&lt; endl &lt;&lt; alpha_map &lt;&lt; endl;
        //alpha_map =
        //    [1, 1, 1, 1, 1, 1, 1, 1;
        //     1, 1, 1, 1, 1, 1, 1, 1]
    }
    {
        Mat alpha_map(pic_height, pic_width, CV_32FC4, Scalar(1.0, 1.0, 1.0, 1.0));
        cout &lt;&lt; "alpha_map = " &lt;&lt; endl &lt;&lt; alpha_map &lt;&lt; endl;
        //alpha_map =
        //    [1, 1, 1, 1, 1, 1, 1, 1;
        //     1, 1, 1, 1, 1, 1, 1, 1]
    }
    return 0;
}</code></pre>
    <p>
     一直以为下面这样会将每个通道均初始化为1，导致一个bug调了半天根本没有怀疑过这里。
    </p>
    <p>
     连deepseek和chatgpt也这样说，实际上只会对一个通道初始化。
    </p>
    <blockquote>
     <p>
      Mat alpha_map = Mat::ones(pic_height, pic_width, CV_32FC4);
     </p>
    </blockquote>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c:6f672e6373646e2e6e65742f63645f796f757268656172742f:61727469636c652f64657461696c732f313436313831333038" class_="artid" style="display:none">
 </p>
</div>


