---
layout: post
title: "有关MyBatis的动态SQL"
date: 2025-03-11 21:30:34 +0800
description: "本文介绍了MyBatis中的动态SQL，介绍了其运行原理和常用标签的使用方法，以及使用时的注意事项！"
keywords: "有关MyBatis的动态SQL"
categories: ['Mybatis']
tags: ['笔记', '学习', 'Sql', 'Mybatis', 'Java']
artid: "146189445"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146189445
    alt: "有关MyBatis的动态SQL"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146189445
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146189445
cover: https://bing.ee123.net/img/rand?artid=146189445
image: https://bing.ee123.net/img/rand?artid=146189445
img: https://bing.ee123.net/img/rand?artid=146189445
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     有关MyBatis的动态SQL
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="MyBatisSQL_0">
     </a>
     有关MyBatis动态SQL
    </h2>
    <p>
     MyBatis动态SQL是一种根据不同条件灵活拼接SQL语句的技术，基于OGNL表达式实现。动态 SQL 大大减少了编写代码的工作量，更体现了 MyBatis 的灵活性、高度可配置性和可维护性。
    </p>
    <h2>
     <a id="1SQL_2">
     </a>
     1.什么是动态SQL?
    </h2>
    <p>
     动态sql可以在一些需要灵活拼接sql语句的场景中使用，作用是根据一些条件，拼接出需要的sql语句。
    </p>
    <p>
     动态 SQL 是 MyBatis 的强大特性之一。在 JDBC 或其它类似的框架中，开发人员通常需要手动拼接 SQL 语句。根据不同的条件拼接 SQL 语句是一件极其痛苦的工作。而动态 SQL 恰好解决了这一问题，可以根据场景动态的构建查询。
    </p>
    <p>
     动态 SQL 只有几个基本元素，与 JSTL 或 XML 文本处理器相似，十分简单明了，大量的判断都可以在 MyBatis 的映射 XML 文件里配置，以达到许多需要大量代码才能实现的功能。
    </p>
    <p>
     MyBatis 也可以在注解中配置 SQL，但是由于注解功能受限，且对于复杂的 SQL 语句来说可读性差，所以使用较少。本教程不对它们进行介绍。
    </p>
    <h2>
     <a id="2SQL_12">
     </a>
     2.动态SQL的作用与原理
    </h2>
    <h3>
     <a id="21__14">
     </a>
     2.1
     <strong>
      作用
     </strong>
    </h3>
    <ul>
     <li>
      <strong>
       灵活拼接SQL
      </strong>
      ：根据参数值动态添加或删除SQL片段，例如条件查询、批量操作、多分支选择等场景
     </li>
     <li>
      <strong>
       简化代码
      </strong>
      ：避免手动处理逗号、空格、WHERE/AND/OR等语法细节，提升代码可读性
     </li>
     <li>
      <strong>
       提高安全性
      </strong>
      ：通过预编译机制（
      <code>
       #{}
      </code>
      ）防止SQL注入，但需注意复杂逻辑下的潜在风险
     </li>
    </ul>
    <h3>
     <a id="22__20">
     </a>
     2.2
     <strong>
      执行原理
     </strong>
    </h3>
    <ul>
     <li>
      <p>
       <strong>
        OGNL表达式
       </strong>
       ：MyBatis使用OGNL（Object-Graph Navigation Language）从参数对象中解析条件值，判断是否包含特定SQL片段
      </p>
     </li>
     <li>
      <p>
       <strong>
        动态解析流程
       </strong>
       ：
      </p>
      <p>
       ① XML中的SQL标签（如
       <code>
        &lt;if&gt;
       </code>
       <code>
        &lt;where&gt;
       </code>
       、）被解析为
       <code>
        SqlNode
       </code>
       对象；
      </p>
      <p>
       ② 运行时根据参数值生成
       <code>
        BoundSql
       </code>
       对象，拼接最终SQL；
      </p>
      <p>
       ③ 核心类如
       <code>
        OgnlExpressionEvaluator
       </code>
       处理表达式计算，
       <code>
        TrimSqlNode
       </code>
       、
       <code>
        WhereSqlNode
       </code>
      </p>
      <p>
       等处理语法修剪;
      </p>
     </li>
    </ul>
    <h2>
     <a id="3SQL_34">
     </a>
     3.常用动态SQL标签及用法
    </h2>
    <p>
     MyBatis 的动态 SQL 包括以下几种元素，如下表所示。
    </p>
    <table>
     <thead>
      <tr>
       <th align="left">
        元素
       </th>
       <th align="left">
        作用
       </th>
       <th align="left">
        备注
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td align="left">
        if
       </td>
       <td align="left">
        判断语句
       </td>
       <td align="left">
        单条件分支判断
       </td>
      </tr>
      <tr>
       <td align="left">
        choose（when、otherwise）
       </td>
       <td align="left">
        相当于 Java 中的 switch case 语句
       </td>
       <td align="left">
        多条件分支判断
       </td>
      </tr>
      <tr>
       <td align="left">
        trim、where
       </td>
       <td align="left">
        辅助元素
       </td>
       <td align="left">
        用于处理一些SQL拼装问题
       </td>
      </tr>
      <tr>
       <td align="left">
        foreach
       </td>
       <td align="left">
        循环语句
       </td>
       <td align="left">
        在in语句等列举条件常用
       </td>
      </tr>
      <tr>
       <td align="left">
        bind
       </td>
       <td align="left">
        辅助元素
       </td>
       <td align="left">
        拼接参数
       </td>
      </tr>
     </tbody>
    </table>
    <h3>
     <a id="31__if_46">
     </a>
     3.1
     <strong>
      <code>
       &lt;if&gt;
      </code>
      标签
     </strong>
    </h3>
    <ul>
     <li>
      <p>
       <strong>
        功能
       </strong>
       ：通过
       <code>
        test
       </code>
       属性判断条件是否成立，决定是否包含SQL片段。当判断条件为 true 时，才会执行所包含的 SQL 语句
      </p>
     </li>
     <li>
      <p>
       示例：根据姓名和年龄动态查询用户：
      </p>
      <pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectUser<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    SELECT * FROM user
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>where</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name != null<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>AND name = #{name}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>age &gt; 0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>AND age = #{age}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>where</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre>
      <ul>
       <li>
        示例:可多个 if 语句同时使用。以下语句表示为可以按照student名称（stu_name）或者stu_age进行模糊查询。如果您不输入名称或年龄，则返回所有的student记录。但是，如果你传递了任意一个参数，它就会返回与给定参数相匹配的记录。
       </li>
      </ul>
      <pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>select13<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Student<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        select * from student where true
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name!=null<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            and stu_name='${name}'
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>age!=null<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            and stu_age=${age}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre>
      <p>
       注意：字符串比较需用
       <code>
        toString()
       </code>
       避免类型错误，如
      </p>
      <pre><code class="prism language-xml">test="sex == '1'.toString()"
</code></pre>
     </li>
    </ul>
    <h3>
     <a id="32_where_82">
     </a>
     3.2
     <strong>
      <code>
       &lt;where&gt;
      </code>
      标签
     </strong>
    </h3>
    <ul>
     <li>
      <p>
       <strong>
        功能
       </strong>
       ：自动生成
       <code>
        WHERE
       </code>
       子句，并去除首个条件的
       <code>
        AND
       </code>
       /
       <code>
        OR
       </code>
       前缀，避免语法错误。
      </p>
     </li>
     <li>
      <p>
       if 语句中判断条件为 true 时，where 关键字才会加入到组装的 SQL 里面，否则就不加入。where 会检索语句，它会将 where 后的第一个 SQL 条件语句的 AND 或者 OR 关键词去掉。
      </p>
     </li>
     <li>
      <p>
       示例：
      </p>
      <pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>where</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name != null<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>name = #{name}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>age != null<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>AND age = #{age}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>where</span><span class="token punctuation">&gt;</span></span>
</code></pre>
      <ul>
       <li>
        最佳实践：每个条件建议以
        <code>
         AND
        </code>
        /
        <code>
         OR
        </code>
        开头，
        <code>
         &lt;where&gt;
        </code>
        会自动处理首前缀,where后面的意思是，如果后面if条件中有成立的语句，则加上where语句，如果没有成立的条件语句，则不加where条件，第一个成立条件的语句，前面的and或者or自动删除。
       </li>
      </ul>
     </li>
    </ul>
    <h3>
     <a id="33_trim_99">
     </a>
     3.3
     <strong>
      <code>
       &lt;trim&gt;
      </code>
      标签
     </strong>
    </h3>
    <pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>trim</span> <span class="token attr-name">prefix</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>前缀<span class="token punctuation">"</span></span> <span class="token attr-name">suffix</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>后缀<span class="token punctuation">"</span></span> <span class="token attr-name">prefixOverrides</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>忽略前缀字符<span class="token punctuation">"</span></span> <span class="token attr-name">suffixOverrides</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>忽略后缀字符<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    SQL语句
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>trim</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <ul>
     <li>
      <strong>
       功能
      </strong>
      ：自定义前缀/后缀的添加或删除，适用于复杂场景。
     </li>
     <li>
      <strong>
       属性
      </strong>
      ：
      <code>
       prefix
      </code>
      （添加前缀）、
      <code>
       suffix
      </code>
      （添加后缀）、
      <code>
       prefixOverrides
      </code>
      （删除前缀）、
      <code>
       suffixOverrides
      </code>
      （删除后缀）。
     </li>
    </ul>
    <p>
     trim 中属性说明如下。
    </p>
    <table>
     <thead>
      <tr>
       <th align="left">
        属性
       </th>
       <th align="left">
        描述
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td align="left">
        prefix
       </td>
       <td align="left">
        给SQL语句拼接的前缀，为 trim 包含的内容加上前缀
       </td>
      </tr>
      <tr>
       <td align="left">
        suffix
       </td>
       <td align="left">
        给SQL语句拼接的后缀，为 trim 包含的内容加上后缀
       </td>
      </tr>
      <tr>
       <td align="left">
        prefixOverrides
       </td>
       <td align="left">
        去除 SQL 语句前面的关键字或字符，该关键字或者字符由 prefixOverrides 属性指定。
       </td>
      </tr>
      <tr>
       <td align="left">
        suffixOverrides
       </td>
       <td align="left">
        去除 SQL 语句后面的关键字或者字符，该关键字或者字符由 suffixOverrides 属性指定。
       </td>
      </tr>
     </tbody>
    </table>
    <ul>
     <li>
      <p>
       示例：替代
       <code>
        &lt;where&gt;
       </code>
       实现相同功能：
      </p>
      <pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>trim</span> <span class="token attr-name">prefix</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>WHERE<span class="token punctuation">"</span></span> <span class="token attr-name">prefixOverrides</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>AND |OR <span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name != null<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>AND name = #{name}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>trim</span><span class="token punctuation">&gt;</span></span>
</code></pre>
     </li>
    </ul>
    <h3>
     <a id="34_choosewhenotherwise_127">
     </a>
     3.4
     <strong>
      <code>
       &lt;choose&gt;
      </code>
      、
      <code>
       &lt;when&gt;
      </code>
      、
      <code>
       &lt;otherwise&gt;
      </code>
      标签
     </strong>
    </h3>
    <ul>
     <li>
      <p>
       <strong>
        功能
       </strong>
       ：实现多分支选择逻辑，类似Java的
       <code>
        switch-case-default
       </code>
      </p>
     </li>
     <li>
      <pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>choose</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>when</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>判断条件1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        SQL语句1
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>when</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>when</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>判断条件2<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        SQL语句2
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>when</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>when</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>判断条件3<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        SQL语句3
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>when</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>otherwise</span><span class="token punctuation">&gt;</span></span>
        SQL语句4
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>otherwise</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>choose</span><span class="token punctuation">&gt;</span></span>
</code></pre>
     </li>
     <li>
      <p>
       示例：
      </p>
      <pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>choose</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>when</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name != null<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>AND name = #{name}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>when</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>when</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>age != null<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>AND age = #{age}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>when</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>otherwise</span><span class="token punctuation">&gt;</span></span>AND status = 1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>otherwise</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>choose</span><span class="token punctuation">&gt;</span></span>
</code></pre>
     </li>
    </ul>
    <p>
     3.5
     <strong>
      <code>
       &lt;foreach&gt;
      </code>
      标签
     </strong>
    </p>
    <p>
     对于一些 SQL 语句中含有 in 条件，需要迭代条件集合来生成的情况，可以使用 foreach 来实现 SQL 条件的迭代。
    </p>
    <pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foreach</span> <span class="token attr-name">item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item<span class="token punctuation">"</span></span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>index<span class="token punctuation">"</span></span> <span class="token attr-name">collection</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>list|array|map key<span class="token punctuation">"</span></span> <span class="token attr-name">open</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>(<span class="token punctuation">"</span></span> <span class="token attr-name">separator</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>,<span class="token punctuation">"</span></span> <span class="token attr-name">close</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>)<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    参数值
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>foreach</span><span class="token punctuation">&gt;</span></span>  
</code></pre>
    <p>
     参数说明：
    </p>
    <p>
     foreach 标签主要有以下属性，说明如下。
    </p>
    <blockquote>
     <ul>
      <li>
       item：表示集合中每一个元素进行迭代时的别名。
      </li>
      <li>
       index：指定一个名字，表示在迭代过程中每次迭代到的位置。
      </li>
      <li>
       open：表示该语句以什么开始（既然是 in 条件语句，所以必然以(开始）。
      </li>
      <li>
       separator：表示在每次进行迭代之间以什么符号作为分隔符（既然是 in 条件语句，所以必然以,作为分隔符）。
      </li>
      <li>
       close：表示该语句以什么结束（既然是 in 条件语句，所以必然以)开始）。
      </li>
     </ul>
    </blockquote>
    <p>
     使用 foreach 标签时，最关键、最容易出错的是 collection 属性，该属性是必选的，但在不同情况下该属性的值是不一样的，主要有以下 3 种情况：
    </p>
    <blockquote>
     <ul>
      <li>
       如果传入的是单参数且参数类型是一个 List，collection 属性值为 list。
      </li>
      <li>
       如果传入的是单参数且参数类型是一个 array 数组，collection 的属性值为 array。
      </li>
      <li>
       如果传入的参数是多个，需要把它们封装成一个 Map，当然单参数也可以封装成 Map。Map 的 key 是参数名，collection 属性值是传入的 List 或 array 对象在自己封装的 Map 中的 key。
      </li>
     </ul>
    </blockquote>
    <ul>
     <li>
      <p>
       <strong>
        功能
       </strong>
       ：遍历集合（如List、Array），生成批量操作的SQL，常用于
       <code>
        IN
       </code>
       语句或批量插入。
      </p>
     </li>
     <li>
      <p>
       示例：根据ID列表查询用户：
      </p>
      <pre><code class="prism language-XML">SELECT * FROM user WHERE id IN
&lt;foreach collection="idList" item="id" open="(" separator="," close=")"&gt;
    #{id}
&lt;/foreach&gt;
</code></pre>
     </li>
    </ul>
    <h3>
     <a id="36__set_195">
     </a>
     3.6
     <strong>
      <code>
       &lt;set&gt;
      </code>
      标签
     </strong>
    </h3>
    <ul>
     <li>
      <p>
       <strong>
        功能
       </strong>
       ：在更新操作中动态生成
       <code>
        SET
       </code>
       子句，自动去除末尾逗号。
      </p>
     </li>
     <li>
      <p>
       示例：
      </p>
      <pre><code class="prism language-XML">&lt;update id="updateUser"&gt;
    UPDATE user
    &lt;set&gt;
        &lt;if test="name != null"&gt;name = #{name},&lt;/if&gt;
        &lt;if test="age != null"&gt;age = #{age}&lt;/if&gt;
    &lt;/set&gt;
    WHERE id = #{id}
&lt;/update&gt;
</code></pre>
     </li>
    </ul>
    <h3>
     <a id="37_bind_212">
     </a>
     3.7
     <code>
      bind
     </code>
     标签
    </h3>
    <p>
     每个数据库的拼接函数或连接符号都不同，例如 MySQL 的 concat 函数、Oracle 的连接符号“||”等。这样 SQL 映射文件就需要根据不同的数据库提供不同的实现，显然比较麻烦，且不利于代码的移植。幸运的是，MyBatis 提供了 bind 标签来解决这一问题。
    </p>
    <p>
     bind 标签可以通过 OGNL 表达式自定义一个上下文变量。
    </p>
    <p>
     比如，按照名称进行模糊查询，SQL 映射文件如下。
    </p>
    <pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>select14e<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Student<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bind</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myvalue<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">'</span>%'+stu_name+'%'<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
    SELECT *
    FROM student
    WHERE stu_name like #{myvalue}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>            
</code></pre>
    <p>
     bind 元素属性如下:
    </p>
    <ul>
     <li>
      value：对应传入实体类的某个字段，可以进行字符串拼接等特殊处理。
     </li>
     <li>
      name：给对应参数取的别名。
     </li>
    </ul>
    <p>
     以上代码中的“_parameter”代表传递进来的参数，它和通配符连接后，赋给了 pattern，然后就可以在 select 语句中使用这个变量进行模糊查询，不管是 MySQL 数据库还是 Oracle 数据库都可以使用这样的语句，提高了可移植性。
    </p>
    <h2>
     <a id="4_236">
     </a>
     4.使用建议与注意事项
    </h2>
    <ol>
     <li>
      <p>
       优先使用
       <code>
        &lt;where&gt;
       </code>
       和
       <code>
        &lt;set&gt;
       </code>
       ：避免手动添加
       <code>
        1=1
       </code>
       或处理逗号，提高代码简洁性
      </p>
     </li>
     <li>
      <p>
       模糊查询优化：使用
       <code>
        &lt;bind&gt;
       </code>
       标签统一处理模糊匹配，如
       <code>
        &lt;bind name="nameLike" value="'%' + name + '%'" /&gt;
       </code>
       ，解决不同数据库的语法差异
      </p>
     </li>
     <li>
      <p>
       性能考量：动态SQL可能影响执行计划优化，复杂条件建议结合索引设计使用
      </p>
     </li>
    </ol>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f36383039333631302f:61727469636c652f64657461696c732f313436313839343435" class_="artid" style="display:none">
 </p>
</div>


