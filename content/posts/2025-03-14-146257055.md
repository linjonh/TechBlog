---
layout: post
title: "pytest自动化测试面试篇"
date: 2025-03-14 14:49:08 +0800
description: "api自动化测试"
keywords: "pytest自动化测试[面试篇]"
categories: ['软件测试面试']
tags: ['Pytest']
artid: "146257055"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146257055
    alt: "pytest自动化测试面试篇"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146257055
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146257055
cover: https://bing.ee123.net/img/rand?artid=146257055
image: https://bing.ee123.net/img/rand?artid=146257055
img: https://bing.ee123.net/img/rand?artid=146257055
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     pytest自动化测试[面试篇]
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     pytest是python的测试框架，它提供了许多功能，
    </p>
    <h3>
     <a id="_2">
     </a>
     测试运行
    </h3>
    <p>
     <code>
      组织pytest的测试用例代码
     </code>
     ：模块名称以
     <strong>
      test
     </strong>
     _开头，类名以
     <strong>
      Test
     </strong>
     开头，函数名以
     <strong>
      test
     </strong>
     _开头, 然后用
     <code>
      pytest命令
     </code>
     即可运行测试用例。
    </p>
    <ul>
     <li>
      可以在
      <strong>
       命令行
      </strong>
      中，用pytest命令运行
     </li>
     <li>
      也可以在
      <strong>
       代码
      </strong>
      中，用pytest.main()运行
     </li>
    </ul>
    <h3>
     <a id="api_8">
     </a>
     api自动化测试实现
    </h3>
    <ol>
     <li>
      <strong>
       第一步
      </strong>
      ：通过
      <code>
       代码编写
      </code>
      ，最终需要在测试用例，test_开头的函数中，
      <strong>
       对接口进行请求，然后断言
      </strong>
      。
     </li>
     <li>
      <strong>
       第二步
      </strong>
      ：pytest运行时，就可以批量调接口api， 使用**–aluredir**参数，可以
      <code>
       生成allure的测试报告
      </code>
      。
     </li>
     <li>
      <strong>
       第三步
      </strong>
      ：代码
      <code>
       集成到git和jenkins
      </code>
      中，
      <strong>
       代码最后在jenkins里面，运行pytest命令，allure的测试报告存在Jenkins的workspace中
      </strong>
      。
      <br/>
      再结合
      <code>
       Jenkins的allure插件
      </code>
      可以在Jenkins中，
      <code>
       查看历史测试报告
      </code>
      。 最后可以设置Jenkins的
      <code>
       邮件（钉钉）通知
      </code>
      ，发送报告。
     </li>
    </ol>
    <h4>
     <a id="_14">
     </a>
     具体代码实现
    </h4>
    <ol>
     <li>
      代码目录下有一个
      <strong>
       libs 目录（业务层）
      </strong>
      ， 一个功能模块写成一个py文件。 然后去封装接口，pytest测试用例方法，再调用
      <strong>
       libs层封装方法
      </strong>
      。
     </li>
     <li>
      <code>
       a【各个模块的请求方法、url 集中存在一个yaml文件中】 b【请求参数，预期值，是放到excel中的】
      </code>
      <ul>
       <li>
        <strong>
         业务层的业务类
        </strong>
        继承了BaseApi基类，也是自己封装的，提供了请求方法--------它可以获取到对应模块的接口的 method 和 URL
       </li>
       <li>
        在
        <strong>
         测试用例的类中，每个测试方法
        </strong>
        那里，首先使用xrld获取到excel文件中对应接口的请求参数。使用
        <strong>
         @pytest.mark.parametrize
        </strong>
        把数据传给测试用例，进行数据驱动。
       </li>
      </ul>
     </li>
     <li>
      初始化和身份校验
      <ul>
       <li>
        pytest它支持写初始化和清除的代码，使用@pytest.fixture()装饰器。参数：scope，参数3：autouse
       </li>
       <li>
        用例testcase目录，
        <strong>
         添加conftest.py,
        </strong>
        里面写了整个项目运行前的初始化，进行登录。并且返回了token。 页面类进行实例化时，会传传入token，页面类请求接口时，会自动带上token。
       </li>
       <li>
        我在
        <strong>
         之前公司的实际项目
        </strong>
        中，也是初始化进行了登录，
        <strong>
         然后把token保存到配置
        </strong>
        中-----方式有所不同。
       </li>
      </ul>
     </li>
    </ol>
    <h3>
     <a id="pyest_24">
     </a>
     以上pyest部分未提到的一些用法
    </h3>
    <ol>
     <li>
      测试用例调用初始化方法：
      <ol>
       <li>
        @
        <strong>
         pytest.fixture
        </strong>
        (autouse=True) 、
       </li>
       <li>
        @pytest.mark.usefixtures(“方法名”) 、
       </li>
       <li>
        或直接在test_开头的函数中，直接把
        <code>
         fixture定义的方法名
        </code>
        当成参数传入。
       </li>
      </ol>
     </li>
     <li>
      装饰器
      <strong>
       @pytest.mark.repeat(2)
      </strong>
      可以重复运行测试用例。
     </li>
     <li>
      pytest-assume库提供的，
      <strong>
       pytest.assume()
      </strong>
      断言，如果断言失败，会继续执行，直到全部执行完。
     </li>
     <li>
      测试用例方法上，
      <strong>
       添加@pytest.mark.skipif(True, reason=“跳过原因”)
      </strong>
      ，可以跳过用例。 （或 @pytest.mark.skip）
     </li>
     <li>
      pytest命令运行时，可以添加
      <strong>
       -k 参数
      </strong>
      ，指定某个测试用例py模块，或者测试用例类，或者某个测试用例方法。
     </li>
    </ol>
    <h3>
     <a id="allure_34">
     </a>
     allure测试报告
    </h3>
    <p>
     安装allure-pytest
    </p>
    <ol>
     <li>
      allure.attach() 可以添加更多的日志、截图等。
     </li>
     <li>
      @allure.epic、@allure.feature、@allure.story、@allure.title， 让用例分层。
     </li>
     <li>
      使用with allure.step()，可以添加步骤。 若调用外部方法，也可以使用装饰器@allure.step()，装饰在外部方法上
     </li>
    </ol>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="6874747073:3a2f2f626c6f672e6373646e2e6e65742f4174616f6b65722f:61727469636c652f64657461696c732f313436323537303535" class_="artid" style="display:none">
 </p>
</div>


