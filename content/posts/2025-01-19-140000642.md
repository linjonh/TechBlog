---
layout: post
title: JD-GUIMacOS-中使用Java反编译工具JD-GUI
date: 2025-01-19 13:47:50 +0800
description: "MacOS 中如何安装和使用Java反编译工具JD-"
keywords: jd-gui mac
categories: ['小猿们的开发日常', 'Macos']
tags: ['策略模式', 'Macos', 'Java']
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=140000642
    alt: JD-GUIMacOS-中使用Java反编译工具JD-GUI
artid: 140000642
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=140000642
featuredImagePreview: https://bing.ee123.net/img/rand?artid=140000642
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     【JD-GUI】MacOS 中使用Java反编译工具JD-GUI
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <blockquote>
     <p>
      希望文章能给到你启发和灵感～
      <br/>
      如果觉得文章对你有帮助的话，
      <mark>
       点赞 + 关注+ 收藏
      </mark>
      支持一下博主吧～
     </p>
    </blockquote>
    <p>
    </p>
    <div class="toc">
     <h4>
      阅读指南
     </h4>
     <ul>
      <li>
       <a href="#_5" rel="nofollow">
        开篇说明
       </a>
      </li>
      <li>
       <a href="#_11" rel="nofollow">
        概念理解
       </a>
      </li>
      <li>
       <a href="#_18" rel="nofollow">
        一、基础环境说明
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#11__20" rel="nofollow">
          1.1 硬件环境
         </a>
        </li>
        <li>
         <a href="#12__22" rel="nofollow">
          1.2 软件环境
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a href="#_24" rel="nofollow">
        二、下载与安装
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#21__27" rel="nofollow">
          2.1 选择对应版本
         </a>
        </li>
        <li>
         <a href="#22__31" rel="nofollow">
          2.2 解压运行排除异常：
         </a>
        </li>
        <li>
         <a href="#23__840" rel="nofollow">
          2.3 关于使用
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a href="#_846" rel="nofollow">
        三、最后
       </a>
      </li>
     </ul>
    </div>
    <p>
    </p>
    <h2>
     <a id="_5">
     </a>
     开篇说明
    </h2>
    <blockquote>
     <p>
      现在的反编译软件繁多，Apktool，JD-GUI，dedexer，IDA Pro等等，每种反编译工具都有各自使用的场景，例如Apktool我们在反编译apk类型文件时会用到，JD-GUI则是常用来反编译Java中的class文件，或者Jar等源文件；
     </p>
    </blockquote>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/a482396f6bcf1561855e80b2d9741cf0.png"/>
    </p>
    <h2>
     <a id="_11">
     </a>
     概念理解
    </h2>
    <p>
     【1】什么是反编译？
    </p>
    <blockquote>
     <p>
      简单的说，就是将机器语言转换成我们能看懂的语言，这个过程就叫反编译，例如Java中的class文件反编译后，就能变成我们日常开发写的代码xxx.java文件；
     </p>
    </blockquote>
    <p>
     【2】反编译是否一定能成功?
    </p>
    <blockquote>
     <p>
      不一定，随着现在很多代码编译中都会加入代码混淆，加密，或是加壳等等技术，加大反编译的难度和降低反编译代码的可读性，不过如果想完全避免反编译也是不可能的。只是反编译的还原度的大小问题了；
     </p>
    </blockquote>
    <h2>
     <a id="_18">
     </a>
     一、基础环境说明
    </h2>
    <blockquote>
     <p>
      考虑环境因素，大家适当的对比自己的软硬件环境情况分析～请仔细阅读硬件、软件环境
     </p>
    </blockquote>
    <h3>
     <a id="11__20">
     </a>
     1.1 硬件环境
    </h3>
    <p>
     <code>
      MacOS Monterey 版本 12.6.8 Apple M1
     </code>
    </p>
    <h3>
     <a id="12__22">
     </a>
     1.2 软件环境
    </h3>
    <p>
     JD-GUI版本：
     <code>
      jd-gui-osx-1.6.6
     </code>
    </p>
    <h2>
     <a id="_24">
     </a>
     二、下载与安装
    </h2>
    <blockquote>
     <p>
      Github下载JD-GUI软件
      <a href="" rel="nofollow">
       github java-decompiler/jd-gui Public
      </a>
     </p>
    </blockquote>
    <h3>
     <a id="21__27">
     </a>
     2.1 选择对应版本
    </h3>
    <p>
     macOS系统我们选择
     <code>
      jd-gui-osx-1.6.6.tar
     </code>
     压缩包即可；
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/3ab6a128b28012d52adab8c70e44361f.png"/>
    </p>
    <h3>
     <a id="22__31">
     </a>
     2.2 解压运行排除异常：
    </h3>
    <p>
     解压后，进入文件打开JD-GUI;
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/5ace19e0796ec5ae9555a523685a28d7.png">
      <br/>
      <mark>
       【注】运行时
      </mark>
      ，
      <code>
       需要注意自己环境已经安装了JDK
      </code>
      ，否则你可能会遇到这样的错误：
     </img>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/f509758e325e401f64e93662a2d6f0dc.png">
      <br/>
      若是确认JDK安装后，仍然提示该错误，需要修改文件-&gt;
      <code>
       显示包内容-&gt;Contents-&gt;MacOs-&gt;universalJavaApplicationStub.sh;
      </code>
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/2cac0b2cd5880ef91fd18d415e08442a.png">
       <br/>
       将内容替换成下面的内容：
      </img>
     </img>
    </p>
    <pre><code class="prism language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token comment">##################################################################################</span>
<span class="token comment">#                                                                                #</span>
<span class="token comment"># universalJavaApplicationStub                                                   #</span>
<span class="token comment">#                                                                                #</span>
<span class="token comment"># A BASH based JavaApplicationStub for Java Apps on Mac OS X                     #</span>
<span class="token comment"># that works with both Apple's and Oracle's plist format.                        #</span>
<span class="token comment">#                                                                                #</span>
<span class="token comment"># Inspired by Ian Roberts stackoverflow answer                                   #</span>
<span class="token comment"># at http://stackoverflow.com/a/17546508/1128689                                 #</span>
<span class="token comment">#                                                                                #</span>
<span class="token comment"># @author    Tobias Fischer                                                      #</span>
<span class="token comment"># @url       https://github.com/tofi86/universalJavaApplicationStub              #</span>
<span class="token comment"># @date      2020-03-19                                                          #</span>
<span class="token comment"># @version   3.0.6                                                               #</span>
<span class="token comment">#                                                                                #</span>
<span class="token comment">##################################################################################</span>
<span class="token comment">#                                                                                #</span>
<span class="token comment"># The MIT License (MIT)                                                          #</span>
<span class="token comment">#                                                                                #</span>
<span class="token comment"># Copyright (c) 2014-2020 Tobias Fischer                                         #</span>
<span class="token comment">#                                                                                #</span>
<span class="token comment"># Permission is hereby granted, free of charge, to any person obtaining a copy   #</span>
<span class="token comment"># of this software and associated documentation files (the "Software"), to deal  #</span>
<span class="token comment"># in the Software without restriction, including without limitation the rights   #</span>
<span class="token comment"># to use, copy, modify, merge, publish, distribute, sublicense, and/or sell      #</span>
<span class="token comment"># copies of the Software, and to permit persons to whom the Software is          #</span>
<span class="token comment"># furnished to do so, subject to the following conditions:                       #</span>
<span class="token comment">#                                                                                #</span>
<span class="token comment"># The above copyright notice and this permission notice shall be included in all #</span>
<span class="token comment"># copies or substantial portions of the Software.                                #</span>
<span class="token comment">#                                                                                #</span>
<span class="token comment"># THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR     #</span>
<span class="token comment"># IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,       #</span>
<span class="token comment"># FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE    #</span>
<span class="token comment"># AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER         #</span>
<span class="token comment"># LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,  #</span>
<span class="token comment"># OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE  #</span>
<span class="token comment"># SOFTWARE.                                                                      #</span>
<span class="token comment">#                                                                                #</span>
<span class="token comment">##################################################################################</span>
 
 
 
<span class="token comment"># function 'stub_logger()'</span>
<span class="token comment">#</span>
<span class="token comment"># A logger which logs to the macOS Console.app using the 'syslog' command</span>
<span class="token comment">#</span>
<span class="token comment"># @param1  the log message</span>
<span class="token comment"># @return  void</span>
<span class="token comment">################################################################################</span>
<span class="token keyword">function</span> <span class="token function-name function">stub_logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	syslog <span class="token parameter variable">-s</span> <span class="token parameter variable">-k</span> <span class="token punctuation">\</span>
		Facility com.apple.console <span class="token punctuation">\</span>
		Level Notice <span class="token punctuation">\</span>
		Sender <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">basename</span> <span class="token string">"<span class="token variable">$0</span>"</span><span class="token variable">)</span></span>"</span> <span class="token punctuation">\</span>
		Message <span class="token string">"[<span class="token variable">$$</span>][<span class="token variable">${CFBundleName<span class="token operator">:-</span>$(basename "$0")}</span>] <span class="token variable">$1</span>"</span>
<span class="token punctuation">}</span>
 
 
 
<span class="token comment"># set the directory abspath of the current</span>
<span class="token comment"># shell script with symlinks being resolved</span>
<span class="token comment">############################################</span>
 
<span class="token assign-left variable">PRG</span><span class="token operator">=</span><span class="token variable">$0</span>
<span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token parameter variable">-h</span> <span class="token string">"<span class="token variable">$PRG</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
	<span class="token assign-left variable">ls</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">ls</span> <span class="token parameter variable">-ld</span> <span class="token string">"<span class="token variable">$PRG</span>"</span><span class="token variable">)</span></span>
	<span class="token assign-left variable">link</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">expr</span> <span class="token string">"<span class="token variable">$ls</span>"</span> <span class="token builtin class-name">:</span> <span class="token string">'^.*-&gt; \(.*\)$'</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null<span class="token variable">)</span></span>
	<span class="token keyword">if</span> <span class="token function">expr</span> <span class="token string">"<span class="token variable">$link</span>"</span> <span class="token builtin class-name">:</span> <span class="token string">'^/'</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span> /dev/null <span class="token operator">&gt;</span>/dev/null<span class="token punctuation">;</span> <span class="token keyword">then</span>
		<span class="token assign-left variable">PRG</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$link</span>"</span>
	<span class="token keyword">else</span>
		<span class="token assign-left variable">PRG</span><span class="token operator">=</span><span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">dirname</span> <span class="token string">"<span class="token variable">$PRG</span>"</span><span class="token variable">)</span></span>/<span class="token variable">$link</span>"</span>
	<span class="token keyword">fi</span>
<span class="token keyword">done</span>
<span class="token assign-left variable">PROGDIR</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">dirname</span> <span class="token string">"<span class="token variable">$PRG</span>"</span><span class="token variable">)</span></span>
stub_logger <span class="token string">"[StubDir] <span class="token variable">$PROGDIR</span>"</span>
 
 
 
<span class="token comment"># set files and folders</span>
<span class="token comment">############################################</span>
 
<span class="token comment"># the absolute path of the app package</span>
<span class="token builtin class-name">cd</span> <span class="token string">"<span class="token variable">$PROGDIR</span>"</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/ <span class="token operator">||</span> <span class="token builtin class-name">exit</span> <span class="token number">11</span>
<span class="token assign-left variable">AppPackageFolder</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>
 
<span class="token comment"># the base path of the app package</span>
<span class="token builtin class-name">cd</span> <span class="token punctuation">..</span> <span class="token operator">||</span> <span class="token builtin class-name">exit</span> <span class="token number">12</span>
<span class="token assign-left variable">AppPackageRoot</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>
 
<span class="token comment"># set Apple's Java folder</span>
<span class="token assign-left variable">AppleJavaFolder</span><span class="token operator">=</span><span class="token string">"<span class="token variable">${AppPackageFolder}</span>"</span>/Contents/Resources/Java
 
<span class="token comment"># set Apple's Resources folder</span>
<span class="token assign-left variable">AppleResourcesFolder</span><span class="token operator">=</span><span class="token string">"<span class="token variable">${AppPackageFolder}</span>"</span>/Contents/Resources
 
<span class="token comment"># set Oracle's Java folder</span>
<span class="token assign-left variable">OracleJavaFolder</span><span class="token operator">=</span><span class="token string">"<span class="token variable">${AppPackageFolder}</span>"</span>/Contents/Java
 
<span class="token comment"># set Oracle's Resources folder</span>
<span class="token assign-left variable">OracleResourcesFolder</span><span class="token operator">=</span><span class="token string">"<span class="token variable">${AppPackageFolder}</span>"</span>/Contents/Resources
 
<span class="token comment"># set path to Info.plist in bundle</span>
<span class="token assign-left variable">InfoPlistFile</span><span class="token operator">=</span><span class="token string">"<span class="token variable">${AppPackageFolder}</span>"</span>/Contents/Info.plist
 
<span class="token comment"># set the default JVM Version to a null string</span>
<span class="token assign-left variable">JVMVersion</span><span class="token operator">=</span><span class="token string">""</span>
<span class="token assign-left variable">JVMMaxVersion</span><span class="token operator">=</span><span class="token string">""</span>
 
 
 
<span class="token comment"># function 'plist_get()'</span>
<span class="token comment">#</span>
<span class="token comment"># read a specific Plist key with 'PlistBuddy' utility</span>
<span class="token comment">#</span>
<span class="token comment"># @param1  the Plist key with leading colon ':'</span>
<span class="token comment"># @return  the value as String or Array</span>
<span class="token comment">################################################################################</span>
<span class="token function-name function">plist_get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	/usr/libexec/PlistBuddy <span class="token parameter variable">-c</span> <span class="token string">"print <span class="token variable">$1</span>"</span> <span class="token string">"<span class="token variable">${InfoPlistFile}</span>"</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span> /dev/null
<span class="token punctuation">}</span>
 
<span class="token comment"># function 'plist_get_java()'</span>
<span class="token comment">#</span>
<span class="token comment"># read a specific Plist key with 'PlistBuddy' utility</span>
<span class="token comment"># in the 'Java' or 'JavaX' dictionary (&lt;dict&gt;)</span>
<span class="token comment">#</span>
<span class="token comment"># @param1  the Plist :Java(X):Key with leading colon ':'</span>
<span class="token comment"># @return  the value as String or Array</span>
<span class="token comment">################################################################################</span>
<span class="token function-name function">plist_get_java</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	plist_get <span class="token variable">${JavaKey<span class="token operator">:-</span>"<span class="token operator">:</span>Java"}</span><span class="token variable">$1</span>
<span class="token punctuation">}</span>
 
 
 
<span class="token comment"># read Info.plist and extract JVM options</span>
<span class="token comment">############################################</span>
 
<span class="token comment"># read the program name from CFBundleName</span>
<span class="token assign-left variable">CFBundleName</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>plist_get <span class="token string">':CFBundleName'</span><span class="token variable">)</span></span>
 
<span class="token comment"># read the icon file name</span>
<span class="token assign-left variable">CFBundleIconFile</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>plist_get <span class="token string">':CFBundleIconFile'</span><span class="token variable">)</span></span>
 
 
<span class="token comment"># check Info.plist for Apple style Java keys -&gt; if key :Java is present, parse in apple mode</span>
/usr/libexec/PlistBuddy <span class="token parameter variable">-c</span> <span class="token string">"print :Java"</span> <span class="token string">"<span class="token variable">${InfoPlistFile}</span>"</span> <span class="token operator">&gt;</span> /dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>
<span class="token assign-left variable">exitcode</span><span class="token operator">=</span><span class="token variable">$?</span>
<span class="token assign-left variable">JavaKey</span><span class="token operator">=</span><span class="token string">":Java"</span>
 
<span class="token comment"># if no :Java key is present, check Info.plist for universalJavaApplication style JavaX keys -&gt; if key :JavaX is present, parse in apple mode</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$exitcode</span> <span class="token parameter variable">-ne</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
	/usr/libexec/PlistBuddy <span class="token parameter variable">-c</span> <span class="token string">"print :JavaX"</span> <span class="token string">"<span class="token variable">${InfoPlistFile}</span>"</span> <span class="token operator">&gt;</span> /dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>
	<span class="token assign-left variable">exitcode</span><span class="token operator">=</span><span class="token variable">$?</span>
	<span class="token assign-left variable">JavaKey</span><span class="token operator">=</span><span class="token string">":JavaX"</span>
<span class="token keyword">fi</span>
 
 
<span class="token comment"># read 'Info.plist' file in Apple style if exit code returns 0 (true, ':Java' key is present)</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$exitcode</span> <span class="token parameter variable">-eq</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
	stub_logger <span class="token string">"[PlistStyle] Apple"</span>
 
	<span class="token comment"># set Java and Resources folder</span>
	<span class="token assign-left variable">JavaFolder</span><span class="token operator">=</span><span class="token string">"<span class="token variable">${AppleJavaFolder}</span>"</span>
	<span class="token assign-left variable">ResourcesFolder</span><span class="token operator">=</span><span class="token string">"<span class="token variable">${AppleResourcesFolder}</span>"</span>
 
	<span class="token assign-left variable">APP_PACKAGE</span><span class="token operator">=</span><span class="token string">"<span class="token variable">${AppPackageFolder}</span>"</span>
	<span class="token assign-left variable">JAVAROOT</span><span class="token operator">=</span><span class="token string">"<span class="token variable">${AppleJavaFolder}</span>"</span>
	<span class="token assign-left variable">USER_HOME</span><span class="token operator">=</span><span class="token string">"<span class="token environment constant">$HOME</span>"</span>
 
 
	<span class="token comment"># read the Java WorkingDirectory</span>
	<span class="token assign-left variable">JVMWorkDir</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>plist_get_java <span class="token string">':WorkingDirectory'</span> <span class="token operator">|</span> <span class="token function">xargs</span><span class="token variable">)</span></span>
	<span class="token comment"># set Working Directory based upon PList value</span>
	<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-z</span> <span class="token variable">${JVMWorkDir}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
		<span class="token assign-left variable">WorkingDirectory</span><span class="token operator">=</span><span class="token string">"<span class="token variable">${JVMWorkDir}</span>"</span>
	<span class="token keyword">else</span>
		<span class="token comment"># AppPackageRoot is the standard WorkingDirectory when the script is started</span>
		<span class="token assign-left variable">WorkingDirectory</span><span class="token operator">=</span><span class="token string">"<span class="token variable">${AppPackageRoot}</span>"</span>
	<span class="token keyword">fi</span>
	<span class="token comment"># expand variables $APP_PACKAGE, $JAVAROOT, $USER_HOME</span>
	<span class="token assign-left variable">WorkingDirectory</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">eval</span> <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">${WorkingDirectory}</span>"</span><span class="token variable">)</span></span>
 
 
	<span class="token comment"># read the MainClass name</span>
	<span class="token assign-left variable">JVMMainClass</span><span class="token operator">=</span><span class="token string">"<span class="token variable"><span class="token variable">$(</span>plist_get_java <span class="token string">':MainClass'</span><span class="token variable">)</span></span>"</span>
 
	<span class="token comment"># read the SplashFile name</span>
	<span class="token assign-left variable">JVMSplashFile</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>plist_get_java <span class="token string">':SplashFile'</span><span class="token variable">)</span></span>
 
	<span class="token comment"># read the JVM Properties as an array and retain spaces</span>
	<span class="token assign-left variable"><span class="token environment constant">IFS</span></span><span class="token operator">=</span><span class="token string">$'<span class="token entity" title="\t">\t</span><span class="token entity" title="\n">\n</span>'</span>
	<span class="token assign-left variable">JVMOptions</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable"><span class="token variable">$(</span><span class="token function">xargs</span> <span class="token parameter variable">-n1</span> <span class="token operator">&lt;&lt;&lt;</span><span class="token punctuation">$(</span>plist_get_java <span class="token string">':Properties'</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">" ="</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'s/^ */-D/g'</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token parameter variable">-E</span> <span class="token string">'s/ = (.*)$/="\1"/g'</span><span class="token variable">)</span></span><span class="token punctuation">))</span>
	<span class="token builtin class-name">unset</span> <span class="token environment constant">IFS</span>
	<span class="token comment"># post processing of the array follows further below...</span>
 
	<span class="token comment"># read the ClassPath in either Array or String style</span>
	<span class="token assign-left variable">JVMClassPath_RAW</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>plist_get_java <span class="token string">':ClassPath'</span> <span class="token operator">|</span> <span class="token function">xargs</span><span class="token variable">)</span></span>
	<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$JVMClassPath_RAW</span> <span class="token operator">==</span> *Array* <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">;</span> <span class="token keyword">then</span>
		<span class="token assign-left variable">JVMClassPath</span><span class="token operator">=</span>.<span class="token variable"><span class="token variable">$(</span>plist_get_java <span class="token string">':ClassPath'</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"    "</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'s/^ */:/g'</span> <span class="token operator">|</span> <span class="token function">tr</span> <span class="token parameter variable">-d</span> <span class="token string">'\n'</span> <span class="token operator">|</span> <span class="token function">xargs</span><span class="token variable">)</span></span>
	<span class="token keyword">else</span>
		<span class="token assign-left variable">JVMClassPath</span><span class="token operator">=</span><span class="token variable">${JVMClassPath_RAW}</span>
	<span class="token keyword">fi</span>
	<span class="token comment"># expand variables $APP_PACKAGE, $JAVAROOT, $USER_HOME</span>
	<span class="token assign-left variable">JVMClassPath</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">eval</span> <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">${JVMClassPath}</span>"</span><span class="token variable">)</span></span>
 
	<span class="token comment"># read the JVM Options in either Array or String style</span>
	<span class="token assign-left variable">JVMDefaultOptions_RAW</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>plist_get_java <span class="token string">':VMOptions'</span> <span class="token operator">|</span> <span class="token function">xargs</span><span class="token variable">)</span></span>
	<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$JVMDefaultOptions_RAW</span> <span class="token operator">==</span> *Array* <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">;</span> <span class="token keyword">then</span>
		<span class="token assign-left variable">JVMDefaultOptions</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>plist_get_java <span class="token string">':VMOptions'</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"    "</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'s/^ */ /g'</span> <span class="token operator">|</span> <span class="token function">tr</span> <span class="token parameter variable">-d</span> <span class="token string">'\n'</span> <span class="token operator">|</span> <span class="token function">xargs</span><span class="token variable">)</span></span>
	<span class="token keyword">else</span>
		<span class="token assign-left variable">JVMDefaultOptions</span><span class="token operator">=</span><span class="token variable">${JVMDefaultOptions_RAW}</span>
	<span class="token keyword">fi</span>
 
	<span class="token comment"># read StartOnMainThread and add as -XstartOnFirstThread</span>
	<span class="token assign-left variable">JVMStartOnMainThread</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>plist_get_java <span class="token string">':StartOnMainThread'</span><span class="token variable">)</span></span>
	<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">${JVMStartOnMainThread}</span>"</span> <span class="token operator">==</span> <span class="token string">"true"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
		<span class="token assign-left variable">JVMDefaultOptions</span><span class="token operator">+=</span><span class="token string">" -XstartOnFirstThread"</span>
	<span class="token keyword">fi</span>
 
	<span class="token comment"># read the JVM Arguments in either Array or String style (#76) and retain spaces</span>
	<span class="token assign-left variable"><span class="token environment constant">IFS</span></span><span class="token operator">=</span><span class="token string">$'<span class="token entity" title="\t">\t</span><span class="token entity" title="\n">\n</span>'</span>
	<span class="token assign-left variable">MainArgs_RAW</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>plist_get_java <span class="token string">':Arguments'</span> <span class="token operator">|</span> <span class="token function">xargs</span><span class="token variable">)</span></span>
	<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$MainArgs_RAW</span> <span class="token operator">==</span> *Array* <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">;</span> <span class="token keyword">then</span>
		<span class="token assign-left variable">MainArgs</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable"><span class="token variable">$(</span><span class="token function">xargs</span> <span class="token parameter variable">-n1</span> <span class="token operator">&lt;&lt;&lt;</span><span class="token punctuation">$(</span>plist_get_java <span class="token string">':Arguments'</span> <span class="token operator">|</span> <span class="token function">tr</span> <span class="token parameter variable">-d</span> <span class="token string">'\n'</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token parameter variable">-E</span> <span class="token string">'s/Array \{ *(.*) *\}/\1/g'</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'s/  */ /g'</span><span class="token variable">)</span></span><span class="token punctuation">))</span>
	<span class="token keyword">else</span>
		<span class="token assign-left variable">MainArgs</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable"><span class="token variable">$(</span><span class="token function">xargs</span> <span class="token parameter variable">-n1</span> <span class="token operator">&lt;&lt;&lt;</span><span class="token punctuation">$(</span>plist_get_java <span class="token string">':Arguments'</span><span class="token punctuation">)</span><span class="token variable">)</span></span><span class="token punctuation">)</span>
	<span class="token keyword">fi</span>
	<span class="token builtin class-name">unset</span> <span class="token environment constant">IFS</span>
	<span class="token comment"># post processing of the array follows further below...</span>
 
	<span class="token comment"># read the Java version we want to find</span>
	<span class="token assign-left variable">JVMVersion</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>plist_get_java <span class="token string">':JVMVersion'</span> <span class="token operator">|</span> <span class="token function">xargs</span><span class="token variable">)</span></span>
	<span class="token comment"># post processing of the version string follows below...</span>
 
 
<span class="token comment"># read 'Info.plist</span><span class="token string">' file in Oracle style
else
	stub_logger "[PlistStyle] Oracle"
 
	# set Working Directory and Java and Resources folder
	JavaFolder="${OracleJavaFolder}"
	ResourcesFolder="${OracleResourcesFolder}"
	WorkingDirectory="${OracleJavaFolder}"
 
	APP_ROOT="${AppPackageFolder}"
 
	# read the MainClass name
	JVMMainClass="$(plist_get '</span>:JVMMainClassName<span class="token string">')"
 
	# read the SplashFile name
	JVMSplashFile=$(plist_get '</span>:JVMSplashFile<span class="token string">')
 
	# read the JVM Options as an array and retain spaces
	IFS=$'</span><span class="token punctuation">\</span>t<span class="token punctuation">\</span>n<span class="token string">'
	JVMOptions=($(plist_get '</span>:JVMOptions<span class="token string">' | grep "    " | sed '</span>s/^ *//g<span class="token string">'))
	unset IFS
	# post processing of the array follows further below...
 
	# read the ClassPath in either Array or String style
	JVMClassPath_RAW=$(plist_get '</span>:JVMClassPath<span class="token string">')
	if [[ $JVMClassPath_RAW == *Array* ]] ; then
		JVMClassPath=.$(plist_get '</span>:JVMClassPath<span class="token string">' | grep "    " | sed '</span>s/^ */:/g<span class="token string">' | tr -d '</span><span class="token punctuation">\</span>n<span class="token string">' | xargs)
		# expand variables $APP_PACKAGE, $JAVAROOT, $USER_HOME
		JVMClassPath=$(eval echo "${JVMClassPath}")
 
	elif [[ ! -z ${JVMClassPath_RAW} ]] ; then
		JVMClassPath=${JVMClassPath_RAW}
		# expand variables $APP_PACKAGE, $JAVAROOT, $USER_HOME
		JVMClassPath=$(eval echo "${JVMClassPath}")
 
	else
		#default: fallback to OracleJavaFolder
		JVMClassPath="${JavaFolder}/*"
		# Do NOT expand the default '</span>AppName.app/Contents/Java/*<span class="token string">' classpath (#42)
	fi
 
	# read the JVM Default Options
	JVMDefaultOptions=$(plist_get '</span>:JVMDefaultOptions<span class="token string">' | grep -o " \-.*" | tr -d '</span><span class="token punctuation">\</span>n<span class="token string">' | xargs)
 
	# read the Main Arguments from JVMArguments key as an array and retain spaces (see #46 for naming details)
	IFS=$'</span><span class="token punctuation">\</span>t<span class="token punctuation">\</span>n<span class="token string">'
	MainArgs=($(xargs -n1 &lt;&lt;&lt;$(plist_get '</span>:JVMArguments<span class="token string">' | tr -d '</span><span class="token punctuation">\</span>n<span class="token string">' | sed -E '</span>s/Array <span class="token punctuation">\</span><span class="token punctuation">{<!-- --></span> *<span class="token punctuation">(</span>.*<span class="token punctuation">)</span> *<span class="token punctuation">\</span><span class="token punctuation">}</span>/<span class="token punctuation">\</span><span class="token number">1</span>/g<span class="token string">' | sed '</span>s/  */ /g<span class="token string">')))
	unset IFS
	# post processing of the array follows further below...
 
	# read the Java version we want to find
	JVMVersion=$(plist_get '</span>:JVMVersion<span class="token string">' | xargs)
	# post processing of the version string follows below...
fi
 
 
# (#75) check for undefined icons or icon names without .icns extension and prepare
# an osascript statement for those cases when the icon can be shown in the dialog
DialogWithIcon=""
if [ ! -z ${CFBundleIconFile} ]; then
	if [[ ${CFBundleIconFile} == *.icns ]] &amp;&amp; [[ -f "${ResourcesFolder}/${CFBundleIconFile}" ]] ; then
		DialogWithIcon=" with icon path to resource \"${CFBundleIconFile}\" in bundle (path to me)"
	elif [[ ${CFBundleIconFile} != *.icns ]] &amp;&amp; [[ -f "${ResourcesFolder}/${CFBundleIconFile}.icns" ]] ; then
		CFBundleIconFile+=".icns"
		DialogWithIcon=" with icon path to resource \"${CFBundleIconFile}\" in bundle (path to me)"
	fi
fi
 
 
# JVMVersion: post processing and optional splitting
if [[ ${JVMVersion} == *";"* ]]; then
	minMaxArray=(${JVMVersion//;/ })
	JVMVersion=${minMaxArray[0]//+}
	JVMMaxVersion=${minMaxArray[1]//+}
fi
stub_logger "[JavaRequirement] JVM minimum version: ${JVMVersion}"
stub_logger "[JavaRequirement] JVM maximum version: ${JVMMaxVersion}"
 
# MainArgs: replace occurences of $APP_ROOT with its content
MainArgsArr=()
for i in "${MainArgs[@]}"
do
	MainArgsArr+=("$(eval echo "$i")")
done
 
# JVMOptions: replace occurences of $APP_ROOT with its content
JVMOptionsArr=()
for i in "${JVMOptions[@]}"
do
	JVMOptionsArr+=("$(eval echo "$i")")
done
 
 
# internationalized messages
############################################
 
LANG=$(defaults read -g AppleLocale)
stub_logger "[Language] $LANG"
 
# French localization
if [[ $LANG == fr* ]] ; then
	MSG_ERROR_LAUNCHING="ERREUR au lancement de '</span><span class="token variable">${CFBundleName}</span><span class="token string">'."
	MSG_MISSING_MAINCLASS="'</span>MainClass<span class="token string">' n'</span>est pas spécifié.<span class="token punctuation">\</span>nL<span class="token string">'application Java ne peut pas être lancée."
	MSG_JVMVERSION_REQ_INVALID="La syntaxe de la version de Java demandée est invalide: %s\nVeuillez contacter le développeur de l'</span>application.<span class="token string">"
	MSG_NO_SUITABLE_JAVA="</span>La version de Java installée sur votre système ne convient pas.<span class="token punctuation">\</span>nCe programme nécessite Java %s<span class="token string">"
	MSG_JAVA_VERSION_OR_LATER="</span>ou ultérieur<span class="token string">"
	MSG_JAVA_VERSION_LATEST="</span><span class="token punctuation">(</span>dernière mise à jour<span class="token punctuation">)</span><span class="token string">"
	MSG_JAVA_VERSION_MAX="</span>à %s<span class="token string">"
	MSG_NO_SUITABLE_JAVA_CHECK="</span>Merci de bien vouloir installer la version de Java requise.<span class="token string">"
	MSG_INSTALL_JAVA="</span>Java doit être installé sur votre système.<span class="token punctuation">\</span>nRendez-vous sur java.com et suivez les instructions d<span class="token string">'installation..."
	MSG_LATER="Plus tard"
	MSG_VISIT_JAVA_DOT_COM="Java by Oracle"
	MSG_VISIT_ADOPTOPENJDK="Java by AdoptOpenJDK"
 
# German localization
elif [[ $LANG == de* ]] ; then
	MSG_ERROR_LAUNCHING="FEHLER beim Starten von '</span><span class="token variable">${CFBundleName}</span><span class="token string">'."
	MSG_MISSING_MAINCLASS="Die '</span>MainClass<span class="token string">' ist nicht spezifiziert!\nDie Java-Anwendung kann nicht gestartet werden!"
	MSG_JVMVERSION_REQ_INVALID="Die Syntax der angeforderten Java-Version ist ungültig: %s\nBitte kontaktieren Sie den Entwickler der App."
	MSG_NO_SUITABLE_JAVA="Es wurde keine passende Java-Version auf Ihrem System gefunden!\nDieses Programm benötigt Java %s"
	MSG_JAVA_VERSION_OR_LATER="oder neuer"
	MSG_JAVA_VERSION_LATEST="(neuste Unterversion)"
	MSG_JAVA_VERSION_MAX="bis %s"
	MSG_NO_SUITABLE_JAVA_CHECK="Stellen Sie sicher, dass die angeforderte Java-Version installiert ist."
	MSG_INSTALL_JAVA="Auf Ihrem System muss die '</span>Java<span class="token string">'-Software installiert sein.\nBesuchen Sie java.com für weitere Installationshinweise."
	MSG_LATER="Später"
	MSG_VISIT_JAVA_DOT_COM="Java von Oracle"
	MSG_VISIT_ADOPTOPENJDK="Java von AdoptOpenJDK"
 
# Simplifyed Chinese localization
elif [[ $LANG == zh* ]] ; then
	MSG_ERROR_LAUNCHING="无法启动 '</span><span class="token variable">${CFBundleName}</span><span class="token string">'."
	MSG_MISSING_MAINCLASS="没有指定 '</span>MainClass<span class="token string">'！\nJava程序无法启动!"
	MSG_JVMVERSION_REQ_INVALID="Java版本参数语法错误: %s\n请联系该应用的开发者。"
	MSG_NO_SUITABLE_JAVA="没有在系统中找到合适的Java版本！\n必须安装Java %s才能够使用该程序！"
	MSG_JAVA_VERSION_OR_LATER="及以上版本"
	MSG_JAVA_VERSION_LATEST="（最新版本）"
	MSG_JAVA_VERSION_MAX="最高为 %s"
	MSG_NO_SUITABLE_JAVA_CHECK="请确保系统中安装了所需的Java版本"
	MSG_INSTALL_JAVA="你需要在Mac中安装Java运行环境！\n访问 java.com 了解如何安装。"
	MSG_LATER="稍后"
	MSG_VISIT_JAVA_DOT_COM="Java by Oracle"
	MSG_VISIT_ADOPTOPENJDK="Java by AdoptOpenJDK"
 
# English default localization
else
	MSG_ERROR_LAUNCHING="ERROR launching '</span><span class="token variable">${CFBundleName}</span><span class="token string">'."
	MSG_MISSING_MAINCLASS="'</span>MainClass<span class="token string">' isn'</span>t specified<span class="token operator">!</span><span class="token punctuation">\</span>nJava application cannot be started<span class="token operator">!</span><span class="token string">"
	MSG_JVMVERSION_REQ_INVALID="</span>The syntax of the required Java version is invalid: %s<span class="token punctuation">\</span>nPlease contact the App developer.<span class="token string">"
	MSG_NO_SUITABLE_JAVA="</span>No suitable Java version found on your system<span class="token operator">!</span><span class="token punctuation">\</span>nThis program requires Java %s<span class="token string">"
	MSG_JAVA_VERSION_OR_LATER="</span>or later<span class="token string">"
	MSG_JAVA_VERSION_LATEST="</span><span class="token punctuation">(</span>latest update<span class="token punctuation">)</span><span class="token string">"
	MSG_JAVA_VERSION_MAX="</span>up to %s<span class="token string">"
	MSG_NO_SUITABLE_JAVA_CHECK="</span>Make sure you <span class="token function">install</span> the required Java version.<span class="token string">"
	MSG_INSTALL_JAVA="</span>You need to have JAVA installed on your Mac<span class="token operator">!</span><span class="token punctuation">\</span>nVisit java.com <span class="token keyword">for</span> installation instructions<span class="token punctuation">..</span>.<span class="token string">"
	MSG_LATER="</span>Later<span class="token string">"
	MSG_VISIT_JAVA_DOT_COM="</span>Java by Oracle<span class="token string">"
	MSG_VISIT_ADOPTOPENJDK="</span>Java by AdoptOpenJDK<span class="token string">"
fi
 
 
 
# function 'get_java_version_from_cmd()'
#
# returns Java version string from 'java -version' command
# works for both old (1.8) and new (9) version schema
#
# @param1  path to a java JVM executable
# @return  the Java version number as displayed in 'java -version' command
################################################################################
function get_java_version_from_cmd() {
	# second sed command strips "</span> and <span class="token parameter variable">-ea</span> from the version string
	<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$(</span>"$1<span class="token string">" -version 2&gt;&amp;1 | awk '/version/{print <span class="token variable">$3</span>}' | sed -E 's/"</span>//g<span class="token punctuation">;</span>s/-ea//g'<span class="token variable">)</span></span>
<span class="token punctuation">}</span>
 
 
<span class="token comment"># function 'extract_java_major_version()'</span>
<span class="token comment">#</span>
<span class="token comment"># extract Java major version from a version string</span>
<span class="token comment">#</span>
<span class="token comment"># @param1  a Java version number ('1.8.0_45') or requirement string ('1.8+')</span>
<span class="token comment"># @return  the major version (e.g. '7', '8' or '9', etc.)</span>
<span class="token comment">################################################################################</span>
<span class="token keyword">function</span> <span class="token function-name function">extract_java_major_version</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token parameter variable">-E</span> 's/^1<span class="token punctuation">\</span>.//<span class="token punctuation">;</span>s/^<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span>-9<span class="token punctuation">]</span>+<span class="token punctuation">)</span><span class="token punctuation">(</span>-ea<span class="token operator">|</span><span class="token punctuation">(</span><span class="token punctuation">\</span>.<span class="token punctuation">[</span><span class="token number">0</span>-9_.<span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span><span class="token number">1,7</span><span class="token punctuation">}</span><span class="token punctuation">)</span>?<span class="token variable">)</span></span><span class="token punctuation">(</span>-b<span class="token punctuation">[</span><span class="token number">0</span>-9<span class="token punctuation">]</span>+-<span class="token punctuation">[</span><span class="token number">0</span>-9<span class="token punctuation">]</span>+<span class="token punctuation">)</span>?<span class="token punctuation">[</span>+*<span class="token punctuation">]</span>?$/<span class="token punctuation">\</span><span class="token number">1</span>/<span class="token string">')
}
 
 
# function '</span>get_comparable_java_version<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token string">'
#
# return comparable version for a Java version number or requirement string
#
# @param1  a Java version number ('</span><span class="token number">1.8</span>.0_45<span class="token string">') or requirement string ('</span><span class="token number">1.8</span>+<span class="token string">')
# @return  an 8 digit numeral ('</span><span class="token number">1.8</span>.0_45<span class="token string">'-&gt;'</span>08000045<span class="token string">'; '</span><span class="token number">9.1</span>.13<span class="token string">'-&gt;'</span>09001013<span class="token string">')
################################################################################
function get_comparable_java_version() {
	# cleaning: 1) remove leading '</span><span class="token number">1</span>.<span class="token string">'; 2) remove build string (e.g. '</span>-b14-468<span class="token string">'); 3) remove '</span>a-Z<span class="token string">' and '</span>-*+<span class="token string">' (e.g. '</span>-ea<span class="token string">'); 4) replace '</span>_<span class="token string">' with '</span><span class="token builtin class-name">.</span><span class="token string">'
	local cleaned=$(echo "$1" | sed -E '</span>s/^1<span class="token punctuation">\</span>.//g<span class="token punctuation">;</span>s/-b<span class="token punctuation">[</span><span class="token number">0</span>-9<span class="token punctuation">]</span>+-<span class="token punctuation">[</span><span class="token number">0</span>-9<span class="token punctuation">]</span>+$//g<span class="token punctuation">;</span>s/<span class="token punctuation">[</span>a-zA-Z+*<span class="token punctuation">\</span>-<span class="token punctuation">]</span>//g<span class="token punctuation">;</span>s/_/./g<span class="token string">')
	# splitting at '</span><span class="token builtin class-name">.</span><span class="token string">' into an array
	local arr=( ${cleaned//./ } )
	# echo a string with left padded version numbers
	echo "$(printf '</span>%02s<span class="token string">' ${arr[0]})$(printf '</span>%03s<span class="token string">' ${arr[1]})$(printf '</span>%03s<span class="token string">' ${arr[2]})"
}
 
 
# function '</span>is_valid_requirement_pattern<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token string">'
#
# check whether the Java requirement is a valid requirement pattern
#
# supported requirements are for example:
# - 1.6       requires Java 6 (any update)      [1.6, 1.6.0_45, 1.6.0_88]
# - 1.6*      requires Java 6 (any update)      [1.6, 1.6.0_45, 1.6.0_88]
# - 1.6+      requires Java 6 or higher         [1.6, 1.6.0_45, 1.8, 9, etc.]
# - 1.6.0     requires Java 6 (any update)      [1.6, 1.6.0_45, 1.6.0_88]
# - 1.6.0_45  requires Java 6u45                [1.6.0_45]
# - 1.6.0_45+ requires Java 6u45 or higher      [1.6.0_45, 1.6.0_88, 1.8, etc.]
# - 9         requires Java 9 (any update)      [9.0.*, 9.1, 9.3, etc.]
# - 9*        requires Java 9 (any update)      [9.0.*, 9.1, 9.3, etc.]
# - 9+        requires Java 9 or higher         [9.0, 9.1, 10, etc.]
# - 9.1       requires Java 9.1 (any update)    [9.1.*, 9.1.2, 9.1.13, etc.]
# - 9.1*      requires Java 9.1 (any update)    [9.1.*, 9.1.2, 9.1.13, etc.]
# - 9.1+      requires Java 9.1 or higher       [9.1, 9.2, 10, etc.]
# - 9.1.3     requires Java 9.1.3               [9.1.3]
# - 9.1.3*    requires Java 9.1.3 (any update)  [9.1.3]
# - 9.1.3+    requires Java 9.1.3 or higher     [9.1.3, 9.1.4, 9.2.*, 10, etc.]
# - 10-ea     requires Java 10 (early access release)
#
# unsupported requirement patterns are for example:
# - 1.2, 1.3, 1.9       Java 2, 3 are not supported
# - 1.9                 Java 9 introduced a new versioning scheme
# - 6u45                known versioning syntax, but unsupported
# - 9-ea*, 9-ea+        early access releases paired with */+
# - 9., 9.*, 9.+        version ending with a .
# - 9.1., 9.1.*, 9.1.+  version ending with a .
# - 9.3.5.6             4 part version number is unsupported
#
# @param1  a Java requirement string ('</span><span class="token number">1.8</span>+<span class="token string">')
# @return  boolean exit code: 0 (is valid), 1 (is not valid)
################################################################################
function is_valid_requirement_pattern() {
	local java_req=$1
	java8pattern='</span><span class="token number">1</span><span class="token punctuation">\</span>.<span class="token punctuation">[</span><span class="token number">4</span>-8<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">\</span>.<span class="token punctuation">[</span><span class="token number">0</span>-9<span class="token punctuation">]</span>+<span class="token punctuation">)</span>?<span class="token punctuation">(</span><span class="token punctuation">\</span>.0_<span class="token punctuation">[</span><span class="token number">0</span>-9<span class="token punctuation">]</span>+<span class="token punctuation">)</span>?<span class="token punctuation">[</span>*+<span class="token punctuation">]</span>?<span class="token string">'
	java9pattern='</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token operator">|</span><span class="token number">1</span><span class="token punctuation">[</span><span class="token number">0</span>-9<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span>-ea<span class="token operator">|</span><span class="token punctuation">[</span>*+<span class="token punctuation">]</span><span class="token operator">|</span><span class="token punctuation">(</span><span class="token punctuation">\</span>.<span class="token punctuation">[</span><span class="token number">0</span>-9<span class="token punctuation">]</span>+<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token number">1,2</span><span class="token punctuation">}</span><span class="token punctuation">[</span>*+<span class="token punctuation">]</span>?<span class="token punctuation">)</span>?<span class="token string">'
	# test matches either old Java versioning scheme (up to 1.8) or new scheme (starting with 9)
	if [[ ${java_req} =~ ^(${java8pattern}|${java9pattern})$ ]]; then
		return 0
	else
		return 1
	fi
}
 
 
 
# determine which JVM to use
############################################
 
# default Apple JRE plugin path (&lt; 1.6)
apple_jre_plugin="/Library/Java/Home/bin/java"
apple_jre_version=$(get_java_version_from_cmd "${apple_jre_plugin}")
# default Oracle JRE plugin path (&gt;= 1.7)
oracle_jre_plugin="/Library/Internet Plug-Ins/JavaAppletPlugin.plugin/Contents/Home/bin/java"
oracle_jre_version=$(get_java_version_from_cmd "${oracle_jre_plugin}")
 
 
# first check system variable "$JAVA_HOME" -&gt; has precedence over any other System JVM
stub_logger '</span><span class="token punctuation">[</span>JavaSearch<span class="token punctuation">]</span> Checking <span class="token keyword">for</span> <span class="token variable">$JAVA_HOME</span> <span class="token punctuation">..</span>.<span class="token string">'
if [ -n "$JAVA_HOME" ] ; then
	stub_logger "[JavaSearch] ... found JAVA_HOME with value $JAVA_HOME"
 
	# PR 26: Allow specifying "$JAVA_HOME" relative to "$AppPackageFolder"
	# which allows for bundling a custom version of Java inside your app!
	if [[ $JAVA_HOME == /* ]] ; then
		# if "$JAVA_HOME" starts with a Slash it'</span>s an absolute path
		<span class="token assign-left variable">JAVACMD</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$JAVA_HOME</span>/bin/java"</span>
	<span class="token keyword">else</span>
		<span class="token comment"># otherwise it's a relative path to "$AppPackageFolder</span><span class="token string">"
		JAVACMD="</span><span class="token variable">$AppPackageFolder</span>/<span class="token variable">$JAVA_HOME</span>/bin/java<span class="token string">"
	fi
	JAVACMD_version=<span class="token variable"><span class="token variable">$(</span>get_comparable_java_version <span class="token punctuation">$(</span>get_java_version_from_cmd <span class="token string">"<span class="token variable">${JAVACMD}</span>"</span><span class="token punctuation">)</span><span class="token variable">)</span></span>
else
	stub_logger "</span><span class="token punctuation">[</span>JavaSearch<span class="token punctuation">]</span> <span class="token punctuation">..</span>. didn<span class="token string">'t found JAVA_HOME"
fi
 
 
# check for any other or a specific Java version
# also if $JAVA_HOME exists but isn'</span>t executable
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token string">"<span class="token variable">${JAVACMD}</span>"</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-x</span> <span class="token string">"<span class="token variable">${JAVACMD}</span>"</span> <span class="token punctuation">]</span> <span class="token punctuation">;</span> <span class="token keyword">then</span>
	stub_logger <span class="token string">"[JavaSearch] Checking for JavaVirtualMachines on the system ..."</span>
	<span class="token comment"># reset variables</span>
	<span class="token assign-left variable">JAVACMD</span><span class="token operator">=</span><span class="token string">""</span>
	<span class="token assign-left variable">JAVACMD_version</span><span class="token operator">=</span><span class="token string">""</span>
 
	<span class="token comment"># first check whether JVMVersion string is a valid requirement string</span>
	<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-z</span> <span class="token string">"<span class="token variable">${JVMVersion}</span>"</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span> is_valid_requirement_pattern <span class="token variable">${JVMVersion}</span> <span class="token punctuation">;</span> <span class="token keyword">then</span>
		<span class="token assign-left variable">MSG_JVMVERSION_REQ_INVALID_EXPANDED</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">printf</span> <span class="token string">"<span class="token variable">${MSG_JVMVERSION_REQ_INVALID}</span>"</span> <span class="token string">"<span class="token variable">${JVMVersion}</span>"</span><span class="token variable">)</span></span>
		<span class="token comment"># log exit cause</span>
		stub_logger <span class="token string">"[EXIT 4] <span class="token variable">${MSG_JVMVERSION_REQ_INVALID_EXPANDED}</span>"</span>
		<span class="token comment"># display error message with AppleScript</span>
		osascript <span class="token parameter variable">-e</span> <span class="token string">"tell application <span class="token entity" title='\"'>\"</span>System Events<span class="token entity" title='\"'>\"</span> to display dialog <span class="token entity" title='\"'>\"</span><span class="token variable">${MSG_ERROR_LAUNCHING}</span><span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span><span class="token variable">${MSG_JVMVERSION_REQ_INVALID_EXPANDED}</span><span class="token entity" title='\"'>\"</span> with title <span class="token entity" title='\"'>\"</span><span class="token variable">${CFBundleName}</span><span class="token entity" title='\"'>\"</span> buttons {<!-- --><span class="token entity" title='\"'>\"</span> OK <span class="token entity" title='\"'>\"</span>} default button 1<span class="token variable">${DialogWithIcon}</span>"</span>
		<span class="token comment"># exit with error</span>
		<span class="token builtin class-name">exit</span> <span class="token number">4</span>
	<span class="token keyword">fi</span>
	<span class="token comment"># then check whether JVMMaxVersion string is a valid requirement string</span>
	<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-z</span> <span class="token string">"<span class="token variable">${JVMMaxVersion}</span>"</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span> is_valid_requirement_pattern <span class="token variable">${JVMMaxVersion}</span> <span class="token punctuation">;</span> <span class="token keyword">then</span>
		<span class="token assign-left variable">MSG_JVMVERSION_REQ_INVALID_EXPANDED</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">printf</span> <span class="token string">"<span class="token variable">${MSG_JVMVERSION_REQ_INVALID}</span>"</span> <span class="token string">"<span class="token variable">${JVMMaxVersion}</span>"</span><span class="token variable">)</span></span>
		<span class="token comment"># log exit cause</span>
		stub_logger <span class="token string">"[EXIT 5] <span class="token variable">${MSG_JVMVERSION_REQ_INVALID_EXPANDED}</span>"</span>
		<span class="token comment"># display error message with AppleScript</span>
		osascript <span class="token parameter variable">-e</span> <span class="token string">"tell application <span class="token entity" title='\"'>\"</span>System Events<span class="token entity" title='\"'>\"</span> to display dialog <span class="token entity" title='\"'>\"</span><span class="token variable">${MSG_ERROR_LAUNCHING}</span><span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span><span class="token variable">${MSG_JVMVERSION_REQ_INVALID_EXPANDED}</span><span class="token entity" title='\"'>\"</span> with title <span class="token entity" title='\"'>\"</span><span class="token variable">${CFBundleName}</span><span class="token entity" title='\"'>\"</span> buttons {<!-- --><span class="token entity" title='\"'>\"</span> OK <span class="token entity" title='\"'>\"</span>} default button 1<span class="token variable">${DialogWithIcon}</span>"</span>
		<span class="token comment"># exit with error</span>
		<span class="token builtin class-name">exit</span> <span class="token number">5</span>
	<span class="token keyword">fi</span>
 
 
	<span class="token comment"># find installed JavaVirtualMachines (JDK + JRE)</span>
	<span class="token assign-left variable">allJVMs</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token comment"># read JDK's from '/usr/libexec/java_home -V' command</span>
	<span class="token keyword">while</span> <span class="token builtin class-name">read</span> <span class="token parameter variable">-r</span> line<span class="token punctuation">;</span> <span class="token keyword">do</span>
		<span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> $line <span class="token operator">|</span> <span class="token function">awk</span> <span class="token parameter variable">-F</span> <span class="token string">$','</span> <span class="token string">'{print $1;}'</span><span class="token variable">)</span></span>
		<span class="token assign-left variable">path</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> $line <span class="token operator">|</span> <span class="token function">awk</span> <span class="token parameter variable">-F</span> <span class="token string">$'" '</span> <span class="token string">'{print $2;}'</span><span class="token variable">)</span></span>
		<span class="token assign-left variable">path</span><span class="token operator">+=</span><span class="token string">"/bin/java"</span>
		<span class="token assign-left variable">allJVMs</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token string">"<span class="token variable">$version</span>:<span class="token variable">$path</span>"</span><span class="token punctuation">)</span>
	<span class="token keyword">done</span> <span class="token operator">&lt;</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span>/usr/libexec/java_home <span class="token parameter variable">-V</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">'^[[:space:]]'</span><span class="token punctuation">)</span>
	<span class="token comment"># unset while loop variables</span>
	<span class="token builtin class-name">unset</span> version path
 
	<span class="token comment"># add Apple JRE if available</span>
	<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-x</span> <span class="token string">"<span class="token variable">${apple_jre_plugin}</span>"</span> <span class="token punctuation">]</span> <span class="token punctuation">;</span> <span class="token keyword">then</span>
		<span class="token assign-left variable">allJVMs</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token string">"<span class="token variable">$apple_jre_version</span>:<span class="token variable">$apple_jre_plugin</span>"</span><span class="token punctuation">)</span>
	<span class="token keyword">fi</span>
 
	<span class="token comment"># add Oracle JRE if available</span>
	<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-x</span> <span class="token string">"<span class="token variable">${oracle_jre_plugin}</span>"</span> <span class="token punctuation">]</span> <span class="token punctuation">;</span> <span class="token keyword">then</span>
		<span class="token assign-left variable">allJVMs</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token string">"<span class="token variable">$oracle_jre_version</span>:<span class="token variable">$oracle_jre_plugin</span>"</span><span class="token punctuation">)</span>
	<span class="token keyword">fi</span>
 
	<span class="token comment"># debug output</span>
	<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token string">"<span class="token variable">${allJVMs<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>"</span>
	<span class="token keyword">do</span>
		stub_logger <span class="token string">"[JavaSearch] ... found JVM: <span class="token variable">$i</span>"</span>
	<span class="token keyword">done</span>
 
 
	<span class="token comment"># determine JVMs matching the min/max version requirement</span>
	<span class="token assign-left variable">minC</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>get_comparable_java_version $<span class="token punctuation">{<!-- --></span>JVMVersion<span class="token punctuation">}</span><span class="token variable">)</span></span>
	<span class="token assign-left variable">maxC</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>get_comparable_java_version $<span class="token punctuation">{<!-- --></span>JVMMaxVersion<span class="token punctuation">}</span><span class="token variable">)</span></span>
	<span class="token assign-left variable">matchingJVMs</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 
	<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token string">"<span class="token variable">${allJVMs<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>"</span>
	<span class="token keyword">do</span>
		<span class="token comment"># split JVM string at ':' delimiter to retain spaces in $path substring</span>
		<span class="token assign-left variable"><span class="token environment constant">IFS</span></span><span class="token operator">=</span>: <span class="token assign-left variable">arr</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span> <span class="token punctuation">;</span> <span class="token builtin class-name">unset</span> <span class="token environment constant">IFS</span>
		<span class="token comment"># [0] JVM version number</span>
		<span class="token assign-left variable">ver</span><span class="token operator">=</span><span class="token variable">${arr<span class="token punctuation">[</span>0<span class="token punctuation">]</span>}</span>
		<span class="token comment"># comparable JVM version number</span>
		<span class="token assign-left variable">comp</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>get_comparable_java_version $ver<span class="token variable">)</span></span>
		<span class="token comment"># [1] JVM path</span>
		<span class="token assign-left variable">path</span><span class="token operator">=</span><span class="token string">"<span class="token variable">${arr<span class="token punctuation">[</span>1<span class="token punctuation">]</span>}</span>"</span>
		<span class="token comment"># construct string item for adding to the "matchingJVMs</span><span class="token string">" array
		item="</span><span class="token variable">$comp</span><span class="token builtin class-name">:</span><span class="token variable">$ver</span><span class="token builtin class-name">:</span><span class="token variable">$path</span><span class="token string">"
 
		# pre-requisite: current version number needs to be greater than min version number
		if [ "</span><span class="token variable">$comp</span><span class="token string">" -ge "</span><span class="token variable">$minC</span><span class="token string">" ] ; then
 
			# perform max version checks if max version requirement is present
			if [ ! -z <span class="token variable">${JVMMaxVersion}</span> ] ; then
 
				# max version requirement ends with '*' modifier
				if [[ <span class="token variable">${JVMMaxVersion}</span> == *\* ]] ; then
 
					# use the '*' modifier from the max version string as wildcard for a 'starts with' comparison
					# and check whether the current version number starts with the max version wildcard string
					if [[ <span class="token variable">${ver}</span> == <span class="token variable">${JVMMaxVersion}</span> ]]; then
						matchingJVMs+=("</span><span class="token variable">$item</span><span class="token string">")
 
					# or whether the current comparable version is lower than the comparable max version
					elif [ "</span><span class="token variable">$comp</span><span class="token string">" -le "</span><span class="token variable">$maxC</span><span class="token string">" ] ; then
						matchingJVMs+=("</span><span class="token variable">$item</span><span class="token string">")
					fi
 
				# max version requirement ends with '+' modifier -&gt; always add this version if it's greater than <span class="token variable">$min</span>
				# because a max requirement with + modifier doesn't make sense
				elif [[ <span class="token variable">${JVMMaxVersion}</span> == *+ ]] ; then
					matchingJVMs+=("</span><span class="token variable">$item</span><span class="token string">")
 
				# matches 6 zeros at the end of the max version string (e.g. for 1.8, 9)
				# -&gt; then the max version string should be treated like with a '*' modifier at the end
				#elif [[ <span class="token variable">${maxC}</span> =~ ^[0-9]{2}0{6}$ ]] &amp;&amp; [ "</span><span class="token variable">$comp</span><span class="token string">" -le <span class="token variable"><span class="token variable">$((</span> ${maxC#<span class="token number">0</span>} <span class="token operator">+</span> <span class="token number">999</span> <span class="token variable">))</span></span> ] ; then
				#	matchingJVMs+=("</span><span class="token variable">$item</span><span class="token string">")
 
				# matches 3 zeros at the end of the max version string (e.g. for 9.1, 10.3)
				# -&gt; then the max version string should be treated like with a '*' modifier at the end
				#elif [[ <span class="token variable">${maxC}</span> =~ ^[0-9]{5}0{3}$ ]] &amp;&amp; [ "</span><span class="token variable">$comp</span><span class="token string">" -le "</span><span class="token variable">${maxC}</span><span class="token string">" ] ; then
				#	matchingJVMs+=("</span><span class="token variable">$item</span><span class="token string">")
 
				# matches standard requirements without modifier
				elif [ "</span><span class="token variable">$comp</span><span class="token string">" -le "</span><span class="token variable">$maxC</span><span class="token string">" ]; then
					matchingJVMs+=("</span><span class="token variable">$item</span><span class="token string">")
				fi
 
			# no max version requirement:
 
			# min version requirement ends with '+' modifier
			# -&gt; always add the current version because it's greater than <span class="token variable">$min</span>
			elif [[ <span class="token variable">${JVMVersion}</span> == *+ ]] ; then
				matchingJVMs+=("</span><span class="token variable">$item</span><span class="token string">")
 
			# min version requirement ends with '*' modifier
			# -&gt; use the '*' modifier from the min version string as wildcard for a 'starts with' comparison
			#    and check whether the current version number starts with the min version wildcard string
			elif [[ <span class="token variable">${JVMVersion}</span> == *\* ]] ; then
				if [[ <span class="token variable">${ver}</span> == <span class="token variable">${JVMVersion}</span> ]] ; then
					matchingJVMs+=("</span><span class="token variable">$item</span><span class="token string">")
				fi
 
			# compare the min version against the current version with an additional * wildcard for a 'starts with' comparison
			# -&gt; e.g. add 1.8.0_44 when the requirement is 1.8
			elif [[ <span class="token variable">${ver}</span> == <span class="token variable">${JVMVersion}</span>* ]] ; then
					matchingJVMs+=("</span><span class="token variable">$item</span><span class="token string">")
			fi
		fi
	done
	# unset for loop variables
	unset arr ver comp path item
 
	# debug output
	for i in "</span><span class="token variable">${matchingJVMs<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token string">"
	do
		stub_logger "</span><span class="token punctuation">[</span>JavaSearch<span class="token punctuation">]</span> <span class="token punctuation">..</span>. <span class="token punctuation">..</span>. matches all requirements: <span class="token variable">$i</span><span class="token string">"
	done
 
 
	# sort the matching JavaVirtualMachines by version number
	# https://stackoverflow.com/a/11789688/1128689
	IFS=$'<span class="token entity" title="\n">\n</span>' matchingJVMs=(<span class="token variable"><span class="token variable">$(</span><span class="token function">sort</span> <span class="token parameter variable">-nr</span> <span class="token operator">&lt;&lt;&lt;</span><span class="token string">"<span class="token variable">${matchingJVMs<span class="token punctuation">[</span>*<span class="token punctuation">]</span>}</span>"</span><span class="token variable">)</span></span>)
	unset IFS
 
 
	# get the highest matching JVM
	for <span class="token variable"><span class="token punctuation">((</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ${#matchingJVMs[@]}<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">))</span></span>;
	do
		# split JVM string at ':' delimiter to retain spaces in <span class="token variable">$path</span> substring
		IFS=: arr=(<span class="token variable">${matchingJVMs<span class="token punctuation">[</span>$i<span class="token punctuation">]</span>}</span>) ; unset IFS
		# [0] comparable JVM version number
		comp=<span class="token variable">${arr<span class="token punctuation">[</span>0<span class="token punctuation">]</span>}</span>
		# [1] JVM version number
		ver=<span class="token variable">${arr<span class="token punctuation">[</span>1<span class="token punctuation">]</span>}</span>
		# [2] JVM path
		path="</span><span class="token variable">${arr<span class="token punctuation">[</span>2<span class="token punctuation">]</span>}</span><span class="token string">"
 
		# use current value as JAVACMD if it's executable
		if [ -x "</span><span class="token variable">$path</span><span class="token string">" ] ; then
			JAVACMD="</span><span class="token variable">$path</span><span class="token string">"
			JAVACMD_version=<span class="token variable">$comp</span>
			break
		fi
	done
	# unset for loop variables
	unset arr comp ver path
fi
 
# log the Java Command and the extracted version number
stub_logger "</span><span class="token punctuation">[</span>JavaCommand<span class="token punctuation">]</span> <span class="token string">'$JAVACMD'</span><span class="token string">"
stub_logger "</span><span class="token punctuation">[</span>JavaVersion<span class="token punctuation">]</span> <span class="token variable"><span class="token variable">$(</span>get_java_version_from_cmd <span class="token string">"<span class="token variable">${JAVACMD}</span>"</span><span class="token variable">)</span></span><span class="token variable">${JAVACMD_version<span class="token operator">:+</span> <span class="token operator">/</span> $JAVACMD_version}</span><span class="token string">"
 
 
 
if [ -z "</span><span class="token variable">${JAVACMD}</span><span class="token string">" ] || [ ! -x "</span><span class="token variable">${JAVACMD}</span><span class="token string">" ] ; then
 
	# different error messages when a specific JVM was required
	if [ ! -z "</span><span class="token variable">${JVMVersion}</span><span class="token string">" ] ; then
		# display human readable java version (#28)
		java_version_hr=$(echo <span class="token variable">${JVMVersion}</span> | sed -E 's/^1\.([0-9+*]+)$/ <span class="token entity" title="\1">\1</span>/g' | sed "</span>s/+/ <span class="token variable">${MSG_JAVA_VERSION_OR_LATER}</span>/<span class="token punctuation">;</span>s/*/ <span class="token variable">${MSG_JAVA_VERSION_LATEST}</span>/<span class="token string">")
		MSG_NO_SUITABLE_JAVA_EXPANDED=<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">printf</span> <span class="token string">"<span class="token variable">${MSG_NO_SUITABLE_JAVA}</span>"</span> <span class="token string">"<span class="token variable">${java_version_hr}</span>"</span><span class="token variable">)</span></span>.
 
		if [ ! -z "</span><span class="token variable">${JVMMaxVersion}</span><span class="token string">" ] ; then
			java_version_hr=<span class="token variable"><span class="token variable">$(</span>extract_java_major_version $<span class="token punctuation">{<!-- --></span>JVMVersion<span class="token punctuation">}</span><span class="token variable">)</span></span>
			java_version_max_hr=$(echo <span class="token variable">${JVMMaxVersion}</span> | sed -E 's/^1\.([0-9+*]+)$/ <span class="token entity" title="\1">\1</span>/g' | sed "</span>s/+//<span class="token punctuation">;</span>s/*/ <span class="token variable">${MSG_JAVA_VERSION_LATEST}</span>/<span class="token string">")
			MSG_NO_SUITABLE_JAVA_EXPANDED="</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">printf</span> <span class="token string">"<span class="token variable">${MSG_NO_SUITABLE_JAVA}</span>"</span> <span class="token string">"<span class="token variable">${java_version_hr}</span>"</span><span class="token variable">)</span></span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">printf</span> <span class="token string">"<span class="token variable">${MSG_JAVA_VERSION_MAX}</span>"</span> <span class="token string">"<span class="token variable">${java_version_max_hr}</span>"</span><span class="token variable">)</span></span><span class="token string">"
		fi
 
		# log exit cause
		stub_logger "</span><span class="token punctuation">[</span>EXIT <span class="token number">3</span><span class="token punctuation">]</span> <span class="token variable">${MSG_NO_SUITABLE_JAVA_EXPANDED}</span><span class="token string">"
 
		# display error message with AppleScript
		osascript -e "</span>tell application <span class="token punctuation">\</span>"System Events<span class="token punctuation">\</span>" to display dialog <span class="token punctuation">\</span>"<span class="token variable">${MSG_ERROR_LAUNCHING}</span><span class="token punctuation">\</span>n<span class="token punctuation">\</span>n<span class="token variable">${MSG_NO_SUITABLE_JAVA_EXPANDED}</span><span class="token punctuation">\</span>n<span class="token variable">${MSG_NO_SUITABLE_JAVA_CHECK}</span><span class="token punctuation">\</span>" with title <span class="token punctuation">\</span>"<span class="token variable">${CFBundleName}</span><span class="token punctuation">\</span>"  buttons <span class="token punctuation">{<!-- --></span><span class="token punctuation">\</span>" OK <span class="token punctuation">\</span>", <span class="token punctuation">\</span>"<span class="token variable">${MSG_VISIT_JAVA_DOT_COM}</span><span class="token punctuation">\</span>", <span class="token punctuation">\</span>"<span class="token variable">${MSG_VISIT_ADOPTOPENJDK}</span><span class="token punctuation">\</span>"<span class="token punctuation">}</span> default button <span class="token number">1</span><span class="token variable">${DialogWithIcon}</span><span class="token string">" \
				-e "</span><span class="token builtin class-name">set</span> response to button returned of the result<span class="token string">" \
				-e "</span><span class="token keyword">if</span> response is <span class="token punctuation">\</span>"<span class="token variable">${MSG_VISIT_JAVA_DOT_COM}</span><span class="token punctuation">\</span>" <span class="token keyword">then</span> <span class="token function">open</span> location <span class="token punctuation">\</span>"https://www.java.com/download/<span class="token punctuation">\</span>"<span class="token string">" \
				-e "</span><span class="token keyword">if</span> response is <span class="token punctuation">\</span>"<span class="token variable">${MSG_VISIT_ADOPTOPENJDK}</span><span class="token punctuation">\</span>" <span class="token keyword">then</span> <span class="token function">open</span> location <span class="token punctuation">\</span>"https://adoptopenjdk.net/releases.html<span class="token punctuation">\</span>"<span class="token string">"
		# exit with error
		exit 3
 
	else
		# log exit cause
		stub_logger "</span><span class="token punctuation">[</span>EXIT <span class="token number">1</span><span class="token punctuation">]</span> <span class="token variable">${MSG_ERROR_LAUNCHING}</span><span class="token string">"
		# display error message with AppleScript
		osascript -e "</span>tell application <span class="token punctuation">\</span>"System Events<span class="token punctuation">\</span>" to display dialog <span class="token punctuation">\</span>"<span class="token variable">${MSG_ERROR_LAUNCHING}</span><span class="token punctuation">\</span>n<span class="token punctuation">\</span>n<span class="token variable">${MSG_INSTALL_JAVA}</span><span class="token punctuation">\</span>" with title <span class="token punctuation">\</span>"<span class="token variable">${CFBundleName}</span><span class="token punctuation">\</span>" buttons <span class="token punctuation">{<!-- --></span><span class="token punctuation">\</span>"<span class="token variable">${MSG_LATER}</span><span class="token punctuation">\</span>", <span class="token punctuation">\</span>"<span class="token variable">${MSG_VISIT_JAVA_DOT_COM}</span><span class="token punctuation">\</span>", <span class="token punctuation">\</span>"<span class="token variable">${MSG_VISIT_ADOPTOPENJDK}</span><span class="token punctuation">\</span>"<span class="token punctuation">}</span> default button <span class="token number">1</span><span class="token variable">${DialogWithIcon}</span><span class="token string">" \
					-e "</span><span class="token builtin class-name">set</span> response to button returned of the result<span class="token string">" \
					-e "</span><span class="token keyword">if</span> response is <span class="token punctuation">\</span>"<span class="token variable">${MSG_VISIT_JAVA_DOT_COM}</span><span class="token punctuation">\</span>" <span class="token keyword">then</span> <span class="token function">open</span> location <span class="token punctuation">\</span>"https://www.java.com/download/<span class="token punctuation">\</span>"<span class="token string">" \
					-e "</span><span class="token keyword">if</span> response is <span class="token punctuation">\</span>"<span class="token variable">${MSG_VISIT_ADOPTOPENJDK}</span><span class="token punctuation">\</span>" <span class="token keyword">then</span> <span class="token function">open</span> location <span class="token punctuation">\</span>"https://adoptopenjdk.net/releases.html<span class="token punctuation">\</span>"<span class="token string">"
		# exit with error
		exit 1
	fi
fi
 
 
 
# MainClass check
############################################
 
if [ -z "</span><span class="token variable">${JVMMainClass}</span><span class="token string">" ]; then
	# log exit cause
	stub_logger "</span><span class="token punctuation">[</span>EXIT <span class="token number">2</span><span class="token punctuation">]</span> <span class="token variable">${MSG_MISSING_MAINCLASS}</span><span class="token string">"
	# display error message with AppleScript
	osascript -e "</span>tell application <span class="token punctuation">\</span>"System Events<span class="token punctuation">\</span>" to display dialog <span class="token punctuation">\</span>"<span class="token variable">${MSG_ERROR_LAUNCHING}</span><span class="token punctuation">\</span>n<span class="token punctuation">\</span>n<span class="token variable">${MSG_MISSING_MAINCLASS}</span><span class="token punctuation">\</span>" with title <span class="token punctuation">\</span>"<span class="token variable">${CFBundleName}</span><span class="token punctuation">\</span>" buttons <span class="token punctuation">{<!-- --></span><span class="token punctuation">\</span>" OK <span class="token punctuation">\</span>"<span class="token punctuation">}</span> default button <span class="token number">1</span><span class="token variable">${DialogWithIcon}</span><span class="token string">"
	# exit with error
	exit 2
fi
 
 
 
# execute <span class="token variable">$JAVACMD</span> and do some preparation
############################################
 
# enable drag&amp;drop to the dock icon
export CFProcessPath="</span><span class="token variable">$0</span><span class="token string">"
 
# remove Apples ProcessSerialNumber from passthru arguments (#39)
if [[ "</span><span class="token variable">$*</span><span class="token string">" == -psn* ]] ; then
	ArgsPassthru=()
else
	ArgsPassthru=("</span><span class="token variable">$@</span><span class="token string">")
fi
 
# change to Working Directory based upon Apple/Oracle Plist info
cd "</span><span class="token variable">${WorkingDirectory}</span><span class="token string">" || exit 13
stub_logger "</span><span class="token punctuation">[</span>WorkingDirectory<span class="token punctuation">]</span> <span class="token variable">${WorkingDirectory}</span><span class="token string">"
 
# execute Java and set
# - classpath
# - splash image
# - dock icon
# - app name
# - JVM options / properties (-D)
# - JVM default options (-X)
# - main class
# - main class arguments
# - passthrough arguments from Terminal or Drag'n'Drop to Finder icon
stub_logger "</span><span class="token punctuation">[</span>Exec<span class="token punctuation">]</span> <span class="token punctuation">\</span>"<span class="token variable">$JAVACMD</span><span class="token punctuation">\</span>" <span class="token parameter variable">-cp</span> <span class="token punctuation">\</span>"<span class="token variable">${JVMClassPath}</span><span class="token punctuation">\</span>" -splash:<span class="token punctuation">\</span>"<span class="token variable">${ResourcesFolder}</span>/<span class="token variable">${JVMSplashFile}</span><span class="token punctuation">\</span>" <span class="token parameter variable">-Xdock:icon</span><span class="token operator">=</span><span class="token punctuation">\</span>"<span class="token variable">${ResourcesFolder}</span>/<span class="token variable">${CFBundleIconFile}</span><span class="token punctuation">\</span>" <span class="token parameter variable">-Xdock:name</span><span class="token operator">=</span><span class="token punctuation">\</span>"<span class="token variable">${CFBundleName}</span><span class="token punctuation">\</span>" <span class="token variable">${JVMOptionsArr<span class="token operator">:+</span>$(printf "'<span class="token operator">%</span>s' " "${JVMOptionsArr<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>"<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token variable">${JVMDefaultOptions<span class="token operator">:+</span>$JVMDefaultOptions }</span><span class="token variable">${JVMMainClass}</span><span class="token variable">${MainArgsArr<span class="token operator">:+</span> $(printf "'<span class="token operator">%</span>s' " "${MainArgsArr<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>"<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token variable">${ArgsPassthru<span class="token operator">:+</span> $(printf "'<span class="token operator">%</span>s' " "${ArgsPassthru<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>"<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token string">"
exec "</span><span class="token variable">${JAVACMD}</span><span class="token string">" \
		-cp "</span><span class="token variable">${JVMClassPath}</span><span class="token string">" \
		-splash:"</span><span class="token variable">${ResourcesFolder}</span>/<span class="token variable">${JVMSplashFile}</span><span class="token string">" \
		-Xdock:icon="</span><span class="token variable">${ResourcesFolder}</span>/<span class="token variable">${CFBundleIconFile}</span><span class="token string">" \
		-Xdock:name="</span><span class="token variable">${CFBundleName}</span><span class="token string">" \
		${JVMOptionsArr:+"</span><span class="token variable">${JVMOptionsArr<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token string">" }\
		<span class="token variable">${JVMDefaultOptions<span class="token operator">:+</span>$JVMDefaultOptions }</span>\
		"</span><span class="token variable">${JVMMainClass}</span><span class="token string">"\
		${MainArgsArr:+ "</span><span class="token variable">${MainArgsArr<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token string">"}\
		${ArgsPassthru:+ "</span><span class="token variable">${ArgsPassthru<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>"<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="23__840">
     </a>
     2.3 关于使用
    </h3>
    <p>
     打开软件，选择自己要反编译的文件即可；
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/68823cda57fa86d0aae0889c3cfe9d87.png">
      <br/>
      确认文件打开之后，我们就能看到反编译的源代码了；
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/a445ace42a586f70ffa79d2c4473d749.png"/>
     </img>
    </p>
    <h2>
     <a id="_846">
     </a>
     三、最后
    </h2>
    <blockquote>
     <p>
      Windows的宝子们，方法上大同小异的，除了下载包区分一下，其他基本一致的问题；
     </p>
    </blockquote>
   </div>
   <link href="./../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="./../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f33393631313231322f:61727469636c652f64657461696c732f313430303030363432" class_="artid" style="display:none">
 </p>
</div>


