---
layout: post
title: "信息收集网络空间测绘FOFA,查询语法最全使用方法图文解析"
date: 2024-12-29 08:15:00 +0800
description: "官网描述：FOFA－网络空间资产搜索引擎是华顺信安推出的一款通过对全球网络对外开放服务的资产进行主动"
keywords: "fofa"
categories: ['未分类']
tags: ['网络安全']
artid: "140688629"
image:
  path: https://api.vvhan.com/api/bing?rand=sj&artid=140688629
  alt: "信息收集网络空间测绘FOFA,查询语法最全使用方法图文解析"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=140688629
featuredImagePreview: https://bing.ee123.net/img/rand?artid=140688629
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     信息收集：网络空间测绘FOFA，查询语法最全使用方法（图文解析）
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h2>
     前言
    </h2>
    <p>
     经小绿书粉丝投稿，特意搜集了一些fofa的使用教程和一些高级用法
    </p>
    <p>
    </p>
    <p class="img-center">
     <img alt="image-20240723211326162" height="96" src="https://i-blog.csdnimg.cn/blog_migrate/2c85e699247deb7f8e3748a943be5e62.png" width="288"/>
    </p>
    <h3>
     什么是FOFA？
    </h3>
    <blockquote>
     <p>
      官网描述：FOFA－网络空间资产搜索引擎是华顺信安推出的一款通过对全球网络对外开放服务的资产进行主动或被动方式探测、抓取、存储，分析整理不同种类的网络空间资产指纹信息（规则），并对符合规则的资产进行统计分析，进而快速检索全球网络空间资产的产品。
     </p>
     <p>
      它能够帮助用户迅速进行网络资产匹配，快速开展网络空间威胁态势感知、漏洞影响范围分析、应用分布统计、应用流行度排名统计等工作。
     </p>
    </blockquote>
    <h3>
     查询语法表
    </h3>
    <h4>
     高级搜索
    </h4>
    <table>
     <thead>
      <tr>
       <th>
        逻辑连接符
       </th>
       <th>
        具体含义
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        =
       </td>
       <td>
        匹配，=""时，可查询不存在字段或者值为空的情况。
       </td>
      </tr>
      <tr>
       <td>
        ==
       </td>
       <td>
        完全匹配，==""时，可查询存在且值为空的情况。
       </td>
      </tr>
      <tr>
       <td>
        &amp;&amp;
       </td>
       <td>
        与
       </td>
      </tr>
      <tr>
       <td>
        ||
       </td>
       <td>
        或
       </td>
      </tr>
      <tr>
       <td>
        !=
       </td>
       <td>
        不匹配，!=""时，可查询值不为空的情况。
       </td>
      </tr>
      <tr>
       <td>
        *=
       </td>
       <td>
        模糊匹配，使用
        <em>
         或者?进行搜索，比如banner
        </em>
        ="mys??" (个人版及以上可用)。
       </td>
      </tr>
      <tr>
       <td>
        ()
       </td>
       <td>
        确认查询优先级，括号内容优先级最高。
       </td>
      </tr>
     </tbody>
    </table>
    <p>
    </p>
    <h4>
     基础类别
    </h4>
    <p>
    </p>
    <p class="img-center">
     <img alt="image-20240725012102362" height="43" src="https://i-blog.csdnimg.cn/blog_migrate/f5ddc992c3b7d5a8b5a131ffdd4fc09f.png" width="860"/>
    </p>
    <p>
    </p>
    <p class="img-center">
     <img alt="image-20240725011857819" height="564" src="https://i-blog.csdnimg.cn/blog_migrate/a3cee40ce7f1983eaba421ef63d3b59b.png" width="870"/>
    </p>
    <p>
    </p>
    <p class="img-center">
     <img alt="image-20240725011909892" height="86" src="https://i-blog.csdnimg.cn/blog_migrate/721971d783b853538eb8e8bc074188e9.png" width="876"/>
    </p>
    <h4>
     标记类（Special Label）
    </h4>
    <p>
    </p>
    <p class="img-center">
     <img alt="image-20240725011941218" height="563" src="https://i-blog.csdnimg.cn/blog_migrate/91981cab107d52ca39b356b2a496aa06.png" width="870"/>
    </p>
    <p>
    </p>
    <p class="img-center">
     <img alt="image-20240725011953012" height="107" src="https://i-blog.csdnimg.cn/blog_migrate/9854641e654eed0ffe627cb95e49aea8.png" width="872"/>
    </p>
    <h4>
     协议类 （type=service)
    </h4>
    <p>
    </p>
    <p class="img-center">
     <img alt="image-20240725012028072" height="226" src="https://i-blog.csdnimg.cn/blog_migrate/7746fa9b2e96f2e39fac82ea1223e730.png" width="880"/>
    </p>
    <h4>
     网站类（type=subdomain）
    </h4>
    <p>
    </p>
    <p class="img-center">
     <img alt="image-20240725012137305" height="407" src="https://i-blog.csdnimg.cn/blog_migrate/3fe6791979f605635e21ecd7cb1e1295.png" width="861"/>
    </p>
    <p>
    </p>
    <p class="img-center">
     <img alt="image-20240725012149232" height="356" src="https://i-blog.csdnimg.cn/blog_migrate/cc1a55db3c9aae67f0dd2b142bfaea24.png" width="873"/>
    </p>
    <h4>
     证书类
    </h4>
    <p>
    </p>
    <p class="img-center">
     <img alt="image-20240725012255872" height="437" src="https://i-blog.csdnimg.cn/blog_migrate/7f532d582c8d2d1857a65146c4ba1325.png" width="870"/>
    </p>
    <p>
    </p>
    <p class="img-center">
     <img alt="image-20240725012316250" height="441" src="https://i-blog.csdnimg.cn/blog_migrate/bb9ad768a07d098a395fe7d2c30c3ab7.png" width="874"/>
    </p>
    <p class="img-center">
     <img alt="image-20240725012327244" height="115" src="https://i-blog.csdnimg.cn/blog_migrate/5a0d28afea7c3df0d513ef18011c7705.png" width="880"/>
    </p>
    <h4>
     地理位置（Location）
    </h4>
    <p class="img-center">
     <img alt="image-20240725012343975" height="300" src="https://i-blog.csdnimg.cn/blog_migrate/6e20cf8acf82f8baf75ee0f241ca4a89.png" width="874"/>
    </p>
    <h4>
     时间类（Last update time）
    </h4>
    <p class="img-center">
     <img alt="image-20240725012444068" height="212" src="https://i-blog.csdnimg.cn/blog_migrate/d5e03417b74c1bb29e260da8c24b9ed5.png" width="875"/>
    </p>
    <h4>
     独立IP语法（独立IP系列语法，不可和上面其他语法共用）
    </h4>
    <p class="img-center">
     <img alt="image-20240725013333692" height="525" src="https://i-blog.csdnimg.cn/blog_migrate/d14cad10f58246133f99c1d8cba60007.png" width="872"/>
    </p>
    <h4>
     查询基础语法案例
    </h4>
    <p>
     直接输入查询语句，将从标题，
     <code>
      html内容
     </code>
     ，
     <code>
      http头信息
     </code>
     ，
     <code>
      url字段
     </code>
     中搜索；
    </p>
    <h4>
     html搜索
    </h4>
    <p>
     我们找到某云的登录提示，因为
     <u>
      文字在网页中皆属于html
     </u>
    </p>
    <p class="img-center">
     <img alt="image-20240723223704731" height="648" src="https://i-blog.csdnimg.cn/blog_migrate/4931d3f59cb8d80d61ac58e186ad6126.png" width="1093"/>
    </p>
    <p>
     复制在fofa查询即可，发现还有其他的网站使用了关联的内容
    </p>
    <p class="img-center">
     <img alt="image-20240723230405508" height="707" src="https://i-blog.csdnimg.cn/blog_migrate/a684e6a0925db8a7a9ee71215825fe06.png" width="1200"/>
    </p>
    <p>
     那么我们可以对国家进行筛选
    </p>
    <p class="img-center">
     <img alt="image-20240723230615840" height="681" src="https://i-blog.csdnimg.cn/blog_migrate/0287b570ba1857926c9a05b278f5f1be.png" width="1200"/>
    </p>
    <p>
     此时即可缩小查找的范围
    </p>
    <p class="img-center">
     <img alt="image-20240723230746127" height="834" src="https://i-blog.csdnimg.cn/blog_migrate/8dad526d2c7703cc945623ef5403f563.png" width="1200"/>
    </p>
    <p>
     既然是html，那么我们这样搜索呢
    </p>
    <p class="img-center">
     <img alt="image-20240723231111938" height="696" src="https://i-blog.csdnimg.cn/blog_migrate/024a881cc0d01a31ccf133bdb1ea8ef8.png" width="1200"/>
    </p>
    <h4>
     title标题搜索
    </h4>
    <p class="img-center">
     <img alt="image-20240723223602510" height="690" src="https://i-blog.csdnimg.cn/blog_migrate/4a82e9ad95ed3b4ea2ee2935b005d185.png" width="1111"/>
    </p>
    <h4>
     domain域名搜索
    </h4>
    <p class="img-center">
     <img alt="image-20240723231356676" height="748" src="https://i-blog.csdnimg.cn/blog_migrate/9e6050723d7b36bfde49598a726e1e87.png" width="1200"/>
    </p>
    <p>
     如果查询表达式有多个与或关系，尽量在外面用
     <code>
      ()
     </code>
     包含起来，比如这样。
    </p>
    <p>
    </p>
    <p class="img-center">
     <img alt="image-20240723231426610" height="77" src="https://i-blog.csdnimg.cn/blog_migrate/2a1b2bc7fbabe57465c2b1b3c1fea736.png" width="523"/>
    </p>
    <p class="img-center">
     <img alt="image-20240723211549593" height="824" src="https://i-blog.csdnimg.cn/blog_migrate/d72ca502bfd740bdb66ffcfed1a1ba51.png" width="1200"/>
    </p>
    <h4>
     host主机名搜索
    </h4>
    <p>
     host="主机名"
    </p>
    <p class="img-center">
     <img alt="image-20240724195013467" height="663" src="https://i-blog.csdnimg.cn/blog_migrate/31a6fef64f37c23d12674e85d4b7f29f.png" width="1200"/>
    </p>
    <h4>
     os操作系统搜索
    </h4>
    <p>
     os="操作系统"
    </p>
    <p class="img-center">
     <img alt="image-20240724195505811" height="777" src="https://i-blog.csdnimg.cn/blog_migrate/300e23ca2521bfcfcbcfdc40addd1517.png" width="1200"/>
    </p>
    <h4>
     server服务器查询
    </h4>
    <p>
     server="nginx"通过服务器进行查询
    </p>
    <p class="img-center">
     <img alt="image-20240724200229742" height="783" src="https://i-blog.csdnimg.cn/blog_migrate/5a06c648ac16380aa98f687bd456cf9e.png" width="1200"/>
    </p>
    <h4>
     org所属组织
    </h4>
    <p class="img-center">
     <img alt="image-20240724200022284" height="684" src="https://i-blog.csdnimg.cn/blog_migrate/b0370613d77ef63da929ef20fe002f4e.png" width="1200"/>
    </p>
    <h4>
     body搜索内容
    </h4>
    <p>
     通过HTML正文进行查询
    </p>
    <p>
    </p>
    <p class="img-center">
     <img alt="image-20240724202003639" height="161" src="https://i-blog.csdnimg.cn/blog_migrate/e454810fe8b5d84685c42d27f643f92f.png" width="746"/>
    </p>
    <p>
    </p>
    <p class="img-center">
     <img alt="image-20240724202019201" height="518" src="https://i-blog.csdnimg.cn/blog_migrate/002baa81f25c8ff1c9c5197c10498cdf.png" width="1200"/>
    </p>
    <h4>
     js_name
    </h4>
    <p>
     通过HTML正文中js进行查询
    </p>
    <p class="img-center">
     <img alt="image-20240725001121447" height="845" src="https://i-blog.csdnimg.cn/blog_migrate/c6403bd60384d929dd820ac60d661dcb.png" width="1200"/>
    </p>
    <h5>
     header
    </h5>
    <p>
     header="thinkphp"
    </p>
    <p class="img-center">
     <img alt="image-20240725001850709" height="730" src="https://i-blog.csdnimg.cn/blog_migrate/f2996bc7d9f6d45aa1c424289f7b4327.png" width="1200"/>
    </p>
    <h5>
     port
    </h5>
    <p>
     port="3306"，找mysql的端口地址
    </p>
    <p class="img-center">
     <img alt="image-20240725003601617" height="836" src="https://i-blog.csdnimg.cn/blog_migrate/6f44bdd5ea7eb1e771e3e8bbc3dfedfe.png" width="1200"/>
    </p>
    <h4>
     icp
    </h4>
    <p>
     icp="备案号"
    </p>
    <hr/>
    <h5>
     status_code
    </h5>
    <p>
     status_code="服务器状态码"
    </p>
    <p class="img-center">
     <img alt="image-20240725004341624" height="819" src="https://i-blog.csdnimg.cn/blog_migrate/ae092cdb160aeedf46eeb54e2ffdfc3b.png" width="1200"/>
    </p>
    <h5>
     protocol
    </h5>
    <p>
     protocol="协议类型" ，例如https/ssh/http
    </p>
    <p class="img-center">
     <img alt="image-20240725004526645" height="859" src="https://i-blog.csdnimg.cn/blog_migrate/23f753f69f04ecb293c79030927b2243.png" width="1200"/>
    </p>
    <h5>
     country
    </h5>
    <p>
     country="国家编码"
    </p>
    <p class="img-center">
     <img alt="image-20240725004636636" height="601" src="https://i-blog.csdnimg.cn/blog_migrate/322965a0defc6807d949f8ebe4203b5c.png" width="1200"/>
    </p>
    <h5>
     region
    </h5>
    <p>
     region=“行政区” ，英文名称即可
    </p>
    <p class="img-center">
     <img alt="image-20240725004753434" height="858" src="https://i-blog.csdnimg.cn/blog_migrate/46485db5f8f6c452ccc86f74d038ac0b.png" width="1200"/>
    </p>
    <h5>
     city
    </h5>
    <p>
     city=“城市”
    </p>
    <p class="img-center">
     <img alt="image-20240725004847385" height="780" src="https://i-blog.csdnimg.cn/blog_migrate/2bfc88fe3498b01dd6771d60e4ac9ba3.png" width="1200"/>
    </p>
    <h5>
     app
    </h5>
    <p>
     app="设备"
    </p>
    <p class="img-center">
     <img alt="image-20240725005003358" height="748" src="https://i-blog.csdnimg.cn/blog_migrate/2f8edf999c50fc43374ba381d495df84.png" width="1200"/>
    </p>
    <p>
    </p>
    <p>
    </p>
   </div>
  </div>
  <div class="blog-extension-box" id="blogExtensionBox" style="width:400px;margin:auto;margin-top:12px">
  </div>
 </article>
 <p alt="68747470733a:2f2f626c6f672e6373646e2e6e65742f78743335303438382f:61727469636c652f64657461696c732f313430363838363239" class_="artid" style="display:none">
 </p>
</div>
