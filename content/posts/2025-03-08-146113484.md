---
layout: post
title: "快速使用PPASR-V3版不能语音识别框架"
date: 2025-03-08 11:40:51 +0800
description: "主要介绍如何快速使用PPASR语音识别框架训练和推理，该框架支持多个语音识别模型，包含deepspeech2、conformer、squeezeformer、efficient_conformer等，每个模型都支持流式识别和非流式识别，以及多种解码器，包含ctc_greedy_search、ctc_prefix_beam_search、attention_rescoring、ctc_beam_search等"
keywords: "快速使用PPASR V3版不能语音识别框架"
categories: ['语音', '深度学习', 'Paddlepaddle']
tags: ['语音识别', '人工智能', 'Paddlepaddle']
artid: "146113484"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146113484
    alt: "快速使用PPASR-V3版不能语音识别框架"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146113484
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146113484
cover: https://bing.ee123.net/img/rand?artid=146113484
image: https://bing.ee123.net/img/rand?artid=146113484
img: https://bing.ee123.net/img/rand?artid=146113484
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     快速使用PPASR V3版不能语音识别框架
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="_1">
     </a>
     前言
    </h2>
    <p>
     本文章主要介绍如何快速使用PPASR语音识别框架训练和推理，本文将致力于最简单的方式去介绍使用，如果使用更进阶功能，还需要从源码去看文档。仅需三行代码即可实现训练和推理。
    </p>
    <p>
     <strong>
      源码地址：
      <a href="https://github.com/yeyupiaoling/PPASR">
       https://github.com/yeyupiaoling/PPASR
      </a>
     </strong>
    </p>
    <h2>
     <a id="_5">
     </a>
     安装环境
    </h2>
    <p>
     使用Anaconda，并创建了Python3.11的虚拟环境。
    </p>
    <ul>
     <li>
      首先安装的是PaddlePaddle 2.6.2 的GPU版本，如果已经安装过了，请跳过。
     </li>
    </ul>
    <pre><code class="prism language-shell">conda <span class="token function">install</span> paddlepaddle-gpu<span class="token operator">==</span><span class="token number">2.6</span>.2 <span class="token assign-left variable">cudatoolkit</span><span class="token operator">=</span><span class="token number">11.7</span> <span class="token parameter variable">-c</span> https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/Paddle/ <span class="token parameter variable">-c</span> conda-forge
</code></pre>
    <ul>
     <li>
      使用pip安装PPASR库，命令如下：
     </li>
    </ul>
    <pre><code class="prism language-shell">python <span class="token parameter variable">-m</span> pip <span class="token function">install</span> ppasr <span class="token parameter variable">-U</span> <span class="token parameter variable">-i</span> https://pypi.tuna.tsinghua.edu.cn/simple
</code></pre>
    <h2>
     <a id="_19">
     </a>
     准备数据集
    </h2>
    <p>
     执行下面代码即可自动完成下载数据，和制作数据列表。默认下载可能会比较慢，可以复制下载地址用迅雷等工具下载，并指定
     <code>
      filepath
     </code>
     为下载好的文件路径，可以快速完成制作数据列表。
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> argparse
<span class="token keyword">import</span> os
<span class="token keyword">import</span> functools
<span class="token keyword">from</span> utility <span class="token keyword">import</span> download<span class="token punctuation">,</span> unpack
<span class="token keyword">from</span> utility <span class="token keyword">import</span> add_arguments<span class="token punctuation">,</span> print_arguments

DATA_URL <span class="token operator">=</span> <span class="token string">'https://openslr.trmal.net/resources/33/data_aishell.tgz'</span>
MD5_DATA <span class="token operator">=</span> <span class="token string">'2f494334227864a8a8fec932999db9d8'</span>

parser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span>description<span class="token operator">=</span>__doc__<span class="token punctuation">)</span>
add_arg <span class="token operator">=</span> functools<span class="token punctuation">.</span>partial<span class="token punctuation">(</span>add_arguments<span class="token punctuation">,</span> argparser<span class="token operator">=</span>parser<span class="token punctuation">)</span>
add_arg<span class="token punctuation">(</span><span class="token string">"target_dir"</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">"dataset/audio/"</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">"存放音频文件的目录"</span><span class="token punctuation">)</span>
add_arg<span class="token punctuation">(</span><span class="token string">"annotation_text"</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">"dataset/annotation/"</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">"存放音频标注文件的目录"</span><span class="token punctuation">)</span>
add_arg<span class="token punctuation">(</span><span class="token string">"filepath"</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">"提前下载好的数据集压缩文件"</span><span class="token punctuation">)</span>
args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">create_annotation_text</span><span class="token punctuation">(</span>data_dir<span class="token punctuation">,</span> annotation_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Create Aishell annotation text ...'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>annotation_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
        os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span>annotation_path<span class="token punctuation">)</span>
    f_train <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>annotation_path<span class="token punctuation">,</span> <span class="token string">'aishell.txt'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>annotation_path<span class="token punctuation">,</span> <span class="token string">'test.txt'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        f_test <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>annotation_path<span class="token punctuation">,</span> <span class="token string">'test.txt'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        f_test <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>annotation_path<span class="token punctuation">,</span> <span class="token string">'test.txt'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    transcript_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>data_dir<span class="token punctuation">,</span> <span class="token string">'transcript'</span><span class="token punctuation">,</span> <span class="token string">'aishell_transcript_v0.8.txt'</span><span class="token punctuation">)</span>
    transcript_dict <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token keyword">for</span> line <span class="token keyword">in</span> <span class="token builtin">open</span><span class="token punctuation">(</span>transcript_path<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        line <span class="token operator">=</span> line<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> line <span class="token operator">==</span> <span class="token string">''</span><span class="token punctuation">:</span> <span class="token keyword">continue</span>
        audio_id<span class="token punctuation">,</span> text <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token comment"># remove space</span>
        text <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        transcript_dict<span class="token punctuation">[</span>audio_id<span class="token punctuation">]</span> <span class="token operator">=</span> text
    data_types <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'train'</span><span class="token punctuation">,</span> <span class="token string">'dev'</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> <span class="token builtin">type</span> <span class="token keyword">in</span> data_types<span class="token punctuation">:</span>
        audio_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>data_dir<span class="token punctuation">,</span> <span class="token string">'wav'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> subfolder<span class="token punctuation">,</span> _<span class="token punctuation">,</span> filelist <span class="token keyword">in</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>walk<span class="token punctuation">(</span>audio_dir<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> fname <span class="token keyword">in</span> filelist<span class="token punctuation">:</span>
                audio_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>subfolder<span class="token punctuation">,</span> fname<span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\\'</span><span class="token punctuation">,</span> <span class="token string">'/'</span><span class="token punctuation">)</span>
                audio_id <span class="token operator">=</span> fname<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span>
                <span class="token comment"># if no transcription for audio then skipped</span>
                <span class="token keyword">if</span> audio_id <span class="token keyword">not</span> <span class="token keyword">in</span> transcript_dict<span class="token punctuation">:</span>
                    <span class="token keyword">continue</span>
                text <span class="token operator">=</span> transcript_dict<span class="token punctuation">[</span>audio_id<span class="token punctuation">]</span>
                f_train<span class="token punctuation">.</span>write<span class="token punctuation">(</span>audio_path<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'../'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\t'</span> <span class="token operator">+</span> text <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
    audio_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>data_dir<span class="token punctuation">,</span> <span class="token string">'wav'</span><span class="token punctuation">,</span> <span class="token string">'test'</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> subfolder<span class="token punctuation">,</span> _<span class="token punctuation">,</span> filelist <span class="token keyword">in</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>walk<span class="token punctuation">(</span>audio_dir<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> fname <span class="token keyword">in</span> filelist<span class="token punctuation">:</span>
            audio_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>subfolder<span class="token punctuation">,</span> fname<span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\\'</span><span class="token punctuation">,</span> <span class="token string">'/'</span><span class="token punctuation">)</span>
            audio_id <span class="token operator">=</span> fname<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span>
            <span class="token comment"># if no transcription for audio then skipped</span>
            <span class="token keyword">if</span> audio_id <span class="token keyword">not</span> <span class="token keyword">in</span> transcript_dict<span class="token punctuation">:</span>
                <span class="token keyword">continue</span>
            text <span class="token operator">=</span> transcript_dict<span class="token punctuation">[</span>audio_id<span class="token punctuation">]</span>
            f_test<span class="token punctuation">.</span>write<span class="token punctuation">(</span>audio_path<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'../'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\t'</span> <span class="token operator">+</span> text <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
    f_test<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    f_train<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">prepare_dataset</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> md5sum<span class="token punctuation">,</span> target_dir<span class="token punctuation">,</span> annotation_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Download, unpack and create manifest file."""</span>
    data_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>target_dir<span class="token punctuation">,</span> <span class="token string">'data_aishell'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>data_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> args<span class="token punctuation">.</span>filepath <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            filepath <span class="token operator">=</span> download<span class="token punctuation">(</span>url<span class="token punctuation">,</span> md5sum<span class="token punctuation">,</span> target_dir<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            filepath <span class="token operator">=</span> args<span class="token punctuation">.</span>filepath
        unpack<span class="token punctuation">(</span>filepath<span class="token punctuation">,</span> target_dir<span class="token punctuation">)</span>
        <span class="token comment"># unpack all audio tar files</span>
        audio_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>data_dir<span class="token punctuation">,</span> <span class="token string">'wav'</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> subfolder<span class="token punctuation">,</span> _<span class="token punctuation">,</span> filelist <span class="token keyword">in</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>walk<span class="token punctuation">(</span>audio_dir<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> ftar <span class="token keyword">in</span> filelist<span class="token punctuation">:</span>
                unpack<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>subfolder<span class="token punctuation">,</span> ftar<span class="token punctuation">)</span><span class="token punctuation">,</span> subfolder<span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
        os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>filepath<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Skip downloading and unpacking. Aishell data already exists in %s."</span> <span class="token operator">%</span> target_dir<span class="token punctuation">)</span>
    create_annotation_text<span class="token punctuation">(</span>data_dir<span class="token punctuation">,</span> annotation_path<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    print_arguments<span class="token punctuation">(</span>args<span class="token punctuation">)</span>
    <span class="token keyword">if</span> args<span class="token punctuation">.</span>target_dir<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'~'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        args<span class="token punctuation">.</span>target_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>expanduser<span class="token punctuation">(</span>args<span class="token punctuation">.</span>target_dir<span class="token punctuation">)</span>

    prepare_dataset<span class="token punctuation">(</span>url<span class="token operator">=</span>DATA_URL<span class="token punctuation">,</span>
                    md5sum<span class="token operator">=</span>MD5_DATA<span class="token punctuation">,</span>
                    target_dir<span class="token operator">=</span>args<span class="token punctuation">.</span>target_dir<span class="token punctuation">,</span>
                    annotation_path<span class="token operator">=</span>args<span class="token punctuation">.</span>annotation_text<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <h2>
     <a id="_119">
     </a>
     训练
    </h2>
    <p>
     使用PPASR框架训练非常简单，核心代码就3行，如下，
     <code>
      configs
     </code>
     参数可以指定使用的默认配置文件。
    </p>
    <pre><code class="prism language-python"><span class="token keyword">from</span> ppasr<span class="token punctuation">.</span>trainer <span class="token keyword">import</span> PPASRTrainer

trainer <span class="token operator">=</span> PPASRTrainer<span class="token punctuation">(</span>configs<span class="token operator">=</span><span class="token string">"conformer"</span><span class="token punctuation">,</span> use_gpu<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

trainer<span class="token punctuation">.</span>train<span class="token punctuation">(</span>save_model_path<span class="token operator">=</span><span class="token string">"models/"</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     输出类似如下：
    </p>
    <pre><code>2025-03-08 11:04:57.884 | INFO     | ppasr.optimizer:build_optimizer:16 - 成功创建优化方法：Adam，参数为：{'lr': 0.001, 'weight_decay': 1e-06}
2025-03-08 11:04:57.884 | INFO     | ppasr.optimizer:build_lr_scheduler:31 - 成功创建学习率衰减：WarmupLR，参数为：{'warmup_steps': 25000, 'min_lr': 1e-05}
2025-03-08 11:04:57.885 | INFO     | ppasr.trainer:train:541 - 词汇表大小：5561
2025-03-08 11:04:57.885 | INFO     | ppasr.trainer:train:542 - 训练数据：13382
2025-03-08 11:04:57.885 | INFO     | ppasr.trainer:train:543 - 评估数据：27
2025-03-08 11:04:58.642 | INFO     | ppasr.trainer:__train_epoch:414 - Train epoch: [1/200], batch: [0/836], loss: 51.60880, learning_rate: 0.00000008, reader_cost: 0.1062, batch_cost: 0.6486, ips: 21.1991 speech/sec, eta: 1 day, 11:03:13
</code></pre>
    <h2>
     <a id="_139">
     </a>
     导出模型
    </h2>
    <p>
     训练完成之后还需要导出模型才能进行推理，导出模型也非常简单。需要三行代码，如下：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">from</span> ppasr<span class="token punctuation">.</span>trainer <span class="token keyword">import</span> PPASRTrainer

<span class="token comment"># 获取训练器</span>
trainer <span class="token operator">=</span> PPASRTrainer<span class="token punctuation">(</span>configs<span class="token operator">=</span><span class="token string">"conformer"</span><span class="token punctuation">,</span> use_gpu<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># 导出预测模型</span>
trainer<span class="token punctuation">.</span>export<span class="token punctuation">(</span>save_model_path<span class="token operator">=</span><span class="token string">'models/'</span><span class="token punctuation">,</span>
               resume_model<span class="token operator">=</span><span class="token string">'models/ConformerModel_fbank/best_model/'</span><span class="token punctuation">)</span>
</code></pre>
    <h2>
     <a id="_152">
     </a>
     推理
    </h2>
    <p>
     推理也相当简单，只需要下面三行代码即可完成语音识别。
    </p>
    <pre><code class="prism language-python"><span class="token keyword">from</span> ppasr<span class="token punctuation">.</span>predict <span class="token keyword">import</span> PPASRPredictor

predictor <span class="token operator">=</span> PPASRPredictor<span class="token punctuation">(</span>model_dir<span class="token operator">=</span><span class="token string">"models/ConformerModel_fbank/inference_model/"</span><span class="token punctuation">,</span> use_gpu<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

audio_path <span class="token operator">=</span> <span class="token string">"dataset/test.wav"</span>
result <span class="token operator">=</span> predictor<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>audio_data<span class="token operator">=</span>audio_path<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"识别结果: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>result<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
</code></pre>
    <p>
     输出如下：
    </p>
    <pre><code>2025-03-08 11:21:52.100 | INFO     | ppasr.infer_utils.inference_predictor:__init__:38 - 已加载模型：models/ConformerModel_fbank/inference_model/inference.pth
2025-03-08 11:21:52.147 | INFO     | ppasr.predict:__init__:117 - 流式VAD模型已加载完成
2025-03-08 11:21:52.147 | INFO     | ppasr.predict:__init__:119 - 开始预热预测器...
2025-03-08 11:22:01.366 | INFO     | ppasr.predict:reset_predictor:471 - 重置预测器
2025-03-08 11:22:01.366 | INFO     | ppasr.predict:__init__:128 - 预测器已准备完成！
识别结果: {'text': '近几年不但我用书给女儿压岁也劝说亲朋不要给女儿压岁钱而改送压岁书', 'sentences': [{'text': '近几年不但我用书给女儿压岁也劝说亲朋不要给女儿压岁钱而改送压岁书', 'start': 0, 'end': 8.39}]}
</code></pre>
    <h2>
     <a id="_176">
     </a>
     结语
    </h2>
    <p>
     该框架支持多个语音识别模型，包含
     <code>
      deepspeech2
     </code>
     、
     <code>
      conformer
     </code>
     、
     <code>
      squeezeformer
     </code>
     、
     <code>
      efficient_conformer
     </code>
     等，每个模型都支持流式识别和非流式识别，以及多种解码器，包含
     <code>
      ctc_greedy_search
     </code>
     、
     <code>
      ctc_prefix_beam_search
     </code>
     、
     <code>
      attention_rescoring
     </code>
     、
     <code>
      ctc_beam_search
     </code>
     等。更多功能等你发现。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f33333230303936372f:61727469636c652f64657461696c732f313436313133343834" class_="artid" style="display:none">
 </p>
</div>


