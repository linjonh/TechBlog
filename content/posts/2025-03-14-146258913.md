---
layout: post
title: "51单片机程序实验17.红外遥控"
date: 2025-03-14 15:38:55 +0800
description: "可见光按波长从长到短排列依次为红橙黄绿青蓝紫，其中红光波长为620~760nm。比红光波长还要长的光为红外线，红外遥控利用波长760~1500nm的红外线来传输控制信号。"
keywords: "【51单片机】程序实验17.红外遥控"
categories: ['51单片机']
tags: ['嵌入式硬件', 'Mongodb', '51单片机']
artid: "146258913"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146258913
    alt: "51单片机程序实验17.红外遥控"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146258913
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146258913
cover: https://bing.ee123.net/img/rand?artid=146258913
image: https://bing.ee123.net/img/rand?artid=146258913
img: https://bing.ee123.net/img/rand?artid=146258913
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     【51单片机】程序实验17.红外遥控
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <blockquote>
     <p>
      主要参考学习资料：B站【普中官方】51单片机手把手教学视频
     </p>
     <p>
      开发资料下载链接：http://www.prechin.cn/gongsixinwen/208.html
     </p>
     <p>
      单片机套装：普中STC51单片机开发板A4标准版套餐7
     </p>
    </blockquote>
    <p>
    </p>
    <p>
    </p>
    <h2>
     <a id="_7">
     </a>
     红外遥控介绍
    </h2>
    <h3>
     <a id="_9">
     </a>
     红外线简介
    </h3>
    <p>
     可见光按波长从长到短排列依次为红橙黄绿青蓝紫，其中红光波长为620~760nm。比红光波长还要长的光为红外线，红外遥控利用波长760~1500nm的红外线来传输控制信号。
    </p>
    <h3>
     <a id="_13">
     </a>
     红外遥控原理
    </h3>
    <h4>
     <a id="_15">
     </a>
     红外发射装置
    </h4>
    <p>
     红外发射装置是由键盘电路、红外编码电路、电源电路和红外发射电路组成。红外发射电路的主要元件是红外发光二极管。通常红外遥控为了提高抗干扰性能和降低电源消耗，常用38KHz的载波传输二进制编码，该频率来源于发射端晶振频率455KHz的十二分频。
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/direct/9bfa9ae7fbc840da8efbca0fe3c0ea1e.png"/>
    </p>
    <p>
     上图左侧为发射端，右侧为接收端。脉冲到达时，发射端二极管发出红外线，接收端通过取反将其解码。
    </p>
    <p>
     二进制编码形式有很多种，常见的是以NEC为代表的PWM脉冲宽度调制码和Philip的PPM脉冲位置调制码，本实验配套遥控器使用NEC的协议。
    </p>
    <p>
     NEC码的位定义（发射端）：一个脉冲对应560us的连续载波，一个逻辑1传输需要2.25ms（560us脉冲+1680us低电平），一个逻辑0的传输需要1.125ms（569us脉冲+560ms低电平）。
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/direct/0b33e633822343c1a1b398e3b5499ab4.png"/>
    </p>
    <p>
     NEC遥控指令的数据格式（接收端）：引导码由9ms的低电平和4.5ms的高电平组成，地址码、地址反码、控制码、控制反码均为八位数据格式，按照从低位到高位的顺序传输，反码增加了传输的可靠性，用于检验传输的信号是否正确。地址码和地址反码对于同一个遥控器来说是相同的，不同按键对应的控制码是不一样的。发射端需要对上述信号取反。
    </p>
    <p>
     NEC还规定了连发码，由9ms低电平+2.5ms高电平+0.56ms低电平+97.94ms高电平组成。如果在一帧数据数据发送完成后，红外遥控器按键仍然没有放开，会紧接着发送连发码。通过统计连发码的次数可以标记按键按下的长短或者次数。
    </p>
    <h4>
     <a id="_35">
     </a>
     红外接收装置
    </h4>
    <p>
     红外接收设备由红外接收电路、红外解码、电源和应用电路组成，将红外线转化为电信号，再经过放大、限幅、检波和整型形成遥控指令脉冲输出到微控制器来对信号进行接收。
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/direct/e3279a58817249158697ba9492a0bb31.png"/>
    </p>
    <p>
     一体化红外接收头对上述电路进行了集成封装，包括三个管脚，从左到右依次为Vout、GND、Vcc。
    </p>
    <p>
     红外接收头在无脉冲时为高电平，接收到脉冲时为低电平，可通过下降沿触发外部中断，从中断中读取数据。
    </p>
    <h2>
     <a id="_46">
     </a>
     硬件设计
    </h2>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/direct/0d6e96850963456bb9779275a570edc9.png"/>
    </p>
    <p>
     本实验Vout管脚与单片机外部中断管脚P3.2相连。
    </p>
    <h2>
     <a id="17__53">
     </a>
     实验17 红外遥控
    </h2>
    <p>
     实现功能：数码管显示红外遥控器键值。
    </p>
    <p>
     数码管驱动沿用自实验14
    </p>
    <h3>
     <a id="_59">
     </a>
     红外接收头驱动
    </h3>
    <p>
     <strong>
      ired.h
     </strong>
    </p>
    <pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifnedf</span> <span class="token expression">_ired_H</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_ired_H</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"public.h"</span></span>

<span class="token comment">//定义外部中断管脚</span>
sbit IRED <span class="token operator">=</span> P3<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">;</span>

<span class="token comment">//声明存储一帧数据的数组</span>
<span class="token keyword">extern</span> u8 gired_data<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">ired_init</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
</code></pre>
    <p>
     <strong>
      ired.c
     </strong>
    </p>
    <p>
     程序框图（未注明分支均强制退出中断）：
    </p>
    <p>
     <img alt="" src="https://i-blog.csdnimg.cn/direct/860618a8f1db4da98f3e97ac73c1cb82.png"/>
    </p>
    <pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ired.h"</span></span>

u8 gired_data<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">//启用相应外部中断</span>
<span class="token keyword">void</span> <span class="token function">ired_init</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	IT0 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	EX0 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	EA <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	IRED <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//外部中断响应函数</span>
<span class="token keyword">void</span> <span class="token function">ired</span><span class="token punctuation">(</span><span class="token punctuation">)</span> interrupt <span class="token number">0</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//倒计时变量</span>
	u16 time_cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token comment">//存储循环控制变量</span>
	u8 i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token comment">//高电平计时变量</span>
	u8 ired_high_time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token comment">//参考程序框图</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>IRED<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		time_cnt <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>IRED<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token function">delay_10us</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			time_cnt<span class="token operator">--</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>time_cnt<span class="token punctuation">)</span><span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>IRED<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			time_cnt <span class="token operator">=</span> <span class="token number">500</span><span class="token punctuation">;</span>
			<span class="token keyword">while</span><span class="token punctuation">(</span>IRED<span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token function">delay_10us</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				time_cnt<span class="token operator">--</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>time_cnt<span class="token punctuation">)</span><span class="token keyword">return</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">4</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
			<span class="token punctuation">{<!-- --></span>
				<span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">8</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>
				<span class="token punctuation">{<!-- --></span>
					time_cnt <span class="token operator">=</span> <span class="token number">600</span><span class="token punctuation">;</span>
					<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>IRED<span class="token punctuation">)</span>
					<span class="token punctuation">{<!-- --></span>
						<span class="token function">delay_10us</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						time_cnt<span class="token operator">--</span><span class="token punctuation">;</span>
						<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>time_cnt<span class="token punctuation">)</span><span class="token keyword">return</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					<span class="token keyword">while</span><span class="token punctuation">(</span>IRED<span class="token punctuation">)</span>
					<span class="token punctuation">{<!-- --></span>
						<span class="token function">delay_10us</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						ired_high_time<span class="token operator">++</span><span class="token punctuation">;</span>
						<span class="token keyword">if</span><span class="token punctuation">(</span>ired_high_time<span class="token operator">&gt;=</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token keyword">return</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					gired_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;&gt;=</span> <span class="token number">1</span><span class="token punctuation">;</span>
					<span class="token keyword">if</span><span class="token punctuation">(</span>ired_high_time<span class="token operator">&gt;=</span><span class="token number">8</span><span class="token punctuation">)</span>gired_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">|=</span> <span class="token number">0x80</span><span class="token punctuation">;</span>
					ired_high_time <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>gired_data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token operator">~</span>gired_data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">4</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
				gired_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="_162">
     </a>
     主函数
    </h3>
    <pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"public.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"smg.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ired.h"</span></span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//存储三位十六进制键值段码值数组</span>
	u8 ired_buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token comment">//启用外部中断函数</span>
	<span class="token function">ired_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">//以十六进制显示键值，第三位固定为H</span>
		ired_buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> gseg_code<span class="token punctuation">[</span>gired_data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">/</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		ired_buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> gseg_code<span class="token punctuation">[</span>gired_data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">%</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		ired_buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x76</span><span class="token punctuation">;</span>
		<span class="token function">seg_display</span><span class="token punctuation">(</span>ired_buf<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f6d6f6a696e323030352f:61727469636c652f64657461696c732f313436323538393133" class_="artid" style="display:none">
 </p>
</div>


