---
arturl_encode: "68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34383837383434302f:61727469636c652f64657461696c732f313436323336383738"
layout: post
title: "搭建阿里云专有网络VPC"
date: 2025-03-13 22:11:03 +0800
description: "阿里云专有网络VPC搭建 搭建云上私有云"
keywords: "vpc服务器搭建教程"
categories: ['网络']
tags: ['云服务', '专有网络Vpc']
artid: "146236878"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146236878
    alt: "搭建阿里云专有网络VPC"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146236878
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146236878
cover: https://bing.ee123.net/img/rand?artid=146236878
image: https://bing.ee123.net/img/rand?artid=146236878
img: https://bing.ee123.net/img/rand?artid=146236878
---

# 搭建阿里云专有网络VPC

---

创建vpc不需要费用，会自动生成交换机和路由表，但vpc下属的资源需要收费。

主要需要创建ecs资源、弹性公网IP、一个弹性公网IP可以实现多个互联网服务。

## 一、概述

![](https://i-blog.csdnimg.cn/direct/f870d80ae16f45a78d2f7c983754dc76.png)

## 二、专有网络vpc

![](https://i-blog.csdnimg.cn/direct/881f3662f5bc47a7920b3536c09f512d.png)

### 2.1 vpc基本信息

![](https://i-blog.csdnimg.cn/direct/201f76fca4034c2893b00da4f648378f.png)

### 2.2 vpc资源管理

![](https://i-blog.csdnimg.cn/direct/adc46b4b203d4db2b701abc4ccbd7116.png)

### 2.3 vpc网段管理

![](https://i-blog.csdnimg.cn/direct/d29ae3ce22c143c2a8cdfb359c36ee7b.png)

## 三、交换机

一个vpc有多个交换机，每个交换机管理一个网段，交换机网段必须在vpc网段之内，交换机可以新建ecs、slb、rds

![](https://i-blog.csdnimg.cn/direct/6634037be5dd4ecdb988370902819ce2.png)

路由表在创建vpc时自动生成 ，路由表需要绑定路由器和网关

![](https://i-blog.csdnimg.cn/direct/178dce2e0c984546a1666ec07672d56f.png)

## 四、NAT网关

### 4.1 绑定弹性公网IP

需要先购买弹性公网IP，绑定公网NAT网关，其中自动生成SNAT用于内网访问外网

![](https://i-blog.csdnimg.cn/direct/afb535b946e64cc5b92821d5bd159e00.png)

### 4.2 NAT网关信息

![](https://i-blog.csdnimg.cn/direct/407e56a4617f45bbb7f6489c5a9e5aba.png)

### 4.3 绑定的弹性公网IP

![](https://i-blog.csdnimg.cn/direct/9e8bcfaf0c0f4df29181b041807c9e37.png)

### 4.4 DNAT

DNAT端口映射，此处对外开放了81端口

![](https://i-blog.csdnimg.cn/direct/ff8040c39acf4aca999d62e770a76ba6.png)

![](https://i-blog.csdnimg.cn/direct/76d8de36262349a691b0a4898ab14cca.png)

### 4.5 SNAT

SNAT内网访问外网，此处不做限制，限制在ACL做，这里系统默认开通运行访问外网

![](https://i-blog.csdnimg.cn/direct/0144bcbb23354bad937841533b365c62.png)

## 五、弹性公网IP

弹性公网IP绑定后会NAT后，会自动生成SNAT和DNAT，

![](https://i-blog.csdnimg.cn/direct/7fb7d506f85f4f64a700a4a7a15843b1.png)

## 六、访问控制ACL（绑定交换机）

### 6.1 入方向

负责外网黑名单收集

![](https://i-blog.csdnimg.cn/direct/d62c1f9865934651a858ea4aca28d229.png)

### 6.2 出方面

默认允许访问外网，所有端口出方向放通，禁止8.8.8.8访问是我自行添加，且该记录在优先级放通全网高，所以无法访问。

![](https://i-blog.csdnimg.cn/direct/4ebd2965f58a45bba6fa8f6a2e315e79.png)

![](https://i-blog.csdnimg.cn/direct/97c4b4806502461eb7b4904d6473941e.png)

弹性公网IP解绑NAT网关，需要先删除DNAT和SNAT

## 七、弹性公网IP绑定不同资源

### 7.1 解绑NAT网关

![](https://i-blog.csdnimg.cn/direct/fe16ee25e139430184336843ccfc979f.png)

解绑后内网服务器无法访问外网

![](https://i-blog.csdnimg.cn/direct/9fe695a0ae264ebcabf75c5eaf5fe8a5.png)

解绑后弹性公网IP处于未绑定转态，可以绑定以下资源

![](https://i-blog.csdnimg.cn/direct/8745afdf761b4d2981800713c04fec7a.png)

![](https://i-blog.csdnimg.cn/direct/263851cd0595418fa802fe79802af550.png)

### 7.2 弹性公网IP绑定负载均衡CLB

此处直接绑定CLB负载IP，此时访问CLB4000端口可以直接访问到服务，但我们通常不会这样做这种危险的操作，这直接把内网负载均衡器直接暴露在外网环境。

![](https://i-blog.csdnimg.cn/direct/bac0df6821b64464ac03530602816c0a.png)

![](https://i-blog.csdnimg.cn/direct/cadfaaf518194d5b91c7cc4d9c3451d4.png)

### 7.3 弹性公网IP绑定服务器ECS

再次解绑直接绑定真实服务器ECS，此时直接访问80端口即可访问，但我们通常不会这样做这种危险的操作，这直接把内网主机直接暴露在外网环境。

![](https://i-blog.csdnimg.cn/direct/eab35dbf3e16462699ae08b22e9109fa.png)

![](https://i-blog.csdnimg.cn/direct/b3f5d8bccc2d404f8d5928ee68d1a7dd.png)

## 八、安全组

安全组==>安全组模块在ecs控制面板下

### 8.1 入方向

负责服务器真实端口开放。此处放通80端口nginx对外服务

![](https://i-blog.csdnimg.cn/direct/8dc3a6e27af64307934fed9210008368.png)

### 8.2 出方向

默认放行

![](https://i-blog.csdnimg.cn/direct/d9078c74a6d04074879a9df947a33186.png)

## 九、传统型负载均衡CLB

vpc资源管理==>传统型负载均衡CLB（私网）==>负载均衡SLB控制台

CLB可以当做是一台内网反向代理服务器（CLB内网四层负载），占用一个内网ip，该例子为192.168.1.210

![](https://i-blog.csdnimg.cn/direct/08ff875f16e349bba46d2f2a8712f36f.png)

### 9.1 CLB实例详情

![](https://i-blog.csdnimg.cn/direct/b830f9ffdcc843289d759118574060c8.png)

### 9.2 监听

一个CLB实例可监听多个端口，每个端口对应一个服务，每个服务对应一个服务器组，此处监听4000端口，服务器组为slb-group1，slb-group1实际是ip为192.168.1.209的nginx服务器，通常来说服务器组需要包含多个，已达到流量分发的目的。

这样在对外服务配置DNAT时就需要把内部地址改成CLB地址和4000端口，而不是真实服务器地址和80端口。

![](https://i-blog.csdnimg.cn/direct/a7ac1f640b6b4daca0e5a847ac917c23.png)

![](https://i-blog.csdnimg.cn/direct/442bdcd90ddb4201b8ee0e73fe9014d0.png)

![](https://i-blog.csdnimg.cn/direct/6f86e723823b4354a43e3bc0cdda4660.png)

弹性公网IP绑定NAT网关，DNAT绑定负载CLB4000端口

![](https://i-blog.csdnimg.cn/direct/12b47e1d943b4f788c40c86ba1e80163.png)

弹性公网IP绑定NAT网关，DNAT绑定真实服务器80端口

![](https://i-blog.csdnimg.cn/direct/c3d1d08175d049ec996b5dbfbe38fd10.png)

## 十、资源回收

除了收费资源要及时删除，弹性公网IP、服务器ces、负载均衡clb，删除vpc还需要删除安全组、交换机、acl（删除acl要先解绑交换机）。路由表无需手动删除，vpc删除后自动删除。