---
layout: post
title: "æ·±å…¥è§£æ-TensorFlow-å…¼å®¹æ€§é—®é¢˜åŠæ„å»ºè¾“å‡ºæ–‡ä»¶ç»“æ„"
date: 2025-03-16 16:58:37 +08:00
description: "å®ƒçš„æ–‡ä»¶ç»“æ„å†³å®šäº†æœ€ç»ˆéƒ¨ç½²çš„ç»„ä»¶ï¼Œç†è§£è¿™äº›æ–‡ä»¶çš„ä½œç”¨ï¼Œæœ‰åŠ©äºå¼€å‘è€…æŒæ¡ TensorFlow åœ¨åµŒå…¥å¼ç³»ç»Ÿä¸­çš„è¿è¡Œæœºåˆ¶ã€‚ï¼Œå¸®åŠ©å¼€å‘è€…æ›´ç³»ç»Ÿåœ°æŒæ¡ TensorFlow åœ¨å®é™…åº”ç”¨ä¸­çš„æ„å»ºå’Œä¼˜åŒ–æ–¹æ³•ã€‚è®²è§£äº† TensorFlow Lite çš„æ ¸å¿ƒç»„ä»¶ï¼Œè®©ä½ èƒ½å¤Ÿæ›´ç³»ç»Ÿåœ°ç†è§£ã€‚ç„¶è€Œï¼Œåœ¨å®é™…éƒ¨ç½²è¿‡ç¨‹ä¸­ï¼Œå¼€å‘è€…ç»å¸¸é‡åˆ°ã€‚TensorFlow æ˜¯å½“å‰ä¸»æµçš„æ·±åº¦å­¦ä¹ æ¡†æ¶ä¹‹ä¸€ï¼Œåœ¨ã€‚ä¸‹ï¼ŒTensorFlow çš„æ„å»ºå’Œé€‚é…å¾€å¾€å……æ»¡æŒ‘æˆ˜ã€‚ï¼Œå¦‚æœ Bazel ç‰ˆæœ¬ä¸åŒ¹é…ï¼Œä¼šå¯¼è‡´ã€‚åœ¨åµŒå…¥å¼è®¾å¤‡ä¸Šï¼Œä½ å¯ä»¥ç›´æ¥æµ‹è¯•ã€‚"
keywords: "æ·±å…¥è§£æ TensorFlow å…¼å®¹æ€§é—®é¢˜åŠæ„å»ºè¾“å‡ºæ–‡ä»¶ç»“æ„*"
categories: ['Ai']
tags: ['äººå·¥æ™ºèƒ½', 'Tensorflow', 'Neo']
artid: "146297608"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146297608
    alt: "æ·±å…¥è§£æ-TensorFlow-å…¼å®¹æ€§é—®é¢˜åŠæ„å»ºè¾“å‡ºæ–‡ä»¶ç»“æ„"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146297608
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146297608
cover: https://bing.ee123.net/img/rand?artid=146297608
image: https://bing.ee123.net/img/rand?artid=146297608
img: https://bing.ee123.net/img/rand?artid=146297608
---

# æ·±å…¥è§£æ TensorFlow å…¼å®¹æ€§é—®é¢˜åŠæ„å»ºè¾“å‡ºæ–‡ä»¶ç»“æ„*
### **ğŸ“Œ å¼•è¨€**
TensorFlow æ˜¯å½“å‰ä¸»æµçš„æ·±åº¦å­¦ä¹ æ¡†æ¶ä¹‹ä¸€ï¼Œåœ¨ **è®¡ç®—æœºè§†è§‰ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€å¼ºåŒ–å­¦ä¹ ** ç­‰é¢†åŸŸè¢«å¹¿æ³›åº”ç”¨ã€‚ç„¶è€Œï¼Œåœ¨å®é™…éƒ¨ç½²è¿‡ç¨‹ä¸­ï¼Œå¼€å‘è€…ç»å¸¸é‡åˆ°
**ç‰ˆæœ¬å…¼å®¹æ€§é—®é¢˜** ï¼Œç‰¹åˆ«æ˜¯åœ¨ **åµŒå…¥å¼å¹³å°ã€Yocto é¡¹ç›®ã€æ ‘è“æ´¾ç­‰ç¯å¢ƒ** ä¸‹ï¼ŒTensorFlow çš„æ„å»ºå’Œé€‚é…å¾€å¾€å……æ»¡æŒ‘æˆ˜ã€‚
æœ¬ç¯‡æ–‡ç« å°†æ·±å…¥è§£æ **TensorFlow å…¼å®¹æ€§é—®é¢˜çš„æ ¸å¿ƒçŸ¥è¯†ç‚¹** ï¼Œå¹¶ç»“åˆ **TensorFlow åœ¨ Yocto ä¸­çš„æ„å»ºè¾“å‡ºæ–‡ä»¶ç»“æ„**
ï¼Œä»æœ€ç»ˆçš„æ–‡ä»¶ç”Ÿæˆè§’åº¦æ¥ç†è§£ **TensorFlow çš„å…³é”®ç»„ä»¶** ï¼Œå¸®åŠ©å¼€å‘è€…æ›´ç³»ç»Ÿåœ°æŒæ¡ TensorFlow åœ¨å®é™…åº”ç”¨ä¸­çš„æ„å»ºå’Œä¼˜åŒ–æ–¹æ³•ã€‚
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/d78966a30cf34d97a62a0fad588390a9.png)
* * *
### **ğŸ“Œ 1. TensorFlow å…¼å®¹æ€§é—®é¢˜çš„æ ¸å¿ƒè¦ç‚¹**
åœ¨ä¸åŒå¹³å°ä¸Šæ„å»º TensorFlow æ—¶ï¼Œå¸¸è§çš„å…¼å®¹æ€§é—®é¢˜åŒ…æ‹¬ï¼š
1. **Python ç‰ˆæœ¬ä¸å…¼å®¹**
2. **Bazel ç‰ˆæœ¬ä¸å…¼å®¹**
3. **ç¡¬ä»¶æ¶æ„æ”¯æŒé—®é¢˜**
4. **ç³»ç»Ÿå…±äº«åº“ä¾èµ–å†²çª**
5. **TensorFlow Lite è¿è¡Œåº“ (`tflite_runtime`) ä¸¢å¤±**
#### **ğŸš© 1.1 Python ç‰ˆæœ¬ä¸å…¼å®¹**
TensorFlow çš„ä¸åŒç‰ˆæœ¬å¯¹ **Python ç‰ˆæœ¬æœ‰ä¸¥æ ¼è¦æ±‚** ï¼Œå¦‚æœä¸åŒ¹é…ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ— æ³•å®‰è£…æˆ–è¿è¡Œï¼š
ImportError: Python version mismatch: module was compiled for Python 3.11, but is 3.12.6
##### **âœ… è§£å†³æ–¹æ¡ˆ**
* **æŸ¥è¯¢ TensorFlow å…¼å®¹çš„ Python ç‰ˆæœ¬**
pip install tensorflow==2.x.x --no-deps
* **åœ¨ Yocto ä¸­æŒ‡å®š Python ç‰ˆæœ¬**
åœ¨ `local.conf` æ·»åŠ ï¼š
PREFERRED_VERSION_python3 = "3.11%"
ç„¶åé‡æ–°ç¼–è¯‘ï¼š
bitbake -c cleansstate python3
bitbake python3
* * *
#### **ğŸš© 1.2 Bazel ç‰ˆæœ¬ä¸å…¼å®¹**
TensorFlow **ä¾èµ– Bazel è¿›è¡Œç¼–è¯‘** ï¼Œå¦‚æœ Bazel ç‰ˆæœ¬ä¸åŒ¹é…ï¼Œä¼šå¯¼è‡´ `tensorflow-lite` å¤±è´¥ï¼š
ERROR: The 'build' command is only supported in Bazel versions 6.0.0 to 6.9.0.
##### **âœ… è§£å†³æ–¹æ¡ˆ**
1. **æ£€æŸ¥ TensorFlow éœ€è¦çš„ Bazel ç‰ˆæœ¬**
cat tensorflow/.bazelversion
2. **åœ¨ Yocto ä¸­å¼ºåˆ¶æŒ‡å®š`bazel-native` ç‰ˆæœ¬**
åœ¨ `local.conf` é‡Œæ·»åŠ ï¼š
PREFERRED_VERSION_bazel-native = "6.1.1"
3. **é‡æ–°ç¼–è¯‘**
bitbake -c cleansstate bazel-native
bitbake bazel-native
* * *
#### **ğŸš© 1.3 ç¡¬ä»¶æ¶æ„æ”¯æŒ**
TensorFlow **é»˜è®¤æä¾› x86_64 å’Œ arm64 é¢„ç¼–è¯‘åŒ…** ï¼Œå¦‚æœä½ åœ¨ **æ ‘è“æ´¾ (ARMv7) æˆ– i.MX 8M
(Cortex-A53)** ç­‰å¹³å°è¿è¡Œï¼Œå¯èƒ½ä¼šé‡åˆ°ï¼š
Illegal instruction (core dumped)
##### **âœ… è§£å†³æ–¹æ¡ˆ**
* **æ£€æŸ¥ CPU æŒ‡ä»¤é›†**
cat /proc/cpuinfo | grep flags
* **äº¤å‰ç¼–è¯‘ TensorFlow Lite**
bitbake tensorflow-lite
* * *
### **ğŸ“Œ 2. TensorFlow åœ¨ Yocto çš„æ„å»ºè¾“å‡ºæ–‡ä»¶ç»“æ„è§£æ**
TensorFlow åœ¨ Yocto ä¸­çš„ç¼–è¯‘è¾“å‡ºæ–‡ä»¶ **å­˜æ”¾åœ¨`image/`
ç›®å½•ä¸‹**ï¼Œå®ƒçš„æ–‡ä»¶ç»“æ„å†³å®šäº†æœ€ç»ˆéƒ¨ç½²çš„ç»„ä»¶ï¼Œç†è§£è¿™äº›æ–‡ä»¶çš„ä½œç”¨ï¼Œæœ‰åŠ©äºå¼€å‘è€…æŒæ¡ TensorFlow åœ¨åµŒå…¥å¼ç³»ç»Ÿä¸­çš„è¿è¡Œæœºåˆ¶ã€‚
tree tmp/work/cortexa72-poky-linux/tensorflow-lite/2.16.9/image/
#### **ğŸš€ è¾“å‡ºæ–‡ä»¶ç›®å½•ç»“æ„**
.
â”œâ”€â”€ lib
â”‚ â”œâ”€â”€ libtensorflowlite.so
â”‚ â””â”€â”€ python3.12
â”‚ â””â”€â”€ site-packages
â”‚ â”œâ”€â”€ tflite_runtime
â”‚ â”‚ â”œâ”€â”€ __init__.py
â”‚ â”‚ â”œâ”€â”€ interpreter.py
â”‚ â”‚ â”œâ”€â”€ metrics_interface.py
â”‚ â”‚ â”œâ”€â”€ _pywrap_tensorflow_interpreter_wrapper.so
â”‚ â””â”€â”€ tflite_runtime-2.16.9.dist-info
â”œâ”€â”€ sbin
â”‚ â”œâ”€â”€ benchmark_model
â”‚ â””â”€â”€ label_image
â””â”€â”€ share
â””â”€â”€ label_image
â”œâ”€â”€ mobilenet_v1_1.0_224_quant.tflite
#### **ğŸ“ å…³é”®æ–‡ä»¶è§£æ**
ç»„ä»¶| ç›®å½•| ä½œç”¨
---|---|---
**TensorFlow Lite è¿è¡Œæ—¶åº“**| `lib/libtensorflowlite.so`| `libtensorflowlite.so` æ˜¯
TensorFlow Lite çš„æ ¸å¿ƒåŠ¨æ€é“¾æ¥åº“ï¼Œæ‰€æœ‰çš„æ¨ç†è°ƒç”¨éƒ½éœ€è¦è¿™ä¸ªåº“ã€‚
**Python TensorFlow Lite è¿è¡Œæ—¶**| `lib/python3.12/site-packages/tflite_runtime`|
è¿™æ˜¯ TensorFlow Lite åœ¨ Python è¿è¡Œæ—¶çš„ç»‘å®šï¼Œ`interpreter.py` æ˜¯ TensorFlow Lite è§£æ
`.tflite` æ¨¡å‹çš„å…¥å£ã€‚
**TensorFlow Lite Benchmark å·¥å…·**| `sbin/benchmark_model`| è¯¥å·¥å…·ç”¨äºæµ‹è¯• TFLite
æ¨¡å‹çš„æ¨ç†æ€§èƒ½ï¼Œä¾‹å¦‚åœ¨ **æ ‘è“æ´¾** æˆ– **i.MX 8M** ä¸Šæµ‹ç®— FPSã€‚
**TensorFlow Lite é¢„è®­ç»ƒæ¨¡å‹**|
`share/label_image/mobilenet_v1_1.0_224_quant.tflite`| è¿™æ˜¯ä¸€ä¸ª **MobileNet V1
é‡åŒ–æ¨¡å‹** ï¼Œå¯ä»¥ç›´æ¥ç”¨äºç›®æ ‡æ£€æµ‹æˆ–åˆ†ç±»ä»»åŠ¡ã€‚
* * *
### **ğŸ“Œ 3. TensorFlow Lite çš„å®é™…è¿è¡Œ**
åœ¨åµŒå…¥å¼è®¾å¤‡ä¸Šï¼Œä½ å¯ä»¥ç›´æ¥æµ‹è¯• **TensorFlow Lite è¿è¡Œæ—¶åº“** ï¼š
import tflite_runtime.interpreter as tflite
# åŠ è½½æ¨¡å‹
interpreter = tflite.Interpreter(model_path="/usr/share/label_image/mobilenet_v1_1.0_224_quant.tflite")
interpreter.allocate_tensors()
print("TensorFlow Lite æ¨¡å‹åŠ è½½æˆåŠŸï¼")
å¦‚æœæŠ¥é”™ï¼š
ModuleNotFoundError: No module named 'tflite_runtime'
è¯´æ˜ `PYTHONPATH` æ²¡æœ‰æ­£ç¡®è®¾ç½®ï¼š
export PYTHONPATH=/usr/lib/python3.12/site-packages:$PYTHONPATH
* * *
### **ğŸ“Œ 4. ç»“è®º**
âœ… **TensorFlow å…¼å®¹æ€§é—®é¢˜ä¸»è¦æ¶‰åŠï¼šPython ç‰ˆæœ¬ã€Bazel ç‰ˆæœ¬ã€ç¡¬ä»¶æ¶æ„ã€ç³»ç»Ÿå…±äº«åº“ç­‰** ã€‚
âœ… **åœ¨ Yocto ä¸­ï¼Œå¯ä»¥é€šè¿‡`PREFERRED_VERSION_python3` å’Œ `bitbake tensorflow-lite`
é‡æ–°ç¼–è¯‘é€‚é…ç‰ˆæœ¬**ã€‚
âœ… **TensorFlow Lite çš„æ„å»ºè¾“å‡ºæ–‡ä»¶ä¸»è¦åŒ…æ‹¬`libtensorflowlite.so` è¿è¡Œæ—¶åº“ã€Python ç»‘å®šã€Benchmark
å·¥å…·ã€é¢„è®­ç»ƒæ¨¡å‹ç­‰**ã€‚
âœ… **ç†è§£`image/` ç›®å½•ä¸‹çš„æ–‡ä»¶ç»“æ„ï¼Œæœ‰åŠ©äºæ·±å…¥æŒæ¡ TensorFlow åœ¨åµŒå…¥å¼è®¾å¤‡ä¸Šçš„è¿è¡Œæ–¹å¼**ã€‚
è¿™ç¯‡æ–‡ç« ä¸ä»…å¸®åŠ©ä½ è§£å†³ **TensorFlow åœ¨ Yocto ä¸­çš„å…¼å®¹æ€§é—®é¢˜** ï¼Œè¿˜ä» **æœ€ç»ˆçš„æ„å»ºè¾“å‡ºè§’åº¦** è®²è§£äº† TensorFlow
Lite çš„æ ¸å¿ƒç»„ä»¶ï¼Œè®©ä½ èƒ½å¤Ÿæ›´ç³»ç»Ÿåœ°ç†è§£ **TensorFlow çš„å·¥ä½œåŸç†** ï¼Œå¹¶æˆåŠŸéƒ¨ç½²åˆ°åµŒå…¥å¼è®¾å¤‡ä¸­ ğŸš€ï¼