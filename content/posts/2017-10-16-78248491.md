---
layout: post
title: "python-__slot__的用法"
date: 2017-10-16 12:47:51 +0800
description: "Python中，每个类的实例属性默认由字典存储，适合动态设置属性，但可能导致内存浪费。对于属性固定的"
keywords: "python slot"
categories: ['Python']
tags: ['Python']
artid: "78248491"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=78248491
    alt: "python-__slot__的用法"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=78248491
featuredImagePreview: https://bing.ee123.net/img/rand?artid=78248491
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     python  __slot__的用法
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h2 id="__slots__" style="margin-top:0px; font-family:'Roboto Slab',ff-tisa-web-pro,Georgia,Arial,sans-serif; font-size:25.2px; color:rgb(64,64,64); background-color:rgb(252,252,252)">
     <code style="font-family:Consolas,'Andale Mono WT','Andale Mono','Lucida Console','Lucida Sans Typewriter','DejaVu Sans Mono','Bitstream Vera Sans Mono','Liberation Mono','Nimbus Mono L',Monaco,'Courier New',Courier,monospace; font-size:18.9px; white-space:pre; max-width:100%; border:1px solid rgb(225,228,229); padding:0px 5px; color:rgb(231,76,60); overflow-x:auto; background:rgb(255,255,255)">
      __slots__
     </code>
     魔法
    </h2>
    <p style="line-height:24px; margin-top:0px; margin-bottom:24px; font-size:16px; color:rgb(64,64,64); font-family:Lato,proxima-nova,'Helvetica Neue',Arial,sans-serif; background-color:rgb(252,252,252)">
     在Python中，每个类都有实例属性。默认情况下Python用一个字典来保存一个对象的实例属性。这非常有用，因为它允许我们在运行时去设置任意的新属性。
    </p>
    <p style="line-height:24px; margin-top:0px; margin-bottom:24px; font-size:16px; color:rgb(64,64,64); font-family:Lato,proxima-nova,'Helvetica Neue',Arial,sans-serif; background-color:rgb(252,252,252)">
     然而，对于有着已知属性的小类来说，它可能是个瓶颈。这个字典浪费了很多内存。Python不能在对象创建时直接分配一个固定量的内存来保存所有的属性。因此如果你创建许多对象（我指的是成千上万个），它会消耗掉很多内存。
     <br style=""/>
     不过还是有一个方法来规避这个问题。这个方法需要使用
     <code style="font-family:Consolas,'Andale Mono WT','Andale Mono','Lucida Console','Lucida Sans Typewriter','DejaVu Sans Mono','Bitstream Vera Sans Mono','Liberation Mono','Nimbus Mono L',Monaco,'Courier New',Courier,monospace; font-size:12px; white-space:pre; max-width:100%; border:1px solid rgb(225,228,229); padding:0px 5px; color:rgb(231,76,60); overflow-x:auto; word-wrap:break-word; background:rgb(255,255,255)">
      __slots__
     </code>
     来告诉Python不要使用字典，而且只给一个固定集合的属性分配空间。
    </p>
    <p style="line-height:24px; margin-top:0px; margin-bottom:24px; font-size:16px; color:rgb(64,64,64); font-family:Lato,proxima-nova,'Helvetica Neue',Arial,sans-serif; background-color:rgb(252,252,252)">
     这里是一个使用与不使用
     <code style="font-family:Consolas,'Andale Mono WT','Andale Mono','Lucida Console','Lucida Sans Typewriter','DejaVu Sans Mono','Bitstream Vera Sans Mono','Liberation Mono','Nimbus Mono L',Monaco,'Courier New',Courier,monospace; font-size:12px; white-space:pre; max-width:100%; border:1px solid rgb(225,228,229); padding:0px 5px; color:rgb(231,76,60); overflow-x:auto; word-wrap:break-word; background:rgb(255,255,255)">
      __slots__
     </code>
     的例子：
    </p>
    <ul style="margin:0px 0px 24px; padding:0px; line-height:24px; color:rgb(64,64,64); font-family:Lato,proxima-nova,'Helvetica Neue',Arial,sans-serif; font-size:14.4px; background-color:rgb(252,252,252)">
     <li style="list-style:disc; margin-left:24px">
      不使用
      <code style="font-family:Consolas,'Andale Mono WT','Andale Mono','Lucida Console','Lucida Sans Typewriter','DejaVu Sans Mono','Bitstream Vera Sans Mono','Liberation Mono','Nimbus Mono L',Monaco,'Courier New',Courier,monospace; font-size:10.8px; white-space:pre; max-width:100%; border:1px solid rgb(225,228,229); padding:0px 5px; color:rgb(231,76,60); overflow-x:auto; background:rgb(255,255,255)">
       __slots__
      </code>
      :
     </li>
    </ul>
    <pre style="font-family:monospace,serif; color:rgb(64,64,64); background-color:rgb(252,252,252)"><code class="python hljs" style="font-family:Consolas,'Andale Mono WT','Andale Mono','Lucida Console','Lucida Sans Typewriter','DejaVu Sans Mono','Bitstream Vera Sans Mono','Liberation Mono','Nimbus Mono L',Monaco,'Courier New',Courier,monospace; max-width:100%; border:1px solid rgb(225,228,229); padding:0.5em; color:rgb(51,51,51); overflow-x:auto; display:block; background-color:rgb(255,255,255)"><span style="font-size:14px"><span class="hljs-class" style=""><span class="hljs-keyword" style="font-weight:bold">class</span> <span class="hljs-title" style="color:rgb(68,85,136); font-weight:bold">MyClass</span><span class="hljs-params" style="">(object)</span>:</span>
    <span class="hljs-function" style=""><span class="hljs-keyword" style="font-weight:bold">def</span> <span class="hljs-title" style="color:rgb(153,0,0); font-weight:bold">__init__</span><span class="hljs-params" style="">(self, name, identifier)</span>:</span>
        self.name = name
        self.identifier = identifier
        self.set_up()
    <span class="hljs-comment" style="color:rgb(153,153,136); font-style:italic"># ...</span></span><span style="font-size:10.8px">
</span></code></pre>
    <ul style="margin:0px 0px 24px; padding:0px; line-height:24px; color:rgb(64,64,64); font-family:Lato,proxima-nova,'Helvetica Neue',Arial,sans-serif; font-size:14.4px; background-color:rgb(252,252,252)">
     <li style="list-style:disc; margin-left:24px">
      使用
      <code style="font-family:Consolas,'Andale Mono WT','Andale Mono','Lucida Console','Lucida Sans Typewriter','DejaVu Sans Mono','Bitstream Vera Sans Mono','Liberation Mono','Nimbus Mono L',Monaco,'Courier New',Courier,monospace; font-size:10.8px; white-space:pre; max-width:100%; border:1px solid rgb(225,228,229); padding:0px 5px; color:rgb(231,76,60); overflow-x:auto; background:rgb(255,255,255)">
       __slots__
      </code>
      :
     </li>
    </ul>
    <pre style="font-family:monospace,serif; color:rgb(64,64,64); background-color:rgb(252,252,252)"><code class="python hljs" style="font-family:Consolas,'Andale Mono WT','Andale Mono','Lucida Console','Lucida Sans Typewriter','DejaVu Sans Mono','Bitstream Vera Sans Mono','Liberation Mono','Nimbus Mono L',Monaco,'Courier New',Courier,monospace; max-width:100%; border:1px solid rgb(225,228,229); padding:0.5em; color:rgb(51,51,51); overflow-x:auto; display:block; background-color:rgb(255,255,255)"><span style="font-size:14px"><span class="hljs-class" style=""><span class="hljs-keyword" style="font-weight:bold">class</span> <span class="hljs-title" style="color:rgb(68,85,136); font-weight:bold">MyClass</span><span class="hljs-params" style="">(object)</span>:</span>
    __slots__ = [<span class="hljs-string" style="color:rgb(221,17,68)">'name'</span>, <span class="hljs-string" style="color:rgb(221,17,68)">'identifier'</span>]
    <span class="hljs-function" style=""><span class="hljs-keyword" style="font-weight:bold">def</span> <span class="hljs-title" style="color:rgb(153,0,0); font-weight:bold">__init__</span><span class="hljs-params" style="">(self, name, identifier)</span>:</span>
        self.name = name
        self.identifier = identifier
        self.set_up()
    <span class="hljs-comment" style="color:rgb(153,153,136); font-style:italic"># ...</span></span><span style="font-size:10.8px">
</span></code></pre>
    <p style="line-height:24px; margin-top:0px; margin-bottom:24px; font-size:16px; color:rgb(64,64,64); font-family:Lato,proxima-nova,'Helvetica Neue',Arial,sans-serif; background-color:rgb(252,252,252)">
     第二段代码会为你的内存减轻负担。通过这个技巧，有些人已经看到内存占用率几乎40%~50%的减少。
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f71715f3335363336333131:2f61727469636c652f64657461696c732f3738323438343931" class_="artid" style="display:none">
 </p>
</div>


