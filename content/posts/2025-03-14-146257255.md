---
layout: post
title: "大数据-spark3.5安装部署之免密登录"
date: 2025-03-14 14:47:22 +0800
description: "spark使用standalone模式部署时，从节点要与主节点之间进行通信。如果不配置免密登录，启动时会提示输入密码，很可能造成从节点没有成功启动；启动后当主从节点要互相访问时，依然需要密码，这时肯定失败，例如web查看时只看到一个主节点自身的worker。节点互访存在于主从之间，从从之间不存在。"
keywords: "大数据-spark3.5安装部署之免密登录"
categories: ['未分类']
tags: ['大数据']
artid: "146257255"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146257255
    alt: "大数据-spark3.5安装部署之免密登录"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146257255
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146257255
cover: https://bing.ee123.net/img/rand?artid=146257255
image: https://bing.ee123.net/img/rand?artid=146257255
img: https://bing.ee123.net/img/rand?artid=146257255
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     大数据-spark3.5安装部署之免密登录
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     spark使用standalone模式部署时，从节点要与主节点之间进行通信。如果不配置免密登录，启动时会提示输入密码，很可能造成从节点没有成功启动；启动后当主从节点要互相访问时，依然需要密码，这时肯定失败，例如web查看时只看到一个主节点自身的worker。
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     节点互访存在于主从之间，从从之间不存在。
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     免密登录配置过程如下
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     查询是否安装了openssh-server，ii表示已安装
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     dpkg -l | grep openssh-server
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     <img alt="" height="82" src="https://i-blog.csdnimg.cn/direct/1b355460acfb49588e0a45938046df3d.png" width="1280"/>
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:left">
     注意：也可以使用 apt list --installed | grep openssh-server
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     若没安装，使用 apt install openssh-server 安装。
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:left">
     查看ssh是否启动
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:left">
     systemctl status ssh
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     如下所示，则表示启动
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     <img alt="" height="389" src="https://i-blog.csdnimg.cn/direct/b21f1fab99e1490d8d7933ed59a53212.png" width="1280"/>
    </p>
    <h2 style="margin-left:0.0001pt; margin-right:0px; text-align:justify">
     主机免密登录从机
    </h2>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     为了能够无密码登录本地主机，需要生成SSH密钥并配置免密码登录。
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     生成密钥对
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     ssh-keygen -t rsa -P "" //-t 指定生成RSA类型的密钥以及管理密钥
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     一直回车，会在/root/.ssh/文件夹下生成id_rsa（私有密钥）、id_rsa.pub（公有密钥）
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     <img alt="" height="448" src="https://i-blog.csdnimg.cn/direct/8365d50701984376b7c08835d3a9efa4.png" width="1280"/>
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     进入目录~/.ssh，即可查看到生成的公钥、私钥文件。
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     <img alt="" height="151" src="https://i-blog.csdnimg.cn/direct/beb32219d20840b69020acb80605770b.png" width="1280"/>
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     将id_rsa.pub追加到authorized_keys
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     <img alt="" height="72" src="https://i-blog.csdnimg.cn/direct/4360f3f6f53f4646ac612ed828430304.png" width="1280"/>
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     修改/etc/ssh/sshd_config文件，让本机允许远程连接。具体如下
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     RSAAuthentication yes  （若无则添加）
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     PubkeyAuthentication yes
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     AuthorizedKeysFile .ssh/authorized_keys
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     PermitRootLogin yes  （配置服务器远程访问时已经设置）
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     <img alt="" height="205" src="https://i-blog.csdnimg.cn/direct/9d9b5aa204794961a56742103d7d72e5.png" width="1280"/>
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     重启ssh
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     service ssh restart
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     <img alt="" height="82" src="https://i-blog.csdnimg.cn/direct/00af2928728c43308458287f8801e811.png" width="1280"/>
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     修改权限
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     chmod 600 ~/.ssh/authorized_keys
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     chmod 700 ~/.ssh
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     <img alt="" height="116" src="https://i-blog.csdnimg.cn/direct/3b98ccb8691e46109b7201f8c093a85c.png" width="1280"/>
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     将公钥复制到从机u22server4spark2
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     scp ~/.ssh/id_rsa.pub root@u22server4spark2:~/.ssh/id_rsa.pub_sl
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     scp ~/.ssh/id_rsa.pub root@u22server4spark3:~/.ssh/id_rsa.pub_sl
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     <img alt="" height="116" src="https://i-blog.csdnimg.cn/direct/3b6bd1eeae044d9495a42dfbf7962706.png" width="1280"/>
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     登录u22server4spark2，将所传公钥添加至authorized_keys
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     cat id_rsa.pub_sl &gt;&gt; authorized_keys
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     <img alt="" height="157" src="https://i-blog.csdnimg.cn/direct/3b8be8e280134818a8ce4a541993ab56.png" width="1280"/>
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     验证从主机u22server4spark登录从机u22server4spark2，免密登录。
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     ssh root@u22server4spark2
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     如下所示，顺利登录，无需密码。
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     <img alt="" height="720" src="https://i-blog.csdnimg.cn/direct/b3fdceab913c4484a99b772984e38598.png" width="861"/>
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     将公钥复制到从机u22server4spark3，按照如上处理，即可实现主机免密登录登录从机u22server4spark3。
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
    </p>
    <h2 style="margin-left:0.0001pt; margin-right:0px; text-align:justify">
     从机免密登录主机
    </h2>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
     按照主机免密登录从机的操作步骤，分别在两个从机上操作即可。
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
    </p>
    <p style="margin-left:.0001pt; margin-right:0; text-align:justify">
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470:733a2f2f626c6f672e6373646e2e6e65742f6379687973722f:61727469636c652f64657461696c732f313436323537323535" class_="artid" style="display:none">
 </p>
</div>


