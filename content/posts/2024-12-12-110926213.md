---
layout: post
title: "微信小程序日期picker组件带至今选项的两种解决方法"
date: 2024-12-12 17:01:28 +0800
description: "微信小程序日期(picker)组件（带‘至今’选项）的两种解决方案文章目录微信小程序日期(picke"
keywords: "微信小程序input 加入年月日"
categories: ['微信小程序']
tags: ['小程序', 'Js', 'Javascript']
artid: "110926213"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=110926213
    alt: "微信小程序日期picker组件带至今选项的两种解决方法"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=110926213
featuredImagePreview: https://bing.ee123.net/img/rand?artid=110926213
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     微信小程序日期(picker)组件（带‘至今’选项）的两种解决方法
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="picker_0">
     </a>
     微信小程序日期(picker)组件（带‘至今’选项）的两种解决方案
    </h2>
    <hr color="#000000" size='1"'/>
    <p>
    </p>
    <div class="toc">
     <h4>
      文章目录
     </h4>
     <ul>
      <li>
       <a href="#picker_0" rel="nofollow">
        微信小程序日期(picker)组件（带‘至今’选项）的两种解决方案
       </a>
      </li>
      <li>
       <a href="#_11" rel="nofollow">
        前言
       </a>
      </li>
      <li>
       <a href="#_27" rel="nofollow">
        一、方案一（超级无敌的处理方案）
       </a>
      </li>
      <li>
       <a href="#_52" rel="nofollow">
        二、方案二（自定义日期组件）
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#1_53" rel="nofollow">
          1.成果展示
         </a>
        </li>
        <li>
         <a href="#2_61" rel="nofollow">
          2.组件实现
         </a>
        </li>
        <li>
         <ul>
          <li>
           <a href="#21_63" rel="nofollow">
            2.1.文件夹说明
           </a>
          </li>
          <li>
           <a href="#22_72" rel="nofollow">
            2.2详细代码实现
           </a>
          </li>
          <li>
           <a href="#3_463" rel="nofollow">
            3.答疑
           </a>
          </li>
         </ul>
        </li>
       </ul>
      </li>
      <li>
       <a href="#_470" rel="nofollow">
        总结
       </a>
      </li>
     </ul>
    </div>
    <p>
    </p>
    <hr color="#000000" size='1"'/>
    <h2>
     <a id="_11">
     </a>
     前言
    </h2>
    <p>
     <font color="#999AAA">
      微信小程序中日期picker选择器中，无法满足一些需求，比如离职日期（还没有离职），那没有‘至今这个选项’，就很不爽！
     </font>
    </p>
    <p>
     如下：
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/cb8b1c8598c4851611127061ef467282.png#pic_center"/>
    </p>
    <hr color="#000000" size='1"'/>
    <p>
     <font color="#999AAA">
      为什莫没有 ‘至今’，选项呢？还得自己写，我天~~~
     </font>
    </p>
    <p>
     接下来就给大家分享一下解决的两种方案
    </p>
    <h2>
     <a id="_27">
     </a>
     一、方案一（超级无敌的处理方案）
    </h2>
    <p>
     <strong>
      wxml
     </strong>
    </p>
    <pre><code class="prism language-c"><span class="token operator">&lt;</span>picker class<span class="token operator">=</span><span class="token string">"select--picker-style"</span> mode<span class="token operator">=</span><span class="token string">"date"</span> value<span class="token operator">=</span><span class="token string">"{<!-- -->{end}}"</span> fields<span class="token operator">=</span><span class="token string">"month"</span> data<span class="token operator">-</span>input<span class="token operator">-</span>index<span class="token operator">=</span><span class="token string">"{<!-- -->{index}}"</span> start<span class="token operator">=</span><span class="token string">"1900-09"</span> end<span class="token operator">=</span><span class="token string">"2050-09"</span> bindchange<span class="token operator">=</span><span class="token string">"bindEndDateChange"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>view class<span class="token operator">=</span><span class="token string">"picker picker-select"</span><span class="token operator">&gt;</span>
       <span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>end<span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>picker<span class="token operator">&gt;</span>
</code></pre>
    <p>
     <strong>
      js
     </strong>
    </p>
    <pre><code class="prism language-c">data<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    end<span class="token punctuation">:</span><span class="token string">'至今'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
    <p>
     页面初始化时 end字段可以将‘至今显示’
    </p>
    <p>
     提交给后台保存时，也可以将’至今’提交给后台保存
    </p>
    <p>
     缺点：在初次显示是可以显示和保存，当拖动picker后无法再次选择’至今’选项
    </p>
    <h2>
     <a id="_52">
     </a>
     二、方案二（自定义日期组件）
    </h2>
    <h3>
     <a id="1_53">
     </a>
     1.成果展示
    </h3>
    <font color="#999AAA">
    </font>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/2c13b581fc6026b0344cee8084b47bb0.png#pic_center"/>
    </p>
    <h3>
     <a id="2_61">
     </a>
     2.组件实现
    </h3>
    <h4>
     <a id="21_63">
     </a>
     2.1.文件夹说明
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/79a03a13f54eb4872b5233daa6a1c12e.png#pic_center"/>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/899520d09f7eb7220ec3d3d80de38389.png#pic_center">
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/40c180f4940a119eeea1dc4791855321.png#pic_center"/>
     </img>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/94b224afb3707ffd9b8698e75b9a5df5.png#pic_center"/>
    </p>
    <h4>
     <a id="22_72">
     </a>
     2.2详细代码实现
    </h4>
    <p>
     （1）处理日期的工具文件（utils/date.js）
    </p>
    <pre><code class="prism language-c"><span class="token keyword">const</span> date <span class="token operator">=</span> new <span class="token function">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> nowYear <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> nowMonth <span class="token operator">=</span> <span class="token function">formatNumber</span><span class="token punctuation">(</span>date<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> nowDay <span class="token operator">=</span> <span class="token function">formatNumber</span><span class="token punctuation">(</span>date<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// 每月的天数</span>
let daysInMonth <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// 根据年月 获取当月的总天数</span>
function <span class="token function">getDays</span><span class="token punctuation">(</span>year<span class="token punctuation">,</span> month<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>month <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>year <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">==</span><span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>year <span class="token operator">%</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">!=</span><span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>year <span class="token operator">%</span> <span class="token number">400</span> <span class="token operator">==</span><span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">29</span> <span class="token punctuation">:</span> <span class="token number">28</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> daysInMonth<span class="token punctuation">[</span>month <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 根据年月日设置当前月有多少天 并更新年月日数组</span>
function <span class="token function">setDate</span><span class="token punctuation">(</span>quick<span class="token punctuation">,</span> year<span class="token punctuation">,</span> month<span class="token punctuation">,</span> day<span class="token punctuation">,</span> that<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  let daysNum <span class="token operator">=</span> <span class="token function">getDays</span><span class="token punctuation">(</span>year<span class="token punctuation">,</span> month<span class="token punctuation">)</span>
  month <span class="token operator">=</span> month <span class="token operator">?</span> month <span class="token punctuation">:</span> <span class="token number">1</span>
  day <span class="token operator">=</span> day <span class="token operator">?</span> day <span class="token punctuation">:</span> <span class="token number">1</span>
  let monthsNum <span class="token operator">=</span> <span class="token number">12</span>
  let years <span class="token operator">=</span> quick <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token string">'至今'</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  let months <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  let days <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  let yearIdx <span class="token operator">=</span> <span class="token number">0</span>
  let monthIdx <span class="token operator">=</span> <span class="token number">0</span>
  let dayIdx <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token comment">// 重新设置年份列表</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>quick<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>let i <span class="token operator">=</span> nowYear<span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">1900</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      years<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>let i <span class="token operator">=</span> nowYear <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">1900</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      years<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  years<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> idx<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>v <span class="token operator">==</span><span class="token operator">=</span> year<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      yearIdx <span class="token operator">=</span> idx
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// 重新设置月份列表</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>let i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> monthsNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    months<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">formatNumber</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  months<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> idx<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>v <span class="token operator">==</span><span class="token operator">=</span> month<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      monthIdx <span class="token operator">=</span> idx
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// 重新设置日期列表</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>let i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> daysNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    days<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">formatNumber</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  days<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> idx<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>v <span class="token operator">==</span><span class="token operator">=</span> day<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      dayIdx <span class="token operator">=</span> idx
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  that<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    years<span class="token punctuation">,</span><span class="token comment">//年份列表</span>
    months<span class="token punctuation">,</span><span class="token comment">//月份列表</span>
    days<span class="token punctuation">,</span><span class="token comment">//日期列表</span>
    year<span class="token punctuation">,</span>
    month<span class="token punctuation">:</span> <span class="token function">formatNumber</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span><span class="token punctuation">,</span>
    day<span class="token punctuation">:</span> <span class="token function">formatNumber</span><span class="token punctuation">(</span>day<span class="token punctuation">)</span><span class="token punctuation">,</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// 年月日数组有数据后，重新再设置一下vualue才能跳转到对应位置</span>
  that<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    value<span class="token punctuation">:</span> <span class="token punctuation">[</span>yearIdx<span class="token punctuation">,</span> monthIdx<span class="token punctuation">,</span> dayIdx<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

function <span class="token function">formatNumber</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  n <span class="token operator">=</span> n<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> n<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">?</span> n <span class="token punctuation">:</span> <span class="token string">'0'</span> <span class="token operator">+</span> n
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  nowYear<span class="token punctuation">:</span> nowYear<span class="token punctuation">,</span>
  nowMonth<span class="token punctuation">:</span> nowMonth<span class="token punctuation">,</span>
  nowDay<span class="token punctuation">:</span> nowDay<span class="token punctuation">,</span>
  setDate<span class="token punctuation">:</span> setDate<span class="token punctuation">,</span>
  formatNumber<span class="token punctuation">:</span> formatNumber
<span class="token punctuation">}</span>

</code></pre>
    <p>
     （2）自定义日期picker组件封装（components/pickerDate文件夹）
    </p>
    <p>
     <strong>
      wxml
     </strong>
    </p>
    <pre><code class="prism language-c"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>components<span class="token operator">/</span>pickerDate<span class="token operator">/</span>index<span class="token punctuation">.</span>wxml<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view class<span class="token operator">=</span><span class="token string">"birthday"</span> bindtap<span class="token operator">=</span><span class="token string">"showBirthday"</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>text wx<span class="token punctuation">:</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"{<!-- -->{selectDate !== ''}}"</span><span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>selectDate<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>text class<span class="token operator">=</span><span class="token string">"ph-class"</span> wx<span class="token punctuation">:</span><span class="token keyword">else</span><span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>placeholder<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>view class<span class="token operator">=</span><span class="token string">"birthday-mask"</span> hidden<span class="token operator">=</span><span class="token string">"{<!-- -->{!pickerDateshow}}"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view class<span class="token operator">=</span><span class="token string">"birthday-box {<!-- -->{pickerDateshow?'birthday-show':''}}"</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>view class<span class="token operator">=</span><span class="token string">"picker-header"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>view class<span class="token operator">=</span><span class="token string">"picker-btn"</span> data<span class="token operator">-</span>index<span class="token operator">=</span><span class="token string">"{<!-- -->{index}}"</span> wx<span class="token punctuation">:</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"{<!-- -->{picker_btn}}"</span> wx<span class="token punctuation">:</span>key bindtap<span class="token operator">=</span><span class="token string">"selectBirthday"</span><span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>item<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>picker<span class="token operator">-</span>view class<span class="token operator">=</span><span class="token string">"birthday-picker"</span> indicator<span class="token operator">-</span>class<span class="token operator">=</span><span class="token string">"birthday-indicator"</span> value<span class="token operator">=</span><span class="token string">"{<!-- -->{value}}"</span> bindchange<span class="token operator">=</span><span class="token string">"bindChange"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>picker<span class="token operator">-</span>view<span class="token operator">-</span>column wx<span class="token punctuation">:</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"{<!-- -->{fields === 'year' || fields === 'month' || fields === 'day'}}"</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>view wx<span class="token punctuation">:</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"{<!-- -->{years}}"</span> wx<span class="token punctuation">:</span>key<span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>item <span class="token operator">==</span><span class="token operator">=</span> <span class="token string">'至今'</span> <span class="token operator">?</span> item <span class="token punctuation">:</span> item <span class="token operator">+</span> <span class="token string">'年'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>picker<span class="token operator">-</span>view<span class="token operator">-</span>column<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>picker<span class="token operator">-</span>view<span class="token operator">-</span>column wx<span class="token punctuation">:</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"{<!-- -->{fields === 'month' || fields === 'day'}}"</span> hidden<span class="token operator">=</span><span class="token string">"{<!-- -->{year === '至今'}}"</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>view wx<span class="token punctuation">:</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"{<!-- -->{months}}"</span> wx<span class="token punctuation">:</span>key<span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>item<span class="token punctuation">}</span><span class="token punctuation">}</span>月<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>picker<span class="token operator">-</span>view<span class="token operator">-</span>column<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>picker<span class="token operator">-</span>view<span class="token operator">-</span>column wx<span class="token punctuation">:</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"{<!-- -->{fields === 'day'}}"</span> hidden<span class="token operator">=</span><span class="token string">"{<!-- -->{year === '至今'}}"</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>view wx<span class="token punctuation">:</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"{<!-- -->{days}}"</span> wx<span class="token punctuation">:</span>key<span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>item<span class="token punctuation">}</span><span class="token punctuation">}</span>日<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>picker<span class="token operator">-</span>view<span class="token operator">-</span>column<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>picker<span class="token operator">-</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>


</code></pre>
    <p>
     <strong>
      wxss
     </strong>
    </p>
    <pre><code class="prism language-c"><span class="token comment">/* components/pickerDate/index.wxss */</span>
<span class="token punctuation">.</span>birthday <span class="token punctuation">{<!-- --></span>
  font<span class="token operator">-</span>size<span class="token punctuation">:</span> <span class="token number">32</span>rpx<span class="token punctuation">;</span>
  color<span class="token punctuation">:</span> #<span class="token number">16233</span>D<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>birthday <span class="token punctuation">.</span>ph<span class="token operator">-</span>class<span class="token punctuation">{<!-- --></span>
  font<span class="token operator">-</span>size<span class="token punctuation">:</span> <span class="token number">32</span>rpx<span class="token punctuation">;</span>
  color<span class="token punctuation">:</span> #C5C8CE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 自定义遮罩层*/</span>

<span class="token punctuation">.</span>birthday<span class="token operator">-</span>mask <span class="token punctuation">{<!-- --></span>
  width<span class="token punctuation">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
  height<span class="token punctuation">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
  background<span class="token operator">-</span>color<span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  position<span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
  bottom<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
  left<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 自定义按钮 */</span>

<span class="token punctuation">.</span>picker<span class="token operator">-</span>header <span class="token punctuation">{<!-- --></span>
  box<span class="token operator">-</span>sizing<span class="token punctuation">:</span> border<span class="token operator">-</span>box<span class="token punctuation">;</span>
  position<span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  top<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
  left<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
  width<span class="token punctuation">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
  padding<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">30</span>rpx<span class="token punctuation">;</span>
  display<span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  justify<span class="token operator">-</span>content<span class="token punctuation">:</span> space<span class="token operator">-</span>between<span class="token punctuation">;</span>
  align<span class="token operator">-</span>items<span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  border<span class="token operator">-</span>top<span class="token punctuation">:</span> <span class="token number">1</span>px solid #eee<span class="token punctuation">;</span>
  border<span class="token operator">-</span>bottom<span class="token punctuation">:</span> <span class="token number">1</span>px solid #eee<span class="token punctuation">;</span>
  background<span class="token operator">-</span>color<span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  z<span class="token operator">-</span>index<span class="token punctuation">:</span> <span class="token number">999</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>picker<span class="token operator">-</span>btn <span class="token punctuation">{<!-- --></span>
  padding<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">30</span>rpx<span class="token punctuation">;</span>
  line<span class="token operator">-</span>height<span class="token punctuation">:</span> <span class="token number">80</span>rpx<span class="token punctuation">;</span>
  color<span class="token punctuation">:</span> #<span class="token number">999</span><span class="token punctuation">;</span>
  font<span class="token operator">-</span>size<span class="token punctuation">:</span> <span class="token number">32</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>picker<span class="token operator">-</span>btn<span class="token punctuation">:</span>last<span class="token operator">-</span>child <span class="token punctuation">{<!-- --></span>
  color<span class="token punctuation">:</span> #FF4C00<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 自定义动画 */</span>

<span class="token punctuation">.</span>birthday<span class="token operator">-</span>box <span class="token punctuation">{<!-- --></span>
  width<span class="token punctuation">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
  padding<span class="token operator">-</span>top<span class="token punctuation">:</span> <span class="token number">80</span>rpx<span class="token punctuation">;</span>
  background<span class="token operator">-</span>color<span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
  position<span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
  bottom<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
  left<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
  transform<span class="token punctuation">:</span> <span class="token function">translateY</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  transition<span class="token punctuation">:</span> <span class="token number">0.5</span>s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>birthday<span class="token operator">-</span>show <span class="token punctuation">{<!-- --></span>
  transform<span class="token punctuation">:</span> <span class="token function">translateY</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>birthday<span class="token operator">-</span>picker <span class="token punctuation">{<!-- --></span>
  width<span class="token punctuation">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
  height<span class="token punctuation">:</span> <span class="token number">450</span>rpx<span class="token punctuation">;</span>
  text<span class="token operator">-</span>align<span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>birthday<span class="token operator">-</span>indicator <span class="token punctuation">{<!-- --></span>
  height<span class="token punctuation">:</span> <span class="token number">80</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>birthday<span class="token operator">-</span>picker picker<span class="token operator">-</span>view<span class="token operator">-</span>column view <span class="token punctuation">{<!-- --></span>
  display<span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  justify<span class="token operator">-</span>content<span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  align<span class="token operator">-</span>items<span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  font<span class="token operator">-</span>weight<span class="token punctuation">:</span> <span class="token number">400</span><span class="token punctuation">;</span>
  font<span class="token operator">-</span>size<span class="token punctuation">:</span> <span class="token number">32</span>rpx<span class="token punctuation">;</span>
  color<span class="token punctuation">:</span> #<span class="token number">525</span>B6E<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre>
    <p>
     <strong>
      js
     </strong>
    </p>
    <pre><code class="prism language-c"><span class="token keyword">const</span> date <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"../../utils/date.js"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>

  <span class="token comment">/**
   * 组件的属性列表
   */</span>
  properties<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    fields<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
      value<span class="token punctuation">:</span> <span class="token string">'day'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    quick<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      type<span class="token punctuation">:</span> Boolean<span class="token punctuation">,</span>
      value<span class="token punctuation">:</span> false
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    placeholder<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
      value<span class="token punctuation">:</span> <span class="token string">''</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    selectDate<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
      value<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  observers<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>  <span class="token comment">//监听日期是否改变并给年月日赋值</span>
    selectDate<span class="token punctuation">:</span> <span class="token function">function</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>val <span class="token operator">!=</span><span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        let arr <span class="token operator">=</span> val<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span>length <span class="token operator">==</span><span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          this<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            year<span class="token punctuation">:</span> <span class="token function">Number</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">.</span>length <span class="token operator">==</span><span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          this<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            year<span class="token punctuation">:</span> <span class="token function">Number</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            month<span class="token punctuation">:</span> <span class="token function">Number</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">.</span>length <span class="token operator">==</span><span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          this<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            year<span class="token punctuation">:</span> <span class="token function">Number</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            month<span class="token punctuation">:</span> <span class="token function">Number</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            day<span class="token punctuation">:</span> <span class="token function">Number</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 页面的初始数据
   */</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    pickerDateshow<span class="token punctuation">:</span> false<span class="token punctuation">,</span>
    picker_btn<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'取消'</span><span class="token punctuation">,</span> <span class="token string">'确定'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    years<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    months<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    days<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    year<span class="token punctuation">:</span> date<span class="token punctuation">.</span>nowYear<span class="token punctuation">,</span>
    month<span class="token punctuation">:</span> date<span class="token punctuation">.</span>nowMonth<span class="token punctuation">,</span>
    day<span class="token punctuation">:</span> date<span class="token punctuation">.</span>nowDay<span class="token punctuation">,</span>
    value<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//选中值的下标</span>
    selectDate<span class="token punctuation">:</span> <span class="token string">''</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 打开选框</span>
    showBirthday<span class="token punctuation">:</span> function <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      date<span class="token punctuation">.</span><span class="token function">setDate</span><span class="token punctuation">(</span>this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>quick<span class="token punctuation">,</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>year<span class="token punctuation">,</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>month<span class="token punctuation">,</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>day<span class="token punctuation">,</span> this<span class="token punctuation">)</span>
      this<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        pickerDateshow<span class="token punctuation">:</span> true
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      this<span class="token punctuation">.</span>value <span class="token operator">=</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>value<span class="token punctuation">;</span><span class="token comment">// 记录改变前的日期</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 关闭选框</span>
    selectBirthday<span class="token punctuation">:</span> function <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      let index <span class="token operator">=</span> e<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>index<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&amp;&amp;</span> index <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 确定选择 更换改变后的日期</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>this<span class="token punctuation">.</span>val<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          date<span class="token punctuation">.</span><span class="token function">setDate</span><span class="token punctuation">(</span>this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>quick<span class="token punctuation">,</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>years<span class="token punctuation">[</span>this<span class="token punctuation">.</span>val<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>months<span class="token punctuation">[</span>this<span class="token punctuation">.</span>val<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>days<span class="token punctuation">[</span>this<span class="token punctuation">.</span>val<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> this<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
          date<span class="token punctuation">.</span><span class="token function">setDate</span><span class="token punctuation">(</span>this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>quick<span class="token punctuation">,</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>years<span class="token punctuation">[</span>this<span class="token punctuation">.</span>value<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>months<span class="token punctuation">[</span>this<span class="token punctuation">.</span>value<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>days<span class="token punctuation">[</span>this<span class="token punctuation">.</span>value<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> this<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        let res <span class="token operator">=</span> <span class="token string">''</span>
        let data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>year <span class="token operator">==</span><span class="token operator">=</span> <span class="token string">'至今'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          res <span class="token operator">=</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>year
          data<span class="token punctuation">.</span>date <span class="token operator">=</span> res
          data<span class="token punctuation">.</span>year <span class="token operator">=</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>year
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>fields <span class="token operator">==</span><span class="token operator">=</span> <span class="token string">'year'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          res <span class="token operator">=</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>year
          data<span class="token punctuation">.</span>date <span class="token operator">=</span> res
          data<span class="token punctuation">.</span>year <span class="token operator">=</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>year
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>fields <span class="token operator">==</span><span class="token operator">=</span> <span class="token string">'month'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          res <span class="token operator">=</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>year <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>month
          data<span class="token punctuation">.</span>date <span class="token operator">=</span> res
          data<span class="token punctuation">.</span>year <span class="token operator">=</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>year
          data<span class="token punctuation">.</span>month <span class="token operator">=</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>month
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
          res <span class="token operator">=</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>year <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>month <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>day
          data<span class="token punctuation">.</span>date <span class="token operator">=</span> res
          data<span class="token punctuation">.</span>year <span class="token operator">=</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>year
          data<span class="token punctuation">.</span>month <span class="token operator">=</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>month
          data<span class="token punctuation">.</span>day <span class="token operator">=</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>day
        <span class="token punctuation">}</span>
        this<span class="token punctuation">.</span><span class="token function">triggerEvent</span><span class="token punctuation">(</span><span class="token string">'changeDate'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 取消选择 还原改变前的日期</span>
        date<span class="token punctuation">.</span><span class="token function">setDate</span><span class="token punctuation">(</span>this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>quick<span class="token punctuation">,</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>years<span class="token punctuation">[</span>this<span class="token punctuation">.</span>value<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>months<span class="token punctuation">[</span>this<span class="token punctuation">.</span>value<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>days<span class="token punctuation">[</span>this<span class="token punctuation">.</span>value<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> this<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      this<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        pickerDateshow<span class="token punctuation">:</span> false<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    bindChange<span class="token punctuation">:</span> function <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      let val <span class="token operator">=</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
      this<span class="token punctuation">.</span>val <span class="token operator">=</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value<span class="token punctuation">;</span> <span class="token comment">//记录改变后的日期</span>
      date<span class="token punctuation">.</span><span class="token function">setDate</span><span class="token punctuation">(</span>this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>quick<span class="token punctuation">,</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>years<span class="token punctuation">[</span>val<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>months<span class="token punctuation">[</span>val<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> this<span class="token punctuation">.</span>data<span class="token punctuation">.</span>days<span class="token punctuation">[</span>val<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> this<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>


</code></pre>
    <p>
     至此，日期组件已基本封装完成，接下来就是page页面的使用啦~~~
    </p>
    <p>
     （3）page使用
    </p>
    <p>
     <strong>
      json
     </strong>
    </p>
    <p>
     加上这一个配置
    </p>
    <pre><code class="prism language-c"><span class="token string">"usingComponents"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"pickerDate"</span><span class="token punctuation">:</span> <span class="token string">"/components/pickerDate/index"</span>
  <span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      wxml
     </strong>
    </p>
    <pre><code class="prism language-c"><span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>text style<span class="token operator">=</span><span class="token string">"color: red"</span><span class="token operator">&gt;</span>选中日期：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>endTime<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>pickerDate fields<span class="token operator">=</span><span class="token string">"day"</span> selectDate<span class="token operator">=</span><span class="token string">"{<!-- -->{endTime}}"</span> placeholder<span class="token operator">=</span><span class="token string">"请选择离职日期"</span> quick bind<span class="token punctuation">:</span>changeDate<span class="token operator">=</span><span class="token string">"onChangeDate"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>pickerDate<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
</code></pre>
    <p>
     <strong>
      js
     </strong>
    </p>
    <pre><code class="prism language-c"><span class="token comment">// date/index.js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>

  <span class="token comment">/**
   * 页面的初始数据
   */</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    endTime<span class="token punctuation">:</span> <span class="token string">''</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">onChangeDate</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    this<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      endTime<span class="token punctuation">:</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>date
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre>
    <h4>
     <a id="3_463">
     </a>
     3.答疑
    </h4>
    <p>
     可能会遇到的问题是日期组件与页面元素布局的层级问题，请参考另一篇文章
    </p>
    <p>
     <a href="https://blog.csdn.net/weixin_45439379/article/details/110822359">
      元素层级问题
     </a>
    </p>
    <hr color="#000000" size='1"'/>
    <h2>
     <a id="_470">
     </a>
     总结
    </h2>
    <p>
     两种方案，到这里就结束啦~~~
    </p>
    <p>
     有问题的话私聊我哦
    </p>
    <p>
     参考文章：
    </p>
    <p>
     https://www.jianshu.com/p/465104099778
    </p>
    <p>
     https://www.cnblogs.com/dreamstartplace/p/10826134.html
    </p>
    <p>
     https://www.freesion.com/article/6191257335
    </p>
    <p>
     https://blog.csdn.net/fly_666/article/details/103910334
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34353433393337392f:61727469636c652f64657461696c732f313130393236323133" class_="artid" style="display:none">
 </p>
</div>


