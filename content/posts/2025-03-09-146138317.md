---
layout: post
title: "C语言学习day25WinAPI编程进阶07-游戏辅助时钟周期事件定时器消息"
date: 2025-03-09 21:02:11 +0800
description: "接下来我们说一下时间周期（定时器）事件我们接下来继续用上一章中的代码来举例这次课程我们需要用的函数=SetTimer（）函数和KillTimer（）函数。"
keywords: "C语言学习day25：WinAPI编程进阶07-游戏辅助时钟周期事件、定时器消息"
categories: ['C']
tags: ['游戏', '学习', 'C']
artid: "146138317"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146138317
    alt: "C语言学习day25WinAPI编程进阶07-游戏辅助时钟周期事件定时器消息"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146138317
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146138317
cover: https://bing.ee123.net/img/rand?artid=146138317
image: https://bing.ee123.net/img/rand?artid=146138317
img: https://bing.ee123.net/img/rand?artid=146138317
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     C语言学习day25：WinAPI编程进阶07-游戏辅助时钟周期事件、定时器消息
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     接下来我们说一下时间周期（定时器）事件
    </p>
    <p>
     我们接下来继续用上一章中的代码来举例
    </p>
    <p>
     这次课程我们需要用的函数=SetTimer（）函数和KillTimer（）函数
    </p>
    <h2>
     SetTimer()
    </h2>
    <h3>
     语法：
    </h3>
    <pre><code class="language-cpp">UINT_PTR SetTimer(
  [in, optional] HWND      hWnd,
  [in]           UINT_PTR  nIDEvent,
  [in]           UINT      uElapse,
  [in, optional] TIMERPROC lpTimerFunc
);</code></pre>
    <h4>
     参数一：
    </h4>
    <p>
     类型：
     <strong>
      HWND
     </strong>
     <br/>
     要与计时器关联的窗口的句柄。 此窗口必须由调用线程拥有。 如果
     <em>
      hWnd
     </em>
     的
     <strong>
      NULL
     </strong>
     值与现有计时器的
     <em>
      nIDEvent
     </em>
     一起传入，则替换该计时器的方式与现有非 NULL
     <em>
      hWnd
     </em>
     计时器相同。
    </p>
    <h4>
     参数二：
    </h4>
    <p>
     类型：
     <strong>
      UINT_PTR
     </strong>
     <br/>
     非零计时器标识符。 如果
     <em>
      hWnd
     </em>
     参数为
     <strong>
      NULL
     </strong>
     ，并且
     <em>
      nIDEvent
     </em>
     与现有计时器不匹配，则忽略它并生成新的计时器 ID。
    </p>
    <h4>
     参数三：
    </h4>
    <p>
     类型：
     <strong>
      UINT
     </strong>
     <br/>
     超时值（以毫秒为单位）。
    </p>
    <h4>
     参数四：
    </h4>
    <p>
     类型：
     <strong>
      TIMERPROC
     </strong>
     <br/>
     指向在超时值过后要通知的函数的指针。 有关 函数的详细信息，请参阅
     <a href="https://learn.microsoft.com/zh-cn/windows/desktop/api/winuser/nc-winuser-timerproc" rel="nofollow" title="TimerProc">
      TimerProc
     </a>
     。
    </p>
    <h3>
     代码：
    </h3>
    <pre><code class="language-cpp">// 添加全局变量
int g_State = 0;

case WM_KEYDOWN:
        if (GetAsyncKeyState(VK_F1) != 0)
        {
            if (g_State == 0)
            {
                // 开启时钟
                SetTimer(hwnd, 1, 2000, NULL);
                g_State = 1;
            }</code></pre>
    <h2>
     KillTimer()
    </h2>
    <h3>
     语法：
    </h3>
    <h4>
     参数一：
    </h4>
    <p>
     类型：
     <strong>
      HWND
     </strong>
     <br/>
     与指定计时器关联的窗口的句柄。 此值必须与传递给创建计时器的
     <a href="https://learn.microsoft.com/zh-cn/windows/desktop/api/winuser/nf-winuser-settimer" rel="nofollow" title="SetTimer">
      SetTimer
     </a>
     函数的
     <em>
      hWnd
     </em>
     值相同。
    </p>
    <h4>
     参数二 ：
    </h4>
    <p>
     类型：
     <strong>
      UINT_PTR
     </strong>
     <br/>
     要销毁的计时器。 如果传递给
     <a href="https://learn.microsoft.com/zh-cn/windows/desktop/api/winuser/nf-winuser-settimer" rel="nofollow" title="SetTimer 的">
      SetTimer 的
     </a>
     窗口句柄有效，则此参数必须与
     <em>
      nIDEvent
     </em>
     相同
     <br/>
     传递给
     <strong>
      SetTimer 的值
     </strong>
     。 如果应用程序在
     <em>
      hWnd
     </em>
     设置为
     <strong>
      NULL
     </strong>
     的情况下调用
     <strong>
      SetTimer
     </strong>
     ，则此参数必须是
     <strong>
      SetTimer
     </strong>
     返回的计时器标识符。
    </p>
    <h3>
     代码
    </h3>
    <pre><code class="language-cpp">else
            {
                // 关闭时钟
                KillTimer(hwnd, 1);
                MessageBoxA(NULL,"已关闭","温馨提示",MB_OK);
                g_State = 0;
            }</code></pre>
    <h2>
     此外：
    </h2>
    <p>
     我们还加了一个判定，用来处理时钟消息。以下代码也就是说，每隔2s弹出一个框
    </p>
    <h3>
     代码：
    </h3>
    <pre><code class="language-cpp">case WM_TIMER:
    {
        MessageBoxA(NULL, "开启成功", "温馨提示", MB_OK);
        break;
    }</code></pre>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c:6f672e6373646e2e6e65742f7131333430373434313833362f:61727469636c652f64657461696c732f313436313338333137" class_="artid" style="display:none">
 </p>
</div>


