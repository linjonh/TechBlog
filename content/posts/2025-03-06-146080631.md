---
layout: post
title: "前端常用的设计模式"
date: 2025-03-06 21:20:48 +0800
description: "在软件工程中，设计模式是对软件设计中普遍存在的各种问题提出的解决方案；"
keywords: "前端常用的设计模式"
categories: ['未分类']
tags: ['设计模式', '前端']
artid: "146080631"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146080631
    alt: "前端常用的设计模式"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146080631
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146080631
cover: https://bing.ee123.net/img/rand?artid=146080631
image: https://bing.ee123.net/img/rand?artid=146080631
img: https://bing.ee123.net/img/rand?artid=146080631
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     前端常用的设计模式
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="_0">
     </a>
     什么是设计模式
    </h3>
    <p>
     在软件工程中，设计模式是对软件设计中普遍存在的各种问题提出的解决方案；
    </p>
    <h4>
     <a id="1__2">
     </a>
     1. 工厂模式
    </h4>
    <h5>
     <a id="11__3">
     </a>
     1.1 概念
    </h5>
    <p>
     工程模式是不暴露对象的具体逻辑，而是将逻辑封装在一个函数中；像工厂一样重复产生类型的产品，工程模式只需要我们传入正确的参数，就能生产类似的产品。
    </p>
    <h5>
     <a id="12__5">
     </a>
     1.2 实现
    </h5>
    <p>
     工厂模式根据抽象程度的不能分为：
    </p>
    <ol>
     <li>
      简单工厂模式
     </li>
     <li>
      工厂方法模式
     </li>
     <li>
      抽象工程模式
     </li>
    </ol>
    <h6>
     <a id="121__10">
     </a>
     1.2.1 简单工厂模式
    </h6>
    <p>
     简单工程模式也叫静态工程模式，用一个工厂对象创建同一个对象类的实例
    </p>
    <pre><code class="prism language-javascript"><span class="token keyword">function</span> <span class="token function">Factory</span><span class="token punctuation">(</span><span class="token parameter">career</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	 <span class="token keyword">function</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token parameter">career<span class="token punctuation">,</span> work</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		 <span class="token keyword">this</span><span class="token punctuation">.</span>career <span class="token operator">=</span> career
		 <span class="token keyword">this</span><span class="token punctuation">.</span>work <span class="token operator">=</span> work
	 <span class="token punctuation">}</span>
	 <span class="token keyword">let</span> work
	 <span class="token keyword">switch</span><span class="token punctuation">(</span>career<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		 <span class="token keyword">case</span> <span class="token string">'coder'</span><span class="token operator">:</span>
		 work <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">' Bug'</span><span class="token punctuation">]</span>
		 <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span>career<span class="token punctuation">,</span> work<span class="token punctuation">)</span>
	 <span class="token keyword">break</span>
	 <span class="token keyword">case</span> <span class="token string">'hr'</span><span class="token operator">:</span>
		 work <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">]</span>
		 <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span>career<span class="token punctuation">,</span> work<span class="token punctuation">)</span>
	 <span class="token keyword">break</span>
		 <span class="token keyword">case</span> <span class="token string">'driver'</span><span class="token operator">:</span>
		 work <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">' '</span><span class="token punctuation">]</span>
		 <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span>career<span class="token punctuation">,</span> work<span class="token punctuation">)</span>
		 <span class="token keyword">break</span>
	 <span class="token keyword">case</span> <span class="token string">'boss'</span><span class="token operator">:</span>
		 work <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">]</span>
		 <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span>career<span class="token punctuation">,</span> work<span class="token punctuation">)</span>
		 <span class="token keyword">break</span>
	 <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
<span class="token keyword">let</span> coder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Factory</span><span class="token punctuation">(</span><span class="token string">'coder'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> boss <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Factory</span><span class="token punctuation">(</span><span class="token string">'boss'</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     Factory就是一个简单工厂，当我们调用工厂函数时，只需要传递name、age、career就可以获取到包含用户工作内容的实例对象。
    </p>
    <h6>
     <a id="122__43">
     </a>
     1.2.2 工厂方法模式
    </h6>
    <p>
     工厂方法模式跟简单工厂模式差不多，但是把具体的产品放到了工厂函数的prototype中。这样一来，扩展产品种类就不必修改工厂函数，和心累就变成抽象类，也可以随时重写某种具体的产品。也就是相当于工厂总部不生产产品了，交给下辖分工厂进行生产；但是进入工厂之前，需要有个判断来验证你要生产的东西是否属于我们的工厂所生产范围，如果是，就丢给下辖工厂来进行生产
    </p>
    <pre><code class="prism language-javascript"><span class="token comment">// 工厂方法</span>
<span class="token keyword">function</span> <span class="token function">Factory</span><span class="token punctuation">(</span><span class="token parameter">career</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	 <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">Factory</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		 <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">this</span><span class="token punctuation">[</span>career<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		 <span class="token keyword">return</span> a<span class="token punctuation">;</span>
	 <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
		 <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Factory</span><span class="token punctuation">(</span>career<span class="token punctuation">)</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
<span class="token comment">// </span>
<span class="token class-name">Factory</span><span class="token punctuation">.</span>prototype<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
	 <span class="token string-property property">'coder'</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		 <span class="token keyword">this</span><span class="token punctuation">.</span>careerName <span class="token operator">=</span> <span class="token string">' '</span>
		 <span class="token keyword">this</span><span class="token punctuation">.</span>work <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">' Bug'</span><span class="token punctuation">]</span>
	 <span class="token punctuation">}</span><span class="token punctuation">,</span>
	 <span class="token string-property property">'hr'</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		 <span class="token keyword">this</span><span class="token punctuation">.</span>careerName <span class="token operator">=</span> <span class="token string">'HR'</span>
		 <span class="token keyword">this</span><span class="token punctuation">.</span>work <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">]</span>
	 <span class="token punctuation">}</span><span class="token punctuation">,</span>
	 <span class="token string-property property">'driver'</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		 <span class="token keyword">this</span><span class="token punctuation">.</span>careerName <span class="token operator">=</span> <span class="token string">' '</span>
		 <span class="token keyword">this</span><span class="token punctuation">.</span>work <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">' '</span><span class="token punctuation">]</span>
	 <span class="token punctuation">}</span><span class="token punctuation">,</span>
	 <span class="token string-property property">'boss'</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		 <span class="token keyword">this</span><span class="token punctuation">.</span>careerName <span class="token operator">=</span> <span class="token string">' '</span>
		 <span class="token keyword">this</span><span class="token punctuation">.</span>work <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">]</span>
	 <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
<span class="token keyword">let</span> coder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Factory</span><span class="token punctuation">(</span><span class="token string">'coder'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> hr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Factory</span><span class="token punctuation">(</span><span class="token string">'hr'</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     工厂方法核心代码是工厂里面的判断this是否属于工厂，也就是做了分支判断，这个工厂只做我能做的产品
    </p>
    <h6>
     <a id="233__80">
     </a>
     2.3.3 抽象工程模式
    </h6>
    <p>
     简单工厂模式和工厂方法模式都是直接生产实例，但是抽象工程模式不同，抽象工厂模式并不直接生产实例，而是用于对产品类族的创建
     <br/>
     简单来的说就是：简单工厂和方法工厂模式是生产产品，那么抽象工厂模式的工作就是生产工厂的
    </p>
    <pre><code class="prism language-javascript"><span class="token keyword">let</span> <span class="token function-variable function">CareerAbstractFactory</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">subType<span class="token punctuation">,</span> superType</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	 <span class="token comment">// 判断抽象工厂是否有该抽象类</span>
	 <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> CareerAbstractFactory<span class="token punctuation">[</span>superType<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		 <span class="token comment">// 缓存类</span>
		 <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
		 <span class="token comment">// 继承父类属性和方法</span>
		 <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CareerAbstractFactory</span><span class="token punctuation">[</span>superType<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		 <span class="token comment">// 将子类constructor指向父类</span>
		 subType<span class="token punctuation">.</span>constructor <span class="token operator">=</span> subType<span class="token punctuation">;</span>
		 <span class="token comment">// 子类原型继承父类</span>
		 subType<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	 <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
		 <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'抽象类不存在'</span><span class="token punctuation">)</span>
	 <span class="token punctuation">}</span> 
 <span class="token punctuation">}</span>
</code></pre>
    <p>
     上面代码中CareerAbstractFactory 就是一个抽象工厂方法，该方法在参数中传递子类和父类，在方法内部实现了子类对父类的继承。
    </p>
    <h4>
     <a id="2__102">
     </a>
     2. 单例模式
    </h4>
    <p>
     创建型模式，提供了一个创建对象的最佳方式，这种模式涉及到一个单一的类，该类负责创建自己的对象，同时确保只有单个对象被创建
     <br/>
     在应用程序运行期间，单例模式只会在全局作用域下创建一次实例对象，让所有需要调用的地方共享这一单例对象
    </p>
    <pre><code class="prism language-javascript"><span class="token comment">// 定义一个类</span>
<span class="token keyword">function</span> <span class="token function">Singleton</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	 <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
	 <span class="token keyword">this</span><span class="token punctuation">.</span>instance <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 原型扩展类的一个方法getName()</span>
<span class="token class-name">Singleton</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 获取类的实例</span>
Singleton<span class="token punctuation">.</span><span class="token function-variable function">getInstance</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	 <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>instance<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		 <span class="token keyword">this</span><span class="token punctuation">.</span>instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span>
	 <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>instance
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 获取对象1</span>
<span class="token keyword">const</span> a <span class="token operator">=</span> Singleton<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 获取对象2</span>
<span class="token keyword">const</span> b <span class="token operator">=</span> Singleton<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 进行比较</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a <span class="token operator">===</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <h4>
     <a id="3__130">
     </a>
     3. 策略模式
    </h4>
    <p>
     策略模式指是先定义一系列算法，把他们一个个封装起来，将不变的部分和变化的部分隔开
    </p>
    <p>
     一个基于策略模式的程序至少有两部分组成
     <br/>
     1、策略类，策略类封装了具体的算法，并负责具体的计算过程
     <br/>
     2、环境类Context,Context接受客户的请求，随后把请求委婉给一个策略类
    </p>
    <pre><code class="prism language-javascript"><span class="token keyword">var</span> <span class="token function-variable function">calculateBouns</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">salary<span class="token punctuation">,</span>level</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	 <span class="token keyword">if</span><span class="token punctuation">(</span>level <span class="token operator">===</span> <span class="token string">'A'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		 <span class="token keyword">return</span> salary <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span>
	 <span class="token keyword">if</span><span class="token punctuation">(</span>level <span class="token operator">===</span> <span class="token string">'B'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		 <span class="token keyword">return</span> salary <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span>
	 <span class="token keyword">if</span><span class="token punctuation">(</span>level <span class="token operator">===</span> <span class="token string">'C'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		 <span class="token keyword">return</span> salary <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 调用如下：</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">calculateBouns</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">,</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 16000</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">calculateBouns</span><span class="token punctuation">(</span><span class="token number">2500</span><span class="token punctuation">,</span><span class="token string">'B'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 7500</span>
</code></pre>
    <p>
     从上述可有看到，函数内部包含过多的if…else,并且后续改正的时候，需要在函数内部添加逻辑，违反了开放封闭原则
     <br/>
     使用策略模式，就是先定义一系列算法，把他们一个个封装起来，将不变的部分和变化的部分隔开
    </p>
    <pre><code class="prism language-javascript"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
	 <span class="token string-property property">"A"</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">salary</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		 <span class="token keyword">return</span> salary <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span><span class="token punctuation">,</span>
	 <span class="token string-property property">"B"</span> <span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">salary</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		 <span class="token keyword">return</span> salary <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span><span class="token punctuation">,</span>
	 <span class="token string-property property">"C"</span> <span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">salary</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		 <span class="token keyword">return</span> salary <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token function-variable function">calculateBouns</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">level<span class="token punctuation">,</span>salary</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">return</span> obj<span class="token punctuation">[</span>level<span class="token punctuation">]</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">calculateBouns</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 40000</span>
</code></pre>
    <h4>
     <a id="4__173">
     </a>
     4. 观察者模式
    </h4>
    <p>
     观察者模式定义了对象间的一种一对多的依赖关系，当一个对象的状态发生改变时，所有依赖它的对象都将得到通知，并自动更新
     <br/>
     观察者模式属于行为型模式，关注的是对象之间的通讯，观察者模式就是观察者和被观察者之间的通讯
    </p>
    <ol>
     <li>
      被观察者模式
     </li>
    </ol>
    <pre><code class="prism language-javascript"><span class="token keyword">class</span> <span class="token class-name">Subject</span> <span class="token punctuation">{<!-- --></span>
	 <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		 <span class="token keyword">this</span><span class="token punctuation">.</span>observerList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span>
	 <span class="token function">addObserver</span><span class="token punctuation">(</span><span class="token parameter">observer</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		 <span class="token keyword">this</span><span class="token punctuation">.</span>observerList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span>
	 <span class="token function">removeObserver</span><span class="token punctuation">(</span><span class="token parameter">observer</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		 <span class="token keyword">const</span> index <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>observerList<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span><span class="token parameter">o</span> <span class="token operator">=&gt;</span> o<span class="token punctuation">.</span>name <span class="token operator">===</span> observer<span class="token punctuation">.</span>nam
		e<span class="token punctuation">)</span><span class="token punctuation">;</span>
		 <span class="token keyword">this</span><span class="token punctuation">.</span>observerList<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span>
	 <span class="token function">notifyObservers</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		 <span class="token keyword">const</span> observers <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>observeList<span class="token punctuation">;</span>
		 observers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">observer</span> <span class="token operator">=&gt;</span> observer<span class="token punctuation">.</span><span class="token function">notified</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre>
    <ol start="2">
     <li>
      观察者
     </li>
    </ol>
    <pre><code class="prism language-javascript"><span class="token keyword">class</span> <span class="token class-name">Observer</span> <span class="token punctuation">{<!-- --></span>
	 <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> subject</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	 <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
	 <span class="token keyword">if</span> <span class="token punctuation">(</span>subject<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		 subject<span class="token punctuation">.</span><span class="token function">addObserver</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
 <span class="token function">notified</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token string">'got message'</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <ol start="3">
     <li>
      使用代码：
     </li>
    </ol>
    <pre><code class="prism language-javascript"><span class="token keyword">const</span> subject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Subject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> observerA <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Observer</span><span class="token punctuation">(</span><span class="token string">'observerA'</span><span class="token punctuation">,</span> subject<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> observerB <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Observer</span><span class="token punctuation">(</span><span class="token string">'observerB'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
subject<span class="token punctuation">.</span><span class="token function">addObserver</span><span class="token punctuation">(</span>observerB<span class="token punctuation">)</span><span class="token punctuation">;</span>
subject<span class="token punctuation">.</span><span class="token function">notifyObservers</span><span class="token punctuation">(</span><span class="token string">'Hello from subject'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
subject<span class="token punctuation">.</span><span class="token function">removeObserver</span><span class="token punctuation">(</span>observerA<span class="token punctuation">)</span><span class="token punctuation">;</span>
subject<span class="token punctuation">.</span><span class="token function">notifyObservers</span><span class="token punctuation">(</span><span class="token string">'Hello again'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     观察者主动申请加入被观察者的列表，被观察者主动将观察者加入列表
    </p>
    <h4>
     <a id="5__226">
     </a>
     5. 发布订阅模式
    </h4>
    <p>
     发布-订阅是一种消息范式，消息的发送者（发布者）不会将消息直接发送给特定的接受者（订阅者）。而是将发布的消息分为不同的类别，无须了解那些订阅者可能存在，同样，订阅者可以表达对一个或多个类别的兴趣，只接收感兴趣的消息，无须了解那些发布者存在
    </p>
    <pre><code class="prism language-javascript"><span class="token keyword">class</span> <span class="token class-name">PubSub</span> <span class="token punctuation">{<!-- --></span>
 <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	 <span class="token keyword">this</span><span class="token punctuation">.</span>messages <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	 <span class="token keyword">this</span><span class="token punctuation">.</span>listeners <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 <span class="token comment">// 添加发布者</span>
 <span class="token function">publish</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> content</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	 <span class="token keyword">const</span> existContent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>messages<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">;</span>
	 <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>existContent<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		 <span class="token keyword">this</span><span class="token punctuation">.</span>messages<span class="token punctuation">[</span>type<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span>
	 <span class="token keyword">this</span><span class="token punctuation">.</span>messages<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 <span class="token comment">// 添加订阅者</span>
 <span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	 <span class="token keyword">const</span> existListener <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listeners<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">;</span>
	 <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>existListener<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		 <span class="token keyword">this</span><span class="token punctuation">.</span>listeners<span class="token punctuation">[</span>type<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span>
	 <span class="token keyword">this</span><span class="token punctuation">.</span>listeners<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 <span class="token comment">// 通知</span>
 <span class="token function">notify</span><span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	 <span class="token keyword">const</span> messages <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>messages<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">;</span>
	 <span class="token keyword">const</span> subscribers <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listeners<span class="token punctuation">[</span>type<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	 subscribers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cb<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">cb</span><span class="token punctuation">(</span>messages<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
</code></pre>
    <p>
     发布者代码
    </p>
    <pre><code class="prism language-javascript"><span class="token keyword">class</span> <span class="token class-name">Publisher</span> <span class="token punctuation">{<!-- --></span>
	 <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		 <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
		 <span class="token keyword">this</span><span class="token punctuation">.</span>context <span class="token operator">=</span> context<span class="token punctuation">;</span>
	 <span class="token punctuation">}</span>
	 <span class="token function">publish</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> content</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		 <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
</code></pre>
    <p>
     订阅者代码
    </p>
    <pre><code class="prism language-javascript"><span class="token keyword">class</span> <span class="token class-name">Subscriber</span> <span class="token punctuation">{<!-- --></span>
 <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	 <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
	 <span class="token keyword">this</span><span class="token punctuation">.</span>context <span class="token operator">=</span> context<span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 <span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	 <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> cb<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     使用代码：
    </p>
    <pre><code class="prism language-javascript"><span class="token keyword">const</span> <span class="token constant">TYPE_A</span> <span class="token operator">=</span> <span class="token string">'music'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">TYPE_B</span> <span class="token operator">=</span> <span class="token string">'movie'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">TYPE_C</span> <span class="token operator">=</span> <span class="token string">'novel'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> pubsub <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PubSub</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> publisherA <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Publisher</span><span class="token punctuation">(</span><span class="token string">'publisherA'</span><span class="token punctuation">,</span> pubsub<span class="token punctuation">)</span><span class="token punctuation">;</span>
publisherA<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token constant">TYPE_A</span><span class="token punctuation">,</span> <span class="token string">'we are young'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
publisherA<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token constant">TYPE_B</span><span class="token punctuation">,</span> <span class="token string">'the silicon valley'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> publisherB <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Publisher</span><span class="token punctuation">(</span><span class="token string">'publisherB'</span><span class="token punctuation">,</span> pubsub<span class="token punctuation">)</span><span class="token punctuation">;</span>
publisherB<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token constant">TYPE_A</span><span class="token punctuation">,</span> <span class="token string">'stronger'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> publisherC <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Publisher</span><span class="token punctuation">(</span><span class="token string">'publisherC'</span><span class="token punctuation">,</span> pubsub<span class="token punctuation">)</span><span class="token punctuation">;</span>
publisherC<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token constant">TYPE_C</span><span class="token punctuation">,</span> <span class="token string">'a brief history of time'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> subscriberA <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Subscriber</span><span class="token punctuation">(</span><span class="token string">'subscriberA'</span><span class="token punctuation">,</span> pubsub<span class="token punctuation">)</span><span class="token punctuation">;</span>
subscriberA<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token constant">TYPE_A</span><span class="token punctuation">,</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'subscriberA received'</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> subscriberB <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Subscriber</span><span class="token punctuation">(</span><span class="token string">'subscriberB'</span><span class="token punctuation">,</span> pubsub<span class="token punctuation">)</span><span class="token punctuation">;</span>
subscriberB<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token constant">TYPE_C</span><span class="token punctuation">,</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'subscriberB received'</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> subscriberC <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Subscriber</span><span class="token punctuation">(</span><span class="token string">'subscriberC'</span><span class="token punctuation">,</span> pubsub<span class="token punctuation">)</span><span class="token punctuation">;</span>
subscriberC<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token constant">TYPE_B</span><span class="token punctuation">,</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'subscriberC received'</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pubsub<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token constant">TYPE_A</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pubsub<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token constant">TYPE_B</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pubsub<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token constant">TYPE_C</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     发布者和订阅者需要通过发布订阅中心进行关联，发布者的发布动作和订阅者的订阅动作相互独立，消息派发由发布订阅中心负责
    </p>
    <h5>
     <a id="_314">
     </a>
     发布订阅模式余观察者模式区别
    </h5>
    <ol>
     <li>
      在观察者模式中，观察者是知道被观察者的，被观察者一直保持对观察者进行记录，然后在发布订阅模式中，发布者和订阅者不知道对方的存在。他们只有通过消息代理进行通信
     </li>
     <li>
      在发布订阅中，组件是松散耦合的，正好和观察者相反
     </li>
     <li>
      观察者模式大多数时候是同步的，不如当事件触发，被观察就会去调用观察者的方法。而发布-订阅模式大多数是异步的（使用消息队列）
     </li>
    </ol>
    <h4>
     <a id="6_318">
     </a>
     6.代理模式
    </h4>
    <p>
     代理模式是为一个对象提供一个代用品或占位符，以便控制对它的访问
     <br/>
     代理模式的关键是，当客户不方便直接访问一个对象或者不满足需要时，提供一个替身对象来控制这个对象的访问，客户实际上访问的是替身对象
    </p>
    <h5>
     <a id="1__322">
     </a>
     1. 缓存代理
    </h5>
    <p>
     缓存代理可以为一些开销大的运算结果提供暂时的存储，在下次运算时，如果传递进来的参数跟之前一致，则可以直接返回前端存储的运算结果
     <br/>
     实现一个求积的函数
    </p>
    <pre><code class="prism language-javascript"><span class="token keyword">var</span> <span class="token function-variable function">muti</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"开始计算乘积"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	 <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	 <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		 a <span class="token operator">=</span> a <span class="token operator">*</span> arguments<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span>
	 <span class="token keyword">return</span> a<span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     缓存代理
    </p>
    <pre><code class="prism language-javascript"><span class="token keyword">var</span> proxyMult <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	 <span class="token keyword">var</span> cache <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	 <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		 <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		 <span class="token keyword">if</span> <span class="token punctuation">(</span>args <span class="token keyword">in</span> cache<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		 <span class="token keyword">return</span> cache<span class="token punctuation">[</span>args<span class="token punctuation">]</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span>
	 <span class="token keyword">return</span> <span class="token punctuation">(</span>cache<span class="token punctuation">[</span>args<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">mult</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <h5>
     <a id="2_350">
     </a>
     2.虚拟代理
    </h5>
    <p>
     虚拟代理把一些开销很大的对象，延迟到真正需要它的时候才去创建
     <br/>
     常见的就是图片预加载
    </p>
    <pre><code class="prism language-javascript"><span class="token comment">// 图片本地对象，负责往页面中创建一个img标签，并且提供一个对外的setSrc接口</span>
<span class="token keyword">let</span> myImage <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	 <span class="token keyword">let</span> imgNode <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span> <span class="token string">'img'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
	 document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span> imgNode <span class="token punctuation">)</span><span class="token punctuation">;</span>
	 <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
		 <span class="token comment">//setSrc接口，外界调用这个接口，便可以给该img标签设置src属性</span>
		 <span class="token function-variable function">setSrc</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">src</span> <span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			 imgNode<span class="token punctuation">.</span>src <span class="token operator">=</span> src<span class="token punctuation">;</span>
		 <span class="token punctuation">}</span>
	 <span class="token punctuation">}</span> 
 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 代理对象，负责图片预加载功能</span>
<span class="token keyword">let</span> proxyImage <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	 <span class="token comment">// 创建一个Image对象，用于加载需要设置的图片</span>
	 <span class="token keyword">let</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">;</span>
	 img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		 <span class="token comment">// 监听到图片加载完成时后，给被代理的图片本地对象src为加载完成后的图片</span>
		 myImage<span class="token punctuation">.</span><span class="token function">setSrc</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">.</span>src <span class="token punctuation">)</span><span class="token punctuation">;</span>
	 <span class="token punctuation">}</span>
	 <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
		 <span class="token function-variable function">setSrc</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">src</span> <span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		 <span class="token comment">// 设置图片时，在图片并未被真正加载好时，以这张图作为loading，提供用户图片正在加载</span>
		 myImage<span class="token punctuation">.</span><span class="token function">setSrc</span><span class="token punctuation">(</span> 'https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>img<span class="token punctuation">.</span>zcool<span class="token punctuation">.</span>cn<span class="token operator">/</span>community<span class="token operator">/</span>01deed57601906
		0000018c1bd2352d<span class="token punctuation">.</span>gif' <span class="token punctuation">)</span><span class="token punctuation">;</span>
		 img<span class="token punctuation">.</span>src <span class="token operator">=</span> src<span class="token punctuation">;</span>
	 <span class="token punctuation">}</span>
 <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
proxyImage<span class="token punctuation">.</span><span class="token function">setSrc</span><span class="token punctuation">(</span> <span class="token string">'https://xxx.jpg'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <h5>
     <a id="3_384">
     </a>
     3.保护代理
    </h5>
    <p>
     保护代理主要实现了访问主体的限制行为，以过滤字符作为简单的例子。
    </p>
    <pre><code class="prism language-javascript"><span class="token keyword">function</span> <span class="token function">sendMsg</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">proxySendMsg</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> msg <span class="token operator">===</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'deny'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  msg <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">''</span> <span class="token operator">+</span> msg<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'z'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">sendMsg</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">sendMsg</span><span class="token punctuation">(</span><span class="token string">'zll'</span><span class="token punctuation">)</span>
<span class="token function">proxySendMsg</span><span class="token punctuation">(</span><span class="token string">"zll"</span><span class="token punctuation">)</span>
<span class="token function">proxySendMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34303132313330382f:61727469636c652f64657461696c732f313436303830363331" class_="artid" style="display:none">
 </p>
</div>


