---
layout: post
title: "详细讲解如何使用Java连接Kafka构建生产者和消费者带测试样例"
date: 2025-01-19 12:38:29 +0800
description: "详细讲解如何使用Java连接Kafka构建生产者和消费者。_java 模拟kafka生产消费"
keywords: "java 模拟kafka生产消费"
categories: ['消息队列']
tags: ['Kafka', 'Java']
artid: "126154171"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=126154171
    alt: "详细讲解如何使用Java连接Kafka构建生产者和消费者带测试样例"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=126154171
featuredImagePreview: https://bing.ee123.net/img/rand?artid=126154171
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     详细讲解如何使用Java连接Kafka构建生产者和消费者（带测试样例）
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atelier-sulphurpool-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="1__0">
     </a>
     1 缘起
    </h2>
    <p>
     学习消息队列的过程中，先补习了RabbitMQ相关知识，
     <br/>
     接着又重温了Kafka相关的知识，
     <br/>
     发现，我并没有积累Java原生操作Kafka的文章，
     <br/>
     只使用SpringBoot集成过Kafka，
     <br/>
     所以，本次是纯Java的方式操作Kafka，
     <br/>
     构建生产者和消费者，本地部署Kafka环境，给出测试样例的测试结果，
     <br/>
     同时，讲解部分通用的参数，
     <br/>
     及给出通过命令行启动生产者和消费者的测试样例，
     <br/>
     分享如下，帮助读者学习Kafka基础操作。
    </p>
    <h2>
     <a id="2__10">
     </a>
     2 环境准备
    </h2>
    <p>
     下载kafka：
     <a href="https://download.csdn.net/download/Xin_101/19787459">
      https://download.csdn.net/download/Xin_101/19787459
     </a>
    </p>
    <h3>
     <a id="21_zookeeper_12">
     </a>
     2.1 启动zookeeper
    </h3>
    <pre><code>bin/zookeeper-server-start.sh config/zookeeper.properties
</code></pre>
    <h3>
     <a id="22_kafka_16">
     </a>
     2.2 启动kafka
    </h3>
    <pre><code>bin/kafka-server-start.sh config/server.properties
</code></pre>
    <h3>
     <a id="23_topic_20">
     </a>
     2.3 新建topic
    </h3>
    <pre><code>bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic my-topic
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/64c94e145604828e811a07b40d4eb04b.png#pic_center"/>
    </p>
    <h3>
     <a id="24__25">
     </a>
     2.4 依赖
    </h3>
    <pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.kafka<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>kafka-clients<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.2.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <h2>
     <a id="3_Kafka_34">
     </a>
     3 Kafka通用配置
    </h2>
    <p>
     Kafka的生产者和消费者参数比较多，这里仅列出一些测试用的参数，
     <br/>
     区分生产者和消费者。
    </p>
    <h3>
     <a id="31__37">
     </a>
     3.1 生产者配置参数
    </h3>
    <table>
     <thead>
      <tr>
       <th>
        序号
       </th>
       <th>
        参数
       </th>
       <th align="left">
        描述
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        1
       </td>
       <td>
        bootstrap.servers
       </td>
       <td align="left">
        Kafka主机
       </td>
      </tr>
      <tr>
       <td>
        2
       </td>
       <td>
        acks
       </td>
       <td align="left">
        生产者：要求leader请求结束前收到的确认次数，来控制发送数据的持久化
        <br/>
        消息确认：
        <br/>
        0：生产者不等待服务器确认，此时retry参数不生效
        <br/>
        1：leader写入记录到log，不会等待follower的确认即向生产者发送通知
        <br/>
        all：leader等待所有副本通知，然后向生产者发送通知，保证所有数据落盘到所有副本，功能同设置为-1
       </td>
      </tr>
      <tr>
       <td>
        3
       </td>
       <td>
        retries
       </td>
       <td align="left">
        生产者重试次数
       </td>
      </tr>
      <tr>
       <td>
        4
       </td>
       <td>
        batch.size
       </td>
       <td align="left">
        生产者：向同一分区发送打包发送的数据量，单位：bytes，默认16384bytes=16K
       </td>
      </tr>
      <tr>
       <td>
        5
       </td>
       <td>
        linger.ms
       </td>
       <td align="left">
        生产者：批量发送消息的间隔时间（延迟时间），单位：毫秒
       </td>
      </tr>
      <tr>
       <td>
        6
       </td>
       <td>
        buffer.memory
       </td>
       <td align="left">
        生产者：可以使用的最大缓存空间，单位：bytes，默认33554432bytes=32M
       </td>
      </tr>
      <tr>
       <td>
        7
       </td>
       <td>
        key.serializer
       </td>
       <td align="left">
        生产者：键编码器
       </td>
      </tr>
      <tr>
       <td>
        8
       </td>
       <td>
        value.serializer
       </td>
       <td align="left">
        生产者：值编码器
       </td>
      </tr>
     </tbody>
    </table>
    <h3>
     <a id="32__49">
     </a>
     3.2 消费者配置参数
    </h3>
    <table>
     <thead>
      <tr>
       <th>
        序号
       </th>
       <th>
        参数
       </th>
       <th align="left">
        描述
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        1
       </td>
       <td>
        bootstrap.servers
       </td>
       <td align="left">
        Kafka主机
       </td>
      </tr>
      <tr>
       <td>
        2
       </td>
       <td>
        group.id
       </td>
       <td align="left">
        消费者：消费topic的组ID
       </td>
      </tr>
      <tr>
       <td>
        3
       </td>
       <td>
        enable.auto.commit
       </td>
       <td align="left">
        消费者：后台定期提交offset
       </td>
      </tr>
      <tr>
       <td>
        4
       </td>
       <td>
        auto.commit.interval.ms
       </td>
       <td align="left">
        消费者提交offset的时间间隔：单位：毫秒，当enable.auto.commit为true时生效
       </td>
      </tr>
      <tr>
       <td>
        5
       </td>
       <td>
        auto.offset.reset
       </td>
       <td align="left">
        消费者：重启后配置offset
        <br/>
        earliest：消费者恢复到当前topic最早的offset
        <br/>
        latest：消费者从最新的offset开始消费
        <br/>
        none：如果消费者组没找到之前的offset抛出异常
        <br/>
        其他任何值都会抛出异常
       </td>
      </tr>
      <tr>
       <td>
        6
       </td>
       <td>
        key.deserializer
       </td>
       <td align="left">
        消费者：键解码器
       </td>
      </tr>
      <tr>
       <td>
        7
       </td>
       <td>
        value.deserializer
       </td>
       <td align="left">
        消费者：值解码器
       </td>
      </tr>
     </tbody>
    </table>
    <h3>
     <a id="33_Kafka_60">
     </a>
     3.3 Kafka通用参数封装
    </h3>
    <p>
     由于参数众多，这里封装了一个Kafka通用参数类，给了默认值，
     <br/>
     本地测试，直接使用默认参数，
     <br/>
     同时给出了有参构造器，自定义参数，
     <br/>
     代码样例如下。
    </p>
    <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>monkey<span class="token punctuation">.</span>java_study<span class="token punctuation">.</span>mq<span class="token punctuation">.</span>kafka</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Collection</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Collections</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Kafka通用配置.
 *
 * @author xindaqi
 * @since 2022-08-03 9:49
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">KafkaCommonProperties</span> <span class="token punctuation">{<!-- --></span>

    <span class="token comment">/**
     * Kafka主机
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> kafkaHost <span class="token operator">=</span> <span class="token string">"192.168.211.129:9092"</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 生产者：要求leader请求结束前收到的确认次数，来控制发送数据的持久化
     * 消息确认：
     * 0：生产者不等待服务器确认，此时retry参数不生效
     * 1：leader写入记录到log，不会等待follower的确认即向生产者发送通知
     * all：leader等待所有副本通知，然后向生产者发送通知，保证所有数据落盘到所有副本，功能同设置为-1
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> ack <span class="token operator">=</span> <span class="token string">"all"</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 生产者重试次数
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> retryTimes <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 生产者：向同一分区发送打包发送的数据量，单位：bytes，默认16384bytes=16K
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> batchSize <span class="token operator">=</span> <span class="token number">16384</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 生产者：批量发送消息的间隔时间（延迟时间），单位：毫秒
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> lingerMs <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 生产者：可以使用的最大缓存空间，单位：bytes，默认33554432bytes=32M.
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> bufferMemory <span class="token operator">=</span> <span class="token number">33554432</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 生产者：键编码器
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> keyEncoder <span class="token operator">=</span> <span class="token string">"org.apache.kafka.common.serialization.StringSerializer"</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 生产者：值编码器
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> valueEncoder <span class="token operator">=</span> <span class="token string">"org.apache.kafka.common.serialization.StringSerializer"</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 消费者：消费topic的组ID
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> groupId <span class="token operator">=</span> <span class="token string">"my-group-id"</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 消费者：后台定期提交offset
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> autoCommit <span class="token operator">=</span> <span class="token string">"true"</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 消费者提交offset的时间间隔：单位：毫秒，当enable.auto.commit为true时生效
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> autoCommitIntervalMs <span class="token operator">=</span> <span class="token string">"1000"</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 消费者：键解码器
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> keyDecoder <span class="token operator">=</span> <span class="token string">"org.apache.kafka.common.serialization.StringDeserializer"</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 消费者：值解码器
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> valueDecoder <span class="token operator">=</span> <span class="token string">"org.apache.kafka.common.serialization.StringDeserializer"</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 消费者：重启后配置offset
     * earliest：消费者恢复到当前topic最早的offset
     * latest：消费者从最新的offset开始消费
     * none：如果消费者组没找到之前的offset抛出异常
     * 其他任何值都会抛出异常
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> autoOffsetReset <span class="token operator">=</span> <span class="token string">"latest"</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * TOPIC
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> topic <span class="token operator">=</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">singleton</span><span class="token punctuation">(</span><span class="token string">"my-topic"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">KafkaCommonProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">KafkaCommonProperties</span><span class="token punctuation">(</span><span class="token class-name">String</span> kafkaHost<span class="token punctuation">,</span> <span class="token class-name">String</span> ack<span class="token punctuation">,</span> <span class="token class-name">Integer</span> retryTimes<span class="token punctuation">,</span> <span class="token class-name">Integer</span> batchSize<span class="token punctuation">,</span> <span class="token class-name">Integer</span> lingerMs<span class="token punctuation">,</span> <span class="token class-name">Integer</span> bufferMemory<span class="token punctuation">,</span> <span class="token class-name">String</span> keyEncoder<span class="token punctuation">,</span> <span class="token class-name">String</span> valueEncoder<span class="token punctuation">,</span> <span class="token class-name">String</span> groupId<span class="token punctuation">,</span> <span class="token class-name">String</span> autoCommit<span class="token punctuation">,</span> <span class="token class-name">String</span> autoCommitIntervalMs<span class="token punctuation">,</span> <span class="token class-name">String</span> keyDecoder<span class="token punctuation">,</span> <span class="token class-name">String</span> valueDecoder<span class="token punctuation">,</span> <span class="token class-name">String</span> autoOffsetReset<span class="token punctuation">,</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> topic<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>kafkaHost <span class="token operator">=</span> kafkaHost<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>ack <span class="token operator">=</span> ack<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>retryTimes <span class="token operator">=</span> retryTimes<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>batchSize <span class="token operator">=</span> batchSize<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>lingerMs <span class="token operator">=</span> lingerMs<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>bufferMemory <span class="token operator">=</span> bufferMemory<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>keyEncoder <span class="token operator">=</span> keyEncoder<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>valueEncoder <span class="token operator">=</span> valueEncoder<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>groupId <span class="token operator">=</span> groupId<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>autoCommit <span class="token operator">=</span> autoCommit<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>autoCommitIntervalMs <span class="token operator">=</span> autoCommitIntervalMs<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>keyDecoder <span class="token operator">=</span> keyDecoder<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>valueDecoder <span class="token operator">=</span> valueDecoder<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>autoOffsetReset <span class="token operator">=</span> autoOffsetReset<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>topic <span class="token operator">=</span> topic<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token comment">// 省略setter和getter及toString()  </span>
<span class="token punctuation">}</span>
</code></pre>
    <h2>
     <a id="4_Code_186">
     </a>
     4 Code实践
    </h2>
    <h3>
     <a id="41__187">
     </a>
     4.1 生产者
    </h3>
    <p>
     构建Kafka数据生产者，
     <br/>
     测试样例的配置有：Kafka broker地址，消息确认，重试，批量发送数据，数据键和值的编码器，
     <br/>
     重写Callback实现异步生产数据。
    </p>
    <h4>
     <a id="411__192">
     </a>
     4.1.1 生产数据
    </h4>
    <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>monkey<span class="token punctuation">.</span>java_study<span class="token punctuation">.</span>mq<span class="token punctuation">.</span>kafka</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>producer<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Objects</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Properties</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Kafka生产者.
 *
 * @author xindaqi
 * @since 2022-08-02 9:59
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">KafkaProducerTest</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">KafkaProducerTest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">KafkaProducer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getDefaultKafkaProducer</span><span class="token punctuation">(</span><span class="token class-name">KafkaCommonProperties</span> kafkaCommonProperties<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Properties</span> properties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ProducerConfig</span><span class="token punctuation">.</span>BOOTSTRAP_SERVERS_CONFIG<span class="token punctuation">,</span> kafkaCommonProperties<span class="token punctuation">.</span><span class="token function">getKafkaHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ProducerConfig</span><span class="token punctuation">.</span>ACKS_CONFIG<span class="token punctuation">,</span> kafkaCommonProperties<span class="token punctuation">.</span><span class="token function">getAck</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ProducerConfig</span><span class="token punctuation">.</span>RETRIES_CONFIG<span class="token punctuation">,</span> kafkaCommonProperties<span class="token punctuation">.</span><span class="token function">getRetryTimes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ProducerConfig</span><span class="token punctuation">.</span>BATCH_SIZE_CONFIG<span class="token punctuation">,</span> kafkaCommonProperties<span class="token punctuation">.</span><span class="token function">getBatchSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ProducerConfig</span><span class="token punctuation">.</span>LINGER_MS_CONFIG<span class="token punctuation">,</span> kafkaCommonProperties<span class="token punctuation">.</span><span class="token function">getLingerMs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ProducerConfig</span><span class="token punctuation">.</span>BUFFER_MEMORY_CONFIG<span class="token punctuation">,</span> kafkaCommonProperties<span class="token punctuation">.</span><span class="token function">getBufferMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ProducerConfig</span><span class="token punctuation">.</span>KEY_SERIALIZER_CLASS_CONFIG<span class="token punctuation">,</span> kafkaCommonProperties<span class="token punctuation">.</span><span class="token function">getKeyEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ProducerConfig</span><span class="token punctuation">.</span>VALUE_SERIALIZER_CLASS_CONFIG<span class="token punctuation">,</span> kafkaCommonProperties<span class="token punctuation">.</span><span class="token function">getValueEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">KafkaProducer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">MyProducerCallback</span> <span class="token keyword">implements</span> <span class="token class-name">Callback</span> <span class="token punctuation">{<!-- --></span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCompletion</span><span class="token punctuation">(</span><span class="token class-name">RecordMetadata</span> metadata<span class="token punctuation">,</span> <span class="token class-name">Exception</span> exception<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">nonNull</span><span class="token punctuation">(</span>exception<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Producer生产消息异常："</span><span class="token punctuation">,</span> exception<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">nonNull</span><span class="token punctuation">(</span>metadata<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Producer生产消息：metadata：{}，partition:{}, offset：{}"</span><span class="token punctuation">,</span> metadata<span class="token punctuation">,</span> metadata<span class="token punctuation">.</span><span class="token function">partition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> metadata<span class="token punctuation">.</span><span class="token function">offset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">KafkaCommonProperties</span> kafkaCommonProperties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KafkaCommonProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">KafkaProducer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> producer <span class="token operator">=</span> <span class="token function">getDefaultKafkaProducer</span><span class="token punctuation">(</span>kafkaCommonProperties<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> message <span class="token operator">=</span> <span class="token string">"hello world "</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 异步写入数据</span>
                <span class="token class-name">String</span> topic <span class="token operator">=</span> kafkaCommonProperties<span class="token punctuation">.</span><span class="token function">getTopic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">ProducerRecord</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> producerRecord <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ProducerRecord</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>topic<span class="token punctuation">,</span> message <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                producer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>producerRecord<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">MyProducerCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;生产数据异常："</span><span class="token punctuation">,</span> ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
            producer<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="412__259">
     </a>
     4.1.2 开启生产者
    </h4>
    <p>
     生产者开启后，控制台输出生产者配置信息，如下图所示，其中，
     <br/>
     acks在代码中配置为all，而运行日志中acks为-1，所以，acks的all与-1是同种功能。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/4fce1750d68b269e330626fbb1765ef1.png#pic_center">
      <br/>
      生产者生产数据是通过异步的方式，控制台日志如下图所示，
      <br/>
      由图可知，生产数据的线程为：kafka-producer-network-thread。
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/50689ccd99c02b908c6d475028e11823.png#pic_center"/>
     </img>
    </p>
    <h3>
     <a id="42__267">
     </a>
     4.2 消费者
    </h3>
    <p>
     Kafka消费者通过groupId消费指定topic的，
     <br/>
     以groupId区分不同的消费者，即不同的groupId消费相同的topic，对于topic而言，就是不同的消费者，
     <br/>
     同时，消费者需要记录消费到的offset，以便下次启动时定位到具体的位置，消费消息。
     <br/>
     这里，配置的offset策略为：latest，即每次重启消费者时，从最新的offset开始消费（上次记录的offset之后的一个，如果上次消费没有记录，则从当前offset之后开始消费）。
     <br/>
     offset的重置这样理解：
     <br/>
     当前topic写入数据有4条，offset从0到3，
     <br/>
     如果，offset重设为earliest，则每次重启消费者，offset都会从0开始消费数据；
     <br/>
     如果，offset重设为latest，则，每次消费从上次消费的offset下一个开始消费，如果上次消费的offset为3，则，重启后， 从4开始消费数据。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/2ddee8766386e893abd30f4de0635287.png#pic_center"/>
    </p>
    <h4>
     <a id="421__278">
     </a>
     4.2.1 消费数据
    </h4>
    <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>monkey<span class="token punctuation">.</span>java_study<span class="token punctuation">.</span>mq<span class="token punctuation">.</span>kafka</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>consumer<span class="token punctuation">.</span></span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>consumer<span class="token punctuation">.</span></span><span class="token class-name">ConsumerRecord</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>consumer<span class="token punctuation">.</span></span><span class="token class-name">ConsumerRecords</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>consumer<span class="token punctuation">.</span></span><span class="token class-name">KafkaConsumer</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">Duration</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Properties</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Kafka消费者.
 *
 * @author xindaqi
 * @since 2022-08-02 9:59
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">KafkaConsumerTest</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">KafkaConsumerTest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">KafkaConsumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getDefaultKafkaConsumer</span><span class="token punctuation">(</span><span class="token class-name">KafkaCommonProperties</span> kafkaCommonProperties<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Properties</span> properties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">.</span>BOOTSTRAP_SERVERS_CONFIG<span class="token punctuation">,</span> kafkaCommonProperties<span class="token punctuation">.</span><span class="token function">getKafkaHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">.</span>GROUP_ID_CONFIG<span class="token punctuation">,</span> kafkaCommonProperties<span class="token punctuation">.</span><span class="token function">getGroupId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">.</span>ENABLE_AUTO_COMMIT_CONFIG<span class="token punctuation">,</span> kafkaCommonProperties<span class="token punctuation">.</span><span class="token function">getAutoCommit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">.</span>AUTO_COMMIT_INTERVAL_MS_CONFIG<span class="token punctuation">,</span> kafkaCommonProperties<span class="token punctuation">.</span><span class="token function">getAutoCommitIntervalMs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">.</span>AUTO_OFFSET_RESET_CONFIG<span class="token punctuation">,</span> kafkaCommonProperties<span class="token punctuation">.</span><span class="token function">getAutoOffsetReset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">.</span>KEY_DESERIALIZER_CLASS_CONFIG<span class="token punctuation">,</span> kafkaCommonProperties<span class="token punctuation">.</span><span class="token function">getKeyDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">.</span>VALUE_DESERIALIZER_CLASS_CONFIG<span class="token punctuation">,</span> kafkaCommonProperties<span class="token punctuation">.</span><span class="token function">getValueDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">KafkaConsumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">KafkaCommonProperties</span> kafkaCommonProperties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KafkaCommonProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">KafkaConsumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> consumer <span class="token operator">=</span> <span class="token function">getDefaultKafkaConsumer</span><span class="token punctuation">(</span>kafkaCommonProperties<span class="token punctuation">)</span><span class="token punctuation">;</span>
            consumer<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>kafkaCommonProperties<span class="token punctuation">.</span><span class="token function">getTopic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token class-name">Boolean</span><span class="token punctuation">.</span>TRUE<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">ConsumerRecords</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> records <span class="token operator">=</span> consumer<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofMillis</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ConsumerRecord</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">record</span> <span class="token operator">:</span> records<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;Consumer offset:{}, value:{}"</span><span class="token punctuation">,</span> <span class="token keyword">record</span><span class="token punctuation">.</span><span class="token function">offset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">record</span><span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="422__333">
     </a>
     4.2.2 开启消费者
    </h4>
    <p>
     开启消费者后，控制台输出消费者的配置参数，如下图所示。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/f492b7ae52cbc2610f686b082814c6c2.png#pic_center">
      <br/>
      同时输出的还有（如下图所示），下次将要消费的offset：41。
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/946b9246b8a87ceee7582f0d7ff16561.png#pic_center">
       <br/>
       消费信息日志如下图所示，
       <br/>
       由图可知，从offset 41开始消费。
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/36dc0f35c9ae69d9f3558fb4c547712f.png#pic_center"/>
      </img>
     </img>
    </p>
    <h2>
     <a id="5__342">
     </a>
     5 命令行
    </h2>
    <p>
     上面
    </p>
    <h3>
     <a id="51__344">
     </a>
     5.1 开启消费者
    </h3>
    <p>
     从topic的最开始消费数据，则offset从0开始，
     <br/>
     开启消费者命令：
    </p>
    <pre><code>bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic my-topic --from-beginning
</code></pre>
    <p>
     topic中已有数据，因此，开始消费者时，从最开始消费数据，结果如下图所示。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/8ba5cee290d32d290fcd72c4d52737a7.png#pic_center">
      <br/>
      命令行启动生产者后，
      <br/>
      该消费者会自动消费进入数据，结果如下图所示。
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/deed28e00daefeb0040f336defd4ecae.png#pic_center"/>
     </img>
    </p>
    <h3>
     <a id="52__356">
     </a>
     5.2 开启生产者
    </h3>
    <p>
     开启生产者命令如下：
    </p>
    <pre><code>bin/kafka-console-producer.sh --broker-list localhost:9092 --topic my-topic
</code></pre>
    <p>
     发送消费如下图所示。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/eb4624dd6fae8d826ed4522bd8e3b3c4.png#pic_center"/>
    </p>
    <h2>
     <a id="6__363">
     </a>
     6 小结
    </h2>
    <p>
     无。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="6874747073:3a2f2f626c6f672e6373646e2e6e65742f58696e5f3130312f:61727469636c652f64657461696c732f313236313534313731" class_="artid" style="display:none">
 </p>
</div>


