---
layout: post
title: "以下是一个可执行的-Linux-命令脚本,支持优雅停止-Tomcat-服务等待-30-秒后重启,并包含错误处理机制"
date: 2025-03-06 16:27:13 +0800
description: "以下是一个可执行的 Linux 命令脚本，支持优雅停止 Tomcat 服务、等待 30 秒后重启，并包含错误处理机制："
keywords: "以下是一个可执行的 Linux 命令脚本，支持优雅停止 Tomcat 服务、等待 30 秒后重启，并包含错误处理机制："
categories: ['未分类']
tags: ['Tomcat', 'Linux']
artid: "146073835"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146073835
    alt: "以下是一个可执行的-Linux-命令脚本,支持优雅停止-Tomcat-服务等待-30-秒后重启,并包含错误处理机制"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146073835
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146073835
cover: https://bing.ee123.net/img/rand?artid=146073835
image: https://bing.ee123.net/img/rand?artid=146073835
img: https://bing.ee123.net/img/rand?artid=146073835
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     以下是一个可执行的 Linux 命令脚本，支持优雅停止 Tomcat 服务、等待 30 秒后重启，并包含错误处理机制：
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-github-gist" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     以下是一个可执行的 Linux 命令脚本，支持优雅停止 Tomcat 服务、等待 30 秒后重启，并包含错误处理机制：
    </p>
    <pre><code class="prism language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token comment"># 停止 Tomcat 服务（支持多种方式）</span>
<span class="token function">sudo</span> systemctl stop tomcat <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null <span class="token operator">||</span> <span class="token punctuation">\</span>
<span class="token function">sudo</span> <span class="token function">service</span> tomcat stop <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null <span class="token operator">||</span> <span class="token punctuation">\</span>
/path/to/tomcat/bin/shutdown.sh <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null

<span class="token comment"># 等待30秒并监控进程终止</span>
<span class="token builtin class-name">echo</span> <span class="token string">"Waiting for Tomcat to fully stop..."</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">..</span><span class="token number">30</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token keyword">if</span> <span class="token operator">!</span> pgrep <span class="token parameter variable">-f</span> <span class="token string">"catalina"</span> <span class="token operator">&gt;</span>/dev/null<span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token builtin class-name">break</span>
    <span class="token keyword">fi</span>
    <span class="token function">sleep</span> <span class="token number">1</span>
<span class="token keyword">done</span>

<span class="token comment"># 强制终止（如果正常停止失败）</span>
<span class="token keyword">if</span> pgrep <span class="token parameter variable">-f</span> <span class="token string">"catalina"</span> <span class="token operator">&gt;</span>/dev/null<span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"Force stopping Tomcat..."</span>
    <span class="token function">pkill</span> <span class="token parameter variable">-9</span> <span class="token parameter variable">-f</span> <span class="token string">"catalina"</span>
    <span class="token function">sleep</span> <span class="token number">5</span>
<span class="token keyword">fi</span>

<span class="token comment"># 重启服务（优先使用系统服务）</span>
<span class="token builtin class-name">echo</span> <span class="token string">"Restarting Tomcat..."</span>
<span class="token function">sudo</span> systemctl start tomcat <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null <span class="token operator">||</span> <span class="token punctuation">\</span>
<span class="token function">sudo</span> <span class="token function">service</span> tomcat start <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null <span class="token operator">||</span> <span class="token punctuation">\</span>
/path/to/tomcat/bin/startup.sh

<span class="token comment"># 验证服务状态</span>
<span class="token builtin class-name">echo</span> <span class="token string">"Checking service status..."</span>
<span class="token function">sleep</span> <span class="token number">3</span>
<span class="token keyword">if</span> pgrep <span class="token parameter variable">-f</span> <span class="token string">"catalina"</span> <span class="token operator">&gt;</span>/dev/null<span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"Tomcat restarted successfully"</span>
<span class="token keyword">else</span>
    <span class="token builtin class-name">echo</span> <span class="token string">"Restart failed! Check logs at /path/to/tomcat/logs/catalina.out"</span>
<span class="token keyword">fi</span>
</code></pre>
    <h4>
     <a id="__42">
     </a>
     功能说明 ：
    </h4>
    <ol>
     <li>
      <strong>
       多方式停止服务
      </strong>
      ：优先尝试
      <code>
       systemctl
      </code>
      和
      <code>
       service
      </code>
      命令（适用于系统服务管理），若失败则调用 Tomcat 自带的
      <code>
       shutdown.sh
      </code>
      脚本
     </li>
     <li>
      <strong>
       智能等待机制
      </strong>
      ：30 秒倒计时期间持续监控进程状态，若提前终止则立即继续
     </li>
     <li>
      <strong>
       强制终止保障
      </strong>
      ：30 秒后仍有残留进程时自动执行强制终止
     </li>
     <li>
      <strong>
       多方式重启
      </strong>
      ：优先使用系统服务管理，兼容直接调用启动脚本
     </li>
     <li>
      <strong>
       状态验证
      </strong>
      ：最终会检查进程状态并提示日志查看路径
     </li>
    </ol>
    <blockquote>
     <p>
      注意：具体服务名称（如
      <code>
       tomcat
      </code>
      /
      <code>
       tomcat8
      </code>
      ）和路径需根据实际环境调整。建议首次运行时添加
      <code>
       -x
      </code>
      参数观察执行流程：
      <code>
       bash -x restart_tomcat.sh
      </code>
     </p>
    </blockquote>
   </div>
   <link href="./../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="./../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c:6f672e6373646e2e6e65742f5149553137363136313635302f:61727469636c652f64657461696c732f313436303733383335" class_="artid" style="display:none">
 </p>
</div>


