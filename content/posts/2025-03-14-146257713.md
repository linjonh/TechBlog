---
arturl_encode: "68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f36313030363236322f:61727469636c652f64657461696c732f313436323537373133"
layout: post
title: "å¤§æ•°æ®å­¦ä¹ 68-Flinkå’ŒSpark-Streaming"
date: 2025-03-14 15:51:40 +08:00
description: "Flink æ˜¯åŸºäºæµçš„çœŸæ­£runtime,å¯ä»¥æŒç»­åœ°å¯¹æ— ç•Œæ•°æ®æµè¿›è¡Œè®¡ç®—ã€‚Spark Streaming åˆ™é‡‡ç”¨çš„æ˜¯å¾®æ‰¹å¤„ç†æ¨¡å‹,å°†æ•°æ®æµç¦»æ•£ä¸ºæ‰¹è¿›è¡Œå¤„ç†ã€‚"
keywords: "å¤§æ•°æ®å­¦ä¹ ï¼ˆ68ï¼‰- Flinkå’ŒSpark Streaming"
categories: ['æœªåˆ†ç±»']
tags: ['å­¦ä¹ ', 'å¤§æ•°æ®', 'Spark', 'Flink']
artid: "146257713"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146257713
    alt: "å¤§æ•°æ®å­¦ä¹ 68-Flinkå’ŒSpark-Streaming"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146257713
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146257713
cover: https://bing.ee123.net/img/rand?artid=146257713
image: https://bing.ee123.net/img/rand?artid=146257713
img: https://bing.ee123.net/img/rand?artid=146257713
---

# å¤§æ•°æ®å­¦ä¹ ï¼ˆ68ï¼‰- Flinkå’ŒSpark Streaming

ğŸ‹ğŸ‹
**å¤§æ•°æ®å­¦ä¹ **
ğŸ‹ğŸ‹

**ğŸ”¥ç³»åˆ—ä¸“æ ï¼š ğŸ‘‘å“²å­¦è¯­å½•: ç”¨åŠ›æ‰€èƒ½åŠï¼Œæ”¹å˜ä¸–ç•Œã€‚
  
ğŸ’–å¦‚æœè§‰å¾—åšä¸»çš„æ–‡ç« è¿˜ä¸é”™çš„è¯ï¼Œè¯·ç‚¹èµğŸ‘+æ”¶è—â­ï¸+ç•™è¨€ğŸ“æ”¯æŒä¸€ä¸‹åšä¸»å“¦ğŸ¤**

---

## ğŸ‹ä¸€ã€Flink and SparkåŸºæœ¬åŸç†

Flink å’Œ Spark Streaming éƒ½æ˜¯ç”¨äºå®æ—¶æµå¼æ•°æ®å¤„ç†çš„åˆ†å¸ƒå¼è®¡ç®—æ¡†æ¶,ä½†ä¸¤è€…çš„åŸºæœ¬è®¾è®¡æ€æƒ³å’Œå†…éƒ¨æ‰§è¡Œæœºåˆ¶æœ‰äº›ä¸åŒã€‚

**Flink åŸºäºæµçš„ç†å¿µ,é‡‡ç”¨äº†åŸºäºæ•°æ®æµæ¨¡å‹çš„æ ¸å¿ƒè¿è¡Œæ—¶å¼•æ“ã€‚**
å®ƒå¯ä»¥å¯¹æ— ç•Œå’Œæœ‰ç•Œæ•°æ®æµè¿›è¡Œæœ‰çŠ¶æ€çš„è®¡ç®—ã€‚Flink ä½¿ç”¨äº†é“¾å¼æ“ä½œæ¥è¡¨è¾¾è¿ç®—é€»è¾‘,å¹¶åŸºäºæµæ°´çº¿çš„æ–¹å¼è¿›è¡Œä»»åŠ¡è°ƒåº¦ã€‚

Spark Streaming åˆ™æ˜¯é€šè¿‡å¾®æ‰¹å¤„ç†çš„æ–¹å¼æ¥å®ç°å¯¹å®æ—¶æ•°æ®æµçš„å¤„ç†ã€‚å®ƒå°†æ•°æ®æµåˆ‡åˆ†æˆå¾ˆå°çš„æ‰¹æ•°æ®,ç„¶åæäº¤ç»™ Spark æ‰§è¡Œæ‰¹å¤„ç†ä»»åŠ¡ã€‚
**Spark Streaming åŸºäº RDD æ¥è¡¨è¾¾è¿ç®—é€»è¾‘,å¹¶é€šè¿‡ Spark çš„ä»»åŠ¡è°ƒåº¦æœºåˆ¶è¿›è¡Œè°ƒåº¦ã€‚**

**Flink çš„å†…éƒ¨æŠŠæµå¤„ç†ç®—æ³•è¡¨ç¤ºä¸ºæ•°æ®æµå›¾,å¹¶ä»¥æµæ°´çº¿çš„æ–¹å¼æŒç»­è¿ç®—ã€‚**
è€Œ
**Spark Streaming**

**æ˜¯
**å°†**
æµä»»åŠ¡æ‹†è§£ä¸ºä¸€ä¸ªä¸ªå°æ‰¹çš„ Spark ä»»åŠ¡,è¿™äº›æ‰¹ä»»åŠ¡æŒ‰æ—¶é—´é¡ºåºæ‰§è¡Œã€‚**

ä¸¤è€…åœ¨ fault tolerance æœºåˆ¶ä¸Šä¹Ÿæœ‰åŒºåˆ«ã€‚Flink åŸºäºæ£€æŸ¥ç‚¹æœºåˆ¶å®ç°äº† exactly-once è¯­ä¹‰ã€‚è€Œ Spark Streaming é€šè¿‡ Write ahead logs å®ç°äº†è‡³å°‘ä¸€æ¬¡ä¿è¯ã€‚

#### **å®ç°æœºåˆ¶**

1. æ•°æ®å¤„ç†æ¨¡å¼ä¸Š,
   **Flink æ˜¯åŸºäºæµçš„çœŸæ­£runtime,å¯ä»¥æŒç»­åœ°å¯¹æ— ç•Œæ•°æ®æµè¿›è¡Œè®¡ç®—ã€‚Spark Streaming åˆ™é‡‡ç”¨çš„æ˜¯å¾®æ‰¹å¤„ç†æ¨¡å‹,å°†æ•°æ®æµç¦»æ•£ä¸ºæ‰¹è¿›è¡Œå¤„ç†ã€‚**
2. Flink é€šè¿‡aperator chainså®ç°äº†æµå¼æ•°æ®æµæ°´çº¿è®¡ç®—ã€‚Spark StreamingåŸºäºRDDæ‹¼æ¥æ‰¹ç»“æœæ¥æ¨¡æ‹Ÿæµè®¡ç®—ã€‚
3. Flink ä½¿ç”¨è½»é‡çº§çš„æµæ°´çº¿è°ƒåº¦æœºåˆ¶è¿›è¡Œä»»åŠ¡è°ƒåº¦ã€‚Spark Streamingåˆ™ä¾èµ–Spark Engineè¿›è¡Œä»»åŠ¡è°ƒåº¦ã€‚
4. Flinkæ£€æŸ¥ç‚¹æœºåˆ¶å®ç°äº†Exactly-onceè¯­ä¹‰ã€‚Spark Streamingé€šè¿‡Write Ahead Logså®ç°äº†è‡³å°‘ä¸€æ¬¡ä¿è¯ã€‚
5. FlinkåŸºäºæ•°æ®æµå›¾è¿›è¡Œè®¡ç®—,å…è®¸å¾ªç¯æ•°æ®æµ(è¿­ä»£è®¡ç®—)ã€‚Spark Streamingçš„DAGä¸å…è®¸å­˜åœ¨å¾ªç¯ã€‚
6. Flinkæœ‰æ›´ä½çš„å»¶è¿Ÿ,å¯ä»¥è¾¾åˆ°æ¯«ç§’çº§ã€‚Spark Streamingæ‰¹é—´éš”ä¸€èˆ¬åœ¨500æ¯«ç§’ä»¥ä¸Šã€‚
7. Flinkæœ‰æ›´å¥½çš„é‡å¯èƒ½åŠ›,å¯ä»¥ä»æ£€æŸ¥ç‚¹æ¢å¤çŠ¶æ€ã€‚Spark Streamingé‡å¯åéœ€è¦é‡æ–°è®¡ç®—ã€‚
8. Flinkæœ‰æ›´å¤šé’ˆå¯¹æµçš„ä¼˜åŒ–,å¦‚çª—å£æœºåˆ¶ç­‰ã€‚Spark Streamingç»§æ‰¿è‡ªSparkçš„æ‰¹è®¾è®¡ã€‚
9. Flinkéœ€è¦é¢å¤–çš„Clusteréƒ¨ç½²å’Œæ“ä½œã€‚Spark Streamingå¯ä»¥ç›´æ¥åŸºäºSpark Clusterè¿è¡Œã€‚

## ğŸ‹äºŒã€è¿è¡Œè§’è‰²

**Spark Streaming**
è¿è¡Œæ—¶çš„è§’è‰²(standalone æ¨¡å¼)ä¸»è¦æœ‰ï¼š

* **Master**
  :ä¸»è¦è´Ÿè´£æ•´ä½“é›†ç¾¤èµ„æºçš„ç®¡ç†å’Œåº”ç”¨ç¨‹åºè°ƒåº¦ï¼›
* **Worker**
  :è´Ÿè´£å•ä¸ªèŠ‚ç‚¹çš„èµ„æºç®¡ç†ï¼Œdriver å’Œ executor çš„å¯åŠ¨ç­‰ï¼›
* **Driver**
  :ç”¨æˆ·å…¥å£ç¨‹åºæ‰§è¡Œçš„åœ°æ–¹ï¼Œå³ SparkContext æ‰§è¡Œçš„åœ°æ–¹ï¼Œä¸»è¦æ˜¯ DGA ç”Ÿæˆã€stage åˆ’åˆ†ã€task ç”ŸæˆåŠè°ƒåº¦ï¼›
* **Executor**
  :è´Ÿè´£æ‰§è¡Œ taskï¼Œåé¦ˆæ‰§è¡ŒçŠ¶æ€å’Œæ‰§è¡Œç»“æœã€‚
* ![](https://i-blog.csdnimg.cn/direct/87f7ea2f3b8a438ca8a0c325706ca1a3.png)

**Flink**
è¿è¡Œæ—¶çš„è§’è‰²(standalone æ¨¡å¼)ä¸»è¦æœ‰:

* **Jobmanager**
  : åè°ƒåˆ†å¸ƒå¼æ‰§è¡Œï¼Œä»–ä»¬è°ƒåº¦ä»»åŠ¡ã€åè°ƒ checkpointsã€åè°ƒæ•…éšœæ¢å¤ç­‰ã€‚è‡³å°‘æœ‰ä¸€ä¸ª JobManagerã€‚é«˜å¯ç”¨æƒ…å†µä¸‹å¯ä»¥å¯åŠ¨å¤šä¸ª JobManagerï¼Œå…¶ä¸­ä¸€ä¸ªé€‰ä¸¾ä¸º leaderï¼Œå…¶ä½™ä¸º standbyï¼›
* **Taskmanager**
  : è´Ÿè´£æ‰§è¡Œå…·ä½“çš„ tasksã€ç¼“å­˜ã€äº¤æ¢æ•°æ®æµï¼Œè‡³å°‘æœ‰ä¸€ä¸ª TaskManagerï¼›
* **Slot**
  : æ¯ä¸ª task slot ä»£è¡¨ TaskManager çš„ä¸€ä¸ªå›ºå®šéƒ¨åˆ†èµ„æºï¼Œ
  **Slot çš„ä¸ªæ•°ä»£è¡¨ç€ taskmanager å¯å¹¶è¡Œæ‰§è¡Œçš„ task æ•°ã€‚**

![](https://i-blog.csdnimg.cn/direct/aad0b342cb3949a2b878e8f7f055b590.png)

## ğŸ‹ä¸‰ã€sparkÂ streamingå’ŒFlinkè¿è¡Œæ¨¡å‹

1.
Spark Streaming æ˜¯
**å¾®æ‰¹å¤„ç†**
ï¼Œè¿è¡Œçš„æ—¶å€™éœ€è¦æŒ‡å®šæ‰¹å¤„ç†çš„æ—¶é—´ï¼Œæ¯æ¬¡è¿è¡Œ job æ—¶å¤„ç†ä¸€ä¸ªæ‰¹æ¬¡çš„æ•°æ®ï¼Œæµç¨‹å¦‚å›¾ 3 æ‰€ç¤ºï¼š

![640?](https://i-blog.csdnimg.cn/blog_migrate/040e12a5f17eecd2d25ec7e739141e64.png)

2.
Flink æ˜¯åŸºäº
**äº‹ä»¶**
é©±åŠ¨çš„
ï¼Œäº‹ä»¶å¯ä»¥ç†è§£ä¸ºæ¶ˆæ¯ã€‚äº‹ä»¶é©±åŠ¨çš„åº”ç”¨ç¨‹åºæ˜¯ä¸€ç§çŠ¶æ€åº”ç”¨ç¨‹åºï¼Œå®ƒä¼šä»ä¸€ä¸ªæˆ–è€…å¤šä¸ªæµä¸­æ³¨å…¥äº‹ä»¶ï¼Œé€šè¿‡è§¦å‘è®¡ç®—æ›´æ–°çŠ¶æ€ï¼Œæˆ–å¤–éƒ¨åŠ¨ä½œå¯¹æ³¨å…¥çš„äº‹ä»¶ä½œå‡ºååº”ã€‚

![640?](https://i-blog.csdnimg.cn/blog_migrate/1eb8a1b2118a2fdb23cf6e2a76f97409.jpeg)

## ğŸ‹å››ã€ä»»åŠ¡è°ƒåº¦

### 1.Spark ä»»åŠ¡è°ƒåº¦

Spark Streaming ä»»åŠ¡å¦‚ä¸Šæ–‡æåˆ°çš„æ˜¯åŸºäºå¾®æ‰¹å¤„ç†çš„ï¼Œå®é™…ä¸Šæ¯ä¸ªæ‰¹æ¬¡éƒ½æ˜¯ä¸€ä¸ª Spark Core çš„ä»»åŠ¡ã€‚å¯¹äºç¼–ç å®Œæˆçš„ Spark Core ä»»åŠ¡åœ¨ç”Ÿæˆåˆ°æœ€ç»ˆæ‰§è¡Œç»“æŸä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š

* æ„å»º DGA å›¾ï¼›
* åˆ’åˆ† stageï¼›
* ç”Ÿæˆ tasksetï¼›
* è°ƒåº¦ taskã€‚

![640?](https://i-blog.csdnimg.cn/blog_migrate/048b02b89b1453ca42dd29524ef2c283.jpeg)

å¯¹äº job çš„è°ƒåº¦æ‰§è¡Œæœ‰ fifo å’Œ fair ä¸¤ç§æ¨¡å¼ï¼ŒTask æ˜¯æ ¹æ®
**æ•°æ®æœ¬åœ°æ€§**
è°ƒåº¦æ‰§è¡Œçš„ã€‚ å‡è®¾æ¯ä¸ª Spark Streaming ä»»åŠ¡æ¶ˆè´¹çš„ kafka topic æœ‰å››ä¸ªåˆ†åŒºï¼Œä¸­é—´æœ‰ä¸€ä¸ª transformæ“ä½œï¼ˆå¦‚ mapï¼‰å’Œä¸€ä¸ª reduce æ“ä½œã€‚

![640?](https://i-blog.csdnimg.cn/blog_migrate/816449d8bf905c217230dc471b86304b.jpeg)

å‡è®¾æœ‰ä¸¤ä¸ª executorï¼Œå…¶ä¸­æ¯ä¸ª executor ä¸‰ä¸ªæ ¸ï¼Œé‚£ä¹ˆæ¯ä¸ªæ‰¹æ¬¡ç›¸åº”çš„ task è¿è¡Œä½ç½®æ˜¯å›ºå®šçš„å—ï¼Ÿæ˜¯å¦èƒ½é¢„æµ‹ï¼Ÿ ç”±äºæ•°æ®æœ¬åœ°æ€§å’Œè°ƒåº¦ä¸ç¡®å®šæ€§ï¼Œæ¯ä¸ªæ‰¹æ¬¡å¯¹åº” kafka åˆ†åŒºç”Ÿæˆçš„ task è¿è¡Œä½ç½®å¹¶ä¸æ˜¯å›ºå®šçš„ã€‚

### **2.Flink ä»»åŠ¡è°ƒåº¦**

å¯¹äº flink çš„æµä»»åŠ¡å®¢æˆ·ç«¯é¦–å…ˆä¼šç”Ÿæˆ StreamGraphï¼Œæ¥ç€ç”Ÿæˆ JobGraphï¼Œç„¶åå°† jobGraph æäº¤ç»™ Jobmanager ç”±å®ƒå®Œæˆ jobGraph åˆ° ExecutionGraph çš„è½¬å˜ï¼Œæœ€åç”± jobManager è°ƒåº¦æ‰§è¡Œã€‚

![640?](https://i-blog.csdnimg.cn/blog_migrate/b702adb9f2be207975b020bdb9018e5f.jpeg)

ä¸Šå›¾æ‰€ç¤ºæœ‰ä¸€ä¸ªç”± data sourceã€MapFunctionå’Œ ReduceFunction ç»„æˆçš„ç¨‹åºï¼Œdata source å’Œ MapFunction çš„å¹¶å‘åº¦éƒ½ä¸º 4ï¼Œè€Œ ReduceFunction çš„å¹¶å‘åº¦ä¸º 3ã€‚ä¸€ä¸ªæ•°æ®æµç”± Source-Map-Reduce çš„é¡ºåºç»„æˆï¼Œåœ¨å…·æœ‰ 2 ä¸ªTaskManagerã€æ¯ä¸ª TaskManager éƒ½æœ‰ 3 ä¸ª Task Slot çš„é›†ç¾¤ä¸Šè¿è¡Œã€‚

å¯ä»¥çœ‹å‡º
**flink çš„æ‹“æ‰‘ç”Ÿæˆæäº¤æ‰§è¡Œä¹‹åï¼Œé™¤éæ•…éšœï¼Œå¦åˆ™æ‹“æ‰‘éƒ¨ä»¶æ‰§è¡Œä½ç½®ä¸å˜ï¼Œå¹¶è¡Œåº¦ç”±æ¯ä¸€ä¸ªç®—å­å¹¶è¡Œåº¦å†³å®šï¼Œç±»ä¼¼äº stormã€‚è€Œ spark Streaming æ˜¯æ¯ä¸ªæ‰¹æ¬¡éƒ½ä¼šæ ¹æ®æ•°æ®æœ¬åœ°æ€§å’Œèµ„æºæƒ…å†µè¿›è¡Œè°ƒåº¦ï¼Œæ— å›ºå®šçš„æ‰§è¡Œæ‹“æ‰‘ç»“æ„ã€‚ flink æ˜¯æ•°æ®åœ¨æ‹“æ‰‘ç»“æ„é‡ŒæµåŠ¨æ‰§è¡Œï¼Œè€Œ Spark Streaming åˆ™æ˜¯å¯¹æ•°æ®ç¼“å­˜æ‰¹æ¬¡å¹¶è¡Œå¤„ç†ã€‚**