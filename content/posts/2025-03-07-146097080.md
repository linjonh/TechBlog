---
layout: post
title: "js逆向iwencai国内某金融网站实战-"
date: 2025-03-07 17:33:00 +0800
description: "iwencai国内某金融网站实战   "
keywords: "【js逆向】iwencai国内某金融网站实战 "
categories: ['逆向', '爬虫']
tags: ['爬虫']
artid: "146097080"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146097080
    alt: "js逆向iwencai国内某金融网站实战-"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146097080
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146097080
cover: https://bing.ee123.net/img/rand?artid=146097080
image: https://bing.ee123.net/img/rand?artid=146097080
img: https://bing.ee123.net/img/rand?artid=146097080
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     【js逆向】iwencai国内某金融网站实战
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     地址：aHR0cHM6Ly93d3cuaXdlbmNhaS5jb20vdW5pZmllZHdhcC9ob21lL2luZGV4
    </p>
    <p>
     在搜索框中随便输入关键词
    </p>
    <p>
     <img alt="" height="826" src="https://i-blog.csdnimg.cn/direct/f3e8fad84b1d41fab56ffcb335c5d374.png" width="1910"/>
    </p>
    <p>
     查看请求标头，请求头中有一个特殊的
     <span style="color:#fe2c24">
      <strong>
       <code>
        Hexin-V
       </code>
      </strong>
     </span>
     <span style="color:#0d0016">
      <code>
       ,
      </code>
     </span>
     它是加密过的；响应数据包中全是明文。搞清楚
     <code>
      Hexin-V
     </code>
     的值是怎么生成的，这个值和cookie中的v值也是一样的
    </p>
    <p>
     <img alt="" height="382" src="https://i-blog.csdnimg.cn/direct/bf43ead5ac21491bb0158e6761fc2cbf.png" width="1826"/>
    </p>
    <p>
     查看载荷
    </p>
    <p>
     <img alt="" height="332" src="https://i-blog.csdnimg.cn/direct/2ab8667499c14bb691936ab2ea9a44e5.png" width="1115"/>
    </p>
    <p>
     采用hook技术，调试的时候会停在给cookie赋值的地方。
    </p>
    <p>
     <img alt="" height="672" src="https://i-blog.csdnimg.cn/direct/750eea79678b4d0683cb0d57f538cf39.png" width="1899"/>
    </p>
    <p>
     点两下继续执行脚本就出现了
    </p>
    <p>
     <img alt="" height="108" src="https://i-blog.csdnimg.cn/direct/8bddada2867d4476ad88529a3ba3317d.png" width="1329"/>
    </p>
    <p>
     主要的实现代码在
     <code>
      O
     </code>
     函数里
    </p>
    <p>
     <img alt="" height="507" src="https://i-blog.csdnimg.cn/direct/bc76161ec42c4e3eaf8a4303789d4592.png" width="1227"/>
    </p>
    <p>
     在这个自运行函数下面，变量
     <code>
      rt
     </code>
     就是自运行函数里的变量
     <code>
      n
     </code>
     ，所以给
     <code>
      n
     </code>
     赋值也就相当于给
     <code>
      rt
     </code>
     赋值。
    </p>
    <p>
     <img alt="" height="45" src="https://i-blog.csdnimg.cn/direct/949b0ba9ccf1466d86f5ebe72cc24af9.png" width="914"/>
    </p>
    <p>
     ReferenceError: document is not defined  ReferenceError: window is not defined
    </p>
    <pre><code class="language-javascript">var document = {};
var window = {};</code></pre>
    <p>
     TypeError: r[51].getElementsByTagName is not a function ，这句代码去掉
    </p>
    <pre><code class="language-javascript">Kn = c[66][f + l] || r[51].getElementsByTagName(p + d)[r[52]]</code></pre>
    <p>
     var rt下面的那段函数
    </p>
    <p>
     注释：
    </p>
    <pre><code class="language-javascript">            function P() {
                var n = s[0]
                    , t = r[88]
                    , e = parseInt(u[13], c[122])
                    , a = s[217];
                S = new qn([a, a, a, a, n, n, n, e, t, t, t, t, t, t, t, a, t, n]),
                    S[p] = Jn.serverTimeNow(),
                    M(),
                    S[B] = Vn,
                    S[k] = Un,
                    S[R] = c[2],
                    S[h] = 3962565446,
                    S[b] = 3748,
                    S[g] = 1,
                    S[w] = 10,
                    S[m] = 5
            }</code></pre>
    <pre><code class="language-javascript">function M() {
                // var n = Qn.getCookie(Fn) || Zn.get(jn);
                // if (n &amp;&amp; n[s[111]] == parseInt(c[221], e[93])) {
                //     var t = zn.decode(n);
                //     if (t &amp;&amp; (S.decodeBuffer(t),
                //     S[l] != s[2]))
                //         return
                // }
                S[l] = Jn.random()
            }</code></pre>
    <pre><code class="language-javascript">function O() {
                S[R]++,
                    S[p] = Jn.serverTimeNow(),
                    S[d] = Jn.timeNow(),
                    S[B] = Vn,
                    S[I] = 0,
                    S[y] = 0,
                    S[_] = 0,
                    S[C] = 0,
                    S[E] = 0,
                    S[A] = 0;
                var n = S.toBuffer();
                return zn.encode(n)
            }</code></pre>
    <p>
     <img alt="" height="476" src="https://i-blog.csdnimg.cn/direct/70fe7cb271604222a1f3024e118c33dd.png" width="969"/>
    </p>
    <p>
     运行结果：
    </p>
    <p>
     <img alt="" height="101" src="https://i-blog.csdnimg.cn/direct/4475d239c9e3426cbe41cc6be615557b.png" width="832"/>
    </p>
    <p>
     结果：
    </p>
    <p>
     <img alt="" height="734" src="https://i-blog.csdnimg.cn/direct/82668822e0f34e80897d321cf00972af.png" width="1831"/>
    </p>
    <p>
     此题和图灵练习平台第15题cookie加密一模一样
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f37333734343538332f:61727469636c652f64657461696c732f313436303937303830" class_="artid" style="display:none">
 </p>
</div>


