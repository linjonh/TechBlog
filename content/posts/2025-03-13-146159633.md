---
layout: post
title: "React-常用-Hooks-详细解析"
date: 2025-03-13 16:47:37 +0800
description: "是 React 16.8 引入的核心特性，允许在函数组件中使用状态、生命周期等特性，替代类组件的复杂逻辑。：处理组件生命周期中的副作用（如数据请求、DOM 操作、订阅）。：类似 Redux 的状态管理，适合多状态关联或复杂更新逻辑。类似，但会在 DOM 更新后同步执行（在浏览器绘制前）。：状态更新涉及多个子值、依赖前一个状态、需要集中化管理。：在组件树中共享数据，避免逐层传递 props。：在函数组件中定义和更新局部状态。：将组件逻辑封装为可复用的函数。"
keywords: "react 常用hooks"
categories: ['React']
tags: ['前端', 'React', 'Javascript']
artid: "146159633"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146159633
    alt: "React-常用-Hooks-详细解析"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146159633
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146159633
cover: https://bing.ee123.net/img/rand?artid=146159633
image: https://bing.ee123.net/img/rand?artid=146159633
img: https://bing.ee123.net/img/rand?artid=146159633
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     React 常用 Hooks 详细解析
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     React
     <strong>
      Hooks
     </strong>
     是 React 16.8 引入的核心特性，允许在函数组件中使用状态、生命周期等特性，替代类组件的复杂逻辑。以下是常用 Hooks 的详细解析及最佳实践：
    </p>
    <hr/>
    <h4>
     <a id="1_useState_4">
     </a>
     <strong>
      1.
      <code>
       useState
      </code>
      ：状态管理
     </strong>
    </h4>
    <p>
     <strong>
      用途
     </strong>
     ：在函数组件中定义和更新局部状态。
     <br/>
     <strong>
      示例
     </strong>
     ：
    </p>
    <pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Counter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 初始值 0</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
      Clicked <span class="token punctuation">{<!-- --></span>count<span class="token punctuation">}</span> times
    <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <strong>
      注意
     </strong>
     ：
    </p>
    <ul>
     <li>
      状态更新是异步的，连续调用
      <code>
       setCount(count + 1)
      </code>
      不会立即生效。
     </li>
     <li>
      若新状态依赖旧状态，应使用函数形式：
      <code>
       setCount(prev =&gt; prev + 1)
      </code>
      。
     </li>
    </ul>
    <hr/>
    <h4>
     <a id="2_useEffect_26">
     </a>
     <strong>
      2.
      <code>
       useEffect
      </code>
      ：副作用处理
     </strong>
    </h4>
    <p>
     <strong>
      用途
     </strong>
     ：处理组件生命周期中的副作用（如数据请求、DOM 操作、订阅）。
     <br/>
     <strong>
      示例
     </strong>
     ：
    </p>
    <pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> useEffect<span class="token punctuation">,</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">DataFetcher</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{<!-- --></span> url <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>data<span class="token punctuation">,</span> setData<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> <span class="token function-variable function">fetchData</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">setData</span><span class="token punctuation">(</span><span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>url<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 依赖项：url 变化时重新执行</span>

  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span>data <span class="token operator">?</span> data<span class="token punctuation">.</span>name <span class="token operator">:</span> <span class="token string">'Loading...'</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <strong>
      注意
     </strong>
     ：
    </p>
    <ul>
     <li>
      <strong>
       依赖项数组
      </strong>
      ：
      <ul>
       <li>
        空数组
        <code>
         []
        </code>
        ：仅在组件挂载时执行（类似
        <code>
         componentDidMount
        </code>
        ）。
       </li>
       <li>
        无数组：每次渲染后都执行（慎用）。
       </li>
       <li>
        包含变量：变量变化时重新执行。
       </li>
      </ul>
     </li>
     <li>
      <strong>
       清理函数
      </strong>
      ：返回一个函数用于清理（如取消订阅、移除事件监听）：
      <pre><code class="prism language-js"><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">clearInterval</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 组件卸载时清理</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
     </li>
    </ul>
    <hr/>
    <h4>
     <a id="3_useContext_61">
     </a>
     <strong>
      3.
      <code>
       useContext
      </code>
      ：跨组件数据传递
     </strong>
    </h4>
    <p>
     <strong>
      用途
     </strong>
     ：在组件树中共享数据，避免逐层传递 props。
     <br/>
     <strong>
      示例
     </strong>
     ：
    </p>
    <pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> createContext<span class="token punctuation">,</span> useContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token comment">// 1. 创建 Context</span>
<span class="token keyword">const</span> ThemeContext <span class="token operator">=</span> <span class="token function">createContext</span><span class="token punctuation">(</span><span class="token string">'light'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 2. 提供数据</span>
<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>ThemeContext<span class="token punctuation">.</span>Provider value<span class="token operator">=</span><span class="token string">"dark"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>Toolbar <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>ThemeContext<span class="token punctuation">.</span>Provider<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 3. 消费数据</span>
<span class="token keyword">const</span> <span class="token function-variable function">Toolbar</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> theme <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>ThemeContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Current theme<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>theme<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
    <hr/>
    <h4>
     <a id="4_useReducer_86">
     </a>
     <strong>
      4.
      <code>
       useReducer
      </code>
      ：复杂状态逻辑
     </strong>
    </h4>
    <p>
     <strong>
      用途
     </strong>
     ：类似 Redux 的状态管理，适合多状态关联或复杂更新逻辑。
     <br/>
     <strong>
      示例
     </strong>
     ：
    </p>
    <pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> useReducer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> initialState <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">reducer</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">case</span> <span class="token string">'increment'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">count</span><span class="token operator">:</span> state<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">'decrement'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">count</span><span class="token operator">:</span> state<span class="token punctuation">.</span>count <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">Counter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> dispatch<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> initialState<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
      <span class="token literal-property property">Count</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>state<span class="token punctuation">.</span>count<span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'increment'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">+</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'decrement'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <strong>
      适用场景
     </strong>
     ：状态更新涉及多个子值、依赖前一个状态、需要集中化管理。
    </p>
    <hr/>
    <h4>
     <a id="5_useCallback__useMemo_120">
     </a>
     <strong>
      5.
      <code>
       useCallback
      </code>
      和
      <code>
       useMemo
      </code>
      ：性能优化
     </strong>
    </h4>
    <h5>
     <a id="useCallback_121">
     </a>
     <strong>
      <code>
       useCallback
      </code>
      ：缓存函数
     </strong>
    </h5>
    <pre><code class="prism language-js"><span class="token keyword">const</span> handleClick <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Clicked:'</span><span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// count 变化时重新创建函数</span>
</code></pre>
    <h5>
     <a id="useMemo_128">
     </a>
     <strong>
      <code>
       useMemo
      </code>
      ：缓存计算结果
     </strong>
    </h5>
    <pre><code class="prism language-js"><span class="token keyword">const</span> expensiveValue <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">return</span> <span class="token function">computeExpensiveValue</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// a/b 变化时重新计算</span>
</code></pre>
    <p>
     <strong>
      最佳实践
     </strong>
     ：
    </p>
    <ul>
     <li>
      仅当子组件依赖这些值且用
      <code>
       React.memo
      </code>
      优化时使用。
     </li>
     <li>
      避免滥用，内存缓存本身也有开销。
     </li>
    </ul>
    <hr/>
    <h4>
     <a id="6_useRef_141">
     </a>
     <strong>
      6.
      <code>
       useRef
      </code>
      ：持久化引用
     </strong>
    </h4>
    <p>
     <strong>
      用途
     </strong>
     ：
    </p>
    <ul>
     <li>
      访问 DOM 元素。
     </li>
     <li>
      保存可变值（类似类组件的实例变量），不会触发重新渲染。
      <br/>
      <strong>
       示例
      </strong>
      ：
     </li>
    </ul>
    <pre><code class="prism language-js"><span class="token keyword">const</span> <span class="token function-variable function">TextInput</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> inputRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">focusInput</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    inputRef<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>input ref<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>inputRef<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>focusInput<span class="token punctuation">}</span><span class="token operator">&gt;</span>Focus<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
    <hr/>
    <h4>
     <a id="7_useLayoutEffect_165">
     </a>
     <strong>
      7.
      <code>
       useLayoutEffect
      </code>
      ：同步副作用
     </strong>
    </h4>
    <p>
     <strong>
      用途
     </strong>
     ：与
     <code>
      useEffect
     </code>
     类似，但会在 DOM 更新后同步执行（在浏览器绘制前）。
     <br/>
     <strong>
      适用场景
     </strong>
     ：需要直接操作 DOM 并确保用户看不到中间状态（如测量元素尺寸）。
     <br/>
     <strong>
      示例
     </strong>
     ：
    </p>
    <pre><code class="prism language-js"><span class="token function">useLayoutEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> width <span class="token punctuation">}</span> <span class="token operator">=</span> divRef<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setWidth</span><span class="token punctuation">(</span>width<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 确保在渲染前获取最新尺寸</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <hr/>
    <h4>
     <a id="8__Hook_178">
     </a>
     <strong>
      8. 自定义 Hook：逻辑复用
     </strong>
    </h4>
    <p>
     <strong>
      用途
     </strong>
     ：将组件逻辑封装为可复用的函数。
     <br/>
     <strong>
      示例
     </strong>
     ：自定义
     <code>
      useFetch
     </code>
     ：
    </p>
    <pre><code class="prism language-js"><span class="token keyword">const</span> <span class="token function-variable function">useFetch</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>data<span class="token punctuation">,</span> setData<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> <span class="token function-variable function">fetchData</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">setData</span><span class="token punctuation">(</span><span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>url<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> data<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 使用</span>
<span class="token keyword">const</span> <span class="token function-variable function">MyComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token function">useFetch</span><span class="token punctuation">(</span><span class="token string">'/api/data'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span>data<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
    <hr/>
    <h4>
     <a id="Hooks__205">
     </a>
     <strong>
      Hooks 使用规则
     </strong>
    </h4>
    <ol>
     <li>
      <strong>
       只在顶层调用
      </strong>
      ：不能在条件、循环或嵌套函数中使用 Hooks。
     </li>
     <li>
      <strong>
       仅在 React 函数组件或自定义 Hook 中使用
      </strong>
      。
     </li>
    </ol>
    <hr/>
    <h4>
     <a id="_211">
     </a>
     <strong>
      总结
     </strong>
    </h4>
    <table>
     <thead>
      <tr>
       <th>
        <strong>
         Hook
        </strong>
       </th>
       <th>
        <strong>
         核心用途
        </strong>
       </th>
       <th>
        <strong>
         典型场景
        </strong>
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <code>
         useState
        </code>
       </td>
       <td>
        管理组件内部状态
       </td>
       <td>
        计数器、表单输入
       </td>
      </tr>
      <tr>
       <td>
        <code>
         useEffect
        </code>
       </td>
       <td>
        处理副作用（数据请求、订阅）
       </td>
       <td>
        API 调用、事件监听
       </td>
      </tr>
      <tr>
       <td>
        <code>
         useContext
        </code>
       </td>
       <td>
        跨组件共享数据
       </td>
       <td>
        主题、用户身份全局传递
       </td>
      </tr>
      <tr>
       <td>
        <code>
         useReducer
        </code>
       </td>
       <td>
        复杂状态逻辑管理
       </td>
       <td>
        表单多字段、状态机
       </td>
      </tr>
      <tr>
       <td>
        <code>
         useCallback
        </code>
       </td>
       <td>
        缓存函数，避免子组件无效渲染
       </td>
       <td>
        传递回调函数给优化过的子组件
       </td>
      </tr>
      <tr>
       <td>
        <code>
         useMemo
        </code>
       </td>
       <td>
        缓存计算结果，减少重复计算
       </td>
       <td>
        复杂计算、优化渲染性能
       </td>
      </tr>
      <tr>
       <td>
        <code>
         useRef
        </code>
       </td>
       <td>
        访问 DOM 或保存可变引用
       </td>
       <td>
        输入框聚焦、保存定时器 ID
       </td>
      </tr>
      <tr>
       <td>
        <code>
         useLayoutEffect
        </code>
       </td>
       <td>
        同步 DOM 操作
       </td>
       <td>
        测量元素尺寸、强制同步更新
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     合理使用 Hooks 能显著提升代码可读性和可维护性，但需注意避免过度优化和滥用内存缓存。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a:2f2f626c6f672e6373646e2e6e65742f706f7070696e674a2f:61727469636c652f64657461696c732f313436313539363333" class_="artid" style="display:none">
 </p>
</div>


