---
arturl_encode: "68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34353237393138302f:61727469636c652f64657461696c732f313436323630353530"
layout: post
title: "html-to-imageçš„ä½¿ç”¨åŠå›¾ç‰‡å˜å½¢å’Œæ— å›¾é—®é¢˜ä¿®å¤"
date: 2025-03-14 16:24:03 +0800
description: "åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­æˆ‘å‘ç°éƒ¨åˆ†ç”Ÿæˆçš„å›¾ç‰‡æ²¡æœ‰å…ƒç´ ï¼Œèµ·åˆæˆ‘ä»¥ä¸ºæ˜¯å…ƒç´ ä¸­å›¾ç‰‡çš„é—®é¢˜ï¼Œåæ¥å‘ç°éƒ¨åˆ†å…ƒç´ çš„åç§»ä½¿ç”¨çš„æ˜¯å®šä½éƒ¨åˆ†ä½¿ç”¨çš„æ˜¯transformï¼Œå®šä½çš„topã€leftç­‰å€¼æ˜¯å¯ä»¥æ­£å¸¸æ•æ‰åˆ°å…ƒç´ çš„ï¼Œä½†æ˜¯å½“ä½¿ç”¨transformçš„æ—¶å€™ï¼Œå› ä¸ºåç§»æ˜¯ç›¸å¯¹è‡ªèº«çš„ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´å…ƒç´ å¯èƒ½è¶…å‡ºäº†ç”Ÿæˆçš„å›¾ç‰‡èŒƒå›´ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨çš„æ–¹æ³•æ˜¯è½¬å›¾ç‰‡çš„æ—¶å€™æ‰‹åŠ¨æ¸…é™¤transformï¼Œè½¬æ¢å®Œæ¯•åå†è®¾ç½®å›å»ã€‚æ–¹æ³•ï¼Œä½¿ç”¨çš„æ—¶å€™é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œä¸è¿‡å·²ç»æ˜¯äº”ä¸ªæœˆå‰çš„äº‹å„¿äº†æ‰€ä»¥è¿™é‡Œå°±è·³è¿‡ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯ã€‚åŸºç¡€çš„ä½¿ç”¨æ–¹æ³•è¯´å®Œäº†ï¼Œä¸‹é¢è¯´è¯´ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜ã€‚"
keywords: "html-to-imageçš„ä½¿ç”¨åŠå›¾ç‰‡å˜å½¢å’Œæ— å›¾é—®é¢˜ä¿®å¤"
categories: ['æœªåˆ†ç±»']
tags: ['å‰ç«¯']
artid: "146260550"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146260550
    alt: "html-to-imageçš„ä½¿ç”¨åŠå›¾ç‰‡å˜å½¢å’Œæ— å›¾é—®é¢˜ä¿®å¤"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146260550
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146260550
cover: https://bing.ee123.net/img/rand?artid=146260550
image: https://bing.ee123.net/img/rand?artid=146260550
img: https://bing.ee123.net/img/rand?artid=146260550
---

# html-to-imageçš„ä½¿ç”¨åŠå›¾ç‰‡å˜å½¢å’Œæ— å›¾é—®é¢˜ä¿®å¤

### html-to-imageçš„ä½¿ç”¨åŠå›¾ç‰‡å˜å½¢å’Œæ— å›¾é—®é¢˜ä¿®å¤

æœ€è¿‘è¿­ä»£çš„æ—¶å€™å› ä¸ºæ–°å¢äº†ä¸€ä¸ªéœ€æ±‚ï¼Œéœ€è¦å‰ç«¯æä¾›ç´ æåŠæ ·å¼ç»™åç«¯ï¼Œåç«¯åŒæ­¥æ¸²æŸ“ï¼Œä½†æ˜¯å› ä¸ºéƒ¨åˆ†æ ·å¼é—®é¢˜åç«¯æ— æ³•å®ç°æ‰€ä»¥å†³å®šå‰ç«¯å°†é¡µé¢ç”Ÿæˆå›¾ç‰‡ç„¶åä¼ é€’ç»™åç«¯ä½¿ç”¨ï¼Œæœ¬æ–‡è®°å½•ä¸€ä¸‹ä½¿ç”¨çš„è¿‡ç¨‹åŠé‡åˆ°çš„éƒ¨åˆ†é—®é¢˜ã€‚

#### æŠ€æœ¯è°ƒç ”

ç°åœ¨å°†é¡µé¢å…ƒç´ è½¬æ¢æˆå›¾ç‰‡çš„æ’ä»¶æœ‰å¾ˆå¤šï¼Œæ™®éä½¿ç”¨çš„æŠ€æœ¯åŸç†éƒ½æ˜¯åˆ©ç”¨
**canvas**
æˆ–è€…
**SVG**
å°†é¡µé¢å…ƒç´ è½¬æ¢æˆç”»å¸ƒæˆ–è€…svgå…ƒç´ ï¼Œç„¶åå†è½¬æˆå›¾ç‰‡ã€‚è¿™é‡Œæˆ‘åœ¨è€ƒè™‘åˆ°é€Ÿåº¦ã€æ˜“ç”¨æ€§ã€ç¨³å®šæ€§åé€‰æ‹©ä½¿ç”¨
**html-to-imag**
ï¼Œ
[æ–‡æ¡£åœ°å€åœ¨è¿™é‡ŒğŸš©](https://github.com/bubkoo/html-to-image#readme)
ï¼Œæœ¬æ–‡ä½¿ç”¨html-to-imageç‰ˆæœ¬
**1.11.11**
ã€‚

#### ä½¿ç”¨

html-to-imageçš„ä½¿ç”¨éå¸¸æ–¹ä¾¿ï¼Œå†…ç½®äº†å¾ˆå¤šæ–¹æ³•ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼š

```ts
import { toPng, toJpeg, toBlob, toPixelData, toSvg } from 'html-to-image';

```

è¿™é‡Œæ ¹æ®å…·ä½“éœ€æ±‚é€‰æ‹©ä¸åŒçš„ä½¿ç”¨æ–¹å¼å°±å¥½äº†ï¼Œæœ€å¼€å§‹æˆ‘æ˜¯ç”¨çš„
`toPng`
æ–¹æ³•ï¼Œä½¿ç”¨çš„æ—¶å€™é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œä¸è¿‡å·²ç»æ˜¯äº”ä¸ªæœˆå‰çš„äº‹å„¿äº†æ‰€ä»¥è¿™é‡Œå°±è·³è¿‡ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯
**toBlob**
æ–¹æ³•ï¼Œä¸ªäººä¹Ÿæ¨èä½¿ç”¨toBlobæ–¹æ³•ã€‚

```ts
import { toBlob } from 'html-to-image'

toBlob(node,config)
  .then((blob)=> {
  ...
  });

```

åŸºç¡€çš„ä½¿ç”¨å¦‚ä¸Šæ‰€ç¤ºï¼Œå…¶ä¸­ç¬¬äºŒä¸ªå‚æ•°æ˜¯ç”Ÿæˆå›¾ç‰‡çš„ä¸€äº›é…ç½®ï¼Œç”¨äºä¸€äº›å®šåˆ¶åŒ–çš„éœ€æ±‚ã€‚

1. **`canvasWidth`
   å’Œ
   `canvasHeight`**
   * **ä½œç”¨**
     ï¼šè®¾ç½®ç”Ÿæˆçš„ canvas å…ƒç´ çš„å®½åº¦å’Œé«˜åº¦ã€‚
   * **é»˜è®¤å€¼**
     ï¼šæ ¹æ® HTML å…ƒç´ çš„å°ºå¯¸è‡ªåŠ¨è®¡ç®—ã€‚
2. **`style`**
   * **ä½œç”¨**
     ï¼šæ·»åŠ é¢å¤–çš„ CSS æ ·å¼åˆ°ç”Ÿæˆçš„ canvas ä¸Šã€‚
   * **é»˜è®¤å€¼**
     ï¼šæ— ã€‚
3. **`pixelRatio`**
   * **ä½œç”¨**
     ï¼šè®¾ç½®ç”Ÿæˆå›¾åƒçš„åƒç´ å¯†åº¦ã€‚å€¼è¶Šå¤§ï¼Œå›¾åƒè´¨é‡è¶Šé«˜ï¼Œä½†æ–‡ä»¶å¤§å°ä¹Ÿè¶Šå¤§ã€‚
   * **é»˜è®¤å€¼**
     ï¼š
     `window.devicePixelRatio`
     ã€‚
4. **`cacheBust`**
   * **ä½œç”¨**
     ï¼šæ·»åŠ ä¸€ä¸ªå”¯ä¸€çš„æŸ¥è¯¢å‚æ•°åˆ°å›¾åƒ URL ä¸­ï¼Œä»¥é¿å…ç¼“å­˜é—®é¢˜ã€‚
   * **é»˜è®¤å€¼**
     ï¼š
     `true`
     ã€‚
5. **`quality`**
   * **ä½œç”¨**
     ï¼šè®¾ç½®ç”Ÿæˆå›¾åƒçš„è´¨é‡ï¼ˆä»…é€‚ç”¨äº JPEG æ ¼å¼ï¼‰ã€‚
   * **é»˜è®¤å€¼**
     ï¼š
     `1.0`
     ï¼ˆæœ€é«˜è´¨é‡ï¼‰ã€‚
6. **`imagePlaceholder`**
   * **ä½œç”¨**
     ï¼šè®¾ç½®å›¾åƒåŠ è½½å¤±è´¥æ—¶çš„å ä½ç¬¦å›¾åƒ URLã€‚
   * **é»˜è®¤å€¼**
     ï¼š
     `undefined`
     ã€‚
7. **`skipFonts`**
   * **ä½œç”¨**
     ï¼šè·³è¿‡å­—ä½“åŠ è½½ï¼ŒåŠ å¿«ç”Ÿæˆé€Ÿåº¦ã€‚
   * **é»˜è®¤å€¼**
     ï¼š
     `false`
     ã€‚
8. **`fontEmbedCSS`**
   * **ä½œç”¨**
     ï¼šè‡ªå®šä¹‰å­—ä½“åµŒå…¥çš„ CSS æ ·å¼ã€‚
   * **é»˜è®¤å€¼**
     ï¼š
     `undefined`
     ã€‚
9. **`filter`**
   * **ä½œç”¨**
     ï¼šä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºè¿‡æ»¤ä¸éœ€è¦è½¬æ¢çš„èŠ‚ç‚¹æˆ–é¢å¤–å¤„ç†ã€‚
   * **é»˜è®¤å€¼**
     ï¼š
     `undefined`
     ã€‚
10. **`backgroundColor`**
    * **ä½œç”¨**
      ï¼šè®¾ç½®ç”Ÿæˆå›¾åƒçš„èƒŒæ™¯é¢œè‰²ã€‚
    * **é»˜è®¤å€¼**
      ï¼š
      `undefined`
      ã€‚
11. **`width`
    å’Œ
    `height`**
    * **ä½œç”¨**
      ï¼šè®¾ç½®ç”Ÿæˆå›¾åƒçš„å®½åº¦å’Œé«˜åº¦ã€‚
    * **é»˜è®¤å€¼**
      ï¼šæ ¹æ® HTML å…ƒç´ çš„å°ºå¯¸è‡ªåŠ¨è®¡ç®—ã€‚
12. **`type`**
    * **ä½œç”¨**
      ï¼šè®¾ç½®ç”Ÿæˆå›¾ç‰‡çš„ç±»å‹ã€‚
    * **é»˜è®¤å€¼**
      ï¼š
      `image/png`

ä¸Šé¢æ˜¯éƒ¨åˆ†é…ç½®é¡¹ï¼Œæ›´å¤šçš„é…ç½®é¡¹å’Œä½¿ç”¨æ–¹æ³•å¯ä»¥ç§»æ­¥æ–‡æ¡£ã€‚

#### é—®é¢˜è®°å½•

åŸºç¡€çš„ä½¿ç”¨æ–¹æ³•è¯´å®Œäº†ï¼Œä¸‹é¢è¯´è¯´ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜

##### transformå¯¼è‡´çš„å…ƒç´ åç§»

åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­æˆ‘å‘ç°éƒ¨åˆ†ç”Ÿæˆçš„å›¾ç‰‡æ²¡æœ‰å…ƒç´ ï¼Œèµ·åˆæˆ‘ä»¥ä¸ºæ˜¯å…ƒç´ ä¸­å›¾ç‰‡çš„é—®é¢˜ï¼Œåæ¥å‘ç°éƒ¨åˆ†å…ƒç´ çš„åç§»ä½¿ç”¨çš„æ˜¯å®šä½éƒ¨åˆ†ä½¿ç”¨çš„æ˜¯transformï¼Œå®šä½çš„topã€leftç­‰å€¼æ˜¯å¯ä»¥æ­£å¸¸æ•æ‰åˆ°å…ƒç´ çš„ï¼Œä½†æ˜¯å½“ä½¿ç”¨transformçš„æ—¶å€™ï¼Œå› ä¸ºåç§»æ˜¯ç›¸å¯¹è‡ªèº«çš„ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´å…ƒç´ å¯èƒ½è¶…å‡ºäº†ç”Ÿæˆçš„å›¾ç‰‡èŒƒå›´ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨çš„æ–¹æ³•æ˜¯è½¬å›¾ç‰‡çš„æ—¶å€™æ‰‹åŠ¨æ¸…é™¤transformï¼Œè½¬æ¢å®Œæ¯•åå†è®¾ç½®å›å»ã€‚

```ts
const transformList = []
const nodeTransform = node.style.transform
const rotateRegex = /rotate\([-.\d]+deg\)/
const match = nodeTransform.match(rotateRegex)
const isRotate = match && match[0] !== 'rotate(0deg)'
if (nodeTransform) {
   node.style.transform = '' // è¿™é‡Œåº”è¯¥ä¿ç•™rotateï¼Œå› ä¸ºæˆ‘è¿™é‡Œä¸éœ€è¦å¤„ç†æ‰€ä»¥ç›´æ¥æ¸…é™¤ï¼Œrotateåªä½œåŒ¹é…å±•ç¤º
}
toBlob(node).then((res) => {
  ...
}).finally(() => {
   requestAnimationFrame(() => {
     node.style.transform = transformList[index] // æˆ‘è¿™é‡Œä½¿ç”¨äº†nodeListéå†æ‰€ä»¥ç”¨åˆ°äº†index,å…·ä½“ä½¿ç”¨çœ‹ä¸ªäººå®é™…æƒ…å†µ
   })
})

```

##### èƒŒæ™¯å›¾æ¸²æŸ“å¯¼è‡´ç”Ÿæˆçš„å›¾ç‰‡å˜å½¢

æˆ‘ä»¬çš„é¡µé¢ä¸­æœ‰éƒ¨åˆ†å…ƒç´ æ˜¯é‡‡ç”¨èƒŒæ™¯å›¾ç„¶åè®¾ç½®backgroundçš„æ–¹å¼å®ç°çš„

```css
background: url(...) 0% 0% / 100% 100% no-repeat;

```

å½“æ—¶æ’æŸ¥åˆ°æ˜¯èƒŒæ™¯å›¾å…ƒç´ ä¼šå¯¼è‡´ç”Ÿæˆå›¾ç‰‡å˜å½¢åæˆ‘å°è¯•äº†ä½¿ç”¨å…¶ä»–èƒŒæ™¯å‚æ•°å»è®¾ç½®ï¼Œæ— è®ºæ˜¯è®¾ç½®
`background-size`
è¿˜æ˜¯
`background-position`
çš„å…¶ä»–å€¼ç”Ÿæˆçš„å›¾ç‰‡éƒ½æ˜¯è¢«æ‹‰ä¼¸çš„ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘é‡‡ç”¨ç¬¬äºŒç§æ–¹æ¡ˆï¼Œè½¬å›¾ç‰‡å‰å°†èƒŒæ™¯å›¾è½¬æˆå›¾ç‰‡å…ƒç´ ç„¶åå†æ¢å¤ã€‚

```ts
// åœ¨è°ƒç”¨toBolbæ–¹æ³•å‰æ·»åŠ ä¸‹é¢ä»£ç 
let backgroundImage = node.style.backgroundImage
let isBgRenderEle =
    backgroundImage !== '' && backgroundImage !== 'url("")'
if (isBgRenderEle) {
  const imgUrl = backgroundImage
  .replace(/^url\(["']?/, '')
  .replace(/["']?\)$/, '')
  const imgNode = document.createElement('img')
  imgNode.src = imgUrl
  imgNode.style.width = '100%'
  imgNode.style.height = '100%'
  node.style.backgroundImage = ''
  node.appendChild(imgNode)
}

// è½¬æˆå›¾ç‰‡åæ·»åŠ ä¸‹é¢ä»£ç 
 if (isBgRenderEle) {
   node.innerHTML = ''
   node.style.backgroundImage = backgroundImage
   backgroundImage = ''
   isBgRenderEle = false
 }

```