---
layout: post
title: "MathJS入门mathjs最佳实践,快速解决前端在数学计算时出现的精度问题"
date: 2025-01-19 16:46:32 +0800
description: "前沿前端的小伙伴，在项目开发中，当你在进行一些基础的数学运算时，不可避免的就会遇到让人头疼的精度问题"
keywords: "前端计算精度问题"
categories: ['精度问题', 'Mathjs', 'Js']
tags: ['Javascript']
artid: "107326742"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=107326742
    alt: "MathJS入门mathjs最佳实践,快速解决前端在数学计算时出现的精度问题"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=107326742
featuredImagePreview: https://bing.ee123.net/img/rand?artid=107326742
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     【MathJS】入门mathjs最佳实践，快速解决前端在数学计算时出现的精度问题
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="_0">
     </a>
     前沿
    </h3>
    <p>
     前端的小伙伴，在项目开发中，比如常见的订单模块中，都会进行一些基础的数学运算时，不可避免的就会遇到让人头疼的精度问题。
     <a href="https://www.cnblogs.com/zm-blogs/p/12909096.html" rel="nofollow">
      为什么会出现精度问题
     </a>
     ，这里就略过，本篇重点介绍解决精度问题。
    </p>
    <h3>
     <a id="_3">
     </a>
     上手撸代码
    </h3>
    <p>
     安装
    </p>
    <pre><code class="prism language-javascript">npm i <span class="token operator">--</span>save<span class="token operator">-</span>dev mathjs
</code></pre>
    <p>
     在项目中引入mathjs
    </p>
    <pre><code class="prism language-javascript"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> math <span class="token keyword">from</span> <span class="token string">'mathjs'</span>
</code></pre>
    <p>
     加一个consol方法，方便打印
    </p>
    <pre><code class="prism language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">consol</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arguments<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="Add_23">
     </a>
     Add（加法运算）
    </h3>
    <pre><code class="prism language-javascript"><span class="token comment">// 之前</span>
<span class="token function">consol</span><span class="token punctuation">(</span><span class="token number">0.1</span> <span class="token operator">+</span> <span class="token number">0.2</span><span class="token punctuation">)</span> <span class="token comment">// 0.30000000000000004</span>
<span class="token comment">// 之后</span>
<span class="token keyword">const</span> addNumber <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>
  math<span class="token punctuation">.</span><span class="token function">chain</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">bignumber</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">bignumber</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token function">consol</span><span class="token punctuation">(</span>addNumber<span class="token punctuation">)</span> <span class="token comment">// 0.3</span>
</code></pre>
    <h3>
     <a id="Chaining__37">
     </a>
     Chaining 链式调用
    </h3>
    <p>
     在实际开发中，需要快速上手，要在最短的时间内解决问题。我的思路就是
     <strong>
      写一个最简单的用例，搞清楚它的输入和输出，从而正确的理解它的作用
     </strong>
     。
    </p>
    <pre><code class="prism language-javascript"><span class="token function">consol</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">chain</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Chain {value: 0.1}</span>

<span class="token function">consol</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">chain</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Chain {value: 0.30000000000000004}</span>

<span class="token comment">/*
* 通过在尾部调用一下任意一种方法，返回Chain的value值
* The Chain has all functions available in the math namespace, and has a number of special functions:
    done()     Finalize the chain and return the chain’s value.
    valueOf()  The same as done(), returns the chain’s value.
    toString() Executes math.format(value) onto the chain’s value, returning a string representation of the value.
*/</span>
<span class="token function">consol</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">chain</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 0.30000000000000004</span>
<span class="token function">consol</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">chain</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 0.30000000000000004</span>
<span class="token function">consol</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">chain</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 0.30000000000000004</span>

<span class="token function">consol</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> math<span class="token punctuation">.</span><span class="token function">chain</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// number</span>
<span class="token function">consol</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> math<span class="token punctuation">.</span><span class="token function">chain</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// number</span>
<span class="token function">consol</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> math<span class="token punctuation">.</span><span class="token function">chain</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// string</span>
</code></pre>
    <p>
     chain调用，返回的是Chain的实例对象，就需要尾部调用，返回chain的value值，如上。
    </p>
    <pre><code class="prism language-javascript"><span class="token comment">/*
* Function format
* Format a value of any type into a string.
*/</span>
<span class="token function">consol</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">chain</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 0.30000000000000004</span>
<span class="token function">consol</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> math<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">chain</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// string</span>
</code></pre>
    <p>
     看上去，math.format()只是把number类型转成string类型，别慌，后面讲bignumber时，才会真正体会到它的价值。
    </p>
    <h3>
     <a id="BigNumbers_70">
     </a>
     BigNumbers
    </h3>
    <p>
     <strong>
      划重点：对于具有任意精度的计算，math.js支持BigNumber数据类型，bignumber返回一个Decimal类
     </strong>
    </p>
    <pre><code class="prism language-javascript"><span class="token comment">/*
* BigNumbers
* 对于具有任意精度的计算，math.js支持BigNumber数据类型
* bignumber返回一个Decimal类
*/</span>
<span class="token keyword">const</span> _a <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">bignumber</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span> <span class="token comment">// Decimal {s: 1, e: -1, d: Array(1), constructor: ƒ}</span>
<span class="token keyword">const</span> _b <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">bignumber</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> math<span class="token punctuation">.</span><span class="token function">bignumber</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Decimal {s: 1, e: -1, d: Array(1), constructor: ƒ}</span>
math<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>_b<span class="token punctuation">)</span> <span class="token comment">// 0.3</span>
</code></pre>
    <p>
     math.format()，返回了Decimal类的value值。
    </p>
    <p>
     总结一下，math的链式调用与rxjs差不多，写法非常灵活，可根据实际场景组合使用。来一个简单的例子：
    </p>
    <pre><code class="prism language-javascript"><span class="token keyword">const</span> addNumber <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>
  math<span class="token punctuation">.</span><span class="token function">chain</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">bignumber</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">bignumber</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token keyword">const</span> a <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>
  math<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">bignumber</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> math<span class="token punctuation">.</span><span class="token function">bignumber</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre>
    <h3>
     <a id="Subtract_98">
     </a>
     Subtract（减法运算）
    </h3>
    <pre><code class="prism language-javascript"><span class="token function">consol</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> <span class="token number">0.9</span><span class="token punctuation">)</span> <span class="token comment">// 0.09999999999999998</span>

<span class="token keyword">const</span> subtractNumber <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>
  math<span class="token punctuation">.</span><span class="token function">chain</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">subtract</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">bignumber</span><span class="token punctuation">(</span><span class="token number">0.9</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token function">consol</span><span class="token punctuation">(</span>subtractNumber<span class="token punctuation">)</span> <span class="token comment">// 0.1</span>
<span class="token keyword">const</span> subtractNumber_1 <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>
  math<span class="token punctuation">.</span><span class="token function">subtract</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">bignumber</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> math<span class="token punctuation">.</span><span class="token function">bignumber</span><span class="token punctuation">(</span><span class="token number">0.9</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token function">consol</span><span class="token punctuation">(</span>subtractNumber_1<span class="token punctuation">)</span> <span class="token comment">// 0.1</span>
</code></pre>
    <h3>
     <a id="Multiply_115">
     </a>
     Multiply（乘法运算）
    </h3>
    <pre><code class="prism language-javascript"><span class="token function">consol</span><span class="token punctuation">(</span><span class="token number">11</span> <span class="token operator">*</span> <span class="token number">1.2</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">// 39.599999999999994</span>

<span class="token keyword">const</span> multiplyMumber <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>
  math<span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">bignumber</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">,</span> math<span class="token punctuation">.</span><span class="token function">bignumber</span><span class="token punctuation">(</span><span class="token number">1.2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> math<span class="token punctuation">.</span><span class="token function">bignumber</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token function">consol</span><span class="token punctuation">(</span>multiplyMumber<span class="token punctuation">)</span> <span class="token comment">// 39.6</span>

</code></pre>
    <h3>
     <a id="Divide_127">
     </a>
     Divide（除法运算）
    </h3>
    <pre><code class="prism language-javascript"><span class="token function">consol</span><span class="token punctuation">(</span><span class="token number">1.2</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">// 0.39999999999999997</span>

<span class="token keyword">const</span> divideNumber <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>
  math<span class="token punctuation">.</span><span class="token function">divide</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">bignumber</span><span class="token punctuation">(</span><span class="token number">1.2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> math<span class="token punctuation">.</span><span class="token function">bignumber</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token function">consol</span><span class="token punctuation">(</span>divideNumber<span class="token punctuation">)</span> <span class="token comment">// 0.4</span>

<span class="token keyword">const</span> divideNumber_1 <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>
  math<span class="token punctuation">.</span><span class="token function">chain</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">bignumber</span><span class="token punctuation">(</span><span class="token number">1.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">divide</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">bignumber</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token function">consol</span><span class="token punctuation">(</span>divideNumber_1<span class="token punctuation">)</span> <span class="token comment">// 0.4</span>
</code></pre>
    <p>
     简单总结一下，简单的加减乘除都可以按照上面的实现，要进行组合计算时，就可以使用链式调用.
     <br/>
     还有一些场景需要处理，
    </p>
    <p>
     1.保留N位小数的问题
    </p>
    <h3>
     <a id="Round_148">
     </a>
     Round（四舍五入）
    </h3>
    <pre><code class="prism language-javascript"><span class="token comment">// Round 四舍五入，保留2位小数</span>
<span class="token function">consol</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token number">12.0355</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 12.036</span>
<span class="token function">consol</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token number">12.0354</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 12.035</span>
<span class="token function">consol</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token number">12.0354</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 12.04</span>
<span class="token function">consol</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token number">12.100</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 12.1</span>
</code></pre>
    <p>
     最后，再来一个综合实例
    </p>
    <pre><code class="prism language-javascript"><span class="token function">consol</span><span class="token punctuation">(</span>
  <span class="token operator">+</span>math<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>
    math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>
      math<span class="token punctuation">.</span><span class="token function">chain</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subtract</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span><span class="token number">1.2</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">divide</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token number">3</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token comment">// 0.011879999999999998 =&gt; 0.012</span>
</code></pre>
    <p>
     掌握到基础用法之后，我们来手动实现一两个方法
    </p>
    <h3>
     <a id="Round_172">
     </a>
     手动实现一个Round
    </h3>
    <p>
     实现非常简单，2行代码，没有任何意外的情况。
    </p>
    <pre><code class="prism language-javascript"><span class="token comment">// toFixed 即使位数不够，也会用0补充</span>
<span class="token function">consol</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span><span class="token number">12.035</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 12.04</span>
<span class="token function">consol</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span><span class="token number">12.1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 12.10</span>
<span class="token function">consol</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 12.00</span>
<span class="token comment">// string转number</span>
<span class="token keyword">function</span> <span class="token function">formatNumber</span><span class="token punctuation">(</span>number<span class="token punctuation">,</span> len <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 四舍五入</span>
  number <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span>len<span class="token punctuation">)</span>
  <span class="token comment">// 去尾部的0</span>
  <span class="token keyword">return</span> <span class="token function">Number</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">consol</span><span class="token punctuation">(</span><span class="token function">formatNumber</span><span class="token punctuation">(</span><span class="token number">12.0355</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 12.036</span>
<span class="token function">consol</span><span class="token punctuation">(</span><span class="token function">formatNumber</span><span class="token punctuation">(</span><span class="token number">12.0354</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 12.035</span>
<span class="token function">consol</span><span class="token punctuation">(</span><span class="token function">formatNumber</span><span class="token punctuation">(</span><span class="token number">12.0354</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 12.04</span>
<span class="token function">consol</span><span class="token punctuation">(</span><span class="token function">formatNumber</span><span class="token punctuation">(</span><span class="token number">12.100</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 12.1</span>
</code></pre>
    <h3>
     <a id="Add_192">
     </a>
     手动实现一个Add
    </h3>
    <p>
     基本逻辑：把需要计算的数字升级（乘以10的n次幂）成计算机能够精度识别的整数，等计算完毕后在降级（除以10的n次幂）
    </p>
    <pre><code class="prism language-javascript"><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token operator">...</span>numList<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> base <span class="token operator">=</span> <span class="token number">10</span>
    <span class="token keyword">const</span> maxPrecision <span class="token operator">=</span> numList<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>curMaxPrecision<span class="token punctuation">,</span> num<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> curPrecision <span class="token operator">=</span> <span class="token function">getNumPrecision</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
        <span class="token keyword">return</span> curMaxPrecision <span class="token operator">&gt;</span> curPrecision <span class="token operator">?</span> curMaxPrecision <span class="token punctuation">:</span> curPrecision
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> enlargeScale <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span>base<span class="token punctuation">,</span> maxPrecision<span class="token punctuation">)</span>
    <span class="token keyword">const</span> startNum <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">const</span> counts <span class="token operator">=</span> numList<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>total<span class="token punctuation">,</span> num<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> total <span class="token operator">+</span> num <span class="token operator">*</span> enlargeScale
    <span class="token punctuation">}</span><span class="token punctuation">,</span> startNum<span class="token punctuation">)</span>
    <span class="token keyword">return</span> counts <span class="token operator">/</span> enlargeScale
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">getNumPrecision</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>num<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length
<span class="token punctuation">}</span>

<span class="token function">consol</span><span class="token punctuation">(</span><span class="token number">0.1</span> <span class="token operator">+</span> <span class="token number">0.2</span> <span class="token operator">+</span> <span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 0.6000000000000001</span>
<span class="token function">consol</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 0.6</span>
</code></pre>
    <p>
     <strong>
      其他解决方案
     </strong>
     <br/>
     bignumber.js
     <br/>
     BigDecimal.js
     <br/>
     long.js
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f33363332313930392f:61727469636c652f64657461696c732f313037333236373432" class_="artid" style="display:none">
 </p>
</div>


