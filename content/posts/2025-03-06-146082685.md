---
layout: post
title: "第十章,防火墙带宽管理"
date: 2025-03-06 23:36:16 +0800
description: "的上网用户数量不固定，为了让用户公平的使用带宽，根据实际在线上网用户数量，平均分配带宽。多个带宽策略以策略共享的方式，引入相同的带宽通道，则匹配了多个带宽策略的流量可以实现带。受入接口带宽限制，如果流量大于入接口，将依据带宽通道中设定的转发优先级来对流量进行。多条流量匹配到同一个策略，从而进入相同带宽通道，多条流量之间实现带宽复用。流量匹配带宽策略，经过带宽策略的分流后，进入相应的带宽通道进行处理。所有引用带宽通道的策略，都共同受到该带宽通道的约束。匹配了父子策略的多个子策略的多条流量可以实现带宽复用。"
keywords: "第十章，防火墙带宽管理"
categories: ['防护保护']
tags: ['运维', '网络', '服务器']
artid: "146082685"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146082685
    alt: "第十章,防火墙带宽管理"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146082685
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146082685
cover: https://bing.ee123.net/img/rand?artid=146082685
image: https://bing.ee123.net/img/rand?artid=146082685
img: https://bing.ee123.net/img/rand?artid=146082685
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     第十章，防火墙带宽管理
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h2>
     概述
    </h2>
    <div>
     <span style="color:#333333">
      带宽的理论流动数据量
     </span>
     <span style="color:#333333">
      与
     </span>
     <span style="color:#333333">
      实际的流量数据量；
     </span>
    </div>
    <div>
    </div>
    <div>
     <span style="color:#333333">
      对通过防火墙的流量进行管理和控制，带宽保证、带宽限制以及连接数限制。从而提高带宽利用
     </span>
    </div>
    <div>
     <span style="color:#333333">
      率，避免带宽耗尽。
     </span>
    </div>
    <div>
    </div>
    <ul>
     <li>
      <span style="color:#333333">
       带宽保证
      </span>
      <span style="color:#333333">
       ---
      </span>
      <span style="color:#333333">
       企业网络中关键业务所需的基本带宽，当线路繁忙的时候，确保此类业务不受影响
      </span>
     </li>
     <li>
      <span style="color:#333333">
       带宽限制
      </span>
      <span style="color:#333333">
       ---
      </span>
      <span style="color:#333333">
       限制网络中的一些非关键性业务占据过多的带宽，避免资源消耗
      </span>
     </li>
     <li>
      <span style="color:#333333">
       连接数限制
      </span>
      <span style="color:#333333">
       ---
      </span>
      <span style="color:#333333">
       限制业务会话数量，有利于降低该业务占据的带宽
      </span>
     </li>
    </ul>
    <p>
    </p>
    <p>
     <img alt="" height="247" src="https://i-blog.csdnimg.cn/direct/d18816f2e924414493b7c7b25f0fac9c.png" width="717"/>
    </p>
    <p>
    </p>
    <ul>
     <li>
      <span style="color:#333333">
       对企业总数据进行带宽管理
      </span>
     </li>
     <li>
      <span style="color:#333333">
       对每个
      </span>
      <span style="color:#333333">
       IP/
      </span>
      <span style="color:#333333">
       每个用户来实施带宽管理
      </span>
     </li>
     <li>
      <span style="color:#333333">
       多级策略方式，按部门实施带宽管理
      </span>
     </li>
     <li>
      <span style="color:#333333">
       动态分配
      </span>
     </li>
    </ul>
    <h2>
     <span style="color:#333333">
      实现原理
     </span>
    </h2>
    <p>
    </p>
    <p>
    </p>
    <div>
     <span style="color:#333333">
      <strong>
       总体流程
      </strong>
     </span>
    </div>
    <ul>
     <li>
      <span style="color:#333333">
       带宽通道
      </span>
      <span style="color:#333333">
       ---
      </span>
      <span style="color:#333333">
       定义了被管理对象所能使用的带宽资源；该通道会被带宽策略引用
      </span>
     </li>
     <li>
      <span style="color:#333333">
       带宽策略
      </span>
      <span style="color:#333333">
       ---
      </span>
      <span style="color:#333333">
       定义了被管理的对象和动作
      </span>
     </li>
     <li>
      <span style="color:#333333">
       接口带宽
      </span>
      <span style="color:#333333">
       ---
      </span>
      <span style="color:#333333">
       <strong>
        分为接口入方向和接口出方向的实际带宽
       </strong>
      </span>
      <ul>
       <li>
        <span style="color:#333333">
         当发生拥塞时，
        </span>
        <span style="color:#333333">
         <strong>
          队列调度机制
         </strong>
        </span>
       </li>
       <li>
        <img alt="" height="235" src="https://i-blog.csdnimg.cn/direct/585e10a4f4e64006ace1144e76a1d709.png" width="641"/>
       </li>
       <li>
        <span style="color:#333333">
         流量匹配带宽策略，经过带宽策略的分流后，进入相应的带宽通道进行处理。
        </span>
       </li>
      </ul>
     </li>
    </ul>
    <p>
     <span style="color:#333333">
      丢弃超过预定义最大带宽的流量
     </span>
    </p>
    <ul>
     <li>
      <span style="color:#333333">
       限制业务连接数
      </span>
     </li>
     <li>
      <span style="color:#333333">
       <strong>
        标记流量的优先级，作为后续队列调度的依据
       </strong>
      </span>
      <ul>
       <li>
        <span style="color:#333333">
         受入接口带宽限制，如果流量大于入接口，将依据带宽通道中设定的转发优先级来对流量进行
        </span>
        <span style="color:#333333">
         队列调度，保证高优先级的报文优先发送
        </span>
       </li>
       <li>
        <span style="color:#333333">
         流量最终会从出接口发送，并且收到出接口带宽限制，如果流量大于出接口，则按照转发优先
        </span>
        <span style="color:#333333">
         级来调度。
        </span>
       </li>
      </ul>
     </li>
    </ul>
    <p>
    </p>
    <h2>
     <span style="color:#333333">
      带宽通道
     </span>
    </h2>
    <div>
     <span style="color:#333333">
      <strong>
       将物理的带宽资源从逻辑上划分为多个虚拟的带宽资源
      </strong>
      。
     </span>
    </div>
    <div>
    </div>
    <ul>
     <li>
      <span style="color:#333333">
       整体的保证带宽和最大带宽
      </span>
      <ul>
       <li>
        <span style="color:#ffa500">
         <strong>
          处理方式
         </strong>
        </span>
        <span style="color:#333333">
         ：
        </span>
        <ul>
         <li>
          <span style="color:#333333">
           如果流量
          </span>
          <span style="color:#333333">
           &lt;
          </span>
          <span style="color:#333333">
           保证带宽，则这部分流量直接发送
          </span>
         </li>
         <li>
          <span style="color:#333333">
           如果流量
          </span>
          <span style="color:#333333">
           &gt;
          </span>
          <span style="color:#333333">
           最大带宽，则这部分流量直接被丢弃
          </span>
         </li>
         <li>
          <span style="color:#ff0000">
           <strong>
            如果流量
           </strong>
          </span>
          <span style="color:#ff0000">
           <strong>
            &lt;
           </strong>
          </span>
          <span style="color:#ff0000">
           <strong>
            最大带宽，
           </strong>
          </span>
          <span style="color:#ff0000">
           <strong>
            &gt;
           </strong>
          </span>
          <span style="color:#ff0000">
           <strong>
            保证带宽，则这部分流量会在出接口发送环节与其他带宽通道中
           </strong>
          </span>
          <span style="color:#ff0000">
           <strong>
            的同类型流量自由竞争带宽资源
           </strong>
          </span>
          <span style="color:#333333">
           。
          </span>
          <ul>
           <li>
            <span style="color:#333333">
             <strong>
              依靠优先级竞争，优先级高的占据剩余带宽资源。优先级低的被丢弃
             </strong>
            </span>
            <span style="color:#333333">
             。
            </span>
           </li>
          </ul>
         </li>
        </ul>
       </li>
       <li>
        <strong style="color:#333333">
         在带宽通道中，最大带宽、保证带宽和连接数限制，均支持上下行设置
        </strong>
        <span style="color:#333333">
         。
        </span>
       </li>
      </ul>
     </li>
     <li>
      <span style="color:#333333">
       设定每一个用户
      </span>
      <span style="color:#333333">
       /IP
      </span>
      <span style="color:#333333">
       的保证带宽和最大带宽
      </span>
     </li>
     <li>
      <span style="color:#333333">
       连接数限制
      </span>
      <ul>
       <li>
        <span style="color:#333333">
         <strong>
          一条会话连接
         </strong>
        </span>
        <span style="color:#333333">
         ---
        </span>
        <span style="color:#ff0000">
         <strong>
          FW
         </strong>
        </span>
        <span style="color:#ff0000">
         <strong>
          通过限制自身生成的会话数量，来实现连接数的限制
         </strong>
        </span>
        <span style="color:#333333">
         。
        </span>
       </li>
       <li>
        <span style="color:#333333">
         主要限制
        </span>
        <span style="color:#333333">
         P2P
        </span>
        <span style="color:#333333">
         业务。
        </span>
       </li>
      </ul>
     </li>
     <li>
      <span style="color:#333333">
       <strong>
        优先级重标记
       </strong>
      </span>
      <span style="color:#333333">
       <strong>
        --- DSCP
       </strong>
      </span>
      <ul>
       <li>
        <span style="color:#ff0000">
         <strong>
          DSCP ---
         </strong>
        </span>
        <span style="color:#ff0000">
         <strong>
          差分服务代码点
         </strong>
        </span>
        <span style="color:#333333">
         ---
        </span>
        <span style="color:#333333">
         一种指示网络流量优先级的字段
        </span>
       </li>
      </ul>
     </li>
     <li>
      <span style="color:#333333">
       IP
      </span>
      <span style="color:#333333">
       头部中的服务类型字段
      </span>
      <span style="color:#333333">
       1
      </span>
      <span style="color:#333333">
       字节，只是使用了
      </span>
      <span style="color:#333333">
       6bit
      </span>
      <span style="color:#333333">
       ，通过编码的形式来区分优先级。在
      </span>
      <span style="color:#333333">
       TOS
      </span>
      <span style="color:#333333">
       字段
      </span>
      <span style="color:#333333">
       中
      </span>
      <span style="color:#333333">
       8bit
      </span>
      <span style="color:#333333">
       使用，只不过在
      </span>
      <span style="color:#333333">
       <strong>
        早期只使用了前
       </strong>
      </span>
      <span style="color:#333333">
       <strong>
        3bit
       </strong>
      </span>
      <span style="color:#333333">
       <strong>
        ，被划分为
       </strong>
      </span>
      <span style="color:#333333">
       <strong>
        8
       </strong>
      </span>
      <span style="color:#333333">
       <strong>
        个优先级，优先级数值越大优先度越
       </strong>
      </span>
      <span style="color:#333333">
       <strong>
        高
       </strong>
      </span>
      <span style="color:#333333">
       。
      </span>
     </li>
     <li>
      <pre><code class="hljs">7 --- 保留
6 --- 保留
5 --- 语音数据
4 --- 视频会议数据
3 --- 呼叫信号
2 --- 高优先级
1 --- 中优先级
0 --- 低优先级</code></pre>
      <p>
      </p>
     </li>
    </ul>
    <p>
    </p>
    <div>
     <span style="color:#333333">
      带宽通道被带宽策略引用后，存在两种工作方式：
     </span>
    </div>
    <ul>
     <li>
      <span style="color:#333333">
       策略独占
      </span>
      <ul>
       <li>
        <span style="color:#333333">
         <strong>
          带宽策略和带宽通道一一对应
         </strong>
        </span>
        <span style="color:#333333">
         。
        </span>
       </li>
      </ul>
     </li>
     <li>
      <span style="color:#333333">
       策略共享
      </span>
      <ul>
       <li>
        <span style="color:#333333">
         所有引用带宽通道的策略，都共同受到该带宽通道的约束。
        </span>
       </li>
       <li>
        <span style="color:#333333">
         多个带宽策略对应一个带宽通道。
        </span>
       </li>
      </ul>
     </li>
    </ul>
    <p>
    </p>
    <p>
    </p>
    <h3>
     <span style="color:#333333">
      <strong>
       带宽复用
      </strong>
     </span>
    </h3>
    <div>
     <span style="color:#ff0000">
      <strong>
       指的是多条流量进入同一个带宽通道后，带宽通道内带宽资源的动态分配方式
      </strong>
     </span>
     <span style="color:#333333">
      。
     </span>
    </div>
    <div>
    </div>
    <ul>
     <li>
      <span style="color:#333333">
       多条流量匹配到同一个策略，从而进入相同带宽通道，多条流量之间实现带宽复用。
      </span>
     </li>
     <li>
      <span style="color:#333333">
       多个带宽策略以策略共享的方式，引入相同的带宽通道，则匹配了多个带宽策略的流量可以实现带
      </span>
      <span style="color:#333333">
       宽复用。
      </span>
     </li>
     <li>
      <span style="color:#333333">
       匹配了父子策略的多个子策略的多条流量可以实现带宽复用
      </span>
     </li>
    </ul>
    <h3>
     <span style="color:#333333">
      <strong>
       流量转发优先级
      </strong>
     </span>
    </h3>
    <ul>
     <li>
      <span style="color:#333333">
       流量监管
      </span>
      <span style="color:#333333">
       ---
      </span>
      <span style="color:#333333">
       某个连接的流量超过带宽上限，则报文直接被丢弃。
      </span>
     </li>
     <li>
      <span style="color:#333333">
       流量整形
      </span>
      <span style="color:#333333">
       ---
      </span>
      <span style="color:#333333">
       通过队列机制，将超出带宽上限的峰值流量和突发流量报文
      </span>
      <span style="color:#333333">
       <strong>
        延迟传输
       </strong>
      </span>
      <span style="color:#333333">
       。
      </span>
     </li>
    </ul>
    <div>
     <span style="color:#ff0000">
      <strong>
       依靠优先级区分，优先级=4
      </strong>
     </span>
     <span style="color:#ff0000">
      <strong>
       的情况，采用流量监管。当优先级
      </strong>
     </span>
     <span style="color:#ff0000">
      <strong>
       ≠
      </strong>
     </span>
     <span style="color:#ff0000">
      <strong>
       4
      </strong>
     </span>
     <span style="color:#ff0000">
      <strong>
       ，则采用流量整形
      </strong>
     </span>
     <span style="color:#333333">
      。优先级大于
     </span>
     <span style="color:#333333">
      4的报文被优先转发，小于4
     </span>
     <span style="color:#333333">
      则延迟转发。
     </span>
    </div>
    <div>
     <span style="color:#333333">
      <strong>
       延迟转发的数据流大小受到缓冲区队列长度的限制，一旦数据量超出缓冲区大小，则超出部分将被
      </strong>
     </span>
     <span style="color:#333333">
      <strong>
       丢弃
      </strong>
     </span>
     <span style="color:#333333">
      。
     </span>
    </div>
    <div>
    </div>
    <div>
    </div>
    <h2>
     <span style="color:#333333">
      <strong>
       带宽策略
      </strong>
     </span>
    </h2>
    <p>
    </p>
    <p>
     <img alt="" height="385" src="https://i-blog.csdnimg.cn/direct/4a98de0735254b73863f10cbc512e805.png" width="625"/>
    </p>
    <p>
    </p>
    <p>
    </p>
    <div>
     <span style="color:#ff0000">
      <strong>
       默认情况下，FW
      </strong>
     </span>
     <span style="color:#ff0000">
      <strong>
       上存在一条缺省带宽策略，匹配条件为
      </strong>
     </span>
     <span style="color:#ff0000">
      <strong>
       any
      </strong>
     </span>
     <span style="color:#ff0000">
      <strong>
       ，动作为不限流
      </strong>
     </span>
     <span style="color:#333333">
      。
     </span>
    </div>
    <h3>
     <span style="color:#333333">
      <strong>
       多级策略
      </strong>
     </span>
    </h3>
    <div>
     <span style="color:#333333">
      <strong>
       在一条带宽策略下，还可以继续配置多条带宽子策略
      </strong>
      。
     </span>
     <span style="color:#ff0000">
      <strong>
       对于多级策略，流量先匹配父策略，再去匹
      </strong>
     </span>
     <span style="color:#ff0000">
      <strong>
       配子策略，直到匹配到最后一级可以匹配到的子策略为止
      </strong>
     </span>
     <span style="color:#333333">
      。
     </span>
     <span style="color:#333333">
      ---
     </span>
     <span style="color:#333333">
      支持
     </span>
     <span style="color:#333333">
      4
     </span>
     <span style="color:#333333">
      级多级策略
     </span>
    </div>
    <div>
    </div>
    <div>
     <h3>
      <span style="color:#333333">
       <strong>
        配额策略
       </strong>
      </span>
     </h3>
     <div>
      <span style="color:#333333">
       <strong>
        针对于上网用户，的上网流量和上网时间进行控制
       </strong>
       。防止带宽滥用，上网时间过长影响工作效率。
      </span>
     </div>
     <div>
      <span style="color:#333333">
       实时检测上网的流量和时长，并根据用户的上网配额策略进行比较，根据策略结果进行处理。
      </span>
     </div>
     <div>
     </div>
     <div>
     </div>
     <div>
     </div>
     <div>
     </div>
     <h2>
      <span style="color:#333333">
       <strong>
        带宽管理配置
       </strong>
      </span>
     </h2>
     <p>
     </p>
     <p>
      <img alt="" height="471" src="https://i-blog.csdnimg.cn/direct/0629173d271649afa294f065923d543f.png" width="731"/>
     </p>
    </div>
    <p>
    </p>
    <p>
    </p>
    <blockquote>
     <p>
     </p>
     <div>
      <span style="color:#333333">
       配置流程：
      </span>
     </div>
     <div>
      <span style="color:#333333">
       1
      </span>
      <span style="color:#333333">
       、带宽通道：整体带宽、每个用户带宽、连接数、优先级信息
      </span>
     </div>
     <div>
      <span style="color:#333333">
       2
      </span>
      <span style="color:#333333">
       、带宽策略
      </span>
     </div>
     <div>
      <span style="color:#333333">
       3
      </span>
      <span style="color:#333333">
       、策略
      </span>
      <span style="color:#333333">
       +
      </span>
      <span style="color:#333333">
       通道，引用
      </span>
     </div>
     <div>
      <span style="color:#333333">
       4
      </span>
      <span style="color:#333333">
       、配置接口出入带宽
      </span>
     </div>
    </blockquote>
    <p>
    </p>
    <p>
    </p>
    <p>
     <span style="color:#333333">
      <strong>
       需求一
      </strong>
     </span>
    </p>
    <blockquote>
     <p>
     </p>
     <div>
      <span style="color:#333333">
       企业组织架构中存在部门
      </span>
      <span style="color:#333333">
       A
      </span>
      <span style="color:#333333">
       ，部门
      </span>
      <span style="color:#333333">
       A
      </span>
      <span style="color:#333333">
       中存在销售组
      </span>
      <span style="color:#333333">
       1
      </span>
      <span style="color:#333333">
       和研发组
      </span>
      <span style="color:#333333">
       2
      </span>
     </div>
     <div>
      <span style="color:#333333">
       销售部门
      </span>
      <span style="color:#333333">
       ---&gt;
      </span>
      <span style="color:#333333">
       业务
      </span>
      <span style="color:#333333">
       Email
      </span>
      <span style="color:#333333">
       、
      </span>
      <span style="color:#333333">
       ERP
      </span>
      <span style="color:#333333">
       服务
      </span>
     </div>
     <div>
      <span style="color:#333333">
       可以对部门
      </span>
      <span style="color:#333333">
       A
      </span>
      <span style="color:#333333">
       中的销售组进行带宽资源细分，保证销售员工的业务服务流量正常转发：
      </span>
     </div>
     <div>
      <span style="color:#333333">
       1
      </span>
      <span style="color:#333333">
       、部门
      </span>
      <span style="color:#333333">
       A
      </span>
      <span style="color:#333333">
       的下行最大带宽不超过
      </span>
      <span style="color:#333333">
       60M
      </span>
     </div>
     <div>
      <span style="color:#333333">
       2
      </span>
      <span style="color:#333333">
       、部门
      </span>
      <span style="color:#333333">
       A
      </span>
      <span style="color:#333333">
       中的销售组下行最大带宽不超过
      </span>
      <span style="color:#333333">
       30M
      </span>
     </div>
     <div>
      <span style="color:#333333">
       3
      </span>
      <span style="color:#333333">
       、部门
      </span>
      <span style="color:#333333">
       A
      </span>
      <span style="color:#333333">
       中的销售组的
      </span>
      <span style="color:#333333">
       Email
      </span>
      <span style="color:#333333">
       、
      </span>
      <span style="color:#333333">
       ERP
      </span>
      <span style="color:#333333">
       业务下行最小带宽不低于
      </span>
      <span style="color:#333333">
       20M
      </span>
     </div>
     <div>
      <span style="color:#333333">
      </span>
     </div>
     <div>
      <span style="color:#333333">
      </span>
     </div>
     <div>
      <span style="color:#333333">
       分析：需求之间存在父子关系
      </span>
     </div>
     <div>
      <span style="color:#333333">
       A
      </span>
      <span style="color:#333333">
       部门带宽通道
      </span>
      <span style="color:#333333">
       ---
      </span>
      <span style="color:#333333">
       最大
      </span>
      <span style="color:#333333">
       60M
      </span>
     </div>
     <div>
      <span style="color:#333333">
       部门A
      </span>
      <span style="color:#333333">
       销售组带宽通道最大
      </span>
      <span style="color:#333333">
       30M
      </span>
     </div>
     <div>
      <span style="color:#333333">
       部门A销售组
      </span>
      <span style="color:#333333">
       Email
      </span>
      <span style="color:#333333">
       业务带宽通道
      </span>
      <span style="color:#333333">
       ---
      </span>
      <span style="color:#333333">
       最小
      </span>
      <span style="color:#333333">
       20M
      </span>
     </div>
    </blockquote>
    <p>
    </p>
    <p>
    </p>
    <blockquote>
     <div>
      <span style="color:#333333">
       [FW]traffic-policy ---
      </span>
      <span style="color:#333333">
       进入带宽策略配置视图
      </span>
     </div>
     <div>
      <span style="color:#333333">
       [FW-policy-traffic]profile 01 ---
      </span>
      <span style="color:#333333">
       创建一个带宽通道，名称为
      </span>
      <span style="color:#333333">
       01
      </span>
     </div>
     <div>
      <span style="color:#333333">
       [FW-policy-traffic-profile-01]bandwidth maximum-bandwidth whole downstream 60 --
      </span>
     </div>
     <div>
      <span style="color:#333333">
       -
      </span>
      <span style="color:#333333">
       设定带宽，最大带宽，下行
      </span>
      <span style="color:#333333">
       60M
      </span>
     </div>
     <div>
      <span style="color:#333333">
      </span>
     </div>
     <div>
      <span style="color:#333333">
      </span>
     </div>
     <div>
      <span style="color:#333333">
       [FW]traffic-policy ---
      </span>
      <span style="color:#333333">
       进入带宽策略配置视图
      </span>
     </div>
     <div>
      <span style="color:#333333">
       [FW-policy-traffic]rule name 01 ---
      </span>
      <span style="color:#333333">
       策略名称
      </span>
     </div>
     <div>
      <span style="color:#333333">
       [FW-policy-traffic-rule-01]source-zone trust
      </span>
     </div>
     <div>
      <span style="color:#333333">
       [FW-policy-traffic-rule-01]destination-zone untrust
      </span>
     </div>
     <div>
      <span style="color:#333333">
       [FW-policy-traffic-rule-01]source-address 192.168.1.0 24
      </span>
     </div>
     <div>
      <span style="color:#333333">
       [FW-policy-traffic-rule-01]source-address 192.168.2.0 24
      </span>
     </div>
     <div>
      <span style="color:#333333">
       [FW-policy-traffic-rule-01]action qos profile 01 ---
      </span>
      <span style="color:#333333">
       动作为限流，且调用带宽通道
      </span>
     </div>
    </blockquote>
    <p>
    </p>
    <p>
     <img alt="" height="499" src="https://i-blog.csdnimg.cn/direct/db1e66f9e4af4e16ac78829e1f567953.png" width="731"/>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
     <span style="color:#333333">
      <strong>
       需求二
      </strong>
     </span>
    </p>
    <blockquote>
     <div>
      <span style="color:#333333">
       给部门A
      </span>
      <span style="color:#333333">
       和部门
      </span>
      <span style="color:#333333">
       B
      </span>
      <span style="color:#333333">
       划分可使用的带宽资源。要避免
      </span>
      <span style="color:#333333">
       P2P
      </span>
      <span style="color:#333333">
       业务占据较多的带宽，还需要限制部门
      </span>
      <span style="color:#333333">
       A
      </span>
      <span style="color:#333333">
       和部门
      </span>
      <span style="color:#333333">
       B
      </span>
      <span style="color:#333333">
       使用P2P业务的带宽总和。
      </span>
     </div>
     <div>
      <span style="color:#333333">
       1、部门
      </span>
      <span style="color:#333333">
       A
      </span>
      <span style="color:#333333">
       下行最大带宽
      </span>
      <span style="color:#333333">
       60M
      </span>
     </div>
     <div>
      <span style="color:#333333">
       2、部门
      </span>
      <span style="color:#333333">
       B
      </span>
      <span style="color:#333333">
       下行最大带宽
      </span>
      <span style="color:#333333">
       40M
      </span>
     </div>
     <div>
      <span style="color:#333333">
       3、部门
      </span>
      <span style="color:#333333">
       A
      </span>
      <span style="color:#333333">
       和部门
      </span>
      <span style="color:#333333">
       B
      </span>
      <span style="color:#333333">
       的
      </span>
      <span style="color:#333333">
       P2P
      </span>
      <span style="color:#333333">
       业务下行最大带宽不超过
      </span>
      <span style="color:#333333">
       80M
      </span>
     </div>
     <div>
      <span style="color:#333333">
       4、
      </span>
      <span style="color:#333333">
       P2P
      </span>
      <span style="color:#333333">
       流量需要计算到各自部门的总流量中
      </span>
     </div>
    </blockquote>
    <p>
     <span style="color:#333333">
      <strong>
       需求三
      </strong>
     </span>
    </p>
    <blockquote>
     <div>
      <span style="color:#333333">
       在不影响正常用户上网和web
      </span>
      <span style="color:#333333">
       服务器正常提供对外服务的情况下，实现以下功能
      </span>
     </div>
     <div>
      <span style="color:#333333">
       1
      </span>
      <span style="color:#333333">
       、将从
      </span>
      <span style="color:#333333">
       ISP
      </span>
      <span style="color:#333333">
       购买的
      </span>
      <span style="color:#333333">
       100M
      </span>
      <span style="color:#333333">
       带宽进行划分
      </span>
     </div>
     <div>
      <span style="color:#333333">
       上网高峰期（工作日下午3
      </span>
      <span style="color:#333333">
       点
      </span>
      <span style="color:#333333">
       -6
      </span>
      <span style="color:#333333">
       点），上网用户下行带宽
      </span>
      <span style="color:#333333">
       60M(U-T)
      </span>
      <span style="color:#333333">
       ，外用用户下行带宽
      </span>
      <span style="color:#333333">
       40M(D-U)
      </span>
     </div>
     <div>
      <span style="color:#333333">
       2
      </span>
      <span style="color:#333333">
       、
      </span>
      <span style="color:#333333">
       2
      </span>
      <span style="color:#333333">
       台
      </span>
      <span style="color:#333333">
       Web
      </span>
      <span style="color:#333333">
       服务器，限制每一台
      </span>
      <span style="color:#333333">
       Web
      </span>
      <span style="color:#333333">
       服务器对外提供的最大下行带宽不超过
      </span>
      <span style="color:#333333">
       20M
      </span>
     </div>
     <div>
      <span style="color:#333333">
       3
      </span>
      <span style="color:#333333">
       、假设，总共
      </span>
      <span style="color:#333333">
       30
      </span>
      <span style="color:#333333">
       个上网用户，在上网高峰期，限制每个用户访问
      </span>
      <span style="color:#333333">
       Internet
      </span>
      <span style="color:#333333">
       的最大下行带宽不超过
      </span>
      <span style="color:#333333">
       2M
      </span>
     </div>
    </blockquote>
    <div>
     <span style="color:#333333">
      <strong>
       需求四
      </strong>
     </span>
    </div>
    <div>
    </div>
    <blockquote>
     <div>
      <div>
       <span style="color:#333333">
        部门A
       </span>
       <span style="color:#333333">
        的上网用户数量不固定，为了让用户公平的使用带宽，根据实际在线上网用户数量，平均分配带宽
       </span>
      </div>
      <div>
       <span style="color:#333333">
        1
       </span>
       <span style="color:#333333">
        、部门
       </span>
       <span style="color:#333333">
        A
       </span>
       <span style="color:#333333">
        的下行最大带宽
       </span>
       <span style="color:#333333">
        60M
       </span>
      </div>
      <div>
       <span style="color:#333333">
        2
       </span>
       <span style="color:#333333">
        、根据实时的上网用户数量，对部门
       </span>
       <span style="color:#333333">
        A
       </span>
       <span style="color:#333333">
        的
       </span>
       <span style="color:#333333">
        60M
       </span>
       <span style="color:#333333">
        带宽资源进行均分
       </span>
      </div>
     </div>
    </blockquote>
    <p>
    </p>
    <p>
    </p>
    <div>
     <span style="color:#333333">
      <strong>
       动态均分功能：在配置了整体最大带宽的前提下，FW
      </strong>
     </span>
     <span style="color:#333333">
      <strong>
       根据在线
      </strong>
     </span>
     <span style="color:#333333">
      <strong>
       IP/
      </strong>
     </span>
     <span style="color:#333333">
      <strong>
       用户的个数和带宽使用率，动态
      </strong>
     </span>
     <span style="color:#333333">
      <strong>
       的对每一个
      </strong>
     </span>
     <span style="color:#333333">
      <strong>
       IP/
      </strong>
     </span>
     <span style="color:#333333">
      <strong>
       用户能够使用的最大带宽进行平均分配
      </strong>
     </span>
     <span style="color:#333333">
      。
     </span>
    </div>
    <div>
     <span style="color:#ffa500">
      <strong>
       每个IP/
      </strong>
     </span>
     <span style="color:#ffa500">
      <strong>
       用户最大带宽
      </strong>
     </span>
     <span style="color:#ffa500">
      <strong>
       = MAX
      </strong>
     </span>
     <span style="color:#ffa500">
      <strong>
       （带宽最小值，整体最大带宽
      </strong>
     </span>
     <span style="color:#ffa500">
      <strong>
       /IP
      </strong>
     </span>
     <span style="color:#ffa500">
      <strong>
       用户数
      </strong>
     </span>
     <span style="color:#ffa500">
      <strong>
       *
      </strong>
     </span>
     <span style="color:#ffa500">
      <strong>
       平均分配系数）
      </strong>
     </span>
     <span style="color:#333333">
      。
     </span>
    </div>
    <div>
    </div>
    <blockquote>
     <div>
      <div>
       <span style="color:#333333">
        平均分配系数
       </span>
       <span style="color:#333333">
        ---
       </span>
       <span style="color:#333333">
        与带宽使用率存在反比关系
       </span>
      </div>
      <div>
       <span style="color:#333333">
        0         ＜
       </span>
       <span style="color:#333333">
        70%
       </span>
      </div>
      <div>
       <span style="color:#333333">
        1          70-75
       </span>
      </div>
      <div>
       <span style="color:#333333">
        2          75-80
       </span>
      </div>
      <div>
       <span style="color:#333333">
        3
       </span>
      </div>
      <div>
       <span style="color:#333333">
        4
       </span>
      </div>
     </div>
    </blockquote>
    <p>
    </p>
    <div>
     <span style="color:#333333">
      <strong>
       需求五
      </strong>
     </span>
    </div>
    <div>
    </div>
    <blockquote>
     <div>
      <div>
       <span style="color:#333333">
        电信购买带宽
       </span>
       <span style="color:#333333">
        100M
       </span>
      </div>
      <div>
       <span style="color:#333333">
        联通购买带宽
       </span>
       <span style="color:#333333">
        50M
       </span>
      </div>
     </div>
    </blockquote>
    <p>
    </p>
    <p>
     <span style="color:#333333">
      <strong>
       需求六
      </strong>
     </span>
     <span style="color:#333333">
      <strong>
       -
      </strong>
     </span>
     <span style="color:#333333">
      <strong>
       配额策略
      </strong>
     </span>
    </p>
    <blockquote>
     <div>
      <span style="color:#333333">
       运营商---&gt;
      </span>
      <span style="color:#333333">
       流量套餐
      </span>
      <span style="color:#333333">
       ---&gt;
      </span>
      <span style="color:#333333">
       对中小企业
      </span>
      <span style="color:#333333">
       500G/
      </span>
      <span style="color:#333333">
       月，超出部分，额外计费，
      </span>
      <span style="color:#333333">
       1G/100
      </span>
      <span style="color:#333333">
       元。
      </span>
     </div>
     <div>
      <span style="color:#333333">
       限额---&gt;
      </span>
      <span style="color:#333333">
       每一个员工规定上网时长
      </span>
     </div>
     <div>
      <span style="color:#333333">
       1
      </span>
      <span style="color:#333333">
       、员工
      </span>
      <span style="color:#333333">
       40
      </span>
      <span style="color:#333333">
       人，
      </span>
      <span style="color:#333333">
       10
      </span>
      <span style="color:#333333">
       名管理人员
      </span>
      <span style="color:#333333">
       +30
      </span>
      <span style="color:#333333">
       名牛马
      </span>
     </div>
     <div>
      <span style="color:#333333">
       高管--&gt;20G/
      </span>
      <span style="color:#333333">
       月
      </span>
     </div>
     <div>
      <span style="color:#333333">
       牛马--&gt;10G/
      </span>
      <span style="color:#333333">
       月
      </span>
     </div>
     <div>
      <span style="color:#333333">
       2
      </span>
      <span style="color:#333333">
       、牛马
      </span>
      <span style="color:#333333">
       ---&gt;4h/
      </span>
      <span style="color:#333333">
       日，流量
      </span>
      <span style="color:#333333">
       500M/
      </span>
      <span style="color:#333333">
       日
      </span>
     </div>
     <div>
      <span style="color:#333333">
       3
      </span>
      <span style="color:#333333">
       、超额后限制
      </span>
     </div>
     <div>
      <span style="color:#333333">
       牛马---&gt;
      </span>
      <span style="color:#333333">
       禁止上网
      </span>
     </div>
     <div>
      <span style="color:#333333">
       高管---&gt;
      </span>
      <span style="color:#333333">
       超过配额后最大带宽限定为
      </span>
      <span style="color:#333333">
       800K
      </span>
     </div>
    </blockquote>
    <p>
    </p>
    <blockquote>
     <p>
     </p>
     <div>
      <span style="color:#333333">
       [FW]quota-policy ---
      </span>
      <span style="color:#333333">
       进入配额策略视图
      </span>
     </div>
     <div>
      <span style="color:#333333">
       [FW-policy-quota]profile niuma ---
      </span>
      <span style="color:#333333">
       创建配额通道
      </span>
     </div>
     <div>
      <span style="color:#333333">
       [FW-policy-quota-profile-niuma]stream-daily 500 ---
      </span>
      <span style="color:#333333">
       每日流量配额
      </span>
     </div>
     <div>
      <span style="color:#333333">
       [FW-policy-quota-profile-niuma]stream-monthly 10240 --
      </span>
      <span style="color:#333333">
       每月流量配额
      </span>
     </div>
     <div>
      <span style="color:#333333">
       [FW-policy-quota-profile-niuma]time-daily 240 ---
      </span>
      <span style="color:#333333">
       设定上网时长
      </span>
     </div>
     <div>
      <span style="color:#333333">
       [FW-policy-quota-profile-niuma]limit-bandwidth 0 ---
      </span>
      <span style="color:#333333">
       超出配额后的限制带宽为
      </span>
      <span style="color:#333333">
       0
      </span>
     </div>
     <div>
      <span style="color:#333333">
      </span>
     </div>
     <div>
      <span style="color:#333333">
      </span>
     </div>
     <div>
      <span style="color:#333333">
       [FW-policy-quota]rule name niuma
      </span>
     </div>
     <div>
      <span style="color:#333333">
       [FW-policy-quota-rule-niuma]user user-group /default/niuma ---
      </span>
      <span style="color:#333333">
       策略应用用户
      </span>
     </div>
     <div>
      <span style="color:#333333">
       [FW-policy-quota-rule-niuma]action quota profile niuma
      </span>
     </div>
    </blockquote>
    <p>
    </p>
    <p>
     <img alt="" height="491" src="https://i-blog.csdnimg.cn/direct/224d5c7f70ad4f518fdcad9a7ae9c430.png" width="807">
     </img>
    </p>
    <p>
    </p>
    <p>
    </p>
    <div>
     <span style="color:#333333">
      <strong>
       需求七
      </strong>
     </span>
     <span style="color:#333333">
      <strong>
       ---
      </strong>
     </span>
     <span style="color:#333333">
      <strong>
       流量整形和流量监管
      </strong>
     </span>
    </div>
    <div>
    </div>
    <div>
     <span style="color:#ff0000">
      <strong>
       无法在
      </strong>
     </span>
     <span style="color:#ff0000">
      <strong>
       web
      </strong>
     </span>
     <span style="color:#ff0000">
      <strong>
       界面实现
      </strong>
     </span>
    </div>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f67:2e6373646e2e6e65742f66697273686d616e5f73746172742f:61727469636c652f64657461696c732f313436303832363835" class_="artid" style="display:none">
 </p>
</div>


