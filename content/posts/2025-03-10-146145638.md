---
layout: post
title: "小结-IGMP协议"
date: 2025-03-10 10:06:51 +0800
description: "IGMP（Internet Group Management Protocol）是。设置 IGMP 查询器（Querier）定期查询间隔为 60 秒。，但不负责组播路由转发。组播路由协议（如 PIM）负责。，从而决定是否在某个网络接口上转发组播流量。使接口永久加入组播组 239.1.1.1。指定 IGMP 版本（1、2 或 3）组播组，路由器根据 IGMP 消息。在接口上启用 IGMP 监听功能。：IPv6 组播使用的是。，而不是 IGMP。"
keywords: "小结: IGMP协议"
categories: ['Hcia']
tags: ['笔记']
artid: "146145638"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146145638
    alt: "小结-IGMP协议"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146145638
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146145638
cover: https://bing.ee123.net/img/rand?artid=146145638
image: https://bing.ee123.net/img/rand?artid=146145638
img: https://bing.ee123.net/img/rand?artid=146145638
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     小结: IGMP协议
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="IGMPInternet_Group_Management_Protocol_0">
     </a>
     <strong>
      IGMP（Internet Group Management Protocol）协议详解
     </strong>
    </h3>
    <p>
     IGMP（Internet Group Management Protocol）是
     <strong>
      IPv4 组播（Multicast）通信的控制协议
     </strong>
     ，主要用于
     <strong>
      主机和路由器之间的组播成员管理
     </strong>
     。IGMP 允许主机
     <strong>
      加入或离开
     </strong>
     组播组，路由器根据 IGMP 消息
     <strong>
      维护组播转发表
     </strong>
     ，从而决定是否在某个网络接口上转发组播流量。
    </p>
    <hr/>
    <h3>
     <a id="1_IGMP__5">
     </a>
     <strong>
      1. IGMP 作用
     </strong>
    </h3>
    <ul>
     <li>
      <strong>
       主机加入组播组
      </strong>
      （加入特定的组播地址）
     </li>
     <li>
      <strong>
       主机离开组播组
      </strong>
      （通知路由器不再接收组播流量）
     </li>
     <li>
      <strong>
       路由器维护组播成员关系
      </strong>
      （定期查询、更新组播组成员）
     </li>
     <li>
      <strong>
       提高带宽利用率
      </strong>
      （仅向有需求的主机转发组播流量）
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="2_IGMP__13">
     </a>
     <strong>
      2. IGMP 版本
     </strong>
    </h3>
    <table>
     <thead>
      <tr>
       <th>
        <strong>
         IGMP 版本
        </strong>
       </th>
       <th>
        <strong>
         标准
        </strong>
       </th>
       <th>
        <strong>
         特点
        </strong>
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <strong>
         IGMPv1
        </strong>
       </td>
       <td>
        RFC 1112（1989）
       </td>
       <td>
        - 组播成员定期报告
        <br/>
        - 只有
        <code>
         Leave
        </code>
        机制（超时后删除成员）
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         IGMPv2
        </strong>
       </td>
       <td>
        RFC 2236（1997）
       </td>
       <td>
        - 支持
        <code>
         Leave Group
        </code>
        （更快离开组）
        <br/>
        - 组播查询器（Querier）选举
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         IGMPv3
        </strong>
       </td>
       <td>
        RFC 3376（2002）
       </td>
       <td>
        - 支持
        <strong>
         源特定组播（SSM，Source-Specific Multicast）
        </strong>
        <br/>
        - 允许主机指定要接收或屏蔽的源 IP
       </td>
      </tr>
     </tbody>
    </table>
    <blockquote>
     <p>
      <strong>
       注
      </strong>
      ：IPv6 组播使用的是
      <strong>
       MLD（Multicast Listener Discovery）
      </strong>
      ，而不是 IGMP。
     </p>
    </blockquote>
    <hr/>
    <h3>
     <a id="3_IGMP__24">
     </a>
     <strong>
      3. IGMP 消息类型
     </strong>
    </h3>
    <p>
     IGMP 主要有以下几种消息类型：
    </p>
    <table>
     <thead>
      <tr>
       <th>
        <strong>
         消息类型
        </strong>
       </th>
       <th>
        <strong>
         作用
        </strong>
       </th>
       <th>
        <strong>
         IGMP 版本
        </strong>
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <strong>
         Membership Query（成员查询）
        </strong>
       </td>
       <td>
        路由器询问哪些主机仍然需要某个组播流量
       </td>
       <td>
        IGMPv1、IGMPv2、IGMPv3
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         Membership Report（成员报告）
        </strong>
       </td>
       <td>
        主机响应查询，报告自己要加入的组播组
       </td>
       <td>
        IGMPv1、IGMPv2、IGMPv3
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         Leave Group（离开组）
        </strong>
       </td>
       <td>
        主机通知路由器自己不再需要某个组播流量
       </td>
       <td>
        IGMPv2、IGMPv3
       </td>
      </tr>
     </tbody>
    </table>
    <h4>
     <a id="_IGMPv1__32">
     </a>
     <strong>
      🔹 IGMPv1 组播加入流程
     </strong>
    </h4>
    <ol>
     <li>
      <strong>
       主机发送 Membership Report（组播成员报告）
      </strong>
     </li>
     <li>
      <strong>
       路由器收到后，向上游申请组播流量
      </strong>
     </li>
     <li>
      <strong>
       主机不再需要时
      </strong>
      ，不主动通知，
      <strong>
       路由器超时后移除
      </strong>
     </li>
    </ol>
    <h4>
     <a id="_IGMPv2__37">
     </a>
     <strong>
      🔹 IGMPv2 组播离开流程
     </strong>
    </h4>
    <ol>
     <li>
      <strong>
       主机发送 Leave Group（离开组播组）
      </strong>
     </li>
     <li>
      <strong>
       路由器发送 Group-Specific Query（特定组播查询）
      </strong>
     </li>
     <li>
      <strong>
       如果没有主机回应，路由器移除该组播组
      </strong>
     </li>
    </ol>
    <h4>
     <a id="_IGMPv3__42">
     </a>
     <strong>
      🔹 IGMPv3 的增强
     </strong>
    </h4>
    <ul>
     <li>
      <strong>
       支持源特定组播（SSM）
      </strong>
      ，可以选择性接收来自特定源的组播流量
     </li>
     <li>
      <strong>
       支持“允许/拒绝特定源”
      </strong>
      ，增加组播安全性和控制能力
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="4_IGMP__48">
     </a>
     <strong>
      4. IGMP 工作原理
     </strong>
    </h3>
    <h4>
     <a id="__49">
     </a>
     <strong>
      🔹 组播成员管理流程
     </strong>
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        主机加入组播组
       </strong>
      </p>
      <ul>
       <li>
        发送 IGMP
        <strong>
         Membership Report
        </strong>
        （组播成员报告）
       </li>
       <li>
        路由器记录该主机的 IP，并请求上游设备转发组播流量
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        组播查询（定期维护）
       </strong>
      </p>
      <ul>
       <li>
        组播路由器
        <strong>
         定期发送 IGMP Membership Query
        </strong>
       </li>
       <li>
        组播成员
        <strong>
         响应 Membership Report
        </strong>
        ，继续接收组播流量
       </li>
       <li>
        若无响应，路由器删除该组播组
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        主机离开组播组
       </strong>
      </p>
      <ul>
       <li>
        <strong>
         IGMPv1
        </strong>
        ：主机
        <strong>
         不发送 Leave
        </strong>
        ，路由器超时后自动删除
       </li>
       <li>
        <strong>
         IGMPv2、IGMPv3
        </strong>
        ：主机
        <strong>
         主动发送 IGMP Leave Group
        </strong>
       </li>
       <li>
        路由器查询是否还有其他主机，若无，则删除该组播组
       </li>
      </ul>
     </li>
    </ol>
    <hr/>
    <h3>
     <a id="5_IGMP__66">
     </a>
     <strong>
      5. IGMP 配置（华为路由器示例）
     </strong>
    </h3>
    <h4>
     <a id="__IGMP_67">
     </a>
     <strong>
      🔹 开启 IGMP
     </strong>
    </h4>
    <pre><code class="prism language-bash">system-view
interface GigabitEthernet <span class="token number">0</span>/0/1
 igmp <span class="token builtin class-name">enable</span>
</code></pre>
    <blockquote>
     <p>
      在接口上启用 IGMP 监听功能
     </p>
    </blockquote>
    <h4>
     <a id="_IGMP__75">
     </a>
     <strong>
      🔹 IGMP 版本设置
     </strong>
    </h4>
    <pre><code class="prism language-bash">interface GigabitEthernet <span class="token number">0</span>/0/1
 igmp version <span class="token number">2</span>
</code></pre>
    <blockquote>
     <p>
      指定 IGMP 版本（1、2 或 3）
     </p>
    </blockquote>
    <h4>
     <a id="__IGMP__82">
     </a>
     <strong>
      🔹 配置 IGMP 组播成员
     </strong>
    </h4>
    <pre><code class="prism language-bash">interface GigabitEthernet <span class="token number">0</span>/0/2
 igmp static-group <span class="token number">239.1</span>.1.1
</code></pre>
    <blockquote>
     <p>
      使接口永久加入组播组 239.1.1.1
     </p>
    </blockquote>
    <h4>
     <a id="__89">
     </a>
     <strong>
      🔹 组播查询器配置
     </strong>
    </h4>
    <pre><code class="prism language-bash">interface GigabitEthernet <span class="token number">0</span>/0/1
 igmp query-interval <span class="token number">60</span>
</code></pre>
    <blockquote>
     <p>
      设置 IGMP 查询器（Querier）定期查询间隔为 60 秒
     </p>
    </blockquote>
    <hr/>
    <h3>
     <a id="6_IGMP__PIM__98">
     </a>
     <strong>
      6. IGMP 与 PIM 组播协议
     </strong>
    </h3>
    <p>
     IGMP
     <strong>
      管理主机和路由器之间的组播成员
     </strong>
     ，但不负责组播路由转发。组播路由协议（如 PIM）负责
     <strong>
      在路由器之间转发组播流量
     </strong>
     。
    </p>
    <table>
     <thead>
      <tr>
       <th>
        <strong>
         协议
        </strong>
       </th>
       <th>
        <strong>
         作用
        </strong>
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <strong>
         IGMP
        </strong>
       </td>
       <td>
        组播成员管理（主机 ↔ 路由器）
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         PIM（Protocol Independent Multicast）
        </strong>
       </td>
       <td>
        组播路由协议（路由器 ↔ 路由器）
       </td>
      </tr>
     </tbody>
    </table>
    <h4>
     <a id="__106">
     </a>
     <strong>
      🔹 组播协议如何协作
     </strong>
    </h4>
    <ol>
     <li>
      <strong>
       IGMP 让主机加入组播组
      </strong>
      （主机 ↔ 组播路由器）
     </li>
     <li>
      <strong>
       PIM 负责组播流量转发
      </strong>
      （路由器 ↔ 其他组播路由器）
     </li>
     <li>
      <strong>
       最终路由器通过 IGMP 把组播流量发送到主机
      </strong>
     </li>
    </ol>
    <hr/>
    <h3>
     <a id="7_IGMP__113">
     </a>
     <strong>
      7. IGMP 组播优化与问题
     </strong>
    </h3>
    <h4>
     <a id="_IGMP_Snooping_114">
     </a>
     <strong>
      🔹 IGMP Snooping（监听）
     </strong>
    </h4>
    <ul>
     <li>
      <strong>
       作用
      </strong>
      ：在二层交换机上控制组播流量，仅向
      <strong>
       需要的端口
      </strong>
      转发组播流量
     </li>
     <li>
      <strong>
       命令
      </strong>
      ：
      <pre><code class="prism language-bash">system-view
interface VLAN10
 igmp-snooping <span class="token builtin class-name">enable</span>
</code></pre>
     </li>
     <li>
      <strong>
       优势
      </strong>
      ：避免组播流量泛洪，优化带宽利用率
     </li>
    </ul>
    <h4>
     <a id="_IGMP__124">
     </a>
     <strong>
      🔹 IGMP 常见问题
     </strong>
    </h4>
    <table>
     <thead>
      <tr>
       <th>
        <strong>
         问题
        </strong>
       </th>
       <th>
        <strong>
         可能原因
        </strong>
       </th>
       <th>
        <strong>
         解决方案
        </strong>
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        主机无法接收组播流量
       </td>
       <td>
        IGMP 版本不匹配
       </td>
       <td>
        <code>
         igmp version 2
        </code>
       </td>
      </tr>
      <tr>
       <td>
        组播流量泛洪
       </td>
       <td>
        交换机未开启 IGMP Snooping
       </td>
       <td>
        <code>
         igmp-snooping enable
        </code>
       </td>
      </tr>
      <tr>
       <td>
        组播延迟高
       </td>
       <td>
        组播查询间隔过长
       </td>
       <td>
        <code>
         igmp query-interval 30
        </code>
       </td>
      </tr>
     </tbody>
    </table>
    <hr/>
    <h3>
     <a id="8__133">
     </a>
     <strong>
      8. 结论
     </strong>
    </h3>
    <table>
     <thead>
      <tr>
       <th>
        <strong>
         知识点
        </strong>
       </th>
       <th>
        <strong>
         核心内容
        </strong>
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <strong>
         IGMP 作用
        </strong>
       </td>
       <td>
        让主机加入/离开组播组，通知路由器转发组播流量
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         IGMP 版本
        </strong>
       </td>
       <td>
        IGMPv1（超时离开）、IGMPv2（快速离开）、IGMPv3（支持 SSM）
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         IGMP 工作机制
        </strong>
       </td>
       <td>
        查询器发送 Membership Query，主机发送 Report，路由器维护组播成员
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         IGMP 配置
        </strong>
       </td>
       <td>
        <code>
         igmp enable
        </code>
        ，
        <code>
         igmp static-group
        </code>
        ，
        <code>
         igmp version 2
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         IGMP Snooping
        </strong>
       </td>
       <td>
        交换机监听 IGMP，防止组播流量泛洪
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     🚀
     <strong>
      IGMP 是组播网络的基础，结合 PIM 和 IGMP Snooping 可优化组播流量传输！
     </strong>
    </p>
   </div>
   <link href="./../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="./../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34343731393439392f:61727469636c652f64657461696c732f313436313435363338" class_="artid" style="display:none">
 </p>
</div>


