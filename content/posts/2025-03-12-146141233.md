---
layout: post
title: "项目基于FreeRTOS的STM32四轴飞行器-八.遥控器摇杆"
date: 2025-03-12 01:37:57 +0800
description: "进行了遥控器摇杆按键的完成"
keywords: "[项目]基于FreeRTOS的STM32四轴飞行器: 八.遥控器摇杆"
categories: ['基于Freertos的Stm32四轴飞行器']
tags: ['嵌入式硬件', '单片机', 'Stm', 'Mcu', 'Iot', 'C']
artid: "146141233"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146141233
    alt: "项目基于FreeRTOS的STM32四轴飞行器-八.遥控器摇杆"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146141233
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146141233
cover: https://bing.ee123.net/img/rand?artid=146141233
image: https://bing.ee123.net/img/rand?artid=146141233
img: https://bing.ee123.net/img/rand?artid=146141233
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     [项目]基于FreeRTOS的STM32四轴飞行器: 八.遥控器摇杆
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <h2>
     <a id="_1">
     </a>
     一.摇杆数据的扫描
    </h2>
    <p>
     下面摇杆初始化时，启动了ADC-DMA进行了采集，已经开始转换直接将数据通过DMA存入buff数组中：
    </p>
    <pre><code class="prism language-c"><span class="token keyword">static</span> <span class="token class-name">uint16_t</span> buff<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * @description: 摇杆初始化
 * @return {*}
 */</span>
<span class="token keyword">void</span> <span class="token function">Inf_JoyStickAndKey_Init</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">debug_printfln</span><span class="token punctuation">(</span><span class="token string">"摇杆和按键数据的初始化 开始"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">/* 1. ADC校准 */</span>
    <span class="token function">HAL_ADCEx_Calibration_Start</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>hadc1<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/* 2. 启动ADC转换 */</span>
    <span class="token function">HAL_ADC_Start_DMA</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>hadc1<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">uint32_t</span> <span class="token operator">*</span><span class="token punctuation">)</span>buff<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">debug_printfln</span><span class="token punctuation">(</span><span class="token string">"摇杆和按键数据的初始化 结束"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     扫描摇杆数据时，直接从缓冲区中扫描就行了：
     <br/>
     注意取数据要根据配置的Rank。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/1ba7f7499cfa4fe38d7d585f05f62fd8.png">
      <br/>
      <strong>
       定义摇杆数据：
      </strong>
      <br/>
      com_config.h使用int16防止数据突变。
     </img>
    </p>
    <pre><code class="prism language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name">int16_t</span> THR<span class="token punctuation">;</span> <span class="token comment">/* 油门 */</span>
    <span class="token class-name">int16_t</span> PIT<span class="token punctuation">;</span> <span class="token comment">/* 俯仰 */</span>
    <span class="token class-name">int16_t</span> ROL<span class="token punctuation">;</span> <span class="token comment">/* 横滚 */</span>
    <span class="token class-name">int16_t</span> YAW<span class="token punctuation">;</span> <span class="token comment">/* 偏航 */</span>

    <span class="token class-name">uint8_t</span> isPowerDown<span class="token punctuation">;</span> <span class="token comment">/* 是否关机: 1:关机 0:不关机 */</span>
    <span class="token class-name">uint8_t</span> isFixHeight<span class="token punctuation">;</span> <span class="token comment">/* 是否翻转定高的状态 */</span>
<span class="token punctuation">}</span> JoyStick_Struct<span class="token punctuation">;</span>
</code></pre>
    <p>
     <strong>
      扫描摇杆数据：
     </strong>
    </p>
    <pre><code class="prism language-c"><span class="token comment">/**
* @description: 扫描摇杆数据
* @return {*}
*/</span>
<span class="token keyword">void</span> <span class="token function">Inf_JoyStickAndKey_JoyStickScan</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    joyStick<span class="token punctuation">.</span>THR <span class="token operator">=</span> buff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    joyStick<span class="token punctuation">.</span>YAW <span class="token operator">=</span> buff<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    joyStick<span class="token punctuation">.</span>PIT <span class="token operator">=</span> buff<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    joyStick<span class="token punctuation">.</span>ROL <span class="token operator">=</span> buff<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      创建摇杆处理任务：
     </strong>
     <br/>
     先定义一些任务参数。
    </p>
    <pre><code class="prism language-c"><span class="token comment">/* 4. 摇杆处理任务 */</span>
<span class="token keyword">void</span> <span class="token function">joyStickTask</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">JOY_STICK_TASK_NAME</span> <span class="token string">"joy_stick_task"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">JOY_STICK_TASK_STACK</span> <span class="token expression"><span class="token number">256</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">JOY_STICK_TASK_PRIORITY</span> <span class="token expression"><span class="token number">7</span></span></span>
TaskHandle_t joyStickTaskHandle<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">JOY_STICK_EXEC_CYCLE</span> <span class="token expression"><span class="token number">4</span></span></span>

<span class="token comment">/* 4. 摇杆处理任务 */</span>
<span class="token function">xTaskCreate</span><span class="token punctuation">(</span>joyStickTask<span class="token punctuation">,</span>
            JOY_STICK_TASK_NAME<span class="token punctuation">,</span>
            JOY_STICK_TASK_STACK<span class="token punctuation">,</span>
            <span class="token constant">NULL</span><span class="token punctuation">,</span>
            JOY_STICK_TASK_PRIORITY<span class="token punctuation">,</span>
            <span class="token operator">&amp;</span>joyStickTaskHandle<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <strong>
      测试打印摇杆数据：
     </strong>
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/d2da554ece7746d5b96e9b80969a6880.png"/>
    </p>
    <pre><code class="prism language-c"><span class="token comment">/* 4. 摇杆处理 */</span>
<span class="token keyword">void</span> <span class="token function">joyStickTask</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>args<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">vTaskDelay</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">debug_printfln</span><span class="token punctuation">(</span><span class="token string">"摇杆处理任务开始调度"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> preTime <span class="token operator">=</span> <span class="token function">xTaskGetTickCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">Inf_JoyStickAndKey_JoyStickScan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">Com_Config_PrintJoyStick</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">vTaskDelayUntil</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>preTime<span class="token punctuation">,</span> JOY_STICK_EXEC_CYCLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     观察打印数据全部为0：
     <br/>
     因为要先启动ADC采集数据。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/0f63653f4bf747c3a31186a3d6f2ee7e.png">
      <br/>
      在启动任务前启动处理模块：
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/b715615b975f47a396d6c8bcecfe01c4.png">
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/09b182481d474a48a5c2b0e0ab6f17e6.png">
        <br/>
        这时可以打印数据：
        <br/>
        观察发现数据有一些极性相反。
        <br/>
        <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/cf2feab1ca2f4e07bd4a77c4adcb4cf1.png"/>
       </img>
      </img>
     </img>
    </p>
    <h2>
     <a id="_96">
     </a>
     二.处理摇杆数据
    </h2>
    <p>
     摇杆
     <strong>
      极性和范围的处理
     </strong>
     ：
     <br/>
     处理摇杆数据范围
     <strong>
      0-4095转换为0-1000
     </strong>
     。
    </p>
    <pre><code class="prism language-c"><span class="token comment">/**
 * @description: 处理摇杆数据的极性和范围
 * @return {*}
 */</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">App_DataProcess_JoyStickPolarityAndRange</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">/* 1. 处理极性   [4095, 0]  =&gt; [0, 1000]
          (4095 -  [4095, 0]) / 4.095
          (4095 -  [4095, 0]) / (4095 / 1000)
          (4095 -  [4095, 0]) * 1000 / 4095
          1000 - [4095, 0] * 1000 / 4095

     */</span>
    joyStick<span class="token punctuation">.</span>THR <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">-</span> joyStick<span class="token punctuation">.</span>THR <span class="token operator">*</span> <span class="token number">1000</span> <span class="token operator">/</span> <span class="token number">4095</span><span class="token punctuation">;</span>
    joyStick<span class="token punctuation">.</span>ROL <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">-</span> joyStick<span class="token punctuation">.</span>ROL <span class="token operator">*</span> <span class="token number">1000</span> <span class="token operator">/</span> <span class="token number">4095</span><span class="token punctuation">;</span>
    joyStick<span class="token punctuation">.</span>PIT <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">-</span> joyStick<span class="token punctuation">.</span>PIT <span class="token operator">*</span> <span class="token number">1000</span> <span class="token operator">/</span> <span class="token number">4095</span><span class="token punctuation">;</span>
    joyStick<span class="token punctuation">.</span>YAW <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">-</span> joyStick<span class="token punctuation">.</span>YAW <span class="token operator">*</span> <span class="token number">1000</span> <span class="token operator">/</span> <span class="token number">4095</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      处理摇杆数据：
     </strong>
    </p>
    <pre><code class="prism language-c"><span class="token comment">/**
 * @description: 处理摇杆数据
 * @return {*}
 */</span>
<span class="token keyword">void</span> <span class="token function">App_DataProcess_JoyStickDataProcess</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">/* 1. 扫描摇杆 */</span>
    <span class="token function">Inf_JoyStickAndKey_JoyStickScan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">/* 2. 极性和范围处理 */</span>
    <span class="token function">App_DataProcess_JoyStickPolarityAndRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token function">Com_Config_PrintJoyStick</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre>
    <p>
     观察发现该数据在默认情况下会有
     <strong>
      误差值
     </strong>
     ，需要进行
     <strong>
      校准
     </strong>
     ：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/997d5eb6f742418b979bda7156136f1b.png">
      <br/>
      <strong>
       摇杆数据校准：
      </strong>
      <br/>
      想办法
      <strong>
       求出数据偏移量
      </strong>
      ，
      <strong>
       长按按键
      </strong>
      减去偏移量进行校准。
      <br/>
      在Config.c中定义存储摇杆偏移量的结构体：
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/30fa72d5161b4b7594a4fbd86fc72a25.png">
       <br/>
       <strong>
        计算偏移量：
       </strong>
      </img>
     </img>
    </p>
    <pre><code class="prism language-c"><span class="token comment">/**
 * @description: 计算摇杆的偏移量
 * @return {*}
 */</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">App_DataProcess_JoyStickCaclBias</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    joyStickBias<span class="token punctuation">.</span>THR <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    joyStickBias<span class="token punctuation">.</span>ROL <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    joyStickBias<span class="token punctuation">.</span>YAW <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    joyStickBias<span class="token punctuation">.</span>PIT <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">uint8_t</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">Inf_JoyStickAndKey_JoyStickScan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">App_DataProcess_JoyStickPolarityAndRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        joyStickBias<span class="token punctuation">.</span>THR <span class="token operator">+=</span> <span class="token punctuation">(</span>joyStick<span class="token punctuation">.</span>THR <span class="token operator">-</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">/* 0值校准 */</span>
        joyStickBias<span class="token punctuation">.</span>PIT <span class="token operator">+=</span> <span class="token punctuation">(</span>joyStick<span class="token punctuation">.</span>PIT <span class="token operator">-</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 中值校准 */</span>
        joyStickBias<span class="token punctuation">.</span>YAW <span class="token operator">+=</span> <span class="token punctuation">(</span>joyStick<span class="token punctuation">.</span>YAW <span class="token operator">-</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        joyStickBias<span class="token punctuation">.</span>ROL <span class="token operator">+=</span> <span class="token punctuation">(</span>joyStick<span class="token punctuation">.</span>ROL <span class="token operator">-</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">vTaskDelay</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    joyStickBias<span class="token punctuation">.</span>THR <span class="token operator">/=</span> <span class="token number">100</span><span class="token punctuation">;</span>
    joyStickBias<span class="token punctuation">.</span>PIT <span class="token operator">/=</span> <span class="token number">100</span><span class="token punctuation">;</span>
    joyStickBias<span class="token punctuation">.</span>ROL <span class="token operator">/=</span> <span class="token number">100</span><span class="token punctuation">;</span>
    joyStickBias<span class="token punctuation">.</span>YAW <span class="token operator">/=</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token comment">// Com_Config_PrintJoyStickBias("bias 2");</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      校准：
     </strong>
    </p>
    <pre><code class="prism language-c"><span class="token comment">/**
 * @description: 对摇杆数据做校准
 * @return {*}
 */</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">App_DataProcess_JoystickWithBias</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">/* 叠加偏移量 */</span>
    joyStick<span class="token punctuation">.</span>THR <span class="token operator">-=</span> joyStickBias<span class="token punctuation">.</span>THR<span class="token punctuation">;</span>
    joyStick<span class="token punctuation">.</span>PIT <span class="token operator">-=</span> joyStickBias<span class="token punctuation">.</span>PIT<span class="token punctuation">;</span>
    joyStick<span class="token punctuation">.</span>ROL <span class="token operator">-=</span> joyStickBias<span class="token punctuation">.</span>ROL<span class="token punctuation">;</span>
    joyStick<span class="token punctuation">.</span>YAW <span class="token operator">-=</span> joyStickBias<span class="token punctuation">.</span>YAW<span class="token punctuation">;</span>

    <span class="token comment">/* 对校准后的数据做限幅处理 */</span>
    joyStick<span class="token punctuation">.</span>THR <span class="token operator">=</span> <span class="token function">LIMIT</span><span class="token punctuation">(</span>joyStick<span class="token punctuation">.</span>THR<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    joyStick<span class="token punctuation">.</span>PIT <span class="token operator">=</span> <span class="token function">LIMIT</span><span class="token punctuation">(</span>joyStick<span class="token punctuation">.</span>PIT<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    joyStick<span class="token punctuation">.</span>ROL <span class="token operator">=</span> <span class="token function">LIMIT</span><span class="token punctuation">(</span>joyStick<span class="token punctuation">.</span>ROL<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    joyStick<span class="token punctuation">.</span>YAW <span class="token operator">=</span> <span class="token function">LIMIT</span><span class="token punctuation">(</span>joyStick<span class="token punctuation">.</span>YAW<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     在打印数据时出现BUG，数值不正确：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/f1e40a29dbb24371b406e2ca347ae3d9.png"/>
     <br/>
     原因是扫描摇杆值后未对极性和范围处理，数值错误。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/d6a5915b7eb14524a6c64974f5efadf2.png"/>
     <br/>
     解决：
     <br/>
     在执行完扫描后执行极性和范围处理函数，之后再计算偏移量。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/b8a4c2cfb4b04c12b8f1cd905ff196e7.png"/>
     <br/>
     在按键处理时，将该函数放在临界区中可以避免在长按时，任务调度到摇杆扫描：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/b33f62f0bcd74936aee453c9db8e1f9d.png"/>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/26b252ed4cc74f31a8e0dc88ce8303e9.png"/>
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/959f64d49d3e4774be1c122e6f34590d.png"/>
    </p>
    <h2>
     <a id="_207">
     </a>
     三.微调按键处理
    </h2>
    <p>
     在摇杆结构体中添加isPowerDown和isFixHeight：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/0adfb353599648948bf9cbd7935f109f.png"/>
     <br/>
     在按键处理函数中
     <strong>
      继续添加关机和定高功能：
     </strong>
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/06048b4ece234e12baf129f6e0644736.png"/>
     <br/>
     继续
     <strong>
      添加微调按钮：
     </strong>
     <br/>
     保持飞行稳定不偏，将需要微调的数据直接加到偏移量中，之后减去偏移量可以达到效果。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/ea23f4e4da9c400095e2af65a415ddbc.png"/>
    </p>
   </div>
   <link href="./../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="./../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f37343736393835342f:61727469636c652f64657461696c732f313436313431323333" class_="artid" style="display:none">
 </p>
</div>


