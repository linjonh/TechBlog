---
arturl_encode: "68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f35383634383839302f:61727469636c652f64657461696c732f313436303632353134"
layout: post
title: "åœ¨-CLion-ä¸­ä½¿ç”¨-Google-Test-è¿›è¡Œå•å…ƒæµ‹è¯•"
date: 2025-03-06 11:33:44 +0800
description: "æœ¬åšå®¢å°†ä»‹ç»å¦‚ä½•åœ¨ä¸åŒå¹³å°ï¼ˆWindowsã€macOSã€Linuxï¼‰ä¸Šï¼Œä½¿ç”¨CLioné…ç½®Google Testè¿›è¡ŒC++å•å…ƒæµ‹è¯•ï¼ŒåŒ…æ‹¬å®‰è£…Google Testã€é…ç½®CMakeLists.txtã€ç¼–å†™å’Œè¿è¡Œæµ‹è¯•ä»£ç ï¼Œä»¥åŠå¦‚ä½•æµ‹è¯•ç±»å’Œä½¿ç”¨æµ‹è¯•å¤¹å…·ã€‚"
keywords: "åœ¨ CLion ä¸­ä½¿ç”¨ Google Test è¿›è¡Œå•å…ƒæµ‹è¯•"
categories: ['å•å…ƒæµ‹è¯•']
tags: ['å•å…ƒæµ‹è¯•', 'C']
artid: "146062514"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146062514
    alt: "åœ¨-CLion-ä¸­ä½¿ç”¨-Google-Test-è¿›è¡Œå•å…ƒæµ‹è¯•"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146062514
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146062514
cover: https://bing.ee123.net/img/rand?artid=146062514
image: https://bing.ee123.net/img/rand?artid=146062514
img: https://bing.ee123.net/img/rand?artid=146062514
---

# åœ¨ CLion ä¸­ä½¿ç”¨ Google Test è¿›è¡Œå•å…ƒæµ‹è¯•

### **ä»‹ç»**

Google Testï¼ˆGTestï¼‰æ˜¯ Google å¼€æºçš„ C++ å•å…ƒæµ‹è¯•æ¡†æ¶ï¼Œæä¾›äº†ä¸°å¯Œçš„æ–­è¨€ã€æµ‹è¯•å¤¹å…·ï¼ˆFixturesï¼‰å’Œæµ‹è¯•ç®¡ç†åŠŸèƒ½ï¼Œä½¿ C++ å¼€å‘è€…èƒ½å¤Ÿç¼–å†™é«˜æ•ˆçš„å•å…ƒæµ‹è¯•ã€‚

æœ¬åšå®¢å°†ä»‹ç»å¦‚ä½•åœ¨ä¸åŒå¹³å°ï¼ˆWindowsã€macOSã€Linuxï¼‰ä¸Šï¼Œä½¿ç”¨ CLion é…ç½® Google Test è¿›è¡Œ C++ å•å…ƒæµ‹è¯•ï¼ŒåŒ…æ‹¬å®‰è£… Google Testã€é…ç½® CMakeLists.txtã€ç¼–å†™å’Œè¿è¡Œæµ‹è¯•ä»£ç ï¼Œä»¥åŠå¦‚ä½•æµ‹è¯•ç±»å’Œä½¿ç”¨æµ‹è¯•å¤¹å…·ã€‚

---

### **1. å®‰è£… Google Test**

Google Test å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®‰è£…ï¼š

#### **æ–¹æ³• 1ï¼šä½¿ç”¨åŒ…ç®¡ç†å™¨å®‰è£…ï¼ˆæ¨èï¼‰**

**Windowsï¼ˆvcpkgï¼‰ï¼š**

```sh
git clone https://github.com/microsoft/vcpkg.git
cd vcpkg
bootstrap-vcpkg.bat
vcpkg install gtest

```

ä¹Ÿå¯ä»¥ç›´æ¥åœ¨ CLion çš„ vcpkg å®‰è£… gtestï¼š

![æ˜¾ç¤º Vcpkg](https://i-blog.csdnimg.cn/direct/fc1963d8237c4d03aba024dc593d4118.png)

![vcpkgæœç´¢gtest](https://i-blog.csdnimg.cn/direct/a0d7c82fc70c4cd38417aacaa6807ec6.png)

**macOSï¼ˆHomebrewï¼‰ï¼š**

```sh
brew install googletest

```

**Linuxï¼ˆAPTï¼‰ï¼š**

```sh
sudo apt install libgtest-dev

```

å®‰è£…å®Œæˆåï¼Œåº“æ–‡ä»¶å­˜æ”¾åœ¨ vcpkg/Homebrew/ç³»ç»Ÿåº“è·¯å¾„ä¸‹ã€‚

#### **æ–¹æ³• 2ï¼šä½¿ç”¨ Git ç›´æ¥æ‹‰å–æºç **

```sh
git clone https://github.com/google/googletest.git
cd googletest
mkdir build && cd build
cmake .. -DBUILD_GMOCK=OFF
cmake --build .

```

#### **æ–¹æ³• 3ï¼šæ‰‹åŠ¨ä¸‹è½½å’Œç¼–è¯‘**

ä»
[Google Test å®˜æ–¹ GitHub](https://github.com/google/googletest/releases)
ä¸‹è½½
`.zip`
æºç åŒ…ï¼Œè§£å‹åæ”¾å…¥ä½ çš„é¡¹ç›®ç›®å½•ã€‚

---

### **2. åˆ›å»º CLion é¡¹ç›®**

1. æ‰“å¼€ CLionï¼Œé€‰æ‹©
   `New Project`
   ã€‚
2. é€‰æ‹©
   `C++ Executable`
   ï¼Œç„¶åç‚¹å‡»
   `Create`
   åˆ›å»ºä¸€ä¸ªé¡¹ç›®ã€‚

---

### **3. é…ç½® CMakeLists.txt**

æ ¹æ®ä¸åŒå®‰è£…æ–¹å¼ä¿®æ”¹
`CMakeLists.txt`
ã€‚

#### **æ–¹æ³• 1ï¼šä½¿ç”¨åŒ…ç®¡ç†å™¨ï¼ˆvcpkg/Homebrewï¼‰**

![é…ç½® CMakeLists](https://i-blog.csdnimg.cn/direct/ec8b9c8e5a3d41feb5c48aa91a56b0a0.png)

å¦‚æœæŠ¥é”™ä¹Ÿæ²¡äº‹ï¼Œåœ¨è¾“å‡ºçš„åœ°æ–¹ç‚¹å‡»ä¿®å¤å°±å¯ä»¥äº†ã€‚

```cmake
cmake_minimum_required(VERSION 3.30)
project(MyTest)

set(CMAKE_CXX_STANDARD 20)

# æŸ¥æ‰¾ Google Test
find_package(GTest REQUIRED)
include_directories(${GTEST_INCLUDE_DIRS})

# æ·»åŠ æµ‹è¯•æ–‡ä»¶
add_executable(MyTest main.cpp)

# é“¾æ¥ Google Test åº“
target_link_libraries(MyTest GTest::GTest GTest::Main pthread)

# å¯ç”¨æµ‹è¯•
enable_testing()
add_test(NAME MyTest COMMAND MyTest)

```

#### **æ–¹æ³• 2ï¼šGit æ‹‰å–æˆ–æ‰‹åŠ¨ä¸‹è½½**

```cmake
include(FetchContent)
FetchContent_Declare(
    googletest
    URL https://github.com/google/googletest/archive/refs/heads/main.zip
)
FetchContent_MakeAvailable(googletest)

add_executable(my_test test.cpp)
target_link_libraries(my_test gtest gtest_main)

enable_testing()

```

---

### **4. ç¼–å†™æµ‹è¯•ä»£ç **

åˆ›å»º
`main.cpp`
ï¼Œç¼–å†™ Google Test ä»£ç ï¼š

```cpp
#include <gtest/gtest.h>

int Add(int nA, int nB) {
    return nA + nB;
}

TEST(AddTest, HandlesAddition) {
    EXPECT_EQ(Add(2, 3), 5);
    EXPECT_EQ(Add(-2, -5), -7);
}

int main(int argc, char **argv) {
    ::testing::InitGoogleTest(&argc, argv);
    return RUN_ALL_TESTS();
}

```

---

### **5. è¿è¡Œ Google Test**

#### **æ–¹æ³• 1ï¼šæ‰‹åŠ¨è¿è¡Œ**

```sh
cmake --build .
./MyTest

```

#### **æ–¹æ³• 2ï¼šCLion ç›´æ¥è¿è¡Œ**

1. ä¸èƒ½
   **å³é”®
   `main.cpp`
   ï¼Œé€‰æ‹©
   `Run 'main.cpp'`**
   ã€‚
2. **åœ¨ CLion é…ç½® Google Test**
   * æ‰“å¼€
     **â€œRunâ€ > â€œEdit Configurationsâ€¦â€**
   * ç‚¹å‡»
     **â€œ+â€**
     å·ï¼Œé€‰æ‹©
     **Google Test**
   * é€‰æ‹©
     `Target`
     ï¼Œç„¶ååº”ç”¨å¹¶è¿è¡Œ
3. **æŸ¥çœ‹æµ‹è¯•ç»“æœ**
     
   åœ¨ CLion åº•éƒ¨çš„ â€œTest Runnerâ€ çª—å£æŸ¥çœ‹æµ‹è¯•ç»“æœã€‚

![æµ‹è¯•ç»“æœ](https://i-blog.csdnimg.cn/direct/d1accd9dc7064323bae4222647593872.png)

---

### **6. å¤„ç† Google Test æ–­è¨€**

```cpp
TEST(SampleTest, Example) {
    ASSERT_EQ(1, 1); // é€šè¿‡
    EXPECT_EQ(1, 2); // å¤±è´¥ï¼Œä½†ç»§ç»­æ‰§è¡Œ
    ASSERT_EQ(1, 2); // å¤±è´¥ï¼Œæµ‹è¯•ç»ˆæ­¢
}

```

---

### **7. ä½¿ç”¨ Google Test Fixturesï¼ˆæµ‹è¯•å¤¹å…·ï¼‰**

å¦‚æœç±»æœ‰çŠ¶æ€ï¼Œå¯ä»¥ä½¿ç”¨
`TEST_F()`
å…±äº«æµ‹è¯•æ•°æ®ã€‚

```cpp
class MyTestFixture : public ::testing::Test {
protected:
    void SetUp() override { nValue = 5; }
    void TearDown() override { }
    int nValue;
};

TEST_F(MyTestFixture, TestAddition) {
    EXPECT_EQ(nValue + 5, 10);
}

```

---

### **8. è§£å†³å¯èƒ½é‡åˆ°çš„é—®é¢˜**

#### **æ‰¾ä¸åˆ° Google Test**

* ç¡®ä¿
  `find_package(GTest REQUIRED)`
  ä½ç½®æ­£ç¡®ã€‚
* ä½¿ç”¨
  `vcpkg integrate install`
  è®© CMake è¯†åˆ«
  `vcpkg`
  ã€‚

#### **é“¾æ¥é”™è¯¯ï¼ˆundefined reference to â€˜testing::InitGoogleTestâ€™ï¼‰**

* å¿˜è®°
  `target_link_libraries(my_test GTest::GTest GTest::Main)`
* ç‰ˆæœ¬ä¸å…¼å®¹ï¼Œå°è¯•
  `FetchContent`
  æ–¹å¼è·å–æœ€æ–°ç‰ˆæœ¬ã€‚

---

### **æ€»ç»“**

| æ–¹æ³• | é€‚ç”¨æƒ…å†µ |
| --- | --- |
| **åŒ…ç®¡ç†å™¨ï¼ˆvcpkg/Homebrew/APTï¼‰** | æ¨èï¼Œç®€å•æ˜“ç”¨ |
| **Git æ–¹å¼ï¼ˆFetchContentï¼‰** | é€‚ç”¨äºä¸åŒå¹³å° |
| **æ‰‹åŠ¨ä¸‹è½½** | é€‚ç”¨äºæ— æ³•è”ç½‘çš„æƒ…å†µ |
| **ä½¿ç”¨é¢„ç¼–è¯‘åº“** | é€‚ç”¨äºå›ºå®šç‰ˆæœ¬ |
| **Conan åŒ…ç®¡ç†å™¨** | é€‚ç”¨äºå¤§å‹é¡¹ç›® |

ä¸åŒçš„æ–¹æ³•é€‚ç”¨äºä¸åŒçš„éœ€æ±‚ï¼Œä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„æƒ…å†µé€‰æ‹©æœ€ä½³æ–¹æ¡ˆï¼ğŸš€