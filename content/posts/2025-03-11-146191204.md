---
layout: post
title: "Linux-Shell-è„šæœ¬ç¼–ç¨‹æç®€å…¥é—¨æŒ‡å—"
date: 2025-03-11 22:52:53 +0800
description: "15åˆ†é’ŸæŒæ¡Shellè„šæœ¬åŸºç¡€è¯­æ³•ï¼Œæ¶µç›–å˜é‡ã€å¾ªç¯ã€å‡½æ•°ç­‰æ ¸å¿ƒæ“ä½œï¼Œé™„è‡ªåŠ¨åŒ–å®æˆ˜æ¡ˆä¾‹ï¼æœ¬æ–‡é…å¥—æ‰€æœ‰ä»£ç å‡å·²é€šè¿‡ShellCheckéªŒè¯ âœ…"
keywords: "Linux Shell è„šæœ¬ç¼–ç¨‹æç®€å…¥é—¨æŒ‡å—"
categories: ['ç¼–ç¨‹è¯­è¨€']
tags: ['è¿ç»´', 'æœåŠ¡å™¨', 'Linux']
artid: "146191204"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146191204
    alt: "Linux-Shell-è„šæœ¬ç¼–ç¨‹æç®€å…¥é—¨æŒ‡å—"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146191204
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146191204
cover: https://bing.ee123.net/img/rand?artid=146191204
image: https://bing.ee123.net/img/rand?artid=146191204
img: https://bing.ee123.net/img/rand?artid=146191204
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Linux Shell è„šæœ¬ç¼–ç¨‹æç®€å…¥é—¨æŒ‡å—
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h3>
     ä¸€ã€å­¦ä¹ å‰æå‡†å¤‡
    </h3>
    <p>
     âœ…
     <strong>
      ç¯å¢ƒè¦æ±‚
     </strong>
     ï¼š
    </p>
    <ul>
     <li>
      <p>
       Linuxç³»ç»Ÿï¼ˆUbuntu/CentOSç­‰ï¼‰æˆ– WSL (Windowsç”¨æˆ·)
      </p>
     </li>
     <li>
      <p>
       ä»»æ„æ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆæ¨èVSCode/Vimï¼‰
      </p>
     </li>
     <li>
      <p>
       åŸºç¡€å‘½ä»¤è¡Œæ“ä½œèƒ½åŠ›
      </p>
     </li>
    </ul>
    <p>
     ğŸ”
     <strong>
      éªŒè¯ç¯å¢ƒ
     </strong>
     ï¼š
    </p>
    <pre><code class="language-bash"># æŸ¥çœ‹ç³»ç»Ÿé»˜è®¤Shell
echo $SHELL
# æŸ¥çœ‹Bashç‰ˆæœ¬
bash --version </code></pre>
    <hr/>
    <h3>
     äºŒã€Shellè„šæœ¬åŸºç¡€è®¤çŸ¥
    </h3>
    <h4>
     2.1 ä»€ä¹ˆæ˜¯Shellè„šæœ¬ï¼Ÿ
    </h4>
    <ul>
     <li>
      <p>
       <strong>
        è§£é‡Šå‹è¯­è¨€
       </strong>
       ï¼šé€šè¿‡
       <code>
        /bin/bash
       </code>
       é€è¡Œè§£ææ‰§è¡Œ
      </p>
     </li>
     <li>
      <p>
       <strong>
        æ ¸å¿ƒä»·å€¼
       </strong>
       ï¼š
      </p>
      <ul>
       <li>
        <p>
         è‡ªåŠ¨åŒ–é‡å¤æ€§ç³»ç»Ÿæ“ä½œï¼ˆ80%è¿ç»´å·¥ä½œå¯è„šæœ¬åŒ–ï¼‰
        </p>
       </li>
       <li>
        <p>
         å¿«é€Ÿå®ç°ä»»åŠ¡è°ƒåº¦ï¼ˆç»“åˆcronï¼‰
        </p>
       </li>
       <li>
        <p>
         æå‡æ“ä½œå¯é‡å¤æ€§å’Œç²¾ç¡®åº¦
        </p>
       </li>
      </ul>
     </li>
    </ul>
    <h4>
     2.2 è„šæœ¬æ–‡ä»¶æ ‡å‡†ç»“æ„
    </h4>
    <pre><code class="language-bash">#!/bin/bash Â  Â  Â  Â  Â  # Shebangå£°æ˜ï¼ˆå¿…é¡»ç¬¬1è¡Œï¼‰
# æ–‡ä»¶ï¼šdemo.sh Â  Â  Â   # è„šæœ¬æè¿°
# ä½œè€…ï¼šCSDNç”¨æˆ· Â  Â  Â  # ç»´æŠ¤ä¿¡æ¯
â€‹
echo "æ¬¢è¿å­¦ä¹ Shellç¼–ç¨‹" Â  # å¯æ‰§è¡Œè¯­å¥</code></pre>
    <hr/>
    <h3>
     ä¸‰ã€é¦–ä¸ªShellè„šæœ¬å®æˆ˜
    </h3>
    <h4>
     3.1 åˆ›å»ºå¹¶è¿è¡Œè„šæœ¬
    </h4>
    <pre><code class="language-bash"># åˆ›å»ºè„šæœ¬æ–‡ä»¶ï¼ˆå»ºè®®.shåç¼€ï¼‰
touch hello_world.sh Â 
chmod +x hello_world.sh Â # æ·»åŠ æ‰§è¡Œæƒé™</code></pre>
    <h4>
     3.2 ç¼–è¾‘å™¨è¾“å…¥ä»¥ä¸‹ä»£ç 
    </h4>
    <pre><code class="language-bash">#!/bin/bash
# ç¬¬ä¸€ä¸ªShellç¨‹åº
echo "å½“å‰ç”¨æˆ·ï¼š$(whoami)"
echo "ç³»ç»Ÿæ—¶é—´ï¼š$(date +%F)"</code></pre>
    <h4>
     3.3 ä¸‰ç§æ‰§è¡Œæ–¹å¼å¯¹æ¯”
    </h4>
    <table>
     <thead>
      <tr>
       <th>
        æ‰§è¡Œæ–¹å¼
       </th>
       <th>
        å‘½ä»¤ç¤ºä¾‹
       </th>
       <th>
        é€‚ç”¨åœºæ™¯
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <strong>
         è·¯å¾„ç›´æ¥æ‰§è¡Œ
        </strong>
       </td>
       <td>
        <code>
         ./hello_world.sh
        </code>
       </td>
       <td>
        å·²æ·»åŠ æ‰§è¡Œæƒé™æ—¶
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         æŒ‡å®šè§£é‡Šå™¨æ‰§è¡Œ
        </strong>
       </td>
       <td>
        <code>
         bash hello_world.sh
        </code>
       </td>
       <td>
        è°ƒè¯•å¿«é€Ÿæ‰§è¡Œ
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         sourceå‘½ä»¤æ‰§è¡Œ
        </strong>
       </td>
       <td>
        <code>
         source hello_world.sh
        </code>
       </td>
       <td>
        éœ€ä¿ç•™ç¯å¢ƒå˜é‡æ—¶
       </td>
      </tr>
     </tbody>
    </table>
    <hr/>
    <h3>
     å››ã€æ ¸å¿ƒç¼–ç¨‹è¯­æ³•ç²¾è¦
    </h3>
    <h4>
     4.1 å˜é‡æ“ä½œ
    </h4>
    <pre><code class="language-bash">company="CSDNç¤¾åŒº" Â  Â  Â  Â  Â # å®šä¹‰å˜é‡ï¼ˆç­‰å·æ— ç©ºæ ¼ï¼‰
readonly version="1.0" Â  Â  # åªè¯»å˜é‡ï¼ˆä¸å¯ä¿®æ”¹ï¼‰
today=$(date +%Y-%m-%d) Â  Â # å‘½ä»¤æ‰§è¡Œç»“æœèµ‹å€¼
echo "${company} ${today}" # å»ºè®®å˜é‡ç”¨èŠ±æ‹¬å·åŒ…è£¹</code></pre>
    <h4>
     4.2 æ¡ä»¶åˆ†æ”¯ç»“æ„
    </h4>
    <pre><code class="language-bash">if [ -f "/etc/passwd" ]; then Â  Â  # åˆ¤æ–­æ–‡ä»¶å­˜åœ¨
 Â echo "ç³»ç»Ÿå¯†ç æ–‡ä»¶å­˜åœ¨"
elif [ -d "/tmp" ]; then Â  Â  Â  Â  Â # åˆ¤æ–­ç›®å½•å­˜åœ¨
 Â echo "/tmpç›®å½•å­˜åœ¨"
else
 Â echo "æ¡ä»¶æœªæ»¡è¶³"
fi</code></pre>
    <h4>
     4.3 å¾ªç¯ç»“æ„
    </h4>
    <p>
     <strong>
      forå¾ªç¯å¤„ç†æ–‡ä»¶åˆ—è¡¨
     </strong>
     :
    </p>
    <pre><code class="language-bash">for file in *.log; do
 Â echo "æ­£åœ¨å¤„ç†æ—¥å¿—æ–‡ä»¶ï¼š${file}"
done</code></pre>
    <p>
     <strong>
      whileæŒ‰è¡Œè¯»å–æ–‡ä»¶
     </strong>
     :
    </p>
    <pre><code class="language-bash">while read line; do
 Â echo "å½“å‰è¡Œï¼š$line"
done &lt; input.txt</code></pre>
    <h4>
     4.4 å‡½æ•°å®šä¹‰ä¸è°ƒç”¨
    </h4>
    <pre><code class="language-bash"># å¸¦è¿”å›å€¼å‡½æ•°
file_exists() {
  [ -f "$1" ] &amp;&amp; return 0 || return 1
}
â€‹
# è°ƒç”¨å‡½æ•°
file_exists /etc/hosts
if [ $? -eq 0 ]; then Â  Â # $?è·å–ä¸Šä¸€æ¡å‘½ä»¤è¿”å›å€¼
 Â echo "æ–‡ä»¶å­˜åœ¨"
fi</code></pre>
    <hr/>
    <h3>
     äº”ã€å®ç”¨åŠŸèƒ½æ¨¡å—é€ŸæŸ¥
    </h3>
    <h4>
     5.1 å‚æ•°ä¼ é€’å¤„ç†
    </h4>
    <table>
     <thead>
      <tr>
       <th>
        ç‰¹æ®Šå˜é‡
       </th>
       <th>
        å«ä¹‰
       </th>
       <th>
        ç¤ºä¾‹
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <code>
         $0
        </code>
       </td>
       <td>
        è„šæœ¬åç§°
       </td>
       <td>
        <code>
         echo "è„šæœ¬ï¼š$0"
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <code>
         $1
        </code>
        -
        <code>
         $9
        </code>
       </td>
       <td>
        ç¬¬1-9ä¸ªä½ç½®å‚æ•°
       </td>
       <td>
        <code>
         echo "ç¬¬1å‚æ•°ï¼š$1"
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <code>
         $#
        </code>
       </td>
       <td>
        å‚æ•°æ€»ä¸ªæ•°
       </td>
       <td>
        <code>
         if [ $# -gt 0 ]
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <code>
         $@
        </code>
       </td>
       <td>
        æ‰€æœ‰å‚æ•°åˆ—è¡¨
       </td>
       <td>
        <code>
         for param in $@
        </code>
       </td>
      </tr>
     </tbody>
    </table>
    <h4>
     5.2 é€€å‡ºçŠ¶æ€ç 
    </h4>
    <pre><code class="language-bash">check_service() {
  systemctl is-active nginx &gt;/dev/null
  return $? Â  # è¿”å›ä¸Šæ¡å‘½ä»¤çš„é€€å‡ºçŠ¶æ€
}
â€‹
check_service
case $? in
 Â 0) echo "æœåŠ¡è¿è¡Œä¸­";;
  *) echo "æœåŠ¡å¼‚å¸¸ï¼ŒçŠ¶æ€ç ï¼š$?";;
esac</code></pre>
    <h4>
     5.3 ç®¡é“ä¸é‡å®šå‘
    </h4>
    <pre><code class="language-bash"># ç®¡é“ç»„åˆå‘½ä»¤
cat access.log | grep "404" | awk '{print $7}'
â€‹
# è¾“å‡ºé‡å®šå‘
ls -l &gt; file_list.txt Â  Â # è¦†ç›–å†™å…¥
echo "æ–°å¢å†…å®¹" &gt;&gt; log.txt # è¿½åŠ å†™å…¥
â€‹
# é”™è¯¯è¾“å‡ºå¤„ç†
apt update 2&gt; /dev/null Â # ä¸¢å¼ƒé”™è¯¯è¾“å‡º</code></pre>
    <hr/>
    <h3>
     å…­ã€è‡ªåŠ¨åŒ–å®æˆ˜ï¼šç³»ç»Ÿå¤‡ä»½è„šæœ¬
    </h3>
    <h4>
     6.1 éœ€æ±‚è¯´æ˜
    </h4>
    <ul>
     <li>
      <p>
       æ¯æ—¥å‡Œæ™¨å‹ç¼©å¤‡ä»½
       <code>
        /data
       </code>
       ç›®å½•
      </p>
     </li>
     <li>
      <p>
       è‡ªåŠ¨åˆ é™¤30å¤©å‰çš„å¤‡ä»½æ–‡ä»¶
      </p>
     </li>
     <li>
      <p>
       è®°å½•æ“ä½œæ—¥å¿—
      </p>
     </li>
    </ul>
    <h4>
     6.2 å®Œæ•´ä»£ç å®ç°
    </h4>
    <pre><code class="language-bash">#!/bin/bash
# è‡ªåŠ¨åŒ–å¤‡ä»½è„šæœ¬
â€‹
# é…ç½®å‚æ•°
backup_dir="/data"
dest_path="/backup"
keep_days=30
log_file="/var/log/backup.log"
â€‹
# ç›®å½•æ£€æŸ¥
[ ! -d "$dest_path" ] &amp;&amp; mkdir -p "$dest_path"
[ ! -f "$log_file" ] &amp;&amp; touch "$log_file"
â€‹
# ç”Ÿæˆå‹ç¼©åŒ…
timestamp=$(date +%Y%m%d%H%M)
tar -czf "${dest_path}/backup_${timestamp}.tar.gz" "$backup_dir" 2&gt;&amp;1 | tee -a "$log_file"
â€‹
# æ¸…ç†æ—§å¤‡ä»½
find "$dest_path" -name "*.tar.gz" -mtime +$keep_days -delete 2&gt;&amp;1 | tee -a "$log_file"
â€‹
# æ—¥å¿—è®°å½•
echo "[$(date)] å¤‡ä»½å®Œæˆï¼Œä¿ç•™æœ€è¿‘${keep_days}å¤©æ–‡ä»¶" | tee -a "$log_file"</code></pre>
    <h4>
     6.3 éƒ¨ç½²åˆ°cronè®¡åˆ’ä»»åŠ¡
    </h4>
    <pre><code class="language-bash"># æ¯æ—¥å‡Œæ™¨2ç‚¹æ‰§è¡Œ
crontab -e
# æ·»åŠ å¦‚ä¸‹è¡Œ
0 2 * * * /opt/scripts/backup.sh</code></pre>
    <hr/>
    <h3>
     ä¸ƒã€é«˜é˜¶è°ƒè¯•æŠ€å·§
    </h3>
    <h4>
     7.1 æ‰§è¡Œè¿‡ç¨‹è¿½è¸ª
    </h4>
    <pre><code class="language-bash">bash -x script.sh Â # æ˜¾ç¤ºæ¯æ¡æ‰§è¡Œå‘½ä»¤</code></pre>
    <h4>
     7.2 ä»£ç æ®µè°ƒè¯•
    </h4>
    <pre><code class="language-bash">set -x Â  # å¼€å¯è°ƒè¯•æ¨¡å¼
# éœ€è¦è°ƒè¯•çš„ä»£ç 
set +x Â  # å…³é—­è°ƒè¯•æ¨¡å¼</code></pre>
    <h4>
     7.3 é”™è¯¯è‡ªåŠ¨é€€å‡º
    </h4>
    <pre><code class="language-bash">#!/bin/bash
set -e Â  # ä»»ä½•è¯­å¥è¿”å›å€¼é0åˆ™ç«‹å³é€€å‡º
set -o pipefail Â # ç®¡é“å‘½ä»¤å‡ºé”™æ—¶ä¹Ÿé€€å‡º</code></pre>
    <hr/>
    <h3>
     å…«ã€å­¦ä¹ è·¯çº¿ä¸èµ„æºæ¨è
    </h3>
    <p>
     ğŸ”¥
     <strong>
      æŠ€èƒ½æå‡è·¯çº¿
     </strong>
     ï¼š
    </p>
    <ol>
     <li>
      <p>
       æŒæ¡æ­£åˆ™è¡¨è¾¾å¼ï¼ˆgrep/sedï¼‰
      </p>
     </li>
     <li>
      <p>
       å­¦ä¹ awké«˜çº§æ–‡æœ¬å¤„ç†
      </p>
     </li>
     <li>
      <p>
       ç†è§£Linuxä¿¡å·å¤„ç†ï¼ˆtrapï¼‰
      </p>
     </li>
     <li>
      <p>
       ç ”ç©¶Ansibleç­‰è‡ªåŠ¨åŒ–å·¥å…·
      </p>
     </li>
    </ol>
    <p>
     ğŸ“š
     <strong>
      æ¨èèµ„æ–™
     </strong>
     ï¼š
    </p>
    <ul>
     <li>
      <p>
       <strong>
        ä¹¦ç±
       </strong>
       ï¼šã€ŠLinuxå‘½ä»¤è¡Œä¸Shellè„šæœ¬ç¼–ç¨‹å¤§å…¨ã€‹
      </p>
     </li>
     <li>
      <p>
       <strong>
        å·¥å…·
       </strong>
       ï¼š
       <a href="https://www.shellcheck.net/" rel="nofollow" title="ShellCheckåœ¨çº¿æ£€æµ‹">
        ShellCheckåœ¨çº¿æ£€æµ‹
       </a>
      </p>
     </li>
    </ul>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f33363937393935322f:61727469636c652f64657461696c732f313436313931323034" class_="artid" style="display:none">
 </p>
</div>


