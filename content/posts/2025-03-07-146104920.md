---
layout: post
title: "我与DeepSeek读大型网站技术架构8-网站应用攻击与防御"
date: 2025-03-07 21:40:39 +0800
description: "网站应用的攻击与防御手段"
keywords: "我与DeepSeek读《大型网站技术架构》（8）- 网站应用攻击与防御"
categories: ['我与Deepseek读大型网站技术架构']
tags: ['网络', '架构']
artid: "146104920"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146104920
    alt: "我与DeepSeek读大型网站技术架构8-网站应用攻击与防御"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146104920
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146104920
cover: https://bing.ee123.net/img/rand?artid=146104920
image: https://bing.ee123.net/img/rand?artid=146104920
img: https://bing.ee123.net/img/rand?artid=146104920
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     我与DeepSeek读《大型网站技术架构》（8）- 网站应用攻击与防御
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <h2>
     <a id="__2">
     </a>
     固若金汤： 网站的安全性架构
    </h2>
    <h3>
     <a id="_4">
     </a>
     网站应用攻击与防御
    </h3>
    <p>
     以下是
     <strong>
      主流网站应用攻击类型及防御措施
     </strong>
     的详细总结，基于参考资料的核心内容与安全实践原则：
    </p>
    <hr/>
    <h4>
     <a id="XSS_12">
     </a>
     XSS（跨站脚本攻击）
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        攻击原理
       </strong>
      </p>
      <ul>
       <li>
        <strong>
         反射型
        </strong>
        ：攻击者诱导用户点击含恶意脚本的链接，窃取Cookie或会话数据 。
       </li>
       <li>
        <strong>
         存储型
        </strong>
        ：恶意脚本通过用户输入（如评论）存入数据库，用户浏览时触发攻击。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        防御措施
       </strong>
      </p>
      <ul>
       <li>
        <strong>
         消毒（转义危険字符）
        </strong>
        ：对用户输入的关键字符（如
        <code>
         &lt;
        </code>
        →
        <code>
         &amp;lt;
        </code>
        ）进行转义。
       </li>
       <li>
        <strong>
         HttpOnly属性
        </strong>
        ：禁止客户端脚本访问敏感Cookie（如会话ID）。
       </li>
      </ul>
     </li>
    </ol>
    <hr/>
    <h4>
     <a id="SQL_23">
     </a>
     注入攻击（如SQL注入）
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        攻击原理
       </strong>
      </p>
      <ul>
       <li>
        攻击者在输入参数中嵌入恶意SQL语句（如
        <code>
         ' OR 1=1; DROP TABLE users
        </code>
        ），篡改数据库操作 。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        防御措施
       </strong>
      </p>
      <ul>
       <li>
        <strong>
         参数化查询（预编译语句）
        </strong>
        ：避免直接拼接SQL语句。
       </li>
       <li>
        <strong>
         输入消毒
        </strong>
        ：过滤输入中的特殊符号（如单引号、分号）。
       </li>
       <li>
        <strong>
         最小权限原则
        </strong>
        ：数据库账户仅授予必要权限。
       </li>
      </ul>
     </li>
    </ol>
    <hr/>
    <h4>
     <a id="CSRF_34">
     </a>
     CSRF（跨站请求伪造）
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        攻击原理
       </strong>
      </p>
      <ul>
       <li>
        攻击者伪造用户身份（如利用已登录状态），通过恶意链接触发非授权操作（如转账请求）。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        防御措施
       </strong>
      </p>
      <ul>
       <li>
        <strong>
         CSRF Token
        </strong>
        ：服务器生成唯一Token随页面下发，请求时验证其合法性。
       </li>
       <li>
        <strong>
         验证码校验
        </strong>
        ：对敏感操作（如支付）强制用户输入验证码。
       </li>
       <li>
        <strong>
         Referer检查
        </strong>
        ：验证请求来源是否合法（如仅允许本站来源）。
       </li>
      </ul>
     </li>
    </ol>
    <hr/>
    <h4>
     <a id="_45">
     </a>
     其他常见攻击及防御
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        路径遍历攻击
       </strong>
      </p>
      <ul>
       <li>
        <strong>
         攻击
        </strong>
        ：通过构造非法URL（如
        <code>
         ../../etc/passwd
        </code>
        ）访问受限目录或文件。
       </li>
       <li>
        <strong>
         防御
        </strong>
        ：资源文件独立部署；避免动态参数包含路径信息。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        错误回显（Error Code）
       </strong>
      </p>
      <ul>
       <li>
        <strong>
         攻击
        </strong>
        ：通过触发服务器错误获取敏感信息（如数据库结构）。
       </li>
       <li>
        <strong>
         防御
        </strong>
        ：配置服务器跳转至统一错误页面，隐藏堆栈细节。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        文件上传漏洞
       </strong>
      </p>
      <ul>
       <li>
        <strong>
         攻击
        </strong>
        ：上传可执行脚本（如
        <code>
         .php
        </code>
        、
        <code>
         .sh
        </code>
        ），控制服务器。
       </li>
       <li>
        <strong>
         防御
        </strong>
        ：限制文件类型白名单；重命名存储文件名；文件存入独立服务器。
       </li>
      </ul>
     </li>
    </ol>
    <hr/>
    <h4>
     <a id="_60">
     </a>
     全局防护工具
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        Web应用防火墙（WAF）
       </strong>
      </p>
      <ul>
       <li>
        实时拦截恶意请求（如注入语句、XSS脚本），支持规则动态升级。示例工具：ModSecurity。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        安全漏洞扫描
       </strong>
      </p>
      <ul>
       <li>
        自动化工具模拟攻击，检测潜在安全漏洞（如未消毒参数、错误配置）。
       </li>
      </ul>
     </li>
    </ol>
    <hr/>
    <h4>
     <a id="ModSecurity_69">
     </a>
     ModSecurity架构设计
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        分离式架构
       </strong>
       ：
      </p>
      <ul>
       <li>
        <strong>
         执行引擎
        </strong>
        （核心处理逻辑）：嵌入到Web服务器（如Apache、Nginx）中，负责请求/响应的
        <strong>
         实时拦截与过滤
        </strong>
        ，包括解析HTTP协议、加载规则集合、执行规则匹配等。
       </li>
       <li>
        <strong>
         规则集合
        </strong>
        ：独立于引擎，以文本或配置文件形式定义攻击检测模式（如正则表达式匹配恶意脚本、SQL注入特征等），支持动态更新以应对新威胁 。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        请求处理流程
       </strong>
       ：
      </p>
      <ol>
       <li>
        <strong>
         拦截阶段
        </strong>
        ：捕获所有传入的HTTP请求和传出的响应数据流。
       </li>
       <li>
        <strong>
         预处理阶段
        </strong>
        ：解析请求参数（如URL、Headers、Body），标准化数据方便规则匹配。
       </li>
       <li>
        <strong>
         规则匹配阶段
        </strong>
        ：逐条应用规则集中的检测逻辑（如检测XSS、SQL注入、路径遍历等）。
       </li>
       <li>
        <strong>
         阻断或放行
        </strong>
        ：若触发规则则记录日志并阻断请求，否则允许正常流量通过。
       </li>
      </ol>
     </li>
     <li>
      <p>
       <strong>
        扩展性与兼容性
       </strong>
       ：
      </p>
      <ul>
       <li>
        <strong>
         多平台支持
        </strong>
        ：作为模块嵌入主流Web服务器（早期为Apache，后扩展至Nginx、IIS等）。
       </li>
       <li>
        <strong>
         自定义规则
        </strong>
        ：允许用户编写针对业务场景的
        <strong>
         个性化防御规则
        </strong>
        ，与其他安全工具（如漏洞扫描器）联动 。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        安全能力强化
       </strong>
       ：
      </p>
      <ul>
       <li>
        <strong>
         自动消毒（Sanitization）
        </strong>
        ：清洗请求中的危险参数（如转义HTML字符）。
       </li>
       <li>
        <strong>
         会话管理
        </strong>
        ：跟踪用户会话状态，识别异常行为（如高频请求）。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        架构优势
       </strong>
      </p>
     </li>
    </ol>
    <ul>
     <li>
      <strong>
       低耦合设计
      </strong>
      ：规则与引擎分离，使安全策略升级无需修改核心代码。
     </li>
     <li>
      <strong>
       实时防护
      </strong>
      ：集成在请求处理链中，可快速响应攻击。
     </li>
     <li>
      <strong>
       日志与审计
      </strong>
      ：记录攻击事件，提供事后分析与策略优化依据。
     </li>
    </ul>
    <ol start="6">
     <li>
      <strong>
       对比选型
      </strong>
     </li>
    </ol>
    <table>
     <thead>
      <tr>
       <th>
        维度
       </th>
       <th>
        ModSecurity
       </th>
       <th>
        NAXSI
       </th>
       <th>
        Shadow Daemon
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <strong>
         部署方式
        </strong>
       </td>
       <td>
        模块嵌入Apache/Nginx等服务器
       </td>
       <td>
        仅支持Nginx（原生模块）
       </td>
       <td>
        独立中间件或集成至PHP/Python等语言环境
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         规则体系
        </strong>
       </td>
       <td>
        分离式架构，支持自定义规则集
       </td>
       <td>
        基于预定义签名的轻量规则库
       </td>
       <td>
        动态请求分析 + 用户自定义白名单
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         防护机制
        </strong>
       </td>
       <td>
        基于正则匹配的通用WAF策略
       </td>
       <td>
        简化签名匹配（注重常见攻击模式）
       </td>
       <td>
        上下文敏感的动态恶意行为检测
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         性能开销
        </strong>
       </td>
       <td>
        较高（复杂正则与规则深度解析）
       </td>
       <td>
        低（固定规则库）
       </td>
       <td>
        中等（动态分析需额外计算资源）
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         扩展性
        </strong>
       </td>
       <td>
        高（支持动态加载规则、插件扩展）
       </td>
       <td>
        中（依赖Nginx集成）
       </td>
       <td>
        中（依赖语言框架适配）
       </td>
      </tr>
     </tbody>
    </table>
    <hr/>
    <h4>
     <a id="_106">
     </a>
     总结思考
    </h4>
    <p>
     安全防御需以
     <strong>
      分层防护
     </strong>
     为核心：
    </p>
    <ol>
     <li>
      <strong>
       输入层
      </strong>
      ：强制消毒与验证（如参数过滤、Token机制）。
     </li>
     <li>
      <strong>
       逻辑层
      </strong>
      ：权限最小化 + 业务逻辑加固（如验证码、反自动化脚本）。
     </li>
     <li>
      <strong>
       基础设施层
      </strong>
      ：部署WAF + 加密敏感数据（如密钥管理）。
     </li>
    </ol>
    <hr/>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="687474:70733a2f2f626c6f672e6373646e2e6e65742f67647231322f:61727469636c652f64657461696c732f313436313034393230" class_="artid" style="display:none">
 </p>
</div>


