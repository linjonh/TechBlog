---
layout: post
title: "Python数据分析之数据处理与分析"
date: 2025-03-10 16:57:21 +0800
description: "三、数据分析工具NumPy高性能数值计算和数组操作库，掌握数组相关操作。pandas强大的数据分析和处理库，重点掌握 DataFrame 和 Series 对象功能。Matplotlib常用数据可视化库，绘制各种类型图表。Seaborn基于 Matplotlib 的高级可视化库，绘制复杂统计图表。"
keywords: "Python数据分析之数据处理与分析"
categories: ['Python']
tags: ['数据分析', '开发语言', 'Python']
artid: "146131811"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146131811
    alt: "Python数据分析之数据处理与分析"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146131811
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146131811
cover: https://bing.ee123.net/img/rand?artid=146131811
image: https://bing.ee123.net/img/rand?artid=146131811
img: https://bing.ee123.net/img/rand?artid=146131811
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Python数据分析之数据处理与分析
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h4>
     <a id="Python__0">
     </a>
     Python 数据分析重点知识点
    </h4>
    <p>
     <em>
      <strong>
       本系列不同其他的知识点讲解，力求通过例子让新同学学习用法，帮助老同学快速回忆知识点
      </strong>
     </em>
    </p>
    <p>
     可视化系列：
    </p>
    <ol>
     <li>
      <a href="https://blog.csdn.net/weixin_52593633/article/details/146131777">
       Python基础
      </a>
     </li>
     <li>
      <a href="https://blog.csdn.net/weixin_52593633/article/details/146131820?spm=1001.2014.3001.5501">
       数据分析工具
      </a>
     </li>
     <li>
      <a href="https://blog.csdn.net/weixin_52593633/article/details/146131811?spm=1001.2014.3001.5501">
       数据处理与分析
      </a>
     </li>
     <li>
      <a href="https://blog.csdn.net/weixin_52593633/article/details/146131829">
       数据可视化
      </a>
     </li>
     <li>
      <a href="https://blog.csdn.net/weixin_52593633/article/details/146131838">
       机器学习基础
      </a>
     </li>
    </ol>
    <h5>
     <a id="_9">
     </a>
     三、数据处理与分析
    </h5>
    <ul>
     <li>
      <strong>
       数据清洗
      </strong>
      <ul>
       <li>
        处理缺失值（删除、填充）、异常值（识别、处理），数据标准化、归一化等。
       </li>
      </ul>
     </li>
    </ul>
    <pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler<span class="token punctuation">,</span> MinMaxScaler

<span class="token comment"># 创建示例数据 </span>
<span class="token comment">#一般是.csv文件或者.xls文件,这里为了清楚直接写了两行数据</span>
data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Salary'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">50000</span><span class="token punctuation">,</span> <span class="token number">60000</span><span class="token punctuation">,</span> <span class="token number">120000</span><span class="token punctuation">,</span> <span class="token number">150000</span><span class="token punctuation">,</span> <span class="token number">180000</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span> <span class="token number">210000</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token comment"># 处理缺失值</span>
<span class="token comment"># 删除含有NaN的行</span>
df_dropped <span class="token operator">=</span> df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 填充缺失值，这里我们用平均值填充</span>
df_filled <span class="token operator">=</span> df<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>df<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 数据标准化</span>
scaler <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>
df_standardized <span class="token operator">=</span> df_filled<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
df_standardized<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">,</span> <span class="token string">'Salary'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> scaler<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>df_filled<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">,</span> <span class="token string">'Salary'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 数据归一化</span>
min_max_scaler <span class="token operator">=</span> MinMaxScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>
df_normalized <span class="token operator">=</span> df_filled<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
df_normalized<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">,</span> <span class="token string">'Salary'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> min_max_scaler<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>df_filled<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">,</span> <span class="token string">'Salary'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"原始数据:\n"</span><span class="token punctuation">,</span>df<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n删除缺失值后的数据:\n"</span><span class="token punctuation">,</span>df_dropped<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n填充缺失值后的数据:\n"</span><span class="token punctuation">,</span>df_filled<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n标准化后的数据:\n"</span><span class="token punctuation">,</span>df_standardized<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n归一化后的数据:\n"</span><span class="token punctuation">,</span>df_normalized<span class="token punctuation">)</span>
</code></pre>
    <ul>
     <li>
      <strong>
       数据探索
      </strong>
      <ul>
       <li>
        通过统计方法和可视化手段了解数据特征和分布。
       </li>
      </ul>
     </li>
    </ul>
    <pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'Salary'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">50000</span><span class="token punctuation">,</span> <span class="token number">60000</span><span class="token punctuation">,</span> <span class="token number">120000</span><span class="token punctuation">,</span> <span class="token number">180000</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">210000</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 绘制年龄的直方图</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">#可以设置多个子图，表示一行两列的第一个图</span>
plt<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> bins<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Age Distribution'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Age'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Frequency'</span><span class="token punctuation">)</span>

<span class="token comment"># 绘制薪水的直方图</span>
plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">#表示一行两列的第二个图</span>
plt<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'Salary'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> bins<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'green'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Salary Distribution'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Salary'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Frequency'</span><span class="token punctuation">)</span>

<span class="token comment"># 当你使用 plt.subplot() 创建多个子图时，默认情况下，子图可能会彼此重叠或与边缘过于接近，这会影响图形的可读性。</span>
<span class="token comment"># 调用 plt.tight_layout() 后，Matplotlib 会自动调整子图的布局，使得它们更加整洁和易于阅读。</span>
plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/f88093a083ff4bfe878ff0f0f6b992ad.png#pic_center" width="800"/>
    </p>
    <ul>
     <li>
      <strong>
       数据转换
      </strong>
      <ul>
       <li>
        数据类型转换、数据重塑（pivot、melt 等函数），特征工程（创建新特征、特征选择）。
       </li>
      </ul>
     </li>
    </ul>
    <pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token comment"># 创建示例数据集</span>
data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'Date'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'2021-01-01'</span><span class="token punctuation">,</span> <span class="token string">'2021-01-02'</span><span class="token punctuation">,</span> <span class="token string">'2021-01-03'</span><span class="token punctuation">,</span> <span class="token string">'2021-01-04'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'City'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'New York'</span><span class="token punctuation">,</span> <span class="token string">'Los Angeles'</span><span class="token punctuation">,</span> <span class="token string">'Chicago'</span><span class="token punctuation">,</span> <span class="token string">'Houston'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Temperature'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Humidity'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"原始数据:"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token comment"># 转换日期列为日期时间类型</span>
df<span class="token punctuation">[</span><span class="token string">'Date'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'Date'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 转换温度和湿度列为浮点数类型</span>
df<span class="token punctuation">[</span><span class="token string">'Temperature'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'Temperature'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">'Humidity'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'Humidity'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n数据类型转换后的数据:"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>dtypes<span class="token punctuation">)</span>

<span class="token comment"># 使用pivot函数重塑数据,意思就是指定数据的行和列</span>
df_pivot <span class="token operator">=</span> df<span class="token punctuation">.</span>pivot<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token string">'City'</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token string">'Date'</span><span class="token punctuation">,</span> values<span class="token operator">=</span><span class="token string">'Temperature'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n数据重塑后的数据 (pivot):"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_pivot<span class="token punctuation">)</span>

<span class="token comment"># 使用melt函数重塑数据</span>
df_melt <span class="token operator">=</span> pd<span class="token punctuation">.</span>melt<span class="token punctuation">(</span>df_pivot<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> id_vars<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'City'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> var_name<span class="token operator">=</span><span class="token string">'Date'</span><span class="token punctuation">,</span> value_name<span class="token operator">=</span><span class="token string">'Temperature'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n数据重塑后的数据 (melt):"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_melt<span class="token punctuation">)</span>

<span class="token comment"># 创建新特征：温度的平方</span>
df<span class="token punctuation">[</span><span class="token string">'Temperature_Squared'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'Temperature'</span><span class="token punctuation">]</span> <span class="token operator">**</span> <span class="token number">2</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n添加新特征后的数据:"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

<span class="token comment"># 选择特定的列作为新的特征集</span>
selected_features <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'City'</span><span class="token punctuation">,</span> <span class="token string">'Temperature'</span><span class="token punctuation">,</span> <span class="token string">'Humidity'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n特征选择后的数据:"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>selected_features<span class="token punctuation">)</span>
</code></pre>
    <center class="half">
     <img src="https://i-blog.csdnimg.cn/direct/86a43e0d359d40d887d34b4ae7ded9e4.png" width="280">
      <img src="https://i-blog.csdnimg.cn/direct/6794f8948f2b46b3ac47bb4714dbd50f.png" width="250">
       <img src="https://i-blog.csdnimg.cn/direct/fa482f19f716462c9590d4b67f5bd78b.png" width="360">
       </img>
      </img>
     </img>
    </center>
    <blockquote>
     <p>
      关于pivot和melt的区别，请先看以上的运行结果然后再理解会更加清楚
     </p>
    </blockquote>
    <ul>
     <li>
      <p>
       pivot：
      </p>
      <ul>
       <li>
        <p>
         index：指定作为新表格行索引的列。
        </p>
       </li>
       <li>
        <p>
         columns：指定作为新表格列索引的列。
        </p>
       </li>
       <li>
        <p>
         values：指定在新表格中填充数据的列。
        </p>
       </li>
      </ul>
     </li>
     <li>
      <p>
       melt：
      </p>
      <ul>
       <li>
        <p>
         id_vars：指定在转换过程中保留的列。
        </p>
       </li>
       <li>
        <p>
         value_vars：指定要合并的列。
        </p>
       </li>
       <li>
        <p>
         var_name：指定新变量列的名称。
        </p>
       </li>
       <li>
        <p>
         value_name：指定新值列的名称。
        </p>
       </li>
      </ul>
     </li>
    </ul>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f35323539333633332f:61727469636c652f64657461696c732f313436313331383131" class_="artid" style="display:none">
 </p>
</div>


