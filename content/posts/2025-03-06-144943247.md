---
layout: post
title: "云原生系列之本地k8s环境搭建"
date: 2025-03-06 10:38:22 +0800
description: "Windows 11 家庭中文版，版本号 23H2。"
keywords: "云原生系列之本地k8s环境搭建"
categories: ['云原生']
tags: ['云原生', 'Minikube', 'K', 'Docker']
artid: "144943247"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=144943247
    alt: "云原生系列之本地k8s环境搭建"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=144943247
featuredImagePreview: https://bing.ee123.net/img/rand?artid=144943247
cover: https://bing.ee123.net/img/rand?artid=144943247
image: https://bing.ee123.net/img/rand?artid=144943247
img: https://bing.ee123.net/img/rand?artid=144943247
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     云原生系列之本地k8s环境搭建
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="_0">
     </a>
     前置条件
    </h2>
    <p>
     Windows 11 家庭中文版，版本号 23H2
    </p>
    <h2>
     <a id="_2">
     </a>
     云原生环境搭建
    </h2>
    <h3>
     <a id="wslwindows_subsystem_for_linux_3">
     </a>
     操作系统启用wsl(windows subsystem for linux)
    </h3>
    <ol>
     <li>
      <p>
       开启wsl功能，如下图
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/37738b08c6674b929145d12312632802.jpeg#pic_center"/>
      </p>
     </li>
     <li>
      <p>
       安装并开启github加速器 FastGithub
       <br/>
       2.1 下载地址：
       <a href="https://cloud.tsinghua.edu.cn/d/df482a15afb64dfeaff8/" rel="nofollow">
        点击下载
       </a>
       <br/>
       2.2 解压安装文件fastgithub_win-x64.zip
       <br/>
       2.3 开启fastGithub,双击FastGithub.UI图标，如下图
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/7f8109c9d076423fb213c6273e1d3434.png#pic_center"/>
      </p>
     </li>
     <li>
      <p>
       安装linux子系统(cmd 里操作)
       <br/>
       3.1 查看可安装的子系统:
       <code>
        wsl -l -o 或者 wsl --list --online
       </code>
       <br/>
       3.2 安装子系统：
       <code>
        wsl --install [子系统名称]
       </code>
       ，如果没有指定子系统名称，会默认安装
       <code>
        wsl -l -o
       </code>
       查出来的第一个子系统。
       <br/>
       3.3 更新wsl (docker依赖wsl版本2)：
       <code>
        wsl --update
       </code>
       <br/>
       3.4 设置wsl默认版本为2：
       <code>
        wsl --set-default-version 2
       </code>
       <br/>
       3.5 运行wsl服务：
       <code>
        wsl -d -Ubuntu
       </code>
       （
       <code>
        wsl -l -o
       </code>
       查出来的第一个子系统是Ubuntu）
       <br/>
       3.5 查看wsl状态：
       <code>
        wsl -l -v
       </code>
      </p>
     </li>
    </ol>
    <h3>
     <a id="docker_20">
     </a>
     docker安装
    </h3>
    <ol>
     <li>
      <a href="https://www.docker.com/" rel="nofollow">
       官网下载docker
      </a>
      <br/>
      <img alt="根据实际操作系统选择合适的版本" src="https://i-blog.csdnimg.cn/direct/356481ee228b44aaabaaf0161bf46b8f.jpeg#pic_center"/>
     </li>
     <li>
      安装docker
      <br/>
      下载完成后,所有步骤均选择默认即可（exe文件安装会自动配置到path路径上，其它方式可能需要自己配置环境变量）
     </li>
     <li>
      配置docker engine（主要是配置国内镜像地址）
      <br/>
      打开Docker Desktop，配置如下
      <br/>
      <img alt="docker engine 配置" src="https://i-blog.csdnimg.cn/direct/92fe099679fb4e29beeb2d6ea26370e2.jpeg"/>
     </li>
    </ol>
    <pre><code class="prism language-powershell"><span class="token punctuation">{<!-- --></span>
  <span class="token string">"builder"</span>: <span class="token punctuation">{<!-- --></span>
    <span class="token string">"gc"</span>: <span class="token punctuation">{<!-- --></span>
      <span class="token string">"defaultKeepStorage"</span>: <span class="token string">"20GB"</span><span class="token punctuation">,</span>
      <span class="token string">"enabled"</span>: true
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">"experimental"</span>: false<span class="token punctuation">,</span>
  <span class="token string">"insecure-registries"</span>: <span class="token punctuation">[</span>
    <span class="token string">"172.17.0.9:9001"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">"registry-mirrors"</span>: <span class="token punctuation">[</span>
    <span class="token string">"https://docker.hpcloud.cloud"</span><span class="token punctuation">,</span>
    <span class="token string">"https://docker.m.daocloud.io"</span><span class="token punctuation">,</span>
    <span class="token string">"https://docker.unsee.tech"</span><span class="token punctuation">,</span>
    <span class="token string">"https://docker.1panel.live"</span><span class="token punctuation">,</span>
    <span class="token string">"http://mirrors.ustc.edu.cn"</span><span class="token punctuation">,</span>
    <span class="token string">"https://docker.chenby.cn"</span><span class="token punctuation">,</span>
    <span class="token string">"http://mirror.azure.cn"</span><span class="token punctuation">,</span>
    <span class="token string">"https://dockerpull.org"</span><span class="token punctuation">,</span>
    <span class="token string">"https://dockerhub.icu"</span><span class="token punctuation">,</span>
    <span class="token string">"https://hub.rat.dev"</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
    <ol start="4">
     <li>
      测试docker是否安装成功
     </li>
    </ol>
    <pre><code class="prism language-powershell"><span class="token comment"># 拉取 Hello World 镜像</span>
docker pull hello-world
<span class="token comment"># 运行 Hello World 镜像</span>
docker run hello-world
</code></pre>
    <p>
     <img alt="docker验证" src="https://i-blog.csdnimg.cn/direct/9a274a4c538e4e3db4978d75d5b83516.jpeg"/>
    </p>
    <h3>
     <a id="minikubek8s_63">
     </a>
     minikube安装并启动k8s集群
    </h3>
    <ol>
     <li>
      <a href="https://minikube.sigs.k8s.io/docs/start/?arch=/windows/x86-64/stable/.exe%20download" rel="nofollow">
       官网下载minikube
      </a>
      <br/>
      <img alt="minikube下载" src="https://i-blog.csdnimg.cn/direct/7ffddf763fb94ce09067869d0cfc1fe1.jpeg"/>
     </li>
     <li>
      下载完成后,所有步骤均选择默认即可（exe文件安装会自动配置到path路径上，其它方式可能需要自己配置环境变量）
     </li>
     <li>
      验证minikube是否安装成功
     </li>
    </ol>
    <pre><code class="prism language-powershell">minikube version
</code></pre>
    <p>
     <img alt="验证minikube" src="https://i-blog.csdnimg.cn/direct/7cbdc5bba6f14197b6d87ec7f257e6e7.jpeg">
      <br/>
      4. 启动集群
      <br/>
      新版minikube依赖的的镜像可能国内镜像网站还没有，建议启动的时候先开启科学上网工具，镜像下载到本地后，后面在关掉
      <br/>
      <img alt="启动失败" src="https://i-blog.csdnimg.cn/direct/963e05ee19b24c1ca63414068de68344.jpeg"/>
     </img>
    </p>
    <pre><code class="prism language-powershell"><span class="token comment">#删除集群相关信息</span>
minikube delete
<span class="token comment">#开启科学上网后，重新启动集群</span>
minikube <span class="token function">start</span> <span class="token operator">--</span>driver=docker
<span class="token comment">#验证集群是否启动成功</span>
kubectl cluster-info
</code></pre>
    <p>
     <img alt="启动成功" src="https://i-blog.csdnimg.cn/direct/02ea1ac68baf4a83a92fcd7a09adc933.jpeg"/>
     <br/>
     <img alt="查看集群信息" src="https://i-blog.csdnimg.cn/direct/bf7358de8a6c45658b94c58e28c5e091.jpeg"/>
     <br/>
     至此，云原生本地k8s环境搭建已全部完成，本文涉及了wsl配置安装、docker安装配置、minikube安装配置及启动了第一个k8s集群。后面会继续介绍如何k8s相关配置，及如何在k8s上部署第一个后端项目，敬请期待。。。
    </p>
   </div>
   <link href="./../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="./../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f77666c5f3133373732342f:61727469636c652f64657461696c732f313434393433323437" class_="artid" style="display:none">
 </p>
</div>


