---
layout: post
title: "OpenCV开发笔记八十三图像remap实现哈哈镜效果"
date: 2025-03-12 20:20:58 +0800
description: "对图像进行非规则的扭曲，实现哈哈镜就是一种非常规的扭曲方式，本文先描述remap的原理，然后通过remap实现哈哈镜。"
keywords: "OpenCV开发笔记（八十三）：图像remap实现哈哈镜效果"
categories: ['未分类']
tags: ['径向畸变', '哈哈镜', 'Remap', 'Opencv']
artid: "146213444"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146213444
    alt: "OpenCV开发笔记八十三图像remap实现哈哈镜效果"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146213444
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146213444
cover: https://bing.ee123.net/img/rand?artid=146213444
image: https://bing.ee123.net/img/rand?artid=146213444
img: https://bing.ee123.net/img/rand?artid=146213444
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     OpenCV开发笔记（八十三）：图像remap实现哈哈镜效果
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     若该文为原创文章，转载请注明原文出处
     <br/>
     本文章博客地址：
     <a href="https://hpzwl.blog.csdn.net/article/details/146213444" rel="nofollow">
      https://hpzwl.blog.csdn.net/article/details/146213444
     </a>
    </p>
    <p>
     <a href="https://blog.csdn.net/qq21497936/article/details/102478062">
      长沙红胖子Qt（长沙创微智科）博文大全：开发技术集合（包含Qt实用技术、树莓派、三维、OpenCV、OpenGL、ffmpeg、OSG、单片机、软硬结合等等）持续更新中…
     </a>
    </p>
    <h2>
     <a id="OpenCVhttpsblogcsdnnetqq21497936articledetails102478062OpenCVE5BC80E58F91E4B893E6A08F_4">
     </a>
     <a href="https://blog.csdn.net/qq21497936/article/details/102478062#OpenCV%E5%BC%80%E5%8F%91%E4%B8%93%E6%A0%8F">
      OpenCV开发专栏（点击传送门）
     </a>
    </h2>
    <p>
     上一篇：《
     <a href="https://hpzwl.blog.csdn.net/article/details/143432922" rel="nofollow">
      OpenCV开发笔记（八十二）：两图拼接使用渐进色蒙版场景过渡缝隙
     </a>
     》
     <br/>
     下一篇：持续补充中…
    </p>
    <br/>
    <h2>
     <a id="_10">
     </a>
     前言
    </h2>
    <p>
     对图像进行非规则的扭曲，实现哈哈镜就是一种非常规的扭曲方式，本文先描述remap的原理，然后通过remap实现哈哈镜。
    </p>
    <br/>
    <h2>
     <a id="Demo_15">
     </a>
     Demo
    </h2>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/15a6fed53dd04181b2cb70d8ed49d183.png"/>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/3d240ba9aa974452abe13d563a00b5b4.png"/>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/560cffde46c74d2a99573ea9254a2ed7.png"/>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/5a3f664cb4d64212b2423ba763d82c1c.png">
      <br/>
      基于原始算法，可以进行二次开发，实现一些其他效果：
     </img>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/f1c0f879bda540e6bfefa36a434c4fa2.png"/>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/513db5d90aec4b1495da79535efa1061.png"/>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/b8a7bfd0a61c473e878836ac9bdc7596.png"/>
    </p>
    <br/>
    <h2>
     <a id="remap_34">
     </a>
     矫正映射remap（畸变映射）
    </h2>
    <p>
     当进行图像矫正时，必须指定输入图像的每个像素在输出图像中移动到的位置，成为“矫正映射”（畸变映射）。
    </p>
    <h3>
     <a id="_36">
     </a>
     双通道浮点数表示方式
    </h3>
    <p>
     N x M的矩阵A中，重映射由双通道浮点数的N x M的矩阵B表示，对于图像A中的任意一点aPoint(i, j)，映射为b1Point(i’, j’)和b2Point(i’, j’)，在A中假设i=2，j=3，那么（假设重映射之后4.5，5.5）在B1中b1Point(i’, j’)值为4.5，b2Point(i’, j’)值为5.5，由于坐标是浮点数，那么需要插值得到整数位置以及中间过渡的区域颜色（平滑处理）。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/ee93249333414c56a7d5cefc9a7a6e99.png"/>
    </p>
    <h3>
     <a id="_40">
     </a>
     双矩阵浮点数表示方式
    </h3>
    <p>
     双矩阵浮点数表示，N x M的矩阵A中，重映射由一对N x M的矩阵B和C描述，这里所有的N x M矩阵都是单通道浮点矩阵，在A中的点aPoint(i, j)，重映射矩阵B中的点bPoint(i,j)存储了重映射后的i’ （映射后的i坐标）， 重映射矩阵C中的点cPoint(i,j)存储了重映射后的j’（映射后的j坐标）。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/9009727184204b4b94e3a60b9f13553e.png"/>
    </p>
    <h3>
     <a id="_44">
     </a>
     定点表示方式
    </h3>
    <p>
     映射由双通道有符号整数矩阵（即CV_16SC2类型）表示。该方式与双通道浮点数表示方式相同，但使用此格式要快得多（笔者理解：由浮点数插值改为整数插值，会要快一些，但是肯定双通道浮点数的表示方式图像效果会稍微好一些）。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/aab604deb41445ba974c5a555c27bd0a.png"/>
    </p>
    <br/>
    <h2>
     <a id="remap_51">
     </a>
     remap核心关键
    </h2>
    <p>
     在于得到插值的坐标系来映射新位置的x和y位置，要渐近等，所以本方法的核心关键在于得到标定后的矩阵，得到映射矩阵的方式可以自己写算法，也可以使用其他方式，后续文章继续深入这块。
    </p>
    <br/>
    <h2>
     <a id="remap_56">
     </a>
     remap演示
    </h2>
    <p>
     为了更好的展示remap的作用，我们使用一张100x100的图，这样可以更好的看到remap的原理效果。
     <br/>
     先做一张100x100的图，图里面用不同的颜色，如下：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/c3e8db203f064e95b787cec0e9125155.png"/>
    </p>
    <p>
     使用opencv打开：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/79f95f459cfc477fadc4d3eeb82a5eda.png"/>
    </p>
    <h3>
     <a id="Map1_64">
     </a>
     Map1使用第一种表示点的方式
    </h3>
    <p>
     使用点的方式映射：
    </p>
    <pre><code class="prism language-cpp"><span class="token comment">// 表示点的第一种</span>
std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>cv<span class="token double-colon punctuation">::</span>Point2f<span class="token operator">&gt;</span> vectorPoints<span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/24e7ae79b0754462be83f2050e4323a0.png"/>
    </p>
    <p>
     这是相当于把点提取出来映射到一个mat里面，一直堆下去：
    </p>
    <pre><code class="prism language-cpp"><span class="token comment">// 表示点的第一种</span>
std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>cv<span class="token double-colon punctuation">::</span>Point2f<span class="token operator">&gt;</span> vectorPoints<span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> <span class="token number">50</span><span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/c0616d4200d1448faefa4330eab6d72c.png"/>
    </p>
    <h3>
     <a id="Map1_105">
     </a>
     Map1使用第二种表示点的方式
    </h3>
    <p>
     直接初始化：
    </p>
    <pre><code class="prism language-cpp">cv<span class="token double-colon punctuation">::</span>Mat <span class="token function">mapX</span><span class="token punctuation">(</span>srcMat<span class="token punctuation">.</span>rows<span class="token punctuation">,</span> srcMat<span class="token punctuation">.</span>cols<span class="token punctuation">,</span> CV_32F<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// x 方向</span>
cv<span class="token double-colon punctuation">::</span>Mat <span class="token function">mapY</span><span class="token punctuation">(</span>srcMat<span class="token punctuation">.</span>rows<span class="token punctuation">,</span> srcMat<span class="token punctuation">.</span>cols<span class="token punctuation">,</span> CV_32F<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// y 方向</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> row <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> row<span class="token operator">++</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> col <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> col <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> col<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> mapX<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
cv<span class="token double-colon punctuation">::</span><span class="token function">remap</span><span class="token punctuation">(</span>srcMat<span class="token punctuation">,</span> dstMat<span class="token punctuation">,</span> mapX<span class="token punctuation">,</span> mapY<span class="token punctuation">,</span> cv<span class="token double-colon punctuation">::</span>INTER_LINEAR<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     打印输出都是0：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/67409b3d0b0e46e09208ed9f8e2bca6b.png"/>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/bd93511059534f82ae5425d25366c58f.png"/>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/3387421fb2a84b75adeb44b84286b38f.png"/>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/5cf256caf2fd418f8ee13c631d239c78.png"/>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/09177c14d7d5417aa3aee631977b13ee.png"/>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/bc9e28881e4e4c49b05df5d06dbd3a33.png"/>
    </p>
    <p>
     这里map保存的是原来现在这个位置的点映射到原来图片哪个坐标点（注意：不是原来哪个位置映射到map哪个位置，是map的纵横坐标点映射原来值里面的那个坐标）左右从中间向两边拉伸则是：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/f55e568cccf8443e99e0c3e55e651aee.png"/>
    </p>
    <pre><code class="prism language-cpp">cv<span class="token double-colon punctuation">::</span>Mat <span class="token function">mapX</span><span class="token punctuation">(</span>srcMat<span class="token punctuation">.</span>rows<span class="token punctuation">,</span> srcMat<span class="token punctuation">.</span>cols<span class="token punctuation">,</span> CV_32F<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// x 方向</span>
cv<span class="token double-colon punctuation">::</span>Mat <span class="token function">mapY</span><span class="token punctuation">(</span>srcMat<span class="token punctuation">.</span>rows<span class="token punctuation">,</span> srcMat<span class="token punctuation">.</span>cols<span class="token punctuation">,</span> CV_32F<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// y 方向</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> row <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> row<span class="token operator">++</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> col <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> col <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> col<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>col <span class="token operator">&lt;</span> <span class="token number">25</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 0~24</span>
            mapX<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span> <span class="token operator">=</span> col <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
            mapY<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span> <span class="token operator">=</span> row<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>col <span class="token operator">&lt;</span> <span class="token number">50</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 25-49</span>
            mapX<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">49</span><span class="token punctuation">;</span>
            mapY<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span> <span class="token operator">=</span> row<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>col <span class="token operator">&lt;</span> <span class="token number">75</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 50~74</span>
            mapX<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span>
            mapY<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span> <span class="token operator">=</span> row<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 75~99</span>
            mapX<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">99</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token number">99</span> <span class="token operator">-</span> col<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
            mapY<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span> <span class="token operator">=</span> row<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
cv<span class="token double-colon punctuation">::</span><span class="token function">remap</span><span class="token punctuation">(</span>srcMat<span class="token punctuation">,</span> dstMat<span class="token punctuation">,</span> mapX<span class="token punctuation">,</span> mapY<span class="token punctuation">,</span> cv<span class="token double-colon punctuation">::</span>INTER_LINEAR<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/054a181141b540d7ad6693f766a98abd.png"/>
    </p>
    <br/>
    <h2>
     <a id="_171">
     </a>
     核心桥梁：椭圆
    </h2>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/3d9c9f74ff3f4e90a0d88fa875a82cf7.png"/>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/ca780ca7a21b4dc9be3700049673c197.png"/>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/b8c47e81fa124eec81d8ad83a136dc27.png"/>
    </p>
    <p>
     椭圆的标准方程，对于一个中心在原点、长轴在x轴上的椭圆，其标准方程为：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/9d0df740c59145fab69315d85983e4b4.png"/>
    </p>
    <p>
     其中，a是椭圆长轴的一半，b是椭圆短轴的一半。
     <br/>
     给定一个参数t（通常称为参数或偏心率角），椭圆上的点(x,y)可以用以下参数方程表示：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/5b8d6231ff314d21b3643cb3eaf98de4.png"/>
    </p>
    <p>
     其中，t的取值范围是[0,2π)，通过改变t的值，可以得到椭圆上的不同点。例如，假设有一个椭圆，其长轴为10，短轴为6。那么，a=5，b=3。
    </p>
    <ul>
     <li>
      当t=0时，点(x,y)=(5,0)，这是椭圆长轴上的一个端点。
     </li>
     <li>
      当 t=2π时，点(x,y)=(0,3)，这是椭圆短轴上的一个端点。
     </li>
     <li>
      当t=π时，点(x,y)=(−5,0)，这是椭圆长轴上的另一个端点。
     </li>
     <li>
      当t=2/3*π时，点(x,y)=(0,−3)，这是椭圆短轴上的另一个端点。
      <br/>
      通过改变t的值，可以得到椭圆上的任意点。
     </li>
    </ul>
    <br/>
    <h2>
     <a id="_194">
     </a>
     哈哈镜实现
    </h2>
    <p>
    </p>
    <pre><code class="prism language-cpp"><span class="token keyword">int</span> cols <span class="token operator">=</span> srcMat<span class="token punctuation">.</span>cols<span class="token punctuation">;</span>
<span class="token keyword">int</span> rows <span class="token operator">=</span> srcMat<span class="token punctuation">.</span>rows<span class="token punctuation">;</span>
<span class="token keyword">double</span> horizontalStrength <span class="token operator">=</span> <span class="token number">1.0f</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> verticalStrength <span class="token operator">=</span> <span class="token number">1.0f</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> zoom <span class="token operator">=</span> <span class="token number">1.0</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> cx <span class="token operator">=</span> cols <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> cy <span class="token operator">=</span> rows <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> x <span class="token operator">&lt;</span> cols<span class="token punctuation">;</span> x<span class="token operator">++</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> y <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> y<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 先求的范围内的点离中心点的偏移比例</span>
        <span class="token keyword">double</span> dx <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> cx<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1.0f</span> <span class="token operator">/</span> cx<span class="token punctuation">;</span>
        <span class="token keyword">double</span> dy <span class="token operator">=</span> <span class="token punctuation">(</span>y <span class="token operator">-</span> cy<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1.0f</span> <span class="token operator">/</span> cy<span class="token punctuation">;</span>
        <span class="token comment">// 求得中心点的距离</span>
        <span class="token keyword">double</span> distance <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>dx <span class="token operator">*</span> dx <span class="token operator">+</span> dy <span class="token operator">*</span> dy<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">// 缩放半径</span>
       <span class="token keyword">double</span> r <span class="token operator">=</span> distance <span class="token operator">/</span> zoom<span class="token punctuation">;</span>
       <span class="token comment">// 后面除0操作，这里防止为0</span>
       <span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
       <span class="token punctuation">{<!-- --></span>
           r <span class="token operator">=</span> <span class="token number">1e-6</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 求出角度</span>
        <span class="token keyword">double</span> theta <span class="token operator">=</span> <span class="token function">atan</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 求出最新比例覆盖点的rX</span>
        <span class="token keyword">double</span> rDistortedX <span class="token operator">=</span> horizontalStrength <span class="token operator">*</span> theta <span class="token operator">/</span> r<span class="token punctuation">;</span>
        <span class="token comment">// 求出最新比例覆盖点的rY</span>
        <span class="token keyword">double</span> rDistortedY <span class="token operator">=</span> verticalStrength <span class="token operator">*</span> theta <span class="token operator">/</span> r<span class="token punctuation">;</span>
        <span class="token comment">// 求出当前这个点使用原来哪个点映射</span>
        <span class="token keyword">double</span> dstX <span class="token operator">=</span> cx <span class="token operator">+</span> rDistortedX <span class="token operator">*</span> dx <span class="token operator">*</span> cx<span class="token punctuation">;</span>
        <span class="token keyword">double</span> dstY <span class="token operator">=</span> cy <span class="token operator">+</span> rDistortedY <span class="token operator">*</span> dy <span class="token operator">*</span> cy<span class="token punctuation">;</span>
        <span class="token comment">// 给map赋值</span>
        mapX<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>dstX<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mapY<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>dstY<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <br/>
    <h2>
     <a id="_238">
     </a>
     函数原型
    </h2>
    <pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">remap</span><span class="token punctuation">(</span>InputArray src<span class="token punctuation">,</span>
           OutputArray dst<span class="token punctuation">,</span>
           InputArray map1<span class="token punctuation">,</span>
           InputArray map2<span class="token punctuation">,</span>
           <span class="token keyword">int</span> interpolation<span class="token punctuation">,</span>
           <span class="token keyword">int</span> borderMode <span class="token operator">=</span> BORDER_CONSTANT<span class="token punctuation">,</span>
           <span class="token keyword">const</span> Scalar<span class="token operator">&amp;</span> borderValue <span class="token operator">=</span> <span class="token function">Scalar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <ul>
     <li>
      <p>
       参数一：InputArray类型的src，一般为cv::Mat;
      </p>
     </li>
     <li>
      <p>
       参数二：OutputArray类型的dst，目标图像。它的大小与map1相同，类型与src相同。
      </p>
     </li>
     <li>
      <p>
       参数三：InputArray类型的map1，它有两种可能的表示对象：表示点（x，y）的第一个映射或者表示CV_16SC2 , CV_32FC1或CV_32FC2类型的x值。
      </p>
     </li>
     <li>
      <p>
       参数四：InputArray类型的map2，它也有两种可能的表示对象，而且他是根据map1来确定表示哪种对象。若map1表示点（x，y）时，这个参数不代表任何值，否则，表示CV_16UC1 , rCV_32FC1类型的y值（第二个值）。
      </p>
     </li>
     <li>
      <p>
       参数五：int类型的interpolation，使用的插值方法；
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/4358e876dc204802b837c6af487d817c.png"/>
      </p>
     </li>
     <li>
      <p>
       参数六：int类型的borderMode，边界处理方式；
      </p>
     </li>
     <li>
      <p>
       参数七：Scalar类型的borderValue，重映射后，离群点的背景，需要broderMode设置为BORDER_CONSTRANT时才有效。（离群点：当图片大小为400x300，那么对应的map1和map2范围为0
       <sub>
        399、0
       </sub>
       299，小于0或者大于299的则为离散点，使用该颜色填充）;
      </p>
     </li>
    </ul>
    <br/>
    <h2>
     <a id="Demo_260">
     </a>
     Demo源码
    </h2>
    <pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token class-name">OpenCVManager</span><span class="token double-colon punctuation">::</span><span class="token function">testDistortingMirror</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token number">1</span></span></span>
    <span class="token comment">// 测试remap的Demo</span>
<span class="token comment">//    cv::Mat srcMat = cv::imread("D:/qtProject/openCVDemo/openCVDemo/modules/openCVManager/images/41.png");</span>
<span class="token comment">//    cv::Mat srcMat = cv::imread("D:/qtProject/openCVDemo/openCVDemo/modules/openCVManager/images/25.jpg");</span>
    cv<span class="token double-colon punctuation">::</span>Mat srcMat <span class="token operator">=</span> cv<span class="token double-colon punctuation">::</span><span class="token function">imread</span><span class="token punctuation">(</span><span class="token string">"D:/qtProject/openCVDemo/openCVDemo/modules/openCVManager/images/42.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>srcMat<span class="token punctuation">.</span>data <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    cv<span class="token double-colon punctuation">::</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token string">"srcMat"</span><span class="token punctuation">,</span> srcMat<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// remap的</span>
    <span class="token comment">/*
        插值方法：
        INTER_NEAREST        = 0,
        INTER_LINEAR         = 1,
        INTER_CUBIC          = 2,
        INTER_AREA           = 3,
        INTER_LANCZOS4       = 4,
        INTER_LINEAR_EXACT = 5,
        INTER_MAX            = 7,
        WARP_FILL_OUTLIERS   = 8,
        WARP_INVERSE_MAP     = 16
    */</span>
    cv<span class="token double-colon punctuation">::</span>Mat dstMat <span class="token operator">=</span> cv<span class="token double-colon punctuation">::</span><span class="token function">Mat</span><span class="token punctuation">(</span>srcMat<span class="token punctuation">.</span>rows<span class="token punctuation">,</span> srcMat<span class="token punctuation">.</span>cols<span class="token punctuation">,</span> srcMat<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token number">0</span></span></span>
    <span class="token comment">// 表示点的第一种</span>
    std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>cv<span class="token double-colon punctuation">::</span>Point2f<span class="token operator">&gt;</span> vectorPoints<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> <span class="token number">50</span><span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        vectorPoints<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>cv<span class="token double-colon punctuation">::</span><span class="token function">Point2f</span><span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    cv<span class="token double-colon punctuation">::</span><span class="token function">remap</span><span class="token punctuation">(</span>srcMat<span class="token punctuation">,</span> dstMat<span class="token punctuation">,</span> vectorPoints<span class="token punctuation">,</span> cv<span class="token double-colon punctuation">::</span><span class="token function">Mat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cv<span class="token double-colon punctuation">::</span>INTER_LINEAR<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token number">0</span></span></span>
    cv<span class="token double-colon punctuation">::</span>Mat <span class="token function">mapX</span><span class="token punctuation">(</span>srcMat<span class="token punctuation">.</span>rows<span class="token punctuation">,</span> srcMat<span class="token punctuation">.</span>cols<span class="token punctuation">,</span> CV_32F<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// x 方向</span>
    cv<span class="token double-colon punctuation">::</span>Mat <span class="token function">mapY</span><span class="token punctuation">(</span>srcMat<span class="token punctuation">.</span>rows<span class="token punctuation">,</span> srcMat<span class="token punctuation">.</span>cols<span class="token punctuation">,</span> CV_32F<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// y 方向</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> row <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> row<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> col <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> col <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> col<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>col <span class="token operator">&lt;</span> <span class="token number">25</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 0~24</span>
                mapX<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span> <span class="token operator">=</span> col <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
                mapY<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span> <span class="token operator">=</span> row<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>col <span class="token operator">&lt;</span> <span class="token number">50</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 25-49</span>
                mapX<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">49</span><span class="token punctuation">;</span>
                mapY<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span> <span class="token operator">=</span> row<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>col <span class="token operator">&lt;</span> <span class="token number">75</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 50~74</span>
                mapX<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span>
                mapY<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span> <span class="token operator">=</span> row<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 75~99</span>
                mapX<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">99</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token number">99</span> <span class="token operator">-</span> col<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
                mapY<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span> <span class="token operator">=</span> row<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    cv<span class="token double-colon punctuation">::</span><span class="token function">remap</span><span class="token punctuation">(</span>srcMat<span class="token punctuation">,</span> dstMat<span class="token punctuation">,</span> mapX<span class="token punctuation">,</span> mapY<span class="token punctuation">,</span> cv<span class="token double-colon punctuation">::</span>INTER_LINEAR<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
    cv<span class="token double-colon punctuation">::</span>Mat <span class="token function">mapX</span><span class="token punctuation">(</span>srcMat<span class="token punctuation">.</span>rows<span class="token punctuation">,</span> srcMat<span class="token punctuation">.</span>cols<span class="token punctuation">,</span> CV_32F<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// x 方向</span>
    cv<span class="token double-colon punctuation">::</span>Mat <span class="token function">mapY</span><span class="token punctuation">(</span>srcMat<span class="token punctuation">.</span>rows<span class="token punctuation">,</span> srcMat<span class="token punctuation">.</span>cols<span class="token punctuation">,</span> CV_32F<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// y 方向</span>
    <span class="token comment">// 这里显示原本的图</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> row <span class="token operator">&lt;</span> srcMat<span class="token punctuation">.</span>rows<span class="token punctuation">;</span> row<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> col <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> col <span class="token operator">&lt;</span> srcMat<span class="token punctuation">.</span>cols<span class="token punctuation">;</span> col<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            mapX<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span> <span class="token operator">=</span> col<span class="token punctuation">;</span>
            mapY<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span> <span class="token operator">=</span> row<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token number">0</span></span></span>
    <span class="token comment">// 使用径向畸变</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 这里a永远是长边，长边是纵向的</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">int</span> cols <span class="token operator">=</span> srcMat<span class="token punctuation">.</span>cols<span class="token punctuation">;</span>
            <span class="token keyword">int</span> rows <span class="token operator">=</span> srcMat<span class="token punctuation">.</span>rows<span class="token punctuation">;</span>
            <span class="token keyword">double</span> horizontalStrength <span class="token operator">=</span> <span class="token number">2.0f</span><span class="token punctuation">;</span>
            <span class="token keyword">double</span> verticalStrength  <span class="token operator">=</span> <span class="token number">2.0f</span><span class="token punctuation">;</span>
            <span class="token keyword">double</span> zoom <span class="token operator">=</span> <span class="token number">1.0</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> cx <span class="token operator">=</span> cols <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> cy <span class="token operator">=</span> rows <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> x <span class="token operator">&lt;</span> cols<span class="token punctuation">;</span> x<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> y <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> y<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// 先求的范围内的点离中心点的偏移比例</span>
                    <span class="token keyword">double</span> dx <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> cx<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1.0f</span> <span class="token operator">/</span> cx<span class="token punctuation">;</span>
                    <span class="token keyword">double</span> dy <span class="token operator">=</span> <span class="token punctuation">(</span>y <span class="token operator">-</span> cy<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1.0f</span> <span class="token operator">/</span> cy<span class="token punctuation">;</span>
                    <span class="token comment">// 求得中心点的距离</span>
                    <span class="token keyword">double</span> distance <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>dx <span class="token operator">*</span> dx <span class="token operator">+</span> dy <span class="token operator">*</span> dy<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 缩放半径</span>
                    <span class="token keyword">double</span> r <span class="token operator">=</span> distance <span class="token operator">/</span> zoom<span class="token punctuation">;</span>
                    <span class="token comment">// 后面除0操作，这里防止为0</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        r <span class="token operator">=</span> <span class="token number">1e-6</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token comment">// 求出角度</span>
                    <span class="token keyword">double</span> theta <span class="token operator">=</span> <span class="token function">atan</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 求出最新比例覆盖点的rX</span>
                    <span class="token keyword">double</span> rDistortedX <span class="token operator">=</span> horizontalStrength <span class="token operator">*</span> theta <span class="token operator">/</span> r<span class="token punctuation">;</span>
                    <span class="token comment">// 求出最新比例覆盖点的rY</span>
                    <span class="token keyword">double</span> rDistortedY <span class="token operator">=</span> verticalStrength <span class="token operator">*</span> theta <span class="token operator">/</span> r<span class="token punctuation">;</span>
                    <span class="token comment">// 求出当前这个点使用原来哪个点映射</span>
                    <span class="token keyword">double</span> dstX <span class="token operator">=</span> cx <span class="token operator">+</span> rDistortedX <span class="token operator">*</span> dx <span class="token operator">*</span> cx<span class="token punctuation">;</span>
                    <span class="token keyword">double</span> dstY <span class="token operator">=</span> cy <span class="token operator">+</span> rDistortedY <span class="token operator">*</span> dy <span class="token operator">*</span> cy<span class="token punctuation">;</span>
                    <span class="token comment">// 给map赋值</span>
                    mapX<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>dstX<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    mapY<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>dstY<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        cv<span class="token double-colon punctuation">::</span><span class="token function">remap</span><span class="token punctuation">(</span>srcMat<span class="token punctuation">,</span> dstMat<span class="token punctuation">,</span> mapX<span class="token punctuation">,</span> mapY<span class="token punctuation">,</span> cv<span class="token double-colon punctuation">::</span>INTER_LINEAR<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token number">1</span></span></span>
    <span class="token comment">// 使用径向畸变</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 这里a永远是长边，长边是纵向的</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">int</span> cols <span class="token operator">=</span> srcMat<span class="token punctuation">.</span>cols<span class="token punctuation">;</span>
            <span class="token keyword">int</span> rows <span class="token operator">=</span> srcMat<span class="token punctuation">.</span>rows<span class="token punctuation">;</span>
            <span class="token keyword">double</span> horizontalStrength <span class="token operator">=</span> <span class="token number">1.0f</span><span class="token punctuation">;</span>
            <span class="token keyword">double</span> verticalStrength <span class="token operator">=</span> <span class="token number">1.0f</span><span class="token punctuation">;</span>
            <span class="token keyword">double</span> zoom <span class="token operator">=</span> <span class="token number">1.0</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> cx <span class="token operator">=</span> cols <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> cy <span class="token operator">=</span> rows <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> x <span class="token operator">&lt;</span> cols<span class="token punctuation">;</span> x<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> y <span class="token operator">&lt;</span> rows<span class="token punctuation">;</span> y<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// 先求的范围内的点离中心点的偏移比例</span>
                    <span class="token keyword">double</span> dx <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> cx<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1.0f</span> <span class="token operator">/</span> cx<span class="token punctuation">;</span>
                    <span class="token keyword">double</span> dy <span class="token operator">=</span> <span class="token punctuation">(</span>y <span class="token operator">-</span> cy<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1.0f</span> <span class="token operator">/</span> cy<span class="token punctuation">;</span>
                    <span class="token comment">// 求得中心点的距离</span>
                    <span class="token keyword">double</span> distance <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>dx <span class="token operator">*</span> dx <span class="token operator">+</span> dy <span class="token operator">*</span> dy<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 缩放半径</span>
                    <span class="token keyword">double</span> r <span class="token operator">=</span> distance <span class="token operator">/</span> zoom<span class="token punctuation">;</span>
                    <span class="token comment">// 后面除0操作，这里防止为0</span>
                    <span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        r <span class="token operator">=</span> <span class="token number">1e-6</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token comment">// 求出角度</span>
                    <span class="token keyword">double</span> theta <span class="token operator">=</span> <span class="token function">atan</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 求出最新比例覆盖点的rX</span>
                    <span class="token keyword">double</span> rDistortedX <span class="token operator">=</span> horizontalStrength <span class="token operator">*</span> theta <span class="token operator">/</span> r<span class="token punctuation">;</span>
                    <span class="token comment">// 求出最新比例覆盖点的rY</span>
                    <span class="token keyword">double</span> rDistortedY <span class="token operator">=</span> verticalStrength <span class="token operator">*</span> theta <span class="token operator">/</span> r<span class="token punctuation">;</span>
                    <span class="token comment">// 求出当前这个点使用原来哪个点映射</span>
                    <span class="token keyword">double</span> dstX <span class="token operator">=</span> cx <span class="token operator">+</span> rDistortedX <span class="token operator">*</span> dx <span class="token operator">*</span> cx<span class="token punctuation">;</span>
                    <span class="token keyword">double</span> dstY <span class="token operator">=</span> cy <span class="token operator">+</span> rDistortedY <span class="token operator">*</span> dy <span class="token operator">*</span> cy<span class="token punctuation">;</span>
                    <span class="token comment">// 给map赋值</span>
                    mapX<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>dstX<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    mapY<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>dstY<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        cv<span class="token double-colon punctuation">::</span><span class="token function">remap</span><span class="token punctuation">(</span>srcMat<span class="token punctuation">,</span> dstMat<span class="token punctuation">,</span> mapX<span class="token punctuation">,</span> mapY<span class="token punctuation">,</span> cv<span class="token double-colon punctuation">::</span>INTER_LINEAR<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>

    cv<span class="token double-colon punctuation">::</span><span class="token function">imshow</span><span class="token punctuation">(</span><span class="token string">"dstMat"</span><span class="token punctuation">,</span> dstMat<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cv<span class="token double-colon punctuation">::</span><span class="token function">waitKey</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
<span class="token punctuation">}</span>
</code></pre>
    <br/>
    <h2>
     <a id="v1730_454">
     </a>
     工程模板v1.73.0
    </h2>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/1310ab5abf164957b99c1a53632c8289.png"/>
    </p>
    <br/>
    <h2>
     <a id="_459">
     </a>
     入坑
    </h2>
    <h3>
     <a id="map1map2_460">
     </a>
     入坑一：map1和map2映射崩溃
    </h3>
    <h4>
     <a id="_461">
     </a>
     问题
    </h4>
    <p>
     映射崩溃，图是100x100，那么坐标x和y都是0
     <sub>
      99，0
     </sub>
     99，但是运行崩溃。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/b97b78a68885407ea2856f09ad2446a8.png"/>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/5ce2c1d3661f4dc0bdba1fc164072862.png"/>
    </p>
    <h4>
     <a id="_467">
     </a>
     原因
    </h4>
    <p>
     定位到remap奔溃，发现map的类型是float不是double。
    </p>
    <h4>
     <a id="_469">
     </a>
     解决
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/62f28284cf53413eb3e7ba21b209557d.png"/>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/c560ec92bcf748769128b11a43a7f0ab.png"/>
    </p>
    <br/>
    <p>
     上一篇：《
     <a href="https://hpzwl.blog.csdn.net/article/details/143432922" rel="nofollow">
      OpenCV开发笔记（八十二）：两图拼接使用渐进色蒙版场景过渡缝隙
     </a>
     》
     <br/>
     下一篇：持续补充中…
    </p>
    <br/>
    <p>
     本文章博客地址：
     <a href="https://hpzwl.blog.csdn.net/article/details/146213444" rel="nofollow">
      https://hpzwl.blog.csdn.net/article/details/146213444
     </a>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
  <div class="blog-extension-box" id="blogExtensionBox" style="width:400px;margin:auto;margin-top:12px">
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f717132313439373933362f:61727469636c652f64657461696c732f313436323133343434" class_="artid" style="display:none">
 </p>
</div>


