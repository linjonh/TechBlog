---
layout: post
title: "react拖曳组件react-dnd的简单封装使用"
date: 2025-03-07 19:03:06 +0800
description: "React DnD 是一组 React 高阶组件，我们在使用的时候只需要将目标元素进行包裹，就可以实现目标元素具有拖动或接受拖动的功能。它将整个拖动的事件完整的描述了出来，这使得我们在使用的过程变得简单易用和扩展上有了无限的可能，在处理复杂拖曳和丰富需求的时候强烈建议使用它。由于项目中需要使用拖曳组件(需求:全局，跨组件，跨数据)，我选择了react-dnd。著作权归作者所有,转载或内容合作请联系作者。组件参数type.ts。组件MyDrag.ts。"
keywords: "react拖曳组件react-dnd的简单封装使用"
categories: ['面试题汇总与解析']
tags: ['课程设计', 'Vue', 'Sql', 'Springboot', 'Spring']
artid: "146102972"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146102972
    alt: "react拖曳组件react-dnd的简单封装使用"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146102972
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146102972
cover: https://bing.ee123.net/img/rand?artid=146102972
image: https://bing.ee123.net/img/rand?artid=146102972
img: https://bing.ee123.net/img/rand?artid=146102972
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     react拖曳组件react-dnd的简单封装使用
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <div>
     <div class="note-content">
      <h3>
       分享原因
      </h3>
      <p>
       由于项目中需要使用拖曳组件(需求:全局，跨组件，跨数据)，我选择了react-dnd
      </p>
      <h3>
       概念
      </h3>
      <p>
       React DnD 是一组 React 高阶组件，我们在使用的时候只需要将目标元素进行包裹，就可以实现目标元素具有拖动或接受拖动的功能。它将整个拖动的事件完整的描述了出来，这使得我们在使用的过程变得简单易用和扩展上有了无限的可能，在处理复杂拖曳和丰富需求的时候强烈建议使用它。
       <br/>
       官网
       <a href="https://links.jianshu.com/go?to=https%3A%2F%2Freact-dnd.github.io%2Freact-dnd%2F" rel="nofollow noopener noreferrer" target="_blank">
        https://react-dnd.github.io/react-dnd/
       </a>
      </p>
      <h3>
       基本
      </h3>
      <ul>
       <li>
        Item type：跟redux或其他组件一样，item用来描述拖动dom的数据对象，type用来标识一组可拖动和接收
       </li>
       <li>
        Backend：用来表现dom拖动现象，我使用了HTML5Backend
       </li>
       <li>
        Monitors：用来查询当前拖动状态(数据，dom，位置等)，强大的收集功能
       </li>
       <li>
        Connectors：用于Backend和组件状态之间的连接
       </li>
       <li>
        hook：useDrag 将组件作为可拖动的来源注册到dnd useDrop 将组件作为可接收拖动来源注册到dnd
       </li>
      </ul>
      <h3>
       使用方法
      </h3>
      <p>
       导入
       <br/>
       <code>
        npm install react-dnd react-dnd-html5-backend
       </code>
       <br/>
       初始化
      </p>
      <pre><code class="import">import { HTML5Backend } from 'react-dnd-html5-backend';
 &lt;DndProvider backend={HTML5Backend}&gt;
     ....
 &lt;/&gt;
</code></pre>
      <p>
       组件参数type.ts
      </p>
      <pre><code>export type DragProps = {
    name: string; //名称标记
    type: string; //暂用于标记拖拽类型,接收者和发送者一致
    role: string; //
    data: any; //绑定的数据用于拖曳后操作数据
    content: JSX.Element; //绑定的元素
    onDragFinished: Function; //拖动结束回调.
};

export type AcceptorProps = {
    name: string; //名称标记
    type: string; //暂用于标记拖拽类型,接收者和发送者一致
    role: string; //
    data: any; //绑定的数据用于拖曳后操作数据
    content: JSX.Element; //绑定的元素
    styleType: 'background' | 'border';
    // customStyle:{
    //     canDrop:string,
    //     isActive:string
    // }
    onHover: Function; //移入区域.
};
</code></pre>
      <p>
       组件MyDrag.ts
      </p>
      <pre><code>import { useDrag, useDrop } from 'react-dnd';
import { DragProps, AcceptorProps } from './type';
export const Dragger = function Dragger(option: DragProps) {
    const { name, data, type, onDragFinished } = option;
    const [{ isDragging }, drag] = useDrag(() =&gt; ({
        type: type,
        item: { name: name, data: data },
        end: (item, monitor, ...arg) =&gt; {
            console.log(arg);
            const dropResult = monitor.getDropResult();
            if (item &amp;&amp; dropResult) {
                console.log('source:', item);
                console.log('target:', dropResult);
            }
            if (onDragFinished) {
                onDragFinished(item, dropResult);
            }
        },
        collect: (monitor) =&gt; ({
            isDragging: monitor.isDragging(),
            handlerId: monitor.getHandlerId(),
        }),
    }));
    const opacity = isDragging ? 0.4 : 1;
    return (
        &lt;div
            ref={drag}
            role={option.role}
            style={<!-- -->{ opacity }}
            data-id={`${option.name}`}
        &gt;
            {option.content}
        &lt;/div&gt;
    );
};
export const Acceptor = (option: AcceptorProps) =&gt; {
    const { name, data, type, styleType, onHover } = option;
    const [{ canDrop, isOver }, drop] = useDrop(() =&gt; ({
        accept: type,
        drop: () =&gt; option,
        hover: () =&gt; {
            if (onHover) {
                onHover();
            }
        },
        collect: (monitor) =&gt; ({
            isOver: monitor.isOver(),
            canDrop: monitor.canDrop(),
        }),
    }));
    const isActive = canDrop &amp;&amp; isOver;
    let backgroundColor = '#222';
    let borderBottom = '0px solid rgba(31, 92, 206, 0)';
    if (isActive) {
        backgroundColor = 'rgba(64, 224, 208, 0.3)';
        borderBottom = '1px solid #26BD11';
    } else if (canDrop) {
        backgroundColor = 'rgba(100, 149, 277, 0.3)';
        borderBottom = '1px solid #2063AF';
    }
    return (
        &lt;div
            ref={drop}
            role={'Acceptor'}
            style={
                styleType === 'background'
                    ? { backgroundColor }
                    : { borderBottom }
            }
        &gt;
            {option.content}
        &lt;/div&gt;
    );
};
//同一list之间拖动
export const dragList = (
    list: Array&lt;any&gt;,
    crtIndex: number,
    willIndex: number,
) =&gt; {
    let targetItem = list[crtIndex];
    let delIndex = crtIndex &lt; willIndex ? crtIndex : crtIndex + 1;
    list.splice(willIndex, 0, targetItem);
    list.splice(delIndex, 1);

    return list;
};
//来自不同list之间拖动，1.删除原来  2不删除原来
export const dragToList = (
    list: Array&lt;any&gt;,
    targetList: Array&lt;any&gt;,
    crtIndex: number,
    willIndex: number,
    del: 1 | 2,
) =&gt; {
    let targetItem = list[crtIndex];
    targetList.splice(willIndex, 0, targetItem);
    if (del === 1) {
        list.splice(crtIndex, 1);
    }

    return { list, targetList };
};
</code></pre>
      <p>
       具体使用
      </p>
      <pre><code>import { Dragger, Acceptor, dragList } from '@/components/Drag';
//同列表之间拖曳
 handleDrag(crt: number, target: number) {
      conslog.log(dragList(newPanels, crt, target);)
    }
 renderDrag(item: ItemProps, children) {
    &lt;Acceptor
                    key={item.type}
                    name={item.title}
                    data={item}
                    type="xxx"
                    role="xxxAccept"
                    onHover={() =&gt; {}}
                    content={
                        &lt;Dragger
                            name={item.title}
                            data={item}
                            type="xxx"
                            role="xxxDrag"
                            content={children}
                            onDragFinished={(source: any, target: any) =&gt; {
                                console.log(source, target, '回调');
                                if (target) {
                                    this.handleDrag(
                                        source.data.sort,
                                        target.data.sort,
                                    );
                                }
                            }}
                        /&gt;
                    }
                    styleType="border"
                /&gt;
                
       }
</code></pre>
      <div class="image-package">
       <div class="image-container" style="max-width: 587px; max-height: 620px;">
        <div class="image-container-fill">
        </div>
        <div class="image-view">
         <img src="https://i-blog.csdnimg.cn/img_convert/8566be1a316c39803b67779ee69c85b5.webp?x-oss-process=image/format,png">
         </img>
        </div>
       </div>
       <div class="image-caption">
       </div>
      </div>
     </div>
     <div class="copyright">
      © 
   著作权归作者所有,转载或内容合作请联系作者
     </div>
    </div>
    <br/>
    <img src="https://img-blog.csdnimg.cn/direct/67c64049147741939b85489caefbb597.png" width="800px">
     <br/>
     <p style="font-weight: 700;">
      喜欢的朋友记得点赞、收藏、关注哦！！！
     </p>
    </img>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f6361696875617975616e342f:61727469636c652f64657461696c732f313436313032393732" class_="artid" style="display:none">
 </p>
</div>


