---
layout: post
title: "python移植到arm的单板"
date: 2025-01-13 15:07:48 +0800
description: "注：下文的CSU是我们一个嵌入式单板的名称。1 前言作者的话：本人非常喜欢python，一直梦想可以"
keywords: "arm python 模块"
categories: ['Python']
tags: ['嵌入式', 'Python', 'Arm']
artid: "78059102"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=78059102
    alt: "python移植到arm的单板"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=78059102
featuredImagePreview: https://bing.ee123.net/img/rand?artid=78059102
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     python移植到arm的单板
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     <strong>
      注：下文的CSU是我们一个嵌入式单板的名称。
     </strong>
    </p>
    <h2>
     1
     <strong>
      前言
     </strong>
    </h2>
    <p>
     作者的话：
    </p>
    <p>
     <span style="font-family:宋体">
      本人非常喜欢
     </span>
     python
     <span style="font-family:宋体">
      ，一直梦想可以移植到
     </span>
     <span style="font-family:Times New Roman">
      CSU
     </span>
     <span style="font-family:宋体">
      中。但是
     </span>
     <span style="font-family:Times New Roman">
      python
     </span>
     <span style="font-family:宋体">
      诞生之初并没有想到要应用在嵌入式领域，因此，
     </span>
     <span style="font-family:Times New Roman">
      python
     </span>
     <span style="font-family:宋体">
      的交叉编译比较复杂。
     </span>
     <span style="font-family:Times New Roman">
      python
     </span>
     <span style="font-family:宋体">
      的交叉编译花费了我一些时间进行摸索，这篇文章是在查阅了
     </span>
     <span style="font-family:Times New Roman">
      N
     </span>
     <span style="font-family:宋体">
      多资料，进行了
     </span>
     <span style="font-family:Times New Roman">
      N
     </span>
     <span style="font-family:宋体">
      多尝试后成功的，就在想彻底放弃的时候，
     </span>
     <span style="font-family:Times New Roman">
      NEVER GIVE UP
     </span>
     <span style="font-family:宋体">
      的信念让我进行前进，而恰恰是这前进的一步，转暗为明，相继研究出来
     </span>
     <span style="font-family:Times New Roman">
      CSU
     </span>
     <span style="font-family:宋体">
      的
     </span>
     <span style="font-family:Times New Roman">
      NFS
     </span>
     <span style="font-family:宋体">
      与
     </span>
     <span style="font-family:Times New Roman">
      CSU
     </span>
     <span style="font-family:宋体">
      的
     </span>
     <span style="font-family:Times New Roman">
      Python
     </span>
     <span style="font-family:宋体">
      ！这是让自己非常振奋的！
     </span>
    </p>
    <h2>
     2
     <strong>
      交叉编译
     </strong>
    </h2>
    <p>
     <span style="font-family:宋体">
      这里以
     </span>
     python2.7.6
     <span style="font-family:宋体">
      进行陈述。
     </span>
    </p>
    <p>
     <span style="font-family:宋体">
      下载
     </span>
     python
     <span style="font-family:宋体">
      的
     </span>
     <span style="font-family:Times New Roman">
      linux
     </span>
     <span style="font-family:宋体">
      版本源码包，解压到
     </span>
     <span style="font-family:Times New Roman">
      /opt
     </span>
     <span style="font-family:宋体">
      中。
     </span>
    </p>
    <h3>
     2.1
     <strong>
      <span style="font-family:黑体">
       更新虚拟机上的
      </span>
      python
      <span style="font-family:黑体">
       版本
      </span>
     </strong>
    </h3>
    <p>
     <span style="font-family:宋体">
      为了最大的稳定性，建议更新虚拟机上的版本与交叉编译的版本一致。由于下载的源码包版本肯定是最新的，因此，顺便更新一下虚拟机的
     </span>
     python
     <span style="font-family:宋体">
      版本也是一件好事。
     </span>
    </p>
    <p>
     传统三部曲。
    </p>
    <p>
     ./configure
    </p>
    <p>
     make
    </p>
    <p>
     make install
    </p>
    <h3>
     2.2
     <strong>
      <span style="font-family:黑体">
       配置
      </span>
      arm
      <span style="font-family:黑体">
       的
      </span>
      <span style="font-family:Arial">
       configure
      </span>
     </strong>
    </h3>
    <p>
     <span style="font-family:宋体">
      由于源码包需要生成
     </span>
     pc
     <span style="font-family:宋体">
      版的
     </span>
     <span style="font-family:Times New Roman">
      python
     </span>
     <span style="font-family:宋体">
      和
     </span>
     <span style="font-family:Times New Roman">
      arm
     </span>
     <span style="font-family:宋体">
      版的
     </span>
     <span style="font-family:Times New Roman">
      python
     </span>
     <span style="font-family:宋体">
      ，因此，需要隔离开，这个非常关键。
     </span>
    </p>
    <p>
     pc
     <span style="font-family:宋体">
      版采用原有路径，不改变。
     </span>
    </p>
    <p>
     arm
     <span style="font-family:宋体">
      则在源码包下
     </span>
    </p>
    <p>
     mkdir arm_build
    </p>
    <p>
     <span style="font-family:宋体">
      由于
     </span>
     configure
     <span style="font-family:宋体">
      会在当前目录下生成
     </span>
     <span style="font-family:Times New Roman">
      Makefile
     </span>
     <span style="font-family:宋体">
      等文件，因此，不能在源码包下直接
     </span>
     <span style="font-family:Times New Roman">
      configure
     </span>
     <span style="font-family:宋体">
      ，必须在
     </span>
     <span style="font-family:Times New Roman">
      arm_build
     </span>
     <span style="font-family:宋体">
      里执行。这点非常重要。
     </span>
    </p>
    <p>
     cd arm_build
    </p>
    <p>
    </p>
    <p>
     <span style="font-family:宋体">
      由于交叉编译中，需要明确如下两个变量的值，因此，这里必须人工定义。
     </span>
     ptmx
     <span style="font-family:宋体">
      就是虚拟串口的意思，由于我的单板以后要用到这个，因此，设为
     </span>
     <span style="font-family:Times New Roman">
      yes
     </span>
     <span style="font-family:宋体">
      。
     </span>
    </p>
    <p>
     <span style="font-family:宋体">
      设为
     </span>
     no
     <span style="font-family:宋体">
      一样是可以的。
     </span>
    </p>
    <p>
     echo ac_cv_file__dev_ptmx=yes &gt; config.site
    </p>
    <p>
     echo ac_cv_file__dev_ptc=yes &gt;&gt; config.site
    </p>
    <p>
     export CONFIG_SITE=config.site
    </p>
    <p>
    </p>
    <p>
     <span style="font-family:宋体">
      建好
     </span>
     arm
     <span style="font-family:宋体">
      版
     </span>
     <span style="font-family:Times New Roman">
      python
     </span>
     <span style="font-family:宋体">
      要安装到的文件夹。
     </span>
    </p>
    <p>
     arm_install=/opt/arm_python
    </p>
    <p>
     mkdir $arm_install
    </p>
    <p>
    </p>
    <p>
     configure
     <span style="font-family:宋体">
      如下：
     </span>
    </p>
    <p>
     ../configure --host=arm-none-linux-gnueabi --build=i686-linux-gnu --target=arm-none-linux-gnueabi --disable-ipv6 --prefix=$arm_install --enable-shared --silent
    </p>
    <p>
     <span style="font-family:宋体">
      其中，
     </span>
     arm
     <span style="font-family:宋体">
      的
     </span>
     <span style="font-family:Times New Roman">
      gcc
     </span>
     <span style="font-family:宋体">
      采用
     </span>
     <span style="font-family:Times New Roman">
      2011
     </span>
     <span style="font-family:宋体">
      版本；
     </span>
    </p>
    <p>
     <span style="font-family:宋体">
      由于
     </span>
     ipv6
     <span style="font-family:宋体">
      支持有问题，因此，必须关闭；
     </span>
    </p>
    <p>
     --silent
     <span style="font-family:宋体">
      去掉
     </span>
     <span style="font-family:Times New Roman">
      configure
     </span>
     <span style="font-family:宋体">
      过程中的垃圾信息，只输出
     </span>
     <span style="font-family:Times New Roman">
      warning
     </span>
     <span style="font-family:宋体">
      及以上的关键信息，我特别喜欢这个。
     </span>
    </p>
    <p>
     --build
     <span style="font-family:宋体">
      是必须填的，怎么知道这个
     </span>
     <span style="font-family:Times New Roman">
      build
     </span>
     <span style="font-family:宋体">
      信息呢，最简单的方法就是
     </span>
    </p>
    <p>
     gcc –v
    </p>
    <p>
     <span style="font-family:宋体">
      里面会有
     </span>
     gcc
     <span style="font-family:宋体">
      的
     </span>
     <span style="font-family:Times New Roman">
      configure
     </span>
     <span style="font-family:宋体">
      信息，里面就有
     </span>
     <span style="font-family:Times New Roman">
      --build
     </span>
     <span style="font-family:宋体">
      的信息，复制过来就万无一失。
     </span>
    </p>
    <p>
     --target
     <span style="font-family:宋体">
      其实可以不写，系统可以猜出来的，但这里还是写上。
     </span>
    </p>
    <h3>
     2.3
     <strong>
      pgen
      <span style="font-family:黑体">
       准备
      </span>
     </strong>
    </h3>
    <p>
     这个非常关键。
    </p>
    <p>
     <span style="font-family:宋体">
      在
     </span>
     configure
     <span style="font-family:宋体">
      之后
     </span>
     <span style="font-family:Times New Roman">
      make
     </span>
     <span style="font-family:宋体">
      或
     </span>
     <span style="font-family:Times New Roman">
      make Parsr/pgen
     </span>
     <span style="font-family:宋体">
      。
     </span>
    </p>
    <p>
     <span style="font-family:宋体">
      可以在
     </span>
     arm_build
     <span style="font-family:宋体">
      的
     </span>
     <span style="font-family:Times New Roman">
      Parser
     </span>
     <span style="font-family:宋体">
      文件夹里发现
     </span>
     <span style="font-family:Times New Roman">
      pgen
     </span>
     <span style="font-family:宋体">
      这个执行文件，它是
     </span>
     <span style="font-family:Times New Roman">
      python
     </span>
     <span style="font-family:宋体">
      的语法分析器之类东西，但问题来了。
     </span>
    </p>
    <p>
     <span style="font-family:宋体">
      这个东西是不能用的，因为是交叉编译版本的
     </span>
     pgen
     <span style="font-family:宋体">
      ，在虚拟机下用不了。
     </span>
    </p>
    <p>
     最简单的解决方法如下：
    </p>
    <p>
     回到源码包路径
    </p>
    <p>
     cd ../
    </p>
    <p>
     <span style="font-family:宋体">
      生成
     </span>
     pc
     <span style="font-family:宋体">
      版本的
     </span>
     <span style="font-family:Times New Roman">
      pgen
     </span>
    </p>
    <p>
     make Parser/pgen
    </p>
    <p>
     <span style="font-family:宋体">
      复制到
     </span>
     arm_build
     <span style="font-family:宋体">
      的
     </span>
     <span style="font-family:Times New Roman">
      Parser
     </span>
     <span style="font-family:宋体">
      里面
     </span>
    </p>
    <p>
     cd arm_build
    </p>
    <p>
     cp ../Parser/pgen Parser
    </p>
    <p>
     下面这一步非常关键而且非常巧妙
    </p>
    <p>
     touch –t 12312359 Parser/pgen
    </p>
    <p>
     <span style="font-family:宋体">
      意思是：将
     </span>
     pgen
     <span style="font-family:宋体">
      文件的日期改为今年的最后一分钟生成的。
     </span>
    </p>
    <p>
     为什么需要这一步？
    </p>
    <p>
     很简单：
    </p>
    <p>
     <span style="font-family:宋体">
      因为，
     </span>
     arm
     <span style="font-family:宋体">
      版
     </span>
     <span style="font-family:Times New Roman">
      python
     </span>
     <span style="font-family:宋体">
      在
     </span>
     <span style="font-family:Times New Roman">
      make
     </span>
     <span style="font-family:宋体">
      时，会生成它的
     </span>
     <span style="font-family:Times New Roman">
      pgen
     </span>
     <span style="font-family:宋体">
      ，就会把刚才复制过来的给替换掉了，改了未来的时间，就会忽略跳过，非常巧妙的技巧！
     </span>
    </p>
    <h3>
     2.4
     <strong>
      make &amp;&amp; make install
     </strong>
    </h3>
    <p>
     <span style="font-family:宋体">
      现在可以
     </span>
     make
     <span style="font-family:宋体">
      （或
     </span>
     <span style="font-family:Times New Roman">
      make python
     </span>
     <span style="font-family:宋体">
      ）了。
     </span>
    </p>
    <p>
     <span style="font-family:宋体">
      我喜欢加上
     </span>
     --silent
     <span style="font-family:宋体">
      ，这样可以减少很多垃圾信息。
     </span>
    </p>
    <p>
     make
     <span style="font-family:宋体">
      完成后，注意：
     </span>
    </p>
    <p>
     <span style="font-family:宋体">
      这里，使用
     </span>
     make install
     <span style="font-family:宋体">
      一般会出错，显示缺失
     </span>
     <span style="font-family:Times New Roman">
      _struct
     </span>
     <span style="font-family:宋体">
      的类型错误。
     </span>
    </p>
    <p>
     <span style="font-family:宋体">
      使用
     </span>
     make -i install
     <span style="font-family:宋体">
      才能搞定。
     </span>
    </p>
    <p>
     -i
     <span style="font-family:宋体">
      就是
     </span>
     ignore
     <span style="font-family:宋体">
      错误的意思，继续前进。这里可能的问题是：前面需要某模块，但是
     </span>
     <span style="font-family:Times New Roman">
      install
     </span>
     <span style="font-family:宋体">
      中却在后面才安装这个模块，导致了前面找不到模块的错误，其实，整个完成后，是完整的。
     </span>
    </p>
    <p>
     <span style="font-family:宋体">
      这一招对这种时序问题，或
     </span>
     install
     <span style="font-family:宋体">
      中出现的时序问题比较难解决时，能帮上大忙。
     </span>
    </p>
    <p>
     <span style="font-family:宋体">
      现在，查看
     </span>
     /opt/arm_python
     <span style="font-family:宋体">
      这个安装目录，可以发现已经有相关
     </span>
     <span style="font-family:Times New Roman">
      python
     </span>
     <span style="font-family:宋体">
      文件了。
     </span>
    </p>
    <h2>
     3
     <strong>
      第三方库
     </strong>
    </h2>
    <p>
     python
     <span style="font-family:宋体">
      容易使用的一大特点就是自由开放的库很多，官方不可能全部纳入自己的标准库中，因此，安装自己需要的第三方库是必要的。
     </span>
    </p>
    <p>
     举例：
    </p>
    <p>
     <span style="font-family:宋体">
      这里安装第三方
     </span>
     xlrd
     <span style="font-family:宋体">
      库，这个库可以非常方便的读取
     </span>
     <span style="font-family:Times New Roman">
      excel
     </span>
     <span style="font-family:宋体">
      文件的内容，即使不在
     </span>
     <span style="font-family:Times New Roman">
      windows
     </span>
     <span style="font-family:宋体">
      下，即使没有安装
     </span>
     <span style="font-family:Times New Roman">
      excel
     </span>
     <span style="font-family:宋体">
      ，也可以，而且速度非常的快。
     </span>
    </p>
    <p>
     <span style="font-family:宋体">
      下载源码包后解压，
     </span>
     cd
     <span style="font-family:宋体">
      到那个路径下。
     </span>
    </p>
    <p>
     python setup.py install
    </p>
    <p>
     <span style="font-family:宋体">
      就可以完成第三方库的安装了。这里的
     </span>
     install
     <span style="font-family:宋体">
      其实就是包括
     </span>
     <span style="font-family:Times New Roman">
      build
     </span>
     <span style="font-family:宋体">
      和
     </span>
     <span style="font-family:Times New Roman">
      install
     </span>
     <span style="font-family:宋体">
      。
     </span>
    </p>
    <p>
     对于虚拟机，会安装到
    </p>
    <p>
     /usr/local/lib/python3.3/site-packages
    </p>
    <p>
     <span style="font-family:宋体">
      第三方库基本默认安装在
     </span>
     site-packages
     <span style="font-family:宋体">
      里。
     </span>
    </p>
    <p>
    </p>
    <p>
     <span style="font-family:宋体">
      那如何安装到我们的
     </span>
     arm
     <span style="font-family:宋体">
      的
     </span>
     <span style="font-family:Times New Roman">
      python
     </span>
     <span style="font-family:宋体">
      里呢。
     </span>
    </p>
    <p>
     很简单：
    </p>
    <p>
     python setup.py install --prefix=/opt/arm_python
    </p>
    <p>
     (
     <span style="font-family:宋体">
      默认情况下，这个前缀为
     </span>
     <span style="font-family:Times New Roman">
      /usr/local/)
     </span>
    </p>
    <p>
     <span style="font-family:宋体">
      如果没有正确安装，当程序需要这个库时，会报找不到模块的
     </span>
     error
     <span style="font-family:宋体">
      。
     </span>
    </p>
    <h2>
     4
     <strong>
      应用
     </strong>
    </h2>
    <p>
     <span style="font-family:宋体">
      由于
     </span>
     python
     <span style="font-family:宋体">
      的库文件很大，直接拷贝到
     </span>
     <span style="font-family:Times New Roman">
      CSU
     </span>
     <span style="font-family:宋体">
      是不现实的。裁剪库也很麻烦，而且消弱了功能。因此，这里采用
     </span>
     <span style="font-family:Times New Roman">
      NFS
     </span>
     <span style="font-family:宋体">
      。
     </span>
     <span style="font-family:Times New Roman">
      python
     </span>
     <span style="font-family:宋体">
      的
     </span>
     <span style="font-family:Times New Roman">
      bin
     </span>
     <span style="font-family:宋体">
      、
     </span>
     <span style="font-family:Times New Roman">
      lib
     </span>
     <span style="font-family:宋体">
      等文件，以及自己编写的代码文件都放在虚拟机上。
     </span>
     <span style="font-family:Times New Roman">
      CSU
     </span>
     <span style="font-family:宋体">
      通过
     </span>
     <span style="font-family:Times New Roman">
      NFS
     </span>
     <span style="font-family:宋体">
      使用
     </span>
     <span style="font-family:Times New Roman">
      python
     </span>
     <span style="font-family:宋体">
      即可。
     </span>
    </p>
    <p>
     CSU
     <span style="font-family:宋体">
      侧：
     </span>
    </p>
    <p>
     mkdir /mnt/python
    </p>
    <p>
     mount –o nolock 10.9.102.23:/opt/arm_python /mnt/python
    </p>
    <p>
     <span style="font-family:宋体">
      在
     </span>
     /etc/profile
     <span style="font-family:宋体">
      里
     </span>
    </p>
    <p>
     <span style="font-family:宋体">
      在
     </span>
     export PATH
     <span style="font-family:宋体">
      一行后面加入
     </span>
    </p>
    <p>
     :/mnt/python/bin
    </p>
    <p>
     <span style="font-family:宋体">
      在
     </span>
     export LD_LIBRARY_PATH
     <span style="font-family:宋体">
      一行后面加入
     </span>
     <span style="font-family:Times New Roman">
      :/mnt/python/lib
     </span>
    </p>
    <p>
    </p>
    <p>
     <span style="font-family:宋体">
      这样就可以使用
     </span>
     python
     <span style="font-family:宋体">
      了。
     </span>
    </p>
    <p>
     python –V
     <span style="font-family:宋体">
      就可以看到
     </span>
     <span style="font-family:Times New Roman">
      python
     </span>
     <span style="font-family:宋体">
      的版本信息了。
     </span>
    </p>
    <p>
     python
     <span style="font-family:宋体">
      回车后
     </span>
    </p>
    <p>
     <span style="font-family:宋体">
      就可以进入
     </span>
     python
     <span style="font-family:宋体">
      的
     </span>
     <span style="font-family:Times New Roman">
      shell
     </span>
     <span style="font-family:宋体">
      了，可以在命令中输入
     </span>
     <span style="font-family:Times New Roman">
      python
     </span>
     <span style="font-family:宋体">
      语句。
     </span>
    </p>
    <p>
     <span style="font-family:宋体">
      由于这个
     </span>
     CSU
     <span style="font-family:宋体">
      上的
     </span>
     <span style="font-family:Times New Roman">
      python
     </span>
     <span style="font-family:宋体">
      的
     </span>
     <span style="font-family:Times New Roman">
      shell
     </span>
     <span style="font-family:宋体">
      非常不好用，打错字无法修正，⊙﹏⊙
     </span>
     <span style="font-family:Times New Roman">
      b
     </span>
     <span style="font-family:宋体">
      汗，因此，我一般都在虚拟机上写代码，
     </span>
     <span style="font-family:Times New Roman">
      CSU
     </span>
     <span style="font-family:宋体">
      上运行就行了。（注，
     </span>
     <span style="font-family:Times New Roman">
      python
     </span>
     <span style="font-family:宋体">
      的
     </span>
     <span style="font-family:Times New Roman">
      shell
     </span>
     <span style="font-family:宋体">
      退出方式是输入
     </span>
     <span style="font-family:Times New Roman">
      exit()
     </span>
     <span style="font-family:宋体">
      指令）
     </span>
    </p>
    <p>
     例如：
    </p>
    <p>
     mkdir /opt/arm_python/code
    </p>
    <p>
     <span style="font-family:宋体">
      在
     </span>
     code
     <span style="font-family:宋体">
      写入
     </span>
     <span style="font-family:Times New Roman">
      helloworld.py
     </span>
     <span style="font-family:宋体">
      的文件
     </span>
    </p>
    <p>
     <span style="font-family:宋体">
      在
     </span>
     CSU
     <span style="font-family:宋体">
      中：
     </span>
    </p>
    <p>
     python /mnt/python/code/helloworld.py
    </p>
    <p>
     就可以看到输出了。
    </p>
    <h2>
     5
     <strong>
      python3
      <span style="font-family:宋体">
       的移植
      </span>
     </strong>
    </h2>
    <p>
     <span style="font-family:宋体">
      同
     </span>
     python2
     <span style="font-family:宋体">
      。
     </span>
    </p>
    <p>
     <span style="font-family:宋体">
      虚拟机是支持同时安装两个版本的
     </span>
     python
     <span style="font-family:宋体">
      的，它们的路径会通过版本号进行区分。
     </span>
    </p>
    <p>
     arm
     <span style="font-family:宋体">
      版的
     </span>
     <span style="font-family:Times New Roman">
      python
     </span>
     <span style="font-family:宋体">
      也一样，在
     </span>
     <span style="font-family:Times New Roman">
      /opt/arm_python
     </span>
     <span style="font-family:宋体">
      会进行版本的区分。
     </span>
    </p>
    <p>
     <span style="font-family:宋体">
      默认
     </span>
     python
     <span style="font-family:宋体">
      链接指向
     </span>
     <span style="font-family:Times New Roman">
      python2
     </span>
     <span style="font-family:宋体">
      ，如果需要更改，
     </span>
     <span style="font-family:Times New Roman">
      rm
     </span>
     <span style="font-family:宋体">
      后
     </span>
     <span style="font-family:Times New Roman">
      ln
     </span>
     <span style="font-family:宋体">
      到
     </span>
     <span style="font-family:Times New Roman">
      python3
     </span>
     <span style="font-family:宋体">
      即可。
     </span>
    </p>
    <h2>
     6
     <strong>
      懒人时刻
     </strong>
    </h2>
    <p>
     又是将书变薄的时候了，以下是精华，即自动化交叉编译脚本。
    </p>
    <p>
    </p>
    <div>
     <pre><code class="language-plain">#prepare
echo "prepare stage"
arm_install=/opt/arm_python
arm_build=`pwd`/arm_build
mkdir $arm_build
mkdir $arm_install
cd `pwd`
#arm comfigure
echo "arm confiure stage"
cd $arm_build
echo ac_cv_file__dev_ptmx=yes &gt; config.site
echo ac_cv_file__dev_ptc=yes &gt;&gt; config.site
export CONFIG_SITE=config.site
../configure --host=arm-none-linux-gnueabi --build=i686-linux-gnu --target=arm-none-linux-gnueabi --disable-ipv6 --prefix=$arm_install --enable-shared --silent

#pc pgen
echo "pc pgen stage"
cd - 
./configure --silent
for args in $@
do
if [ $args = "all" ];then
make --silent &amp;&amp; make install --silent
break
fi
done
make Parser/pgen --silent
cd -
cp ../Parser/pgen Parser
#change the pgen time,
# or else the cross compile will replace this pc version pgen. important!!
touch -t 12312359 Parser/pgen

#make
echo "make stage"
make python --silent &amp;&amp; make -i install

#make it smaller
#arm-none-linux-gnueabi-strip -s $arm_install/bin/python3.3
exit 0
</code></pre>
    </div>
    <br/>
    <p>
    </p>
    <p>
    </p>
    <p>
     使用方法：
    </p>
    <p>
     chmod +x arm_python
    </p>
    <p>
     <span style="font-family:宋体">
      复制到源码包路径下（或
     </span>
     ln
     <span style="font-family:宋体">
      到源码包路径下）；
     </span>
    </p>
    <p>
     <span style="font-family:宋体">
      执行
     </span>
     ./arm_python
     <span style="font-family:宋体">
      即可。
     </span>
    </p>
    <p>
     <span style="font-family:宋体">
      默认安装在
     </span>
     /opt/arm_python
     <span style="font-family:宋体">
      里。
     </span>
    </p>
    <p>
     <span style="font-family:宋体">
      （当加入参数
     </span>
     all
     <span style="font-family:宋体">
      时，脚本会顺便更新虚拟机上的
     </span>
     <span style="font-family:Times New Roman">
      python
     </span>
     <span style="font-family:宋体">
      ）
     </span>
    </p>
    <p>
    </p>
    <h2>
     7
     <strong>
      附录（性能测评）
     </strong>
    </h2>
    <h3>
     7.1
     <strong>
      <span style="font-family:黑体">
       不同
      </span>
      cpu
      <span style="font-family:黑体">
       与系统的对比
      </span>
     </strong>
    </h3>
    <p>
     执行如下测评语句：
    </p>
    <p>
     import time
    </p>
    <p>
     start_time=time.clock()
    </p>
    <p>
     for i in range(1000):
    </p>
    <p>
     print('good')
    </p>
    <p>
     end_time = time.clock()
    </p>
    <p>
     print('total time is ', end_time-start_time)
    </p>
    <p>
    </p>
    <p>
     结果对比：
    </p>
    <table>
     <tbody>
      <tr>
       <td>
        <p>
         CPU
        </p>
       </td>
       <td>
        <p>
         OS
        </p>
       </td>
       <td>
        <p>
         Time
        </p>
       </td>
      </tr>
      <tr>
       <td>
        <p>
         奔腾
         <span style="font-family:Times New Roman">
          E6700
         </span>
         <span style="font-family:宋体">
          （酷睿
         </span>
         <span style="font-family:Times New Roman">
          core2
         </span>
         <span style="font-family:宋体">
          ）
         </span>
        </p>
       </td>
       <td>
        <p>
         Windows7
        </p>
       </td>
       <td>
        <p>
         0.03s
        </p>
       </td>
      </tr>
      <tr>
       <td>
        <p>
         奔腾
         <span style="font-family:Times New Roman">
          E6700
         </span>
         <span style="font-family:宋体">
          （酷睿
         </span>
         <span style="font-family:Times New Roman">
          core2
         </span>
         <span style="font-family:宋体">
          ）
         </span>
        </p>
       </td>
       <td>
        <p>
         Virtual Ubuntu
        </p>
       </td>
       <td>
        <p>
         0.01s
        </p>
       </td>
      </tr>
      <tr>
       <td>
        <p>
         AMD
         <span style="font-family:宋体">
          炫龙双核
         </span>
        </p>
       </td>
       <td>
        <p>
         Ubuntu
        </p>
       </td>
       <td>
        <p>
         0.003s
        </p>
       </td>
      </tr>
      <tr>
       <td>
        <p>
         AT9260
         <span style="font-family:宋体">
          （
         </span>
         <span style="font-family:Times New Roman">
          Arm9
         </span>
         <span style="font-family:宋体">
          ）
         </span>
        </p>
       </td>
       <td>
        <p>
         Linux
        </p>
       </td>
       <td>
        <p>
         0.6s
        </p>
       </td>
      </tr>
      <tr>
       <td>
        <p>
         AM335
         <span style="font-family:宋体">
          （
         </span>
         <span style="font-family:Times New Roman">
          A8)
         </span>
        </p>
       </td>
       <td>
        <p>
         Linux
        </p>
       </td>
       <td>
        <p>
         0.18s
        </p>
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     <br/>
    </p>
    <p>
     <span style="font-family:宋体">
      结果在我的预测范围里，即
     </span>
     CSU
     <span style="font-family:宋体">
      的处理能力只有主流台式
     </span>
     <span style="font-family:Times New Roman">
      2
     </span>
     <span style="font-family:宋体">
      核
     </span>
     <span style="font-family:Times New Roman">
      cpu
     </span>
     <span style="font-family:宋体">
      的几百分之一，属于可以接受的范围。
     </span>
    </p>
    <p>
     <span style="font-family:宋体">
      （有趣的是，
     </span>
     ubuntu
     <span style="font-family:宋体">
      的执行速度远高于
     </span>
     <span style="font-family:Times New Roman">
      windows
     </span>
     <span style="font-family:宋体">
      ！
     </span>
     <span style="font-family:Times New Roman">
      python
     </span>
     <span style="font-family:宋体">
      虽然是跨平台语言，但是在
     </span>
     <span style="font-family:Times New Roman">
      linux
     </span>
     <span style="font-family:宋体">
      环境下，却有明显的优势）
     </span>
    </p>
    <p>
     <span style="font-family:宋体">
      另一个将数据字典自动转为
     </span>
     XML
     <span style="font-family:宋体">
      的程序对比：
     </span>
    </p>
    <p>
     win7:0.35s
    </p>
    <p>
     A8:8s
    </p>
    <h3>
     7.2
     <strong>
      python
      <span style="font-family:黑体">
       与
      </span>
      <span style="font-family:Arial">
       C
      </span>
      <span style="font-family:黑体">
       的对比
      </span>
     </strong>
    </h3>
    <p>
     <span style="font-family:宋体">
      执行
     </span>
     1000
     <span style="font-family:宋体">
      次相加与输出：
     </span>
    </p>
    <p>
     C
     <span style="font-family:宋体">
      语言代码如下：
     </span>
    </p>
    <p>
     1 #include &lt;stdio.h&gt;
    </p>
    <p>
     2 #include &lt;sys/time.h&gt;
    </p>
    <p>
     3 void main(void){
     <!-- -->
    </p>
    <p>
     4         struct timeval start,end;
    </p>
    <p>
     5         gettimeofday(&amp;start,NULL);
    </p>
    <p>
     6         int i,sum=0;
    </p>
    <p>
     7         for(i=0;i&lt;1000;++i){
     <!-- -->
    </p>
    <p>
     8                 sum+=i;
    </p>
    <p>
     9                 printf("%d\n",sum);
    </p>
    <p>
     10         }
    </p>
    <p>
     11         gettimeofday(&amp;end,NULL);
    </p>
    <p>
     12         printf("total time is %d\n",1000000*(end.tv_sec-start.tv_sec)+end.tv    _usec-start.tv_usec);}
    </p>
    <p>
     Python
     <span style="font-family:宋体">
      代码如下：
     </span>
    </p>
    <p>
     1 import time
    </p>
    <p>
     2 start_time = time.clock()
    </p>
    <p>
     3 sum=0
    </p>
    <p>
     4 for i in range(1000):
    </p>
    <p>
     5     sum=i+sum
    </p>
    <p>
     6     print(sum)
    </p>
    <p>
     7 end_time = time.clock()
    </p>
    <p>
     8 print('time is ',end_time-start_time )
    </p>
    <p>
     C
     <span style="font-family:宋体">
      一共使用：
     </span>
     <span style="font-family:Times New Roman">
      34
     </span>
     <span style="font-family:宋体">
      毫秒；
     </span>
    </p>
    <p>
     Python
     <span style="font-family:宋体">
      一共使用：
     </span>
     <span style="font-family:Times New Roman">
      180
     </span>
     <span style="font-family:宋体">
      毫秒。
     </span>
    </p>
    <p>
     Python
     <span style="font-family:宋体">
      为
     </span>
     <span style="font-family:Times New Roman">
      C
     </span>
     <span style="font-family:宋体">
      速度的
     </span>
     <span style="font-family:Times New Roman">
      20%
     </span>
     <span style="font-family:宋体">
      左右，属于可以接受的范围内。
     </span>
    </p>
   </div>
  </div>
 </article>
 <p alt="687474:70733a2f2f626c6f672e6373646e2e6e65742f797977373934:2f61727469636c652f64657461696c732f3738303539313032" class_="artid" style="display:none">
 </p>
</div>


