---
layout: post
title: "物联网esp8266-物联网平台-微信小程序的智能环境监测系统"
date: 2024-12-02 15:11:58 +0800
description: "物联网平台实现智能监测室内环境_微信小程序和巴法云的api"
keywords: "微信小程序和巴法云的api"
categories: ['物联网']
tags: ['物联网', '微信小程序', '嵌入式硬件', 'Iot']
artid: "125010733"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=125010733
    alt: "物联网esp8266-物联网平台-微信小程序的智能环境监测系统"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=125010733
featuredImagePreview: https://bing.ee123.net/img/rand?artid=125010733
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     【物联网】esp8266 + 物联网平台 + 微信小程序的智能环境监测系统
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-tomorrow-night" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <div class="toc">
     <h4>
      文章目录
     </h4>
     <ul>
      <li>
       <a href="#_3" rel="nofollow">
        成果演示
       </a>
      </li>
      <li>
       <a href="#_10" rel="nofollow">
        项目介绍
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#_16" rel="nofollow">
          原理
         </a>
        </li>
        <li>
         <a href="#__NodeMcu_27" rel="nofollow">
          设备端 ------ NodeMcu
         </a>
        </li>
        <li>
         <a href="#___45" rel="nofollow">
          物联网平台 ----- 巴法云
         </a>
        </li>
        <li>
         <ul>
          <li>
           <a href="#TCP_49" rel="nofollow">
            与设备端建立TCP连接，实现订阅/发布
           </a>
          </li>
          <li>
           <ul>
            <li>
             <a href="#_51" rel="nofollow">
              设备端发送信息到巴法云
             </a>
            </li>
            <li>
             <a href="#_55" rel="nofollow">
              设备端从巴法云接收信息
             </a>
            </li>
           </ul>
          </li>
          <li>
           <a href="#HTTP_59" rel="nofollow">
            客户端发送HTTP请求，实现订阅/发布
           </a>
          </li>
          <li>
           <ul>
            <li>
             <a href="#_61" rel="nofollow">
              小程序发送信息到巴法云
             </a>
            </li>
            <li>
             <a href="#_64" rel="nofollow">
              小程序从巴法云接收信息
             </a>
            </li>
           </ul>
          </li>
         </ul>
        </li>
        <li>
         <a href="#___68" rel="nofollow">
          客户端 ----- 微信小程序
         </a>
        </li>
        <li>
         <ul>
          <li>
           <a href="#_70" rel="nofollow">
            页面设计与布局
           </a>
          </li>
          <li>
           <a href="#_77" rel="nofollow">
            数据实时更新
           </a>
          </li>
          <li>
           <a href="#_83" rel="nofollow">
            边界情况界定
           </a>
          </li>
          <li>
           <a href="#_86" rel="nofollow">
            警戒阈值设置
           </a>
          </li>
         </ul>
        </li>
       </ul>
      </li>
      <li>
       <a href="#_95" rel="nofollow">
        结语
       </a>
      </li>
     </ul>
    </div>
    <p>
    </p>
    <h2>
     <a id="_3">
     </a>
     成果演示
    </h2>
    <img src="https://i-blog.csdnimg.cn/blog_migrate/5e186df85597667a9249d466dfe4ef06.png" width="90%">
     <p>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/b3287fb4edd6defecd47b0e452c259e8.jpeg"/>
     </p>
     <h2>
      <a id="_10">
      </a>
      项目介绍
     </h2>
     <p>
      本项目《基于物联网平台的室内环境监测系统》，大致课分为
      <strong>
       三个部分
      </strong>
      进行完成，框架图如下：
     </p>
     <img src="https://i-blog.csdnimg.cn/blog_migrate/56b6d0686d850483680ff56fe12506ec.png" width="80%">
      <h3>
       <a id="_16">
       </a>
       原理
      </h3>
      <p>
       <strong>
        传统物联网项目
       </strong>
       ：
      </p>
      <img src="https://i-blog.csdnimg.cn/blog_migrate/7c393ad446cc26f0904e43efe848ecb9.png" width="90%">
       <p>
        这个方法适用企业或工作室等
        <strong>
         体量稍大
        </strong>
        的团体使用，优点是
        <strong>
         保密和安全
        </strong>
        。具体参照阿里云物联网平台，本文主要介绍的还是下面的方法。
       </p>
       <p>
        <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/419f0aab490b158433a2afd0ec6ca7fb.png"/>
       </p>
       <p>
        从图中可以看出，巴法云物联网平台帮助我们省略了一些繁琐的服务器部署及后端部署，让我们可以
        <code>
         通过巴法云官方api
        </code>
        专注于设备端与客户端的数据上传与接收。
       </p>
       <h3>
        <a id="__NodeMcu_27">
        </a>
        设备端 ------ NodeMcu
       </h3>
       <img src="https://i-blog.csdnimg.cn/blog_migrate/a6f20c80008b97ba27682481a167a218.png" width="90%">
        <p>
         NodeMcu是一块基于esp8266 - 12F的开发板，使用Audrino开发。
        </p>
        <p>
         特找来原理图。需特别注意图中
         <code>
          3V3
         </code>
         和
         <code>
          Vin输出5V
         </code>
         。因为有些模块如
         <code>
          CH20甲醛模块、PMS9000空气质量模块
         </code>
         都需要5V电压驱动。
        </p>
        <p>
         <strong>
          温馨提醒
         </strong>
         ：es8266做主控无法驱动舵机，即使提供5V电压也不行，因为电流过小。一开始踩到坑里了测试以为无法输出5V电压。
        </p>
        <ul>
         <li>
          使用 Audrino 开发
         </li>
         <li>
          通过WiFi模块上传数据至物联云平台，完成数据采集、存储、上传。
         </li>
         <li>
          使用模块
          <br/>
          DHT11 温湿度模块，BH1750 光照模块，CH20 甲醛模块，PMS9000 空气质量模块，SGP30二氧化碳模块
         </li>
         <li>
          实现实时查询数据、发出控制指令等应用。
         </li>
         <li>
          实现了室内温湿度、PM2.5、P10和VOC,TVOC,CO2,甲醛等参数的采集，并能将数据上传物联云平台，从而实现同步远程监测、发布指令的目的。
         </li>
        </ul>
        <h3>
         <a id="___45">
         </a>
         物联网平台 ----- 巴法云
        </h3>
        <p>
         为了更方便小白理解与定位问题，我将特定的api片段截取下来供大家翻阅使用。
         <a href="https://cloud.bemfa.com/docs/#/?id=_51-tcp%E5%88%9B%E5%AE%A2%E4%BA%91" rel="nofollow">
          巴法云官方 api 文档链接
         </a>
        </p>
        <h4>
         <a id="TCP_49">
         </a>
         与设备端建立TCP连接，实现订阅/发布
        </h4>
        <h5>
         <a id="_51">
         </a>
         设备端发送信息到巴法云
        </h5>
        <img src="https://i-blog.csdnimg.cn/blog_migrate/dcc950278bb3e1fc79b5d3e37e830bbf.png" width="90%">
         <h5>
          <a id="_55">
          </a>
          设备端从巴法云接收信息
         </h5>
         <img src="https://i-blog.csdnimg.cn/blog_migrate/75a8040b3229df8aaf6aedc6ca190a15.png" width="90%">
          <h4>
           <a id="HTTP_59">
           </a>
           客户端发送HTTP请求，实现订阅/发布
          </h4>
          <h5>
           <a id="_61">
           </a>
           小程序发送信息到巴法云
          </h5>
          <img src="https://i-blog.csdnimg.cn/blog_migrate/b13331585d813d98c09b6d5ea8596284.png" width="90%"/>
          <h5>
           <a id="_64">
           </a>
           小程序从巴法云接收信息
          </h5>
          <img src="https://i-blog.csdnimg.cn/blog_migrate/2ba727c9e10a2e9c8efa1ff73b993976.png" width="90%"/>
          <h3>
           <a id="___68">
           </a>
           客户端 ----- 微信小程序
          </h3>
          <p>
           在当下移动端越来越流行的时代，使用Web网页进行物联网控制显然已跟不上潮流。为了突出物联网控制的便捷性与灵巧性，微信小程序便成为了首选。
          </p>
          <h4>
           <a id="_70">
           </a>
           页面设计与布局
          </h4>
          <p>
           先上成品图
          </p>
          <img src="https://i-blog.csdnimg.cn/blog_migrate/5e186df85597667a9249d466dfe4ef06.png" width="80%"/>
          <p>
           卡片式布局区分显示各模块数据信息如
           <code>
            温度、湿度、光照强度、PM2.5、甲醛等
           </code>
           ，tab栏区分不同功能如
           <code>
            数据监控、控制面板、警戒阈值
           </code>
          </p>
          <h4>
           <a id="_77">
           </a>
           数据实时更新
          </h4>
          <p>
           为了确保数据实时更新，我们采用
           <code>
            轮询
           </code>
           的方法，使用定时器周期性发送HTTP请求获取设备端各模块的数据。具体代码实现如下：
          </p>
          <p>
           <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/b11d7cf325f8c1c5434fb348cad85dbe.png"/>
           <br/>
           其中，
           <code>
            this.getData
           </code>
           是发送HTTP请求的函数。
          </p>
          <h4>
           <a id="_83">
           </a>
           边界情况界定
          </h4>
          <ul>
           <li>
            在发送指令控制设备时，需要先确保设备端在线
           </li>
           <li>
            发送指令时不能短时间内多次点击，需要消抖处理
           </li>
          </ul>
          <h4>
           <a id="_86">
           </a>
           警戒阈值设置
          </h4>
          <img src="https://i-blog.csdnimg.cn/blog_migrate/4a09bddaea2d3d56dfc8ad6baa7bb484.png" width="90%"/>
          <ul>
           <li>
            区分模块进行控制，优化用户体验，使人一目了然。
           </li>
           <li>
            不同模块不同步进值，更方便控制参数
           </li>
          </ul>
          <h2>
           <a id="_95">
           </a>
           结语
          </h2>
          <p>
           有需要的可以私信或加V — h287728237。有原理图、PCB、小程序源码和Audrino源码，包教包会~
          </p>
         </img>
        </img>
       </img>
      </img>
     </img>
    </img>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a:2f2f626c6f672e6373646e2e6e65742f4d696e66434f4e532f:61727469636c652f64657461696c732f313235303130373333" class_="artid" style="display:none">
 </p>
</div>


