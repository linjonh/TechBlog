---
layout: post
title: "用户界面拒绝,后端放行-记一次邮件验证bypass"
date: 2025-03-12 09:33:23 +0800
description: "这个漏洞出现在。"
keywords: "用户界面拒绝，后端放行 -- 记一次邮件验证bypass"
categories: ['未分类']
tags: ['网络', '经验分享', '安全', 'Xss', 'Web', 'Csrf']
artid: "146196422"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146196422
    alt: "用户界面拒绝,后端放行-记一次邮件验证bypass"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146196422
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146196422
cover: https://bing.ee123.net/img/rand?artid=146196422
image: https://bing.ee123.net/img/rand?artid=146196422
img: https://bing.ee123.net/img/rand?artid=146196422
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     用户界面拒绝，后端放行 -- 记一次邮件验证bypass
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     <a class="link-info" href="https://bbs.zkaq.cn/" rel="nofollow" title="目录： ">
      目录：
     </a>
    </p>
    <p>
     <a class="link-info" href="https://bbs.zkaq.cn/" rel="nofollow" title="   前言">
      前言
     </a>
    </p>
    <p>
     <a class="link-info" href="https://bbs.zkaq.cn/" rel="nofollow" title="　漏洞挖掘">
      漏洞挖掘
     </a>
    </p>
    <p>
     <a class="link-info" href="https://bbs.zkaq.cn/" rel="nofollow" title="   复现漏洞的步骤">
      复现漏洞的步骤
     </a>
    </p>
    <p>
     <a class="link-info" href="https://bbs.zkaq.cn/" rel="nofollow" title="   小贴士">
      小贴士
     </a>
    </p>
    <p>
     希望大家一切顺利！今天，我将分享一个在
     <strong>
      HackerOne 公开项目
     </strong>
     中发现的逻辑漏洞。所以，话不多说，让我们直接进入正题。
    </p>
    <hr/>
    <h2>
     <strong>
      前言
     </strong>
    </h2>
    <p>
     这个漏洞出现在
     <strong>
      HackerOne 的某个公开项目
     </strong>
     中。由于它尚未修复，我们暂且将该项目称为
     <strong>
      target.com
     </strong>
     。
    </p>
    <p>
     该漏洞允许我
     <strong>
      绕过邮件验证
     </strong>
     ，也就是说，我可以使用任何电子邮件地址注册，而无需真正拥有该邮箱。
    </p>
    <hr/>
    <h3>
     <strong>
      漏洞挖掘
     </strong>
    </h3>
    <p>
     我的测试方法是先注册一个账户，并探索主域及其功能——最初
     <strong>
      不使用 Burp Suite 或任何工具
     </strong>
     ，而是试图彻底理解该应用的逻辑。
    </p>
    <p>
     随后，我开始检查
     <strong>
      登录、注册、重置密码
     </strong>
     等涉及身份验证的功能，以寻找可能的漏洞。
    </p>
    <p>
     然而，不幸的是，这些功能都
     <strong>
      很安全
     </strong>
     ，没有发现明显的安全问题。
    </p>
    <p>
     但我注意到，该应用在
     <strong>
      注册过程中
     </strong>
     需要
     <strong>
      邮件验证
     </strong>
     。于是，我想到：
     <strong>
      是否可以绕过这个验证？
     </strong>
    </p>
    <p>
     首先，我分析了
     <strong>
      发送到邮箱的验证链接
     </strong>
     ，检查其生成方式是否存在
     <strong>
      配置错误
     </strong>
     。我关注的常见问题包括：
    </p>
    <p>
     <strong>
      可预测的令牌
     </strong>
     —— 如果令牌易于猜测，我可以尝试
     <strong>
      暴力破解
     </strong>
     。
    </p>
    <p>
     -
     <strong>
      编码的邮箱值
     </strong>
     —— 如果令牌包含我的邮箱地址，并且使用了
     <strong>
      Base64
     </strong>
     或
     <strong>
      URL 编码
     </strong>
     ，那么我可以尝试篡改。
    </p>
    <p>
     <strong>
      可篡改的参数
     </strong>
     —— 如果链接中包含
     <code>
      email
     </code>
     或
     <code>
      user_id
     </code>
     之类的参数，我可以修改它们以尝试绕过验证。
    </p>
    <p>
     然而，不幸的是，
     <strong>
      这些问题都不存在
     </strong>
     —— 该令牌
     <strong>
      强大且不可预测
     </strong>
     。
    </p>
    <p>
     于是，我决定放弃
     <strong>
      邮件验证
     </strong>
     的思路，转而测试应用的其他
     <strong>
      功能
     </strong>
     ，看看是否能找到有趣的漏洞。
    </p>
    <p>
     我首先检查了
     <strong>
      个人资料页面
     </strong>
     ，因为这通常是
     <strong>
      CSRF、CORS 配置错误、缓存欺骗、IDOR
     </strong>
     以及其他漏洞的高风险区域。
    </p>
    <p>
     但很快我发现，我无法修改
     <strong>
      敏感信息
     </strong>
     ，如
     <strong>
      邮箱
     </strong>
     或
     <strong>
      用户名
     </strong>
     。唯一可编辑的字段仅限于
     <strong>
      基本信息
     </strong>
     ，如
     <strong>
      性别、身高
     </strong>
     等非关键数据。
    </p>
    <p>
    </p>
    <p class="img-center">
     <img alt="img" height="429" src="https://i-blog.csdnimg.cn/img_convert/26c04c0715edc03d6e3cfb6080063e1c.png" width="875"/>
    </p>
    <p>
     此时，我决定分析
     <strong>
      负责更改用户信息的请求
     </strong>
     。
    </p>
    <p>
     我注意到，
     <strong>
      任何我修改的参数
     </strong>
     都会以
     <strong>
      键值对
     </strong>
     的形式出现在
     <strong>
      JSON 请求体
     </strong>
     中。
    </p>
    <p>
     就在这时，我突然灵光一闪
    </p>
    <p>
    </p>
    <p class="img-center">
     <img alt="img" height="468" src="https://i-blog.csdnimg.cn/img_convert/ea187e521974bff22c424be0079a1c24.png" width="875"/>
    </p>
    <p>
    </p>
    <p>
     <strong>
      还记得邮箱验证吗？
     </strong>
    </p>
    <p>
     如果网站
     <strong>
      只是在用户界面上阻止了邮箱修改
     </strong>
     ，但
     <strong>
      后台并没有进行相应的限制
     </strong>
     呢？
    </p>
    <p>
     <strong>
      没错！
     </strong>
     这正是你现在想到的 😏
    </p>
    <p>
     我立刻测试了一下，
     <strong>
      修改了请求
     </strong>
     ：
    </p>
    <p>
     <code>
      我将 键从 genderIdentity 改为 email。
     </code>
     <br/>
     <code>
      我将 值 设置为一个 新邮箱。
     </code>
    </p>
    <p>
    </p>
    <p class="img-center">
     <img alt="img" height="468" src="https://i-blog.csdnimg.cn/img_convert/c739c72f61d663d79cc159163c7451c4.png" width="875"/>
    </p>
    <p>
     然后，
     <strong>
      你猜怎么着？
     </strong>
    </p>
    <p>
     <strong>
      邮箱直接更新了，完全不需要任何验证！
     </strong>
    </p>
    <p>
    </p>
    <p class="img-center">
     <img alt="img" height="427" src="https://i-blog.csdnimg.cn/img_convert/a837c187fe7ded4906a17785aeb3c1cd.png" width="875"/>
    </p>
    <p>
     这意味着攻击者可以使用
     <strong>
      任意受害者的邮箱
     </strong>
     注册账户，
     <strong>
      绕过邮箱验证
     </strong>
     ，甚至可能
     <strong>
      冒充受害者身份
     </strong>
     在平台上活动。
    </p>
    <h2>
     复现漏洞的步骤：
    </h2>
    <p>
     1️⃣
     <strong>
      在
      <code>
       target.com
      </code>
      注册一个新账号
     </strong>
     ，使用任意
     <strong>
      虚假邮箱
     </strong>
     完成注册并验证邮箱。
    </p>
    <p>
     2️⃣ 进入
     <strong>
      个人资料设置
     </strong>
     ，这里可以修改用户的个人信息。
    </p>
    <p>
     3️⃣ 使用
     <strong>
      Burp Suite
     </strong>
     捕获
     <strong>
      更新用户信息
     </strong>
     的请求（例如性别、身高等）。
    </p>
    <p>
     4️⃣
     <strong>
      修改请求的 JSON 数据
     </strong>
     ：
    </p>
    <p>
     <code>
      将 键 从 "genderIdentity"（或其他可编辑字段）改为 "email"。
     </code>
     <br/>
     <code>
      将 值 设置为你想更改的新邮箱.
     </code>
    </p>
    <p>
     5️⃣
     <strong>
      发送修改后的请求
     </strong>
     到服务器。
    </p>
    <p>
     6️⃣
     <strong>
      结果：
     </strong>
     邮箱成功更新，
     <strong>
      无需任何验证
     </strong>
     ，攻击者即可使用受害者的邮箱完成注册。
    </p>
    <h2>
     <strong>
      小贴士：
     </strong>
    </h2>
    <p>
     永远不要
     <strong>
      完全依赖用户界面
     </strong>
     ！许多在 UI 上看似受限或不可用的操作，可能仍然可以通过
     <strong>
      后端 API
     </strong>
     直接访问。
     <strong>
      直接测试 API 请求
     </strong>
     ，你可能会发现隐藏的漏洞。
    </p>
    <p>
     我最初将此漏洞报告为
     <strong>
      中等严重性
     </strong>
     ，但公司工作人员将其
     <strong>
      升级为高危漏洞
     </strong>
     。
    </p>
    <p>
    </p>
    <p class="img-center">
     <img alt="img" height="405" src="https://i-blog.csdnimg.cn/img_convert/cbf86eab2a9e7a216fbb3b7ad8557ee7.png" width="396"/>
    </p>
    <h4>
     申明：本账号所分享内容仅用于网络安全技术讨论，切勿用于违法途径，所有渗透都需获取授权，违者后果自行承担，与本号及作者无关
    </h4>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f7a6b61716c616f6e69616f2f:61727469636c652f64657461696c732f313436313936343232" class_="artid" style="display:none">
 </p>
</div>


