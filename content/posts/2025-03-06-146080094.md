---
arturl_encode: "687474:70733a2f2f626c6f672e6373646e2e6e65742f686867685f2f:61727469636c652f64657461696c732f313436303830303934"
layout: post
title: "常见的限流算法有哪些"
date: 2025-03-06 21:00:25 +08:00
description: "提示：这里对文章进行总结：例如：以上就是今天要讲的内容，本文仅仅简单介绍了pandas的使用，而pandas提供了大量能使我们快速便捷地处理数据的函数和方法。"
keywords: "常见的限流算法有哪些？"
categories: ['未分类']
tags: ['算法', '开发语言', 'Java']
artid: "146080094"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146080094
    alt: "常见的限流算法有哪些"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146080094
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146080094
cover: https://bing.ee123.net/img/rand?artid=146080094
image: https://bing.ee123.net/img/rand?artid=146080094
img: https://bing.ee123.net/img/rand?artid=146080094
---

# 常见的限流算法有哪些？

## 一、计数器算法

**原理**
：

* 使用一个固定窗口（时间段）内的计数器，记录请求的数量。
* 若计数器超过设定的阈值，则拒绝后续请求。

**实现**
：

* 定义一个时间窗口（如1秒）。
* 在窗口内维护一个计数器，接收到请求时计数器+1。
* 若计数器超过阈值，则限流；否则允许。

**优点**
：
  
简单易实现，适用于低精度的限流需求。

**缺点**
：
  
边界问题：窗口边界处可能产生突发流量。例如，当前窗口接近阈值，新窗口开始时流量激增。

## 二、滑动窗口计数器

**原理**
：

* 将固定窗口进一步细分为更小的时间片段。
* 根据当前时间的滑动，将多个时间片段内的请求数量进行累加。

**实现**
：

* 将1秒分为多个时间片段（如100毫秒）。
* 使用一个队列存储各时间片段的计数。
* 请求时移除过期的时间片段，并累计最新的请求数。

**优点**
：

* 缓解固定窗口算法的边界问题。
* 流量控制更加平滑。

**缺点**
：
  
实现较为复杂，存储和计算开销增加。

## 三、漏桶算法

**原理**
：

* 将请求存入一个“桶”中，以恒定速率从桶中取出处理。
* 若请求到达速度超过出水速度，则多余的请求被丢弃或排队。

**实现**
：

* 维护一个队列表示漏桶。
* 按固定速率处理请求。
* 若队列满，则丢弃新请求。

**优点**
：

* 能平滑突发流量，将其转化为稳定输出。
* 控制请求处理速率。

**缺点**
：
  
丢弃超量请求可能导致用户体验下降。

## 四、令牌桶算法

**原理**
：

* 系统按固定速率向桶中加入“令牌”。
* 每次请求需要消耗一个令牌，若令牌不足，则拒绝请求。

**实现**
：

* 维护一个桶存储令牌，设定令牌生成速率和桶容量。
* 请求时，检查桶内是否有足够令牌：
* 有：扣除相应令牌，允许请求。
* 无：拒绝请求。

**优点**
：

* 支持突发流量处理（通过允许提前消费桶中积累的令牌）。
* 限流效果较平滑。

**缺点**
：
  
相比漏桶算法实现稍复杂。

## 五、Sliding Log（滑动日志算法）

**原理**
：

* 记录每个请求的时间戳。
* 根据当前时间窗口计算历史请求数量，决定是否限流。

**实现**
：

* 使用一个有序集合（如Redis的zset）存储时间戳。
* 请求时清理超出时间窗口的过期时间戳，并统计剩余时间戳数量。
* 若数量未超限，则允许请求；否则限流。

**优点**
：
  
精度高，适合精细化限流。

**缺点**
：
  
存储开销大，尤其在高并发下可能性能较低。

## 总结

提示：这里对文章进行总结：
  
例如：以上就是今天要讲的内容，本文仅仅简单介绍了pandas的使用，而pandas提供了大量能使我们快速便捷地处理数据的函数和方法。