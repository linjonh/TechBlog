---
layout: post
title: "凸优化算法学习笔记决策单调性与-wqs二分"
date: 2025-03-14 16:40:25 +0800
description: "凸优化算法：决策单调性与wqs二分"
keywords: "凸优化算法学习笔记：决策单调性与 wqs二分"
categories: ['未分类']
tags: ['算法', '笔记', '学习', '动态规划']
artid: "146261059"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146261059
    alt: "凸优化算法学习笔记决策单调性与-wqs二分"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146261059
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146261059
cover: https://bing.ee123.net/img/rand?artid=146261059
image: https://bing.ee123.net/img/rand?artid=146261059
img: https://bing.ee123.net/img/rand?artid=146261059
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     凸优化算法学习笔记：决策单调性与 wqs二分
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <h2>
     <a id="_1">
     </a>
     前言
    </h2>
    <p>
     学习了凸性相关的算法。
     <br/>
     有：决策单调性，wqs二分， 闵可夫斯基和， slope trick。
     <br/>
     一般是用来优化dp。
     <br/>
     <s>
      文章写的太长了因此分成两篇发。
     </s>
    </p>
    <h2>
     <a id="_6">
     </a>
     决策单调性
    </h2>
    <h3>
     <a id="_8">
     </a>
     单调矩阵，完全单调矩阵，蒙日阵
    </h3>
    <ul>
     <li>
      单调矩阵：每行最小值/最大值的位置单调的矩阵。
     </li>
     <li>
      完全单调矩阵：若一个矩阵
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         A 
         
        
       
         A
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord mathnormal">
           A
          </span>
         </span>
        </span>
       </span>
      </span>
      满足其所有子矩阵均为单调矩阵，那么称其为完全单调矩阵。
     </li>
    </ul>
    <p>
     常见的决策单调性问题其实就是在单调矩阵上求一行最小值的问题。一般用
     <strong>
      四边形不等式
     </strong>
     判定是否具有决策单调性。
    </p>
    <ul>
     <li>
      蒙日阵：满足
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         ∀ 
         
        
          1 
         
        
          ≤ 
         
         
         
           i 
          
         
           1 
          
         
        
          &lt; 
         
         
         
           i 
          
         
           2 
          
         
        
          ≤ 
         
        
          n 
         
        
          , 
         
        
          1 
         
        
          ≤ 
         
         
         
           j 
          
         
           1 
          
         
        
          &lt; 
         
         
         
           j 
          
         
           2 
          
         
        
          ≤ 
         
        
          m 
         
        
       
         \forall 1 \leq i_1 &lt; i_2 \leq n, 1\leq j_1 &lt; j_2 \leq m
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.8304em; vertical-align: -0.136em;">
          </span>
          <span class="mord">
           ∀1
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           ≤
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.8095em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            i
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3011em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           &lt;
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.8095em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            i
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3011em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  2
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           ≤
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.8389em; vertical-align: -0.1944em;">
          </span>
          <span class="mord mathnormal">
           n
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mord">
           1
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           ≤
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.854em; vertical-align: -0.1944em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0572em;">
            j
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3011em;">
               <span class="" style="top: -2.55em; margin-left: -0.0572em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           &lt;
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.854em; vertical-align: -0.1944em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0572em;">
            j
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3011em;">
               <span class="" style="top: -2.55em; margin-left: -0.0572em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  2
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           ≤
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.4306em;">
          </span>
          <span class="mord mathnormal">
           m
          </span>
         </span>
        </span>
       </span>
      </span>
      ，
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         A 
          
          
           
           
             i 
            
           
             1 
            
           
          
            , 
           
           
           
             j 
            
           
             1 
            
           
          
         
        
          + 
         
         
         
           A 
          
          
           
           
             i 
            
           
             2 
            
           
          
            , 
           
           
           
             j 
            
           
             2 
            
           
          
         
        
          ≤ 
         
         
         
           A 
          
          
           
           
             i 
            
           
             1 
            
           
          
            , 
           
           
           
             j 
            
           
             2 
            
           
          
         
        
          + 
         
         
         
           A 
          
          
           
           
             i 
            
           
             2 
            
           
          
            , 
           
           
           
             j 
            
           
             1 
            
           
          
         
        
       
         A_{i_1, j_1} + A_{i_2, j_2} \leq A_{i_1, j_2} + A_{i_2, j_1}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           +
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          2
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          2
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           ≤
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          2
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           +
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          2
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      的矩阵
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         A 
         
        
       
         A
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord mathnormal">
           A
          </span>
         </span>
        </span>
       </span>
      </span>
      被称为
      <strong>
       蒙日阵
      </strong>
      。也称
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         A 
         
        
       
         A
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord mathnormal">
           A
          </span>
         </span>
        </span>
       </span>
      </span>
      满足四边形不等式。其中
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         A 
          
          
           
           
             i 
            
           
             1 
            
           
          
            , 
           
           
           
             j 
            
           
             1 
            
           
          
         
        
          + 
         
         
         
           A 
          
          
           
           
             i 
            
           
             2 
            
           
          
            , 
           
           
           
             j 
            
           
             2 
            
           
          
         
        
          ≤ 
         
         
         
           A 
          
          
           
           
             i 
            
           
             1 
            
           
          
            , 
           
           
           
             j 
            
           
             2 
            
           
          
         
        
          + 
         
         
         
           A 
          
          
           
           
             i 
            
           
             2 
            
           
          
            , 
           
           
           
             j 
            
           
             1 
            
           
          
         
        
       
         A_{i_1, j_1} + A_{i_2, j_2} \leq A_{i_1, j_2} + A_{i_2, j_1}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           +
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          2
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          2
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           ≤
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          2
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           +
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          2
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      中的
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         ≤ 
         
        
       
         \leq
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.7719em; vertical-align: -0.136em;">
          </span>
          <span class="mrel">
           ≤
          </span>
         </span>
        </span>
       </span>
      </span>
      理解为
      <strong>
       优于
      </strong>
      。
     </li>
    </ul>
    <p>
     有重要结论：
     <strong>
      蒙日阵是完全单调矩阵
     </strong>
     。
    </p>
    <p>
     证明：
    </p>
    <ol>
     <li>
      判断一个矩阵是否为完全单调矩阵只需要看任意的
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         2 
         
        
          × 
         
        
          2 
         
        
       
         2 \times 2
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;">
          </span>
          <span class="mord">
           2
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           ×
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.6444em;">
          </span>
          <span class="mord">
           2
          </span>
         </span>
        </span>
       </span>
      </span>
      子矩阵是否为单调矩阵。可以画图理解。
     </li>
     <li>
      由
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         1 
         
        
       
         1
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6444em;">
          </span>
          <span class="mord">
           1
          </span>
         </span>
        </span>
       </span>
      </span>
      得：若一个矩阵
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         A 
         
        
       
         A
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord mathnormal">
           A
          </span>
         </span>
        </span>
       </span>
      </span>
      是完全单调矩阵，需满足
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         ∀ 
         
        
          1 
         
        
          ≤ 
         
         
         
           i 
          
         
           1 
          
         
        
          &lt; 
         
         
         
           i 
          
         
           2 
          
         
        
          ≤ 
         
        
          n 
         
        
          , 
         
        
          1 
         
        
          ≤ 
         
         
         
           j 
          
         
           1 
          
         
        
          &lt; 
         
         
         
           j 
          
         
           2 
          
         
        
          ≤ 
         
        
          m 
         
        
       
         \forall 1 \leq i_1 &lt; i_2 \leq n, 1 \leq j_1 &lt; j_2 \leq m
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.8304em; vertical-align: -0.136em;">
          </span>
          <span class="mord">
           ∀1
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           ≤
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.8095em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            i
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3011em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           &lt;
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.8095em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            i
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3011em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  2
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           ≤
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.8389em; vertical-align: -0.1944em;">
          </span>
          <span class="mord mathnormal">
           n
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mord">
           1
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           ≤
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.854em; vertical-align: -0.1944em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0572em;">
            j
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3011em;">
               <span class="" style="top: -2.55em; margin-left: -0.0572em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           &lt;
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.854em; vertical-align: -0.1944em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0572em;">
            j
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3011em;">
               <span class="" style="top: -2.55em; margin-left: -0.0572em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  2
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           ≤
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.4306em;">
          </span>
          <span class="mord mathnormal">
           m
          </span>
         </span>
        </span>
       </span>
      </span>
      ，
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         A 
          
          
           
           
             i 
            
           
             1 
            
           
          
            , 
           
           
           
             j 
            
           
             1 
            
           
          
         
        
          ≤ 
         
         
         
           A 
          
          
           
           
             i 
            
           
             1 
            
           
          
            , 
           
           
           
             j 
            
           
             2 
            
           
          
         
        
       
         A_{i_1, j_1} \leq A_{i_1, j_2}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           ≤
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          2
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      或
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         A 
          
          
           
           
             i 
            
           
             1 
            
           
          
            , 
           
           
           
             j 
            
           
             1 
            
           
          
         
        
          &gt; 
         
         
         
           A 
          
          
           
           
             i 
            
           
             2 
            
           
          
            , 
           
           
           
             j 
            
           
             2 
            
           
          
         
        
          且 
         
         
         
           A 
          
          
           
           
             i 
            
           
             2 
            
           
          
            , 
           
           
           
             j 
            
           
             1 
            
           
          
         
        
          &gt; 
         
         
         
           A 
          
          
           
           
             i 
            
           
             2 
            
           
          
            , 
           
           
           
             j 
            
           
             2 
            
           
          
         
        
       
         A_{i_1, j_1} &gt; A_{i_2, j_2}且 A_{i_2, j_1} &gt; A_{i_2, j_2}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           &gt;
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          2
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          2
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mord cjk_fallback">
           且
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          2
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           &gt;
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          2
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          2
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      。反过来讲，若
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         ∃ 
         
        
          1 
         
        
          ≤ 
         
         
         
           i 
          
         
           1 
          
         
        
          &lt; 
         
         
         
           i 
          
         
           2 
          
         
        
          ≤ 
         
        
          n 
         
        
          , 
         
        
          1 
         
        
          ≤ 
         
         
         
           j 
          
         
           1 
          
         
        
          &lt; 
         
         
         
           j 
          
         
           2 
          
         
        
          ≤ 
         
        
          m 
         
        
       
         \exists 1 \leq i_1 &lt; i_2 \leq n, 1 \leq j_1 &lt; j_2 \leq m
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.8304em; vertical-align: -0.136em;">
          </span>
          <span class="mord">
           ∃1
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           ≤
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.8095em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            i
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3011em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           &lt;
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.8095em; vertical-align: -0.15em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            i
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3011em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  2
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           ≤
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.8389em; vertical-align: -0.1944em;">
          </span>
          <span class="mord mathnormal">
           n
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mord">
           1
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           ≤
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.854em; vertical-align: -0.1944em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0572em;">
            j
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3011em;">
               <span class="" style="top: -2.55em; margin-left: -0.0572em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           &lt;
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.854em; vertical-align: -0.1944em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal" style="margin-right: 0.0572em;">
            j
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3011em;">
               <span class="" style="top: -2.55em; margin-left: -0.0572em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  2
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.15em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           ≤
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.4306em;">
          </span>
          <span class="mord mathnormal">
           m
          </span>
         </span>
        </span>
       </span>
      </span>
      ，满足
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         A 
          
          
           
           
             i 
            
           
             1 
            
           
          
            , 
           
           
           
             j 
            
           
             1 
            
           
          
         
        
          &gt; 
         
         
         
           A 
          
          
           
           
             i 
            
           
             1 
            
           
          
            , 
           
           
           
             j 
            
           
             2 
            
           
          
         
        
          且 
         
         
         
           A 
          
          
           
           
             i 
            
           
             2 
            
           
          
            , 
           
           
           
             j 
            
           
             1 
            
           
          
         
        
          ≤ 
         
         
         
           A 
          
          
           
           
             i 
            
           
             2 
            
           
          
            , 
           
           
           
             j 
            
           
             2 
            
           
          
         
        
       
         A_{i_1, j_1} &gt; A_{i_1, j_2} 且 A_{i_2, j_1} \leq A_{i_2, j_2}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           &gt;
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          2
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mord cjk_fallback">
           且
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          2
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           ≤
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          2
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          2
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ，那么
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         A 
         
        
       
         A
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord mathnormal">
           A
          </span>
         </span>
        </span>
       </span>
      </span>
      就不是完全单调矩阵。发现此时
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         A 
          
          
           
           
             i 
            
           
             1 
            
           
          
            , 
           
           
           
             j 
            
           
             1 
            
           
          
         
        
          + 
         
         
         
           A 
          
          
           
           
             i 
            
           
             2 
            
           
          
            , 
           
           
           
             j 
            
           
             2 
            
           
          
         
        
          &gt; 
         
         
         
           A 
          
          
           
           
             i 
            
           
             1 
            
           
          
            , 
           
           
           
             j 
            
           
             2 
            
           
          
         
        
          + 
         
         
         
           A 
          
          
           
           
             i 
            
           
             2 
            
           
          
            , 
           
           
           
             j 
            
           
             1 
            
           
          
         
        
       
         A_{i_1, j_1} + A_{i_2, j_2} &gt; A_{i_1, j_2} + A_{i_2, j_1}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           +
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          2
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          2
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           &gt;
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          2
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           +
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          2
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                    j
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3173em;">
                       <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          1
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ，与蒙日阵定义矛盾。证必。
     </li>
    </ol>
    <p>
     这说明了，如果一个矩阵满足四边形不等式，那么它具有决策单调性。
    </p>
    <p>
     判定一个矩阵为蒙日阵：
    </p>
    <p>
     方法一：根据定义，证明
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        ∀ 
        
       
         1 
        
       
         ≤ 
        
        
        
          i 
         
        
          1 
         
        
       
         &lt; 
        
        
        
          i 
         
        
          2 
         
        
       
         ≤ 
        
       
         n 
        
       
         , 
        
       
         1 
        
       
         ≤ 
        
        
        
          j 
         
        
          1 
         
        
       
         &lt; 
        
        
        
          j 
         
        
          2 
         
        
       
         ≤ 
        
       
         m 
        
       
      
        \forall 1 \leq i_1 &lt; i_2 \leq n, 1\leq j_1 &lt; j_2 \leq m
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8304em; vertical-align: -0.136em;">
         </span>
         <span class="mord">
          ∀1
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8095em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           i
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3011em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 1
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          &lt;
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8095em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           i
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3011em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 2
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8389em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.854em; vertical-align: -0.1944em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0572em;">
           j
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3011em;">
              <span class="" style="top: -2.55em; margin-left: -0.0572em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 1
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          &lt;
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.854em; vertical-align: -0.1944em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0572em;">
           j
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3011em;">
              <span class="" style="top: -2.55em; margin-left: -0.0572em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 2
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          m
         </span>
        </span>
       </span>
      </span>
     </span>
     ，
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        A 
         
         
          
          
            i 
           
          
            1 
           
          
         
           , 
          
          
          
            j 
           
          
            1 
           
          
         
        
       
         + 
        
        
        
          A 
         
         
          
          
            i 
           
          
            2 
           
          
         
           , 
          
          
          
            j 
           
          
            2 
           
          
         
        
       
         ≤ 
        
        
        
          A 
         
         
          
          
            i 
           
          
            1 
           
          
         
           , 
          
          
          
            j 
           
          
            2 
           
          
         
        
       
         + 
        
        
        
          A 
         
         
          
          
            i 
           
          
            2 
           
          
         
           , 
          
          
          
            j 
           
          
            1 
           
          
         
        
       
      
        A_{i_1, j_1} + A_{i_2, j_2} \leq A_{i_1, j_2} + A_{i_2, j_1}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           A
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   i
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3173em;">
                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         1
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      ​
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.143em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                   j
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3173em;">
                      <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         1
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      ​
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.143em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           A
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   i
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3173em;">
                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         2
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      ​
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.143em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                   j
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3173em;">
                      <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         2
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      ​
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.143em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           A
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   i
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3173em;">
                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         1
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      ​
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.143em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                   j
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3173em;">
                      <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         2
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      ​
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.143em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           A
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   i
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3173em;">
                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         2
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      ​
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.143em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                   j
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3173em;">
                      <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         1
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      ​
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.143em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     。
     <br/>
     方法二：证明
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        ∀ 
        
       
         1 
        
       
         ≤ 
        
       
         i 
        
       
         &lt; 
        
       
         n 
        
       
         , 
        
       
         1 
        
       
         ≤ 
        
       
         j 
        
       
         &lt; 
        
       
         m 
        
       
      
        \forall 1 \leq i &lt; n, 1 \leq j &lt; m
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8304em; vertical-align: -0.136em;">
         </span>
         <span class="mord">
          ∀1
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6986em; vertical-align: -0.0391em;">
         </span>
         <span class="mord mathnormal">
          i
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          &lt;
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8389em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.854em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0572em;">
          j
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          &lt;
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          m
         </span>
        </span>
       </span>
      </span>
     </span>
     ，
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        A 
         
         
         
           i 
          
         
           , 
          
         
           j 
          
         
        
       
         + 
        
        
        
          A 
         
         
         
           i 
          
         
           + 
          
         
           1 
          
         
           , 
          
         
           j 
          
         
           + 
          
         
           1 
          
         
        
       
         ≤ 
        
        
        
          A 
         
         
         
           i 
          
         
           , 
          
         
           j 
          
         
           + 
          
         
           1 
          
         
        
       
         + 
        
        
        
          A 
         
         
         
           i 
          
         
           + 
          
         
           1 
          
         
           , 
          
         
           j 
          
         
        
       
      
        A_{i, j} + A_{i + 1, j + 1} \leq A_{i, j + 1} + A_{i + 1, j}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           A
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           A
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mbin mtight">
                  +
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                 <span class="mbin mtight">
                  +
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           A
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                 <span class="mbin mtight">
                  +
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           A
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mbin mtight">
                  +
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     。相当于仅考虑任意
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        2 
        
       
         × 
        
       
         2 
        
       
      
        2 \times 2
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;">
         </span>
         <span class="mord">
          2
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          ×
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          2
         </span>
        </span>
       </span>
      </span>
     </span>
     的子矩形。
    </p>
    <p>
     对方法二正确性的说明：将定义式变形：
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        A 
         
         
          
          
            i 
           
          
            2 
           
          
         
           , 
          
          
          
            j 
           
          
            2 
           
          
         
        
       
         − 
        
        
        
          A 
         
         
          
          
            i 
           
          
            1 
           
          
         
           , 
          
          
          
            j 
           
          
            2 
           
          
         
        
       
         − 
        
        
        
          A 
         
         
          
          
            i 
           
          
            2 
           
          
         
           , 
          
          
          
            j 
           
          
            1 
           
          
         
        
       
         + 
        
        
        
          A 
         
         
          
          
            i 
           
          
            1 
           
          
         
           , 
          
          
          
            j 
           
          
            1 
           
          
         
        
       
         ≤ 
        
       
         0 
        
       
      
        A_{i_2, j_2} - A_{i_1, j_2} - A_{i_2, j_1} + A_{i_1, j_1} \leq 0
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           A
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   i
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3173em;">
                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         2
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      ​
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.143em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                   j
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3173em;">
                      <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         2
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      ​
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.143em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          −
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           A
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   i
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3173em;">
                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         1
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      ​
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.143em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                   j
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3173em;">
                      <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         2
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      ​
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.143em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          −
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           A
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   i
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3173em;">
                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         2
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      ​
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.143em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                   j
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3173em;">
                      <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         1
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      ​
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.143em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           A
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   i
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3173em;">
                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         1
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      ​
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.143em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                   j
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3173em;">
                      <span class="" style="top: -2.357em; margin-left: -0.0572em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         1
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      ​
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.143em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          0
         </span>
        </span>
       </span>
      </span>
     </span>
     ，发现这是
     <strong>
      二维差分
     </strong>
     的形式，相当于要求
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        A 
        
       
      
        A
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal">
          A
         </span>
        </span>
       </span>
      </span>
     </span>
     的二维差分矩阵的任意一个矩形和小于等于
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        0 
        
       
      
        0
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          0
         </span>
        </span>
       </span>
      </span>
     </span>
     。这等价于差分后每一个位置上的数都小于等于
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        0 
        
       
      
        0
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          0
         </span>
        </span>
       </span>
      </span>
     </span>
     。
    </p>
    <p>
     <strong>
      特别说明
     </strong>
     ：如果一个矩阵的左下角或右上角没有意义，可以通过给这些位置赋值为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
         
        
          i 
         
        
       
         × 
        
       
         ∞ 
        
       
      
        k_i \times \infty
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8444em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0315em;">
           k
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0315em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          ×
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord">
          ∞
         </span>
        </span>
       </span>
      </span>
     </span>
     的方式让跨过斜对角线的
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        2 
        
       
         × 
        
       
         2 
        
       
      
        2 \times 2
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;">
         </span>
         <span class="mord">
          2
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          ×
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          2
         </span>
        </span>
       </span>
      </span>
     </span>
     子矩形满足四边形不等式。因此可以只关注另一部分是否满足四边形不等式。
    </p>
    <p>
     蒙日阵的性质：
    </p>
    <p>
     设
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        A 
        
       
         , 
        
       
         B 
        
       
      
        A, B
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          A
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0502em;">
          B
         </span>
        </span>
       </span>
      </span>
     </span>
     为蒙日阵。
    </p>
    <ul>
     <li>
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         A 
          
         
           T 
          
         
        
       
         A^{T}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.8413em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.8413em;">
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.1389em;">
                   T
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      为蒙日阵。
     </li>
     <li>
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         A 
         
        
          + 
         
        
          B 
         
        
       
         A + B
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;">
          </span>
          <span class="mord mathnormal">
           A
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           +
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0502em;">
           B
          </span>
         </span>
        </span>
       </span>
      </span>
      为蒙日阵。
     </li>
     <li>
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         λ 
         
        
          A 
         
        
          ( 
         
        
          λ 
         
        
          ≥ 
         
        
          0 
         
        
          ) 
         
        
       
         \lambda A(\lambda \geq 0)
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord mathnormal">
           λ
          </span>
          <span class="mord mathnormal">
           A
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord mathnormal">
           λ
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           ≥
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord">
           0
          </span>
          <span class="mclose">
           )
          </span>
         </span>
        </span>
       </span>
      </span>
      为蒙日阵。
     </li>
     <li>
      对
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         A 
         
        
       
         A
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6833em;">
          </span>
          <span class="mord mathnormal">
           A
          </span>
         </span>
        </span>
       </span>
      </span>
      的某一行或某一列加上任意常数
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         c 
         
        
       
         c
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.4306em;">
          </span>
          <span class="mord mathnormal">
           c
          </span>
         </span>
        </span>
       </span>
      </span>
      仍为蒙日阵。
     </li>
    </ul>
    <p>
     一些蒙日阵的例子：
    </p>
    <ul>
     <li>
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         A 
          
          
          
            x 
           
          
            , 
           
          
            y 
           
          
         
        
          = 
         
        
          m 
         
        
          i 
         
        
          n 
         
        
          ( 
         
        
          x 
         
        
          , 
         
        
          y 
         
        
          ) 
         
        
       
         A_{x, y} = min(x, y)
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.1514em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   x
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mathnormal mtight" style="margin-right: 0.0359em;">
                   y
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord mathnormal">
           min
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord mathnormal">
           x
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           y
          </span>
          <span class="mclose">
           )
          </span>
         </span>
        </span>
       </span>
      </span>
     </li>
     <li>
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         A 
          
          
          
            x 
           
          
            , 
           
          
            y 
           
          
         
        
          = 
         
        
          m 
         
        
          a 
         
        
          x 
         
        
          ( 
         
        
          x 
         
        
          , 
         
        
          y 
         
        
          ) 
         
        
       
         A_{x, y} = max(x, y)
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.1514em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   x
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mathnormal mtight" style="margin-right: 0.0359em;">
                   y
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord mathnormal">
           ma
          </span>
          <span class="mord mathnormal">
           x
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord mathnormal">
           x
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           y
          </span>
          <span class="mclose">
           )
          </span>
         </span>
        </span>
       </span>
      </span>
     </li>
     <li>
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         A 
          
          
          
            x 
           
          
            , 
           
          
            y 
           
          
         
        
          = 
         
         
         
           ∑ 
          
          
          
            i 
           
          
            = 
           
          
            1 
           
          
         
           x 
          
         
         
         
           ∑ 
          
          
          
            j 
           
          
            = 
           
          
            1 
           
          
         
           y 
          
         
         
         
           d 
          
          
          
            i 
           
          
            , 
           
          
            j 
           
          
         
        
       
         A_{x, y} = \sum_{i = 1}^{x}\sum_{j = 1}^{y}d_{i, j}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.1514em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   x
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mathnormal mtight" style="margin-right: 0.0359em;">
                   y
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 1.2401em; vertical-align: -0.4358em;">
          </span>
          <span class="mop">
           <span class="mop op-symbol small-op" style="position: relative; top: 0em;">
            ∑
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.8043em;">
               <span class="" style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   i
                  </span>
                  <span class="mrel mtight">
                   =
                  </span>
                  <span class="mord mtight">
                   1
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.2029em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   x
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2997em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mop">
           <span class="mop op-symbol small-op" style="position: relative; top: 0em;">
            ∑
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.8043em;">
               <span class="" style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                   j
                  </span>
                  <span class="mrel mtight">
                   =
                  </span>
                  <span class="mord mtight">
                   1
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.2029em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0359em;">
                   y
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.4358em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.1667em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            d
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   i
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                   j
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      ，其中
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         d 
         
        
       
         d
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6944em;">
          </span>
          <span class="mord mathnormal">
           d
          </span>
         </span>
        </span>
       </span>
      </span>
      为非负矩阵。
     </li>
     <li>
      <mark>
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          A 
           
           
           
             x 
            
           
             , 
            
           
             y 
            
           
          
         
           = 
          
         
           f 
          
         
           ( 
          
         
           y 
          
         
           − 
          
         
           x 
          
         
           ) 
          
         
        
          A_{x, y} = f(y - x)
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
           </span>
           <span class="mord">
            <span class="mord mathnormal">
             A
            </span>
            <span class="msupsub">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 0.1514em;">
                <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                 <span class="pstrut" style="height: 2.7em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    x
                   </span>
                   <span class="mpunct mtight">
                    ,
                   </span>
                   <span class="mord mathnormal mtight" style="margin-right: 0.0359em;">
                    y
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                ​
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 0.2861em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mspace" style="margin-right: 0.2778em;">
           </span>
           <span class="mrel">
            =
           </span>
           <span class="mspace" style="margin-right: 0.2778em;">
           </span>
          </span>
          <span class="base">
           <span class="strut" style="height: 1em; vertical-align: -0.25em;">
           </span>
           <span class="mord mathnormal" style="margin-right: 0.1076em;">
            f
           </span>
           <span class="mopen">
            (
           </span>
           <span class="mord mathnormal" style="margin-right: 0.0359em;">
            y
           </span>
           <span class="mspace" style="margin-right: 0.2222em;">
           </span>
           <span class="mbin">
            −
           </span>
           <span class="mspace" style="margin-right: 0.2222em;">
           </span>
          </span>
          <span class="base">
           <span class="strut" style="height: 1em; vertical-align: -0.25em;">
           </span>
           <span class="mord mathnormal">
            x
           </span>
           <span class="mclose">
            )
           </span>
          </span>
         </span>
        </span>
       </span>
       ，其中
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          f 
          
         
           ( 
          
         
           x 
          
         
           ) 
          
         
        
          f(x)
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 1em; vertical-align: -0.25em;">
           </span>
           <span class="mord mathnormal" style="margin-right: 0.1076em;">
            f
           </span>
           <span class="mopen">
            (
           </span>
           <span class="mord mathnormal">
            x
           </span>
           <span class="mclose">
            )
           </span>
          </span>
         </span>
        </span>
       </span>
       为上凸函数。
      </mark>
     </li>
    </ul>
    <h3>
     <a id="_dp_50">
     </a>
     决策单调性优化
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
       
         p 
        
       
      
        dp
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord mathnormal">
          p
         </span>
        </span>
       </span>
      </span>
     </span>
    </h3>
    <h4>
     <a id="_dp_51">
     </a>
     线性
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
       
         p 
        
       
      
        dp
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord mathnormal">
          p
         </span>
        </span>
       </span>
      </span>
     </span>
    </h4>
    <p>
     一般是划分段的
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
       
         p 
        
       
      
        dp
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord mathnormal">
          p
         </span>
        </span>
       </span>
      </span>
     </span>
     。通常会有代价函数
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
         
         
         
           l 
          
         
           , 
          
         
           r 
          
         
        
       
      
        w_{l, r}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0269em;">
           w
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3361em;">
              <span class="" style="top: -2.55em; margin-left: -0.0269em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0197em;">
                  l
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                  r
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     表示将
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        [ 
        
       
         l 
        
       
         , 
        
       
         r 
        
       
         ] 
        
       
      
        [l, r]
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mopen">
          [
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0197em;">
          l
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          r
         </span>
         <span class="mclose">
          ]
         </span>
        </span>
       </span>
      </span>
     </span>
     划分成一段的代价。
     <br/>
     将
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
         
         
         
           l 
          
         
           , 
          
         
           r 
          
         
        
       
      
        w_{l, r}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0269em;">
           w
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3361em;">
              <span class="" style="top: -2.55em; margin-left: -0.0269em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0197em;">
                  l
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                  r
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     看做矩阵第
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        l 
        
       
      
        l
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0197em;">
          l
         </span>
        </span>
       </span>
      </span>
     </span>
     行第
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        r 
        
       
      
        r
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          r
         </span>
        </span>
       </span>
      </span>
     </span>
     列的数，那么
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
      
        w
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0269em;">
          w
         </span>
        </span>
       </span>
      </span>
     </span>
     可看做一个左下角无意义的矩阵。其满足四边形不等式的意义就是区间代价满足
     <strong>
      交叉优于包含
     </strong>
     。
    </p>
    <h5>
     <a id="_54">
     </a>
     分治（离线）
    </h5>
    <p>
     考虑转移式形如
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        f 
         
         
         
           i 
          
         
           , 
          
         
           j 
          
         
        
       
         = 
        
        
         
         
           min 
          
         
           ⁡ 
          
         
         
         
           k 
          
         
           &lt; 
          
         
           j 
          
         
        
        
        
          f 
         
         
         
           i 
          
         
           − 
          
         
           1 
          
         
           , 
          
         
           k 
          
         
        
       
         + 
        
        
        
          w 
         
         
         
           k 
          
         
           , 
          
         
           j 
          
         
        
       
      
        f_{i, j} = \min\limits_{k &lt; j}f_{i - 1, k} + w_{k, j}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.1076em;">
           f
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.1076em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.5827em; vertical-align: -0.8882em;">
         </span>
         <span class="mop op-limits">
          <span class="vlist-t vlist-t2">
           <span class="vlist-r">
            <span class="vlist" style="height: 0.6679em;">
             <span class="" style="top: -2.3479em; margin-left: 0em;">
              <span class="pstrut" style="height: 3em;">
              </span>
              <span class="sizing reset-size6 size3 mtight">
               <span class="mord mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                 k
                </span>
                <span class="mrel mtight">
                 &lt;
                </span>
                <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                 j
                </span>
               </span>
              </span>
             </span>
             <span class="" style="top: -3em;">
              <span class="pstrut" style="height: 3em;">
              </span>
              <span class="">
               <span class="mop">
                min
               </span>
              </span>
             </span>
            </span>
            <span class="vlist-s">
             ​
            </span>
           </span>
           <span class="vlist-r">
            <span class="vlist" style="height: 0.8882em;">
             <span class="">
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.1076em;">
           f
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3361em;">
              <span class="" style="top: -2.55em; margin-left: -0.1076em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mbin mtight">
                  −
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                  k
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0269em;">
           w
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3361em;">
              <span class="" style="top: -2.55em; margin-left: -0.0269em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                  k
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     的
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
       
         p 
        
       
      
        dp
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord mathnormal">
          p
         </span>
        </span>
       </span>
      </span>
     </span>
     ：
    </p>
    <p>
     通常第一维为层数或段数，称这样每一层仅有上一层转移得到的
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
       
         p 
        
       
      
        dp
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord mathnormal">
          p
         </span>
        </span>
       </span>
      </span>
     </span>
     为
     <strong>
      分层转移
     </strong>
     。这样的
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
       
         p 
        
       
      
        dp
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord mathnormal">
          p
         </span>
        </span>
       </span>
      </span>
     </span>
     并不限制转移顺序，可认为每一层内的转移是离线问题。
    </p>
    <p>
     设第二维长度为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        m 
        
       
      
        m
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          m
         </span>
        </span>
       </span>
      </span>
     </span>
     ，
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        f 
         
         
         
           i 
          
         
           − 
          
         
           1 
          
         
        
       
      
        f_{i - 1}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.9028em; vertical-align: -0.2083em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.1076em;">
           f
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.1076em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mbin mtight">
                  −
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2083em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     向
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        f 
         
        
          i 
         
        
       
      
        f_{i}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.1076em;">
           f
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.1076em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     的转移可以用一个
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        m 
        
       
         × 
        
       
         m 
        
       
      
        m \times m
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;">
         </span>
         <span class="mord mathnormal">
          m
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          ×
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          m
         </span>
        </span>
       </span>
      </span>
     </span>
     的矩阵
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        A 
        
       
      
        A
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal">
          A
         </span>
        </span>
       </span>
      </span>
     </span>
     表示：
     <br/>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         A 
          
          
          
            x 
           
          
            , 
           
          
            y 
           
          
         
        
          = 
         
         
         
           { 
          
          
           
            
             
              
               
               
                 f 
                
                
                
                  i 
                 
                
                  − 
                 
                
                  1 
                 
                
                  , 
                 
                
                  y 
                 
                
               
              
                + 
               
               
               
                 w 
                
                
                
                  y 
                 
                
                  , 
                 
                
                  x 
                 
                
               
              
             
            
            
             
              
              
                x 
               
              
                ≥ 
               
              
                y 
               
              
             
            
           
           
            
             
             
               ∞ 
              
             
            
            
             
              
              
                x 
               
              
                &lt; 
               
              
                y 
               
              
             
            
           
          
         
        
       
         A_{x, y} = \left\{\begin{matrix} f_{i - 1, y} +w_{y, x} &amp; x \geq y\\ \infty &amp; x &lt; y \end{matrix}\right.
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.1514em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   x
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mathnormal mtight" style="margin-right: 0.0359em;">
                   y
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 2.4em; vertical-align: -0.95em;">
          </span>
          <span class="minner">
           <span class="mopen delimcenter" style="top: 0em;">
            <span class="delimsizing size3">
             {
             <!-- -->
            </span>
           </span>
           <span class="mord">
            <span class="mtable">
             <span class="col-align-c">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 1.45em;">
                 <span class="" style="top: -3.61em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    <span class="mord mathnormal" style="margin-right: 0.1076em;">
                     f
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.3117em;">
                        <span class="" style="top: -2.55em; margin-left: -0.1076em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight">
                            i
                           </span>
                           <span class="mbin mtight">
                            −
                           </span>
                           <span class="mord mtight">
                            1
                           </span>
                           <span class="mpunct mtight">
                            ,
                           </span>
                           <span class="mord mathnormal mtight" style="margin-right: 0.0359em;">
                            y
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        ​
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.2861em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mbin">
                    +
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mord">
                    <span class="mord mathnormal" style="margin-right: 0.0269em;">
                     w
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.1514em;">
                        <span class="" style="top: -2.55em; margin-left: -0.0269em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight" style="margin-right: 0.0359em;">
                            y
                           </span>
                           <span class="mpunct mtight">
                            ,
                           </span>
                           <span class="mord mathnormal mtight">
                            x
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        ​
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.2861em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -2.41em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    ∞
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 ​
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 0.95em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="arraycolsep" style="width: 0.5em;">
             </span>
             <span class="arraycolsep" style="width: 0.5em;">
             </span>
             <span class="col-align-c">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 1.45em;">
                 <span class="" style="top: -3.61em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal">
                    x
                   </span>
                   <span class="mspace" style="margin-right: 0.2778em;">
                   </span>
                   <span class="mrel">
                    ≥
                   </span>
                   <span class="mspace" style="margin-right: 0.2778em;">
                   </span>
                   <span class="mord mathnormal" style="margin-right: 0.0359em;">
                    y
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -2.41em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal">
                    x
                   </span>
                   <span class="mspace" style="margin-right: 0.2778em;">
                   </span>
                   <span class="mrel">
                    &lt;
                   </span>
                   <span class="mspace" style="margin-right: 0.2778em;">
                   </span>
                   <span class="mord mathnormal" style="margin-right: 0.0359em;">
                    y
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 ​
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 0.95em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mclose nulldelimiter">
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     发现转移矩阵
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        A 
        
       
      
        A
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal">
          A
         </span>
        </span>
       </span>
      </span>
     </span>
     就是
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
      
        w
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0269em;">
          w
         </span>
        </span>
       </span>
      </span>
     </span>
     转置后每一列
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        j 
        
       
      
        j
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.854em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0572em;">
          j
         </span>
        </span>
       </span>
      </span>
     </span>
     加上常数
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        f 
         
         
         
           i 
          
         
           − 
          
         
           1 
          
         
           , 
          
         
           j 
          
         
        
       
      
        f_{i - 1, j}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.1076em;">
           f
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.1076em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mbin mtight">
                  −
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     。
     <br/>
     由蒙日矩阵的性质：若
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
      
        w
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0269em;">
          w
         </span>
        </span>
       </span>
      </span>
     </span>
     满足四边形不等式，那么
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        A 
        
       
      
        A
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal">
          A
         </span>
        </span>
       </span>
      </span>
     </span>
     一定是蒙日阵，满足决策单调性。
    </p>
    <p>
     如何求解：
     <br/>
     定义函数
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        s 
        
       
         o 
        
       
         l 
        
       
         v 
        
       
         e 
        
       
         ( 
        
       
         l 
        
       
         , 
        
       
         r 
        
       
         , 
        
       
         q 
        
       
         l 
        
       
         , 
        
       
         q 
        
       
         r 
        
       
         ) 
        
       
      
        solve(l, r, ql, qr)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal">
          so
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0197em;">
          l
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          v
         </span>
         <span class="mord mathnormal">
          e
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0197em;">
          l
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          r
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0197em;">
          ql
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          q
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          r
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     表示决策范围是
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        [ 
        
       
         l 
        
       
         , 
        
       
         r 
        
       
         ] 
        
       
      
        [l, r]
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mopen">
          [
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0197em;">
          l
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          r
         </span>
         <span class="mclose">
          ]
         </span>
        </span>
       </span>
      </span>
     </span>
     ，要给
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        [ 
        
       
         q 
        
       
         l 
        
       
         , 
        
       
         q 
        
       
         r 
        
       
         ] 
        
       
      
        [ql, qr]
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mopen">
          [
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0197em;">
          ql
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          q
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          r
         </span>
         <span class="mclose">
          ]
         </span>
        </span>
       </span>
      </span>
     </span>
     范围的状态进行转移。
     <br/>
     那么每次找到中间状态
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        m 
        
       
         i 
        
       
         d 
        
       
         = 
        
        
         
         
           q 
          
         
           l 
          
         
           + 
          
         
           q 
          
         
           r 
          
         
        
          2 
         
        
       
      
        mid = \frac{ql + qr}{2}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal">
          mi
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.2772em; vertical-align: -0.345em;">
         </span>
         <span class="mord">
          <span class="mopen nulldelimiter">
          </span>
          <span class="mfrac">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.9322em;">
              <span class="" style="top: -2.655em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  2
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.23em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="frac-line" style="border-bottom-width: 0.04em;">
               </span>
              </span>
              <span class="" style="top: -3.4461em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0197em;">
                  ql
                 </span>
                 <span class="mbin mtight">
                  +
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0359em;">
                  q
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                  r
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.345em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose nulldelimiter">
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ，扫描
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        [ 
        
       
         l 
        
       
         , 
        
       
         r 
        
       
         ] 
        
       
      
        [l, r]
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mopen">
          [
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0197em;">
          l
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          r
         </span>
         <span class="mclose">
          ]
         </span>
        </span>
       </span>
      </span>
     </span>
     找到最优决策点
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        p 
        
       
      
        p
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          p
         </span>
        </span>
       </span>
      </span>
     </span>
     给
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        m 
        
       
         i 
        
       
         d 
        
       
      
        mid
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal">
          mi
         </span>
         <span class="mord mathnormal">
          d
         </span>
        </span>
       </span>
      </span>
     </span>
     进行转移。然后接着递归
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        s 
        
       
         o 
        
       
         l 
        
       
         v 
        
       
         e 
        
       
         ( 
        
       
         l 
        
       
         , 
        
       
         p 
        
       
         , 
        
       
         q 
        
       
         l 
        
       
         , 
        
       
         m 
        
       
         i 
        
       
         d 
        
       
         − 
        
       
         1 
        
       
         ) 
        
       
      
        solve(l, p, ql, mid - 1)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal">
          so
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0197em;">
          l
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          v
         </span>
         <span class="mord mathnormal">
          e
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0197em;">
          l
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          p
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0197em;">
          ql
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          mi
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          −
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     和
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        s 
        
       
         o 
        
       
         l 
        
       
         v 
        
       
         e 
        
       
         ( 
        
       
         p 
        
       
         , 
        
       
         r 
        
       
         , 
        
       
         m 
        
       
         i 
        
       
         d 
        
       
         + 
        
       
         1 
        
       
         , 
        
       
         q 
        
       
         r 
        
       
         ) 
        
       
      
        solve(p, r, mid + 1, qr)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal">
          so
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0197em;">
          l
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          v
         </span>
         <span class="mord mathnormal">
          e
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          p
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          r
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          mi
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          q
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          r
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     。
    </p>
    <p>
     复杂度分析：假设每次求一个决策点的转移值复杂度
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         ( 
        
       
         1 
        
       
         ) 
        
       
      
        O(1)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord">
          1
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     ，那么一共会递归
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         ( 
        
       
         log 
        
       
         ⁡ 
        
       
         n 
        
       
         ) 
        
       
      
        O(\log n)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mop">
          lo
          <span style="margin-right: 0.0139em;">
           g
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     层，每层复杂度
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         ( 
        
       
         n 
        
       
         ) 
        
       
      
        O(n)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     ，总复杂度
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         ( 
        
       
         n 
        
       
         log 
        
       
         ⁡ 
        
       
         n 
        
       
         ) 
        
       
      
        O(n \log n)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mop">
          lo
          <span style="margin-right: 0.0139em;">
           g
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     。
     <br/>
     如果第一维的大小为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     ，那么总复杂度为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         ( 
        
       
         n 
        
       
         k 
        
       
         log 
        
       
         ⁡ 
        
       
         n 
        
       
         ) 
        
       
      
        O(nk \log n)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          nk
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mop">
          lo
          <span style="margin-right: 0.0139em;">
           g
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     。
    </p>
    <p>
     局限性：只能离线，如果使用
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        c 
        
       
         d 
        
       
         q 
        
       
      
        cdq
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          c
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          q
         </span>
        </span>
       </span>
      </span>
     </span>
     会多一个
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        l 
        
       
         o 
        
       
         g 
        
       
      
        log
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0197em;">
          l
         </span>
         <span class="mord mathnormal">
          o
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          g
         </span>
        </span>
       </span>
      </span>
     </span>
     。
     <br/>
     优点：好写，只要求是
     <strong>
      单调矩阵
     </strong>
     。
     <mark>
      当
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         A 
          
          
          
            i 
           
          
            , 
           
          
            j 
           
          
         
        
       
         A_{i, j}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.3117em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   i
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                   j
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      不好计算时可以通过跳转指针增量求得
     </mark>
     。
    </p>
    <h5>
     <a id="_78">
     </a>
     二分队列（在线）
    </h5>
    <p>
     考虑转移式形如
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        f 
         
        
          i 
         
        
       
         = 
        
        
         
         
           min 
          
         
           ⁡ 
          
         
         
         
           j 
          
         
           &lt; 
          
         
           i 
          
         
        
        
        
          f 
         
        
          j 
         
        
       
         + 
        
        
        
          w 
         
         
         
           j 
          
         
           , 
          
         
           i 
          
         
        
       
      
        f_{i} = \min\limits_{j &lt; i} f_j + w_{j, i}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.1076em;">
           f
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.1076em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.5582em; vertical-align: -0.8638em;">
         </span>
         <span class="mop op-limits">
          <span class="vlist-t vlist-t2">
           <span class="vlist-r">
            <span class="vlist" style="height: 0.6679em;">
             <span class="" style="top: -2.3723em; margin-left: 0em;">
              <span class="pstrut" style="height: 3em;">
              </span>
              <span class="sizing reset-size6 size3 mtight">
               <span class="mord mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                 j
                </span>
                <span class="mrel mtight">
                 &lt;
                </span>
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="" style="top: -3em;">
              <span class="pstrut" style="height: 3em;">
              </span>
              <span class="">
               <span class="mop">
                min
               </span>
              </span>
             </span>
            </span>
            <span class="vlist-s">
             ​
            </span>
           </span>
           <span class="vlist-r">
            <span class="vlist" style="height: 0.8638em;">
             <span class="">
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.1076em;">
           f
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.1076em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                 j
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0269em;">
           w
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0269em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     的
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
       
         p 
        
       
      
        dp
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord mathnormal">
          p
         </span>
        </span>
       </span>
      </span>
     </span>
     :
    </p>
    <p>
     发现转移顺序只能从小到大，视为在线问题。
    </p>
    <p>
     与上面类似，转移同样可以写成一个
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        m 
        
       
         × 
        
       
         m 
        
       
      
        m \times m
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;">
         </span>
         <span class="mord mathnormal">
          m
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          ×
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          m
         </span>
        </span>
       </span>
      </span>
     </span>
     的矩阵：
     <br/>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         A 
          
          
          
            x 
           
          
            , 
           
          
            y 
           
          
         
        
          = 
         
         
         
           { 
          
          
           
            
             
              
               
               
                 f 
                
               
                 y 
                
               
              
                + 
               
               
               
                 w 
                
                
                
                  y 
                 
                
                  , 
                 
                
                  x 
                 
                
               
              
             
            
            
             
              
              
                x 
               
              
                ≥ 
               
              
                y 
               
              
             
            
           
           
            
             
             
               ∞ 
              
             
            
            
             
              
              
                x 
               
              
                &lt; 
               
              
                y 
               
              
             
            
           
          
         
        
       
         A_{x, y} = \left\{\begin{matrix} f_{y} +w_{y, x} &amp; x \geq y\\ \infty &amp; x &lt; y \end{matrix}\right.
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
          </span>
          <span class="mord">
           <span class="mord mathnormal">
            A
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.1514em;">
               <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   x
                  </span>
                  <span class="mpunct mtight">
                   ,
                  </span>
                  <span class="mord mathnormal mtight" style="margin-right: 0.0359em;">
                   y
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.2861em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.2778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 2.4em; vertical-align: -0.95em;">
          </span>
          <span class="minner">
           <span class="mopen delimcenter" style="top: 0em;">
            <span class="delimsizing size3">
             {
             <!-- -->
            </span>
           </span>
           <span class="mord">
            <span class="mtable">
             <span class="col-align-c">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 1.45em;">
                 <span class="" style="top: -3.61em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    <span class="mord mathnormal" style="margin-right: 0.1076em;">
                     f
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.1514em;">
                        <span class="" style="top: -2.55em; margin-left: -0.1076em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight" style="margin-right: 0.0359em;">
                            y
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        ​
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.2861em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mbin">
                    +
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mord">
                    <span class="mord mathnormal" style="margin-right: 0.0269em;">
                     w
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.1514em;">
                        <span class="" style="top: -2.55em; margin-left: -0.0269em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight" style="margin-right: 0.0359em;">
                            y
                           </span>
                           <span class="mpunct mtight">
                            ,
                           </span>
                           <span class="mord mathnormal mtight">
                            x
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        ​
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.2861em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -2.41em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    ∞
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 ​
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 0.95em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="arraycolsep" style="width: 0.5em;">
             </span>
             <span class="arraycolsep" style="width: 0.5em;">
             </span>
             <span class="col-align-c">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 1.45em;">
                 <span class="" style="top: -3.61em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal">
                    x
                   </span>
                   <span class="mspace" style="margin-right: 0.2778em;">
                   </span>
                   <span class="mrel">
                    ≥
                   </span>
                   <span class="mspace" style="margin-right: 0.2778em;">
                   </span>
                   <span class="mord mathnormal" style="margin-right: 0.0359em;">
                    y
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -2.41em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal">
                    x
                   </span>
                   <span class="mspace" style="margin-right: 0.2778em;">
                   </span>
                   <span class="mrel">
                    &lt;
                   </span>
                   <span class="mspace" style="margin-right: 0.2778em;">
                   </span>
                   <span class="mord mathnormal" style="margin-right: 0.0359em;">
                    y
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 ​
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 0.95em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mclose nulldelimiter">
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     不同点在于这个是在线的每次将一列加一个常数。
     <br/>
     但是并不影响蒙日阵的性质，因此如果
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
      
        w
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0269em;">
          w
         </span>
        </span>
       </span>
      </span>
     </span>
     满足四边形不等式那么
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        A 
        
       
      
        A
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal">
          A
         </span>
        </span>
       </span>
      </span>
     </span>
     同样具有决策单调性。
    </p>
    <p>
     如何求解：
     <br/>
     对每个点维护当前它的最有决策点。具体的说：开一个队列存储三元组
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        ( 
        
       
         l 
        
       
         , 
        
       
         r 
        
       
         , 
        
       
         x 
        
       
         ) 
        
       
      
        (l, r, x)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0197em;">
          l
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          r
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          x
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     ，表示当前
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        [ 
        
       
         l 
        
       
         , 
        
       
         r 
        
       
         ] 
        
       
      
        [l, r]
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mopen">
          [
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0197em;">
          l
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          r
         </span>
         <span class="mclose">
          ]
         </span>
        </span>
       </span>
      </span>
     </span>
     状态的最优决策点为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        x 
        
       
      
        x
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          x
         </span>
        </span>
       </span>
      </span>
     </span>
     。那么每次拿出队头的
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        i 
        
       
      
        i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6595em;">
         </span>
         <span class="mord mathnormal">
          i
         </span>
        </span>
       </span>
      </span>
     </span>
     并用决策点更新它，考虑
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        l 
        
       
      
        l
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0197em;">
          l
         </span>
        </span>
       </span>
      </span>
     </span>
     会更新那些状态的决策点：不难发现由于决策单调性因此影响的是一段后缀。因此从后往前合并决策点被更新成
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        i 
        
       
      
        i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6595em;">
         </span>
         <span class="mord mathnormal">
          i
         </span>
        </span>
       </span>
      </span>
     </span>
     的连续段，如果更新后缀的端点在一段的中间，就二分找到这个端点然后将这一段分裂。
    </p>
    <p>
     复杂度分析：不难发现每次最多新开一段，并且一段只会被合并一次，因此合并连续段的复杂度均摊
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         ( 
        
       
         n 
        
       
         ) 
        
       
      
        O(n)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     。但是每次在段内二分，因此总复杂度
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         ( 
        
       
         n 
        
       
         log 
        
       
         ⁡ 
        
       
         n 
        
       
         ) 
        
       
      
        O(n \log n)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mop">
          lo
          <span style="margin-right: 0.0139em;">
           g
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     。
    </p>
    <p>
     局限性：需要矩阵满足
     <strong>
      完全单调
     </strong>
     。
     <br/>
     优点：离线和在线通用。
    </p>
    <h5>
     <a id="SMAWK_101">
     </a>
     SMAWK
    </h5>
    <p>
     不会，先鸽了。
    </p>
    <h4>
     <a id="_dp_103">
     </a>
     区间
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
       
         p 
        
       
      
        dp
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord mathnormal">
          p
         </span>
        </span>
       </span>
      </span>
     </span>
    </h4>
    <p>
     考虑对于形如
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
        
        
          p 
         
         
         
           l 
          
         
           , 
          
         
           r 
          
         
        
       
         = 
        
        
         
         
           min 
          
         
           ⁡ 
          
         
         
         
           l 
          
         
           ≤ 
          
         
           k 
          
         
           ≤ 
          
         
           r 
          
         
        
       
         d 
        
        
        
          p 
         
         
         
           l 
          
         
           , 
          
         
           k 
          
         
        
       
         + 
        
       
         d 
        
        
        
          p 
         
         
         
           k 
          
         
           + 
          
         
           1 
          
         
           , 
          
         
           r 
          
         
        
       
         + 
        
        
        
          w 
         
         
         
           l 
          
         
           , 
          
         
           r 
          
         
        
       
      
        dp_{l, r} = \min\limits_{l \leq k \leq r}dp_{l, k} + dp_{k + 1, r} +w_{l, r}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           p
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3361em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0197em;">
                  l
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                  r
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.5417em; vertical-align: -0.8473em;">
         </span>
         <span class="mop op-limits">
          <span class="vlist-t vlist-t2">
           <span class="vlist-r">
            <span class="vlist" style="height: 0.6679em;">
             <span class="" style="top: -2.3479em; margin-left: 0em;">
              <span class="pstrut" style="height: 3em;">
              </span>
              <span class="sizing reset-size6 size3 mtight">
               <span class="mord mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.0197em;">
                 l
                </span>
                <span class="mrel mtight">
                 ≤
                </span>
                <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                 k
                </span>
                <span class="mrel mtight">
                 ≤
                </span>
                <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                 r
                </span>
               </span>
              </span>
             </span>
             <span class="" style="top: -3em;">
              <span class="pstrut" style="height: 3em;">
              </span>
              <span class="">
               <span class="mop">
                min
               </span>
              </span>
             </span>
            </span>
            <span class="vlist-s">
             ​
            </span>
           </span>
           <span class="vlist-r">
            <span class="vlist" style="height: 0.8473em;">
             <span class="">
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           p
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3361em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0197em;">
                  l
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                  k
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           p
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3361em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                  k
                 </span>
                 <span class="mbin mtight">
                  +
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                  r
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0269em;">
           w
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3361em;">
              <span class="" style="top: -2.55em; margin-left: -0.0269em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0197em;">
                  l
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                  r
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     的区间
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
       
         p 
        
       
      
        dp
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord mathnormal">
          p
         </span>
        </span>
       </span>
      </span>
     </span>
     ：
    </p>
    <p>
     结论：
     <br/>
     若
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
      
        w
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0269em;">
          w
         </span>
        </span>
       </span>
      </span>
     </span>
     满足四边形不等式 且满足
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        ∀ 
        
       
         l 
        
       
         ≤ 
        
        
        
          l 
         
        
          ′ 
         
        
       
         ≤ 
        
        
        
          r 
         
        
          ′ 
         
        
       
         ≤ 
        
       
         r 
        
       
         , 
        
        
        
          w 
         
         
          
          
            l 
           
          
            ′ 
           
          
         
           , 
          
          
          
            r 
           
          
            ′ 
           
          
         
        
       
         ≤ 
        
        
        
          w 
         
         
         
           l 
          
         
           , 
          
         
           r 
          
         
        
       
      
        \forall l \leq l' \leq r' \leq r,w_{l',r'} \leq w_{l,r}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8304em; vertical-align: -0.136em;">
         </span>
         <span class="mord">
          ∀
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0197em;">
          l
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8879em; vertical-align: -0.136em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0197em;">
           l
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7519em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  ′
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8879em; vertical-align: -0.136em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           r
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7519em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  ′
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.9221em; vertical-align: -0.2861em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          r
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0269em;">
           w
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3361em;">
              <span class="" style="top: -2.55em; margin-left: -0.0269em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0197em;">
                   l
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.6828em;">
                      <span class="" style="top: -2.786em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         <span class="mord mtight">
                          ′
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                   r
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.6828em;">
                      <span class="" style="top: -2.786em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         <span class="mord mtight">
                          ′
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0269em;">
           w
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3361em;">
              <span class="" style="top: -2.55em; margin-left: -0.0269em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0197em;">
                  l
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                  r
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     (区间单调性)，那么转移具有决策单调性。
     <br/>
     设
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        p 
         
         
         
           i 
          
         
           , 
          
         
           j 
          
         
        
       
      
        p_{i, j}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           p
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     表示
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
        
        
          p 
         
         
         
           i 
          
         
           , 
          
         
           j 
          
         
        
       
      
        dp_{i, j}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           p
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     的最优决策点，那么有
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        p 
         
         
         
           i 
          
         
           − 
          
         
           1 
          
         
           , 
          
         
           j 
          
         
        
       
         ≤ 
        
        
        
          p 
         
         
         
           i 
          
         
           , 
          
         
           j 
          
         
        
       
         ≤ 
        
        
        
          p 
         
         
         
           i 
          
         
           , 
          
         
           j 
          
         
           + 
          
         
           1 
          
         
        
       
      
        p_{i - 1, j} \leq p_{i, j} \leq p_{i, j + 1}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.9221em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           p
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mbin mtight">
                  −
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.9221em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           p
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           p
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                 <span class="mbin mtight">
                  +
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     。
    </p>
    <p>
     可以通过记录
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        p 
        
       
      
        p
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          p
         </span>
        </span>
       </span>
      </span>
     </span>
     然后缩小枚举范围的方式将复杂度优化到
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         ( 
        
        
        
          n 
         
        
          2 
         
        
       
         ) 
        
       
      
        O(n^2)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.0641em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           n
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8141em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 2
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     。
    </p>
    <p>
     证明：
     <s>
      不会
     </s>
     。
    </p>
    <h3>
     <a id="_114">
     </a>
     练习题
    </h3>
    <h4>
     <a id="LOJ6039_115">
     </a>
     LOJ6039
    </h4>
    <p>
     有
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        n 
        
       
      
        n
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
        </span>
       </span>
      </span>
     </span>
     个物品，每个物品体积为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
         
        
          i 
         
        
       
      
        w_i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0269em;">
           w
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0269em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ，价值为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        v 
         
        
          i 
         
        
       
      
        v_i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           v
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     。
     <br/>
     求当背包体积为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        1 
        
       
         ∼ 
        
       
         k 
        
       
      
        1 \sim k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ∼
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     时的最大价值。
     <br/>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        n 
        
       
         ≤ 
        
       
         1 
        
        
        
          0 
         
        
          6 
         
        
       
         , 
        
        
        
          w 
         
        
          i 
         
        
       
         ≤ 
        
       
         300 
        
       
         , 
        
       
         k 
        
       
         ≤ 
        
       
         5 
        
       
         × 
        
       
         1 
        
        
        
          0 
         
        
          4 
         
        
       
      
        n \leq 10^6,w_i \leq300, k \leq 5 \times 10^4
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7719em; vertical-align: -0.136em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.0085em; vertical-align: -0.1944em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mord">
          <span class="mord">
           0
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8141em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 6
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0269em;">
           w
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0269em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord">
          300
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;">
         </span>
         <span class="mord">
          5
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          ×
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8141em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mord">
          <span class="mord">
           0
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8141em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 4
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     。
    </p>
    <p>
     分析：
     <br/>
     直接做
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        01 
        
       
      
        01
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          01
         </span>
        </span>
       </span>
      </span>
     </span>
     背包复杂度为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         ( 
        
       
         n 
        
       
         k 
        
       
         ) 
        
       
      
        O(nk)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          nk
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     ，显然过不了。
     <br/>
     注意到物品体积值域较小，启示我们把体积相同的物品一起考虑。
     <br/>
     设
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
        
        
          p 
         
         
         
           c 
          
         
           , 
          
         
           v 
          
         
        
       
      
        dp_{c, v}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           p
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.1514em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  c
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0359em;">
                  v
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     表示考虑了体积为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        1 
        
       
         ∼ 
        
       
         c 
        
       
      
        1 \sim c
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ∼
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          c
         </span>
        </span>
       </span>
      </span>
     </span>
     的物品，当前背包体积为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        v 
        
       
      
        v
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          v
         </span>
        </span>
       </span>
      </span>
     </span>
     的最大价值。
     <br/>
     转移显然把
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        v 
        
       
         % 
        
       
         c 
        
       
      
        v\%c
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8056em; vertical-align: -0.0556em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          v
         </span>
         <span class="mord">
          %
         </span>
         <span class="mord mathnormal">
          c
         </span>
        </span>
       </span>
      </span>
     </span>
     后分组：
     <br/>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
        
        
          p 
         
         
         
           c 
          
         
           , 
          
         
           c 
          
         
           × 
          
         
           i 
          
         
           + 
          
         
           r 
          
         
        
       
         = 
        
        
         
         
           max 
          
         
           ⁡ 
          
         
         
         
           j 
          
         
           ≤ 
          
         
           i 
          
         
        
       
         d 
        
        
        
          p 
         
         
         
           c 
          
         
           − 
          
         
           1 
          
         
           , 
          
         
           c 
          
         
           × 
          
         
           j 
          
         
           + 
          
         
           r 
          
         
        
       
         + 
        
       
         f 
        
       
         ( 
        
       
         c 
        
       
         , 
        
       
         i 
        
       
         − 
        
       
         j 
        
       
         ) 
        
       
      
        dp_{c, c \times i + r} = \max\limits_{j \leq i}dp_{c - 1, c \times j + r} + f(c, i - j)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           p
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  c
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight">
                  c
                 </span>
                 <span class="mbin mtight">
                  ×
                 </span>
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mbin mtight">
                  +
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                  r
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.5582em; vertical-align: -0.8638em;">
         </span>
         <span class="mop op-limits">
          <span class="vlist-t vlist-t2">
           <span class="vlist-r">
            <span class="vlist" style="height: 0.4306em;">
             <span class="" style="top: -2.3723em; margin-left: 0em;">
              <span class="pstrut" style="height: 3em;">
              </span>
              <span class="sizing reset-size6 size3 mtight">
               <span class="mord mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                 j
                </span>
                <span class="mrel mtight">
                 ≤
                </span>
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="" style="top: -3em;">
              <span class="pstrut" style="height: 3em;">
              </span>
              <span class="">
               <span class="mop">
                max
               </span>
              </span>
             </span>
            </span>
            <span class="vlist-s">
             ​
            </span>
           </span>
           <span class="vlist-r">
            <span class="vlist" style="height: 0.8638em;">
             <span class="">
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           p
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  c
                 </span>
                 <span class="mbin mtight">
                  −
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight">
                  c
                 </span>
                 <span class="mbin mtight">
                  ×
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                 <span class="mbin mtight">
                  +
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0278em;">
                  r
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1076em;">
          f
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          c
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          i
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          −
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0572em;">
          j
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     其中
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        f 
        
       
         ( 
        
       
         c 
        
       
         , 
        
       
         x 
        
       
         ) 
        
       
      
        f(c, x)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1076em;">
          f
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          c
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          x
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     表示体积为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        c 
        
       
      
        c
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          c
         </span>
        </span>
       </span>
      </span>
     </span>
     的物品价值前
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        x 
        
       
      
        x
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          x
         </span>
        </span>
       </span>
      </span>
     </span>
     大的物品的价值之和。
     <br/>
     发现这与
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
        
        
          p 
         
         
         
           k 
          
         
           , 
          
         
           i 
          
         
        
       
         = 
        
        
         
         
           max 
          
         
           ⁡ 
          
         
         
         
           j 
          
         
           ≤ 
          
         
           i 
          
         
        
       
         d 
        
        
        
          p 
         
         
         
           k 
          
         
           − 
          
         
           1 
          
         
           , 
          
         
           j 
          
         
        
       
         + 
        
        
        
          w 
         
         
         
           j 
          
         
           , 
          
         
           i 
          
         
        
       
      
        dp_{k, i} = \max\limits_{j \leq i}dp_{k - 1, j} + w_{j, i}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           p
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3361em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                  k
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.5582em; vertical-align: -0.8638em;">
         </span>
         <span class="mop op-limits">
          <span class="vlist-t vlist-t2">
           <span class="vlist-r">
            <span class="vlist" style="height: 0.4306em;">
             <span class="" style="top: -2.3723em; margin-left: 0em;">
              <span class="pstrut" style="height: 3em;">
              </span>
              <span class="sizing reset-size6 size3 mtight">
               <span class="mord mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                 j
                </span>
                <span class="mrel mtight">
                 ≤
                </span>
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="" style="top: -3em;">
              <span class="pstrut" style="height: 3em;">
              </span>
              <span class="">
               <span class="mop">
                max
               </span>
              </span>
             </span>
            </span>
            <span class="vlist-s">
             ​
            </span>
           </span>
           <span class="vlist-r">
            <span class="vlist" style="height: 0.8638em;">
             <span class="">
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           p
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3361em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                  k
                 </span>
                 <span class="mbin mtight">
                  −
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0269em;">
           w
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0269em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     的形式非常像，只是
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
         
         
         
           j 
          
         
           , 
          
         
           i 
          
         
        
       
         = 
        
       
         f 
        
       
         ( 
        
       
         c 
        
       
         , 
        
       
         i 
        
       
         − 
        
       
         j 
        
       
         ) 
        
       
      
        w_{j, i} = f(c, i - j)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0269em;">
           w
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0269em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1076em;">
          f
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          c
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          i
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          −
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0572em;">
          j
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     。
     <br/>
     注意到
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        f 
        
       
         ( 
        
       
         c 
        
       
         , 
        
       
         x 
        
       
         ) 
        
       
      
        f(c, x)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1076em;">
          f
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          c
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          x
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     是上凸的，因此
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
      
        w
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0269em;">
          w
         </span>
        </span>
       </span>
      </span>
     </span>
     满足四边形不等式，每一组的转移满足决策单调性。
     <br/>
     那么将每一组跑一遍决策单调性优化
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
       
         p 
        
       
      
        dp
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord mathnormal">
          p
         </span>
        </span>
       </span>
      </span>
     </span>
     即可。
     <br/>
     复杂度分析：对于一个
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        c 
        
       
      
        c
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          c
         </span>
        </span>
       </span>
      </span>
     </span>
     ，一共有
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        c 
        
       
      
        c
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          c
         </span>
        </span>
       </span>
      </span>
     </span>
     组，每一组有
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
         
        
          c 
         
        
       
      
        \frac{k}{c}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.2251em; vertical-align: -0.345em;">
         </span>
         <span class="mord">
          <span class="mopen nulldelimiter">
          </span>
          <span class="mfrac">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8801em;">
              <span class="" style="top: -2.655em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  c
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.23em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="frac-line" style="border-bottom-width: 0.04em;">
               </span>
              </span>
              <span class="" style="top: -3.394em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                  k
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.345em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose nulldelimiter">
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     个状态，因此复杂度为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         ( 
        
       
         c 
        
       
         × 
        
        
        
          k 
         
        
          c 
         
        
       
         × 
        
       
         log 
        
       
         ⁡ 
        
        
        
          k 
         
        
          c 
         
        
       
         ) 
        
       
         = 
        
       
         O 
        
       
         ( 
        
       
         k 
        
       
         × 
        
       
         log 
        
       
         ⁡ 
        
        
        
          k 
         
        
          c 
         
        
       
         ) 
        
       
      
        O(c \times \frac{k}{c} \times \log\frac{k}{c}) = O(k \times \log \frac{k}{c})
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          c
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          ×
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.2251em; vertical-align: -0.345em;">
         </span>
         <span class="mord">
          <span class="mopen nulldelimiter">
          </span>
          <span class="mfrac">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8801em;">
              <span class="" style="top: -2.655em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  c
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.23em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="frac-line" style="border-bottom-width: 0.04em;">
               </span>
              </span>
              <span class="" style="top: -3.394em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                  k
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.345em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose nulldelimiter">
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          ×
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.2251em; vertical-align: -0.345em;">
         </span>
         <span class="mop">
          lo
          <span style="margin-right: 0.0139em;">
           g
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          <span class="mopen nulldelimiter">
          </span>
          <span class="mfrac">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8801em;">
              <span class="" style="top: -2.655em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  c
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.23em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="frac-line" style="border-bottom-width: 0.04em;">
               </span>
              </span>
              <span class="" style="top: -3.394em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                  k
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.345em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose nulldelimiter">
          </span>
         </span>
         <span class="mclose">
          )
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          ×
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.2251em; vertical-align: -0.345em;">
         </span>
         <span class="mop">
          lo
          <span style="margin-right: 0.0139em;">
           g
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          <span class="mopen nulldelimiter">
          </span>
          <span class="mfrac">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8801em;">
              <span class="" style="top: -2.655em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  c
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.23em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="frac-line" style="border-bottom-width: 0.04em;">
               </span>
              </span>
              <span class="" style="top: -3.394em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                  k
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.345em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose nulldelimiter">
          </span>
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     。总复杂度为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         ( 
        
        
        
          ∑ 
         
         
         
           c 
          
         
           ≤ 
          
         
           m 
          
         
           a 
          
          
          
            x 
           
          
            w 
           
          
         
        
       
         k 
        
       
         × 
        
       
         log 
        
       
         ⁡ 
        
        
        
          k 
         
        
          c 
         
        
       
         ) 
        
       
      
        O(\sum\limits_{c \leq max_w}k \times \log \frac{k}{c})
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.8113em; vertical-align: -1.0613em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mop op-limits">
          <span class="vlist-t vlist-t2">
           <span class="vlist-r">
            <span class="vlist" style="height: 0.75em;">
             <span class="" style="top: -2.1388em; margin-left: 0em;">
              <span class="pstrut" style="height: 3em;">
              </span>
              <span class="sizing reset-size6 size3 mtight">
               <span class="mord mtight">
                <span class="mord mathnormal mtight">
                 c
                </span>
                <span class="mrel mtight">
                 ≤
                </span>
                <span class="mord mathnormal mtight">
                 ma
                </span>
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  x
                 </span>
                 <span class="msupsub">
                  <span class="vlist-t vlist-t2">
                   <span class="vlist-r">
                    <span class="vlist" style="height: 0.1645em;">
                     <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                      <span class="pstrut" style="height: 2.5em;">
                      </span>
                      <span class="sizing reset-size3 size1 mtight">
                       <span class="mord mathnormal mtight" style="margin-right: 0.0269em;">
                        w
                       </span>
                      </span>
                     </span>
                    </span>
                    <span class="vlist-s">
                     ​
                    </span>
                   </span>
                   <span class="vlist-r">
                    <span class="vlist" style="height: 0.143em;">
                     <span class="">
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="" style="top: -3em;">
              <span class="pstrut" style="height: 3em;">
              </span>
              <span class="">
               <span class="mop op-symbol small-op">
                ∑
               </span>
              </span>
             </span>
            </span>
            <span class="vlist-s">
             ​
            </span>
           </span>
           <span class="vlist-r">
            <span class="vlist" style="height: 1.0613em;">
             <span class="">
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          ×
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.2251em; vertical-align: -0.345em;">
         </span>
         <span class="mop">
          lo
          <span style="margin-right: 0.0139em;">
           g
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          <span class="mopen nulldelimiter">
          </span>
          <span class="mfrac">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8801em;">
              <span class="" style="top: -2.655em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  c
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.23em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="frac-line" style="border-bottom-width: 0.04em;">
               </span>
              </span>
              <span class="" style="top: -3.394em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                  k
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.345em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose nulldelimiter">
          </span>
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     ，卡常可过。
    </p>
    <h2>
     <a id="wqs__131">
     </a>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
         q 
        
       
         s 
        
       
      
        wqs
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          wq
         </span>
         <span class="mord mathnormal">
          s
         </span>
        </span>
       </span>
      </span>
     </span>
     二分（蒙日阵最短路）
    </h2>
    <h3>
     <a id="_133">
     </a>
     算法
    </h3>
    <p>
     考虑转移式形如
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        f 
         
         
         
           i 
          
         
           , 
          
         
           j 
          
         
        
       
         = 
        
        
         
         
           min 
          
         
           ⁡ 
          
         
         
         
           k 
          
         
           &lt; 
          
         
           j 
          
         
        
        
        
          f 
         
         
         
           i 
          
         
           − 
          
         
           1 
          
         
           , 
          
         
           k 
          
         
        
       
         + 
        
        
        
          w 
         
         
         
           k 
          
         
           , 
          
         
           j 
          
         
        
       
      
        f_{i, j} = \min\limits_{k &lt; j}f_{i - 1, k} + w_{k, j}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.1076em;">
           f
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.1076em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.5827em; vertical-align: -0.8882em;">
         </span>
         <span class="mop op-limits">
          <span class="vlist-t vlist-t2">
           <span class="vlist-r">
            <span class="vlist" style="height: 0.6679em;">
             <span class="" style="top: -2.3479em; margin-left: 0em;">
              <span class="pstrut" style="height: 3em;">
              </span>
              <span class="sizing reset-size6 size3 mtight">
               <span class="mord mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                 k
                </span>
                <span class="mrel mtight">
                 &lt;
                </span>
                <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                 j
                </span>
               </span>
              </span>
             </span>
             <span class="" style="top: -3em;">
              <span class="pstrut" style="height: 3em;">
              </span>
              <span class="">
               <span class="mop">
                min
               </span>
              </span>
             </span>
            </span>
            <span class="vlist-s">
             ​
            </span>
           </span>
           <span class="vlist-r">
            <span class="vlist" style="height: 0.8882em;">
             <span class="">
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.1076em;">
           f
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3361em;">
              <span class="" style="top: -2.55em; margin-left: -0.1076em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mbin mtight">
                  −
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                  k
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0269em;">
           w
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3361em;">
              <span class="" style="top: -2.55em; margin-left: -0.0269em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                  k
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     的
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
       
         p 
        
       
      
        dp
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord mathnormal">
          p
         </span>
        </span>
       </span>
      </span>
     </span>
     ：
     <br/>
     刚才我们说，这是一类离线问题，如果
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
      
        w
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0269em;">
          w
         </span>
        </span>
       </span>
      </span>
     </span>
     是蒙日阵，假设第一维大小为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     ，第二维大小为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        n 
        
       
      
        n
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
        </span>
       </span>
      </span>
     </span>
     ，那么可以再
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         ( 
        
       
         n 
        
       
         k 
        
       
         log 
        
       
         ⁡ 
        
       
         n 
        
       
         ) 
        
       
      
        O(nk\log n)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          nk
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mop">
          lo
          <span style="margin-right: 0.0139em;">
           g
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     的复杂度求解。
    </p>
    <p>
     但是如果第一维很大，复杂度就会爆炸。
     <br/>
     但是如果最后只需要回答
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        f 
         
         
         
           k 
          
         
           , 
          
         
           n 
          
         
        
       
      
        f_{k, n}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.1076em;">
           f
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3361em;">
              <span class="" style="top: -2.55em; margin-left: -0.1076em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                  k
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight">
                  n
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ，其中
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     是固定的，那么可以通过
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
         q 
        
       
         s 
        
       
      
        wqs
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          wq
         </span>
         <span class="mord mathnormal">
          s
         </span>
        </span>
       </span>
      </span>
     </span>
     二分优化复杂度。
     <br/>
     通常这类问题的标志是：
     <strong>
      恰好分成
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         k 
         
        
       
         k
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6944em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0315em;">
           k
          </span>
         </span>
        </span>
       </span>
      </span>
      段
     </strong>
     。
    </p>
    <p>
     <mark>
      做法
     </mark>
     ：
     <br/>
     一. 转化成恰好走
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     条边的最短路问题
    </p>
    <p>
     观察上述转移式，发现可以把
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        f 
         
         
         
           i 
          
         
           , 
          
         
           j 
          
         
        
       
      
        f_{i, j}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.1076em;">
           f
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.1076em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     的含义理解成
     <strong>
      从起点出发，经过了恰好
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         i 
         
        
       
         i
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6595em;">
          </span>
          <span class="mord mathnormal">
           i
          </span>
         </span>
        </span>
       </span>
      </span>
      条边，到达了
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         j 
         
        
       
         j
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.854em; vertical-align: -0.1944em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0572em;">
           j
          </span>
         </span>
        </span>
       </span>
      </span>
      号点
     </strong>
     的最短路。
     <br/>
     其中
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        i 
        
       
         → 
        
       
         j 
        
       
      
        i \to j
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6595em;">
         </span>
         <span class="mord mathnormal">
          i
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          →
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.854em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0572em;">
          j
         </span>
        </span>
       </span>
      </span>
     </span>
     的边权为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
         
         
         
           i 
          
         
           , 
          
         
           j 
          
         
        
       
      
        w_{i, j}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0269em;">
           w
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0269em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ，当
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        i 
        
       
         &gt; 
        
       
         j 
        
       
      
        i &gt; j
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6986em; vertical-align: -0.0391em;">
         </span>
         <span class="mord mathnormal">
          i
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          &gt;
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.854em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0572em;">
          j
         </span>
        </span>
       </span>
      </span>
     </span>
     时，
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
         
         
         
           i 
          
         
           , 
          
         
           j 
          
         
        
       
         = 
        
       
         ∞ 
        
       
      
        w_{i, j} = \infty
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0269em;">
           w
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0269em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord">
          ∞
         </span>
        </span>
       </span>
      </span>
     </span>
     。
     <br/>
     实际上这张图的邻接矩阵就是
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
      
        w
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0269em;">
          w
         </span>
        </span>
       </span>
      </span>
     </span>
     ，
     <strong>
      它是一个蒙日阵
     </strong>
     。
     <br/>
     那么答案就是从起点出发，恰好走
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     条边到达
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        n 
        
       
      
        n
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
        </span>
       </span>
      </span>
     </span>
     的最短路。
    </p>
    <p>
     二. 证明凸性
    </p>
    <p>
     设
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        g 
        
       
         ( 
        
       
         k 
        
       
         ) 
        
       
         = 
        
        
        
          f 
         
         
         
           k 
          
         
           , 
          
         
           n 
          
         
        
       
      
        g(k) = f_{k, n}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          g
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mclose">
          )
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.1076em;">
           f
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3361em;">
              <span class="" style="top: -2.55em; margin-left: -0.1076em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                  k
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight">
                  n
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     。那么有结论：当
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
      
        w
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0269em;">
          w
         </span>
        </span>
       </span>
      </span>
     </span>
     为蒙日阵时，
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        g 
        
       
         ( 
        
       
         k 
        
       
         ) 
        
       
      
        g(k)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          g
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     是关于
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     的下凸函数。（如果取
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        m 
        
       
         a 
        
       
         x 
        
       
      
        max
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          ma
         </span>
         <span class="mord mathnormal">
          x
         </span>
        </span>
       </span>
      </span>
     </span>
     就是上凸函数）
    </p>
    <p>
     证明：
     <br/>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        g 
        
       
         ( 
        
       
         k 
        
       
         ) 
        
       
      
        g(k)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          g
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     为下凸函数等价于
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        ∀ 
        
       
         k 
        
       
         ∈ 
        
       
         [ 
        
       
         2 
        
       
         , 
        
       
         n 
        
       
         − 
        
       
         1 
        
       
         ] 
        
       
      
        \forall k \in[2, n - 1]
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7335em; vertical-align: -0.0391em;">
         </span>
         <span class="mord">
          ∀
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ∈
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mopen">
          [
         </span>
         <span class="mord">
          2
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          −
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mclose">
          ]
         </span>
        </span>
       </span>
      </span>
     </span>
     ，
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        g 
        
       
         ( 
        
       
         k 
        
       
         ) 
        
       
         − 
        
       
         g 
        
       
         ( 
        
       
         k 
        
       
         − 
        
       
         1 
        
       
         ) 
        
       
         ≤ 
        
       
         g 
        
       
         ( 
        
       
         k 
        
       
         + 
        
       
         1 
        
       
         ) 
        
       
         − 
        
       
         g 
        
       
         ( 
        
       
         k 
        
       
         ) 
        
       
      
        g(k) - g(k - 1) \leq g(k + 1) - g(k)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          g
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mclose">
          )
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          −
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          g
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          −
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mclose">
          )
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          g
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mclose">
          )
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          −
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          g
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     。
    </p>
    <p>
     假设能找到两条长度为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     的路径
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        g 
         
        
          1 
         
        
          ′ 
         
        
       
         ( 
        
       
         k 
        
       
         ) 
        
       
      
        g'_1(k)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.0019em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           g
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7519em;">
              <span class="" style="top: -2.4519em; margin-left: -0.0359em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 1
                </span>
               </span>
              </span>
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  ′
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2481em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     和
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        g 
         
        
          2 
         
        
          ′ 
         
        
       
         ( 
        
       
         k 
        
       
         ) 
        
       
      
        g_2'(k)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.0019em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           g
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7519em;">
              <span class="" style="top: -2.4519em; margin-left: -0.0359em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 2
                </span>
               </span>
              </span>
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  ′
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2481em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     满足
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        g 
         
        
          1 
         
        
          ′ 
         
        
       
         ( 
        
       
         k 
        
       
         ) 
        
       
         + 
        
        
        
          g 
         
        
          2 
         
        
          ′ 
         
        
       
         ( 
        
       
         k 
        
       
         ) 
        
       
         ≤ 
        
       
         g 
        
       
         ( 
        
       
         k 
        
       
         − 
        
       
         1 
        
       
         ) 
        
       
         + 
        
       
         g 
        
       
         ( 
        
       
         k 
        
       
         + 
        
       
         1 
        
       
         ) 
        
       
      
        g_1'(k) + g_2'(k) \leq g(k - 1) + g(k + 1)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.0019em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           g
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7519em;">
              <span class="" style="top: -2.4519em; margin-left: -0.0359em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 1
                </span>
               </span>
              </span>
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  ′
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2481em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mclose">
          )
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.0019em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           g
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7519em;">
              <span class="" style="top: -2.4519em; margin-left: -0.0359em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 2
                </span>
               </span>
              </span>
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  ′
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2481em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mclose">
          )
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          g
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          −
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mclose">
          )
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          g
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     。
     <br/>
     那么有
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        2 
        
       
         g 
        
       
         ( 
        
       
         k 
        
       
         ) 
        
       
         ≤ 
        
        
        
          g 
         
        
          1 
         
        
          ′ 
         
        
       
         ( 
        
       
         k 
        
       
         ) 
        
       
         + 
        
        
        
          g 
         
        
          2 
         
        
          ′ 
         
        
       
         ( 
        
       
         k 
        
       
         ) 
        
       
         ≤ 
        
       
         g 
        
       
         ( 
        
       
         k 
        
       
         − 
        
       
         1 
        
       
         ) 
        
       
         + 
        
       
         g 
        
       
         ( 
        
       
         k 
        
       
         + 
        
       
         1 
        
       
         ) 
        
       
      
        2g(k) \leq g'_1(k) + g'_2(k) \leq g(k - 1) + g(k + 1)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          2
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          g
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mclose">
          )
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.0019em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           g
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7519em;">
              <span class="" style="top: -2.4519em; margin-left: -0.0359em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 1
                </span>
               </span>
              </span>
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  ′
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2481em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mclose">
          )
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.0019em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           g
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7519em;">
              <span class="" style="top: -2.4519em; margin-left: -0.0359em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 2
                </span>
               </span>
              </span>
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  ′
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2481em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mclose">
          )
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          g
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          −
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mclose">
          )
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          g
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     。就可以证明原命题了。
    </p>
    <p>
     假设
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        g 
        
       
         ( 
        
       
         k 
        
       
         − 
        
       
         1 
        
       
         ) 
        
       
      
        g(k - 1)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          g
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          −
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     和
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        g 
        
       
         ( 
        
       
         k 
        
       
         + 
        
       
         1 
        
       
         ) 
        
       
      
        g(k + 1)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          g
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     的路径分别为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        A 
        
       
         , 
        
       
         B 
        
       
      
        A,B
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          A
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0502em;">
          B
         </span>
        </span>
       </span>
      </span>
     </span>
     ，用
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        a 
        
       
         , 
        
       
         b 
        
       
      
        a, b
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          a
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          b
         </span>
        </span>
       </span>
      </span>
     </span>
     表示两条路径上的点。
     <br/>
     那么
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        A 
        
       
         , 
        
       
         B 
        
       
      
        A,B
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          A
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0502em;">
          B
         </span>
        </span>
       </span>
      </span>
     </span>
     是有序的，将两条路径的点按照编号从小到大归并到一起，形成的字符串如下：
     <br/>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        a 
        
       
         a 
        
       
         b 
        
       
         b 
        
       
         a 
        
       
         b 
        
       
         . 
        
       
         . 
        
       
         . 
        
       
         a 
        
       
         a 
        
       
         b 
        
       
      
        aabbab...aab
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal">
          aabbab
         </span>
         <span class="mord">
          ...
         </span>
         <span class="mord mathnormal">
          aab
         </span>
        </span>
       </span>
      </span>
     </span>
     。其中
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        a 
        
       
      
        a
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          a
         </span>
        </span>
       </span>
      </span>
     </span>
     的数量比
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        b 
        
       
      
        b
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal">
          b
         </span>
        </span>
       </span>
      </span>
     </span>
     多两个。
     <br/>
     考虑找到一条分界线，满足分界线左边
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        a 
        
       
      
        a
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          a
         </span>
        </span>
       </span>
      </span>
     </span>
     恰好比
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        b 
        
       
      
        b
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal">
          b
         </span>
        </span>
       </span>
      </span>
     </span>
     多一个，且分界线左右相邻的都是
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        a 
        
       
      
        a
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          a
         </span>
        </span>
       </span>
      </span>
     </span>
     。
     <br/>
     那么如果将分别线左边的
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        a 
        
       
      
        a
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          a
         </span>
        </span>
       </span>
      </span>
     </span>
     和分界线右边的
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        b 
        
       
      
        b
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal">
          b
         </span>
        </span>
       </span>
      </span>
     </span>
     拼接成一条路径，剩下的点拼成一条路径，不难发现两条路径的长度都为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/99a23fed79a142ab900bbb0c66e54bb4.png"/>
    </p>
    <p>
     并且两条路径的边权和与原来相比唯一改变的就是跨过分界线的两条边：b…aa…b 原来是 bb + aa 现在是 ba + ab。这个由
     <strong>
      四边形不等式
     </strong>
     可以得到现在两条路径的边权和更小。
    </p>
    <p>
     这样就相当于找到了两条
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        g 
         
        
          1 
         
        
       
         ( 
        
       
         k 
        
       
         ) 
        
       
      
        g_1(k)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           g
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3011em;">
              <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 1
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     和
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        g 
         
        
          2 
         
        
       
         ( 
        
       
         k 
        
       
         ) 
        
       
      
        g_2(k)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           g
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3011em;">
              <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 2
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     。
    </p>
    <p>
     那么一定能找到这样的分界线吗？
     <br/>
     不妨将
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        b 
        
       
      
        b
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal">
          b
         </span>
        </span>
       </span>
      </span>
     </span>
     看做
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        − 
        
       
         1 
        
       
      
        -1
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;">
         </span>
         <span class="mord">
          −
         </span>
         <span class="mord">
          1
         </span>
        </span>
       </span>
      </span>
     </span>
     ，
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        a 
        
       
      
        a
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          a
         </span>
        </span>
       </span>
      </span>
     </span>
     看做
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        1 
        
       
      
        1
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          1
         </span>
        </span>
       </span>
      </span>
     </span>
     。然后可以画出一条从
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        ( 
        
       
         0 
        
       
         , 
        
       
         0 
        
       
         ) 
        
       
      
        (0, 0)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord">
          0
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          0
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     跑到
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        ( 
        
       
         2 
        
       
         k 
        
       
         , 
        
       
         2 
        
       
         ) 
        
       
      
        (2k, 2)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord">
          2
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          2
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     的折线。那么这样的分界线的意义就是折线越过
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        y 
        
       
         = 
        
       
         1 
        
       
      
        y = 1
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          y
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          1
         </span>
        </span>
       </span>
      </span>
     </span>
     的横坐标。容易得到这样分界线一定存在。
    </p>
    <p>
     三.
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
         q 
        
       
         s 
        
       
      
        wqs
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          wq
         </span>
         <span class="mord mathnormal">
          s
         </span>
        </span>
       </span>
      </span>
     </span>
     二分
    </p>
    <p>
     证明了
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        g 
        
       
         ( 
        
       
         k 
        
       
         ) 
        
       
      
        g(k)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          g
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     是下凸函数，如何求解某个点值
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        ( 
        
       
         x 
        
       
         , 
        
       
         g 
        
       
         ( 
        
       
         x 
        
       
         ) 
        
       
         ) 
        
       
      
        (x, g(x))
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          x
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          g
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          x
         </span>
         <span class="mclose">
          ))
         </span>
        </span>
       </span>
      </span>
     </span>
     呢？
    </p>
    <p>
     考虑二分一个斜率
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     ，求斜率为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     的直线与凸包的切点。如果这个切点横坐标大于
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        x 
        
       
      
        x
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          x
         </span>
        </span>
       </span>
      </span>
     </span>
     ，说明二分的斜率偏大，否则斜率偏小。不断缩小
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     的范围直到直线与凸包相切在
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        x 
        
       
      
        x
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          x
         </span>
        </span>
       </span>
      </span>
     </span>
     就成功了。如果凸包和直线相切的是一段，也就是有多个切点，要规定此时选择最大或最小的那个。
    </p>
    <p>
     怎么求一条斜率为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     的直线和凸包的切点呢？
     <br/>
     设直线为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        y 
        
       
         = 
        
       
         k 
        
       
         x 
        
       
         + 
        
       
         b 
        
       
      
        y = kx + b
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          y
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7778em; vertical-align: -0.0833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mord mathnormal">
          x
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal">
          b
         </span>
        </span>
       </span>
      </span>
     </span>
     时与凸包相交，那么当直线与凸包相切时
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        b 
        
       
      
        b
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal">
          b
         </span>
        </span>
       </span>
      </span>
     </span>
     最小。
     <br/>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        f 
        
       
         ( 
        
       
         x 
        
       
         ) 
        
       
         = 
        
       
         k 
        
       
         x 
        
       
         + 
        
       
         b 
        
       
         ⇒ 
        
       
         b 
        
       
         = 
        
       
         f 
        
       
         ( 
        
       
         x 
        
       
         ) 
        
       
         − 
        
       
         k 
        
       
         x 
        
       
      
        f(x) = kx + b \Rightarrow b = f(x) - kx
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1076em;">
          f
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          x
         </span>
         <span class="mclose">
          )
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7778em; vertical-align: -0.0833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mord mathnormal">
          x
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal">
          b
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ⇒
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal">
          b
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1076em;">
          f
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          x
         </span>
         <span class="mclose">
          )
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          −
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mord mathnormal">
          x
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     也就是说，如果让每走一步需要减去一个额外代价
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     ，此时不考虑步数，求出走到
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        n 
        
       
      
        n
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
        </span>
       </span>
      </span>
     </span>
     时花费的最小代价就是最小的
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        b 
        
       
      
        b
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal">
          b
         </span>
        </span>
       </span>
      </span>
     </span>
     。此时走的步数
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        p 
        
       
      
        p
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          p
         </span>
        </span>
       </span>
      </span>
     </span>
     就是切点横坐标。
    </p>
    <p>
     不难发现每走一步减去一个额外代价
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     相当于让蒙日阵整体减去一个常数，那么还是蒙日阵。问题就变成了
     <strong>
      不考虑步数的在线问题
     </strong>
     。仍然可以用
     <strong>
      二分队列
     </strong>
     优化转移。
    </p>
    <p>
     复杂度
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         ( 
        
       
         n 
        
       
         log 
        
       
         ⁡ 
        
       
         n 
        
       
         log 
        
       
         ⁡ 
        
       
         V 
        
       
         ) 
        
       
      
        O(n \log n \log V)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mop">
          lo
          <span style="margin-right: 0.0139em;">
           g
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mop">
          lo
          <span style="margin-right: 0.0139em;">
           g
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.2222em;">
          V
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     。
    </p>
    <p>
     <mark>
      进一步拓展
     </mark>
     ：
     <br/>
     实际上
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
         q 
        
       
         s 
        
       
      
        wqs
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          wq
         </span>
         <span class="mord mathnormal">
          s
         </span>
        </span>
       </span>
      </span>
     </span>
     二分的应用并不局限于可以转化为蒙日阵最短路的问题。
     <br/>
     只要看到题目上要求
     <strong>
      某些变量的大小恰好为
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         k 
         
        
       
         k
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6944em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0315em;">
           k
          </span>
         </span>
        </span>
       </span>
      </span>
     </strong>
     ，并且能够证明或者感受
     <strong>
      答案关于这个变量是凸函数
     </strong>
     ，那么就可以用
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
         q 
        
       
         s 
        
       
      
        wqs
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          wq
         </span>
         <span class="mord mathnormal">
          s
         </span>
        </span>
       </span>
      </span>
     </span>
     二分解决。
    </p>
    <p>
     因此
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
         q 
        
       
         s 
        
       
      
        wqs
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          wq
         </span>
         <span class="mord mathnormal">
          s
         </span>
        </span>
       </span>
      </span>
     </span>
     二分与决策单调性的关系可以简单用一句话概括：
     <br/>
     <strong>
      具有决策单调性一定可以用
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         w 
         
        
          q 
         
        
          s 
         
        
       
         wqs
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           wq
          </span>
          <span class="mord mathnormal">
           s
          </span>
         </span>
        </span>
       </span>
      </span>
      二分，但是能用
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         w 
         
        
          q 
         
        
          s 
         
        
       
         wqs
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           wq
          </span>
          <span class="mord mathnormal">
           s
          </span>
         </span>
        </span>
       </span>
      </span>
      二分不一定有决策单调性
     </strong>
     。
    </p>
    <p>
     需要注意：
     <br/>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
         q 
        
       
         s 
        
       
      
        wqs
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          wq
         </span>
         <span class="mord mathnormal">
          s
         </span>
        </span>
       </span>
      </span>
     </span>
     二分只能求解对于
     <strong>
      某个
     </strong>
     给定的
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     。对一个特定的
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     求答案的复杂度时
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         ( 
        
       
         n 
        
       
         log 
        
       
         ⁡ 
        
       
         n 
        
       
         log 
        
       
         ⁡ 
        
       
         V 
        
       
         ) 
        
       
      
        O(n \log n \log V)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mop">
          lo
          <span style="margin-right: 0.0139em;">
           g
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mop">
          lo
          <span style="margin-right: 0.0139em;">
           g
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.2222em;">
          V
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     的，当需要对所有
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     都求答案时，
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
         q 
        
       
         s 
        
       
      
        wqs
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          wq
         </span>
         <span class="mord mathnormal">
          s
         </span>
        </span>
       </span>
      </span>
     </span>
     二分就无法解决。
    </p>
    <p>
     <mark>
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         w 
         
        
          q 
         
        
          s 
         
        
       
         wqs
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           wq
          </span>
          <span class="mord mathnormal">
           s
          </span>
         </span>
        </span>
       </span>
      </span>
      二分构造方案
     </mark>
     ：
     <br/>
     咕咕咕。
    </p>
    <h3>
     <a id="_203">
     </a>
     练习题
    </h3>
    <h4>
     <a id="P2619__Tree_I_204">
     </a>
     P2619 [国家集训队] Tree I
    </h4>
    <p>
     给你一张
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        V 
        
       
      
        V
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.2222em;">
          V
         </span>
        </span>
       </span>
      </span>
     </span>
     个点，
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        E 
        
       
      
        E
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0576em;">
          E
         </span>
        </span>
       </span>
      </span>
     </span>
     条边的无向连通图，每条边是黑色或白色。求一棵最小权的恰好有
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     条白色边的生成树。
    </p>
    <p>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        1 
        
       
         ≤ 
        
       
         V 
        
       
         ≤ 
        
       
         5 
        
       
         × 
        
       
         1 
        
        
        
          0 
         
        
          4 
         
        
       
      
        1 \leq V \leq 5 \times 10^4
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7804em; vertical-align: -0.136em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8193em; vertical-align: -0.136em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.2222em;">
          V
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;">
         </span>
         <span class="mord">
          5
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          ×
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8141em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mord">
          <span class="mord">
           0
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8141em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 4
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ，
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        1 
        
       
         ≤ 
        
       
         k 
        
       
         ≤ 
        
       
         E 
        
       
         ≤ 
        
       
         1 
        
        
        
          0 
         
        
          5 
         
        
       
      
        1 \leq k \leq E \leq 10^5
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7804em; vertical-align: -0.136em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8304em; vertical-align: -0.136em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8193em; vertical-align: -0.136em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0576em;">
          E
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8141em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mord">
          <span class="mord">
           0
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8141em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 5
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     。
    </p>
    <p>
     分析：
     <br/>
     设
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        f 
        
       
         ( 
        
       
         k 
        
       
         ) 
        
       
      
        f(k)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1076em;">
          f
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     表示恰好有
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     条白色边的最小生成树。感性猜测
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        f 
        
       
         ( 
        
       
         k 
        
       
         ) 
        
       
      
        f(k)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1076em;">
          f
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     关于
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     下凸，因此直接
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
         q 
        
       
         s 
        
       
      
        wqs
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          wq
         </span>
         <span class="mord mathnormal">
          s
         </span>
        </span>
       </span>
      </span>
     </span>
     二分。每次二分一个斜率
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        t 
        
       
      
        t
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6151em;">
         </span>
         <span class="mord mathnormal">
          t
         </span>
        </span>
       </span>
      </span>
     </span>
     ，相当于所有白色边的边权减去
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        t 
        
       
      
        t
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6151em;">
         </span>
         <span class="mord mathnormal">
          t
         </span>
        </span>
       </span>
      </span>
     </span>
     ，然后跑一边
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
         r 
        
       
         u 
        
       
         s 
        
       
         k 
        
       
         a 
        
       
         l 
        
       
      
        kruskal
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          r
         </span>
         <span class="mord mathnormal">
          u
         </span>
         <span class="mord mathnormal">
          s
         </span>
         <span class="mord mathnormal">
          ka
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0197em;">
          l
         </span>
        </span>
       </span>
      </span>
     </span>
     算法。需要注意要保证多个切点时切在最左边，因此每次排序如果一条白边和黑边边权相同那么把黑边排在前面。
    </p>
    <h4>
     <a id="P6246_IOI_2000____212">
     </a>
     P6246 [IOI 2000] 邮局 加强版 加强版
    </h4>
    <p>
     数轴上有
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        n 
        
       
      
        n
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
        </span>
       </span>
      </span>
     </span>
     个点，第
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        i 
        
       
      
        i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6595em;">
         </span>
         <span class="mord mathnormal">
          i
         </span>
        </span>
       </span>
      </span>
     </span>
     个点的位置为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        a 
         
        
          i 
         
        
       
      
        a_i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           a
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     。你需要建立
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        m 
        
       
      
        m
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          m
         </span>
        </span>
       </span>
      </span>
     </span>
     个邮局，每个点的代价为它距离最近的邮局的距离。求所有点的最小代价和。
    </p>
    <p>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        1 
        
       
         ≤ 
        
       
         m 
        
       
         ≤ 
        
       
         n 
        
       
         ≤ 
        
       
         5 
        
       
         × 
        
       
         1 
        
        
        
          0 
         
        
          5 
         
        
       
      
        1 \leq m \leq n \leq 5 \times 10^5
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7804em; vertical-align: -0.136em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7719em; vertical-align: -0.136em;">
         </span>
         <span class="mord mathnormal">
          m
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7719em; vertical-align: -0.136em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;">
         </span>
         <span class="mord">
          5
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          ×
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8141em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mord">
          <span class="mord">
           0
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8141em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 5
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ，
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        0 
        
       
         ≤ 
        
        
        
          a 
         
        
          i 
         
        
       
         ≤ 
        
       
         2 
        
       
         × 
        
       
         1 
        
        
        
          0 
         
        
          6 
         
        
       
      
        0 \leq a_i \leq 2 \times 10^6
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7804em; vertical-align: -0.136em;">
         </span>
         <span class="mord">
          0
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.786em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           a
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;">
         </span>
         <span class="mord">
          2
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          ×
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8141em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mord">
          <span class="mord">
           0
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8141em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 6
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     。
    </p>
    <p>
     分析：
     <br/>
     由于要求
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        m 
        
       
         i 
        
       
         n 
        
       
      
        min
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6595em;">
         </span>
         <span class="mord mathnormal">
          min
         </span>
        </span>
       </span>
      </span>
     </span>
     的
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        m 
        
       
         i 
        
       
         n 
        
       
      
        min
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6595em;">
         </span>
         <span class="mord mathnormal">
          min
         </span>
        </span>
       </span>
      </span>
     </span>
     ，因此可以通过
     <strong>
      钦定每个点去哪个邮局
     </strong>
     来计算代价，最后一定能转移出最优的。
     <br/>
     对于一个邮局而言，显然前往它的点是一段区间。因此有一个暴力的
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
       
         p 
        
       
      
        dp
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord mathnormal">
          p
         </span>
        </span>
       </span>
      </span>
     </span>
     ：
     <br/>
     设
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
        
        
          p 
         
         
         
           i 
          
         
           , 
          
         
           j 
          
         
        
       
      
        dp_{i, j}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           p
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     表示前
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        i 
        
       
      
        i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6595em;">
         </span>
         <span class="mord mathnormal">
          i
         </span>
        </span>
       </span>
      </span>
     </span>
     个点划分成
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        j 
        
       
      
        j
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.854em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0572em;">
          j
         </span>
        </span>
       </span>
      </span>
     </span>
     段，每一段放置一个邮局表示这一段点前往的邮局的最小花费。那么不难发现邮局的位置应该是这一段点的中位数，一段的花费可以
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         ( 
        
       
         1 
        
       
         ) 
        
       
      
        O(1)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord">
          1
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     计算。直接
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
       
         p 
        
       
      
        dp
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord mathnormal">
          p
         </span>
        </span>
       </span>
      </span>
     </span>
     的复杂度为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         ( 
        
        
        
          n 
         
        
          2 
         
        
       
         m 
        
       
         ) 
        
       
      
        O(n^2m)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.0641em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           n
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8141em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 2
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mord mathnormal">
          m
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     。
    </p>
    <p>
     然后是发现了这是
     <strong>
      离线的最优段划分
     </strong>
     问题。猜测满足四边形不等式，可以用决策单调性优化。
     <br/>
     那么复杂度可以优化到
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         ( 
        
       
         n 
        
       
         m 
        
       
         log 
        
       
         ⁡ 
        
       
         n 
        
       
         ) 
        
       
      
        O(nm \log n)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          nm
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mop">
          lo
          <span style="margin-right: 0.0139em;">
           g
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     。
     <br/>
     注意到是
     <strong>
      恰好
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         m 
         
        
       
         m
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.4306em;">
          </span>
          <span class="mord mathnormal">
           m
          </span>
         </span>
        </span>
       </span>
      </span>
      段
     </strong>
     ，并且满足蒙日阵，等价于蒙日阵最短路，答案具有凸性，可以
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
         q 
        
       
         s 
        
       
      
        wqs
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          wq
         </span>
         <span class="mord mathnormal">
          s
         </span>
        </span>
       </span>
      </span>
     </span>
     二分。
     <br/>
     二分斜率
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     ，那么每开一段需要减
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     ，记录最优方案下开的段数以及花费即可。每次
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
       
         p 
        
       
      
        dp
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord mathnormal">
          p
         </span>
        </span>
       </span>
      </span>
     </span>
     可以用
     <strong>
      二分队列
     </strong>
     优化。
     <br/>
     复杂度
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         ( 
        
       
         n 
        
       
         log 
        
       
         ⁡ 
        
       
         n 
        
       
         log 
        
       
         ⁡ 
        
       
         V 
        
       
         ) 
        
       
      
        O(n \log n \log V)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mop">
          lo
          <span style="margin-right: 0.0139em;">
           g
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mop">
          lo
          <span style="margin-right: 0.0139em;">
           g
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.2222em;">
          V
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     。
     <br/>
     <strong>
      CODE：
     </strong>
    </p>
    <pre><code class="prism language-cpp"><span class="token comment">// wqs 二分 + 在线决策单调性 </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MP</span> <span class="token expression">make_pair</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> LL<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> pair<span class="token operator">&lt;</span> LL<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">&gt;</span> PII<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> N <span class="token operator">=</span> <span class="token number">5e5</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span> m<span class="token punctuation">;</span>
LL a<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
PII f<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">seg</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> L<span class="token punctuation">,</span> R<span class="token punctuation">,</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> l<span class="token punctuation">,</span> r<span class="token punctuation">;</span>
seg Stk<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
LL <span class="token function">w</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> mid <span class="token operator">=</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> r <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> s<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">-</span> s<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token punctuation">(</span>r <span class="token operator">-</span> mid<span class="token punctuation">)</span> <span class="token operator">*</span> a<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">+</span> a<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span>mid <span class="token operator">-</span> l <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">-</span> s<span class="token punctuation">[</span>l <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
PII <span class="token function">g</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> c<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token function">MP</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>first <span class="token operator">+</span> <span class="token function">w</span><span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token operator">-</span> c<span class="token punctuation">,</span> f<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>second <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token keyword">int</span> c<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	l <span class="token operator">=</span> r <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	Stk<span class="token punctuation">[</span>l<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>seg<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">int</span> x <span class="token operator">=</span> Stk<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">;</span>
		f<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">g</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> i<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
		Stk<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">.</span>L <span class="token operator">++</span><span class="token punctuation">;</span> <span class="token keyword">if</span><span class="token punctuation">(</span>Stk<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">.</span>L <span class="token operator">&gt;</span> Stk<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">.</span>R<span class="token punctuation">)</span> l <span class="token operator">++</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span> ll <span class="token operator">=</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> rr <span class="token operator">=</span> n<span class="token punctuation">;</span>
		<span class="token keyword">while</span><span class="token punctuation">(</span>r <span class="token operator">&gt;=</span> l <span class="token operator">&amp;&amp;</span> <span class="token function">g</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> Stk<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span>L<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token function">g</span><span class="token punctuation">(</span>Stk<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> Stk<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span>L<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			ll <span class="token operator">=</span> Stk<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span>L<span class="token punctuation">;</span>
			r <span class="token operator">--</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">&gt;=</span> l<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">int</span> lt <span class="token operator">=</span> Stk<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span>L<span class="token punctuation">,</span> rt <span class="token operator">=</span> Stk<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span>R<span class="token punctuation">,</span> mid<span class="token punctuation">,</span> res <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
			<span class="token keyword">while</span><span class="token punctuation">(</span>lt <span class="token operator">&lt;=</span> rt<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				mid <span class="token operator">=</span> <span class="token punctuation">(</span>lt <span class="token operator">+</span> rt <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">g</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> mid<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token function">g</span><span class="token punctuation">(</span>Stk<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> mid<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span> res <span class="token operator">=</span> mid<span class="token punctuation">,</span> rt <span class="token operator">=</span> mid <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
				<span class="token keyword">else</span> lt <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
 			<span class="token punctuation">}</span>
 			<span class="token keyword">if</span><span class="token punctuation">(</span>res <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
 				ll <span class="token operator">=</span> res<span class="token punctuation">;</span>
 				Stk<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span>R <span class="token operator">=</span> res <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>ll <span class="token operator">&lt;=</span> rr<span class="token punctuation">)</span> Stk<span class="token punctuation">[</span><span class="token operator">++</span> r<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>seg<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>ll<span class="token punctuation">,</span> rr<span class="token punctuation">,</span> i<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">,</span> <span class="token operator">&amp;</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%lld"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">sort</span><span class="token punctuation">(</span>a <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> a <span class="token operator">+</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1e9</span><span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token number">1e9</span><span class="token punctuation">,</span> mid<span class="token punctuation">,</span> res<span class="token punctuation">;</span>
	<span class="token function">check</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token keyword">while</span><span class="token punctuation">(</span>l <span class="token operator">&lt;=</span> r<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		mid <span class="token operator">=</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> r <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">check</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">.</span>second <span class="token operator">&gt;</span> m<span class="token punctuation">)</span> r <span class="token operator">=</span> mid <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">.</span>second <span class="token operator">==</span> m<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%lld\n"</span><span class="token punctuation">,</span> f<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">.</span>first <span class="token operator">+</span> <span class="token number">1LL</span> <span class="token operator">*</span> m <span class="token operator">*</span> mid<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
		<span class="token keyword">else</span> res <span class="token operator">=</span> mid<span class="token punctuation">,</span> l <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">check</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%lld\n"</span><span class="token punctuation">,</span> f<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">.</span>first <span class="token operator">+</span> <span class="token number">1LL</span> <span class="token operator">*</span> m <span class="token operator">*</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="P4383__2018__299">
     </a>
     P4383 [八省联考 2018] 林克卡特树
    </h4>
    <p>
     给你一棵
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        n 
        
       
      
        n
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
        </span>
       </span>
      </span>
     </span>
     个点的树，每条边有边权
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        v 
         
        
          i 
         
        
       
      
        v_i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           v
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     。若
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        v 
         
        
          i 
         
        
       
         &lt; 
        
       
         0 
        
       
      
        v_i &lt; 0
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6891em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           v
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          &lt;
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          0
         </span>
        </span>
       </span>
      </span>
     </span>
     ，表示经过这条边需要花费
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        v 
         
        
          i 
         
        
       
      
        v_i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           v
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     的代价。若
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        v 
         
        
          i 
         
        
       
         &gt; 
        
       
         0 
        
       
      
        v_i &gt; 0
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6891em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           v
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          &gt;
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          0
         </span>
        </span>
       </span>
      </span>
     </span>
     ，表示经过这条边能获得
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        v 
         
        
          i 
         
        
       
      
        v_i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           v
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     的收益。你可以任意选择
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        K 
        
       
      
        K
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0715em;">
          K
         </span>
        </span>
       </span>
      </span>
     </span>
     条边并将它们删掉，然后加入
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        K 
        
       
      
        K
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0715em;">
          K
         </span>
        </span>
       </span>
      </span>
     </span>
     条
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        v 
         
        
          i 
         
        
       
         = 
        
       
         0 
        
       
      
        v_i = 0
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.5806em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           v
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          0
         </span>
        </span>
       </span>
      </span>
     </span>
     的边得到一棵新树。接着你可以选择两个点
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        p 
        
       
         , 
        
       
         q 
        
       
      
        p, q
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          p
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          q
         </span>
        </span>
       </span>
      </span>
     </span>
     并从
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        p 
        
       
      
        p
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          p
         </span>
        </span>
       </span>
      </span>
     </span>
     走到
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        q 
        
       
      
        q
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          q
         </span>
        </span>
       </span>
      </span>
     </span>
     。求出可能的 收益 - 花费 最大是多少。
    </p>
    <p>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        1 
        
       
         ≤ 
        
       
         n 
        
       
         ≤ 
        
       
         3 
        
       
         × 
        
       
         1 
        
        
        
          0 
         
        
          5 
         
        
       
      
        1 \leq n \leq 3 \times 10^5
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7804em; vertical-align: -0.136em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7719em; vertical-align: -0.136em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;">
         </span>
         <span class="mord">
          3
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          ×
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8141em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mord">
          <span class="mord">
           0
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8141em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 5
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ，
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        0 
        
       
         ≤ 
        
       
         K 
        
       
         ≤ 
        
       
         3 
        
       
         × 
        
       
         1 
        
        
        
          0 
         
        
          5 
         
        
       
      
        0 \leq K \leq 3\times 10^5
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7804em; vertical-align: -0.136em;">
         </span>
         <span class="mord">
          0
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8193em; vertical-align: -0.136em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0715em;">
          K
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;">
         </span>
         <span class="mord">
          3
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          ×
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8141em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mord">
          <span class="mord">
           0
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8141em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 5
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ，
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        K 
        
       
         &lt; 
        
       
         n 
        
       
      
        K &lt; n
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7224em; vertical-align: -0.0391em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0715em;">
          K
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          &lt;
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
        </span>
       </span>
      </span>
     </span>
     ，
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        ∣ 
        
        
        
          v 
         
        
          i 
         
        
       
         ∣ 
        
       
         ≤ 
        
       
         1 
        
        
        
          0 
         
        
          6 
         
        
       
      
        |v_i| \leq 10^6
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          ∣
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           v
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mord">
          ∣
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8141em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mord">
          <span class="mord">
           0
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8141em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 6
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     。
    </p>
    <p>
     分析：
     <br/>
     假设我们已经确定了删除的
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        K 
        
       
      
        K
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0715em;">
          K
         </span>
        </span>
       </span>
      </span>
     </span>
     条边，考虑这时最大的 收益 - 花费 是多少。
     <br/>
     发现会形成
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        K 
        
       
         + 
        
       
         1 
        
       
      
        K + 1
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0715em;">
          K
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          1
         </span>
        </span>
       </span>
      </span>
     </span>
     个连通块，那么每个连通块的最长简单路径之和就是答案。
     <br/>
     可以证明答案不会超过这个值，也可以构造加的边取到这个值。
    </p>
    <p>
     发现这
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        K 
        
       
         + 
        
       
         1 
        
       
      
        K + 1
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0715em;">
          K
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          1
         </span>
        </span>
       </span>
      </span>
     </span>
     条简单路径总是不交的。那么反过来想，任意取
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        K 
        
       
         + 
        
       
         1 
        
       
      
        K + 1
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0715em;">
          K
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          1
         </span>
        </span>
       </span>
      </span>
     </span>
     条两两不交的简单路径，一定存在一种删边方式把它们划分到不同的连通块里。
    </p>
    <p>
     这样能说明原问题的答案就是
     <strong>
      在树上选出
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         K 
         
        
          + 
         
        
          1 
         
        
       
         K + 1
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0715em;">
           K
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           +
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.6444em;">
          </span>
          <span class="mord">
           1
          </span>
         </span>
        </span>
       </span>
      </span>
      条不交路径，路径之和的最大值
     </strong>
     。
     <br/>
     可以树背包：
     <br/>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        f 
         
         
         
           i 
          
         
           , 
          
         
           j 
          
         
        
       
      
        f_{i, j}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.1076em;">
           f
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.1076em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     表示 以
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        i 
        
       
      
        i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6595em;">
         </span>
         <span class="mord mathnormal">
          i
         </span>
        </span>
       </span>
      </span>
     </span>
     为根的子树里选了
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        j 
        
       
      
        j
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.854em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0572em;">
          j
         </span>
        </span>
       </span>
      </span>
     </span>
     条不交路径，没有一条
     <strong>
      半路径
     </strong>
     延伸上来的最大值。
     <br/>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        g 
         
         
         
           i 
          
         
           , 
          
         
           j 
          
         
        
       
      
        g_{i, j}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0359em;">
           g
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     则表示有一条半路径延伸上来。
     <br/>
     那么转移时考虑将两半拼起来，并树背包转移即可。复杂度
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         ( 
        
        
        
          n 
         
        
          2 
         
        
       
         ) 
        
       
      
        O(n^2)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.0641em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           n
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8141em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 2
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     。
    </p>
    <p>
     注意到要求
     <strong>
      恰好选出
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         K 
         
        
          + 
         
        
          1 
         
        
       
         K + 1
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.7667em; vertical-align: -0.0833em;">
          </span>
          <span class="mord mathnormal" style="margin-right: 0.0715em;">
           K
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
          <span class="mbin">
           +
          </span>
          <span class="mspace" style="margin-right: 0.2222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.6444em;">
          </span>
          <span class="mord">
           1
          </span>
         </span>
        </span>
       </span>
      </span>
      条路径
     </strong>
     ，考虑答案是否关于
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        K 
        
       
      
        K
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0715em;">
          K
         </span>
        </span>
       </span>
      </span>
     </span>
     存在凸性。
     <br/>
     不难发现
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        K 
        
       
      
        K
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0715em;">
          K
         </span>
        </span>
       </span>
      </span>
     </span>
     越大答案越大，因为可以一条路径可以只有一个点。当
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        K 
        
       
      
        K
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0715em;">
          K
         </span>
        </span>
       </span>
      </span>
     </span>
     变大时答案的增量越来越小，因为肯定是先选出价值高的路径。
     <br/>
     所以感性证明了答案关于
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        K 
        
       
      
        K
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0715em;">
          K
         </span>
        </span>
       </span>
      </span>
     </span>
     上凸。
     <br/>
     那么直接
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
         q 
        
       
         s 
        
       
      
        wqs
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          wq
         </span>
         <span class="mord mathnormal">
          s
         </span>
        </span>
       </span>
      </span>
     </span>
     二分即可，每次新选中一条路径要减去斜率。
     <br/>
     时间复杂度
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         ( 
        
       
         n 
        
       
         log 
        
       
         ⁡ 
        
       
         V 
        
       
         ) 
        
       
      
        O(n \log V)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mop">
          lo
          <span style="margin-right: 0.0139em;">
           g
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.2222em;">
          V
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     <strong>
      CODE：
     </strong>
    </p>
    <pre><code class="prism language-cpp"><span class="token comment">// wqs 二分 + 树形 dp</span>
<span class="token comment">// 相当于求划分若干条不交链的最大权值和 </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> N <span class="token operator">=</span> <span class="token number">3e5</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> LL<span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span> K<span class="token punctuation">;</span>
LL sum<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 到根的路径和 </span>
<span class="token keyword">struct</span> <span class="token class-name">edge</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> v<span class="token punctuation">,</span> last<span class="token punctuation">;</span>
	LL w<span class="token punctuation">;</span>
<span class="token punctuation">}</span>E<span class="token punctuation">[</span>N <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">G</span> <span class="token punctuation">{<!-- --></span>
	LL v<span class="token punctuation">;</span> <span class="token keyword">int</span> c<span class="token punctuation">;</span>
	<span class="token keyword">friend</span> <span class="token keyword">bool</span> <span class="token keyword">operator</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>G x<span class="token punctuation">,</span> G y<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>v <span class="token operator">&lt;</span> y<span class="token punctuation">.</span>v<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span>v <span class="token operator">==</span> y<span class="token punctuation">.</span>v <span class="token operator">&amp;&amp;</span> x<span class="token punctuation">.</span>c <span class="token operator">&gt;</span> y<span class="token punctuation">.</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">friend</span> G <span class="token keyword">operator</span> <span class="token operator">+</span> <span class="token punctuation">(</span>G x<span class="token punctuation">,</span> G y<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		G z <span class="token operator">=</span> <span class="token punctuation">(</span>G<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>x<span class="token punctuation">.</span>v <span class="token operator">+</span> y<span class="token punctuation">.</span>v<span class="token punctuation">,</span> x<span class="token punctuation">.</span>c <span class="token operator">+</span> y<span class="token punctuation">.</span>c<span class="token punctuation">}</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> z<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> head<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span> tot<span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> u<span class="token punctuation">,</span> <span class="token keyword">int</span> v<span class="token punctuation">,</span> LL w<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	E<span class="token punctuation">[</span><span class="token operator">++</span> tot<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>edge<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>v<span class="token punctuation">,</span> head<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">,</span> w<span class="token punctuation">}</span><span class="token punctuation">;</span>
	head<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">=</span> tot<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">dfs0</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> fa<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> head<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span> i<span class="token punctuation">;</span> i <span class="token operator">=</span> E<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>last<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">int</span> v <span class="token operator">=</span> E<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>v<span class="token punctuation">;</span> LL w <span class="token operator">=</span> E<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>w<span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>v <span class="token operator">==</span> fa<span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
		sum<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">=</span> sum<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">+</span> w<span class="token punctuation">;</span>
		<span class="token function">dfs0</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
G f<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span> g<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span> h<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// f[x] 没有半链延伸， g[x] 已经拼接过了， h[x] 有一条半链延伸上来了 </span>
<span class="token keyword">void</span> <span class="token function">dfs1</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> fa<span class="token punctuation">,</span> LL cost<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    f<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>G<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
	g<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>G<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token operator">-</span>cost<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    h<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>G<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>sum<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> head<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span> i<span class="token punctuation">;</span> i <span class="token operator">=</span> E<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>last<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">int</span> v <span class="token operator">=</span> E<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>v<span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>v <span class="token operator">==</span> fa<span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
		<span class="token function">dfs1</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> x<span class="token punctuation">,</span> cost<span class="token punctuation">)</span><span class="token punctuation">;</span>
		g<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> g<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token function">max</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">,</span> g<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		g<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>g<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>G<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>h<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>v <span class="token operator">+</span> h<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">.</span>v <span class="token operator">-</span> <span class="token number">2LL</span> <span class="token operator">*</span> sum<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">-</span> cost<span class="token punctuation">,</span> h<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>c <span class="token operator">+</span> h<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">.</span>c <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		h<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>h<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token function">max</span><span class="token punctuation">(</span>g<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">,</span> f<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> h<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">+</span> f<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		f<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> f<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token function">max</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">,</span> g<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">check</span><span class="token punctuation">(</span>LL x<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 新开一条路径的花费为 x </span>
	<span class="token function">dfs1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">,</span> <span class="token operator">&amp;</span>K<span class="token punctuation">)</span><span class="token punctuation">;</span> K <span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">int</span> u<span class="token punctuation">,</span> v<span class="token punctuation">;</span> LL w<span class="token punctuation">;</span>
		<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%lld"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>u<span class="token punctuation">,</span> <span class="token operator">&amp;</span>v<span class="token punctuation">,</span> <span class="token operator">&amp;</span>w<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">add</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span> v<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">add</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> u<span class="token punctuation">,</span> w<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">dfs0</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	LL l <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">3e11</span><span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token number">3e11</span><span class="token punctuation">,</span> mid<span class="token punctuation">,</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>l <span class="token operator">&lt;=</span> r<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		mid <span class="token operator">=</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> r <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">check</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">;</span>
        G ans <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> g<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>ans<span class="token punctuation">.</span>c <span class="token operator">==</span> K<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%lld\n"</span><span class="token punctuation">,</span> ans<span class="token punctuation">.</span>v <span class="token operator">+</span> mid <span class="token operator">*</span> K<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>ans<span class="token punctuation">.</span>c <span class="token operator">&gt;</span> K<span class="token punctuation">)</span> l <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1LL</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> res <span class="token operator">=</span> mid<span class="token punctuation">,</span> r <span class="token operator">=</span> mid <span class="token operator">-</span> <span class="token number">1LL</span><span class="token punctuation">;</span>
 	<span class="token punctuation">}</span>
 	<span class="token function">check</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
 	G ans <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> g<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%lld\n"</span><span class="token punctuation">,</span> ans<span class="token punctuation">.</span>v <span class="token operator">+</span> <span class="token number">1LL</span> <span class="token operator">*</span> K <span class="token operator">*</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="ARC168E_Subsegments_with_Large_Sums_403">
     </a>
     [ARC168E] Subsegments with Large Sums
    </h4>
    <p>
     给定长度为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        n 
        
       
      
        n
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
        </span>
       </span>
      </span>
     </span>
     的数列
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        { 
        
        
        
          a 
         
        
          i 
         
        
       
         } 
        
       
      
        \{a_i\}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mopen">
          {
          <!-- -->
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           a
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mclose">
          }
         </span>
        </span>
       </span>
      </span>
     </span>
     和两个参数
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
         , 
        
       
         s 
        
       
      
        k, s
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          s
         </span>
        </span>
       </span>
      </span>
     </span>
     ，将
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        { 
        
        
        
          a 
         
        
          i 
         
        
       
         } 
        
       
      
        \{a_i\}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mopen">
          {
          <!-- -->
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           a
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mclose">
          }
         </span>
        </span>
       </span>
      </span>
     </span>
     划分成
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     段，最大化和
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        ≥ 
        
       
         s 
        
       
      
        \geq s
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7719em; vertical-align: -0.136em;">
         </span>
         <span class="mrel">
          ≥
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          s
         </span>
        </span>
       </span>
      </span>
     </span>
     的段数。
    </p>
    <p>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        1 
        
       
         ≤ 
        
       
         k 
        
       
         ≤ 
        
       
         n 
        
       
         ≤ 
        
       
         250000 
        
       
      
        1 \leq k \leq n \leq 250000
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7804em; vertical-align: -0.136em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8304em; vertical-align: -0.136em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7719em; vertical-align: -0.136em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6444em;">
         </span>
         <span class="mord">
          250000
         </span>
        </span>
       </span>
      </span>
     </span>
     ，
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        1 
        
       
         ≤ 
        
        
        
          A 
         
        
          i 
         
        
       
         ≤ 
        
       
         1 
        
        
        
          0 
         
        
          9 
         
        
       
      
        1 \leq A_i \leq 10^9
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7804em; vertical-align: -0.136em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8333em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           A
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8141em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mord">
          <span class="mord">
           0
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8141em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 9
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ，
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        1 
        
       
         ≤ 
        
       
         s 
        
       
         ≤ 
        
       
         1 
        
        
        
          0 
         
        
          15 
         
        
       
      
        1 \leq s \leq 10^{15}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7804em; vertical-align: -0.136em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7719em; vertical-align: -0.136em;">
         </span>
         <span class="mord mathnormal">
          s
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8141em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mord">
          <span class="mord">
           0
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8141em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  15
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     。
    </p>
    <p>
     分析：
     <br/>
     要恰好分成
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     段，考虑
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
         q 
        
       
         s 
        
       
      
        wqs
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          wq
         </span>
         <span class="mord mathnormal">
          s
         </span>
        </span>
       </span>
      </span>
     </span>
     二分。设
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        f 
        
       
         ( 
        
       
         k 
        
       
         ) 
        
       
      
        f(k)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1076em;">
          f
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     表示恰好分成
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     段的答案，猜
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        f 
        
       
         ( 
        
       
         k 
        
       
         ) 
        
       
      
        f(k)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1076em;">
          f
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     关于
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     上凸。
     <br/>
     但是仔细想就会发现问题，因为可以把和
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        &lt; 
        
       
         s 
        
       
      
        &lt; s
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;">
         </span>
         <span class="mrel">
          &lt;
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          s
         </span>
        </span>
       </span>
      </span>
     </span>
     的段分成两段，增加了段数但是答案不变，因此
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        f 
        
       
         ( 
        
       
         k 
        
       
         ) 
        
       
      
        f(k)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.1076em;">
          f
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     关于
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     并不是凸的。
    </p>
    <p>
     枚举答案
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        t 
        
       
      
        t
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6151em;">
         </span>
         <span class="mord mathnormal">
          t
         </span>
        </span>
       </span>
      </span>
     </span>
     ，然后
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        c 
        
       
         h 
        
       
         e 
        
       
         c 
        
       
         k 
        
       
      
        check
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal">
          c
         </span>
         <span class="mord mathnormal">
          h
         </span>
         <span class="mord mathnormal">
          ec
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     能否有
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        ≥ 
        
       
         t 
        
       
      
        \geq t
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7719em; vertical-align: -0.136em;">
         </span>
         <span class="mrel">
          ≥
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6151em;">
         </span>
         <span class="mord mathnormal">
          t
         </span>
        </span>
       </span>
      </span>
     </span>
     段的和
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        ≥ 
        
       
         s 
        
       
      
        \geq s
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7719em; vertical-align: -0.136em;">
         </span>
         <span class="mrel">
          ≥
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          s
         </span>
        </span>
       </span>
      </span>
     </span>
     。不难发现这是满足单调性的，因为可以二分答案。
     <br/>
     那么问题变成了如何
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        c 
        
       
         h 
        
       
         e 
        
       
         c 
        
       
         k 
        
       
      
        check
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal">
          c
         </span>
         <span class="mord mathnormal">
          h
         </span>
         <span class="mord mathnormal">
          ec
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     是否存在一种划分，满足划分的
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     段中至少有
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        t 
        
       
      
        t
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6151em;">
         </span>
         <span class="mord mathnormal">
          t
         </span>
        </span>
       </span>
      </span>
     </span>
     段的和
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        ≥ 
        
       
         s 
        
       
      
        \geq s
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7719em; vertical-align: -0.136em;">
         </span>
         <span class="mrel">
          ≥
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          s
         </span>
        </span>
       </span>
      </span>
     </span>
     。
     <br/>
     假设已经确定了这
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        t 
        
       
      
        t
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6151em;">
         </span>
         <span class="mord mathnormal">
          t
         </span>
        </span>
       </span>
      </span>
     </span>
     段，那么只需要这
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        t 
        
       
      
        t
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6151em;">
         </span>
         <span class="mord mathnormal">
          t
         </span>
        </span>
       </span>
      </span>
     </span>
     段外的位置数
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        ≥ 
        
       
         k 
        
       
         − 
        
       
         t 
        
       
      
        \geq k - t
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7719em; vertical-align: -0.136em;">
         </span>
         <span class="mrel">
          ≥
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7778em; vertical-align: -0.0833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          −
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6151em;">
         </span>
         <span class="mord mathnormal">
          t
         </span>
        </span>
       </span>
      </span>
     </span>
     就合法，如果不满足就一定不合法。因为每段最少需要有一个元素。
     <br/>
     假设此时这
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        t 
        
       
      
        t
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6151em;">
         </span>
         <span class="mord mathnormal">
          t
         </span>
        </span>
       </span>
      </span>
     </span>
     段的长度之和为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        g 
        
       
         ( 
        
       
         t 
        
       
         ) 
        
       
      
        g(t)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          g
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          t
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     ，只需要
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        n 
        
       
         − 
        
       
         g 
        
       
         ( 
        
       
         t 
        
       
         ) 
        
       
         ≥ 
        
       
         k 
        
       
         − 
        
       
         t 
        
       
      
        n - g(t) \geq k - t
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          −
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          g
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          t
         </span>
         <span class="mclose">
          )
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≥
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7778em; vertical-align: -0.0833em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          −
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.6151em;">
         </span>
         <span class="mord mathnormal">
          t
         </span>
        </span>
       </span>
      </span>
     </span>
     即可说明
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        t 
        
       
      
        t
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6151em;">
         </span>
         <span class="mord mathnormal">
          t
         </span>
        </span>
       </span>
      </span>
     </span>
     合法。那么只需要我们求出最小的
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        g 
        
       
         ( 
        
       
         t 
        
       
         ) 
        
       
      
        g(t)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          g
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          t
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     即可。
    </p>
    <p>
     怎么求
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        g 
        
       
         ( 
        
       
         t 
        
       
         ) 
        
       
      
        g(t)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          g
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          t
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     呢？
     <br/>
     考虑一个暴力
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
       
         p 
        
       
      
        dp
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord mathnormal">
          p
         </span>
        </span>
       </span>
      </span>
     </span>
     ：
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
        
        
          p 
         
         
         
           i 
          
         
           , 
          
         
           j 
          
         
        
       
      
        dp_{i, j}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           p
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     表示考虑前
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        j 
        
       
      
        j
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.854em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0572em;">
          j
         </span>
        </span>
       </span>
      </span>
     </span>
     个位置，当前选出了
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        i 
        
       
      
        i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6595em;">
         </span>
         <span class="mord mathnormal">
          i
         </span>
        </span>
       </span>
      </span>
     </span>
     个 和
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        ≥ 
        
       
         s 
        
       
      
        \geq s
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7719em; vertical-align: -0.136em;">
         </span>
         <span class="mrel">
          ≥
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          s
         </span>
        </span>
       </span>
      </span>
     </span>
     的段，这些段长度之和的最小值。
     <br/>
     那么转移有：
     <br/>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
        
        
          p 
         
         
         
           i 
          
         
           , 
          
         
           j 
          
         
        
       
         ← 
        
       
         d 
        
        
        
          p 
         
         
         
           i 
          
         
           , 
          
         
           j 
          
         
           − 
          
         
           1 
          
         
        
       
      
        dp_{i, j} \gets dp_{i, j - 1}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           p
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ←
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           p
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                 <span class="mbin mtight">
                  −
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
        
        
          p 
         
         
         
           i 
          
         
           , 
          
         
           j 
          
         
        
       
         ← 
        
       
         d 
        
        
        
          p 
         
         
         
           i 
          
         
           − 
          
         
           1 
          
         
           , 
          
         
           l 
          
         
           s 
          
          
          
            t 
           
          
            j 
           
          
         
           − 
          
         
           1 
          
         
        
       
      
        dp_{i, j} \gets dp_{i - 1, lst_j - 1}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           p
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ←
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.0418em; vertical-align: -0.3473em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           p
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3361em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mbin mtight">
                  −
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0197em;">
                  l
                 </span>
                 <span class="mord mathnormal mtight">
                  s
                 </span>
                 <span class="mord mtight">
                  <span class="mord mathnormal mtight">
                   t
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3281em;">
                      <span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                         j
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      ​
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.2819em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="mbin mtight">
                  −
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3473em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     其中
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        l 
        
       
         s 
        
        
        
          t 
         
        
          j 
         
        
       
      
        lst_j
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0197em;">
          l
         </span>
         <span class="mord mathnormal">
          s
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           t
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                 j
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     表示最大的
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        x 
        
       
      
        x
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          x
         </span>
        </span>
       </span>
      </span>
     </span>
     满足
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        [ 
        
       
         x 
        
       
         , 
        
       
         j 
        
       
         ] 
        
       
      
        [x, j]
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mopen">
          [
         </span>
         <span class="mord mathnormal">
          x
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0572em;">
          j
         </span>
         <span class="mclose">
          ]
         </span>
        </span>
       </span>
      </span>
     </span>
     的和
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        ≥ 
        
       
         s 
        
       
      
        \geq s
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7719em; vertical-align: -0.136em;">
         </span>
         <span class="mrel">
          ≥
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          s
         </span>
        </span>
       </span>
      </span>
     </span>
     。
     <br/>
     那么
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        g 
        
       
         ( 
        
       
         t 
        
       
         ) 
        
       
         = 
        
       
         d 
        
        
        
          p 
         
         
         
           t 
          
         
           , 
          
         
           n 
          
         
        
       
      
        g(t) = dp_{t, n}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          g
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          t
         </span>
         <span class="mclose">
          )
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           p
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2806em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  t
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight">
                  n
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     这样复杂度
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         ( 
        
        
        
          n 
         
        
          2 
         
        
       
         ) 
        
       
      
        O(n^2)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.0641em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           n
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8141em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 2
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     。但是考虑要求的是
     <strong>
      恰好
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         t 
         
        
       
         t
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.6151em;">
          </span>
          <span class="mord mathnormal">
           t
          </span>
         </span>
        </span>
       </span>
      </span>
      段
     </strong>
     ，考虑
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
         q 
        
       
         s 
        
       
      
        wqs
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          wq
         </span>
         <span class="mord mathnormal">
          s
         </span>
        </span>
       </span>
      </span>
     </span>
     二分。
     <br/>
     不难发现此时
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        g 
        
       
         ( 
        
       
         t 
        
       
         ) 
        
       
      
        g(t)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          g
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          t
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     关于
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        t 
        
       
      
        t
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6151em;">
         </span>
         <span class="mord mathnormal">
          t
         </span>
        </span>
       </span>
      </span>
     </span>
     是上凸的，感性理解就是肯定先选长度较小的合法段，再选长度较大的段。
     <br/>
     因此
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
         q 
        
       
         s 
        
       
      
        wqs
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          wq
         </span>
         <span class="mord mathnormal">
          s
         </span>
        </span>
       </span>
      </span>
     </span>
     二分就是对的。那么外层二分答案，内层
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
         q 
        
       
         s 
        
       
      
        wqs
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          wq
         </span>
         <span class="mord mathnormal">
          s
         </span>
        </span>
       </span>
      </span>
     </span>
     二分，每次
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
       
         p 
        
       
      
        dp
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord mathnormal">
          p
         </span>
        </span>
       </span>
      </span>
     </span>
     复杂度
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         ( 
        
       
         n 
        
       
         ) 
        
       
      
        O(n)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     ，总复杂度就是
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         ( 
        
       
         n 
        
       
         log 
        
       
         ⁡ 
        
       
         n 
        
       
         log 
        
       
         ⁡ 
        
       
         V 
        
       
         ) 
        
       
      
        O(n \log n \log V)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mop">
          lo
          <span style="margin-right: 0.0139em;">
           g
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mop">
          lo
          <span style="margin-right: 0.0139em;">
           g
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.2222em;">
          V
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     。
     <br/>
     <strong>
      CODE：
     </strong>
    </p>
    <pre><code class="prism language-cpp"><span class="token comment">// f(x) 表示分成 x 段的最大合法段数， f(x) 不是凸的</span>
<span class="token comment">// f(x) 表示分出 x 段合法段的最小代价，f(x) 是凸的。 合法的 x 就是一段前缀</span>
<span class="token comment">// 二分，然后wqs二分求出点值check </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MP</span> <span class="token expression">make_pair</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> N <span class="token operator">=</span> <span class="token number">250010</span><span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> LL<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> pair<span class="token operator">&lt;</span> LL<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">&gt;</span> PII<span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span> pre<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span> K<span class="token punctuation">;</span>
LL a<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">,</span> sum<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
PII f<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	f<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">MP</span><span class="token punctuation">(</span><span class="token number">0LL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		f<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> f<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>pre<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> f<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">MP</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>pre<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first <span class="token operator">+</span> i <span class="token operator">-</span> pre<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> k<span class="token punctuation">,</span> f<span class="token punctuation">[</span>pre<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>second <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
LL <span class="token function">F</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 求 x 的点值 </span>
	<span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> r <span class="token operator">=</span> n<span class="token punctuation">,</span> mid<span class="token punctuation">,</span> res<span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>l <span class="token operator">&lt;=</span> r<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		mid <span class="token operator">=</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> r <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">calc</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">.</span>second <span class="token operator">==</span> x<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token keyword">return</span> f<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">.</span>first <span class="token operator">+</span> <span class="token number">1LL</span> <span class="token operator">*</span> x <span class="token operator">*</span> mid<span class="token punctuation">;</span><span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">.</span>second <span class="token operator">&lt;</span> x<span class="token punctuation">)</span> res <span class="token operator">=</span> mid<span class="token punctuation">,</span> l <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> r <span class="token operator">=</span> mid <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">calc</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> f<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">.</span>first <span class="token operator">+</span> <span class="token number">1LL</span> <span class="token operator">*</span> res <span class="token operator">*</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%lld"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">,</span> <span class="token operator">&amp;</span>K<span class="token punctuation">,</span> <span class="token operator">&amp;</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%lld"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		sum<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> sum<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">int</span> p <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">while</span><span class="token punctuation">(</span>p <span class="token operator">&lt;=</span> i <span class="token operator">&amp;&amp;</span> sum<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> sum<span class="token punctuation">[</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;=</span> s<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			p <span class="token operator">++</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		pre<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> r <span class="token operator">=</span> K<span class="token punctuation">,</span> mid<span class="token punctuation">,</span> res<span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span>l <span class="token operator">&lt;=</span> r<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		mid <span class="token operator">=</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> r <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">F</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> n <span class="token operator">-</span> K<span class="token punctuation">)</span> res <span class="token operator">=</span> mid<span class="token punctuation">,</span> l <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> r <span class="token operator">=</span> mid <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	cout <span class="token operator">&lt;&lt;</span> res <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="P5896_IOI_2016_aliens_486">
     </a>
     P5896 [IOI 2016] aliens
    </h4>
    <p>
     给你一个大小为
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        m 
        
       
         × 
        
       
         m 
        
       
      
        m \times m
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;">
         </span>
         <span class="mord mathnormal">
          m
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          ×
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          m
         </span>
        </span>
       </span>
      </span>
     </span>
     的正方形，上面有
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        n 
        
       
      
        n
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
        </span>
       </span>
      </span>
     </span>
     个点，你需要选出最多
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     个正方形使得这
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     个正方形的对角线与主对角线重合，并且这
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        k 
        
       
      
        k
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
        </span>
       </span>
      </span>
     </span>
     个正方形能够覆盖所有的点，同时要求正方形的
     <strong>
      面积并
     </strong>
     最小。
    </p>
    <p>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        1 
        
       
         ≤ 
        
       
         k 
        
       
         ≤ 
        
       
         n 
        
       
         ≤ 
        
       
         1 
        
        
        
          0 
         
        
          5 
         
        
       
      
        1 \leq k \leq n \leq 10^5
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7804em; vertical-align: -0.136em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8304em; vertical-align: -0.136em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0315em;">
          k
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7719em; vertical-align: -0.136em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8141em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mord">
          <span class="mord">
           0
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8141em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 5
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ，
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        1 
        
       
         ≤ 
        
       
         m 
        
       
         ≤ 
        
       
         1 
        
        
        
          0 
         
        
          6 
         
        
       
      
        1 \leq m \leq 10^6
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7804em; vertical-align: -0.136em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7719em; vertical-align: -0.136em;">
         </span>
         <span class="mord mathnormal">
          m
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ≤
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8141em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mord">
          <span class="mord">
           0
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8141em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 6
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     。
    </p>
    <p>
     分析：
     <br/>
     由于选出正方形的对角线与主对角线重合，因此我们直接在主对角线上每次选出一段作为某个正方形的对角线。
     <br/>
     有两个问题：
    </p>
    <ol>
     <li>
      覆盖所有点的限制怎么刻画
     </li>
     <li>
      怎么求
      <strong>
       面积并
      </strong>
     </li>
    </ol>
    <p>
     对于第一个问题，发现一个点
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        ( 
        
       
         x 
        
       
         , 
        
       
         y 
        
       
         ) 
        
       
      
        (x, y)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          x
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          y
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     能被覆盖到的条件是对角线上选出一段
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        [ 
        
       
         l 
        
       
         , 
        
       
         r 
        
       
         ] 
        
       
      
        [l, r]
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mopen">
          [
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0197em;">
          l
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          r
         </span>
         <span class="mclose">
          ]
         </span>
        </span>
       </span>
      </span>
     </span>
     包含
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        [ 
        
       
         m 
        
       
         i 
        
       
         n 
        
       
         ( 
        
       
         x 
        
       
         , 
        
       
         y 
        
       
         ) 
        
       
         , 
        
       
         m 
        
       
         a 
        
       
         x 
        
       
         ( 
        
       
         x 
        
       
         , 
        
       
         y 
        
       
         ) 
        
       
         ] 
        
       
      
        [min(x, y), max(x, y)]
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mopen">
          [
         </span>
         <span class="mord mathnormal">
          min
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          x
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          y
         </span>
         <span class="mclose">
          )
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          ma
         </span>
         <span class="mord mathnormal">
          x
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          x
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          y
         </span>
         <span class="mclose">
          )]
         </span>
        </span>
       </span>
      </span>
     </span>
     。
     <br/>
     那么我们可以把点的限制转化为线段覆盖的问题，形如
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        [ 
        
        
        
          l 
         
        
          i 
         
        
       
         , 
        
        
        
          r 
         
        
          i 
         
        
       
         ] 
        
       
      
        [l_i, r_i]
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mopen">
          [
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0197em;">
           l
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0197em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           r
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mclose">
          ]
         </span>
        </span>
       </span>
      </span>
     </span>
     至少被某条线段覆盖。
     <br/>
     然后是发现如果有限制相包含的情况可以删掉较短的那个，因为满足了较长的限制一定满足较短的。这样所有限制线段都是不交的，可以看作
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        l 
        
       
         , 
        
       
         r 
        
       
      
        l,r
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0197em;">
          l
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          r
         </span>
        </span>
       </span>
      </span>
     </span>
     分别单增。
     <br/>
     把所有限制按照
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        l 
        
       
      
        l
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0197em;">
          l
         </span>
        </span>
       </span>
      </span>
     </span>
     或
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        r 
        
       
      
        r
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          r
         </span>
        </span>
       </span>
      </span>
     </span>
     从小到大排序。那么每个选中的线段一定覆盖了一个区间的限制线段，假设覆盖了
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        [ 
        
       
         L 
        
       
         , 
        
       
         R 
        
       
         ] 
        
       
      
        [L, R]
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mopen">
          [
         </span>
         <span class="mord mathnormal">
          L
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0077em;">
          R
         </span>
         <span class="mclose">
          ]
         </span>
        </span>
       </span>
      </span>
     </span>
     的限制，显然这一段取
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        [ 
        
        
        
          l 
         
        
          L 
         
        
       
         , 
        
        
        
          r 
         
        
          R 
         
        
       
         ] 
        
       
      
        [l_L, r_R]
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mopen">
          [
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0197em;">
           l
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3283em;">
              <span class="" style="top: -2.55em; margin-left: -0.0197em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight">
                 L
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           r
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3283em;">
              <span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathnormal mtight" style="margin-right: 0.0077em;">
                 R
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mclose">
          ]
         </span>
        </span>
       </span>
      </span>
     </span>
     是最优的。
    </p>
    <p>
     对于第二个问题，由于最优方案下我们选中的矩形不可能有包含情况，因此每个选中矩形的面积减去上一个它和上一个相邻的矩形的面积交就是它对答案的贡献。证明可以画图理解。
    </p>
    <p>
     那么就可以
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
       
         p 
        
       
      
        dp
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord mathnormal">
          p
         </span>
        </span>
       </span>
      </span>
     </span>
     ：
     <br/>
     设
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
        
        
          p 
         
         
         
           i 
          
         
           , 
          
         
           j 
          
         
        
       
      
        dp_{i, j}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           p
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     表示考虑了前
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        j 
        
       
      
        j
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.854em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0572em;">
          j
         </span>
        </span>
       </span>
      </span>
     </span>
     个限制，并且选中了
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        i 
        
       
      
        i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6595em;">
         </span>
         <span class="mord mathnormal">
          i
         </span>
        </span>
       </span>
      </span>
     </span>
     段使这
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        j 
        
       
      
        j
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.854em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0572em;">
          j
         </span>
        </span>
       </span>
      </span>
     </span>
     个限制至少被一条线段包含的最小代价。
     <br/>
     怎么转移呢？
    </p>
    <p>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
        
        
          p 
         
         
         
           i 
          
         
           , 
          
         
           j 
          
         
        
       
         ← 
        
       
         d 
        
        
        
          p 
         
         
         
           i 
          
         
           − 
          
         
           1 
          
         
           , 
          
         
           k 
          
         
        
       
         + 
        
        
        
          w 
         
         
         
           k 
          
         
           + 
          
         
           1 
          
         
           , 
          
         
           j 
          
         
        
       
      
        dp_{i, j} \gets dp_{i - 1, k} + w_{k + 1, j}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           p
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          ←
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord">
          <span class="mord mathnormal">
           p
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3361em;">
              <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mbin mtight">
                  −
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                  k
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0269em;">
           w
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3361em;">
              <span class="" style="top: -2.55em; margin-left: -0.0269em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0315em;">
                  k
                 </span>
                 <span class="mbin mtight">
                  +
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
         
         
         
           i 
          
         
           , 
          
         
           j 
          
         
        
       
         = 
        
       
         ( 
        
        
        
          r 
         
        
          j 
         
        
       
         − 
        
        
        
          l 
         
        
          i 
         
        
       
         + 
        
       
         1 
        
        
        
          ) 
         
        
          2 
         
        
       
         − 
        
       
         ( 
        
        
        
          r 
         
         
         
           i 
          
         
           − 
          
         
           1 
          
         
        
       
         − 
        
        
        
          l 
         
        
          i 
         
        
       
         + 
        
       
         1 
        
        
        
          ) 
         
        
          2 
         
        
       
      
        w_{i, j} = (r_{j} - l_{i} + 1)^2 - (r_{i -1} - l_{i} + 1)^2
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0269em;">
           w
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0269em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mpunct mtight">
                  ,
                 </span>
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.2778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.0361em; vertical-align: -0.2861em;">
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           r
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight" style="margin-right: 0.0572em;">
                  j
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2861em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          −
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8444em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0197em;">
           l
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0197em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.0641em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mclose">
          <span class="mclose">
           )
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8141em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 2
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          −
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0278em;">
           r
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                 <span class="mbin mtight">
                  −
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.2083em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          −
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.8444em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathnormal" style="margin-right: 0.0197em;">
           l
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.3117em;">
              <span class="" style="top: -2.55em; margin-left: -0.0197em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathnormal mtight">
                  i
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.2222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.0641em; vertical-align: -0.25em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mclose">
          <span class="mclose">
           )
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.8141em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 2
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     但是这样转移当没有去掉矩形包含的情况。
     <br/>
     其实不用考虑，因为如果存在矩形包含按照这种方式转移只会变得更劣，更不可能成为答案了。
    </p>
    <p>
     接着发现这是一个典型的
     <strong>
      离线最优段划分问题
     </strong>
     ，
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
      
        w
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.4306em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0269em;">
          w
         </span>
        </span>
       </span>
      </span>
     </span>
     满足四边形不等式，因此转移具有决策单调性。
     <br/>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
         q 
        
       
         s 
        
       
      
        wqs
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          wq
         </span>
         <span class="mord mathnormal">
          s
         </span>
        </span>
       </span>
      </span>
     </span>
     二分后用
     <strong>
      二分队列
     </strong>
     优化
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        d 
        
       
         p 
        
       
      
        dp
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal">
          d
         </span>
         <span class="mord mathnormal">
          p
         </span>
        </span>
       </span>
      </span>
     </span>
     ，复杂度
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        O 
        
       
         ( 
        
       
         n 
        
       
         log 
        
       
         ⁡ 
        
       
         n 
        
       
         log 
        
       
         ⁡ 
        
       
         V 
        
       
         ) 
        
       
      
        O(n \log n \log V)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0278em;">
          O
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mop">
          lo
          <span style="margin-right: 0.0139em;">
           g
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mop">
          lo
          <span style="margin-right: 0.0139em;">
           g
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.2222em;">
          V
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     。
     <br/>
     好像
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
         q 
        
       
         s 
        
       
      
        wqs
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
         </span>
         <span class="mord mathnormal" style="margin-right: 0.0359em;">
          wq
         </span>
         <span class="mord mathnormal">
          s
         </span>
        </span>
       </span>
      </span>
     </span>
     二分后可以用斜率优化去掉
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        log 
        
       
         ⁡ 
        
       
         n 
        
       
      
        \log n
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
         </span>
         <span class="mop">
          lo
          <span style="margin-right: 0.0139em;">
           g
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.1667em;">
         </span>
         <span class="mord mathnormal">
          n
         </span>
        </span>
       </span>
      </span>
     </span>
     ，但是我没写。
    </p>
    <p>
     <strong>
      CODE：
     </strong>
    </p>
    <pre><code class="prism language-cpp"><span class="token comment">// wqs 二分之后决策单调性 </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MP</span> <span class="token expression">make_pair</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">long</span> LL<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> pair<span class="token operator">&lt;</span> LL<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">&gt;</span> PII<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> N <span class="token operator">=</span> <span class="token number">1e5</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> n<span class="token punctuation">,</span> m<span class="token punctuation">,</span> K<span class="token punctuation">,</span> tot<span class="token punctuation">;</span>
<span class="token keyword">int</span> R<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span> C<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
PII dp<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">seg</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> l<span class="token punctuation">,</span> r<span class="token punctuation">;</span>
<span class="token punctuation">}</span>s<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span> h<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">bool</span> <span class="token function">cmp</span><span class="token punctuation">(</span>seg x<span class="token punctuation">,</span> seg y<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>l <span class="token operator">&lt;</span> y<span class="token punctuation">.</span>l<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span>l <span class="token operator">==</span> y<span class="token punctuation">.</span>l <span class="token operator">&amp;&amp;</span> x<span class="token punctuation">.</span>r <span class="token operator">&gt;</span> y<span class="token punctuation">.</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">inline</span> LL <span class="token function">calc</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	x <span class="token operator">++</span><span class="token punctuation">;</span>
	LL S <span class="token operator">=</span> <span class="token number">1LL</span> <span class="token operator">*</span> <span class="token punctuation">(</span>h<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token operator">-</span> h<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>h<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token operator">-</span> h<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	LL ts <span class="token operator">=</span> <span class="token punctuation">(</span>h<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token operator">&gt;</span> h<span class="token punctuation">[</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token number">1LL</span> <span class="token operator">*</span> <span class="token punctuation">(</span>h<span class="token punctuation">[</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token operator">-</span> h<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>h<span class="token punctuation">[</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token operator">-</span> h<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> S <span class="token operator">-</span> ts<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">struct</span> <span class="token class-name">range</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> l<span class="token punctuation">,</span> r<span class="token punctuation">,</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span>stk<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> l<span class="token punctuation">,</span> r<span class="token punctuation">;</span>
<span class="token keyword">inline</span> PII <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">,</span> LL c<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token function">MP</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>first <span class="token operator">+</span> <span class="token function">calc</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token operator">-</span> c<span class="token punctuation">,</span> dp<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>second <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span>LL c<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 每开一段 -c</span>
    l <span class="token operator">=</span> r <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> 
    dp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">MP</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	stk<span class="token punctuation">[</span>l<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>range<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span> tot<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> tot<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">int</span> x <span class="token operator">=</span> stk<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">;</span>
		dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">get</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> i<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
		stk<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token operator">++</span><span class="token punctuation">;</span> <span class="token keyword">if</span><span class="token punctuation">(</span>stk<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token operator">&gt;</span> stk<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">.</span>r<span class="token punctuation">)</span> l <span class="token operator">++</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span> lp <span class="token operator">=</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> rp <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span><span class="token punctuation">(</span>r <span class="token operator">&gt;=</span> l <span class="token operator">&amp;&amp;</span> <span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> stk<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span>l<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token function">get</span><span class="token punctuation">(</span>stk<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> stk<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span>l<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			lp <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>lp<span class="token punctuation">,</span> stk<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span>l<span class="token punctuation">)</span><span class="token punctuation">;</span> rp <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>rp<span class="token punctuation">,</span> stk<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
			r <span class="token operator">--</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">&gt;=</span> l<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 二分 </span>
			<span class="token keyword">int</span> lt <span class="token operator">=</span> stk<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span>l<span class="token punctuation">,</span> rt <span class="token operator">=</span> stk<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span>r<span class="token punctuation">,</span> mid<span class="token punctuation">,</span> res <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
			<span class="token keyword">while</span><span class="token punctuation">(</span>lt <span class="token operator">&lt;=</span> rt<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				mid <span class="token operator">=</span> <span class="token punctuation">(</span>lt <span class="token operator">+</span> rt <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> mid<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token function">get</span><span class="token punctuation">(</span>stk<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> mid<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span> res <span class="token operator">=</span> mid<span class="token punctuation">,</span> rt <span class="token operator">=</span> mid <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
				<span class="token keyword">else</span> lt <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>res <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>lp <span class="token operator">=</span> res<span class="token punctuation">;</span> rp <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>rp<span class="token punctuation">,</span> stk<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span> stk<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token operator">=</span> res <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
 		<span class="token punctuation">}</span>
 		<span class="token keyword">if</span><span class="token punctuation">(</span>rp <span class="token operator">&gt;=</span> lp<span class="token punctuation">)</span> stk<span class="token punctuation">[</span><span class="token operator">++</span> r<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>range<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>lp<span class="token punctuation">,</span> rp<span class="token punctuation">,</span> i<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">,</span> <span class="token operator">&amp;</span>m<span class="token punctuation">,</span> <span class="token operator">&amp;</span>K<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>R<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>C<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		R<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">++</span><span class="token punctuation">;</span> C<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">++</span><span class="token punctuation">;</span> 
		s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>seg<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token function">min</span><span class="token punctuation">(</span>R<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> C<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">max</span><span class="token punctuation">(</span>R<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> C<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">sort</span><span class="token punctuation">(</span>s <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> s <span class="token operator">+</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> cmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> mxr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token operator">&lt;=</span> mxr<span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
		h<span class="token punctuation">[</span><span class="token operator">++</span> tot<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
		mxr <span class="token operator">=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>r<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	K <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>K<span class="token punctuation">,</span> tot<span class="token punctuation">)</span><span class="token punctuation">;</span>
    LL l <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1e12</span><span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> mid<span class="token punctuation">,</span> res<span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>l <span class="token operator">&lt;=</span> r<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    	mid <span class="token operator">=</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> r <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token function">solve</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token keyword">if</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>tot<span class="token punctuation">]</span><span class="token punctuation">.</span>second <span class="token operator">==</span> K<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%lld\n"</span><span class="token punctuation">,</span> dp<span class="token punctuation">[</span>tot<span class="token punctuation">]</span><span class="token punctuation">.</span>first <span class="token operator">+</span> <span class="token number">1LL</span> <span class="token operator">*</span> K <span class="token operator">*</span> mid<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
    	<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>tot<span class="token punctuation">]</span><span class="token punctuation">.</span>second <span class="token operator">&lt;</span> K<span class="token punctuation">)</span> res <span class="token operator">=</span> mid<span class="token punctuation">,</span> l <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    	<span class="token keyword">else</span> r <span class="token operator">=</span> mid <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">solve</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%lld\n"</span><span class="token punctuation">,</span> dp<span class="token punctuation">[</span>tot<span class="token punctuation">]</span><span class="token punctuation">.</span>first <span class="token operator">+</span> <span class="token number">1LL</span> <span class="token operator">*</span> K <span class="token operator">*</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f35353835313237362f:61727469636c652f64657461696c732f313436323631303539" class_="artid" style="display:none">
 </p>
</div>


